journal sport analyt 6 (2020) 3543 doi 10.3233/jsa-190348 io press 35 predict plai nation footbal leagu craig joash fernandes, ronen yakubov, yuze li, amrit kumar prasad timothi c.y. chan depart mechan industri engineering, univers toronto, 5 king colleg road, toronto, canada abstract. paper aim develop interpret machin learn model predict plai (pass versu rush) nation footbal leagu us player coach real time. data 20132014 2016 2017 nfl regular seasons, includ 1034 game 130,344 pass/rush plays, develop compar machin learn model determin maximum possibl predict accuracy. best perform model, neural network, achiev predict accuraci 75.3%, competit state-of-the-art method appli datasets. then, search famili simpl decis tree model identifi captur 86% predict accuraci neural network easili memor implement actual game. extend analysi build decis tree model tailor 32 nfl teams, obtain accuraci rang 64.7% 82.5%. overall, decis tree model us tool coach player improv chanc stop offens play. keywords: machin learning, neural networks, decis trees, plai prediction, nfl 1. introduct footbal team compos offens defens players. virtu have ball, offens dictat play. defens react oppos team offens com- menc play, abil correctli predict type plai offens run game-chang advantage. least, have clue type plai offens run allow defens better-inform decis increas likelihood limit advanc team. idea util predict in-gam situ- ation increasingli popular research focu sport analyt (alamar, 2013). however, primari object previou paper area correspond author: craig joash fernandes, depart mechan industri engineering, univers toronto, 5 king colleg road, toronto, m5 s 3g8, canada. tel.: (1) 416 436 5210; e-mail: maxim predict accuracy, result accur uninterpret models. approach us test far predic- tion model advanc easi differ outcom predict, typic translat practic approach util predict in-gam situation. example, accur predict neural network model implement necessari technol- ogi commun predict turn action decis allow side- lines. nation footbal leagu (nfl) exampl leagu sidelin technolog restrictions. addition, opaqu complex model approach neural net- work random forests, combin like skeptic coach trust complex model understand, limit potenti adopt models. paper, goal creat interpret predict model accurate, motiv desir model issn 2215-020x/20/$35.00 2020 io press authors. right reserv articl publish onlin open access distribut term creativ common attribut non-commerci licens (cc by-nc 4.0). 36 c.j. fernand et al. / predict plai nation footbal leagu real game situations. focu predict- ing playsin particular, plai pass rush nfl. start creat differ predict model determin achiev highest predict accuracy; result serv baselin comparison prac- tical model valid publish literatur differ datasets. demonstrat- ing highest accuraci model competit state-of-the-art, investig famili simpl decis tree model determin trade- accuracy, fals neg rate, model parsimony. investig perform team-specif models, train fraction data. data us includ 130, 344 nfl regular season plai 201314 season 201617 season, inclusive. specif contribut paper fol- lows: 1. neural network model gener- at maximum predict accuraci 75.3% 10.6% fals neg rate. predict accuraci competit state-of-the- art; fals neg rate report compar studies. 2. view nfl plai predict problem len real-world imple- mentation, devis simpl decis tree model captur 86% accuraci complex model. 2. literatur review recent prediction-bas sport analyt research focus individu player projections, game outcom predictions, in-gam play-typ predic- tions. studi focus analyz individu nfl play- er attempt predict potenti impact field. instance, mulholland jensen (2014) emploi linear regress model recurs partit tree pre-nfl draft data predict career success tight-end nfl. study, dhar (2011) colleg game statist bodi mass index signific factor influenc wide receiv success league. alamar gould (2008) project offens line- men impact team pass complet rate seri regress tree determin like lineman successfulli hold block relat time took quarterback throw ball. berri simmon (2009) investi- gate relationship draft posit quarterback subsequ perform nfl conclud pick real- world nfl draft significantli overvalu manner inconsist notion ration expect effici markets. focu recent predict research sports, basketbal hockey, predict game outcomes. predict outcom ncaa tournament game (dutta, jacobson, sauppe, 2017), nba regular season game (manner 2016), european hockei leagu regular season game (marek, sediva, toupal, 2014), nhl playoff game (demers, 2015) examin varieti predict models. similar studi paper examin problem predict nfl plays, goal maxim accuracy. lee, chen lakshman (2016) play-by-plai data mad- den nfl video game player rate 201112 201415 season mix model involv gradient boost random forest achiev predict accuraci 75.9%. burton dickei (2015) data 201112 201415 sea- son built logist regress model quarter winning, tied, lose situat 4th quarter, achiev predict accuraci 75.0%. 3. data 3.1. data sourc obtain raw data sources: (1) play-by-plai data www.nflsavant.com, (2) madden nfl video game player rate mad- denratings.weebly.com. 3.1.1. play-by-plai data obtain detail play-by-plai data nfl regular seasons, 2013-2014 2016-2017, includ 1034 game 130,344 pass/rush plai total. play, record year, quarter, minute, second, down, yard down, yard line, offens format (shotgun, wildcat, center, huddl not). note intend pass plai revert qb scrambl classifi pass plays. play-by-plai data provid www.nflsavant.com c.j. fernand et al. / predict plai nation footbal leagu 37 raw featur build predict models. 3.1.2. madden rate obtain overal player rating, weight sum rate attributes, player 2014 2017 version madden nfl video game. rate base player perform previou season allow us predict plai upcom- ing season. example, madden 14 base data 201213 season us rate predict plai 201314 season. madden data augment play-by-plai data degre (subjective) domain knowledg captur subtl differ strength teams. example, team outstand wide receiv offens face team adept defend rush like pass ball. 3.2. deriv featur raw play-by-plai data, deriv addi- tional featur insight team in-gam tendencies. featur includ previou play, game home away, point differ- ential, in-gam in-season pass proportion, game complet proport pass aver- ag yard gain pass/rush. madden player ratings, deriv score posit group team: quar- terback, run backs, wide receivers, offens line, defens line, linebackers, cornerback safeties. order comput scores, took num- ber player need field posit group (base offens format 4- 3 defens formation) highest lowest score rank, score select player averag comput posit group score. reason select number player posit group avoid penal team low-rat back-up player rare field. 3.3. exploratori data analysi subsection, provid brief overview insight gain initi exploratori analysi dataset. overall, 58.9% plai pass- ing plays, repres baselin accuraci nave predict model predict pass play. drill littl deeper, dataset tabl 1 proport plai pass down, game scenario madden rate quarterback, wide receiv run current second fourth 0.496 0.585 0.793 0.670 game scenario lose ti win 0.656 0.558 0.513 madden rate [70, 74] [75, 79] [80, 84] [85, 89] [90, 94] [95, 99] qb 0.591 0.576 0.587 0.583 0.594 0.612 wr 0.526 0.594 0.583 0.587 0.614 n/a hb 0.609 0.597 0.588 0.566 0.586 n/a divid downs, proport pass plai 3rd approxim 79.3%, substan- tialli higher scenario shown tabl 1. result intuit pass plai typ- ical result yard gained, increas chanc success 3rd convers longer distances. shown tabl 1, team like pass (65.6%) game, compar team lead (51.3%). find intuit pass plai seen higher reward higher risk: potenti gain yards, increas chanc turnov intercept incomplet pass. madden rate posit group indic differ pass proport nfl team (tabl 1). instance, team higher rate quarterbacks, higher rate wide receiv lower rate run back gener like choos pass plays. 4. model maxim predict accuraci focu paper develop interpret predict model, start train- ing famili complex model goal maxim predict accuracy. exercis serv purposes. first, wish valid predict competit state-of-the-art complex model papers. second, us accuraci achiev best-perform complex model baselin simpler model develop. dataset raw deriv features, consid follow models: classifica- tion trees, k-nearest neighbors, random forests, neural networks. respect hyperparamet model tune repeat 10-fold cross 38 c.j. fernand et al. / predict plai nation footbal leagu tabl 2 predict accuraci fals neg rate complex model cart knn random neural forest network predict accuraci 73.3% 71.3% 74.7% 75.3% fals neg rate 11.9% 6.7% 11.1% 10.6% valid 15 iterations. maxim predict accuraci goal, predict accuraci score metric cross validation. however, consid fals posit (i.e., predict pass run) fals neg (i.e., predict run pass) rate model. given practic interpret met- rics, believ fals neg rate import metric consider. defens expect- ing pass gener better posit respond run, compar team posi- tion defend run pass plai execut instead. tabl 2 compar predict accuraci fals neg rate models. neural network highest predict accuraci (75.3%) associ second lowest fals neg rate (10.6%). recal literatur clos- est studi gener predict accuraci 75.9% 75.0%, suggest result competit state-of-the-art. paper document fals neg rates, comment certainti rate compares. import feat0ur predict accuraci highlight appendix. 5. interpret predict model design simpl predict approach guid criteria. first, predict model easi execut short time frame defens coordin plai call decision. nfl, offens maximum 40 second snap ball. 25 seconds, defens coordin communicate, one-wai radio, middl linebacker. therefore, ensur model quick use, limit variabl sim- ple model util static variabl easili observ point time. so, elimin variabl in-gam pass- ing proportion, averag yard gain pass game, requir coach constantli updat track game. static variabl permit sim- ple model quarter, down, minute, yard down, previou yard gain point differential. second criterion interpretabil- ity. believ coach like trust adopt black box model. thus, simpl model understand us it. given criteria, ultim decid imple- ment classif tree model limit number splits. determin accept balanc accu- raci simplicity, train larg famili classif tree model differ variabl includ split allowed. obtain result attempt simpl model, step select optim one, consid complex vs. accuraci trade-off. thought have fewer variables, max- imiz predict accuracy, desir requir fewer input track consid make prediction. thus, end choos classif tree variabl 10 splits, gener highest predict accuraci tree considered. chosen classif tree depict fig. 1. variabl greatest impact plai predict current down, yard down, point differential. simpl model achiev predict accuraci 65.3%, cor- respond 86% accuraci gener neural network model. finally, creat equiva- lent visual represent classif tree believ easier read and/or memorize, us time-sensit situat (see fig. 2). emphas model replac coach knowledg support decis making. util classif tree, us proport major class termin leaf node mea- sure strong predict is, allow coach player decid heavili trust model particular situations. predict accuraci model base differ game scenario shown tabl 3. example, model predict accu- raci higher fourth quarter, fourth downs, offens lose yard greater 13. hand, model perform fairli stabl yard lines. addit provid defens coordin tool assist plai calls, model serv c.j. fernand et al. / predict plai nation footbal leagu 39 fig. 1. classif tree readili coach percentag major class parenthesis. fig. 2. equival represent coach classif tree percentag major class parenthesis. tabl 3 predict accuraci classif tree base dif- ferent game variabl current quarter second fourth 60.3% 60.6% 62.4% 73.1% current second fourth 58.8% 58.7% 84.2% 83.4% current yard line 124 2549 5074 7599 63.7% 64.2% 64.9% 64.3% game scenario lose ti win 66.6% 60.6% 62.9% yard 14 58 912 1316 17+ 66.7% 66.4% 61.2% 77.9% 76.0% mean suppli individu player defens line pre-snap reads. player run model determin greater likeli- hood pass rush, mental prepar ensu play. example, safeti us model predict pass, inform extra caution guard wide receivers. model insert play-cal wristband similar on quarterbacks. player util model time snap, abl creat secondari model addit offens format variabl (figs. 3 4). new model achiev predict accuraci 72.3%, captur 96% predict power neural network model. propos coach us base model aid plai call defens line us secondari model help pre-snap reads. 6. team-specif classif tree previous develop classif tree train data teams, 40 c.j. fernand et al. / predict plai nation footbal leagu fig. 3. classif tree defens percentag major class parenthesis. fig. 4. equival represent defens line classif tree percentag major class parenthesis. team-specific. sought calcul predictabil- iti individu team order determin team deviat predict model describ above. therefore, creat team-specif classif tree follow approach balanc accuraci interpret previous outlined. process follow same, differ data team, result classif tree differ number variabl splits. figur 5 summar predict accuraci 32 team-specif models. model dalla cowboi achiev highest accuraci 82.5%, model buffalo bill achiev lowest accuraci 64.7%. averag accuraci team-specif model 73.0%. believ variabl predict accuraci par- tialli attribut differ offens style tendenc team. asso- ciation team coach (head assistant) chang year span dataset team poorer predict accuracy. believ find make sens coach change, style plai call tendenc chang well. note team gener lead (trailing) easier predict reli rush (passing) plays. however, model util point differenti variable, featur captur model. conduct robust check ver- ifi team-specif result nois data. randomli assign plai data team re-conduct analysis, cre- at 32 new classif trees. repeat process 50 times. averag team accuraci 71.5% (minmax: 70.3%72.8%), averag minimum valu team 68.9% averag maximum valu team 74.3%. believ fairli tight distribut compar true distribut non-simul data suggest origin find nois actual between-team variation. c.j. fernand et al. / predict plai nation footbal leagu 41 fig. 5. predict accuraci team-specif classif trees. 7. futur work avenu research leav futur work. first, detail data includ exact player field, injuries, weather, players/coach media comment dai lead game, lead bet- ter predictions. addit data lead creation altern simpl model avoid format variabl instead us exact personnel field. allow coach readili plai call base model wait offens team get formation. second, relat point, test model human expert valuabl exercise, human abl account extra information. third, explor certain team predict others. per- hap coach exhibit fewer variat consist plai calling. possibl train model sequenti time season progress reduc nois asso- ciat player/staff turnov offseason. practice, hybrid approach model train histor data updat dynam season progresses, appropriate. additionally, note specif pre- diction model given pair team valuabl defens coordinators. is, defen- sive coordin jet want patriot team-specif model train patriot games, patriot model train data game plai exclus jets. however, tailor desired, avail data train model sparser, possibl lead reduct predict accuracy. 8. conclus summary, paper focus develop- ment simpl interpret machin learn model predict nfl plays. show simpl classif tree model variabl gener overal predict accuraci 65.3%, 86% accuraci state-of-the-art neural network model. moreover, addit goal creat simpl model sole aid pre- snap reads, abl achiev accuraci 72.3%. focus team-specif data, abl team rang significantli term predictability, 64.7% 82.5%. given transpar potenti memorized, believ model us decision-aid nfl games, consid short timefram decis need made. refer alamar, b., 2013, sport analytics: guid coaches, man- agers, decis makers. new york: columbia univers press. alamar, b. & weinstein-gould, j., 2008, isol effect individu linemen pass game nation footbal league. journal quantit analysi sports, 4(2), 111. 1113. 42 c.j. fernand et al. / predict plai nation footbal leagu berri, d. & simmons, r., 2009, catch draft: pro- cess select quarterback nation footbal leagu amateur draft journal product analysis, 35(1), 3749. burton, w. & dickey, m., 2015, nfl plai predict joint statist meet 2015. seattle, 813 august. demers, s., 2015, ride probabilist support vector machin stanlei cup. journal quantit analysi sports, 11(4), 205218. dhar, a., 2011, draft nfl wide receivers: hit miss? univers california, berkeley. stat.berkeley.edu/aldous/157/old projects/amrit dhar. pdf dutta, s. jacobson, s. & sauppe, j., 2017, identifi ncaa tournament upset us balanc optim subset selec- tion. journal quantit analysi sports, 13(2), 7983. lee, p. chen, r. & lakshman, v., 2016, predict offen- sive plai type nation footbal league. stanford university. 268dc039d4f17bb8cbbe6881bf1bf8187dba.pdf manners, h., 2016, model forecast outcom nba basketbal games. journal quantit analysi sports, 12(1), 3141. marek, p. sediva, b. & toupal, t., 2014, model predict ic hockei match results. journal quantit analysi sports, 10(3), 357365. mulholland, j. & jensen, s., 2014, predict draft career success tight end nation footbal league. journal quantit analysi sports, 10(4), 381396. c.j. fernand et al. / predict plai nation footbal leagu 43 appendix figur 6 highlight import featur variabl random forest model. difficult determin import featur neu- fig. 6. predict accuraci random forest model lose featur removed. ral network, best complex model, believ compar result fig. 6. import note differ predic- tion accuraci random forest neural network 0.6%.