eurograph confer visual (eurovis) (2012) short paper m. meyer t. weinkauf (editors) fast visual gaussian densiti surfac molecular dynam particl trajectori michael krone1, john e. stone2, thoma ertl1, klau schulten2 1visual research center, univers stuttgart, germani 2beckman institute, univers illinoi urbana-champaign, usa abstract present effici algorithm comput surfac represent enabl interact visual larg dynam particl data sets. method base gpu-acceler data-parallel algorithm comput volumetr densiti map gaussian weight particles. algorithm extract isovalu surfac comput densiti map, fast gpu-acceler march cubes. approach enabl interact frame rate molecular dynam simul consist million atoms. user interact adjust displai structur continu scale, rang atom in-depth analysis, reduc visual represent suitabl view overal architectur molecular complexes. extract surfac us interact visualization, provid basi structur analysi methods. categori subject descriptor (accord acm ccs): i.3.5 [comput graphics]: comput geometri object modelingboundari represent 1. introduct particle-bas simul wide tool fields. molecular dynam (md) simul exampl appli simul biomolecul like proteins. out- simul large, time-depend data set compos thousand time step million particl frame. visual fundamen- tal tool interpret results. instead visual particl individu spheres, surfac represent advantag interest phenomena oc- cur boundari particl complexes. present fast method visual smooth surfac larg particl data sets. algorithm base metabal definit [bli82]. method make us tremend comput power offer modern graphic process unit (gpu). result surfac model analyt defin molecular surfac closely. represent adapt interact creat coarser, approxim surfac desir larger number particles, atom necessary. surfac color displai per- atom biochem attribut crucial comprehen- sive analysis. outlin algorithm simple: first, uniformli space densiti map calcul particles. next, surfac extract march cube (mc) algorithm [lc87]. extract surfac visual analysis. 2. relat work solvent exclud surfac (ses) [ric77, con83, ta95] defin spheric probe roll atom spheres. probe contact surfac trace ses. wide molecular surfac provid meaning represent molecul respect substrate. however, comput se involv recent, parallel method [lbph10, kge11] render se dynam data set 100 k atom inter- activ current hardware. molecular surfac definit introduc blinn [bli82] known metaballs. implicit surfac defin point p r3 satisfi certain equat f(p) = 0. particl repres den- siti function di(p) usual degrad distanc atom center ai. densiti valu particl ad point global densiti field d(p) = idi(p). isosurfac defin threshold valu t f(p) = d(p) t . gaussian densiti function c eurograph associ 2012. m. krone, j.e. stone, t. ertl, k. schulten / fast visual gaussian densiti surfac (a) (b) (c) (d) figur 1: (a) semitranspar molecular surfac small protein (7,231 atoms) combin stick model. (b) molecular surfac chromatophor (9.6 m atoms) comput method. paramet adjust creat coars surfac show shape molecul smooth individu atoms. (c) chromatophor data set bead represent (<1 m beads). (d) polio viru capsid (0.7 m atoms) comput atom detail. suitabl paramet di, result smooth iso- surfac model electron densiti surfac molecul close [bli82] (cf. figur 1a, d). surfac ren- dere directli gpu rai cast [mge07, ksn08] intermedi densiti map comput isosurfac extraction. falk et al. [fkre10] uniform grid visual particle-bas simulations. appli gpu shader program gener volum gpu extract isosurfac gpu rai marching. krone et al. [kfr11] similar techniqu visual approx- imat molecular surfaces. fraedrich et al. [faw10] sampl particl perspect grid us gpu rai march- ing rendering. dia et al. [dg11] recent present cuda-bas approach construct densiti map extract isosurfac mc cuda. stone et al. [spf07] rodrigu et al. [rhs08] describ fast gpu algorithm comput electrostat potenti map uniform lattices, strongli influenc gpu gaussian densiti summat algorithm. approach differ primarili comput spatial acceler structur entir gpu irregular atom bin sizes, enabl interact displai rate larg structures. gpu-acceler optim lorensen cline origin mc algorithm [lc87]. cuda implement base bourk mc [bou94] includ nvidia gpu comput sdk. dyken et al. [dzts08] implement similar nvidias, achiev notic speedup replac prefix sum histopyramid [ztts06] traversal. 3. algorithm implement detail method split parts: gener vol- umetr densiti map atom posit iso- surfac extract mc. triangul surfac benefici render crucial comput (cf. section 4 & 5). algorithm design run parallel gpu. implement step al- gorithm cuda, optim nvidia fermi gpus. 3.1. volumetr densiti map gener costli step molecular surfac gener calcul scalar volum contain gaussian den- siti sum particl neighborhood voxel. gaussian densiti distribut approxim electron densiti solvent access surfac all-atom molecular model [bli82, ggp96]. densiti map gener algorithm accumul gaus- sian densiti uniformly-spac 3-d lattic defin bound box contain particles; pad volum ensur extract surfac clip off. densiti map gener algorithm satisfi (~r;~r1,~r2, . . . ,~rn) = n i=1 e |~r~ri | 2 22 , (1) densiti evalu position~r sum n atoms. atom locat posit ~ri associ weight factor determin multipli radiu user-defin weight scale factor custom visual produc surfac appropri user-defin level detail. densiti map comput serial o(n2) sum densiti contribut n atom voxel. quickli impract molecular complex moder size. magnitud gaussian densiti contribut atom decai rapidli increas distance, algorithm reduc linear time complex elimin densiti contribut atom cutoff radius. lim- it set contribut atom cutoff radius, work associ grid point roughli constant atom larg uniformli dis- tribut space [vbw94]. perform improv formul data-parallel version linear- time approach, take advantag fact densiti grid point ~r comput independently, partial densiti contribut given grid point~r differ atom comput parallel. c eurograph associ 2012. m. krone, j.e. stone, t. ertl, k. schulten / fast visual gaussian densiti surfac implement parallel gather approach gpu involv construct uniform spatial accelera- tion grid grid space equal cutoff distance. particl sort acceler grid. grid point~r, algorithm gather densiti contribut loop atom contain 33 neighbor cell acceler grid. grid point comput independently, parallel write conflict cach coher requir process units. cuda implement reus y z atom distanc com- ponent multipl grid point y row, z column, comput multipl grid point thread, x distanc uniqu grid point. secondari benefit thread coarsen approach per-thread regist reus read atom data global memori amort multipl grid points, significantli increas arithmet intensity. per-atom color molecular surface, 3-d rgb-volum comput addit densiti map. color grid cell sum color contri- bution atom scale associ densiti contri- bution divid isovalue. result normal- iz color requir post-process color valu prior us isosurfac extraction. 3.2. march cube isosurfac extract us march cube (mc) algorithm [lc87] ex- tract isosurfac densiti map. implementa- tion optim extend version mc exam- ple nvidia gpu comput sdk. step, number triangl gener determin cube 23 voxel lookup tabl [bou94]. cube consid activ contain trian- gle. activ cube flag (0 1) number triangl vertic cube written uint2 array. step call classification. second step, parallel prefix sum classif arrai comput total number activ cube triangl vertices. step compactif activ cubes. base pre- fix sum previou step, lookup tabl written. number entri lookup tabl equal number activ cubes. subsequently, lookup tabl ad- dress activ cubes. fourth step, tri- angl cube generated. compactif step three, step execut activ cubes. again, 23 voxel valu read cube classified, triangl actual gener vertic written output array. speed computation, split triangl vertex calcul normal calcul separ steps. kernel write vertic second kernel comput per-vertex normal central differences. surfac color accord 3d color map creat dur- ing gener step. triangl vertex locat figur 2: membran patch data set (22.8 m atoms). screenshot, surfac water box (20 m atoms) render lower membran protein reduc comput time. edg cube. therefore, determin voxel coordin start end point edge. vertex color calcul linearli interpol color valu voxel coordinates. 4. enhanc extens section showcas possibl extens fast molecular surfac extraction. bead simplification. view protein system million atoms, desir us reduced-detail visual overal architec- ture molecular complex instead clutter associ- at atom detail. biomolecular complex usual decompos nucleic acids, lipids, amino acids, bound sphere comput atom contain, coarse-grain bead input densiti map gener (cf. figur 1c). result order- of-magnitud reduct particl yield signific per- formanc boost, allow interact visual larger molecular complexes. molecular surfac area. gaussian surfac descrip- tor us model solvent access surfac area (sasa) [ric77] accur (below 2 % deviat area se [gp95]). implement interac- tive cuda area calcul mc triangulation: af- ter comput individu triangl area parallel, prefix sum total area. comparison rapid stochast measur sasa juba et al. [jv08], solut equal fast, accuraci higher. area differ 10 % se [jv08]. 5. result discuss measur perform method data set real molecular dynam simulations. figur 2 show largest test case: membran patch protein water (22.8 m atoms). test intel core i7 x980 (63.3 ghz) 12 gb ram nvidia geforc gtx 580. test application, user adjust surfac easi understand param- eters: grid space h, scale factor r atom c eurograph associ 2012. m. krone, j.e. stone, t. ertl, k. schulten / fast visual gaussian densiti surfac tabl 1: perform measur (all time sec- onds). radiu scale r set 1.0 isovalu 0.5 tests. h denot grid spacing. tsort includ time upload particl gpu sort acceler grid, td comput time densiti map tmc mc runtime. column show overal perform (comput + rendering) fps. #atom h map size tsort td tmc fp 147,976 1.0 183184184 0.007 0.048 0.009 13.2 754,200 (fig.1d) 1.0 364364364 0.01 0.18 0.05 3.5 955,226 1.0 220220220 0.008 0.189 0.012 4.2 2.37 m 2.0 42939458 0.03 0.17 0.016 3.9 9.62 m (fig.1b) 2.0 377375355 0.16 0.023 0.06 3.4 22.8 m (fig.2) 4.0 24022272 4.4 0.68 0.01 0.18 radiu isovalu i. molecular surfac atom detail, suggest grid space 1.0 . larger data set smoother, abstract surfac desir visual analysi show over- shape molecul draw attent insignific singl atom movements. tabl 1 show perform method. frame rate includ transfer particl gpu, den- siti map calcul mc extract frame. is, techniqu possibl interact vi- sualiz molecular surfac fulli dynam data set million atom atom detail. time measur per-atom coloring. comput densiti map colors, td 30% lower. compu- tation time influenc combin follow factors: number particles; grid resolution, result grid space h; number trian- gles, depend spatial arrang particles. factor mutual influenc time step (tsort , td , tmc). cases, densiti map calcul expens algorithm. how- ever, larg number particl small densiti maps, sort time limit factor. mc calcul fast influenc frame rate marginally. bead represent reduc number particl order magnitud biomolecules. additionally, grid space larger bead larger origin atoms. result high frame rate larg data set. figur 1c show bead surfac chromatophor data set (figur 1b, 9 m atoms). number bead 1 m, result 10 fp test system. recently, krone et al. [kge11] present fast method analyt comput se gpu cuda fulli dynam data. protein 59,000 atom (pdb- id: 1aon) measur 6.8 fp nvidia quadro 7000. algorithm visual molecular surfac data set geforc gtx 580 (which compar quadro) grid space 1.0 19 fps. method similar work dia et al. [dg11]. construct densiti map extract molecular surfac mc cuda. densiti grid, us atom-bas scatter approach voxel-bas gather approach do. protein 7,231 atom (shown figur 1a) report comput time 10 s geforc gtx 280. implement comput surfac protein 0.07 s (same gpu grid size). lack detail [dg11] sure method faster, assum densiti map calcul slower explic- itli avoid write conflict scatter approach. fraedrich et al. [faw10] sampl visibl parti- cle scene perspective, non-uniform grid view space. optim result low comput time large, dynam data sets. render isosurfac gpu rai casting. perform method compar technique. however, densiti grid view-depend non-uniform, method analyt process (cf. section 4). triangle-based, undistort isosurfac obtain benefici applic render data multipl point view, like 3-d stereoscop render input avail offlin raytracers. 6. summari conclus present fast method comput smooth sur- face large, dynam particl data sets. algorithm intend visual md simul trajectories, however, applic particle-bas data, e.g. sph simulations. surfac extract in- teract comput densiti field parallel mc implementation. densiti field comput gaus- sian kernel particle. stage algorithm run complet gpu, leverag tremend com- putat power speed computation. compu- tation highli parallel advantag gpu. result interact frame rate data set million particles. method integr publicli avail molecular visual softwar vmd [hds96] "quicksurf" representation. got posit feedback user field biochemistri biophysics. like high perform compar molecular surfac comput method felt process trajectori analysi sped en- rich method. 7. acknowledg work partial fund german research foundat (dfg) collabor research center sfb 716, u.s. nation institut health, grant p41-rr005969. c eurograph associ 2012. m. krone, j.e. stone, t. ertl, k. schulten / fast visual gaussian densiti surfac refer [bli82] blinn j. f.: gener algebra surfac drawing. acm transact graphic 1 (1982), 235256. 1, 2 [bou94] bourk p.: polygonis scalar field. online, //www.paulbourke.net/geometry/polygonise/, 1994. (last access 01.04.2012). 2, 3 [con83] connolli m. l.: analyt molecular surfac calcu- lation. journal appli crystallographi 16 (1983), 548558. 1 [dg11] dia s., gome a. j. p.: graphic process unit- base triangul blinn molecular surfaces. concurr comput 23, 17 (2011), 22802291. 2, 4 [dzts08] dyken c., ziegler g., theobalt c., seidel h.- p.: high-spe march cube histopyramids. graphic forum 27, 8 (2008), 20282039. 2 [faw10] fraedrich r., auer s., westermann r.: ef- ficient high-qual volum render sph data. ieee transact visual graphic 16 (2010), 15331540. 2, 4 [fkre10] falk m., klann m., reuss m., ertl t.: 3d vi- sualiz concentr stochast agent-bas signal transduct simulations. proceed ieee intern symposium biomed imag (2010). 2 [ggp96] grant j. a., gallardo m. a., pickup b. t.: fast method molecular shape comparison. journal com- putat chemistri 17, 14 (1996), 16531666. 2 [gp95] grant j. a., pickup b. t.: gaussian descript molecular shape. journal physic chemistri 99, 11 (1995), 35033510. 3 [hds96] humphrei w., dalk a., schulten k.: vmd visual molecular dynamics. journal molecular graphic 14 (1996), 3338. 4 [jv08] juba d., varshnei a.: parallel stochast measure- ment molecular surfac area. journal molecular graphic model 27, 1 (2008), 8287. 3 [kfr11] krone m., falk m., rehm s., pleiss j., ertl t.: interact explor protein cavities. graphic forum 30, 3 (2011), 673682. 2 [kge11] krone m., grottel s., ertl t.: parallel contour- buildup algorithm molecular surface. proceed ieee symposium biolog data visual (2011). 1, 4 [ksn08] kanamori y., szego z., nishita t.: gpu-bas fast rai cast larg number metaballs. graphic forum 27, 3 (2008), 351360. 2 [lbph10] lindow n., baum d., prohaska s., hege h.-c.: acceler visual dynam molecular surfaces. com- puter graphic forum 29 (2010), 943952. 1 [lc87] lorensen w. e., cline h. e.: march cubes: high resolut 3d surfac construct algorithm. proceed- ing acm siggraph graphic interact techniqu (1987), pp. 163169. 1, 2, 3 [mge07] mller c., grottel s., ertl t.: image-spac gpu metabal time-depend particl data sets. proceed vision, model visual (vmv 07) (2007), pp. 3140. 2 [rhs08] rodrigu c. i., hardi d. j., stone j. e., schulten k., hwu w. w.: gpu acceler cutoff pair potenti molecular model applications. cf08: pro- ceed 2008 confer comput frontier (2008), acm, pp. 273282. 2 [ric77] richard f. m.: areas, volumes, packing, protein structure. annual review biophys bioengin 6, 1 (1977), 151176. 1, 3 [spf07] stone j. e., phillip j. c., freddolino p. l., hardi d. j., trabuco l. g., schulten k.: acceler molecular model applic graphic processors. jour- nal comput chemistri 28 (2007), 26182640. 2 [ta95] totrov m., abagyan r.: contour-buildup algo- rithm calcul analyt molecular surface. journal structur biologi 116 (1995), 138143. 1 [vbw94] varshnei a., brook f. p., wright w. v.: lin- earli scalabl comput smooth molecular surfaces. ieee graphic applic 14, 5 (1994), 1925. 2 [ztts06] ziegler g., tev a., theobalt c., seidel h.- p.: gpu point list gener histogram pyramids. research report, max-planck-institut fr informatik, 2006. 2 c eurograph associ 2012.