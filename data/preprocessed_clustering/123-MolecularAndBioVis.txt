eurographics/ ieee-vgtc symposium visual 2008 a. vilanova, a. telea, g. scheuermann, t. mller (guest editors) volum 27 (2008), number 3 visual abstract solvent pathlin near protein caviti katrin bidmon1, sebastian grottel1, fabian bs2 jrgen pleiss2 thoma ertl1 1visualis research center, universitt stuttgart, germani 2institut technic biochemistry, universitt stuttgart, germani abstract water known plai crucial role protein structure, flexibl activity. us molecular dynam simul allow detail studi complex protein-solv interactions. cluster analysi density-bas approach successfulli identif analysi conserv water molecul hy- dration pattern proteins. however, appropri tool analys long-tim molecular dynam simul respect track visualis path solvent molecul lacking. method focus visu- alis solvent path enter leav caviti protein allow studi rout dynam exchang tightli bound intern water molecul bulk solvent. propos visualis repres dynam properti direct veloc solvent. especially, cluster similar path- line respect design properti visualis abstract repres princip path solvent molecul cavities. applic analysi long-tim scale molecular dynam simul confirm conjectur base previou manual observ chance, led novel insight dynam structur role water molecul interplai protein structure. categori subject descriptor (accord acm ccs): i.3.7 [comput graphics]: three-dimension graphic realism, i.3.8 [comput graphics]: applications, j.3 [life medic sciences]: 1. introduct water import protein structure, dynam activ- iti plai kei role biolog processes. certain threshold hydrat level, enzym inact nonfunct [rc91]. water mediat protein-protein protein-ligand contact form hydrogen bond chain backbon atom protein polar atom substrat ligands. therefore, protein-solv system studi experiment theoret method gain insight interact solvent molecules, particular water, protein structur dynam (for review [ps06, hel07]). x-rai crystallographi long analys wa- ter protein surfaces, crystal structur determin high resolut provid detail pictur protein hy- dration [nak04]. analysi multipl crystal structur {bidmon | grottel | {fabian.bo | protein protein famili show certain posit par- ticularli interior protein repeatedli occupi conserv water molecul [bwt06]. water molecul interior protein form inte- gral structur exchang exter- nal bulk solvent result protein conform fluctu- ation [gh00]. experiment mean resid time de- termin sub-nanosecond time scale surfac bound water, interior water molecul exchang nanosecond millisecond time scale [olw91]. molecular dynam (md) simul provid detail atom descript biomolecul enclos shell solvent molecules. base newton equat motion, md simul ideal suit provid detail infor- mation fluctuat conform chang protein surround solvent. simul re- sult gigabyt data, hence, visualis plai import role understand analys results. visualis context focus protein itself, thus, lack visualis method c 2008 author(s) journal compil c 2008 eurograph associ blackwel publish ltd. publish blackwel publishing, 9600 garsington road, oxford ox4 2dq, uk 350 main street, malden, ma 02148, usa. k. bidmon & s. grottel & f. bs & j. pleiss & t. ertl / abstract solvent pathlin support grow protein interact solvent. protein-solv interact studi mi- crobial antibiot resist protein long-tim scale md simulations. avail protein-centr al- gorithm appli identifi so-cal water bridg [san04]. result discoveri water molecul locat insid caviti involv water bridg con- nect function relev loop protein core. be- ing highly-occupi water bridg through- simulation, plai possibl role stabilis loop. convent tool like vmd [hds96] visualis posit water molecul insid cavity. however, identif water bridg time-averag process, inform motion movement individu water molecul lost. plain visuali- sation anim trajectory, water molecul certain cut-off distanc caviti omitted, clear remain wa- ter high fluctuat prevent visual investiga- tion. however, observ water molecul enter leav caviti distinct routes. directli vi- sualis water molecul pathlin exist viewer feasible, result pictur clutter unsteadi pathlin water molecules. work present new abstract wai identifi visualis pathwai solvent molecules, water simul examined, protein caviti md simul trajectories. visualis retain di- rection water molecul enter leav cav- iti inform veloc resid time water molecul follow routes. 2. relat work visualis macromolecular structur busi research area. start earli work def- init molecular surfac [ric77] effici implement [con83, vbw94], nowadai work mainli deal interact high-qual represent larg molecular structuresoften exploit programma- biliti modern gpus. mention them, lamp et al. [lvrh07] present approach visualis- ing protein point-bas method. better under- stand 3d structure, tarini et al. [tcm06] present gpu-acceler method appli ambient occlus real-tim visualis spacefil representation. approach focus visualis con- format chang molecul (e.g. [sebh02]). additionally, tool visualis protein-solv trajectori md simul vmd [hds96] chimera [pgh04]. develop long period time offer wide rang function analys pro- tein usual lack special featur process sol- vent. hand grow number gpu- optimis viewer like biobrows [hof05] tex- mol [bdst04], featur good perform ren- dere qualiti lack support time-depend dataset offer vmd chimera. unfortunately, solut take special care solvent surround- ing protein. repres solvent molecul lead box fill tini molecul obstruct protein insideillustr fig. 1. obviously, us investig protein-solv interactions. figur 1: protein-solv repres filter solvent molecules. far, water distribut repres us- ing cluster density-bas approach. cluster approach identifi water molecul occupi posit trajectori frames, result distinct clus- ter point repres water molecul tightli bound protein [mb04]. density-bas approach place 3d grid protein repres histogram water molecul grid element, result densiti dis- tribut solvent protein high densiti peak constitut area tightli bound water molecul [pma98]. approach requir initi superpo- sition trajectori frame refer frame, treat protein essenti inflexible, cluster- base approach fail identifi water molecul associ flexibl protein residu residu cours simulation. density- base approach result smeared-out densiti dis- tribut flexibl protein residues. circum- vent problems, method emploi us protein- water-centr coordin instead global calcul water bind rel pro- tein atom [san04, hm02]. represent solvent distribut mention static view water distri- bution, suffici purposes. allow identifi water-fil caviti surfac deepli buri structur water molecules. [bvg02] tight hull c 2008 author(s) journal compil c 2008 eurograph associ blackwel publish ltd. 936 k. bidmon & s. grottel & f. bs & j. pleiss & t. ertl / abstract solvent pathlin volum caviti identifi water molecul insid detected. similar approach, statist exit water molecul exchang bulk made, water molecul track examin visualis pathwai insid caviti inform water molecul enter leav caviti exit provided. besides, visualis preserv- ing data dynam desired, rout water molecul cavitya seen cluster densiti representation. vmd provid function track individu atom trajectory. task describ especi long trajectori ten thousand time step processed, contain easili 50000 atom solvent frame. track singl atom trajectori usual result errat pathlin extend- ing simul domain. however, us select atom caviti cho- sen frame determin molecul leav caviti all. explor gener behaviour sol- vent molecul enter leav roi approach provid specif interact support necessary. order handl numer pathlin result larg trajectory, decid abstract represent main routes, cluster pathlin visualis tubes, similar approach [tvw99], pathlin vector field simplifi flow visualisation. never- theless, wide rang techniqu commonli flow visualis appli task, vector field attent turn explor trajec- tori singl frame. 3. pathlin order applic flexible, decid implement calcul solvent molecul path- line subsequ process preprocess- ing step independ tool decoupl viewer store result pathlin file. additionally, statist detail calcul written option output file. data includ inform length extract pathlin averag path- length exit taken enter leav cavity. so, basic tool wider rang users, load extract pathlin coordin md viewer, e.g. pymol [del02], vmd chimera, extens script plu- gins. python script pymol provid tool. possibl adjust cluster param- eter particular dataset visualisation, clus- tere pathlin represent de- scribe section 4, protein visualis chosen chang interact viewer. follow sections. 3.1. data extract filter solvent molecul trajectory, super- posit frame trajectori common refer- enc frame, e.g. frame, appli standard analysi tool provid amber molecular dynam- ic packag [ccd05]. superposit base protein backbon atom remov overal translat rotat motion protein preserv protein flexibility. figur 2: protein spacefil representation. grei sphere mark region enclos cavity. sol- vent molecul outsid neglect processing. visualis path solvent molecul re- sult box stuf pathlines. thus, select re- gion (roi) solvent molecul tracked. following, region defin bound- ing sphere centr s insid protein caviti radiu surround caviti possibl exit (see fig. 2 3). alternatively, roi de- fine shape suit caviti tightly, cylinders, boxes, orplan futur workth caviti ge- ometri extract extern tool (e.g. [pkko07,wps07]) well-establish applic domain. 3.2. pre-process dynam behaviour solvent molecul close protein surfac protein caviti differ bulk solvent molecules. on im- pact behaviour want explore. hence, want visualis like relev solvent molecules. order initi set pathlin frame trajectori solvent molecul locat insid roi extracted. read trajectory, posi- tion solvent molecul select area. includ molecul surround bulk solvent pass roi high veloc phenomenon explore. therefore, initi extract path filter pathlin persist user- chosen minimum frame kept. c 2008 author(s) journal compil c 2008 eurograph associ blackwel publish ltd. 937 k. bidmon & s. grottel & f. bs & j. pleiss & t. ertl / abstract solvent pathlin dp3 dw2 dp2 dw4 dw1 dp4 dp1 s w1 w2 w3 p3 p2 w4 p4 p1 figur 3: schemat exampl filter solvent molecul bulk insid cavity. solvent molecul wi awai sphere centr s nearest protein molecul pi skip outer protein probabl bulk. depend shape examin area pro- tein solvent, molecul pass roi outer protein included. solvent molecul close protein surfac slowli bulk, pass previous describ filter- ing. hence, addit filter included, remov molecul (illustr fig. 3). dwi denot distanc solvent molecul wi select sphere centr s, dpi distanc s protein atom pi locat closest wi, respectively, skip solvent molecul wi : dpi < dwi assum outer molecule. ensur visibl contextu information, is, water enter leav cavity, pathlin ex- tend user-chosen distanc (either angstrom number frames) select volum take account adjoin pathlin solvent molecul trajectori boundaries. 4. render filter describ section 3.2 prevent view clutter individu path- lines. therefore, addit process appli order comprehens abstract representationreduc princip path travers solvent molecul en- tere leav protein caviti question. however, creat abstract represent im- pli risk discard distort relev inform lead wrong conclusions. im- plement direct visualis pathlin fil- tere solvent molecul refer base abstract representations. 4.1. render pathlin implement direct straight-forward render pathlin select roi refer check plausibl abstract representations, mention above, analys small datasets. number relev solvent molecul re- duce few, direct visualis suffici gain requir insight. avail visualisa- tion make tool compar exist visual- isat research area increas accep- tanc commun applic domain. how- ever, visualis refer ab- stract on main aim implementation. extract pathlin repres static view trajectory, dynam properti map sup- plementari graphic attributes. want encod interest aspects: direct movement, veloc- ity, point time. however, necessari rep- resent exact values. qualit impress suffici (e.g. given posit begin end trajectory.). posit time map colour gradient red, yellow cyan, blue. figur 4 show allow roughli compar time frame near positions. veloc map satur colour. interest slow movements, low veloc map high saturation, path high veloc repres gray. veloc direct movement shown small, repeated, anim lumin gradient pattern.th pat- tern length chosen proport local veloc emphasis mapping. map valu colour pathlin optim cases. enabl user modifi map multipl wai (e.g. chang colour gradient). process step pathlin want rid chaotic small-scal motion molecules, ob- scure princip movements, better perceptibility. figur 4: properti map pathlines: time trajectori repres colour gradient red (start trajectory) yellow cyan, blue (end trajectory). addit lumin ramp en- code molecul direct motion seen cut-out. veloc encod saturation. fast pathlin (on right side) shown gray. c 2008 author(s) journal compil c 2008 eurograph associ blackwel publish ltd. 938 k. bidmon & s. grottel & f. bs & j. pleiss & t. ertl / abstract solvent pathlin resolv problem, appli simpl effect smooth oper pathlines. filter ker- nel base cos2 interv [0, 2 ] com- pact support. size kernel user defin and, course, filter compact support (e.g. truncat gaussian). re- duce total number pathlin visualised, simplifi represent and, thus, help understand struc- ture dataset. figur 5 show effect smooth small region dataset. figur 5: origin pathlin smooth (right) em- phasis princip direct motion normal obscur molecul chaotic small-scal fluctuat (left). 4.2. abstract represent describ above, abstract represent need gain deeper insight characterist data. reduc number paths, adjac pathlin simi- lar dynam properti merg bundl pathlines, edges. specialis cluster algorithm take account specif properti data presented. interest part dataset classifi groups: posit conserv water molecules, area low veloc solvent molecules, princip path solvent molecul po- sitions. extract posit low veloc node graph build edg pathlin posit between. step cluster detect posit low veloc support point abstract pathways. try construct structur quickli possibl abl chang cluster paramet in- teractively, handl pathlin separately, clus- tere data performed. sequenc vertic wi pathlin pi veloc valu de- fine threshold vmax form cluster ci,n own, n reflect fact pathlin cluster emerg (see fig. 6). veloc threshold adapt given dataset behaviour solvent select area interest. situat present paper 60 percentil veloc work threshold. us sphere repres clusters. posit sphere given mean posit cluster pathlin vertic radiu rci,n chosen sphere cover 90 percent vertices. w4(t0) w3(t0) w2(t0) w1(t0) w1(t1) w3(t1) w3(t2) c1,1 c3,1 c2,2 c2,3 c4,1 c2,1 p1 w4(t1) p4 c3 c1 w2(t1) w4(t2) p2 p3 w2(t2) w1(t2) c2e11,2 e21,2 figur 6: cluster pathlines: vertic wi (blue) pathlin pi low veloc valu form spheric cluster ci,n (mark light blue). cluster overlap defin new major cluster ck (green) connect- ing pathlines. finally, path (red) connect major cluster merg singl direct edg clusters. second step cluster merg overlap sphere new cluster ck, colour green fig. 6. connect individu pathlin segment path- line connect cluster cn c m form direct edg ein,m (mark red fig. 6). finally, edg pair cluster group singl edg en,m. number pathlin segment ein,m form final edg defin weight edge. introduc helper cluster end pathlines. allow creat edg previ- ousli detect cluster conserv water posit bulk solvent border select area inter- est. helper cluster merg base distanc threshold. reduc clutter images, edg weight (optionally) removed, path usual interest. straight line connect cluster yield satisfactori result cluster place close together, intention merged. therefore, straight line produc overlaps, edg ren- dere tube edg weight encod tube radius. additionally, edg smaller weight com- plete occlud thicker ones. resolv cubic bzier curv repres edge. curv fit- ted vertic pathlin segment form edg good trade-off origin trajectori princip path solvent molecules. however, real-world dataset show strong overlaps. decid modifi bzier curves. goal reduc overlap chang curv necessari move inner control point bzier curves. control point accumul scale distanc vector line segment in- ner control point curves. distanc vectors, c 2008 author(s) journal compil c 2008 eurograph associ blackwel publish ltd. 939 k. bidmon & s. grottel & f. bs & j. pleiss & t. ertl / abstract solvent pathlin point line segment control point, normalis scaled, depend length distanc vector weight correspond edges. smaller distanc is, larger scale fac- tor chosen, edg close affect edg larg distanc other. figur 7: abstract pathlines. upper figur show pathlines. middl figur show vertic pathlines, colour base detect cluster slower motion. posit conserv water correspond larger clusters. lower figur show extract princip paths. final visualis path structure, shown figur 7, option contain sphere repres de- tect cluster spheres. normal tube bzier curv repres edg rendered. direct edg shown yellow blue colour gradient. graphic primit (sphere cylinder) creat point-bas gpu raycasting, optim vi- sual qualiti performance. basic techniqu shown [gum03,ke04]. abstract represen- tation element protein rendering, like stick, ball-and-stick spacefil representation. colour map pathlin perform fragment shader. exchang shader allow easili ex- chang map process. 5. result perform pathlin extract visualis method propos work appli studi interact water molecul protein tem -lactamase, plai major role antibiot resist gram- neg bacteria. main dataset evalu approach 50n md simul trajectori vari- ant protein surround approxim 25000 wa- ter molecules. special scientif focu li interplai water molecul part protein structure. novel approach identifi visualis sol- vent pathlin appli md trajectories, pathlin water molecul pass roi (the water-fil cavity) simul identi- fied. figur 8 show direct render pathlin select area confirm prior observ distinct exit (mark green) exist wa- ter molecul enter leav cavity. rout obviou open caviti (on right im- ages) visibl initi crystal structure. addit rout (on lower left images) pro- figur 8: 5n trajectori (5000 frames) compar 50n trajectori (50000 frames). shorter trajectori up- imag evalu manual exist tools. however, result gain short dataset judg care, interest valu depend fre- quenci water exchange. 50n trajectory, shown lower image, hand far clutter complex effici evalu exist tools. c 2008 author(s) journal compil c 2008 eurograph associ blackwel publish ltd. 940 k. bidmon & s. grottel & f. bs & j. pleiss & t. ertl / abstract solvent pathlin ceed dynam form open middl loop evid initi crystal structure. direct render pathlin statisti- cal output preprocessor evid fewer water molecul follow route. gain better understand- ing flow insid caviti abstract represent needed. detect cluster posit (middl imag fig. 7) mark region slower motion. sequenc tube repres princip path faster motion. figur 7 show abstract visualis repres real distribut pathlin well, structur tube observ imag show pathlines. visualis cluster slower motion agre posit conserv water bridg detect previou analysis, confirm chosen cluster approach. tube repres main path faster motion cluster help follow comprehend movement water molecul conserv posit insid cavity. individu path shown, princip structur motion solvent repres allow interpre- tation data (fig. 7 9). evid straight rout water molecul enter cavity, water molecul quickli ex- chang rel long stai conserv wa- ter bridg positions. interest fact sol- figur 9: structur extract solvent paths. upper imag show water molecul pathlines. lower imag show extract main solvent paths. time frame map colour gradient yellow (start trajec- tory) blue (end trajectory). vent molecul motion insid caviti structur compar chaotic motion bulk solvent area. ran perform test intel core2 duo 6600 processor nvidia geforc 8800 gtx graphic card. viewport size fullscreen (1600 1200, reduc small area gui controls). cartoon render- ing protein us geometri shader element render point-bas gpu raycast glyph mention sec. 4.2. result optim vi- sual qualiti high render performance. tabl 1 show render perform interact rates, larg viewport. perform calcula- tion pathlin cluster need 3 second consid interactive. preprocess- ing dataset need 4 minut extract pathlin roi addit 2 5 minut ex- tend pathlin describ sec. 3.2. protein solvent fp visualis visualis (max. - min.) stick pathlin 89 - 63 cartoon pathlin 55 - 42 stick princip path 365 - 317 cartoon princip path 182 - 175 tabl 1: perform differ render style pro- tein solvent. rang fp valu result dif- ferent filter paramet result differ number pathlin princip motion structur solvent. 6. conclus present approach visual analys solvent molecul pathlin abstract level, support long trajectori ten thousand time frames. fast cluster algorithm appli extract princip structur solvent transport. differ level abstract provid facilit explor solvent-protein-interact level detail. cluster observ abstract represent solvent pathlin roi confirm posit conserv water approach addition- alli inform dynam behaviour solvent molecul provided. thus, abl substanti conjectur base previou observ particular sol- vent molecul solvent-protein interactions. 7. acknowledg work partial fund deutsch forschungsge- meinschaft (dfg) collabor research centr sfb 716 prioriti programm spp 1170. c 2008 author(s) journal compil c 2008 eurograph associ blackwel publish ltd. 941 k. bidmon & s. grottel & f. bs & j. pleiss & t. ertl / abstract solvent pathlin refer [bdst04] bajaj c., djeu p., siddavanah v., thane a.: texmol: interact visual explor larg flexibl multi-compon molecular complexes. vi 04: proceed confer visual 04 (2004), pp. 243250. [bvg02] bakowi d., van gunsteren w. f.: water protein cavities: procedur identifi intern wa- ter exchang pathwai applic fatti acid- bind protein. protein 47, 4 (jun 2002), 534545. [bwt06] bottom c. a., white t. a., tanner j. j.: explor structur conserv solvent site protein families. protein 64, 2 (2006), 404421. [ccd05] case d., cheatham t., darden t., gohlk h., luo r., k.m. merz, jr., onufriev a., simmerl c., wang b., wood r.: amber biomolecular simul programs. journal computa- tional chemistri 26 (2005), 1668 1688. [con83] connolli m. l.: analyt molecular sur- face calculation. journal appli crystallographi 16, 5 (1983), 548558. [del02] delano w.: pymol: open-sourc molecular graphic tool. ccp4 newslett protein crystallogra- phy 40 (2002). [gh00] garca a. e., hummer g.: water penetr escap proteins. protein 38, 3 (2000), 261272. [gum03] gumhold s.: splat illumin ellipsoid depth correction. workshop vision, modelling, visual vmv 03 (2003), pp. 245252. [hds96] humphrei w., dalk a., schul- k.: vmd visual molecular dynamics. journal molecular graphic 14 (1996), 3338. [hel07] helm v.: protein dynam tightli con- nect dynam surround intern water molecules. chemphyschem 8 (2007), 2333. [hm02] henchman r. h., mccammon j. a.: extract- ing hydrat site protein explicit water simulations. j comput chem 23, 9 (jul 2002), 861869. [hof05] halm a., offen l., fellner d.: bio- browser: framework fast protein visualization. proceed eurograph - ieee vgtc symposium visual 2005 (2005). [ke04] klein t., ertl t.: illustr magnet field line discret particl model. workshop vision, modelling, visual vmv 04 (2004), pp. 387394. [lvrh07] lamp o. d., viola i., reuter n., hauser h.: two-level approach effici visualiza- tion protein dynamics. ieee transact visual- izat graphic 13, 6 (nov./dec. 2007), 16161623. [mb04] mustata g., brigg j. m.: cluster analysi water molecul alanin racemas put structur role. protein eng 17, 3 (2004), 223234. [nak04] nakasako m.: water-protein interact high-resolut protein crystallography. philo tran r soc lond b biol sci 359, 1448 (2004), 11911204. [olw91] ot g., liepinsh e., wthrich k.: protein hydrat aqueou solution. scienc 254, 5034 (nov 1991), 974980. [pgh04] pettersen e., goddard t., huang c., couch g., greenblatt d., meng e., ferrin t.: ucsf chimera - visual exploratori research analysis. journal comput chem- istri 25, 13 (2004), 16051612. [pkko07] petrek m., kosinov p., koca j., otyepka m.: mole: voronoi diagram-bas explor molecular channels, pores, tunnels. structur 15, 11 (nov 2007), 13571363. [pma98] pettitt b. m., makarov v. a., andrew b. k.: protein hydrat density: theory, simul crystallography. curr opin struct biol 8, 2 (apr 1998), 218221. [ps06] prabhu n., sharp k.: protein-solv interac- tions. chem rev 106 (2006), 16161623. [rc91] ruplei j. a., careri g.: protein hydrat function. adv protein chem 41 (1991), 37172. [ric77] richard f.: areas, volumes, pack pro- tein structure. annual review biophys bioengi- neer 6 (1977). [san04] sanjeev b.: ankush. indian institut sci- ence., 2004. [sebh02] schmidt-ehrenberg j., baum d., hege h.-c.: visual dynam molecular conformations. vi 02: proceed confer visualiza- tion02 (2002), pp. 235242. [tcm06] tarini m., cignoni p., montani c.: am- bient occlus edg cue enhanc real time molecular visualization. ieee transact visualiza- tion graphic 12, 5 (2006), 12371244. [tvw99] telea a., van wijk j. j.: simplifi repre- sentat vector fields. vi 99: proceed confer visual 99 (1999), ieee societi press, pp. 3542. [vbw94] varshnei a., brooks, jr. f. p., wright w. v.: linearli scalabl comput smooth molecu- lar surfaces. ieee graphic applic 14, 5 (1994), 1925. [wps07] weisel m., proschak e., schneider g.: pocketpicker: analysi ligand binding-sit shape descriptors. chem cent j 1 (2007), 7. c 2008 author(s) journal compil c 2008 eurograph associ blackwel publish ltd. 942