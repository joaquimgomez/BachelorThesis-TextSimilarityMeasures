sens predict puls citi share bicycl abstract city-wid urban infrastructur increasingli reliant network technolog improv ex- pand services. effect digitali- zation, larg amount data sens analyz uncov pattern human behavior. paper, focu digit footprint type emerg urban infrastructure: share bicycl systems. provid spatiotempor analysi 13 week bicycl station usag barcelona' share bicycl system, call bicing. appli cluster techniqu identifi share behavior station behavior relat location, neighborhood, time day. compar experiment result predict model near-term station usage. finally, analyz impact factor time dai station activ predict capabl algorithms. 1 introduct observ model human movement urban environ central traffic forecasting, understand spread biolog viruses, design location-bas services, improv urban infrastructure. however, littl chang whyte (1980) observ "street life project" actual usag new york' street squar clash origin idea architect citi planners. kei difficulti face urban planners, virologists, social scientist obtain large, real- world observ data human movement challeng costli (brockman et al., 2006). websit evolv offer geo-loc services, new sourc real-world behavior data begun emerge. example, rattenburi et al. (2007) girardin et al. (2008) geo-tag pattern photograph flickr automat detect interest real-world event draw conclus flow tourist city. addition, city-wid urban infrastructur buses, subways, public utilities, road digitized, sourc real-world dataset implicitli sens emerging. ratti et al. (2006) gonzlez et al. (2008) cellular network data studi citi dynam human mobility. mcnamara et al. (2008) data collect rfid-en subwai predict co-loc pattern mass transit users. sourc data ever-expand offer large, under- explor dataset physically-bas interact real world. paper, introduc novel sourc real-world human behavior data new type urban infra- structure: share bicycl systems. station usag data barcelona bice (figur 1) infer cultur geograph aspect citi predict futur bicycl station usag behavior, correspond human movement city. particular, main contribut paper are: (1) demonstr potenti share bicycl data sourc gain insight citi dynam aggreg human behavior; (2) explor relationship spatiotempor pattern bicycl usag underli citi behavior geography; (3) studi pattern bicycl station usage, includ predict usag pattern analysi factor time dai affect prediction. analysis, emphas bicycl station usag data sens predict puls citi share bicycl jon froehlich 1 , joachim neumann 2 , nuria oliv 2 1 scienc engin univers washington 2 telefonica research, barcelona, spain {joachim, figur 1. (top) bice station; close-up bicycl park slot; user station kiosk rfid check-out bicycle; (bottom) 390 bice station distribut citi barcelona, spain. reveal share bicycl patterns, pattern reflect cultur spatial layout city. believ work direct implic design oper futur share bicycl system (e.g., precis load balanc station dimensioning, improv onlin servic bice users), urban plan (e.g., blueprint new bicycl path roads), traffic forecast (e.g., understand peopl city), social scienc (e.g., studi peopl city, latour, 2007) develop novel context-bas mobil services. addition, expect similar type analys appli sourc urban digit traces, provid subwai (e.g., london oyster), buse (e.g., seattl orca program), park manag (e.g., san francisco sfpark), cellular network (gonzlez et al., 2008). work emphas increas role machin learn (ml) pattern recognit techniqu plai assist aforement field analyz trace human behavior. 2 bice dataset commun share bicycl program offer environ- mental friendly, healthy, inexpens altern automobil transportation. recent technolog advanc led gener share bicycl real-tim usag data collected, archived, analyzed. currently, program world includ smartbikedc washington d.c. vlib paris, 20,000 bicycl 1,450 station (approxim 1 station 300 meters). barcelona share bicycl program, bicing, launch march 2007. current 390 station 6,000 bicycl 150,000 yearli subscribers. bicycl check swipe rfid membership card bice station kiosk (figur 1), unlock bicycl displai rack locat lcd screen. check-out inform upload web server provid real-tim inform number avail bicycl vacant slot station. check- provid 30 min free ride time, 30 min cost 0.30 hours. bicycl return station, place auto- lock rack. warnings, monetari penalti (3/hr), eventu suspens membership possibl user consist return bicycl hour limit. bice open 5am 12am sundai thursdai 24 hour weekend. bice websit report statu bicycl station googl map visual 1 . scrape webpag minut extract data element station: station geo-location, number avail bicycl number vacant park slots. dataset contain 13 week contigu observ aug. 27, 2008 dec.1, 2008. total, collect 26.1 million observ 390 stations. 1 paper, focu primarili weekdai data (mondai friday, exclud holidays), weekdai typic correspond regular share bicycl usag patterns. 2.1 definit notat subsection, defin terms, notat intermediari process analysis. station size: station size directli report bice website, calcul sum avail bicycl bt free park slot st time t station. note sum fluctuat time, like com- binat temporarili broken bicycl park slots, station growth bice evolves, and/or station report invalid number serviced. consequently, infer station size 95 th percentil observ bt+st valu specifi time window station. averag infer station size 25.2 slots. observ normalization: station rang size 15 36 slots. therefore, station data normal divid observ infer station size. particular, analys present paper carri normal avail bicycl (nab), specifi otherwise. note nab analog station percentag full. dayview: dayview calcul averag station data match certain criteria 24 hour window, discret five-minut bin (288 bins/day). exam- ple, station nab weekdai dayview creat comput station averag nab valu 288 bin weekdai 13-week observ period. exampl weekdai weekend dayview shown figur 2 singl station. activ event score: activ score (as) measur activ station given time: as(t)=|bt -bt-1|, bt number bicycl time t. event score (es) binari version as: es(t)=1 as(t)>0, es(t)=0. typic comput averag activ (asavg) event score (esavg) specifi period time measur station activity. distanc metric: order comput distanc be- tween dayview singl dai data station dayview, us dynam time warp (dtw) base metric one-hour sakoe-chiba band (sakoe, 1978). dtw prefer euclidean- distanc measur interest compar overal tempor pattern want allow hour tempor shift data. 2.2 data cleans data scrape bice websit noisi result temporari station closures, technic issu station caus mainten work, internet connect failures, server-sid sql time-outs, broken bicycl park slots. emploi step process detect elimin faulti observations. data cleans critic ensur data train predict model valid. observ removal. elimin approxim 10% 26.1 million individu observ collect bice websit to: (a) fluctuat bt + st ; (b) unattain values, bt + st exceed station size; (c) unusu low station activity, es < 0.1* esavg hour slide time window. dai removal. elimin 13.7% observ dai because: (a) observ dai (less 70% 720 possibl observations/day); (b) dai exhibit extrem anomal behavior, i.e., dtw distanc dai station dayview larger standard deviat station averag dtw distanc comput days. station removal. finally, remov station 30 weekdai (out total 64) good data, accord previous describ criteria. step reduc number station 390 370 (5.1%). end process, total 20.2 million observa- tion remained, depict tabl 1. 3 tempor spatiotempor pattern explor predict individu station usage, discuss tempor spatiotempor pattern highlight pattern reflect underli cultur spatial characterist barcelona. 3.1 tempor pattern figur 3 compar dayview normal weekdai weekend activ score (as) stations. shade background figur 3 plot standard deviat score bin. figur 4 show total number bicycl checked-out station week, aver- ag 13-week observ period. figur reveal repeat three-prong spike station activ weekday, correspond morning, lunch, even commutes. lunch spike, appear days, occur 2pm, reflect late lunch cultur spain. expect, morn commut absent weekend days, result two-prong spike. fridai activ weekday, like reduc work hour offic barcelona, mondai active, congest vehicl traffic day. fact peopl tend us bice work week reflect result onlin survei 2 conduct earlier year 212 respondents, 75% bice user state commut motiv sign membership. 3.2 spatiotempor pattern spatial layout citi obviou influenc movement pattern social behavior therein. bar- celona mixtur residential, commercial, recrea- tional area connect narrow streets, one-wai avenu multitud public transport option topograph features. investig bice usag pattern share station geograph distribut city, hierarch cluster techniqu call dendrogram cluster (duda, 2000) station dayviews. built set clusters: base weekdai activ score dayview (activ clusters, figur 5) weekdai avail bicycl dayview (bicycl clusters, figur 6). cases, normal weekdai dayview represent creat station similar matrix construct store dtw distanc cluster. cluster algorithm began 390 cluster (one station). cluster-to- cluster similar calcul averag dtw distanc weekdai dayview station cluster. cluster iteration, similar cluster group together. cluster termin averag intercluster-to-intraclust distanc maxim weight appli decreas total number clusters. note cluster algorithm knowledg station geo- location. figur 5 6 (top) illustr cluster result geo-visu barcelona neighbor station gener share similar usag patterns. node repres station locat color accord cluster membership. line graph shown figur 5 6 (bottom) creat averag normal activity/bicycl data station clusters. shade line depict standard deviat station 288 dayview bins. line color consist cluster color map visualization. 2 0 0.01 0.02 0.03 0.04 0.05 0 4 8 12 16 20 n o rm . ct iv y s time dai (hrs) avg activ weekdai weekend 0 0.2 0.4 0.6 0.8 1 0 4 8 12 16 20 n o rm v il b ik e s (n b ) time dai (hrs) station 37: avg avail bike weekdai weekend raw dataset clean dataset station 390 370 dai 25k 22.7k observ 26.1m 20.2m park slot 9831 9315 0 540 1080 1620 2160 2700 # o f c h e ck e d -o u t b ic y cl e s time week num checked-out bicycl tabl 1. size raw clean dataset figur 2. normal weekdai weekend dayview avail bicycl station 37. figur 3. normal weekdai weekend dayview activ score stations. figur 4. total number bicycl checked-out station week. mon tue wed thu fri sat sun activ clusters. cluster algorithm return activ cluster (figur 5), similar three- prong spike shape (see figur 3). cluster gener- alli activ (from a1 a5) move outward edg citi downtown. activ cluster, cluster a1 (n=207), surround nearli entir perimet barcelona. activ cluster (a3, a4, a5) notic activ dai ad- vances. bicycl clusters. algorithm identifi bicycl cluster (depict figur 6) class behavior: outgo (cluster b3 b4), incom (cluster b5 b6) flat (cluster b1 b2). outgo cluster precipit drop avail bi- cycl 7-8am peopl leav work, slight rise 2-3pm lunch return earli morn level 10-11pm. station spread edg downtown midtown section city. incom station locat high densiti commerci area major arteri routes: rambla catalunya avinguda diagonal. incom station shape nearli invers outgo stations: peopl be- gin arriv 7-8am begin leav 1-2pm. financi busi barcelona open 9am close 2:30pm, align tempor pattern clusters. finally, cluster b1 b2 rel flat usag patterns. cluster b2 tend high degre avail bicycl (on average, 66% full) cluster b1 opposit (15% availability). reason discrep like barcelona topography: citi built long incline. station locat figur 6 80-110 meter sea level versu bottom, 0-10 meter sea level. peopl tend bicycl higher altitudes, leav station cluster b1 starv bicycles. 4 station behavior predict focu predict station usage. particular, interest predict number avail bicycl station given time fu- ture. work relat traffic forecasting. approach traffic engin reli flow theori incorpor queue-theoret model (vandael et al., 2000). horvitz et al. (2005) took altern approach close relat ours: successfulli model kei traffic bottleneck area bayesian network ignor underli flows. similarly, attempt model individu bicycl movement citi focu model bice station usag directly. predict station usag model (a) allow accur load balanc stations; (b) assist urban planner citi offici provid inform expect activ city; (c) open wai new mobil servic bice users. previous mention onlin survey, bice user identifi find avail bicycl park slot import problem bice experi (76% 66% respondents, respectively). therefore, interest predict probabl find free bicycl slot station given time future. furthermore, model shed light factor influenc predict station usag behavior. 4.1 model station behavior implement simpl predict models, includ bayesian network (bn) predict avail bicycl station. model input parameters: (1) current time 0; (2) 0 0.02 0.04 0.06 0.08 0 4 8 12 16 20 ct iv y s time dai (hrs) cluster a1 cluster a2 0 4 8 12 16 20 time dai (hrs) cluster a3 cluster a4 0 4 8 12 16 20 time dai (hrs) cluster a5 figur 5. activ cluster creat progress combin similar activ score station dayview dendrogram clustering. 0 4 8 12 16 20 time dai (hrs) cluster b5 cluster b6 0 4 8 12 16 20 time dai (hrs) cluster b3 cluster b4 0 0.2 0.4 0.6 0.8 1 0 4 8 12 16 20 n o rm b ik e s (n b ) time dai (hrs) cluster b1 cluster b2 figur 6. bicycl cluster creat progress combin similar avail bicycl dayview cluster dendrogram clustering. avail bicycl cluster activ score cluster known number bicycl time 0 (bt0); (3) predict window (pw) specifi far futur predict. paper, focu pw valu rang 10 min 120 min, correspond common bice usag scenario. model us histor data fourth input parameter: previou observ time 0. valu (lv). model predict current number avail bicycl remain constant measur valu 0 pw: (, 0 , ) = histor mean (hm). model dynam construct dayview base observ 0 , return valu correspond dayview time bin (0 + ). formally: let averag number bicycl time bin 0 dayview denot 0. hm predictor forecast number bicycl time 0 + : (, , ) = + words, predictor return averag number bicycl time bin 0 + . histor trend (ht). model build lv hm predictors. histor trend extract comput differ averag number bicycl 0 0 + , ad current number bicycles, 0: , , = + + bayesian network (bn). model consist simpl bn station observ (input) node hidden (output) node, observ node parent hidden output node (nave bayes), depict figur 7. node network are: (1) time, discret observ node 24 possibl valu correspond hour day; (2) bikes, valu nab time t, discret bins, valu correspond 0-20% bicycles, correspond 20-40%, etc; (3) pw, size predict window, possibl valu correspond 10, 20, 30, 60, 90 120 minut future; (4) delta, continu gaussian variabl contain chang number bike time t + pw respect valu time t. predict number bicycl ad valu delta node recent observation: , , = + delta dimension valu observ discret node effect accuraci bn. carri extens experi pilot station determin optim dimension dis- crete nodes. configur smallest pre- diction error stations. history-bas predictor week histor data, nov. 2, 2008 nov. 23, 2008 (see figur 10) build models. hm ht predictor correspond dayview built three-week period. bn train comput posterior paramet given fulli observ data time, bikes, pw delta, cover three-week period train data, minut increments. matlab bn toolkit kevin murphi 3 learn paramet bayesian network (learn_params) comput ml estim unobserv delta note (in toolbox label marginal_nod jtree_inf_engine). 4.2 predict evalu weekdai follow train data (i.e., nov. 24 nov. 28, 2008) evalu models. simul real-world conditions, remov unusu dai test data. start midnight nov 24 th , predict model fed current time (in minut increments), current number avail bicycles, previous mention pw values. pw, model return predict number avail bicycles. predict error comput absolut differ predict number bicycl ground truth observ time t0 + pw. error normal station size (thus, given nab units). completeness, compar result random predictor (rand), return random valu drawn uniform distribut zero station size. tabl 2 list predict error models, averag stations, dai valu pw. bn predictor smallest averag error 0.08 nab. station 25 slots, correspond averag error bicycl (8%). interestingly, hm predictor perform worst - exclud random model, impli station daili activ vari compar histor mean. highlight import give weight recent observations. full-empti station state prediction. perspect bice user managers, us measur accuraci predict station (i.e., relev want pick bicycle) station (i.e., want drop bicycle). cases, station state easili deriv number avail bicycl predict models. 3 figur 7. graph bn tabl 3 below, compar result classif error appli model pw=120min, challeng scenario. note analysi below, we: (1) exclud rand, hm lv models, perform poorli pw=120 min; (2) includ classif error addit binari classifi train predict station states: decis tree classifi (id3) support vector machin classifi (svm) dot product kernel. classifi train evalu observ triplet consist time dai (in minutes), percentag station (i.e. number 0% 100% specifi station respect capacity) state station (full/not full; empty/not empty) pw=120 min. note train classifi binari decision: full/not empty/not empty. method predict error station predict error station bn 13.3% 12.0% ht 13.7% 12.0% id3 13.3% 12.5% svm 14.7% 13.8% tabl 3. comparison error classifi pw=120 min. predict number bicycl ht bn model obtain predict station state. contrast, id3 svm classifi directli train evalu station state. interestingly, classifi list tabl 3 similar classif errors, despit differ input variabl optim differ cost function (gener vs. discrimin approaches). similar predict error indic lower bound station state predict ~12%. data addit sourc (e.g., weather, local event information, train schedules) need overcom barrier. 4.2 factor impact predict next, discuss factor impact predict station usage. predict window. averag predict error function pw shown figur 8. hm predictor result averag error 0.17 regardless pw. station usag perfectli consist weekdays, predictor perform flawlessly. lv predictor nearli best perform predictor pw <= 60 min. thus, small pw number avail bicycl t0 strong indic number avail bicycl t0 + pw. pw > 60 min, however, ht bn predictor begin perform significantli better rest: unpair t-test show differ predict error pw=120min signific predictors: t(1002229) = 34-158, p < 0.001 (bonferroni' adjust compar model applied). mobil bice user interest predict station vacanc like interest pw <= 60 min, lv, ht, bn model abl predict number avail bicycl singl bicycle. time day. figur 9 show accuraci predictor function time day. expected, predictor perform night, littl activity, accur day. predictor perform wors activ time day, bn resilient. histor data. station usag model requir previou observ build predictions. given model data driven, open question data need build accur models. figur 10 show averag predict error station (one bicycl cluster) pw=120min. observ used, lower predict error ht bn predictors. 15 weekdai train data, averag predict error plateaus, show 22% (ht) 26% (bn) improv predictor train singl day. note error hm predictor actual increas observations, corrobor intuit recent data weight higher. station clusters. better understand station usag pattern affect predictability, group predict result activ bicycl cluster present section 3. general, activ station difficult predict (figur 11). bn significantli bet- ter activ cluster predictors. flat cluster (b1 b2) result lowest overal predict error minim variat bicycl avail time (figur 12). signific differ incom outgo stations, probabl have similar, reversed, dynam behavior. model avg error stdev error rand 0.37 0.27 hm 0.17 0.16 lv 0.09 0.14 ht 0.09 0.13 bn 0.08 0.12 0.0 0.1 0.2 0.3 p d ic ti o n e rr o r (n b ) time dai (hours) predict error vs. time dai 0 0.1 0.2 p d ic ti o n e rr o r (n b ) predict window (min) predict error vs. pw 0.08 0.12 0.16 0.20 p d ic ti o n e rr o r [n b ] number train dai predict errror vs. train data 15 weekdai tabl 2. averag predict error model random predictor. figur 8. predict error function size predict window figur 9. predict error function time-of-dai two-hour predict window figur 10. predict error function dai train data station cluster pw=120 min figur 11. averag predict error broken activ cluster. note activ station higher predict errors. figur 12. averag predict error broken bicycl cluster. note bn error sensit type cluster. 5 conclus futur work urban infrastructur increasingli digitized, human behavior data ubiquitous. pattern recognit ml techniqu necessari sort analyz larg amount real-world behavior data produced. shown share bicycl station usag data reveal pattern bicycl usage, underli tempor spatial dynam city. shown fairli simpl predict model abl predict station usag averag error bicycl classifi station state (full, empty, in-between) 80% accuraci hour future. experi indic 10 15 weekdai histor data build station models. result present paper align intuit human behavior pattern barcelona, detail surprising. example, share tempor trend station usag allow infer attribut neighborhood (e.g., residenti vs. commercial, proxim downtown). station usag far regular initi suspected, reveal poor perform hm predictor. share bicycl station usag sourc human movement city, potenti uncov underli tempor spatial dynam city, shown paper. believ similar analys expand combin digit urban infrastructur roadways, buses, subways. future, like incorpor contextu featur bn, weather, season, special event (e.g., concert soccer matches), public transport schedul locations, data addit urban infrastructur (e.g., cellular networks). plan experi dynam bn continu dynam models. current work leverag predict result backend mobil web applic provid real-tim inform probabl find bicycl free park slot station. finally, log 18 addit share bicycl program includ pari washington d.c. plan large-scal analysi compar behavior pattern cities. acknowledg thank xavier anguera, mauro cherubini, leah findlater, jame fogarty, aaron hertzman, raphael hoffman, john krumm, rodrigo oliveira, shwetak patel, scott saponas, mike toomim help comment earli draft paper. work sponsor telefonica research jon froehlich microsoft research fellowship. refer [brockmann et al., 2006] brockmann, d. d., hufnagel, l. & geisel, t. (2006). scale law human travel. natur 439, pp. 462465 [duda et al., 2000] duda, r., hart, p., stork, d. (2000) pattern classif (2 nd edition). wiley, new york. [girardin et al., 2008] girardin, f., calabrese, f., dal fiore, f. , ratti, c., blat, j. (2008). digit footprinting: uncov tourist user-gener content. ieee pervas computing, 7(4) [gonzlez et al., 2008] gonzlez, m. c., hidalgo, c. a., barabsi, a. l. (2008). understand individu human mobil patterns. natur 453, pp. 779-782. [horvitz et al., 2005] horvitz, e., apacible, j., sarin, r. liao, l. prediction, expectation, surprise: methods, designs, studi deploi traffic forecast service. proceed. iui 05, juli 2005. [latour, 2007] latour, b. beware, imagin leav digit traces, column time higher educ supplement, 6th april 2007. thes-gb.doc [mcnamara et al., 2008] mcnamara, l., mascolo, c., & capra, l. media share base coloc predict urban transport. proceed. acm mobicom '08. san francisco, ca, sept. 14 - 19, 2008, pp. 58-69. [rattenburi et al., 2007] rattenbury, t., good, n., & naaman, m. automat extract event place semant flickr tags. proceed. acm sigir 07. amsterdam, juli 23-27, 2007, pp. 103-110. [ratti et al., 2006] ratti, c., pulselli, r. m., williams, s., & frenchman, d. (2006). mobil landscapes: locat data cell-phon urban analysis. environ & planning. 33(5), pp. 727748. [sako & chiba, 1978] sakoe, h. & chiba, s. (1978). dynam program algorithm optim spoken word recognition. ieee trans. acoustics, speech & sig proc, v. assp-26. pp. 43- 49. [vandael et al., 2000] vandaele, n., van woensel, t., & verbruggen, n. (2000). queuing-bas traffic flow model. transport research-d: transport environment, 5(2), pp. 121-135. [whyte, 1980] whyte, w. h. social life small urban spaces. washington, d.c.: conserv foundation, 1980. 0.0 0.1 0.2 0.3 a5 a4 a3 a2 a1 p d ic ti o n e rr o r (n b ) activ cluster predict error vs. activ cluster lastvalu histmean histtrend bayesian 0.0 0.1 0.2 0.3 b6 b5 b4 b3 b2 b1 p d ic ti o n e rr o r (n b ) avail bicycl cluster predict error vs. avail bicycl cluster lastvalu histmean histtrend bayesian