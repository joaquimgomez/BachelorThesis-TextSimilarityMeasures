dynam cluster time seri data victhor s. sartrio instituto matemtica universidad feder rio janeiro rio janeiro, brazil thai c. o. fonseca departamento mtodo estatstico universidad feder rio janeiro rio janeiro, brazil abstract propos new method cluster multivari time-seri data base dynam linear models. usual time-seri cluster method obtain static membership parameters, propos allow time-seri dynam chang cluster membership time. context, mixtur model assum time seri flexibl dirichlet evolut mixtur weight allow smooth membership chang time. posterior estim predict obtain gibb sampling, effici method obtain point estim presented, base stochast expectation-maxim gradient descent. finally, ap- plicat illustr us propos model model univari multivari time-series: world bank indic renew energi consumpt eu nation famou gapmind dataset contain life-expect gdp capita countries. keyword time-seri cluster mixtur model dynam model 1 introduct cluster process group data differ sets, call clusters, heterogen other, member cluster rel similar themselves. approach identifi structur unlabel dataset increasingli popular exploratori analysi automat segment data points. historically, cluster techniqu concern static data. rise routin collect data, however, attent increasingli turn cluster time-vari obser- vations. number develop field past decad over- whelming, liao (2005) aghabozorgi et al. (2015) serv good summari signific publications. particular time-seri cluster hidden markov model (hmms). gener framework probabilist time-seri model reli abstract awai tempor de- pendenc unobserv state evolut follow markov property. idea cluster time-seri hmm initi present juang rabin (1985) signific impact field speech recognit (juang rabiner, 1991), protein model (krogh et al., 1994), genet (schliep et al., 2003), others. cluster time-seri data span long window time, however, inappropri assum singl observ follow behavior cluster period. consid figur 1 illustr exampl behavior look like. page 1 ar x iv :2 00 2. 01 89 0v 1 [ st .a p ] 2 8 ja n 20 20 dynam cluster time seri data figur 1: illustr exampl time-seri spread cluster time-series, color orange, chang cluster membership halfwai time window. evidently, argu behaviour new, third, cluster. however, observ unit start present behavior differ time-points, requir big number cluster member captur changes, which, way, goe purpos clustering. model succesfulli acommod behavior, need account possibl time-seri chang cluster membership time, littl work regard exist literature. particularli relev public approach. first, punzo maruotti (2016) propos markov chain dictat transit probabl cluster lon- gitudin observation. downsid approach: first, cluster membership chang abrupt; second, assum observ transit probabl strict. hand, maruotti vichi (2017) us hidden markov structur propos model take idea k-mean cluster (macqueen et al., 1967) adapt clus- ter centroid rule vector autoregress model. consider ideal approach longer time-seri data, cluster membership incorpor time-dependence, allow clear missclassif outlier observ shown appendix a. paper, present cluster time-seri base dynam linear model (west harrison, 1996) particular class hmms. then, extend initi model account dynam mixtur coeffici assum evolut rule evolut dirichlet process (fonseca ferreira, 2017), allow cluster membership shift smoothli time. estim approach considered: markov chain mont carlo inference, consider higher comput cost allow probabilist infer posterior distributions, pontual estim method base stochast expect maxim gradient descent, provid result quickly, restrict analysi simpl point estim model parameters. accompani python librari name dynmix1 developed. 1acess pypi repositories. page 2 dynam cluster time seri data section 2, present model simpl mixtur dlms, pontual estim procedur prove us regular hmm applications, section 3 present extens dynam mixtur dlms,. section 4 showcas applic univari seri renew energi consumpt eu member states, multivari applic consid life expect gdp capta data european african countries. section 5 present final remarks. 2 mixtur dynam linear model consid observ n differ m-variat time seri t time instants, denot yi = (yi1, . . . ,yit ), = 1, . . . , n. let assum k differ clusters, index j = 1, . . . , k, behavior determin pj-variat time-vari state j = (j1, . . . ,jt ) cluster specif paramet j . finally, assum depend observ data, time differ observations, captur states. thus, consid follow observ model n condition independ observ f(yi|i,1, . . . ,k,1, . . . ,k) = k j=1 ij t t=1 fj(yit|t,jt,j) (1) = (i1, . . . , ik) cluster membership vector (or mixtur weights) i-th observ fj appropri observ probabl densiti function (p.d.f.) j-th cluster. assumpt made, consequ equat (1), specifi observ model gener time-seri cluster approach base hidden markov models, juang rabin (1985) proposed. proce choic dynam linear models, dlm short, serv specif framework hidden markov model model state clusters. dlm provid power conveni set tool flexibl model behaviours. particular, dlm state j observationsx1, . . . ,xt model equat xt = fjtjt + jt jt n(0m,vjt) jt = gjtj,t1 + (j) t (j) t n(0pj ,wjt) fj call observ matrix,gj call evolut matrix, vjt observ error covari matrix andwjt evolut error covari matrix. remaind paper, lighten notation, time index observ evo- lution matric drop explicitli assum time-varying. differ specif pair (fj ,gj) account interest properti data, differ form trend, season depend time-vari covariates. west harrison (1996) thorough overview dynam linear models. consid indirect model thewt discount factor model (harrison west, 1987). us discount factor turn essenti success propos page 3 dynam cluster time seri data allow maximum posteriori procedur defin dynam linear models. better detail section 2.2. summary, idea discount model impos (known) rate loss inform state time-step lead wt function paramet observations. strategi model evolut varianc commonli practice; lamon et al. (1998) lope carvalho (2007) interest examples. now, ad assumpt state cluster model dlm, cluster specif paramet j = {vj} observ equat (1) f(yi|i,1, . . . ,k,v1, . . . ,vk) = k j=1 ij t t=1 nm(yit;fjjt,vj) (2) np(;m,c) probabl densiti function p-variat normal distribut mean m covari matrix c. equat (2) fulli reflect observ model interest, estim concern us perform commonli model augment (tanner wong, 1987). particular, introduc dummi variabl zi observ pr(zi = j|i) = ij . this, observ equat simplifi f(yi|zi,1, . . . ,k,v1, . . . ,vk) = t t=1 nm(yit;fzizit,vzi). (3) model present assum number cluster k known, special focu impos meaning structur cluster dlm, work richardson green (1997) nobil fearnsid (2007) pave wai futur extens estim k. approach perform model comparison differ valu k, metric modifi bic propos fralei rafteri (2007). specifi model, estim model parameters, present options: fulli bayesian approach obtain sampl posterior dis- tribut markov chain mont carlo (mcmc) methods, maximum posteriori approach provid point estim effici manner expect maxim (em) algorithm. 2.1 gibb sampl mcmc estim approach model easi thank depend struc- ture, lead condit independences, thank analyt tractabl dynam linear models. gibb algorithm (geman geman, 1987) involv separ random variabl differ block sampl condit distribut block, time, iteration. result stochast process guarante converg joint posterior distribu- tion random variabl interest. page 4 dynam cluster time seri data firstly, assum dirichlet(c0) prior, condit distribut given inform easili i| dirichlet(c0 + ezi) c0 come prior ej j-th canon vector rk. then, obtain condit distribut zi, given p (zi = j|i,1, . . . ,k,v1, . . . ,vk,yi) = ij t t=1nm(yit;fjjt,vj)k l=1 il t t=1nm(yit;fllt,vl) (4) which, intuit simpl obtain algebrically, lead comput problem arris underflow, special higher valu t . strategi deal problem is, i, evalu nm(yit;fjjt,vj), j t, obtain mean order magnitud oij = 1 t t t=1 log10nm(yit;fjjt,vj) clusters. then, defin new quantiti oi = maxj=1,...,k oj . given value, comput express p (zi = j|i,1, . . . ,k,v1, . . . ,vk,yi) = ij t t=1 10 oinm(yit;fjjt,vj)k l=1 il t t=1 10 oinm(yit;fllt,vl) , (5) obvious lead mathemat result avoid underflow keep term product relev cluster 1. condit z1, . . . , zn, let ij = {i : zi = j} set observ index belong j-th cluster nj number element set. m observ dimens gener state compon associ behaviour, e.g. level. discount factors, systemat correl dimens captur states, reason assum independ observ discrep mean time-point independ other. such, assum paper vj diagonal, vj = diag( 1 j1 , . . . , 1 jm). thus, condit distribut element jl| gamma njt 2 , iij t t=1 ( (fjtj)l yitl )2 2 (fjtj)l denot l-th element result vector product fjtj . note desir consid observ correlations, condit distribut vj hold analyt form invers wishart distribution. states, cluster j specif involv m-variat observ pj-variat state dimension. however, given ij , know nj replic m-variat observation. equival consid njm-variat observ vector y (j) t time instant, y (j) t vertic concaten nj vector yi, ij . then, creat new observ page 5 dynam cluster time seri data matrix vertic tile nj replic origin matrix fj new observ error covari matrix given inj vj n n ident matrix denot kroneck product. then, proce perform usual forward filter backward sampl dynam linear model quantiti cluster l, thus, obtain sampl condit distribut j . 2.2 expect maxim obtain point estim finit mixtur model common applic expectation- maxim algorithm (dempster et al., 1977) converg properti comput efficiency. consid y1, . . . ,yn z1, . . . , zn observations, log-likelihood function l(|y1, . . . ,yn, z1, . . . , zn) = n i=1 k j=1 (zi j) (ln ij + lnnm(yit;fjjt,vj)) + n j=1 t t=2 lnnpj (jt;gj,t1,wjt) (6) () dirac delta function. appli e-step, expect valu log-likelihood (6), respect complet condit distribut zi, obtain q(|y1, . . . ,yn) = n i=1 k j=1 ij (ln ij + lnnm(yit;fjjt,vj)) + n j=1 t t=2 lnnpj (jt;gj,t1,wjt) (7) ij equal exactli equat (4), evalu paramet valu comput previou iter algorithm. note have form, present numer problem equat (4); thus, care taken. then, m-step revolv maxim function (7). given function (7) present linearli independ terms, break optim step seper blocks. firstly, maxim linearli independ else, express form k j=1 ij ln ij optimum is, unsurprisingly, exactli ij = ij . optim paramet cluster perform independ paramet clusters, express form n i=1 ij lnnm(yit;fjjt,vj) + t t=2 lnnpj (jt;gj,t1,wjt) (8) weight log-likelihood usual dynam linear model. page 6 dynam cluster time seri data time note us discount factor import model. essenti log-likelihood dlm weight type errors: 1. observ error, given term (8) weight precis term v 1j , and; 2. evolut error, given second term (8), weight precis termsw1j . far maximum likelihood (or maximum posteriori) estim concerned, assum con- stantwj function lead diverg optim problem. essentially, optimum minim error throw respect varianc near zero set varianc high value, tend infinity. concretely, l overfit data estim vj go zero, l go overfit evolut equat estim ofwj go zero. discount factors, wjt function valu vj wai guar- ante certain level smooth evolut j , level smooth dictat discount factor itself. imposit relation, optimum longer li previous detail edg cases, us estim obtained. need, however, abl optim weight dlm. this, us coordin descent (wright, 2015) optim individu dlm. allow iter optim j given vj vj given j . us abl obtain analyt solut steps, consequ run effici usual gradient descent approach, example. optim j given vj tile observ mention before, consid observ yt vertic concaten yit consid observa- tional matrix vertic tile n replic origin fj . differ observ error covari matrix given i(j)vj where, instead ident matrix use, i(j) = diag(11j , . . . , 1 nj ). form observ covari matrix take account weight observ inflat varianc entri low weights. then, instead run standard forward filter backward sampl procud perform forward filter backward steps, instead obtain sampl obtain modes. weight observ exceedingli small certain cluster, matrix i(j) numer unstable. avoid this, recommend set small valu w discard observ weight lower estim step. avoid numer instabl and, remov observ small weights, result valu significantli affect regardless inclusion. optim vj given j reduc classic weight estim varianc normal observations. conclusion, e-step direct m-step analytical, effici subpro- cedur optim j vj cluster. all, quick theoret robust wai obtain point estim model paramet states. page 7 dynam cluster time seri data 2.3 algorithm initi expect maxim gibb sampl algorithm iter requir initi start valu parameters. method proven theoret properti indic initi valu small importance2, smart initi avoid compu- tation problem speed convergence. here, propos algorithm combin clever idea smyth (1997) pick individu time- seri initi cluster, reduc consider comput cost introduc robust method k-means++ algorithm (arthur vassilvitskii, 2007) select candidates. k-means++ algorithm tradition initi paramet lie space observations, case m-dimension observation, arbitrari pj-dimens space j = 1, . . . , k clusters. work follows: first, observ randomli (and uniformly) chosen centroid. then, new centroid chosen randomli probabl proport distanc candid exist centroids. k centroid found. common impress algorithm tendenc place initi centroid outlier observations. practice, outlier highest distanc points, like individu point chosen, region lot point moder distant exist centroid present higher probabl picked. way, specifi valu k high, probabl new centroid chosen differ cluster. detail properti discuss method, refer origin paper. import differ model origin context algorithm propos that, unlik k-mean case order cluster irrelevant, model relev specif pair (fj ,gj) differ other. consider, example, well-defin clusters: seri random walk behaviour seri linear trend behaviour. desir observ seri linear trend initi linear growth model, observ seri random walk behaviour initi random walk models. propos smyth (1997) tackl exatcli problem. revolv estim k model n observations, pick highest likelihood observ initi k clusters. combin approach follows: separ k differ dlm model l k differ sets, dlm set present exact pair (fj ,gj). exampl set clusters: random walk set linear growth set. then, perform k-means++ algorithm pick k obsev initi repres k clusters. then, estim l differ model k observations, 2true em algorithm unimod likelihood abl arriv local maxima. page 8 dynam cluster time seri data reduc number model estim k n k k, remov redund estim equival models, i.e. model specif (fj ,gj), multipl times, reduc number model estim l k. estim singl dlm observ follow computation effici gra- dient descent procedur detail previously, given initi valu cluster, initi ij perform appli equat (5) ij terms. 2.4 label switch problem perform mcmc sampl work mixtur model lead problem re- gard identifi order clusters. diebolt robert (1994) frhwirth- schnatter (2001) detail explanations. model, mentioned, dlm pair (fj ,gj) observ inform ideal order. thus, simpl order restrict like detail frhwirth-schnatt (2001) need imposed. time-seri have, example, exact overal mean differ shapes; consider, example, seri figur 2. assum theyr mean cluster bigger model problem. tri specifi order cluster overal mean, differ behaviour differ other. practic solut prove successful impos order restrict refer singl time instant. exampl pictur figur 2, simpli impos order at, say, t = 0. theoret construct exampl singl time instant t k cluster present differ level, proven success strategi practice. figur 2: exampl time-seri overal mean wildli differ shapes. 3 dynam mixtur dynam linear model time window observ long, inappropri assum obser- vation remain cluster it. altern allow observ shift page 9 dynam cluster time seri data cluster membership time. far observ model concern modif simple; simpli add time index cluster membership paramet equat equat (2) f(yi|i,1, . . . ,k,v1, . . . ,vk) = k j=1 t t=1 itjnm(yit;fjjt,vj), dummi variabl time-index zi = (zi1, . . . , zit ), where, analogously, pr(zit = j|it) = itj . thus, equat (3) f(yi|zi,1, . . . ,k,v1, . . . ,vk) = t t=1 nm(yit;fzitzitt,vzit). (9) this, itself, complet valid model estim trivial small extens methodolog specifi previou section. matter fact, exist spe- cific pair (fj ,gj) that, appli cluster, result model equival maruotti vichi (2017). this, propos gener allow cluster possibl differ dlm. however, time-depend includ i,t1, essenti independ cluster time-point, lead undesir effect have observ wildli switch cluster membership singl outlier observations3. avoid problem includ tempor depend weight assum dirichlet evolut model, propos fonseca ferreira (2017), determin evolut behavior it. noe consequ p (zit|it) = itj ezit |it multinomial(1,it). consid vector latent observ dirichlet evolution, fonseca ferreira (2017) follow results. definit 1 (evolut dirichlet process). let = (it1, . . . , itk) it1, . . . , itk independ itj beta(ici,t1,j , (1 i)ci,t1,j), (0, 1] discount factor ci,t1,j > 0, j = 1, . . . , k. let sit = ti,t1 let denot entrywis product. then, evolut dirichlet process defin = 1 sit i,t1. (10) valu determin volatil cluster membership i-th observ time. specifically, 0, consid tempor dependence, 1, consid static mixtur previou section. obvious li valu unit interval. let di0 prior inform i0 dit = {di,t1, ezit} t > 0. theorem 1 (edp forward filter). assum prior distribut process form i0|di0 dirichlet(ci0), consid ezit |it multinomial(1,it) edp given (10). then, 3again, exampl shown applic page 10 dynam cluster time seri data t = 1, . . . , t , given i,t1|i,di,t1 dirichlet(ci,t1), prior distribut it|i,di,t1 dirichlet(ici,t1) posterior distribut it|i,dit dirichlet(cit) cit = ci,t1 +ezit . follow theorem 1 thate[it|i,di,t1] = e[i,t1|i,di,t1]. hence, import note edp impli local constant model. theorem 2. (edp backward sampler) sampl f(i1, . . . ,it |i,dit ) re- cursiv comput filter distribut it|i,dit dirichlet(cit) given theorem 1 sampl |i,dit dirichlet(cit ) directly. then, t t 2, recurs sampl i,t1 given {i,dit ,it, sit} follows: sampl sit given {dit ,it, i} follow abeta(i1kci,t1, (1i)1 kci,t1), sampl u fromdirichlet((1i)ci,t1), set i,t1 = sitit + (1 sit)u. note high dimension time-series, paramet etai k-variat series, trajectori time serv us summari indic seri membership cluster thorough time, regardless high m is. 3.1 gibb sampl firstly, sampl process = {i1, . . . ,it } = 1, . . . , n, given parameters, particularli dummi observ zit, easili perform forward filter backward sampl given theorem 1 2, respectively. sampl dummi variabl zit similarli wai previou section, weight comput time-inst time, remov numer problem larg product small values. specifically, equat (4) p (zit = j|it,1, . . . ,k,v1, . . . ,vk,yi) = itjnm(yit;fjjt,vj)k l=1 itlnm(yit;fllt,vl) . sampl dlm specif paramet similar way. differ instead cluster have fix number replic nj , differ number replic njt time point. trivial solv perform tile techniqu f v time instant. parameter, determin volatil evolut weight singl observ unit i, control observ unit switch clusters, model simpli initialized. far model concerned, margin likelihood given dummi variabl zi,1:t , given p(zi,1:t |di,0, i) = t t=1 t1i ci,0,zit + t2 l=0 l i(zi,t1l zi,t) t1i k j=1 ci,0,j + 1t1i 1i . function domain unit interval, sampl import resampl approach gener condit distribution, uniform distribution, example, proposal. page 11 dynam cluster time seri data 3.2 point estim expectation-maxim algorithm properti effect remov dummi vari- abl optim expect step, substitut expect value. us static model, properti valuabl dynam case big advantag evolut dirichlet process analyt forward filter backward sampl procedure, reli presenc latent observations. specifically, given dummi variables, instead foward filter backward sampl perform aforement maxim procedure: perform usual forward filter follow theorem 1 and, theorem 2, instead sampl given distributions, simpli obtain mode backward fashion. inclus non-continu variabl directli maxim procedure, however, unfeasiable. optim continu space simpler efficient. solv this, us stochast expectation-maxim algorithm (nielsen et al., 2000). es- sentially, step maxim weights, margin dummi variabl mont carlo approach condit distribut normal us perform expecta- tion step tradit em application. guarante exist discret valu operation perform ffbs, but, time, remov necess directli includ estim procedure. far cluster specif estimation, perform weight dlm optimization, time-inst differ observ error covari matrix membership weight chang time. iter algorithm implement follows, describ arbitrari iter step: 1. i: (a) simul m differ {zi1, . . . ,zit} condit distribut evalu iter parameters. (b) mean m differ result mont carlo estim result maxim weight margin dummi variables. 2. j, perform direct maxim weight dlm coordin descent. wish perform joint estim , step 1.(a), function present (3.1) easili optimized, example, grid method. 3.3 initi initi method philosophi previou section. first, initi dlm state precis follow exact approach. then, initi weight given initi cluster parameters, set itj = nm(yit;fjjt,vj)k l=1nm(yit;fllt,vl) . page 12 dynam cluster time seri data bayesian estim evolut dirichlet evolut discount factor per- form mention fonseca ferreira (2017), intuit algorithm initi them. basic idea involv quickli estim dynam mixtur model, consid time-depend weights, computation fast do. results, easi check comput weight time-seri like chang clusters. is, set moder valu time-series, independ weight model, gener stai cluster, set valu close 1. 4 applic applic present illustr model perform real dataset univari multivari time-series. firstly, univari example, world bank indic usag renew energi eu countri considered. second example, popular gap- minder dataset used, provid life-expect gdp capta countries, european african on select better illustr dynam cluster membership certain nations. 4.1 renew energi consumpt eu big topic discuss european comiss (ec) relat usag renew energi member states. import topic gain sustain technolog advanc result invest renew energi sources, present strateg econom benefit reli import natur ga oil. 2017, 55.1% gross avail energi resourc eu came import sourc (european comission, 2019). such, 2004 eu direct electr product renew energi sourc (2001/77/ec), popularli known re directive, came effect, set nation target renew energi pro- duction individu member states, set target 2010 2020. 2009, re direct supersed ongo renew energi direct (2009/28/ec), set extens targets, aim 2020, 20% total energi consumpt eu come renew resources. direct oblig countri present, 2010, nation renew energi action plan, explain countri road map achiev goal. 2015, eu- ropean comiss publish track achiev direct goal (european comission, 2015). world bank publish indic nations, includ on european union, renew energi consumpt percentag countri total final energi consumpt (the world bank, 2019). data avail eu countri 1990 2015, yearli resolution. malta rel unimport overal goal size, 2002 renew energi consumption, exclud analysis. page 13 dynam cluster time seri data data shown figur 3. figur 3: 2001 renewab target set 2009 revised. regardless country, shortli 2005 renew energi usag start grow. larg group countri low rate renew energi usag (reu), smaller group higher reu countri show growth time- period, move lower group higher 1995 2010. countri highlight figur 4. figur 4: estonia, lithuania romania grow rate renew energi usag start time-window 1996, denmark start rapid growth 1999. denmark, 2015, eu countri fifth-highest reu. growth mainli denmark effeci us wind energi production. accord denmark energinet, 2017 81,4% energi came renew resources, 8.7% 1997. 2017, astound page 14 dynam cluster time seri data 50.2% energi product came sole wind (energinet, 2018). lithuania growth larg extens us biomass resourc (lsd, 2012), estonia reli heavili wind (erea, 2019) romania reli morsli hydro-energi (19% total energi february, 2019) signific share wind solar (9% 8% total, respectively, february, 2019) (export.gov, 2019). fit model present section 3 data consid k = 2 cluster assum random-walk behavior them. result mean cluster shown figur 5. figur 5: model mean clusters, dash line indic standard deviations. figur 6: classif countri growth behavior. model successfulli captur gener behavior clusters. that, page 15 dynam cluster time seri data seri grow countri figur 6, highlight color reflect membership weight time-instant. model results, estonia, earliest grower, uncertain membership weight 1995 1996, romania estonia switch cluster behaviour 1997 1998, respectively. denmark, latest grower, chang cluster behaviour 2002 2004, soon re directive. note propos model allow identifi chang point time seri move cluster another. figur 7 countri static assign clusters, signific chang membership entir time-window, expected. figur 7: classif countri static behavior. 4.2 life-expect gdp capta europ africa second analysis, consid famou gapmind dataset inform gdp capta life expect nation creat popular present incom relat life expectancy? (gapminder, 2015). better illustr visual cluster-chang behavior, select nation classifi african european origin 142 countries, result select 82 bivari time- seri continents. dataset present inform year 1952 2007. visual data figur 8. figur 8 that, general, countri show signific improv life expectancy, countri consider increas gdp capta, number exceptions. that, unsurprisingly, european countri tend higher life expect gdp capta african counterparts. evid group behavior: european group african group. how- ever, pai close attent graph, except rule. orang curv life expect graph clearli european group page 16 dynam cluster time seri data refer runion, oversea depart region france, republ mauritius, island nation near runion. graph, blue line start african group refer turkey, show signific growth. figur 8: gapmind data life expect (above) log-gdp capta (below). european coun- tri blue african countri orange. far gdp capta concerned, group divis clear. african curv which, special 1962 1987, stai close relat european group; refer south africa, rich african nation, lybia gabon, nation reli strongli natur resourc extraction, oil. european countri low gdp albania, bosnia herzegovina, turkey, show similar behavior gdp capta life expectancy. interestingly, however, north african nations, turkey, show con- sider growth life expect subtl growth gdp capta, highlight figur 9. countries, morroco show improv life expect gdp capta. countri show strong improv gdp capta, highlight figur 10: botswana, present steadi growth 1970, evid equatori guinea, signific jump 1992 1997 major econom develop result discoveri larg oil reserv 1996 (opec, 2019). page 17 dynam cluster time seri data figur 9: gapmind data life expect (above) log-gdp capta (below) north african nation turkey. figur 10: gapmind data life expect (above) log-gdp capta (below) botswana equatori guinea. page 18 dynam cluster time seri data botswana 1990, sub-saharan nations, present larg drop life expectancy, start recov 2000. decad mark larg deadli hiv epidem africa, countri abl fulli recov day, highlight life expectancies. consumer-grad notebook, pontual estim dataset n = 82 differ m = 2 dimesion time-seri accross t = 12 time-inst took 2 minutes, mcmc approach took time long. assum exist k = 2 differ cluster obtain mean shown figur 11. figur 11: estim mean cluster interv standard deviations. figur 12: cluster classif north african countri turkey. page 19 dynam cluster time seri data bivari application, classif consider interest model weight chang behavior differ variables. happens, north african nation turkei actual present chang classification, except morrocco, shown figur 12, cluster membership european group esti- mate 45% 2017. lybia strong gdp capta, 1967 estim 45% membership european group low life expectancy. 1977 88% membership, classifi en european-level countri north african nation help gdp capta. equitori guinea botswana strong gdp capta 2007, low life expect kept strongli african group, estim membership near 100%. note, countri classifi european group uncertain classif data-points. are: albania, bosnia herzegovina, mauritiu runion. highlight figur 13. figur 13: cluster classif north african countri turkey. membership 1952 estim 50%, mean time-points, far model concerned, classifi member groups, rate quickli end gener classifi european countries. nation specif mention receiv static classif expect cluster expected. page 20 dynam cluster time seri data 5 conclud remark static mixtur dynam linear models, main result research, present extrem effici flexibl wai static cluster time-seri data, form em-algorithm, dynamix mixtur unecessary. dynam mixtur dynam linear model proven abl captur chang behavior time-seri correctli classifi time-seri clearli belong cluster entir time-window. particular, demonstr improv exist method avoid missclassif outlier emploi evolut dirichlet process captur time-depend cluster membership parameters. us deal high number high-dimension time-seri segment differ clusters. gener behavior seri summaris k-dimension membership paramet , monitor seri behaviour k differ means, instead go effort analys actual m-variat time seri m large. natur step develop model attempt incorpor method decid number clusters, k, automatically, allow k evolv time, encompass, example, set observ present behaviour time-inst separ differ clusters. refer aghabozorgi, s., shirkhorshidi, a. s., wah, t. y. (2015). time-seri clusteringa decad review. inform systems, 53:1638. arthur, d. vassilvitskii, s. (2007). k-means++: advantag care seeding. proceed eighteenth annual acm-siam symposium discret algorithms, page 10271035. societi industri appli mathematics. dempster, a. p., laird, n. m., rubin, d. b. (1977). maximum likelihood incomplet data em algorithm. journal royal statist society: seri b (methodological), 39(1):122. diebolt, j. robert, c. p. (1994). estim finit mixtur distribut bayesian sampling. journal royal statist society: seri b (methodological), 56(2):363375. energinet (2018). environment report 2018. erea (2019). renew energi estonia. renewable-energy-estonia/. accessed: 2019-10-30. european comiss (2015). eu track meet 20 news/eu-track-meeting-20-renewable-energy-target. accessed: 2019-10-30. page 21 dynam cluster time seri data european comiss (2019). energi product imports. eurostat/statistics-explained/index.php/energy_production_and_ imports. accessed: 2019-10-30. export.gov (2019). romania - energy. romania-energy. accessed: 2019-10-30. fonseca, t. c. ferreira, m. a. (2017). dynam multiscal spatiotempor model poisson data. journal american statist association, 112(517):215234. fraley, c. raftery, a. e. (2007). bayesian regular normal mixtur estim model- base clustering. journal classification, 24(2):155181. frhwirth-schnatter, s. (2001). markov chain mont carlo estim classic dynam switch mixtur models. journal american statist association, 96(453):194209. gapmind (2015). incom relat life expectancy? answers/how-does-income-relate-to-life-expectancy/. accessed: 2019-11-01. geman, s. geman, d. (1987). stochast relaxation, gibb distributions, bayesian restor images. read vision, page 564584. elsevier. harrison, j. west, m. (1987). practic bayesian forecasting. journal royal statist society: seri d (the statistician), 36(2-3):115125. juang, b.-h. rabiner, l. r. (1985). probabilist distanc measur hidden markov models. at&t technic journal, 64(2):391408. juang, b. h. rabiner, l. r. (1991). hidden markov model speech recognition. technometrics, 33(3):251272. krogh, a., brown, m., mian, i. s., sjlander, k., haussler, d. (1994). hidden markov model comput biology: applic protein modeling. journal molecular biology, 235(5):1501 1531. lamon, e. c., carpenter, s. r., stow, c. a. (1998). forecast pcb concentr lake michigan salmonids: dynam linear model approach. ecolog applications, 8(3):659668. liao, t. w. (2005). cluster time seri dataa survey. pattern recognition, 38(11):18571874. lopes, h. f. carvalho, c. m. (2007). factor stochast volatil time vari load markov switch regimes. journal statist plan inference, 137(10):30823091. lsd (2012). energetiko statistika. stat.gov.lt/lt/news/view#selection-238.0-240.1. page 22 dynam cluster time seri data macqueen, j. et al. (1967). method classif analysi multivari observations. proceed fifth berkelei symposium mathemat statist probability, volum 1, page 281297. oakland, ca, usa. maruotti, a. vichi, m. (2017). time-vari cluster multivari longitudin observations. commun statistics-theori methods, 45(2):430443. nielsen, s. f. et al. (2000). stochast em algorithm: estim asymptot results. bernoulli, 6(3):457489. nobile, a. fearnside, a. t. (2007). bayesian finit mixtur unknown number compo- nents: alloc sampler. statist computing, 17(2):147162. opec (2019). equatori guinea fact figures. about_us/4319.htm. accessed: 2019-11-01. punzo, a. maruotti, a. (2016). cluster multivari longitudin observations: contamin gaussian hidden markov model. journal comput graphic statistics, 25(4):10971098. richardson, s. green, p. j. (1997). bayesian analysi mixtur unknown number compon (with discussion). journal royal statist society: seri b (statist methodol- ogy), 59(4):731792. schliep, a., schnhuth, a., steinhoff, c. (2003). hidden markov model analyz gene express time cours data. bioinformatics, 19(suppl_1):i255i263. smyth, p. (1997). cluster sequenc hidden markov models. advanc neural inform process systems, page 648654. tanner, m. a. wong, w. h. (1987). calcul posterior distribut data augmentation. journal american statist association, 82(398):528540. world bank (2019). renew energi consumpt ( indicator/eg.fec.rnew.zs?view=chart. accessed: 2019-10-30. west, m. harrison, j. (1996). bayesian forecasting. encyclopedia statist sciences. wright, s. j. (2015). coordin descent algorithms. mathemat programming, 151(1):334. page 23 dynam cluster time seri data applic artifici data consid dataset present figur 14. it, total 20 time-seri clearli differenti differ behaviours. initi algorithm describ subsect 2.3 chose initi time-seri repres cluster indic figur 15. initi led state classif shown figur 15. initi algorithm perform wonderfully, effect estim procedur serv smooth estim state possibl correct small missclassifications. figur 14: artifici dataset static cluster time-series. figur 15: time-seri select initi differ cluster shown green (left) result initi procedure, color time-seri repres classif (right). run regular consumer-grad notebook, pontual estim took 5 second run gibb sampler took 9 minut 38 seconds. result shown figur 16, seen estim method essenti same, expect. page 24 dynam cluster time seri data figur 16: result estim gibb sampler (left) em algorithm (right). color time-seri repres classification. consid dataset shown figur 17, time-seri ad wai follow behavior cluster point cluster nearli meet, point chang membership second cluster. figur 17: artifici dataset dynam cluster time-series. time-seri orang ad dataset repres membership chang behaviour. propos algorithm pick discount factor return valu 0.95 origin observations, discount factor 0.5 new membership-chang time-series. pontual estim implement took 1 minut 18 second run gibb sampler took 14 minut 23 second run. figur 18 estim result state algorithms. figur 19 classif result algorithms. page 25 dynam cluster time seri data figur 18: estim result gibb sampler (left) pontual estim algorithm (right) states. figur 19: classif result origin 20 observ (left) new observ (right) gibb algorithm (top) pontual estim algorithm (bottom). expected, algorithm approxim results, origin 20 observ fulli classifi clusters, new addit cluster membership chang behaviour. visual classif uncertainti look posterior distribut pa- ramet cluster chang time-seri t = 39, cluster chang actual took place. distribut highlight figur 20. page 26 dynam cluster time seri data figur 20: posterior distribut paramet time-seri chang clusters, t = 37 t = 42. import thing note import includ evolut dirichlet process. develop packag implement case mention equat (9), cluster membership independ time. figur 21: higher-valu cluster time-seri classif model evolut dirichlet process weight (left) indend weight (right). figur 21 exampl misclassif result lack depend time instants, singl outlier incorrectli classifi member lower cluster dont access neighbor inform time-series. accord rafteri diagnostic, chain converg immedietaly, thank initial- izat procedures, sampl valu lightli correlated. page 27 1 introduct 2 mixtur dynam linear model 2.1 gibb sampl 2.2 expect maxim 2.3 algorithm initi 2.4 label switch problem 3 dynam mixtur dynam linear model 3.1 gibb sampl 3.2 point estim 3.3 initi 4 applic 4.1 renew energi consumpt eu 4.2 life-expect gdp capta europ africa 5 conclud remark applic artifici data