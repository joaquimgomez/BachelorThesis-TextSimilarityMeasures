instant construct visual crowd biolog environ tobia klein, ludov autin, barbora kozlkova, david s. goodsell, arthur olson, m. eduard groller, ivan viola abstract present approach integr structur model biolog mesoscal interact visual environment. complex model compris million molecul defin atom structures, locations, interactions. construct previous attempt non-visu non-interact environment. solut unit model visual aspect, enabl interact construct atom resolut mesoscal model larg portion cell. present novel set gpu algorithm build basi rapid construct complex biolog structures. structur consist multipl membrane-enclos compart includ solubl molecul fibrou structures. compart defin volum voxel triangul meshes. membranes, present extens wang tile concept popul bilay individu lipids. solubl molecul popul compart halton sequenc distribution. fibrou structures, rna actin filaments, creat self-avoid random walks. result overlap molecul resolv forced-bas system. approach open new possibl world interact construct cellular compartments. demonstr effect showcas scene differ scale complex compris blood plasma, mycoplasma, hiv. index termsinteract modeling, population, biolog data, interact visual 1 introduct technolog advanc structur biology, proteomics, bio- physics, combin rapid advanc comput capabilities, open door studi increasingli larg complex bio- logic systems. recently, seen shift studi individu protein model analyz function protein assembl larger systems, viruses, bacteria, portion eukary- tobia klein, m. eduard groller, ivan viola tu wien, austria. e-mails: ludov autin, david s. goodsell, arthur olson scripp research institute, california, usa. e-mails: barbora kozlkova masaryk university, brno, czech republic. e-mail: manuscript receiv xx xxx. 201x; accept xx xxx. 201x. date public xx xxx. 201x; date current version xx xxx. 201x. inform obtain reprint article, send e-mail to: digit object identifier: xx.xxxx/tvcg.201x.xxxxxxx otic cells. denot biolog mesoscal structures, repres intermedi scale molecular cellular bi- ology. molecular (nanoscale) level, cell built proteins, nucleic acids, lipids, polysaccharides. mesoscal level reveal molecul assembl complex subcellular en- viron orchestr process life. given complex massiv mesoscal environments, model tightli coupl proper visual representation. provid intuit feedback validation, tool explor models, visual materi public dissemin commun find peers. typic scenarios, visual creat sci- entif illustr tradition produc imag hand draw 3d model tools. exampl includ illustr cellular environ [14], detail 3d model synapt bouton creat maya [46]. labori process limit interact explor capabilities, requir non trivial domain knowledg depict biolog structures. altern solut scene higher level abstract us descript automat creat result scene. approach recent implement cellpack [23] gener visual 3d model complex biolog environ- ments. cellpack integr data multipl sourc recip describ constitut desir environment. envi- ronment partit membrane-bound compartments, arrang hierarchically. compart defin mesh sur- face repres lipid-bilay membranes. compartment, includ membranes, popul differ set ingredients, includ solubl molecul insid compart molecul embed membranes. ingredi fibrou com- ponents, rna carbohydr chains, solubl compon protein metabolites, lipid membranes. cellpack combin knowledg membranes, compartments, ingre- dients, assembl mesoscal model respect mutual biologically-relev interact them. main drawback approach comput time assembl 3d mesoscal model input data recipe. depend desir qualiti distribut ingredients, stage span minut hours. therefore, lengthi process to, example, chang paramet like number ingredi (molarity) interact observ impact change. aim overcom limit instantli provid distribut ingredi biolog compart membranes. open new possibl biologist gather domain-specif knowledg mesoscale-level structures, integr model, explor consequ gap knowledg rang experimentally-observ parameters. irreplac process visual represen- tation scene content. molecular visual techniqu develop decad focus predominantli vi- sual depict molecul captur x-rai crystallography, nmr spectroscopy, recently, electron microscopy. natur structur data, molecul visual atom reso- lution. however, mesoscal level pose new challenges. mesoscal model larger, million atoms, tax exist visual hardwar software. complex, integrat- ing multipl type data differ resolutions, complex hierarch relationship span individu molecul entir cells. visual represent provid user overview structur mean explor details. address challenge, state-of-th art tool cellview [35] enabl seamless transit visual represent structur differ level detail. cellview integr latest gpu-bas algorithm graphic visual interact render larg biolog scenes. approach describ incorpor instant model as- pect cellview provid unifi visual framework model visualization. main contribut include: new algorithm instant model differ type compart- ment membran biolog structur mesoscal level. interact visual environ enabl chang popula- tion paramet instantli explor result scene nanoscal mesoscal levels. enhanc process creat model mesoscal structur shift non-visu non-interact environ fulli interact visually-support one. demonstr approach mesoscal model differ scale complexity, includ blood plasma, hiv, entir mycoplasma bacterium. 2 relat work experiment method determin mesoscal structur extend larger larger subjects, current fall short abl determin atom structur live cells. instance, cryo- em microscopi detail structur regular envelop zika virus, randomli arrang genom insid larg inaccess experi [39]. similarly, cryo-em tomographi current yield detail view complex envelop viruses, bacteria, eukaryot cells, typic abl resolv larg molecul ribosomes, cytoskelet elements, membran [2]. group attempt structur model mesoscal atom detail, comput combin inform mesoscal experiment techniqu atom structur informa- tion compon (review [21, 37]). work structur mesoscal model focus solubl compo- nent bacteri cytoplasm, model explor diffus crowd environ (see, example, [34]). recently, sev- eral group build tool structur model includ cellular infrastructure, includ work cellpack [23] lifeexplor [20, 42]. procedur modeling. mesoscal structur cell similar natur phenomena high geometr visual complex requir explicit control details. exampl includ model cloud meadow cover grass. gener approach model type phenomena defin overal shape environment, detail object stochast process. approach, call procedur modeling, long tradit graphics. work propos on-the-fli gener sceneri target infinit citi [15] forest [7], mainli aim provid rich game content. current focu parallel schedul optimizations, procedur content gener effici realiz graphic hardwar [4, 40]. wonka et al. [48] present method automat model architecture. recently, novel techniqu propos viewpoint-guid gener high geometr detail facad [29]. techniqu usual us certain plan grammars, provid structur rule gener shapes. work, focu distribut object space constrain membran divid compartments. visual larg biolog scenes. driven wealth structur inform avail sourc like protein data bank [3], highli effect softwar current avail visualiza- tion biomolecul assembl (for recent reviews, kozlikova et al. [28] johnson hertig [26]). however, method typic fail face larg number mesoscal molecules. mesoscal structur requir specialized, highly-optim solutions. currently, publicly-avail open-sourc system larg number atom render effici leverag graphic hardwar capabilities. megamol [16], us atom representations, biomolecules. cellview [35], tool illustr multiscal visualiza- tion larg biomolecular datasets. altern approach, publish walterm et al. [44], introduc interact tool combin mesoscop molecular scale visualization. reach magnifi tool enabl user select region cell membran map pre-comput membran patch atomist resolut it. however, approach abl popul limit area cell surface. mesoscal scene produc scientif illustr general-purpos 3d model tools. eas tasks, extens specif molecular model introduced. example, epmv plugin [24] allow user run molecular model- ing softwar directli insid profession 3d anim applications. sketchbio [43] exampl 3d interfac molecular mod- el animation. lv et al. [32] explor possibl us game technolog biomolecular visualization, unity3d game engin develop prototyp molecular visual applic subsequ us research education. textur synthesis. approach popul larg biolog membran lipid base tile approach, commonli seamless 2d textur synthesis. follow well-known tile techniques, wang tile [45], util squar tile gener plane tiling. posit tile plane accord face-color rule compos desir pattern. recently, extens basic approach published. design synthes 2d textur map 3d surfaces. fu leung [12] wang tile applic arbitrari topolog surfaces. case differ necess synthes tile contain 3d objects, lipids. therefore, detect handl overlap object account. inspir solut provid lipidwrapp [9]. however, lipidwrapp solv collis triangl 3d mesh, make inapplic larg membranes. neyret cani [36] present strategi tiling, triangl homogen textur tile surfaces. culik kari [5] introduc wang cube extend wang tile approach abl creat non-period illustr 3d pattern textures. lu et al. [31] present framework volum illustr util wang cubes. extend origin idea modifi multipurpos tiling. wang cube applic case deal 3d tile repres lipid bilayer, tile defin 2d plane. fleischer et al. [11] present approach textur surfac call cellular textures. textur repres complex geometri cover surfac complex objects, feather thorns. close situat lipid bilayers. however, approach appli case regular produc surfac algorithm speed. popul fibrou structures. algorithm self-avoid walk popul compart fibrou structure. fan et al. [10] publish extens definit manhattan lattice, solv problem, go 2d 3d space. procedur build fibrou structures, follow ap- proach, similar polymer process address kolesar et al. [27]. illustr approach fusion differ model techniques, l-systems, agent-bas systems, system densities. posit new build block exist polym base attract forces. gruenert et al. [17] present approach rule-bas spatial model chemic reaction systems. techniqu suitabl simul polymer process, showcas growth filaments. growth driven pa- rameters, torsion bending, control pathwai structur form complexes. problem procedur construct path common area well. example, galin et al. [13] present automat method gener road given points, base weight anisotrop shortest path algorithm. trajectori minim cost function consist differ paramet scene, terrain shape obstacles. 3 overview model scene contain complex mesoscal biolog struc- tures, workflow consist follow basic steps: 1. scene organization, defin shape membrane- bound compartment. 2. recip definition, determin molecular composit compart membrane. 3. popul model, solubl space membran ingredi defin recipe. organ scene defin close 3d mesh repres lipid bilay membranes. membran defin sep- arat compart scene. example, figur 1 a) show scene concentr close membran defin intracellular environ (label 1 2) surround environ (label 3). follow step compil recip defin molecu- lar composit compart membran (figur 1 b)). recip includ structur molecules, concentra- tion (molarity), constraint relat posit membranes, specif interact molecules, etc. step take recip popul compart membran accordingli (see figur 1 c)). popul step typic stochastic, (a) (b) (c) fig. 1: scene hierarchi provid compart organ scene (here mark 1, 2, 3), (b) individu com- partment, composit defin includ type number ingredients. (c) algorithm automat popul compart- ment surfac inform ingredients. repeat provid ensembl similar model consist scene organ recipe. current avail approaches, cellpack [23], process transform scene definit recip final model minut hours, depend complex scene. make model process non-interact user immedi consequ paramet changes. overcom appli parallel processing, improv compu- tation bottleneck workflow. seen figur 1 b), individu compart membran popul ways. distinguish basic cases: membran repres semi-perm barrier compartments. consist lipid bilay em- bed protein commun transport molecul ion membrane. order model membranes, implement solut base textur tiling. solubl compon occupi free space compartment. consist ingredi (molecules) differ shape complexity, influenc difficulti popul step predefin space. approach posit in- gredient compart consist steps. step popul ingredi consid overlap them, collis resolv second step. fibrou structur dna, rna, actin filaments, long strand fold insid specif compartments. us self- avoid random walk construct fiber allow space compartments. algorithm popul type ingredients, advantag popul specif order, describ follow sections. 4 membran popul biolog membran built continu fluid sheet contain- ing oppos layer lipids. lipid small molecul consist dozen atoms, characterist chemic character. compos head group solubl water, tail insoluble. water, spontan associ hide insolubl tails, form largest structur cells. membran form semi-perm boundari surround cells, boundari inner compart nucleu mi- tochondria. differ type lipid distribut unequ creat asymmetri outer inner surfac import cell function. biolog structure, hiv virion red blood cell, bilay uniqu lipid composition. common properti lipid dens pack membran orient roughli perpendicular it. model lipid bilay complex labori task, dens pack larg number lipid com- pare surround molecules. main challenge, term modeling, incorpor known structur inform avoid repetit pattern surface. bilayer-model program available, charmm-gui [22], packmol [33], cellpack [23]. tool posit individu lipid one-by-on membrane, lead unaccept comput costs. sophist solut provid lipidwrapp [9]. extract patch pre-equilibr planar membran model. patch contain detail structur inform lipids. order produc membran surface, lipidwrapp us triangul mesh input, triangl patch randomli cut provid membran model. however, edg adjac patch surfac fit lipid potenti overlap regions. therefore, lipidwrapp delet overlap lipid fill result hole new lipids. expens process triangl edg surface. reason, comput cost lipidwrapp signific applic instant modeling. allow interact popul membranes, solut us tile approach textur synthesi cover membran mesh lipids. approach, requir mesh defin quad-bas surfac map. general, method resampl given mesh quad-bas surfac result surfac map conform low area distortions. exampl polycubemap introduc tarini et al. [41]. mesh gener approach margin affect distortions, make suitabl tile approach. cover mesh lipids, us small number tiles. tile pre-popul lipid us basic principl lipidwrapper. however, solut significantli faster gener content limit set tile instead appli mesh geometry. tile subsequ cover membrane. place wai edg fit tile result period patterns. repetit pattern visible, us concept wang tile [45]. following, individu step approach detail. start descript concept principl wang tiles. present adapt concept membran meshes. 4.1 wang tile extens membran wang tile concept introduc earli 60 well- known textur synthesis. wang tile defin squar color-encod edges. set wang tile cover 2d plane period patterns. color edg restrict tile place tile process. tile valid share edg color. color requir tile plane non-periodically. approach extend concept wang tile 3d space. solution, follow approach fu leun [12], appli tile concept wang tile arbitrari topolog surfaces. gener tile differ diamond-shap input patch posit west, east, north, south tile center, respectively. patch combin gener set tile differ color edges. adapt approach us membran model synthes collect lipid-textur tile map membran mesh. 4.1.1 tile synthesi lipid bilay model synthesi tile major challeng approach generat- ing 3d model biolog membranes. first, extract content tile input texture. biolog membranes, input textur planar represent lipid bilay contain- ing non-overlapping, tightly-pack lipid molecules. atom coordi- nate lipid bilay generated, example, molecular dynam simul amber forc field lipid [8]. (a) (b) (c) (d) fig. 2: overview wang tile synthesis. (a) small patch extract input texture. (b) larg patch assembl small patches, tile extract center patch. (c) border lipid collis removed, leav hole tile. (d) hole fill posit new lipids. tile gener steps. first, small diamond-shap patch extract larg bilay texture. extract patch (figur 2 a)), includ lipid center bound specifi patch, center lipid defin center bound box. larg diamond-shap patch creat posit tile together. finally, extract rectangular tile larg diamond-shap patch (see figur 2 b)). note differ tile need wang tile gener differ arrang small patch larg patch. tile process resolv overlap gaps. detect overlap lipid assembl tile multipl input patch inher lead overlap lipid area input patch meet. collis evalu step process improv performance, test overlap bound boxes, test individu lipid atom appropriate. lipid highest number collis remov tile (if multipl lipid number collisions, chosen randomli removal). number collis updat neighbor remov lipid, procedur repeat collis solved. leav tile undesir hole (figur 2 c)), fill final step. hole fill hole tile fill non-collid lipid (figur 2 d)). individu lipid extract input membran bilay gener patch tiles. bilayer, plane defin intersect hy- drophil head group lipid tile. trial lipid randomli chosen input textur place regular interv diagon tile, align head group planes. collisions, lipid ad tile, otherwise, lipid rotat axi perpendicular plane test col- lisions. accept orient found, process continu lipid input texture. additionally, reduc number possibl candid reject intersect lipid tile. result hole fill process depend paramet lipid test set, rotat fig. 3: exampl lipid-bilay membran popul lipid tiles. cross-sect view visual cut plane. lipid test, time repeat entir hole fill procedure. paramet adjust accord user needs. however, appli process tile quad mesh, paramet set critic aspect. 4.2 tile map finally, gener tile map membran mesh con- sist quads. data bilay lipid membran instead textures, 3d coordin map quad instead 2d textur coordinates. reason, us quadrilater coordin map lipid center ( ,) vertic (v0,v1,v2,v3) quad follow equation, p result vertex 3d space. p = (1 ) (1) v0 + (1) v1 + v2 +(1 ) v3 (1) result position, correspond lipid instantiated. orient lipid quad adjust well. main axi lipid perpendicular plane tile, determin orient comput rotat angl origin tile posit quad. rotat appli lipid given tile. figur 3 show result posit tile lipid membran mesh. 5 solubl membrane-bound compon cell typic crowd proteins, nucleic acid molecules, solubl compon assembl fill com- partment membrane-bound compon embed lipid bilayers. recip mesoscal scene specifi quantiti ingredients, locat orient (if appropriate), mutual interactions. task popul boil prob- lem non-overlap spatial distribut ingredi appropri space. current avail solutions, capabl posit solubl ingredi compartments, however, sequenti manner. mean posit ingredi one, posit ingredi surround space updat awar distanc closest ingredient. ingredi posit point suffici distanc nearbi ingredients. comput cost approach feasibl interact environments. therefore, solut us parallel process speed performance. procedur applic gpu, divid approach consecut step (see figur 4): step 1 compart space organ voxelization. step 2 popul space given ingredients. step 3 detect resolv collis ingredients. major advantag approach process individu ingredi independent. rest section step detail. (a) (b) (c) fig. 4: step approach popul compart solubl components. (a) voxel space definit inner (purpl grey), surfac (dark purpl dark blue), outer (light blue) grids. (b) posit individu ingredi inner compartments. collis ingredi highlighted. (c) scene resolv collis force-bas approach. 5.1 step 1 space partit voxel step partit scene set compartments, delimit membran meshes. approach base state- of-the-art method gpu voxel schwarz seidel [38]. voxel process start classif voxel intersect compartment. grid axes, scanlin algorithm appli voxel determin belong cellular compartments, membranes, surround environment. assign neg valu cellular compart voxels, posit valu surfac voxels, zero outsid voxels. repeat process compart scene. result structure, compart grid, identifi compart membran associ voxel, us rapid popul follow step. moreover, sort voxel compart estim volum them. thus, given molar calcul proper count given protein. addit compart grid, defin occup grid help resolv overlap ingredients. occup grid size resolut compart grid, hold neg valu free voxel correspond id ingredi voxel occupied. especi import size ingredi differ significantly, e.g., surfac ingredi protrud compart surface. reason, start popul process distribut larg surfac ingredi us remain space interior on emploi updat occup grid. divid popul passes, prevent small ingredi complet overlap larger ingredi come differ compartment. 5.2 step 2 popul step popul given compart individu ingredi- ent defin recipe, compart grid occup grid gener previou step. distinguish type ingredi populated. type repres ingredi- ent occupi inner compart bound compart membrane. second type ingredi popul solubl space compartment. order avoid addit overlaps, popul surfac compart inner part. 5.2.1 popul compart surfac cell membran typic includ divers collect membrane- bound proteins, interact face membran span membrane. pose challenges: protein orient correctli face proper direct membrane-span portion embed membrane. protein larg portion extend side membrane, evalu collis membrane-bound protein solubl components. implement spatial distribut ingredi given membran (a) (b) (c) (d) fig. 5: (a) ingredi distribut surfac compartment. (b) occup grid contain inform voxel occupi ingredi (green outside, yellow inside). (c) posit ingredi insid compart (new ingredi red orang color). (d) occup grid update. steps. briefly, need inform ingredi type, molarity, id membrane, princip vector offset ingredi (figur 5 a)). step, updat inform store occup grid (figur 5 b)). first, sampl triangular mesh repres compart surfac determin locat proteins. uniform sampl instantli posit sampl triangl vertic centers. however, suitabl ingredi irregularli distribut surfac differ size shape. solv issue, willmott previous properti halton sequenc distribut real time non-overlap object plane [47]. however, method reli sequenc determin size distribut object. current scenario object size predefin scaled. order reach irregular distribut minim possibl overlap ingredi surface, us halton sequenc select triangl posit ingredient. halton sequenc [18] provid wai produc point low discrepancy, i.e., produc well-spac samples. sequenc construct prime number defin number divis unit interv sub-intervals. subsequ divid prime number reach desir length sequence. sequenc order wai produc subset evenli cover entir domain. halton sequenc numer method like mont carlo simul [6]. advantag halton sequenc contain number twice choos grid point multipl ingredients. approach provid effici rapid wai distribut ingredi compart surfac suffici random minim possibl overlaps. suitabl triangl selected, gener random point insid triangl us posit correspond ingredient. orient ingredi describ princip vector defin orient ingredi respect membrane, offset vector place ingredi proper posit rel surfac membrane, depict figur 6. inform usual comput opm webserv [30]. note method test overlap differ (a) (b) fig. 6: (a) exampl surfac ingredi proper princip vector (black), offset vector (white), head center mass anchor posit surface. (b) posit ingredi surfac correct orient offset align surfac normal (top). grid occup updat (bottom). ingredi case count object place larger number triangles, object size larger triangles, end result present overlaps. 5.2.2 popul compart inner area popul solubl space compartments, us infor- mation store compart grid occup grid appropri posit ingredients. mean membrane- bound ingredi posit previou step consid non-mov obstacles, i.e., handl static object resolv collisions. popul work follows. instanc ingredi defin recipe, place ingredi voxel mark appropri valu compart grid, valu occup grid. occup grid updat ident ingredient, step repeat ingredi posit (figur 5 c, d). occup grid updat posit ingredi completed, grid popul compart fibrou structur (see section 6). size ingredi substanti larger voxel size, ultim result intersect ingredi place close proximity. popul step necessarili need overlap consideration, overlap- ping produced, comput requir follow step resolv overlapping. straightforward approach reduc overlap uniformli distribut ingredients. however, lead undesir visual appear grid structur clearli visible. order introduc certain degre random reduc overlaps, util halton sequenc choos potenti grid point population. practic compart popu- late halton sequenc suffer visibl regularities. therefore, addition introduc jitter random vector grid posit appli random rotat ingredient. halton sequence, significantli reduc number overlap molecul complet reduc zero. follow step detect resolv remain overlaps. 5.3 step 3 detect resolv collis ideally, want detect collis evalu contact atom molecules. however, practic term performance, molecul type, comput two-level proxi geometri approxim shape. higher-level proxi simpli bound sphere molecule. lower- level proxi approxim molecul small number sphere (a) (b) fig. 7: (a): proxi geometri ingredients. overlap geometri mark red, non-overlap green, static on grey. (b) scene popul ingredients. (preset 16 spheres) calcul gpu-bas k-mean cluster algorithm. provid center sphere size correspond cluster size. ensur atom cover proxi geometry. collision-detect process us higher level proxi geometri detect potenti collis molecules, verifi lower-level proxi geometri finer approxim shape. figur 7 show lower-level proxi geometri (a) scene popul ingredi (b). proxi geometri slightli overestim actual shape molecul ensur certain distanc creat molecul collis resolved. perceptu point view, molecul easier distinguish shape boundari direct contact. resolv collis loos base standard rigid bodi dynam [1]. however, usual exact point contact bodi detect correspond forc computed. molecul collid state, simpli comput forc resolv collisions. us inform collis lower-level proxi geometri basi computation. intersect pair molecul determin overlap sphere pair consid collision. molecul accumul linear angular forc updat collision. linear forc defin direct strength. direct deriv vector center spheres. distanc sphere center determin strength force. rigid bodi dynamics, comput angular forc take account vector center molecul collision, direct vector. forc collis computed, determin new posit rotat molecules, standard physics-bas systems. denot integr step. collision- resolv process, happen molecul temporarili leav compartment. appli forc molecule, steer compartment. process repeat certain number integr step collis resolv stop criterion reached. criterion set user specifi certain number accept remain collisions. make flexibl power hardwar system well. collis detect subsequ resolv comput gpu. (a) (b) fig. 8: fibrou structur model self-avoid random walk. (a) walk start random point insid certain compartment. random direct hemispher point chosen. intersect exist structur compart surfaces, direct chosen segment ad fiber. process repeat desir length fiber reached. (b) long dna (yellow) long persist length combin shorter rna (red) small persist length. 6 fibrou structur fibrou ingredi linear branch polym repeat units, place cells. includ protein filament form infrastructure, polysaccharid provid protect store energy, nucleic acid encod genet information. usual model procedur grow algorithm, self-avoid random walks. angl length constrain maintain persis- tent length process fiber. process build fibrou structur sequenti natur awar previou state fiber. however, process greatli improv grid information. increment step walk, correspond grid check belong compart (compart grid) occupi protein (occu- panci grid). improv comput cost restrain grow fiber allow space minim intersect pre- viousli posit ingredients, includ self-intersections. larg systems, genomes, fiber contain million subunits, complet fiber-grow process interactive. here, provid possibl user observ current progress fiber growth, remain interactive. self-avoid random walk approach work follows. target compartment, start point randomli chosen follow protocol iter requir length fiber reached. step, random direct select hemi- sphere orient posit accord previou direc- tion, illustr figur 8 a). possibl intersect mem- branes, solubl molecul test occup compart grids, intersections, segment ad grid updated. otherwise, differ random direct chosen. dead-end reach walk reject given number attempts. experience, or- der molecul distribut strongli influenc success popul step. obtain best result place membrane-bound protein first, follow fibers, finish solubl ingredients. sequenc address signific potenti problems: (i) membrane-bound protein protrud compart- ments, fiber avoid them, (ii) typic solubl compon highli crowd compartments, lead free grid point option fiber growth. figur 8 b) show exampl posit fibrou structur differ type compart (outside, inside, surface). method provid interact perform small fibers, lipopolysaccharid extend mycoplasma surfac small rna molecul cytoplasm. long genom dna molecules, however, requir minut generate. provid method allow user interact larg structures: premad dna model preloaded, grow walk real-tim progress, allow user stop restart grow model show problems. 7 result discuss approach describ flexible, allow model varieti biolog systems. abil due, part, relationship live thing earth. similar membran surround cell defin inner organelles, similar protein orchestr traffic molecul inform membranes. similar protein nucleic acid metabol genet task requir energi production, biosynthesis, reproduction, packag similar compart cells. viruses, reli cell reproduction, built subset machinery. thus, limit set structur model tools, abl build varieti differ cellular scenes. build mesoscal model iter process, recipe, ultrastructur paramet tune reflect lend insight avail experiment results. labori process method cellpack, singl model requir minut hour generate, follow signific effort visual results. approach tighten research cycle, allow research gener model ensembl model rapidli intrins visual environment. allow interact optim recip identifi correct error bugs, rapid incorpor new data available. demonstr capabl advantag new approach test systems. mesoscal model blood plasma, ef- ficienc current method allow creat larg scene contain million molecules, requir prohibit com- putat effort previou methods. hiv, interact capabl allow gener multipl model singl recipe, explor stochast variat structur complex subject. model entir mycoplasma bacterium, abl tune recip model paramet interact achiev particular goal: creat 3d version exist 2d render cell. follow sections, case achiev results. perform measur intel core i7-6700k cpu 4.00ghz nvidia geforc gtx 1080 graphic card 8 gb memory. blood plasma. blood plasma larg homogen rel spars occupi protein short fibrou components. protein varieti functions, includ molecul immun system, blood clot factors, transport molecules, hormones. perfect earli test method popul mesoscal scenes, protein varieti size shapes, includ- ing larg aspect ratios. creat model cellpack, scene contain nearli 30,000 molecul cre- at 116 seconds. approach test scene blood plasma contain 33,000 molecules. popul step take averag 100 ms consecut overlap resolv averag 2000 ms. capabl popul significantli larger scenes. shown figur 9, popul scene volum cubic micron blood plasma. given accur molarity, approach produc 4.6 million solubl protein ingre- dient 0.6 seconds. current implementation, capabl force-bas resolv potenti overlaps. main bottleneck collis detection. however, conceptu limitation. current research [19] shown possibl interact solv collis million particles. hiv. hiv conveni test mesoscal model incept cellpack project. advantages: rel small, tax method most-studi organisms, abund inform available. however, signific grai area avail data, leav room experiment paramet recipe. recip describ johnson et al. [25], consist 5 type surfac proteins, 19 type interior protein fig. 9: cubic space micron wide fill blood plasma, 4.6 million solubl protein ingredients, popul 0.6 sec. (a) (b) (c) (d) (e) (f) fig. 10: overview interact model matur hiv virion base cellpack recipe. (a) build membran (magenta) base spheric mesh, preload capsid (blue) cryo-em structur (pdb entri 3j3q). (b) solid voxel compartments. (c) updat occup grid. (d) popul surfac ingredi (envelop protein green, matrix protein yellow). (e) build copi rna (red) fiber growth method attach hiv nc protein control points. (f) result model. 2 rna copi (9,200 bases, roughli 30,000 angstrom long). membran envelop surround virion, copi viral envelop protein embed membran extend outwards. inside, protein-enclos capsid protect copi viral genome. varieti proteins, includ viral enzym accessori proteins, space membran capsid. figur 10 depict differ step procedur approach model hiv. final model consist 11,790 protein ingredients. entir model requir 0.07 second gener rna, requir 3 second gener copi rna. take hour gener model cellpack. mycoplasma bacterium. ultim goal work creat comput model entir cells, us interpret exper- iment results, model structure/funct relationship healthi diseas states. approach challenge, fo- cuse simplest cells, mycoplasma bacterium. cell simpl structure, singl cellular membran small genome. membran fill pump chan- nels, decor outer surfac lipopolysaccharid form protect coat cell. detail organ molecul insid cell begin explor cry- (a) (b) (c) fig. 11: cross-sect mycoplasma mycoides. (a) hand-drawn illustration. (b) 3d model gener draft recipe. (c) 3d model gener interact tune recip match gener characterist illustration. 3d models, membran green, membrane-embed protein orang lipopolysaccharid green. inside, dna yellow, solubl protein blue magenta, rna red. oem microscopy, given small size cells. model random tangl dna surround solubl protein rna components. draft recip current model (figur 11) includ mem- brane, strand dna (1,211,703 bp), 1500 lipopolysaccharides, collect 18 preval protein nucleic acids. model requir 100 sec gener fiber model (dna, mrna, peptides, lipopolysaccharides) 0.1 sec remain space solubl components. cellpack, creation mycoplasma model take hours. interact capabl method tune recipe, base previou research creat hand-drawn illustr cell. figur 11 includ illustration, 3d model draft recipe, 3d model gener interact tune recip better match illustration. 7.1 perform interact capabl creation type model previous labori process, form bottleneck study. instance, micron-s blood plasma scene previous requir hour comput time, model new method second. currently, method abl popul solubl compart interactively, allow on-the-fli experiment recip effect result scenes. perform model fibrou membran compon significantli improv compar previou approaches, take second gener cell-siz membran minut calcul genome-s object. great advantag present method abil test hypothes interactively. biolog research ongo process, grai area bodi knowledg struc- ture function cell mesoscal level. cases, us test emerg mesoscal consequ differ proper- ti molecular level. current implementation, us paramet tunabl runtime. user import ultrastructur mesh descript ingredients, creat visual model base recip fly. tunabl paramet recip current includ location, molarity, orient (a defin princip vector offset), fiber-gener parame- ters. basic geometri loaded, chang interactively. example, figur 12, test assumpt dna persist length model small genom pack spheric bacterium. longer persist length lead dna strand wrap peripheri cell, shorter persist length lead trajectori reminisc 3d random walk. realiti probabl combin assumptions, (a) (b) fig. 12: model dna bacteri cells, (a) long persist length (b) short persist length ( 30 kb, 7 sec generate) dna-bind protein form kink mimic short persist length, free strand dna longer persist length. 8 conclus futur work work present interact approach integr structur model biolog mesocale. interac- tive perform method provid signific advantag scientif educ applications. abil creat interact models, domain expert abl tune paramet explor mesoscal properti emerge. addit possibl creat ensembl model singl recipe, allow research explor stochast variat mesoscal properti compar experiments. education, inter- activ capabl allow curriculum develop tune model represent optim clariti result imagery. long tradit scientif illustr proven pedagog util introduc small artist chang subject improv interpret shown. major enhanc method incorpor interact intuit approach model interact ingredients. instance, model interact ribosom messeng rna form polysome, crosslink dna dna-bind proteins, current feasible. current explor particl simul method nvidia flex add capability. addition, continu optim gener fibrou components, current rate-limit step model gener new approach. refer [1] d. baraff. introduct physic base modeling: rigid bodi simul i-unconstrain rigid bodi dynamics. siggraph cours notes, pp. d31d68, 1997. [2] m. beck w. baumeister. cryo-electron tomography: reveal molecular sociolog cell atom detail? trend cell biology, 26(11):825837, 2016. special issue: futur cell biology. doi: 10. 1016/j.tcb.2016.08.006 [3] h. m. berman, j. westbrook, z. feng, g. gilliland, t. n. bhat, h. weissig, i. n. shindyalov, p. e. bourne. protein data bank. nucleic acid research, 28(1):235242, 2000. [4] p. boechat, m. dokter, m. kenzel, h.-p. seidel, d. schmalstieg, m. steinberger. repres schedul procedur gener oper graphs. acm transact graphics, 35(6):183:1183:12, 2016. doi: 10.1145/2980179.2980227 [5] k. culik j. kari. aperiod set wang cubes. journal univers science, 1(10):675686, 1996. [6] i. l. dalal, d. stefan, j. harwayne-gidansky. low discrep sequenc mont carlo simul reconfigur platforms. application-specif systems, architectur processors, 2008. asap 2008. intern confer on, pp. 108113. ieee, 2008. [7] p. decaudin f. neyret. render forest scene real-time. proceed fifteenth eurograph confer render tech- niques, egsr04, pp. 93102. eurograph association, 2004. doi: 10. 2312/egwr/egsr04/093-102 [8] c. j. dickson, b. d. madej, a. a. skjevik, r. m. betz, k. teigen, i. r. gould, r. c. walker. lipid14: amber lipid forc field. journal chemic theori computation, 10(2):865879, 2014. pmid: 24803855. doi: 10.1021/ct4010307 [9] j. d. durrant r. e. amaro. lipidwrapper: algorithm gener large-scal membran model arbitrari geometry. plo comput biology, 10(7):e1003720, 2014. [10] k. fan, x.-y. li, d.-c. wu. self-avoid walk three-dimension manhattan lattice. journal physic a: mathemat general, 33(22):3971, 2000. [11] k. w. fleischer, d. h. laidlaw, b. l. currin, a. h. barr. cellular textur generation. proceed 22nd annual confer graphic interact techniques, pp. 239248. acm, new york, ny, usa, 1995. doi: 10.1145/218380.218447 [12] c.-w. fu m.-k. leung. textur tile arbitrari topolog surfac wang tiles. render techniques, pp. 99104, 2005. [13] e. galin, a. peytavie, n. marechal, e. guerin. procedur gener roads. graphic forum (proceed eurographics), 29(2):429438, 2010. [14] d. s. goodsell. insid live cell. trend biochem sciences, 16:203206, 1991. doi: 10.1016/0968-0004(91)90083-8 [15] s. greuter, j. parker, n. stewart, g. leach. real-tim procedur gener pseudo infinit cities. proceed 1st interna- tional confer graphic interact techniqu australasia south east asia, graphit 03, pp. 87ff. acm, new york, ny, usa, 2003. doi: 10.1145/604471.604490 [16] s. grottel, m. krone, c. muller, g. reina, t. ertl. megamol prototyp framework particle-bas visualization. visual graphics, ieee transact on, 21(2):201214, 2015. doi: 10. 1109/tvcg.2014.2350479 [17] g. gruenert, b. ibrahim, t. lenser, m. lohel, t. hinze, p. dittrich. rule-bas spatial model diffusing, geometr constrain molecules. bmc bioinformatics, 11(1):307, 2010. doi: 10.1186/1471 -2105-11-307 [18] j. halton. effici certain quasi-random sequenc point evalu multi-dimension integrals. numerisch mathematik, 2:8490, 1960. [19] r. hoetzlein. fast fixed-radiu nearest neighbors: interact million- particl fluids. gpu technolog conference, p. 18, 2014. [20] s. hornus, b. levy, d. lariviere, e. fourmentin. easi dna model graphitelifeexplorer. plo one, 8(1):112, 01 2013. doi: 10.1371/journal.pone.0053609 [21] w. im, j. liang, a. olson, h.-x. zhou, s. vajda, i. a. vakser. chal- leng structur approach cell modeling. journal molecular biology, 428(15):29432964, 2016. doi: 10.1016/j.jmb.2016.05.024 [22] s. jo, j. b. lim, j. b. klauda, w. im. charmm-gui membran builder mix bilay applic yeast membranes. bio- physic journal, 97(1):5058, 2009. doi: 10.1016/j.bpj.2009.04.013 [23] g. t. johnson, l. autin, m. al-alusi, d. s. goodsell, m. f. sanner, a. j. olson. cellpack: virtual mesoscop model visual structur system biology. natur methods, 12(1):8591, 2015. [24] g. t. johnson, l. autin, d. s. goodsell, m. f. sanner, a. j. olson. epmv emb molecular model profession anim softwar environments. structure, 19(3):293303, 2011. [25] g. t. johnson, d. s. goodsell, l. autin, s. forli, m. f. sanner, a. j. olson. 3d molecular model hiv-1 virion gener cellpack. faradai discussions, 169:2344, 2014. [26] g. t. johnson s. hertig. guid visual analysi commu- nicat biomolecular structur data. natur review molecular cell biology, 15(10):690698, 10 2014. [27] i. kolesar, j. parulek, i. viola, s. bruckner, a.-k. stavrum, h. hauser. interact illustr polymer three-level model fusion. bmc bioinformatics, 15(1):345, 2014. doi: 10.1186/1471-2105-15-345 [28] b. kozlkova, m. krone, m. falk, n. lindow, m. baaden, d. baum, i. viola, j. parulek, h.-c. hege. visual biomolecular struc- tures: state art revisited. graphic forum, 2016. doi: 10. 1111/cgf.13072 [29] l. krecklau, j. born, l. kobbelt. view-depend realtim render procedur facad high geometr detail. graphic forum, 32(2pt4):479488, 2013. doi: 10.1111/cgf.12068 [30] m. a. lomize, a. l. lomize, i. d. pogozheva, h. i. mosberg. opm: orient protein membran database. bioinformatics, 22(5):623 625, 2006. [31] a. lu, d. s. ebert, w. qiao, m. kraus, b. mora. volum illustr wang cubes. acm transact graphics, 26(2):11, 2007. doi: 10.1145/1243980.1243985 [32] z. lv, a. tek, f. da silva, c. empereur-mot, m. chavent, m. baaden. game on, scienc - video game technolog help biologist tackl visual challenges. plo one, 8(3):e57990, 2013. [33] l. martnez, r. andrade, e. g. birgin, j. m. martnez. packmol: packag build initi configur molecular dynam simulations. journal comput chemistry, 30(13):21572164, 2009. doi: 10.1002/jcc.21224 [34] s. r. mcguffe a. h. elcock. diffusion, crowd & protein stabil dynam molecular model bacteri cytoplasm. plo compu- tation biology, 6(3):118, 2010. doi: 10.1371/journal.pcbi.1000694 [35] m. l. muzic, l. autin, j. parulek, i. viola. cellview: tool illustr multi-scal render larg biomolecular datasets. eurograph workshop visual comput biologi medicine, pp. 6170. digit library, eurograph association, 2015. [36] f. neyret m.-p. cani. pattern-bas textur revisited. proceed 26th annual confer graphic interact techniques, siggraph 99, pp. 235242. acm press/addison-weslei publish co., new york, ny, usa, 1999. doi: 10.1145/311535.311561 [37] t. reddi m. s. sansom. comput virology: insid out. biochimica et biophysica acta (bba) - biomembranes, 1858(7, b):16101618, 2016. doi: 10.1016/j.bbamem.2016.02.007 [38] m. schwarz h.-p. seidel. fast parallel surfac solid voxel gpus. acm transact graphics, 29(6):179:1179:10, 2010. doi: 10.1145/1882261.1866201 [39] d. sirohi, z. chen, l. sun, t. klose, t. c. pierson, m. g. rossmann, r. j. kuhn. 3.8 resolut cryo-em structur zika virus. science, 352(6284):467470, 2016. doi: 10.1126/science.aaf5316 [40] m. steinberger, m. kenzel, b. kainz, p. wonka, d. schmalstieg. on- the-fli gener render infinit citi gpu. graphic forum, 33(2):105114, 2014. doi: 10.1111/cgf.12315 [41] m. tarini, k. hormann, p. cignoni, c. montani. polycube-maps. acm transact graphics, 23(3):853860, 2004. doi: 10.1145/1015706. 1015810 [42] a. vendeville, d. lariviere, e. fourmentin. inventori bac- terial macromolecular compon spatial organization. fem microbiolog reviews, 35(2):395414, 2011. doi: 10.1111/j.1574-6976. 2010.00254.x [43] s. m. waldon, p. m. thompson, p. j. hahn, r. m. taylor. sketchbio: scientist 3d interfac molecular model animation. bmc bioinformatics, 15(1):334, 2014. doi: 10.1186/1471-2105-15-334 [44] t. waltemate, b. sommer, m. botsch. membran mapping: com- bine mesoscop molecular cell visualization. eurograph workshop visual comput biologi medicine. eurograph- ic association, 2014. doi: 10.2312/vcbm.20141187 [45] h. wang. prove theorem pattern recognition-ii. bell lab technic journal, 40(1):141, 1961. [46] b. g. wilhelm, s. mandad, s. truckenbrodt, k. krohnert, c. schafer, b. rammner, s. j. koo, g. a. claen, m. krauss, v. haucke, h. urlaub, s. o. rizzoli. composit isol synapt bouton reveal amount vesicl traffick proteins. science, 344(6187):10231028, 2014. doi: 10.1126/science.1252884 [47] a. willmott. fast object distribution. siggraph sketches, p. 80, 2007. [48] p. wonka, m. wimmer, f. sillion, w. ribarsky. instant architecture. acm transact graphics, 22(3):669677, 2003. doi: 10.1145/ 882262.882324