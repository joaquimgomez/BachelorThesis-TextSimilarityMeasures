effici shadow gpu-bas volum raycast timo ropinski jen kasten klau hinrich depart scienc univers mnster einsteinstra 62 48149 mnster, germani {ropinski, j_kast03, abstract gpu-bas raycast emerg defacto standard interact volum render off-the-shelf graphic hardware. theori techniqu easili extend shadow feeler order support shadows, obviou approach major impact render performance. paper investig shadow extens gpu- base volum raycast compar respect qualiti performance. particular, consid shadow rays, shadow map deep shadow maps. techniqu address implement current graphic boards, compar visual result runtim behavior. keyword volum rendering, shadow generation, shadow mapping, deep shadow maps. 1 introduct volum render evolv matur area graphics. domain medic acquisit seismic sonographi techniqu produc volumetr data set explor inter- actively. immedi visual feedback good percept spatial relationship impor- tant. shown light model major impact spatial comprehens [lb00]. diffus interreflect shadow serv import depth cue [ssmk05]. volum ren- dere techniqu develop recent year mainli goal achiev interact frame rates, objec- tive realist render neglected. interact volum render possibl stan- dard graphic hardwar [kw03] time strive produc realist imag order sup- port better spatial comprehension. paper focu shadow algorithm integr volum render order provid addit depth cue (see figur 1). consid particu- lar algorithm implement potenti permit interact shadowing. how- ever, effici shadow gener import adapt techniqu volum render tech- niqu exploit imag generation. dif- permiss digit hard copi work person classroom us grant fee provid copi distribut profit commerci advantag copi bear notic citat page. copi otherwise, republish, post server redistribut lists, requir prior specif permiss and/or fee. copyright union agenc scienc press, plzen, czech republ ferent algorithm propos slice-bas volum render [kphe02], concentr techniqu suitabl integr shadow gpu-bas volum raycast [kw03], gpu-bas volum raycast emerg state-of-the-art volum render techniqu recent vol- um render frameworks. benefit gpu- base raycast includ easi flexibl im- plementation, state gpu-bas ray- cast allow easi integr shadow effects. however, brute forc approach shadow truli consid easi integrate, effi- cient all. fact, adapt shadow feeler rai known convent raytracers, downsides. provid reader detail knowledg shadow volum render- ing, paper review differ shadow algorithm implement context gpu-bas vol- um raycasting. particular compar brute forc approach, i.e., cast shadow rays, shadow map techniqu gpu-bas raycast deep shadow maps. remaind paper structur follows. section 2 discuss relat work regard- ing shadow gener specif address algorithm suitabl interact volum rendering. section 3 implement shadow algorithm discussed, compar section 4. paper conclud section 5 give overview futur work. 2 relat work underli gpu-bas volum raycast tech- nique, follow call gpu-bas raycasting, introduc roettger et al. [rgwe03]. figur 1: engin data set (256256128 voxel) render phong shade combin shadow mapping. krger westermann propos extens better exploit capabl current graphic hardwar [kw03]. gpu-bas raycast enabl effici volum render commod graphic hardwar cast rai volum data set, repres 3d texture. determin entri exit point rai bound box volum data set render color code manner, valu rgb color channel interpret volum textur coordinates. shadow algorithm develop past. crow propos shadow volum tech- niqu gener shadow scene contain polygon data [cro77]. comput shadow object, silhouett extract extrud di- rection light rai order gener shadow polygon form shadow volum object. render object test li insid outsid shadow volume, determin object shadowed. polygon natur algorithm, suit volum rendering. common approach gener shadow render polygon data shadow map present 1978 william [wil78]. shadow map image-bas approach exploit addit render pass scene render light sourc point view order determin structur closest light source. knowledge, fragment- base shadow test introduc main ren- dere pass, i.e., fragment test awai light sourc correspond- ing texel shadow map. shadow map allow effici shadow fragment basis, support semi-transpar occlud volum rendering. order address semi- transpar structur opac shadow map serv stack shadow maps, store alpha valu instead depth valu shadow map [kn01]. compact represent semi-transpar occlud deep shadow map [lv00]. data structur consist stack textures, con- trast opac shadow maps, approxim shadowfunct store textures. possibl approxim shadow fewer hardwar resources. deep shadow map appli volum render [hksb06]. paper propos altern implementation. work shadow slice-bas volum render approach [br98], knowledg integr shadow gpu- base raycasting, consid state-of-the- art volum render technique, address far. however, similar rai paradigm, note shadow integr volum ray-trac system [wkb+02, wfms05]. overview techniqu [mfs06]. previous cite work pa- focu volum rendering, men- tion research address combin polygon volumetr data consid light interact [zxc05]. soft-shadow tech- niqu [cd03, zc03, hlhs03] cover paper, investig ex- tend volum rendering. 3 implement shadow techniqu section address implement shadow- ing techniques, compar section 4. review concept implement detail shadow rai (see subsect 3.1), imple- mentat shadow map exploit effici gpu-bas raycast (see subsect 3.2) de- scribe improv deep shadow map implement (see subsect 3.3). 3.1 shadow rai shadow rai obviou wai integr shadow gpu-bas raycaster. sam- ple view rai shadow feeler sent light sourc order determin current sampl shadowed. implement differ variat shadow technique. support opaqu occlud- er only, shadow feeler cast sampl reach intens exce shadow thresh- old. sampl li shadow feeler, current sampl assum lie shadow. however, fact occurr sampl exceed shadow threshold taken account, shadow binari effect, i.e., sampl shadow unshadowed. achiev differ figur 2: hit point color-cod volum co- ordin seen light sourc (left) re- sult depth map (right). map resolut 512 512 texel gener render visibl human head data set (see figur 8). visual results, shadow threshold chang gui. straight-forward extens support semi- transpar occlud incorpor intens sampl shadow feelers. cast shadow feelers, render integr evalu sampl intens consid alpha valu describ degre absorption. earli ray-termin opaqu occlud only, techniqu recogniz impact performance. shadow rai techniques, shadow feeler need cast sampl view ray. runtim directli proport screen resolut sampl rate. especi high qualiti imag desir prevent interact frame rates. combin shadow rai techniqu allow opaqu occlud render 3d textur function abl cach re- sult shadow feelers: cast shadow feeler sample, result shadow valu store shadow lookup volume. cach shadow feeler need cast light sourc occlud changed. 3.2 shadow map shadow map altern approach shadow rai support opaqu occluders. section shadow map implemen- tation adapt gpu-bas raycasting. analog gener shadow map approach (see subsec- tion 2), gener depth map order store light sourc visibility. comput hit po- sition seen light sourc us comput light sourc distanc (see figur 2). render polygon model depth valu properli defined. contrast, volum render pro- vide depth valu general. intro- duce shadow threshold value, control gui. intens valu repres opaqu geometri changed, con- tent gener shadow map. exampl shadow map shown figur 2 resolut viewport, i.e., 512 512 pixel, allow gener- at shadow introduc alias artifact (see figur 8). comparison shadow rays, shadow map expect run faster, light sourc visibil- iti need recalcul sample, light rai only. result fact semi-transpar occlud supported. how- ever, benefit shadow map soft shadow approxim exploit percentag closer filter [rsc87]. demonstr figur 3, visibl human torso data set render both, hard shadow (left) fake soft shadow (right). furthermore, shadow map combi- nation polygon model support easily, geometri repres shadow map. 3.3 deep shadow map mention above, deep shadow map allow captur shadow semi-transpar occluders. demonstr purpos appli imple- mentat simpl synthet scene consist 128 128 128 voxel (see figur 4). blue ball, set semi-transpar modifi transfer function, cast transpar shadow wall. differ shadow opaqu purpl box noticed, especi look shadow borders. implement deep shadow map consist layers, shown right fig- ur 4. similar approach propos [hksb06], exploit current graphic hardwar order gen- erat shadow layer on-the-fli multipl render targets. current graphic hardwar al- low address render target sin- figur 3: visibl human torso data set (256 256512 voxel) render hard shadow (left) fake soft shadow shadow map ex- ploit percentag closer filter (right). figur 4: synthet scene (128 128 128 voxel) render deep shadow mapping. shadow semi-transpar blue ball correctli captured. imag right success layer deep shadow map. gle pass, us render target creat deep shadow layer perform simpl chan- nel splitting. origin deep shadow map ap- proach [lv00] store overal light intens layer, store absorpt given accumul alpha valu analog volum render inte- gral. shadow ray, analyz alpha func- tion, i.e., function describ absorption, approxim linear functions. unlik implement describ [hksb06] restrict depth interv approxim linear function maximum number samples, case 255 samples. necessari order termin criterion fragment shader perform processing. however, determin current ana- lyze voxel approxim suffici linear function, smaller depth interv considered. thus, approxim work follows. initially, hit point shadow rai computed, similar shadow map describ above. next, distanc light sourc hit point alpha valu posit store layer deep shadow map. hit position, alpha valu usual equal zero shadow threshold set accordingly. start hit point, travers shadow rai check iter wether sampl encount far approxim linear function. case done, distanc previou sam- ple light sourc accumul alpha valu previou sampl store layer deep shadow map. repeat layer deep shadow map created. light sourc distanc alpha valu store success channels, i.e., r g b a. thus, repres shadow layer rgba texture. however, illus- tration purposes, wrote valu r g channel gener pictur shown fig- ur 4. determin wether current analyz sampl approxim linear function error valu introduced. analog origin deep shadow map techniqu [lv00], error valu constrain varianc approximation. ad (resp. subtracting) error valu sam- ple position. alpha function lie anymor rang given error value, new segment approxim linear function started. effect choos small error valu shown figur 5. seen, small error valu result close approximation, lay- er suffici anymor repres shadow rai have higher depth complexity. especi regions, occlud intersect shadow ray, shadow artifact appear. obvious drawback avoid introduc addit shadow lay- ers. allow precis approxim shadow function, result de- creas render perform addit render- ing pass required. similar previou techniques, com- bine deep shadow map algorithm genera- tion shadow volume. thus, shadow change, shadow valu directli fetch 3d textur sample. figur 5: differ error valu deep shadow map- ping: 0.00005 (left), 0.01 (right). artifact appear small error values. shadow mode rc rc shadow rai (b) 7.98 7.98 shadow rai (a) 6.70 6.70 shadow rai (b + pp) 4.25 14.90 shadow map (b) 12.50 15.00 deep shadow map (a) 10.00 14.90 deep shadow map (a + pp) 8.85 14.90 tabl 1: averag frame rate differ tech- niqu captur geforc 8800gtx graphic board optim graphic settings. 4 perform result compar capabl limit discuss shadow technique, con- duct perform tests. script anima- tion let virtual camera rotat en- gine data set shown figur 1. data set res- olut 256256128 voxel render standard desktop computer, have intel core2 cpu 6600 run 2.40 ghz, 2 gb main memory, nvidia geforc 8800gtx graphic board. result perform test shown tabl 1 tabl 2; tabl 1 show frame rate graphic driver tune achiev maxi- mum quality, tabl 2 show result set- ting driver maximum performance. option allow acceler textur fetches, vast perfor- manc gain achieved, major displai arti- fact notic (see tabl 2). differ implement compar tabl version shadow rays, shadow map version deep shadow maps. iden- tifier denot semi-transpar occlud alpha valu unequ 1 supported, b mean opaqu occlud supported. pp mean shadow valu comput frame store 3d texture, later fetch render success frames. cach mechan render succes- sive frames, camera posit changed. rc mean shadow comput frame, i.e., light sourc object modified. thus, frame rate shown column rc on expected, light sourc and/or object changed, col- umn rc show frame rate in- stanc camera modifi shadow change. impact techniqu data structur store shadow- ing state, shadow rai travers knowledg prior frame exploit rendering. result indic confin shadow rai support opaqu occlud ma- shadow mode rc rc shadow rai (b) 10.03 10.03 shadow rai (a) 10.00 10.00 shadow rai (b + pp) 5.59 46.00 shadow map (b) 29.08 45.50 deep shadow map (a) 15.76 34.50 deep shadow map (a + pp) 13.06 45.20 tabl 2: averag frame rate differ tech- niqu captur geforc 8800gtx graphic board optim graphic settings. jor impact frame rates. however, ren- der 3d textur function order gener 3d shadow lookup textur major influenc performance. recomput 3d shadow textur frame, slow sig- nificantly. fact render 3d textur function allow render slice 3d textur another. however, frequent recomput required, frame rate improv pp. investig far shadow recomput predict certain case order de- cide 3d shadow textur gener- at not. shown tables, shadow map allow frame rate superior achiev shadow rays. fact 3d tex- ture fetch expens oper current graph- ic boards. thus, opaqu occlud sup- ported, shadow map definit techniqu choice. semi-transpar occlud taken account, deep shadow map allow per- formanc gain. however, gener 3d shadow tex- ture benefici shadow rays. reason probabl fact shadow rai oper 3d textur any- way, deep shadow map implement us 2d textur pp disabled. comparison shadow map deep shadow map opaqu semi-transpar occlud- er shown figur 6. figur 7-10 visual comparison discuss shadow techniqu shown differ data sets. compar unshadow images, shadow result higher degre realism object appear flat. shadow rai deep shadow map al- low captur shadow semi-transpar occluders, shadow map support opaqu occlud only. seen especi figur 8 figur 9, deep shadow map introduc artifact oc- cluder structur present. shadow structur transpar effect ob- ject opaque. result fact ap- proxim alpha function exploited. espe- figur 6: volum render synthet scene (256 256 256 voxel) shadow map (left) deep shadow map (right). transfer function chang techniqu order chang ball opaqu semi-transparent. shadow map suffici correctli mimic shadow semi- transpar shadow casters. cialli structur diminish approxim long depth intervals. 5 conclus futur work paper compar differ techniqu combin shadow gpu-bas raycasting. expected, abl obviou wai gener shadows, i.e., cast shadow rai rai trace systems, far opti- mal technique. however, deep shadow map- ping techniqu capabl plau- sibli captur shadow cast semi-transpar ob- jects. propos effici implement deep shadow maps, suffici gener deep shadow map layer singl render pass. deep shadow map depend chosen er- ror values, data set dependent, consid best solut gener case. especi fine structur cast shad- ows, deep shadow map requir addit effort provid suffici results. however, perform improv propos paper carefulli choos error value, deep shadow map- ping produc convinc results. identifi drawbacks, research interact shadow techniqu need future. examin far deep shadow map extend support fine struc- ture cast shadow introduc visual arti- facts. furthermore, investig far combin exist shadow techniqu help order simul shadow wider rang applications. simpl extens propos deep shadow map techniqu integr color shadows. lot research target shadow algo- rithm polygon data sets, examin far concept transfer volum data sets. instance, render soft shadow volumetr data set addressed. acknowledg work partli support grant deutsch forschungsgemeinschaft (dfg), sfb 656 mobil mnster, germani (project z1). present concept integr voreen volum render engin (www.voreen.org). visibl human anatom data set licens nation librari medicin ncat data set gener 4d ncat phantom. refer [br98] uw behren ralf ratering. ad shadow texture-bas volum ren- derer. vv 98: proceed 1998 ieee symposium volum visualization, page 3946. acm press, 1998. [cd03] eric chan frdo durand. render- ing fake soft shadow smoothies. egrw 03: proceed 14th eurograph workshop rendering, page 208218, aire-la-ville, switzer- land, switzerland, 2003. eurograph as- sociation. [cro77] franklin c. crow. shadow algorithm graphics. siggraph 77: proceed 4th annual con- ferenc graphic inter- activ techniques, page 242248. acm press, 1977. [hksb06] marku hadwiger, andrea kratz, chris- tian sigg, katja bhler. gpu- acceler deep shadow map direct volum rendering. gh 06: proceed 21st acm sig- graph/eurograph symposium graphic hardware, page 4952, new york, ny, usa, 2006. acm press. [hlhs03] jean-marc hasenfratz, marc lapierre, nicola holzschuch, franoi sillion. survei real-tim soft shadow al- gorithms. graphic forum, 22(4):753774, dec 2003. [kn01] tae-yong kim ulrich neumann. opac shadow maps. proceed 12th eurograph workshop ren- dere techniques, page 177182, lon- don, uk, 2001. springer-verlag. [kphe02] joe kniss, simon premoze, charl hansen, david ebert. interact transluc volum render proce- dural modeling. vi 02: proceed- ing confer visual 02, page 109116. ieee so- ciety, 2002. [kw03] j. krger r. westermann. acceler- ation techniqu gpu-bas volum rendering. proceed ieee visualiza- tion 2003, 2003. [lb00] michael s. langer heinrich h. blthoff. depth discrimin shad- ing diffus lighting. perception, 29(6):649660, 2000. [lv00] tom lokov eric veach. deep shadow maps. siggraph 00: pro- ceed 27th annual confer graphic interact tech- niques, page 385392, new york, ny, usa, 2000. acm press/addison-weslei publish co. [mfs06] gerd marmitt, heiko friedrich, philipp slusallek. interact volum ren- dere rai tracing. eurograph state art reports, 2006. [rgwe03] s. roettger, s. guthe, d. weiskopf, t. ertl. smart hardware-acceler vol- um rendering. procceed eg/iee tcvg symposium visualiza- tion vissym 03, page 231238, 2003. [rsc87] william t. reeves, david h. salesin, robert l. cook. render antialias shadow depth maps. siggraph 87: proceed 14th annual con- ferenc graphic inter- activ techniques, page 283291. acm press, 1987. [ssmk05] mirko sattler, ralf sarlette, thoma mcken, reinhard klein. exploita- tion human shadow percept fast shadow rendering. apgv 05: pro- ceed 2nd symposium appli percept graphic visualization, page 131134. acm press, 2005. [wfms05] ingo wald, heiko friedrich, gerd mar- mitt, hans-pet seidel. faster iso- surfac rai trace implicit kd- trees. ieee transact visual graphics, 11(5):562572, 2005. member-philipp slusallek. [wil78] lanc williams. cast curv shad- ow curv surfaces. siggraph 78: proceed 5th annual con- ferenc graphic inter- activ techniques, page 270274. acm press, 1978. [wkb+02] ingo wald, thoma kollig, carsten benthin, alexand keller, philipp slusallek. interact global illumin fast rai tracing. egrw 02: pro- ceed 13th eurograph work- shop rendering, page 1524, aire-la- ville, switzerland, switzerland, 2002. eu- rograph association. [zc03] caixia zhang roger crawfis. shad- ow soft shadow particip media splatting. ieee transact visual graphics, 9(2):139149, 2003. [zxc05] c. zhang, d. xue, r. crawfis. light propag mix polygon vol- umetr data. cgi 05: proceed graphic intern 2005, page 249256, washington, dc, usa, 2005. ieee society. figur 7: ncat phantom data set (128128128 voxel) render shadows, shadow rai (a), shadow map deep shadow map (from left right). figur 8: visibl human head data set (512512294 voxel) render shadows, shadow rai (a), shadow map deep shadow map (from left right). gener shadow map shown figur 2. figur 9: hand data set (244 124 257 voxel) render shadows, shadow rai (a), shadow map deep shadow map (from left right). semi-transpar shadow visibl shadow rai deep shadow maps. figur 10: bonsai data set (256 256 256 voxel) render shadows, shadow rai (a), shadow map deep shadow map (from left right).