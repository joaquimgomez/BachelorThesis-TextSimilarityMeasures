thesis.dvi ambient occlus shadow molecular graphic robert easdon thesi submit degre master scienc univers east anglia septemb 2013 ambient occlus shadow molecular graphic robert easdon c copi thesi suppli condit consult understood recognis copyright rest author quotat thesis, inform deriv therefrom, publish author prior, written consent. abstract base visualis molecul produc earli 1950 aid research understand biomolecular structures. import consider molecular graphic softwar abil visualis 3d struc- ture molecul clear manner. recent advanc graphic led improv render capa- biliti visualis tools. capabl current shade languag allow inclus advanc graphic effect ambient occlus shadow greatli improv comprehens 3d shape molecules. thesi focus find improv solut real time render molecular graphic modern dai computers. method calcul ambient occlus hard soft shadow examin implement user complet experi navig larg molecular structures. acknowledg like thank primari supervisor dr. stephen laycock secondari supervisor dr. steven hayward support advic degree, help advanc graphic knowledge, understand biolog aspect research. thank particular dr. stephen laycock consist encourag guidance, help greatli past years. ii tabl content abstract acknowledg ii 1 introduct 1 1.1 motiv research object . . . . . . . . . . . . . . . . . . 3 1.2 contribut . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 1.3 thesi outlin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 1.4 terminolog . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 1.4.1 haptimol isa . . . . . . . . . . . . . . . . . . . . . . . . . 5 1.4.2 molecular graphic (mg) . . . . . . . . . . . . . . . . . . . . 5 1.4.3 opengl shade languag (glsl) . . . . . . . . . . . . . . . 5 1.4.4 screen space ambient occlus (ssao) . . . . . . . . . . . . 6 2 literatur review 7 2.1 introduct . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 2.2 earli molecular graphic comput . . . . . . . . . . . . . . . . 8 2.3 modern molecular graphic system techniqu . . . . . . . . . 14 2.4 ambient occlus . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23 2.4.1 geometri base method . . . . . . . . . . . . . . . . . . . . 27 2.4.2 image-spac techniqu . . . . . . . . . . . . . . . . . . . . . 30 2.5 shadow . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34 2.5.1 shadow volum . . . . . . . . . . . . . . . . . . . . . . . . . 36 2.5.2 shadow map . . . . . . . . . . . . . . . . . . . . . . . . . 38 2.6 conclus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41 3 techniqu render molecul space-fil repre- sentat 43 3.1 introduct . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43 3.2 haptimol isa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44 3.3 rai cast 2d billboard . . . . . . . . . . . . . . . . . . . . 45 3.3.1 point sprite . . . . . . . . . . . . . . . . . . . . . . . . . . . 50 iii iv 3.4 cull molecul clip plane arbitrari angl . . . . 50 3.4.1 multipl clip plane . . . . . . . . . . . . . . . . . . . . . 53 3.5 clip molecul navig cube . . . . . . . . . . . . . . . . 56 3.6 conclus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59 4 ambient occlus molecul space-fil represent 62 4.1 introduct . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62 4.2 rai trace ambient occlus . . . . . . . . . . . . . . . . . . . . . 63 4.2.1 singl sampl rai trace ambient occlus . . . . . . . . . 63 4.3 screen space ambient occlus . . . . . . . . . . . . . . . . . . . . . 66 4.4 analyt calcul ambient occlus sphere . . . . . . 67 4.4.1 implement decis . . . . . . . . . . . . . . . . . . . . 69 4.5 hybrid ambient occlus . . . . . . . . . . . . . . . . . . . . . . . . 71 4.6 comparison ambient occlus techniqu . . . . . . . . . . . . . 72 4.7 defer render . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76 4.8 conclus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79 5 real time shadow molecul space-fil represent 81 5.1 introduct . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81 5.2 gpu rai trace glsl . . . . . . . . . . . . . . . . . . . . . . 82 5.2.1 grid creation . . . . . . . . . . . . . . . . . . . . . . . . . . . 83 5.2.2 grid travers . . . . . . . . . . . . . . . . . . . . . . . . . . . 84 5.2.3 grid storag . . . . . . . . . . . . . . . . . . . . . . . . . . . 84 5.2.4 perform . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86 5.3 aid user interact shadow cast probe light . . . . . 90 5.4 dynam shadow navig cube explor . . . . . . . . . . 91 5.5 soft shadow space-fil molecul rai trace . . . . . 96 5.6 futur advanc render space-fil molecul path trace . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102 5.7 conclus . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106 6 conclus 107 6.1 discuss conclus . . . . . . . . . . . . . . . . . . . . . . . 107 6.2 futur work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111 bibliographi 113 list tabl 3.1 compar render time small molecule, 1crn, number larger molecul clip atom method. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59 4.1 rai trace ambient occlus half resolution. . . . . . . . 65 4.2 ao data layout. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69 4.3 analyt ambient occlus vari number occlud atoms. 70 4.4 comparison ambient occlus techniqu presented. . . 72 4.5 g-buffer data layout. . . . . . . . . . . . . . . . . . . . . . . . . . . . 79 5.1 compar shadow calcul time small molecule, 1crn, number larger molecul clip atom method. . . . . . . . . . . . . . . . . . . . . . . . 95 5.2 comparison perform hard soft shadows. . . 102 5.3 path trace perform 100 sampl pixel, 2 light sources, light path allow bounc 3 time scene. render time seconds. . . . . . . . . . . . . . . . . . . . . . . . . . . . 106 v list figur 2.1 overview molecular model system, kluge lower left corner, space-fil model display. photo cour- tesi martin zwick. . . . . . . . . . . . . . . . . . . . . . . . . . . . 10 2.2 close view crt screen, kluge, globe devic control direct speed structur rotation. photo courtesi martin zwick. . . . . . . . . . . . . . . . . . . . . . . . . 10 2.3 stereoscop pair imag depict amylos polym gener ortep [joh65]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 2.4 diagram rai trace algorithm. view rai sent camera closest intersect point. rai test shadow illumin effect sent point. . . . . 16 2.5 random path ey rai second pass, unlik land exact spot store photon map. solut averag photon hit circumfer ey rai intersect point. . . . . . . . . . . . . . . . . . . . . . . . . . . 20 2.6 radios algorithom appli scene. pass add addit illumin scene. imag hugo elias. . . . . . . . . . . . . 20 vi vii 2.7 imag show qutemol arrai post-process techniqu enhanc depth perception. left imag show border atom help detect atom intersections. right imag show depth awar border line thick increas- ing base distance. left imag similar effect, us halo vari transpar achiev result. final right imag show effect combin am- bient occlus greatli aid user percept molecule. . . 24 2.8 illustr compar molecul render qute- mol standard render (left), self shadow (middle) ambient occlus render mode (right). right imag us ambient occlu- sion darken area molecul light access, give better percept depth creat better 3d appear- anc molecule. imag combin qutemol offer provid user cue structur molecule. 25 2.9 disk-bas ambient occlus techniqu bunnel [bun05]. disc el- ement pre-calcul mesh data, analyt calcul ambient occlus valu vertex run time. . . . . . . . 29 2.10 result imag mittr implement ssao [mit07]. in- correct shade geometri clearli visibl occlusion, result overli dark image. correct later implemen- tations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30 2.11 exampl shadow abl chang percept object posit space. shadows, ball appear positions. however, shadows, ball clearli differ posit images. . . . . . . . . . . . . . . . . . 35 2.12 illustr shadow volum technique. yellow line indi- cate triangl mesh repres shadow volumes. point li insid mesh, said shadow. . . . . . . . . . . . 37 viii 2.13 shadow map process left right: scene camera viewpoint, scene light viewpoint, light shadow map project scene depth, area pixel fail depth test, final render scene shadows. . . . . . . 39 3.1 space-fil model n-octan c8h18 . . . . . . . . . . . . . . . . . 44 3.2 comparison tradit geometri (two images), rai cast (top right), creat circl window space (top left). . 46 3.3 rai posit p0 intersect sphere center c radiu r point p p . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47 3.4 graph compar perform point sprites, billboard align gpu, triangl mesh render molecul vari atoms, hundr ten thousands. . 49 3.5 imag sphere cut clip plane. left hand imag render initi intersect point ray- sphere intersection. center imag render intersect point ray-spher intersection. right hand imag show sphere alter appear like shell, natur solid look. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52 3.6 diagram plane intersect 2d billboard repre- sent sphere. red area fragment discard completely. green area show plane intersect pmin pmax. blue area sphere remain unchanged. . . . . . . 53 3.7 structur molecul clip clip plane. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54 3.8 protein cull clip plane. possibl pocket channel previous hidden view structure. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54 3.9 atom cull clip planes, front, right. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55 ix 3.10 graph show perform impact gpu ad clip- ping plane scene. clip plane posit 6 face navig cube (introduc section) molecul contain 58870 atoms. 327 atom left unclip navig cube clip plane added. perform test cull atom cpu highlight gpu perform impact algorithm describ section 3.4. . . . . 56 3.11 navig cube explor protein. dimens cube base usabl workspac device. . . . . . . . 57 3.12 figur illustr calcul bound cell nav- igat cube, find minimum maximum grid index. . . 58 3.13 imag clip navig cube achieved. left imag show molecule, 1adg, right imag includ uniform grid molecule. left imag highlight bound cell navig cube, whilst right imag show final result clip cube. . . . . . . . 60 4.1 rai trace ambient occlus 100 random sampl pixel. imag took 3 second generate. imag refer chapter. . . . . . . . . . . . . . . . . . . . 64 4.2 rai trace ambient occlus 1crn molecule, vari sampl resolutions. . . . . . . . . . . . . . . . . . . . . . . . . . 64 4.3 rai trace ambient occlus 1crn molecule, appli bilater filter remov nois caus reduc number samples. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65 4.4 screen space ambient occlus 1crn molecule, bilater blur. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67 4.5 ambient occlus sphere point surfac calcul know radiu sphere distanc sphere center surface. . . . . . . . . . . . . . . . . . . . . . . 68 4.6 result calcul ambient occlus white ray-trac spheres, equat 4.4.1. . . . . . . . . . . . . . 69 x 4.7 analyt ambient occlus 1crn molecule. . . . . . . . . . . 70 4.8 combin ambient occlus techniques. . . . . . . . . . . . 71 4.9 graph show perform calcul ambient occlus number techniques. . . . . . . . . . . . . . . . . . . . . . . 73 4.10 100 sampl resolution. . . . . . . . . . . . . . . . . . . . . . . 74 4.11 1 sampl half resolut blur. . . . . . . . . . . . . . . . . . . 74 4.12 ssao half resolut blur. . . . . . . . . . . . . . . . . . . . . 74 4.13 analyt techniqu 32 occlud atoms. . . . . . . . . . . . . . 75 4.14 hybrid solut rai trace analyt methods. . . . . . . . 75 4.15 hybrid solut diffus colours. . . . . . . . . . . . . . . . . . . 75 4.16 scene render g-buffer, store materi properti (left top), posit (left middle) normal (left bottom) scene. inform textur produc final image, seen right. . . . . . . . . . . . . . . . . . . . . . . . . . 80 5.1 represent 3d-dda algorithm. green line repres ray, highlight blue cell cell rai intersects. . . . 85 5.2 structur data map textur memory. base textur size 2048x2048 pixels, structur ensur perform rai trace calcul molecul hundr thou- sand atom size. . . . . . . . . . . . . . . . . . . . . . . . . . . 85 5.3 graph show perform calcul shadow singl direct light sourc molecul 1crn contain 327 atoms. grid cell densiti increased, calcul time drop dramat- ically. cell size indic select points. unit base van der wall radii, oxygen atom radius, example, have valu 15.2. . . . . . . . . . . . . . . . . . . . . . 87 5.4 relationship averag number atom cell number grid cell shown. clearli link number atom cell, shadow calcul time. cell size shown select points. . . . . . . . . . . . . . . . . . . . . . 89 xi 5.5 compar molecul look similar pattern perfor- manc relat number grid cells. abl choos optim cell size (indic select points) initialis grid lead signific memori save rel small increas shadow calcul time. . . . . . . . . . . . . . . . . . . . 90 5.6 figur show grid travers point light. light grid cell reached, stop traversal. . . . . . . 92 5.7 red area highlight molecul show pixel point light illuminates. limit shadow calcul pixel ensur unnecessari processing, improv perfor- mance. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92 5.8 imag show probe sphere (dark blue) point light center. attenu light set illumin atom molecul close proximity, give user better sens depth navig molecular structure. however, shadows, area receiv light thought occlud atom (highlight arrows). . . . . . . . 93 5.9 image, shadow enabled. posit probe sphere rel atom clearer, allow user navig structur confidence. . . . . . . . . . . 93 5.10 light blue cell indic bound cell navig cube. shadow rai (the green line), travers grid outsid workspace, instead travers entir grid. . . . . . . . . . . 94 5.11 backbon structur molecul render user better understand molecular structure. space-fil atoms, complex light shadow calculations, limit atom insid navig cube. . . . . . . . . . . . . . . . . . 96 5.12 inner sphere cast umbra shadow. outer sphere creat larger shadow, area sphere creat penumbra. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97 xii 5.13 produc soft shadow effect, surround sphere center c radiu r, larger sphere radiu rb. scale shadow valu base distanc d shadow rai center sphere. . . . . . . . . . . . . . . . . . . . . . . . . . . . 99 5.14 exampl tradit hard shadows, calcul cast singl shadow rai point light source. shadow rai collid sphere molecule, diffus specular term set zero, leav ambient term light pixel. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100 5.15 hard shadow replac soft shadow techniqu describ above. smooth chang shadow unshadow area seen, aid spatial percept scene. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100 5.16 new render techniqu integr hapti- mol isa software. user interact molecul control- ling probe sphere phantom omni haptic device. . . . . . 101 5.17 molecul render path tracing. light path allow bounc time scene. atom given differ materi properties, help quickli distinguish element types. reflect seen red oxygen atom blue nitrogen atoms. . . . . . . . . . . . . . . . . . . . . . . . . . . . 103 5.18 diagram illustr colour pixel determin path tracing. light sourc directli sampl intersect point. indirect illumin gather light path, base materi brdf. . . . . . . . . . . . . . . . . . . . . . . 104 chapter 1 introduct gener imag molecul appear 1950 [aw59]. point, molecul hand drawn model physic objects, studi structur biologi biochemistry. model limit practic complex construct larg space consumed. molecul consist thousand individu atoms, make hard studi area model occlud atoms. known time, comput hold answer problem displai atom structur molecules. earli comput hardware, devic displai images, devic interact input limit graphic engin time. however, comput power increas new graphic hardwar developed, real time rate achiev allow interact molecular structur person computers. explor molecul longer requir physic model expens larg mainfram systems. research abl load newli develop graphic program devices, allow effici work. appreci 3d form molecul 2d imag displai difficult. follow advanc graphic algorithm hardware, improv light stereoscop techniqu commonli emploi molecular visualisa- tion software. techniqu us aid biologist understand 3d 1 2 structur protein enhanc simul depth image. technique, popularis game industri seen molecular visualisa- tions, ambient occlus [zik98]. ambient occlus shade method graphic help improv local illumin model take account attenu light occlusion. attempt approxim wai light radiat real life, produc effect contact shadows, unattain standard light methods. basic approxim global illumination, calcul faster whilst enhanc visual represent scene. ambient occlus commonli calcul offlin render softwar cast- ing rai direct point surface. rai intersect geometri scene reach background sky increas bright surface, rai intersect object scene contribut illumination. result point surround larg amount geometri ren- dere darker point littl geometri visibl hemisphere. attempt incorpor ambient occlus real time applic seen number tech- niqu developed, imag space approxim algorithm introduc mittr [mit07], reduc calcul time effect. although, real time approximations, techniqu tend suffer inaccuraci lower qualiti rai trace approach. whilst ambient occlus deal light specif direct source, desir handl light clear origin, torch sun. real time graphic applic today, shadow map popular choic gener shadow scene. shadow map pre-rend scene real time scene graphic applications, includ molecular graphic programs. shadow 3 creat test pixel visibl light source, compar z-buffer light sourc view, store form texture. eas implement combin lack knowledg need scene ge- ometri techniqu popular choic real time graphic applications, includ molecular visualis programs. however, addit techniqu re- quir correct visibl alias shadow edg project shadow map texel cover notic larg area screen space. user best experi visualis molecular structures, ambient occlus shadow method includ molecular graphic packag enhanc user interact structure. however, challeng creat real time graphic applic larg biomolecul varieti hardware. render algorithm need maintain frame rate 30 hertz ensur simul remain interactive. simpl task consid molecul contain thousand atoms. 1.1 motiv research object softwar program exist attempt convei 3d form biomolecules. however, manag provid sens depth imper help nav- igat larg molecular structur understand geometri relat function. complex light techniques, ambient occlusion, achiev high qualiti visual represent vital aid user percept molecule, produc result commonli limit imag gener offline. however, speed render highest import real time applications, modern dai comput give expect fast smooth interact frame rate. motiv mind, aim thesi improv clariti 4 exist haptimol isa softwar bring easier understand 3d shape structur larg molecul complex proteins, whilst produc real time visualisation. achiev implement advanced, efficient, light techniqu includ ambient occlusion, hard soft shad- ows, kei improv realism molecular visualisation. techniqu develop incorpor haptimol isas, improv tradit render methods. haptimol isa softwar packag provid haptic render molecular graphic deeper appreci shape biomolecul augment sens sight touch [shl09]. spher- ical probe size water molecule, roll biomolecul equival explor solvent access surface. 1.2 contribut main contribut thesi include; investig visualisa- tion problem associ render larg structur encount biomolecular study. technic comparison popular ambient occlus shadow techniqu perform molecular graphics. rai trace gpu us opengl graphic librari glsl shade languag in- vestig method creat effects, focuss space-fil molecular representation. know render sphere repres atom allow optimis allow real time perform technique. fi- nally, integr promis result exist softwar develop studi arbitrari size biomolecules. 5 1.3 thesi outlin chapter 2 give comprehens review histori graphic visu- alis molecules, move current method emploi solv problem associ it. chapter 3 look effici wai render space- fill represent molecules, clip plane implement remov atom view whilst maintain realist visual represent molecule. chapter 4, varieti ambient occlus method compar base perform visual quality. shadow plai kei role 3d percept graphics, chapter 5 cover shadow techniques, includ rai trace ap- proach gpu. thesi conclud chapter 6, includ section work extend research describ previou chapters. 1.4 terminolog 1.4.1 haptimol isa softwar develop thesis. explain section 3.2. haptic molelcular interact solvent access surface. 1.4.2 molecular graphic (mg) molecular graphic (mg) term studi molecul properti graphic representation. 1.4.3 opengl shade languag (glsl) opengl shade languag (glsl) high-level shade languag develop- er direct control graphic pipeline. allow increas flexibl render pipelin vertex fragment level. 6 1.4.4 screen space ambient occlus (ssao) screen space ambient occlus (ssao) render techniqu approxim graphic ambient occlus effect imag space. chapter 2 literatur review 2.1 introduct attempt solut real time render molecular graphic modern dai computers, import firstli understand problem came method emploi solv them. chapter focus review literatur relev molecular graphics, particular graphic techniques, ambient occlus shadows, focu thesis. section 2.2, earli exampl molecular graphic comput look help overview import molecular graphics. current popular molecular visualis system analys section 2.3, modern render techniqu develop applications. final section look graphic techniqu link directli thesis. section 2.4 discuss ambient occlusion, method appli light techniqu real time applications, good effect improv comprehens 3d shape molecules. finally, section 2.5 investig current method implement shadow 3d scene, look import person percept environment. 7 8 2.2 earli molecular graphic comput molecular graphic field visualis molecul properti graph- ical displai devic [iup]. us visualis molecules, model plai import role studi protein nucleic acids, al- low hypothes tested. molecular graphic assist drug design extrem import area research aid comput speed develop process. time computers, molecul model physic objects, best known dna model built rod sheet watson crick [wc+53]. physic model allow easi interactivity, tactile, visual aspect easili reproduc computers. however, render molecul standard method present graphic molecular data. practic build physic models, larg molecul possibl take week build. visualis good repres comput properti atom charg electrostat potential, need applic drug design. haptic devic emploi repro- duce miss tactil element physic models, appli molecular graphic main areas. teach structur biology, user explor area geometri extra sens touch [sws+03]. second applic particl steer haptic devic manipul molecular structur [bkb+07]. final haptic explor dock protein ligand [sb08]. combin 3d stereoscop displai realist light techniqu give illus depth, haptic improv visualis molecular graphic researchers. 1966 massachusett institut technolog (mit) comput graphic render molecular data crt display. project 9 mac (multi-access computer), earli mainfram [fc66], model build- ing program design work protein structur [lev66]. program allow anim interact molecular structure, 3d effect achiev rotat wirefram model constantli screen. figur 2.1 show overview molecular model system, visual displai known kluge left image. hardwar constraint limit system, offer small inter- action user trackball-lik devic control rotat speed molecul screen. storag process power time limit view structur simplifi version complex molecules. lack colour limit abil distinguish atom types. figur 2.2 provid close view display, input devic control molecul direct speed rotation. levinth notic larg potenti comput displai interact larg molecular structures, earli know comput advanc power decreas price larg scale. import creation fulli realis time, program pave wai futur develop molecular graphics. 1960s, carrol k. johnson oak ridg nation laboratori re- leas ortep (oak ridg thermal ellipsoid plot program), program produc stereoscop draw molecular crystal structur pen-plott (a vector graphic print device) [joh65]. abl produc ball-and-stick illustr crystal structur qualiti high public uses. appeal featur applic abil produc stereoscop pair images. techniqu gener 3d view imag creat singl imag eye. stereo render aid greatli visualis complex arrang 10 figur 2.1: overview molecular model system, kluge lower left corner, space-fil model display. photo courtesi martin zwick. figur 2.2: close view crt screen, kluge, globe devic control direct speed structur rotation. photo courtesi martin zwick. 11 atoms, proteins. figur 2.3 show pair imag gener ortep. later revis ortep ad featur colour addit output for- mats, however, remain static model package. interact molecul achiev command line, updat imag base certain inputs, mean provid true interact experience. figur 2.3: stereoscop pair imag depict amylos polym gener ortep [joh65]. 1990s, technolog develop hardwar allow high qualiti visualis molecul person computers. avail person (pc) remov need expens larg mainfram systems, requir- ing full-tim staff maintain. research load molecular graphic program gener purpos devic explor molecul desired, allow effect effici work. rasmol, develop roger sayl [sb92] 1992, import develop molecular graphic field time. rasmol, visualis program 12 requir expens dedic workstat run, mean easili acces- sibl research larg cost involved. rasmol quickli wide tool creat imag research publications, educ purposes. sourc code open source, continu revis year releas contributor support differ type computers. sayl origin undergradu degre problem depth percept solid object graphics. appli molecular graphic particular, lead creation shadow program gener shadow hard sphere molecular representations. rasmol render algorithm work calcul visibl surfac scanlin z-buffer algorithm similar describ porter [por78], calcul shadow pixel rai trace [whi80]. shadow provid enhanc 3d effect help discoveri pocket molecular structure, research look geometri molecul relat function. rasmol effici render code number molecular visu- alis programs, includ mdl chime [chi]. chime, avail 1996, take 16,000 line line code sayl origin source, thousand ad mdl add new featur whilst improv user ex- perience. chime differ rasmol chime web browser plug-in run insid browser, visualis happen directli page website. websit provid abil run plug-in displai molecul provid author site, dedic websit interfac provid support show molecul desired, protein explorer. protein explor ideal beginners, goal program power chime avail scientists, educators, student alik [pro]. 13 rasmol-lik interfac help load navig structures, provid power chime, requir advanc technic knowledg larg time use. visual explor protein easier novic user conveni specialist users. chime prove effect rasmol present structur information, mainli plug-in accompani text kei web page. button text control chime function javascript web language, allow task automated, provid excel educ resource. neg featur chime code base releas publicly, allow extern code contribut new function program relevant. modern open-sourc molecular viewer came form jmol earli 2000 [jmo]. cross-platform program, run standalon java applic desktop, applet integr web page major browsers. offer altern chime plug-in longer development. basic understand web technolog html, jmol easili incorpor websit displai molecular graphic visualis wide audience. similar rasmol, jmol us custom render engin optimis specif draw core geometr primit molecular representations. instead univers graphic api directx opengl, build custom render engin allow effici render engin need gener graphics. mean jmol perform high-perform 3d render hardwar requir need 3d acceler plug-ins, make highli adopt tool today. jmol improv exist render system time rasmol, grow desir us advanc render techniqu 14 improv aesthet percept molecule. rapid advanc dedic graphic hardwar allow effect achiev real time rates. section look modern system emploi techniqu allow enhanc high qualiti public imag generated, interact studi molecular structures. 2.3 modern molecular graphic system tech- niqu modern molecular graphic applic commonli split render molecular data areas: real time offlin rendering. offlin render gener produc high qualiti imag structur publication, combin creat script animations. perform second prioriti imag qualiti pre-rendering, allow complex algorithm improv image. course, user interact impaired, typic molecular graphic program provid option simplifi interact display, offlin solut allow user creat high qualiti imag movies. visual molecular dynam (vmd) [hds96] molecular model visual- isat system, primarili design view analys result molecular dynam simulations. common theme molecular graphic applications, pro- gram us opengl [grob] render real time visualisations, incorpor extern render tool pov-rai [pov] renderman [stu], creat high qualiti rai trace imag public use. abl creat present qualiti images, analys molecul real time pymol [del02]. seen current industri standard molecular graphic software. opengl gener interact visualisations, pymol implement shadow map- ping shadow generation. offlin render creat pymol rai 15 trace engine, wide molecular imag scientif literature. rai trace graphic techniqu take differ approach render 3d scene tradit rasteris technique. rasteris algorithm take stream vertices, transform correspond 2d point viewer monitor, final transform 2d triangl fill appropri- ate. rai tracing, however, techniqu gener imag trace rai pixel imag plane simul effect encount object scene. techniqu capabl produc high degre realism, far higher popular rasteris method, come greater comput cost. common techniqu emploi real time graphic applications. however, rai trace abil simul wide varieti optic effects, reflection, refract scattering, wide tool us film special effect molecular graphic renders, imag render offline. rai trace algorithm render present arthur appel 1968 [app68], present gener consid rai casting, secondari rai shadow rai used. idea algorithm pixel, rai cast ey closest object scene intersect ray. materi properti effect light scene, algorithm determin shade object. simplifi assumpt surfac face light, light reach surfac block shadow. import advantag appel show rai cast offer older scan line algorithm abil easili deal non-planar surfac solids, cone spheres. mathemat surfac intersect ray, render rai casting. complex 16 object creat solid model techniqu easili rendered. figur 2.4: diagram rai trace algorithm. view rai sent camera closest intersect point. rai test shadow illumin effect sent point. import develop came turner whit 1980 [whi80]. whilst appel cast rai ey scene hit object, rai trace further. whit continu process. rai hit surface, gener new type rays: reflection, refraction, shadow. reflect rai continu mirror-reflect direct shini surface. intersect object scene closest object intersect seen reflection. refract rai travel transpar materi work similarly, addit refract rai enter exit material. shadow rai test surfac visibl light. rai trace intersect point light. opaqu object surfac light, surfac shadow light contribut shade. new layer rai calcul ad realism rai trace images, time calcul rai path scene meant minut hour produc singl frame. 17 advanc graphic hardware, fix function pipelin replac programm vertex fragment processors, graphic pipelin evolv gener programm stream processor capabl simpl trian- gle rendering. purcel et al. show rai trace map graphic hardwar effici wai textur store scene structure, uni- form grid reduc intersect test [pbmh02]. note uniform grid enabl constant-tim access grid cell take advantag coher block memori gpu. however, optim acceler structur scene non-uniform distribut geometry. rel perform acceler structur rai trace studi widely. havran [hav00] compar number acceler structur varieti scene find k-d tree best gener purpos acceler structur cpu rai tracers. folei et al. [fs05] appli k-d tree acceler structur gpu rai trace show k-d tree yield far better perform uniform grid complex scenes. implement real time rai tracer credit 2005 sig- graph graphic confer remrt/rt tool develop brl-cad solid model [muu87]. brl-cad rai tracer known implement parallel network distribut rai trace achiev frame second render performance. then, consider effort research implement rai trace real time speed varieti purposes. research extend field molecular graphic marsalek et al. [mdg+10], work rai trace compon ballview. ballview biochem algorithm librari standalon molecular mod- ell visualis application. offer standard visualis model atoms, 18 bonds, surfac grid base visualisation. cebit 2009, ballview promin present complet integr real time rai trace technolog molecular viewer model tool, rtfact: real time rai trace library. best result however, high specif requir produc interact frame rate. drawback convent rai trace unrealist sharp natur reflec- tion shadows, us singl rai sampl domains. distribut rai tracing, call distribut rai trace stochast rai tracing, propos cook et al. [cpc84] take differ approach. us multipl rai sampl area lights, glossi diffus reflect effects, allow render soft phenomena soft shadows. shadow tradit rai trace discrete, limit us singl shadow rai pixel. produc shadow sharp edges, known hard shad- ows. shadow real world transit fulli shadow partial shadow gradual fashion. finit area real light sources, scatter light surfaces. model light sourc finit area, set rai cast random fashion project area light source, light transmit sourc surfac approx- imat ratio rai hit light sourc total number rai cast. course, rai need produc smooth results, lead lengthi render times. altern approach, path tracing, propos kajiya [kaj86], allow interact preview scene. instead expens accur estim radianc surfac interact seen distribut rai tracing, path trace combin larg number cheap individu inaccur sampl produc good estimate. produc fast noisi initi results. refin 19 time number sampl increases. power cpu gpu increased, rai trace path trace algorithm real time applications. aid matur gpgpu program toolkit cuda [cor] opencl [groa] gpu rai trace sdk optix [pbd+10]. rai trace method calcul illumin scene. photon mapping, develop jensen [jen96], two-pass global illumin algo- rithm approxim solv render equation. rai light sourc rai camera trace independ termin criterion met, connect second step produc radianc value. render pass, packet light, photons, cast scene light source. photon hit surface, intersect point incom direct store cach call photon map. second render pass, scene render mont carlo rai tracer, photon map estim radianc pixel produc final image. figur 2.5 illustr algorithm. advantag photon map easier solv global illumin prob- lem tradition hard solv observ standpoint, example: intersect small light sourc random bounces, simul refract light transpar substanc glass water. radios popular algorithm calcul global illumin com- puter graphics. introduc goral et al. [gtgb84], divid scene smaller surfaces, patches. patch consid diffus reflectors, emitt combin both. view factor comput pair patches, defin patch other. indic radiant light energi transfer patches. smaller patch accur result be, cost longer comput time. figur 20 figur 2.5: random path ey rai second pass, unlik land exact spot store photon map. solut averag photon hit circumfer ey rai intersect point. 2.6 illustr radios method. downsid radios unlik ren- dere method path tracing, handl type light paths, radios account path leav light sourc reflect diffus hit eye. radios base method gener solv complet render equation. figur 2.6: radios algorithom appli scene. pass add addit illumin scene. imag hugo elias. real time render mean ensur render frame comput fast allow viewer interact virtual environment. varieti tool librari avail help produc graphic real time, help advantag modern graphic hardware. new graphic techniqu allow higher qualiti 21 visual result achieved, maintain 30 hertz frame rate, gener consid minimum interact applications. qutemol open-sourc molecular visualis program focuss ap- ply modern render techniqu achiev comprehens arrai visual ef- fect [tcm06]. make heavi us modern graphic card featur includ pro- grammabl shader frame vertex buffers, help achiev effect real time rates. program us popular molecular represent visualisations: space-fill, atom repres spheres, ball-and-stick, bond atom displayed. effici method render model vital consid molecul contain thousand atoms. qutemol us techniqu call impostor greatli reduc geometri need repres atoms. impostor term us 2d geometri subtli replac real 3d object scene. impostor face camera, appear look natur angle. qutemol impostor procedur calcul fragment shader, mean look perfect regardless enlarg screen. reduct triangl need repres object translat signific perform gains, especi larg molecular structures, mean render time spent complex light effects. effici method botsch kobbelt [bk03], guennebaud et al. [gp+03] need vertex gener impostor. improv sigg et al. [swbg06] introduc method comput tight screen-spac bound box quadric vertex shader allow perspect warp seen tessel- late geometry. fragment gener rasteris box, ray-quadr intersect comput fragment shader classifi pixel belong- ing shape. avoid light calcul fragment subsequ 22 overdrawn (a drawback technique), defer shade [dws+88] emploi reduc light calcul need pixel. qutemol offer rang non-photorealist effect goal produc clearer, inform imag molecules. effects, in- spire artist style paint drawing, featur film video games. qutemol show effects, particularli edg highlighting, scientif visualis enhanc image. example, border edg atom help detect atom intersect (top left figur 2.7). simpl border detect achiev identi- fy polygon face awai viewer, colour darker shade. depth-awar border attempt bring inform structur initi way, line thick increas atom border distanc atom increases. effect right imag figur 2.7. qutemol featur depth-awar halo effect, halo irradi atom, strength effect indic depth distance. similar depth-awar border effect, map z-distanc transpar line thickness. illustr left imag figur 2.7. unlik pho- torealist techniques, effect gener fast compute, take advantag fragment shader perform fast per-pixel effects. offer non-photorealist effects, qutemol us common shade techniques, includ phong shade self-shadow shadow maps. however, includ advanc methods, ambient occlusion, consid challeng real time rendering. ambient occlusion, explor fur- ther section 2.4, prove particularli us improv imag clarity. qutemol, occlus factor comput gpu, store special for- mat textur allow us impostor technique, run-tim 23 cover atom surfaces. figur 2.8 show comparison light method avail- abl space-fil model. left imag render basic light equation, lack depth percept clearli issue. center im- ag show self-shadowing, similar rasmol render algorithm, improv depth cueing. right imag show ambient occlus provid signific improv depth perception. lower imag figur 2.8 show mix non-photorealist techniqu simpl global illumin model greatli improv percept model, provid help imag research purposes. thesi focuss graphic techniqu shown improv realism depth percept molecular graphic applications: ambient occlus cast shadows. vast research graphic community, look develop greater detail. 2.4 ambient occlus ambient occlus techniqu approxim indirect light reach point surfac object [zik98]. light reach surfac base light occlud object world. unlik local light effect light come directli light sourc taken account, ambient occlus global method, take account geometri scene. produc effect unattain standard light methods, contact shadows. basic approxim global illumination, calcul far faster, abl enhanc visual qualiti scene. popular research technique, graphic applic video game molecular 24 figur 2.7: imag show qutemol arrai post-process techniqu enhanc depth perception. left imag show border atom help detect atom intersections. right imag show depth awar border line thick increas base distance. left imag similar effect, us halo vari transpar achiev result. final right imag show effect combin ambient occlus greatli aid user percept molecule. 25 figur 2.8: illustr compar molecul render qutemol standard render (left), self shadow (middle) ambient occlus render mode (right). right imag us ambient occlus darken area molecul light access, give better percept depth creat better 3d appear molecule. imag combin qutemol offer provid user cue structur molecule. 26 visualis programs. ambient occlus help perceptu clue spatial proxim geome- try scene. langer bulthoff [lb00] depth discrimin diffus light superior predict standard direct illumination. combin static ambient dynam light simpl multipl give perceptu plausibl result high frame rates. occlus ap point p surfac normal n comput integr visibl function hemispher respect project solid angle: ap = 1 vp, (n ) d (2.4.1) vp, visibl function p, defin zero p occlud direct otherwise, d infinitesim solid angl step integr variabl . classic ambient term [pho75] commonli combin 1 ap, improv visual qualiti greatli tradit constant value. vast number techniqu develop approxim integral. simpl accur method us mont carlo method cast rai point p hemispher surfac normal, test intersect geometri scene. larg number rai cast, accur approxim occlus valu point. applic ambient occlus product render spatial effect motion pictur [lan02], commercialis softwar [chr02]. softwar us pre-rend occlus map access scene need rendered. rai trace ambient occlus avail offlin render molec- ular graphic software, pymol, high qualiti public images. 27 simpl implement techniqu offlin render applications, real time dynam scene proven difficult. look method attempt speed occlus calcul enabl real time performance, note molecular graphic applications. 2.4.1 geometri base method techniqu calcul ambient occlus gener categoris dis- tinct areas: geometri base method imag base methods. geometri base techniques, focu section, method occlus calcul us inform 3d geometri scene. comput occlus stage avoid view depend error seen image-spac methods, per- formanc impact scene larg complexity. pharr green [pg04] us techniqu develop offlin render landi [lan02], pre-process scene comput access vertex. access valu interpol pixel fragment shader, giv- ing smooth occlus effect minim run-tim overhead. valu pre-calculated, method produc correct light result dynam meshes, limit techniqu static scenes. pre-process accessibil- iti valu perform rai tracing, lead lengthi pre-process time larger scenes. scene contain 150,000 triangles, pre-process took approxim minutes, 512 rai triangl comput access values. sarletu klein [sk04] present similar techniqu calcul self-occlus static meshes. work differ comput access render object number direct posit uniformli bound sphere object. vertex access posit occlus 28 queri advantag graphic hardware. downsid techniqu need render object time gener occlus uniformly, method faster softwar rai tracer previou method. method implement qutemol molecular visualis fast wai comput occlus static molecules, success results. enabl occlus dynam scenes, bunnel [bun05] propos disc-bas approach approxim face mesh. method requir larg pre- comput step calcul disc element polygon data. vertex, shadow valu emitt gather determin ambient occlu- sion. figur 2.9 illustr method. gather visibl emitt caus area dark, element shadow cast shadows. second pass correct overshadow multipli form factor emitt element access pass, mean element shadow cast fewer shadow elements. visibil- iti valu estim per-vertex, highli tessel mesh need produc higher qualiti detail occlusion. method abl produc dynam occlus real time, perform limit geometr complex scene. similar theme approach ren et al. [rws+06] shanmugam arikan [sa07] us sphere instead disc proxi occluders. approach ap- proxim complex geometri sphere comput direct visibl function. proxi geometri far simpler original, method miss high fre- quenci occlus effect help defin small details. method tend suffer perform larg number objects. shanmugam arikan split ambient occlus calcul differ parts: high fre- quenci approxim nearbi surfac imag space, low frequenc 29 figur 2.9: disk-bas ambient occlus techniqu bunnel [bun05]. disc ele- ment pre-calcul mesh data, analyt calcul ambient occlus valu vertex run time. approxim spheric occlud soft occlus effect caus distant objects. defin occlus distinct area emploi successfulli work reinboth et al. [rba09], rai cast voxel scene low frequenc effects, high-frequ featur highlight screen space occlus pass. novel method kontkanen lain [kl05], ambient occlus fields, com- pute inter-object occlus real time. occlud object, pre-comput 3d grid surround space encod approxim occlus caus object. volumetr inform fragment shader run-tim quickli determin occlus valu receiv object. method achiev real time performance, similar issu method seen, specif long pre-comput time larg amount memori usag larg number textures. seen number popular geometri base ambient occlus meth- ods. method advantag fulfil specif roles, common theme limit perform geometr complexity, pre-process requir methods. assess 30 second major categori ambient occlus techniqu calcul occlus screen space, popular topic research simplic support arbitrari scene complexity. 2.4.2 image-spac techniqu screen space ambient occlus (ssao) render techniqu approxim ambient occlus factor analys scene depth buffer. develop mittr [mit07] time video game 2007 pc game crysi [fra]. algorithm run fragment shader pixel screen, sampl depth valu current pixel comput occlus sampl point base differ depth. result approxim rel success ad ambient occlus effect scene real time, popular choic number interact applic video games. figur 2.10: result imag mittr implement ssao [mit07]. in- correct shade geometri clearli visibl occlusion, result overli dark image. correct later implementations. mittr compar depth surround pixels, possibl comput darken factor creat silhouett objects. limit 31 effect nearbi receivers, local ambient occlus effect produced. creat imag high visual quality, larg number sampl need pixel, accept real time application. reduc number samples, suggest randomli distribut sampl posit origin sphere. high-frequ nois produc blurred, inform depth buffer preserv edg details. method allow reduct number depth sampl pixel, algorithm, maintain perform visual quality. number kei advantag ssao ambient occlus method previous discussed. firstly, occlus factor calcul screen space, process entir gpu take advantag larg process power. process complet dynamic, requir pre-computation, mean load time requir mem- ory. allow techniqu integr easili modern pipeline. finally, method complet independ scene complexity, ideal scene high number polygon method struggl achiev real time performance. course, notabl disadvantag method stop prefer choic certain applications. techniqu rel expen- sive process consid need depth awar blur stage smooth output light calcul happen. effect view dependant, abl account geometri render screen, geometri clip frustum discard back-fac culling. techniqu effect local occlusion, larg sampl radiu prove costli miss cach read gpu hardware. whilst mittr introduc ssao, vast 32 number adapt origin algorithm tackl disadvantag list above. filion mcnaughton [fm08] introduc method inspir work crytek, kei chang improv imag qualiti performance. problem crytek origin techniqu self-occlusion. random offset vector gener sphere test point lead sampl penetr surfac object itself. filion mcnaughton solv issu gener vector hemispher centr normal point screen. approach produc incorrect shadow occur crytek technique, seen figur 2.10, requir extra buffer store imag space normals. however, normal commonli store depth defer render pipeline, gener littl concern. main bottleneck algorithm textur sampling, note increas sampl area size reduc gpu textur cach effect yield poorer performance. combat this, sampl depth buffer quarter origin size, improv textur cach perform significantli cost loss detail. horizon base ambient occlus (hbao), introduc bavoil et al. [bsd08], take approach estim occlus values. techniqu us depth buffer height map, calcul occlud geometri point search horizon. horizon defin averag slope height field point, heavili occlud point have steep horizon angle. sampl direct point chosen imag space sampl point creat directions, produc circular sampl area pixel. method produc higher qualiti occlus effect standard ssao, expens compute. novel techniqu describ research includ us angl 33 bias, remov artifact appear geometri render low tessellation. bia allow occlus near tangent plane point hemispher ignored. geometri provid fals occlus values, previous difficult exclud older methods. like filion mcnaughton, sourc half resolut depth buffer occlus calculations. render occlus pass half resolut well, whilst blur resolut avoid bleed edges. appli cross bilater filter, develop kopf et al. [kclu07], separ x y directions. non-separ technique, method greatli reduc perform cost small drop blur quality. bavoil sainz [bs09] build horizon-bas occlus algorithm, attempt- ing solv view depend issu seen ssao algorithms. us multipl depth layers, techniqu call depth peeling, attempt remov view depend artifact caus us singl depth layer. techniqu take sampl depth layer test point. take largest occlus valu layers, greatli reduc issu miss inform z-buffer vast major cases, provid depth layers. bavoil sainz introduc method solv miss occlus caus edg screen, lack depth inform outsid view frustum. suggest enlarg depth imag field view, simpl constant value, increas time render depth imag small amount. help increas perform technique, suggest max footprint parameter, discard sampl outsid area, give perform boost better caching. volumetr obscur publish loo sloan [ls10], improv ssao techniqu make better us depth buffer sample. instead treat 34 sampl points, binari comparison depth buffer sampl depth, sampl treat line sample. estim occlus proport volumetr occlus point. however, perform techniqu competit method seen. see, vast research screen space meth- od calcul ambient occlusion. desir trait predict render time, eas integration, complet dynamic. separ render time geometr complex make desir real time applic dynam scenes, common techniqu emploi video games, integr popular molecular graphic programs. 2.5 shadow shadow occur object partial fulli block light fall surface. unlik ambient occlusion, light consid specif direct source, commonli tend think shadow cast clear origin, consist direction, sun torch light. shadow import graphic help creat realist imag scene. provid user import visual cue 3d structur objects, rel posit other, enhanc user depth percept world. depth percept defin visual abil perceiv rel distanc object on visual field. aris varieti depth cues, commonli split categories: binocular cues, provid depth inform view scene eyes, monocular cues, provid depth inform view scene eye. binocular cue includ binocular dispar convergence. 35 monocular cue includ occlusion, perspective, size, refer frames, light- ing effect includ shadow cast objects, provid effect cue brain determin shape object posit space. figur 2.11 illustr power shadow provid depth cue scene. figur 2.11: exampl shadow abl chang percept object posit space. shadows, ball appear positions. however, shadows, ball clearli differ posit images. numer studi role shadow plai help un- derstand 3d world. wanger et al. [wfg92] assess influenc pictori cue perceiv spatial relat gener images. hard shadow provid domin cue spatial scale task compar common visual cue includ projection, motion frame reference. work develop wanger [wan92], assess effect shadow qualiti percept space. result indic physic accur hard edg shadow prefer task requir accur percept object shape. object moves, appar rel motion stationari object give hint rel distance. kersten et al. [kmk94] analys cast 36 shadow motion provid inform infer object motion, measur human observ us information. demonstr simpli adjust motion shadow dramat chang appar trajectori shadow cast object. mamassian el al. [mkk98] shadow motion profound effect spatial understanding. shadow inform shape object, shape object receiv shadow, spatial arrang two. clearli psychophys experi strongli shadow plai vital role graphic produc enhanc visual represent scene. survei shadow algorithm woo et al. [wpf90], dramat develop graphic hardwar technolog allow shadow real time applications, includ molecular graphics. however, recreat realist shadow difficult task, gener research. rai trace easiest method comprehend ad shadow scene. shadow rai trace surfac point light. opaqu object li points, surfac shadow. shadow creat techniqu seen work whit [whi80], whilst graphic hardwar advanc rapidly, creat rai trace shadow real time speed challeng today. turn investig popular render- ing techniqu emploi modern applic recreat real time shadow graphic environment. 2.5.1 shadow volum shadow volumes, propos frank crow [cro77], method calcul geometri area occlud light sourc determin shadow areas. basic process calcul shadow volum silhouett edg 37 mesh. edg separ face face faces. edg extend direct awai light sourc point infinity. volum cap depend implemen- tation. point li volume, shadow light. figur 2.12 illustr shadow volum basic scene. shadow volum popular method real time shadowing, shadow map popular choice, shadow volum advan- tages. main accur nearest pixel unlik shadow maps, suffer alias limit textur resolution. figur 2.12: illustr shadow volum technique. yellow line indic triangl mesh repres shadow volumes. point li insid mesh, said shadow. origin algorithm adapt heidmann [hei91] us stencil buffer comput per-pixel count point volum test. face area shadow volum increment stencil buffer, face area decrement it. render volume, stencil buffer hold mask indic area shadow. however, method produc incorrect result viewport intersect shadow volume. everitt kilgard [ek03] resolv move far clip plane infinity, produc robust hardwar 38 acceler technique. are, however, issu shadow volum techniqu present today. addit geometri need volum costli cpu rate time, polygon tend cover larg portion visibl scene. issu compound complex shadow casters. case shadow caster mesh accur repres shape, billboards. shadow volum base object mesh, shadow object repres correctly. finally, shadow volum produc realist soft shadow effect seen real-world environments, import creat realist visualisation. techniqu call shadow map take differ approach creat shadow graphics, look detail. 2.5.2 shadow map shadow map popular techniqu add shadow 3d scene. introduc lanc william [wil78], extens real time offlin graphics, includ popular molecular graphic applic qutemol rasmol. techniqu requir stages. scene firstli render light point view, depth buffer save texture. scene render camera viewpoint, pixel test depth map light, project right coordinates. z-valu greater store valu depth map, object consid occlud object, drawn shadow. figur 2.13 give visual breakdown process. reason shadow map popular techniqu shadow gener graphics, especi real time applications. 39 figur 2.13: shadow map process left right: scene camera viewpoint, scene light viewpoint, light shadow map project scene depth, area pixel fail depth test, final render scene shadows. easi implement, need singl textur hold depth infor- mation light. process knowledg scene geometry, shadow calcul happen imag space. mean techniqu work automat geometri creat alter gpu. cost sensit geometr complex techniques, vital todai applic increas polygon counts. disadvantag shadow map techniqu however. gener accur shadow volumes, accuraci shadow map limit resolution. drop quality, especi small shadow maps, usual visibl alias shadow edg project shadow-map texel cover notic larg area screen space. desir wai overcom increas shadow map size, given memori comput constraints, viable. scene geometri render light, point light time captur omnidirect depth. scene lights, shadow normal restrict main light sourc scene, normal sun. research improv problem list here, look notabl techniqu detail. particular area shadow map research look warp algorithm tackl problem insuffici shadow map resolut region near eye. techniqu 40 call perspect shadow map stamming drettaki [sd02] attempt wrap light frustum exactli coincid view frustum appli standard shadow map post-perspect space camera. approach improv shadow qualiti cases, encount difficulti dynam environ- ments. light space perspect shadow map wimmer et al. [wsp04] wrap camera frustum wai leav direct light sourc unchanged. new light frustum built parallel shadow map, size includ camera frustum potenti shadow casters. method stabl perspect method, us shadow map fully. trapezoid shadow map martin tan [mt04] build bound trapezoid camera frustum instead frustum light space method improv shadow map usage. area shadow map research look split view frustum multipl depth layers. separ shadow map gener layers. introduc zhang et al. [zsxl06] develop dimitrov [dim07], motiv idea observ point differ dis- tanc view need differ shadow map sampl densities. split frustum, shadow map focu smaller area provid better match sampl frequenc view space textur space. work describ look best choos shadow map sampl reduc artefacts, however, alias free method produc hard shadow effects. order better recreat real world soft shadow effects, solut developed. percentag closer filter reev et al. [rsc87] method multipl shadow map comparison pixel averag together, calcul percentag surfac shadow. origin algorithm random sampl region shaded. bunnel pellacini [bp04] optimis techniqu modern gpu hardware, 4x4 41 sampl region reduc aliasing. varianc shadow map donnelli lauritzen [dl06] try address prob- lem effici filter shadow maps. note standard shadow map store depth singl point, present method improv repres distribut depth pixel. this, shadow map repres manner filter linearly, give abil advantag graphic hardwar built-in capabl mipmap anisotrop filtering. however, techniqu potenti issu light bleeding, mean area light occur fulli shadow. attempt fix issu lauritzen [lau07], vsm certainli remain promis direct futur research. section look varieti popular shadow techniqu develop time. rai trace creat realist accu- rate shadow offlin renders, shadow map domin method recreat shadow effect real time applications. combin cascad shadow map percentag closer filter current method choic produc shadow current gener real time graphic applications, highli optimis current gener gpus. 2.6 conclus overarch goal molecular graphic provid scientist enhanc wai studi molecul properti graphic representation. graph- ical system develop provid abil manipul molecul rotat geometri hide atom obscur others. advanc light method adopt provid better sens depth, ambient occlu- sion shadow popular method simplic 42 comparison global illumin model. chapter, look effici method render molecul space-fil representation, improv perform appear haptimol isa software. chapter 3 techniqu render molecul space-fil represent 3.1 introduct chemistri space-fil model, known calott model, type 3d molecular model atom repres spheres. radiu sphere proport radiu atom, commonli defin van der waal radii [bon64]. center-to-cent distanc atom proport distanc atom nuclei. colour atom type import help distinguish individu atom molecule. molecular graphic program us cpk colour system, name design origin space-fil model creat corei paul 1950 [rbc53] later revis koltun [kol65]. provid consist standard atom colour atom differ chemic elements. haptimol isa softwar us space-fil representation, cpk colour system, molecular visualisation. know work sphere allow optimis render process, whilst enhanc visual appear molecules. 43 44 figur 3.1: space-fil model n-octan c8h18 3.2 haptimol isa haptimol isa softwar provid haptic render molecular graphic deeper appreci shape biomolecul augment user sens sight touch. spheric probe size water molecule, process explor benefit abl determin region molecular surfac access solvent. give insight awkward water molecul gain access escap channel cavities, indic possibl entrop bottlenecks. softwar us opengl 2.0 api render molecular structure, displai list render triangl mesh repres spheric atoms. phong shad- ing lighting, light sourc illumin molecule. light sourc locat centr probe, give user better understand posit relat atom molecule. thesis, aim improv render techniqu current displai molecul user. section focus render sphere repres atom efficiently. 45 later section look ad advanc light effect software, includ am- bient occlus shadows, hope aid depth percept molecul improv navig biomolecule. 3.3 rai cast 2d billboard common wai molecular visualis program render sphere 3d scene gener triangl mesh. mesh like need hundr triangl produc smooth shape appear spheric human eye. case viabl gener sphere arbitrari number triangles, improv approximation, approximation. per- pixel light help disguis low polygon mesh smooth light effect provides, individu triangl mesh visibl sphere intersect. gener case, memori usag render time taken account, need limit number triangl render maintain interact frame rate, consequ hurt visual representation. sphere defin set point space equal distanc common center point. techniqu emploi molecular visualis program qutemol approxim definit impostors. geometr shape simpli place-hold provid wai invok fragment shader certain region screen. given 2d square, invok fragment shader region, cull awai fragment awai center squar radiu sphere. squar posit dimens actual circle, face camera. fragment shader, comput posit normal point sphere surface. 46 this, map point squar point sphere try render. techniqu produc sphere appear perfectli round regardless close sphere camera. help drastic reduc number triangl sphere hundr two. however, problem techniqu sphere appear perfectli circular viewer, matter view angle. problem illustr 3.2. figur 3.2: comparison tradit geometri (two images), rai cast (top right), creat circl window space (top left). techniqu describ above, whilst produc seemingli perfect spheres, simpli creat circl window space. reproduc elong effect seen real geometri figur 3.2. good approxim sphere appear small screen. however, sphere large, close camera, inaccuraci clearli seen method. instead us rai cast techniqu posit normal sphere fragment. prove import later chapters, rai trace ambient occlus shadows. ensur shadow cast sphere match exactli geometri rendered. 47 rai casting, coin scott roth 1982 [rot82], techniqu generat- ing imag cast rai pixel imag plane, intersect rai object scene. nearest intersect point found, final pixel colour determin base incom light materi properti object. instead perform rai cast algorithm pixel screen, perform billboard. remov need acceler structur ensur object hit rai quickly. comput intersect rai sphere parametr equations. figur 3.3: rai posit p0 intersect sphere center c radiu r point p p . p = p0 + tv (3.3.1) |pc| 2 r2 = 0 (3.3.2) substitut rai equat sphere equation: |(p0 + tv)c| 2 r2 = 0 (3.3.3) written form quadrat equation: 48 v2t2 + 2v (p0 c)t+ |p0 c| 2 r2 = 0 (3.3.4) equat solv quadrat formula. equat 3.3.5 gener form quadrat equation. substitut valu order solve: at2 + bt c = 0 (3.3.5) = |v| 2 (3.3.6) b = 2v (p0 c) (3.3.7) c = |p0 c| 2 r2 (3.3.8) solv quadrat equat fragment billboard produc sphere ident tradit geometry, pixel perfect regardless posit camera. compar techniqu tradit triangl mesh previous repres atom haptimol isa software. time render singl frame measured, light effect used, camera posit fit structur screen. result shown figur 3.4. clear figur 3.4 poorli tessel triangl mesh reproduc perform billboard technique. especi appar larger molecul ten thousand atoms. frame rate drop consid interact triangl meshes, billboard remain interact user. 49 0 10,000 20,000 30,000 40,000 50,000 60,000 0 10 20 30 40 50 60 70 80 90 100 110 120 130 number atom m il li se n d s point sprite billboard quad triangl mesh (28) triangl mesh (648) figur 3.4: graph compar perform point sprites, billboard align gpu, triangl mesh render molecul vari atoms, hundr ten thousands. 50 3.3.1 point sprite order creat camera align billboard describ section 3.3, calcul posit point align face camera cpu. send point gpu render them. however, opengl provid altern wai produc view align geometri gpu, point sprites. save billboard calcul main applic reduc number vertic sent vertex program. comparison render techniques, shown figur 3.4, show advantag point sprite billboard quads. bill- board calcul take place gpu point sprites, data need transfer pipeline. however, larg drawback point sprite aris clip screen. opengl discard entir point sprite vertex outsid view frustum, lead notic disappear atom edg screen. lead conclus billboard point sprite render method includ software, point sprite lower end graphic card interact frame rate take preced visual appearance. 3.4 cull molecul clip plane arbitrari angl isa softwar allow user interact molecul probe sphere. user move probe pocket channel molecule, user lose sight it. abl clip structur awai probe move inside, probe relat protein structure. motiv clip plane includ abl channel imposs detect cull part structur away. softwar packag 51 provid clip functionality, emploi nice clip strategy, visual result appear unnatural. software, desir clip plane fix probe sphere, mean user move probe channel pockets, sphere probe camera cull away. ensur user view probe sphere restricted. benefici user option cull sphere entir intersect plane, altern displai partial cull sphere cut. advantag case user want know exactli far probe relat atom molecule. approach produc visual correct cull effect, instead atom unnatur pop view intersect plane, atom gradual smaller plane pass them. improv render atom section 3.3 2d rai trace billboard place tradit triangl meshes. make implement render partial cut sphere easier, us intersect point ray-spher intersect advantag order chang shape atom. rai intersect sphere, point intersection, enter exit sphere (unless rai tangent sphere, mean intersect point). billboard face camera, common render sphere techniqu calcul intersect point nearest camera, know second intersect point occluded. approach work fine sphere need culled, 3d effect break fragment discard plane, seen left imag figur 3.5. solut render sphere cut plane angl 52 figur 3.5: imag sphere cut clip plane. left hand imag render initi intersect point ray-spher intersection. center imag render intersect point ray-spher intersection. right hand imag show sphere alter appear like shell, natur solid look. seen figur 3.6. describ above, ray-spher intersect produc intersect points, pmin pmax, pmin defin intersection, closest camera, pmax defin second intersection. pmin pmax clip plane, fragment discarded, seen red section figur 3.6. pmin plane, pmax front, render fragment posit pmax, depict green section figur 3.6. pmin pmax plane, simpli render pmin shown blue section figur 3.6. result calcul pmin pmax seen center imag figur 3.5. appear expect sphere cut two. peopl intuit imagin atom model solid sphere shell. sphere appear solid, right imag figur 3.5, simpli calcul distanc pmax plane, direct camera, pmax plane accordingly. set normal fragment opposit plane, produc correct light results. result techniqu molecul seen figur 3.8. import ensur fulli dynam ambient occlus shadow 53 figur 3.6: diagram plane intersect 2d billboard repres sphere. red area fragment discard completely. green area show plane intersect pmin pmax. blue area sphere remain unchanged. atom culled, atom longer produc occlus cast shadow atom visible. aid produc visual believ scene, light effect chang dynam respons user move clip plane. work dynam ambient occlus shadow cover later chapters. light effect possibl softwar packag qutemol, ambient occlus effect bake textur pre-process stage. result techniqu provid real time user interact clip plane molecule. realist visualis maintain model atom appear solid cull clip plane. help produc immers us molecular visualis user. 3.4.1 multipl clip plane clip plane fix probe sphere, desir user hide section molecul need view. algorithm support multipl clip plane move pmax closest 54 figur 3.7: structur molecul clip clip plane. figur 3.8: protein cull clip plane. possibl pocket channel previous hidden view structure. 55 plane. result clip plane atom shown figur 3.9. figur 3.9: atom cull clip planes, front, right. perform impact ad dynam clip plane scene small. atom, perform simpl sphere-plan test cpu determin atom fulli plane. atom need rendered, number draw call reduc mean complex fragment shader comput minimum. atom partial intersect clip plane, vertex attribut set pass fragment shader indic processing. fragment intersect clip plane, perform point-plan tests, pmin pmax, determin pixel need discard alter. atom ahead clip plane render normal tests, reduc fragment operations. however, real bottleneck perform tend number opengl draw calls. practise, mean ad clip plane scene like reduc draw count, boost performance. 56 0 1 2 3 4 5 6 28 28.5 29 29.5 30 30.5 31 31.5 32 32.5 33 number clip plane m il ec o n d s figur 3.10: graph show perform impact gpu ad clip plane scene. clip plane posit 6 face navig cube (introduc section) molecul contain 58870 atoms. 327 atom left unclip navig cube clip plane added. perform test cull atom cpu highlight gpu perform impact algorithm describ section 3.4. 3.5 clip molecul navig cube haptimol us navig cube visualis boundari safe work area haptic devic used. move devic edg cube translat molecul desir area protein safe studied. navig cube illustr figur 3.11. previou section, look clip plane remov ar- ea molecul ensur user abl probe sphere. experimentation, note inclus simpl sphere-plan test atom 57 figur 3.11: navig cube explor protein. dimens cube base usabl workspac device. help improv perform reduc draw calls. perform bene- fit especi notic render larg molecul ten thousand atoms, vertex process tend bottleneck graphic pipeline. figur 3.4 show how, effici billboard techniqu render atoms, reach point time render frame drop consid minimum real time performance. system unabl render entireti molecul real time, develop method render atom insid scalabl navig cube. provid user easi wai reduc number atom render suit needs, have posit clip plane manually, have perform sphere-plan test atom. user navig area molecul interest exploring, method emploi remov atom outsid area interest, boost perform real time level interact molecule. 58 render atom insid select area, us uniform grid allow quickli determin specifi area molecul user navig to. talk uniform grid chapter 5, includ gener choic grid cell density. figur 3.12 give 2d illustr grid cell chosen. navig cube corner transform grid local space. corner, grid index, indic green cells. minimum maximum index bound cell updat accordingly, shown blue cells. cell determined, travers cell, test sphere contain cell navig cube. figur 3.13 show techniqu implement software. figur 3.12: figur illustr calcul bound cell navi- gation cube, find minimum maximum grid index. import determin perform overhead technique. tabl 3.1 show clip method appli number molecules. measur render time small molecul 327 atoms, clip method employed. clip method number larger molecules, move navig cube select 327 atom section each. note small increas render time, show method appli effect molecul size target range. 59 effect method render section larg molecul real time. 3iyn, molecul contain 100,000 atoms, take 60 millisecond render time frame billboard technique. user enabl techniqu achiev real time rate render smaller size molecules. tabl 3.1: compar render time small molecule, 1crn, number larger molecul clip atom method. frame time (ms) overhead (ms) 1crn 327 0.32 0.0 1bk 5231 0.36 0.04 3et 9152 0.36 0.04 1jb0 24198 0.36 0.04 1aon 58870 0.37 0.05 3iyn 99595 0.38 0.06 3.6 conclus chapter, cover varieti techniqu render atom repres spheres. us billboard platform perform rai cast provid enhanc visual benefit polygon mesh ensur sphere accur nearest pixel, whilst sustain far greater frame rate poorli tessel triangl meshes. billboard produc cheapli point sprites, reduc process time creation camera face geometry. whilst billboard techniqu provid advantag tradit rai cast methods, primari ray. rai creat shad- ows, reflect refract effect need reli tradit method describ follow chapters. clip plane vital tool explor larg data sets, ensur user 60 figur 3.13: imag clip navig cube achieved. left imag show molecule, 1adg, right imag includ uniform grid molecule. left imag highlight bound cell navig cube, whilst right imag show final result clip cube. 61 probe sphere, whilst find pocket channel structur hidden view. us rai cast allow sphere appear partial culled, give user precis visual cue locat clip plane relat atoms. addit clip plane easili implement minim perform impact. finally, shown simpl techniqu render small portion molecul uniform grid quickli determin area cull. especi us interact larger molecules, hard render real time, billboard method. techniqu prove us limit complex light calcul manag area, discuss chapter 5. chapter look light techniques, includ realist ambient occlus effect help improv percept depth scene, rai trace soft shadows. chapter 4 ambient occlus molecul space-fil represent 4.1 introduct graphics, difficult appreci 3d form scene 2d image. haptimol isa softwar especially, increasingli necessari visualis molecul thousand atom ensur user good visual understand structure. benefit research look geometri molecul relat function, aid user softwar spot pocket channel probe access. aid depth percept molecule, advanc light stereoscop techniqu emploi molecular visualis software. techniques, avail advanc modern graphic algorithm hardware, help achiev simul depth aid help biologist understand 3d structur proteins. ambient occlus shade model popular light tech- niqu help percept 3d scene. experi shown depth percept uniform diffus light condit superior direct light 62 63 model [lb00]. chapter, discuss number ambient occlus imple- mentat goal improv user percept depth software. 4.2 rai trace ambient occlus simple, expens techniqu calcul ambient occlus cast rai point, test intersect geometri scene. hundr sampl gener randomli point hemisphere, accur approxim ambient occlus produced. figur 4.1 show molecul 1crn render method, rai tracer develop chapter. 100 rai cast pixel, nois pattern randomli cast rai reduc accept level, imag take 3 second generate. us cosine-weight sampling, sampl weight cosin angl rai normal. gener sampl weight heavili normal, reduc nois computation. course, real time applic viabl solution. investig possibl reduc number samples, method try reduc render time real time rates. 4.2.1 singl sampl rai trace ambient occlus common ambient occlus method ssao us lower number sampl pixel, addit blur pass take account depth discontinu remov high frequenc nois produc consequence. solut allow reduct number depth sampl pixel 16 maintain accept quality. however, 16 sampl pixel expens rai traced. figur 4.2 show singl rai trace sampl produc ambient occlus approximation, 64 figur 4.1: rai trace ambient occlus 100 random sampl pixel. imag took 3 second generate. imag refer chapter. albeit noisy. figur 4.2b calcul screen resolution, whilst figur 4.2c calcul half resolution. perform seen tabl 4.1. (a) 100 sampl res- olution. (b) 1 sampl resolu- tion. (c) 1 sampl half resolu- tion. figur 4.2: rai trace ambient occlus 1crn molecule, vari sampl resolutions. smart blur filter remov noise, whilst retain sharp edges. blur pass give impress multipl sampl fraction cost. common smart blur techniqu todai cross bilater 65 tabl 4.1: rai trace ambient occlus half resolution. resolut (ms) half resolut (ms) chang (%) 1crn 327 21.67 7.04 -67.51 1bk 5231 47.28 15.51 -67.19 3et 9152 56.89 17.30 -69.59 1jb0 24198 58.33 16.68 -71.40 1aon 58870 64.07 20.50 -68.00 3iyn 99595 71.90 23.64 -67.12 filter. depth depend gaussian blur diffus ambient occlus whilst avoid blur edges. achiev lower weight sampl larg differ depth current pixel. figur 4.3 show effect blur stage remov nois image. (a) 100 sampl res- olution. (b) 1 sampl resolu- tion bilater blur. (c) 1 sampl half resolu- tion bilater blur. figur 4.3: rai trace ambient occlus 1crn molecule, appli bilater filter remov nois caus reduc number samples. result singl rai trace ambient occlus sampl pixel promising. global ambient occlus effect rai trace provid desirable, especi help gain understand larg molecular structure. smart blur stage, possibl produc smooth result origin noisi sourc image. notabl issu method. flicker seen caus randomli gener rai direct pixel. exagger calcul ambient occlus lower resolut screen size. work solut 66 ensur blur radiu large, appli secondari blur pass smooth flicker effects. consequ heavi blur local ambient occlus lost, section 4.5 look wai tackl this. 4.3 screen space ambient occlus screen space ambient occlus (ssao) render method approxim am- bient occlus real time. standard approach comput ambient occlus real time applic video games. introduc mittr [mit07], techniqu us depth buffer approxim ge- ometri scene. occlus factor calcul screen space, mean process entir gpu, process dynamic, requir pre-computation, independ scene complexity. featur desir- abl haptimol isa software, molecul contain thousand individu atoms. whilst calcul complet gpu, screen space ambient occlus rel expens process. common ssao calcul half screen resolution, 16 sampl pixel. depth awar blur cross bilater filter smooth imag light calculations. figur 4.4 show ssao calcul differ resolut blur pass performed. compar ambient occlus solutions, ssao set featur desir molecular graphic software. independ scene complex make ideal molecular structur sizes. fulli dynam natur make excel scene move object probe sphere software. easili integr modern graphic pipeline. limit ssao, however, distanc method produc 67 (a) 100 sampl res- olution. (b) 16 sampl reso- lution bilater blur. (c) 16 sampl half reso- lution bilater blur. figur 4.4: screen space ambient occlus 1crn molecule, bilater blur. result interpret occlusion. extrem case seen dif- ferenc figur 4.10 4.12, atom far awai ssao techniqu capture, give fals impress structur molecule. in- creas sampl radiu try captur larger area object decreas per- formanc significantly, lead fine ambient occlus lost. ssao us techniqu solv occlus rel small distances, mean solut need occlus higher distanc desired. 4.4 analyt calcul ambient occlu- sion sphere ambient occlus equat easili approxim send test rai point surfac object, find rai intersect object scene. ambient occlus valu depend far awai object are, intersect found. produc suffici accur result method, hundr rai need test pixel, rule method real time applications. work inigo qulez [qui06] show possibl analyt calcul occlus sphere point arbitrari surface. especi us isa software, us sphere repres atom molecule. 68 investig possibl method space-fil molecular representation, goal creat high qualiti dynam occlus effects. equat describ block factor sphere radiu r distanc d point. block factor, bl(r, d), area sphere project hemispher divid area hemisphere. figur 4.5: ambient occlus sphere point surfac calcul know radiu sphere distanc sphere center surface. bl(r, d) = 1 1 (r/d)2 (4.4.1) express simpli function r/d. logical, make sphere bigger mean project shadow occlus factor. sphere x time bigger project shadow x time away. effect seen figur 4.6. 69 figur 4.6: result calcul ambient occlus white ray- trace spheres, equat 4.4.1. 4.4.1 implement decis integr techniqu software, atom, store atom nearest it. atom molecul need move, calcul atom nearest neighbour initialis stage molecul loaded. sphere id neighbour atom store textur access light stage graphic pipeline. id point second pre- calcul textur store posit radiu atom. final textur store flag atom indic atom cull clip plane. ensur light dynam atom remov view. occlus movabl probe sphere calcul nearbi pixels, similar fashion point light detail chapter. tabl 4.2: ao data layout. red green blue alpha textur format cull flag gl r8 posit radiu gl rgba32f atom occlud gl r32f 70 occlud atom store atom base per- formanc storag limitations. opengl 2.1 api implement requir minimum 2048x2048 textur size supported. base minimum size, store 32 occlud atom atom whilst support molecul 100,000 atom size. tabl 4.3 show perform ambient occlus method vari number occlud atom rang molecules. tabl 4.3: analyt ambient occlus vari number occlud atoms. 8 atom (ms) 16 atom (ms) 32 atom (ms) 1crn 327 2.41 4.19 6.66 1bk 5231 2.44 4.31 7.02 3et 9152 2.72 4.83 7.61 1jb0 24198 2.74 4.90 7.97 1aon 58870 2.48 4.41 7.68 3iyn 99595 2.39 4.36 6.58 (a) 100 sampl res- olution. (b) analyt ao 8 nearest spheres. (c) analyt ao 32 nearest spheres. figur 4.7: analyt ambient occlus 1crn molecule. analyt calcul ambient occlus sphere appeals. formula calcul occlus factor simple, perform pixel basis. techniqu produc occlus artifacts, fit pixel perfect sphere previou chapter. mean addit blur stage required. however, method requir addit pre- process memori overhead, lower occlud count 71 tackl needed. occlud limit, techniqu us occlus localis area unabl captur global occlus value. 4.5 hybrid ambient occlus interest work investig hybrid ambient occlus techniques, shanmugam arikan [sa07]. look separ ambient oc- clusion problem detail high-frequ occlusion, distant low-frequ occlus domains, demonstr good results. previou section present number techniqu calcul ambient occlus molecular structures. uniqu characteristics, advantag disadvantag other. take method hybrid solut provid ambient occlus solut techniqu provide. singl sampl rai trace ambient occlus seen section 4.2.1 calcul occlus far techniqu produce, lack fine result heavi blurring. analyt solut section 4.4 ideal calcul occlus smaller distances, lack global reach. combin method simpl multipl produc result closer refer rai trace imag own. figur 4.8 illustr method. (a) analyt ao 8 occlud spheres. (b) 1 rai trace sampl half resolution, blur. (c) multipl (a) (b). figur 4.8: combin ambient occlus techniques. 72 4.6 comparison ambient occlus techniqu previou section detail number possibl solut calcul ambi- ent occlus space-fil molecules. choos best solut haptimol isa softwar need base number areas. perform kei factor software. applic need run real time allow user navig structur probe sphere. aid depth percept import secondari factor account. good visual understand molecul great benefit user, help probe confid efficiency. visual qualiti need factor in, smooth natur appear import distract user. figur 4.9 show rel perform ambient occlus method implemented, tabl 4.4 show advantag disadvantages. clear ssao analyt method signific perform advantag rai trace hybrid solutions. perform rai trace solut affect number atom molecule. ssao analyt method affect molecul size. predict constant perform appeal softwar visualis molecul vari larg size. tabl 4.4: comparison ambient occlus techniqu presented. techniqu advantag disadvantag rai trace 100 sampl high accuracy, nois real time rai trace 1 sampl real time, captur global occlus noisy, need strong blur ssao real time, constant render- ing time view dependant, local oc- clusion analyt real time, high qualiti local occlus hybrid captur near far occlus realist real time us 73 choic ssao analyt techniqu come visual quality, perform wise similar, provid localis occlusion. ssao requir calcul half resolution, blur pass achiev ac- ceptabl level performance. analyt solut produc pixel perfect effect, artifact flicker randomis sampl methods. softwar analyt method best solution, constant fast performance, high qualiti occlusion. user access higher end pcs, hybrid solut viabl option, consid futur updat software. 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 105 0 5 10 15 20 25 30 35 number atom m il li se n d s rai trace half resolut 2 blur pass ssao 16 sampl 1 blur pass analyt 32 occlud sphere analyt rai trace combin figur 4.9: graph show perform calcul ambient occlus number techniques. 74 figur 4.10: 100 sampl resolution. figur 4.11: 1 sampl half resolut blur. figur 4.12: ssao half resolut blur. 75 figur 4.13: analyt techniqu 32 occlud atoms. figur 4.14: hybrid solut rai trace analyt methods. figur 4.15: hybrid solut diffus colours. 76 4.7 defer render previou chapter rai trace produc pixel perfect sphere billboard give larg visual improv scene. however, tech- niqu combin rel complex light calculations, perform issue. larg need set fragment depth manual fragment shader. driver know output fragment depth generated, perform simpl depth test execut fragment shader, known earli depth test. mean discard fragment comput potenti complex fragment shaders. indeed, modern hard- ware complic earli z cull hardwar discard multipl fragment singl test. however, soon set fragment depth manually, pipeline, optimis performed. light calcul perform pixel molecules, whilst inher- entli expens own, expens comput combin larg overdraw pixel consequ earli depth testing. tech- niqu call defer render emploi case, replac tradit forward render approach. forward render straightforward approach appli set trans- format vertic object vertex shader follow light calcul pixel fragment shader. pixel object get singl fragment shader invoc provid fragment shader inform light sourc account calcul light effect pixel. simpl approach downsides. scene highli complex object larg depth complex (same screen pixel cover objects) lot wast gpu cycles. defer render popular techniqu target specif problem above. 77 kei point defer render decoupl geometri calcul light calculations. instead take object vertex buffer final rest place framebuffer, separ process major passes. pass run usual vertex shader, instead send process attribut (such positions, normals, colours) fragment shader light calculations, forward known geometri buffer g-buffer. logic group 2d textur written capabl opengl call multipl render target (mrt). write attribut fragment shader, valu end g-buffer result interpol perform raster vertex attributes. stage call geometri pass. object process pass, depth test, geometri pass complet textur g-buffer popul interpol attribut closest pixel camera. mean irrelev pixel fail depth test drop left g-buffer pixel light calculated. solv issu overdraw caus render geometry. defer render tradit forward render provid benefits. light 2d post process mean appli potenti thousand light efficiently, combin differ type point spot, mix shadow unshadow lights, differ combin light shader previous required. allow spatial optimis light complex shading, mean appli light pixel actual light area effect. inform store g-buffer post process effects, us improv viewer percept 3d structur molecule. 78 anti-alias import consider graphic applications. alias occur monitor displai imag form uniformli colour pixels, geometri scene align pixel appear jagged. fxaa popular techniqu combat aliasing. creat timothi lott [lot11], fxaa run singl screen pixel shader post process, easili integr defer render pipeline. develop system, shader take 1.5 millisecond run 1280x720 imag default settings. accept cost excel edg smooth produces. downsid techniqu form slight loss textur effect software. notabl downsid defer render need discussed. de- fer render inher overhead term memori use, storag requir g-buffer. potenti reduc materi flexibility. un- like forward rendering, possibl chang shader comput light chang material, en-mass 2d post process. problem transpar object scene handl defer renderer. object need dealt second, forward render pass mean need work forward renderer. case haptimol software, disadvantag concern outweigh vast benefit defer render provides. littl us alpha channel application. materi properti simpl molecules, mean disadvantag loss materi flexibility. finally, concern memori us valid, care decis data store g-buffer, textur format render targets, memori us kept minimum. tabl 4.5 break g-buffer layout pipeline, total gpu memori usag g-buffer 79 25mb 1280x720 resolution. tabl 4.5: g-buffer data layout. red green blue alpha textur format diffus colour gl rgba8 posit atom id gl rgba32f normal materi id gl rgba16f 4.8 conclus chapter hope shown ambient occlus greatli improv visual depth percept molecules, aid user navig structur efficiency. explor varieti method abl run real time environment. analyt calcul ambient occlus sphere provid best over- solut software. techniqu perform similar modern ambient occlus techniqu screen space ambient occlusion, compar favour compar visual quality, benefit lack blur requir produc smooth outcome. rai trace result shown promising, viabl solut user softwar adopt power modern graphic cards. ambient occlus work basic approxim indirect illumin application. effect lost direct light ad scene shadows. produc shadow molecular visualis softwar focu chapter. 80 figur 4.16: scene render g-buffer, store materi properti (left top), posit (left middle) normal (left bottom) scene. inform textur produc final image, seen right. chapter 5 real time shadow molecul space-fil represent 5.1 introduct shadow vital human percept 3d environment. research work mamassian et al. [mkk98] wanger et al. [wfg92] explore, psychophys experiments, role shadow plai help understand object rel posit size graphic scene. work kersten et al. [kmk94] show movement shadow plai import role produc appar motion depth. shadow reveal geometri hidden view, geometri outsid field view. abil achiev accurate, dynam real time shadow haptimol isa softwar greatli enhanc user abil navig molecular structure. however, reproduc realist shadow real time graphic applic remain difficult task. section 3.3 describ techniqu produc rai cast sphere camera align billboards. chapter look continu explor rai trace theme produc eleg solut dynam shadows, whilst maintain interact frame rate. 81 82 5.2 gpu rai trace glsl rai trace offer eleg accur solut problem domain compar popular shadow techniqu shadow mapping. scene need render direct light source, time omnidirect light sourc shadow mapping. rai tracing, shadow simpl extens scene, especi simpl geometri spheres. shadow rai test surfac visibl light. primari rai hit surface, rai trace intersect point light. opaqu object surfac light, surfac shadow light contribut shade. rai trace gener expens process high number intersec- tion test frame. brute forc approach rai trace test rai object scene. infeas comput real time number object scene increases. primari approach acceler rai trace reduc total number intersect tests. usual involv travers form spatial data structur object nearbi ray. current haptimol isa softwar us opengl opengl shade lan- guag (glsl) render molecular structur phong shade shad- ows. glsl high-level shade languag creat develop direct control graphic pipelin vertex fragment level. desir carri technolog eas integration, compat older hardware. shader model 3.0 introduc abil perform gpgpu shaders, work purcel et al. [pbmh02] christen [chr05] shown possibl perform rai trace techniqu gpu shaders, uniform grid reduc intersect tests. uniform grid easier acceler structur implement 83 gpu. introduc fujimoto iwata [fi85], grid evenli divid scene size cells, cell contain refer object intersect it. structur work best grid cell close match object size. achiev case dimens atom molecul vari rel small amount. atom size defin bondi [bon64] rang hydrogen atom radiu 1.2 angstroms, potassium radiu 2.75 angstroms. structur map gpu memori textur storage, algorithm travers structur simpl implement pixel shader, mean popular choic acceler structur gpu. reason make good choic acceler structur software. 5.2.1 grid creation creation uniform grid need perform time user load molecul program. creation need fast ensur minim delai load molecul rendered. method uniform grid creation shown below. sphere si: 1. grid cell contain center sphere, si 2. perform collis test sphere, si, cell directli initi cell step 1, cell repres axi align bound box (aabb) 3. add refer sphere, si, grid textur initi cell, cell sphere-aabb test return true import choic uniform grid cell size. gener case cell size larg contain largest object. 84 ensur number cell object overlap limit cell intersect tests, import initialis speed. however, perform grid travers stage importance, need happen real time. decis cell size discuss section 5.2.4. 5.2.2 grid travers simpl wai travers uniform grid introduc amanatid woo [aw87], 3d-dda algorithm. algorithm requir small oper guid rai neighbour cell cost travers linear number cell visited. featur algorithm valid hit occlud hit follow cell voxel visit order rai pass grid, seen figur 5.1. 5.2.3 grid storag access uniform grid structur geometri data pixel shader, data map textur memory. previou work gpu rai trace purcel et al. [pbmh02], christen [chr05] nguyen [ngu07], us method cell grid index structur contain pointer grid cell list. grid cell list contain atom id point actual geometri data. method potenti handl molecul hundr thousand atom size, ensur support larg proport molecul current recorded. data textur gener cpu, current implement lim- it render static scene only. accept softwar atom molecul move. however, clip plane place scene stop atom plane rendered. solut ensur dynam light effect molecul explor section 5.4. 85 figur 5.1: represent 3d-dda algorithm. green line repres ray, highlight blue cell cell rai intersects. figur 5.2: structur data map textur memory. base textur size 2048x2048 pixels, structur ensur perform rai trace calcul molecul hundr thousand atom size. 86 algorithm 1 shadow calcul algorithm light pass 1: pixel contain geometri 2: calcul n l 3: n l > 0 4: sphere id > 0 5: calcul grid index rai origin 6: grid index outsid grid 7: project rai origin grid 8: end 9: insid grid 10: sphere grid cell 11: rai intersect sphere 12: pixel shadow 13: end 14: end 15: end 16: end 17: end 18: end 5.2.4 perform choos suitabl cell size uniform grid vital achiev real time perfor- manc shadow calculations. smaller cell size help reduc number intersect test need cell. larger cell size help reduc memori requir store grid data, number grid cells, likelihood sphere multipl cell reduced. memori usag concern, grid cell size increas cost like decreas performance. figur 5.3 compar perform varieti grid cell size test molecule, singl cell brute forc approach, cell smallest possibl size, mean abl fulli contain largest atom molecule. common molecul explor haptimol gener contain thou- sand ten thousand atoms. groel, contain nearli thousand atoms, consid larg molecule. default us minimum cell size available, 87 0 100 200 300 400 500 600 20 40 60 80 100 3650 80 160 number grid cell m il li se n d s figur 5.3: graph show perform calcul shadow singl direct light sourc molecul 1crn contain 327 atoms. grid cell densiti increased, calcul time drop dramatically. cell size indic select points. unit base van der wall radii, oxygen atom radius, example, have valu 15.2. vast major molecul memori avail achiev maximum performance. size good start point reduc memori requirements, atom cell worst case. however, see, room memori save required. figur 5.3, low level subdivision, shadow calcul expensive. however, small increas subdivis perform increas dramatically. result close resembl amanatid woo [aw87], although, minimum cell size set contain largest atom molecule, reduc perform have grid cell encounter. 88 notabl featur perform result roughli halfwai minimum maximum cells, perform in- creas negligible. 1crn, time calcul shadow 567 grid cell take 12.60 milliseconds, whilst 294 grid cells, time increas slightli 14.32 milliseconds. halv number cell 2 millisec- ond drop perform significant, especi trend repeat molecul ten thousand grid cells. larg molecul molecul uniqu structur uniform grid inefficient, lot cells, find optim zone memori usag perform appealing, allow smaller textur store grid used. help investig perform gain drop dramatically, figur 5.4 show relationship number grid cell averag number atom cell 1crn. nice correl figur 5.3 5.4. show direct link perform number atom cell. travers grid rel cheap, whilst intersect test need cell incur cost. learn increas number cell certain point littl reduc averag number atom cell, explain reduc perform gain higher grid densities. particular molecule, cell size 50 produc best perform memori ratio. desir know find molecul vari sizes. look perform result new select molecules, similar pattern before. cell size region 50 produc best memori perform ratio. import note, however, larger molecul especially, perform differ minimum cell size optim suggest signific consid real time performance. 1aon, 89 0 100 200 300 400 500 600 0 20 40 60 80 100 3650 80 160 number grid cell v er g e n u m b er o f m p er c el l figur 5.4: relationship averag number atom cell number grid cell shown. clearli link number atom cell, shadow calcul time. cell size shown select points. example, differ 10 milliseconds, larg time consid real time target 33 millisecond render time. ultim goal achiev real time shadow improv user percept scene. shown achiev real time rate small medium size molecules. however, larg molecules, rai trace shadow drop rate develop system. chapter 3 look render small portion molecule, clip navig cube reduc draw call render time. section 5.4, look build techniqu achiev real time dynam shadow larger molecul groel. 90 0 200 400 600 0 50 100 150 200 365080 160 no. grid cell m il li se n d s (a) 1crn (327 atoms) 0 2,000 4,000 50 100 150 200 3650 80 160 no. grid cell m il li se n d s (b) 2eb2 (2459 atoms) 0 1,000 2,000 3,000 4,000 50 100 150 200 4550 80 160 no. grid cell m il li se n d s (c) 1bk (5231 atoms) 0 0.2 0.4 0.6 0.8 1 105 50 100 150 200 3650 80 130 no. grid cell m il li se n d s (d) 1aon (58870 atoms) figur 5.5: compar molecul look similar pattern perform relat number grid cells. abl choos optim cell size (indic select points) initialis grid lead signific memori save rel small increas shadow calcul time. 5.3 aid user interact shadow cast- ing probe light haptimol isa softwar includ point light posit center probe sphere. attenu light set illumin atom near probe, give user better understand posit rel atom molecule. current however, light cast shadows, mean area molecul occlud light illuminated. shadow 91 cast probe light user better understand probe sphere posit rel molecular structure. creat shadow point light shadow map techniqu requir scene render time cover area light potenti illuminate. rai trace greatli simplifi calcul point light shadows, need singl shadow rai pixel. algorithm 1 describ rai trace direct lights, rai need travers grid exits, light sourc effect outsid grid. point lights, algorithm modifi slightli reduc number voxel traversed. achiev ad extra condit stop travers rai reach light grid cell, know light grid cell occlud pixel testing. figur 5.6 illustr method. small chang limit area shadow calcul pixel illumin area point light. pre-set cut-off defin manual light pass shader ensur expens shadow calcul perform necessary. exampl reduc area pixel perform process shown figur 5.7. 5.4 dynam shadow navig cube explo- ration aim softwar achiev fulli dynam shadow atom culled, clip plane navig cube introduc chapter 3. aid produc better interact experience, light effect chang respons user actions. previou chapter, describ simpl wai achiev dynam ambient occlus effect addit textur store cull flag atom. us techniqu ensur atom cull view 92 figur 5.6: figur show grid travers point light. light grid cell reached, stop traversal. figur 5.7: red area highlight molecul show pixel point light illuminates. limit shadow calcul pixel ensur un- necessari processing, improv performance. 93 figur 5.8: imag show probe sphere (dark blue) point light center. attenu light set illumin atom molecul close proximity, give user better sens depth navig molecular structure. however, shadows, area receiv light thought occlud atom (highlight arrows). figur 5.9: image, shadow enabled. posit probe sphere rel atom clearer, allow user navig structur confidence. 94 longer cast shadow atom visibl scene. small import chang algorithm 1 reduc unnecessari travers shadow rai uniform grid. figur 3.12 show calcul bound cell navig cube. send minimum maximum index cell light shader, abl travers grid outsid bound cells, instead outsid entir grid previous needed. figur 5.10 illustr change. figur 5.10: light blue cell indic bound cell navig cube. shadow rai (the green line), travers grid outsid workspace, instead travers entir grid. bound cell navig cube effici wai cull larg portion molecule, travers shadow rai stop outsid cells. however, need test atom bound cell navig cube. tabl 5.1 show perform overhead dynam shadows, 6 millisecond averag varieti molecules. decreas perform come need check atom culled, mean addit textur read branch light pass shader. seen effect wai produc dynam rai trace shadow molecul ten thousand atom reduc atom render 95 tabl 5.1: compar shadow calcul time small molecule, 1crn, number larger molecul clip atom method. shadow calcul time (ms) overhead (ms) 1crn 327 12.68 0.0 1bk 5231 18.77 6.09 3et 9152 18.53 5.85 1jb0 24198 19.21 6.53 1aon 58870 18.84 6.16 3iyn 99595 19.23 6.55 navig cube. molecul imposs render real time system, explor interact rates. reduc shadow calcul time allow possibl ad direct light source, point light sourc locat center probe sphere, scene. however, limit atom render insid navig cube, user appreci structur molecule. solut render backbon structur molecule, simpl light effects. backbon structur illustr main chain structur biologist us visualis molecule. main chain adopt substructur call secondari structur mainli helic sheets, arrang protein make structur easi identify. seen space-fil models, occlud dens pack atoms. figur 5.11 show backbon structur render alongsid space-fil representation, complex light calcul perform smaller scale. help boost perform whilst allow rai trace shadow ambient occlus effect area molecul user interact with. 96 figur 5.11: backbon structur molecul render user better understand molecular structure. space-fil atoms, there- fore complex light shadow calculations, limit atom insid navig cube. 5.5 soft shadow space-fil molecul us- ing rai trace limit rai trace hard edg comput shadows. light sourc usual defin singl point, mean surfac fulli lit fulli shadowed. reality, surfac partial view light, fraction light sourc visibl point. tradition need cast multipl rai area light sourc order model interact scene. techniqu produc accur soft shadow effect rai used, dramat increas comput time 97 rel hard shadow computation. know rai trace sphere provid opportun calcul plausibl soft shadow littl extra computation. parker et al. [pss98] introduc algorithm creat shadow soft-edg object point light source, creat correct soft-edg shadow area light source. integr techniqu previou rai trace work minim extra code, provid simpl wai creat visual plausibl soft shadow littl extra computation. soft shadow approximate, robust penumbra width behav believ way. main benefit techniqu shadow rai need pixel. figur 5.12: inner sphere cast umbra shadow. outer sphere creat larger shadow, area sphere creat penumbra. seen figur 5.12, penumbra shadow semi-opaqu (outer) object shadow opaqu (inner) object. transpar 98 outer object increas transpar inner object, transpar boundari outer object intens gradient penumbra need look natural. achiev comput variabl s begin surfac inner object, increas distanc surfac outer object. parker el al. suggest linear gradient boundaries, hermit curv provid smoother transit tested. need algorithm remain simpl robust multipl objects. example, point penumbra region objects, composit attenu factor base individu factor s1 s2. minimum valu s1 s2, yield continu intens transit visual pleas result shadow multipl objects. shadow rai p = o + tv light posit l, sphere center c radiu r, need decid penumbra region, so, valu s, fraction distanc umbra penumbra boundaries. comput distanc t0 point shadow rai closest c: t0 = (c o) v (5.5.1) t0 negative, s set 1, collis sphere. comput valu minimum distanc d center sphere c ray: d = t0v c+ o (5.5.2) distanc r rb calcul s as: 99 figur 5.13: produc soft shadow effect, surround sphere center c radiu r, larger sphere radiu rb. scale shadow valu base distanc d shadow rai center sphere. s = (dr)/b (5.5.3) d r, s set 0 rai collid inner sphere. d greater rb, s set 1, rai collid inner outer sphere. valu s multipli specular diffus term produc soft shadow effect scene. tabl 5.2 compar perform soft shadow techniqu hard shad- ows. small molecul hundr atoms, 20 percent increas render time. increas 30 percent molecul ten thousand atoms. rel small hit perform offset realist natur shadow help spatial percept molecule. 100 figur 5.14: exampl tradit hard shadows, calcul cast singl shadow rai point light source. shadow rai collid sphere molecule, diffus specular term set zero, leav ambient term light pixel. figur 5.15: hard shadow replac soft shadow techniqu describ above. smooth chang shadow unshad- ow area seen, aid spatial percept scene. 101 figur 5.16: new render techniqu integr haptimol isa software. user interact molecul control probe sphere phantom omni haptic device. 102 tabl 5.2: comparison perform hard soft shadows. hard shadow (ms) soft shadow (ms) differ (%) 1crn 327 12.72 15.54 19.95 1bk 5231 26.68 33.77 23.45 3et 9152 33.53 43.69 24.52 1jb0 24198 38.29 49.33 25.19 1aon 58870 38.04 50.14 27.44 3iyn 99595 35.93 47.14 26.98 5.6 futur advanc render space- fill molecul path trace path tracing, propos kajiya [kaj86], graphic techniqu similar rai tracing, rai cast camera scene. path trace differ gener light transport path chain rays. rai cast recurs path estim transport radiance. rai trace recurs hit light source, render equat evalu path. distinct illumin emit light sourc illumin reflect surface. rai direct govern bidi- rection reflect distribut function (brdf) defin light reflect surfac object. path trace natur simul global illumin ef- fect indirect lighting, soft shadow caustics, specif ad render methods. effect visibl figur 5.17, includ colour bleed reflections. combin physic accur model object materials, path trace produc photorealist images, commonli gener refer imag render algorithm unbias nature. avoid artifact caus random sampl light paths, larg sampl need pixel produc nois free image. bias path tracer accept loss small accuraci return far fewer sampl need 103 figur 5.17: molecul render path tracing. light path allow bounc time scene. atom given differ materi properties, help quickli distinguish element types. reflect seen red oxygen atom blue nitrogen atoms. pixel gener nois free image. techniqu emploi help reduc sampl need pixel, render time image. unbias path tracing, path radianc consid zero hit light source. however, unlik hit light sourc randomli gener rai directions, especi light sourc small. light scene like effect surfac radianc most, light sampl directli intersect point path. rai unbias path tracer gener uniformli surface. however, far effici gener rai direct lumin greater. import sampl techniqu commonli cast rai converg correct lumin value. densiti rai cast certain direct match strength contribut directions, result 104 same, far fewer rai cast. unbias path tracer, light path bounc infinit environ light sourc hit, leav scene. however, bounc energy, light path bounc time littl impact surfac radiance. limit number light path bounces, commonli pixel, help reduc render time dramat littl impact final image. figur 5.18 illustr basic principl path tracing. figur 5.18: diagram illustr colour pixel determin path tracing. light sourc directli sampl intersect point. indirect illumin gather light path, base materi brdf. recent advanc graphic hardwar start allow straight forward intuit algorithm path trace consid real time applications. rai tracer, detail section 5.2, easili extend allow multipl bounc light rai pixel. main light sourc scene, direct light probe light, sampl directli calcul direct light 105 effects. algorithm 2 describ simpl path trace method glsl light shader. algorithm 2 path trace algorithm 1: pixel contain geometri 2: number bounc 3: minimum intersect point 4: hit 5: return total accumul colour 6: end 7: calcul direct light 8: colour accumul *= current surfac colour 9: total accumul colour += colour accumul * direct light 10: set rai origin intersect point 11: set rai direct base materi brdf 12: end 13: pixel colour = mix(accumul colour, previou frame colour, number samples) 14: end measur render speed path trace number molecules, develop machin previou perform tests, desktop pc nvidia geforc gtx 580 graphic card. implementation, 100 sampl pixel need reduc nois accept level, real time rate number sampl clearli achiev high end gpu. progress rendering, method increment comput image, allow scene remain interactive, gather addit sampl camera stop moving. achiev develop machine, take 83 millisecond calcul sampl small molecule. however, gtx 580 achiev minimum sampl pixel molecul tested, achiev 30 frame second. highlight speed progress seen modern graphic cards. 106 tabl 5.3: path trace perform 100 sampl pixel, 2 light sources, light path allow bounc 3 time scene. render time seconds. ati mobil radeon hd 5650 geforc gtx 580 1crn 327 8.33 1.53 1bk 5231 19.62 1.75 3et 9152 24.77 2.13 1jb0 24198 26.85 2.34 1aon 58870 31.89 2.86 5.7 conclus chapter hope shown shadow plai import role im- prove visual depth percept molecules, aid user navig structur efficiency. shadow achiev rai trace techniqu implement gpu glsl, includ uniform grid acceler structur help achiev real time frame rates. give probe sphere abil cast shadow molecular structur allow user gain better understand posit probe rel atoms. clip molecul nav- igat cube plai import role explor larg molecul interact frame rate. look method ensur shadow effect chang dynam respons user move cube, creat visual believ scene. addit improv shadow natur soft feel incorpor small increas process cost. final look path trace futur render method molecular graphics, note graphic hardwar progress real time rate simpl scene method. chapter 6 conclus 6.1 discuss conclus result thesi improv render method hapti- mol isa software. softwar enabl user interact solvent access surfac biomolecules, probe surfac sphere. render im- provement provid number benefit user explor navig molecular structure. billboard approach render sphere repres atom molecul gave signific perform benefit software. technique, reduc number vertic repres atom hundr origin software, method. technique, however, frame rate drop real time rate develop machin render molecul 50,000 atoms. us point sprite shown possibl wai render sphere screen singl vertex sent graphic pipeline, signific perform gains. notabl advantag billboard techniqu tra- dition triangl mesh. ray-spher intersect test perform pixel billboard, give notic visual benefit ensur sphere represent 107 108 accur nearest pixel. desir haptic feedback provid devic exactli match visual represent screen. softwar featur clip plane aid user explor larg data sets. old form, softwar support singl clip plane attach probe sphere, help user maintain clear view probe, whilst aid find pocket channel structur hidden view. experiment shown plane help reduc render time reduc draw calls, especi larg molecules, limit number vertic scene. improv clip plane implement includ allow atom appear partial culled, give user precis visual cue locat plane relat atoms. clip plane place angl chosen user, addit clip plane support needed. perform appear molecul geometri im- portant aspect software, interest modernis light techniqu current emploi system. ambient occlusion, approxim global illumination, great effect tarini et al. [tcm06] enhanc user percept molecular structure. chosen method pre-comput ambient occlusion, store valu textur map atom. however, softwar allow user interact molecule, move probe sphere, remov area molecul clip planes. need ambient occlus solut handl dynam scenes, enabl user receiv real time visual feedback light effect base input device. spent time investig number real time solut calcul 109 ambient occlusion. method advantag disadvan- tages, goal solut best fit requirements. choic us popular techniqu call screen space ambient occlusion. method ideal larg scene independ scene complexity, al- calcul occlus screen space lead local view depend results. investig rai trace tool captur occlusion. method pro- vide better wai captur global occlus effect, come larg perform cost. look reduc number samples, whilst incorpo- rate blur stage reduc cost accept level. notabl loss localis lower sampl count blur filter. uniqu specialis method consid analyt calcul ambient occlus spheres, demonstr inigo qulez [qui06]. prove effect wai produc high qualiti local ambient occlus effect rel small perform costs, unabl captur global occlus effectively. final look combin methods, allow advantag differ techniqu produc outcom singl techniqu achieve. comparison seen section 4.6, figur 4.9 give visual comparison techniques. shadow import visual cue perceiv depth locat object 3d scene. look shadow aid user navig structur efficiency. chapter 3, look effici method produc rai trace sphere billboards. chapter 5, look possibl continu rai trace theme, produc real time rai trace shadow gpu. consid memori requirements, exist structur propos purcel et al. [pbmh02] chosen, mean support molecul 100,000 atom size. 110 look acceler structur map glsl, uniform grid prove easiest implement. result promising, abl maintain real time rate develop machine. limit uniform grid acceler structure, larg grid cell produc cell size decrease. suggest cell size balanc perform memori requirements. look ad shadow exist light sourc software, locat center probe sphere, illumin area atom close proxim probe. allow light sourc produc shadow user better understand posit probe rel atoms. techniqu optimis shadow calcul point light developed, perform calcul certain pixels, reduc grid traversals. techniqu calcul soft shadow singl shadow rai imple- mented, small impact render performance. help reduc shadow calcul time larger molecules, ad option render small section molecule. allow user us advanc light tech- niqu molecul render interact rates. ad option render backbon trace area outsid navig cube, help user visualis structure. given current rate gpu development, long accur global illumin techniques, path tracing, possibl achiev real time. extend rai trace bounc multipl rai pixel. technique, achiev effect reflect refraction, colour bleeding. atom given differ materi properti help distinguish them, aid depth perception. render speed modern high end gpu prove vastli superior medium rang laptop 111 develop previously, take larg step real time performance. however, new gener graphic card requir interact usag method. overall, investig implement render method benefit user software. built allow graphic effect tune user taste, turn completely. allow softwar run larg varieti computers, low high end. glsl shader built dynamically, ensur minim optim code run frame, reduc costli oper branching. effect high qualiti real time, goal set outset. 6.2 futur work ambient occlus shadow graphic effect enhanc depth perception. whilst approach reproduc realist visualis molecule, includ techniqu depth field. distanc nearest farthest object scene appear accept sharp image. base locat probe sphere, blur object certain distanc sphere, allow user focu small area molecule. post process techniqu prove us depth cu techniqu depth awar contour line halo effect propos tarini et al. [tcm06]. point sprites, larg molecul hard render real time lower specif pcs. occlus cull look wai reduc number draw call need render structure. haptimol enm softwar allow forc appli atom elast 112 network model, haptic feedback device. ball stick represent visualis molecule. rai trace techniqu abl implement software, ad abil produc rai trace cylind repres stick. shown path trace appli molecular graphic provid global illumin scene. achiev real time rate 30 hertz method, combin futur hardware, filter import sampl techniqu reduc number sampl requir pixel, soon allow method interact molecular graphic programs. bibliographi [app68] arthur appel. techniqu shade machin render solids. afip spring joint comput conference, volum 32 afip con- ferenc proceedings, page 3745. thomson book company, washington d.c., 1968. [aw59] berni j alder te wainwright. studi molecular dynamics. i. gener method. journal chemic physics, 31:459, 1959. [aw87] john amanatid andrew woo. fast voxel travers algorithm rai tracing. eurograph 87, page 310, 1987. [bk03] mario botsch leif kobbelt. high-qual point-bas render modern gpus. graphic applications, 2003. proceedings. 11th pacif confer on, page 335343. ieee, 2003. [bkb+07] cagatai basdogan, alper kiraz, ibrahim bukusoglu, aydn varol, sul- tan doganay, cecil pacoret, richard bowman, graham gibson, sinan haliyo, david carberry, et al. haptic guidanc improv task per- formanc steer microparticl optic tweezers. opt. express, 15(18):1161611621, 2007. [bon64] a. bondi. van der waal volum radii. journal physic chemistry, 68(3):441451, 1964. [bp04] michael bunnel fabio pellacini. shadow map antialiasing. gpu gems: program tech trick real-tim graphics, 2004. 113 114 [bs09] loui bavoil miguel sainz. multi-lay dual-resolut screen-spac ambient occlusion. siggraph 2009: talks, page 45. acm, 2009. [bsd08] loui bavoil, miguel sainz, rouslan dimitrov. image-spac horizon- base ambient occlusion. acm siggraph 2008 talks, siggraph 08, page 22:122:1, new york, ny, usa, 2008. acm. [bun05] michael bunnel. dynam ambient occlus indirect lighting. matt pharr randima fernando, editors, gpu gem 2, page 223 233. addison wesley, 2005. [chi] chime-mdl discoveri framework. /smp/1st/kaminuma/chemdraw/chemscape.html [access 24.01.14]. [chr02] h christensen. note# 35: ambient occlusion, image-bas illumi- nation, global illumination. photorealist renderman applic notes, 2002. [chr05] martin christen. rai trace gpu. 2005. [cor] nvidia corporation. cuda. /cuda home new.html [access 24.01.14]. [cpc84] robert l cook, thoma porter, loren carpenter. distribut rai tracing. acm siggraph graphics, volum 18, page 137 145. acm, 1984. [cro77] franklin c crow. shadow algorithm graphics. acm siggraph graphics, volum 11, page 242248. acm, 1977. [del02] warren lyford delano. pymol molecular graphic system, 2002. [access 24.01.14]. [dim07] rouslan dimitrov. cascad shadow maps. develop documentation, nvidia corp, 2007. 115 [dl06] william donnelli andrew lauritzen. varianc shadow maps. proceed 2006 symposium interact 3d graphic games, page 161165. acm, 2006. [dws+88] michael deering, stephani winner, bic schediwy, chri duffy, neil hunt. triangl processor normal vector shader: vlsi high perform graphics. acm siggraph graphics, volum 22, page 2130. acm, 1988. [ek03] cass everitt mark j kilgard. practic robust stencil shadow volum hardware-acceler rendering. arxiv preprint cs/0301002, 2003. [fc66] robert m fano fernando j corbato. time-shar computers. scientif american, 215:128140, 1966. [fi85] akira fujimoto kansei iwata. acceler rai tracing. tosiyasul. kunii, editor, graphics, page 4165. springer japan, 1985. [fm08] domin filion rob mcnaughton. effect & techniques. acm siggraph 2008 classes, siggraph 08, page 133164, new york, ny, usa, 2008. acm. [fra] crytek frankfurt. crysis. [access 24.01.14]. [fs05] tim folei jeremi sugerman. kd-tree acceler struc- ture gpu raytracer. proceed acm sig- graph/eurograph confer graphic hardware, page 15 22. acm, 2005. [gp+03] gael guennebaud, mathia paulin, et al. effici screen space approach hardwar acceler surfel rendering. vmv, volum 20003, page 110, 2003. 116 [groa] khrono group. opencl. [access 24.01.14]. [grob] khrono group. opengl. [access 24.01.14]. [gtgb84] cindi m goral, kenneth e torrance, donald p greenberg, bennett battaile. model interact light diffus surfaces. acm siggraph graphics, volum 18, page 213222. acm, 1984. [hav00] vlastimil havran. heurist rai shoot algorithms. phd thesis, faculti electr engineering, czech technic university, 2000. [hds96] william humphrey, andrew dalke, klau schulten. vmd visual molecular dynamics. journal molecular graphics, 14:3338, 1996. [hei91] tim heidmann. real shadows, real time. iri universe, 18:2831, 1991. [iup] iupac compendium chemic terminology, electron version. [access 24.01.14]. [jen96] henrik wann jensen. global illumin photon maps. ren- dere techniqu 96, page 2130. springer, 1996. [jmo] jmol: open-sourc java viewer chemic structur 3d. [access 24.01.14]. [joh65] ck johnson. ortep, fortran thermal-ellipsoid plot program crystal structur illustrations. 1965. [kaj86] jame t kajiya. render equation. acm siggraph graphics, volum 20, page 143150. acm, 1986. [kclu07] johann kopf, michael f cohen, dani lischinski, matt uyttendaele. joint bilater upsampling. acm trans. graph., 26(3):96, 2007. 117 [kl05] jann kontkanen samuli laine. ambient occlus fields. pro- ceed 2005 symposium interact 3d graphic games, page 4148. acm, 2005. [kmk94] daniel kersten, pascal mamassian, david c. knill. move cast shadow percept rel depth. max-planck-institut biolog cybernet technic report, 1994. [kol65] walter l. koltun. precis space-fil atom models. biopolymers, 3(6):665679, 1965. [lan02] hayden landis. production-readi global illumination. siggraph cours notes, volum 16, 2002. [lau07] andrew lauritzen. summed-area varianc shadow maps. gpu gems, 3:157182, 2007. [lb00] m. s. langer h. h. bulthoff. depth discrimin shade diffus lighting. perception, 29:49660, 2000. [lev66] cyru levinthal. molecular model-build computer. wh freeman company, 1966. [lot11] timothi lottes. fxaa. nvidia white paper, 2011. [ls10] bradford jame loo peter-pik j. sloan. volumetr obscurance. daniel g. aliaga, manuel m. oliveira, amitabh varshney, chri wyman, editors, si3d, page 151156. acm, 2010. [mdg+10] luka marsalek, anna katharina dehof, iliyan georgiev, hans-pet lenhof, philipp slusallek, andrea hildebrandt. real-tim rai trac- ing complex molecular scenes. ebad banissi, stefan bertschi, remo aslak burkhard, john counsell, mohammad dastbaz, martin j. eppler, camilla forsell, georg g. grinstein, jimmi johansson, mikael jern, farzad khosrowshahi, franci t. marchese, carsten maple, richard 118 laing, urska cvek, marjan trutschl, muhammad sarfraz, liz j. stuart, anna ursyn, theodor g. wyeld, editors, iv, page 239245. ieee society, 2010. [mit07] martin mittring. find gen: cryengin 2. siggraph 07: acm siggraph 2007 courses, page 97121, new york, ny, usa, 2007. acm. [mkk98] pascal mamassian, david c. knill, daniel kersten. percept cast shadows. trend cognit sciences, 2(8):288 295, 1998. [mt04] tobia martin tiow seng tan. anti-alias continu trapezoid shadow maps. render techniques, page 153160, 2004. [muu87] michael j. muuss. rt remrt: share memori parallel network distribut ray-trac programs. fourth graphic work- shop proceedings, page 8698. usenix, 1987. [ngu07] hubert nguyen. gpu gem 3. addison-weslei professional, edition, 2007. [pbd+10] steven g parker, jame bigler, andrea dietrich, heiko friedrich, jare hoberock, david luebke, david mcallister, morgan mcguire, keith mor- ley, austin robison, et al. optix: gener purpos rai trace engine. acm transact graphic (tog), 29(4):66, 2010. [pbmh02] timothi j. purcell, ian buck, william r. mark, pat hanrahan. rai trace programm graphic hardware. proceed 29th annual confer graphic interact techniques, siggraph 02, page 703712, new york, ny, usa, 2002. acm. [pg04] matt pharr simon green. ambient occlusion. randima fernando, editor, gpu gems, page 279292. addison wesley, 2004. 119 [pho75] bui tuong phong. illumin gener pictures. com- mun. acm, 18(6):311317, 1975. [por78] thoma k porter. spheric shading. acm siggraph graphics, volum 12, page 282285. acm, 1978. [pov] persist vision pty. ltd. (2004) persist vision raytrac (version 3.6) [comput software]. retriev [access 24.01.14]. [pro] protein explor homepage. /pe beta/pe/protexpl/ [access 24.01.14]. [pss98] steven parker, peter shirley, brian smits. singl sampl soft shadows. most, page 16, 1998. [qui06] inigo quilez. sphere ambient occlussion, 2006. [ac- cess 24.01.14]. [rba09] christoph k reinbothe, tami boubekeur, marc alexa. hybrid am- bient occlusion. eurograph 2009-area papers, page 5157. eurograph association, 2009. [rbc53] linu paul robert b. corey. molecular model amino acids, pep- tides, proteins, 1953. [rot82] scott d roth. rai cast model solids. graphic imag processing, 18(2):109 144, 1982. [rsc87] william t reeves, david h salesin, robert l cook. render antialias shadow depth maps. acm siggraph graphics, volum 21, page 283291. acm, 1987. 120 [rws+06] zhong ren, rui wang, john snyder, kun zhou, xinguo liu, bo sun, peter-pik sloan, hujun bao, qunsheng peng, bain guo. real- time soft shadow dynam scene spheric harmon exponen- tiation. acm transact graphic (tog), volum 25, page 977986. acm, 2006. [sa07] peruma shanmugam okan arikan. hardwar acceler ambient occlus techniqu gpus. i3d 07: proceed 2007 symposium interact 3d graphic games, acm. press, 2007. [sb92] roger sayl andrew bissell. rasmol: program fast, realist render molecular structur shadows. proceed 10th eurograph uk, volum 92, page 79, 1992. [sb08] erk subasi cagatai basdogan. new haptic interact visu- aliz approach rigid molecular dock virtual environments. presence: teleoper virtual environments, 17(1):7390, 2008. [sd02] marc stamming georg drettakis. perspect shadow maps. acm transact graphic (tog), volum 21, page 557562. acm, 2002. [shl09] matthew stocks, steven hayward, stephen laycock. interact biomolecular solvent access surfac haptic feedback device. bmc structur biology, 9(1):69, 2009. [sk04] m sarletu g klein. hardware-acceler ambient occlus compu- tation. vision, modeling, visual 2004: proceedings, novem- ber 16-18, 2004, standford, usa, page 331338, 2004. [stu] pixar anim studios. renderman. [ac- cess 24.01.14]. 121 [swbg06] christian sigg, tim weyrich, mario botsch, marku gross. gpu- base ray-cast quadrat surfaces. proceed 3rd euro- graphics/iee vgtc confer point-bas graphics, page 5965. eurograph association, 2006. [sws+03] ganesh sankaranarayanan, suzann weghorst, michel sanner, alexandr gillet, arthur olson. role haptic teach structur molecular biology. haptic interfac virtual environ teleoper systems, 2003. haptic 2003. proceedings. 11th symposium on, page 363366. ieee, 2003. [tcm06] marco tarini, paolo cignoni, claudio montani. ambient occlus edg cue enhanc real time molecular visualization. ieee transact visual graphics, 12(5):12371244, 2006. [wan92] leonard wanger. effect shadow qualiti percept spatial relationship gener imagery. proceed 1992 symposium interact 3d graphics, i3d 92, page 3942, new york, ny, usa, 1992. acm. [wc+53] jame d watson, franci hc crick, et al. molecular structur nucleic acids. nature, 171(4356):737738, 1953. [wfg92] leonard r wanger, jame ferwerda, donald p greenberg. perceiv- ing spatial relationship computer-gener images. ieee graphic applications, 12(3):4458, 1992. [whi80] turner whitted. improv illumin model shade display. commun. acm, 23(6):343349, 1980. [wil78] lanc williams. cast curv shadow curv surfaces. acm siggraph graphics, volum 12, page 270274. acm, 1978. 122 [wpf90] andrew woo, pierr poulin, alain fournier. survei shadow algorithms. graphic applications, ieee, 10(6):1332, 1990. [wsp04] michael wimmer, daniel scherzer, werner purgathofer. light space perspect shadow maps. proceed fifteenth eurograph confer render techniques, page 143151. eurograph asso- ciation, 2004. [zik98] sergei zhukov, andrei iones, grigorij kronin. ambient light illumin model. render techniques, page 4556, 1998. [zsxl06] fan zhang, hanqiu sun, leilei xu, lee kit lun. parallel-split shadow map large-scal virtual environments. proceed 2006 acm intern confer virtual realiti continuum applications, page 311318. acm, 2006.