eurographics/ ieee-vgtc symposium visual 2009 h.-c. hege, i. hotz, t. munzner (guest editors) volum 28 (2009), number 3 direct occlus shade model interact direct volum render mathia schott1, vincent pegoraro1, charl hansen1, kvin boulanger2, kadi bouatouch2 1sci institute, univers utah, usa 2inria rennes, bretagne-atlantique, franc abstract volumetr render wide examin 3d scalar field ct/mri scanner numer simula- tion datasets. kei aspect volumetr render abil provid perceptu cue aid under- stand structur contain data. shade model reproduc natur light condit shown better convei depth inform spatial relationships, tradition requir consider (pre)computation. paper, shade model interact direct volum render propos provid perceptu cue similar ambient occlusion, solid transpar surface-lik features. imag space occlus factor deriv radi transport equat base special phase func- tion. method reli precomput allow interact explor volumetr data set on-the-fli edit shade model paramet (multi-dimensional) transfer function modif volum clip plane incorpor result occlusion-bas shading. categori subject descriptor (accord acm ccs): graphic [i.3.7]: three-dimension graphic realism subjects: color, shading, shadowing, textur 1. introduct volumetr render wide examin 3d scalar field ct/mri scanner numer simul datasets. kei aspect volum render abil provid shade cue aid understand structur contain datasets. shade model propos improv comprehens complex fea- ture volumes. especi method rel spatial arrang featur account suc- cessfulli appli enhanc qualiti visual volumetr data sets. exampl techniqu ambient occlus (ao), defin light reach point spheric environ light sourc uniform inten- siti enclos scene. surround area light sourc caus occlud structur cast soft shadows, giv- ing critic cue human observ rel spa- tial arrang [lb00]. comput ao challeng- ing, requir global inform volum make task computation intens commonli in- volv precomput approach techniqu feasible. expens comput conflict desir interact volum render techniqu user flexibility. allow chang transfer function clip plane preclud expens precomput make necessari recomput shade paramet ev- eri frame. paper present occlusion-bas shade method yield depth cue similar ao. propos method extend [kph03] render occlus effect inter- activ allow user driven-manipul multi- dimension transfer functions, shown improv classif materi data set com- plex composit [kkh02]. unlik precomput ao methods, clip plane influenc occlus effects. transpar solid surfac shade addit insight desir multipl occlud sur- face time, volumetr data set high featur complex benefit present method. paper structur follows: section 2 discuss re- late work focus volumetr shading. section 3 deriv direct occlus shade physic radi transport outlin integr slice-bas vol- um renderer. result present discuss sec- c 2009 author(s) journal compil c 2009 eurograph associ blackwel publish ltd. publish blackwel publishing, 9600 garsington road, oxford ox4 2dq, uk 350 main street, malden, ma 02148, usa. m. schott & v. pegoraro & c. hansen & k. boulang & k. bouatouch / direct occlus shade interact dvr tion 4, follow conclus futur work section 5. 2. relat work shade model volum render plai critic role help user gain insight ex- plorat volumetr data set. simpl approxim light transport, emission-absorpt model [max95] local illumin shade model blinn illu- minat model [bli77] build foundat vol- um render systems, thank low comput cost simplic implementation. however, light contribut surround featur import perceptu cue support comprehen- sion understand complex featur volumetr data sets. shadow incorpor volum ren- dere systems, basic mean gain addit light- ing occlus information, e.g. precomput shadow volum [br98], variat imag space shadow map [kkh02, dep05, hksb06] ray-cast [rkh08]. ao methods, especi polygon geometry, re- centli receiv consider attent provide, expens preprocess step, method realis- tical shade scene uniform diffus illumination, cheaper cost global illumin [lb00]. here, discuss ao techniqu volum render refer reader recent survei [mfs09] ao tech- niqu general. vicin shade [ste03] obscur shade [rbv08] method determin preprocess step vicinity/obscur valu voxel take surround- ing voxel consideration. occlus base voxel densiti vicin shading, distanc occlud voxel obscur shading, sup- port color bleeding. method requir recomput occlus valu volum classif parame- ter iso-valu transfer function change. vicin occlus map [dyv08] comput imag space halo compar depth valu surround aver- ag depth valu measur arrang voxel vicinity. volumetr halo enhanc depth percept illustr volum render [bg07]. hernel et al. [hly07] comput local ao approxima- tion consid voxel neighborhood voxel illumin spheric light source. ray- cast comput local ambient light emmis- sive contributions, store volum textur us- ing multi-resolut block-bas data structur spatial sampling. chang transfer function caus interact increment refin ambient emis- sive illumin volum recomput transfer function depend block-bas data structures. subsequ public [hly08] extend local ao shad- ing global shadow order scatter effects. ritschel [rit07] consid illumin volum data set distant spheric illumin repres environ map. visibl function comput integr transmitt hundr rai ema- nate voxel spatial undersampl adapt travers hierarch data structure. spher- ical harmon decomposit visibl func- tion environ map allow effici storag evalu low frequenc indirect illumin valu dur- ing direct volum rendering. chang transfer function requir second recomput visibl function. rezk-salama et al. [rs07] us gpu acceler monte-carlo volum ray-cast render isosurfac high-qual scattering, ao refract effects. desgrang et al. [de07] us linear combin opac- iti volum blur differ filter size approxim occlus averag opac surround vox- els. us sum area volum comput averag opac volum transfer function changes. filter occlus map [pm08] us approach similar varianc shadow map [dl06] repres statist in- format neighbor voxel com- pute ao soft shadow effect render iso- surfaces. comput filter occlus map run interact recent gpu arbitrari iso-valu chosen, inaccuraci appear statist ap- proxim repres actual distribut dataset. filter occlus map combin direct volum rendering, semi-transpar materi- al dont influenc occlus computation. ropinski et al. [rmsd08] comput quantiz configur neighbor voxel independ spe- cific transfer function lengthi precomput step. combin precomput valu transfer func- tion allow interact render ao color bleed- ing effects. contrast method, support multi- dimension transfer function post-classification. method propos kniss et al. [kph03] us di- rect indirect light contribut render transluc effects, demonstr cloud region semi-dens materials, block wax. indirect light contri- bution evalu success blur addit buffer, chromat attenu lower magnitud achromat direct light contribut let light penetr deepli material, qualit ap- proxim scatter effect materi strongli forward peak phase function. propos direct occlus shade model us addit buffer comput addit shade model pa- ramet similar kniss et al. [kph03], differ accentu semi-transpar solid surface- like featur viewer-ori backward-peak cone phase function, instead approxim transluc ef- fect semi-dens materi strongli forward scatter- c 2009 author(s) journal compil c 2009 eurograph associ blackwel publish ltd. 856 m. schott & v. pegoraro & c. hansen & k. boulang & k. bouatouch / direct occlus shade interact dvr ing phase functions. support perspect correct sampl attenu occlus buffer implementa- tion exploit multipl render target reduc cpu gpu cost evalu present shade model. float point buffer increas precision, es- pecial low-transpar materi low inter-slic distances. 3. direct occlus shade (a) (b) figur 1: a) geometr setup propos direct occlus shade model show conic subset sphere comput occlusion. b) setup interact comput occlus factors. propos direct occlus shade (dos) model captur import percept cue caus soft shadow effect ao techniqu have eval- uat prohibit expens global ao solution. unlik previou approach consid local occlus spheric neighborhood, do take account fea- ture point ambient light. however, in- stead comput occlus sphere, special- iz phase function, backward-peak cone phase function user-specifi apertur angl illustr fig- ur 1(a), comput occlus effects. spirit similar forward-peak light transport angl render scatter effect interact [kph03] cone angl artist control ao effect offlin render [chr03]. monte-carlo raytrac empir compar direct occlus (figur 2(b)) volumetr ambient occlus isotrop phase function (figur 2(a)). result differ, cone phase function abl highlight featur visual purpos manner similar ambient occlusion. in- teract approxim (figur 2(c)) present slight differ- enc refer images, allow com- plex shade effect render interact frame rate precomputation. chang apertur angl cone, discuss section 4, possibl vari influenc featur differ distances, allow user choos bal- anc visual local global structures. com- plete evalu occlusion, albeit closer physic light transport, restrict flexibility. section outlin radi transport equat deriv direct occlus shade model. given theoret framework, shown extend slice-bas 3d textur volum render support dos. 3.1. radi transport equat radianc integr rai origin ~x0 direc- tion ~, pass particip medium describ radi transport equat (rte) [cpcp05]: l(~x,~) = t (~x, ~x0)lb(~x0,~)+lm(~x,~) (1) lm(~x,~) = z ~x0 ~x t (~x,~x)a(~x)le(~x,~)d~x + z ~x0 ~x t (~x,~x)s(~x)li(~x,~)d~x (2) equat express radianc given point sum attenu background radianc lb(~x0,~) medium radianc lm(~x,~). integr contribut emit radianc le(~x,~), weight wavelength-depend absorpt coeffici a, in-scatt radianc li(~x,~), weight wavelength-depend scatter coeffici s. extinc- tion coeffici t = + s describ radi- anc lost absorpt out-scatt trans- mittanc t (~xa, ~xb) optic thick (~xa, ~xb). t (~xa, ~xb) = e (~xa,~xb) (3) (~xa, ~xb) = z ~xb ~xa t(~x)d~x (4) emit radianc depend local properti medium, in-scatt radianc li(~x,~) depend global properties, defin integr radianc incom point ~x direct ~i, weight phase function (~,~i). li(~x,~) = z 4 l(~x,~i)(~,~i)d~i. (5) recurs evalu l(~x,~i) equat 5 make rte gener challeng evaluate. however, simplifi model suffic visual purpos al- low signific reduct comput cost. section special model. 3.2. direct occlus shade model direction occlus evalu model cone-shap phase function (~,~i), given equat 6. apertur angl cone [0, 2 ). (~,~i) = { 1 2(1co ) if~,~i > cos() 0 (6) radiu r = 1 2(1co ) normal phase function r 4 (~,~i)d~i = 1. model, ~ correspond c 2009 author(s) journal compil c 2009 eurograph associ blackwel publish ltd. 857 m. schott & v. pegoraro & c. hansen & k. boulang & k. bouatouch / direct occlus shade interact dvr (a) monte-carlo, isotrop phase function (b) monte-carlo, cone phase function (c) interact dos, 10.6 fp figur 2: stag beetl data set render a) monte-carlo integr equat 7, isotrop phase function b) monte-carlo integr equat 7, cone phase function apertur angl = 80 c) interact direct occlus shade 1046 slice apertur 80. view direct ~i chosen cone (~,~i) 6= 0. then, rte simplifi as- sume medium emit light (le(~x,~) = 0) scatter light direct cone, describ phase function (~,~i). first-ord scatter- ing event consid in-scatt radiance. certain rai direct ~i, leav volum ~x 0,i, l(~x, ~i) equal constant ambient radianc la attenu- at transmitt t (~x, ~x0,i) ~i scale (~,~i); drop term recurs evalua- tion l(~x,~) equat 5. equat 7 10 model dos: l(~x,~) = t (~x, ~x0)lb(~x0,~)+lm(~x,~) (7) lm(~x,~) = z ~x0 ~x t (~x,~x)s(~x)li(~x,~)d~x (8) li(~x,~) = lav (~x,~) (9) v (~x,~) = z 4 t (~x, ~x0,i)(~,~i)d~i (10) in-scatt radianc li(~x,~) equat 9 fur- ther decompos product fraction visibl term v (~x,~), given equat 10, ambient radi- anc la. fraction visibl conceptu equival occlus factor surfac ao methods, de- scribe environ light reach point ~x. section 3.4 explain us addit buffer interact calcul occlus factor slice-bas volum renderer. difficult measur s t real world data-sets, typic ct/mri scanner measur densiti orienta- tion magnet fields. therefore, 2d transfer function map attribut specifi posit volum chromat scatter coeffici s achromat extinct coeffici t , drop a, le(~x,~) = 0. 3.3. render algorithm propos algorithm, outlin algorithm 1 2, integr slice-bas volum render [wvw94]. graphic hardwar render proxi ge- ometry, typic slice creat intersect view align plane bound box volume, frag- ment program comput color opac valu composit imag previou slice store frame buffer. similar half-angl base method [kkh02, kph03], addit buffer store comput oc- clusion factor slice. ey buffer occlu- sion buffer updat altern slice-by-slic travers volume. addit render pass updat occlus buffer, approxim equat 10 averag- ing sampl taken previou occlus buffer. comput world space proxi geometri cpu, view-align slice render ey point view, project ey buffer. pass, occlus factor determin read occlu- sion buffer project fragment position, multipli color sampl ambient radiance, blend- ing ey buffer front-to-back compositing. next, occlus inform updat render slice again, occlus buffer. dur- ing pass, occlus factor previou occlus buffer integr read averag multipl sam- ples, describ greater section 3.4. finally, current occlus buffer swap algorithm proce slice. final ey buffer computed, get copi frame buffer visibl window, con- vert final valu floating-point format fixed-point format usual displai imag c 2009 author(s) journal compil c 2009 eurograph associ blackwel publish ltd. 858 m. schott & v. pegoraro & c. hansen & k. boulang & k. bouatouch / direct occlus shade interact dvr screen. required, tone-map appli here. 3.4. interact comput occlus factor possibl approxim integr occlu- sion factor describ equat 10 averag attenu- at sampl previou occlus buffer neigh- borhood current fragment propag occlus current occlus buffer. figur 1(b) show setup comput occlus factors. given apertur angl cone inter-slic distanc d, occlusion_ext defin radiu cone base enclos samples, comput equat 11. occlusion_ext = d tan() (11) us view-align slice caus cone axi collinear slice normal. however, perspect pro- jection requir correct factor compens differ size base cone screen space occlusion_ext vari function z coordin slice. correct factor ~c, describ equat 12, comput vertex shader project ma- trix p view space z-compon vertic slices, constant given slice. correct factor~c pass fragment shader comput textur coordin sampl previou oc- clusion buffer, given equat 15. ~c = xscale wscale yscale wscale xscale yscale zscale wscale = p 1 1 z 1 (12) sampl posit ~p gener disk radiu occlusion_ext transform accord equat 13 15. perspect divis project interpol clip space posit ~xyc fragment normal devic coordin ~xyd . then, sampl posit ~p disk radiu occlusion_ext scale component-wis (here de- note ) correct factor~c ad ~xyd . yield sampl posit normal devic coordin ~pd scale bias 0.5 determin textur coordin ~pt sampl previou occlus buffer. ~xyd = ~xyc wc (13) ~pd = ~xyd +~c~p (14) ~pt = 0.5 ~pd + ( 0.5 0.5 ) (15) comput integr approxim read previou occlus buffer sampl posit ~pt , attenu- at sampl transmitt comput distanc tip cone sampl position, final averag weight samples. gener sampl posit p, uniform grid user specifi resolut chosen compromis be- tween perform imag quality. symmetri ori- entat sampl ax occlus buffer reduc inter-fram continu artifact camera po- sition changes. 4. result discuss method implement opengl cg run- ning nvidia geforc gtx 280 gpu 1 gb. imag render 512 512 resolut 16-bit precis floating-point buffer inter-slic distanc d = 0.001 captur high-frequ detail introduc multi-dimension transfer functions. multipl render target (mrt) allow parallel updat ey occlus buffers. render into/read individu layer layer render target per- form blend oper manual fragment pro- gram reduc cpu gpu overhead describ singl render target (srt) implementation. exploit be- havior undefin opengl specification, work practice, ensur read write refer- enc layer. mrt perform increas 44% 99%, compar present srt implementa- tion, especi low number occlus buffer samples. higher number samples, bottleneck shift memori bandwidth, reduc gain exploit mrts. report frame rate mrt imple- mentation. experiment show qualit visual differ exact distanc tip cone sampl point, distanc = d2 + ~p,~p, com- putat t (~x, ~x0,i), approxim inter- slice distanc d, outlin algorithm 3. increas perform 23% (between 30% 98% us- ing mrts) rel high number samples. pre- sent imag render approxima- tion. figur 3 show direct occlus shade model lambertian diffus shade model appli dif- ferent data sets. diffus shade model pro- vide basic hint shape, direct occlus shad- ing model accentu structur concav depth discontinuities. creas brain figur 3(a) ey socket figur 3(b) exampl for- mer; soft shadow cast zygomat bone sphenoid bone figur 3(b) emphas boundari fish bone respect background figur 3(c) illustr latter. figur 4(a) show occlus transpar skin, visibl wrinkl nose accentu solid bone surfac below. figur 4(b), clip plane uncov hidden detail engin block. intri- cate detail tree data set emphas figur 4(c), c 2009 author(s) journal compil c 2009 eurograph associ blackwel publish ltd. 859 m. schott & v. pegoraro & c. hansen & k. boulang & k. bouatouch / direct occlus shade interact dvr (a) 3.7 fp (b) 1.6 fp (c) 48.3 fp (d) 8.8 fp (e) 13.3 fp (f) 16.0 fp (g) 59.0 fp (h) 29.1 fp figur 3: data set show differ direct occlus shade (top row) diffus lambertian shade (bottom row) differ data sets. two-dimension transfer function highlight differ featur mri scan brain resolut 256256160 voxels, ct scan head resolut 128256256 voxels, ct scan carp resolut 256 288 512 voxel ct scan hand resolut 244 124257 voxels. number slice render imag 1000, 1458, 220 619 respectively. (a) 5.0 fp (b) 25.7 fp (c) 5.6 fp figur 4: a) visibl male data set occlus solid transpar materi (512512302 voxels, 962 slices) b) ct scan engin block clip plane exhaust port (256256128 voxels, 679 slices) c) tree data set complex featur expos ambient occlus approxim (512512512 voxels, 1563 slices) 2d transfer function properli classifi differ materi contain decor tree. figur 3(a) 3(b) regular structures, suggest- ing render artifact propos shade model, es- pecial structur visibl dif- fuse shade (figur 3(e) 3(f)). diffus shading, gradient precomput store addit 3d tex- ture resolut volume, access shade trilinearli interpol textur fetch. process implicitli appli low pass filter gra- dients, kei shade paramet diffus shading, ignor high-frequ detail introduc applic transfer function. direct occlus shade hand comput store shade paramet imag space higher resolution, captur emphas high frequenc detail introduc data interpol classification, accentu discret structur c 2009 author(s) journal compil c 2009 eurograph associ blackwel publish ltd. 860 m. schott & v. pegoraro & c. hansen & k. boulang & k. bouatouch / direct occlus shade interact dvr volumetr dataset. case diffus shading, on- the-fli gradient estim classifi data yield sim- ilar render artifact reduced, e.g. higher order filter data set higher resolu- tion. on-the-fli gradient estim trade memori requir store precomput gradient consider reduc per- formance, multipl depend textur fetches. (a) 16.4 fp (b) 1.2 fp (c) 15.7 fp (d) 1.2 fp figur 5: valu (top row: = 50, row: = 85) resolut sampl grid (left col- umn: 2 2, right column: 13 13) determin effect surround features. imag top, base cone cover 0.8 1.3 texel 512512 view port. imag bottom, base cone cover 8.5 12.7 texels, view port resolution. imag render 619 slices. figur 5 show effect vari apertur angl cone phase function. higher valu caus dis- tant featur increas shade variat surfaces, demonstr figur 5(c) 5(a) contrast valu = 50 valu = 85. ambient occlus obscurance-bas techniqu expos similar level con- trol let length occlus rai determin influenc distant featur volume. increas resolut sampl grid reduc alias especi high valu base cone cover rel high number texels. ex- ampl figur 5(c) 5(d), cone apertur angl = 85, occlus extent vari 8.5 12.7 unit texel space, depend z valu slice. low valu , figur 5(a) 5(b), occlus extent cover rel small region occlus buffer, small differ- enc differ grid resolutions. however, perform strongli depend grid resolution, report frame rates. 5. conclus futur work paper, shade model present add occlus effect direct volum rendering. restrict occlus comput cone orient viewer enabl interact render plausibl occlus effects, qualit similar ambient occlus tech- niques. method reli pre-comput allow interact manipul camera position, transfer function clip planes, taken account occlus computation. future, like extend shade model render volumetr soft shadow arbitrari area light sourc adapt half-angl base volum shade tech- niques. integr do volum render method base ray-cast desirable, applic render iso-surfaces. acknowledg like thank graphic group univers vienna, erlangen sylvain gouttard, univers utah, provid dataset review- er comment suggestions. work fund grant nsf, doe inria. refer [bg07] bruckner s., grller e.: enhanc depth- percept flexibl volumetr halos. ieee transact visual graphic 13, 6 (2007), 13441351. [bli77] blinn j. f.: model light reflect syn- thesiz pictures. acm transact graphic (proceed siggraph) 11, 2 (1977), 192198. [br98] behren u., rater r.: ad shadow texture-bas volum renderer. proceed ieee sym- posium volum visual (1998), pp. 3946. [chr03] christensen p. h.: global illumin that. siggraph cours note 9 (renderman: theori practice) (2003). [cpcp05] cerezo e., perez-cazorla f., pueyo x., seron f., sillion f.: survei particip media ren- dere techniques. visual 21, 5 (2005), 303328. [de07] desgrang p., engel k.: fast ambient occlus direct volum rendering. unit state patent application, #20070013696 (2007). [dep05] desgrang p., engel k., paladini g.: gradient- free shading: new method realist interact volum rendering. proceed vision, modeling, visual (2005), 209216. [dl06] donnelli w., lauritzen a.: varianc shadow maps. proceed symposium interact 3d graphic game (2006), pp. 161165. c 2009 author(s) journal compil c 2009 eurograph associ blackwel publish ltd. 861 m. schott & v. pegoraro & c. hansen & k. boulang & k. bouatouch / direct occlus shade interact dvr [dyv08] daz j., yela h., vzquez p.: vicin occlus maps: enhanc depth percept volumetr models. com- puter graphic intern (2008). [hksb06] hadwig m., kratz a., sigg c., bhler k.: gpu-acceler deep shadow map direct volum rendering. proceed 21st acm siggraph/eurograph symposium graphic hardwar (2006), pp. 4952. [hly07] hernel f., ljung p., ynnerman a.: effici am- bient emiss tissu illumin local occlus multiresolut volum rendering. ieee/eg symposium volum graphic (2007), pp. 18. [hly08] hernel f., ljung p., ynnerman a.: interact global light propag direct volum render local piecewis integration. ieee/eg symposium volum point-bas graphic (2008), pp. 105112. [kkh02] kniss j., kindlmann g., hansen c.: multi- dimension transfer function interact volum rendering. ieee transact visual graphic 8, 3 (2002), 270285. [kph03] kniss j., premoz s., hansen c., shirlei p., mcpherson a.: model volum light modeling. ieee transact visual graphic 9, 2 (2003), 150162. [lb00] langer m. s., blthoff h. h.: depth discrimin shade diffus lighting. percept 29, 6 (2000), 649660. [max95] max n.: optic model direct volum rendering. ieee transact visual graphic 1, 2 (1995), 99108. [mfs09] mndez-feliu a., sbert m.: obscur ambient occlusion: survey. visual 25, 2 (2009), 181196. [pm08] penner e., mitchel r.: isosurfac ambient occlu- sion soft shadow filter occlus maps. ieee/ symposium volum point-bas graphic (2008), pp. 5764. [rbv08] ruiz m., boada i., viola i., bruckner s., feixa m., sbert m.: obscurance-bas volum render framework. ieee/eg symposium volum point-bas graphic (2008), pp. 113120. [rit07] ritschel t.: fast gpu-bas visibl comput natur illumin volum data set . eurograph short paper (2007), pp. 5760. [rkh08] ropinski t., kasten j., hinrich k. h.: effi- cient shadow gpu-bas volum raycasting. proceed- ing 16th intern confer central europ graphics, visual vision (wscg) (2008), pp. 1724. [rmsd08] ropinski t., meyer-spradow j., diepen- brock s., mensmann j., hinrich k. h.: interact vol- um render dynam ambient occlus color bleed- ing. graphic forum (proceed eurographics) 27, 2 (2008), 567576. [rs07] rezk-salama c.: gpu-bas monte-carlo volum ray- casting. proceed 15th pacif confer com- puter graphic applic (2007), pp. 411414. [ste03] stewart a. j.: vicin shade enhanc percep- tion volumetr data. ieee visual (2003), pp. 355 362. [wvw94] wilson o., vangeld a., wilhelm j.: di- rect volum render 3d textures. tech. rep., univers california santa cruz, santa cruz, ca, usa, 1994. appendix a: pseudocod render algorithm algorithm 1 main render algorithm (srt) computeproxygeometri occlusion_bu f f erprev occlusion_bu f f ernext 1 eye_bu f f er lb(~x0,~) slice s proxi geometri bindtexture(occlusion_bu f f erprev) setrendertarget(eye_bu f f er) setblendingmode(1destination,1) fragment f s (x, |x|) texture3d(volume, f ) (s,t) texture2d(tran f er_ f unction, (x, |x|)) occlus texture2d(occlusion_bu f f erprev, fclip_space) 1 etslice_dist f rame_bu f f er (la s occlusion,) end bindtexture(occlusion_bu f f erprevious) setrendertarget(occlusion_bu f f ernext ) disableblending() compute~c vertex shader equat 12 fragment f s (x, |x|) texture3d(volume, f ) (t) texture2d(tran f er_ f unction, (x, |x|)) occlus run(algorithm 2 algorithm 3) f rame_bu f f er occlus end swap(occlusion_bu f f erprev, occlusion_bu f f ernext ) end compositwithwindowframebuffer(eye_bu f f er) algorithm 2 occlus correct distanc occlus 0 sampl ~p base cone comput ~pt equat 15 distanc slice_distance2 + ~p,~p transmitt etdist sampl texture2d(occlusion_bu f f erprev, ~pt ) occlusion+ = sampl transmitt end occlus occlusion/|p| algorithm 3 occlus approxim distanc occlus 0 sampl ~p base cone comput ~pt equat 15 occlusion+ = texture2d(occlusion_bu f f erprev, ~pt ) end occlus (occlusion/|p|)etslice_dist c 2009 author(s) journal compil c 2009 eurograph associ blackwel publish ltd. 862