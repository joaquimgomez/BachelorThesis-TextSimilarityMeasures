dynam visibility-driven molecular surfac eurograph 2019 / p. alliez f. pellacini (guest editors) volum 38 (2019), number 2 dynam visibility-driven molecular surfac stefan bruckner univers bergen, norwai figur 1: molecular surfac visual 717k atom render real-tim frame rate (pdb id: 4v4g). method abl render larger structur fulli interact preprocessing. abstract molecular surfac represent import tool visual analysi molecular structur function. paper, present novel method visual dynam molecular surfac base gaussian model. contrast previou approaches, techniqu reli construct intermedi represent grid triangul surfaces. instead, oper entir imag space, enabl exploit visibl inform effici skip unnecessari computations. visibility-driven approach, visual dynam high-qual surfac molecul consist million atoms. approach requir preprocessing, allow interact adjust properti parameters, significantli faster previou approaches, provid superior quality. cc concept human-cent comput scientif visualization; comput methodolog visibility; point-bas models; 1. introduct particle-bas simul wide tool fields. molecular dynam (md) simulations, instance, emploi simul biomolecul proteins. commonli investig protein-ligand protein-protein interactions, import applic field drug design. md simul can, example, calcul behavior molecul ligand, output set consecut spatial atom configur known trajectories. simul gener- at larg time-depend data set compos hundr thousand time step potenti million atom frame. md simul point achiev scale begin compat biolog process [hgo15]. visual fundament tool interpret results, essenti method abl handl ever-increas size data. common wai visual dynam data set depict van der waal surface, i.e., union sphere defin 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. publish john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac van der waal radii respect atoms. main advantag approach atom treat independ union oper perform graphic hardwar z-buffer, enabl fast high-qual render current gpus. simpl approach attract efficiency, advanc sur- face represent offer advantag convei relev molecular properti structure. surfac represent particularli help identif caviti channel access solvent specif molecules, analysi bind site hydrophob hydrophil regions, impact protein characteristics. however, type represent difficult han- dle, surfac definit typic base neighborhood atom. contrast van der waal representation, atom simpli correspond singl sphere, presenc shape surfac atom base distance. common approach visual surfac typic con- struct intermedi data structur order acceler rendering, challeng deal time-depend data, costli process step need execut frame. larg molecules, prohibit term comput load memori consumption. paper, present novel approach visual molecular surfac base gaussian model. contrast pre- viou methods, typic reli intermedi volumetr grid triangul render rai casting, approach aim defer surfac construct render stage, visibl inform exploited. molecular data typic dense, fraction actual surfac visible. enabl avoid major comput load object space methods, enabl handl dynam data overhead, let chang surfac paramet on-the-fli addit costs. best knowledge, method enabl interact render dynam molecular surfac structur consist million atoms, prior data reduction. 2. relat work research aim enabl real-tim visual high-qual molecular surfac dynam data. kozlkov et al. [kkf17] provid comprehens overview approach visual molecular data. common molecular surfac represent solvent exclud surfac (ses) [ric77], surfac trace spheric probe roll atom spheres. practic approach com- pute se present connolli [con83], provid analyt descript base type patch algorithm extraction. costli natur initi algorithm, signific research devot find altern solutions. totrov abagyan [ta96] present contour-buildup method, extract patch se solvent access surfac (sas). varshnei et al. [vbww97] develop parallel approach base power diagrams. reduc surface, propos sanner et al. [sos96], intermedi represent ac- celer comput analyt ses. later develop increas us multi-cor cpu gpu im- prove perform se generation. lindow et al. [lbph10] present parallel version contour-buildup method multi- core cpus, krone et al. [kge11] describ gpu adapt algorithm, achiev interact comput time smaller molecul 10k atoms. approach us gpu-bas rai cast render individu patch [kbe09]. altern approach, parulek viola [pv12] propos im- plicit formul se render directly, perform limit costli evaluation. parulek bram- billa [pb13] subsequ present faster implicit approxim ses. limit scalabl analyt approaches, approxim method reli intermedi grid repre- sentat presented. method gener faster, requir memory. exampl includ method et al. [ccw06] emploi level-set-bas approach se computation, recent work hermosilla et al. [hkg17] us increment scheme mask latenc final sur- face computed. altern ses, gaussian surfac offer practic advantages, convei im- portant molecular properti [bc10]. origin introduc gener model approach graphic term metabal blinn [bli82], gaussian model visu- aliz particle-bas data outsid context molecular visual- ization. mller et al. [mge07] present multi-pass image-spac approach, achiev interact perform thousand particles. method kanamori et al. [ksn08] gpu-bas approach base bezier approxim gaussian densiti surface, achiev interact frame rate thousand sphere five-fold speedup compar cpu implementation. approach conceptu similar method, suffer us depth peel requir render larg number spheres, partial address occlus queri cpu-bas inter- section test base image-spac tiles. fraedrich et al. [faw10] sampl particl smooth particl hydrodynam (sph) data perspect grid render rai cast- ing. knoll et al. [kwn14] present cpu-bas framework render larg particl data sets. approach focus direct volum render radial basi function kernel us bound volum hierarchi construct preprocess step. approach hochstett et al. [hok16] us adapt sampl scheme perform volum render dynam particl set driven user-control screen space error tolerance. do santo brito et al. [dsbvestt18] present rai trace method particl data achiev frame second million particles. zirr dachsbach [zd18] propos on-the-fli voxel method particl data acceler rai cast approach render achiev consider speedup compar method fraedrich et al. [faw10]. approach focu gener particl data, techniqu specif target molecular visual presented. method dia et al. [dg11] us cuda-bas approach gener densiti grid subsequ surfac extract march cube [lc87]. quicksurf present krone et al. [kses12] current known fastest 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac approach molecular surfac extract [kkf17]. method conceptu similar work dia et al. [dg11], us gather instead scatter approach grid generation, abl achiev ten-fold speedup, en- abl applic dynam data. however, techniqu heavili constrain resolut intermedi vol- ume. coars grid resolut result signific loss larger molecules, higher resolutions, both, cost volum gener result vast number triangles, prevent interact performance. approach present paper aim address draw- back object space method enabl interact visual- izat gaussian surfac larg dynam molecular data. concept close relat method notion output- sensit algorithm, i.e., algorithm run time mainli determin size output context complex output imag plane, oppos number atom molecule. falk weiskopf [fw08], instance, develop larg output-sensit techniqu 3d line integr convolu- tion, oltszov et al. [bs17] present output-sensit approach filter stream volum data. 3. visibility-driven molecular surfac render gaussian molecular surfac implicit surfac base densiti function (x) defin (x) = e sxci 2 ri 2 (1) ci atom positions, ri van der waal radii, s user-defin scale factor > 0 control appear surface. surfac locu point x (x) t = 0, t suitably-chosen threshold. decreas paramet s, individu gaussian curv wider, caus nearbi atom smoothli merg singl structure. context molecular visualization, emul behavior se close gap atom enter spheric probe, shown appropri parametr lead good approxim se [lcl15]. typic approach visual surfac sampl (x) volumetr grid, subsequ render directli isosurfac rai cast triangul creat surfac mesh specif threshold. cases, disadvantages. first, choic grid resolut repres difficult trade-off perform surfac quality. especi problemat signific proport comput resourc potenti spent region volum visibl current viewpoint. partic- ular consid time-depend data, grid need recomput new timestep. method base volum rai casting, typic reli spatial acceler data struc- ture skip space, need regener data structur frame forego optimizations. triangulation-bas approaches, hand, need recomput surfac mesh contain larg number triangl suffici surfac qualiti desired. (a) (b) (c) (d) (e) figur 2: illustr intersect list gener pass. gaussian surfac occur sphere influenc (indic outer circles) overlap, case red (a) green (b) spheres. overlap locat van der waal sphere (indic fill inner circles) need considered, orang (d) purpl (e) sphere store list depict ray, occlud blue sphere (c). order avoid issues, approach aim evalu densiti function directly, intermedi discretization. instead, construct compact on-the-fli data structur render frame allow fast visibility-bas traversal. view-depend list-bas data structur order comput intersect visibl surface. avoid major comput occlud part molecule, method provid real-tim perform larg dynam data. remaind section subdivid accord main step method. first, section 3.1, present approach quickli identifi atom potenti contribut visibl surface. next, section 3.2, present simpl algorithm visibility-bas rai travers allow minim comput devot occlud region data. finally, effici evalu intersect view rai gaussian surfac section 3.3. 3.1. list gener main challeng effici render gaussian surfac identif contribut atoms. point space, surfac model sum gaussian functions. interest visual represent smoothli envelop van der waal spheres, assum final surfac union gaussian surfac van der waal surface. while, principle, gaussian footprint atom infinit support, common, specifi cutoff radiu contribut particular atom consid zero. hence, atom defin center ci, van der waal radiu ri, radiu sphere influenc ri. atom contribut densiti function outsid sphere influence, contribut densiti function final imag occur region sphere influenc overlap. furthermore, view ray, overlap occlud van der waal sphere potenti contribut surface, illustr figur 2. therefore, import step, identifi intersect view rai van der waal sphere, 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac simpli amount render entir molecul spheres. us standard approach render vertex atom, construct quad accord screen space bound box correspond sphere, comput ray-spher intersect analyt [swbg06]. next, view ray, need inform sphere influenc intersect actual overlap. atom, render sphere influenc manner van der waal spheres. however, instead store intersection, intersect point occlud van der waal sphere recorded. achiev this, us approach similar gener a-buff order-independ transpar [kkp13, jpsk16], link list intersect store pixel. entri intersect list pixel store near far intersect depth atom sphere influence, center posit atom, attribut field, index previou list entry. attribut field contain element id atom retriev radius, attribut inform residu id chain id, map addit quantiti surface. 3.2. rai travers gener list intersect unocclud sphere influenc atoms, approach proce travers view rai pixel front-to-back manner. order so, obviou step sort list intersect rai accordingly. however, consid fact data dense, sort entir list proceed inefficient, interest intersect gaussian surface. instead, interleav surfac intersect sorting, termin soon intersect gaussian surfac detected, avoid need sort remaind list. purpose, us adapt select sort, advantag properti i-th iteration, element correctli sorted. mean itera- tion = 1 (assum zero-bas indices), proce check sphere influenc intersect rai overlap. case, sort process continues. oth- erwise, begin span, i.e., atom sphere influenc overlap need consid test intersect gaussian surface. overlap atom constitut span need known, intersect test commenc end span reached, i.e., identifi current atom sphere influenc overlap sphere span, reach end list. cases, initi intersect test, detail section. soon intersect detected, sort loop terminated. effici sort algorithm entir list sort (e.g., case transparency), opaqu render approach provid superior performance. practice, begin rai traversal, scan intersect list store indic global memori pool local arrai effici access. way, sorting, need swap local store indic instead input: arrai count intersect point indic ii, refer near f ar intersect depth respect atom sphere influenc 1 ss = 0 2 = 0 count1 3 k = 4 j = i+1 count1 5 nearii[ j] < nearii[k] k = j 6 end 7 swap(ii[i],ii[k]) 8 ss < 9 count1 f arii[ss] < nearii[i] 10 intersect(ss,i) break 11 ss = ss+1 12 end 13 end 14 end algorithm 1: pseudocod algorithm visibility-driven rai traversal. larger list entries. pseudocod simpl algorithm given algorithm 1. input arrai unsort intersect indic ii correspond list entri current ray, list near far intersect depth sphere influence. iteration, algorithm find smallest near intersect depth remaind arrai swap posit i, mean entri ii 0 correctli sorted. span start index ss track begin current span. soon end span detected, list entri traversed, intersect test perform correspond interv of, sorted, indic ss i. 3.3. surfac intersect obviously, algorithm describ previou section requir effici procedur determin intersect rai gaussian surfac gener set atoms. general, root sum arbitrari number exponenti function analytically. origin work metabal [bli82], blinn suggest us standard iter method newton iter regula falsi. newton iter converg rel rapidly, diverg initi guess suffici close real solution. regula falsi guarante converg initi interv contain root, typic consider slowly, converg root desir- abl rai cast [har93]. hence, approach begin root isol phase, divid search interv segment contain singl root. then, root refin phase us faster method approach root desir precis reached. intersect test consider im- pact overal perform quality, import identifi best possibl choice. hart [har96] introduc sphere trace effici approach render implicit surfac base sign distanc functions. distanc bound implicit function available, approach guarante converg linearli root interv 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac t = 0.25 t = 0.5 t = 0.75 s = 1 -3 -2 -1 1 2 3 -1.0 -0.5 0.5 1.0 -3 -2 -1 1 2 3 -1.0 -0.5 0.5 1.0 -3 -2 -1 1 2 3 -1.0 -0.5 0.5 1.0 s = 2 -3 -2 -1 1 2 3 -1.0 -0.5 0.5 1.0 -3 -2 -1 1 2 3 -1.0 -0.5 0.5 1.0 -3 -2 -1 1 2 3 -1.0 -0.5 0.5 1.0 s = 3 -3 -2 -1 1 2 3 -1.0 -0.5 0.5 1.0 -3 -2 -1 1 2 3 -1.0 -0.5 0.5 1.0 -3 -2 -1 1 2 3 -1.0 -0.5 0.5 1.0 figur 3: plot gaussian densiti function (x) t (in blue) correspond distanc function (x) t (in orange) differ valu s t atom posit -1 1. seen, behavior distanc estim close linear, root function same. b c d figur 4: capsid protein (pdb id: 6b0x) cpk element color- ing (a) s = 1, (b) s = 2, (c) s = 4, (d) s = 8 valu s increased, surfac approach van der waal spheres. penetr surface. wide distance-funct base modeling, shown fast robust approach render compar gener methods. gaussian surfaces, hart suggest us polynomi approxim [wt90], distanc bound easili found. however, target molecular visualization, want preserv appear properti gaussian surfaces. follow hart, function f : r3r sign distanc bound implicit surfac f1(0), | f (x)| d(x, f1(0)) (2) d point-to-set distanc point x r3 set r3 defin d(x,a) = min ya xy . (3) examin equat 1, singl atom ideal dis- tanc function easili obtain appli transform ln()s1 side equat (x) = t, normal euclidean distanc center atom appropri adjust threshold. however, approach work multipl atoms, real root equat unaffect transformation. given densiti function (x) correspond threshold t defin equat 1, sign distanc estim d (x) = (x) t (4) (x) = ln((x)) s (5) 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac t = ln(t) s . (6) function (x) t root (x) t, pro- gress linearli posit farther awai surface, seen figur 3 show origin function (x)t blue distanc estim (x) t orang differ combin s t. infin visibl s = 1 problematic, note occur neg values, i.e., insid object, affect outcome. equat 4 allow reproduc result exist method us differ valu s t, combin valu produc meaning results. hence, practic proven conveni fix t let user specifi s directly, simultan adjust t. imple- mentation, us t = 1, mean equat 6, t set es. intuit then, s increas result- ing surfac smoothli approach van der waal surface, demonstr figur 4. lead wai estim atom sphere influ- ence, far omitted. simplest approach, common grid-bas methods, us fix cutoff distanc contribut individu gaussian equa- tion 1 assum zero. alternative, instead propos set distanc accord estim atom averag influenc posit space. sphere influenc individu atom chosen that, n atom contribut densiti position, sum contribut threshold. assum base atom radiu ri, want sphere influenc radiu ri ne sri 2 ri 2 t = 0. (7) solv ri, obtain ri = ri ln (n t ) s . (8) hence, approach specifi radiu influenc atom ri van der waal radiu ri multipli sec- ond term righthand equat 8. expected, multipli approach infin s approach zero (where gaussian densiti constant), smoothli approach s increases. figur 5 plot behavior function respect s differ valu n. result paper, us valu n = 32, result ri 2.11ri s = 1. approach, us hart sphere trace ap- proach intersect computation, and, close-to-linear behavior function rapid pace. intersect function take input interv overlap atom indic [i, j] sort accord closest intersect sphere influenc algorithm 1. informa- tion overlap spheres, addition set rel tight bound search range. gaussian surfac n=16 n=32 n=64 n=128 0 1 2 3 4 5 1.0 1.5 2.0 2.5 3.0 s ri figur 5: sphere influenc radiu ri n {16,32,64,128} differ valu s accord equat 8 r = 1 t = es. intersect correspond sphere overlap, rang neari+1 f ar j1 need considered. itera- tive method, sphere trace requir specif toler value. us valu 0.0125 roughli 1% van der waal radiu hydrogen atom determin experiment detect impact quality, result paper gener value. us standard implement sphere tracing. iteration, valu (x) comput sum respect contribut atom, (x) t compar toler value, and, larger, rai advanc view direct (x) t. exponenti function derivative, normal point x comput analyt d dx = 2s(x ci) ri2 e sxci 2 ri 2 , (9) consist quantiti need evalua- tion densiti function anyway, i.e., normal comput summat process simpli weight vector center current atom point x accordingly. likewise, addit quantiti map sur- face, color charges, easili interpol manner gaussian weight respect atom. actual gaussian weight intersect point consider benefici impact visual qualiti result imag compar triangulation-bas methods, barycentr interpol triangl result diamond- shape artifact well-known gouraud shading, seen figur 11. 4. implement method implement c++ opengl run complet gpu. apart necessari boilerpl c++ code, main step techniqu written glsl. input requir atom posit radii. allow 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac b figur 6: structur human 80 ribosom (pdb id: 4v6x) consist 237k atom cpk element color render (a) s = 1 (b) s = 2 distance-bas blend molecular surfac van der waal spheres. b figur 7: structur phycobilisom red alga griffithsia pacifica (pdb id: 5y6p) consist 1.2m atom render chain color (a) s = 0.5 (b) s = 1. flexibl map molecular attribut optic properties, store atom posit attribut field singl 4-compon vertex buffer object. attribut field look atom radii option map quantiti set uniform buffer objects. current implement support color map element id (see figur 6), chain id (see figur 7), residu id, attribut ad easily. vertex geometri shader van der waal sphere render- ing list gener identical, fragment shader differs. van der waal spheres, depth, normal, attribut field store framebuff object. list gener fragment shader write framebuffer, instead us imag object (initi zero) store index list entri pixel, shader storag buffer object store intersect data. buffer contain singl counter total number alloc entri (initi zero), arrai 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac b figur 8: atomic-level structur entir hiv-1 capsid (pdb id: 3j3q) consist 2.4m atom chain color (a) outsid (b) inside. actual list entri structures. entri store near far intersect depth sphere influenc (one floating-point valu each), atom center (3 floating-point values), attribut field (one integer), index previou list entri (one integer), amount total 28 byte list entry. memori buffer alloc fix pool startup resiz necessary. begin list gener fragment shader, in- tersect sphere influenc computed. near intersect depth larger depth van der waal pass, fragment immedi discard output gener- ated. otherwise, new list entri alloc tail list current pixel updated. requir us atom oper avoid race conditions: first, total entri count atom increment alloc new list entry, return valu atom exchang entri index correspond pixel updat tail list. valu return atom exchang oper set previou index field new list entry. rai travers initi render screen-fil quad. beginning, tail buffer read zero (i.e., list pixel empty) fragment immedi discarded. normal materi valu (use attribut field) current rai initi valu van der waal pass ensur van der waal sphere render intersect occurs. shader proce describ section 3.2 3.3. rai travers terminated, surfac normal depth unshad color written 4-compon textur subsequ defer shading. prototyp support screen space ambient occlus method mcguir et al. [mml12] depth-of-field techniqu bukowski et al. [bhom13] appli usual stage defer shade pipeline. demonstr approach easili integr modern render pipelines. furthermore, effect particular screen space ambient occlus sensit normal depth discontinu triangulation, result imag paper method suffer problems. method need atom positions, radii, option attribut input, handl time-depend data molecular dynam simul straight-forward. individu time step store vertex buffer objects, interpol time step easili possibl pass posit con- secut time step vertex shader van der waal sphere render list generation. furthermore, time step resid gpu, doubl (or multiple) buffer strategi time step transfer asynchron current rendered. current implement exploit featur avail recent opengl version (e.g., uniform buffer shader storag blocks) simplifi code, method reli hardwar capabl avail prior gener gpus. perform low-level optimizations, entir implement compris 1000 line shader code. method implement stand-alon prototyp plan avail commun permiss licens facilit integr exist applications. 5. result order evalu approach, perform extens experi- ment data protein data bank (pdb) rang thousand million atoms. test intel core i7-4939k 3.40 ghz cpu equip nvidia geforc 1080 gtx gpu. figur 6, 7, 8 data set consist 237k, 1.2m, 2.4m atoms, respectively, method abl easili render interact frame rates. figur 6 7, visual effect increas s, result surfac details, eventu smoothli approach van der waal sphere individu atoms. figur 8 demonstr restrict viewpoint show outsid insid view depict structure. tabl 1, frame rate repres select molecular data sets, shown paper, rang rel small larg differ viewport size valu s. bound box data set scale fulli fit viewport dimens avoid clip model, measur repres minimum, maximum, averag frame rate 360 degre rotat model center princip coordin ax 1080 frame (360 frame axis). seen, approach remain fulli interact million atom high resolutions. viewport size 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac tabl 1: render perform method frame second (minmax avg) measur intel core i7-4939k 3.40 ghz cpu equip nvidia geforc 1080 gtx gpu. bound box data set scale fulli fit viewport, frame rate comput rotat model center princip coordin ax 1080 frame (360 frame axis). pdb id atom 7682 viewport 10242 viewport 12802 viewport s = 1 s = 2 s = 3 s = 4 s = 1 s = 2 s = 3 s = 4 s = 1 s = 2 s = 3 s = 4 6b0x 16 791 98221148 175 504 350 228 777 538 297 990 708 63 161 94 121 335 228 169 507 366 184 649 472 53 127 77 111 276182 154 405 289 179 506 377 5vox 34 724 97201156 201 511 402 277 842 642 323 1089 821 70 129100 137 337 265 191 524 420 227 676 551 62 105 82 125 272 214 166 420 337 205 538 435 1aon 58 870 91231150 182 510 357 241 773 538 254 933 678 55 137 93 110 323 225 165 476 347 183 587 435 51 113 76 105 266183 146 385 279 173 471 349 5ot7 154 665 80129105 152 305 250 203 450 373 231 569 476 51 82 65 101 199154 129 301 241 165 376 311 43 64 53 92 159131 126 232193 148 294 247 4v6x 237 685 80135111 148 317 262 197 461 381 229 566 474 51 87 67 101 210161 137 312 245 165 386 313 42 68 56 89 165137 118 245199 144 304 250 4v4g 717 805 106261198 163 394 324 202 451 382 213 483 416 82 214154 136 347 271 160 406 333 180 436 365 75 178123 127 310 234 160 368 300 172 402 335 5y6p 1 234 811 74125100 117 210172 138 248 211 150 270 232 49 83 68 89 165138 115 210179 125 236 205 44 70 57 11 143116 76 187156 118 209180 3j3q 2 440 800 5788 71 87 128110 98 144127 106 155139 40 68 51 69 109 89 79 128108 88 136119 36 58 43 66 100 82 79 120102 85 131113 12802 dataset consist 2.4m atoms, achiev 40 frame second s = 1. seen, method visibility-driven, scale sublinearli atom count. cases, larger data set achiev higher frame rate smaller ones. unexpected, mean specif geometr arrang heavier impact perform number atoms. instance, 4v4g highli asymmetr elong shape (see figur 1), project imag plane cover pixel spheric data sets. cours approach complet independ atom count, list gener phase requir comput intersect van der waal sphere sphere influenc atoms, costlier intersect gaussian surfac significantli benefit visibility-bas method. analyz further, perform measur in- dividu phase technique. figur 9, total render time divid render van der waal sphere ("spheres"), list gener ("list"), rai travers surfac intersect ("surface"), final shade ("shading") extrem valu s = 1 s = 4 viewport size 12802. smaller data sets, sphere render list gener account rel small fraction total render time, number atom increases, rel impact rises, particular higher valu s case rai travers termin quickly. s = 1, surfac intersect domin render time largest test data sets. fig- ur 10 addition depict total render time scale increas sphere influenc radiu (correspond decreas valu s) viewport size 12802. figur addition includ measur s = 0.5 method approach limit respect interactivity, achiev 16 frame second largest data set. present measur includ cost regular phong shading, ambient occlus depth field disabled. overhead option effect depend imag size, 1.5 ms viewport size 12802 implementation. mean largest dataset 3j3q s = 1 viewport size 12802, perform drop 43 40 frame second effect enabled. 6b0x 5vox 1aon 5ot7 4v6x 4v4g 5y6p 3j3q sphere list surfac shade 0 ms 5 ms 10 ms 15 ms 20 ms 25 ms 6b0x 5vox 1aon 5ot7 4v6x 4v4g 5y6p 3j3q s = 1 s = 4 figur 9: distribut total render time differ phase method viewport size 12802 valu s = 1 s = 4. data set list tabl 1 static, access simul data span repres rang atom counts. however, handl time-depend data come addit cost method comput on-the-fli frame, verifi experimentally. compar method krone et al. quicksurf ap- proach [kses12], avail popular softwar packag visual molecular dynam (vmd) [hds96]. heavili opti- mize cuda-bas implement us parallel gather ap- 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac 0 ms 10 ms 20 ms 30 ms 40 ms 50 ms 60 ms 70 ms 1 1.5 2 2.5 3 6b0x 5vox 1aon 5ot7 4v6x 4v4g 5y6p 3j3q render time r r s=0.5s=1s=2s=3s=4 figur 10: scale total render time increas sphere influenc radiu accord equat 8 viewport size 12802. tabl 2: perform quicksurf method frame second implement vmd 1.9.3 viewport size 12802. column "full" give total perform includ comput surface, column "render" give render time surfac computed. pdb id grid res. 1.0 grid res. 0.7 grid res. 0.5 render render render 6b0x 74 120 29 96 12 44 5vox 22 48 10 22 5 14 1aon 27 62 10 21 4 9 5ot7 12 29 4 5 3 8 4v6x 8 31 1 3 n/a n/a 4v4g 2 6 n/a n/a n/a n/a 5y6p 2 5 n/a n/a n/a n/a 3j3q 0.8 4 n/a n/a n/a n/a proach comput gaussian densiti grid, parallel version march cube [lc87] algorithm. account differ graphic hardware, result ob- tain consist origin experi present krone et al. default, quicksurf us coars grid space 1 , need reduc surfac detail desired, measur perform grid space 1, 0.7, 0.5. result shown tabl 2. method object space approach, frame rate total comput time includ grid comput march cube (column "full"), need perform time step case dy- namic data, render time (column "render"). data set view setup tabl 1. main comput load quicksurf approach (grid genera- tion march cubes) independ viewport size, perform measur largest size 12802 fair comparison. seen, quicksurf perform par techniqu smallest data set coarsest grid b c figur 11: comparison quicksurf march cube surfac grid space (a) 1 (b) 0.5 (c) method (pdb id: 1aon). resolution, atom count exce 100k interact method limited. interest note larger molecul render frame rate recomput significantli lower ours. like high ge- ometri load caus excess number triangl produc march cubes, method requir vertex atom. abl measur perform data set default grid resolution, abl obtain result fine resolut larger data sets. com- pare approach triangul surfac term quality, default grid space 1 exhibit typic artifact caus barycentr interpol surfac properti triangles, shown figur 11 (a), per-pixel light enabled. finer grid resolut remedi degree, depict figur 11 (b), appear blurri method shown figur 11 (c). tabl 3 list mean valu maximum averag number entri pixel intersect list (a longer intersect 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac tabl 3: tabl list mean valu maximum averag number intersect list entri pixel, pixel coverag memori consumpt measur viewport size 12802 s = 1. pdb id max. entri avg. entri coverag memori 6b0x 60.30 1.17 13.63% 47.20mb 5vox 76.52 0.85 9.37% 34.24mb 1aon 57.56 1.04 12.01% 42.18mb 5ot7 67.59 1.37 15.30% 55.54mb 4v6x 68.69 1.22 13.76% 49.38mb 4v4g 67.79 0.31 3.26% 12.43mb 5y6p 66.89 0.89 10.02% 35.88mb 3j3q 71.43 1.09 11.99% 43.92mb list result lower performance, bound number iter need perform algorithm 1) memori requir store list entri largest test viewport size 12802 s = 1, averag manner tabl 1. tabl give averag percentag viewport pixel cover model. figur 12 (b), exampl number entri intersect list distribut image. seen tabl 3, size intersect list independ atom count, result modest memori consumpt 50 mb. memori requir framebuffers, vari depend addit postprocess step screen space ambient occlus similar defer shade pipeline, total memori footprint techniqu 150 mb viewport size 12802. mean method suitabl lower-end gpu avail laptop comput typic memory. like note quicksurf highli capabl solut gener triangul surfac molecular data, outperform implement order magnitude, best method extract surfac analysi purposes. however, visual dynam surfac method repres attract altern term performance, quality, flexibility, memori consumption. method fulli dynamic, straight-forwardli possibl vari surfac paramet view-depend manner. example, implement magic len tool vari s paramet continu base imag space distanc mous cursor. simple, result compel surfac dynam gradual shrink van der waal sphere nearbi atoms, demonstr figur 13. similarly, emploi seamless abstract approach adjust surfac detail base view distanc [pjr14] properties. 6. discuss limit shown, approach capabl render larg molecul high qualiti performance, modest 66 0 b figur 12: structur elong factor g-ribosom complex (pdb id: 5ot7). (a) render s = 1. (b) number list entri pixel map color. memori footprint. fulli dynamic, abl handl time-depend procedur gener data set overhead. limit method perform depend scale factor s showed, lower valu s, larger neighborhood atom taken account, reduc achiev frame rates. demonstr figur 10, reason interact perform largest test data set achiev s = 0.5, valu reduc approach hit limitations. larg scale structur consist- ing ten million atoms, limit perform method high degre surfac abstract desired. how- ever, case prior gener level-of-detail hierarchi merg nearbi sphere meaning solution, pro- jection singl sphere like cover pixels. method fulli compat approach dynam natur enabl smooth blend hierarchi levels. further- more, approxim se standard probe radiu 1.4 , bernstein et al. [bc10] valu s close 1 (note formulation, s defin reciproc manner). addition, relev mention method behavior invers grid-bas method respect parameter, gener achiev better perform higher degre smooth performed, coarser grid resolut used. gaussian surfac us shown pro- vide meaning relev represent molecular visual- izat [lcl15], nonetheless desir method similar perform type molecular surfaces. case gaussian approxim insufficient, current approach se visual limit perform 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac b figur 13: dynam lens effect adjust valu s reveal structur len posit (a) left, (b) lower right imag focu region addition us color chain (pdb id: 5vox). abil handl larg data. futur work, plan investig applic approach type molecular surfaces, particular se molecular skin surfac (mss) [ede99]. list gener rai travers phase method directli applicable, intersect test complex differ type patch need identifi clipped. ses, particular, exhibit singular [kbe09] resolv non-loc information, prove challeng efficiently. finally, method specif develop con- text molecular visualization, note techniqu applic type particle-bas data. instance, be- liev approach valuabl context real-tim smooth particl hydrodynam (sph) fluid simulation, enabl fulli gpu-bas simul visual loop. 7. conclus present novel approach visual gaussian molecular surfaces. exploit visibl information, abl develop effici method enabl render larg dynam data set need intermedi grid representation. techniqu us on-the-fli gener list intersect atom sphere influence, inter- leav visibl sort intersect test avoid unnecessari computations. real-world data set includ larg structur consist million atoms, demonstr method achiev high perform quality, have small memori footprint. acknowledg research present paper support metavi project (#250133) fund research council norway. refer [bc10] bernstein h. j., craig p. a.: effici molecular surfac render linear-tim pseudo-gaussian approxim leerichard surfac (pgalrs). journal appli crystallographi 43, 2 (2010), 356361. doi:10.1107/s0021889809054326. 2, 11 [bhom13] bukowski m., hennessi p., osman b., mcguir m.: skyland swap forc depth-of-field shader. gpu pro 4: ad- vanc render techniques. 2013, pp. 175184. 8 [bli82] blinn j. f.: gener algebra surfac drawing. acm transact graphic 1, 3 (1982), 235256. doi:10.1145/ 357306.357310. 2, 4 [ccw06] t., chen c.-i., wang y.-f.: effici molecular surfac gener level-set methods. journal molecular graphic model 25, 4 (2006), 442454. doi:10.1016/j.jmgm.2006. 02.012. 2 [con83] connolli m.: analyt molecular surfac calculation. jour- nal appli crystallographi 16, 5 (1983), 548558. doi:10.1107/ s0021889883010985. 2 [dg11] dia s. e., gome a. j.: graphic process unit-bas triangul blinn molecular surfaces. concurr com- putation: practic experi 23, 17 (2011), 22802291. doi: 10.1002/cpe.1783. 2, 3 [dsbvestt18] do santo brito c. d., vieira e silva a. l. b., teixeira j. m., teichrieb v.: rai tracer base render solut larg scale fluid rendering. comput & graphic 77 (2018), 6579. doi:10.1016/j.cag.2018.09.019. 2 [ede99] edelsbrunn h.: deform smooth surfac design. dis- crete & comput geometri 21, 1 (1999), 87115. doi:10.1007/ pl00009412. 12 [faw10] fraedrich r., auer s., westermann r.: effici high- qualiti volum render sph data. ieee transact visual graphic 16, 6 (2010), 15331540. doi:10.1109/ tvcg.2010.148. 2 [fw08] falk m., weiskopf d.: output-sensit 3d line integr convolution. ieee transact visual graphic 14, 4 (2008), 820834. doi:10.1109/tvcg.2008.25. 3 [har93] hart j. c.: rai trace implicit surfaces. siggraph 1993 cours notes: design, visual anim implicit surfaces, 1993. 4 [har96] hart j. c.: sphere tracing: geometr method an- tialias rai trace implicit surfaces. visual 12, 10 (1996), 527545. doi:10.1007/s003710050084. 4 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd. s. bruckner / dynam visibility-driven molecular surfac [hds96] humphrei w., dalk a., schulten k.: vmd: visual molecular dynamics. journal molecular graphic 14, 1 (1996), 33 38. doi:10.1016/0263-7855(96)00018-5. 9 [hgo15] hospit a., goi j. r., orozco m., , gelp j. l.: molecular dynam simulations: advanc applications. advanc applic bioinformat chemistri 8 (2015), 3747. doi:10.2147/aabc.s70333. 1 [hkg17] hermosilla p., krone m., guallar v., vzquez p.- p., vinacua ., ropinski t.: interact gpu-bas gener solvent-exclud surfaces. visual 33, 6 (2017), 869881. doi:10.1007/s00371-017-1397-2. 2 [hok16] hochstett h., orthmann j., kolb a.: adapt sam- pling on-the-fli rai cast particle-bas fluids. proc. high- perform graphic (2016), pp. 129138. doi:10.2312/hpg. 20161199. 2 [jpsk16] jurck a., parulek j., sochor j., kozlkov b.: ac- celer visual transpar molecular surfac molecu- lar dynamics. proc. ieee pacificvi (2016), pp. 112119. doi: 10.1109/pacificvis.2016.7465258. 4 [kbe09] krone m., bidmon k., ertl t.: interact visual molecular surfac dynamics. ieee transact visual graphic 15, 6 (2009), 13911398. doi:10.1109/tvcg. 2009.157. 2, 12 [kge11] krone m., grottel s., ertl t.: parallel contour-buildup algorithm molecular surface. proc. ieee biovi (2011), pp. 17 22. doi:10.1109/biovis.2011.6094043. 2 [kkf17] kozlkov b., krone m., falk m., lindow n., baaden m., baum d., viola i., parulek j., hege h.: visual biomolecular structures: state art revisited. graphic forum 36, 8 (2017), 178204. doi:10.1111/cgf.13072. 2, 3 [kkp13] kauker d., krone m., panagiotidi a., reina g., ertl t.: render molecular surfac order-independ transparency. proc. eurograph symposium parallel graphic visual (2013), pp. 3340. doi:10.2312/egpgv/egpgv13/033-040. 4 [kses12] krone m., stone j., ertl t., schulten k.: fast vi- sualiz gaussian densiti surfac molecular dynam particl trajectories. proc. eurovi short paper (2012), pp. 67 71. doi:10.2312/pe/eurovisshort/eurovisshort2012/ 067-071. 2, 9 [ksn08] kanamori y., szego z., nishita t.: gpu-bas fast rai cast larg number metaballs. graphic forum 27, 2 (2008), 351360. doi:10.1111/j.1467-8659.2008.01132.x. 2 [kwn14] knoll a., wald i., navratil p., bowen a., reda k., papka m. e., gaither k.: rbf volum rai cast multicor manycor cpus. graphic forum 33, 3 (2014), 7180. doi:10.1111/cgf.12363. 2 [lbph10] lindow n., baum d., prohaska s., hege h.: acceler- at visual dynam molecular surfaces. graphic forum 29, 3 (2010), 943952. doi:10.1111/j.1467-8659.2009. 01693.x. 2 [lc87] lorensen w. e., cline h. e.: march cubes: high reso- lution 3d surfac construct algorithm. acm siggraph grapic 21, 4 (1987), 163169. doi:10.1145/37402.37422. 2, 10 [lcl15] liu t., chen m., lu b.: parameter molecular gaussian surfac comparison studi surfac mesh generation. journal molecular model 21, 5 (2015), 113. doi:10.1007/ s00894-015-2654-9. 3, 11 [mge07] mller c., grottel s., ertl t.: image-spac gpu meta- ball time-depend particl data sets. proc. vmv (2007), pp. 31 40. 2 [mml12] mcguir m., mara m., luebk d.: scalabl ambient obscurance. proc. high-perform graphic (2012), 97103. doi: 10.2312/eggh/hpg12/097-103. 8 [pb13] parulek j., brambilla a.: fast blend scheme molec- ular surfac representation. ieee transact visual graphic 19, 12 (2013), 26532662. doi:10.1109/tvcg. 2013.158. 2 [pjr14] parulek j., jnsson d., ropinski t., bruckner s., yn- nerman a., viola i.: continu levels-of-detail visual abstract seamless molecular visualization. graphic forum 33, 6 (2014), 276287. doi:10.1111/cgf.12349. 11 [pv12] parulek j., viola i.: implicit represent molecular surfaces. proc. ieee pacificvi (2012), pp. 217224. doi:10.1109/ pacificvis.2012.6183594. 2 [ric77] richard f. m.: areas, volumes, packing, protein structure. annual review biophys bioengin 6, 1 (1977), 151176. doi:10.1146/annurev.bb.06.060177.001055. 2 [bs17] oltszov v., birkeland ., stoppel s., viola i., bruckner s.: output-sensit filter stream volum data. graphic forum 36, 1 (2017), 249262. doi:10.1111/ cgf.12799. 3 [sos96] sanner m. f., olson a. j., spehner j.: reduc surface: effici wai comput molecular surfaces. biopolym 38, 3 (1996), 305320. doi:10.1002/(sici)1097-0282(199603) 38:3<305::aid-bip4>3.0.co;2-y. 2 [swbg06] sigg c., weyrich t., botsch m., gross m.: gpu-bas ray-cast quadrat surfaces. proc. point-bas graphic (2006), pp. 5965. doi:10.2312/spbg/spbg06/059-065. 4 [ta96] totrov m., abagyan r.: contour-buildup algorithm calcul analyt molecular surface. journal structur biologi 116, 1 (1996), 138143. doi:10.1006/jsbi.1996.0022. 2 [vbww97] varshnei a., brook jr. f., william j., wright w.: linearli scalabl comput smooth molecular surfaces. ieee graphic applic 14, 5 (1997), 1925. 2 [wt90] wyvil g., trotman a.: ray-trac soft objects. proc. graphic intern (1990), pp. 469476. 5 [zd18] zirr t., dachsbach c.: memory-effici on-the-fli vox- eliz render particl data. ieee transact vi- sualiz graphic 24, 2 (2018), 11551166. doi: 10.1109/tvcg.2017.2656897. 2 2019 author(s) graphic forum 2019 eurograph associ john wilei & son ltd.