acs_ci_ci-2011-00217w 1..17 published: juli 16, 2011 r 2011 american chemic societi 2007 dx.doi.org/10.1021/ci200217w | j. chem. inf. model. 2011, 51, 20072023 articl pubs.acs.org/jcim travi - free analyz visual mont carlo andmolecular dynam trajectori martin brehm barbara kirchner*, wilhelm-ostwald-institut fur physikalisch und theoretisch chemie, universitat leipzig, linnestrass 2, d-04103 leipzig, germani bs support inform introduct exponenti increas avail re- sources, increas dedic molecular dynam (md) mont carlo (mc) simul decades, rais indispens standard method nowadai comput chemistry. complex realist chemic system simulated, insight gain properti access experiment.18 direct result mc md simul trajectory, contain posit rb(t) veloc vb(t) simul particl discret time step t. n particl simulated, trajectori regard path 6n-dimension phase space system. high-dimension nature, path suitabl direct evalu interpretation. algorithm reduct dimension applied, convert input data two- three-dimension data sets, interpret visual easier. dimens reduct algorithm known long time wide used, e.g. mention radial pair distribut function (rdfs),911 provid insight structur mc md article. innumer program avail calcul functions. typically, certain analysi program contain desir algorithms, differ program differ require- ment input data format. circumstanti file format convers necessari - cours program contain desir analysi found. lack program perform analyses, scientist write small script particular system. aim develop travi creat unifi program packag contain common kind analys appli trajectori - addition new on appear literatur (e.g., power combin distribut functions, below). avail kind program packag greatli ration simplifi process evalu trajectories. analys perform travi appear literature.1214 good wai introduc trajectori analys appli sampl trajectori results. articl focus program features. go interpret result relat simul system. interpret elsewhere.12,14 aim serv example. scope work extens discuss possibl applic analyses. sampl chosen result ab initio molecular dynam simulation1,8 room temperatur ionic liquid 1-ethyl-3-methylimidazolium thiocyan (refer [c2c1im] +[scn]) liquid state (at 350 k), like investig before.12,14 cubic simul cell contain 32 ion pairs, cell vector chosen 2027.7 pm, period boundari conditions15 applied. simul perform cp2k program package,16 quickstep method17 orbit transformation18 faster convergence. b-lyp functional19,20 densiti function theori (dft)21,22 grimm dispers correction23 dzvp-molopt gauss- ian basi sets24 gth pseudopotentials25,26 atom used. simul perform nvt ensemble, received: 16, 2011 abstract:w present travi (trajectori analyz visualizer), free program packag analyz visualiz- ing mont carlo molecular dynam trajectories. aim travi collect analys possibl program, creat power tool make unnecessari us differ program evalu simulations. greatli ration simplifi workflow analyz trajectories. travi written c++, open-sourc freewar licens term gnu gener public licens (gplv3). easi instal (platform independent, extern libraries) easi use. article, present algorithm implement travi - wide known long time, appear literatur time. shown analys requir standard md trajectori input data. 2008 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl appli anose-hoov chain thermostat2729 temperatur coupling. approxim 55 ps physic time simulated, time step 0.5 fs. atom label articl shown left figur 1. number scheme obtain topolog algorithm implement travi (which ex- plain below). right figur 1, snapshot simul box render qutemol30 illustrated. articl divid sections. introduction, gener featur travi presented. follow part, structur analys perform discussed. section 4 introduc dynam analys implement travis. follow that, technic detail implement list extern program creat figur given. section conclud articl give short outlook. gener featur support trajectori formats. currently, travi abl read trajectori xyz, pdb, andmol2 file format. format text file simpl structure. primari file format travi reli xyz, coordin input output perform format. trajectori store differ format analyzed, power tool avail convert geometri format xyz (e.g., vmd31). travi read atom coordin trajectori file, disregard topolog inform (see section molecul recognit below). step trajectori need success time (and properti like time exist, like mc trajectories). requir travi put trajectori total number atom type atom stai constant simulation. mc md simul perform period boundari condit (pbcs).15 exist complex sophis- ticat scheme appli pbcs.32 travi support period boundari conditions, current orthorhomb simula- tion cell (i.e., cell vector orthogon other) used. simul cell period certain direct supported. support chang cell vector simul (like, e.g., obtain simulat- ing npt ensembl barostat), case, static analys performed. bond break format simul support travis. however, normal point major importance, happen ab initio mc md simulations1,8 appli reactiv forc field classic simulations.33,34 analys reli fix molecular structure, nonstat bond render useless degree. small subset analys remain us case. molecul recognit atom labeling. md mc simul contain molecules, com- pose atoms. input file travi typic read contain atom posit lack connect atoms. travi perform amolecul recognit creat connect information. bond recogn time step (or specifi step) accord distanc criterion, base coval radii atoms, scale factor slightli 1 account bond vibrations. point requir attent fact mc md simul us period boundari condit molecul rip apart atom-wis wrap simul box. travi recogn molecul distort describ wai reconstruct them. import label atom molecules. desir wai travi name atom accord iupac nomenclature. iupac contain innumer rule except kind chemic systems, complet scope project implement iupac compliant name scheme travis. instead this, travi us topolog atom order label atoms, like describ shellei et al.35,36 atom get prioriti (a so-cal atom code) assign iter algorithm. algorithm converged, guaran- teed nonequival atom possess differ atom codes, equival atom atom code. help try identifi equival atom complic molecules. atom central molecul higher atom codes. atom element sort atom code descend order given label order (e.g., c1 central c6, figur 1). algorithm ensur equival molecul label way, nomatt order atom specifi input trajectory. furthermore, enabl travi process trajec- tori file atom order nonuniform mix up. simul contain molecules, travi recogn molecul kind put groups. molecul sum formula differ connect (i.e., structur isomers) distinguished, comparison algorithm pure topolog reli atom code connect information. wrap unwrapping. mentioned, mc md simul us period boundari conditions.15 analys requir molecul wrap box (like e.g. rdf sdfs), analys (like mean squar displacement) explicitli requir trajectori nonwrapped. furthermore, trajectori input file wrap not. accord this, travi need wrap/unwrap trajectori requir analysi specified. wrap molecul simul box rel easi procedure. choic wrap molecul atom- wise, possibl break part (use comput rdf atoms), wrap molecule-wise, figur 1. analyz system: (a) atom label molecul accord topolog algorithm (left) (b) snapshot simul box (right). 2009 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl keep molecul intact (use analyses). box center wrap defined, necessarili need refer particl analysis. choic box center offer addit flexibility, requir task (e.g., analyz trajectori big ion pair solvent). principl possibl unwrap trajectori wrap box before, inform lost (the wrap trajectori kind quotient space, uniqu map origin space). however, possibl inform unwrap trajec- tory, assumpt simul made. guarante particl half box length time step (i.e., time step suffici small), particl jump half box length time step wrapped. wrap undone. travi us empir algorithm unwrap wrap trajectori requir analysis. virtual atoms. perform analys present here, point simul system chosen. normally, point chosen atom system. travis, possibl defin point posit atom located. auxiliari point call virtual atoms. virtual atom like normal atom kind analyses. possibl write trajectori contain virtual atom addit real atoms. virtual atom defin ways. wai specifi set atom weight factor atom. virtual atom defin weight averag atoms. apart enter weight factor hand, possibl us center mass center geometri specifi atoms. wai defin virtual atom choos atom a, b, c molecule. virtual atom x defin specifi distanc x-a, angl x-a-b, dihedr angl x-a-b-c. make possible, e.g., locat virtual atom [c2c1im] + ring plane calcul function like rdf atoms. dipol vector dipol moments. input trajectori contain electron structur inform (e.g., maxim loca- lize wannier centers37,38 ab initiomd1,8), fix partial charg atom given, travi evalu dipol moment molecules, group molecules, system. subsystem dipol moment calcul total charg differ zero, uniqu definit dipol moment. case, valu dipol moment depend choic refer point. usually, center geometri subsystem taken refer point, travi allow choos point. obtain dipol calcul ir spectra, like explain below, obtain histogram dipol moment (see section dipol distribut function). possibl visual depend dipol moment quantiti like distanc angles. apart that, dipol vector analys defin vector (like e.g. angular distribut function vector reorient dynamics). higher order multipol current support travis. equit binning. creat histogram classic binning, piec data assign exactli bin, valu bin increased. valu piec data close border bins, bifurc exists: infinitesim chang input valu caus origin bin left unchang bin increas instead - macroscop effect rel infini- tesim change. introduc unnecessari nois histogram. travi us method equit bin creat histograms. knowledge, method publish relat trajectori analysis. piec data insert histogram share equit wai adjac bins. adjac bin on closer half bin width exact posit piec data. visual descript method, figur 2. equit bin extend higher-dimension histograms. used, e.g., comput combin distribut function (2d binning) spatial distribut function (3d binning) travis. algorithm regard smooth procedure, smooth algorithm appli histogram analysis. contrast that, equit bin directli work raw input data, addit inform left classic binning. does, e.g., lead line broadening, like expect appli smooth methods. analys travi us histogram stage, us equit bin increas visual qualiti plot created. smooth optim algorithms. apart equit binningmethod, smooth procedur appli output data (see, e.g., figur 7). question smooth improv plot appear highli subject depend system; therefore, user choos strength smooth appli leav smooth all. correl larg data set time-consum step, travi perform correl fast fourier transform accord thewiener-khinchin theorem.3941 greatli reduc requir time autocorrel involv select analysis. calcul spectra, defin fourier transform autocorrel functions42 (see below), travi allow user util sophist method obtain neat results. exampl zero padding, increas spectral resolut ad block zero end input data, applianc window function,43,44 e.g. blackman-harri type (cosin series) han type (cos2), greatli improv singal-nois ratio suppress spuriou fourier spectrum input data envelop curve. figur 2. comparison bin methods: (a) standard bin (left) (b) equit bin (right). 2010 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl structur analys term structur analys articl refer analys explicitli requir time axis. algorithm present section appli list coordin frames, includ mc md trajectory. note differ mean term like two-dimension common us talk functions. article, dimension function refer sum dimension preimag imag function. simpl words, function map one-dimension space one-dimension space, like e.g. f(x) = y, call two- dimension function here, plot two-dimensional. two-dimension distribut functions. function shown subsect histogram develop scalar quantiti (like distanc angle) measur simulation. accord definit state above, two-dimension functions. radial distribut functions. wide wai analyz trajectori obtain inform structur calcul radial pair distribut function (rdfs),9,10 refer pair correl functions. make avail averag distanc inform particl system, rdf simple, flexibl tool univers applied. point contribut impor- tanc rdf fact comput simul calcul result neutron x-rai diffract experiments45 kind samples. enabl valid perform simul compar calcul rdf on obtain experiments. rdf involv differ particl time, us term refer particl observ particl following. rdf give probabl find observ particl certain distanc refer particl - rel uniform densiti observ particle. uniform densiti densiti observ particl uniformli distribut simul cell. rdf valu larger 1 depict find observ particl distanc refer particl probabl average. larg distances, valu function tend 1. definit rdf given eq 1, ri rj denot posit vector i-th j-th particle, take valu 1 interv [-w,w) (with w bin width), 0. rdf calcul travi published1214 gabr v na 3nb na 1 nb j 1 r j rbit rbjtjt 1 rdf calcul analyz model shown figur 3. note rdf refer particl observ particl chosen differ molecul - inform gain plot intermolecular nature. possibl choos refer particl observ particl molecul obtain intramolecular information, e.g. histogram bond length developments. figur 4 show tempor develop h1-n distanc select [c2c1im] + 32 [scn] ions. raw data rdf repres black solid line figur 3 - repres distanc histogram data. right figur 4 convei distanc develop form rdf. [scn] ions, distanc develop shown color, remain 31 curv drawn shade grai avoid confusion. rdf calcul distanc inform 32 [c2c1im] + 32 [scn] ion - 32 distanc develop shown here. exampl cation, observ differ anion close coordin simul (black, green, pink, red curve). plot kind us analyz exchang behavior coordin molecules. is, e.g., us investig anion-c coordin solvat behavior molecul metal complex (which perform travi publish soon). angular distribut functions. like rdf histogram distanc development, angular distribut function (adfs) histogram develop certain angl system, eq 2. term contain sin (r) correct uniform angular distribut (also refer cone correction46) omit travi desired. addit angular distribut function itself, combin tempor develop- ment/distribut plot (like shown figur 4 distance) created. adfabcr 1 sinr 3 1 na 3nb 3nc na 1 nb j 1 nc k j 1 r rbit, rbjt, rbktt 2 angl defin specifi vectors. vector specifi points. base point defin vector different, offer addit flex- ibility. point defin vector necessarili molecule. apart posit vectors, possibl us veloc acceler vector atom molecules, dipol vector molecul (see section dipol vector dipol moments), combin vectors. enabl power analys like, e.g., evalu angl bond molecular dipol vector. dihedr distribut functions. similar rdf adfs, dihedr distribut function (ddf) histogram dihedr angles. possibl wai defin dihedr angl travis. standard definition, like figur 3. rdf [c2c1im] + ring h atom [scn] s, n atoms. 2011 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl literatur andmani programs, specifi point (e.g., atoms) form dihedr angle. additionaly, gener flexibl method implement travis. dihedr angl specifi vector ab, bb, cb, correspond point instead four. ab bb project normal plane cb, angl project vector gener dihedr angle, left figur 5 eq 3. standard definit ident gener definit base point vector ab base point cb tip cb base point bb ab, bb, cb arcco ab cb 3 bb cb jab cbj 3 jbb cbj ! 3 explain discuss adfs, posit vector velocity, force, dipol vector defin dihedr angles. right figur 5, exampl tempor dihedr develop correspond histogram shown. dihedr specifi gener (three vectors) definition. vector ab select normal vector [c2c1im] + ring plane. vector bb chosen c2 c6! vector cb n1 c2 ! . tempor develop shown select [c2c1im] + cations. histogram right includ cations. plot like shown right figur 5 us investig flexibl group (e.g., alkyl chains). dipol moment distribut functions. dipol moment simul avail (see section dipol vector dipol moments), travi comput dipol moment distribut function (dipdf). possibl visual tempor develop dipol moment similar figur 4. spatial distribut functions. like rdf prob- abil find particl certain distanc particle, spatial distribut function (sdfs)47 depict prob- abil find particl certain posit space fix refer particles. sdf kind three-dimension enhanc rdfs. refer mole- cule selected. set refer frame, atom (which locat line) figur 4. tempor develop distanc select [c2c1im] + h1 [scn] n atom (left) correspond rdf (right). figur 5. gener dihedr angl defin vector ab, bb, cb (left) tempor develop dihedr angl select cation correspond ddf cation (right). 2012 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl molecul chosen: place origin, second atom locat posit x axis, atom x-y plane (with posit y value) refer frame. instanc refer molecul time step transform uniqu orientation, enabl averag probabl space refer molecule. possibl set refer frame 3 points, refer atom place center frame, enabl direct control sdf center. explain introduction, probabl three- dimension space four-dimension function, obvious hard visual is. necessari reduc dimension (or lower). common reason- abl method visual iso-surfac data, easili drawn three-dimension space. iso- surfac surfac pass area probability, like countour line topograph map (but dimens less). valu iso-surfac typic given unit particl densiti (nm-3 pm-3), specifi particl densiti iso-surface. sdf comput travi appear literature.1214 figur 6, intramolecular sdf [c2c1im] + cation shown. mean [c2c1im] + time refer molecule, atom refer molecul observed. rotat methyl ethyl chain shown, result toroid shapes. note rotat definit mislead term here, pictur predic group actual rotating, dynam inform included. consid fig- ur 6, possibl ethyl group [c2c1im] + stai place time, differ posit [c2c1im] +. analyz trajectori ofmedium size (e.g., 32molecul 55 ps, like perform work), sampl data usual poor direct sdf creation. result sdf look like shown figur 7 left. appear sdf improv smooth underli data. travi contain smooth algorithm sdfs, level smooth appli select (includ choic smooth all). example, sdf smoothen differ level shown middl right figur 7. sdf shown intermolecular - [c2c1im] + cation time fix distribut [scn] ion (in case [scn] center mass) cation observed. problem iso-surfac occlud import part bulkiness. good wai encount problem introduc clip plane system, shown figur 8 left (thi featur travi vmd31). again, purpl color depict particl densiti [scn] anion [c2c1im] + refer molecule. clip plane, purpl color spheric bodi visible, refus insight interior. left figur 8, seen area close [c2c1im] + cation [scn] anion - repuls forc close figur 6. intramolecular sdf [c2c1im] + atom (red: carbon; green: h2, h3; yellow: hydrogen atoms). figur 7. spatial distribut function [scn] center mass [c2c1im] + (left) differ smooth level spatial data (middl right). figur 8. sdf [scn] [c2c1im] + clip plane (left) invert sdf show exclud volum [c2c1im] + (right). 2013 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl atoms. travi invert sdf inner region, particl enters, figur 8 right. shown volum understood exclud volum [c2c1im] + cation, numer integr molecular volum molecular surfac area md mc simulation. neighborhood analysis. interest, distanc refer particl neighbor particl kind found. travi perform neighborhood analysi given refer particl given observ particle. similar creat rdf (like shown figur 3), fact refer particl time step closest observ particl taken account. result distribut show minim maxim distanc neighbor distanc neighbor time. analysi perform distant neighbors. neighborhood analysi shown figur 9. refer particl h1 atom [c2c1im] +; observ particl n atom [scn]. black curv corre- spond neighbor, explain above. red curv creat principl contain second neighbor configuration. green curv show neighbor on. vertic line lower plot depict theminim andmaxim valu kind neighbor (technically, strong magnif plot y direction). neighbor [scn] anion (black curve) rang 200 300 pm time, expected. case approach h1 close 150 pm. interest fact cases, neighbor [scn] nitrogen atom far 550 pm away. mean configur [scn] nitrogen atom 500 pm sphere h1. configur probabl 78.3 ppm trajectory. hand, fifth neighbor [scn] nitrogen atom (orang curve) nearer 500 pm h1, mean exist configur differ [scn] nitrogen atom 500 pm sphere h1 time. configur observ probabl 4.32 ppm. travi abl write snapshot rare events. example, figur 10 select configur [scn] nitrogen atom 500 pm sphere h1 present left (with distanc nitrogen atom labeled). right side, configur differ [scn] nitrogen atom 500 pm sphere shown. feature, hard filter rare situat hand. combin distribut functions. section, present kind analys (rdf, adf, ddf, dipdf) histogram scalar data (there analysi fit scheme, veloc distribut function, dynam analysis, scope section). travis, possibl combin function order creat histogram higher dimensionality, call combin distribut function (cdfs). differ analysi deliv scalar raw data cdf call channel cdf. channel chosen two-dimension analyses, analys defin varieti ways, possibl cdf appear literatur before. mention unusu example, possibl plot angl themolecular dipol vector center mass veloc vector total veloc molecule. high-dimen- sional histogram hard handl visualize, discuss two-channel cdf here, result two-dimension histograms. order demonstr us cdfs, consid exampl following. start combin- ing rdf h1 atom [c2c1im] + n atom [scn] adf h1-c2 vector [c2c1im] + intermolecular h1-n vector [c2c1im] + [scn]. underli distanc rdf visual figur 11 right r angl adf label r. perform e.g. order observ possibl hydrogen bonding, hydrogen bond involv atom defin distanc angle.48,49 time step input trajectori pair [c2c1im] + [scn] (all combinations), rdf adf creat scalar value. normally, rdf valu linear rdf histogram adf valu linear adf histogram. case, regard valu 2-tuple, connect relat other, stem configuration. obtain 2-tupl two-dimension histogram (which regard matrix). figur 9. distanc distribut 5 neighbor [scn] n atom [c2c1im] + h1. figur 10. (a) rare conform [scn]n atom 500 pm sphere h1 (left) (b) rare conform 5 [scn]natom 500 pm sphere aroundh1 (right). distanc pm. 2014 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl result histogram time step anion cation pair shown figur 11 left. distanc angl independ other, result plot contain inform rdf adf (the result plot product distribut functions). valu depend other, cdf contain inform rdf adf together. angl r > 90 prefer h1-n distanc 200 pm, correspond configur [scn] nitrogen atom close [c2c1im] + h1 atom. configuration, typic hydrogen bond h1 n formed. angl r = 180 indic linear hydrogen bond. small angl r < 45, peak fairli high distanc r = 600 pm. peak correspond configur [scn] anion coordin [c2c1im] + ring hydrogen atom h3 h4. right axi figur 11, two- dimension functions, act data sourc cdf, plotted. frequently, function similar kind appear literature.47,50 dash line drawn plot figur 11 depict differ criteria chosen defin hydrogen bond [c2c1im] + [scn]. standard ap- proach defin hydrogen bond criterion minimum rdf distanc cutoff (0 e r e 450 pm) angl interv e.g. 130 e r e 180. depict dash yellow line. accord visual impress figur 11, suboptim criterion here, crop part peak take account contribut larg distanc instead. better choic criterion 0 e r e 300 pm 90 e r e 180, visual dash pink line. cdf power tool defin criteria, offer inform rdf. possibl choic criteria (0e 300 pm/130 e r e 180, dash black line, 0 e r e 300 pm/ 150 e r e 180, dash blue line) shown. dynam accord criteria analyz section concern dimer exist autocorrel functions. shown diverse. present rdf ddf, tempor develop- ment distanc dihedr angle, raw data histograms, shown. raw data form explain cdf shown similar way, figur 12. ax plot correspond distanc angl - valu input data cdf. time proceeds, chang valu draw curv plot. curv correspond pair [c2c1im] + [scn]. 32 ion pair simulated, 32 3 32 = 1024 curves. avoid confusion, shown figur 11, shown time interv short (around 0.5 ps). travi creat output movi well. movi support information. state before, kind two-dimension analys combin three-dimension cdfs. figur 13, present example, rdf combined. figur 11. combin radial/angular distribut function; possibl h bond criteria shown dash lines. figur 12. tempor develop distang angl [c2c1im] + select [scn] (red, green, blue). raw data cdf shown figur 11. 2015 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl rdf observ distanc h1 atom [c2c1im] + n atom [scn], second rdf observ distanc h1 s atom [scn] ion, illustr figur 13 right. [scn] mainli coordin n atom, indic peak h1-n = 250 pm/h1- = 450 pm. configur n s atom similar distanc 300 pm h1 frequent found. however, case s atom coordin toh1 rel rare, peak h1-n= 450 pm/h1- = 250 pm weak. asymmetri plot indic differ coordin behavior n s atom [scn]. follow analysis, present figur 14, show cdf constitut rdfs. major differ preced case rdf observ differ [scn] ions. rdf defin h1-n distance. 2-tupl describ creat possibl pair [c2c1im] + [scn] possibl tripl [c2c1im] +, [scn]1, [scn]2. exclud case [scn]1 equal [scn]2, result strong diagon contribut plot. main peak figur 14 600 pm/200 200 pm/600 pm depict configur [scn] n atom tightli coordin h1 [scn] n atom coordin rear [c2c1im] + (h4 h5). case [scn]n atom coordin h1 time (200 pm/200 pm) case [scn] n atom coordin h1 rear (600 pm/600 pm) infrequently. figur 13. combin radial/radi distribut function [c2c1im] + [scn]. figur 14. combin radial/radi distribut function [c2c1im] + differ [scn]. 2016 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl multi-interv analysis.al analys travi (not on present point) perform multi- interv manner. mean input trajectori auto- matic separ parts. analys performed, result written separ part. enabl properti chang trajectory, e.g. equilibr begin not. exampl multi-interv analysis, h1-n rdf, present figur 3 solid black line, shown figur 15. 12.5 ps trajectori automat dissect 5 nonoverlap interv length. take averag 5 curv overal rdf 12.5 ps. seen black, red, green curv (depict 3 intervals) differ 2 curv plot. remain 2 curv good accord other. behavior usual mean equilibr begin on, picosecond left analyzing. dynam analys contrast structur analys present above, dyna- mical analys account simul time there- fore appli time-depend trajectories. tempor develop overlai plots. wai direct visual tempor motion singl molecul tempor develop overlai (tdo) plot. creat plot kind, molecul trajectori point time chosen. desired, defin count neighbor molecul taken account. travi creat file contain molecular conform defin point time. file small script execut pymol51 automat load coordinates. bleach atom color visual consecut geometries, initi structur shownwith color saturation. travi give choic defin cluster center (to remov translation) cluster rotat uniform orient (to remov rotat movement). tdo plot creat travi published.13 figur 16 show exampl tdo plot. tempor motion select [c2c1im] + ion, nearest [scn] neighbor around, shown. snapshot taken 0.25 ps; therefore, total plot 5 snapshot compris time span 1 ps. ring center fix origin, result translat movement [c2c1im] + visible. rotat [c2c1im] + remov occur short time scale. however, strong rotat methyl group clearli visible. veloc distribut functions. analyz dy- namic properti trajectory, obviou choic analysi veloc distribution, veloc central properti dynamics. travi creat veloc distribut function (vdfs) defin center. atom group atom point space atom located, e.g. center mass center geometry. example, figur 17 illustr veloc distribut function select atom vdf center mass (com) ion [c2c1im] + ring center. like expected, veloc show distribut qualit similar maxwell-boltzmann distribut kinet ga figur 15. rdf [c2c1im] + h1 [scn]1 n, comput differ interv trajectory. figur 16. tdo plot [c2c1im] + ion [scn] around. figur 17. vdf differ atom center mass (com) [c2c1im] + [scn]. 2017 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl theory. lighter atom possess higher veloc average, heavier atom molecul (defin center mass) slower. interest option add veloc inform sdf like shown figur 7. result shown figur 18. surfac defin wai classic sdf: isosurfac particl densiti [scn] fix [c2c1im] +molecule. addit inform given color surface. color repres averag veloc [scn] point space, rel fix [c2c1im] +. blue repres slow motion, red depict high averag velocities. dimer exist autocorrel functions. order judg lifetim aggreg speci (call dimer here) defin ormor criteria, dimer exist autocorrel function (dacf) comput travis. thedacf given pair particl i,j defin autocorrel simpl function ij, valu 1 long criteria fulfilled, switch 0 soon criteria fail time (see eq 4). stai 0, matter criteria fulfil later not. total dacf averag differ pair i,j. accord definition, dacf start valu 1 fall 0 increas . statement contain result function dacf() follows: larg probabl criteria fulfil (without interruption) given time , fulfil time 0?. dacf calcul travi published13 dacf n 3 t t 0 ijt 3 ijti, j 4 travi support wai defin dimers. wai specifi criterion base angular distanc intervals. angl distanc defin molecules, interv given criterion fulfilled. differ angl distanc criteria combin logic oper or, allow complex combinations. wai defin dimer criterion defin distanc molecul account nearest neighbor accord distanc definition. make possibl molecul form dimer neighbor (or n neighbors) time. dimer defin wai break neighborhood relat change, i.e. neighbor longer neighbor. distanc determin neighborhood base atom molecules. case, atom twomolecul closest calcul distanc time, correspond smallest distanc molecules. pair particl pair fulfil condit singl time interval, result curv straight line, start valu 1 = 0 fall 0, give shape triangl (which exactli correspond statement quotat mark given above). behavior visual figur 19 left. contrast dacf, dimer lifetim distribut function (dldf), shown right, exhibit peak dimer posit total lifetime. complex systems, dimer pairs, fulfil condit differ time intervals. result dacf curv compos sum triangles, singl event. case poor sampling, figur 18. spatial distribut function [scn] center mass (com) [c2c1im] +; color repres averag [scn] com veloc (blue = slow, red = fast). figur 19. dimer specif lifetime: (a) correspond dacf (left) (b) correspond dldf (right). figur 20. dacf 4 criteria shown figur 11 (solid line = continuous; dash line = intermittend 1 ps). 2018 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl lead visibl edg curves, like, e.g., show dot line figur 20 1 ps. descript given correspond normaldacfs, denot continu dacfs. contrast this, intermittend dacf creat travis. defini- tion intermittend function same, differ interrupt criteria fulfil allow specifi duration. words, dissoci recombin aggreg allowed, long durat process exce given time criterion. figur 20, dacf [c2c1im] + [scn] correspond differ criteria, shown figur 11 describ there, shown. color curv correspond criteria. solid line depict continu dacfs, dash line repres intermittend dacf reform threshold 1 ps. dacf sensit regard chosen dimer definition. note that, spite base strongli differ criteria, red green curv behavior. case coincidence. dimer lifetime/displac functions. lifetim dimer distanc travel fulfil criteria interest, dimer lifetime/displac function (dldisp) great use. three-dimension plot axi repres lifetim dimer, explain dldf (see figur 19 right). axi depict distanc dimer (e.g., center mass contribut molecules) travel format cleavage. kind function publish before.52 example, dldisp function [c2c1im] + [scn] base 300 pm/130 criterion shown figur 21 (onli continu function, reform allow here). seen [c2c1im] + [scn] dimer travel 150 pm time interv 1 ps fulfil criterion. major dimer stai approxim 25 pm 0.05 ps, is, e.g., bond length typic chain reorient motion. vector reorient dynamics. vector ab trajectori (defined, e.g., points, veloc vector dipol vector), vector reorient dynam analys per- formed. result function autocorrel vector, defin normal sum dot product vector time t vector later time t + start time t. definit vector reorient dynam function given eq 5, t denot total simul time. kind function us compar md simul experiments,13 reorient correl time obtain nmr experiments53 vrd n 3 t t 0 abit 3 abit 5 function similar dacf describ above. start valu 1, tend 0 increas t, inform fast vector chang direction. vector reorient function shown figur 22. black curv depict reorient [c2c1im] + ring normal vector. blue curv correspond reorient [scn] s-n vector. red green curv inform reorient bond vector c2-c6 c6-h [c2c1im] +, indic move- ment chain faster [c2c1im] + ring. mean squar displacement. analyz dynam simul system, popular wide method calcul mean squar displac (msd) kind particles. two-dimension function defin squar averag distanc kind particl move awai start point time interv (averag particl kind start times), eq 6. function contain inform diffus observ particles. steeper rise higher values, faster observ particl diffus system. solid, msd satur finit value, liquid gaseous, msd grow linearli time. slope msd diffus coeffici d figur 21. dldisp function (continuous) 300 pm/130 criterion shown figur 11. figur 22. vector reorient dynam vector [c2c1im] + [scn]. 2019 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl observ particle,11 eq 7. travi allow calcul compon mean squar displac parallel perpendicular vector ab defin molecule, eq 8 eq 9. important, e.g., good estim diffus coeffici molecul md simulation.54 mean squar displac import quantity, valid simul mean measur values, e.g. pfg nmr experiments.55 figur 23 show msd particles. expected, light atom like hydrogen larg mean squar displacement, heavier atom molecul shorter distanc time. interest fact small valu , [scn] (green curve) faster [c2c1im] + (red curve), larger , [scn] move slower (see inlay) msd j rbit rbitj 2t, 6 d lim f 1 6 j rbit rbitj 2t, 7 msd )ab rbit rbit 3 abtjabtj 2 + t, * 8 msd^ ab rbit rbit rbit rbit 3 abtjabtj ! 3 abt jabtj 2 + t, * 9 van hove correl functions. van hove correl function (vhcfs) time-depend gener rdfs. addit time dimens introduc rdf. = 0, function ident normal rdf [c2c1im] + h1 [scn] n. case > 0, observ perform posit h1 time 0 posit n time , eq 10 ( explain eq 1). words, h1 allow diffus awai time interv , taken account - initi posit h1 used, h1 longer locat there. lead broaden rdf peak increas . larg valu , function take valu 1 distanc r. exampl vhcf [c2c1im] + h1 [scn] n shown figur 24. import point vhcf form intersect simul experiments, determin experimentally.56 result neutron scatter experiments57 three-dimension plot frequenc reciproc distanc axes. plot dual fourier transform vhcf vhcfab, r na 1 nb j 1 r j rbit rbjtjt 10 travis, possibl creat auto-vhcf certain particl itself. distanc initi posit particl time 0 new posit particl time observed. kind gener mean squar displacement, contain averag distanc time actual complet distanc distribu- tion. figur 25, vhcf [scn] center mass observ shown. note ax right plot swap strike similar msd (see figur 23). msd plot show squar displacement, auto-vhcf contain nonsquar displacement. obviously, possibl draw function kind = 0, function possess peak infinit height r = 0 definition. power spectra/infrar spectra. import trajectori analysi comput spectra differ kinds. spectra readili avail experi probabl best wai valid perform simulations. infrar (ir) spectra outstand dispers avail substance, intuit choic calcul ir spectra trajectories. ir spectrum observ chang dipol vector molecules, time-depend dipol inform requir calcul one.58 informa- tion suppli (e.g., form time-depend partial charg maxim local wannier centers37,38), travi comput ir spectra trajectory. informa- tion obtain classic md runs, calcul ir spectra usual impract (it is, however, possibl assign fix partial charg atom calcul ir spectra result dipol moments, spectra poor quality). gener kind spectrum comput kind time-depend trajectori power spectrum. power spectra defin fourier transform autocorrel function particl velocities.42 power spectra contain peak ir spectrum, - imagin sum ir spectrum, raman spectrum motion ir raman active. figur 26, power spectra [c2c1im] + [scn] shown. travi allow user util sophist method obtain neat spectra, section smooth optim algorithms. great advantag simul spectra possibl assign peak specif compound present sampl - is, course, possibl perform singl experiment. peak assign [c2c1im] + [scn] (like shown figur 26), figur 23. msd plot atom center mass (com) [c2c1im] + [scn]. 2020 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl peak assign specif motion molecules. figur 27 left, spectra c-h bond [c2c1im] + cation shown. plot right figur 27 contain spectra c-c c-n bond [c2c1im] +. spectra account bond-stretch modes. angular vibrat mode left here. technic detail sourc code compil requirements. travi written c++, strongli reli power concept object-ori programming. function encapsul 80 differ classes, collect similar code segment separ disjunct on other. program distribut open-sourc freeware, licens gnu gener public licens (version 3).59 sourc code precompil execut file user manual download travi proud requir extern library. demand build travi sourc code work c++ compiler. result fact, principl limit hardwar platform oper system travi run on. develop test perform figur 24. van hove correl function h1 observ n (left: 2d slices; right: 3d plot). figur 25. van hove correl function [scn] center mass observ (left = 2d slices; right = 3d plot - note swap axes). 2021 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl differ type microsoft window linux oper system c++ compil (e.g., g++, intel c++ compiler, microsoft visual c++, bloodsh dev-c++). requir extern programs. travi bear predic visual title, produc graphic file itself. produc close precursor graphic files. data visualized, precursor contain design inform transform public grade figur addit effort. step perform extern programs, integr trajectori analysi pipelin travis. program present subsection. note, addit output special input file visual programs, raw data written plain text format enabl process differ program purposes. render two-dimension plot (like shown figur 3 5,9,12,20,22 25, 27), travi write agr input file thegrac plot package,60 contain- ing design information, e.g., axi label frame style. spatial distribut (like on figur 6 8 18) creat vmd.31 store spatial densities, travi write file gopenmol plt andgaussian cube format, be, e.g., directli load vmd. high-qual render pictur perform pov-rai render package,61 emploi vmd. three-dimension distribut function like shown figur 11, 13, 14, 21, 24, 25 obtain wolfram mathematica.62 travi directli output math- ematica notebook files, open click, render second click directli public grade images. file written travi contain sophist framework plot 3d graphs, enabl adjust paramet power featur like zoom plot direct smooth data desired. tempor develop overlai plot shown fig- ur 16 render pymol.51 travi creat custom pymol startup script, automat load differ overlai geometri pymol set color atom nice render options. molecul draw figur 1, 10, 11, 13, 14 creat pymol, stem directli output travi program packag requir addit process imag manipul program. snapshot simul box figur 1 right render freewar program qutemol.30 conclus present travi program package, abl perform varieti analys trajectori obtain frommc andmd simulations; discuss article. analyses, like e.g. radial distribut functions, spatial distribut functions, mean squar displac (all discuss above), common regard ubiquit standard trajectori analys today. enhanc new featur offer addit flexibility, like three-vector definit dihedr angl (see figur 5 left). knowledge, analys appear literatur time. accounts, e.g., combin distribut function (cdfs), offer power tool investig structur simul system combin scalar quantiti like distances, angles, dipol moments. scalar quantiti chosen differ ways, manifold differ cdf aris combinations, appli system. cdf bear inform distribut function figur 26. power spectra (fourier transform veloc auto- correlation) [c2c1im] + [scn]. figur 27. power spectra differ c-h bond stretch motion [c2c1im] + (left) power spectra differ c-c c-n bond stretch motion [c2c1im] + (right). 2022 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl scalar base quantities. this, creation cdf possibl program packag unit scalar analys scope. apart varieti analyses, travi offer gener featur help analyz trajectori (see gener featur section). are, e.g., automat molecul recognition, topolog atom labeling, support period boundari condit chang cell vectors, definit new virtual atom posit space, calcul dipol vector dipol moments. equit bin method travi reduc nois enhanc visual qualiti creat one- multidimension histo- grams. knowledge, equit bin appli problem trajectori analysi visual before. travi open-sourc freeware. sourc code precompil execut user manual download de- velop travi ongo process. new featur implement time time. associ content bs support information. movi text. ma- terial avail free charg internet org. author inform correspond author *e-mail: acknowledg work support dfg, particular project spp 1191, ki-768/4-1, ki-768/4-2, ki-768/5-2, ki- 768/5-3. support dfg graduat school excel build molecul nano-object (build- mona), esf, irtg diffus porou materi gratefulli acknowledged. refer (1) huber, h.; dyson, a. j.; kirchner, b. calcul bulk properti liquid supercrit fluid pure theory. chem. soc. rev. 1999, 28, 121133. (2) maginn, e. j.; elliott, j. r. histor perspect current outlook molecular dynam chemic engin tool. ind. eng. chem. res. 2010, 49, 30593078. (3) maginn, e. j. molecular simul ionic liquids: current statu futur opportunities. j. phys.: condens. matter 2009, 37, 373101. (4) brussel, m.; zahn, s.; hey-hawkins, e.; kirchner, b. theoret investig solvent effect complex systems: calcul bioinorgan system ab initio molecular dynam simul static quantum chemistry. adv. inorg. chem. 2010, 62, 111142. (5) senn,h.m.; thiel, w.qm/mmmethod biolog systems. top. curr. chem. 2007, 268, 173290. (6) yockel, s.; schatz, g. c. dynam qm/mm: hybrid ap- proach simul gas-liquid interactions. top. curr. chem. 2011ahead print. (7) dell site, l.; holm, c.; van dervegt, n. f. a. multiscal approach perspect model aqueou electrolyt polyelectrolytes. top. curr. chem. 2011ahead print. (8) jaramillo-botero, a.; nielsen, r.; abrol, r.; su, j.; pascal, t.; mueller, j.; goddard, w. a., iii first-principles-bas multiscale, multiparadigmmolecularmechan dynamicsmethod describ- ing complex chemic processes. top. curr. chem. 2011ahead print. (9) mcquarrie, d. a. statist mechanics; harper row: new york, 1976. (10) hansen, j. p.; mcdonalds, i. r. theori simpl liquids, 2nd ed.; academ press: new york, 1986. (11) allen, m. p.; tildesley, d. j. simul liquids; oxford univers press: oxford, 1989. (12) thar, j.; brehm, m.; seitsonen, a. p.; kirchner, b. unexpect hydrogen bond dynam imidazolium-bas ionic liquids. j. phys. chem. b 2009, 113, 1512915132. (13) kohagen, m.; brehm, m.; thar, j.; zhao, w.; muller-plathe, f.; kirchner, b. perform quantum chemic deriv charg persist ion cage ionic liquids. molecular dynam simul studi 1-n-butyl-3-methylimidazolium bromide. j. phys. chem. b 2011, 115, 693702. (14) brussel, m.; brehm, m.; kirchner, b. ab initio molecular dynam simul binari ionic liquids. phys. chem. chem. phys. 2011, doi:10.1039/c1cp21550g (15) born,m.; vonkarman, t. uber schwingungen raumgittern. physik. z. 1912, 13, 297309. (16) cp2k. 2011. (access mar 21, 2011). (17) vandevondele, j.; krack, m.; mohamed, f.; parrinello, m.; chassaing, t.; hutter, j. quickstep: fast accur densiti function calcul mix gaussian plane wave approach. comput. phys. commun. 2005, 167, 103128. (18) vandevondele, j.; hutter, j. effici orbit transform method electron structur calculations. j. chem. phys. 2003, 118, 43654369. (19) becke, a. density-funct exchange-energi approxim correct asymptotic-behavior. phys. rev. 1988, 38, 30983100. (20) lee, c.; yang, w.; parr, r. develop colle-salvetti correlation-energi formula function electron-density. phys. rev. b 1988, 37, 785789. (21) hohenberg, p.; kohn, w. inhomogen electron gas. phys. rev. b 1964, 136, 864. (22) kohn, w.; sham, l. self-consist equat includ ex- chang correl effects. phys. rev. 1965, 140, 1133. (23) grimme, s. semiempir gga-typ densiti function con- struct long-rang dispers correction. j. comput. chem. 2006, 27, 17871799. (24) vandevondele, j.; hutter, j. gaussian basi set accur calcul molecular system ga condens phases. j. chem. phys. 2007, 127, 114105. (25) goedecker, s.; teter, m.; hutter, j. separ dual-spac gaussian pseudopotentials. phys. rev. b 1996, 54, 17031710. (26) hartwigsen, c.; goedecker, s.; hutter, j. relativist separ dual-spac gaussian pseudopotenti h rn. phys. rev. b 1998, 58, 36413662. (27) nose, s. unifi formul constant temperatur molecular dynam methods. j. chem. phys. 1984, 81, 511519. (28) nose, s. molecular dynam method simul canon ensemble. mol. phys. 1984, 52, 255268. (29) martyna, g.; klein, m.; tuckerman, m. nose-hoov chain - canon ensembl continu dynamics. j. chem. phys. 1992, 97, 26352643. (30) tarini, m.; cignoni, p.; montani, c. ambient occlus edg cue enhanc real time molecular visualization. ieee t. vis. comput. gr. 2006, 12, 12371244. (31) humphrey, w.; dalke, a.; schulten, k. vmd - visual molec- ular dynamics. j. mol. graphic 1996, 14, 3338. (32) frascoli, f.; todd, b. d.; searles, d. j. boundari condit independ molecular dynam simul planar elong flow. phys. rev. e 2007, 75, 066702. (33) van duin, a. c. t.; dasgupta, s.; lorant, f.; goddard, w. a., iii reaxff: reactiv forc field hydrocarbons. j. phys. chem. 2001, 105, 93969409. 2023 dx.doi.org/10.1021/ci200217w |j. chem. inf. model. 2011, 51, 20072023 journal chemic inform model articl (34) nielson, k. d.; van duin, a. c. t.; oxgaard, j.; deng, w.-q.; goddard,w. a., iii develop reaxff reactiv forc field describ transit metal catalyz reactions, applic initi stage catalyt format carbon nanotubes. j. phys. chem. 2005, 109, 493499. (35) shelley, c. a.; munk, m. e. percept topolo- gical symmetry. j. chem. inf. comput. sci. 1977, 17, 110113. (36) shelley, c. a. heurist approach displai chemic structures. j. chem. inf. comput. sci. 1983, 23, 6165. (37) wannier, g. h. structur electron excit level insul crystals. phys. rev. 1937, 52, 191197. (38) marzari, n.; vanderbilt, d. maxim local generalized- wannier function composit energi bands. phys. rev. b 1997, 56, 1284712865. (39) futrelle, r. p.; mcginty, d. j. calcul spectra correl function frommolecular dynam data fast fourier transform. chem. phys. lett. 1971, 12, 285287. (40) kestemont, e.; vancraen, j. comput correl function molecular dynam experiments. j. comput. phys. 1976, 22, 451458. (41) smith, w. introduct discret fourier transform. ccp5 quarterli 1982, 5, 3441. (42) press, w. h.; flannery, b. p.; teukolsky, s. a.; vetterling, w. t. numer recip fortran: art scientif computing, 2nd ed.; cambridg univers press: 1993; chapter power spectra estima- tion fft, pp 542-551. (43) harris, f. j. us window harmon analysi discret fourier transform. proc. ieee 1978, 66, 5183. (44) nuttall, a. window good sidelob behavior. ieee trans. acoust., speech, signal process. 1981, 29, 8491. (45) head-gordon, t.; hura, g. water structur scatter experi simulation. chem. rev. 2002, 102, 26512670. (46) kroon, j.; kanters, j. a. non-linear hydrogen bond molecular crystals. natur 1974, 248, 667669. (47) svishchev, i. m.; kusalik, p. g. structur liquid water - studi spatial-distribut functions. j. chem. phys. 1993, 99, 30493058. (48) wendler, k.; thar, j.; zahn, s.; kirchner, b. estim hydrogen bond energy. j. phys. chem. 2010, 114, 95299536. (49) lehmann, s. b. c.; roatsch, m.; schoppke, m.; kirchner, b. physic origin cation-anion intermedi bond ionic liquid i. place (weak) hydrogen bond charges. phys. chem. chem. phys. 2010, 12, 74737486. (50) kumar, r.; schmidt, j. r.; skinner, j. l. hydrogen bond definit dynam liquid water. j. chem. phys. 2007, 126, 204107. (51) pymol molecular graphic system, version 1.3. 2010. (access mar 21, 2011). (52) zhao, w.; leroy, f.; heggen, b.; zahn, s.; kirchner, b.; balasubramanian, s.; muller-plathe, f. stabl ion-pair room-temperatur ionic liquids? molecular dynam simul 1-n-butyl-3-methylimidazoliumhexafluorophosphate. j. am. chem. soc. 2009, 131, 1582515833. (53) antony, j. h.; mertens, d.; dolle, a.; wasserscheid, r.; carper, w. r. molecular reorient dynam neat ionic liquid 1-butyl-3-methylimidazolium hexafluorophosph measur c-13 nuclear magnet relax data. chemphyschem 2003, 4, 588594. (54) tildesley, d. j.; madden, p. a. time correl function model liquid carbon disulphide. mol. phys. 1983, 48, 129152. (55) vasenkov, s.; bohlmann, w.; galvosas, p.; geier, o.; liu, h.; karger, j. pfgnmr studi diffus inmfi-typ zeolites: evid exist intracrystallin transport barriers. j. phys. chem. b 2001, 105, 59225927. (56) dahlborgt, u.; gudowskit, w.; davidovic, m. van hove correl function coher neutron inelast scattering. j. phys.: condens. matter 1989, 1, 61736179. (57) embs, j. p.; juranyi, f.; hempelmann, r. introduct quasielast neutron scattering. z. phys. chem. 2010, 224, 532. (58) iftimie, r.; tuckerman, m. e. decompos total ir spectra aqueou system solut solvent contributions: comput approach maxim local wannier orbitals. j. chem. phys. 2005, 122, 214508. (59) gnu gener public license. (access mar 21, 2011). (60) grace. 1996-2008. (access mar 21, 2011). (61) persist vision raytrac (version 3.6). 2004. www.povray.org (access mar 21, 2011). (62) mathematica, version 8.0. 2010. www.wolfram.com/mathema- tica/ (access mar 21, 2011).