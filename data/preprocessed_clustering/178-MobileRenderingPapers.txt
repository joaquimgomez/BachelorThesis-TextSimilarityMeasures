adapt multi-r rai sampl mobil rai trace gpu adapt multi-r rai sampl mobil rai trace gpu won-jong lee seok joong hwang youngsam shin soojung ryu insung ihm samsung advanc institut technolog skt sogang univers figur 1: adapt rai sampl mobil ray-trac gpus. similar test classifi sampl similar (yellow) dissimilar (blue) (left). similar sampl shade linear interpol instead rai tracing. compar refer render (fsaa22) (middle), implement achiev 1.83 time better performance-pow effici compromis qualiti (psnr 30.5db) (right). abstract present adapt multi-r rai sampl algorithm target- ing mobil ray-trac gpus. effici combin exist algorithms, adapt supersampl undersampling, sin- gle framework target ray-trac gpu extend new multi-r sampl scheme util tile-bas render frame-to-fram coherency. experiment result implement versatil solut futur ray-trac gpu provid 2.98 time better effici term perfor- manc watt reduc number rai fed dedic hardwar minim memori operations. keywords: rai tracing, gpu, mobile, low-power, resampl concepts: comput methodolog rai tracing; graph- ic processors; 1 introduct recent mobil market grow continuously, real-tim rai trace attract consider attent futur graphic ap- plications, ux/ui, high-qual aaa games, virtual reality. however, real-tim rai trace current mobil cpu gpu continu challeng limit com- pute power, memori bandwidth, energi budget. therefore, recently, hardware-bas rai trace solut fulli dedic hardwar [nah et al. 2014], hardware-softwar hybrid [lee et al. 2013], gpu ip [mccomb 2014], pro- pose solv problem mobil devices. todai ray-trac hardwar ip mobil devic exhibit reason- abl perform (300 mrays/s) achiev real-tim render basic ray-trac effects, shadows, reflections, oc- clusions, fhd resolut (19201080) cooper ras- teriz gpus, call hybrid rendering. however, support requir production-level applications, permiss digit hard copi work person classroom us grant fee provid copi distribut profit commerci advantag copi bear notic citat page. copyright third- parti compon work honored. uses, contact owner/author(s). c 2016 copyright held owner/author(s). game engin rai trace (13 grays/s) [john- stone et al. 2015]. furthermore, comput requir increas futur graphic applic requir ex- treme high resolut (>4k). order narrow gap, consid adapt rai sam- pling approach, reduc comput cost main- tain imag quality. kei idea approach util pixel-to-pixel coher contain graphic applica- tion reus result ray-trac neighbor pixel current pixels. is, trace rai spars sampl classifi remain sampl type similar dissimilar (to spars samples) replac ray-trac oper inexpens linear interpol similar samples. paper, present adapt multi-r rai sampl algo- rithm improv performance-pow effici mo- bile ray-trac gpu, call sgrt (samsung gpu base rai tracing) [lee et al. 2012; lee et al. 2013]. combin exist algorithm target commod gpus, adapt rai supersampl [jin et al. 2009] adapt rai undersam- pling [kim et al. 2016], singl framework effici map programm shader core, significantli reduc comput cost fixed-funct hardware. unlik previou works, implement aggress util tile-bas render- ing, allow oper perform on-chip intern memori have access extern memory. addition, extend algorithm new multi-r sampl scheme appli variabl sampl rate accord ra- tio similar tile, provid addit perform improvements. experiment result implementa- tion versatil solut futur ray-trac gpus, achiev 2.98 time better effici term perform watt substanti reduc comput cost dedic hard- ware minim memori operations. summarize, main contribut paper are: integr adapt rai supersampl subsampl algorithm singl framework, propos new multi-r sampl scheme control sam- pling rate accord similar ratio tile, implement optim algorithm improv performance-pow effici mobil ray-trac gpus. ihm typewritten text ihm typewritten text ihm typewritten text definit version avail acm digit library. ihm typewritten text figur 2: overview adapt rai sampl ray-trac gpus. addit kernel similar check linear interpol easili implement srp support programmability. tile-bas approach allow oper perform on-chip intern memori have access extern memori figur 3: (a) refer (red) intermedi sampl (green). (b) rai shot refer intermedi samples. 2 relat work despit recent advanc mobil computing, need develop dedic hardwar great concern allow high-qual graphic base high perform low power solutions. spjut et al. [2012] propos version mimd tm [kopta et al. 2010] number thread multiproces- sor activ thread reduced, make suitabl mobil devices. kim et al. [2012] propos dedic multi-cor processor mobil rai tracing, configur simt mimd modes. however, architectur provid suffici high perform (less 30 mrays/s) real-tim rai trace real-world applications. lee et al. [2012] firstli present mobil gpu base rai trac- ing call sgrt combin advanteg programm dsp core call srp (samsung reconfigur processor) [lee et al. 2011] dedic hardware, call t&i unit. archi- tectur revis advanc featur 2-aabb travers unit [lee et al. 2014], reorder buffer [lee et al. 2015b], hybrid number [hwang et al. 2015]. recently, com- mercial mobil gpu featur ray-trac hardwar blocks, call powervr gr6500 [mccomb 2014], announced. kei featur gpu adopt hybrid render combin advantag rai trace rasterization. lee et al [2015a] propos hybrid render architectur base tile-bas mo- bile gpus. architectur realiz real-tim render basic raytrac effect support aaa game high-resolut vr applications. adapt sampl ray-trac domain import topic extens util past research hierarchi- cal adapt supersampl [whit 1980], optim stochast sam- pling [dipp wold 1985], adapt hierarch sampl [ka- jiya 1986], two-level sampl method [mitchel 1987]. algorithm util geometri inform imag object space adapt sampling. recently, algorithm evolv advantag commod pc mobil gpus. jin et al. [2009] present select adapt supersampl method, optim massiv parallel modern gpus. kim et al. [2016] adopt algorithm adapt undersampl method novel post-correct filters, optim mobil gpus. raster domain consid adapt sampl ap- proach [vaidyanathan et al. 2014; et al. 2014; clarberg et al. 2014] complex fragment shade sharpli in- creas commerci graphic applic aaa games. accord factor importance, interest, level (lod) camera effects, algorithm adapt control shade rates. however, rasterization-bas ap- proach extend ray-trac gpu similar method present paper. 3 adapt multi-r rai samp sgrt paper, present adapt multi-r rai sampl algo- rithm target mobil ray-trac gpus. baselin algorithm, util adapt methods, supersampl [jin et al. 2009] undersampl [kim et al. 2016], develop commod gpu rai tracer. invent differ pur- pose, kei idea same: reus result rai trace neighbor pixel current pixel. brief oper flow follows. initially, screen area par- tition types. figur 3 show exampl partit 22 blocks, regularli distribut set, mark r, form group refer sampl (r-samples). sam- ples, mark i, call intermedi sampl (i-samples). exampl show 22 pixel partitioning, chang (e.g 33, 44) accord sampl ratio. integr super undersampl algorithm singl framework. sampl map sub-pixel supersampl mode, map pixel undersampl mode. render consist steps. rai trace r-sampl carri out. step, sampl color comput addit geometri infor- mation step collect (figur 3b). geometri inform includ hit object id, normal vector, posit vector, shadow bit hit point. figur 4: visual similar check frame extract anim sequenc provenc scene (yellow: similar, blue: dissimilar). frame number 1, 150, 340, 400, 600, 700. similar ratio variant tile frame, variant frame tiles. figur 5: oper flow propos adapt multi-r rai sampl frame coherency. shadow bit set shadow cast surfac hit point respect correspond light source. given geometri information, similar check con- duct adjac r-samples. con- duct test object id same, direct normal vector similar, shadow bit same. test consist sub-step x- y-direction. oper i-sampl carri out. current i- sampl pass similar check, color calcu- late linear interpol neighbor r-samples. otherwise, normal ray-trac current i-sampl conducted. secondarys, procedur appli manner. extend algorithm effici map ray-trac gpu. target gpu, util sgrt [lee et al. 2012; lee et al. 2013], consist components: dedic hardwar call t&i unit programm shader call srp [lee et al. 2011]. t&i unit acceler travers intersection, domin oper rai tracing. oper- ation implement softwar execut srp. commun compon effici perform direct interfac [shin et al. 2013] ex- ternal memori overhead. figur 2 show overview rai trac- ing base adapt rai sampl sgrt. simpl expla- nation, procedur secondari rai omitted. addit kernel adapt rai sampling, similar check, in- terpolation, color update, easili implement srp programmability. conversely, architectur fulli ded- icat hardwar [nah et al. 2014] add addit logic support new featur lack flexibility, eventu in- creas area costs. addition, unlik previou work [jin et al. 2009; kim et al. 2016], adopt tile-bas approach avoid expens memori operations. words, conduct rai trace tile (a subdivid area screen) basis, local buffer-stor geometri data, call tile-buffer, intern memori srp. thus, access extern memori minim render time. oper flow implement follows. rai r-sampl gener kernel srp transmit t&i unit direct interface. t&i unit per- form travers intersect oper send hit point srp. shade kernel srp execut hit points. additionally, shade kernel store geom- etri color inform hit point tile buffer intern memory. i-samples, similar check ker- nel execut geometri data tile buffer store binari results, test pass fail, tile buffer again. kernel produc data stream base result sim- ilar test. i-sampl pass similar test fed interpol kernel, i-sampl fail test fed ray-gener kernel restart normal rai tracing. kernel implement inspector-executor model [hwang et al. 2014] reduc side-effect branch di- vergenc maxim effici stream processing. color comput current tile finished, color data tile buffer flush extern frame buffer dma (direct memori access) function. supersampl mode, color updat includ step averag sampl color pixel color; thus, mode alloc memori proport sampl rate compar undersampl mode. addition, extend baselin algorithm aggress multi-r sampl method util tile-bas approach frame-to-fram coherence. figur 4 visual sim- ilar check frame extract anim se- quenc provenc scene (yellow: similar, blue: dissimilar). similar ratio variant tile frame frame tiles. thus, tile rel- figur 6: test scenes. teapot (15k triangles), chess (42k), bmw (55k), chemic lab.(98k), provenc (600k). ativ high similar ratio us lower sampl ratio similar check step (e.g. r-sampl 22 block r- sampl 44 block), reduc addit comput cost significantli damag imag quality. en- abl multi-r sampl appli differ sampl rate tile accord similar ratio. per-til similar ratio referenc previou frame, valu com- pare predefin thresholds. base result, dynam control sampl rate per-til basis, shown figur 5. alternately, switch threshold valu order avoid tempor alias caus discret jump sampl rate changed. finally, adapt rai sampl multi-r featur significantli improv performance-pow effici reduc number rai traced. 4 experiment result verifi evalu framework reduc comput- ing cost t&i unit, util cycl accur simul sgrt integr energi model. simul pro- vide render images, total execut cycles, hardwar utilization, cach statistics, expect performance. energi power model [lee et al. 2015b] util custom model base databas built power valu compo- nent synopsi primtim px [synopsi 2016] sam- sung 14nm lpp process technolog [samsung 2016]. cycl ac- curat simul produc activ counter hardwar block aggreg power valu obtain energi power model. hardwar configur t&i t&i unit 2.0 [lee et al. 2014]. test scenes, dataset (figur 6), teapot (15k triangles), chess (42k), bmw (55k), chemic lab.(98k), provenc (600k). scene secondari rai includ shadows, refractions, reflections. test scene render 20481024 res- olution. comparion perform quality, choos refer conditions: fsaa (full scene antialiasing) 22: rai shot pixel target resolution. standard 11: rai shot pixel target reso- lution. refer compar adapt supersampl adapt undersampl mode, respectively. figur 7 show rel performance, power consumption, ratio (perform watt), measur t&i unit appli adapt ray-sampl approaches. overall, tabl 1: psnr render scene adapt rai sampl sampl mode teapot chess bmw chemic lab. provenc averag adapt supersampl 48.99 28.53 34.11 36.28 30.50 35.68 adapt undersampl 42.13 34.73 41.68 42.60 37.71 39.77 adapt method outperform refer method 3 be- caus rai trace similar i-sampl replac interpol oper srp correspond rai transmit t&i unit. perform improv proport number rai cut access ex- ternal memori minim tile-bas rendering. term power consumptions, adapt method consum slightli power ( 9%), faster render speed higher pipelin util (but, trend revers valu translat energy). result, adapt method advantag achiev 2.98 time better effici term perform watt. variant test scenes. scene higher similar lower frequenc (teapot, bmw) exhibit better gain (2.432.98). case scene rel higher frequenc (chess, chem- ical lab., provence), exhibit 1.53 gains. lastly, consid overhead addit kernel srp. profil results, decomposit execut cycl srp, overhead 11% (5% similar check 6% interpolation) hinder execut t&i unit. evalu imag quality, comput psnr valu refer test scene (tabl 1). average, obtain valu 35.68 39.77 db visual toler level shown figur 1. believ imag qualiti better add test condit similar check imag space (e.g. textur color difference) appli post-correct method [kim et al. 2016] adjust errors. 5 conclus futur work paper, present adapt multi-r rai sampl al- gorithm target mobil ray-trac gpus. effici com- bine exist algorithm singl framework extend new multi-r sampl scheme util tile-bas ren- dere frame-to-fram coherency. adapt rai sampl figur 7: rel performance, power consumption, ratio perform watt (to reference), execut t&i unit appli adapt sampl approaches. achiev 2.98 time better effici term perfor- manc watt reduc number rai fed dedic hardwar minim memori operations. current framework, multi-r sampl applied. near future, add featur perfor- manc improv equip accur similar test post-correct filter better qualiti cover corner case like object [kim et al. 2016]. refer clarberg, p., toth, r., hasselgren, j., nilsson, j., akenine- moller, t. 2014. amfs: adapt multi-frequ shade futur graphic processors. acm transact graphic (proceed acm siggraph 2014) 33, 4, articl no. 141. dippe, m., wold, e. 1985. antialias stochast sampling. proceed acm siggraph 1985, 6978. he, y., gu, y., fatahalian, k. 2014. extend graphic pipelin adaptive, multi-r shading. acm transact graphic (proceed acm siggraph 2014) 33, 4, articl no. 142. hwang, s. j., deshwal, a., lee, w.-j., shin, y., lee, j., yoo, d., ryu, s. 2014. shade languag compil implement mobil rai trace accelerator. proceed acm siggraph asia 2014, symposium mobil graphic interact applic (mgia), articl no. 2. hwang, s. j., lee, j., shin, y., lee, w.-j., ryu, s. 2015. mobil rai trace engin hybrid number representation. proceed acm sig- graph asia 2015, symposium mobil graphic interact applic (mgia), articl no. 3. jin, b., ihm, i., chang, b., park, c., lee, w.-j., jung, s. 2009. select adapt supersampl real-tim rai tracing. proceed acm high perform graphic (hpg) 2009, 117125. johnstone, b., sommefeldt, r., peterson, l., davis, j. 2015. powervr graphic keynote: latest develop futur plans. imagin develop- er connect (idc) 2015, technic talk. kajiya, j. 1986. render equation. proceed acm siggraph 1986, 143150. kim, h.-y., kim, y.-j., oh, j., kim, l.-s. 2012. reconfigur simt processor mobil rai trace content reduct share memory. ieee transact circuit system (tcs) 1, 99, 113. kim, y., seo, w., kim, y., lim, y., nah, j.-h., ihm, i. 2016. adapt undersampl effici mobil rai tracing. visual (proceed graphic intern 2016), 111. kopta, d., spjut, j., davis, a., brunvand, e. 2010. effici mimd architectur high-perform rai tracing. proceed 28th ieee intern confer design (iccd) 2010, 916. lee, w.-j., woo, s.-o., kwon, k.-t., son, s.-j., min, k.-j., lee, c.-h., jang, k.-j., park, c.-m., jung, s.-y., , lee, s.-h. 2011. scal- abl gpu architectur base dynam embed reconfigur processor. proceed acm high perform graphic 2011, posters. lee, w.-j., lee, s., nah, j.-h., kim, j.-w., shin, y., lee, j., jung, s. 2012. sgrt: scalabl mobil gpu architectur base rai tracing. pro- ceed acm siggraph 2012, talks. lee, w.-j., shin, y., lee, j., andja ho nah, j.-w. k., jung, s.-y., lee, s.-h., han, h.-s. p. t.-d. 2013. sgrt: mobil gpu architectur real-tim rai tracing. proceed acm high perform graphic (hpg) 2013, 109119. lee, j., lee, w.-j., shin, y., hwang, s. j., ryu, s., kim, j. 2014. two- aabb travers mobil real-tim rai tracing. proceed acm sig- graph asia 2014, symposium mobil graphic interact applic (mgia), articl no. 14. lee, w.-j., hwang, s. j., shin, y., yoo, j.-j., ryu, s. 2015. effi- cient hybrid rai trace raster architectur mobil gpu. proceed acm siggraph asia 2015, symposium mobil graphic interact applic (mgia), articl no. 2. lee, w.-j., shin, y., hwang, s. j., kang, s., yoo, j.-j., ryu, s. 2015. re- order buffer: energy-effici multithread architectur hardwar mimd rai traversal. proceed acm high perform graphic (hpg) 2015, 2132. mccombe, j. 2014. new techniqu possibl powervr rai trace hard- ware. game develop conferecn (gdc) 2014, technic talk. mitchell, d. 1987. gener antialias imag low sampl densities. proceed acm siggraph 1987, 6572. nah, j.-h., kwon, h.-j., kim, d.-s., jeong, c.-h., park, j., han, t.-d., manocha, d., park, w.-c. 2014. raycore: ray-trac hardwar ar- chitectur mobil devices. acm transact graphic (tog) 33, 6, articl no. 162. samsung, 2016. 14 nano meter technolog . shin, y., lee, w.-j., lee, j., lee, s.-h., ryu, s., kim, j. 2013. en- ergi effici data transmiss rai trace mobil comput platform. proceed acm siggraph asia 2013, symposium mobil graphic interact applic (mgia), articl no. 64. spjut, j., kopta, d., brunvand, e., davis, a. 2012. mobil acceler architectur rai tracing. proceed 3rd workshop socs, heteroge- neou architectur workload (shaw-3). synopsys, 2016. primetim px: signoff power analysi tool . fcd.html. vaidyanathan, k., salvi, m., toth, r., foley, t., akenine-moller, t., nilsson, j., munkberg, j., hasselgren, j., sugihara, m., clarberg, p., janczak, t., lefohn, a. 2014. coars pixel shading. proceed acm high perform graphic (hpg) 2014, 918. whitted, t. 1980. improv model shade display. commun acm 23, 6, 343349.