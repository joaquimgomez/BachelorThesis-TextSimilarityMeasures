modern workflow force-field develop bridg quantum mechan atomist comput model physic commun 182 (2011) 21842191 content list avail sciencedirect physic commun www.elsevier.com/locate/cpc modern workflow force-field develop bridg quantum mechan atomist comput model dirk reith, karl n. kirschner fraunhof institut algorithm scientif comput (scai), depart comput chemistri engineering, schloss birlinghoven, 53754 sankt augustin, germani r t c l e n f o b s t r c t articl history: receiv 1 march 2011 receiv revis form 26 2011 accept 28 2011 avail onlin 13 june 2011 keywords: atomist forc field paramet optim scientif workflow multiscal model articl present recent effort design comprehens consist scientif workflow, nicknam wolf2 pack, force-field optim field comput chemistry. atomist forc field repres multiscal bridg connect high-resolut quantum mechan knowledg coarser molecular mechanics-bas models. force-field optim far time-consum error-pron process, topic us scientif workflow provid obviou great benefits. case studi gener gas-phas forc field methanol wolf2 pack, special attent given deriv partial atom charges. 2011 elsevi b.v. right reserved. 1. introduct multiscal model comput chemistri exist 5060 years, aris develop quantum mechanics-bas atomist forc fields. high-resolut quantum mechan (qm) method investig elec- tron behav nuclei. larg number possibili- ties, studi provid ground-stat inform poten- tial energi geometri stationari points, molecular electro- static potenti (mep), vibrat frequencies. coarser level, need access larger systems, newtonian physics-bas atomist models, molecular mechan (mm) molec- ular dynam (md) simulation, allow investig atomist behavior need comput costli electron inte- gral requir qm methods. however, reliabl atomist mm md model requir accur forc fields, optim qm data valid experiment data. way, forc field serv bridg transfer qm-gain knowledg atomist mm-base models. force-field develop time-consum process involv multipl step data transferal. basi meaning application-typ study. therefore, primari goal research develop accur reliabl atomist force-field paramet reason time error free possible. accomplish creat scientif workflow force- field optim packag (wolf2 pack) incorpor be- * correspond author. e-mail addresses: (d. reith), (k.n. kirschner). 0010-4655/$ matter 2011 elsevi b.v. right reserved. doi:10.1016/j.cpc.2011.05.018 lief qm-gain knowledg transfer mm models. defin scientif workflow seri independ step link accord data flow de- pendenc [1], implement us tailor-mad script algorithms. benefit util sci- entif workflow clear a) save time autom cer- tain tasks, b) force-field develop (almost) determinist reproducible, reduc human error, c) enabl task execut distribut environment, d) accommod ideas, algorithm changes, updat place step, final e) acceler transform scientific-analysi process [13]. commun servic perspective, wolf2 pack significantli reduc real time need force- field develop allow nonspecialist access stan- dardiz optim procedures. scientif perspective, allow research focu scientif issues, hierarch organization, error better avoid specif improv easier accomplish. contribution, introduc wolf2 pack work wai optim paramet methanol case study, fo- cuse partial atom charges, rel potenti energi curves, geometries. importantly, state real time need perform overal task. furthermore, demonstr impact differ partial atom charg dipol mo- ment vector potenti energi curves. clearly, present forc field methanol. known small molecul mere chosen case studi serv specif exampl simpl allow disclos procedure. so, emphasi sci- entif workflow clear, benefit d. reith, k.n. kirschner / physic commun 182 (2011) 21842191 2185 fig. 1. workflow atomist force-field optimization. collect tool need quickli reliabl develop high-accuraci forc fields. creation tool optim intramolecular forc con- stant previous groups. research group develop program suit inter- ests, torsfind [4], parmscan [5], fit dihedr [6], forcefit [7]. goal develop wolf2 pack creat user- friendli user-driven packag address modern force-field parameter issues. wolf2 pack design interfac exist md packag (e.g. amber, gromacs), allow user develop balanc paramet miss forc field packages. 2. scientif workflow & case studi difficulti force-field develop aris number sequenti interdepend step need transfer qm-gain knowledg classic atomist level. dif- ficulti aris pure research aspect (e.g. choic theori levels, train molecul use, validate). importantly, time consum larg manual in- tervent need (e.g. edit files, transfer data program another) execut comput jobs. fortunately, creation workflow, difficulti execut sequenti step time requir file creation editing, need steps, greatli reduced. job parallelization, real time need run comput greatli reduced. thus, scientif workflow enabl research better us time address research aspects. wolf2 pack, diagram fig. 1, exampl workflow incorpor philosophi force-field development. philosophi foundat paramet optim human driven entir process. view issu pure mathemat problem, pa- ramet treat fulli adjust optim pro- cedur numer problem. so, nearli molecular forc field gener perform measur high precision. however, approach lose link physic basi behavior given degre freedom paramet value. paramet transfer sens accuraci depend molecul target observ (e.g. rel energies, density, diffus rates) optim procedure. instead, scientist steer paramet optim procedur maintain link given paramet physic origin. thus, optim goal turn gener paramet reproduc molecular behavior gener pa- ramet reproduc underli physics, captur molecular behavior process. feel approach result paramet transfer best repres bridg qm-gain knowledg coarser mm models. allow easier paramet refin in- accuraci uncov research investig local approach describ degre free- dom. following, demonstr envis proce- dure methanol molecule. serv simpl demand test case eas understand meta-level idea reader. 2.1. workflow 2.1.1. workflow step 13: foundat setup step, structur conform se- lect methanol hcoh torsion angl 180 . structur coordin come experiment (e.g. mi- crowav x-rai data) theoret data (e.g. previou quantum optimization). case pymol [8] creat methanol 180 torsion angle, ran hf/6-31g(d) geometri optimization, verifi minimum frequenc analysis. gener speaking, global minima, low-energi conformation, help ensur result op- timiz forc field best reproduc geometri energet highest popul conformations. trivial methanol; however, molecul multipl minima nec- essari computation search global minima experiment unknown. result qm-optim conforma- tion input gener conform step 3. step 2, determin final atom sequence, requir maintain consist atom order workflow. enabl transfer geometr data easili reduc likelihood errors. allow root-mean-squar deviat (rmsd) calcul structur overlai system- atic manner. step 3, n conform gener reaction coordin investig degre freedom. bond an- gle conform sampl expans contract pathwai extend minimum. confor- mation torsion angl systemat relev minima maxima sampl bond rotation. methanol, chose sampl bond angl potenti energi surfac 0.01 2 (e.g. fig. 2), torsion angl sampl 30 (fig. 3). 2.1.2. workflow step 4 5: qm-constrain geometri energi conform gener step 3 individu opti- mize quantum mechanics, constrain specif degre freedom. goal obtain reliabl geome- tri energet specifi reaction coordinate. clearly, singl method obtain reliabl geometri energetics; however, typic cost computa- tional power calcul time. thus, advantag us inexpens method obtain geometri (step 4) expens method obtain energi (step 5). seen fig. 3, rel potenti energi curv differ greatli theori another. methanol, hf/6-31g(d) perform con- strain optim reason reproduct ex- periment geometri low cost (tabl 1). energet perform b3lyp/6-311++g(2d,2p) singl self-consist field 2186 d. reith, k.n. kirschner / physic commun 182 (2011) 21842191 fig. 2. rel potenti energi curv methanol (a) stretch (b) c oh bend determin b3lyp/6-31++g(2d,2p) (black circles), optim forc field resp hf/acct c (blue close squares) opl (red open squares) charg sets. energi report kcal mol1, distanc angstrom, angl degrees. calcul hf/6-31g(d) geometri past us theori force-field develop [9]. furthermore, shown alling cowork b3lyp/6-311++g(2d,2p) pro- vide reliabl energet system involv alcohol functionali- ti [10]. 2.1.3. workflow step 6 7: determin partial atom charg instanc transfer qm-knowledge, molecular electrostat potential, classic represent knowledge, partial atom charg (tabl 2). partial atom charg experiment qm observable, obtain mep directli quantum wavefunction. want partial atom charg reproduc consis- tent similar chemic environ (e.g. carbonyl group r1c(=o)r2, r1,2=cnh2ch3). thus, chosen calcul charg fit mep resp methodolog implement r.e.d. [1114]. methanol gener resp charg set varieti qm level (tabl 2). resp hf/acct c charg set provid dipol moment 1.80 deby closest experiment magnitud 1.69 deby [15,16], provid charg equiva- lent methyl hydrogen (see section 3 discussion). conversely, resp hf/sto-3g c opl charg provid dipol moment 1.53 2.24 debye, repres largest deviat ex- periment. ultimately, chose resp hf/acct c charg set fig. 3. potenti energi curv methanol hcoh torsion rotat deter- mine hf/6-31g(d) (triangles), b3lyp/6-31++g(2d,2p) (circles), forc field (square). mm curv gener v 3 = 0.00 (a) v 3 = 0.17 (b). en- ergi report kcal mol1 angl measur degrees. best reproduc methanol experiment dipol moment equival charg methyl hydrogens. 2.1.4. workflow step 8: gener classic model incorpor partial atom charg classic model, gener mol2 files, constrain qm op- timization, mm calcul (step 9). atom type assign stage. mol2 file in- clude atom labels, atom coordinates, atom types, partial atom charges. amber, mol2 file cre- at topolog file need mm minimizations. such, mol2 file atom type assign methanol supplementari inform onlin version doi:10.1016/j.cpc.2011.05.018. 2.1.5. workflow step 9: mm-constrain geometri energi step 9 perform constrain mm optimizations. ini- tial bond angl forc constant set reason values, valu close relat paramet borrow similar forc field, natur equilibrium length (req) angl (eq) set qm-optim valu (eq. (1)). torsion forc constant set zero. qm-optim co- ordin input mm calculations, result geometri rel energi compar directli another. tabl 1 methanol structur methyl rotat barrier determin experimental, quantum mechanical, molecular mechan methods.a degre freedom exp. 1b exp. 2c hf/sto-3g hf/6-31g(d) hf/accd hf/acct chd 1.0936 0.0032 1.095 0.010 1.094 1.085 1.091 1.084 1.4246 0.0024 1.428 0.003 1.433 1.400 1.405 1.399 ho 0.9451 0.0034 0.960 0.015 0.991 0.946 0.942 0.939 coh 108.32 0.29 103.8 109.4 109.9 110.2 hchd 108.38 0.42 109 3 108.1 108.5 108.7 108.6 hcoh 61.1 61.2 61.2 61.2 torsion barrier 1.07 2.013 1.359 1.125 mp2/6-31g(d) mp2/accd mp2/acct opl resp hf/sto-3g c resp hf/acct c chd 1.095 1.100 1.089 1.097 1.096 1.096 1.424 1.435 1.423 1.432 1.428 1.428 ho 0.970 0.966 0.961 0.961 0.960 0.960 coh 107.4 107.7 108.0 109.5 109.5 109.5 hchd 108.6 108.9 108.8 108.8 109.0 109.0 hcoh 61.5 61.5 61.4 60.2 60.0 60.0 torsion barrier 1.485 1.132 1.00 1.05 1.02 1.02 report distances, angles, energet angstrom, degrees, kcal mol1. b obtain millimeter-wav spectrum [22]. c obtain electron diffract method [23]. d averag valu reported. d. reith, k.n. kirschner / physic commun 182 (2011) 21842191 2187 tabl 2 partial atom charg dipol moment (, debye) methanol determin number approaches. oplsa resp hf/6-31g(d) resp hf/6-31g(d) b resp hf/6-31g(d) c resp hf/6-31g(d) d orig. b resp hf/6-31g(d) d htran 0.040 0.0411 0.0008 0.0000 0.0072 0.0372 hgauch 0.040 0.0218 0.0008 0.0000 0.0072 0.0372 c 0.145 0.2562 0.2561 0.2434 0.2164 0.1166 o 0.683 0.6741 0.6741 0.6194 0.6141 0.6498 h 0.418 0.4204 0.4204 0.3760 0.3761 0.4215 rrmsc 0.241 0.135 0.201 0.178 0.179 0.1672 1.268 0.963 0.965 0.977 0.980 0.999 b 1.852 1.551 1.858 1.667 1.666 1.853 d 2.24 (32.5%) 1.83 (8.3%) 2.09 (23.7%) 1.93 (14.2%) 1.93 (14.2%) 2.14 (26.6%) resp hf/sto-3g c resp hf/accd resp hf/accd b resp hf/accd c resp hf/acct resp hf/acct c htran 0.0000 0.0271 0.0172 0.0000 0.0234 0.0000 hgauch 0.0000 0.0394 0.0172 0.0000 0.0421 0.0000 c 0.1705 0.3076 0.3075 0.2323 0.3177 0.2309 o 0.4453 0.6559 0.6559 0.5872 0.6565 0.5863 h 0.2748 0.4000 0.4000 0.3549 0.3996 0.3554 rrmsc 0.156 0.186 0.226 0.185 0.224 0.791 0.921 0.921 0.936 0.899 0.913 b 1.315 1.434 1.759 1.563 1.431 1.557 d 1.53 (9.5%) 1.70 (0.6%) 1.99 (17.8%) 1.82 (7.7%) 1.70 (0.6%) 1.80 (6.5%) resp mp2/6-31g(d) resp mp2/6-31g(d) c resp mp2/accd resp mp2/accd c resp mp2/acct resp mp2/acct c htran 0.0509 0.0000 0.0407 0.0000 0.0336 0.0000 hgauch 0.0087 0.0000 0.0243 0.0000 0.0303 0.0000 c 0.2135 0.2468 0.2560 0.2368 0.2779 0.2349 o 0.6570 0.6151 0.6379 0.5832 0.6407 0.5823 h 0.4101 0.3686 0.3898 0.3464 0.3898 0.3475 rrmsc 0.130 0.168 0.181 0.218 0.180 0.216 1.074 1.085 1.046 1.058 1.012 1.024 b 1.588 1.700 1.461 1.590 1.459 1.583 d 1.92 (13.7%) 2.02 (19.5%) 1.80 (6.5%) 1.91 (13.0%) 1.78 (5.3%) 1.89 (11.8%) opl [24] partial atom charg hf/6-31g(d) geometry. b partial atom charges, rrms, reproduc tabl vii ref. [11]. c rel root-means-squar valu qm comput mep defin partial atom charges. d experiment dipol 1.69 debye, compon 0.889 1.39 deby [15,16]. percent error rel experiment valu shown parentheses. 2.1.6. workflow step 10: paramet optim step 10 second instanc transfer qm- gain knowledg (i.e. geometries) classic model. step optim bond, angle, torsion forc constant take place. point qm initi mm data assembl generated. obtain properli optim paramet critic bridg- ing qm atomist resolut levels. possibl us algorithm adjust paramet mm potenti energi curv geometri come agreement qm data. purpose, us gnuplot least-squares-fit solver obtain initi sampl possibl dihedr paramet solut [17]. note, degre freedom poten- tial function truncat v 3 term suffici reproduc nearli qm data observ far. workflow allow quick iter step 9s con- strain mm optim allow research uniqu abil steer paramet valu deem best reproduc import region potenti energi surfac (e.g. transit state regions, specif minima). manual param- eter adjust reiter step 9, research us chemic intuit optim process, help ensur paramet maintain physic interpret meaning. total methanol, 116 qm-constrain optim 116 singl self-consist field calcul deriv paramet report tabl 3. illustration, fig. 3 dis- plai pre- post-forc field optim rel potenti en- ergi curv hcoh torsion rotation; hf/6-31g(d) b3lyp/6-311++g(2d,2p) rel energi included. fig. 2 displai rel energi stretch coh bend comput b3lyp/6-311++g(2d,2p), forc field resp hf/acct c opl charg sets. know experiment valu methanol methyl rotation, knowledg optim hcoh parameter. includ qm rel potenti en- ergi (step 4), constrain qm geometri point curv optim paramet minim rmsd qm mm optim structures. com- pare energet geometr data qm mm constrain optim structur 116 comput con- format points, rmsd valu 0.027 , hf/6-31g(d) geometries, 0.30 kcal mol1 absolut energi difference,1 us- ing b3lyp/6-311++g(2d,2p) rel energies, obtain forc field (tabl 3) resp hf/acct c charg set (tabl 2). minima considered, absolut energi error 0.04 kcal mol1 obtained. 2.1.7. workflow step 11: valid final step workflow valid optim parameters. valid method gener qm potenti 1 |energi error| = |(qm rel energy) (mm rel energy)|. 2188 d. reith, k.n. kirschner / physic commun 182 (2011) 21842191 tabl 3 force-field paramet methanol.a bond kl lo angl k o 350.0 1.428 coh 55.0 109.5 ch 410.0 1.096 hco 60.0 110.0 o-h 730.0 0.960 hch 40.0 109.0 torsion v 1 v 2 v 3 hcoh 0.0 0.0 0.17 opl l-jb c 1.964 0.066 h (c) 1.403 0.030 h (o) 0.000 0.000 o 1.751 0.170 bond length, bond angle, torsion constant kcal mol1 2, kcal mol1 rad2, kcal mol1. b opl [24] lennard-jon paramet convert us amber pairwis combin rules. energi curv involv degre freedom investigated, molecul train set. trans- ferabl forc field desired, curv repro- duce forc field wide rang test molecules. how- ever, ultim valid come compar computa- tional result experiment data. choic data come experiment studi similar studi forc field implement gas-phas solution-phas data standard temperatur pressure, data phase coexist curve. popular experiment data valid includ experiment ge- ometri (e.g. obtain microwav data, crystallization, nmr), dipol moments, vibrat frequencies, conform popula- tions, densities, enthalpi vaporizations, diffus rates. type experiment data allow uniqu validation. ex- ample, us microwav geometri moment inertia indic gas-phas minima reproduced. nmr data help valid intramolecular paramet be- havior solvat molecules. us densiti enthalpi vapor help valid intermolecular paramet behavior. methanol, illustr goal gener forc field reproduc experiment gas-phas geometries, dipol mo- ment, energetics. tabl 1 provid methanol geometri determin experiments, optim seven differ qm levels, optim forc field differ charg sets; charg set includ resp hf/acct c , resp hf/sto-3g c , opls. fulli optim mm structure, optim pa- ramet resp hf/acct c charg set, yield structur nearli ident determin electron diffract averag error 0.74% respect microwav structure. also, resp hf/acct c deriv dipol moment 1.5 devia- tion vector orient regard experiment measurement. purpos herein, valu valid optim forc field. note, investig intermolec- ular interaction, obviou step. like requir optim lennard-jon parameters, futur task suit global optim strate- gi [18] grow algorithm [1921]. 3. highlight resp-deriv partial atom charg approach determin partial atom charg mm calculations. amber community, us resp-deriv charg favor condensed-phas biolog md simul [9,11,12]. resp implement differ hyperbol weight fit process [11]. example, connolli chelpg comput mep fig. 4. dipol moment vector comput partial atom charg (a) resp hf/6-31g(d) (blue), resp hf/6-31g(d) b (green), resp hf/631g(d) c resp hf/631g(d) d (both shown red near equival values), (b) opl (red), resp hf/sto-3g c (green), resp mp2/acct c (blue), experi (yellow) [15,16]. (for interpret refer color figur legend, reader refer web version article.) resp fit [9,11,12]. hf/6-31g(d) common theori gener mep resp input [25,26], hf/cc-pvtz theori develop gycam06 [9]. cases, singl conform gener mep, case multipl conform [27,9]. common includ atom resp fit process, how- develop glycam06, restrict aliphat hy- drogen partial atom charg zero [9]. studi comput resp charg set methanol. origin resp studies, methanol studi differ weight function differ charg averag method (i.e. resp hf/6-31g(d) , resp hf/6-31g(d) b , resp hf/6-31g(d) d ) effect charg dipol moment magnitud [11]. herein, revisit portion earli studi improv resp approach implement r.e.d. chelpg algorithm gener mep, extend studi examin differ basi set us mp2 theori effect resp-determin partial atom charges. time, knowledge, includ examin differ resp approach affect dipol moment orientation. resp-deriv charges, determin differ qm levels, provid tabl 2. resp-deriv dipol moments, magnitud compon vector orient respect methanol center mass, includ table. opl charg set result dipol moment, comput hf/6-31g(d) optim geometry, includ comparison. hf/6-31g(d) jorgensen cowork develop opl parameters, best suit determin opl dipol moment orient [24]. fig. 4 provid graphic represent select dipol moment illustr variat seen differ approaches. origin methanol charg (tabl 2: orig. resp hf/6-31g(d) d ) significantli differ analog charg set produc study. current studi methyl hydrogen charg time smaller carbon charg twice larg comput kollman cowork 1993. differ charg distribut seen dipol moment magni- tude, origin studi valu 2.14 deby [11] compar current valu 1.93 debye. larger molecu- lar dipol seen advantag us hydrophil solution- phase simul approxim effect polar [28,26]. nevertheless, current goal reproduc gas-phas observ resp approach undesirable. seen tabl 2, origin 1993 charg set provid second wors dipol moment comparison experiment valu 1.69 deby [15,16]. discrep origin resp-deriv charg set present like us chelpg mep us multipl reorient gener mep implement r.e.d. d. reith, k.n. kirschner / physic commun 182 (2011) 21842191 2189 rel root mean squar deviat (rrms) fit be- tween resp-deriv partial atom charg qm mep indic overal fit qualiti [11,29]. base cri- teria alone, tabl 2 resp charg obtain hf/6-31g(d) mp2/6-31g(d) mep, allow ev- eri atom uniqu assign partial atom charg (i.e. method a) provid lowest rrm value. unfortunately, allow- ing atom uniqu assign charg impract forc field md simul conform sampl occurs. thus, examin differ ap- proach equivalenc methyl hydrogen charges. seen us hf/6-31g(d) mpe, posteriori averag (method b) hydrogen provid higher rrm averag dur- ing fit process (i.e. method c d). (we perform posteriori summat hydrogen charg car- bon atom, yield hydrogen charg 0.0 carbon charg 0.2537, alter result seen method bs av- eraging.) furthermore, enforc hydrogen charg fit process (i.e. method c d) produc rrm values. therefore, enforc charg equival hydrogens, mean regardless us hf, mp2, size basi set, increas rrm value. confirm trend seen origin methanol studi hf/6-31g(d) mep method a, b, d [11]. rrm valu provid indic qm mep re- product quality, indic charg set best reproduc experiment observables. recal goal de- termin partial atom charg provid classic model best mimic nature. ideally, qm wavefunct contain in- format observ experimentally. practically, current solut schrdinger equat realiz approxim (e.g. bornoppenheimer, basi sets, treatment electron correlations), result error solutions. there- fore, valid qm theori (e.g. hf, mp2, dft), us given basi set, regard reproduc ex- periment results. rrm analysi indic charg reproduc given qm mep, qm method requir validation. end, dipol moment excel- lent gas-phas experiment observ gaug suitabl resp-gener charg us gas-phas mm-base calcula- tions. theori level explor tabl 2, resp hf/accd resp hf/acct charg set best reproduc experiment dipol magnitude, error 0.6%, charg set rrm valu higher approach smaller basi set (e.g. resp hf/6-31g(d) resp hf/sto-3g c ). further- more, improv electron correl treatment worsen agree- ment slightly, yield error 6.5% 5.3%. experiment dipol moment vector compon determin laser-stark spectrum microwav data, provid magnitud 1.69 debye, 0.885 1.44 deby [15,16]. mention above, charg equival worsen resp dipol agreement experiment value; clear averag charg posteriori provid worst resp-deriv dipol valu (resp hf/6-31g(d) b = 2.09 deby resp hf/accd b = 1.99 debye). us hf/sto-3g mep significantli underestim dipol magnitude, theori so. interestingly, opl charg provid dipol moment magnitud 2.24 debye, wors charg set studied. opl charg empir deriv solut phase intend gas-phas study. regardless, charg provid extrem case put valu perspective. orient dipol vector requir considera- tion. consid resp-deriv dipol moment hf/6- 31g(d) mep, methods, distinguish- abl dipol orientations, indic compo- nent (tabl 2) shown fig. 4(a). consid vector divergent, determin resp hf/6-31g(d) resp hf/6-31g(d) b , angl 4.8 form them. regard experiment dipol orientation, resp hf/6-31g(d) dipol 0.5 agreement resphf/6-31g(d)b dipol 4.4 deviation. fig. 4(b) displai experiment dipol ori- entat determin opls, resp hf/sto-3g c , resp mp2/acct c charg sets. clear fig. 4 magnitud dipol moment chang significantli differ resp approach, dipol orient effect lesser degree. describ above, resp hf/acct c charg set yield dipol moment 6.5% experiment magnitud angl de- viation 1.5 . consid requir methyl hydrogen equivalent, resp hf/acct c repres optim charg set gas-phas mm study. obviou question is, effect alter partial atom charg potenti energi surfaces? explor question, recomput methanol rel po- tential energi curv opl charg set compar result curv comput resp hf/acct c charg set. fig. 2 displai stretch coh bend curv comput charg sets, curv displai signific changes. seen, differ subtl small differ atomist charg involv 14 interact (i.e. methyl hydrogen hydroxyl hydrogen). like larger differ observ molecul steric hinder larger chang occur partial atom charges. fortunately, val- idat differ charg sets, subsequ reoptim forc field necessary, easier task us wolf2 pack. 4. technic detail case studi 4.1. quantum mechan calcul geometri optim perform restrict closed-shel hartreefock (hf) mllerplesset second order perturb (mp2) theori level gradient converg toler- anc 0.000001 hartre bohr1. constrain optim perform specifi intern coordin frozen degre freedom allow relax fully. singl self-consist field calcul perform us- ing beck paramet leeyangparr hybrid densiti function (b3lyp). follow basi set study: sto-3g (14 basi functions), 6-31g(d) (38 basi functions), aug-cc- pvdz (86 basi functions, abbrevi accd), 6-311++g(2d,2p) (98 basi functions), aug-cc-pvtz (210 basi functions, abbre- viat acct). molecular orbit initi assign huckel guess. transition-st optim perform specifi saddle-point computation. molecular electrostat po- tential (mep) comput chelpg methodolog [30] 0.3 point spacing. scf converg criteria 1.0 106 calculations. stationari point char- acter perform frequenc analyses; pro- ject hessian matric comput analyt method hf/sto-3g hf/6-31g(d) calcul seminumer method hf/accd, hf/acct, mp2 calculations. gamess-u [31,32] softwar perform quantum- mechan calculations. 2190 d. reith, k.n. kirschner / physic commun 182 (2011) 21842191 4.2. parameter initi structur creat pymol [8], save pdb file convert gamess-u format open babel [33,34]. potenti energi function form molecular mechan optim seen eq. (1) [35]. scale factor 14 nonbond (i.e. fscnb) electrostat (i.e. fscee) interact set unity. previous discuss [9], possibl molecular typolog atom 14 15 (or greater) interact equidistant. experiences, paramet develop 14 scale factor lead valu appear chemic intuitive. torsion phase angl ( ) constrain zero, unnecessari fit torsion profiles. nonbond cutoff radiu set 100 , encompass methanol molecular diameter. etot = bond kr(r req)2 + angl k ( eq)2 + dihedr vn 2 [ 1 + cos(n )] + natom b>a ( ab fscnb [( ab rab )12 2 ( ab rab )6] + fscee ( qaqb 40rab )) . (1) resp-deriv partial atom charg [11,12] comput fit hf/acct mep (step 6) (i.e. resp hf/acct c , defin be- low). multipl molecular orient comput mep [30,36]. restraint weight 0.001 calcu- lation, partial atom charg methyl hydrogen constrain zero fit [9]. mep resp calcu- lation perform aid r.e.d. iii algorithm, ensur partial atom charg reproduc (step 7) [13]. larg restraint 15 000 kcal mol1 appli degre freedom frozen, follow 10 cy- cle steepest descent conjug gradient energi minim root-mean-squar converg criterion 0.01 kcal mol1 1 obtain (step 9). reliabl standard lennard-jon paramet taken opl forc field [24], enabl wolf2 pack user focu optim intramolecular degre freedom. however, intermolecular degre freedom need optim order obtain best forc field possibl achieve. purpose, successfulli develop publish grow workflow tool [19]. bond length, bond angle, tor- sion paramet optim manual adjust redo mm restrain optimization. rel energet geometri assess time optim paramet solut best fit qm experiment data (step 10). structur root-mean-squar deviat (rmsd) de- termin referenc restrain molecular-mechan ge- ometri correspond quantum geometri ptraj program [35]. addit resp partial atom charg develop hf/sto-3g, hf/6-31g(d), hf/accd, mp2/6-31g(d), mp2/accd, mp2/acct comput meps. differ approach im- plemented, involv uniqu method charg methyl hydrogen determin final charg set. method repres possibl approach assign charg chemic equival atom (e.g. methyl hydrogen). method a, atom consid uniqu (i.e. chemic distin- guishable) resp fitting. method b undergo resp fit method a, follow posteriori aver- ag methyl hydrogen charges. method c methyl hydrogen constrain partial atom charg zero resp fitting. finally, method d methyl hydrogen restrain equival charg resp fit- ting procedure. result charg set indic respqmmepmethod nomenclature; example, resp hf/631g(d) c indic resp charg determin hf/6-31g(d) mep methyl hydrogen forc zero fit procedure. applic two-stag resp calcul utilized, restraint 0.0005 stage 0.001 second stage [11,12]; singl restraint 0.001 used. amber 9 program packag molecular me- chanic calcul [35]. gnuplot gener bond stretching, angl bending, torsion rotat curv [17]. py- mol gener structur figur [8]. 5. conclus forc field repres multiscal bridg connect high- resolut quantum mechan coarser molecular mechan base models. serv fundament compon molecu- lar mechan molecular dynam (md) simulations, forc field describ intra- intermolecular interactions. such, continu need improv force-field de- velop result performance. creat expert-driven scientif workflow nicknam wolf2 pack, in- corpor belief qm-gain knowledg transfer mm models. wolf2 pack allow effici optim forc fields, enabl focu better scien- tific challeng surround force-field develop given research problem. articl outlin wolf2 pack methanol case studi exemplifi scientif workflow. currently, wolf2 pack written java code shell scripts. mysql organ molecular database. futur intend includ version grow wolf2 pack opti- mize nonbond parameters. optim methanol gas-phas forc field present here, initi structur building, resp investiga- tion, final optim paramet took approxim 3 work days. accomplish singl desktop com- puter amd athlon (tm) 64 x2 dual core processor 6000+ 4 gb memory. base past experi force-field development, work easili taken 2 weeks. therefore, signific speed-up achiev small molecule. however, greater speed-up com- plicat molecul inhabit potenti sourc error easili envis (e.g. molecul mix chemic functionalities). case study, preform detail investi- gation determin resp-deriv partial atom charg hf, mp2, varieti basi sets. comparison experiment dipol moment magnitud orientation, resp charg allow atom fit independ pro- vide best result (i.e. method a). however, charg equival chemic equival atom advantag md simula- tion creat transfer forc fields. end, us hf/acct mep restrict methyl hydrogen zero charg provid best agreement ex- periment. acknowledg like thank thoma brand help discuss concern dipol moment calculations. thank jen nei- d. reith, k.n. kirschner / physic commun 182 (2011) 21842191 2191 siu nikla gehlen assist write java code improv script wolf2 pack. finally, extend thank anonym review provid informa- tive product feedback work writeup. refer [1] y. gil, et al., ieee 40 (2007) 24. [2] a. tiwari, a.k. sekhar, comput biologi chemistri 31 (2007) 305. [3] d. roure, c. goble, ieee softwar 26 (2009) 88. [4] j.-h. lii, unpublish program, distribut mm3 program. [5] j.m. wang, p.a. kollman, journal comput chemistri 22 (2001) 1219. [6] o. guvench, a.d. mackerel jr., journal molecular model 14 (2008) 667. [7] b. waldher, j. kuta, s. chen, n. henson, a.e. clark, journal comput chemistri 31 (2010) 2307. [8] delano scientif llc, pymol molecular graphic system, version 1.2r2, [9] k.n. kirschner, et al., journal comput chemistri 29 (2008) 622. [10] j.h. lii, b.y. ma, n.l. allinger, journal comput chemistri 20 (1999) 1593. [11] c.i. bayly, p. cieplak, w. cornell, p.a. kollman, journal physic chemistri 97 (1993) 10269. [12] w.d. cornell, p. cieplak, c.i. bayly, p.a. kollman, journal american chem- ical societi 115 (1993) 9620. [13] a. pigache, p. cieplak, f.-y. dupradeau, automat highli reproduc resp esp charg derivation: applic develop program red x red, in: 227th ac nation meeting, anaheim, ca, usa, march 28april 1, 2004. [14] f.-y. dupradeau, et al., physic chemistri chemic physic 12 (2010) 7821. [15] l.h. johnston, r.p. srivastava, r.m. lees, journal molecular spectroscopi 84 (1980) 1. [16] t. amano, journal molecular spectroscopi 88 (1981) 194. [17] h.b. broeker, et al., gnuplot version 4.2, patchlevel 3, 2007. [18] a. maa, l. nikitina, t. clees, k.n. kirschner, d. reith, molecular simul 36 (2010) 1208. [19] m. hlsmann, t. kddermann, j. vrabec, d. reith, physic communi- cation 181 (2010) 499. [20] m. hlsmann, j. vrabec, a. maa, d. reith, physic communica- tion 181 (2010) 887. [21] m. hlsmann, t. mller, t. kddermann, d. reith, molecular simul 36 (2010) 1182. [22] r. lees, j. baker, journal chemic physic 48 (1968) 5299. [23] k. kimura, m. kubo, journal chemic physic 30 (1959) 151. [24] w.l. jorgensen, d.s. maxwell, j. tirado-rives, journal american chemic societi 118 (1996) 11225. [25] s.j. weiner, et al., journal american chemic societi 106 (1984) 765. [26] w.d. cornell, et al., journal american chemic societi 117 (1995) 5179. [27] p. cieplak, w. cornell, c. bayly, p. kollman, journal comput chem- istri 16 (1995) 1357. [28] l.f. kuyper, r.n. hunter, d. ashton, k.m. merz jr., p.a. kollman, journal phys- ical chemistri 95 (1991) 6661. [29] d.e. williams, journal comput chemistri 15 (1994) 719. [30] c.m. breneman, k.b. wiberg, journal comput chemistri 11 (1990) 361. [31] w.m. schmidt, et al., journal comput chemistri 14 (1993) 1347. [32] m.s. gordon, m.w. schmidt, advanc electron structur theory: gamess decad later, in: m.s. gordon, m.w. schmidt, c.e. dykstra (eds.), theori applic comput chemistry: years, elsevier, ams- terdam, boston, 2005, pp. 11671189. [33] rajarshi guha, m.t. howard, et al., journal chemic inform mod- el 46 (2006) 991. [34] open babel package, version 2.2.0, 2008. [35] d.a. case, et al., amber 9, 2006. [36] j.r. woods, m. khalil, w. pell, h.s. moffat, h.v. smith, journal comput chemistri 11 (1990) 297. modern workow force-eld develop - bridg quantum mechan atomist comput model 1 introduct 2 scientic workow & case studi 2.1 workow 2.1.1 workow step 1-3: foundat setup 2.1.2 workow step 4 5: qm-constrain geometri energi 2.1.3 workow step 6 7: determin partial atom charg 2.1.4 workow step 8: gener classic model 2.1.5 workow step 9: mm-constrain geometri energi 2.1.6 workow step 10: paramet optim 2.1.7 workow step 11: valid 3 highlight resp-deriv partial atom charg 4 technic detail case studi 4.1 quantum mechan calcul 4.2 parameter 5 conclus acknowledg refer