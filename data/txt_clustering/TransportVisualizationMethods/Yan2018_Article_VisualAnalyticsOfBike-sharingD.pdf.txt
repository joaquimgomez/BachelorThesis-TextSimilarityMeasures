































































































Visual analytics of bike-sharing data based on tensor factorization


REGULAR PAPER

Yuyu Yan • Yubo Tao • Jin Xu • Shuilin Ren • Hai Lin

Visual analytics of bike-sharing data based on tensor
factorization

Received: 31 August 2017 /Accepted: 30 November 2017 / Published online: 10 February 2018
� The Visualization Society of Japan 2018

Abstract Bike-sharing systems have grown tremendously worldwide in the recent years. Understanding the
user activities in urban areas is invaluable, especially for bike rebalance and urban planning. However, it is
difficult to directly capture the user activity patterns from the bike-sharing data due to its sparse and
discontinuous characteristics. In the recent years, many methods have been explored to visualize the user
activity patterns. Many previous methods focused on visually presenting the temporal and spatial distri-
bution directly. In this paper, we construct a tensor based on the spatial, temporal, and user information of
the bike-sharing data, and employ tensor factorization to extract latent user activity patterns. To facilitate the
users to analyze and understand these patterns, a visual analytics system is designed to interactively explore
these patterns from the spatial, temporal, and user dimensions and compare these patterns in/between cities.
We demonstrate the effectiveness of our system via case studies with real-word datasets.

Keywords Bike-sharing systems � Visual analytics � Tensor factorization

1 Introduction

To promote environmental sustainability, bike-sharing systems are widely deployed in more than 700 cities
worldwide, such as New York, Paris, and Beijing. The bike-sharing system is a service to make bicycles
available for shared use to individuals on a very short term basis. Bike-sharing schemes allow the people to
borrow a bike from station ‘‘A’’ and return it to station ‘‘B’’. Bike-sharing systems offer an environment
friendly solution for the ‘‘first-and-last mile’’ connection for short and long distance destinations. In addi-
tion, it is convenient for users to transfer between nearby places. For example, a user can check out a bike
and ride to his destination when he gets off the subway. Meanwhile, it is a good way to avoid jams. The
bike-sharing system is usually used by users for commuting, recreation, and shopping. When checking out/

Y. Yan � Y. Tao (&) � J. Xu � S. Ren � H. Lin
State Key Lab of CAD&CG, Zhejiang University, Hangzhou, China
E-mail: taoyubo@cad.zju.edu.cn

Y. Yan
E-mail: yanyuyu001@gamil.com

J. Xu
E-mail: jinxcoder@gmail.com

S. Ren
E-mail: shuilinren@foxmail.com

H. Lin
E-mail: lin@cad.zju.edu.cn

J Vis (2018) 21:495–509
https://doi.org/10.1007/s12650-017-0463-1

http://orcid.org/0000-0002-0378-0060
http://crossmark.crossref.org/dialog/?doi=10.1007/s12650-017-0463-1&amp;domain=pdf
http://crossmark.crossref.org/dialog/?doi=10.1007/s12650-017-0463-1&amp;domain=pdf
https://doi.org/10.1007/s12650-017-0463-1


in a bike, a user is required to swipe a radio-frequency identification card. This will generate a record,
consisting of start/end station, start/end time, riding time, bike ID, and user ID.

The bike-sharing system finds it often difficult to meet the demands of the users, because the bike usage
is skewed, by changing over the time and locations. Consequently, some stations may have no bikes
available for the users, while some stations have no empty return piles. Thus, the bike-sharing system faces
challenges in bike rebalance between the stations. From the bike-sharing data, we can explore the user
activity patterns, which are helpful to guide the bike station placement and the bike schedule. Moreover, we
can study the urban structures from these patterns in the bike-sharing data, and this is important for urban
planning, such as avoiding traffic congestion.

The bike-sharing data is a mixture of user activity patterns, so that we can infer the latent user activity
patterns by analyzing the bike-sharing data. However, user activity patterns are explicit, dynamic and
context-dependent. How to find and to make use of the latent user activity patterns is challenging for the
bike-sharing data. There are already some works about exploiting the latent activity patterns in bike-sharing
data. Chen et al. (2015) first detected bike usage anomalies in each bike station via the temporal infor-
mation, and then aggregated these anomalies via the spatial distance between the stations. They further
proposed a tensor cofactorization-based data fusion framework Chen et al. (2016) to detect urban events
from bike-sharing data and Foursquare check-in data. The activity patterns are simply presented by a heat
map, a line chart and word clouds. They did not provide an interactive visual analytics system to assist the
users in exploring these patterns, and they also did not consider the user information in bike-sharing data.
Wood et al. (2011) proposed a visualization system with origin–destination maps, flow maps and gridded
views to show the bike demand trend along with time and space. It is easy to analyze the temporal and
spatial distribution of entire data, but difficult for the users to find latent activity patterns from the global
distribution.

In this paper, we propose an interactive visual analytics system designed for exploring the latent user
activity patterns in bike-sharing data and comparing these patterns in/between cities. To discover the latent
user activity patterns, we first construct a tensor to capture the spatial, temporal, and user information of the
bike-sharing data, and then decompose this tensor into several latent user activity patterns. In this way, we
can discover spatial, temporal and user patterns simultaneously. Since it is hard to determine the number of
patterns, we hierarchically cluster these patterns from the spatial, temporal, and user dimensions, respec-
tively. This facilitates the users to explore the similarity between patterns. To assist the users in under-
standing and exploring the latent user activity patterns, we designed multiple coordinated views to visualize
the spatial, temporal, user dimensions, and similarity of patterns. In particular, the main contributions of this
paper are as follows:

– We propose a tensor model to represent the bike-sharing data and introduce a tensor factorization
method to capture the latent activity patterns from bike-sharing data.

– For visualizing the spatial, temporal, and user dimensions, we designed multiple coordinated views to
analyze the latent user activity patterns and to compare the different patterns.

– We developed an interactive visual analytics system leveraging activity analysis algorithms and
visualization techniques to assist the users in exploring the latent user activity patterns effectively.

2 Related Work

Our work is related to tensor factorization, user activity analysis, and trajectory data visualization.

2.1 Tensor factorization

Tensor factorization, first introduced by Hitchcock (1927), can be regarded as a generalization of the matrix
singular value decomposition (SVD) from matrices to tensors. Based on the work of Hitchcock, Tucker
(1966) proposed Tucker decomposition, which decomposes a tensor into a set of matrices and one small
core tensor. Later, Carroll et al. Carroll and Chang (1970) and Harshman Harshman (1970) proposed
CANDECOMP and PARAFAC decomposition, respectively, which decomposes a tensor into a linear
combination of finite rank-1 tensors. Tensor factorization has been widely used in recommendation systems,
data compression and signal processing, etc. Kolda and Bader Kolda and Bader (2009) provided a survey of
high-order tensor factorizations, their applications, and the available softwares.

496 Y. Yan et al.



2.2 User activity analysis

In user activity analysis, researchers have exploited different types of digital footprints. For location-based
social network (LBSN) user activity, Liang et al. (2013) modeled the size, duration, and temporal dynamics
of the short-lived crowds formed in user activities. However, the user-contributed LBSN data are often noisy
and incomplete. Zhang et al. (2015) extracted the human flow dynamics from taxi traces and proposed a
probability-based method to detect the happening time, venue and the scale of events from abnormal user
activities. Taxi traces can only represent a part of the user activities. For short trips, people more likely ride
to their destinations. Chen et al. (2015) proposed a two-phase framework to identify the social activities in
urban activity centers based on bike-sharing data via detecting bike usage anomalies in each bike station.

In addition, there are many researches using tensors to explore the user activities, which can discover
spatial and temporal patterns simultaneously. Wang et al. (2014) proposed a order-3 tensor model based on
the origin area, destination area and time domain for taxi trajectories and adopted Tucker decomposition to
discover the spatial clusters, temporal patterns and relations among them simultaneously. Yang et al Yang
et al. (2015) employed non-negative tensor factorization to collaboratively infer temporal activity prefer-
ence in LBSN. Chen et al. (2016) proposed a tensor cofactorization-based data fusion framework for fine-
grained urban event detection for bike-sharing data and Foursquare check-in data. They constructed a crowd
mobility tensor from bike-sharing data with the spatial and temporal dimensions. In this paper, we further
consider the user attributes, as different kinds of users may have different user activities. We also develop a
visual analytics system to help the users better explore and understand activity patterns.

2.3 Trajectory data visualization

Directly drawing trajectory data is the basic visualization method, including using polygonal lines to
visualize the trajectory Liu et al. (2011), describing the spatial and temporal features with the timelines
Wang and Yuan (2014), harnessing parallel coordinates to visualize the multi-dimensional aspects of the
trajectory Guo et al. (2011). When the amount of trajectories is large, spatio-temporal aggregation visu-
alization is more suitable. It can reduce the visual clutter and the uncertainty in discontinuous trajectories.
Andrienko et al. (2012) utilized visual analytics methods to explore and understand the temporal variation
of spatial situations derived from episodic movement data by means of spatio-temporal aggregation. To
better visualize dense many-to-many flows, Yang et al. (2017) designed MapTrix to combine the origin–
destination matrix and flow map representations, and overcome the clutter associated with a traditional flow
map, while providing geographic embedding that is missing in standard origin–destination matrix repre-
sentations. Jiang et al. (2015) designed a visual analysis system for big taxis O/D data via heat map view,
circular pixel graph, spatio-temporal stacked graph and nested pixel bar. Similarly, Lu et al. (2016) pre-
sented a visual analysis system to explore origin–destination patterns of interested regions based on taxi
trajectories. For bike-sharing data, Wood et al. (2011) presented three visualization methods of hired bicycle
use and travel patterns for London’s bicycle system. A design study using visualization techniques for bike-
sharing systems is described in Wood et al. (2004).

Moreover, some works visualize activity patterns in trajectory data via data mining algorithm (such as
PCA, and bayesian networks) to discover latent patterns. Wang et al. et al. (2013) proposed traffic jam
propagation graphs to extract and derive traffic jam information, which forms a high-level description of a
traffic jam and its propagation in time and space. They presented multiple views to visually explore and
analyze urban traffic congestion. Liu et al. (2017) presented an interactive visual analytics system to deal
with the problem of formulating solutions immediately and comparing them rapidly for billboard place-
ments. To extract the semantic information of GPS trajectories, Chu et al. (2014) transformed the taxi
trajectories as a document consisting of the taxi traversed street names, then used taxi topic maps, topic
routes, street clouds and parallel coordinates to visualize the probability-based topical information extracted
by topic model. Dohuki et al. (2017) further presented a method for managing and visualizing taxi trajectory
data in an intuitive, semantic rich, and efficient means through a textualization transformation process. Liao
et al. (2015) proposed a semantic-enhanced interactive visualization system, which categorizes the daily
activities of suspects into different semantic types by connecting trajectory data with transaction data. In
addition, Wu et al. (2017) utilized non-negative matrix factorization (NMF) to extract the latent activity
patterns from three types of heterogeneous mobility data (taxi trajectories, metro passenger radio-frequency
identification card data, and telco data). Chen et al. (2015) provided an overview of related data processing
techniques, and summarized the existing methods for depicting the temporal, spatial, numerical, and

Visual analytics of bike-sharing 497



categorical properties of traffic data. To understand the multiple aspects of activity patterns, our tensor
model is based on the spatial, temporal, and user information of the bike-sharing data. Thus, besides the
spatial and temporal dimensions, our visual analytics system also supports the visual exploration of user
information in activity pattern and the comparison between patterns in/between cities (Fig. 1).

3 Overview

The bike-sharing data contains the trip records consisting of start/end station, start/end time, bike ID, and
user ID. Based on the global statistics of bike-sharing data, it is extremely hard and unintuitive for users to
discover the user activity patterns hidden in the data, since activity patterns may be explicit in multiple
stations, dynamic over time, and dependent on users. User activities may be affected by the location, time
and user type. For example, bicycles are more likely to be the vehicles for eating, shopping and getting off
work in the downtown at 7 o’clock in the evening. Hence, we should analyze the user activity patterns from
the aspects of space, time and user. Since the number of patterns may be still too large for users and some of
the patterns may be similar, it is helpful to provide a hierarchical structure of the patterns for users. Thus, the
users can browse the organized structure of patterns. According to the requirements above, we describe the
following tasks for our system:

T1: Activity pattern extraction The bike-sharing data contains a mixture of user activity patterns. The user
activities may be affected by the location, time and user type. So, we
should construct a suitable model from these aspects to infer the latent user
activity patterns from the bike-sharing data. These patterns should capture
user activities comprehensively.

T2: Activity pattern understanding Users should be able to capture the detail of activity patterns. The
detail information contains spatial, temporal and user dimensions.
Moreover, users can easily and quickly understand pattern distribu-
tions from the pattern representations.

T3: Pattern comparison For the obtained latent user activity patterns, it is necessary to compute the
similarity between these patterns and organize these patterns, so that users can
know what patterns are contained in the bike-sharing data effectively. In

Fig. 1 System overview , a The age distribution view displays the age distribution of bike records. b The pattern relation view
visualizes the hierarchical clustering result of the patterns in one dimension. c The control panel provides a set of operations for
the users. d The map view presents a overview of spatial distribution of bike-sharing data and patterns. e The pattern time view
illustrates the temporal distribution of patterns. f The stacked view shows the temporal distribution in a week of different ages.
g The dashboard view presents the detail of the age distribution of each pattern

498 Y. Yan et al.



addition, we can better understand these patterns by comparing several
interesting patterns from the aspects of space, time and user.

With the above tasks in mind, the visual analytics pipeline is shown in Fig. 2. According to the task T1, we
should analyze the user activity patterns from the aspects of space, time and user. Thus, we construct a
tensor based on spatial, temporal and user dimensions. Meanwhile, tensor factorization can discover spatial,
temporal, and user patterns simultaneously, and it considers the relationship between each dimension. The
latent user activity patterns have three dimensions. Our system should provide multiple coordinated views to
visualize the spatial, temporal, and user distribution of patterns (T2), so that the users can easily capture the
activity patterns in the bike-sharing data. For the task T3, we hierarchically cluster the extracted patterns
from the spatial, temporal, and user dimension, respectively, and visualize the hierarchical clustering tree to
provide a hierarchical structure to assist the users in browsing patterns.

4 Activity pattern extraction

In this section, we describe how to construct a tensor from bike-sharing data and use tensor factorization to
extract the latent user activity patterns from bike-sharing data.

4.1 Tensor construction

The bike-sharing data records are composed of start/end time, start/end station, bike ID, and user ID. We can
obtain the user information for the records according to the user ID. We consider the bike record as a flow,
which flows out the start station and flows in the end station. Before we extract the activity patterns, we need
to find a suitable data structure to represent the bike flow. When analyzing the relationship between two
discrete attributes (for example, spatial and temporal), a matrix is commonly the first choice. However, user

Fig. 2 The visual analytics pipeline for the latent user activity patterns in bike-sharing data. Our system mainly contains data
analysis module and visual analytics module

Fig. 3 The outflow of adjacent stations and a region. a Map View. We select a region that contains station A and station B. b
The outflow of A station. c The outflow of B station. d The outflow of the region

Visual analytics of bike-sharing 499



activities are not only affected by location and time, but also by the users themselves. Thus, we introduce a
tensor to model the relationship among the spatial, temporal and user dimensions.

For the spatial dimension, bike stations are distributed on eac street of the city. Due to the influence of
the adjacent stations, there is contingency in the bike usage of each station. Fig. 3 shows the number of
outflows of the two adjacent stations A and B in New York in a week. The difference between the two
stations is large, and it is also hard to discover the temporal pattern. From Fig. 3d, we can see that the bike
outflow of the region periodically regularly changes over time, and the outflow is relatively stable. It is
difficult to find periodic trends in a single station, since it is highly dynamic and context-dependent.
Although users usually select a station near their starting point/destination to loan/return the bike, the users
will go to the stations nearby to loan/return the bikes if the station is empty or full. This will affect one
station, but not the region around the station. Thus, we use regions instead of stations as the spatial
dimension in our tensor.

We adopt the spectral clustering algorithm to divide the area of a city into multiple regions. The
clustering should not only consider the neighboring relation in the geographic space, but also the bike flow
of stations. Therefore, the similarity between the two stations is the combination of the geographic distance
and bike flow vector distance which is as follows:

Dði; jÞ ¼ w� distði; jÞ þ ð1� wÞ � cosðFii;FijÞ þ cosðFoi;FojÞ
� �

ð1Þ

where Fii and Foi is the inflow and outflow vector of station i, the distance between the two flow vectors is
measured by the cosine distance. dist (i, j) is the geographic distance between the stations. We standardize
the station positions and flows by removing the mean and scaling to unit variance. And w is the weight to
balance the geographic distance and flow vector distance. As the stations in a region should be close to each
other, the parameter w is set to 0.7 in this paper. We find this value can balance the geographic distance and
bike flow vector distance well. The number of regions has a great impact on the activity pattern extraction.
When the number of regions increases, the region area becomes smaller, the randomness increases, and the
dimensions of the tensor become larger. Thus, the number of regions is 50 in our implementation. The
clustered regions in New York and Chicago are shown in Fig. 4(a)(b).

For the temporal dimension, we adopt one hour as the time interval, since we mainly focus on the users’
daily activity patterns in bike-sharing data. The user behavior is usually stochastic, when the time interval is
one minute or second. Thus, it is useless to measure the sustainability of an activity in the granularity of
second or minute, since the user activities are periodical. In this paper, we explore the periodical user
activity regularity in one week. So, the period in this paper is one week, and the temporal range in the tensor
is 1 week, i.e., 168 h.

For the user dimension, public bike-sharing data usually only provides part of the user information due to
privacy. The birthday is usually provided in public bike-sharing data, such as New York and Chicago. Thus,

Fig. 4 The clustering result of bike stations and bike spatial distribution of loan activity in summer. a The clustering result of
bike stations in New York. b The clustering result of bike stations in Chicago. c Bike spatial distribution of New York. d Bike
spatial distribution of Chicago

500 Y. Yan et al.



we use the user age of each record as the third dimension in our tensor, and limit the age range from 16 to
80 years old.

Thus, we choose the region, hour, and age as the spatial, temporal, and user dimension, respectively.

Spatial dimension: We cluster bike stations to Nr regions r ¼ ½r1; r2; :::; rNr �, Nr ¼ 50 in our
implementation..

Temporal dimension: We divide a week into hours t ¼ ½t1; t2; :::; tNt �, Nt ¼ 168.
User dimension: We select the age as the user dimension. We limit the age scale from 16 to 80 years old

a ¼ ½a1; a2; :::; aNa �, Na ¼ 65.

Based on the three dimensions, we construct an order-3 tensor X 2 RNr�Nt�Na . We summarize the
number of the bike loan/return for each region ri, time tj and age ak, and the sum is the value of X(i, j, k),
i.e., the activity in the ith region, the jth time interval and at the age 16þ k.

4.2 Tensor factorization

The bike-sharing data is a mixture of basic patterns, and it is difficult to extract useful information from such
a mixture pattern directly. Due to the relationship among the spatial, temporal and age dimension, it is
usually error-prone to directly extract activity patterns according to one dimension. Tensor factorization can
decompose a tensor into low-rank latent factors, and it considers the relationship among the dimensions. As
illustrated in Fig. 5, each factor is a rank-K matrix, where K denotes the number of latent patterns. Thus, we
obtain region factor R 2 RNr�K , the time factor T 2 RNt�K , and the age factor A 2 RNa�K . Since the sum-
mary of bike-sharing data is non-negative, we employ the non-negative tensor factorization method
CANDECOMP (CP) to decompose the tensor X as follows:

bX ¼ b; �R R�T T�A A ð2Þ

where �n denotes the mode-n tensor product with matrix. The core tensor b; with dimension K � K � K
handles the correlation among the different factors. For the sake of simplicity, we set b; as a diagonal tensor.

b; ¼
1; if br ¼ bt ¼ ba

0; else

(

where br , bt, ba are indices of the three dimensions of tensor b;, and b; is the element of tensor b;. Since tensor b;
is a diagonal tensor, the values of each element of bX can be represented as:

bXr;t;a ¼
XK

k¼1
Rðr; kÞ � Tðt; kÞ � Aða; kÞ ð3Þ

In other words, bX can be approximately represented as the sum of a number of basic patterns:

bX ¼
XK

k¼1

bX
ðkÞ

¼
XK

k¼1
Rk � Tk � Ak ð4Þ

X

�me

re
gi

on ≈ Rregion

K

O 

�me

K T O A

K

Fig. 5 Tensor factorization

Visual analytics of bike-sharing 501



where Rk is the kth dimension of the region factor R, Tk is the kth dimension of the time factor T, Ak is the
kth dimension of the age factor A. bX

ðkÞ
is the kth basic pattern. Through CP tensor decomposition, we obtain

K basic patterns, each corresponding to a set of user activities. The basic pattern can be represented as a
cross product of the three factors.

4.3 Pattern hierarchical clustering

The number K of basic patterns is selected by root-mean-square error (RMSE). As the number of basic
patterns becomes larger, the value of RMSE becomes smaller.

RMSE ¼

ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi
P bXðr; t; aÞ � Xðr; t; aÞ

� �2

x

v
u
u
t ð5Þ

Usually, we select a large number for K to better capture all the activity patterns, as it is difficult for users to
find the similarity and difference between patterns when K is large. To discover the relationship between
these patterns, we employ the hierarchical clustering algorithm to each dimension of the patterns. For a
pattern bX

ðkÞ
, we can use Rk, Tk, and Ak components to describe the user activity preference over region,

time and age. For example, we can generate the time similarity of each pattern, according to the temporal
dimension of the patterns. We first normalize Tk of each pattern:

XNt

t¼1
Tðt; kÞ ¼ 1 ð6Þ

After normalization, we consider Tk as the time distribution of the patterns. When the peaks of distributions
are closer, the distributions are similar. For example, two distributions only have peaks at noon. We consider
the two distributions are similar, no matter whether the value of peaks varies greatly. So the Jensen–Shannon
divergence and KL divergence are not suitable. Since the value of Tk is non-negative and normalized, we
define the distance between patterns as follows:

D0ðk1; k2Þ ¼ 1�
XNt

t¼1
minðTðt; k1Þ;Tðt; k2ÞÞ 0\k1; k2\ ¼ K ð7Þ

We calculate the overlap interval of the two time distributions to measure the similarity between the time
distributions. In a similar way, we calculate the distribution and distance of the spatial and age dimensions.

5 Visual design

Based on the extracted latent user activity patterns, we design a visual analytics system to visually explore
and compare the latent user activity patterns. The global distribution of bike-sharing data should be pre-
sented to provide an overview. The hierarchical structure of the patterns in each dimension can facilitate the
users selecting patterns of interest. The spatial, temporal and user factors of each activity pattern should be
displayed for detailed analysis and comparison.

As shown in Fig. 1, the user interface of our system consists of a set of views, including (1) The age
distribution view displays the age distribution of bike-sharing data; (2) The pattern relation view visualizes
the hierarchical clustering result of patterns to assist the users in browsing the patterns; (3) The map view
illustrates the urban area to be studied, bike station position, as well as the spatial distribution of the entire
data and patterns; (4) The pattern time view shows the temporal distribution of patterns. (5) The stacked
view presents the temporal distribution in a week of different ages. (6) The dashboard view shows the age
distribution of each pattern.

5.1 Global views

The global view contains the map view, age distribution view, and the stacked view. These views show the
global attribution. The age distribution view is shown in Fig. 1a, where the horizontal axis is the age and the
vertical axis is the bike loan/return amount. The stacked view shows the quantity of bike flow in a week of

502 Y. Yan et al.



different ages. It is encoded by the stacked graph, as Fig. 1f shown. The color of the stacked bar is related
with the age from light green to dark green, similar to the color of leaves in the life cycle. When no pattern is
selected, the map view shows the number of bike flows over the regions via heat map.

5.2 Pattern relation view

We can obtain multiple activity patterns from bike-sharing data by tensor factorization. We usually select a
large latent activity pattern number K, so it is necessary to adapt hierarchical clustering to organize the
patterns in hierarchical structure. It is helpful for users to browse the patterns and find interesting patterns. In
addition, we select the sunburst graph to visualize the hierarchical clustering result, as shown in Fig. 1b. It
uses less space and can better represent the hierarchical structure. The color of each outer ring corresponds
to the pattern color in the pattern time view. The color of each inner ring is related to the hierarchy, from
interior to exterior. The hierarchical clustering is based on a dimension of patterns, such as temporal, spatial,
user dimension. So, the users can select a dimension of patterns to explore the corresponding hierarchical
clustering result. From the relationship between the activity patterns, the users can select patterns of interest
from the sunburst graph. When one node is selected, the patterns associated to the node are added to the
selected patterns, and the other views are updated to display their spatial, temporal and age distributions.

5.3 Activity pattern views

The patterns obtained from tensor factorization have three dimensions. To explore these three dimensions
intuitively, we designed multiple coordinated views for the spatial, temporal and age dimensions.

5.3.1 Spatial dimension

The map view displays the geographic information from the OpenStreetMap OpenStreetMap contributors
(2017). Bike-sharing data not only contains the bike record information, but also includes the geographic
position of bike stations. Thus, we display the stations as points on the map. Each region from the clustering
in Sect. 4.1 is encoded by different colors. The heat map shows the activity distribution of each region.

To analyze the stations in a region, our system allows the users to select their interested region. The
region is selected by a polygon via clicking. The stations in the selected region are labeled with red color.
The border of the selected region is encoded with blue color, and the interior of the region is filled with light
blue. According to the selected region, our system will compute the inflow and outflow of the stations in the
region. As shown in Fig. 2a, the horizontal axis is the user age, the vertical axis is the number of records, the
orange line represents the number of loan records, and the blue line represents the number of return records.
Through the chart, we can see the bike usage trend over age. Moreover, our system provides a heat map to
display the outflow of the selected region according to the records from interior stations to the other stations.

5.3.2 Temporal dimension

The pattern time view illustrates the temporal distribution of patterns, as shown in Fig. 1(e). Time is an
important factor for patterns. Many activities, such as commuting and eating, have obvious time charac-
teristics. For a pattern, the time characteristics between weekdays and weekends has a great difference.
Hence, we select a week as the time range to present the temporal dimension of patterns. The temporal
dimension of patterns is encoded by the curve lines. The horizontal axis represents 168 h in a week. The
vertical axis is the normalized value of Tk. The color of curve corresponds to the color of the pattern. The
left side of the pattern time view is a pattern list. Users can select a pattern through the checkbox before the
pattern name in the list. In addition, we can see the previous selected patterns in this list.

5.3.3 User dimension

For the user dimension, we design a dashboard view, as shown in Fig. 1g. Each dashboard represents an age
distribution of a pattern. The user age increases along the clockwise direction, and we label age ticks around
the dashboard. The color is mapped with the user age like the green leaf life cycle changing from light green
to dark green, the same as the stacked view. The bar on the inner ring shows the age distribution value,

Visual analytics of bike-sharing 503



which is obtained by normalizing the k dimension of the age factor Ak. The color of the circle center
corresponds to the pattern color.

5.4 Interaction

We provide the users with rich interactions to navigate through data for a comprehensive analysis. Our
system supports the following interactions:

Merging: Users can select a single pattern or multiple patterns for a detailed analysis or visual com-
parison. The tensor factorization is not perfect. Thus, we may find some similar patterns that can be
combined during the process of analysis. For example, Fig. 6 shows the pattern time view of pattern 1 and
pattern 2, and we can see the temporal distribution of these two patterns is almost the same. As a result, we
can combine these two patterns into a group by the merge operation.

Filtering: Our system allows the users to select patterns of interest in the hierarchical structure of patterns
in the pattern relation view. Moreover, we offer a brush operation to select a time range for the temporal
dimension in the pattern time view. When the users select a time range on the time axis, our system will
update the other views according to the selected time range. We also provide the filter operation for the user
dimension through the age slider. Users can also select the region of interest as discussed in Sect. 5.3.1. In
summary, our system supports filtering by region, time, age and pattern.

Highlight: When hovering the mouse over a node of the sunburst graph, the upper layers of the node will
be highlighted and the patterns of the node will be displayed in the other views.

Zooming and Panning: Zooming and panning are supported in the map view. Users can scroll the mouse
wheel to zoom and drag the mouse to pan to have a good view of the map.

5.5 System implementation

Our system is based on the browser/server mode, which is easier to share and access. The server side is
implemented by the java servlet framework. For the browser side, we use Bootstrap as the web front
framework and Query to implement control. For the visualization module, we use D3 Bostock et al. (2011)
to implement the user interface and the map is created by the leaflet library.

6 Case study

We used two datasets to demonstrate the effectiveness of our system: New York and Chicago public bike-
sharing data. The time can be divided into two stages: the summer from July 2015 to September 2015, and
the winter from December 2015 to February 2016. Each stage has the records of 84 days. Each record
contains start/end time, start/end station, bike serial number, and user ID. We select the records whose user
age is between 16 and 80 years old. The number of public bike stations in New York in 2015 is 460. These
stations cover the main area of New York. According to the distance and flow similarity of the stations, we
cluster these stations into 50 clusters. The data contains 2,708,624 records in summer, and 1,874,477 records
in winter. The number of public bike stations in Chicago is 475, and the number of records is 947,563 in
summer. For the case study, we select the outflow of stations in our tensor construction. In other words, we
analyze the user rental activity.

Fig. 6 Pattern operation

504 Y. Yan et al.



6.1 Global distributions

Our system not only provides pattern analysis, but also the global analysis of bike-sharing data. We employ
a heat map to show the spatial distribution. Fig. 4c, d shows the number of bike outflow in New York and
Chicago in summer. From the figure, we can see the main check-out area of New York is in Manhattan and
the transportation hubs near Manhattan. The main region of Chicago is near Ogilvie Transportation Center,
Humboldt Park and the lake.

The stacked view in Fig. 2b provides an overview of bike activity over age and time, from which we can
see that the number of rental records of weekdays increases from 7 to 10 and about 6 o’clock in the evening.
We can infer that the users ride bikes for commutation on weekdays. On weekends, users probably ride the
bikes outside. Thus, the number of records increases in the morning and decreases in the evening. The bar in
the lower layer represents younger users, which is also labeled by the gradient colors. We can find that users
of the bike-sharing system are almost all young people.

6.2 Pattern analysis of New York

We select the summer data of New York first. Fig. 1b shows the hierarchical structure of the patterns
according to the temporal dimension. We hover the mouse over the node of the sunburst graph to analyze the
detail distribution of patterns. We discover that these patterns can be roughly divided into weekday morning
patterns, weekday nightfall patterns, weekday allday patterns, and weekend patterns.

Weekday morning patterns: Fig. 1e shows the temporal distribution of weekday morning patterns, from
which we can see the peak of these patterns on weekdays is between 6 and 9 o’clock, and a little peak at
nightfall. From the map view in Fig. 1d, the main area of these patterns covers the most area of Manhattan
and traffic routes. For the user dimension (Fig. 1g), the user age has a wide distribution, mainly concen-
trating between 32 and 56 years old. These patterns may be related to working.

Weekday nightfall patterns: Fig. 7a displays the weekday nightfall patterns of New York. The common
characteristics of these patterns is that the peak appears near 6 o’clock in the evening on the weekday. The
age distribution of most patterns is between 24 and 64 years old. But, the age distribution of the fourth
pattern is mainly between 24 and 32 years old. It can be seen from the map view that the main area of these
patterns is near the route of transportation hubs, such as subway. Thus, we infer that these patterns are
related to people off work.

Weekday allday patterns: The patterns shown in Fig. 8 have bike records all the day. There are a large
number of records in the morning and at nightfall. Also, there are a small number of records at noon. The
main area of these patterns distributes near subway stations, park, etc. The age distribution is across all ages.
The main area of pattern A is near the Grand Central Terminal, pattern B is near the Pennsylvania Station in
New York, pattern c is near Washington Square and D is near Times Square. The main user age of pattern D
is between 24 and 32 years old, and the other patterns is larger than 32 years old. We can infer that these
patterns contain two kinds of activities: getting off trains, and after shopping.

Weekend patterns:
There are weekend patterns in the bike-sharing data, as shown in Fig. 9. The temporal distribution value

of weekends is larger than weekdays, and there are rental activities all the day on weekends. For the user
dimension, most of users are young people. The geographic location is near the central area of a city and
park area. Comparing with the distribution of New York in summer, the area in winter is more concentrated,

Fig. 7 Weekday nightfall patterns (a) New York summer (b) Chicago summer.

Visual analytics of bike-sharing 505



Fig. 8 Weekday allday pattern of New York summer

Fig. 9 Weekend patterns (a) New York summer (b) New York winter (c) Chicago summer

506 Y. Yan et al.



as shown in Fig. 9b. We infer that the user activity is more concentrated and less active due to the cold
weather and snow on roads.

Special patterns: There are some special patterns in the summer data of New York. As shown in
Fig. 10a, the age distribution of this pattern is concentrated around 20 years old, and the spatial distribution
is near Washington Square according to the heat map. It is near the New York University and Washington
University. From the pattern time view in Fig. 10a, we can see the difference of the rental trend of every day
is small. In addition, there is rental activity all day. The flow is smaller on weekends. Hence, we infer that
the users of this area may ride to class or parks.

These discovered patterns in New York demonstrate that our approach can effectively extract the latent
activity patterns, and our visual analytics system clearly shows the relationship between patterns and the
detailed spatial, temporal, and age distribution information.

6.3 User activity of different cities

To compare the user activities between different cities, we select public bike-sharing data of Chicago and
New York. In the aspect of climate, Chicago and New York both belong to the temperate zone. User
activities will be affected by cold weather, thus we select the summer data of the same period.

We browse the patterns of Chicago according to the pattern relation view (Fig. 2d). We find a similar
hierarchical structure of patterns in the two cities. Both have weekday morning patterns, weekday nightfall
patterns, weekday allday patterns, and weekend patterns.

Fig. 7b shows the weekday nightfall patterns in Chicago. From the map view, we can see that region A is
University of Illinois at Chicago, and region B is West Loop Gate. There are large stations in these two
regions. This is similar to New York. However, the age distributions have some difference. The age
distribution is mainly between 24 and 40 years old from the dashboard view in Chicago. For weekend
patterns, New York and Chicago are similar in spatial, temporal, and age distributions. In addition, the
special patterns in New York also appear in Chicago. As shown in Fig. 10b, the users of this pattern are
mainly young people. Area A is the Lincoln Park, which is the biggest park in Chicago. The pattern is
similar to Fig. 10a of New York in each dimension.

In summary, our system can effectively support the comparison of patterns in/between cities.

Fig. 10 Special pattern (a) New York summer (b) Chicago summer

Visual analytics of bike-sharing 507



7 Conclusion and future work

We present a visual analytics system to investigate the user’s daily activity patterns based on tensor
factorization from bike-sharing data. Since the activity in a station is dynamic and context-dependent, we
employ spectral clustering to group stations into regions. Then, we construct a tensor based on temporal,
spatial, and user dimensions and introduce tensor factorization to extract the latent user activity patterns. To
better capture the relation between patterns, we adopt hierarchical clustering to cluster the patterns. Then,
we designed a pattern relation view based on the sunburst graph to visualize the relation between patterns. It
can provide a structure of patterns to help users browse the patterns. In addition, we developed multiple
coordinated views to analyze and compare activity patterns in/between cities, such as pattern time view,
dashboard view and map view. Finally, we demonstrated the effectiveness of our system via case studies
with public bike-sharing data of New York and Chicago.

Bike-sharing data can not perfectly represent user activity patterns of a city. We plan to fuse different
data, such as taxi data and social media data. For each data, we can construct a suitable tensor to represent it,
and employ tensor cofactorization to capture the latent user activity patterns. In addition, the tensor in this
paper is an order-3 tensor. It can only describe the bike’s check-out activities or bike’s check-in activities.
Next, we plan to study these two activities simultaneously. We can extend our tensor to a order-5 tensor
based on start time, end time, start station, end station, and user age to better model user activities. In
addition, we intend to use more user information, such as gender and occupation. Moreover, the hierarchical
clustering of patterns is still not perfect. Some similar patterns are not clustered in a cluster. In the future, we
intend to provide interactions for the users to adjust the hierarchical clustering result.

Acknowledgements This work was partially supported by National Natural Science Foundation of China no. 61472354 and
61672452, NSFC-Guangdong Joint Fund no. U1611263, and the Fundamental Research Funds for the Central Universities.
Map data copyrighted OpenStreetMap contributors and available from https://www.openstreetmap.org.

References

Chen L, Yang D, Jakubowicz J, Pan G, Zhang D, Li S (2015) Sensing the pulse of urban activity centers leveraging bike
sharing open data. In: 2015 IEEE 12th Intl Conf on Ubiquitous Intelligence and Computing and 2015 IEEE 12th Intl Conf
on Autonomic and Trusted Computing and 2015 IEEE 15th Intl Conf on scalable computing and communications and its
associated workshops (UIC-ATC-ScalCom), p 135–142 (2015).

Chen L, Jakubowicz J, Yang D, Zhang D, Pan G (2016) Fine-grained urban event detection and characterization based on
tensor cofactorization. In: IEEE Transactions on Human-Machine Systems

Wood J, Slingsby A, Dykes J (2011) Visualizing the dynamics of london’s bicycle-hire scheme. Cartographica 46(4):239–251
Hitchcock FL (1927) The expression of a tensor or a polyadic as a sum of products. J Math Phys 6(1):164–189
Tucker LR (1966) Some mathematical notes on three-mode factor analysis. Psychometrika 31(3):279–311
Arroll JD, Chang JJ (1970) Analysis of individual differences in multidimensional scaling via an n-way generalization of

‘‘eckart-young’’ decomposition. Psychometrika 35(3):283–319
Harshman RA (1970) Foundations of the PARAFAC procedure: models and conditions for ‘‘explanatory’’ an multi-modal

factor analysis. UCLA Working Papers in Phonetics 16(1), 84
Kolda TG, Bader BW (2009) Tensor decompositions and applications. SIAM Rev 51(3):455–500
Liang Y, Caverlee J, Cheng Z, Kamath KY (2013) How big is the crowd?: Event and location based population modeling in

social media. In: Proceedings of the 24th ACM Conference on Hypertext and Social Media, HT ’13, p 99–108. ACM,
New York

Zhang W, Qi G, Pan G, Lu H, Li S, Wu Z (2015) City-scale social event detection and evaluation with taxi traces. ACM Trans
Intell Syst Technol 6(3):40:1–40:20

Wang J, Gao F, Cui P, Li C, Xiong Z (2014) Discovering Urban Spatio-temporal structure from time-evolving traffic networks.
Springer, Cham, pp 93–104

Yang D, Zhang D, Zheng VW, Yu Z (2015) Modeling user activity preference by leveraging user spatial temporal
characteristics in lbsns. IEEE Trans. Systems, Man, and Cybernetics: Systems 45(1):129–142

Liu H, Gao Y, Lu L, Liu S, Qu H, Ni LM (2011) Visual analysis of route diversity. In: 2011 IEEE Conference on Visual
Analytics Science and Technology, VAST 2011, Providence, Rhode Island, p 171–180

Wang Z, Yuan X (2014) Urban trajectory timeline visualization. In: International Conference on Big Data and Smart
Computing, BIGCOMP 2014, Bangkok, Thailand, p 13–18

Guo H, Wang Z, Yu B, Zhao H, Yuan X (2011) Tripvista: Triple perspective visual trajectory analytics and its application on
microscopic traffic data at a road intersection. In: 2011 IEEE Pacific Visualization Symposium, p 163–170

Andrienko N, Andrienko G, Stange H, Liebig T, Hecker D (2012) Visual analytics for understanding spatial situations from
episodic movement data. KI - Künstliche Intelligenz 26(3):241–251

Yang Y, Dwyer T, Goodwin S, Marriott K (2017) Many-to-many geographically-embedded flow visualisation: an evaluation.
IEEE Trans Vis Comput Graph 23(1):411–420

Jiang X, Zheng C, Tian Y, Liang R (2015) Large-scale taxi o/d visual analytics for understanding metropolitan human
movement patterns. J Vis 18(2):185–200

508 Y. Yan et al.



Lu M, Liang J, Wang Z, Yuan X (2016) Exploring od patterns of interested region based on taxi trajectories. J Vis
19(4):811–821

Wood J, Beecham R, Dykes J (2014) Moving beyond sequential design: reflections on a rich multi-channel approach to data
visualization. IEEE Trans Vis Comput Graph 20(12):2171–2180

Wang Z, Lu M, Yuan X, Zhang J, van de Wetering H (2013) Visual traffic jam analysis based on trajectory data. IEEE Trans
Vis Comput Graph 19(12):2159–2168

Liu D, Weng D, Li Y, Bao J, Zheng Y, Qu H, Wu Y (2017) Smartadp: Visual analytics of large-scale taxi trajectories for
selecting billboard locations. IEEE Trans Vis Comput Graph 23(1):1–10

Chu D, Sheets DA, Zhao Y, Wu Y, Yang J, Zheng M, Chen G (2014) Visualizing hidden themes of taxi movement with
semantic transformation. In: 2014 IEEE Pacific Visualization Symposium, p 137–144

Al-Dohuki S, Wu Y, Kamw F, Yang J, Li X, Zhao Y, Ye X, Chen W, Ma C, Wang F (2017) Semantictraj: a new approach to
interacting with massive taxi trajectories. IEEE Trans Vis Comput Graph 23(1):11–20

iao ZF, Li Y, Peng Y, Zhao Y, Zhou FF, Liao ZN, Dudley S, Ghavami M (2015) A semantic-enhanced trajectory visual
analytics for digital forensic. J Vis 18(2):173–184

Wu W, Zheng Y, Cao N, Zeng H, Ni B, Qu H, Ni LM (2017) Mobiseg: interactive region segmentation using heterogeneous
mobility data. In: 2017 IEEE Pacific Visualization Symposium (PacificVis)

Chen W, Guo F, Wang FY (2015) A survey of traffic data visualization. IEEE Trans Intell Transp Syst 16(6):2970–2984
OpenStreetMap contributors: planet dump retrieved from https://planet.osm.org. https://www.openstreetmap.org (2017)
Bostock M, Ogievetsky V, Heer J (2011) D3 data-driven documents. IEEE Trans Vis Comput Graph 17(12):2301–2309

Visual analytics of bike-sharing 509

https://www.openstreetmap.org

	Visual analytics of bike-sharing data based on tensor factorization
	Abstract
	Introduction
	Related Work
	Tensor factorization
	User activity analysis
	Trajectory data visualization

	Overview
	Activity pattern extraction
	Tensor construction
	Tensor factorization
	Pattern hierarchical clustering

	Visual design
	Global views
	Pattern relation view
	Activity pattern views
	Spatial dimension
	Temporal dimension
	User dimension

	Interaction
	System implementation

	Case study
	Global distributions
	Pattern analysis of New York
	User activity of different cities

	Conclusion and future work
	Acknowledgements
	References




