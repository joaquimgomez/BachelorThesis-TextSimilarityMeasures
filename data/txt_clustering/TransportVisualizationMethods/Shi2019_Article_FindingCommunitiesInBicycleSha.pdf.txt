































































































Finding communities in bicycle sharing system


REGULAR PAPER

XiaoYing Shi • Yang Wang • Fanshun Lv • Wenhui Liu • Dewen Seng • Fei Lin

Finding communities in bicycle sharing system

Received: 23 July 2018 / Revised: 27 June 2019 / Accepted: 15 July 2019 / Published online: 9 August 2019
� The Visualization Society of Japan 2019

Abstract The bicycle sharing system (BSS) provides a more sustainable transport paradigm in big cities.
The recorded cycling trajectories can be used to detect human movement patterns. Community detection
methods have been used to study BSS from a complex network perspective. However, the previous used
modularity-based methods not only ignored the interdependencies of bicycle flows in the system, but also
suffered from the problem of resolution limit. The in-depth analysis of detection results is also lacked. In
this paper, we propose an interactive visual analytics system to detect the cycling communities of bicycle
sharing system. Different kinds of community detection algorithms are adopted for finding station clusters;
multiple inter-linked views are designed to visualize properties of the detected substructures from different
perspectives. The real bicycle sharing dataset in Hangzhou is used for analysis, which demonstrates the
effectiveness of our method. By using the system, analyzers can compare the cluster results generated by
different algorithms, investigate the reason of the partition results based on different metrics, and find the
relationship among human activity communities and the city subregional structures. This study provides
insights into using bicycle sharing data to reveal human travel pattern and BSS usage pattern, which
potentially aids in developing urban planning policies.

Keywords Bicycle sharing system � Community detection � Visual analysis � Complex network �
Geographical visualization

X. Shi (&) � Y. Wang � F. Lv � W. Liu � D. Seng � F. Lin
School of Computer Science and Technology, Hangzhou Dianzi University, Hangzhou, China
E-mail: shixiaoying@hdu.edu.cn

Y. Wang
E-mail: wanggle55@gmail.com

F. Lv
E-mail: 172050041@hdu.edu.cn

W. Liu
E-mail: lwhui_yu@163.com

D. Seng
E-mail: sengdw@hdu.edu.cn

F. Lin
E-mail: linfei@hdu.edu.cn

X. Shi � Y. Wang � F. Lv � W. Liu � D. Seng � F. Lin
Key Laboratory of Complex Systems Modeling and Simulation, Ministry of Education, Hangzhou, China

J Vis (2019) 22:1177–1192
https://doi.org/10.1007/s12650-019-00587-0

http://orcid.org/0000-0003-0452-2503
http://crossmark.crossref.org/dialog/?doi=10.1007/s12650-019-00587-0&amp;domain=pdf
https://doi.org/10.1007/s12650-019-00587-0


1 Introduction

The rapid development of urbanization has brought great pressure on urban traffic. Public transport priority
is a modern concept to alleviate traffic jam. In the past decade, the bicycle sharing programs have gained
wide attentions, which offer an environmental-friendly, healthy, and low-cost alternative to automobile
transportation (Ricci 2015; Fishman 2016). Many big cities had developed bicycle sharing system (BSS),
such as Vélo’v in Lyon (Borgnat et al. 2009, 2011, 2013; Vogel et al. 2014), Vélib’ in Paris (Nair et al.
2013; Etienne and Latifa 2014), Citi Bike in New York (Oliveira et al. 2016), Divvy in Chicago (Zhou
2015), system in Hangzhou (Shaheen et al. 2011; Shi et al. 2018), and London (Wood et al. 2011; Goodman
and Cheshire 2014).

The bicycle sharing system uses touch-screen kiosks and smart cards for bicycle check-in and checkout.
Users could pick-up and drop-off bikes in any station at any time. The users’ trip records are stored digitally
and generate a network in the geographical space. Understanding the network structure can better grasp
human activity patterns. Community detection algorithms (Lancichinetti and Fortunato 2009; Fortunato and
Hric 2016) were used to uncover the underlying structure of bicycle network (Borgnat et al. 2011; Austwick
et al. 2013; Borgnat et al. 2013; Zhou 2015). However, there are several problems. Problem 1 The previous
studies used modularity-based algorithms to detect communities, which not only ignored the interdepen-
dencies of bicycle flows in the system, but also suffered from the problem of resolution limit (Lancichinetti
and Fortunato 2011). Problem 2 New community detection methods with different metrics were put for-
ward, which kinds of methods were more suitable for pattern discovery based on BSS data remained
unknown. The comparison of cluster results generated by different methods and the in-depth analysis of the
measure criterion also remained limited. Problems 3 The previous studied BSSs included no more than 410
stations (Borgnat et al. 2011; Austwick et al. 2013; Borgnat et al. 2013; Zhou 2015). When the system scale
is large, showing the station clusters directly is hard for comparison and knowledge discovery.

To address those problems, we propose an interactive visual analytics system to detect communities in
bicycle sharing system. Rich and coordinated interactions are provided for interactive exploration. In
particular, the system is able to assist users in understanding human movement pattern, exploring the latent
relationships among urban administrative division and human cycling communities, and visually comparing
cluster results generated by different community detection algorithms. A real-world BSS dataset, which has
a larger scale compared with the previous studied BSSs, is used to demonstrate the usefulness and effec-
tiveness of our method. The main contributions include:

(1) We adopt modularity-based algorithms and dynamics-based algorithms to find cycling communities,
visualize the differences among cluster results, and investigate the in-depth reasons of different
partition metrics.

(2) We propose an interactive visual analytic procedure to help BSS system manager or city planner
understand the community detection results and ultimately find the system usage pattern and the
underlying human movement pattern. Multiple inter-linked visual views are designed to demonstrate
the hidden modes vividly. To our knowledge, it is the first system to explore cycling community
patterns for such a big bicycle sharing system. Even if the station number is more than 2000, our
method supports the comparison of community detection results under different attributes.

The rest of paper is organized as follows. Section 2 discusses related work with regard to community
detection algorithms and the BSS domain. Section 3 describes the study area, data form, and the system
pipeline. In Sect. 4, the detail system procedures are explained. The experiments based on real-world dataset
are presented in Sect. 5, followed by conclusion and future work in Sect. 6.

2 Literature review

2.1 Community detection methods

The community detection methods partition a network into communities of densely connected nodes. The
nodes belonging to different communities are sparsely connected. These algorithms can be divided into
three categories roughly.

Optimization-based methods maximized an objective function to evaluate the quality of the community.
Modularity (Newman 2004) was the most widely used objective function to evaluate the performance of

1178 X. Shi et al.



network partitioning. Since the precise optimization was computationally intractable, various strategies were
proposed to speed up the optimization process, such as greedy optimization (Clauset et al. 2004), spectral
division (Newman and Girvan 2004), hierarchical aggregation (Blondel et al. 2008), simulated annealing
(Good et al. 2010), and other bionic intelligent methods (Shi et al. 2010; Jin et al. 2011). Although
modularity-based methods were widely used, they suffered from the problem of resolution limit (Lanci-
chinetti and Fortunato 2011). That was to say: when the modularity was maximized, communities smaller
than a certain scale or small and fully connected sets of nodes were failed to be recognized. Combo
algorithm (Sobolevsky et al. 2014) was a universal optimization technique for community detection, which
took three search strategies to evolve the starting partitions.

Hierarchical clustering methods organized the network topology as a tree structure. The top-down
divisive algorithm (Girvan and Newman 2002) built a hierarchy of communities by removing edges with the
highest betweenness iteratively. The bottom-up agglomeration algorithms (Clauset et al. 2004; Pons and
Latapy 2006; Blondel et al. 2008) merged similar nodes/communities recursively to capture the community
structure of a network. Clauset (Clauset et al. 2004) and Louvain (Blondel et al. 2008) algorithms aimed to
find high modularity partitions of network through node merging, while Walktrap algorithm (Pons and
Latapy 2006) executed agglomerative clustering process based on random walks.

Because the network formation process was affected by its communication structure, the dynamics-based
methods analyzed the network dynamics to reveal the community structure, including random walk (Rosvall
and Bergstrom 2008) and synchronization dynamics (Arenas et al. 2006). Infomap algorithm (Rosvall and
Bergstrom 2008) used the probability flow of random walks on a network as a proxy for information flows in
the real system and decomposed the network into communities by compressing the description code length.

The above classification is not non-overlapping. Some algorithms belong to multiple categories at the
same time. For example, the algorithms (Clauset et al. 2004; Blondel et al. 2008) belonged to the opti-
mization-based method, as well as the hierarchical clustering method. Infomap algorithm (Rosvall and
Bergstrom 2008) belonged to the dynamics-based method, which can also be seen as optimize an alternative
objective function (a map equation measuring the description code length).

2.2 Analysis of BSS data

As the bicycle sharing systems became increasingly popular, BSS data collected from different cities had
been widely studied.

To study the fundamental dynamics of the system, Etienne and Latifa (2014) introduced a generative
model to divide stations based on temporal attributes over the day and discovered regions with different
functions. O’brien et al. (2014) analyzed 38 bicycle sharing systems located in Europe, the Middle East,
Asia, Australasia, and the Americas. A hierarchical clustering method was applied to distinguish the
commonalities and differences between systems. Nair et al. (2013) explored the connection between public
transit and BSS, and the flow imbalance among stations for Vélib’ in Paris. Faghih-Imani and Eluru (2016)
investigated the presence of spatial and temporal dependency for BSS station’s arrival and departure rates.
El-Assi et al. (2017), Zhang et al. (2017), and Wu et al. (2018) investigated the relationships between built
environmental factors and characteristics of BSS, such as station attributes and accessibility, public transit
facilities, and land use diversity. To analyze BSS users, the user typology was generated to classify users
(Vogel et al. 2014), and the user profile changing pattern was examined for bicycle hire scheme in London
(Goodman and Cheshire 2014).

Since the BSS could be represented as a connected graph, network analysis methods were used to find
communities in BSS. Louvain algorithm was used for ‘V�elo’v’ system with about 340 stations (Borgnat
et al. 2011, 2013). Austwick et al. (2013) used a Wards hierarchical clustering algorithm to explore the
station clusters in five different cities. Their station numbers were no more than 410. Zhou (2015) con-
structed a bike flow similarity graph, and used modularity-based algorithm (Clauset et al. 2004; Newman
and Girvan 2004) to detect spatial communities of bike flows. The above methods all used modularity as the
objective function, and the analyzed system scales were relative small. The comparison of cluster results
generated by different algorithms remained limited.

Visual analytic methods can assist the analysis process. Wood et al. (2011) visualized the flow data by
using OD Map, gridded views of station location, and edge bundling technique to identify changes in travel
behavior over space and time. Borgnat et al. (2009) visualized bicycle trips and identified the main char-
acteristics of flows among stations. Oliveira et al. (2016) encoded the system usage data in a pixel-oriented
visualization design supporting partial reordering of time series, to help understand the dynamics of station

Finding communities in bicycle sharing system 1179



status. Shi et al. (2018) analyzed the spatial–temporal changes of station states and the multi-dimensional
factors influencing on hire numbers. Yan et al. (2018) employed tensor factorization to extract latent user
activity patterns and designed a visual analytics system to interactively explore patterns from the spatial,
temporal, and user dimensions. However, there lacked design of useful visual analytics system to explore
the cycling community patterns.

3 Study area and system overview

3.1 Study area

Hangzhou is a famous tourist scenic city in China, with a land area of more than 16,000 km
2
(Fig. 1). It is

famous for the beautiful West Lake, which is located in the city center. Hangzhou comprises eight districts.
The five districts: ‘Xiacheng,’ ‘Shangcheng,’ ‘West Lake,’ ‘GongShu,’ ‘JiangGan,’ cover the core urban
area of Hangzhou. BinJiang district is separated from other parts of Hangzhou by the QianTang River.
Hangzhou government launched the public bike-sharing program on May 1, 2008, with the goal of pro-
viding a free and convenient system for residents and tourists. The bicycle stations were mainly distributed
around the previously mentioned six districts. The BSS in Hangzhou was the first information technology-
based bicycle sharing system in mainland China. As of March 2011, it operated 60,600 bicycles with 2416
fixed stations (Shaheen et al. 2011).

3.2 BSS data preparation

We acquired three month (April to June, 2014) BSS data of Hangzhou from the public bicycle management
department. The BSS data include trip and station information. Each trip record represents a flow from
origin station to destination station, including start/end stations, start/end timestamps, bike ID, etc. Station
information contains station ID, station name, longitude, and latitude. The dataset includes 21,162,572
original trip records occurring in 2759 bicycle stations. These records were stored in the database for further
processing.

3.3 Task abstraction

We define four tasks for our system, to solve the problems exist in the previous studies.

T1: Demonstrate and compare cluster results for large bicycle sharing system. For bicycle sharing system
with larger station number, showing the cluster results on the map directly and assigning colors for each
community randomly would lead to dizzy results. Besides, we need to know one station’s subordinate
cluster across different algorithms clearly. Thus, we need to design intuitive clustering display and
comparison scheme.
T2: Explore the in-depth reasons of cycling clusters generated by different algorithms. Different
community detection algorithms optimize different objective functions. We need to grasp the essence of
partition algorithms based on different metrics, thereby know which algorithm should be used in a
suitable case.
T3: Understand one station’s usage condition. Each station has unique operation status. Even one station
has different usage features under different date attributes, such as workday vs. weekend. We need to
visualize the rental and return states of each station, thereby know why a station is divided into one
community.
T4: Analyze the characteristic of each community. Each community has its own dominant function and
station visiting correlations. Some stations in the community play key roles attracting or generating a
large proportion of traffic volume. Therefore, we should visualize the relationship among stations in one
community and the communities’ important features.

3.4 System overview

Based on the above tasks, we design an interactive visual analytics system (Fig. 2) to help knowledge
discovery. The system contains three phases: data preprocessing, community detection, and visual analysis.

1180 X. Shi et al.



During the data preprocessing phase, trip records and station records are stored in the database. A data
cleaning process is adopted to delete incorrect records, such as: (1) start station or end station is null; (2)
start time[ = end time; and (3) duplicate trip records. We obtain approximately 14 million trip records
after filtering out invalid records. In order to speed up the process, trip records are aggregated by 1 h interval
for each station and stored in advance.

Then, BSS is modeled as a dynamical bicycle network, and different community detection algorithms are
adopted to find station clusters.

During the visual analysis phase, we design several diagrams from three aspects to achieve the four
tasks. From the regional aspect, cluster scatter diagram, cluster correlation diagram, and circle packing
diagram are designed for demonstrating and comparing the detected results (T1, T2). From the station
aspect, two flow distribution diagrams are designed for observing the hire condition for one station (T3).
Core stations in each community are computed, and the related POI (point-of-interest) information is also
acquired and visualized, to help analyze the community characteristic (T4). These diagrams are inter-linked
for discovering patterns integratedly.

4 System procedures

4.1 Bicycle network construction

In order to find communities in BSS, BSS is modeled as a directed weighted network first. The stations are
regarded as nodes, while the flows among stations are edges in the network.

Suppose the station set is S ¼ fsig ð1� i� nÞ, where n is the station number. The analyzed time period is
denoted as s. s can be assigned by analysts through a date picker. For instance, if analysts hope to analyze
the communities in April, then s represents a time period from April 1 to April 30. Analysts can also select
days during weekends, i.e., April 19 and April 20; then, s represents a time period from April 19 to April 20.

The bicycle network for the time period s is defined as GðsÞ ¼ ðS;EðsÞÞ. EðsÞ denotes the adjacent
matrix. Each element value eijðsÞ in EðsÞ represents the trip number starting from si and ending in sj during
a time period s. A larger value of eijðsÞ indicates the stronger strength of correlation among the station pair.
eijðsÞ 6¼ ejiðsÞ since the rental direction is taken into consideration. During the analysis process, analysts can
choose whether to include the self-journeys. If they are interested in relationships between stations, they can
ignore the self-journeys during the calculation. Thus, the values of the main diagonal in EðsÞ are set to be 0.
Otherwise, they can choose to include the self-journeys.

Fig. 1 The map of Hangzhou

Finding communities in bicycle sharing system 1181



4.2 Community detection

After constructing the bicycle network, three different algorithms are applied to detect communities:
Louvain, Combo, and Infomap.

Louvain algorithm (Blondel et al. 2008) is a modularity-based optimization method. Modularity
(Newman 2004) maximizes an objective function Q to find communities with dense links inside and sparse
links among them, which is defined as follows:

Q ¼
1

2m

X

i;j

½Eij �
kikj

2m
� dðci; cjÞ

The adjacent matrix Eij stores the edge weights. ki ¼
P

j Eij is the sum of the edge weight attached to
station si. ci stands for the belonged community of station si. The d-function dðu; vÞ is 1 if u ¼ v and 0
otherwise. m ¼ 1

2

P
ij Eij is the sum of all edge weight in the network.

Fig. 2 System overview

Fig. 3 The result comparison for different community detection algorithms. a The cluster scatter diagram generated by
Infomap (k = 24). One dot stands for a station. The stations in one community have the same color. The colors of communities
are assigned randomly. b The circle packing diagram generated by Infomap. The dot colors of stations are consistent with the
colors in the cluster scatter diagram. One circle stands for a community. c The cluster scatter diagram generated by Combo
(k = 11). The colors of communities are assigned based on (a). Communities with similar geographical locations have similar
colors. d The circle packing diagram generated by Combo. The dot colors are same with those in (b). The surrounding circles
are drawn according to Combo algorithm’s partition result. e The cluster scatter diagram generated by Louvain (k = 9). The
colors of communities are assigned based on (a). f The circle packing diagram generated by Louvain. The dot colors are same
with those in b. The surrounding circles are drawn according to Louvain algorithm’s partition result

c

1182 X. Shi et al.



Finding communities in bicycle sharing system 1183



The algorithm contains two phases. Each station in GðsÞ is assigned to one community initially. In the
first phase, modularity is optimized by allowing only local changes of communities. Each node si is placed
to a community for which the gain of modularity is maximum and positive. The second phase constructs a
new network by merging the communities found during the first phase. The link weights between new
communities are re-computed. These two phases are executed iteratively and stopped until there are no more
changes. Finally, a hierarchy of communities is generated with a maximal modularity.

Combo algorithm (Sobolevsky et al. 2014) combines three search strategies to evolve starting partitions,
including merging two communities, splitting a community into two and moving nodes between two distinct
communities. All stations belong to one community initially. Then, two steps are performed iteratively as
long as any gain in terms of the objective function can be obtained. Step 1 For each pair of source and
destination community, calculate the best possible redistribution of every source nodes into each destination
community (either existing or new). Two communities are recombined starting from several initial con-
figurations. For each starting configuration, a series of Kernighan-Lin shifts are iterated until no further
improvement is possible, and the intermediate result which yields the best gain in terms of objective
function is saved. Step 2 Move nodes from original community to the destination community according to
the best partition finding by step 1, recalculate gains for all changed communities, and obtain the final
partition communities.

Infomap algorithm (Rosvall and Bergstrom 2008) considers finding optimal community structure is
equivalent to minimize the description code length of a random walk on the network. It optimizes a map
equation. For finding a partition M of n nodes into m clusters, the average description code length of a single
step is given by:

1
( ) ( ) ( )

m i i
i

L M q H p
=

= + ∑

This map equation contains two terms: the entropy of the movement between clusters and the entropy of
movements within clusters. q is the probability that the random walk switches clusters on any given step.
HðLÞ is the entropy of the cluster names. HðPiÞ is the entropy of the within-cluster movements, including
the exit code for cluster ci. The weight

ip is the fraction of within-cluster movements that occurring in
cluster ci, plus the probability of exiting cluster ci such that 1

1
m i
i

p q
=

= +∑ . The partitions minimizing the
description code length in the map equation are found by a greedy search algorithm with a simulated
annealing approach. The result both simplifies and highlights the regularities in the structure and their
relationships.

4.3 Visual analysis

During the visual analysis phase, the network GðsÞ is fed as input to different community detection
algorithms, and the cluster results are generated. Each cluster corresponds to a community, and one cluster
contains many stations. Then, multiple diagrams are designed from different aspects to demonstrate the
community detection results.

To visualize and compare the detected results, we design three diagrams from the regional aspect: cluster
scatter diagram, cluster correlation diagram, and circle packing diagram.

Cluster scatter diagram (left of Fig. 5) offers a general overview of the partition result and displays the
communities’ geographical distribution. The stations in one community have same color. To compare the
cluster results more clearly, we calculate the geographical center of each community and assign regions
having similar geographical locations with colors as consistent as possible. Besides, to assist in comparing
the station clusters with the administrative division, and investigating the connection among BSS and
subway, analyzers can choose to highlight the administrative boundary and metro line on the map.

Inter-cluster/Intra-cluster correlation diagram These two diagrams visualize the relationships among
communities and within communities. For the inter-cluster correlation diagram (right of Fig. 5), a com-
munity is abstracted as a dot. The dot size is proportional to the station number within that community. The
flows among communities are aggregated and are represented by arcs. For the intra-cluster correlation
diagram (Fig. 4), each dot represents a station, and the arc stands for hire number among stations. If a
community contains a large number of stations, the relationships among stations would be very complex.
Analyzers can filter out unimportant arcs by entering a threshold. The flows with hire numbers smaller than
that threshold are ignored. These two diagrams adopt the same color encoding. The redder and thicker arc
indicates larger flow magnitude, while the greener and thinner arc indicates smaller flow magnitude.

1184 X. Shi et al.



Circle packing diagram (Fig. 3b, d, f): To demonstrate the overall subordinate communities of stations
across different algorithms intuitively, circle packing diagram is designed. Each dot represents for a station,
and all stations in the same community are surrounded by one large circle. When clicking a dot, the related
information of that station is shown. The assignment of dot color obeys the following rules. For the clusters
generated by the first community detection algorithm, the dot colors of stations in the circle packing diagram
are consistent with the colors in the cluster scatter diagram. For the following clusters generated by other
algorithms, the dot colors remain unchanged, but the surrounding circles are drawn according to its current
partition result. Thus, dots with different color may be surrounded by the same circle and indicate the
change of station division calculated by different algorithms.

In order to show the station’s operation status, flow distribution diagrams (Fig. 7) visualize the distri-
bution of rental/return numbers for one station. Since cycling is mainly used for short journeys, seldom trips
visit stations more than 6 km apart. Therefore, we only calculate the related stations for central station
within 6 km. The six-layer rings from inside to outside represent the rental/return numbers within 6 km to
the center station. The rings are equally divided into 12 parts. Each sector encodes a bicycle usage number
on one direction within a certain distance. Sector representing a larger number will be mapped with a darker
color. In more detail, the rental flow distribution diagram (left of Fig. 7a) demonstrates the condition of
people picking-up bikes from the center station and dropping-off to the surrounding stations. The return flow
distribution diagram (right of Fig. 7a) shows the condition of people renting bikes from surrounding stations
and returning to the center station.

To further analyze the communities, we calculate the core stations for each community. Since some
stations are associated with significantly large proportions of local trips, the core stations are defined as the
stations with top N largest rental and return numbers in each community. The core station diagram has two
versions: map version (Fig. 9a) and POIs version (Fig. 9b). The map version directly shows these core
stations on the map. Their colors are in accordance with that in cluster scatter diagram. The dot size is
proportional to the traffic volume of each station. Previous study had shown that a circular buffer zone of a
300-m radius around bicycle station is an appropriate walking distance to calculate the spatial variables of
built environment factors (Wu et al. 2018). Therefore, we acquire POI information around a core station
within 300-m to analyze its function. Nine POI categories are obtained: real estate, company, scenic spot,
service, food, hotel, shopping, outdoor recreation, and professional institute. The POIs version visualizes the
proportion of different POI categories for each core station. Each station is abstracted as a pie chart on the
map, and the color of outer ring indicates its subordinate community. When clicking a specific pie chart, a
POIs distribution diagram of that station is shown (Fig. 9c). The five-pointed star on the map indicates the
station, and the dot indicates the location of a specific POI, which can help analyzers understand the purpose
of people visiting this station.

5 Results and discussion

In this section, we first conduct a quantitative analysis on the results generated by different community
detection algorithms. Then, three case studies are carried out based on BSS data in Hangzhou to evaluate the
effectiveness of our system.

5.1 The comparison of different community detection algorithms

In this section, we use three algorithms to detect cycling communities in Hangzhou (T1). Infomap algorithm
takes the description code length as the measure criterion, while other two calculate modularity.

The partition results are visualized in Fig. 3a–f. k stands for the cluster number. In order to estimate the
partition quality by different algorithms, we calculate the modularity and description code length, respec-
tively. From Table 1, we find that Louvain algorithm performs worst according to both criterions, and it
produces super-communities containing a large fraction of nodes (Fig. 3e). Infomap and Combo algorithms

Table 1 The calculated modularity and description code length of three algorithms

Infomap Combo Louvain

Modularity 0.600491 0.62138 0.595264
Description code length 9.65883 9.73118 9.99989

Finding communities in bicycle sharing system 1185



perform best in view of description code length and modularity. The cluster scatter diagrams show the
geographical distribution of communities. Since the cluster results are complex for comparison, the circle
packing diagrams show the differences of communities more clearly. The dot colors of Infomap in circle
packing diagram (Fig. 3b) are in accordance with that in cluster scatter diagram. The dot colors for Combo
(Fig. 3d) and Louvain (Fig. 3f) in circle packing diagram remain unchanged referring to Infomap; only the
surrounding circles are rendered according to the new partition results. By using this scheme, we can see the
differences among cluster results clearly. For Combo algorithm, part of its result is consistent with Infomap,
and several regions in the downtown are merged, so that one circle in the circle packing diagram contains
dots with different colors. The Louvain algorithm divides all stations into seven big communities. Three of
which keeps same with the result of Infomap, while the downtown areas are consolidated into four large
regions roughly. Communities smaller than a certain scale are failed to be recognized. Because the Louvain
algorithm performs worst in view of both metrics, we only use Combo and Infomap to detect communities
in the following case studies.

In order to understand the differences of Infomap and Combo algorithms (T2), we select several stations
on the map and divide them using two algorithms. Infomap algorithm aggregates all stations into one
community, while the partition result of Combo algorithm is illustrated in Fig. 4. It divides all stations into
two communities. Stations with larger edge weights are clustered together in terms of modularity. As seen
from Fig. 4, we can understand the essence of these two algorithms. Infomap algorithm focuses on the
interdependence in networks characterized by flows and measures the overall flow fluidity referring to
description code length. Although the edge weights are small, there exist long-range flows in the com-
munity, so all stations are clustered into one community. Combo algorithm focuses on the absolute value of
flow magnitude and finds subregions with stronger internal hire relationships.

5.2 The analysis of community detection results in Hangzhou

In this section, we examine the relationships between cycling communities, geographical environment, and
urban administrative division (T1). Combo and Infomap algorithms are applied to find communities for BSS
in Hangzhou. Administrative boundaries are highlighted. For Infomap algorithm, more isolated stations
appear when considering the self-journeys. For a specific station, if the number of self-journeys is much
higher than other journeys, it tends to be divided as one community. In order to obtain communities with
strong connections inside, the self-journeys are ignores. For Combo algorithm, the detected results are
insensitive to self-journeys. Including the self-journeys can obtain a relatively detailed partition result.

As seen from the cluster scatter diagram of Fig. 5, we find that the geographical environment has a great
influence on bicycle riding. Adjacent stations tend to be divided into the same community, indicating

Fig. 4 The intra-cluster correlation diagram by Combo for a small region

1186 X. Shi et al.



adjacent stations exchange more bicycles than distant stations. Three communities can be recognized by
both algorithms. They are dark blue region in BinJiang (separated by QianTang River), light blue region in
south part of West Lake district, and orange region in XiaSha economic technical development zone (an
independent zone in the JiangGan district). Their geographical locations are far away from other regions.

The result generated by Infomap is more consistent with the district boundary, which manifests the
overall human movement has a latent association with the administrative division. The stations in the same
district tend to be divided into one community. Some districts are divided into smaller communities, which
suggest that the human activities in those areas are more closely linked. The result of Combo algorithm has
less cluster number (k = 11). Some regions are aggregated across two districts, such as purple, deep yellow,
and crimson regions, which means the bicycle rental and return numbers are relative large in these regions.
In general, the community detection results can reveal the actual human activity regions.

Next, we observe the inter-cluster correlation diagrams (right of Fig. 5). From which, we find that the
station clusters in the downtown have relative stronger connections. The arcs among most communities are
green, meaning these communities have sparse connections with other regions and form fairly independent
subsystems. Most people’s activity areas are within these regions, and they seldom visit other regions.

5.3 The comparison of bicycle exchange condition under different date attributes

In this section, we observe the partition results under different date attributes to investigate the stability of
system operation (T1). Figure 6 illustrates the cluster results generated by Combo algorithm on workdays
and weekends. From the circle packing diagrams, we find that the partition results are broadly consistent,
which indicates the BSS has a steady usage structure. Some stations are divided into different communities
under different date attributes. Take the station ‘Nine creeks in misty forest (NCMF)’ for example, it is
divided into cyan region on workdays and crimson region on weekends. To find reasons for that, we further

Fig. 5 The results generated by Infomap and Combo algorithms for BSS in Hangzhou during April 2014. The left column
shows the cluster scatter diagrams, and the right column shows the inter-cluster correlation diagrams. a The results generated
by Infomap algorithm (k = 24). b The results generated by Combo algorithm (k = 11)

Finding communities in bicycle sharing system 1187



check the station’s flow distribution diagrams (T3). As seen from Fig. 7, more flows go to the northeast parts
on workdays, and flows concentrate on the southeast parts on weekends. Several stations may play different
roles in different days, so their belonged communities are changed.

Fig. 6 The bicycle exchange condition generated by Combo algorithm under different date attributes. The left column shows
the cluster scatter diagrams, and the right column shows the circle packing diagrams. a The results on workdays from April 14
to April 18. b The results on weekends from April 19 to April 20

Fig. 7 The flow distribution diagrams of station ‘Nine creeks in misty forest’ under different date attributes. The six-layer
rings from inside to outside represent the rental/return numbers within 6 km to the center station. Each sector encodes a bicycle
usage number on one direction within a certain distance. a The results on workdays from April 14 to April 18. Left of (a) is the
rental flow distribution diagram using a white-red color encoding scheme, and right of (a) is the return flow distribution
diagram using a white-blue color encoding scheme. b The results on weekends from April 19 to April 20. Left of (b) is the
rental flow distribution diagram, and right of (b) is the return flow distribution diagram

1188 X. Shi et al.



We also use Infomap algorithm to divide stations and find similar patterns. The total partitions remain
stable, except few regions merging or splitting. Some stations belong to different communities in different
days. Since Infomap algorithm focuses more on the overall flowability, the single station’s changing pattern
is hard to discover.

Next, we select the city heart area around the West Lake and compare its results on holidays and
workdays (T1). Figure 8 illustrates the partition results, and the intra-cluster correlation diagrams of selected
communities are enlarged. Comparing the results on holidays and workdays, we find that the yellow and
purple communities remain unchanged, and the blue community in Fig. 8a is split into two communities in
Fig. 8b. We select these communities and filter out unimportant arcs to obtain the intra-cluster correlation
diagrams. From the right enlarged intra-cluster correlation diagram (Fig. 8a), we can see people in the blue
area are willing to ride near West Lake on holidays. During workdays, only the southeast parts have large
hire numbers (Fig. 8b), and the frequently used stations are near residential buildings or main roads, which
may be related to citizens’ commuting behaviors. Besides, the red community in Fig. 8a is partially merged
into the green community in Fig. 8b. By inspecting the intra-cluster correlation diagram (left of Fig. 8a), we
find this region forms a small community during holidays, including stations near large shopping malls
(DASP, SYR) and scenic spots around West Lake (LLP, HFS, GYL).

5.4 The analysis of core stations

To find the key stations in each community and understand the users’ visiting purposes (T4), Fig. 9 analyzes
the core stations based on Fig. 5a. As seen from the map version of core station diagram (Fig. 9a), we can
see the distribution of core stations in each community. The traffic volumes of stations in the downtown are

Fig. 8 The bicycle exchange condition in downtown area under different date attributes generated by Combo algorithm. a The
results on holidays from April 5 to April 7. The center figure is the cluster scatter diagram. The left and right figures are intra-
cluster correlation diagrams for red community and blue community, respectively. b The results on workdays from April 21 to
April 25. The left figure is the cluster scatter diagram, and the right figure is the intra-cluster correlation diagram for the
selected communities

Finding communities in bicycle sharing system 1189



slightly larger than that in the peripheral areas. Many core stations are located around the subway. Then, we
select a region in the downtown and check the POIs version (Fig. 9b). For the city heart area (red com-
munity), stations 8012 and 8014 have large proportions of ‘scenic spot’ and ‘service.’ Take the station 8012
for example, it is located in the south entrance of Su Causeway. There have many tourist attractions around
it (Fig. 9c). Thus, it is most used for sightseeing. For the purple community, four core stations (5409, 5047,
5070, and 5022) are around bus terminals. The surrounding POI categories mainly contain ‘company’ and
‘real estate.’ Figure 9d lists some of POIs around station 5022. For other communities, ‘company,’ ‘real
estate,’ and ‘shopping’ are the top three categories. Some stations have a big proportion of one kind of POI,
which are influenced by the surrounding environment. For example, station 6205 is located near the
BinJiang District Government and Armed Police Hospital (Fig. 9e), so the proportion of ‘professional
institute’ is large. Station 3527 is located near the East Railway Station, thereby the proportion of ‘service’
is large. To sum up, many core stations are located near subway or bus terminal, which indicates the BSS
acts as a seamless feeder service to other public transit. The POI distributions of most core stations
concentrate on ‘company,’ ‘real estate,’ and ‘shopping.’ By concentrating large travel volumes, these
stations play important roles in organizing local bicycle flows.

6 Conclusion

We have designed and developed a visual analytics system to explore human cycling behavior and system
usage pattern based on BSS data. The proposed visual analysis framework is not limited to the community
detection algorithms adopted in this paper, but also applicable to other algorithms. Through case studies, we
conclude several insights found by using our system:

(1) The community detection results are in accordance with the administrative division at some extent.
However, the detected subregional structures reflect people’s actual activity regions, which can be

Fig. 9 The core station analysis of communities. a The map version of core station diagram. b The POIs version of the
selected region in (a). c The POIs distribution diagram of station 8012. d The POIs distribution diagram of station 5022. e The
POIs distribution diagram of station 6205

1190 X. Shi et al.



better used for interpreting transportation-related issues than administrative divisions. Some
communities have few interactions with other areas and form independent subsystems, which indicate
that most citizens’ daily activities are completed within that region.

(2) The operation condition of bicycle sharing system is stable; only a few stations belong to different
communities under different date attributes. These stations may play different roles in different days.

(3) The used measure criterions (modularity and description code length) reflect two different senses of
what it means to have a network. Infomap algorithm attempts to find the essence of a network in the
patterns of flow that its structure induces. The found communities contain long-distance flows. The
modularity-based methods concentrate on the topological properties of network links and obtain
communities with heavily weighted links inside. Therefore, if we want to find communities with
stronger hire relationships, we can use Combo algorithm. If we hope to grasp the overall flow condition
of bicycles among stations, we can use Infomap algorithm.

Our method supports to compare the station communities under different date attributes. However, if the
time period is too long, directly obtaining the network snapshots of each day is hard for comparison. In the
future, we will study the evolutionary analysis method for bicycle networks and explore the structural
evolution patterns. Besides, the system is mainly designed for analyzing BSS data. We will try to design a
universal analysis tool to analyze datasets having the community attributes and adopt different kinds of
datasets to conduct evaluation.

Acknowledgements This work was supported by the National Natural Science Foundation of China (Grant Nos. 61602141,
61603119, 61703127).

References

Arenas A, Dı́az-Guilera A, Pérez-Vicente CJ (2006) Synchronization reveals topological scales in complex networks. Phys Rev
Lett 96(11):114102

Austwick MZ, O’Brien O, Strano E et al (2013) The structure of spatial networks and communities in bicycle sharing systems.
PLoS ONE 8(9):e74685

Blondel VD, Guillaume JL, Lambiotte R et al (2008) Fast unfolding of communities in large networks. J Stat Mech Theory Exp
10:P10008

Borgnat P, Fleury E, Robardet C et al (2009) Spatial analysis of dynamic movements of Vélo’v, Lyon’s shared bicycle
program. In: Proceedings of ECCS’09. Complex Systems Society

Borgnat P, Abry P, Flandrin P et al (2011) Shared bicycles in a city: a signal processing and data analysis perspective. Adv
Complex Syst 14(3):415–438

Borgnat P, Robardet C, Abry P et al (2013) A dynamical network view of lyon’s vélo’v shared bicycle system. Dyn Complex
Netw 2:267–284

Clauset A, Newman MEJ, Moore C (2004) Finding community structure in very large networks. Phys Rev E 70(6):066111
El-Assi W, Mahmoud MS, Habib KN (2017) Effects of built environment and weather on bike sharing demand: a station level

analysis of commercial bike sharing in Toronto. Transportation 44(3):589–613
Etienne C, Latifa O (2014) Model-based count series clustering for bike sharing system usage mining: a case study with the

Vélib’system of Paris. ACM Trans Intell Syst Technol 5(3):39
Faghih-Imani A, Eluru N (2016) Incorporating the impact of spatio-temporal interactions on bicycle sharing system demand: a

case study of New York CitiBike system. J Transp Geogr 54:218–227
Fishman E (2016) Bikeshare: a review of recent literature. Transp Rev 36(1):92–113
Fortunato S, Hric D (2016) Community detection in networks: a user guide. Phys Rep 659:1–44
Girvan M, Newman MEJ (2002) Community structure in social and biological networks. Proc Natl Acad Sci 99(12):7821–7826
Good BH, de Montjoye YA, Clauset A (2010) Performance of modularity maximization in practical contexts. Phys Rev E

81(4):046106
Goodman A, Cheshire J (2014) Inequalities in the London bicycle sharing system revisited: impacts of extending the scheme to

poorer areas but then doubling prices. J Transp Geogr 41:272–279
Jin D, Liu D, Yang B et al (2011) Ant colony optimization with a new random walk model for community detection in complex

networks. Adv Complex Syst 14(05):795–815
Lancichinetti A, Fortunato S (2009) Community detection algorithms: a comparative analysis. Phys Rev E 80(5):056117
Lancichinetti A, Fortunato S (2011) Limits of modularity maximization in community detection. Phys Rev E 84(6):066122
Nair R, Miller-Hooks E, Hampshire RC et al (2013) Large-scale vehicle sharing systems: analysis of Vélib’. Int J Sustain

Transp 7(1):85–106
Newman MEJ (2004) Analysis of weighted networks. Phys Rev E 70(5):056131
Newman MEJ, Girvan M (2004) Finding and evaluating community structure in networks. Phys Rev E 69(2):026113
O’brien O, Cheshire J, Batty M (2014) Mining bicycle sharing data for generating insights into sustainable transport systems.

J Transp Geogr 34:262–273
Oliveira GN, Sotomayor JL, Torchelsen RP et al (2016) Visual analysis of bike-sharing systems. Comput Graph 60:119–129
Pons P, Latapy M (2006) Computing communities in large networks using random walks. J Graph Algorithms Appl

10(2):191–218

Finding communities in bicycle sharing system 1191



Ricci M (2015) Bike sharing: a review of evidence on impacts and processes of implementation and operation. Res Transp Bus
Manag 15:28–38

Rosvall M, Bergstrom CT (2008) Maps of random walks on complex networks reveal community structure. Proc Natl Acad Sci
105(4):1118–1123

Shaheen S, Zhang H, Martin E et al (2011) China’s Hangzhou public bicycle: understanding early adoption and behavioral
response to bikesharing. Transp Res Record J Transp Res Board 2247(1):33–41

Shi C, Yan Z, Wang Y et al (2010) A genetic algorithm for detecting communities in large-scale complex networks. Adv
Complex Syst 13(1):3–17

Shi X, Yu Z, Chen J et al (2018) The visual analysis of flow pattern for bicycle sharing system. J Vis Lang Comput 45:51–60
Sobolevsky S, Campari R, Belyi A et al (2014) General optimization technique for high-quality community detection in

complex networks. Phys Rev E 90(1):012811
Vogel M, Hamon R, Lozenguez G et al (2014) From bicycle sharing system movements to users: a typology of Vélo’v cyclists

in Lyon based on large-scale behavioural dataset. J Transp Geogr 41:280–291
Wood J, Slingsby A, Dykes J (2011) Visualizing the dynamics of London’s bicycle-hire scheme. Cartogr Int J Geograph Inf

Geovis 46(4):239–251
Wu J, Wang L, Li W (2018) Usage patterns and impact factors of public bicycle systems: comparison between city center and

suburban district in Shenzhen. J Urban Plan Dev 144(3):04018027
Yan Y, Tao Y, Xu J et al (2018) Visual analytics of bike-sharing data based on tensor factorization. J Vis 21(3):495–509
Zhang Y, Thomas T, Brussel M et al (2017) Exploring the impact of built environment factors on the use of public bikes at bike

stations: case study in Zhongshan, China. J Transp Geogr 58:59–70
Zhou X (2015) Understanding spatiotemporal patterns of biking behavior by analyzing massive bike sharing data in Chicago.

PLoS ONE 10(10):e0137922

Publisher’s Note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional
affiliations.

1192 X. Shi et al.


	Finding communities in bicycle sharing system
	Abstract
	Introduction
	Literature review
	Community detection methods
	Analysis of BSS data

	Study area and system overview
	Study area
	BSS data preparation
	Task abstraction
	System overview

	System procedures
	Bicycle network construction
	Community detection
	Visual analysis

	Results and discussion
	The comparison of different community detection algorithms
	The analysis of community detection results in Hangzhou
	The comparison of bicycle exchange condition under different date attributes
	The analysis of core stations

	Conclusion
	Acknowledgements
	References




