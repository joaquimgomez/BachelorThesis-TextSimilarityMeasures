






















































High quality illustrative effects for molecular rendering


Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

High quality illustrative effects for molecular rendering

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1

1 – Universitat Politècnica de Catalunya
2 – Barcelona Supercomputing Center

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Motivation

Motivation

Molecular Dynamics simulations: Computer simulations of physical
movements of atoms and molecules

Complex and time consuming process – days or weeks

New technological advances

Reduce calculation time to hours or minutes [Madadkar, 2013]
[Borrelli, 2005]

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Motivation

Motivation

Current visualization software

Difficult to understand the atoms arrangements
Advanced techniques:

Require pre-process
Lack of realistic shading effects

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Objectives

Objectives

Requirements:

Provide better understanding of shapes
Highlight ligand/protein interactions
Realtime & no-preprocess

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Outline

Outline

Ambient Occlusion

Halos

Conclusions & Future Work

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Algorithm overview:
1 Fill G-buffer with the scene information
2 Compute scene approximation – Occupancy pyramid
3 Compute ambient occlusion factor
4 Lighting and final composition

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Algorithm overview:
1 Fill G-buffer with the scene information
2 Compute scene approximation – Occupancy pyramid
3 Compute ambient occlusion factor
4 Lighting and final composition

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Algorithm overview:
1 Fill G-buffer with the scene information
2 Compute scene approximation – Occupancy pyramid
3 Compute ambient occlusion factor
4 Lighting and final composition

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Algorithm overview:
1 Fill G-buffer with the scene information
2 Compute scene approximation – Occupancy pyramid
3 Compute ambient occlusion factor
4 Lighting and final composition

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Occupancy pyramid:

3D mipmapped texture
Texel Occupied volume of the cell

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Approximation of the occupied volume – Compute Shader:

Atoms (Spheres): ra−r
D

Bonds (Cylinders):
D
2
−r
D

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

For each pixel of the screen:
Approximate visibility of semi-sphere Set of cones [Crassin, 2011]
Approximate cone visibility Accumulated occupancy of a set of
spheres [Crassin, 2011]
Sphere occupancy Occupancy pyramid

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Results

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Results

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Results

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Comparison with [Grottel, 2012]

Figure: Our method Figure: Grottel et
al.[Grottel, 2012] with
voxel resolution 163

Figure: Grottel et
al.[Grottel, 2012] with
voxel resolution 83

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Ambient occlusion

Ambient occlusion

Performance

Molecule name A 3J3A 1CWP 1K4R 3IYJ
#atoms 3.9K 46K 227K 545K 1356K

S-F
N

No AO 816.52 547.88 169.74 136.66 64.72
AO 201.22 265.45 89.16 70.83 34.09

F
No AO 3444.91 1491.38 499.96 456.49 96.05

AO 257.51 425.65 143.48 116.42 42.51

B&S
N

No AO 2255.4 1156.75 351.47 209.63 88.23
AO 706.51 345.12 123.88 64.6 30.63

F
No AO 3705.44 1858.25 600.48 276.19 108.08

AO 907.55 434.37 157.04 72.14 33.27

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Halos

Halos

Algorithm overview:
1 Update the stencil buffer with the

molecule to highlight
2 Render halo –pixels not marked in the

stencil buffer

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Halos

Halos

Algorithm overview:
1 Update the stencil buffer with the

molecule to highlight
2 Render halo –pixels not marked in the

stencil buffer

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Halos

Halos

Halo rendering algorithm:

Render the bounding box of the molecule
For each pixel cast a ray towards the camera
Accumulate the occupancy of all traversed voxels
Use accumulated value as halo transparency

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Halos

Halos

Visual feedback of previous positions

Do not clear the occupancy pyramid at each frame
Reduce the occupancy each frame using the following formula:

Of = Oi −max
(
t − to
T

, 1

)

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Halos

Halos

Results

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Halos

Halos

Results

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Halos

Halos

no halos ligand mol.

space filling
near 201.22 113.49 101.75
mid. 241.46 126.68 122.91
far 257.51 131.28 129.52

ball-and-stick
near 706.51 484.77 328.78
mid. 840.02 575.9 489.98
far 907.55 621.83 604.08

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Conclusions and Future Work

Conclusions & Future Work

Conclusions
Ambient occlusion algorithm

Full GPU-accelerated pipeline (uses compute shader & atomic
operations)
High quality shading in real-time
No pre-process required

Halo and Temporal Halo rendering algorithm

Highlights ligand and its recent path
Reuses the occupancy pyramid data structure
No pre-process required

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Conclusions and Future Work

Conclusions & Future Work

Conclusions
Ambient occlusion algorithm

Full GPU-accelerated pipeline (uses compute shader & atomic
operations)
High quality shading in real-time
No pre-process required

Halo and Temporal Halo rendering algorithm

Highlights ligand and its recent path
Reuses the occupancy pyramid data structure
No pre-process required

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

Conclusions and Future Work

Conclusions & Future Work

Future Work

Shadows
Antialiasing
Formal user study

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

References

S. Grottel, M. Krone, K. Scharnowski, and T. Ertl. (February 2012)

Object-space ambient occlusion for molecular dynamics

PacificVis

C. Crassin, F. Neyret, M. Sainz, S. Green, and E. Eisemann (2011)

Interactive indirect illumination using voxel cone tracing

Computer Graphics Forum (Proceedings of Pacific Graphics 2011)

Armin Madadkar-Sobhani and Victor Guallar (2013)

Pele web server: atomistic study of biomolecular systems at your fingertips

Nucleic Acids Research 41(W1):W322–W328

K. W. Borrelli, A. Vitalis, R. Alcantara, and V. Guallar (2005)

Pele: Protein energy landscape exploration. a novel monte carlo based technique

Journal of Chemical Theory and Computation 1(6):1304–1311

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering



Motivation Objectives Outline Ambient occlusion Halos Conclusions and Future Work

High quality illustrative effects for molecular rendering

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1

1 – Universitat Politècnica de Catalunya
2 – Barcelona Supercomputing Center

P. Hermosilla 1,2 & V. Guallar 2 & P.P. Vázquez 1 & A. Vinacua1 UPC

High quality illustrative effects for molecular rendering


	Motivation
	Motivation

	Objectives
	Objectives

	Outline
	Outline

	Ambient occlusion
	Ambient occlusion

	Halos
	Halos

	Conclusions and Future Work
	Conclusions and Future Work


