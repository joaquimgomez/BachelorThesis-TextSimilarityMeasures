













































Presentación de PowerPoint


Physics-based Visual 
Characterization of Molecular 

Interaction Forces
P. Hermosilla1,2, J. Estrada2, V. Guallar2, T. Ropinski3, A. Vinacua1, P-P. Vazquez1

1 – ViVIG (Barcelona)  
2 – Barcelona Supercomputing Center  (Barcelona)

3 – Visual Computing Group (Ulm)

moving group - upc



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Motivation

• Why?



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Motivation

• Molecular dynamics simulations
• Generate data to predict drug behavior

• Previous to real experimentation

• Helps understanding molecular interactions

• Limited
• Time, visualized features…



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Motivation

• Commonly analyzed scenarios
• Static frames

• Only atom-atom interaction

• Desired scenarios
• Residue-based analysis

• Visual communication

• Fast interaction & inspection

• We have you covered! 



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Motivation



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Goals & requirements

• Realtime visual analysis of interaction energies
• Full pathway simulation

• Explorative analysis

• Individual energies

• Distance & energy filtering



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Goals & requirements

• Example questions to be answered
• Q1: Which are the most active groups in the interactions between molecules?

• Q2:  Which are the most powerful binding energy components at a certain simulation 
configuration?

• Q3: Is the proximity of the drug causing instability in any residue of the protein?

• Q4: Is the ligand solvation force favoring or rejecting binding?

• Q5: Which residues (if any) prevent drug delivery?



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Outline

• Previous work

• Overview of the application

• Features

• Implementation

• Results & Conclusions



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Previous Work

• Limitations of existing software
• Single visualization

• Single frame analysis

• Not interactive

• Only limited to close-view visualizations/interactions

PLIP
Maestro



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Application design

• Overview



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Application design

• Overview

Interaction forces 
illustrated



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Application design

• Overview

Energy types



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Application design

• Overview

2D abstract view



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Application design

• Overview

Cut-away & 
context



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Zoom & Filter

• Visual illustration of energies

• Visual illustration of energies
• Type, strength & direction

• Color

• Cone size

• Cone orientation

Ligand solvation energy

Dominant energy type, 
maginute and sign

Magnitude and direction the
total interaction energy

Energy codings



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Zoom & Filter

• Visual illustration of energies
• Type, strength & direction

• Both in the 3D & 2D views

• Individually toggle on/off

• Different rendering modes 
• Provide room for energy coding



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Zoom & Filter

• Context
• Clipping plane

• Semi-transparent visualization of the molecule

• Different rendering types (space-filling, ball & sticks, licorice…)

• Selection
• Residues



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Zoom & Filter

• Initial exploration ➜ Energy filtering to under -5kcal/mol
• [Solves Q1]



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Details on demand

• Abstract view
• Provides details on residues

• Linked view

• Coordinated with frame step



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Implementation details

• Application workflow



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Implementation details

• Energy model: ΔGbind = EVDW + Eele + ΔGsol

• EVDW➜ O(n)

• Eele ➜ O(n)

• ΔGsol ➜ O(n
2)



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Implementation details

• Calculation
• ΔGsol ➜ Compute shader

• Each thread computes 16 interactions

• EVDW and Eele ➜ Compute shader
• Each thread computes the interaction between ligand and atom group

• More than 20 times per second for molecules up to 18k atoms (GTX 980)



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Implementation details

• Filtering:
• Energy types

• Distance range [dmin, dMax] 

• Energy range [-∞, emin-] [eMin+, + ∞]



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Implementation details

• Abstract view. Algorithm:
• Calculate projection plane

• Determine number of active groups

• Divide plane around ligand in sectors

• Project atom groups onto the plane and sort them clockwise

• Render the groups in the sectors

• All groups are rendered maximizing their projected area (PCA)



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Results

• Single conformation analysis
• Binding energy analysis

• [Solves Q2]



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Results

• Single conformation analysis
• Hypothesis testing: Palmitate’s solvation 

term, when inside the protein, indicates 
that, contrary to the hypothesis, it does 
not favor binding. 
• Note the high energy value color coded in 

its silhouette

• Being a fatty molecule, the expected value 
would be low (grey)



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Results

• Trajectory analysis
• Using the abstract view

• Evaluates stability

• [Solves Q2]



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Results

• Trajectory analysis
• Close-view binding energy 

analysis
• Identifies strong 

interactions

• [Solves Q2]



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Results

• Trajectory analysis
• Filter by distances

• Distant interactions 
identification



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Evaluation

• Shown to two different experts (protein engineering and computer aided drug 
design)
• Very useful

• Suitable for protein engineering tasks

• Could be used for enzyme engineering

• Data presentation

• “Very intuitive”

• Semi-transparent context “very interesting”

• Cones permit easy identification of interaction forces and direction



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Conclusions & Future Work

• New visualization application for binding forces analysis
• Residue-level

• Facilitates gaining understanding on docking simulations
• Explanations on the interacting residues

• Identifies strong actors

• Identifies distant binding energies



Pere-Pau Vázquez – ViRVIG Group, UPC - pere.pau@cs.upc.edu 

Conclusions & Future Work

• Support full interactive analysis
• In contrast to Maestro or PLIP

• Show full path
• Other tools only single steps

• Linked views provides 2D and 3D visualizations at the same time



Physics-based Visual 
Characterization of Molecular 

Interaction Forces
P. Hermosilla1,2, J. Estrada2, V. Guallar2, T. Ropinski3, A. Vinacua1, P-P. Vazquez1

1 – ViVIG (Barcelona)  
2 – Barcelona Supercomputing Center  (Barcelona)

3 – Visual Computing Group (Ulm)

moving group - upc


