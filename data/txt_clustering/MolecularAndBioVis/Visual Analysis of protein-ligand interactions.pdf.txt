













































Visual Analysis of protein-ligand interactions


Visual Analysis of protein-
ligand interactions

P. Vázquez1, P. Hermosilla2, J. Estrada3, V. Guallar3, A. Vinacua1

1 ViRVIG Group, UPC

2 U. Ulm

3 Barcelona SuperComputing Center

20th EG/VGTC 
Conference on Visualization



Motivation

• Molecular Simulations

• Evaluate binding affinity of ligands to proteins

• Great utility for drug design

• Result is a set of snapshots (trajectory)



Motivation

• Molecular Simulations generate a lot of data 



Motivation
Tunnel properties [Byska et al., 2015]

Residues interactions [Hermosilla et al., 2016]

Maestro’s SID 
[Scrhödinger, 2018]



Motivation

• Data analysis is time consuming

• No specific tools for overview simulation

• Requirements

• Whole trajectory analysis

• Including physico-chemical properties, e.g. per-residue energy 
interactions, h-bonds, fluctuations



Objectives

• Facilitate trajectory analysis

• Most flexible residues?

• Residues interacting with the ligand at a certain distance?

• Facilitate trajectories comparison

• Which residues intervene in the docking? What if we change the ligand?

• How differ these simulations?



Objectives

• Our solution

• Discards 3D structure information

• Preserve secondary structures and residue distribution

• Reduce screen footprint

• Individual trajectory snapshots

• Leave room to show simulation-related data (RMSF, h-bonds…)

• Interactive, compact visual analysis of multiple data



Outline

• Background

• Design: Visually supported trajectory analysis

• Use cases

• Conclusions & Future Work



Proteins

• Chains of amino-acids

Background Design Use cases Conclusions



Simulation energy

• Free energy of binding

• Low energy levels are more stable

• Summation of terms

• Total energy

• EvdW: van der Waals energy (short-range)

• Evac: electrostatic energy in the vacuum (long-range)

• Esolv: electrostatic energy due to the solvent

∆𝐺𝑏𝑖𝑛𝑑≈ 𝐸𝑣𝑑𝑊 + 𝐸𝑣𝑎𝑐 + 𝐸𝑠𝑜𝑙𝑣

Background Design Use cases Conclusions



Energy visualization

[Hermosilla et al., 2016]

Background Design Use cases Conclusions



Root Mean Square Fluctuation

• Root Mean Square Fluctuation: average fluctuation of a 
residue’s atom around a reference position

𝑅𝑀𝑆𝐹𝑖 =
1

𝑇
෍

𝑡=1

𝑇

𝑟𝑖
′ 𝑡 − 𝑟𝑖

′ 𝑡𝑟𝑒𝑓
2

Background Design Use cases Conclusions



Bonds, hydrogen bonds

• Cause the molecule to fold into a specific shape

• Secondary structures are determined by H-bonds 

• Regularly occurring bonds between aminoacids  alpha helix

• Aminoacids of different strands  beta sheets

Background Design Use cases Conclusions



Hydrogen bonds

From: OpenStax Biology

Background Design Use cases Conclusions



Data

• Thousands of atoms x hundreds of steps

• Hundreds of residues

• A dozen or so of secondary structures

• Each step:

• Atoms positions

• System energy

• Energy between ligand & residues (3 types)

• H-Bonds (2 types)

Background Design Use cases Conclusions



Data

• Molecular structure & fluctuation

Background Design Use cases Conclusions

A
to

m
s 

(t
h

o
u

sa
n

d
s)

Steps

<x,y,z>

S
e

co
n

d
a

ry
 s

tr
u

ct
u

re
s

Residue ids (dozen)

R
e

si
d

u
e

s 
(h

u
n

d
re

d
s)

RMSF



Data

• H-bonds

Background Design Use cases Conclusions

S
te

p
s 

(h
u

n
d

re
d

s)

H-bonds (dozens)

S
te

p
s 

(h
u

n
d

re
d

s)

Intra H-bonds



Data

• Energy

Background Design Use cases Conclusions

R
e

si
d

u
e

s 
(h

u
n

d
re

d
s)

Steps (hundreds)

<Coulomb el., Coulomb vac., solvation>

S
te

p
s 

(h
u

n
d

re
d

s) Energy (∑<…>)



Data

• Atoms’ positions per step, dynamic  REMOVE

• Residues (molecular structure), static  KEEP

• Energy (1 value) per step, dynamic  KEEP

• Inter-molecular h-bonds per step (connections to residues, backbone 
& side chain configuration), dynamic  KEEP

• Intra-molecular h-bonds per step (pairs of connections, donor & 
acceptor), dynamic  KEEP

• Residues vs ligand energies (3 values) per step, dynamic  KEEP

• RMSF per residue, static  KEEP

Background Design Use cases Conclusions



Data

• Derived values

• Minimum energy per residue along simulation

• Maximum energy per residue along simulation

Background Design Use cases Conclusions



Main idea
Background Design Use cases Conclusions



Overview

Secondary 
structures

Residues

LigandAttractive Energies 
& h-bonds

Repulsive 
Energies & RMSF

Background Design Use cases Conclusions



Molecular structure
Background Design Use cases Conclusions



Molecular structure
Background Design Use cases Conclusions



RMSF 
Background Design Use cases Conclusions



Energy
Background Design Use cases Conclusions



Energy
Background Design Use cases Conclusions



Hydrogen bonds
Background Design Use cases Conclusions



Hydrogen bonds
Background Design Use cases Conclusions



Energy chart
Background Design Use cases Conclusions



Controls

Energy chart

Property Views

Dynamic legends and
details on demand



Views



Interaction

Selection

Hover

Selection

Background Design Use cases Conclusions



Implementation

• Input:

• Real data from Monte Carlo-based Molecular Simulations

• Stored as JSon files

• JavaScript + D3

• Any capable browser

• Example in: www.cs.upc.edu/~ppau/Visualization/BondsVis.html

Background Design Use cases Conclusions

http://www.cs.upc.edu/~ppau/Visualization/BondsVis.html


Implementation

• Modular Design

Background Design Use cases Conclusions



Shape changes

• Analyzing shape changes induced by protein-ligand interaction

1. Infer shape changes from RMSF view

2. Analyze trajectory range with high degree of interaction of the implied 
residues

3. Inspect h-bonds

Background Design Use cases Conclusions



Use cases. Fluctuation analysis



Binding analysis
Background Design Use cases Conclusions



Domain experts’ input

• Informal user study

• Practical session (20-30 minutes) + questionnaire

• Experts were interested to use it in their work

• Helps them to better understand the overall behavior of a simulation, and to infer h-
bonds formation. 

• Particularly useful to summarize trajectories

• Features not available in known software 

• Extra features

• Would add some more simulation properties and a coupled 3D view

Background Design Use cases Conclusions



Conclusions

• Compact way to display MS information

• Removing 3D structure

• But backbone configuration

• Analysis of whole MS trajectory

• On-site comparison of different simulations

Background Design Use cases Conclusions



Future Work

• Add multiple simulations 

• Maybe large screen

• Add 3D view on demand

Background Design Use cases Conclusions



Visual Analysis of protein-
ligand interactions

P. Vázquez1, P. Hermosilla2, J. Estrada3, V. Guallar3, A. Vinacua1

20th EG/VGTC 
Conference on Visualization

Acknowledgments

Spanish Ministry of Enconomía and Competitividad under Grants TIN2014- 52211-C2-1-R 
and TIN2017-88515-C2-1-R (GEN3DLIVE), by CTQ2016-79138-R, and by DFG under grants 

RO 3408/2-1 and RO 3408/3-1.

Also thanks to my son Marçal.


