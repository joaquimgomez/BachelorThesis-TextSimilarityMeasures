simp-al : general simp method base topolog deriv concept receiv : 15 march 2019 revis : 21 may 2019 accept : 4 june 2019 doi : 10.1002/nme.6140 r e e r c h r c l e simp-al : general simp method base topolog deriv concept a. ferrer1,2 1centr de mathmatiqu appliqu , cole polytechniqu , universit paris-saclay , palaiseau , franc 2centr internacion de mtode numric en enginyeria ( cimn ) , campus nord upc , barcelona , spain correspond a. ferrer , centr de mathmatiqu appliqu , cole polytechniqu , universit paris-saclay , 91128 palaiseau , franc ; centr internacion de mtode numric en enginyeria ( cimn ) , campus nord upc , edifici c-1 , c/jordi girona 1-3 , 08034 barcelona , spain .
email : aferr @ cimne.upc.edu fund inform european union 's horizon 2020 research innov programm , grant/award number : 712949 ; agenc busi competit govern catalonia summari topolog optim emerg last year promis research field wide rang applic .
one success approach , simp method , base regular problem propos penaliza- tion interpol function .
work , propos altern interpol function , simp-al method base topolog deriv con- cept .
first , show strong relat plane linear elast hashin-shtrikman ( h-s ) bound topolog deriv , provid new interpret last one .
, show simp-al interpo- lation remain alway h-s bound regardless materi interpol .
result allow us interpret intermedi valu real microstructur .
final , verifi numer result show con- venienc propos simp-al interpol obtain auto-pen optim design wider rang case .
matlab code simp-al interpol function also provid .
keyword hashin-shtrikman bound , simp , topolog deriv , topolog optim 1 introduct recent year , topolog optim becom research field , arous interest scientif communiti also provid success solut industri problems.1 tradit , topolog optim seek design light-weight structur compon without lose stiff capabl .
last year , address field applic equal success .
propos , sever approach emerg last decad .
initi , topolog optim success address regular techniqu .
simp method repres probabl celebr strategi .
characterist function , usual use describ weak ( white ) stiff ( black ) subdomain , regular allow intermedi valu , word , allow presenc gray area .
frequent , regular represent characterist common name densiti function .
usual , challeng character materi properti intermedi valu densiti function ( gray area ) .
character common describ interpol function .
refer work bends sigmund,2 simp method propos polynomi interpol function , case , lie insid hashin-shtrikman ( h-s ) bound .
could lead gray area sometim interpret microstructur .
addit , depend natur materi , simp method could propos weak interpol penal , consequ , larg gray area could appear .
open access articl term creativ common attribut licens , permit use , distribut , reproduct medium , provid origin work proper cite .
 2019 author .
intern journal numer method engin publish john wiley & son , ltd. int j numer method eng .
2019 ; 120:361381 .
wileyonlinelibrary.com/journal/nm 361 https : //doi.org/10.1002/nme.6140 https : //orcid.org/0000-0003-1011-0230 362 ferrer sens , novel project method enabl promis black white topologies.3 howev , even gray area appear use project method , final topolog could signific suboptim sinc influenc materi properti provid correspond interpol .
circumv limit order fulfil h-s bound , interpol function also propos .
exampl found work stolp svanberg4 dzierzanowski.5 altern , due concept shape deriv , shape optim also establish refer strategi solv topolog optim problem .
usual , domain describ level-set function , turn , advect use shape deriv express object function .
case , shape deriv play role veloc field hamilton-jacobi equation.6 although algorithm requir consid initi hole , increas merg , result new topolog iter , optim shape present intermedi valu clear defin boundari .
likewis , topolog deriv address topolog optim intent consid intermedi valu .
concept base studi sensit function circular ( ellipsoid ) inclus weak materi insert stiff materi ( vice-versa ) .
asymptot expans solv exterior problem , obtain topolog deriv close formula certain measur adequaci insert certain point weak/stiff inclus .
valu concept frequent exploit level-set algorithm .
pioneer work amstutz andr7 clear exampl .
approach found work allair et al8 yamada et al.9 addit , find literatur discret evolutionari algorithm , like beso,10 competit alter- nativ solv problem .
although high effici clear larg problem , signific progress achiev due increas avail comput power .
last year , numer techniqu decreas compu- tation cost topolog optim problem develop , like adapt mesh refinement11 polytree-bas adapt polygon finit element method.12 although , first sight , describ approach may seem differ , connect observ work amstutz13 case topolog deriv simp method approach , especi poisson ratio stiff materi around 13 .
present work follow general result work .
first main result present work connect topolog deriv h-s bound .
result allow us new physic interpret topolog deriv concept .
, base topolog deriv , propos simp-al interpol .
apart free heurist paramet , show , second main result work , alway remain h-s bound regardless stiff weak materi properti want interpol .
result provid us physic interpret term microstructur use simp-al interpol .
note propos interpol strategi conveni characterist function appear insid differenti oper .
case , interpol need , see exampl , work s et al.14 valid result , differ case present compar simp-al simp interpol function relat h-s bound .
final , numer exampl comput see influenc conveni interpol function optim topolog .
addit , matlab code simp-al interpol provid .
work organ follow .
section 2 present bimateri topolog optim problem .
section 3 introduc concept topolog deriv present topolog deriv isotrop materi term shear bulk modulus .
h-s bound briefli present section 4 connect topolog deriv .
special kind ration function use work defin section 5 , simp-al interpol function present section 6 .
section 7 includ comparison simp simp-al relat h-s bound .
addit , numer exampl comput observ influenc interpol function optim topolog .
present work conclud section 8 .
2 topolog optim formul 2.1 exact topolog optim problem let  fix domain split 1 0 enough regular , fulfil 1  0 =  1  0 =  .
let boundari  defin  =  split d n let space  ,  ,  defin  = {   h1 (  )  |d = u0 } ,  = {   h1 (  )  |d = 0 } ,  = l (  , { 0 , 1 } ) .
( 1 ) ferrer 363 , let us defin characterist function    fourth-ord tensor c (  )  ( x ) = { 0 x  0 1 x  1 c (  ) = ( 1   ) c0 + c1 .
( 2 ) constitut tensor c0 c1 plane stress linear elast defin c1 = 21i + ( 1  1 )  c0 = 20i + ( 0  0 )  , ( 3 ) repres fourth- second-ord ident tensor and1 , 1 and0 , 0 bulk shear modulus materi 1 0 , respect .
introduc bilinear linear form linear elast problem (  , u , v ) =  su  c (  )  su l ( v ) = n  v , ( 4 ) exact topolog optim problem defin follow : find    u   min .
 , u j (  , u ) = l ( u ) s.t .
  v (  , u , v ) = l ( v ) v   , ( 5 ) , case , cost j (  , u ) stand complianc function .
2.2 relax topolog optim problem difficulti solv exact problem usual circumv propos relax version , replac characterist function density-lik function  ( x )  [ 0 , 1 ] , , contrast characterist function , take intermedi valu .
thus , exact topolog optim problem rewritten follow regular topolog optim problem : find    = l (  , [ 0 , 1 ] ) u   min .
 , u j (  , u ) = l ( u ) s.t .
  v (  , u , v ) = l ( v ) v   , ( 6 ) bilinear linear form defin (  , u , v ) =  su  c (  )  su l ( v ) = n  v. ( 7 ) case , constitut tensor take follow form : c (  ) = 2 (  ) + (  (  )   (  ) )  , ( 8 )  (  )  c ( [ 0 , 1 ] , [ 0 , 1 ] )  (  )  c  ( [ 0 , 1 ] , [ 0 , 1 ] ) interpol function must propos .
comput complianc gradient .
let complianc function l ( u ) defin ( 7 ) let u   solut elast problem defin ( 6 ) , gradient complianc take follow form : g (  ) = su  c (  )  su , ( 9 ) c (  ) deriv constitut tensor defin ( 8 ) .
see result , let us defin implicit function f (  ) f (  ) = (  , u (  ) , v )  l ( v ) = 0 v   , ( 10 ) 364 ferrer let us comput differenti .
ellipt arguments,15 state  v      provid coerciv constitut tensor , exist uniqu u   solv (  , u (  ) , v ) = l ( v ) .
thus , defin densiti variat    , state f (  +  ) = f (  ) = 0 , consequ , f (  +  )  f (  ) = (  +  , u (  +  ) , v )  (  , u (  ) , v ) = (  +  , u (  +  ) , v )  (  +  , u (  ) , v ) + (  +  , u (  ) , v )  (  , u (  ) , v ) = (  +  , u (  ) + du (  )  , v )  (  +  , u (  ) , v ) + da (  , u (  ) , v )  + ( ||||2 ) = (  +  , du (  )  , v ) + da (  , u (  ) , v )  + ( ||||2 ) = (  , du (  )  , v ) + da (  , u (  ) , v )  + ( ||||2 ) = 0 , ( 11 ) da (  , u (  ) , v ) frchet deriv respect first argument bilinear form (  , u , v ) du (  ) frchet deriv u  .
, differenti complianc comput l ( u (  +  ) )  l ( u (  ) ) = (  , u (  ) , du (  )  ) + ( ||||2 ) = (  , du (  )  , u (  ) ) + ( ||||2 ) = da (  , u (  ) , v )  + ( ||||2 ) =  [ (  +  , u (  ) , v )  (  , u (  ) , v ) ] + ( ||||2 ) =  su  ( c (  +  ) c (  ) )  su + ( ||||2 ) =  su  ( c (  )  )  su + ( ||||2 ) = dl (  )  + ( ||||2 ) , ( 12 ) use symmetr behavior bilinear form result ( 11 ) .
note , neglect higher-ord term , suppos remind ( ||||2 ) small enough .
proof end relat gradient g (  ) complianc frchet deriv dl ( u ) riesz represent theorem , ie , dl (  )  = g .
3 topolog deriv given domain ( unperturb )   r2 , let us insert certain point x small circular inclus b radius  > 0 .
call new ( perturb ) domain  ( see figur 1 ) .
definit 1 .
let j (  ) j (  ) valu function unperturb perturb domain .
certain posit function f (  ) f (  )  0   0 , typic , f (  ) = 2 , defin topolog deriv j (  ) follow limit : gt ( x ) = lim 0+ j (  )  j (  )  (  ) .
( 13 ) remark 1 .
note make express ( 13 ) well defin , need ask function j (  ) admit follow asymptot expans : j (  )  j (  ) =  (  ) gt ( x ) + (  (  ) ) .
( 14 ) definit 2 .
given young 's modulus poisson 's ratio matrix b inclus b , repres em , m ei , i respect , defin fourth-ord polar tensor p p = p1i + p2i  , ( 15 ) figur 1 topolog deriv concept ferrer 365 paramet p1 p2 take follow valu : p1 = 1  + 1 ( 1 +  ) ( 1   ) p2 = 1 2 (    )  + 1 [  (   23 ) + 12 ]  + 2 , ( 16 ) coeffici  ,  ,  , 1 , 2 , 3 form  = 1 + m 1  m ,  = 3  m 1 + m ,  = ei em , ( 17 ) 1 = 1 + i 1 + m , 2 = 1  i 1  m , 3 = i ( 3m  4 ) + 1 m ( 3m  4 ) + 1 .
( 18 ) proposit 1 .
let u   solut elast problem defin ( 6 ) , let complianc l ( u ) defin ( 7 ) , let polar tensor p express definit 1 , topolog deriv point x , defin definit 1 , follow : gt ( x ) =  ( x )  p  su ( x ) , ( 19 ) s symmetr gradient oper  = cm  su stress cm constitut tensor matrix domain .
proof .
result trivial obtain propos asymptot expans solut topolog- ical perturb problem analyt solv associ exterior problem .
see work novotni sokoowski16 full detail .
result valu poisson ratio , see work giusti et al.17 easier comparison h-s bound , seek rewrit topolog deriv term shear bulk modulus .
topolog deriv term shear bulk modulus .
let us defin paramet m = mm 2m+m m = m term shear bulk modulus matrix m , km insert i ,  let us defin shear bulk polar paramet q q q = q ( m , i , m ) , q = q ( m , i , m ) q ( t1 , t2 , t3 ) = ( t1 + t3 ) t1 ( t2 + t3 ) .
( 20 ) , topolog deriv x written term shear bulk modulus ( matrix inclus ) follow : gt ( x ) = su ( x )  dc  su ( x ) dc = 2di + [ d  d ]  , ( 21 ) paramet d d d = m ( i  m ) q d = m ( i  m ) q .
( 22 ) obtain express , let shear bulk polar coeffici q q comput first q = p ( m  i ) q = p ( m  i ) p = p1 p = 2p1 + p2 .
( 23 ) insert lame paramet relat plane stress e = 4 + ,  =  + coeffici defin ( 17 ) ( 18 ) replac ( 16 ) , write shear bulk polar coeffici follow : q = ( m + mm 2m+m ) m ( i + mm 2m+m ) q = ( m + m ) m ( i + m ) , ( 24 ) 366 ferrer precis q ( m , i , m ) q ( m , i , m ) .
, replac relat ( 23 ) ( 15 ) , direct rewrit polar tensor p = pi+ 1 2 ( p  p )  .
proof end replac last relat constitut tensor matrix cm = 2mi + ( m  m )  topolog deriv express ( 19 ) .
remark 2 .
clear identifi two differ case .
( ) stiffer inclus insert : defin case say , point x  0 parametersm = 0 , m = 0 , add inclus paramet i = 1 i = 1 .
, topolog deriv gt0 scenario take point x follow form : gt0 ( x ) =  su ( x )  dc0  su ( x ) , ( 25 ) dc0 = 20 ( 1  0 ) q0i + [ 0 ( 1  0 ) q0  0 ( 1  0 ) q0 ]  , ( 26 ) q0 = q ( 0 , 1 , 0 ) , q0 = q ( 0 , 1 , 0 ) , 0 = 00 20+0 , 0 = 0 posit valu .
( ii ) weaker inclus insert : similar , defin opposit case identifi point x  1 matrix paramet asm = 1 , m = 1 paramet inclus asi = 0 i = 0 .
, topolog deriv gt1 take point x follow form : gt1 ( x ) =  su ( x )  dc1  su ( x ) , ( 27 ) dc1 = 21 ( 0  1 ) q1i + [ 1 ( 0  1 ) q1  1 ( 0  1 ) q1 ]  , ( 28 ) q1 = q ( 1 , 0 , 1 ) , q1 = q ( 1 , 0 , 1 ) , 1 = 11 21+1 1 = 1 also posit valu .
remark 3 .
follow semin work amstutz,13 one could think propos interpol scheme gradient 1 0 coincid precis topolog deriv .
distinguish scenario .
( ) stiffer inclus insert : take  = 2 b ( x ,  ) zero otherwis , b ( x ,  ) repres small circular ball center x radius  .
mean , replac small circular domain matrix small circular inclus , add small amount densiti .
, want taylor 's expans ( 12 ) match asymptot expans ( 14 ) , must defin interpol , x  0 (  = 0 ) , g ( 0 ) = gt0 ( x ) = c  ( 0 ) = dc0 = {  ( 0 ) = 0 ( 1  0 ) q0  ( 0 ) = 0 ( 1  0 ) q0 , ( 29 ) ( ii ) weaker inclus insert : case , take  = 2 b ( x ,  ) zero otherwis .
mean , replac small circular domain matrix small circular inclus , subtract small amount densiti .
similar , match expans , defin interpol , x  1 (  = 1 ) , g ( 1 ) = gt1 ( x ) = c  ( 1 ) = dc1 = {  ( 1 ) = 1 ( 1  0 ) q1  ( 1 ) = 1 ( 1  0 ) q1 .
( 30 ) 4 connect topolog deriv hashin-shtrikman bound h-s bound .
let us suppos composit materi shear bulk constitut properti h h com- pose two-phas materi fraction volum   [ 0 , 1 ] .
let us assum shear bulk modulus constitu composit 0 0 1 1 satisfi 1 > 0 .
, shear bulk modulus ferrer 367 composit materi h h upper lower bound regardless arrang phase .
addit , bound , common call isotrop h-s bound , written , case shear modulus , lb (  ) = 0 ( 1   ) + 1  ( 1   )  ( 1  0 ) 2 0 + 1 ( 1   ) + 00 20+0 ub (  ) = 0 ( 1   ) + 1  ( 1   )  ( 1  0 ) 2 0 + 1 ( 1   ) + 11 21+1 ( 31 ) similar bulk modulus case lb (  ) = 0 ( 1   ) + 1  ( 1   )  ( 1  0 ) 2 0 + 1 ( 1   ) + 0 ub (  ) = 0 ( 1   ) + 1  ( 1   )  ( 1  0 ) 2 0 + 1 ( 1   ) + 1 .
( 32 ) bound develop work hashin shtrikman.18 see also refer book bends sigmund19 allaire.20 remark 4 .
note bound express follow general form ( general h-s bound ) : hs (  ) = 0 ( 1   ) + 1  ( 1   )  ( 1  0 ) 2 0 + 1 ( 1   ) +  , ( 33 ) shear bulk h-s bound recov choos valu describ follow tabl .
remark 5 .
note deriv h-s bound compon rewritten follow : { lb ( 0 ) = 0 ( 1  0 ) q0 ub ( 1 ) = 1 ( 1  0 ) q1 { lb ( 0 ) = 0 ( 1  0 ) q0 ub ( 1 ) = 1 ( 1  0 ) q1 .
( 35 ) fact , way rewrit h-s bound deriv obtain simpl calcul .
equat ( 33 ) , general h-s bound rewritten hs (  ) = 0dhs0 ( 1   ) + 1d hs 1  dhs0 ( 1   ) + hs 1  dhs0 = ( 1  0 ) 2 0 +  , dhs1 = ( 1  0 ) 2 1 +  , ( 36 ) consequ , deriv general h-s bound express  hs (  ) = dhs0 hs 1 ( 1  0 ) [ dhs0 ( 1   ) + hs 1  ] 2 .
( 37 ) 368 ferrer thus , valu compon  hs ( 0 ) = dhs1 dhs0 ( 1  0 ) = 0 +  1 +  ( 1  0 )  hs ( 1 ) = dhs0 dhs1 ( 1  0 ) = 1 +  0 +  ( 1  0 ) .
( 38 ) insert ( 34 ) ( 37 ) use definit q ( 20 ) , deriv h-s bound shear modulus 0 (  = 0 ) 1 (  = 1 ) lb ( 0 ) = ( 0 + 0 ) ( 1  0 ) 1 + 0 = 0 ( 0  1 ) q ( 0 , 1 , 0 ) = 0 ( 1  0 ) q0 lb ( 1 ) = ( 1 + 0 ) ( 1  0 ) 0 + 0 = 1 ( 1  0 ) q ( 1 , 0 , 0 ) ub ( 0 ) = ( 0 + 1 ) ( 1  0 ) 1 + 1 = 0 ( 0  1 ) q ( 0 , 1 , 1 ) ub ( 1 ) = ( 1 + 1 ) ( 1  0 ) 0 + 1 = 1 ( 1  0 ) q ( 1 , 0 , 1 ) = 1 ( 1  0 ) q1 .
( 39 ) similar , deriv h-s bound bulk modulus 0 (  = 0 ) 1 (  = 1 ) written lb ( 0 ) = ( 0 + 0 ) ( 1  0 ) 1 + 0 = 0 ( 0  1 ) q ( 0 , 1 , 0 ) = 0 ( 1  0 ) q0 lb ( 1 ) = ( 1 + 0 ) ( 1  0 ) 0 + 0 = 1 ( 1  0 ) q ( 1 , 0 , 0 ) ub ( 0 ) = ( 0 + 1 ) ( 1  0 ) 1 + 1 = 0 ( 0  1 ) q ( 0 , 1 , 1 ) ub ( 1 ) = ( 1 + 1 ) ( 1  0 ) 0 + 1 = 1 ( 1  0 ) q ( 1 , 0 , 1 ) = 1 ( 1  0 ) q1 .
( 40 ) topolog deriv h-s bound deriv .
one two main result work .
let us defin two materi compon shear bulk materi properti 0 , 0 1 , 1 , respect , let us propos interpol function model mixtur mean fraction volum  = [ 0 , 1 ] close 0 coincid h-s lower bound close 1 h-s upper bound .
, gradient complianc coincid topolog deriv 0 1 .
see result , equat ( 9 ) , write gradient complianc ( use isotrop lower upper bound interpol function ) follow : glb ( 0 ) = su  clb ( 0 )   su clb (  ) = 2lb (  ) + [ lb (  )  lb (  ) ]  gub ( 1 ) = su  cub ( 1 )   su cub (  ) = 2ub (  ) + [ ub (  )  ub (  ) ]  .
( 41 ) , identifi coeffici ( 39 ) ( 40 ) precis one establish topolog deriv ( 29 ) ( 30 ) , thus , { c  lb ( 0 ) = dc0 x  0 c  ub ( 1 ) = dc1 x  1 .
( 42 ) final , use ( 42 ) equat ( 25 ) , ( 27 ) , ( 9 ) , obtain { glb ( 0 ) = gt0 ( x ) x  0 gub ( 1 ) = gt1 ( x ) x  1 .
( 43 ) ferrer 369 remark 6 .
result confirm materi neighborhood infinitesim inclus insert perturb domain use comput topolog deriv understood homogen microstructur circular inclus ( h-s bound microstructur ) fraction volum valu equival infinitesim inclus volum .
say , order studi chang complianc , topolog deriv concept propos fact insert h-s microstructur .
5 ration function definit 3 .
let us introduc follow particular famili ration function :  = {   c ( [ 0 , 1 ] , [ 0 , 1 ] ) |  (  ) = a2 + b + cd + 1 } , ( 44 ) , b , c ,  1 scalar paramet determin fix valu deriv extrem , ie ,  ( 0 ) = 0 ,   ( 0 ) = .
 0 ,  ( 1 ) = 1 ,   ( 1 ) = .
 1 .
( 45 ) remark 7 .
note function    equival follow express :  (  ) = d01 ( 1   )  + 0d0 ( 1   ) + 1d1 d0 ( 1   ) + d1  d01 = .
 1 .
 0  ( 1  0 ) 2 d0 = .
 1  ( 1  0 ) d1 = ( 1  0 )  .
 0 .
( 46 ) result easili obtain comput deriv ration function   (  ) = ad2 + 2a + ( b  cd ) ( d + 1 ) 2 ( 47 ) impos condit ( 45 ) .
, solv system four equat find valu paramet , b , c , d. =  .
 1 .
 0 + ( 1  0 ) 2 .
 1 + ( 1  0 ) , b = 20 ( 1  0 ) + .
 1 .
 0  1 .
 0  .
 10 .
 1 + ( 1  0 ) , c = 0 , = 2 ( 1  0 )  ( .
 1 + .
 0 ) .
 1 + ( 1  0 ) .
( 48 ) remark 8 .
note , definit , follow properti hold : d01 = ( f1  f0 ) ( d0  d1 )  d0d1 .
remark 9 .
general h-s bound therefor upper lower bound shear bulk modulus ration function .
easili seen impos d01 = 0 , d0 = dhs0 = ( 1  0 ) 2 0 +  , d1 = dhs1 = ( 1  0 ) 2 1 +  ( 49 ) general ration equat ( 46 ) obtain hs (  ) = 0dhs0 ( 1   ) + 1d hs 1  dhs0 ( 1   ) + hs 1  , ( 50 ) precis general h-s equat ( 33 ) .
370 ferrer 6 simp-al method idea simp-al method precis propos interpol gradient complianc coincid topolog deriv 0 1 .
alreadi shown equat ( 43 ) , case isotrop materi , equival impos deriv h-s lower bound 0 deriv h-s upper bound 1 shear bulk modulus interpol .
definit 4 .
simp-al function fsa (  ) defin ration functionwith h-s bound deriv ( lower  = 0 upper  = 1 ) deriv paramet .
0 .
1 .
.
0 =  hs ( 0 ) = 0 + 0 1 + 0 ( 1  0 ) .
1 =  hs ( 1 ) = 1 + 1 0 + 1 ( 1  0 ) .
( 51 ) remark 10 .
note shear bulk simp-al interpol function sa (  ) sa (  ) rewritten follow compact form : sa (  ) = ( 1  0 ) ( 0  1 ) ( 1   )  + 0 ( 1 + 0 ) ( 1   ) + 1 ( 0 + 1 )  ( 1 + 0 ) ( 1   ) + ( 0 + 1 )  sa (  ) = ( 1  0 ) ( 0  1 ) ( 1   )  + 0 ( 1 + 0 ) ( 1   ) + 1 ( 0 + 1 )  ( 1 + 0 ) ( 1   ) + ( 0 + 1 )  , ( 52 ) 0 = 00 20+0 , 1 = 11 21+1 , 0 = 0 , 1 = 1 previous defin ( 34 ) .
express easili obtain comput ration function paramet d01 , d0 , d1 defin equat ( 46 ) .
case simp-al interpol , written dsa01 = .
 1 .
 0  ( 1  0 ) 2 = ( 1  0 ) 2 ( 0 + 0 1 + 0 1 + 1 0 + 1  1 ) = ( 1  0 ) 3 ( 0  1 ) ( 0 + 1 ) ( 1 + 0 ) dsa0 = .
 1  ( 1  0 ) = ( 1  0 ) ( 1 + 1 0 + 1  1 ) = ( 1  0 ) 2 0 + 1 dsa1 = ( 1  0 )  .
 0 = ( 1  0 ) ( 1  0 + 0 1 + 0 ) = ( 1  0 ) 2 1 + 0 .
( 53 ) paramet let us build simp-al general interpol function f sa (  ) sa (  ) = dsa01 ( 1   )  + 0d sa 0 ( 1   ) + 1d sa 1  dsa0 ( 1   ) + sa 1  = ( 1  0 ) ( 0  1 ) ( 1   )  + 0 ( 1 + 0 ) ( 1   ) + 1 ( 0 + 1 )  ( 1 + 0 ) ( 1   ) + ( 0 + 1 )  , ( 54 ) last express obtain multipli upper lower part fraction ( 0+1 ) ( 1+0 ) ( 10 ) 2 .
final , take correspond f0 , f1 , 0 , 1 paramet valu case shear bulk modulus .
differ two ration function .
let a   b   two ration function  b ( 0 )   a ( 0 ) ,  a ( 1 )   b ( 1 ) , fa ( 0 ) = fb ( 0 ) , fa ( 1 ) = fb ( 1 )   [ 0 , 1 ] .
, a (  )  b (  )   [ 0 , 1 ] .
( 55 ) ferrer 371 obtain result , show four step differ fa fb posit   [ 0 , 1 ] .
( ) comput differ function .
let us comput function fc differ two ration function fa fb .
c (  ) = a (  )  b (  ) = nc (  ) dc (  ) , ( 56 ) numer nc (  ) written nc (  ) = na (  ) db (  )  nb (  ) da (  ) { na (  ) = da01 ( 1   )  + 0d 0 ( 1   ) + 1d 1  nb (  ) = db01 ( 1   )  + 0d b 0 ( 1   ) + 1d b 1 ( 57 ) denomin dc (  ) dc (  ) = da (  ) db (  ) { da (  ) = da0 ( 1   ) + 1  db (  ) = db0 ( 1   ) + b 1 .
( 58 ) ( ii ) comput differ function numer .
sake compact , write numer matrix form nc (  ) = [ ( 1   )  ( 1   )  ]   da01 0da0 1da1  [ db0 b 1 ]   db01 0db0 1db1  [ da0 1 ]  [ ( 1   )  ] = = [ ( 1   )  ( 1   )  ]  da01d b 0  b 01d 0 01d b 0  b 01d 0 0da0 b 0  0d b 0 0 0d 0 b 1  0d b 0 1 1da1 b 0  1d b 1 0 1d 01d b 0  1d b 01d 0  [ ( 1   )  ] = = [ ( 1   )  ( 1   )  ] [ n11 n12 0 n22 n31 0 ] [ ( 1   )  ] = = ( 1   ) 2n11 + ( 1   ) 2n12 + ( 1   ) n22 +  ( 1   ) n31 = = ( 1   )  [ ( 1   ) n11 + n12 + n22 + n31 ] = ( 1   )  [ ( 1   ) ( n11 + n22 + n31 ) +  ( n12 + n22 + n31 ) ] = ( 1   )  [ ( 1   ) c0 + c1 ] , ( 59 ) c0 = n11 + n22 + n31 c1 = n12 + n22 + n31 .
note , remark 8 , n11 , n12 , n22 , n31 written n11 = [ ( 1  0 ) ( da0  1 )  da0 1 ] db0  [ ( 1  0 ) ( db0  b 1 )  db0 b 1 ] da0 = =  ( 1  0 ) ( db0 1  b 1 0 ) + ( db1  1 ) da0 b 0 n12 = [ ( 1  0 ) ( da0  1 )  da0 1 ] db1  [ ( 1  0 ) ( db0  b 1 )  db0 b 1 ] da1 = =  ( 1  0 ) ( db0 1  b 1 0 ) + ( db0  0 ) da1 b 1 n22 = 0 ( db0 1  b 1 0 ) n31 = 1 ( db0 1  b 1 0 ) .
( 60 ) sum n22 n31 n22 + n31 = ( 1  0 ) ( db0 1  b 1 0 ) .
thus , write coeffici c0 c1 simplifi form c0 = ( db1  1 ) da0 b 0 , c1 = ( db0  0 ) da1 b 1 .
( 61 ) 372 ferrer ( iii ) comput differ function denomin .
equat ( 58 ) , simpli dc (  ) = [ da0 ( 1   ) + 1  ] [ db0 ( 1   ) + b 1 ] .
( 62 ) ( iv ) posit differ possibl scenario .
idea analyz numer denomin differ alway sign possibl case .
first , note , sinc a   b   , imag unbound ( [ f0 , f1 ] ) .
thus , ( 62 ) , see follow two scenario possibl : d0 , d1 > 0 d0 , d1 < 0 .
( 63 ) , assumpt  b ( 0 )   a ( 0 )  a ( 1 )   b ( 1 ) entail follow inequ :  b ( 0 )    ( 0 ) = [ ( 1  0 )  db1 ]  [ ( 1  0 )  da1 ] = da1  b 1  0 = db1  da1  a ( 1 )    b ( 0 ) = [ ( 1  0 ) + da0 ]  [ ( 1  0 ) + db0 ] = da0  b 0  0 = db0  da0 .
( 64 ) view ( 64 ) , summar possibl scenario follow tabl .
tabl , case 1 , 2 , 3 possibl case make fa fb satisfi condit ( 63 ) , consequ , rest case includ .
thus , guarante posit function fc reason follow : case 1 : { c1 , c0 > 0 = nc (  ) > 0 da (  ) > 0 , db (  ) > 0 = dc (  ) > 0 = c (  ) > 0   [ 0 , 1 ] case 2 : { c1 , c0 < 0 = nc (  ) < 0 da (  ) < 0 , db (  ) > 0 = dc (  ) < 0 = c (  ) > 0   [ 0 , 1 ] case 3 : { c1 , c0 > 0 = nc (  ) > 0 da (  ) > 0 , db (  ) < 0 = dc (  ) > 0 = c (  ) > 0   [ 0 , 1 ] .
( 66 ) remark 11 .
base result shown , although may obvious , could show h-s upper bound h-s lower bound .
inde ,  ub ( 0 )    lb ( 0 ) = 0 + 1 1 + 1 ( 1  0 )  0 + 0 1 + 0 ( 1  0 ) = ( 1  0 ) 2 ( 1  0 ) ( 1 + 0 ) ( 1 + 0 )  0 ( 67 )  lb ( 1 )    ub ( 1 ) = 1 + 0 0 + 0 ( 1  0 )  1 + 1 0 + 1 ( 1  0 ) = ( 1  0 ) 2 ( 1  0 ) ( 0 + 0 ) ( 0 + 0 )  0 , ( 68 ) use f1 , f0  0 coerciv reason 1  0 , 0  0 fulfil definit tabl ( 34 ) shear bulk modulus .
thus , expect , h-s bound shear bulk modulus alway h-s lower bound .
ub (  )  lb (  ) ub (  )  lb (  )   [ 0 , 1 ] .
( 69 ) ferrer 373 simp-al h-s bound .
point , show simp-al interpol bulk shear modulus rest alway h-s bound , ub (  )  sa (  )  lb (  ) ub (  )  sa (  )  lb (  )   [ 0 , 1 ] .
( 70 ) result certain second main contribut work .
show , verifi condit state equat ( 55 ) .
fact , h-s upper bound simp-al interpol function fulfil construct  ub ( 0 )    sa ( 0 ) =   ub ( 0 )    lb ( 0 )  0  sa ( 1 )   ub ( 1 ) = 0 .
( 71 ) condit  ub ( 0 )    lb ( 0 )  0 alreadi shown ( 67 ) .
proceed similar h-s lower bound .
construct ,  sa ( 0 )    lb ( 0 ) = 0   sa ( 1 )    ub ( 1 ) =   lb ( 1 )    ub ( 1 )  0 , ( 72 ) condit  sa ( 1 )    ub ( 1 ) =   lb ( 1 )    ub ( 1 )  0 also alreadi proven ( 67 ) .
7 comparison simp simp-al celebr simp interpol function19 propos basic combin properti materi follow : c (  ) = ( 1  p ) c0 + pc1 , ( 73 ) p penal paramet , frequent taken p = 3 .
7.1 interpol function comparison seek section compar interpol follow two differ situat .
( ) material-void interpol regular topolog optim , materi domain ( base materi ) usual interpol void materi , model extrem weak materi .
discuss work bends sigmund,2 standard simp propos isotrop interpol , correspond intermedi valu ( gray ) interpret situat composit materi compos base materi void materi ( interpola- tion function remain outsid h-s bound ) .
circumv limit , adapt valu penal paramet ( term poisson ratio valu base materi 1 ) propos aforement work2 two-dimension plane stress case chang penal paramet follow : p  p ( 1 ) = max ( 2 1  1 , 4 1 + 1 ) .
( 74 ) adapt penal paramet , simp method remain h-s bound 0  0 0  0 .
follow , call interpol choic adapt simp .
compar simp , simp-al , adapt simp , work , propos sequenc composit materi compos isotrop base materi properti ( e1 = 1 , 1  { 13 , 0 , 0.5 , 0.75 , 0.9 } ) void materi properti ( e0 = 103 , 0 = 13 ) .
note valu 0 e0  0 relev .
simp , adapt simp , simp-al interpol function depict figur 2 relat shear bulk h-s bound .
view result , poisson ratio  = 13 , three interpol behav similar .
fact , simp adapt simp coincid sinc p ( 13 ) = 3 .
addit , simp 374 ferrer 0 0.5 1 densiti 0 0.1 0.2 0.3 0.4 shear modulus 0 0.5 1 densiti 0 0.2 0.4 0.6 0.8 bulk modulus 0 0.5 1 densiti 0 2 4 6 shear modulus 0 0.5 1 densiti 0 0.5 1 1.5 2 2.5 shear modulus 0 0.5 1 densiti 0 0.2 0.4 0.6 0.8 1 shear modulus 0 0.5 1 densiti 0 0.1 0.2 0.3 bulk modulus 0 0.5 1 densiti 0 0.1 0.2 0.3 bulk modulus 0 0.5 1 densiti 0 0.1 0.2 0.3 0.4 bulk modulus 0 0.5 1 densiti 0 0.1 0.2 0.3 0.4 0.5 shear modulus 0 0.5 1 0 0.2 0.4 0.6 bulk modulus densiti figur 2 shear bulk interpol function comparison interpol void materi ( e0 = 103 , 0 = 13 ) sequenc stiff materi ( e1 = 1 1 decreas ) .
contrast simp , simp adapt , simp-al interpol remain h-s bound simp-al interpol function take h-s bound deriv valu extrem valu ( lower bound  = 0 upper bound  = 1 ) .
former coincid prove work bends sigmund19 latter obtain construct .
case , interpol remain h-s bound .
howev , soon 1 decreas , simp , simp adapt , simp-al start differ .
fact , simp-al simp adapt interpol function , contrast simp , remain h-s bound expect .
addit , note soon 1 decreas , eg , 1 = 0.9 , p = 40 ( case ( e ) ) , adapt simp interpol , comparison simp-al interpol , increas extrem mark result possibl limit solv topolog optim problem .
( b ) bimateri interpol general case , weak materi necessari much less stiff base materi , topolog optim problem fact bimateri optim problem .
aim decid part  appro- priat use one materi , case  gray ,  combin .
two differ case present .
first one ( case ( ) ) seek model steel-aluminum composit .
sens , materi proper- tie taken e0 = 13 , 0 = 0.35 , e1 = 1 , 1 = 0.3 .
second exampl ( case ( b ) ) intend model extrem case one materi larger bulk modulus valu materi larger shear modulus valu .
aim , materi properti consid e0 = 0.9 , 0 = 0.9 , e1 = 1 , 1 = 0.3 .
ferrer 375 0 0.5 1 densiti 0.2 0.4 0.6 0.8 bulk modulus 0 0.5 1 densiti 0.2 0.4 0.6 0.8 bulk modulus 0 0.5 1 densiti 0 1 2 3 4 5 shear modulus 0 0.5 1 densiti 0.1 0.2 0.3 0.4 shear modulus figur 3 interpol function comparison interpol two real materi .
simp adapt interpol even defin .
contrast simp , simp-al remain h-s bound despit bound realli close bimateri problem , valu penal paramet p simp interpol function unclear .
follow , take penal paramet valu p = 3 .
simp adapt method even defin .
correspond h-s bound , simp , simp-al method depict figur 3 .
expect , case ( b ) , simp function fall outsid h-s bound .
howev , although space h-s bound signific narrow , simp-al interpol function come lie insid , state equat ( 70 ) .
thus , use simp-al interpol seem conveni simp interpol 1  13 conveni ( physic point view ) differ valu 1 solv bimateri problem .
7.2 numer exampl comparison order see numer effect use differ kind interpol function , cantilev beam exampl solv sequenc case describ figur 2 .
size domain 2 1 left side clamp .
distribut vertic forc unit valu appli 0.2 center part right side .
domain equip structur triangular mesh 20 000 element cartesian grid split cell four triangl .
densiti function approxim p1 lagrangian finit element functions21 follow filter appli densiti function : k =  isk nin isk ni , ( 75 ) k densiti valu element k sk set node element k , see work amstutz et al22 detail .
filter defin discret sens , term shape function .
filter depend distanc also possibl .
consid complianc cost function volum ( volum target stiff materi v = 0.5 ) constraint topolog optim problem .
addit , consid mma algorithm,23 wide use communiti , solv problem stop criteria toler 104 maximum number iter nmax = 5000 .
design variabl initi stiff materi overal domain (  = 1 ) .
depict figur 4 , observ similar optim topolog regardless interpol use poisson ratio stiff materi close 1 = 13 .
addit , number iter finite-el solver eval- uation also similar .
exampl comput matlab standard pc ( 3.40 ghz processor 64-bit architectur ) .
howev , differ appear 1 becom smaller .
optim topolog use simp interpol requir larg number iter finite-el solver evalu converg gray area appear .
probabl due small penal valu appear case ( see figur 2 ) .
case simp adapt , penal valu rather larg , although seem almost free numer instabl , nonstan- dard topolog appear .
likewis , signific comput effort term iter requir converg .
contrast , simp-al interpol behav adequ term optim topolog comput effort 376 ferrer figur 4 cantilev beam exampl sequenc differ material-void interpol use differ interpol function .
standard isotrop materi ( 1 = 13 ) , interpol behav similar .
1 becom negat , gray area appear use simp larger number converg iter need .
adapt simp present larg gray area noncompetit cost function larger number converg iter appear .
simp-al interpol present gray area , number iter remain small , object function achiev consider smaller valu .
comparison simp , simp-al method evid auto-pen effect wider rang case [ colour figur view wileyonlinelibrary.com ] consid standard poisson ratio valu , typic  = 13 .
case ( c ) , simp method converg .
note , compar cost valu interpol could fuzzi , sinc gray area , interpol propos differ stiff valu .
case , simp interpol may propos valu stiffer physic possibl ( h-s bound ) .
stiff comparison physic sens , cost optim topolog obtain three interpol evalu use simp-al interpol ( jsa ) .
valu cost ( complianc ) shown figur 4 normal valu cost initi guess .
admit , use simp-al inter- polat , decreas cost case ( e ) 35 % obtain compar simp interpol 30 % compar simp adapt interpol .
result show conveni use simp-al interpol extrem isotrop materi ( see , exampl , work greav et al24 ) bimateri problem consid .
final , gray area appear simp method probabl intermedi valu interpol competit , seen figur 2 .
larg stiff valu ( physic possibl ) provid intermedi valu .
case , simp behav auto-pen interpol function .
contrast , simp-al seem auto-pen case .
thorough surpris sinc , shown equat ( 43 ) , topolog deriv ( use simp-al interpol ) propos fact insert h-s microstructur near extrem valu .
thus , possibl ad certain amount densiti ( insert certain stiffer inclus ) competit sinc provid small stiff increment .
intuit , microstructur made weak materi small number circular inclus transmit bare load , make , general , attract optim point view .
may explain propos simp-al interpol , contrast simp , evid result figur 4 auto-pen behavior studi case .
http : //wileyonlinelibrary.com ferrer 377 8 conclus main contribut work summar follow four point .
first , show equat ( 43 ) topolog deriv complianc precis linear approx- imat h-s bound ( lower bound weak upper bound stiff materi ) .
word , use topolog deriv complianc equival insert h-s bound microstructur ( circular inclus ) .
result strong relat concept allow us give new interpret topolog deriv .
second , propos simp-al method , new interpol function shear bulk modulus .
defin ration function build deriv coincid h-s lower bound deriv weak materi h-s upper bound deriv stiff materi , make gradient coincid , shown ( 43 ) , topolog deriv stiff weak materi .
key point simp-al interpol equat ( 70 ) , shown stay alway h-s bound regardless materi interpol , allow us interpret intermedi valu alway real microstructur .
third , compar simp-al simp simp adapt interpol function .
observ similar behavior 1 close 13 quit differ behavior becom smaller .
contrast simp , simp-al interpol shown stay h-s bound , numer verifi result equat ( 70 ) , case weak-stiff materi also challeng case interpol two general isotrop materi .
final , concern numer exampl , observ also similar behavior optim topolog around  = 13 .
howev , becom smaller , simp-al method shown obtain 20 % stiffer topolog , free gray area smaller comput cost .
comparison simp , result show simp-al method auto-pen wider rang case .
author 's point view , rather altern , simp-al interpol method under- stood general simp method , adequ kind interpol materi , physic mean , free heurist paramet , extra comput effort .
sens , simp-al interpol bridg also gap topolog deriv communiti simp communiti , allow first use reg- ular algorithm second use topolog deriv concept .
matlab implement simp-al interpol avail https : //github.com/ferrerferrealex/simpal also provid appendix .
acknowledg research lead result receiv fund european union 's horizon 2020 research inno- vation programm mari skodowska-curi grant agreement .
712949 ( tecniospr plus ) agenc busi competit govern catalonia .
thank dr samuel amstutz assist develop methodolog , help deepli understand topic comment great improv manuscript .
orcid a. ferrer https : //orcid.org/0000-0003-1011-0230 refer 1 .
pedersen cbw , alling p. industri implement applic topolog optim futur need .
: bends mp , olhoff n , sigmund , ed .
iutam symposium topolog design optim structur , machin materi .
dordrecht , netherland : springer ; 2006:229-238 .
2 .
bends mp , sigmund .
materi interpol scheme topolog optim .
arch appl mech .
1999 ; 69 ( 9 ) :635-654. https : //doi.org/ 10.1007/s004190050248 3 .
wang f , lazarov bs , sigmund .
project method , converg robust formul topolog optim .
struct multidiscip optim .
2011 ; 43 ( 6 ) :767-784. https : //doi.org/10.1007/s00158-010-0602-i 4 .
stolp , svanberg k. altern interpol scheme minimum complianc topolog optim .
struct multidiscip optim .
2001 ; 22:116-124. https : //github.com/ferrerferrealex/simpal https : //orcid.org/0000-0003-1011-0230 https : //orcid.org/0000-0003-1011-0230 https : //doi.org/10.1007/s004190050248 https : //doi.org/10.1007/s004190050248 https : //doi.org/10.1007/s00158-010-0602-i 378 ferrer 5 .
dzierzanowski g. comparison materi interpol scheme optim composit properti plane shape optim .
struct multidiscip optim .
2012 ; 46:693-710 .
6 .
allair g , jouv f , toader a-m .
structur optim use sensit analysi level-set method .
j comput phys .
2004 ; 194 ( 1 ) :363-393. http : //www.sciencedirect.com/science/article/pii/s002199910300487x 7 .
amstutz , andr h. new algorithm topolog optim use level-set method .
j comput phys .
2006 ; 216 ( 2 ) :573-588. http : // www.sciencedirect.com/science/article/pii/s0021999105005656 8 .
allair g , de gournay f , jouv f , toader .
structur optim use topolog shape sensit via level set method .
control cybern .
2005 ; 34 ( 1 ) :59 .
9 .
yamada , izui k , nishiwaki , takezawa .
topolog optim method base level set method incorpor fictiti interfac energi .
comput method appl mech eng .
2010 ; 199 ( 45-48 ) :2876-2891 .
10 .
huang x , xie ym .
new look eso beso optim method .
struct multidiscip optim .
2008 ; 35 ( 1 ) :89-92 .
11 .
baig j , martnez-fruto j , herrero-prez , otero f , ferrer .
large-scal stochast topolog optim use adapt mesh refin coarsen two-level parallel scheme .
comput method appl mech eng .
2019 ; 343:186-206 .
12 .
nguyen-xuan h. polytree-bas adapt polygon finit element method topolog optim .
int j numer method eng .
2017 ; 110 ( 10 ) :972-1000 .
13 .
amstutz s. connect topolog sensit analysi materi interpol scheme topolog optim .
struct multidiscip optim .
2011 ; 43 ( 6 ) :755-765 .
14 .
s lfn , amigo rcr , novotni aa , silva ecn .
topolog deriv appli fluid flow channel design optim problem .
struct multidiscip optim .
2016 ; 54 ( 2 ) :249264 .
15 .
brezi h. function analysi , sobolev space partial differenti equat .
new york , ny : springer scienc ; 2010 .
16 .
novotni aa , sokoowski j. topolog deriv shape optim .
berlin , germani : springer-verlag ; 2013 .
interact mechan mathemat seri .
17 .
giusti sm , ferrer , oliv j. topolog sensit analysi heterogen anisotrop elast problem .
theoret computa- tional aspect .
comput method appl mech eng .
2016 ; 311:134-150 .
18 .
hashin z , shtrikman s. variat approach theori elast behaviour multiphas materi .
j mech phys solid .
1963 ; 11 ( 2 ) :127-140 .
19 .
bends mp , sigmund o. topolog optim : theori method applic .
berlin , germani : springer-verlag ; 2003 .
20 .
allair g. shape optim homogen method .
new york , ny : springer-verlag ; 2002 .
appli mathemat scienc ; vol .
146 .
21 .
ern , guermond j-l .
theori practic finit element .
vol .
159 .
new york , ny : springer scienc busi media ; 2013 .
22 .
amstutz , dapogni c , ferrer .
consist relax optim design problem coupl shape topolog deriv .
numerisch mathematik .
2018 ; 140 ( 1 ) :35-94. https : //doi.org/10.1007/s00211-018-0964-4 23 .
svanberg k. method move asymptotesa new method structur optim .
int j numer method eng .
1987 ; 24 ( 2 ) :359-373 .
24 .
greav gn , greer al , lake rs , rouxel t. poisson 's ratio modern materi .
natur materi .
2011 ; 10 ( 11 ) :823 .
cite articl : ferrer a. simp-al : general simp method base topolog deriv concept .
int j numer method eng .
2019 ; 120:361381 .
https : //doi.org/10.1002/nme.6140 appendix simp-al matlab code appendix , provid simplifi matlab code facilit use simp-al interpol reader .
code also avail https : //github.com/ferrerferrealex/simpal .
simp_all_interpolation.m function devis use start topolog optim code .
time comput interpol function neglig make usabl well-establish interpol function .
constitut interpol tensor deriv provid sinc usual use comput complianc function gradient complianc .
obtain interpol function , first comput shear bulk modulus addit  paramet .
, coeffici ration function comput .
final , differenti respect densiti variabl obtain deriv .
http : //www.sciencedirect.com/science/article/pii/s002199910300487x http : //www.sciencedirect.com/science/article/pii/s0021999105005656 http : //www.sciencedirect.com/science/article/pii/s0021999105005656 https : //doi.org/10.1007/s00211-018-0964-4 https : //doi.org/10.1002/nme.6140 https : //github.com/ferrerferrealex/simpal ferrer 379 11 % dc ( rho ) : deriv isotrop materi constitut tensor respect 12 % densiti function rho .
13 % 14 % remark 1 : condit requir e1 , e0 , nu1 , nu0 ( except e > 0 15 % 1 < nu < 0.5 ) , could refer strong weak materi 16 % materi b .
howev , prefer name strong weak 17 % follow topolog optim name .
18 % 19 % remark 2 : version simpal interpol function intend 20 % 2d plane stress problem .
21 % 22 % remark 3 : simpal interpol evidenc fulfil hashin shtrikman 23 % ( hs ) bound possibl combin materi properti .
24 % thus , densiti function take intermedi valu , result 25 % constitut tensor interpret homogen constitut 26 % tensor micro  structur made strong weak materi 27 % relat fraction volum intermedi densiti valu .
28 % 29 % remark 4 : simpal interpol free penal heurist 30 % paramet .
31 % 32 % remark 5 : interpol built one hand 33 % constitut tensor coincid c0 ( constitut tensor e0 , nu0 34 % materi properti ) rho =0 c1 ( respect e1 , nu1 ) rho =1 35 % hand constitut tensor deriv 36 % rho =0 rho =1 coincid topolog deriv 37 % complianc dc0 dc1 , .
e . , 38 % c ( 0 ) = c0 , c ( 1 ) = c1 , 39 % dc ( 0 ) = dc0 , dc ( 1 ) = dc1 .
40 % 41 % remark 6 : opt provid dc sinc use complianc 42 % ( integr f u = integr e ( u ) : c ( rho ) : e ( u ) ) topolog optim 43 % problem , gradient direct obtain  e ( u ) : dc ( rho ) : e ( u ) .
44 % 45 % shear bulk modulus 46 mu = @ ( e , nu ) e / ( 2  ( 1+ nu ) ) ; 47 kappa = @ ( e , nu ) e / ( 2  ( 1  nu ) ) ; 48 % 49 mu0 = mu ( e0 , nu0 ) ; 50 mu1 = mu ( e1 , nu1 ) ; 51 % 52 kappa0 = kappa ( e0 , nu0 ) ; 53 kappa1 = kappa ( e1 , nu1 ) ; 54 % 55 % auxiliar materi properti 56 eta mu = @ ( mu , kappa ) ( kappa mu ) / ( 2 mu+kappa ) ; 57 eta kappa = @ ( mu , kappa ) mu ; 58 % 59 eta mu0 = eta mu ( mu0 , kappa0 ) ; 60 eta mu1 = eta mu ( mu1 , kappa1 ) ; 1 f u n c n [ c , dc ] = p l l n e r p l n ( e1 , e0 , nu1 , nu0 ) 2 % simpal n e r p l n f u n c n alex fer r , march 2019 .
3 % 4 % e0 , nu0 : young modulus poisson r f r p c weak e r l 5 % e1 , nu1 : young modulus poisson r f r p c r n g e r l 6 % 7 % c ( rho ) : r p c c n u v e e n r n e r p l e r p c 8 % e r l p r p e r e f r n g ( e1 , nu1 ) weak e r l ( e0 , nu0 ) 9 %  e n f u n c n  rho .
10 % 61 % 62 e ta kappa0 = eta kappa ( mu0 , kappa0 ) ; 63 e ta kappa1 = eta kappa ( mu1 , kappa1 ) ; 64 % 65 % r p c f u r h rde r e n r n voigt n n 380 ferrer 66 i1 = eye ( 3 ) ; i1 ( 3 , 3 ) = 1 / 2 ; 67 i2 = [ 1 1 0 ; 1 1 0 ; 0 0 0 ] ; 68 aiso = @ ( alpha , beta ) lpha  i1 + beta  i2 ; 69 % 70 % c e fi c e n ( n= numer , = denomin ) f r n l f u n c n 71 n01 = @ ( f0 , f1 , eta0 , e ta1 )  ( f 1  f 0 )  ( e ta1  eta0 ) ; 72 n0 = @ ( f0 , f1 , e ta0 ) f 0  ( f 1 + eta0 ) ; 73 n1 = @ ( f0 , f1 , e ta1 ) f 1  ( f 0 + eta1 ) ; 74 d0 = @ ( f1 , e ta0 ) ( f 1 + e ta0 ) ; 75 d1 = @ ( f0 , e ta1 ) ( f 0 + e ta1 ) ; 76 % 77 n01 mu = n01 ( mu0 , mu1 , eta mu0 , eta mu1 ) ; 78 n01 kappa = n01 ( kappa0 , kappa1 , eta kappa0 , e ta kappa1 ) ; 79 % 80 n0 mu = n0 ( mu0 , mu1 , eta mu0 ) ; 81 n0 kappa = n0 ( kappa0 , kappa1 , e ta kappa0 ) ; 82 % 83 n1 mu = n1 ( mu0 , mu1 , eta mu1 ) ; 84 n1 kappa = n1 ( kappa0 , kappa1 , e ta kappa1 ) ; 85 % 86 d0 mu = d0 ( mu1 , eta mu0 ) ; 87 d0 kappa = d0 ( kappa1 , e ta kappa0 ) ; 88 % 89 d1 mu = d1 ( mu0 , eta mu1 ) ; 90 d1 kappa = d1 ( kappa0 , e ta kappa1 ) ; 91 % 92 % den ty f u n c n ( symbol ic rde r f r f u r h e r ff e r e n n ) 93 rho = sym (  rho  ,  p v e  ) ; 94 % 95 % simpal r n l f u n c n 96 f = @ ( n01 , n0 , n1 , d0 , d1 , rho ) .
.
.
97 ( n01  ( 1  rho )  ( rho ) + n0  ( 1  rho ) + n1  rho ) / ( d0  ( 1  rho ) + d1  rho ) ; 98 % 99 mu = f ( n01 mu , n0 mu , n1 mu , d0 mu , d1 mu , rho ) ; 100 kappa = f ( n01 kappa , n0 kappa , n1 kappa , d0 kappa , d1 kappa , rho ) ; 101 % 102 % r p c c n u v e e n r .
103 csym = p l f ( aiso ( 2 mu , kappa  mu ) ) ; 104 % 105 % shear bulk modulus e r v v e 106 dmu = ff ( mu ) ; 107 dkappa = ff ( kappa ) ; 108 % 109 % r p c c n u v e e n r e r v v e 110 dcsym = aiso ( 2 dmu , dkappa dmu ) ; 111 % 112 % ord r ob ta handl f u n c n n e f symbol ic e x p r e n 113 % r e c l e v l u e c n u v e e n r ( e r v v e ) f r 114 % v e c r f e n e , make use f matlabfunct ( ) .
115 n r e = 3 ; % number f r e compon n voigt n n n p lane r e 116 dc = c e l l ( n r e , n r e ) ; 117 f r =1 : n r e 118 f r j =1 : n r e 119 f csym ( , j ) ==0 120 c { , j } = @ ( rho ) z e r ( z e ( rho ) ) ; 121 dc { , j } = @ ( rho ) z e r ( z e ( rho ) ) ; 122 e l e 123 c { , j } = matlabfunct ( csym ( , j ) ) ; 124 dc { , j } = matlabfunct ( dcsym ( , j ) ) ; 125 end 126 end 127 end 128 end ferrer 381 follow , present exampl use interpol function common finit element context .
1 f u n c n u e e x p l e f p l l n e r p l n 2 % use exampl f simpal n e r p l n f u n c n f r comput 3 % compl ianc g rad en , alex fer r , may 2018 .
4 % 5 % given e r l r p c p r p e r e v l u e 6 e1 = 1 ; 7 e0 = 0 .
0 1 ; 8 nu1 = 1 / 3 ; 9 nu0 = 1 / 3 ; 10 % bui ld simpal n e r p l n f c n u v e e n r 11 [ c , dc ] = p l l n e r p l n ( e1 , e0 , nu1 , nu0 ) ; 12 % 13 % con tex f fe problem , f r g iven number f gauss p n ngaus 14 % number f e lement nelem f f r exampl 15 nelem = 1000 ; 16 ngaus = 4 ; 17 % 18 % f r g iven e n v l u e 0 < = rho < = 1 f dimens 19 % dim ( rho ) = ngaus x nelem f f r exampl 20 rho = rand ( ngaus , nelem ) ; 21 % 22 % f r g iven r n e n r v l u e n voigt n n ( n r e = 3 ) 23 % ob ta ine h e l u n f fi n e element problem ku=f f f r exampl 24 n r e = 3 ; 25 r n = rand ( n r e , ngaus , nelem ) ; 26 % 27 % although would cheaper f u , e fi n n g dv ( weight  jacobian ) 28 dv = rand ( ngaus , nelem ) ; 29 % compl ianc comput 30 c = 0 ; 31 f r r e = 1 : n r e 32 f r j r e = 1 : n r e 33 r = squeez ( r n ( j r e , : , : ) ) ; 34 aux = r .
c { r e , j r e } ( rho ) .
 r .
dv ; 35 c = c + sum ( aux ( : ) ) ; 36 end 37 end 38 % 39 % g r e n f compl ianc 40 g = z e r ( ngaus , nelem ) ; 41 f r r e = 1 : n r e 42 f r j r e = 1 : n r e 43 r = squeez ( r n ( j r e , : , : ) ) ; 44 g = g  r .
dc { r e , j r e } ( rho ) .
 r ; 45 end 46 end 47 end simp-al : general simp method base topolog deriv concept abstract introduct topolog optim formul exact topolog optim problem relax topolog optim problem topolog deriv connect topolog deriv hashin-shtrikman bound ration function simp-al method comparison simp simp-al interpol function comparison numer exampl comparison conclus refer
