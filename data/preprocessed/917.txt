machin learn methodolog select classif spontan spinal cord dorsum potenti allow disclosur structur (non-random) chang neuron connect induc nocicept stimul method published: 26 august 2015 doi: 10.3389/fninf.2015.00021 frontier neuroinformat | www.frontiersin.org 1 august 2015 | volum 9 | articl 21 edit by: ulla ruotsalainen, tamper univers technology, finland review by: k. jarrod millman, univers california berkeley, usa szymon leski, nencki institut experiment biology, poland *correspondence: mario martin, depart science, universitat politcnica catalunya, c. jordi girona, 1-3, 08034 barcelona, spain enriqu contreras-hernndez, depart physiology, biophys neurosciences, center research advanc studies, nation polytechn institute, av. instituto politcnico nacion 2508, mxico city, d.f. 07360, mxico received: 26 june 2015 accepted: 10 august 2015 published: 26 august 2015 citation: martin m, contreras-hernndez e, bjar j, esposito g, chvez d, glusman s, cort u rudomin p (2015) machin learn methodolog select classif spontan spinal cord dorsum potenti allow disclosur structur (non-random) chang neuron connect induc nocicept stimulation. front. neuroinform. 9:21. doi: 10.3389/fninf.2015.00021 machin learn methodolog select classif spontan spinal cord dorsum potenti allow disclosur structur (non-random) chang neuron connect induc nocicept stimul mario martin 1*, enriqu contreras-hernndez 2*, javier bjar 1, gennaro esposito 1, digen chvez 2, silvio glusman 2, ulis cort 1, 3 pablo rudomin 2, 4 1depart science, universitat politcnica catalunya. barcelonatech, catalonia, spain, 2depart physiology, biophys neurosciences, center research advanc studies, nation polytechn institute, mexico city, mexico, 3 barcelona supercomput center, catalonia, spain, 4 el colegio nacional, mexico city, mexico previou studi aim disclos function organ neuron network involv gener spontan cord dorsum potenti (cdps) gener lumbosacr spinal segment predetermin templat select specif class spontan cdps. procedur time consum requir continu supervision, limit analysi specif type cdp (neg cdp neg posit cdps), exclud potenti reflect activ neuron network presum function relevance. present novel procedur base machin learn allow effici unbias select varieti spontan cdp differ shape amplitudes. reliabl perform present method evalu analyz effect probabl gener differ class spontan cdp induc intraderm inject small amount capsaicin anesthet cat, procedur known induc state central sensit lead allodynia hyperalgesia. result obtain selectionmethod present describ allow detect spontan cdpswith specif shape amplitud assum repres activ function coupl set dorsal horn neuron acquir different, structur configur respons nocicept stimuli. chang consid respons tend adequ transmiss sensori inform specif function requir homeostat adjustments. keywords: machin learning, neural signal processing, sort spontan cord dorsum potentials, capsaicin, spinal cord martin et al. methodolog analysi cdp 1. introduct establish prolong nocicept stimul lead state central sensit develop allodynia secondari hyperalgesia (traub, 1997; arendt- nielsen, 2015). interestingly, recent behavior studi themic shown mechan hyperalgesia render labil revers reactiv spinal pathwai applic protein synthesi inhibitor (bonnin koninck, 2014), high-dos opioid administr (drdla-schut et al., 2012), suggest process analog memori reconsolidation. find potenti import clinic applic control hyperalgesia, emphas know littl chang function connect dorsal horn neuron ensembl ensu state central sensit produc nocicept stimul (see biella et al., 1997; garca et al., 2004) possibl chang inmemori reconsolidation. recent examin anesthet cat chang function connect dorsal horn neuron state central sensit produc acut section cutan nerv (chvez et al., 2012) intraderm inject capsaicin (rudomin et al., 2012; contreras-hernndez et al., 2013). studi strength function connect differ popul dorsal horn neuron infer magnitud correl spontan cord dorsum potenti (cdps) simultan record differ spinal segments. particular attent given gener spontan negative-posit cdp (npcdps) because, contrast pure neg cdp (ncdps), appear relat preferenti activ pathwai lead primari affer depolar presynapt inhibit (rudomin et al., 1987, 1990; chvez et al., 2012). presynapt inhibit consid kei central mechan regul synapt effect sensori affer spinal cord normal patholog process (alvarez, 1998). recent studi aim disclos neuron popul involv gener spontan npcdp ncdp base potenti select raw record predetermin templat (chvez et al., 2012; contreras- hernndez et al., 2015). procedur requir continu supervis valid visual inspect extract spontan ncdp npcdps, repres small wider repertori spontan cdp function role remain established. select classif cdp achiev method time consuming. therefore, aim develop procedur allow faster unbias select classif spontan cdp differ shape amplitudes. end develop method base machin learn select classifi spontan cdps.we illustr us method examin chang spontan cdp induc intraderm inject capsaicin, procedur known produc increas prolong state central excit (contreras-hernndez et al., 2013). result obtain select method present describ allow detect spontan cdp specif shape amplitud assum repres activ function coupl set dorsal horn neuron acquir different, structur configur respons nocicept stimuli. function implic find briefli discuss examin forthcom publication. 1.1. plan work paper address research follow way: section 2 detail descript data, experiment method gener procedur given. section 3 new cdp identif methodolog fulli introduced. section 4 address issu cluster select cdp avail data obtain previou experiments, section 5.1 5.2 discuss differ valid procedur propos methodology. finally, section 6 conclus studi point futur work implement analyticmethod analysi spontan cord dorsum potenti record differ experiment conditions. 2. materi method goal work develop automat unsupervis classif method achiev faster detail select classif spontan cdp differ shape amplitud record simultan spinal segment specif experiment conditions. method devis supersed expert criteria retriev addit ncdp npcdps, potenti interest cdp remain unselect us predetermin templates. 2.1. data work data come publish studi (chvez et al., 2012; rudomin et al., 2012) perform anesthet cat paralyz maintain artifici ventil (see chvez et al., 2012 gener descript experiment procedures). briefly, spontan cord dorsum potenti (cdps) record mean silver ball electrod place cord dorsum side l4l7 spinal segment indiffer electrod insert paravertebr muscl ac amplier filter set 0.3hz 1 khz. experi 300103 cdp record deep anesthesia addit maneuvers. experi 060911 cdp record minut control period (see figur 1) differ time interv intraderm inject capsaicin plantar surfac left footpad (30 l 1% solution). 2.2. visual identif cdp method previou studi sort spontan cdp accord shape amplitud (chvez et al., 2012), based, first, perform small sampl visual select (order hundred) ncdp npcdps. then, frontier neuroinformat | www.frontiersin.org 2 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp figur 1 | exampl continu record spontan cdp differ lumbar segment left (black) right (red) side spinal cord control period. box indic cdp synchron differ lumbar segments. clearli defin ncdp (box 2, l5cr; box 4, l6rl) npcdp (box 3, l6rl; box 4, l5rr). l, left; r, right; c, caudal; r, rostral. data obtain experi 060911 (neg voltag plot upward). respect averag fix templat retriev ncdp npcdp sample. usual expert inspect preselect cdps, leav potenti clearli ncdp npcdps. select ncdp npcdp usual took hour necessari design faster reliabl procedur retriev classifi differ type spontan cdps. procedure, base templat match prior expert knowledg search typic cdp shapes, consid supervis detect method. implicitli consid basic set dictionari possibl cdp recurr class spontan cdp (ncdp npcdp) learn expert experience. 2.3. phase involv cdp identif spontan spinal activ (ssa) regist cord dorsum given spinal segment seen multivari time series. seri divid control period, last typic 1020 min, follow similar record period intraderm inject capsaicin.with sampl frequenc (f 510 khz), record time present experi result multivari time seri compos million points. descript identif phase follow (see section 2.5 summary): phase analysi consist extract cdp record data subsequ time series. task, defin time seri order set observ length tn . subsequ sn sampl subset length tn tn continu posit sn = {tp, ..., tp+n} 1 p n n+ 1. subsequ time seri collect slide window fix size (tw) move data. possibl wai identifi cdp subsequ determin subsequ sn similar subsequ time series. consid case subsequ form recur pattern (ncdp npcdp others). order defin subsequ belong similar pattern (i.e., similar shape) necessari satisfi certain minim constraints: subsequ similar behavior term tempor variation, similar pair subsequ higher given threshold and, finally, subsequ overlap other. second phase involv extract featur better character cdps, perform automat defin user. often, advis appli featur extract approach raw signal automat classif procedure. order captur possibl shapes, necessari us featur amplitud duration, initi baseline, interpret steadi state condit signal. stage, nois reduct featur select addressed. princip compon analysi (pca) (jolliffe, 2002) linear decomposit data captur maxim variance. pca basic find order set orthogon basi vector provid direct data largest variation. princip compon vector obtain comput eigenvector covari matrix data. moreover, order eigenvalu threshold dimension reduct technique. phase involv identif recur class cluster analysi (duda et al., 2000) automat find cluster multidimension data sets. basic assumpt underli cluster method data gener independ classes, describ rel simpl model. class mean amplitud shape recur cdp candid close given cluster similar measure. cluster analysi cluster prototype, variabl data prototyp characterist clusters. cluster analysi gener make frontier neuroinformat | www.frontiersin.org 3 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp assumpt cdp shape consid suboptimal. mimic expert behavior assum cdp shape smooth, help find relev information, leav cluster analysi task identifi recur patterns. addit identif select spontan cdp specif shape amplitudes, method allow detect specif combin cdp simultan gener differ segment (see box figur 1). possibl approach count, combin basic patterns, number occurrences. us count defin configur function interconnect neuron popul involv gener cdp differ spinal segments, give detail inform tempor recurr relat identifi patterns. potenti identifi function defin chang intern connect neuron ensembl gener spontan cdp perform differ task (manjarrez et al., 2000; contreras-hernndez et al., 2015). 2.4. relat work problem address phase methodolog similar analysi neural spike activ spike sort methodolog (ssm) (lewicki, 1998). nevertheless, account cdp amplitud 5 250 v durat 20 300ms, cdp result activ differ neuron ensembl (contreras-hernndez et al., 2015). henceforth, possibl pattern activ differ studi ssm, mean gener perspect analyz kind signals. problem effici locat pattern time seri address term knowledg discoveri automat detect frequent occur patterns. principle, task accomplish appli frequent motif discoveri (fmd)method time seri (lin et al., 2002). approach, given window size, pattern extract repeat frequenc higher predetermin value. interest recur patterns, consid occurr frequency. furthermore, method fmd resort approxim algorithm comput complex problem, interest identifi occur patterns. relat second phase, spike sorting, featur analysi identifi spike have similar durat amplitud given boundaries. however, choos featur base intuit ideas, simpl principle, yield poor pattern separation. phase approach common potenti sorting, case, pattern select featur amplitud durat peak given threshold defin user, aim includ potenti elig candidates. potenti sorting, cluster analysi usual yield limit number (14) independ class rel easi identifi number classes. cdp select perform similar methodology. however, peak result activ neuron popul differ magnitudes, complex number independ shape expect larger difficult assess. 2.5. approach autom identif consid concept devis semi- automat classif method abl identifi cdp raw data record spinal segment compris differ phases: 1. cdp candid detection: phase raw cdp record given segment analyz slide window obtain subsequ time series. select accord given constraint smooth mimic expert knowledg identifi differ class cdps. 2. cdp featur extraction: phase data preprocess order maxim inform relat cdp shapes, reduc nois data dimensionality. 3. cdp cluster analysis: phase candid cdp analyz pca (jolliffe, 2002) featur select method then, k-mean cluster algorithm (duda et al., 2000) basic set dictionari recur independ class built (shape dictionary). pattern identifi class defin recur shape cdp spinal segment. 4. cdp occurr analysis: phase studi correl synchron differ time seri count number occurr concurr synchron cdp class accord given tempor resolution. goal phase identifi possibl relat concurr cdps. 5. cdp recurr analysis: phase search tempor recurr relat concurr identifi pattern synchron class cdps. disclos possibl tempor relat consecut group cdps. paper, focu step address futur publication. 3. cdp candid detect interest build autom unsupervis cdp detect method smooth definit cdp candidates. chanc detect signal embed nois improv advantag prior inform signal noise. prior inform acquir experiment trials. hence, algorithm gener unsupervised, prior inform loose. assum nois contain ssa background stationary, essenti gaussian independ neuron signal (solodkin et al., 1991). assumpt crucial implementation, ensur mathemat tractabl derivations. problem detect transient (mean signif structur variat signal respect frontier neuroinformat | www.frontiersin.org 4 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp background noise) collect noisi observ extens studied. presenc us signal background nois cast hypothesi test problem, signal present null hypothesis. case unsupervis problems, signal detect known, uniformli power test used. result, detector perform reli signal representation. common practic us model base expans base signal representation. absenc signal model, project canon set basi functions, work set expans coefficients. depend signal representation, detect problem formul time domain, frequenc domain time-frequ domain. hereafter, us frequenc domain discret fourier transform (dft) expansion. cdp candid identifi subsequ time seri durat tn slide window durat tw tn . constraint, set slide window time seri resolut tr avoid possibl overlaps. finit set basi frequenc determin sampl rate signal fs = o(khz) durat tw nw = twf number sampl discret signal. expert knowledg restrict frequenc rang cdp signal respect possibl ssa nois background. method identifi transient presenc noisi background comprise, example, window discrimin detect signal exceed simpl amplitud threshold pass user-specifi time-voltag boxes. method requir human supervision, manual natur make unreli statist properti understood. possibl repres amplitud discrimin threshold valu set automatically. perform method deterior rapidli low signal-to-nois ratio (snr) conditions. match filters, known maxim snr signal embed white noise, used. however, method requir build templat unsupervised. finally, power detect evalu instantan power signal slide window, compar threshold deriv mean standard deviat nois power. perform method known poor low snr environment. cdp candid detect formul binari hypothesi test problem null hypothesi h0 signal present altern hypothesish1 signal nois present: h0 : x[t] = n[t] t = 1, ...,nw (1) h1 : x[t] = s[t]+ n[t] t = 1, ...,nw (2) x[t] repres noisi observ (evidence) discret time t, s[t] transient (the cdp candidate) detect n[t] background noise. figur 2 show exampl cdp signal presenc gaussian noise. moreover, multipl transient present repres main differ problem classic signal detect figur 2 | exampl cdp candid selection. (upper) typic raw signal s[t]+ n0[t], (center) identifi signal idft center x = idft (x ) report left xl right xr averag level (see text), (lower) remain gaussian nois ns = idft (xn ) (from experi 300103). detect cdp candidates. linear dft, x = dft(x), hypothesi reformul h0 : x[k] = n[k] k = 1, ...,nw (3) h1 : x[k] = s[k]+ n[k] k = 1, ...,nw (4) hypothesi test problem, goal determin evid support reject h0. decis optim respect suitabl chosen object function. let p(h0|x) p(h1|x) condit probabl associ accept reject hypothesi h0 given evid x, respectively. optim decis rule minim overal cost accept hypothesi smaller condit probabl accord p(h0|x) h0h1 p(h1|x) (5) bay theorem p(hi|x) = p(x|hi)p(hi)/p(x) p(x|h1) p(x|h0) h0 h1 (6) user defin accept threshold typic 1. purpos unsupervis signal detection, separ x estim nois level frequenc sampl data. obtain estim accept frequenc given band fb follow invers dft transform. case, frequenc band fb hypothesi test procedur level coefficients. practic cdp durat 100 300 ms filter cdp signal frequenc band fb [0, 100] hz compon outsid rang frontier neuroinformat | www.frontiersin.org 5 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp treat gaussian stationari noise. procedur allow separ x disjoint contribut depend frequenc interval, signal compon xs case {f fb}, nois compon xn {f 6 fb}. accordingly, separ signal nois time domain evalu invers dft x = idft(xs) hypothesi h1. assumpt work fine practic need, extent, loos wai detect transient candidates. figur 3 rm signal noise, separ differ frequenc interv (fb1 = [0, 30] hz, fb2 = [0, 50] hz, fb3 = [0, 100] hz) effect normal residu noise. optim frequenc interv fb2 = [0, 50] hz accept small deviat gaussian ( 3%) mainli non separ signal compon present residu noise. linear idft reformul h0 : x[t] = n0[t] t = 1, ...,nw (7) h1 : x[t] = s[t]+ n0[t] t = 1, ...,nw (8) n0[t] n[t] residu noise. decis rule safe appli maximum valu signal xm = max (x), report exampl cdp signal nois separ procedur figur 2. assum residu nois gaussian write p(xm|h0) n (0, 20 ) p(xm|h1) n (m, 20 ) decis rule |xm| h0h1 m 2 + 20 m log( ) (9) m mean valu |xm| hypothesish1 0 standard deviat xm. paramet (m, 0, ) figur 3 | optim separ signal nois differ frequenc intervals. (upper): fb1 = [030] hz; (center): fb2 = [050] hz; (lower): fb3 = [0100] hz. first panel signal nois (rms) histogram (a1,b1,c1) separ respect frequenc interv fb1, fb2, fb3 follow procedur describ figur 2. consid distribut noise, rm threshold separ non-gaussian gaussian noise. second panel (a2,b2,c2) time window signal (darker) non-gaussian (ng) residu nois (lighter) present previou histograms. panel (a3,b3,c3) time window residu gaussian (g) nois percentag residu non-gaussian nois present. panel (a4,b4,c4) amplitud histogram (with gaussian fit) residu nois (a3,b3,c3) (data taken segment l6cl, experi 300103). frontier neuroinformat | www.frontiersin.org 6 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp known estim data. practic set threshold maximum filter signal xm > xthd = 0.05 v determin experimentally. 3.1. nois estim test verifi presenc transients, examin qualiti transients. example, time seri control period last 1200 s sampl frequenc fs = 1670 hz, time window tw = 180m time resolut tr = tw/12 = 15 ms, algorithm check 60,000 time window detect averag 4000 transients. fast qualiti cut check badli defin cdp candidates, accord prior assumpt smoothness. intuit accomplish measur ratio cdp candid maximum amplitud left right side averag given tolerance. divid time window tw part equal size tp = tw/4 cdp left xl right averag xr , averag signal time interv [0,tp] [twtp,tw], respectively. qualiti cut select cdp candid have xm > psmthxr xm > psmthxl (we psmth = 1.5 determin experimentally). average, qualiti cut effici 80%. accordingly, previou example, lead 3200 transient surviv cdp candidates. finally, presenc larg deviat gaussian nois detect snr coher test. defin signal-to-noise-ratio as: ysnr = mean[( s s+ n )2] mean[( x x )2] = |xs|2/|x|2 look function respect standard deviat xrm = rms( + n) = rms(x), allow identif larg non-gaussian nois deviation. shown left panel figur 4 curv defin accept region normal (gaussian noise) behavior given sensor defin y thdsnr = psnr(1) 1psnr(2)epsnr (3)xrm 1psnr(4)epsnr (3)xrm paramet psnr = (0.96, 2, 1, 50) determin experimentally. detect presenc larg deviat gaussian nois background time window check ysnr < y thd snr . averag qualiti cut effici rang 90 100% depend behavior segment. right panel figur 4 show exampl detect occasion transient unknown extern sourc correctli identifi procedur larg deviat gaussian noise. 3.2. perform evalu evalu perform consid cdp identif retriev relev inform treat two-class problem. classifi usual label exampl posit neg decis classifi repres confus matrix have categories: fals positives, true positives, fals negatives, true negatives. perform cdp detect phase evalu look precis (fraction retriev instanc relevant) recal (fraction relev instanc retrieved) (davi goadrich, 2006). precis recal cdp candid detect phase estim control period experi 060911, l4 l7 lumbar segments, report tabl 1. recal precis proportions, accord confid interv calcul standard statist method differ proport (newcombe, 1998). expert knowledg order discrimin relev transient select period retriev transient select detect algorithm. data depict tabl 1 estim recal precis fraction cdp select differ spinal segment (e.g., l4cl, caudal (c) left (l) l4 segment, l5rr, rostral right (r) l5 segment, etc.) vari 0.740.81 0.830.87, respectively. consid average, detect phase algorithm show rel good qualiti term indicators, chang probabl occurr differ class cdp (see section 5.2) consist previou observ base correl measur indic stabil figur 4 | snr coher test. (left) snr2 vs. rm allow identif larg deviat gaussian noise. (right) exampl spuriou potenti record cord dorsum left segment l4 identifi test (from experi 300103). frontier neuroinformat | www.frontiersin.org 7 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp tabl 1 | mean standard deviat recal precis cdp candid detect phase evalu control period experi 060911. l4cl l4cr l5rr l5rl l5cr l5cl recal 0.79 0.04 0.78 0.06 0.77 0.06 0.80 0.04 0.74 0.04 0.81 0.03 precis 0.85 0.04 0.84 0.05 0.86 0.05 0.81 0.03 0.87 0.03 0.85 0.03 l6rr l6rl l6cr l6cl l7rl recal 0.79 0.03 0.79 0.03 0.78 0.03 0.79 0.03 0.77 0.04 precis 0.85 0.03 0.85 0.03 0.85 0.03 0.84 0.03 0.83 0.04 explan text. function connect differ lumbar segment control period (rudomin et al., 2012). figur 5 displai step requir select specif time window cdp candidate. algorithm requir paramet defin look perform measure. particular, set time window interv tw = [100, 300] ms defin experts; fb = [0, 50] hz, time resolut step fix tr = tw/12, threshold max signal detect transient xthd = 5 v , resolut posit max peak pkre = tw/12 smooth paramet psmth = 1.5 non-gaussian coher test paramet psnr = (0.96, 2, 1, 50). valid method optim paramet present select method perform set ncdp npcdp select expert raw data perform experi describ section 5.1 5.2. select method abl correctli identifi event mark interest (ncdp npcdps) experts. 4. cluster select cdp cdp candid identifi select procedur described, step gener basic set dictionari cdp proce follows. time-stamp detect cdp correspond time maximum valu select time window. expert, defin suitabl time window identifi transient maximum. so, instance, expert decid sampl frequenc fs = 1670 hz durat tw = 180m result represent cdp sampl 300 points. select time window, data preprocess order prepar clustering. select cdp time window durat tw smooth low pass filter (f 50 hz). eas comparison differ cdp potenti offset remov subtract averag 100 100 point signal. given signal suffici smooth, cdp process pca featur extract comput 10 relev dimens set identifi cdp dimens reconstruct cdp. tri number cluster approach k- means, k-medoids, em gaussian mixtures, dbscan, affinity- propag (gan et al., 2007), select known k-mean algorithm result cluster prototyp interpret meaning experts. also, obtain cluster divid ncdp npcdp disjoint clusters. k-mean main issu select number clusters. given priori inform number differ classes, decis relat cluster quality. algorithm depend initialization, us circumst adequ number clusters.w consid correct number cluster correspond valu yield stabl results. context, stabl mean that, given number cluster initializations, mean similar cluster data larger number clusters. possibl measur cluster similarity. despit select specif cluster algorithm, want abl compar result obtain methods. constrain possibl measur independ cluster representation. kind measur known extern cluster valid index (halkidi et al., 2001) consid differ exampl group clusters. measur select theadjustedmutu inform score (ami) defin vinh et al. (2010). inform theoret measur compar coincid partitions. addit characterist simpl mutual inform correct chance. u v , differ partit dataset, ami score defin as: ami(u,v) = mi(u,v) e[mi(u,v)] max(h(u),h(v)) e[mi(u,v)] (10) mi(u,v) mutual inform partitions, e[mi(u,v)] expect mutual inform partit h(u) entropi partition. measur bound interv [0, 1], 1 themaximum similarity. order reduc initi depend k- mean k-means++ (arthur vassilvitskii, 2007) initi heuristic, shown improv result algorithm. heurist us randomization, deterministic. allow test stabil cluster propos measure. adequ number cluster compact stabl set differ initializations. number cluster choos rang [425]. valu obtain number frontier neuroinformat | www.frontiersin.org 8 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp figur 5 | cdp candid select algorithm. cluster (40) k-mean algorithm, best 10 random initi mention heuristic. cluster number, comput mean ami pair clusters. figur 6 show result data experi 060911. ami score usual larger small number clusters, valu decreas number cluster increas usual present high peak stabl clusterings. ami score graph computed, valu k correspond peak pictur collect test order ensur classif obtain k number spurious. k produc signific peak picture, 10 execut k-mean algorithm obtain 10 dictionaries. execut k-mean best 100 random initializations, try obtain dictionari classif close global minimum k-mean tri find. 10 dictionari generated, compar order know equival not. dictionari d1 d2 equival when, class dictionary, exist class dictionari share 90% (which parameter) element form classes. abl assign class dictionari class dictionary. assign equival class implement hungarian algorithm weight bipartit graphsmatch (lovsz plummer, 2009). 10 differ execut k-mean term return 10 equival dictionaries, pretti sure dictionari spuriou statist relevance. so, k-valu correspond peak ami score graph, remov produc equival dictionari differ execut k-means. set surviv k-values, select highest on help discov larger number statist signific class data diversity. select possibl candid number clusters, group obtain examin expert decid best one. figur 6 | exampl mean ami score evolut respect number cluster experi 060911. pictur show result stabil cluster propos measur rang 4 25 (see text). that, result cluster fix dictionari possibl cdp shape subsequ analysi tasks. 5. result 5.1. experiment evaluation: map ncdp npcdp dictionari wai test dictionari gener propos methodolog check gener dictionari appear neg (ncdps) neg posit (npcdps) defin experts. end, ask expert previous perform cdp templat select check raw potenti record left l6 segment experi 300103 100 clear exampl ncdp frontier neuroinformat | www.frontiersin.org 9 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp npcdps. expert mark time occurr cdp peak label 166 cdp ncdp 26 npcdps. set select exampl test propos methodology. intent dictionari gener procedur base unsupervis learningmechanisms, supervisor identif limit identif clear ncdp npcdps. parallel visual select ncdp npcdps, methodolog appli sequenc 500 s raw recordings. experi evalu expert select cdp appear gener dictionary, express recal interest signal dictionary. check ncdp npcdp appear differ class test gener dictionari abil repres them. appli methodolog describ section 2, cdp selection, data time window preprocess low pass filter (f 50 hz), remov baselin appli pca featur selection. allow identif 1266 cdp candid 1200 s control period. identifi cdp preprocess k-mean algorithm look stabl classif obtain k = 12, 17, 20. examin differ possibl experts, classif 20 cluster consid repres (see figur 7). automat tag class n, np class class find cdp label expert class.when proport user-label ncdp npcdp class 10 time higher expect number case random assignment, class pre- classifi candid repres cdp. way, class 6, 10, 14, 15 pre-label candid repres ncdp class 7 16 pre-label candid repres npcdps. final examin class expert confirm class 6, 10, 14, 15 effect label ncdps. accordingly, class 7 16 consid expert npcdps. class 17 consid expert exampl npcdp class. class discov automat method post-tag class small number npcdp exampl (onli 26 cases). histogram displai lower figur 7 show frequenc 20 differ class cdp retriev 20 min sampl period plot decreas order. seen smallest potenti (e.g., class 1 7) appear largest potenti (e.g., class 14 20). recurr find illustr upper pair control histogram figur 8 obtain data record experi 060911. 5.2. experiment evaluation: capsaicin experi establish abil method proper select classif differ class spontan cdps, desir examin extent differ class cdp chang differ time intraderm inject capsaicin (3l 1% solution) left hindlimb footpad previou experi (contreras-hernndez et al., 2013) shown intraderm inject capsaicin chang pattern function connect dorsal horn neural network involv gener spontan cdps. assess differ distribut cdp differ period defin measur base root mean squar (rms) differ histogram distribut (see appendix a.1). class cdp illustr lower figur 8 retriev experi 060911, databas includ record control period differ time inject capsaicin, indicated. distribut differ class cdp depict histogram obtain separ record period control highli similar (see rm valu tabl 2), indic rel stabl pattern probabl gener differ class cdp retriev 20 min record time. seen data obtain experi 300103 (figur 7) cdp smaller amplitud appear frequent cdp larger amplitudes. applic capsaicin, substanti consist chang frequenc occurr differ class cdp observ record periods. namely, clear increas occurr largest cdp (e.g., class 14 15) reduct smallest e.g., class 1 2 2nd 3rd capsaicin recordings). note effect capsaicin probabl occurr class (4, 11, 14) reduc time. effect attribut increas supraspin inhibit produc nocicept stimul (rudomin hernndez, 2008). remark similar histogram obtain record differ time inject capsaicin (see tabl 2 rm valu histograms). observ demonstr neuron network gener spontan cdp chang non-random dynam state (control state) non- random state applic capsaicin, agreement previou propos base correl measur (rudomin et al., 2012; contreras-hernndez et al., 2013). experi cours perform provid detail character dorsal horn neuron involv gener differ class spontan cdps, particularli view recent observ show depend magnitud synchron spontan neuron activ network, popul dorsal horn neuron involv gener ncdp npcdp (contreras-hernndez et al., 2015). valid chang distribut differ class cdp select present method, examin consist dictionari gener control period variat capsaicin periods. fact, expect consist good classif class obtain compar classif deriv control period somewhat differ classif obtain record capsaicin injection. end, frontier neuroinformat | www.frontiersin.org 10 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp figur 7 | dictionari obtain k = 20 class spontan cdp record l6 left lumbar segment experi 300103. clear npcdp shown class 7 16 clear ncdp mainli appear class 6, 10, 14, 15. lower histogram illustr frequenc appear class record time 20 min. note class smallest amplitud appear frequent largest class spontan cdps. detail text. estim signific deviat pair histogram obtain record periods. namely, crtl1 (between 0 10 min), crtl2 (between 10 20 min), capsa1 (between 0 10 min post injection), capsa2 (between 40 50 min post injection) capsa3 (between 60 70 min post injection). assum signific obei distribut close standard normal distribut valu taken statist population. observ depict figur 8 demonstr compar control distributions, intraderm inject capsaicin increas probabl gener largest class cdps. similar variat observ cdp gener lumbar segments, experi experiments, confirm dictionari base methodolog abl detect ongo non-random chang spinal cord activ rel stabl extend period time. frontier neuroinformat | www.frontiersin.org 11 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp figur 8 | (upper) class (k = 15): histogram variat frequenc occurr differ class cdp obtain control capsaicin record period l6 left rostral lumbar segment anesthet cat experi 060911 (white bar repres control1 plot histogram quantit comparison). lower set trace 15 class select cdp tho construct histogram displai above. tabl 2 | rm class frequenc control capsaicin. rm ctrl1 ctrl2 capsa1 capsa2 capsa3 ctrl1 0 0.88 5.21 5.1 3.88 ctrl2 0.88 0 5.31 5.22 3.99 capsa1 5.21 5.31 0 2.95 3.79 capsa2 5.1 5.22 2.95 0 2.26 capsa3 3.88 3.99 3.79 2.26 0 rm valu 0.88 ctrl1 ctrl2 indic correspond frequenc histogram similar. contrast, rm control capsaicin histogram (capsa1, capsa2, capsa3 ) rang 3.88 5.31, suggest signific differences. contrast, rm valu capsa1, capsa2, capsa3 rang (2.263.79) suggest similarity, signific control histograms. 6. discuss futur work machin learn method develop abl retriev basic pattern spontan cord dorsum potenti obtain differ experiment conditions. present classif method compris phases, (1) cdp candid detection, (2) cdp featur extraction, (3) cdp cluster analysis, (4) cdp occurr analysis, (5) cdp recurr analysi (see section 2.5). phase address present paper left futur work. main advantag method are: autom process select cdp candid raw record compar manual selection; constrain search known cdp allow discov (and fact so) new class cdp (see section 5.1), perform exhaust explor set data, reduc time analysi order magnitud dai ten minutes. relev characterist capabl identifi basic dictionari cdp class statist frontier neuroinformat | www.frontiersin.org 12 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp stabil differ experiment manipulations. dictionari abl confirm (and extend) expert knowledge, character chang cdp activ identifi pattern raw data record normal patholog situat remain undetect previous select methods. place, dictionari abl detect chang state system, facilit analysi effect differ manipul experiment. drawback, label cdp class fulli autom requir expert analysis. expert examin differ class spontan cdp decid function relev base inform provid detail character function featur neuron involv generation, spontan ncdp npcdp (chvez et al., 2012; contreras-hernndez et al., 2015). physiolog point view, fractal analysi spontan cdp (rodrguez et al., 2010) record lumbosacr segment shown potenti random underli tempor spatial structure. lead question extent spontan cdp shape amplitud recurr gener activ rel stable, highli coher neuron network compat concept modular organization, issu explain muscular synergi execut varieti motor behavior (bizzi et al., 2008), matter controversi (rudomin, 2009). present result provid insight question show control condit repertoir differ class spontan cdps, appear highli stabl frequenc differ period control condit (figur 8). applic capsaicin frequenc gener class spontan cdp changes, rel stabl profil differ period (see tabl 2). agreement previou observ demonstr profil correl continu record differ pair lumbar segment remain highli stabl control condit chang intraderm inject capsaicin (rudomin et al., 2012; contreras-hernndez et al., 2013). interestingly, chang frequenc cdp control condit capsaicin condit appear mark cdp record left spinal cord, ipsilater site applic capsaicin indic rm coefficients. implic find hyperalgesia pain perception, dealt forthcom publication, question remain extent class cdp gener synchron activ particular set dorsal horn neuron produc distribut set dorsal horn neuron acquir differ configur intern connectivity, case ncdp npcdps. finally, present approach classif spontan neuron popul potenti base shape amplitud possibl clinic applications, exampl analysi spontan spinal cord potenti patient peripher nerve, root spinal cord disord (liang et al., 2015), chang eeg differ level anesthesia human patient (ertekin et al., 1983), control electrocorticograph base neuroprosthesi (chao et al., 2001; anderson et al., 2012). acknowledg work partial support fi-dgr programm agaur eco/1551/2012. partial support tec2011-29106-c02-02 sistema inteligent i-walker: rehabilitacin colaborativa (siirc) nih grant ns 09196 conacyt grant 50900 barcelona supercomput center (bsc-cns) cinvestav agreement. ec conacyt fellow. ge fi-agaur fellow. dr. pablo rudomin dr. ulis cort member sistema nacion investigador (mxico). refer alvarez, f. j. (1998). anatom basi presynapt inhibit primari sensori fibers, presynapt inhibit neural control, ed p. rudomin, r. romo, l. mendel (new york, ny: oxford univers press), 1349. anderson, n. r., blakely, t., schalk, g., leuthardt, e. c., moran, d. (2012). electrocorticograph (ecog) correl human armmovements. exp. brain res. 223, 110. doi: 10.1007/s00221-012-3226-1 arendt-nielsen, l. (2015). central sensit humans: assess pharmacology, handbook experiment pharmacology, vol. 227, ed h.-g. schaibl (berlin; heidelberg: springer), 79102. doi: 10.1007/978-3-662- 46450-2_5 arthur, d., vassilvitskii, s. (2007). k-means++: advantag care seeding, soda (new orleans: siam), 10271035. biella, g., riva, l., sotgiu, m. (1997). interact neuron differ lamina dorsal horn spinal cord. correl studi normal neuropath rats. eur. j. neurosci. 9, 10171025. doi: 10.1111/j.1460- 9568.1997.tb01452.x bizzi, e., cheung, v. c., davella, a., saltiel, p., tresch, m. (2008). combin modul movement. brain res. rev. 57, 125133. doi: 10.1016/j.brainresrev.2007.08.004 bonnin, r. p., koninck, y. (2014). spinal analog memori reconsolid enabl revers hyperalgesia. natur 17, 10431045. doi: 10.1038/nn.3758 chao, z., nagasaka, y., fujii, n. (2001). long-term asynchron decod arm motion electrocorticograph signal monkeys. front. neuroeng. 30:3. doi: 10.3389/fneng.2010.00003 chvez, d., rodrguez, e., jimnez, i., rudomin, p. (2012). chang correl spontan activ dorsal horn neuron lead differenti recruit inhibitori pathwai cat spinal cord. j. physiol. 590, 15631584. doi: 10.1113/jphysiol.2011.223271 contreras-hernndez, e., chvez, d., hernndez, e., glusman, s., rudomin, p. (2013). reorgan function connect dorsal horn neuron network produc intraderm capsaicin heat-induc skin damag transient restor system lidocaine. abstr. soc. neurosci. abstract retriev abstract viewer/itinerari planner (465.03). frontier neuroinformat | www.frontiersin.org 13 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp contreras-hernndez, e., chvez, d., rudomin, p. (2015). dynam synchron ongo neuron activ spinal segment regul sensori inform flow. j. physiol. 593, 23432363. doi: 10.1113/jphysiol.2014.288134 davis, j., goadrich, m. (2006). relationship precision-recal roc curves, proceed 23rd intern confer machin learning, icml 06 (new york, ny: acm), 233240. drdla-schutting, r., benrath, j., wunderbaldinger, g., sandkhler, j. (2012). erasur spinal memori trace pain brief, high-dos opioid administration. scienc 335, 235238. doi: 10.1126/science.1211726 duda, r., hart, p., stork, d. (2000). pattern classification. john wilei & sons, inc. ertekin, c., sarica, y., ukardeler, l. (1983). studi human spontan electromyelogram (emyelog). ii. patient peripher nerve, root spinal cord disorders. electroencephalogr. clin. neurophysiol. 55, 2433. doi: 10.1016/0013-4694(83)90143-8 gan, g., ma, c., wu, j. (2007). data clustering: theory, algorithms, applications, vol. 20. siam. garca, c., chvez, d., jimnez, i., rudomin, p. (2004). effect spinal peripher nerv lesion intersegment synchron spontan activ dorsal horn neuron cat lumbosacr spinal cord. neurosci. lett. 361, 102105. doi: 10.1016/j.neulet.2003.12.068 halkidi, m., batistakis, y., vazirgiannis, m. (2001). cluster valid techniques. j. intell. inform. syst. 17, 107145. doi: 10.1023/a:1012801612483 jolliffe, i. (2002). princip compon analysis. springer seri statistics. lewicki, m. (1998). review method spike sorting: detect classif neural action potentials. netw. comput. neural syst. 9, 5378. doi: 10.1088/0954-898x/9/4/001 liang, z., wang, y., sun, x., li, d., voss, l., sleigh, j., et al. (2015). eeg entropi measur anesthesia. front. comput. neurosci. 9:16. doi: 10.3389/fncom. 2015.00016 lin, j., keogh, e., lonardi, s., patel, p. (2002). find motif time series, proceed second workshop tempor data mine (edmonton, ab). lovsz, l., plummer, m. (2009).match theory. north holland. manjarrez, e., roja piloni, j., jimnez, i., rudomin, p. (2000). modul synapt transmiss segment affer spontan activ dorsal horn spinal neuron cat. j. physiol. 529, 445460. doi: 10.1111/j.1469-7793.2000.00445.x newcombe, r. g. (1998). interv estim differ independ proportions: comparison methods. stat. med. 17, 873890. doi: 10.1002/(sici)1097-0258(19980430)17:8<873::aid-sim779>3. 0.co;2-i rodrguez, e., hernndez-lemus, e., benjamin, a., itz-ortiz, a., jimnez, i., rudomin, p. (2010). multichannel detrend fluctuat analysi reveal synchron pattern spontan spinal activ anesthet cats. plo 6:0026449. doi: 10.1371/journal.pone.0026449 rudomin, p. (2009). search lost presynapt inhibition. exp. brain res. 196, 139151. doi: 10.1007/s00221-009-1758-9 rudomin, p., chvez, d., contreras, e., rodrguez, e., hernndez, e., glusman, s. (2012). system lidocain transient restor disrupt function connect dorsal horn neuron ensembl produc capsaicin-induc skin inflammation. abstr. soci. neurosci. abstract retriev abstract viewer/itinerari planner (179.20). rudomin, p., hernndez, e. (2008). chang synapt effect myelin joint affer capsaicin-induc inflamm footpad anesthet cat. exp. brain res. 187, 7184. doi: 10.1007/s00221- 008-1281-4 rudomin, p., jimnez, i., quevedo, j., solodkin, m. (1990). pharmacolog analysi inhibit produc last-ord intermedi nucleu interneuron mediat nonreciproc inhibit motoneuron cat spinal cord. j. neurophysiol. 63, 147160. rudomin, p., solodkin, m., jimnez, i. (1987). synapt potenti primari affer fiber andmotoneuron evok singl intermedi nucleu interneuron cat spinal cord. j. neurophysiol. 57, 12881313. solodkin, m., jimnez, i., collins, w. f., mendell, g., rudomin, p. (1991). interact baselin synapt nois ia epsps: evid appreci neg correl physiolog conditions. j. neurophysiol. 65, 927945. traub, r. (1997). spinal modul induct central sensitization. brain res. 778, 3442. doi: 10.1016/s0006-8993(97)00946-3 vinh, n., epps, j., bailey, j. (2010). inform theoret measur cluster comparison: variants, properties, normal correct chance. j. mach. learn. res. 11, 28372854. conflict statement: author declar research conduct absenc commerci financi relationship constru potenti conflict interest. copyright 2015 martin, contreras-hernndez, bjar, esposito, chvez, glusman, cort rudomin. open-access articl distribut term creativ common attribut licens (cc by). use, distribut reproduct forum permitted, provid origin author(s) licensor credit origin public journal cited, accord accept academ practice. use, distribut reproduct permit compli terms. frontier neuroinformat | www.frontiersin.org 14 august 2015 | volum 9 | articl 21 martin et al. methodolog analysi cdp a. appendix a.1. measur compar histogram let consid simpl model histogram random variabl bin obei normal distribut p(x|nik) = 1 2ik e (xnik) 2 2ik (a1) expect valu bin equal nik varianc 2 ik = nik k histogram number (k = 1, 2). defin signific si = ni1 ni2 2i1 + 2 i2 (a2) nik observ valu bin histogram k 2 ik = nik. model consid approxim poisson distribut normal distribution. valu nik, (i = 1, 2, ...,m, k = 1, 2) number event appear bin histogram k. consid rm (the root mean square) distribut signific rm = m i=1(si s)2 m (a3) s mean valu si. rm measur distanc histograms. total number event n1 histogram 1 total number event n2 histogram 2 different, normal signific si(k) calcul follow si(k) = ni1 kni2 2i1 + k2 2 i2 (a4) k = n1/n2. relat rms2 = 2/m s2 exist distribut signific 2 = m i=1 s 2 . distribut observ signific close normal distribut rm 1. distanc measur histogram clear interpretation: rm 0 histogram identical, rm 1 histogram obtain parent distribution, rm 1 histogram obtain differ parent distributions. frontier neuroinformat | www.frontiersin.org 15 august 2015 | volum 9 | articl 21 machin learn methodolog select classif spontan spinal cord dorsum potenti allow disclosur structur (non-random) chang neuron connect induc nocicept stimul 1. introduct 1.1. plan work 2. materi method 2.1. data 2.2. visual identif cdp 2.3. phase involv cdp identif 2.4. relat work 2.5. approach autom identif 3. cdp candid detect 3.1. nois estim 3.2. perform evalu 4. cluster select cdp 5. result 5.1. experiment evaluation: map ncdp npcdp dictionari 5.2. experiment evaluation: capsaicin experi 6. discuss futur work acknowledg refer a. appendix a.1. measur compar histogram