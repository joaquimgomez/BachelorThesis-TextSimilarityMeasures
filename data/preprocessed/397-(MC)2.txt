nodal exact ritz discret 1d diffusion-absorpt helmholtz equat variat fic modifi equat method c. a. felippa e. onat 2004, revis august 2005 accept public comput mechan tabl content page 1. finit calculu 1 2. modifi variat form 2 3. modifi equat method 3 3.1. backward error analysi . . . . . . . . . . . . . 3 3.2. appli modifi equat . . . . . . . . . . . 3 3.3. brief histori modifi equat . . . . . . . . . 4 3.4. free paramet nodal exact . . . . . . . . . 5 3.5. nodal exactness: advantag limit . . . . . . 5 4. diffusion-absorption-helmholtz problem 6 4.1. model problem . . . . . . . . . . . . . . . 7 4.2. exact solut . . . . . . . . . . . . . . . . . 7 4.3. convent ritz . . . . . . . . . . . . . . . 8 4.4. fic function . . . . . . . . . . . . . . . 9 5. ritz fic equat 9 5.1. patch modifi equat . . . . . . . . . . . 10 5.2. posit lower bound . . . . . . . . . . . . . . 11 5.3. diffus upper bound . . . . . . . . . . . . . 11 5.4. nodal exact match . . . . . . . . . . . . . . 11 5.5. pade approxim . . . . . . . . . . . . . . . 12 5.6. nodal exact verif . . . . . . . . . . . . 13 5.7. reduc integr element . . . . . . . . . . . . 13 5.8. sourc term . . . . . . . . . . . . . . . . . 14 5.9. numer result . . . . . . . . . . . . . . . 14 6. templat 18 7. gener variabl coeffici 20 7.1. vc model problem . . . . . . . . . . . . . . 21 7.2. reus cc templat . . . . . . . . . . . . . . 22 7.3. vc-custom templat . . . . . . . . . . . . . 22 7.4. numer result variabl coeffici . . . . . . . 22 8. conclus 25 a. process modifi equat 25 a.1. reduct seri identification. . . . . . . . . . . . . . . . . . . . . . 25 a.2. reduct theorem muir. . . . . . . . . . . . . . . . . . . . . . 26 refer . . . . . . . . . . . . . . . . . . . . . . 28 nodal exact ritz discret 1d diffusion-absorpt helmholtz equat variat fic modifi equat method carlo a. felippa eugenio onat * depart aerospac engin scienc center aerospac structur univers colorado boulder, colorado 80309-0429, usa intern center numer method engin (cimne) edificio c-1, c. gran capitan s/n universidad politecnica cataluna 08034 barcelona, spain abstract. articl present applic finit calculu (fic) ritz-fem variat framework. fic provid steplength parametr mesh dimensions, modifi shape functions. approach appli fem discret steady-state, one-dimensional, diffusion-absorpt helmholtz equations. parametr linear shape function directli insert fic functional. result ritz-fic equat symmetr carri element-level free paramet come function modif process. constant- variable-coeffici case studied. shown paramet produc nodal exact solut constant coeffici case. optim valu match finite-ord modifi differenti equat (fomode) ritz-fic equat origin field equation. inclus ritz-fic model context templat examined. inclus show infinit number nodal exact model constant coeffici case. ingredi method (fic, ritz, mode templates) extend multipl dimensions. keywords: finit calculus, variat principles, ritz method, function modification, stabilization, finit element, diffusion, absorption, helmholtz, nodal exact solution, modifi differenti equation, templates. 1. finit calculu finit calculu (fic) develop past year [2335] gener purpos tool improv stabil accuraci interior discret equat mathemat physic engineering. consid problem govern residu equat r(u) = 0, (1) u arrai n primari variables. turn function independ variabl x, includ time. gener (1) ordinari partial differenti equation, solv numer methods. introduc n characterist length hi collect arrai h, hi pair function ui . length view linked, unspecifi means, mesh grid dimensions. flux balanc argument [26,27] modifi residu construct r(u) + rh(u, h) = 0. (2) 1 simplest form rh 12r h, r gradient matrix r respect independ variables. discret process, usual galerkin-bas fem, appli (2) instead (1). consist requir rh 0 hi 0. philosophi fic, emphas name, practic hi remain finite. kei goal pick rh h stabil accuraci characterist solut given mesh improved. analysi local phenomena, sharp boundari layers, carri multiscal devic [6,19,30]. fic analysi process diagram figur 1. fic primarili solut fluid mechan equat involv flow, advection, dif- fusion, ocean wave chemic reaction [23 35]. applic compet stabi- lizat scheme supg, residu free bub- ble subgrid scale method [3,4,9,10,19]. studi fic method solid mechan [36] variat form formal anal- ogou minimum potenti energi principl obtain modifi displacement, strain stress field manner similar residu forego description, adjust variations. analysi process balanc analysi discret accuraci analysi weak form residu r(u) = 0 galerkin similar discret form pick steplength h numer solut finit calculu modifi residu r(u) + r (u,h) = 0h figur 1. weak-form-bas fic analysi process. approach technic fall class variat principl noncommut variat [43], call modifi variat principl literatur [8]. find provid departur point present study. 2. modifi variat form suppos (1) deriv function j [u] sens r(u) = 0 euler-lagrang equat j . variat j [u] = ut r(u). (3) defin modifi primari variabl field: u def= u + uh(h), (4) uh 0 h 0. choic consid here, suggest previou studi noted, u = u 1 2 ht u. (5) h overal characterist length, arrai collect scale paramet , factor 12 conveni match standard fic method. analysi process discret accuraci analysi residu r(u) = 0 ritz discret form pick steplength h numer solut euler- lagrang equat variat principl j[u] = 0 modifi variat principl j[u,h] = 0 finit calculu figur 2. variat fic analysi process. substitut (5) j yield modifi function jh = j [u] = j + jh, (6) 2 augment term jh vanish h 0. euler-lagrang equat chang jh[u] = ut [ r(u) + rh(u) ] . (7) formal configur (3), share properti h 0 euler-lagrang equat reduc (1). gener start rh(u) fic, (2), reproduc rh . avoid confus qualifi (7) fic variat residual. function jh call fic-modifi functional, fic function brevity. (the superpos tild eventu drop breviti danger confusion.) numer approxim obtain work jh usual way, assum h known. residu studi stabil accuraci properti approximation. analysi process diagram figur 2. 3. modifi equat method accuraci analysi stage figur 2 method modifi equations. known techniqu differenti equations, summari histor outlin present here. exampl relev target applic problem work appendix a. 3.1. backward error analysi convent wai analyz accuraci discret approxim forward error analysis: discret solut fail satisfi sourc differenti form. measur practical, comput local estim truncat residu error (in fem, recoveri element patches). techniqu furnish posteriori error indicators, develop literature. backward error analysi take revers approach accuracy. given comput solution, asks: problem method actual solved? words, seek od pde which, exactli solved, reproduc comput solution. od pde call modifi differenti equation, abbrevi mode sequel. differ modifi equat origin provid estim error. import practic advantag modifi equat gener actual solv discret problem. approach routin matrix comput wilkinson definit work 1960 [4749] standard numer linear algebra courses. known differenti equations. neglect unfortunate, concept follow common sense. applic problem involv physic paramet mass, damping, stiffness, conductivity, diffusivity, etc., known approximately. transient load action (e.g, earthquakes, winds, waves) subject high uncertainties. modifi equat model nearbi problem paramet rang experiment uncertainty, good origin one. defect correct basi control accuraci priori, comput actual carri out. 3.2. appli modifi equat let rh(u, h, ) = 0 denot discret ordinari partial differenti equat r(u) = 0. [a section 12, h collect length (in space, time both) relat mesh grid dimens collect free parameters]. process modifi equat involv steps: 3 step 1: patch discret ddmode. discret equat typic node (a patch fem terminology) render continu independ variable(s). produc difference- differenti form (call delay-differenti form time independ variable), abbrevi ddmode. step 2: ddmode iomode. differ portion ddmode convert differenti form taylor seri expans mesh dimens collect h. step produc modifi differenti equat infinit order, abbrevi iomode. step 3: iomodefomode. iomod reduc finit order differenti equation, fomode. systemat elimin higher order derivatives. process typic produc infinit seri discret dimensions. seri occasion identifi sum close form. technic (by far) difficult step. gener requir us algebra (cas) viable. compar fomod origin problem learn struc- tural aspect discret comparison physic pa- ramet values. example: preser- vation hamiltonian flow con- servat law discret system. imposs difficult an- alyz convent truncat error measures. procedur step outlin flow-chart figur 3. chart show paramet match step achiev nodal exactness, discuss section 3.4 below. reduc finit order elimin high order deriv parametr discret fic match adjust free paramet (if possible) convert difference-differenti form (aka delay-differenti form) pass infinit order taylor expans mesh dimension(s) r(u) = 0 r (u,h,) = 0h r (u,h,) = 0io r (u,h,) = 0dd r (u,h,) = 0 fo discret form given ode/pd ddmode iomod fomod step 1 step 2 step 3 figur 3. step modifi equat method. achiev nodal exact requir close loop. discuss 3.4, involv addit assumptions. 3.3. brief histori modifi equat modifi differenti equat truncat form infinite-ord od appear conjunct finit differ discret comput fluid dynam (cfd). prescript construct richtmyer morton textbook [39, p. 331]. modifi form interpret numer dissip dispers lax-wendroff treatment shocks, deriv correct operators. similar idea hirt [18] roach [40]. drawback earli work guarante truncat retain relev behavior finit mesh dimensions, discard portion domin coars discretizations. warm hyett [45] correct procedur elimin high order time deriv pde space-tim discret wai finite-ord modifi equat (fomode). (space dimens treat fourier methods.) attribut modifi equat lomax [22]. fomod form studi accuraci stabil cfd operators. work origin equat typic model flow effect conduct convection, h includ grid dimens space time, feedback adjust paramet term improv stabil reduc spuriou oscil (e.g. artifici viscos upwinding) dispersion. 4 mode us studi space fem discret structur mechan [44]. deriv elimin forc lump procedur faulty, led incorrect conclusions. correct park flagg [37,38], who, awar method [45] modifi equat systemat studi c0 beam, plate shell fem discretizations. method recent attract attent numer mathemat commun pro- vide effect tool understand long-tim structur behavior comput dynam systems, determinist chaotic. recommend refer [1114,41]. web access mapl script reduct process infinit finit order present [2]. littl work date modifi equat optim select free parameters. except [12]. 3.4. free paramet nodal exact suppos discret rh(u, h, ) = 0 contain free paramet collect . discuss section 12, case fic discretizations, variation base not. obvious free paramet carri modifi equat forms: rdd(u, h, ) = 0, rio(u, h, ) = 0 rfo(u, h, ) = 0. assum available, question paramet chosen rfo(u, h, m) r(u), h. (8) subscript m stand matching. possible, discret rh(u, h, m) nodal exact. is, exact answer node discret gener finite-ord modifi equat matched. fem discret scheme label nodal exact patch test, modifi equat necessarili obtain element patch. idea straightforward attract fraught technic difficulties. particular: exact match possibl drastic restrict dimensionality, properti discretization. instance: constant coefficients, sourc terms, regular meshes. exact match impossible, measur fit (projection, minimization, etc) chosen. solut imaginary, non-unique, inexistent, hard compute. fomod contain parasit term present govern equation, cancel choos parameters. example: sourc laplac equat uxx + uyi = 0 fomod hold parameter-fre cross-deriv term uxi . emerg parasit term fact observ park flagg studi c0 plate shell element [37,38]. occurr trace consist defect discretization; studi presenc parasit term flag element locking. attain close form fomod gener possibl space dimension. truncat required. case fit expect deliv better solut fix mesh. symbol manipul prohibitive, help algebra system. posit side, approach complet general, link discret method. proven rh(u, h, ): finit elements, finit differences, boundari elements, etc., irrelevant. restrict problem dimensionality, requir knowledg exact solutions. fem discretizations, procedur achiev nodal exact tong adjoint techniqu [42]; [50, app. 7]. requir find exact homogen solut r(u) = 0, insert weight function petrov-galerkin discretization. relat scheme base local enrich homogen and/or particular solutions, exampl [5,6] 5 3.5. nodal exactness: advantag limit featur nodal exact (ne) discret illustr figur 4. show exact solut variable-coeffici boundary-valu problem (bvp), later section 7 test example: u = 750 x u, u(1) = 25, u(1) = 4, (.) d2(.)/dx2. (9) compar fem discretiza- tion 6 two-nod element each. label nelvc come model nodal exact coeffici u vari linearli x element. label ficm1 nodal exact constant coefficients. (these model de- velop section 5 7, respectively, others.) case fem solut node interpol linearly. approxim plainli inadequ differ reasons. nelvc piecewis linear interpol wide miss fast variat exact solution, particularli oscillatori side. 1 0.5 0 0.5 1 0 30 20 10 10 20 30 u x nodal exact element linearli vari coeffici (nelvc) nodal exact element constant coeffici (ficm1) exact solut figur 4. featur nodal exact discret bvp (9). solut exponenti behavior, sharp boundari layer, x < 0. oscillatory, increas frequency, x > 0. node valu nelvc mark small circles. defici resolv better intra-el interpol (for example, element deriv shape functions) local refinement. advantag multiscal model nonetheless clear: individu element extract convert local bvp end node values, physic behavior smaller scale introduc appropriate. postprocess feasibl nodally-inexact discretization, wai oscillatori side. 1 0.5 0 0.5 1 30 20 10 0 10 20 30 1 0.5 0 0.5 1 0 30 20 10 10 20 30 (a) (b) exact solut exact, ficm1 & nevc coincid plot toler nodal exact element constant coeffici (ficm1) nodal exact element linearli vari coeffici (nelvc) figur 5. converg behavior discret bvp (9): (a) 24 element (b) 96 elements. mesh refined, nelvc solut quickli lock correct behavior, pictur figur 5(a) 24 elements. solut remain inadequ oscillatori x > 0 3 element fit shorter wavelengths. go 96 element fem solut distinguish exact plot scale figur 5(b). happen 12 element (shortest) wavelength approxim power ficm1 model final realized, coeffici u(x) sensibl constant element. 6 4. diffusion-absorption-helmholtz problem section 47 illustr variat fic discret construct modifi equat steady-state, one-dimension diffusion-absorpt helmholtz equations. problem recent examin onate, miquel hauk [35] fic-galerkin standpoint. studi includ advect term consid here. govern differenti equat model one-dimensional, steadi state, diffusion-absorpt process d dx ( k du dx ) su + q = 0, x [xm, x p] (10) equat u state variable, x [xm, x p] problem domain, k 0 diffusion, s 0 absorpt (also call dissip destruct parameter) q sourc term. prime denot differenti respect x , forego od abbrevi ( k u ) s u + q = 0. (11) flux defin q = k(du/dx) = k u, boundari condit state u = u u, q = q, q . (12) u q dirichlet neumann boundaries, respectively. one-dimension problem consist combin taken end problem domain. problem admit classic variat formulation. sourc function j [u] = x p xm ( 1 2 k(u)2 + 1 2 su2 qu ) dx . (13) take variat j = 0 admiss function u(x) satisfi essenti bc yield differenti equat (10) euler-lagrang equation, flux constraint (12) natur boundari conditions. 4.1. model problem follow [35] assum k = 0, model form (10) obtain introduc dimensionless coeffici w = sa 2 k , (14) = x p xm length problem domain. coeffici character rel import absorpt diffusion. problem domain adjust extend xm = 12 x p = 12 convenience. assum zero source: q = 0, dirichlet boundari condit ends: u( 1 2 a) = um u( 12 a) = u p. state model problem u w a2 u = 0 x [ 1 2 a, 1 2 a], u( 1 2 a) = um, u( 12 a) = u p. (15) associ function j [u] = 1 2 ( (u)2 + w a2 u2 ) dx . (16) variat taken continu u(x) satisfi priori dirichlet bcs. 7 0.4 0.2 0.2 0.4 2 4 6 8 10 0.4 0.2 0.2 0.4 2 4 6 8 10 0.4 0.2 0.2 0.4 10 5 5 10 0.4 0.2 0.2 0.4 2 4 6 8 w = 0 w = 50 w = 50w = 1000 (a) (b) (c) (d) x x x x u u u u10 figur 6. behavior exact solut model equat = 1, dirichlet bc u( 12 ) = 8 u( 12 ) = 3, valu w. 4.2. exact solut w > 0 exact solut model bvp (15) given term hyperbol functions: u(x) = sinh ( 1 2 w(1 ) ) um + sinh ( 1 2 w(1 + ) ) u p sinh( w) , = 2x/a. (17) express 0/0 w = 0 suffer cancel error |w| small, |w| < 108. case taylor seri w = 0 give o(w): u(x) 1 2 [ 1 + w 24 ( 223) ] um + 1 + 2 [ 1 + w 24 ( 2+23) ] u p, = 2x/a. (18) sampl solut displai figur 6 = 1, um = u( 12 ) = 8, u p = u( 12 ) = 3, w = 1000, 50, 0 50. w = 0 solut straight line. w grows, exponenti boundari layer appear dirichlet boundaries. illustr figur 6(a,b). w = 1000 solut small problem domain sharp boundari layer near x = 1 2 a. w < 0, (15) space helmholtz equat linear acoustics: u + k2 u = 0 wavenumb k2 = w/a2. solut harmonic: u(x) = sin ( (1 ) ) um + sin ( (1 + ) ) u p sin(2) , = 2x/a, 2 = w. (19) scale wavenumb = w/(2) = ka/(2) repres number full-cycl oscil domain length a. express (19) valid 2 = 0, 1, 2 . . ., denomin vanishes. figur 6(d) plot u(x) w = 50, case = 50/(2) = 1.1254 cycles. 8 4.3. convent ritz standard fem solut easili construct ritz variat formulation. divid domain n e two-nod element length le = a/n e = a. end node j , coordin xi x j , node valu ui u j , respectively. assum piecewis linear interpol u(x) = ui ni (x) + u j n j (x), (20) ni (x) = (x xi )/le, n j = (x j x)/le le = x j xi known linear shape functions. substitut (16) give element stiff equat seue = 1 le [ 1 + 1 3 1 + 1 6 1 + 1 6 1 + 1 3 ] [ ui u j ] = [ 0 0 ] , = le/a, = w2 = s(le)2/k. (21) w = 0 element relat gives, assembly, linear respons correctly. w = 0, us (21), scheme label unstabil ritz, displai known defect: w larg solut oscil coars meshes. illustr figur 10(a) ne = 8 element w = 1000. neg u valu physic incorrect w > 0, render solut useless. shortcom usual treat petrov-galerkin stabil scheme suitabl adjust weight functions. end result unsymmetr equat self-adjoint problem. 4.4. fic function stai ritz framework piecewise-linear shape functions, chang function method outlin section 2. problem, fic function modif techniqu consist formal replac u(x) = u(x) 1 2 hu(x), u(x) = u(x) 1 2 hu(x). (22) modifi function u(x) u(x) insert (15). tild suppress brevity. scheme yield modifi function jh[u], h fic steplength. h deriv origin fic flux balanc argument [26]. present context h simpli view free paramet dimens length. piecewis linear shape function u(x) vanish element, second replac (22) skipped. simplif modifi function jh[u] = 1 2 ( (u)2 + w a2 ( u 1 2 hu )2) dx . (23) euler-lagrang equat given jh[u] = 0 (1 + wh 2 4a2 )u w a2 u = 0. (24) fic variat residu follow jh = u [ (1 + 1 4 wh2/a2)u (w/a2)u ] . express (24) show nonzero h inject artifici diffus w > 0. furthermore, sign h make differ interior problem domain. h 0 origin od (15) recovered. kei idea fic h finit directli relat mesh size. 9 5. ritz fic equat fic function (23) conjunct piecewise-linear interpol (20) construct stabil ritz equat model diffusion-absorpt problem. steplength h = chang element element. conveni defin = e le e dimensionless paramet determin element. analysi follow restrict constant w element equal size le. elements. restrict remov section 7, studi variabl coeffici variant model problem. exact element integr (equivalently, two-point gauss integr rule), follow ritz fic element equat obtained: se ue = [ seii s e j sei j s e j j ] [ ui u j ] = 1 le [ 1 + ( 1 3 + 1 2 + 1 4 2) 2 1 + ( 1 6 1 4 2) 2 1 + ( 1 6 1 4 2) 2 1 + ( 1 3 1 2 + 1 4 2) 2 ] [ ui u j ] = [ 0 0 ] , (25) = le/a 2 = w2 = s(le)2/k. 5.1. patch modifi equat stiff equat patch equal- size element compris node i, j, k, pictur figur 7, x = x x j j k l = el = e _ x figur 7. patch equal length elements. 1 le 1 + ( 1 3 + 1 2 + 1 4 2) 2 1 + ( 1 6 1 4 2) 2 0 1 + ( 1 6 1 4 2) 2 2 + ( 2 3 + 1 2 2) 2 1 + ( 1 6 1 4 2) 2 0 1 + ( 1 6 1 4 2) 2 1 + ( 1 3 1 2 + 1 4 2) 2 [ ui u j uk ] = [ 0 0 0 ] . (26) investig choic need modifi equat version (26). patch equat node j si ui + sj u j + sk uk = 0, (27) si = sk = [12 + (2 32) 2]/(12 le) sj = [24 + (8 + 42) 2]/(12le). equat (27) continuifi difference-differenti modifi equat (ddmode) formal replac u j u(x), ui u(xle) uk u(x+le) si u(xle) + sj u(x) + sk u(x+le) = 0. (28) node valu u(x le) link u(x) deriv x = x j taylor series: u(xle) = u j leuj + 12 (le)2uj . . . , u(x+le) = u j + leuj + 12 (le)2uj + . . . , (29) replac (28), set le = collect term yield infinite-ord modifi equat (iomode): 6w a2 u + 1 2! u + 1 4! a22u + 1 6! a44u + ... = 0, (30) = 12 + (32 2)w2. truncat (30) second deriv make le 0, make 0, reduc origin equation: u = 12w a2 u = 12w[ 12 + (322)w2 ] a2 u =0 u = w a2 u. (31) 10 limit (31) confirm consist ritz equat origin od le 0, plai import role templat develop section 6. useful, however, nodal exact discretizations. deriv higher (30) systemat elimin techniqu outlin appendix a. elimin yield finite-ord modifi equat (fomode): u = 4 a22 ( arcsinh 2 )2 u, = 4 2 ( sinh w 2 )2 . (32) equat (26), (31) (32) studi suitabl choic paramet . 5.2. posit lower bound suppos ui > 0 uk > 0 prescrib patch equat (26). solv u j second equat give u j = 12 + (32 2)w2 24 + (62 + 8)w2 (ui + uk). (33) w 0, denomin posit 0 real . non-neg u j guarante 12 + (32 2)w2 0. met take 2 2p , 2 p = 2 3 4 w2 . (34) subscript p stand ensur positivity. result give us model guideline: w2 6, set zero, collaps variat fic convent ritz, impair positivity. example, w = 600, mesh 10 elements, i.e. < 1/10, = 0 preclud nonphys oscillations. set 2 = 2p element matrix se (25) cancel off-diagon terms. assembl s diagonal. solut zero sourc dirichlet condit end zero interior nodes. mimic boundari layer behavior larg posit w; w > 10000. posit smaller w solut wai off, show (34) view lower bound accept valu 2, highli diffus set 2d = 2/3 upper bound. result section 5.9, however, bound littl practic valu moder valu w > 0. useless helmholtz equation, w negative. 5.3. diffus upper bound suppos truncat modifi equat left (31) requir reduc origin od , = 0. obtain set 2 = 2d , 2 d = 2 3 . (35) comput 2 = 2d overestim diffus posit w. safe sens provid physic correct solutions. highli inaccur small moder w. result section 5.9 illustr point. method give us limit: w + fix mesh, 2 2d = 2/3 consistency. consequ bound 2p 2 2d w > 0. nodal exact valu 2 li interval. 11 w=1000 w=100 w=10 w=1 w=1 w= =11.4746... w=4 =45.898... 2 2 w0.2 0.4 0.6 0.8 1 20 40 60 80 100 0.4 0.5 0.6 (a) (b) 0 0 0.2 0.4 0.6 0.8 1 0.2 0.4 0.6 0.8 1 w=10 cut cut 2 2 figur 8. function 2m (w, ). (a): 2d plot fix w [1000, 2cut ] 2cut 11.4746. w2 = 2cut , 2m = 0; w2< 2cut , m imaginary. (b): 3d plot 2m versu w [0, 100] = [0, 1]. 5.4. nodal exact match nodal exact solut follow techniqu outlin section 3.4, requir (32) match origin equation. u = (w/a2) u {w, }. give 2 m = 2 3 4 w2 + 1 sinh2 ( 1 2 w ) = 2 3 4 2 + 1 sinh2(/2) , (36) = w subscript m stand matching. express (36) valid w > 0. w 0 0 cancel occur. resolv taylor seri expans 2 m = 1 3 + w 2 60 w 24 1512 + w 36 43200 w 48 1330560 + . . . (37) show 2m 1/3 0 w 0. figur 8 illustr variat 2m function w . vari 0 1, attain 1 element domain length a. posit w, 2m posit 2 d = 2/3. extens neg w cover helmholtz equat requir caution. comput difficulti 2m > 0 2 = w2 > 2cut , 2cut = 11.47463503286087328. w2 < 2cut , 2 m < 0 m imaginary. minimum number element posit 2 m follow condit (1/n e) = 2cut/(2) = 0.539125/ , = w/(2) number cycl oscil exact solut length a, cf. (19). solv n e give n e 1.85486 , (38) easili rememb rule n e 2 , element wavelength. solut cycl 16 time domain, us 32 element more. (38) verified, however, nodal exact solut obtain gener requir us complex arithmetic. mesh consist equal length element w constant, however, complex number occur row coeffici matrix, disappear altogeth appli dirichlet bcs. peculiar associ helmholtz equat presenc dirichlet resonances. w = k22 k = 1, 2, . . . 2 = w = k sin 2 = 0 exact solut (19) blow up. exact number cycl k fit [a/2, a/2], dirichlet bc um = u p inconsistent. practic valu w close gener larg amplitud oscillations. numer test floating-point arithmet show, however, nodal exact ritz-fic solut problem match larg oscil w extrem close reson value. 12 5.5. pade approxim implementation, exponenti function (36), caus numer accuraci problem w > 105, avoid pade approxim 2m . (2,2), (4,4) (6,6) diagon approxim comput mathematica 2 m22 = 1260 + 113w2 30(126 + 5w2) , 2 m44 = 3270960 + 339948w2 + 4787w24 189(51920 + 2800w2 + 39w24) , 2 m66 = 1966225060800 + 218635457040w2 + 4430449320w24 + 27010573w36 60(98311253040 + 6016210200w2 + 115773966w24 + 671585w36) . (39) < 1 4 w < 10000 provid 1, 2 3 digit accuracy, respectively. moder w2 higher approxim 1012 digit accuracy. w2 , 2m22, 2m44, 2m66 2 m88 approach limit 0.75333333333333, 0.64943698277032, 0.6703190462364 0.66590125338669, respectively. 2 exce 2d = 2/3 account consist condit discuss section 5.3, cutoff implement approximants. 5.6. nodal exact verif valuabl verif (36) obtain directli equat u j (33) exact node valu bvp pose 2-element patch prescrib node valu ui uk : uexactj = 12 (ui + uk) sech = 12 + (32 2) 2 24 + (62 + 8) 2 (ui + uk). (40) solv 2 simplifi give (36). method, however, exact solut available, happen dimension problems, modifi equat method reli knowledge. 5.7. reduc integr element forego ritz-fic equat construct exact element integration, equival two-point gauss rule. one-point gauss reduc integr (ri) rule used, element equat se ue = [ seii s e j sei j s e j j ] [ ui u j ] = 1 le [ 1 + 1 4 (1 + )2 2 1 + 1 4 (1 2) 2 1 + 1 4 (1 2) 2 1 + 1 4 (1 + )2 2 ] [ ui u j ] = [ 0 0 ] , (41) two-el patch equat 1 le 1 + 1 4 (1 + )2 2 1 + 1 4 (1 2) 2 0 1 + 1 4 (1 2) 2 2 + 1 2 (1 + )2 2 1 + 1 4 (1 2) 2 0 1 + 1 4 (1 2) 2 1 + 1 4 (1 + )2 2 [ ui u j uk ] = [ 0 0 0 ] . (42) 2 appear differ equat modifi equat forms. proceed obtain nodal exact m = 1 (/ ) 2 4 + 8/ 4/ 2 1 , = w, = cosh . (43) 13 0.2 0.4 0.6 0.8 1 20 40 60 80 100 w 1 0.75 0.5 0.25 0 0.2 m (b)(a) - 20 10 0 10 20 2 1.5 1 0.5 0 0.5 1 exactli integr ritz-fic (ficm2) = w 22 2 = /4 1 2 2 = 9 /4 2 2 reduc integr ritz-fic (ficm1) 2 11.47~~ cut figur 9. nodal exact m reduced-integr ritz fic element. (a) m (,) plot w 0; (b) compar nodal exact m exactli reduc integr posit neg valu w 2. variat m(w, ) plot figur 9(a). taylor seri m = 1 6 w 2 13 720 w 2 4 + 127 20160 w 3 6 + . . . (44) show m 0 w 0 0. variat m(w, ) diffusion-absorpt case w > 0 plot figur 9(a). neg smooth. behavior m helmholtz equat complic m , posit squar root (36). plot function 2 = w2 2 [25, 25] figur 9(b). m real w 2 2cut = 11.474635 . . . vari smoothly, m real 2 jump 2k = k22/4 k = 1, 2, . . .. root cosh(i |k |) = co |k | = 0. jump harmless, however, occur set dirichlet reson discuss section 4.2, exact solut (19) blow up. fact ri model advantag m stai real w, posit negative. exact solut m give solutions: 1 (/ ) 2 4 + 8/ 4/ 2/( 1) = cosh , appear root quadratic. take minu sign reproduc (43), take plu sign give m blow w 2 0, desirable. 5.8. sourc term mode treatment smooth sourc term q(x) u (w/a2)u = q(x) entir analog techniques, represent choices. base expand q(x) taylor series: q(x) = q(x j )+q (x j )(x x j )/a + . . . node j , insert fic function deriv consist node forc term q j usual methods. q(x j ), q (x j ) . . . appear rh iomodefomod elimin system, solut seri identifi fomode. altern q(x) expand fourier seri [37,38]. delta function sourc term process directly. 5.9. numer result section present numer result obtain ritz-fic method model problem (15). problem domain taken unit length (a = 1) extend xm = 12 = 12 x p = 12 = 12 . boundari condit dirichlet type: u( 12 ) = 8 u( 12 ) = 3. domain divid 8 element equal size; = le/a = 1 8 . valu w: 1000, 50, 50 14 0.4 0.2 0.2 0.4 2 2 4 6 8 w = 50(b) 0.4 0.2 0.2 0.4 10 5 5 10 w = 50 (c) 0.4 0.2 0.2 0.4 30 20 10 10 20 30 w = 1000(d) 0.4 0.2 0.2 0.4 2 2 4 6 8 10 w = 1000 (a) 10 x x x x u u u u 2 2 2 2 2 2 2 exact cr: = 0 ficd: = =2/3 ficp: = ficm2: = m p d figur 10. ritz-fic result 8-element discret diffusion-absorpt model problem with: (a) w = 1000, (b) w = 50, (c) w = 50, (d) w = 1000. dirichlet bc u( 12 ) = 8 u( 12 ) = 3, choic , compar exact solution. 1000, tested. result plot figur 10, list 10 decim place tabl 1 4. label shown tabl templat name assign section 6. result w = 1000. solut exhibit sharp boundari layers. propag region, extend roughli middl element discretization, u(x) take small posit values, order 103 less. problem discret choic : = 0 (convent ritz), 2c = 2/3, 2p = 101/375 = 0.410667 2m = 0.490503. numer result shown figur 10(a), list tabl 1. expect solut 2m nodal exact. result = 0 oscil give unaccept neg values. result d p correct physic behavior, bound boundari layer behavior sides. differ result comput d p exact solut mask scale plot, discrep interior point clear tabl 1. result w = 50. case pertain moder absorpt diffus ratio (14). boundari layer diffus exact solut resembl second degre parabola. problem discret choices: = 0, 2c = 2/3, 2p = 334/75 = 4.45333 2m = 0.345961. numer result plot figur 10(b) list tabl 2. solut 2m nodal exact. solut = 0 2c = 2/3 bound exact solution, maintain posit displai reason accuracy. result p wai expect rational construction. result w = 50. solut helmholtz equat goe roughli wavelength problem domain. neg valu u(x) physic admissible. problem dis- cretiz choices: = 0, 2c = 2/3, 2p = 434/75 = 5.78667 2m = 0.319898. note 15 tabl 1. ritz-fic 8-element solutions, w = 1000. node exact 2 = 0 (cr) 2d = 23 (ficd) 2p (ficp) 2m (ficm2) 1 8.0000000000 8.0000000000 8.0000000000 8.0000000000 8.0000000000 2 0.1535996812 1.0514115126 0.4553713752 0 0.1535996812 3 0.0029491079 0.1381982018 0.0259204876 0 0.0029491079 4 0.0000566306 0.0182784646 0.0014772218 0 0.0000566306 5 0.0000014948 0.0028186197 0.0001154770 0 0.0000014948 6 0.0000212544 0.0071239995 0.0005580649 0 0.0000212544 7 0.0011059158 0.0518597445 0.0097204167 0 0.0011059158 8 0.0575998805 0.3942838932 0.1707642790 0 0.0575998805 9 3.0000000000 3.0000000000 3.0000000000 3.0000000000 3.0000000000 tabl 2. ritz-fic 8-element solutions, w = 50. node exact 2 = 0 (cr) 2d = 23 (ficd) 2p (ficp) 2m (ficm2) 1 8.0000000000 8.0000000000 8.0000000000 8.0000000000 8.0000000000 2 3.3105043651 3.2068850933 3.4002474704 0 3.3105043651 3 1.3801678534 1.2942058990 1.4569382771 0 1.3801678534 4 0.6001402687 0.5439870932 0.6518621127 0 0.6001402687 5 0.3203030826 0.2823794489 0.3560532239 0 0.3203030826 6 0.3074243641 0.2744060401 0.3384109163 0 0.3074243641 7 0.5507702703 0.5129051224 0.5851521371 0 0.5507702703 8 1.2531588628 1.2120974286 1.2890434650 0 1.2531588628 9 3.0000000000 3.0000000000 3.0000000000 3.0000000000 3.0000000000 tabl 3. ritz-fic 8-element solutions, w = 50. node exact 2 = 0 (cr) 2d = 23 (ficd) 2p (ficp) 2m (ficm2) 1 8.0000000000 8.0000000000 8.00000000000 8.0000000000 8.0000000000 2 2.1905465154 0.0898920049 3.91683000520 0 2.1905465154 3 5.2217158313 7.8823533208 3.22636343116 0 5.2217158313 4 8.8132821321 10.4059673187 7.84896043693 0 8.8132821321 5 5.9562263170 5.7365163498 6.33955710134 0 5.9562263170 6 1.2589621643 2.8982685015 0.12262521967 0 1.2589621643 7 7.5529760894 9.5296419462 6.48900658781 0 7.5529760894 8 8.3205257619 9.5737052899 7.78585155923 0 8.3205257619 9 3.0000000000 3.0000000000 3.00000000000 3.0000000000 3.0000000000 tabl 4. ritz-fic 8-element solutions, w = 1000. node exact 2 = 0 (cr) 2d = 23 (ficd) 2p (ficp) 2m (ficm2) 1 8.0000000000 8.0000000000 8.0000000000 8.0000000000 8.0000000000 2 11.5432046602 4.5551330632 0.5903534034 0 11.5432046602 3 23.8970551078 2.6374205639 0.0435651218 0 23.8970551078 4 21.3673096334 1.6039299876 0.0032213812 0 21.3673096334 5 5.5295477072 1.1081731645 0.0003261977 0 5.5295477072 6 13.7521345403 0.9839426045 0.0012230626 0 13.7521345403 7 24.4686939039 1.1895887560 0.0163380309 0 24.4686939039 8 19.9456285035 1.7940565712 0.2213826078 0 19.9456285035 9 3.0000000000 3.0000000000 3.0000000000 3.0000000000 3.0000000000 16 2m posit w 2 = 50/64 > 11.4746, imaginari number appear. numer result plot figur 10(c) list tabl 3. solut 2m nodal exact. result = 0 2d = 2/3 bound exact solut follow shape reason well. solut p worthless. result w = 1000. rapidli oscillatori respons goe roughli cycl problem domain, = w/(2) 5.03. problem discret = 0, 2c = 2/3, 2p = 0.92667 2m = 0.261754. 2m neg w2 = 1000/64 = 11.875 < 11.4746. numer result plot figur 10(d) list tabl 4. 2m produc nodal exact solution, 8-element piecewis linear interpol wavelength plainli inadequ captur intra-el oscillations. 0.4 0.2 0.2 0.4 30 20 10 10 20 30 0.4 0.2 0.2 0.4 30 20 10 10 20 30 0.4 0.2 0.2 0.4 30 20 10 10 20 30 0.4 0.2 0.2 0.4 30 20 10 10 20 30 8 element 16 element 32 element 64 element x x x x u u u u 2 2 2 2 2 exact cr: = 0 ficd: = =2/3 ficm2: = m d figur 11. ritz-fic converg studi rapidli oscillatori case w = 1000. boundari conditions: u( 12 ) = 8 u( 12 ) = 3. shown result 8, 16, 32 64 elements, choic : m , d convent ritz = 0. result p omit worthless. effect inject element later case illustr figur 11. show result choic 8 64 elements. 64-element mesh place 10 element wavelength, adequ known empir rule approxim sinusoid waveforms. benefici effect nodal exact evident. result non-match choic , notabl convent ritz, displai errat behavior fine discretizations. replac exactli integr ritz-fic model reduced-integr model match m (43) yield ident results. 17 continuifi taylor seri expans elimin hod match step 1 step 2 step 3 origin od fomod discret (patch) form ddmode iomod u'' u = 0 w a2 ritz fic discret s u + s u + s u = 0i j ii j k j e e u = 2 2 ( arcsinh 2 )2 u = (2 + s )/( s )i ij j 4 s u(xl ) + s u(x) + + s u(x+l ) = 0 2 1 1 2! 4!2 2 2 u + u''+ u''''+ ...= 0 2a s + 2 s cosh( w) = 0 figur 12. nodal exact condit match patch equat (48) si = sk , correspond constant coeffici w equal length element le = . 6. templat exact- reduced-integr fic-bas element obtain set 2 (36) (43), respectively, nodal exact lead complet differ finit element matrices. nodal exact model helmholtz equation, develop harari hugh [1517] produc set matrices. surpris lack uniqu rais question: nodal exact element construct absorption-diffusion-helmholtz equat constant coefficients? templat provid correct answer: infinit number. templat [7] parametr algebra form fem matric includ possibl element priori constraints, symmetry, enforced. set paramet specif valu function produc element instances. set valu call templat signature. assum symmetry, element coeffici matrix model problem place templat framework split se = sek + sem , sem = w2 6le [ 2+1+2+3 11 11 2+1+23 ] , sek = 1 le [ 1+4+5+6 14 14 1+4+56 ] . (45) matrix sek (stiffness-like) s e m (mass-like) come (u )2 u2 terms, respectively, variat formulation. (45) 1 6 dimensionless paramet chosen. vanish convent ritz equat (21) piecewis linear shape function result. interpret specifi deviat convent ritz. (if unsymmetr matric permitted, produc exampl petrov-galerkin methods, paramet enter matrix total eight.) obviou simplif sum sem +sek appear fem equat diffusion- absorpt helmholtz problems, paramet redundant. consequ set 4 = 5 = 6 = 0 leav sk unchanged, set 1 = 2 = 3 = 0 leav sm unchanged. ensu develop choic selected. (45) reduc sem = w2 6le [ 2+1+2+3 11 11 2+1+23 ] , sek = 1 le [ 1 1 1 1 ] . (46) 18 tabl 5. templat instanc 1d diffusion-absorption-helmholtz constant coeffici instanc descript nodal gener performance, troubl spot exact? cr convent ritz element (21). nonphys oscil w > 0 w 2 > 6. errat behavior w < 0 (helmholtz). ficp exactli integr ritz-fic element 2 = 2p (34), guar- ante posit w > 0. zero solut interior nodes, mimic boundary-lay behavior huge w > 0. useless w < 0 (helmholtz). ficd exactli integr ritz-fic element 2 = 2d = 2/3 (35), set high artifici diffusion. correct physic behavior w > 0, especi larg values. perform poorli w < 0 (helmholtz). ficm1 reduc integr ritz-fic element set (42). cc-ele behavior ident ficm2 w 0. higher wavenumb valid rang ficm2 w < 0 (helmholtz). ficm2 exactli integr ritz-fic element 2 set (36). cc-ele behavior ident ficm1 w 0. imaginari coeffici 2 < 11.4746. hhh harari hugh [16] nodal ex- act element one-dimension ex- terior helmholtz. cc-ele w > 0, perform ident ficm1 ficm2. w < 0 (helmholtz) sm null wavenumb note tabl 6. necc templat set match fomod vari length elements. cc-vle perform ident ficm1, ficm2 hhh w > 0 element equal length. maintain nodal exact element length vary. cc-ele: nodal exact constant coeffici equal-length elements. cc-vle: nodal exact constant coeffici variabl length elements. 2 + 31 = 0 3 = 0, take 1 = 1 0 2 = 3(0 1), 0 extract scale factor sem paramet remains: sem = w20 6le [ 2 1 1 2 ] , sek = 1 le [ 1 1 1 1 ] . (47) gener form 2-element patch equat si ui + sj u j + sk uk = 0. (48) constant coeffici equal-length elements, si = sk . modifi equat process step particular case diagram figur 12. iomod express displai indic consist origin equat mesh refin requir = (2si + sj )/(2si ) w 0. templat (46), si = sk = 6w(1 1)2/(6a) sj = (6 + 6w(1 + 2 + 2)2)/(3a). = 2w(3 + 2) (6 + w(1 1)2 0 = w(1 + 1 3 2) 2|0 = 0. (49) 19 tabl 6. templat signatur element tabl 5. instanc templ. templat signatur troubl spot form cr (46) 1 = 2 = 3 = 0. nonphys oscil w 2 > 6. ficp (46) = w, 2 = 2/3 4/ 2 1 = 1 6/ 2, 2 = 0, 3 = 3. 1 2 = w 2 = 6. ficd (46) 1 = 1, 2 = 0, 3 = 6. ficm1 (46) = w, = cosh , = 1 (/ ) 2 4 + 8/ 4/ 2 1 1 = (32 1)/2, 2 = 3, 3 = 0. w < 0, entri jump w = 1 2 n, n = 1, 2, . . .. figur 9 13(a). ficm2 (46) = w, 2 = 23 4 2 + 1sinh2(/2) 1 = 32/2, 2 = 0, 3 = 3. w < 0 w > 3.3874 . . . diagon entri sem complex. figur 9 13(b). hhh (47) = w, = cosh , 0 = 6( 1) 2 ( + 2) w < 0 w = 2n, n = 1, 2, . . ., 0 = 0 , make sem = 0. figur 13(c). necc (46) = w, 1 = 2 6 + 6/ sinh 2 , 2 = (6/ ) tanh(/2) 3, 3 = 0. w < 0 w = n, n = 1, 2, . . ., entri sem blow up. figur 13(d). match nodal exact yield si + 2sj cosh = 0 = w. term paramet templat (46), condit 6 + w (2 + 1 + 2)2 = ( 6 + w (1 1)2 ) cosh . (50) notic 3 appear (50) equal-element-length cancellations. forego condition, solv 1 2, show infinit number nodal exact finit element model form one-paramet family. instanc famili shown tabl 5 6. identifi label ficm1, ficm2, hhh necc. match fic element obtain section 5.7 5.4, respectively, hhh obtain harari hugh [16]. studi variable-element-length case, omit save space, show necc instanc nodal exact discretizations. nodal exact instanc tabl 67 troubl spot appli helmholtz equat w < 0, = w/(2) exce 1/2. spot displai figur 13. 7. gener variabl coeffici section studi applic forego discret method variable-coeffici gener (10): k u s(x) u + q = 0, (51) k 0 constant s linear function x . previously, comput domain x [xm, x p] dirichlet boundari condit u(xm) = um u(x p = u p. particular 20 (a) ficm1 s22 s11 s12 0 0.5 1 1.5 2 2.5 4 2 0 2 4 0 0.5 1 1.5 2 2.5 4 2 0 2 4 0 0.5 1 1.5 2 2.5 4 2 0 2 4 0 0.5 1 1.5 2 2.5 4 2 0 2 4 s = s11 22 s12 (b) ficm2 s12 (d) necc s12 (c) hhh s s complex > 0.5387... 11 22 s = s11 22 = s11 22 s s s s 11 12 12 22 s =em notat figur figur 13. troubl spot coarse, nodally-exact discret constant-coeffici helmholtz equat w < 0. graph plot entri 2 2 matrix sem instanc (a) ficm1, (b) ficm2, (c) hhh (d) necc, function scale wavenumb = w/(2). number element wavelength n e = 1/(). difficulti start roughli > 1/2, n e < 2. jump (a) occur dirichlet reson harmless. s chang sign comput domain. u(x) exhibit boundary-lay exponenti decai behavior portion s > 0, transit oscil vari frequenc s < 0. illustr analyt solut curv figur 45. goal investig variat fic method handl simultan diffusion- absorpt helmholtz type equat bvp. restrict linear variat x impos close form solution, term airi functions, avail comparison. function rare us classic mechan applic laser optics, quantum mechanics, electromagnetics, radi heat transfer. 7.1. vc model problem restrict comput domain 1 2 a, set q = 0, redefin w(x) = s(x) a2/k linear function x explicitli given w = w0 + (x/a). model problem u w a2 u = 0 w = w0 + x , x [ 1 2 a, 1 2 a], u( 1 2 a) = um, u( 12 a) = u p. (52) associ function obtain simpli chang w (16) w(x): j [u] = ( (u)2 + w0 + x 2a2 u2 ) dx . (53) variat taken continu u(x) satisfi priori dirichlet bcs. solut (52) express close form term airi function ai(x) bi(x), defin 21 exampl [1, sec. 10.4], follows. assum = 0, compute: = 3 2 , = 2x/a, z = (w0 + 12)/, z p = (w0 + 12)/, zm = (w0 12)/, ap = ai(z p), = ai(zm), bp = bi(z p), bm = bi(zm), = ai(z ), b = bi(z ), d = bp ap bm, u(x) = [(bp ap b )/d] um + [(am b bm )/d] u p. (54) (in symbol work, import squar take cubic root.) = 0 solut (54) fails. case w = w0 constant exact solut term exponenti given (17)(19) used. example, figur 45 exact solut (9), bvp fit (52) w = 3000x/a2, = 2, u(1) = 25 u(1) = 4. finite-ord modifi equat od requir hypergeometr function express close form, omit brevity. 7.2. reus cc templat expedi approach fem discret (52) reus templat instanc tabl 5 6. nodal valu w(x) wi w j , averag valu wm = (wi + w j )/2 form element. figur 14. example, reduced-integr ritz-fic element ficm1 given (41) = m come wm . hhh necc instanc wm insert formula tabl 6. xi j w wi m wj jslope = w - w l = e l /2 l /2 e e figur 14. variabl coeffici variat element. ritz-fic element ficm2 slight refin evalu w(x) = w() gauss point = 1/ 3, comput m there, us two-point gauss quadrature. numer experiments, however, reduc integr ficm1 perform consist better ficm2, forego refin incorporated. reus strategi gener work exponential-behavior portion comput domain w > 0. oscillatori (helmholtz) portion w < 0, converg errat fine mesh used. find clearli illustr plot figur 45. particular, figur 5(b) show 12 element shortest wavelength need satisfactori converg ficm1 oscillatori region. 7.3. vc-custom templat effort improv converg oscillatori regions, ritz-fic steplength paramet allow function x : = (x), match modifi vc equat attempted. however, match found. gradual realiz singl steplength paramet insufficient, gener framework templat introduc section 6 necessary. develop lengthi final result reported. us templat instanc custom vc case list tabl 7 8. model nelvc nodal exact linearli vari coefficient. (it known nelvc nodal exact model case). drawback nelvc, however, templat paramet express term airi function x-derivatives. difficult evalu appropri librari available. templat instances: mnecc cubvc, gener produc better result tabl 5 6 mesh, nodal exact. 22 tabl 7. templat instanc 1d diffusion-absorption-helmholtz variabl coeffici instanc descript nodal gener performance, troubl spot exact? mnecc modif necc account approxim variabl co- effici match truncat mode. reason accur w > 0 variat abrupt. requir fine mesh helmhotz. cubvc similar nelvc airi func- tion approxim cubic element. excel w > 0, sharp coeffici variation. accur helmholtz better mnecc. nelvc us airi function match mode exactly. ye nodal exact linear coeffici variation, matter abrupt. exact variabl length elements. tabl 8. templat signatur element tabl 7. instanc templ. templat signatur troubl spot form mnecc (46) 1, 2 = necc, 3 = 3 ( coth 1) 2w 2 . necc cubvc (46) d = 10w(11760 + 1456w 2 + 28w24 62), 1 = 72(1960w2 + 36w3 2 + 14 22 w42)/d, 2 = 7(4200w22 + 100w3 4 + 70 42 3w 62)/d, 3 = 3(39200 + 2240w 2 + 28w2 4 62)/d. necc nelvc (46) = 32, zm = (w 12 )/, z p = (w + 12 )/, ap = ai(z p), = ai(zm), bp = bi(z p), bm = bi(zm), ap = ai (z p), = ai (zm), b p = bi (z p), b m = bi (zm), d1 = bm + ap bp b m ap b p, d2 = (amap)(bmbp) (amap)(b mb p), d3 = ap bm bp + ap b m b p, d = ap bm bp, 1 = 16/ 2 + 3 d1 d 2 , 2 = 3 3 d2 d 2 , 3 = 3 d3 d 2 . fail = 0 checked. 7.4. numer result variabl coeffici test bvp (9), i.e. u = 750 x u, = 2, u(1) = 25 u(1) = 4. consequ w = 750 x a2 = 3000 x vari 3000 left 3000 right, = 6000. result mesh 8 64 element present figur 15 16. figur 15 collect result constant-coeffici nodal exact model tabl 56: ficm1, ficm2, hhh necc, plu convent ritz (cr). model perform reason exponenti region x < 0, captur boundari layer near x = 1 mesh refined. oscillatori region x > 0 models: ficm1, necc hhh, start converg satisfactorili 32 elements, agre exact solut 64 elements. models: cr ficm2, displai errat behavior throughout; fact converg notic 256 element more. 23 u x u x u x u x 1 0.5 0 0.5 1 30 20 10 10 20 30 1 0.5 0 0.5 1 30 20 10 0 10 20 30 1 0.5 0 0.5 1 30 20 10 0 10 20 30 1 0.5 0 0.5 1 30 20 10 0 10 20 30 8 element 16 element 32 element 64 element 0 ficm1 ficm2 necc hhh cr exact ficm1 ficm2 necc hhh cr exact ficm1 ficm2 necc hhh cr exact ficm1 ficm2 necc hhh cr exact figur 15. converg studi variabl coeffici od u = 3000 x u = 2, dirichlet boundari conditions: u(1) = 25 u(1) = 4. result shown 8, 16, 32 64 elements, nodal exact templat tabl 67 plu cr. u x u x u x u x 8 element 16 element 32 element 64 element 1 0.5 0 0.5 1 30 20 10 0 10 20 30 1 0.5 0 0.5 1 30 20 10 0 10 20 30 1 0.5 0 0.5 1 30 20 10 0 10 20 30 1 0.5 0 0.5 1 30 20 10 0 10 20 30 nelvc cubvc mnecc exact nelvc cubvc mnecc exact nelvc cubvc mnecc exact nelvc cubvc mnecc exact figur 16. converg studi variabl coeffici od u = 3000 x u = 2, dirichlet boundari conditions: u(1) = 25 u(1) = 4. result shown 8, 16, 32 64 elements, templat tabl 89. 24 figur 16 collect result vc-custom templat instanc tabl 7 8: mnecc, cubvc nelvc. exponenti accur captur coarsest mesh. nelvc cours nodal exact, defici intra-el variation. model begin displai nodal converg 16 elements, near x = 1, hardli distinguish nelvc plot scale 32 64 elements. mnecc perform surprisingli consid simplic templat signature, given tabl 8. 8. conclus articl present synthesi techniques: fic, variat ritz modifi differenti equations. major new contribut are: 1. fic approach function modification. permit effect stabil diffusion- absorpt problem stai ordinari ritz framework finit elements. separ choic trial weight function necessary. 2. us modifi equat (mode) approach valu stabil paramet nodal exact valu absorption-to-diffus ratio, includ neg valu morph origin od helmholtz equation. surpris discoveri nodal exact discret constant coeffici case unique, explain variant publish literature. introduct templat describ section 6, instanc character all. templat allow variabl coeffici case tamed, uniqu remain open question. chief attract modifi equat approach avail exact solut sourc od requir construct accur discretizations. featur import applic method dimensions. one-dimension problem discuss here, nodal exact discret obtain patch match illustr section 5.6. logic extens present combin method studi dimension space discret consid regular finit element patches. exact solut problem rare available, modifi equat method appear promis choic improv nodal solut fix meshes. ritz ingredient, however, drop problems, advection, easili formul variat framework appendix a. process modifi equat appendix present mathemat procedur applic modifi equat method. technic difficult oper process figur 3 pass infinit order modifi equat (iomode) finit order (fomode). univers method reduct process involv identif series. case case rule. nonetheless differenti equat mathemat physic natur lead toeplitz matrix forms. happens, arrai power techniqu available. illustr exampl convei flavor method find applic match procedur nodal exact section 56. a.1 reduct seri identif consid homogeneous, even-derivative, infinite-ord od depend variabl u(x): 2a2 u(x)+ 1 2! u(x)+ 22 4! u(x)+ 44 6! u(x)+ . . . = 0, > 0, = 0, 0 < 1. (55) 25 dimensionless real paramet a, characterist problem dimension, dimens length. reduct finit order obtain variant warm hyett [45] deriv elimin procedure, differenti (55) 2(n 1) time (n = 1, 2, . . .) respect x discard odd derivatives. truncat level , set linear deriv u, u, . . .. configur elimin illustr n = 4: 1/2! a22/4! a44/6! a66/8! 1 2 a2 1/2! a22/4! a44/6! 0 1 2 a2 1/2! a22/4! 0 0 1 2 a2 1/2! u u u u = 1 2 a2 u 0 0 0 . (56) coeffici matrix toeplitz hessemberg hermitian. solv u yield truncat fomode. solv (56) expand taylor seri give u = 56(360 + 60 + 2) u 20160 + 5040 + 2522 + 3 = ( 1 1 12 + 1 90 2 + . . . ) u. (57) = a22. increas n, coeffici power seri gener recurs c1 = 1, ck+1 = 12 k2ck/[(k + 1)(2k + 1)], k 1, produc sequenc {1, 1/12, 1/90, 1/560, 1/3150, 1/16632, . . .}. gener function [46] mathematica packag rsolv enter <<discretemathrsolve; g=generatingfunction[ a[k+1]==-k*k/(2*(k+1)*(2*k+1))*a[k],a[1]==1,a[k],k,]; print[g]. answer verifi print[series[g,{ ,0,8 }]. result 4 ( arcsinh 2 )2 = 1 12 + 2 90 3 560 + 4 3150 5 16632 + 6 84084 7 411840 + . . . (58) yield second-ord fomod u = 4 a22 ( arcsinh 2 )2 u = 4 a22 ( arcsinh 2 )2 u. (59) suppos origin od model bvp (15): u = (w/a2) u, constant w. nodal exactness, w = (4/2) ( arcsinh( 1 2 )2 . free parameter, solv give = 4 2 ( sinh w 2 )2 = 2 ( cosh( w) 1 ) 2 . (60) section 5.4 produc (36). forego analysi term equat (55) (59) assum small. procedur handl forc term f (x) follow essenti technique. occasion us recov higher deriv term u. repeat differ- entiat fomode. example, u = c u, u = c u = c2 u, likewis higher derivatives. 26 1 0.5 0 0.5 1 1 0.5 0 0.5 1 0 0.02 0.04 1 0.5 0 0.5 1 1 0.5 0 0.5 1 1 0.5 0 0.5 1 x x y y r figur 17. plot modulu g2r + g2i gener function (64) { = 1/2, = 1, = 1/4}, show zero x 0.4998, y = 0 converg radiu r. a.2 reduct theorem muir construct (59) heurist flavor: reli recogn series. direct deriv requir advanc mathemat tools, present here. method reli follow theorem determin recurr [21, p. 704]. suppos smooth gener function g(z), z complex, formal taylor seri a0 + a1 z + a2 z2 + . . . z = 0. reciproc 1/g(z) formal expans 1 g(z) = 1 a0 + a1z + a2z2 + a3z3 + . . . = a0 a1z + a2z2 a3z3 + . . . , a0 = 0, (61) toeplitz determin form ai coeffici satisfi a1 = a10 | a1 | , a2 = a20 a1 a2a0 a1 , a3 = a30 a1 a2 a3 a0 a1 a2 0 a0 a1 , a4 = a40 a1 a2 a3 a4 a0 a1 a2 a3 0 a0 a1 a2 0 0 a0 a1 , . . . (62) a0 = 1/a0. determin appear truncat toeplitz n n matric deriv elimin process, exemplifi (56) n = 4, form a1 = | 1/2! | , a2 = 1/2! a22/4! 1 2 a2 1/2! , a3 = 1/2! a22/4! a44/6! 1 2 a2 1/2! a22/4! 0 1 2 a2 1/2! , . . . (63) nth truncated-toeplitz approxim fomod (n > 1) u = cn u, cn = an1/an . seri (61) radiu converg r, cn 1/r n . (61) (63) obtain inspect a22 g(z) = cosh(az) (1 + 1 2 2 ). (64) radiu converg 1/g(z) distanc z = 0 closest pole, same, zero smallest modulu g(z). pictur figur 17, function g(z) z = x + iy, singl zero x = r real line y = 0. obtain solv g(r) = 0 or, equivalently, cosh(a r) = 1 + 1 2 2, r = arccosh(1 + 1 2 2). figur 17 geometr interpretation. > 0 equival r = 4a22 ( arcsinh( 1 2 ) )2 , lead solution: u = ru = 4a22 ( arcsinh( 1 2 ) )2 (59). method bypass determin expans seri identification, restrict toeplitz-hessemberg matrices. 27 acknowledg work author partli support fellowship award spanish ministerio educacion y cultura visit cimn may-jun 2002, partli nation scienc foundat grant high-fidel simul heterogen civil mechan systems, cms-0219422. thank professor hugh call attent nodal exact solut [16,17]. refer 1. abramowitz m, stegun ia (eds) (1972) handbook mathemat function formulas, graphs, mathemat tables, 9th printing, dover, ny 2. ahm mo, corless rm (1997) method modifi equat maple. electron proc. 3rd int. imac conf. applic algebra, maui, hawaii. ps version access www.math.unm.edu/aca/1997/proceedings/odes/ahm paper.p 3. brezzi f, hugh tjr, marini ld, russo a, suli e (1999) priori error analysi residual-fre bubbl advection-diffus problems. siam j. numer. anal. 36:19331948 4. brezzi f, russo (2000) stabil techniqu finit element method. appli industri mathemat venice-2, 1998. ed. spigler r. kluwer academ pubs, dordrecht, nl, 4758 5. farhat c, harari i, franca l (2001) discontinu enrich method. comp. meth. appl. mech. engrg. 190:64556479 6. farhat c, harari i, hetmaniuk u (2003) discontinu enrich method multiscal analysis. comp. meth. appl. mech. engrg. 192:31953209 7. felippa ca (2004) templat tutorial. chapter 3 comput mechanics: theori practice. ed. mathisen km, kvamsdal t okstad km. cimne, barcelona, spain, 2968 8. finlayson bm (1972) method weight residu variat principles, academ press, ny 9. franca l, farhat c, lesoinn m, russo (1998) unusu stabil finit element method residual- free-bubbles. int. j. num. meth. fluids. 27:159168 10. franca l, farhat c, macedo ap, lesoinn m (1997) residual-fre bubbl helmholtz equation. int. j. num. meth. engrg. 40:40034009 11. griffith d, sanz-serna j (1986) scope method modifi equations. siam j. sci. statist. comput. 7:9941008 12. kolesnikov a, baker aj (1999) effici implement high order method advection-diffus equation. proc. 3rd asme/jsm joint fluid engrg conf. san francisco, ca 13. hairer e (1994) backward analysi numer integr symplect methods. annal numer. math. 1:107132 14. hairer e, lubich c, wanner g (2002) geometr numer integration: structur preserv algorithm ordinari differenti equations. springer, berlin 15. harari i, hugh tjr (1990) design analysi finit element method helmholtz equat exterior domains. appl. mech. rev. 43:s366373 16. harari i, hugh tjr (1991) finit element method helmholtz equat exterior domain: model problems, comp. meth. appl. mech. engrg. 87:5996 17. harari i, hugh tjr (1992) galerkin/least-squar finit element method reduc wave equat reflect boundari condit unbound domains, comp. meth. appl. mech. engrg. 98:411454 18. hirt cw (1968) heurist stabil theori finit differ equations. j. comp. physics. 2:339342 19. hugh tjr (1995) multiscal phenomena: green functions, dirichlet-to-neumann formulation, sub- grid scale models, bubbl origin stabil methods. comp. meth. appl. mech. engrg. 127:387 401 20. kloeden pe, palmer kj (eds) (1994) chaotic numerics. amer. math. soc., providence, ri 21. muir t (1960) theori determinants. dover, ny 22. lomax h, kutler p, fuller fb (1970) numer solut partial differenti equat govern convection. agardograph 146-70, nato advisori group aerospac research, brussel 28 23. onat e, garca j, idelsohn sr, (1997) comput stabil paramet finit element solut advective-diffus problems. int. j. numer. meth. fluids. 25:13851407 24. onat e, garca j, idelsohn sr (1998) comput stabil paramet finit element solut advective-diffus problems. new advanc adapt method mechanics. ed. ladevez p oden jt. elsevier, amsterdam, nl 25. onat e (1998) deriv stabil equat advective-diffus fluid transport fluid flow problems. comp. meth. appl. mech. engrg., 151:233267 26. onat manzan m (1999) gener procedur deriv stabil space-tim finit element method advective-diffus problems. int. j. num. meth. engrg. 31:203207 27. onat e, manzan m (2000) stabil techniqu finit element analysi convection-diffus fluid problems. comp. anal. heat transfer. ed. comini g sunden b. wit press, southampton, uk 28. onat e (2000) stabil finit element method incompress viscou flow finit increment calculu formulation. comp. meth. appl. mech. engrg. 182:355370 29. onat e, garca j (2001) finit element method fluid-structur interact surfac wave finit calculu formulation. comp. meth. appl. mech. engrg. 191:635660 30. onat e (2003) multiscal comput analysi mechan finit calculus: introduction. comp. meth. appl. mech. engrg. 192:30433059 31. onat e, taylor rl, zienkiewicz oc, rojek j (2003) residu correct method base finit calculus. engrg. comput. 20:629658 32. onat e, taylor rl, zienkiewicz oc, rojek j (2004) finit calculu formul analysi incompress- ibl solid linear triangl tetrahedra. int. j. num. meth. engrg. 59:14731500 33. onat e (2004) possibl finit calculu comput mechanics. int. j. num. meth. engrg. 60:255281 34. onat e, garca j, idelsohn sr (2004) ship hydrodynam (2004) encyclopedia comput mechan vol 2. ed. hugh tjr, borst r, stein e. wiley, chichester, 579610 35. onat e, miquel j, hauk g (2004) stabil finit element method one-dimension advect diffusion-absorpt equat finit calculus. comp. meth. appl. mech. engrg. submit 36. onat e, felippa ca (2005) variat formul finit calculu equat solid mechanics, cimn report prepar 37. park kc, flagg dl (1984) fourier analysi spuriou mode element lock finit element method. comp. meth. appl. mech. engrg. 42:3746 38. park kc, flagg dl (1984) oper procedur symbol analysi finit element method. comp. meth. appl. mech. engrg. 46:6581 39. richtmyer rl, morton, kw (1967) differ method initi valu problems. 2nd ed., intersci pub (wiley), ny 40. roach pj (1970) comput fluid mechanics. hermosa publishers, albuquerque, nm 41. stuart am, humphri ar (1996) dynam system numer analysis. cambridg univ. press, cambridg uk 42. tong p (1969) exact solut certain problem finit element method. j. aiaa. 7:179180 43. vujanov bd, jone se (1989) variat method nonconserv phenomena, academ press, ny 44. waltz je, fulton re, cyru nj (1968) accuraci converg finit element approximations. proc. second conf. matrix method structur mechanics. wpafb, ohio, sep. 1968. affdl tr 68-150, 9951028 45. warm rf, hyett bj (1974) modifi equat approach stabil accuraci analysi finit differ methods. j. comp. physics. 14:159179 46. wilf hs (1991) generatingfunctionology. academ press, ny 47. wilkinson jh (1961) error analysi direct method matrix invers j. acm. 8:281330 48. wilkinson jh (1963) round error algebra processes. prentice-hall, englewood cliffs, nj 49. wilkinson jh (1965) algebra eigenvalu problem. oxford univ. press, oxford, uk 50. zienkiewicz oc, taylor (1988) finit element method vol. i. 4th ed. mcgraw-hill, london, uk 29