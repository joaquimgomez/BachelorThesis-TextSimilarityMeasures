multiscal comput order homogen shell analysi out-of-plan load masonri wall multiscal comput order homogen shell analysi out-of-plan load masonri wall massimo petraccaa,b,c,, luca pela,b, riccardo rossia,b, sergio ollera,b, guido camatac, enrico spaconec adepart civil environment engineering, technic univers catalonia (upc), barcelona 08034, spain bcimn - centr internacion metod numer en enginyeria, technic univers catalonia (upc), barcelona 08034, spain cdepart engineering, univers "g.dannunzio" chieti pescara, pescara 65127, itali abstract work present multiscal method base comput homogen analysi gener heterogen shell structures, special focu period brick-masonri walls. propos method design analysi shell micro-structur heterogen in-plan directions, initi homogen shell-thick direction, structur topolog single-leaf brick masonri walls. assumption, work propos effici homogen scheme macro-scal micro-scal describ shell theory. propos method appli analysi out-of-plan load brick-masonri walls, compar experiment micro-model results. keywords: comput multiscal homogenization, repres volum element (rve), shell, masonry, period micro-structure, strain local 1. introduct masonri ancient build materi extens history, nowadays. main build techniqu adopt histor constructions, deep understand masonri mechan behavior there- fore primari import preserv cultur heritage. however, formul phenomenolog constitut equat heterogen materi masonri challeng [1, 2, 3]. evolut structur respons strongli depend complex micro-structur phenomena damaged-induc anisotropi local deform micro-structure. difficult ac- count influenc evolv micro-structur overal macroscop correspond author email addresses: (massimo petracca), (luca pel), (riccardo rossi), (sergio oller), (guido camata), (enrico spacone) preprint submit elsevi septemb 27, 2016 behavior, especi strain local occur micro-structure, lead complex dissip mechan structur scale. advanc numer method attract tool understand predict behavior masonri complet failure, allow estim residu strength safeti structures. popular method commonli nowadai studi masonry, account het- erogen micro-structure, micro-/meso-modeling, known direct numer simul (dns), [4, 5, 6, 7, 8, 9, 10, 11]. approach, complet micro-structur (or simplifi version it) directli modeled, complex interact masonri constitu natur taken account. however, approach lead complex model high comput costs. dn suitabl model small structur members, usag soon unafford larg scale structures. contrary, macro-model regard masonri equival homogen continuum, make distinct unit joint discret model [1, 2, 12]. method possess intrins difficulti relat identif mechan properti definit reliabl predict phe- nomenolog failur criteria. nevertheless, macro-model prefer option analysi large-scal structures, thank afford comput cost. exampl masonri macro-model shell propos [13]. in-between macro- micro-model techniques, comput homogen meth- od (chm) recent emerg promis tool join advantag [14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]. prob- lem split scales: structur scale treat equival homogen medium, complex behavior heterogen micro-structur taken account solv micro-scal problem repres sampl micro-structur (rve). classic chm extens adopt analyz micro-structur exhibit- ing stabl behavior. soon recogn non-object result strain-soften materials, homogen respons converg uniqu meaning solut mesh refin and/or increas size rve. fact rve, assum repres micro-structure, loos repres local deformation. note issu directli relat chm itself, stem us order continuum. years, enhanc classic order chm proposed, review recent develop [39] refer therein. method regular respons rve adopt higher order continua macro-scale, materi characterist length natur account [19, 21, 22, 16, 17, 36, 14]. others, known continuous-discontinu methods, up-scal micro-structur respons discontinu structur scale [23, 24, 25, 26, 27, 29, 40, 15]. [41] extens fracture-energy-bas regular- izat homogen problem proposed, appli simul in-plan load masonri shear walls, allow us standard continuum theory, ensur proper dissip structur level. comput homogen shell-lik structur emerg branch com- putat homogen methods. need kind homogen stem fact size micro-structur order magnitud structur thickness, standard 3d continuum homogen applied, respect thick direction. year work structur shell gener structur applications, elast inelast 2 materi behavior, geometr non-linear [42, 43, 44, 45, 46]. approaches, 3d solid rve discret micro-structur thick di- rection, coupl macro-scal shell model. applic concept specif case masonri structur [25, 26]. works, materi non-linear considered, homogen base kirchhoff-lov (thin) shell theory, nonlinear transvers shear behavior obtain mean separ model (i.e. directli rve calculations). present work propos new homogen procedur shell-lik structures, base reissner-mindlin (thick) shell theory. approach tailor ho- mogen micro-structur heterogen in-plan directions, (initially) homogen thick direct (i.e. extrus heterogen surfac thick direction). assumption, macro-scal domain rve domain accur describ accord shell theories. reissner- mindlin shell theori base hypothesi initi straight normal mid-plan shell remain straight deformation, necessarili perpendicular mid-plane. micro-structur homogen thick direction, reason assum previous mention hypothesi holds. assumpt reduc rang applic method, respect method 3d rve, greatli simplifi macro-micro scale transit (both scale share theory), reduc comput cost rve calculations. propos methodolog appli analysi unreinforc masonri wall (urm) subject out-of-plan loading. deep understand out-of-plan behavior kei aspect seismic respons urm buildings. experiment studi conduct [47] urm walls, numer reproduc assess capabl propos method. highlight [47] ref- erenc therein, assum wall, subject out-of-plan loading, collaps bend strength exceed extrem conserv assess seismic response, collaps gener happen out-of-plan displac bend approach thick wall. accur constitut model requir numer reproduc out-of-plan behavior masonry. propos methodol- ogi proven accur reproduc kei aspect out-of-plan behavior urm emerg experiment tests. 3 2. comput homogen framework equival homogen shell heterogen shell shell-lik rve heterogen solid (homogen thickness) figur 1: work-flow comput homogen shell section give main concept basic equat propos comput homogen framework, classic order homogen extend case shell theory. follow deriv assum small strain theory. main work-flow propos chm shell repres figur 1. propos method formal ident classic chm 2d 3d continua [41]. main differ continuum strain stress tensor replac gener strain gener stress typic shell kinematics, describ section 2.1. homogen process seen 3-step procedure: 1. down-scal macro-micro transition. macroscop gener strain, point macroscop domain, sent micro-scale, defin rve boundari conditions; 2. solut micro-scal boundari valu problem (bvp). micro-structur problem solv rve domain. numer method used. fem consid work; 3. up-scal micro-macro transition. macro-scal gener stress obtain homogen procedures. 4 2.1. shell kinemat on, gener quantiti relat shell theori identifi superimpos hat () gener unknown vector local coordin shell defin as: u = [ u0 uz ]t = [ ux uy uz x y ]t (1) u0 = [ ux uy ]t in-plan displacements, uz out-of-plan displace- ment, = [ x y ]t out-of-plan rotat local x y ax respectively. accord order shear deform theori reissner-mindlin, gener strain shell defin as: = [ 0 0 ]t = [ 0,xx 0,yi 20,xy xx yy 2xy 20,xz 20,yz ]t (2) in-plan strain tensor membran action defin as: 0 = su0 (3) curvatur tensor bend action defin as: = s (p) (4) transvers shear strain defin as: 0 = uz + p (5) previou relat transform matrix p introduc account sign convent rotations: p = [ 0 1 1 0 ] (6) p = [ y x ] (7) gener strain shell rewritten as: = 0,xx 0,yi 20,xy xx yy 2xy 20,xz 20,yz = ux x uy y ux y + uy x y x x y y y x x uz x + y uz y x (8) 5 2.2. shell constitut response: through-the-thick integr cross section shell gener strain hand, possibl calcul constitut respons shell obtain gener stresses: = [ n m q ]t = [ nxx nyi nxy mxx myi mxy qxz qyz ]t (9) n = [ nxx nyi nxy ]t membran forc vector unit length, m =[ mxx myi mxy ]t bending/twist moment vector unit length, q =[ qxz qyz ]t transvers shear forc vector unit length. simpl gener wai obtain shell constitut respons mean through-the- thick integr standard continuum constitut models. defin through-the-thick coordinate, rang h/2 h/2 (h thick shell), strain coordin defin as: () = 0 + + 0 (10) matrix form: () = h() (11) xx yy 2xy 2xz 2yz = 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0,xx 0,yi 20,xy xx yy 2xy 20,xz 20,yz (12) stress tensor constitut tangent oper coordin thick direct calcul constitut model: () = f ( () ) , c() = () () (13) gener stress tangent constitut matrix shell final integr thickness: = h 2 h 2 h()() d (14) nxx nyi nxy mxx myi mxy qxz qyz = h 2 h 2 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 k 0 0 0 0 0 k xx yy xy xz yz d (15) 6 c = = h 2 h 2 h()c()h() d (16) k transvers shear correct factor [48]. note eq. (13) continuum stress tensor () certain coordin thick direction, obtain function continuum strain tensor () coordinate. however, strain tensor (), defin eq. (12), lack thick strain compon zz, standard shell kinemat provid it. simpl wai cope issu obtain ps () , plane-stress (), gener (non-linear) plane stress constitut law fp (), consid ts () , transvers shear (), elastic: ps() = f ps ( ps() ) (17) ts() = g ts () (18) zz() = 0 (19) simpl approach applic transvers shear deform negligible, expect linear relat ts () ts () . gener case necessari true. masonry, consid wall layer bricks, in-plan dimens mortar joint (of order 10mm) smaller out-of-plan (wall thickness) dimens (of order 100mm). consid applic mortar joint far softer unit (brick stones), evid shear deform concentr mortar joints, neglig respect in-plan deformation. nonlinear respons transvers shear necessary. present work, base idea given [49], goal achiev store integr point shell domain, extra internal-lik variabl zz (repres strain compon thick direction, provid shell kinematics). evolut obtain impos follow constraint nest iter procedure: zz h 2 h 2 zz()d = 0 (20) way, out-of-plan normal stress forc zero depth thickness, integr (the stress result nzz) constraint zero, requir shell theory. procedur allow us 3d constitut model thick shell. gener stress gener constitut tensor obtain eq. (14) eq. (16), respectively. eq. (14) eq. (16) integr thick direction, suitabl integr scheme provided. note approxim real 3d behavior. out-of-plan strain component, zz, assum constant thick direction, calcul local gauss- point shell element. iter procedur eq. (20) avoid case 7 shell formul kinemat provid thick stretch, 3d-shell example. 2.3. down-scal macro-micro transit constraint condit macroscop gener strain m , point xm macro-scal domain instant t, obtain surfac averag microscop gener strain field defin point x micro-scal domain instant t: m(xm, t) = 1 (x, t) da (21) surfac area shell domain micro-scale. account heterogen micro-structure, microscop displac field u addit split coars scale contribut um (aris macroscop gener strain field), fine scale contribut u (obtain solut micro-scal problem). accordingly, microscop gener strain field split way: (x, t) = m(xm, t) + (x, t) (22) insert eq. (22) eq. (21) take account m constant rve, minim kinemat constraint requir microscop gener displac fluctuat field kinemat admiss is: (x, t) da = 0 (23) order write constraint function microscop gener displac fluctuat field, us split eq. (23) membran 0,, bend , shear 0, components. membran bend components, gauss theorem, surfac integr rewritten boundari integr rve boundari a: 0, da = su0, da = u0, s n ds = 0 (24) da = s ( p ) da = ( p ) s n ds = 0 (25) eq. (24) eq. (25) provid minim kinemat constraint appli micro in-plan displac fluctuat u0, micro out-of-plan rotat fluctuat . shear component, follow minim constraint satisfied: 0, da = uz, + p da = 0 (26) constraint impos directli surfac integral, or, period condi- tion out-of-plan displac fluctuat uz used, follow constraint appli surfac integr rve domain: 8 da = 0 (27) previous defin minim condit impos differ kind bound- ari conditions. present work, take advantag period natur consid micro-structure, follow set constraint adopted: u0,(x + , t) = u0,(x , t) pair {x + , x } (28) (x + , t) = (x , t) pair {x + , x } (29) uz, ( x+ , t ) = uz, ( x , t ) pair { x+ , x } (30) (x, t) da = 0 (31) eq. (28), eq. (29) eq. (30) impos period microscop fluctuat fields. assumpt show good perform previou work author in-plan multiscal analysi masonri [41]. eq. (31) extra constraint aris definit transvers shear strain. 2.4. solut micro-scal bvp neglect inertia forces, absenc bodi forc boundari traction, principl virtual work 3d continuum case micro-scal (rve) reads: : dv = 0 (32) consid shell work gener strain stress obtain through-the-thick integration, eq. (32) rewritten term gener quantities: { h 2 h 2 () : () d } da = 0 (33) { h 2 h 2 () : ( 0, + + 0, ) d } da = 0 (34) { h 2 h 2 [ ,xx (0,,xx + ,xx) + ,yi (0,,yi + ,yy) + ,xy (20,,xy + 2,xy) + ,xz (20,,xz) + ,yz (20,,yz) ] d } da = 0 (35) 9 [ n : 0, +m : +q : 0, ] da = 0 (36) : da = 0 (37) 2.5. up-scal micro-macro transit rve equilibrium, homogen gener stress computed. discuss [20, 31], definit homogen stress directli obtain hill-mandel principl [50, 51] addit split microscop strain. hill-mandel principl written term gener stress strain as: m : m = 1 : da (38) insert split microscop gener strain given eq. (22), hill- mandel principl eq. (38), follow relat obtained: m : m = 1 : m da+ 1 : da (39) m : m = 1 : m da+ 1 : l u da (40) l u = s u0, sp uz, + p (41) eq. (40) valid kinemat admiss u. specifically, case u = 0, follow relat obtained: m : m = 1 : m da m (42) valid macroscop gener strain rate field, lead definit homogen macroscop gener stress surfac averag microscop gener stress field: m = 1 da (43) comput point view, conveni obtain homogen gener stress reaction obtain rve boundari equilibrium [44]: 10 n = 1 n i=1 fr,i s x,i (44) m = 1 p n i=1 mr,i s x,i 1 n i=1 frz,ix,i x,i (45) q = 1 n i=1 frz,ix,i (46) = 1, 2, ..., n boundari node index, x,i = [ x,i y,i ]t posit vector boundari node i, fr,i = [ frx,i fry,i ]t in-plan reaction forc vector, mr,i = [ mrx,i mry,i ]t out-of-plan reaction moment vector, frz,i out-of-plan reaction force. transform matrix p eq. (45), introduc eq. (6). explicit express homogen macro gener stress compon is: m = nxx nyi nxy mxx myi mxy qxz qyz = 1 n i=1 frx,ix,i fry,iy,i 1 2 (frx,iy,i + fry,ix,i) mry,ix,i 12frz,ix 2 ,i mrx,iy,i 12frz,ii 2 ,i 1 2 (mry,iy,i mrx,ix,i) 12frz,ix,iy,i frz,ix,i frz,iy,i (47) 2.6. typic deform mode obtain shell homogen framework section show natur deform mode obtain propos ho- mogen framework shell term coars scale displacements/rotations, fine scale displacement/rot fluctuations, total displacements/rotations. propos method, unknown micro-scal fluctuations, total dis- placements/rot comput displai post-process visual purposes. total microscop displacement/rot vector defin sum coars scale contribut fine scale contribut (fluctuations): u = um + u (48) [ u0, uz, ]t = [ u0,m uz,m m ]t + [ u0, uz, ]t (49) microscop displacement/rot fluctuat u obtain solut microscop boundari valu problem, displacement/rot vector 11 coars scale contribut um calcul post-process macroscop gener strain m: u0,m = 0,mx (50) m = p tmx (51) uz,m = 1 2 (mx) x + m x (52) eq. (51), transform matrix p defin eq. (6) ac- count sign convent rotations. eq. (52), term repres deflect bend deformation, second term repres deflect shear deformation. figur 2 figur 9 deform mode associ- at deform compon macroscop gener strain vector. them, (a) show displacement/rot field um aris associ averag macroscop deform mode repres coarse-scal contribution, (b) show microscop displacement/rot fluctuat field u(unknown micro- scopic bvp) repres fine-scal contribut account heterogen (brick mortar), (c) repres total microscop displacement/rot ua superposit coars fine scale contributions. figur 2, figur 3 figur 4 membran deform modes. figur 5, figur 6 figur 7 bend deform modes. figur 8 figur 9 transvers shear deform modes. (a) (b) (c) figur 2: deform mode xx. (a) coars scale, (b) fine scale, (c) total 12 (a) (b) (c) figur 3: deform mode yy . (a) coars scale, (b) fine scale, (c) total (a) (b) (c) figur 4: deform mode xy . (a) coars scale, (b) fine scale, (c) total (a) (b) (c) figur 5: deform mode xx. (a) coars scale, (b) fine scale, (c) total 13 (a) (b) (c) figur 6: deform mode yy . (a) coars scale, (b) fine scale, (c) total (a) (b) (c) figur 7: deform mode xy . (a) coars scale, (b) fine scale, (c) total (a) (b) (c) figur 8: deform mode xz . (a) coars scale, (b) fine scale, (c) total 14 (a) (b) (c) figur 9: deform mode yz . (a) coars scale, (b) fine scale, (c) total 3. fracture-energi regular 2-scale fe comput homogeniza- tion gener geometr characterist length, account size (i) macro-scal fe, (ii) micro-scal fe (iii) rve, propos previou work author [41]. fracture-energi regular 2-scale fe analysi ensur energi dissip macro-scal object respect discret size micro macro scales, respect size rve. summari given here, reader refer [41] details. micro-scal local constitut model regular modifi characterist length lch,, depend characterist length involv homogen problem (see figur 10): lch, = f(lch,, lch,m, lch,rv e) (53) lch,, lch,m lch,rv e respect micro-scal fe characterist length, macro-scal fe characterist length, rve characterist length. wrv e,d energi dissip damag domain (vrv e,d ) rve: wrv e,d = gf lch, vrv e,d = gf lch, lch, t hrv e (54) whit hrv e length rve direct crack, t thick rve. smear energi entir rve domain (vrv e), equival specif fractur energi gf obtained: gf = wrv e,d vrv e = wrv e,d lch,rv e hrv e t = gf lch, lch, lch,rv e (55) gf integr dissip macro-scal domain total energi wm dissip macro-scale. equat wm actual dissip energi w 15 wm = w gf lch,m hm tm = gf hm tm (56) give definit modifi micro-scal fe characterist length: lch, = lch, lch,m lch,rv e (57) figur 10: fractur energi base regular 2-scale fem [41] notic regular procedur extens classic crack band theory, adapt 2-scale homogen problem. such, regular global problem, consid local valu local zone. 4. numer model out-of-plan load masonri wall propos method appli simul out-of-plan behavior brick- masonri walls. experiment test unreinforc masonri wall (urm) present [47] consid numer assess method. section 4.1 briefli describ experiment test. nonlinear behavior brick mortar joint model constitut model base continuum-damag mechanics, describ section 4.2, adopt rve materi paramet describ section 4.3. preliminari direct numer simul (dns) perform order assess capabl constitut model emul specif local respons masonri wall out-of-plan loadings, result discuss section 4.4. multiscal simul discuss section 4.5, result compar experiment test dns. 16 analys carri krato multiphys [52, 53], free open-sourc framework develop multidisciplinari solvers, develop cimne. pre post-process carri gid [54], develop cimne. 4.1. experiment test experiment test unreinforc masonri wall (urm) present [47]. full-scal clai brick urmwal subject quasi-stat displacement-control load investig load-deflect behavior point maximum strength. wall analyz experiment campaign, con- sider here. wall measur 4m 2.5m, brick 230mm 76mm 110mm, mortar joint 10mm. stage vertic pre-compress 0.1n/mm2 applied, wall subject uniform pressur displac control. order provid realist moment connect vertic edges, 450mm long return wall built test wall. figur 11 show wall geometri obtain failur pattern main face wall, later turn walls. figur 11: test wall geometri obtain failur pattern [47] 4.2. tension/compress continuum damag model 4.2.1. constitut model bi-dissip d+/d damag model, base work [55, 56, 57], defin stress tensor = ( 1 d+ ) + + ( 1 d ) (58) +and respect posit neg part effect (elastic) stress tensor : 17 = c : , + = 3 i=1 ipi pi, = + (59) d+ d are, respectively, tensil compress damag indexes, act respec- tive + . damag index scalar variabl rang 0 (intact material) 1 (complet damag material). 4.2.2. failur criteria order identifi loading, unload reload condit gener state stress, scalar measur introduced, term equival stress + . compress tensil failur criteria base describ [58], comput as: = h (min) [ 1 1 ( i1 + 3j2 + k1 max+ max )] (60) + = h (max) [ 1 1 ( i1 + 3j2 + max ) ft fcp ] (61) = kb 1 2kb 1 (62) = fcp ft (1 ) (1 + ) (63) i1 invari effect stress tensor, j2 second invari effect deviator stress tensor, max maximum effect princip stress, fcp compress peak stress, kb ratio bi-axi uniaxi compress strengths, term ft fcp relat + tensil strength ft. constant k1 eq. (60) control shear behavior model act shape compress surface. k1 rang 0 (drucker-prag criterion) 1 (criterion propos [58]). final term eq. (60), > 0, account increas strength stress state triaxial compression. damag surfac 2d plane-stress case shown figur 12, surfac 3d case shown figur 13. 18 15 10 5 0 5 15 10 5 0 5 1 2 + (1 = 0.00) (1 = 0.25) (1 = 0.50) (1 = 1.00) inact tensil surfac inact compress surfac x = fc0 x = ft x = bfc0 x = fcp figur 12: initi damag surfac (2d plane-stress) (a) tensil surfac (b) compress surfac figur 13: initi damag surfac (3d). inact surfac transpar 19 note compress tensil surfac defin stress state, necessari inactiv certain conditions: 1. compress surfac evolv princip stress neg 2. tensil surfac evolv princip stress posit condit achiev heavisid function h (x) introduc eq. (60) eq. (61). inact portion surfaces, i.e. portion cut heavisid function, drawn dashed-lin figur 12, transpar figur 13. repres irrevers natur damag process, scalar quantities, term damag threshold r, introduced. repres largest valu attain equival stress load history. r time t+ t explicitli evalu r = max ( r0 , max 0nt n ) , r+0 = ft, r 0 = fc0 (64) r+0 r 0 are, respectively, initi tensil compress damag threshold (i.e. elast limit uniaxi tension ft compress fc0), n denot time instant. accordingly, follow damag criteria defined: ( , r ) = r 0 (65) 4.2.3. evolut law damag variabl tensil damag d+ obtain follow exponenti soften law: d+ ( r+ ) = 1 r+0 r+ exp { 2hdi ( r+0 r + r+0 )} (66) hdi discret soften parameter. discret problem, local constitut models, soften law adjust depend width dissip zone (ldis) [59, 60, 61], follow equal holds: gf ldi = gf (67) specif dissip energi gf gf = ( 1 + 1 hdi ) f2t 2e (68) hdi calcul hdi = ldi lmat ldi (69) lmat = 2egf/f2t . ldi taken equal fe characterist length (ldi = lch). 20 (a) (b) figur 14: (a) tensil (b) compress uniaxi law obtain tensil uniaxi law shown figur 14a. evolut compres- sive damag di driven hardening/soften law (see figur 14b) quadrat bezier curves, describ previou work author [41]. tensil case, discret problem compress curv shown figur 14b need regular shade area underneath gc/ldis. 4.3. rve materi paramet geometri adopt rve shown figur 15. boundari condit rve list eq. (28) eq. (31) 230 mm 172 mm 240 mm 76 mm 10 mm figur 15: rve geometry. 21 constitut model brick mortar joint base continuum damag mechanics, briefli describ section 4.2. materi properti brick mortar summar tabl 1. e t gt 0 p r gc p kb k1 52700.0 0.15 2.0 0.08 9.0 18.0 2.5 40.0 0.003 1.2 0.0 3.0 n mm2 - n mm2 n mm n mm2 n mm2 n mm2 n mm - - - - (a) e t gt 0 p r gc p kb k1 1000.0 0.15 0.15 0.003 1.0 2.5 0.5 30.0 0.02 1.2 0.16 1.0 n mm2 - n mm2 n mm n mm2 n mm2 n mm2 n mm - - - - (b) tabl 1: materi properti (a) brick (b) mortar joint 4.4. micro-model direct numer simul dn entir micro-structur discret comput model shell elements, take advantag fact micro-structur heterogen in-plan direct (initially) homogen thick direct (1-layer bricks). geometri micro-model shown figur 16. symmetri geometri boundari conditions, left-half wall modeled. figur 17 show pressure-deflect curv obtain dn compar experiment results. deflect measur center wall, maximum valu attained. overal micro-model simul show good agreement experiment. figur 18 show deform shape end analysis, good agreement predict failur mode shown figur 11. import featur shown experiment campaign, report [47], appar plastic behavior test walls: reach wall strength deflect 2.0 5.0 mm, loss bear capac shown, soon follow constant strength plateau deflect 25.0 mm. discuss author experiment campaign, appar plastic behavior attribut redistribut bend moment diagon crack horizont bend vertic edges, bend restraint provid return wall addit capac accept transfer load diagon bend mechanism. tabl 2 show evolut tensil compress damag stage analysis, wall strength attained, damag pattern end simulation. 22 symmetri axi 600 mm 2035 mm 2484 m m figur 16: micro-model geometri 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 0 5 10 15 20 25 30 35 pr es su (k pa ) deflect (mm) experiment micro-model measur deflect figur 17: pressure-deflect curv obtain micro-model analysi 23 (a) (b) figur 18: final deform shape, (a) (b) view micro-model analysi 24 deflect [mm] d+ d 0.7 2.9 4.0 35.0 tabl 2: tensil compress damag evolut differ load stage micro-model analysi 25 note, import adopt 3d constitut model instead plane- stress one, point section 2.2, clearli shown figur 19, bottom-left corner structur given. in-plan strain local x- direct shell xx(+h/2) = 0,xx+xx h 2 = 0.11+0.0026110/2 = 0.253 larger compar transvers shear strain 0,xz = 0.157. evid transvers shear deform neglected. failur mode depict figur 19 consid overal bend state deform local x-direction, think overal behavior composit masonri material. however, arrang micro-structure, strong differ mechan properti unit mortar, signific transvers shear appear (softer) mortar joints, order allow unit bend vertic axi wall. (a) 0,xx (b) xx (c) xz figur 19: comparison membrane, bend shear strain micro-model analysi 4.5. multiscal simul section propos comput homogen framework shell as- sessed, compar result obtain dn present section 4.4. multiscal simul macro-scal discret used, order check regular properti method respect mesh size. note regular procedur present [41] briefli report sec- tion 3 meant provid object result term dissip energi respect mesh size (i.e. allevi mesh-siz dependency). problem relat mesh bia depend [62, 63, 64, 12, 65] (i.e. depend mesh orien- tation), adopt procedur accompani enhanc fe formul macro-scale. present work, shell fe enhanc membran strain field follow ea method [66], transvers shear field follow mitc plate formul [67, 68]. adopt element suffi- cientli accur respect mesh orient dependency. adopt mesh given figur 20, discret size 300 mm, 150 mm 75 mm respectively. 26 (a) h = 300mm (b) h = 150mm (c) h = 75mm figur 20: macro-scal mesh multiscal simul figur 21 show pressure-deflect curv obtain multiscal analy- ses, compar dn experiment results. 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 0 5 10 15 20 25 30 35 pr es su (k pa ) deflect (mm) experiment micro-model multiscal model - h=300 multiscal model - h=150 multiscal model - h=75 measur deflect figur 21: pressure-deflect curv obtain multiscal analys satisfactori agreement seen homogen respons micro- model response. regular respons satisfactory, converg meaning solut mesh refinement. slight differ homoge- nize respons dn respons seen pressur valu rang 3 kpa 27 peak load, homogen model show softer response, lead slight overestim displac peak strength, peak forc correctli predicted. believ respons given connect (corner) main wall turn wall: micro-model, brick later wall physic connected. contrary, homoge- nize model doesnt happen, rve weakli connect (i.e. mean macroscop homogen strain), offer slightli softer response. however, initi small differ didnt affect overal respons wall subsequ stage analysis. next, detail comparison dn result multiscal result given. figur 22 show comparison tensil compress damag pattern obtain mesh multiscal analyses, obtain dns. failur mode good agreement predict dns, term crack-direct term initi spread non-linear (i.e. local defin rotat hinge). note damag index displai homogen result defin volum averag damag index rve, reach unity, element rve complet damaged. definit damag physic meaning, post-process purposes. real damag valu retriev rve. vertic hing form turn wall near intersect wall, develop narrow damag zone, diagon hing wall involv significantli larger damag zone. behavior mainli redistribut compress stresses, initi uniform entir wall, progress increas center wall, shown figur 23. fact, shown figur 24, moment curvatur respons monitor diagon hing (compar respons monitor vertic hinge) show ductil behavior consider initi hardening, shell cross section subject signific compress stresses. figur 25 show comparison term rotat out-of-plan deflection. remark agreement seen rotations, qualit quantitatively, properli captur posit orient vertic (along corner) diagon (on face) rotat hinges, predict micro-model analysis. figur 26 show comparison term shell moments. case satisfactori agreement overal bend moment distribution, while, obviously, quantit point view peak valu show micro-model smoothed-out multiscal model, averag valu obtain homogen respons rve. finally, figur 27 show comparison term tensil damag obtain micro-model, homogen model, actual damag distribut relev rves. notic relev failur mode highlight micro-model correctli captur homogen one. rve 1 show bend failur mechan head joint direction. rve 2, bottom-left corner wall, show transit uniaxi bend head joint direct diagon bending. rve 3 rve 4 damag pattern obtain diagon bending, rve 4 local band defin diagon rotat hinge. rve 5, center wall, show bend failur mechan bed joint direction. 28 figur 22: comparison tensil compress damage. multiscal (first rows) vs. dn (last row) 29 figur 23: comparison minimum princip shell forc [n/mm], initi pre-compress (row 1) end analysi (row 2). dn (column 1) vs. multiscal (column 2). -0.5 0 0.5 1 1.5 2 2.5 -0.2 0 0.2 0.4 0.6 0.8 1 1.2 1.4 x 103 x 10-4 s h el l m o m en t (n m m /m m ) curvatur (rad/mm) mxx-kxx mxy-kyi mxy-kxi (a) -1.2 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 -8 -6 -4 -2 0 2 4 6 x 103 x 10-5 s h el l m o m en t (n m m /m m ) curvatur (rad/mm) mxx-kxx mxy-kyi mxy-kxi (b) figur 24: homogen moment-curvatur response: (a) center vertic hing turn wall; (b) center diagon hing wall 30 figur 25: comparison rotat [rad] (row 1,2,3) deflect [mm] (row 4). dn (column 1) vs. multiscal (column 2). 31 figur 26: comparison shell moment [nmm/mm]. dn (column 1) vs. multiscal (column 2). 32 figur 27: distribut tensil damag signific rve 4.6. comput cost micro-scal multi-scal simul comput perform main topic work, brief com- parison micro- multi-scal analys given term comput costs. micro- multi-scal analyses, solut strategi consist stage (from time t = 0 t = 0.02), applic vertic load, conduct load control, second stage (from time t = 0.02 t = 1.0), horizont pressure, conduct displac control. averag time step t = 0.005 used. equilibrium attain averag iter time step. stages, newton-raphson iter procedur used, updat tan- gent matrix iteration. analys carri singl machin 33 intel core i7-2670qm-2.20ghz cpu 8.00 gb ram. code parallel openmp. micro-model analysis, averag elaps time iter 00:00:43 [hh:mm:ss], total elaps time 07:12:27 [hh:mm:ss]. multiscal analysi coarsest discret (h = 300 mm), averag elaps time iter 00:00:29 [hh:mm:ss], total elaps time 04:54:30 [hh:mm:ss]. overall, slight speed-up micro- multi-scal model obtained. limit speed-up probabl size masonri micro-structure, compar fe size macro-scale. expect benefit smaller micro- structur larger structur models. however, comput cost non-linear multiscal analysi expens method larg scale simulations. note present implementation, integr point macro-scal rve (due non-linear problem), multiscal simul carri begin integr point. substanti speed-up achiev adapt trigger rve simul needed, line recent propos [69]. 5. comparison dns-3d dns-shell multiscal models. section 4 present experimental-numer comparison, assess abil propos framework repres behavior masonri wall load out-of-plan direction. section give conclud example, 3d-base dns, shell-bas dn shell-bas multiscal model compared. exampl us assess assumpt shell model shell-homogen framework, capabl propos method simul respons 3d model. exampl consist simpli support slab, vertic load center. symmetry, half model analyzed. geometri shown figur 28. model analyz dns, 3d-base shell-based, respect (to assess abil shell simul 3d behavior), shell-bas multiscal simulations, discret size 250 mm 125 mm respect (to assess regular respect macro-scal fe size). figur 29 show comparison load-deflect curv analyses, figur 30 show damag pattern analyses. satisfactori agreement shell-bas dn multiscal simulations, 3d simulation. 34 figur 28: geometri masonri slab. half model symmetri 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 0 1 2 3 4 5 6 7 v er ti ca l ac ti o n ( k n ) deflect (mm) micro-model(3d) micro-model(shell) multiscale-model(shell)(coarse) multiscale-model(shell)(fine) figur 29: load-deflect curv dn multiscal model 35 (a) (b) (c) (d) figur 30: tensil damag pattern (a) 3d dns, (b) shell dns, (c) shell multiscal (coars h = 250mm), (d) shell multiscal (fine h = 125mm). 6. conclus classic comput homogen establish tool analysi complex heterogen structures. however, deal shell-lik structures, characterist size micro-structur approach thick structur member, happen one-leaf brick masonri walls, subject present study. cases, classic homogen dimension continuum applicable. 36 paper propos comput homogen method base shell theory, abl provid equival homogen respons term gener strain gener stresses, directli nest solut rve. method de- sign deal micro-structur consid extrus het- erogen surfac (a case one-leaf masonri walls), heterogen in-plan directions, (initially) homogen thick direction. hypothesis, macro-scal micro-scal rve describ shell theories, greatli simplifi problem coupl micro macro scales. propos method appli analysi unreinforc masonri wall un- dergo out-of-plan loading. experiment studi numer reproduc assess capabl method. propos methodolog proven accur reproduc kei aspect out-of-plan experiment behav- ior urm walls, properli describ failur mechan point maximum bend strength wall. acknowledg research receiv financi support graduat school uni- versiti g. dannunzio chieti-pescara, mineco (ministerio economia y competitividad spanish government) multima project (multi- scale techniqu experiment numer analysi reliabl masonri structures, ref. num. bia2015-63882-p) eaci project (enhanc accuraci comput experiment framework strain local failur mecha- nisms, ref. mat2013-48624-c2-1-p). partial financi support relui (network earthquak engin experiment laboratories, fund prime minist offic - civil protect department) project acknowledg greatli appreciated. publication, however, necessarili reflect viewpoint civil pro- tection department. s. oller acknowledg support european research council advanc grant: erc-2012-adg 320815 comp-des-mat "advanc tool comput design engin materials" 37 refer [1] l. pel, m. cervera, p. roca, continuum damag model orthotrop materials: applic masonry, method appli mechan engin 200 (9-12) (2011) 917930, issn 0045-7825, url [2] l. pel, m. cervera, p. roca, orthotrop damag model analysi masonri struc- tures, construct build materi 41 (2013) 957967, issn 0950-0618, url //www.sciencedirect.com/science/article/pii/s0950061812004837. [3] p. roca, m. cervera, g. gariup, l. pel, structur analysi masonri histor constructions. classic advanc approaches, archiv comput method engin 17 (3) (2010) 299325, issn 1134-3060. [4] p. b. loureno, j. g. rots, multisurfac interfac model analysi masonri structures, journal engin mechan 123 (7) (1997) 660668. [5] p. b. lourenco, comput strategi masonri structures, ph.d. thesis, tu delft, delft univers technology, 1996. [6] d. v. oliveira, p. b. loureno, implement valid constitut model cyclic behaviour interfac elements, comput & structur 82 (17) (2004) 14511461. [7] a. drougkas, l. pel, p. roca, numer model masonri shear wall failur mechanisms, in: proceed 9th intern masonri conference, guimares, portugal, 2014. [8] c. citto, two-dimension interfac model appli masonri structures, proquest, 2008. [9] l. gambarotta, s. lagomarsino, damag model seismic respons brick masonri shear walls. i: mortar joint model applications, earthquak engin & structur dynam 26 (4) (1997) 423439, issn 1096-9845. [10] m. l. raffa, f. lebon, e. sacco, h. welemane, multi-level interfac model damag masonry, in: e. b.h.v. topping, p. iv/anyi (ed.), "proceed fourteenth intern confer civil, structur environment engin computing", civil-comp press, stirlingshire, uk, 2013. [11] e. sacco, j. toti, interfac element analysi masonri structures, intern journal comput method engin scienc mechan 11 (6) (2010) 354373, url [12] l. pel, m. cervera, s. oller, m. chiumenti, local map damag model orthotrop materials, engin fractur mechan 124-125 (2014) 196216, issn 0013-7944, url //www.sciencedirect.com/science/article/pii/s0013794414001386. [13] p. b. loureno, anisotrop soften model masonri plate shells, journal structur engin 126 (9) (2000) 10081016. [14] d. addessi, e. sacco, a. paolone, cosserat model period masonri deduc nonlinear homogenization, european journal mechanics-a/solid 29 (4) (2010) 724737. [15] e. bosco, v. kouznetsova, m. geers, multi-scal comput homogenizationloc propag discontinu x-fem, intern journal numer method engi- neer 102 (3-4) (2015) 496527. [16] m. l. bellis, cosserat base multi-scal techniqu masonri structures, in: phd thesis, 2009. [17] m. l. bellis, d. addessi, cosserat base multi-scal model masonri structures, interna- tional journal multiscal comput engin 9 (5). [18] e. a. d. s. neto, r. a. feijo, variat foundat multi-scal constitut model solid: small larg strain kinemat formulation, lncc research develop (16). [19] m. geers, v. g. kouznetsova, w. a. m. brekelmans, multiscal first-ord second-ord comput homogen microstructur continua, intern journal multiscal comput engin 1 (4), issn 1543-1649. [20] j. a. hernndez, j. oliver, a. e. huespe, m. caicedo, high-perform model reduct proce- dure multiscal simulations, 127, monograph cimne, 2012. [21] v. kouznetsova, m. geers, w. brekelmans, multi-scal second-ord comput homogen multi-phas materials: nest finit element solut strategy, method appli mechan engin 193 (2004) 55255550, issn 0045-7825. [22] v. kouznetsova, m. g. d. geers, w. a. m. brekelmans, multi-scal constitut model hetero- geneou materi gradient-enhanc comput homogen scheme, intern journal numer method engin 54 (8) (2002) 12351260, issn 1097-0207. [23] t. j. massart, multi-scal model damag masonri structur . [24] t. massart, r. peerlings, m. geers, enhanc multi-scal approach masonri wall compu- 38 tation local damage, intern journal numer method engin 69 (5) (2007) 10221059. [25] b. mercatoris, p. bouillard, t. massart, multi-scal detect failur planar masonri shell comput homogenisation, engin fractur mechan 76 (4) (2009) 479499. [26] b. mercatoris, t. massart, coupl two-scal comput scheme failur period quasi-brittl planar shell applic masonry, intern journal numer method engin 85 (9) (2011) 11771206. [27] x. oliv olivella, m. a. caicedo silva, e. roubin, a. e. huespe, et al., continuum approach comput multi-scal model fracture, kei engin materi 627 (2014) 349352. [28] j. oliver, i. dias, a. e. huespe, crack-path field strain-inject techniqu comput model propag materi failure, method appli mechan engin 274 (2014) 289348. [29] j. oliver, m. caicedo, e. roubin, j. hernndez, a. huespe, multi-scal (fe2) analysi mate- rial failur cement/aggregate-typ composit structures, comput model concret structur (2014) 39. [30] s. oller, j. miquel canet, f. zalamea, composit materi behavior homogen doubl scale method, journal engin mechan 131 (1) (2005) 6579. [31] j. m. ortolano, j. a. hernndez, j. oliver, compar studi homogen strategi multi-scal analysi materials, 135, monograph cimne, 2013. [32] f. otero, x. martnez, s. oller, o. salomn, studi predict mechan perform nanotube-reinforc composite, composit structur 94 (2012) 29202930. [33] f. otero, s. oller, x. martinez, o. salomn, numer homogen composit materi analysis. comparison micro mechan formulations, composit structur 122 (2015) 405416. [34] h. a. badillo, numer model base multiscal homogen theory. applic composit materi structures, ph.d. thesis, universitat politcnica catalunya barcelonat- ech, 2012. [35] r. d. quinteros, s. oller, l. g. nallim, nonlinear homogen techniqu solv masonri structur problems, composit structur 94 (2) (2012) 724730. [36] p. trovalusci, r. masiani, non-linear micropolar classic continua anisotrop discontinu materials, intern journal solid structur 40 (5) (2003) 12811297. [37] a. zucchini, p. loureno, micro-mechan model homogenis masonry, interna- tional journal solid structur 39 (12) (2002) 32333255. [38] a. zucchini, p. b. loureno, micro-mechan homogenis model masonry: applic shear walls, intern journal solid structur 46 (3) (2009) 871886. [39] v. p. nguyen, m. stroeven, l. j. sluys, multiscal continu discontinu model heterogen materials: review recent developments, journal multiscal model 3 (04) (2011) 229270. [40] t. belytschko, s. loehnert, j.-h. song, multiscal aggreg discontinuities: method cir- cumvent loss materi stability, intern journal numer method engin 73 (6) (2008) 869894. [41] m. petracca, l. pel, r. rossi, s. oller, g. camata, e. spacone, regular order com- putat homogen multiscal analysi masonri structures, comput mechan 57 (2) (2016) 257276, issn 1432-0924, url [42] m. geers, e. coenen, v. kouznetsova, multi-scal comput homogen structur sheets, model simul materi scienc engin 15 (4) (2007) s393. [43] m. geers, v. kouznetsova, w. brekelmans, multi-scal comput homogenization: trend challenges, journal comput appli mathemat 234 (7) (2010) 21752182. [44] e. coenen, v. kouznetsova, m. geers, comput homogen heterogen sheets, intern journal numer method engin 83 (8-9) (2010) 11801205. [45] y. cong, s. nezamabadi, h. zahrouni, j. yvonnet, multiscal comput homogen heterogen shell small strain extens finit displac buckling, interna- tional journal numer method engin 104 (4) (2015) 235259. [46] r. grytz, g. meschke, comput homogen multi-scal shell analysi larg strains, in: iii european confer comput mechan (eccm 2006), 592, 2006. [47] m. griffith, j. vaculik, out-of-plan flexur strength unreinforc clai brick masonri walls, tm journal 25 (1) (2007) 5368. [48] g. cowper, shear coeffici timoshenko beam theory, journal appli mechan 33 (2) (1966) 335340. 39 [49] r. borst, zero-normal-stress condit plane-stress shell elastoplasticity, communi- cation appli numer method 7 (1) (1991) 2933. [50] r. hill, self-consist mechan composit materials, journal mechan physic solid 13 (4) (1965) 213222. [51] j. mandel, plasticit classiqu et viscoplasticit, springer-verlag, 1971. [52] p. dadvand, r. rossi, e. oate, object-ori environ develop finit element code multi-disciplinari applications, archiv comput method engin 17 (3) (2010) 253297. [53] p. dadvand, r. rossi, m. gil, x. martorell, j. cotela, e. juanpere, s. r. idelsohn, e. oate, migrat gener multi-phys framework hpc environments, comput & fluid 80 (2013) 301309. [54] gid: person pre post preprocessor, 2002. [55] m. cervera, j. oliver, r. faria, seismic evalu concret dam continuum damag models, earthquak engin & structur dynam 24 (9) (1995) 12251245. [56] r. faria, j. oliver, m. cervera, strain-bas plastic viscous-damag model massiv concret structures, intern journal solid structur 35 (14) (1998) 15331558. [57] j. y. wu, j. li, r. faria, energi releas rate-bas plastic-damag model concrete, interna- tional journal solid structur 43 (3) (2006) 583612. [58] j. lubliner, j. oliver, s. oller, e. oate, plastic-damag model concrete, intern journal solid structur 25 (3) (1989) 299326. [59] z. baant, b. oh, crack band theori fractur concrete, bordas-dunod, url books.google.it/books?id=x9citwaacaaj, 1983. [60] j. oliver, consist characterist length smear crack models, intern journal numer method engin 28 (2) (1989) 461474. [61] s. oller, fractura mecnica: enfoqu global, edicion cimn y upc, 2001. [62] m. cervera, m. chiumenti, r. codina, mix stabil finit element method nonlinear solid mechanics. ii: strain localization, method appli mechan engin 199 (37) (2010) 25712589. [63] l. benedetti, m. cervera, m. chiumenti, stress-accur mix fem soil failur shallow foundat involv strain local plasticity, comput geotechn 64 (2015) 3247. [64] m. cervera, l. pel, r. clemente, p. roca, crack-track techniqu local damag quasi-brittl materials, engin fractur mechan 77 (13) (2010) 24312450. [65] s. saloustros, l. pel, m. cervera, crack-track techniqu local cohesive-frict dam- age, engin fractur mechan 150 (2015) 96114, issn 0013-7944, url org/10.1016/j.engfracmech.2015.10.039. [66] j. c. simo, m. rifai, class mix assum strain method method incompat modes, intern journal numer method engin 29 (8) (1990) 15951638. [67] e. n. dvorkin, k.-j. bathe, continuum mechan base four-nod shell element gener non-linear analysis, engin comput 1 (1) (1984) 7788. [68] k.-j. bathe, e. n. dvorkin, four-nod plate bend element base mindlin/reissn plate theori mix interpolation, intern journal numer method engin 21 (2) (2005) 367383. [69] f. otero, x. martinez, s. oller, o. salomn, effici multi-scal method non-linear analysi composit structures, composit structur 131 (2015) 707719. 40 introduct comput homogen framework shell kinemat shell constitut response: through-the-thick integr cross section down-scal macro-micro transit constraint condit solut micro-scal bvp up-scal micro-macro transit typic deform mode obtain shell homogen framework fracture-energi regular 2-scale fe comput homogen numer model out-of-plan load masonri wall experiment test tension/compress continuum damag model constitut model failur criteria evolut law damag variabl rve materi paramet micro-model direct numer simul multiscal simul comput cost micro-scal multi-scal simul comparison dns-3d dns-shell multiscal models. conclus refer