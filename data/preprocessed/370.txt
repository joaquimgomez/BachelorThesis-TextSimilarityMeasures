finit element approxim viscoelast flow problem: non-residu base stabil formul e. castilloa,b r. codinab,c auniversitat politcnica catalunya, jordi girona 1-3, edifici c1, 08034 barcelona, spain buniversidad santiago chile (usach), depto. ingeniera mecnica, av. bdo. ohiggin 3363, santiago, chile ccimn intern center numer method engineering, gran capit s/n, 08034 barcelona, spain abstract paper, three-field finit element stabil formul incompress viscoelast fluid flow problem test numerically. start residu base formulation, non-residu base designed, benefit highlight work. formul allow deal convect natur problem us equal interpol problem unknown -u-p (deviator stress, veloc pressure). additionally, result numer analysi formul stated. numer exampl present robust method, includ classic 4 : 1 planar contract problem flow confin cylind case, two-fluid formul planar jet buckl problem. keywords: viscoelast fluids, oldroyd-b fluids, stabil finit element methods, variat multiscale. 1. introduct finit element approxim flow viscoelast fluid present numer difficulties, particularli spatial approximation. hand, finit element approxim satisfi compat inf-sup conditions, velocity-pressur second associ interpol veloc stress [1, 2]. hand, convect natur present momentum constitut equat lead numer instabilities. advect natur constitut equat make necessari us stabil formul avoid global oscillations. context finit element method, algorithm develop solv problem: classic supg method non-consist counterpart, su method [3], gl method [4, 5], stabil base discontinu galerkin method [6]. present work, appli stabil formul base variat multiscal (vms) framework introduc email address: (e. castilloa,b r. codinab,c) preprint submit elsevi novemb 10, 2016 hugh et al. [7] scalar convection-diffusion-react problem, extend later vectori stoke problem [8], space sub-grid scale taken orthogon finit element space. shall see, import ingredi design formulations. start point vm approach split unknown problem components, namely, compon approxim finit element mesh unresolv one, call sub-grid scale simpli sub-scal follows. need approxim simpl manner term former, captur main effect yield stabl formul finit element unknown. differ wai approxim sub-scal and, particular, choos space taken. formul precis differ choice. formul allow deal instabl three-field viscoelast formul describ earlier. need meet inf-sup condit interpol space possibl solv convect domin problem momentum constitut equation. latter, method work well. however, momentum equat observ robust presenc high gradient unknowns, modifi them. modif consist design sort term-by-term stabil base choic subscal orthogon finit element space. method need it. work organ follows. section 2 contain present problem. section 3 present stabil finit element approach. section 4 devot numer analysi result section 5 contain typic numer exampl kind fluids. finally, section 6 conclus summarized. 2. viscoelast flow problem 2.1. boundari valu problem simul transitori incompress isotherm flow viscoelast fluids, need solv momentum balanc equation, continu equat constitut equat defin viscoelast contribut fluid. conserv equat momentum mass express as: u t + u u t +p = f , t ]0, tf [, (1) u = 0 , t ]0, tf [ (2) comput domain rd occupi fluid, ]0, tf [ time interv problem solved, denot constant density, p : r pressure, u : rd veloc vector, f : rd forc vector t : rd rd deviator extra stress tensor defin 2 term viscou viscoelast elast contribut as: t = 20su+ (3) [0, 1] real paramet (ratio) defin viscou solvent viscos 0 elast polymer viscos (1 ) 0 fluid. viscoelast fluids, problem incomplet definit constitut equat elast extra stress tensor (). larg varieti approach exist defin (see [9, 10] complet description). work, differenti oldroyd-b model considered. reads: 20 t + 1 20 (1 )su+ 20 ( u u (u)t ) = 0 , t ]0, tf [ (4) relax time. call u = [u,, p], f = [f , 0, 0] defin l(u,u) := u u 20 (su) +p u 20 t + 1 20 (1 )su+ 20 ( u u (u)t ) (5) t (u) := u t 0 20 t (6) write (1), (2) (4) definit (3) t (u) + l(u,u) = f . initi boundari condit append problem (1)-(4). simplic exposition, consid simplest boundari condit u = 0 , boundari condit . however, hyperbol natur constitut equation, exampl elast stress fix inflow boundary. complet descript mathemat structur problem refer [11]. 2.2. variat form introduc notat order write weak form problem. space squar integr function domain denot l2 (), space function distribut deriv order m 0 (integer) belong l2 () hm (). space hm0 () consist function h1 () vanish . topolog dual h10 () denot h 1 (), dualiti pair , , l2 inner product (for scalar, vector tensors) denot (, ). norm function space x 3 denot x , x = l2(), case subscript omitted. notation, stress, veloc pressur function space continu problem 0 = l 2 ( 0, tf ; (h 1 0 ()) dd sym ) (the subscript sym stand symmetr tensors), v0 = l2 ( 0, tf ; (h 1 0 ()) d ) q = d ( 0, tf ; (l 2()/r) ) (d stand distributions), respectively. weak form problem consist find u = [u, p,] x = v0 q0, that: ( u t ,v ) + 2 (0su,sv) + u u,v+ (,sv) (p, v) = f ,v (7) (q, u) = 0 (8)( 20 t , ) + ( 1 20 , ) ((1 )su, ) + 20 ( u u (u)t , ) = 0 (9) v = [v, q, ] x (the time independ counterpart x ), f ( 0, tf ; (h 1()) ) . compact form, problem (7)-(9) written as: ( u t ,v ) + ( 20 t , ) +b (u;u ,v ) = f ,v v x , b (u;u ,v ) = 2 (0su,sv) + u u,v+ (,sv) (p, v) + (q, u) + ( 1 20 , ) ((1 )su, ) + 20 ( u u (u)t , ) (10) 3. numer approxim 3.1. galerkin finit element discret standard galerkin approxim variat problem perform consid finit element partit th domain . diamet element domain k th denot hk diamet element partit defin h = max {hk | k th}. considerations, construct conform finit element spaces, vh,0 v0, qh q h,0 0 usual manner. x h = vh,0qhh,0, uh = [uh, ph,h], galerkin finit element approxim consist find uh x h, that: ( uh t ,vh ) + ( 20 h t , h ) +b (uh;uh,v h) = f ,vh (11) v h = [vh, qh, h] x h. principle, pose restrict choic finit element spaces. however, restrict satisfi explicitli discret formul used. 4 three-field formul stoke problem [12, 1, 13]. possibl remedi situat us inf-sup stabl element (see [3] 2d case [14] 3d case). possibl us stabil formul permit interpol variables, approach work. general, stabil formul consist replac b bilinear form bh, possibl mesh dependent, better stabil properties. 3.2. stabil finit element approxim follow present stabil finit element formul comput viscoelast flow oldroyd-b constitut model. base variat multi-scal approach, unknown split u = uh + u , uh finit element u repres remaind non-captur part, call sub-grid scale. similar split consid test functions. method discuss residu base stabil formulation, second non-residu turn better perform situat solut smooth. 3.2.1. residu base stabil finit element formul approxim (see [15]), residu base method consid consist find uh x h ( uh t ,vh ) + ( 20 h t , h ) +b (uh;uh,v h) + k u ,l (uh;v h) k = f ,vh (12) v h x h, l (u,v h) formal adjoint oper (5) consid boundari conditions, u subgrid scale, need approximated. p l2 project space sub-grid scales, approxim consid element u = p [rh] = p [f l (uh;uh)] rh finit element residu matrix comput element, = diag (1id, 2, 3idd) id ident vector rd, idd ident second order tensor paramet i, = 1, 2, 3, comput 1 = [ c1 0 h2 + c2 |uh| h ]1 , 2 = h2 c11 , 3 = [ c1 1 20 + c3 0 ( |uh| 2h + |uh| )]1 c1, c2 c3 algorithm constants. 5 independ choic project p , method defin (12) consistent, term ad galerkin on proport finit element residu rh. thus, vanish finit element solut replac continu solut u . sens (12) residu base method. 3.2.2. non-residu base stabil finit element formul smooth solution, method (12) stabl displai optim order convergence. consid p = ph , (12) design simplifi method, consist neglect cross local inner- product terms, term contribut stability. particular, momentum equat obtain follow stabil term s1 (uh;uh,v h) = k 1 ph [uh uh] , uh vh k + k 1 ph [ph] ,qh k (13) + (1 ) k 1 ph [ h] , h k instead follow term deriv residu base method: s1 (uh;uh,v h) = k 1 p [ h 20 (suh) + uh uh +ph] , (14) (1 ) h + 20 (svh) + uh vh +qh k contribut left-hand-sid discret problem r1 (uh;v h) = k 1 p [f ], (1 ) h + 20 (svh) + uh vh +qh k (15) appear right-hand-sid discret problem. note us (13) intead (14) (15) simplification. smooth solutions, method optim converg rate h. however, problem solut strong gradients, (13) robust. (13), term identifi problemat cross-term 1 ph, (1 ) hk 1 h,qhk . presenc high deriv pressur stress, corner 4:1 contract example, lead converg difficulti high weissenberg number inaccur local pressur stress peaks. fact confirm numer experiments. stabil term constitut equat continu equat us residu base form, proven robust combin addit advantag smaller number finit element project need construct method. continu 6 constitut equat stabil term defin respect as: s2 (uh,v h) = k 3 p [ uh] , vh k , (16) s3 (uh;uh,v h) = k 3 p [ 1 20 h (1 )suh + 20 ( uh h h uh (uh) t h )] , 1 20 h svh + 20 ( uh h + h (uh) t +uh h ) k (17) finally, propos method defin follows: uh x h ( uh t ,vh ) + ( 20 h t , h ) +b (u;uh,v h) + s1 (uh;uh,v h) + s2 (uh,v h) + s3 (uh;uh,v h) = f ,vh (18) v h x h. replac residu formul defin (12). numer exampl follow analysi results, us p = ph term s2 s3. methods, residu non-residual, optim converg space. tempor order accuraci monolith case determin time integr scheme used. case fraction step approach, differ algorithm designed. [16], first, second order scheme time design three-field viscoelast case. 4. numer analysi result perform complet numer analysi stationari linear problem, prove stabil converg mesh depend norm associ problem natur norms. present result analysi proof, [17]. problem consid following: uh x h (now space time independ functions) bstab(uh,v h) := b(ah;uh,v h) + k u ,l (ah;v h) k = f ,vh (19) v h x h, adequ approxim u . here, ah given advect velocity, fixed-point like iter algorithm understood veloc field obtain previou iteration. guarante well-posed solut problem (19), advect veloc satisfi follow assumpt (see e.g. [11]): ah v0, ah = 0, ah ma, ah mg constant ma,mg < (20) 7 let assum simplic stabil paramet constant. norm associ stabil bilinear form bstab, result presented, given v h 2 w = 2 (1 ) svh 2 + 1 2 h 2 + 1 ah vh +qh h 2 + 1 pu (ah vh)2 + 1 (1 ) k pu ( h)2 + 1 k pu (qh)2 + 2 vh 2 + 3 (1 )svh + 2 (ah h + h ) 2 (21) h = h asahasah h stand skew-symmetr gradient vector field. stabil result following: theorem 1 (stability). constant c > 0, inf uhxh sup uhxh bstab (uh,v h) uhw v hw c bellow, c denot gener posit constant. have stability, proce prove convergence. ingredi consistency. method present exactli consistent, optim consist error. state it, need addit notation. let wh finit element space degre kv. function v hk v+1 () = 0, 1, defin interpol error (v) interpol estim inf vhwh k v vhhi(k) ch kv +1i k v hk v +1(k) =: (v) kv = min (kv, k v). denot vh best approxim v wh. clearly, 0 (v) = h1 (v). notat allow prove error function method e (h) := 1 (u) + ( ahh ) 1 (u) + 1 0 () + 1 ( ah h ) 0 () + 1 c0 (p) note error function defin term local reynold number local weissenberg number. lemma 1 (consistency). let u x solut continu problem uh x h finit element solution. f vh u regular enough, bstab (u ,v h) defined, bstab (u uh,v h) ce (h) v hw 8 v h x h. e(h) error function formul determin follow result: lemma 2 (interpol error). let u x solut continu problem, assum regular enough, uh x h best finit element approximation. then, follow inequ hold: bstab(u uh,v h) ce (h) v hw , u uhw ce (h) v h x h. finally, state main converg result, view definit error function e(h) turn optimal: theorem 2 (convergence). let u = (u, p,) x solut continu problem. exist constant c > 0 u uhw ce (h) result state term norm w fulli meaningful. however, case viscos high elast small, prove stabil converg norm space solut belongs. follow theorem states: theorem 3 (stabil converg natur norms). solut discret problem uh = (uh, ph,h) x h bound (for viscou domin case low weissenberg number case): uhh1() + 1 h+ 1 ph c fh1() moreover, solut continu problem u = (u, p,) x regular enough, follow error estim holds: u uhh1() + 1 h+ 1 p ph ce (h) finally, classic assumpt ellipt regular prove l2 estim velocity: theorem 4 (l2-error estim velocity). suppos reynold number weissenberg number small, continu problem satisfi ellipt regular condit uh2() + 1 h1() + 1 ph1() c f then, holds: u uh ch ( u uhh1() + 1 h+ 1 p ph ) 9 4 : 1 contract n element n node xmin = ymin m1 27258 27667 0.05 m2 39894 40501 0.025 m3 105816 106671 0.01 flow cylind n element n node xmin = ymin m1 41514 21330 0.025 m2 56905 29152 0.015 m3 67856 35167 0.005 tabl 1: mesh converg details. 5. numer result section, test conduct numer perform propos formulation, emphas robust non-residu one. exampl correspond 4 : 1 contract problem, result classic flow confin cylind problem, defin pipe diamet equal 2 cylind diamet 1, finally, tridimension jet-buckl case high elast flow two-fluid formulation. cases, oldroyd-b constitut model used. fig. 1 spatial discret shown 4:1 contract problem cylind case. figur ne repres number elements, nn number node xmin repres minimum element size cases. mesh size chosen evalu converg result differ mesh example. detail mesh detail tabl 1. note cases, present result associ m3 mesh practic ident result mesh m2. figur 1: mesh used: 4:1 contract (left) flow cylind (right). motiv design non-residu base formul fact residu formul robust presenc high gradient unknowns. fig. 2 show pressur variat line near corner. corner situat x = 20. figure, non-residu base residu base solut shown weissenberg number = 2.0 reynold number 10 = 1.0. non-residu formul captur peak accur residu gener non- physic secondari peak, remov mesh refinement. numer analysis, term-by-term formul permit orthogon term-by-term control pressur gradient diverg elast stresses, residu formul control, possibl answer situation. case, remark smooth solutions, formul stabl displai optim order convergence. observ case solut high concentr gradient non-residu base formul robust, shown example. figur 2: pressur variat line 4:1 contract problem (we = 2.0 = 1.0): non-residu base (left) residu base (right). addition better capabl resolut high gradient problems, non-residu formul permit calcul elast flows. fig. 3 streamlin case shown. residu base formulation, elast case abl comput approxim = 2.0; elast case calcul fail converge. however, non-residu base formul capabl solv problem = 5.0 (see result [15], formul presented). case confin cylinder, solut smooth, behavior non-residu base formul compar residu base similar. fig. 4, drag coeffici obtain formul compar publish results. note curv graph word log added, associ us log-conform approach. general, literatur standard formul solv problem valu 0.7 1.0 depend refer [18, 19, 5], log-conform formul allow obtain solut valu 2.0 2.5, depend sourc [20, 21, 22]. formulations, abl solv problem = 1.4. graph, agreement good = 1.1, differ lower 1% respect accept valu 11 figur 3: streamlin 4:1 contract problem: = 2.0, = 1.0 (left) = 5.0, = 1.0 (right), non-residu base formulation. references; higher valu differ respect log-conform approach begin increase, possibl associ high weissenberg number problem (hwnp). term hwnp refer empir observ numer method break weissenberg number exce critic value, exponenti grown stresses. figur 4: drag coeffici flow cylinder: residu base non-residu base formulations. final numer exampl (fig. 5) present robust non-residu base formul three-dimension case jet-buckl flow problem. detail exampl two-fluid approach [23], exampl taken. object includ result formul present accur robust situat consid paper. 12 figur 5: jet buckl 3d prismat caviti for: = 100 = 0.25. 13 6. conclus paper present stabil finit element method approxim incompress viscoelast flow problem. hand, summar formulation, state result numer analysi linear problem present numer results. hand, explain residu base formul fail situat stress high local peaks, term-by-term stabil base local project solv problem. work understood summari previou (recent) work explan phenomenon described. formul suffer high weissenberg number problem. under- stood light estim present linear stationari problem, seen deterior weissenb number (or reynold number) increases. nevertheless, present method appli log-conform formulations. numer result robust method. local oscil present residu base formul remov term-by-term stabil method, result obtain smooth, highest weissenberg number result literature. acknowledg e. castillo gratefulli acknowledg support receiv conicyt (programa formacin capit o humano avanzado/becas-chil folio 72120080), universidad santiago chile. r. codina gratefulli acknowledg support receiv catalan govern icrea acadmia research program. refer [1] r. codina, finit element approxim three-field formul stoke problem arbitrari interpolations, siam journal numer analysi 47 (1) (2009) 699718. [2] k. wang, new discret evss method viscoelast flows, comput & mathemat applic 65 (4) (2013) 609615. [3] j. marchal, m. crochet, new mix finit element calcul viscoelast flow, journal non- newtonian fluid mechan 26 (1) (1987) 77114. [4] y. fan, r. tanner, n. phan-thien, galerkin/least-squar finite-el method steadi viscoelast flows, journal non-newtonian fluid mechan 84 (2-3) (1999) 233256. [5] o. m. coronado, d. arora, m. behr, m. pasquali, four-field galerkin/least-squar formul viscoelast fluids, journal non-newtonian fluid mechan 140 (1-3) (2006) 132144. 14 [6] f. p. baaijens, applic low-ord discontinu galerkin method analysi viscoelast flows, journal non-newtonian fluid mechan 52 (1) (1994) 3757. [7] t. j. hughes, g. r. feijo, l. mazzei, j.-b. quincy, variat multiscal method-a paradigm comput mechanics, method appli mechan engin 166 (1-2) (1998) 324, advanc stabil method comput mechanics. [8] r. codina, stabil incompress convect orthogon sub-scal finit element methods, method appli mechan engin 190 (13-14) (2000) 1579 1599. [9] r. b. bird, r. c. amstrong, o. hassager, in: dynam polymer liquids, vol.1: fluid mechanics, 2nd edition, wiley, new york, 1987. [10] r. b. bird, c. f. curtiss, r. c. amstrong, o. hassager, in: dynam polymer liquids, vol.2: kinet theory, 2nd edition, wiley, new york, 1987. [11] e. fernndez-cara, f. guilln, r. ortega, mathemat model analysi viscoelast fluid oldroyd kind, handbook numer analysis, viii, north-holland, 2002. [12] j. bonvin, m. picasso, r. stenberg, gl evss method three-field stoke problem aris viscoelast flows, method appli mechan engin 190 (29-30) (2001) 38933914. [13] e. castillo, r. codina, stabil stress-velocity-pressur finit element formul navier-stok problem fluid non-linear viscosity, method appli mechan engin 279 (0) (2014) 554578. [14] a. c. bogaerds, w. m. verbeeten, g. w. peters, f. p. baaijens, 3d viscoelast analysi polym solut complex flow, method appli mechan engin 180 (3-4) (1999) 413430. [15] e. castillo, r. codina, variat multi-scal stabil formul stationari three-field incompress viscoelast flow problem, method appli mechan engin 279 (0) (2014) 579605. [16] e. castillo, r. codina, first, second order fraction step method three-field viscoelas- tic flow problem, journal comput physic 296 (2015) 113137. [17] e. castillo, r. codina, numer analysi stabil finit element approxim three-field linear viscoelast fluid problem arbitrari interpolations, submitted. 15 [18] m. alves, f. pinho, p. oliveira, flow viscoelast fluid past cylinder: finite-volum high- resolut methods, journal non-newtonian fluid mechan 97 (2-3) (2001) 207232. [19] j. kwack, a. masud, three-field formul incompress viscoelast fluids, intern journal engin scienc 48 (11) (2010) 14131432, special issu honor k.r. rajagopal. [20] m. a. hulsen, r. fattal, r. kupferman, flow viscoelast fluid past cylind high weissenberg number: stabil simul matrix logarithms, journal non-newtonian fluid mechan 127 (1) (2005) 2739. [21] h. damanik, j. hron, a. ouazzi, s. turek, monolith fem approach log-conform reformul lcr viscoelast flow problems, journal non-newtonian fluid mechan 165 (19- 20) (2010) 11051113. [22] a. afonso, p. oliveira, f. pinho, m. alves, log-conform tensor approach finite-volum method framework, journal non-newtonian fluid mechan 157 (1-2) (2009) 5565. [23] e. castillo, j. baiges, r. codina, approxim two-fluid flow problem viscoelast fluid level set method pressur enrich finit element shape functions, journal non-newtonian fluid mechan 225 (2015) 3753. 16