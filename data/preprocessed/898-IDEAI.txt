1 model central nervou control cardiovascular support vector machin jo daz1, jess acosta2, rafael gonzlez1, juan cota1, ernesto sifuentes1, ngela nebot3 1dept ingeniera elctrica y computacin. instituto ingeniera y tecnologa. universidad autnoma ciudad jurez. 32310 - ciudad jurez, mxico. emails: 2dept instrumentacin y control. universidad politcnica territori falcn alonso gamero (uptag). 4101 - coro, venezuela. e-mail: 3dept science. universitat politcnica catalunya. 08034 - barcelona, spain. e-mail: correspond author: jo david daz r. email: phone: +52 (656) 688 4841 2017 elsevier. manuscript version avail cc-by-nc-nd 4.0 licens 2 abstract control cardiovascular (cs) scarc model due, basically, complex central nervou (cns). cardiovascular central nervou system close relat other. model base fuzzi induct reasoning, genet fuzzi systems, neural network quantit approach nonlinear autoregress techniques, emploi purpose, result significant, improv approxim expect control respons cns. research, support vector machin predict respons branch cns, control import cardiovascular system. study, control gener signal regul heart rate, myocardi contractility, peripher resistance, venou tone, coronari resistance, react variat carotid sinu blood pressur (csbp), presented. predict model train input signal (i.e., csbp) output signal controller; set input output signal emploi test control model. input signal process all-pass filter, perform predict model evalu averag normal mean squar error (mse) percentage. best forecast perform obtain peripher resist control mse= 1.20e-4 %, worst heart rate control mse= 1.80e-3 %. support vector machin present better perform estim dynam behavior control cn cardiovascular model system previous studied. kei words: central nervou system, cardiovascular system, modeling, support vector machine, fuzzi induct reasoning. 3 1. introduct mechan regul viscer organ nervou histor research topic. import system bodi cardiovascular and, obviously, fulli control central nervou system. cn gener regulatori signal transmit bundl nerv autonom nervou (sympathet parasympathetic) heart, blood vessels, kidneys, bodi parts; allow maintain appropri blood flow, follow hemodynam chang mainli variat arteri blood pressure. cn control import global function cs as: cardiac output (modifi heart rate myocardi contractility), redistribut blood flow, rapid control arteri pressur mention [1]. control gener cn cs carri vasomotor center manag integr inform from: viscer sensor (come baroreceptor cardiac caviti larg vessels, chemoreceptors), bulbar respiratori center, suprasegment structur brain [2]. reflex function baroreceptor import rapid control blood pressure, modul effer signal direct heart blood vessels. known baroreflex action produc rapid chang renal sympathet nervou activity, plai import role short term control blood pressur carri varieti function like mediat renin secretion, tubular reabsorpt water sodium, renal intravascular resist [3, 4]. 4 hemodynam behavior cs wide studied, mathemat comput model permit fairli accur simul perform hemodynam variabl [5-7]. moreover, high complex cns, model control respons compon hemodynam (heart blood vessels) repres import challenge. simplifi diagram cardiovascular propos valverd [7] shown fig. 1. diagram, hemodynam (hs), control cns, make cardiovascular system. branch cn control hemodynam compos control produc effer signal lead chang peripher resistance, cardiac output coronari circulation. control are: heart rate (hr), myocardi contractil (mc), peripher resist (pr), venou tone (vt), coronari resist (cr). affer signal drive control repres carotid sinu blood pressure, origin arteri carotid sinu baroreceptor [7]. 5 fig. 1. simplifi diagram cardiovascular model compos cn control hemodynam [7]. decades, import contribut produced, theori practice, relat support vector machin (svm) approach. approach led develop methodolog us design effici algorithm applic focus practic problem [8-10]. linear non-linear svm regress time seri predict wide real word applic forecast financi market, electr utility, weather, traffic, [11]; however, literatur outlin approach predict biomed signals. studies, shen et al. [12] develop predictor model base wavelet kernel function svm order predict multichannel electroencephalogram signals. shown svm methodolog captur effect dynam process typic nonlinear, non-stationari defin a-priori. 6 purpos studi predict output cn control cardiovascular model propos valverd [7], emploi regress model support vector machines. previou investig emploi narmax (nonlinear autoregress move averag extern inputs) model [13], neural network [14], fuzzi induct reason (fir) [13, 15], genet fuzzi system (gfs) hybrid techniqu genetic-fir algorithm (ga-fir) [16], automat construct linguist rule methodolog base fir (carfir) [17], target. model report good results, present studi author intend explor potenti support vector machin predict task, great complexity, repres major challeng nonlinear regress model. author propos new predict model deriv svm combin digit signal processing, offer altern build model robust effici mentioned. perform propos svm model compar obtain previou studies. 2. support vector machin methodolog accord theori svms, instead minim empir risk (to optim train set performance), target tradit techniqu pattern recognition, svm minim upper bound expect risk (structur risk). suppli svm great abil gener model, main goal statist learning. 7 import characterist svm [18]: 1) train data points, learn techniqu gener model; train data set, gener error limit estimated. 2) variabl act regular paramet (associ penalti misclassification) [19], determin balanc gener perform resolut [20]. 3) obtain best perform data includ training, algorithm find decis surfac maxim margin classifi data training. support vector machin classif regress tasks. svm determin output linear combin sampl train data, data point nonzero coeffici call support vectors. given set data train compos attribute-label pair (, ), = 1, , ; {1, 1}, classif purposes, svm need solut optim problem pose equat (1) constraint describ equat (2) [21]: min (w,) = 1 2 + =1 1 subject ( () + ) 1 0 2 8 here, train vector map function higher dimension space; higher dimension space, svm find linear separ hyperplan maxim margin. vector determin gener optim separ hyperplane. repres measur misclassif errors, > 0 (a settabl parameter) cost paramet error term. solut optim problem equat (1) constraint equat (2) equival determin point gradient lagrangian zero: (w,b,,,) = 1 2 2 + [( () + ) 1 + ] =1 =1 =1 3 , lagrang multipliers. easi wai solv equat (3) transform primal problem dual problem, minim lagrangian respect , b, , maxim respect , ; given by, max (, ) = max , (min ,, (, , , , )) 4 equat (5) repres minimum lagrangian respect , b : 9 = 0 = 0 =1 = 0 = () = 0 =1 = 0 + = 5 then, solut optim problem equat (5) becomes: = arg min 1 2 ( , ) =1 =1 =1 6 (, ) () () repres kernel function, make nonlinear map input space featur space (usual higher dimension).th constraint are: 0 = 1, , = 0 =1 7 solv equat (6) constraint (7) determin lagrang multipliers. equat (8) establish classifi optim separ hyperplan featur space. 10 () = ( (, ) =1 + ) 8 role kernel chang represent data featur space. popular kernel pattern recognit followings: (, ) = (1 + ) 9 (, ) = ( 2 22 ) 10 (, ) = tanh( ) 11 equat (9) repres polynomi kernel. provid classifier, p degre polynomi data. equat (10) give classifi base gaussian radial basi functions, equat (11) provid kernel repres kind special neural network hide layer sigmoid activ functions. kernel function present detail [18, 22, 23]. regress problems, svm includ altern loss function [24], modifi introduc measur distance. exampl loss function implement svm regress model present [23, 24]. 11 regress tasks, given train set l data points, (, ), = 1, , ; input 1 correspond output, optim problem need solv [18] is: ,,, 1 2 + =1 + =1 12 subject (() + ) ( () ) , 0, = 1, , 13 c pre-specifi valu (cost paramet error term, like classifi svms), , loos variabl set upper lower limit output system. -insensit loss function [23], dual problem express by: , 1 2 ( )( ) + ( ) =1 + ( ) =1 14 subject ( ) =1 = 0, 0 , , = 1, , 15 = ( , ) () (). 12 lagrang multipliers, , *, determin solv equat (14) constraint equat (15). regress function given by: () = ( ) =1 (, ) + 16 () = (, ) =1 (, ) = 1 2 (, ) =1 (( , ) + (, )) 17 kernel function contain bia term b. case, regress function given by: () = ( ) =1 (, ) 18 optim criteria loss function similarli on obtain [24]. -insensit loss function attract solut contain support vectors, instead, quadrat huber cost functions, data point support vectors. 13 investigation, support vector machin regress model implement matlab [25] libsvm tool develop taiwan univers [26]. 3. cardiovascular control central nervou specif data present studi correspond signal set vallverd [7], gener model cs identifi validated. cardiac catheter patient emploi obtain physiolog data order valid model. led simplifi cardiovascular model shown diagram fig. 1. branch cn control hemodynam compos control produc effer signal lead chang peripher resistance, cardiac output coronari circulation; are: heart rate, myocardi contractility, peripher resistance, venou tone, coronari resistance. affer signal driven control repres carotid sinu blood pressure, origin arteri carotid sinu baroreceptor [7]. sensibl analysi valverd studi show paramet baroreceptor have influenc output variabl model carotid sinu baroreceptors, influenc baroreceptor aortic arch neglected. import notic that, cs model, regulatori mechan renal function, respons chang renal sympathet nerv activ (rsna) mediat baroreflex action, assess fact rsna data available. 14 signal obtain simul model differenti equat central nervou [7]. model differenti equat tune order repres patient differ percentag coronari arteri obstruct (between 30 % 70 %) make agre physiolog variabl model (heart rate, aortic pressure, right auricular pressure, coronari blood flow) measur taken patients. 7279 data sampl input output signal cn control identifi model (the train data set), simul differenti equat model sampl period ts=0.12 s [7]. fig. 2 fig. 3 train signal input variabl (csbp) output variabl controllers. 15 fig. 2. bottom, carotid sinu blood pressur (input), output signal control venou tone peripher resistance, train svm models. fig. 3. bottom, output signal control myocardi contractility, heart rate, coronari resistance, train svm models. set test data signal segment (not emploi training) evalu model controller. test data segment size 600 samples. contain signal specif morphologies, product perform standard valsalva maneuv differ exhibit maneuv differ durat rel 16 intensity. detail explan test data set [7, 13, 15]. fig.4 show output signal (test data set) heart rate controller. fig. 4. heart rate control test data set. 3.1 train process all-pass filter (two pole/cero pairs) creat signal time delai (phase compensation), affect magnitud response, second input signal models. preliminari attempt input signal (and differ 17 process version that) train svm model present poor perform train process. reason, second input signal model chosen. primarily, start end frequenc pole/cero pair space all-pass filter determined. coars (0.1 step) grain search frequenc plane [0 ], follow fine (0.01 step) grain search frequenc pair best perform previously. pole magnitud set 1 2 . gaussian radial basi function (rbf) kernel, describ equat (10), advantag kernel function recommend hsu et al. [27]. preliminari test differ kernels, rbf approach show best perform predict task polynomi sigmoid functions, faster train others. case, c=10 =10 svm model, perform iter emploi train data control analyzed. model perform iter determin comput normal mean squar error (mse), percentage, predict output model (()) expect output (()). error comput equat (19): = [(() ()) 2 ] 100% 19 varianc (), given by: 18 = [() 2 ] {[]} 2 20 cross valid process emploi order adjust paramet svm models. this, train dataset control segment subset 4279 data samples, 3679 sampl (about 50.5 % total train dataset) train model, 600 sampl test proposes. continu segment data consid train test (to avoid discontinu signal processing). total, subset data form slide 4279 sampl window begin end data 3679 overlap sampl case. iter cross valid performed; case test data locat end data subset (test data subset a), others, begin data subset (test data subset b). process shown fig. 5. figur subplot a) contain 4279 data sampl subset 1, train data repres 3679 samples, remain 600 on test model (subset case); subplot b) repres data window 4279 sampl move right incorpor 600 new sampl (overlap 3679 sampl subset 1) form subset 2; subplot c) present data window slide step step end train data set order conform total 6 data subsets; subplot d) repres version b data subset 1; 600 sampl repres data test follow 3679 sampl train model. 19 fig. 5. data segment cross valid process. mse averag 12 iter cross valid process comput best paramet c svm regress model grid-search procedur suggest [27]. 3.2 valid process 20 paramet produc model best perform obtain cross valid process emploi evalu phase. paramet signal process svm model found, final model built includ train data set (7279 samples) controller. set paramet all-pass filter (start stop frequency) svm model (c ), control shown tabl 1. tabl 1. paramet past filter svm control hr pr mc vt cr all-pass filter start - stop frequenc [ rad] .01 - .11 .01 - .13 .01 - .13 .01 - .11 .01 - .13 svm c 10 10 10 5 5 10 53 60 58 60 support vector machin regress model cn control evalu test data set. mse obtain evalu model test data set averag report result section. 3.3 result tabl 2 show mse predict obtain control svm models. look closer tabl 2 seen largest averag error 1.8e-3 % (for hr controller). 21 tabl 2. predict mse valid data set control model svm hr (%) pr (%) mc (%) vt (%) cr (%) train data 1.7e-3 1.14e-4 6.38e-4 7.05e-4 1.36e-4 data set 1 1.7e-3 1.10e-4 5.34e-4 6.06e-4 1.05e-4 data set 2 1.5e-3 1.10e-4 4.61e-4 5.81e-4 0.99e-4 data set 3 1.5e-3 0.89e-4 4.97e-4 4.55e-4 1.08e-4 data set 4 1.6e-3 1.03e-4 5.32e-4 5.98e-4 1.39e-4 data set 5 2.0e-3 1.31e-4 7.44e-4 7.55e-4 1.57e-4 data set 6 2.8e-3 1.83e-4 9.42e-4 1.10e-3 1.80e-4 averag error 1.8e-3 1.20e-4 6.18e-4 6.81e-4 1.36e-4 fig. 6 show result predict test data set 3 peripher resist controller. present best predict result obtained, mse= 0.89e-4 %. upper plot figure, expect predict output signal present frame. differ signal appreciated, demonstr excel perform predict models. predict error (real minu predict values) shown lower plot figure. worst case shown fig. 7, correspond predict test data set 6 heart rate controller. case, differ expect predict signal distinguishable, mean great precis model. import notic process time execut 416 iter frequenc pass filter 4992 second (in worst case), 22 paramet c svm model 44256 seconds. therefore, order perform iter cross valid process total time need 5532 seconds. final train svm model, complet train data controller, take 12 second most. matlab simul core 2 duo 2.1 ghz processor. fig.6. peripher resist controller: predict test data set 3. 23 fig 7. heart rate controller: predict test data set 6. 3.4 discuss section, perform svm regress model present work compar obtain previou studies. tabl 3 contain predict result report problem narmax, tdnn rnn, fir, gf (ga-fir) carfir models. tabl specifi mse averag test data set prediction, controller. row tabl present best perform obtain nebot et al. [15]. research fir methodolog 24 predict test data set (which emploi train process), controllers. nebot cowork databas includ signal differ patients. result present tabl 3 correspond model build patient #4, smallest mse average, compar patient results. current research, obtain averag error slightli higher compar obtain fir model patient #4. however, average, error obtain svm lower obtain rest patient nebot study. tabl 3. mse obtain predict valid data set differ method hr (%) pr (%) mc (%) vt (%) cr (%) narmax [13] 9.8 14.89 17.21 16.89 31.69 fir [13] 1.37 1.49 1.41 1.47 0.09 tdnn [14] 15.35 33.76 34.02 34.04 55.69 rnn [14] 18.31 31.16 35.16 34.77 57.12 fir* [15] 7.3e-5 7.0e-4 7.6e-6 7.9e-4 3.0e-4 gf (ga-fir) [16] 0.10 0.15 0.30 0.28 9.47e-30 carfir [17] 11.02 9.97 5.00 5.01 2.64 *patient 4 worst perform report svm model hr control (mse averag 1.8e-3 %), correspond test data set #6 mse= 2.8e-3 % (see tabl 1, sixth row/first column). consider lower report nebot [15] hr 25 control model patient #4 (mse averag 7.3e-5 %), predict test data set mse= 32.1e-3 %. mean svm model fit test data set controller. therefore, show better perform predict models. tabl 4. comparison best result predict output control hr (%) pr (%) mc (%) vt (%) cr (%) svm (thi study) 1.8e-3 1.20e-4 6.18e-4 6.81e-4 1.36e-4 fir [15] 7.3e-5 7.0e-4 7.6e-6 7.9e-4 3.0e-4 gf (ga-fir) [16] 0.10 0.15 0.30 0.28 9.47e-30 present study, mse averag mc control higher report nebot [15], probabl error valid set wors on obtain svm model controller. moreover, [15], detail result control order precis comparison. noted, predict cr control (see tabl 4) better obtain nebot [15], exce obtain gf techniqu [16]. however, taken account comput cost requir us hybrid technique. total execut time tune paramet train svm model control 14 hours. acosta [16] report averag time 357 hour find best paramet gf model, emploi 26 0.6 ghz processor. although, processor investig 3.5 time faster acosta processor, requir laps build svm model close 25.5 time shorter; mean comput save near 7.3 times. 4. conclus paper support vector machin model portion human central nervou control, charg control hemodynam behavior cardiovascular system. control heart rate, myocardi contractility, peripher resistance, venou tone coronari resist model order predict respons driven input variable, carotid sinu blood pressure, differ system behaviors. methodolog consider present tune paramet process input signal fit svm variables. choic second input signal group delai version creat origin signal processing, kei factor obtain excel perform svm predict models. low comput cost implement train method svm model indic simpl flexibl strategy, compar favor optim techniqu implement model purpose. 27 purpos present studi predict cn control respons transient chang blood pressur (a caus valsalva maneuvers), mean svm regress models. chang blood pressur caus chang affer baroreceptor signal (which repres input signal model). close control loop, output model activ effector element hemodynam (heart blood vessels), model vallverd study. however, model hemodynam focu research effort paper. shown support vector machin repres effici power methodology, profici model dynam behavior control cn cardiovascular system. refer [1] a.c. guyton, j.e. hall, tratado fisiologa mdica, 10th ed., mc-graw hill interamiericana, mexico, 2006. [2] j.h. coote, landmark understand central nervou control cardiovascular system, experiment physiology, 92 (2007) 3-18. [3] u.c. kopp, neural control renal function, morgan & claypool life sciences, san rafael (ca), 2011. [4] c. julien, baroreflex control sympathet nerv activ blood pressur variability, clinic experiment pharmacolog & physiology, 35 (2008) 512-515. 28 [5] j.e.w. beneken, v.c. rideout, us multipl model cardiovascular studies: transport perturb methods, ieee transact biomed engin 15 (1968) 281-289. [6] sagawa k., maughan l., suga h., s. k., cardiac contract pressure-volum relationship, new york, 1988. [7] m. vallverd, modelado y simulacin del sistema control cardiovascular en pacient lesion coronarias, universitat politcnica catalunya, barcelona, 1993. [8] y. ma, g. guo, support vector machin applications, springer, new york, 2014. [9] d. naiyang, t. yingjie, z. chunhua, support vector machines: optim base theory, algorithms, extensions, chapman \& hall/crc2012. [10] r.g. brereton, g.r. lloyd, support vector machin classif regression, analyst, 135 (2010) 230-267. [11] n.i. sapankevych, r. sankar, time seri predict support vector machines: survey, ieee comput intellig magazine, 4 (2009) 24-38. [12] m. shen, l. lin, j. chen, c.q. chang, predict approach multichannel eeg signal model local wavelet svm, ieee transact instrument measurement, 59 (2010) 1485-1492. [13] a. nebot, f. cellier, m. vallverdu, mix quantitative/qualit model simul cardiovascular system, method program biomedicine, 55 (1998) 127-155. [14] j. cueva, r. alquezar, a. nebot, experiment comparison fuzzi neural network techniqu learn model central nervou control, 29 eufit'97, 5th european congress intellig techniqu soft computingaachen, 1997, pp. 1014-1018. [15] a. nebot, f. mugica, f. cellier, m. vallverdu, model simul central nervou control gener fuzzi models, simulation, 79 (2003) 648-669. [16] j. acosta, aprendizaj particion difusa para razonamiento inductivo, departa denginyeria sistemes, automtica informtica industrial, universitat politecnica catalunya, barcelona, 2006. [17] p. gmez, a. nebot, f. mugica, automat construct fuzzi rule model predict central nervou system, workshop mineria dato y aprendizaj automtico en el marco la 8th iberoamerican confer artifici intelligencesevilla, 2002, pp. 23-32. [18] v. vapnik, statist learn theory, john wilei & sons, inc, new york, 1998. [19] f. girosi, m. jones, t. poggio, regular theori neural network architectures, neural computation, 7 (1995) 219-269. [20] m. pontil, a. verri, properti support vector machines, neural computation, 10 (1998) 955-974. [21] c. cortes, v. vapnik, support-vector networks, machin learning, 20 (1995) 273-297. [22] f. girosi, equival spars approxim support vector machines, neural computation, 10 (1998) 1455-1480. [23] s.r. gunn, support vector machin classif regression, isi technic report, 14 (1998). [24] a.j. smola, regress estim support vector learn machines, master' thesis, technisch universitat munchen, 1996. 30 [25] r. matlab, version 7.14. 0.739 (r2012a), mathwork natick, ma. [26] c.-c. chang, c.-j. lin, libsvm: librari support vector machines, acm transact intellig system technolog (tist), 2 (2011) 27. [27] c.-w. hsu, c.-c. chang, c.-j. lin, practic guid support vector classification, depart science, nation taiwan university, 2003.