pre-process techniqu improv detect vocal sound neonat intens care unit 1 pre-process techniqu improv detect vocal sound neonat intens care unit ganna raboshchuka,, climent nadeua, sergio vidiella pintoa, oriol ro fornellsa, blanca munoz mahamudb, ana riverola vecianab atalp research center, depart signal theori communications, universitat politecnica catalunya, barcelona 08034, spain bneonatology, hospit sant joan deu, esplugu llobregat, barcelona 08950, spain abstract sound occur noisi acoust environ neonat intens care unit (nicu) thought affect growth neurodevelop preterm infants. automat sound detect nicu novel challeng problem, essenti step investig preterm infant react auditori stimuli nicu environment. paper, present work automat detect vocal sounds, extens present nicus. propos reduc presenc irrelev sound prior detection. pre-process techniqu compared, base spectral subtract non-neg matrix factorization, combin both. vocal sound detect enhanc audio signal gener discrimin classif models. audio databas acquir real-world nicu environ assess perform detect term frame-level miss fals alarm rates. inclus enhanc pre-process step lead 17.54% rel improv baseline. keywords: neonat intens care unit, vocal detection, nois reduction, spectral subtraction, non-neg matrix factorization. 1. introduct prematur infant receiv special medic care neonat intens care unit (nicus) week month life, crucial survival. typic nicu environ acoust rich, di- vers sound produc human activ multipl biomed equip [1, 2] contribut high sound level [3]. recogn noisi nicu environ- ment compromis normal growth neurodevelop preterm infant [4, 5, 6, 7, 8] immatur brain abl adapt respond normal loud, randomli pro- duce sound variabl intens take place nicu [9]. effect nicu acoust environ preterm in- fant reveal infant reaction auditori stim- uli it, investig relat presenc correspond author: e-mail: (ganna raboshchuk) particular sound (i.e., sound ident situat time) preterm physiolog variables. note investig sound produc artificially, occur natur nicu environ on ac- tualli perceiv preterm infant. studi kind complement greatli work report literature, sound pressur level consid take account spectro-tempor properti iden- titi sound (e.g., [10]). carri statist correl studi us sound identities, larg amount label audio data required, obtain automat detect audio signals. paper, address detect vo- calizations, encompass sound produc vocal tract, infant adult (i.e., speech, cries, laugher, cough, etc.). sound frequent occur- ring nicu environ affect preterm babi [11, 12]. instance, newborn demonstr clear prefer- enc matern voic [4], calm ef- <2017>. manuscript version avail cc-by-nc-nd 4.0 licens doi 10.1016/j.bspc.2017.07.024 2 fig. 1. spectrogram audio sampl typic ventil noise. fect, shout cri affect newborn neg manner. aim detect develop auto- matic label tempor region input audio vocal sound present, i.e., specifi start end time vocal occurr specifi par- ticular type. acoust analysi audio data collect nicu show speech (i.e. foreground background voices) predomin type vocal environ- ment. multitud studi deal relat task voice/speech activ detect report lit- erature, e.g., [13, 14, 15] cite few. however, factor specif task nicu acoust environment. rich multisourc natur environment, vari- ou sound event usual place simultaneously. consider- ing vocalizations, tempor overlap sound probabl extens presence. moreover, specif type nois produc ventil equip support breath neonat spread wide frequenc rang strongli present recordings. spec- trogram typic sampl ventil nois given figur 1. differ type ven- tilat equip nicu have nois differ spectral characteristics. depend particular need preterm infant record session appropri type ventil used, fact introduc great deal variabl data. perform detect system known deterior significantli presenc background nois tempor overlap sound sourc [16, 17], nicu environ make vocal detect challenging. paper, order obtain robust detection, address above-ment factor includ pre- process step base follow techniques: 1) spectral subtraction, attenu stationari ventil noise; 2) non-neg matrix factorization, suitabl audio enhanc case non-stationari noises, segreg vocal interf sound noise. studi compar perform detect sys- tem differ pre-process scheme base tech- niqu combin appli prior detection, select scheme yield best detect results. us pre-process step evalu gener discrimin classif approach used. knowledge, work emploi enhanc techniqu appli context nicu acoust environment. rest paper organis follows. section 2 pro- vide detail pre-process step detect implement briefli describ enhanc techniqu used, section 3 contain descript de- tection itself. evalu setup experiment result present section 4 section 5, respectively. 2. enhanc techniqu 2.1. spectral subtract spectral subtract (ss) algorithm classic tool audio denois addit model assumed, i.e. noise-corrupt input signal y(n) compos clean signal x(n) addit nois signal d(n); y(n) = x(n) + d(n). then, clean signal spectrum x(n, k) esti- mate subtract estim nois spectrum d(n, k) noisi signal spectrum y(n, k) follow [18]: |x(n, k)| = |y(n, k)| |d(n, k)|, |y(n, k)| > ( + )|d(n, k)| |d(n, k)|, (1) n k are, correspondingly, frame frequenc bin index, = 1 yield magnitud = 2 yield power spectrum subtraction, subtract factor, control nois subtracted, 0 < 1 spectral floor parameter, control residu perceiv music noise. approach refer ss oversubtract (becaus usual 1) [19]. us proper nois estim d(n, k) crucial qualiti enhanc signal. often, obtain frame input audio. annot data available, guarante vo- caliz sound present begin segment. hand, ventil nois stationari present recording, propos averag spec- trum input signal nois estimate. alternatively, nois estim obtain updat input signal, take account probabl presenc speech. approach abl bet- ter deal highli non-stationari nois environments. work, emploi minima-control recursive-averag (mcra) algorithm [19], mean-squar estim nois power spectrum obtain recurs follows: |d(n, k)| = d(n, k)|d(n 1, k)| + (1 d(n, k))|y(n, k)| , (2) 3 d(n, k) smooth factor defin d(n, k) = + (1 )p(n, k). (3) here, p(n, k) speech-pres probabl calcu- late ratio smooth (with smooth factor s) noisi signal spectrum local minimum. ratio compar threshold yield binari speech-pres probabl estimate, smooth time smooth factor p. study, follow paramet setup used: process perform hann-window half-overlap 64 ms frame = 2. standard ss, = 0.01 {0...3}1, = 0 {0...1} nois estim obtain 7 frame audio record (which roughli cor- respond 200 ms); ss averag spectrum nois estimate, = 0.2 {0...1} = 0 {0...1}; ss mcra, , , d, s, p equal to, correspondingly, 1 {0...1}, 0.01 {0...0.1}, 0.2 {0.2...0.95}, 0.9 {0.7...0.95} 0.1 {0.01...0.7}. 2.2. non-neg matrix factor non-neg matrix factor (nmf) present basic form [20] proven us pattern recognit areas, automat speech recognit [21] acoust event detect [22]. basically, nmf linear decomposit techniqu attempt ap- proxim input non-neg matrix v product non-neg matrices, i.e. vfn wfr hrn , (4) r f control rank approximation. audio signal processing, nmf usual appli spectrogram signal [23], f n correspond number fre- quenci bin number frames, respectively. column w usual refer bases, row h correspond weight activ time. optim problem minim diverg be- tween input matrix approxim need solved: arg min w,h d(v ||wh) + |h|1 w,h 0 (5) d cost function (in work, kullback-leibl divergence), paramet 0 impos spar- siti constraint activations, favour solut fewer base activ given time. minim achiev updat w h multipl factor (de- rive gradient descent algorithm) converg [24]. supervis nmf approach base matrix wt train train data. gener 1the rang valu paramet optim grid search shown curli brackets. note paramet tune ex- haustiv optim paramet configurations, but, ob- serv tuning, larg improv expect gener relat techniqu perform hold. case, s sound sourc considered, base matrix train sourc separ global base matrix construct concaten wt = [w1; ...; ws ]. sourc separ step base matrix fix activa- tion matrix estim h = [h1; ...; hs ], i.e. optim problem is: arg min h d(v ||wth) + |h|1 h 0 (6) basic case, spectrum sourc obtain multipl sourc base correspond ac- tivations, i.e. vi = wihi, [1.. ]. (7) commonly, approach similar wiener filter appli reconstruct source: vi = wihi wihi v, (8) multipl divis oper element- wise [23]. consid binari vocal detect is, princi- ple, two-sourc problem sourc correspond vocal non-voc classes. global base matrix wtrain = [wv ; wnv ] consist base train class, respectively. enhanc audio signal recon- struct vocal spectra vv phase origin input audio. work, implement nmf describ [24] used, follow paramet setup: input matrix v magnitud spectrogram comput hann-window frame 32 ms length 16 ms shift. train r = 25 {25...100} base class, base correspond vector di- mension f 1. sparsiti paramet set 0.01 {0...2}. train test time us 25 iterations. 2.3. combin approach want exploit complementar exist be- tween ss nmf algorithms, investig combin techniques. firstly, try combin ss nmf ap- pli consecutively. case, audio data previous process ss order attenu ventil noise, enhanc audio train data nmf. al- ternatively, nmf appli prior ss processing. secondly, emploi nmf obtain nois spectrum es- timat |d(n, k)| ss technique. contrari nmf base pre- processing, spectrum reconstruct vocaliza- tions, obtain reconstruct spectrum vnv non- vocal or, words, irrelev sounds. column n reconstruct non-voc spectral matrix vnv , correspond time frame n, assign vector |d(n, k)| (1). advantag approach nois estim assum accurate. 4 3. detect input signal split frame ham win- dow frame length 30 ms frame shift 10 ms. 16 frequency-filt logarithm filterbank energi (ff-lfbe) featur [25] 16 tempor deriv extract frame. therefore, di- mension featur vector 32. gaussian mixtur model (gmm) base detector used, consist model vocal model non- vocalization. model singl gaussian probabl den- siti function diagon covari matrix as, exper- iments, provid better detect perform mixtur components. likelihood obtain models, frame classifi vocal non-vocalization. decis threshold chosen base equal error rate (eer) criterion, assum type error equal import frame level. addit gmms, gener classif ap- proach, perform experi emploi discrimina- tive support vector machin (svm) base classifier. svm aim maxim margin class advantag train sampl closest decis surface, benefici limit train data avail [26]. work, linear radial basi function (rbf) kernel employed. fed classifier, input featur mean- varianc normalized; mean varianc valu calcul train data appli test data. optionally, smooth (via major voting) appli string output labels. length smooth window optim regard detect perform equal 31 frames. 4. evalu setup present experiment evalu perform us- ing audio databas acquir nicu hospit sant joan deu barcelona. databas contain record session carri morn afternoon (later record possible). record nicu room design intens care preterm newborns, equip incubators. num- ber session record incub site roughli same. record session differ newborn, allow captur variabl equip (includ ventil equipment). activ place nicu large, set acoust scenarios, correspond daili nurseri care relat activ (e.g. chang diaper, measur temperature), select recording. given session contain subset select scenario recordings, 1-2 min long. electret unidirect microphon connect lin- ear pcm record recordings. micro- phone place insid incubator, close infant ear, outsid incubator, approxim 50 cm tabl 1. vocal detect perform obtain baselin sys- tem. bold best score column. number gaussian post-process smooth evalu metric (%) mr = far mr far 1 32.90 29.64 29.68 2 35.40 31.19 31.23 4 36.55 32.17 32.49 8 39.33 34.15 37.23 it, usual point centr room. in- format databas acquisition, gener acoust descript nicu [27]. experi carri record databas annot total durat 40.2 min. vocal sound present 56.7% time. record acquir microphon out- incub homogen experimen- tal conditions, microphon closer vocal sources. origin 44.1 khz record downsampl 16 khz. 10-fold cross-valid scheme appli order obtain statist relev results, fold 9 record session train 1 session testing. overal metric score obtain aggregat- ing result 10 folds. note cross-valid scheme appli nmf processing, 9 session base training, appli perform separ 1 test session. pre-process scheme, classif model re-train data obtain pre-processing. detect perform evalu frame level. miss rate (mr) fals alarm rate (far) met- ric used, defin as: mr = nm nv , far = nfa nnv , (9) nm nfa number misclassifi frame vocal non-voc class, respectively, nv nnv total number vocal non- vocal frames, respectively. 5. experiment result baselin gmm-base perform present tabl 1 function number gaussian compon used. eer, correspond mr far met- ric have value, report post-process (i.e. smoothing) applied. seen increas number gaussian detriment detect per- formance; gaussian subsequ experiments. furthermore, case smooth classifi output improv detect result term metrics, yield 12% rel improv best case. tak- ing account tempor context number adja- cent frames, smooth discard sporad miss fals alarm 5 tabl 2. vocal detect perform obtain gmm-base pre-process step. bold best score column. pre-process post-process smooth evalu metric (%) mr = far mr far 32.90 29.64 29.68 ss standard 33.92 30.75 31.44 ss averag 31.20 27.46 27.82 ss + mcra 29.39 26.34 25.65 nmf basic 33.56 29.99 29.97 nmf wiener 32.12 29.11 28.26 ss nmf 31.99 27.44 27.96 nmf ss 28.31 24.44 25.26 ss + nmf 33.80 30.54 30.19 errors. perform compar smooth baseline. tabl 2 show detect perform differ pre-process scheme appli prior detection. propos scheme abl improv base- line results. all, result ss nmf techniqu ap- pli separ presented. seen appli standard ss lead perform loss (by 3.74% 5.93%, relatively, term mr far, respectively). explain fact record contain vocal sound begin obtain nois es- timat accurate, caus distort vo- calizations. explan justifi optim paramet valu obtain ( = 0.01, = 0) basic correspond subtraction. hand, ss averag spectrum nois es- timat (ss average) ss mcra algorithm nois estim (ss + mcra) abl improv baselin result better nois estim obtained. case ss averag rel improv 7.35% 6.27% term mr far, respectively, show averag nois estim abl repres ventil noise. reflect higher optim valu = 0.2. ss + mcra pre-process result accur nois estimate, yield higher rel improvement: 11.13% term mr 13.58% term far metric scores. nois estim ss averag mainli captur venti- lation noise, nois estim ss + mcra, con- tinuou updating, abl captur non-stationari non-voc sounds, ss + mcra provid bet- ter results. nmf-base pre-process gain obvious. emploi basic techniqu vocal reconstruct (nmf basic) doesnt bring improv baselin re- sult; conversely, rel loss 1.18% term mr 0.98% term far obtained. hand, nmf wiener-lik reconstruct (nmf wiener), provid better sound qualiti [28], improv results, small fig. 2. det graph best perform setups. circl cor- respond eer points. extent: 1.79% 4.78%, relatively, term mr far, respectively. reason nmf perform fact strong ventil nois sound present train data vocal non- vocalizations, reduc discrimin power train bases. mention above, techniqu target differ type noises: ss suitabl reduct station- ari noises, nmf deal non-stationari noises. fact ss show better result data correl observ stationari ventil nois vastli present record and, therefore, influenc detect perform strongli interf sounds. tabl contain detect result dif- ferent techniqu combinations: ss nmf appli consecut audio signal (ss nmf nmf ss) and, also, nmf obtain nois estim ss (ss + nmf). note best setup ss nmf techniqu audio-bas combinations, namely, ss + mcra nmf wiener. ss + nmf pre-processing, nmf wiener nois estimation, paramet ss set = 0.2, = 0 frame length set 64 ms. rest case optim paramet setup obtain techniqu separ kept. best detect result obtain ss appli audio signal pre-process nmf (nmf ss); case rel improv achiev 17.54% term mr 14.89% term far. confirm com- plementar techniqu term type sound targeting. detect result altern pre- process sequenc (ss nmf) wors ss 6 tabl 3. vocal detect perform obtain svm-base system. bold best score column. pre-processing, kernel post-process smooth evalu metric (%) mr far mr far none, linear 30.65 37.60 27.83 36.59 none, rbf 30.67 37.24 27.93 36.08 nmf ss, rbf 25.09 35.2 22.07 33.94 (onli 7.42% 5.80% rel improv term mr far, respectively, compar baselin results). fact ss process introduc mu- sical nois output audio which, occur ventil noise, benefici base training. seen ss + nmf combin outperform base- line setup. attribut fact process window length ss optim nmf. detect error tradeoff (det) graph present figur 2 best perform setup ss, nmf, combin post-process applied. seen combin techniqu outperform individu oper point curv on far low. tabl 3 provid detect result svm- base classification, linear rbf kernels. ei- ther pre-process nmf ss pre-processing, gave best result gmm-base classifier, ap- plied. linear svm, paramet c, control trade-off train error margin, set 1e4 {1e5...1}. svm rbf kernel, paramet equal c = 0.05 {1e4...1}, paramet rbf set 0.001 {0.0001...0.25}. seen signific differ de- tection result type svm kernel function data, rbf kernel slightli outperform linear one. i.e., smooth post-processing, total error (mr + far) linear kernel equal 64.42%, rbf kernel equal 64.01%. similarli gmm-base sys- tem, result improv pre-process step added, overal improv somewhat smaller case. particular, rel improv term mr far equal 20.98% 5.93%, respectively. compar result type classif mod- els, gener gmm discrimin svm, seen svm-base outperform gmm- base one. total error gmm-base svm-base system equal 49.7% 56.01%, respectively. perhaps, observ strong overlap vocal non-voc class featur space. 6. conclus paper present work vocal sound detect new challeng application: automat analysi acoust environ preterm infant nicu. work focus pre-process step non-voc sound reduction. shown detect benefit introduc enhanc step, obtain de- tection error rel high complex detect problem real-world nicu environ scarciti data. binari detect vocal step correl studi shall follow detect type relev vocal sounds. futur work entail detect higher intens vocal (i.e., foreground speech shouts) parent voices, sound suppos affect preterm babi most. improv step detect system, e.g. featur extract scheme allow better discrimin vocal non-voc classes. acknowledg studi support spanish govern (tec2012-38939-c03-02, tec2015-69266-p) european region develop fund (erdf/ feder). author grate vanessa sancho torrent fran- cisco alarcon sanz work databas annotation. refer [1] s. m. a. hassanein, n. m. el raggal, a. a. shalaby, neonat nurseri noise: practice-bas learn improvement, journal maternal- fetal neonat medicin 26 (4) (2013) 392395. [2] m. d. livera, b. priya, a. ramesh, p. n. suman rao, v. srilakshmi, m. nagapoornima, a. g. ramakrishnan, m. dominic, swarnarekha, spectral analysi nois neonat intens care unit, indian jour- nal pediatr 75 (3) (2008) 217222. [3] c. krueger, s. wall, l. parker, r. nealis, elev sound level busi nicu, neonat network 24 (6) (2005) 3337. [4] l. gray, m. k. philbin, effect neonat intens care unit audi- tori attent distraction, clinic perinatolog 31 (2) (2004) 243 260, vi. [5] a. salavitabar, k. k. haidet, c. s. adkins, e. j. susman, c. palmer, h. storm, preterm infant sympathet arous associ behavior respons sound stimuli neonat intens care unit, advanc neonat care 10 (3) (2010) 158166. [6] e. m. wachman, a. lahav, effect nois preterm infant nicu, archiv diseas childhood - fetal neonat edit 96 (4) (2010) f305f309. [7] committe environment health, noise: hazard fetu newborn, pediatr 100 (4) (1997) 724727. [8] s. n. graven, j. v. browne, sleep brain development: critic role sleep fetal earli neonat brain development, newborn infant nurs review 8 (4) (2008) 173179. [9] k. a. thomas, a. uran, nicu environ sound preterm infant: update, american journal matern child nurs 32 (4) (2007) 250253. [10] p. kuhn, c. zores, t. pebayle, a. hoeft, c. langlet, b. escande, d. as- truc, a. dufour, infant born preterm react variat acous- tic environ incub minimum signal-to-nois ratio threshold 5 10 dba, pediatr research 71 (4) (2012) 386392. [11] e. mcmahon, p. wintermark, a. lahav, auditori brain develop prematur infants: import earli experience, annal new york academi scienc 1252 (2012) 1724. [12] m. caskey, b. stephens, r. tucker, b. vohr, import parent talk develop preterm infant vocalizations, pediatr 128 (5) (2011) 910916. [13] s. morita, m. unoki, x. lu, m. akagi, robust voic activ detect base concept modul transfer function noisi reverber 7 environments, journal signal process system 82 (2) (2015) 163 173. [14] s. graf, t. herbig, m. buck, g. schmidt, featur voic activ de- tection: compar analysis, eurasip journal advanc signal process 2015 (1) (2015) 115. [15] i. hwang, h.-m. park, j.-h. chang, ensembl deep neural network us- ing acoust environ classif statist model-bas voic activ detection, speech & languag 38 (2016) 112. [16] a. temko, c. nadeu, acoust event detect meeting-room environ- ments, pattern recognit letter 30 (14) (2009) 12811288. [17] w. wang (ed.), machin audition: principles, algorithm systems, 1st edition, igi global, 2010. [18] m. berouti, r. schwartz, j. makhoul, enhanc speech corrupt acoust noise, in: proc ieee intern confer acous- tics, speech signal process (icassp), vol. 4, 1979, pp. 208211. [19] p. c. loizou, speech enhancement: theori practice, 2nd edition, crc press, 2013. [20] d. d. lee, h. s. seung, learn part object non-neg matrix factorization, natur 401 (6755) (1999) 788791. [21] j. t. geiger, j. f. gemmeke, b. schuller, g. rigoll, investig nmf speech enhanc neural network base acoust models, in: proc interspeech, 2014, pp. 24052409. [22] a. mesaros, t. heittola, o. dikmen, t. virtanen, sound event detect real life record coupl matrix factor spectral rep- resent class activ annotations, in: proc ieee intern confer acoustics, speech signal process (icassp), 2015, pp. 151155. [23] f. weninger, j. le roux, j. r. hershey, s. watanabe, discrimin nmf applic single-channel sourc separation, in: proc inter- speech, 2014, pp. 865869. [24] p. ogrady, b. pearlmutter, convolut non-neg matrix factoris spars constraint, in: proc 16th ieee signal process societi workshop machin learn signal processing, 2006, pp. 427432. [25] c. nadeu, d. macho, j. hernando, time frequenc filter filter- bank energi robust hmm speech recognition, speech communica- tion 34 (12) (2001) 93114. [26] r. o. duda, p. e. hart, d. g. stork, pattern classification, 2nd edition, wiley, 2001. [27] g. raboshchuk, c. nadeu, b. munoz mahamud, a. riverola veciana, s. navarro hervas, acoust environ neonat intens care unit: initi description, detect equip alarms, in: proc interspeech, 2014, pp. 25432547. [28] p. smaragdis, convolut speech base applic super- vise speech separ 15 (1) (2007) 112. introduct enhanc techniqu spectral subtract non-neg matrix factor combin approach detect evalu setup experiment result conclus