local extend finit element method simul multi-fluid flow particl level set method accept manuscript local extend finit element method simul multi-fluid flow particl level set method k. kamran, r. rossi, e. onat pii: s0045-7825(15)00190-5 doi: reference: cma 10630 appear in: comput. method appl. mech. engrg. receiv date: 30 juli 2014 revis date: 5 2015 accept date: 6 2015 cite articl as: k. kamran, r. rossi, e. onate, local extend finit element method simul multi-fluid flow particl level set method, comput. method appl. mech. engrg. (2015), pdf file unedit manuscript accept publication. servic custom provid earli version manuscript. manuscript undergo copyediting, typesetting, review result proof publish final form. note product process error discov affect content, legal disclaim appli journal pertain. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 local extend finit element method simul multi-fluid flow particl level set method k. kamrana,, r. rossia,b, e. onatea,b acentr internacion metod numer en enginyeria (cimne), gran capitan s/n, 08034 barcelona, spain buniversitat politecnica catalunya, barcelona, spain abstract simul immisc two-phas flow eulerian mesh requir us special techniqu guarante sharp definit evolv fluid interface. work describ combin distinct technolog goal improv accuraci target simulations. all, spatial enrich emploi improv approxim properti eulerian mesh. inject solut space new featur abl correctli resolv solut vicin move interface. then, lagrangian particl level set (pls) method emploi trace evolv solut improv mass conserv properti result method. local enrich understood gener context xfem, emploi element-loc variant, allow preserv matrix graph, highli improv comput efficiency. keywords: two-phas flows, enrichment, discontinu pressure, xfem, particl level set. 1. introduct simul multi-fluid problem face main challenges. relat difficulti approxim kink jump simul field, second connect difficulti ac- curat captur track interfac dif- ferent fluid [1]. interface-track approach used, compu- tation domain adapt shape posit interface. mix lagrangian-eulerian approach [2], space-tim approach [3] pure la- grangian particl finit element (pfem) approach [4] family. wai interfac track paramet paramount import treatment jump/kink unknown fields. main drawback interface-track method need regener comput mesh distort zones. recent develop pfem cir- cumvent problem convect particl project solv fix mesh [5]. correspond author. tel.: +34 93 401 7399; fax: +34 93 401 6517 email addresses: (k. kamran), (r. rossi), (e. onate) altern approach treatment inter- face, call interface-captur method, base idea captur posit interfac keep- ing trace marker field. typic exampl approach volum fluid method (vof) level set method. interface-captur meth- od gain popular easili deal merg breaking-up interface. level set method, interfac repres implic- itli zero-level smooth function typic sign distanc function candidate. valu level-set function need exclus vicin interface, observ equat solv [6, 7]. despit effort high order spatial tempor scheme evolv distanc function, need reinitial- iz frequent soon ceas distanc func- tion. unfortunately, appear difficult con- serv interfac reiniti process lead breakdown mass conser- vation. solut propos over- come problem. [8, 9] volume-of-fluid (vof) method coupl level set method obtain second-ord techniqu gener superior method alone. particl level set (pls) method introduc [10] us lagrangian marker par- preprint submit comput. method appl. mech. engrg 4, 2015 *manuscript click download manuscript: xfem.pdf click view link refer 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 ticl rebuild level set region under- resolved. case flow undergo stretch tearing. particl seed near interfac contain local measur interfac posit correct level set function error convect reinitialization. geometr mass-preserv redist method propos [11, 12] develop unstructur meshes, avoid uniform mass-conserv correction. method comput node-wis correct narrow band close in- terfac consid mass loss/gain concentr interfac zone higher curvature. discon- tinuou galerkin (dg) method appli improv mass conserv level set method. quadrature-fre dg method develop [13] conserv form level set equat remain sta- ble level set diverg sign distanc function. unfortunately, anticip before, posit interfac space known, second challeng arises: accur approxim field cut element close inter- face. sharp definit interfac result cut ele- ments. jump materi properti larg inter- face forc involved, convent fem captur possibl jump/kink pressure/veloc fields. solut assign numer thick interfac provid smooth transit materi properti side interfac [14]. type method requir constant interfac thick- ness time. however, sharp interfac de- sired, cut element need enriched. [15] pressur local enrich interfac captur kink pressur field. [16] enrich functions, cut, introduc el- ement cross interface. function local element, linear inter- face, discontinu interfac zero element nodes. similar [15], enrich condens assembly. local enrichment, global one, particular xfem wide model multi-fluid flow [1720]. intrins xfem [21], version xfem add enrich global graph need updat interfac moves. work present local enrich pressur field coupl pl method. basi enrich taken shift xfem [22], equival [23], present tri- angular tetrahedr elements. basic insid element add enrich node condens element level. enrich seen extens on propos [15] [16] local add dofs, respectively. coupl enrich pl method captur interface. overal present residual-bas variat multiscal stabil form similar propos [15, 20]. content paper present follows. section 2 incompress two-fluid problem pre- sented. propos local enrich intro- duce section 3, section 4 devot pls. comparison xfem propos effect pl result present differ numer exampl section 5. 2. problem statement incompress navier-stok equat govern- ing two-phas motion domain written as: (tu + u u) (2su) + p = b u = 0. (1) set equat complet appropri dirichlet neumann boundari conditions. do- main split parts, denot + , follow materi properties: ((x), (x)) = { (+, +) x + (, ) x . note jump densiti interfac produc discontinu pressur gradient, jump vis- cositi caus discontinu pressure. surfac ten- sion produc jump pressur field interface. work consid effect surfac tension balanc intern forc interfac as: ( +) n = 0. intern stress domain form = pi + 2su. variat equival (1) (u, p) 2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 v q that: (tu + u u) v d + 2su : sv d p v d = b v d q u d = 0, (v, q) v q. stabil variat form obtain algebra sub-grid scale (asgs) method [24] finit calculu [25] approach. non- linear best handl implicit fashion residual-bas newton-raphson strategy. tempor discret perform second order bossak scheme [27] (or page 543 [26]). semi- discret stabil variat form problem is: ru = gu vhd + 2sun+1h : vh d pn+1h vh d + e 1 e unh vh (gu + pn+1h ) + e 2 e un+1h vh = 0 rp = qh un+1h d + e 1 e (gu + pn+1h ) qh = 0. (2) (2) term gu given by: gu = (tun+1h + un+1h un+1h bn+1), stabil paramet are, 1 = h2e 4 + 2he|ue| 2 = + 0.5he|ue|, ue characterist element length veloc vector, respectively. accur solut (2) requir modif finit element space, captur possibl kink jump expect so- lution. 3. enrich interfac cut element fix mesh, jump densiti caus kink pressur field induc jump gradient interfac figur 1: two-fluid hydrostat flow jump density. linear el- ement repres kink pressur field insid element. a) interfac pass elements, b) jump densiti element cut interface, c) exact solut (dot line) fe solut (solid line). posit (figur 1). clear simpl elements, triangl 2d tetrahedra 3d, linear approx- imat pressur repres expect kink pressure. pressur field belong anymor standard one, wai captur add enrich standard field ele- ments. remark. method describ work mainli appli physic problem domin grav- itat forces, i.e. small error pressur lead larg error velocity. therefore, improve- ment pressur approxim benefici modifi veloc approximation. numer studi perform [19] suggest advis enrich veloc approxim space improv result significantly. sever converg problem increas requir number it- erat report consequ veloc enrichment. defin enrich pressur field cut ele- ment as: peh = nnode nei p e + nnode mi(p e enr)i . (3) (peenr)i element pressur enrich associ correspond enrich basi mi. basi defin node cut element as: mi(x, t) = ni(x, t) [(x, t) (xi, t)], (4) (x, t) global enrich function ni(x, t) standard fe shape function node i. definit mi(x, t) properti mi(x, t) zero mesh node take maximum interface. zero support node facilit inter- prete new ad dof local cut element global. definit mi(x, t) ensur 3 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 kronecker- properti overal approximation. mean given node i, pressur inter- polat nodal valu node j zero support node i. enrich af- fect explicitli nodal approxim pressur zero node mesh. basi known xfem shift basi [19] literature. definit propos literature. case strong discontinu (jump pressure) sign enrich defin as: sign(x, t) = sign((x, t)) = 1 (x, t) < 0 0 (x, t) = 0 1 (x, t) > 0. (5) (x, t) level set function defin sign distanc function zero match interfac position. exact definit present section 4. similarli weak discontinu (kink pressur fields) moe et al. [28] hansbo & hansbo [23] separ propos abs-enrich shape function defin as: abs(x, t) = nnode |i|ni(x, t) | nnode ini(x, t)|. figur 2 show enrich shape functions, mi, weak strong discontinu triangular ele- ment. remark. numer result [19] suggest surfac tension considered, sign-enrich provid better result abs-enrich sufficient. sign-enrichment, larger approxim space pressur provid allow captur strong discontinu pressure. hand, know discon- tinuiti pressur appear surfac tension effect, viscos jump [29]. therefore, work consid sign- enrichments: (x, t) = sign(x, t). mentioned, enrich zero sup- port node interpret lo- cal cut element. matrix form semi- discret stabil form (2), equat (5), (4) (3), cut element written as: b bt d ( u penr ) = ( f 0 ) . (6) u vector nodal veloc pressur (a) (b) 0 0.5 (c) ab 1 -1 (d) sign -1 0 (e) msign1 -1 0 (f) msign2 0 1 (g) msign3 0 1 (h) mabs1 0 1 (i) mabs2 0 1 (j) mabs3 figur 2: a) triangular element cut interface. b) sub-el numer integration. show integr points. c) abs, d) sign, e-g) sign-enrich basi captur strong disconti- nuiti h-j) abs-enrich basi captur weak discontinuity. element, u = {u,p}, penr contain element enrich pressure. follow arrangement, matrix contain term relat origin dofs, u, matrix b contain term relat origin dof enrichments, matrix d contain term relat enrichments, penr. note that, consis- tent, enrich appli test function pressure. vector f repres bodi forc term. ex- act comput integr (2) requir modifi- cation quadratur rule. end, triangu- lar element (tetrahedr 3d) split sub-el sub-el integr rule non-cut element (see figur 2b). proce condens comput enrich pressur penr second equa- 4 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 tion (6) as: penr = d1bt u, plug equat (6) obtain, (a bd1bt )u = f, cut element. condens process valid long matrix d invertible. recal equat (2), d laplacian enrich pressur com- pute as: d = 1 e penr qenr de. definit m (4), clear that, matter interfac is, mi bound actual constant interface. result, d invert mi support tend zero. remark. enrich shape function small support typic occur interfac close node edg lead ill-condit ma- trix. approach treat problem given [3032]. work us block crite- ria propos [30] cut element en- richment consid ratio mini- mum maximum sub-volum bound user- defin constant c 1, i.e. min(ve1 ,v e 2) max(ve1 ,v e 2) < c. (7) note condensation, cut element end have dofs, u, rest ele- ment graph matrix remain un- chang interfac evolves. case convent xfem enrich global. figur 3 compar propos local enrich xfem. local case, figur 3a, cut element engag addit dof rep- resent black circl insid element. hand xfem enrich scheme, fig- ur 3b, type subdomain usual distin- guished. one, enr, compos element cut interfac node enriched. second subdomain, penr, element node enriched, subdomain collect element standard dof with- enrichment. xfem, interfac moves, new element cut new global dof need considered. mean graph matrix as- sembl need recomputed, costli larg problems. remark. note xfem provid continu- ou pressur field node inter-el boundaries, local enrich con- tinuou node (thei zero nodes) inter-el boundaries. irregular pressur accept pressure, appear (2), belong l2() space requir control derivatives. (a) element enrich (b) xfem figur 3: schemat view condens element enrich xfem. a) local enrichment. solid point repres con- dens pressur dof cut element. b) subdomain contain enriched, partial enrich standard (non-enriched) element enrich node (solid nodes) xfem terminology. remark. similar local enrich add en- richment cut element two, interface, exist literature. modif [15] suggest interpol pressur as: peh = nnode nei p e + n e enr p e enr, nnode number node element nenr new enrich function ad 5 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 element cut interface. function con- stant gradient interfac zero support nodes. nenr defin level set valu element node as: nenr = 0.5(| nnode nei i| + nnode nei |i|). definit nenr similar definit ab shown figur 2c. note function directli enrich shape function xfem defin mi. enrich propos [15] suffer insta- bilities. idea propos captur kink pressur field ad dof perfectli work 1d problems. however, 2d 3d sit- uation enrich suffici captur correct pressur field actual enrich cut edg appropriate. intuitively, long edg cut height, enrich suffici deviat occur edg cut differ height, enrich- ment needed. 3d problem number cut edg reach tetrahedra, gener enrich cover case enrich- ment node. propos local xfem satisfi requir node enriched, time take advantag condens avoid chang graph matrix common con- vention xfem. follow section review interfac cap- ture techniqu base level set method. iter consid multi-fluid solver interfac captur one. time step, interfac move step predic- tor multi-corrector fluid solver performed. contrast sophist coupl strategi present [33] [19]. 4. particl level set (pls) method underli idea level set method repres interfac zero-level set higher dimension function (x, t). function scalar substanti reduc complex describ interface, especi undergo topolog chang pinch merging. level set function (x, t) defin smooth function posit region neg other. motion interfac determin ve- lociti field, u, function position, time geometri interface, given externally, instanc solut navier-stok equat (1). advect equat interfac evolut is: t + u = 0. (8) level set equat order hyperbol pde need solv near interface. common choic level set function sign distanc interfac || = 1. ensur level set smoothli vari function suit high order accur numer methods. techniqu solv level set equat (8) space time [6, 7]. despit high order tempor spatial approxi- mation level set equation, instabl ap- pear level set ceas sign distanc function. situat occur presenc larg topolog chang interfac vicinity, common practic problems. solut reshap level set function distanc function. method, call reinitialization, shown stabil numer instabl perform frequent evolut interface. reini- tializ perform time step solv steadi state (a fictiti time ) equation: + sgn(0)( 1) = 0. (9) sgn(0) one-dimension smear signum function [14]. unfortunately, major drawback reiniti process difficulti preserv origin locat interface, lead break- conserv mass. overcom problem mass loss level set method (figur 4a), solut propos [10, 11, 13, 34]. pl [10] method us lagrangian marker parti- cle rebuild level set region under- resolved. case flow undergo stretch tearing. set massless marker par- ticl place near interfac set, pos- itiv particles, > 0 region set, neg particl < 0 region (figur 4b). unnecessari place particl far interfac greatli reduc number particl need simulation. region near interfac con- sider region cover element corner distanc inferior time element size. work 10 particl seed 6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 tetrahedr element, differ 4d (d dimension) particl propos origi- nal work cubic element [10]. consid cubic element divid 6 tetrahedra choic 10 particl reasonable. placement massless particl zero-level set test seen figur 4b. figur 4c pl solut revolut shown. (a) (b) (c) figur 4: particl level set (pls) method [10]. a) mass gain/loss standard level set solut revolution. b) placement massless posit (blue) neg (red) particl in- terfac zalesak test. c) pl solut revolution. purpos interfac reconstruct radiu rp assign particl function dis- tanc interface. radiu bound min- imum maximum valu base mesh size near interfac (0.1d < rp < 0.5d , d mean mesh size). note radiu provid local mea- sure interfac position. particl seed radiu adjusted, level set equat (8) in- tegrat forward time. then, particl advect evolut equat dxp dt = u(xp), (10) xp posit particl u(xp) velocity. particl veloc interpol veloc underli grid. remark. work us second order crank- nicolson method time step level set equat (8). particl evolut equat (10) in- tegrat time sub-step techniqu 10 sub-step considered. smooth resolv region flow level set method highli accurate, particl drift non-trivi distanc interfac allow maintain high order accur level set solution. instead, under-resolv region particl wrong interfac radius. defin particl escap particl cross interfac radius. escap particl reconstruct level set function under-resolv regions. end, local level set function defin escap particl mean radiu associ particl as: p(x) = sp(rp x xp ), (11) sp sign particle, i.e. 1. level set defin local corner el- ement contain escap particl seen particl predict valu level set function corner element. variat p indic possibl error level set solution. escap posit particl rebuild > 0 region escap neg particl re- build 0 region. example, > 0 region escap posit particle. equat (11), p valu grid point element con- tain particl calculated. p compar local valu maximum valu taken +. escap pos- itiv particl creat reduc error represent > 0 region. is, given level set set escap posit particl e+, initi + grid point calcul + = max pe+ (p, +). note oper escap posit particl ps calcul el- ement contain escap particles. similarli neg region, 0, initi calcul = min pe (p, ). + agre error par- ticl level set solut interpol errors, etc. merg + singl level set valu set valu + magnitud grid point, = { + |+| 6 || |+| > ||. minimum magnitud reconstruct interfac (instead of, example, take average), give prioriti valu closer in- terface. pl method capabl correct er- ror reinitialization. reinitializa- 7 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 tion step, particl move conserv zero- level set error reiniti scheme correct them. reiniti cor- rection steps, radii particl adjust ac- cord current valu (xp). summari order oper time step pl method follows: solv level set equat (8) par- ticles. correct error level set function parti- cles. reiniti distanc function correct error particles. adjust particl radii. rese particles, necessary, uniform distribution. propos local xfem loos coupl pl method perform numer exampl shown follow section. time step interfac moved, step predictor multi-corrector fluid solver performed. 5. numer exampl follow exampl solv tetrahedr mesh surfac tension considered. regard- ing pl method, maximum seed distanc limit 3h, h maximum edg size. constant enrich criteria eq. (7) taken c = 104. 5.1. rayleigh-taylor instabl singl mode rayleigh-taylor instabl consid- er studi interfac captur techniqu coupl enrich method. instabl occur heavi fluid acceler light graviti forces. author xfem stabil method coupl level set method hexahedr element simula- tion phenomenon [20, 35]. rectangular do- main = [l h] l = 0.5 m h = 4 m extrud direct element thick- ness h = 0.015625 m. domain uniformli dis- cretiz 49152 tetrahedra (32 256 1 cubes, divid 6 tetrahedra). insta- biliti trigger co form deviat am- plitud 0.05 horizont interfac fluids, z = 0.05cos(2x). heavi fluid densiti + = 3 kg/m3 dynam viscos + = 0.0135 kg/(ms) light fluid = 1 kg/m3 = 0.0045 kg/(ms). gravit acceler magnitud g = 10 m/s2 z di- rection considered. similar dimensionless reynold number, = ghl+/+ = ghl/ = 500 atwood number, = + ++ = 0.5, [20, 35] obtained. slip boundari condit consid walls, no-slip condit wall zero pressur prescrib upper wall. surfac tension consid fix time step t = 0.01 used. figur 5 show evolut interfac differ instanc format instabil- ity. result compar result ob- tain [20, 35] hexahedr mesh size. maximum mass fluctuat approxim 0.12%. [20] mass fluctuat 0.10% [35] mass fluctuat 0.07% observ second- order level-set scheme. (a) 0.5 s (b) 0.8 s (c) 1.1 s (d) 1.25 s (e) 1.5 s figur 5: rayleigh-taylor instability. a-c) show evolut interfac breaks. d-e) show particl involv interfac reconstruct concentr near interface. note mesh low resolut captur underli structure. 5.2. slosh tank abil propos enrich method model free surfac behavior studi example. 8 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 comput domain rectangl dimens [0, 1] [0, 1.5] xz plane extrud length 0.0125 y direction. [80 120] divi- sion xz plane result uniform mesh 57600 tetrahedra. interfac separ phase initi given sinusoid wave amplitud equal 0.1 as, z = 1.01 + 0.1sin((x 0.5)). level set initi distanc sinusoid inter- face. densiti fluid + = 1.0 kg/m3 = 1000.0 kg/m3 dynam viscos + = 0.01 kg/(ms) = 1.0 kg/(ms). consid- er g = 1 m/s2, non-dimension froud reynold number 1 1000, respectively. slip boundari condit consid walls, wall consid no-slip pres- sure fix zero wall. time step t = 0.0075 s end time 20 s. posit free surfac underli pressur shown figur 6. time histori height in- terfac right wall shown figur 7 compar xfem. seen viscou damp amplitud height de- creases. mean frequenc oscil 0.277 hz, agre report valu 0.279 [36] 0.274 [20]. note exampl differ observ result level set pl methods. explain tear merg- ing interfac occur volum con- serv level set method. 5.3. rise bubbl rise deform 2d 3d bubbl vertical, rectangular contain consid absenc surfac tension. densiti water air taken be, 1000.0 kg/m3 1.226 kg/m3, re- spectively. viscos surround water taken 0.35 kg/(ms), viscos air in- bubbl 0.00358 kg/(ms). valu result jump approxim equal 1000 densiti 100 viscosity. initi diamet bub- ble d = 0.05m g = 9.81 m/s2. 2d case width height rectangular domain consid 2 time 4 time bub- ble diameter, respectively, result rectangu- lar domain [0.1 0.2]. extens di- mension consid element thickness. paramet reynold number, defin = d gd , 100. eotvo number, e = g(wa)d 2 , tend infin surfac tension consid ( = 0). paramet format skirt bubbl report [37, 38]. uniform tetrahedr mesh size 0.0025 consid (40 80 1) time step increment equal 0.002 s. pressur assign zero wall slip boundari con- dition consid walls. figur 8 show interfac posit pressur field instanc deform (a) (b) 0.0 s (c) 1.8 s (d) 3.6 s (e) 5.4 s (f) 10.8 s (g) 16.2 s figur 6: isocontour pressur posit interfac (solid surface) instanc sloshing. 9 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 0 5 10 15 20 0.90 0.95 1.00 1.05 1.10 1.15 time hsl h ei gh t hm l figur 7: time histori interfac posit right wall. solid line show result obtain xfem dot line local xfem proposed. (a) 0.0 s (b) 0.05 s (c) 0.1 s (d) 0.15 s (e) 0.2 s (f) 0.22 s figur 8: bubbl rising. isocontour pressur posit interfac (solid surface) instances. bubble. result good agreement report [33, 36] larg eotvo numbers. 5.3.1. 3d paramet 2d case con- sider 3d case. comput domain box [0.1 0.1 0.2] m, uniformli discret tetrahedra size 0.0025. surfac tension consid time step equal 0.002 s. result similar obtain [33, 38] = 100 larg eotvo number obvious differ result obtain [20], set exactli match reference. simul car- ri [33, 38] larg densiti ratio, 1000, small surfac tension suggest deform bubbl sphere ellipt cap extend bell shape eventu end pierc surfac shown figur 9. impor- tanc pl method mass conserv seen figur 10 volum fluctuat per- centag bubbl compar pure level set pl methods. observ level set method correct preserv volume, pierc surfac appear similar result obtain [20]. 0.02 0.04 0.06 0.08 0.10 0.12 0.14 -1.2 -1.0 -0.8 -0.6 -0.4 -0.2 0.0 time hsl volum fluctuat level set particl level set figur 10: bubbl volum fluctuat percentage, (100 vv0v0 ), com- pare level set pl methods. 5.3.2. coalesc coalesc bubbl 3d simul studi perform method pres- enc multipl interfac [33]. bubbl densiti viscosity, b = 1 kg/m 3 b = 0.00025 kg/(ms), surround fluid densiti f = 10 kg/m 3 viscos b = 0.0005 kg/(ms). symmetri better appreci interior sur- face bubbles, forth model consid- er only. figur 11 show initi posit bubbl simul box. lower upper bubbl radiu rl = 0.1 m ru = 0.15 m, respectively. distanc center bubbl 0.3 m lower bubbl place 0.25 m awai wall. box dimens [0.5 m0.5 m1 m] discret uniformli tetrahedra size 0.01. pressur fix wall box slip condit appli rest 10 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 (a) 0.0 s (b) 0.042 s (c) 0.072 s (d) 0.102 s (e) 0.122 s (f) 0.132 s figur 9: bubbl rise 3d. pressur posit interfac (solid surface) instances. cut plane pass middl bubbl inner structure. 11 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 walls. set exampl similar propos [33]. figur 11: initi posit bubbl zoom pressur field near bubbl zone. bubbl lighter surround water rise time. pressur gradient impos interfac bubbl travel faster compar one. however, lower bubble, wake larger one, tri fast (figur 12b). time evolv upward move jet produc volum bubbl affect bubbl transient motion shape. lower bubbl de- form spheric ellipt shape similarli sin- gle bubbl behavior. evolut interfac seen figur 12. bubbl develop toroid shape t = 0.21 s portion small bubbl catch portion larger bubble. figur 13a show interfac posit merg bubbl pressur field diag- onal cut domain. underli particl seen figur 13b, red particl bubbl particl (neg distance) blue on surround fluid particl (posit distance). fig- ur 13c particl radii local measur interfac shown particl near inter- face. 6. conclus propos local xfem method solv two-fluid flow problems. pressur field enrich discontinu basi similar on standard xfem, condens element level. wai advantag stabil obtain (a) 0.05 s (b) 0.1 s (c) 0.14 s (d) 0.17 s (e) 0.21 s figur 12: coalesc bubbles. cut plane pass diagon comput box. (a) (b) (c) figur 13: coalesc bubbl t = 0.226 s. a) interfac posit pressur field. b) distribut posit nega- tive particles. c) particl radiu counter particl near interface. xfem enrich time avoid chang graph matrix interfac moves. differ detect result ob- tain method obtain standard xfem two-fluid flow. overcom mass loss/gain level set, pl method cou- pled local xfem. benchmark prob- lem solv tetrahedr meshes. nu- meric result compar obtain standard xfem hexahedr meshes. 12 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 acknowledg support research grant project realtim safecon european research council (erc) support secretari univers research ministri econ- omi knowledg govern catalonia cofund programm mari curi action 7th r&d framework programm european union. refer [1] tayfun e tezduyar. cfd method three-dimension com- putat complex flow problems. journal wind engineer- ing industri aerodynamics, 81(1):97116, 1999. [2] thoma jr hughes, wing kam liu, thoma k zimmer- mann. lagrangian-eulerian finit element formul in- compress viscou flows. method appli me- chanic engineering, 29(3):329349, 1981. [3] te tezduyar, mittal behr, s mittal, j liou. new strat- egi finit element comput involv move bound- ari interfacesth deforming-spatial-domain/space-tim procedure: ii. comput free-surfac flows, two-liquid flows, flow drift cylinders. method appli mechan engineering, 94(3):353371, 1992. [4] s.r. idelsohn, e. onate, f.d. pin. particl finit el- ement method: power tool solv incompress flow free-surfac break waves. intern journal numer method engineering, 61(7):964989, 2004. [5] sergio r idelsohn, julio marti, pablo becker, eugenio onate. analysi multifluid flow larg time step us- ing particl finit element method. intern journal numer method fluids, 2014. [6] stanlei osher chi-wang shu. high-ord essenti nonoscillatori scheme hamilton-jacobi equations. siam journal numer analysis, 28(4):907922, 1991. [7] stanlei osher ronald fedkiw. level set method dy- namic implicit surfaces, volum 153. springer, 2003. [8] mark sussman. second order coupl level set volume-of- fluid method comput growth collaps vapor bub- bles. journal comput physics, 187(1):110136, 2003. [9] christoph e kees, ido akkerman, matthew w farthing, y bazilevs. conserv level set method suitabl variable-ord approxim unstructur meshes. jour- nal comput physics, 230(12):45364558, 2011. [10] dougla enright, ronald fedkiw, joel ferziger, ian mitchell. hybrid particl level set method improv inter- face capturing. journal comput physics, 183(1):83 116, 2002. [11] fernando mut, gustavo c buscaglia, enzo dari. new mass-conserv algorithm level set redistanc unstruc- ture meshes. mecanica computacional, 23:16591678, 2004. [12] roberto f ausas, enzo dari, gustavo c buscaglia. geometr mass-preserv redistanc scheme level set function. intern journal numer method fluids, 65(8):9891010, 2011. [13] emili marchandise, jean-francoi remacle, nicola chevaugeon. quadrature-fre discontinu galerkin method level set equation. journal comput physics, 212(1):338357, 2006. [14] mark sussman, peter smereka, stanlei osher. level set approach comput solut incompress two-phas flow. journal comput physics, 114(1):146159, 1994. [15] ah coppola-owen r codina. improv eulerian two- phase flow finit element approxim discontinu gra- dient pressur shape functions. intern journal numer- ical method fluids, 49(12):12871304, 2005. [16] roberto f ausas, gustavo c buscaglia, sergio r idelsohn. new enrich space treatment discontinu pres- sure multi-fluid flows. intern journal numer method fluids, 70(7):829850, 2012. [17] jack chessa ted belytschko. extend finit element method two-phas fluids: flow simul modeling. journal appli mechanics, 70(1):1017, 2003. [18] sven gro arnold reusken. extend pressur finit element space two-phas incompress flow surfac tension. journal comput physics, 224(1):4058, 2007. [19] hen sauerland thomas-pet fries. extend finit element method two-phas free-surfac flows: sys- temat study. journal comput physics, 230(9):3369 3390, 2011. [20] u rasthofer, f henke, wa wall, v gravemeier. ex- tend residual-bas variat multiscal method two- phase flow includ surfac tension. method ap- pli mechan engineering, 200(21):18661876, 2011. [21] thomas-pet fri ted belytschko. intrins xfem: method arbitrari discontinu addit un- knowns. intern journal numer method en- gineering, 68(13):13581385, 2006. [22] ted belytschko, nicola moes, shuji usui, chandu parimi. arbitrari discontinu finit elements. intern jour- nal numer method engineering, 50(4):9931013, 2001. [23] anita hansbo peter hansbo. unfit finit element method, base nitsch method, ellipt interfac prob- lems. method appli mechan engineering, 191(47):55375552, 2002. [24] ramon codina. stabil finit element method general- iz stationari incompress flows. method ap- pli mechan engineering, 190(20):26812706, 2001. [25] e. onate. deriv stabil equat numer solut advective-diffus transport fluid flow prob- lems. method appli mechan engineer- ing, 151(1-2):233265, 1998. [26] t.j.r. hughes. finit element method: linear static dy- namic finit element analysis, volum 65. dover publications, 2000. [27] wl wood, m bossak, oc zienkiewicz. alpha modifica- tion newmark method. intern journal numer method engineering, 15(10):15621566, 1980. [28] n moes, m cloirec, p cartraud, j-f remacle. com- putat approach handl complex microstructur geome- tries. method appli mechan engineering, 192(28):31633177, 2003. [29] sergio r idelsohn, monica mier-torrecilla, norberto nigro, eugenio onate. analysi heterogen fluid jump viscos discontinu pressur field. comput mechanics, 46(1):115124, 2010. [30] hen sauerland thomas-pet fries. stabl xfem two-phas flows. comput & fluids, 87:4149, 2013. [31] arnold reusken. analysi extend pressur finit ele- ment space two-phas incompress flows. comput visual science, 11(4-6):293305, 2008. [32] eric bechet, h minnebo, n moes, b burgardt. improv implement robust studi x-fem stress 13 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 analysi cracks. intern journal numer method engineering, 64(8):10331056, 2005. [33] sunitha nagrath, kenneth e jansen, richard t lahei jr. comput incompress bubbl dynam stabi- lize finit element level set method. method ap- pli mechan engineering, 194(42):45654587, 2005. [34] mark sussman elbridg gerri puckett. coupl level set volume-of-fluid method comput 3d axisymmet- ric incompress two-phas flows. journal comput physics, 162(2):301337, 2000. [35] emili marchandis jean-francoi remacle. stabil finit element method discontinu level set approach solv phase incompress flows. journal compu- tation physics, 219(2):780800, 2006. [36] tp fries. intrins xfem two-fluid flows. intern journal numer method fluids, 60(4):437471, 2009. [37] jr grace. shape veloc bubbl rise infinit liquids. trans. inst. chem. eng., 51(2):116120, 1973. [38] li chen, suresh v garimella, john reizes, eddi leonardi. develop bubbl rise viscou liq- uid. journal fluid mechanics, 387:6196, 1999. 14