tec forecast base manifold trajectori articl tec forecast base manifold trajectori enriqu mont moreno 1,* id , alberto garca rigo 2,3 id , manuel hernndez-pajar 2,3 id heng yang 1 id 1 depart signal theori communications, talp research center, technic univers catalonia, barcelona, spain 2 upc-ionsat, technic univers catalonia, barcelona, spain 3 ieec-cte-crae, institut destudi espaci catalunya, barcelona, spain * correspondence: tel.: +34-934016435 academ editor: version june 8, 2018 submit remot sens. abstract: paper, present method forecast ionospher total electron content1 (tec) distribut intern gnss servic global ionospher maps. forecasting2 give estim valu tec distribut base linear combin of3 previou tec map (i.e. set 2d arrai index time), comput tangent4 subspac manifold associ map. us tangent space map justified5 allow model possibl distort observ trajectori on6 tangent manifold map. coeffici linear combin observations7 tangent space estim time stamp order minim mean square8 forecast error regular term. estim time stamp adapt9 forecast short-term variat solar activity..10 keywords: total electron content; ionosphere; forecasting; tangent distance; gnss11 1. introduction12 capabl monitor forecast space weather near-earth environment, particular13 ionosphere, critic nowadays. number applic can14 benefit estim nowcast forecast ionospher state. particular, reli on15 global navig satellit system (gnss) satellit base augment system (sbas).16 fact, perturb ionospher state affect multipl system reli signal propagate17 ionospher refract media. indeed, sever ionospher disturb impli loss of18 lock gnss receiv locat earth surfac on-board leo satellites, egno performance19 degrad event [21], [2], degrad precis positioning, others. addition, monitoring20 near-earth environ help take appropri decis space launch operators21 ([4], [20]). context, decad ago european space agenc (esa) show their22 two-dai ahead predict mission planning, particular, soil moistur and23 ocean salin mission [3], [5], [1].24 method forecast ionospher paramet estim gnss data have25 develop years. instanc [6], approach esa, base extrapolation26 spheric harmon coefficients, upc approach [1], base discret cosine27 transform (dct). method estim vertic total electron content (vtec) map to28 combin predict vtec global ionospher map (gim), context of29 intern gnss servic (igs) ionospher work group (ig iono-wg).30 addition, method base neural network develop [7], [8], [9], [23],31 autocorrel autocovari procedur [10], [11], [12], linear regress [13], [14], grey32 submit remot sens., page 1 25 www.mdpi.com/journal/remotesens version june 8, 2018 submit remot sens. 2 25 model [22]. hand, method develop depend physic models,33 [24], consid jpl global ionospher thermospher model (gitm).34 tec forecast method reli time seri upc vertic tec (vtec) gims35 (label uqrg) comput tomion v1 softwar frame intern gnss service36 (igs; [36] [15]). tomion softwar mainli develop author manuscript37 (mhp) consist main versions: tomion v1, focus estim electron38 content models, base gnss dual-frequ measur ionospher tomographic39 krige interpolation; tomion v2, consist hybrid geodet tomographic40 ionospher model allow precis ionospher determin precis positioning, among41 gp radio-occult data processing, [15] , [18], [17], [16]. particular, uqrg 15-min42 resolut 1-dai latenc upc real-tim vtec map (label urtg), computed43 continu 30-second rate, ingest forecast approach. cases, gims44 provid bidimension vtec valu assum single-lay ionospher model height of45 450 consid world-wid regular grid 5 /2.5 longitude/latitud rang (i.e. 7146 latitudin 72 longitudin point account total 5112 vtec valu map). note that47 build forecast time series, map transform local-tim sun-fix reference48 frame.49 brief, wai calcul vtec valu tomion reli simultan estim the50 electron densiti valu ionospher electron content distribution, consid basi functions51 partit voxels, ambigu ionospher combin carrier phases. both52 set paramet estim forward kalman filter. then, slant total electron content53 (stec) affect gnss receiver-satellit signal estim li = l1 l2 istec + bi .54 = 2 1 1.05 = 40.3/ f 2i . bi carrier-phas ionospher ambiguity,55 estim tomion process chain deriv upc gims. addition, kriging56 interpol techniqu [16] gap lack data, given inhomogeneous57 sparsiti gnss receiv [25], [26].58 result present work obtain uqrg maps, proven59 best perform independ tec measur - jason test - altimeter60 data, independ gnss receiv -dstec test- differ ig model (for the61 details, [19]). particular, result paper deriv uqrg data years62 2014 -coincid mild 24th solar cycl maximum-, 2015 2016.63 2. justif method64 method propos evolut forecast method base bi-dimensional65 discret cosin transform (2d-dct) [1] [20]. origin decid us dct method66 analog video compress method base predict code (for instance, chapter67 8 [27]).68 analog li fact time evolut tec map understood series69 images, map index tempor index. suitabl us 2d-dct70 describ tec map smooth maps, i.e. low spacial frequency71 components. words, typic energi (> 95%) concentr normalized72 horizont vertic frequenc 1/10. properti allow forecast base a73 small subset coeffici dct transform domain, given map reconstructed74 low distortion. therefore, instead deal maps, method model the75 time evolut subset dct coeffici account tempor chang of76 gener shape ioniz zones. meant forecast basi extracted77 low frequenc compon dct span space possibl tec global map (in78 linear algebra sense). result predict correct map the79 area correspond transit differ level ionization, border these80 high-ion region (mainli case appleton-hartre anomaly). region occupi a81 version june 8, 2018 submit remot sens. 3 25 small area map, specif region contribut forecast82 error. therefore, tempor distort shape area highest ioniz not83 model locally. new forecast model inspir fact. is, border84 region repres small fraction area/map forecasted, account of85 error.86 example, present forecast differ time year differ solar87 activity. decid select differ date order error edg high88 ioniz zone occur differ level solar activity. show, effect occur a89 lesser extent model propos article. figur 1 2 correspond prediction90 dct method figur 8 tangent plane method present article. figur 191 correspond month (lower solar activity, figur 13), 2 month february.92 figur 8 comput dates.93 improv us tangent plane evid fact area an94 error 20 tecu (total electron content, defin 1 tecu=1016 el/m2) are95 locat smaller area error maps.96 figur 1. forecast mean dct method horizon 3 hours. time stamp, 2016-05-12 15:15:00 (year-month-dai hour:minute:second). current map ( upper left), futur map ( upper right), forecast (lower left), forecast error ( lower right). 97 98 version june 8, 2018 submit remot sens. 4 25 figur 2. forecast mean dct method horizon 3 hours. time stamp, 2016-02-21 13:15:00 (year-month-dai hour:minute:second). current map ( upper left), futur map ( upper right), forecast (lower left), forecast error ( lower right). order solv problem model simultan smooth region map the99 chang border high-ion region decid us differ basi (in sense100 element linear combin span subspace) allow model chang the101 border differ distort shape high-ion regions. set transformations102 allow model chang borders, small rotations, small horizont or103 vertic displacements, thicken thin borders, hyperbol (shear) distortions. the104 transform resid fact time stamp next, changes105 map border ioniz region categor mix above106 mention transformations.107 techniqu creat basi model chang border ioniz region is108 base idea deform prototypes. techniqu pattern recognit dealing109 common distort optic charact recognit (ocr) (see instance, [28], [29] [30]).110 idea assum image, case map denot p, point high dimensional111 space. 71x72 pixel map p consid point space dimens 71x72 = 5112, i.e.112 p r5112. model local chang map next, assum transformation113 s(p, ), creat image, parameter . exposit method, follow114 notat present [29].115 figur 3, diagram method. note given point p, creat trajectory116 space r5112, introduc small linear chang direct space. exampl of117 version june 8, 2018 submit remot sens. 5 25 figur 3. tangent space manifold map 2016-01-19 10:30:00 (year-month-dai hour:minute:second) figure, distortion, parameter , consist rotat map. thus, denote118 set point x r5112 rotat set sp = {x| x = s(p, )}. the119 figure, trajectori follow x, i.e. new imag obtain small rotat p, represented120 parabola, one-dimension curv embed space possibl map r5112. note121 know valu pixel map p, structur transform (in case122 rotation), character trajectori r5112 manifold, comput tangent123 vector point. tangent vector repres line intersect curv manifold at124 p, repres vector ~t. small valu , approxim s(p, ) taylor125 expans = 0:126 s(p, ) = s(p, 0) + s(p, ) + o(2) p + ~t (1) example, allow transformation, vertic translation, a127 differ trajectori dimension manifold correspond tangent vector. hence,128 tangent vectors: ~trot ~tytrans, defin tangent plane, construct order129 approxim chang map/point p transform new point tangent130 plane:131 s(p, ) p + rot~trot + ytrans~tytran (2) gener example, denot estim forecast map future132 time valu + h p+h, function current map p time plu point the133 tangent plane span set tangent vector ~tdist. tangent space ~tdist defin list134 distortions/transform listdist defin follow list:135 listdist = { x/y-translation, thickening/thinning, rotation, parallel hyperbolic, diagonal136 hyperbol }137 paramet h allow model fact forecast horizon differ from138 sampl rate. forecast horizon + h express follows,139 p+h = 0p + dlistdist d~t d (3) version june 8, 2018 submit remot sens. 6 25 criterion determin valu weight d equat 3 minimization140 l2 norm error observ + h, combin observation141 , linear combin compon tangent space ~tdist, is:142 {d|d listdist} argmin d dlistdist p+h 0p + dlistdist d~t d 2 (4) note dimens p higher number paramet d, problem is143 posed. initi model equat 4 extend improved, take account the144 fact ioniz region chang slowli time, us set previous145 map {p1, , pn} order better forecast. tangent space previou maps146 computed, combin linearli set previou maps. give rise two147 possibl strategi estim forecast:148 a) past map pi, estim valu d element tangent space mean of149 equat 3, give partial estim + h map i, p+hi . final estimation150 linear regress partial estimate.151 b) comput tangent space map {p1, , pn}, linear regression152 n map tangent space.153 linear combin follow linear combin equival single154 linear combination, note estim point view, coeffici obtain method155 a) differ on obtain b). preliminari experi (done data of156 year 2014), estim method a) allow interpret the157 forecaster, us test signific order ass number past map relev the158 forecast. method b) gave better perform rmse sense. addit insight159 obtain a) relev previou snapshot forecast future160 uniform time, i.e., relev snapshot past minutes,161 case relev snapshot hour past.162 methodolog reasons, data year 2014 train determin structure163 algorithms, data year 2015 independ valid contrast dataset, finally164 data year 2016 character perform new forecast model, i.e. results165 deriv data seen comput paramet model deciding166 structure. methodolog order diminish possibl effect overfit and167 select bias. preliminari experi test differ machin learn techniqu [32].168 select forecast algorithm evalu experiment frameworks,169 a) us histor set valu (one year) order estim paramet forecasting170 technique. method advantag larg set machin learning171 algorithms. drawback, lead complic model account all172 possibl featur time evolut maps. machin learn algorithm can173 train approach. particular evalu linear regression, lasso, clustering174 (k-means), cart neural network (mlp).175 b) us data limit number map prior current one. drawback method176 regular linear regress . methods177 need higher number examples. advantag approach deal178 fact that, ioniz pattern similar larg regions, high179 variabl both, shape, morpholog ioniz region time seri of180 maps. shape border ioniz region chang slowli rate change181 differ part border uniform. justifi introduct the182 tangent space, model local changes, estim coeffici linear183 regress local data order select relev components.184 version june 8, 2018 submit remot sens. 7 25 preliminari experi show method a) produc greater error b). we185 discard method as: neural networks, svm, cart, infeas training186 model approach b).187 evolut region highest ioniz slow tec forecast case, and188 chang differ time epoch concentr border region highest189 ionization, decid us method took account small distortions. by190 comput tangent vector (also call lie derivatives) differ kind local spatial191 distortions. tangent vector space dimens 5112 repres imag of192 71x72, forecast consist linear combin past map respect set tangent193 vector set distort (for geometr algebra detail subsections).194 3. descript tangent space method195 section, follow [29], defin equat comput tangent196 space list distort listdist defin section 2. differ implementation197 forecast tec map propos [29] ocr, smooth finite198 differ approxim derivative. case ocr, smooth means199 2d low pass filter necessari order assur smooth curvatur border the200 new template. case, test differ smooth techniques, linear low pass filters,201 total variat smoothing, result deterior performance. therefore, we202 approxim deriv finit differ smoothing: s(p,) s(p,) 203 finit differ comput second order central differ interior grid points204 map. boundari map, deriv approxim order difference205 border point (i.e tec value) correspond nearest inner grid point.206 is, interior grid point map, discret approxim comput as207 follows:208 f (x, y) x f (x + 1, y) f (x 1, y) 2 (5) and209 f (x, y) y f (x, y + 1) f (x, y 1) 2 (6) border point map, discret approxim comput as:210 f (x, y) x f (x, y) f (x 1, y) 2 (7) and211 f (x, y) y f (x, y) f (x, y 1) 2 (8) construct tangent vector possibl seven transformations:212 listtran f orm = { x-translation, y-translation, rotation, parallel hyperbol transform, diagonal213 hyperbol transform, thicken thin transform }214 defin oper refer origin coordin center map, which215 case is: (71/2, 72/2), local perturb distort denot . figur 4,216 tangent space given map (upper left) observ time stamp 2016-02-21 13:30:00217 (year-month-dai hour:minute:second). equat defin direct span the218 tangent space following:219 1. x/y-translation:220 version june 8, 2018 submit remot sens. 8 25 figur 4. compon tangent space correspond map observ 2016-02-21 13:30:00 tx : [ x y ] [ x + y ] ty : [ x y ] [ x y + ] (9) correspond lie oper defin as: lx = x ly = y221 2. rotat small angl :222 tr : [ x y ] [ x cos() y sin() x sin() + y cos() ] (10) correspond lie oper defin as: lr = y x x y223 3. parallel/diagon hyperbol transformation:224 parallel hyperbol transform defin shear transform (left), diagonal225 hyperbol transform (right) defin squeez mapping.226 tp : [ x y ] [ x + x y y ] td : [ x y ] [ x + y y + x ] (11) correspond lie oper defin as:227 lp = x x y y (parallel) ld = y x + x y (diagonal)228 4. thicken thin transformation:229 tt : [ x y ] [ x + rx y + ry ] (rx, ry) = f (x) f (x) (12) correspond lie oper defin as: lt = f (x) = ( x ) 2 + ( y ) 2230 5. scale transformation:231 version june 8, 2018 submit remot sens. 9 25 ts : [ x y ] [ x + x y + y ] (13) correspond lie oper defin as: lp = x x + y y232 3.1. transform map tangent directions233 effect map small perturb direct compon of234 tangent space summar figur 5, 6 7. figur present group maps,235 correspond differ direct tangent space. figur 5, effect of236 move map, rotat direct (left group), thicken direct (right237 group). left group map origin map (upper left), tangent map small238 rotat map, (lower) reconstruct map opposit directions. effect moving239 map posit direct tangent space, i.e. p + 0.1~t rotat slightli the240 map clockwise, neg direct anticlockwise. note shift valu = 0.1 in241 case impli notic rotation, increas background level ionization.242 analogously, tangent direct relat thickening/thin transform (right), increases243 area ioniz region ad (thickening) p + 0.1~t, reduc area (thinning), when244 subtracted, i.e. p 0.1~t. figur 6, effect scale transform (left group), shift figur 5. rotat manifold (left group) thicken manifold (right group) 2016-01-19 10:30:00 245 vertic direct (right group). effect scale transform diagon displac of246 ioniz region, effect vertic shift bare noticeable. highlight the247 size factor differ scales. practice, seen instanc figur 9, the248 valu weight dimens tangent space differ size, valu 249 valu wide range. term relat rotat small, term relat the250 y-translat higher. valu = 0.1 give rise clear rotat ioniz area figure251 5, valu bare chang map, shown figur 6 (right). case horizontal252 shift analog case vertic shift.253 figur 7, effect hyperbol (shear) transform map, accounts254 diagon deform map. note case, scale factor , increas the255 background ioniz level, model reason chang highli ioniz region.256 effect chang background ioniz level taken account forecast model257 introduc bia term forecast, intercept.258 version june 8, 2018 submit remot sens. 10 25 figur 6. scale transform (left group) y-translat (right group) 2016-01-19 10:30:00 figur 7. diagon hyperbol transform (left group) parallel hyperbol transform (right group) 2016-01-19 10:30:00 4. model forecaster259 4.1. structure260 section, present model forecast map given horizon. this261 model base idea present section 2.262 univari time seri (see, instance, [33]), forecast model consist linear263 combin past samples. case, analog consist linear combin of264 time seri n map {p1, , pn}, correspond tangent spaces. the265 select past lags, took account fact gener pattern ioniz a266 main period day. thus, map insid time window near current267 observation, select time window approxim time lag 24 hour prior the268 current map. problem model select model estim known machin learning269 version june 8, 2018 submit remot sens. 11 25 (see instanc [32], chapter 7 8). case time series, special difficult problem, due270 correl sampl presenc cyclic pattern differ origin scales.271 methodolog reasons, divid data set order decoupl process272 select structur paramet model. potenti configur the273 forecast model (i.e. set lag previou map tangent spaces), defin optim set of274 delai estim algorithm train year, i.e. 2014, valid perform for275 differ configur rmse evalu data year 2015. finally, independ data276 year 2016 left report performance. list time horizon us work is277 following: horizon = {1/2h, 1h, 2h, 3h, 6h, 24h}278 structur forecast evalu includ differ time lag prior p0 ,279 time lag center multipl 24 hour p0 . addition, possibl inclusion280 tangent maps, possibl combinations.281 interest result best perform obtain delai lag multiples282 forecast horizon, inclus neighborhood p024h.283 gener structur model forecast horizon h includ us list delay284 lag summar tabl 1.285 tabl 1. list time lag weight forecast model. note subindex d, run tangent space list listdist state output input 0 input 1 input 2 input 3 input 4 input 5 train 0 0 h 0 2h 0 3h 0 24h 0 h 24h 0 2h 24h forecast 0 + h 0 0 h 0 2h 0 + h 24h 0 24h 0 h 24h weight 0, d,0 1, d,1 2, d,2 3, d,3 4, d,4 5, d,5 figur 9, plot valu estim paramet , forecast horizon h = 1hour. plot show term correspond delai neighbourhood p024h (i.e. day) signific contribution. effect lower delai lag 48 hours, decid includ us delai improv perform valid databas (i.e. year 2015), increas significantli complex model. effect consist appear experi contribut forecast came current map, tangent space, forecast power greater lag diminish quickly. thus, context forecast limit 0 2h. order model fact global chang ionization, introduc intercept intercept. forecast mean follow formula, p+h = intercept + llistlag lp l + dlistdist llistlag d,l~t l d (14) set element tangent space summar listdist, explain the286 subsect 3.287 4.2. paramet estimation288 subsect argu criteria select estim algorithm model289 present equat 14. model consist linear combin maps, weight the290 coeffici l d,l, estim differ criteria. set structur of291 delays, valu coeffici , determin forecast step minim a292 cost function, make forecast robust respect solar maximum/minimum293 conditions. analog equat 4, minim forecast error restrict on294 possibl weights. note estim paramet near past295 map p0 time 0. specifically, order estim paramet model as296 version june 8, 2018 submit remot sens. 12 25 time indic row train tabl 1, forecast time indic the297 forecast row. note table, lower row, defin notat weights298 associ delay.299 us sampl (i.e. sampl row train tabl 1) for300 estim weight justifi empir fact perform forecaster,301 exhibit better rmse. estim paramet (i.e. training) the302 year result perform significantli worse. explan local (in the303 tempor sense) variat maps, greater contribut rel weight past304 sampl tangent space fix set weight comput long time series.305 drawback small set sampl estim paramet system306 equat underdetermin suffer problem collinearity. order307 deal problem, criterion estim paramet regularization308 term. regular term consist penal norm weights. case using309 norm l2 method known ridg regression, case norm l1 method is310 known lasso (see instanc [32] chapter 3). differ norm ridge311 regress introduc constant diagon covari matrix result uniform312 decreas valu estim parameters, lasso algorithm paramet 313 determin level sparsity, i.e. number paramet valu equal zero.314 optim criterion present equat 15, regular term d, d,lli315 correspond ridg regress li = l2, lasso li = l1. considered316 us norm l1 error term, i.e. p+h p+hi l1. norm penal small valu of317 error, influenc outlier estim weight small. problem at318 hand, us norm error term, gave higher proport map least319 neg valu tec. select l2 norm error term, give following320 cost function. implement work, result present ridge321 regress regularization, select cross-valid data year 2014.322 differ perform obtain ridg regress lasso negligible, and323 ridg regress select run time faster.324 {d, d,l} argmin d ,d,l p+h p+hi l2 + d, d,lli (15) typic exampl shown figur 8 present forecast horizon 3 hours, different325 time stamps, i.e. 2016-05-12 15:15:00 (left) 2016-02-21 13:15:00 (right). comparison purposes326 figur 1 2 exampl perform dct forecast same327 conditions. benchmark follow determin perform will328 us frozen maps, defin predict current map keep its329 vtec valu constant sun-fix refer frame, i.e. consid local-tim / latitud coordinates.330 rmse ratio forecast, frozen map forecast 76%, be331 seen figur 12 mode histogram ratio rmse. weight associated332 estim shown figur 9. note presenc posit intercept bia intercept,333 model both, contribut background ioniz differ element are334 combin linearly, possibl increas background ionization. addit note that335 main contribut forecast, come current map, strong neg component336 vertic deviation. import contribut forecast relat map at337 0 + h 24h, tangent space long vertic direction. hand contribut of338 map 1 2 hour case marginal.339 forecast map vectpr (lower right) smoother current map pnow the340 target map pfuture. addit distribut error reproduc observ borders341 ioniz region accumul error, case border error reach a342 maximum 9.5 tecus.343 version june 8, 2018 submit remot sens. 13 25 figur 8. forecast horizon 3 hour (tangent space method), time stamps, 2016-05-12 15:15:00(left group) 2016-02-21 13:15:00 (right group). group plot, current map (pnow upper left), target map (pfuture, upper right), predict error (lower left), forecast (vectpr lower right). forecast tec valu posit (in train valid years), for344 small fraction case 30 minut 1 hour forecast. case forecast 1hour,345 123 map neg pixel, total 34536 (i.e year).346 case, neg values, substitut valu frozen predict the347 latitude/longitud forecast negative.348 5. results349 section summar perform forecast base tangent350 spaces. result consist comparison error sens total tec rmse (i.e. the351 mean valu pixel map). compar forecast tangent space (which352 denot tangent space method) forecast creat consid chang map a353 sun-fix refer frame (local-tim vs latitude),which denot frozen map method.354 given time seri n maps, map time consist tecu valu xlon,lat and355 estim valu xlon,lat rmse comput as:356 rmse = 1 nlat nlon nlat lat=1 nlon lon=1 (xlon,lat x lon,lat) 2 (16) figur 10 shown comparison forecast rmse time seri tangent space357 method frozen map method interv 10 dai month march 2016.358 figur comparison method horizon 30 minutes, 1 hour, 3359 hour 1 day. rmse time seri tangent space method (red), systemat below360 frozen method (blue) case 30 min, 1 hour 3 hours, period error of361 day. case horizon 1 day, forecast error methods.362 rmse result comput mean map, mention section 2, main363 contribut error origin border highli ioniz regions. tec364 valu present subsect averag low error region borders. the365 version june 8, 2018 submit remot sens. 14 25 figur 9. weight hour forecast time 2016-02-21 13:15:00. term dpdisttime, indic tangent space s(p,dist) dist = ~tdist correspond time lag. version june 8, 2018 submit remot sens. 15 25 result repres gener behaviour algorithm, compat results366 averag entir year, shown tabl 2.367 figur 10. time evolut tec rmse, case forecast tangent space method (red), frozen map method (blue) differ horizon (see annot upper figur ) figur 11 present boxplot (see [34]) forecast error differ horizons,368 comput year. cases, 1 day, forecast error in369 term forecast rmse obtain tangent space method better frozen map. the370 proport improv summar tabl 2. improv refer the371 median value, rang error extern whisker (defin range372 quartil q1 (i.e. percentil 25%) 1.5 time interquartil range, i.e. difference373 q3 (i.e. percentil 25%) q1, is, datum greater q1 1.5 (q3q1)374 extrem given datum q3 + 1.5 iqr). seen the375 figures, dispers mean correspond tangent space method lower, the376 sens enclos smaller margin, sens systemat lower value.377 featur lower preval high valu outlier case tangent space378 method.379 figur 11. box plot tec rmse, case forecast frozen valu (left) tangent space (right), horizon (see tick label figur ) version june 8, 2018 submit remot sens. 16 25 tabl 2. ratio rmse tangent space forecast frozen map wrt actual map differ horizons. horizon 1/2h 1h 2h 3h 6h 24h ratio 84.99 % 77.65% 71.35% 69.34 % 87.23 % 95.76% tabl 2, ratio root mean squar error (rmse), tangent space method vs380 frozen map method. rmse case comput mean n , map corresponding381 year, forecast 15 minutes. rmse comput follows:382 rmse = 1 n nlat nlon n =1 nlat lat=1 nlon lon=1 (xlon,lat x lon,lat) 2 (17) tabl seen case ratio forecast rmse 100%, the383 tangent space method give lower rmse forecast mean. figur 12 histogram of384 ratio time interv 42 days. note maxima histogram coincid approximately385 mean valu shown tabl 2, low varianc skew the386 histograms. note coeffici tangent space forecast comput each387 forecast, result perform method bias solar cycle, is, have388 seen empir total rmse proport underli mean tec. the389 tangent space method better freezing, rmse depend solar cycl conditions.390 391 result differ horizon perform follow convex shape, a392 minimum error 3 hour horizon. particular perform 1/2 hour 6 hours, has393 mean valu 85%, wors horizon {1, 2, 3}hours. case 1/2 hour394 fact rate chang state ionospher slow, horizon395 small room improv forecast. small chang state ionosphere396 reflect fact rmse freez mean 2 tec, lower at397 forecast horizon seen figur 10. interestingli histogram shown figur 12,398 number sampl error greater 100% higher case also399 upper valu higher, account fact histogram ratio between400 number small.401 trend seen figur 12 boxplots, spread forecast errors402 error increas function horizon. note reflect figur 12, the403 tangent space forecast intermedi horizon give lower limit % error, number404 sampl error greater 100% lower. indic qualiti tangent405 space forecast sens total rmse better case freezing, horizons406 24 hours.407 hand, horizon 6 hour perform degrades, compar the408 perform 1/2 hour, indic hypothesi small chang tangent space409 (see section 3.1), begin entir valid. final horizon 24 hours, performance410 differ freez maps, indic both, hypothesi underlying411 model tangent space hold, simpl linear combin past412 observ model tec map dai horizon. forecast mean of413 tangent space slightli better freez observation, figur 12 show the414 ratio perform system shape similar gaussian, mean at415 95%, standard deviat nearli 10%. hand boxplot figur 11 (left), a416 median rmse 5 tecus, acceptable. note the417 compon 24 hour relev forecast short term horizons, adequate418 version june 8, 2018 submit remot sens. 17 25 figur 12. histogram forecast rmse ratio tangent space method, frozen map method. upper left horizon 30 min, upper right horizon 1h lower left horizon 3h lower right horizon 24h. 2016-01-10 2016-02-21, total 4080 maps. forecast long horizon. is, short-term predictions, map 24 hour in419 advanc complement inform observ help improv forecast by420 make us period ioniz patters. hand, horizon directly421 24 hours, inform yield observ good forecast.422 comparison purposes, figur 13, time evolut rmse tecu a423 year differ forecast horizon (3 hours). figur consist superposit the424 instantan rmse low pass filter (zero phase, move averag cut frequency425 1/(0.5month)) time series. shape tempor evolut rmse year is426 similar forecast horizons. featur notic season compon with427 maximum activ spring autumn superpos cyclic compon period of428 28 days. case forecast mean tangent space model, differ the429 maximum minimum low pass filter version 1.5 tecus, mean valu spring430 3.5 tecus, summer 2 winter 2.5 tecus. variabl error much431 version june 8, 2018 submit remot sens. 18 25 lower summer. variabl higher expect case gaussian432 distribut (see section 5.4), local peak 6 tecu occur certain moment 14433 dai time series. test year 2014 2015, activ higher, and434 result analogous, systemat increas low pass filter rmse 1 tecus. note435 that, methodolog point view (of machin learning), analog mere indicative,436 year determin structur forecaster. figur 13. time evolut year total rmse tecu horizon 3 hours. left, frozen forecast, red time seri low pass filtered. right forcast mean tangent space method. 437 5.1. improv forecast us tangent space comparison dct forecasting438 method439 section, compar propos approach forecast use440 tangent space origin vtec map (label map only) base dct441 (dct method). cases, number free paramet model lower the442 tangent model, mean comparison equal terms. hand, possibility443 comparison equal number degre freedom us number of444 map equal number element tangent map. case, took map further445 past, increasingli differ map forecasted, increas the446 number recent maps, highli correl input given badli conditioned447 problem. improv us tangent spaces, shown tabl 3. result is448 us tangent space coeffici improv forecast result horizons, for449 24h. case (except horizon 24h) us tangent space improv result the450 dct method. 24h case explain fact tangent space model local distortions,451 account chang long range. note confid margin (standard452 deviations) shown, 34626 map comput mean valu rmse453 gave extrem small values.454 455 5.2. perform function latitude456 analyz perform algorithm function latitude. analyz the457 year 2016 set horizon 1 hour, total 34626 maps. note test year458 differ year determin valid structur forecaster. for459 version june 8, 2018 submit remot sens. 19 25 tabl 3. improv ratio rmse tangent space forecast frozen map tangent space forecast vs case tangent space maps. horizon 1/2h 1h 2h 3h 6h 24h ratio tang space method 84.99 % 77.65 % 71.35% 69.34 % 87.23 % 95.76% ratio map 89.08 % 80.90 % 76.95 % 73.07 % 91.45 % 94.08% ratio dct method 87.75 % 78.25 % 74.38 % 71.21 % 88.94 % 89.11% present result select horizon 1 hour, order perform a460 situat best worst case.461 rmse function latitud defin as; rmse(lat) = 1 n nlon n =1 nlon lon=1 (xlon,lat x lon,lat) 2 (18) xlon,lat begin section 5. figur 14, compare, latitud mean462 valu rmse tecu tangent space method vs. frozen map method. result of463 tangent space method (left) systemat lower valu rm compar frozen464 map method (right) latitudes, signific improv 30 degrees465 north 30 degre south. maximum differ 1 tecu maxima, i.e. 8466 degre north, 20 degre south. hand latitud 50 degre (north south),467 perform method similar, fact ioniz activ latitud is468 lower near equator, case rmse 1 tecu. equat there469 dip rmse profile. tangent distanc forecast better 0.5 tecus. fact that470 forecast error locat 30 degre shape profile, explained471 spacial distribut forecast error, tend locat margin ionized472 zone shown figur 8. distribut error map explain dip the473 forecast error equator. figur 15 profil root mean squar the474 valu tecus, year 2016 (left) ratio rmse tangent space method the475 frozen map method (right) year 2016. case present result function of476 latitude. figur 15 (left), mean tecu valu concentr equator, with477 mean valu case latitud near equat 25 tecus, decreas the478 latitud near poles. note comparison figur 14, tell forecasting479 error mean 10%. fact, nuanc fact forecast error is480 uniform map, distribut border ioniz map. figure481 15 (right) ratio tangent distanc forecast frozen map, show minima, locat at482 (9-20) degre north (13-25) degre south, 75%, indic us the483 tangent distanc forecast produc reduct 25% mean forecast error, regions484 higher ionization. best improvement, given crest appleton-hartree485 anomaly, equator. tangent distanc method capabl modelling486 region high tec gradients. note coeffici forecast re-estim for487 prediction, mean movement anomali track real time. the488 forecast improv region near pole lower, explain these489 region lower activ smaller rate change. figur hint possibl of490 design perform index assign differ penal error depend on491 level activ relat latitude.492 5.3. bia varianc decomposit forecast error493 analyz bia varianc decomposit forecast error, defin follows:494 given map p forecast map p, error decompos as:495 version june 8, 2018 submit remot sens. 20 25 figur 14. rmse tangent space method (left) vs. rmse frozen map method (right) function latitude. e [( p p )2] = bias[p]2 + var[p] (19) term defin as:496 bias[p] = e [ p p ] (20) and497 var[p] = e [ p2 ] e [ p p ]2 (21) version june 8, 2018 submit remot sens. 21 25 figur 15. root mean squar tecu function latitud (left). ratio rmse tangent distanc forecast error frozen forecast error (right). figur 16, show analysi contribut error var[p] (left tecus2) the498 bias[p]2 (right tecus2) function latitude. varianc forecast near equat is499 12 tecus, explain fact main contribut error appear500 concentr border ioniz regions, variat move regions. it501 seen instanc figur 8, high error valu occupi small map, local at502 edg high ioniz region. valu peak reach order 9 tecus, while503 error inner part lower, order 1 tecu. therefore, observ variance504 understood varianc gaussian distribution, varianc bimodal505 distribution.506 version june 8, 2018 submit remot sens. 22 25 hand, forecast unbias (see figur 16 right), contribution507 bia total error 0.1%. note figur differ scale.508 explan low bia tangent distanc forecast error associ most509 effect set paramet describ degre freedom system. note section 4.2, we510 comment dealt fact estim paramet undetermined.511 figur 16. decomposit forecast error varianc var[ f (x)] (left) vs bia bias[ f (x)]2 (right). note unit tecus2 5.4. histogram forecast error512 histogram forecast error tecu shown figur 17. histogram computed513 pixel 34626 maps, give number sampl greater 166 million, is514 size map time number maps,i.e. 72x72x34626. particular, high error valu are515 version june 8, 2018 submit remot sens. 23 25 tabl 4. empir fraction valu greater tecu valu . tecu 2 4 6 8 10 12 prob ( > tecu ) 1.95 1001 1.48 1002 9.84 1004 1.21 1004 2.81 1005 8.16 1006 locat border highli ioniz regions, account tail error histogram. in516 log frequenc histogram distribut follow approxim line, be517 describ :518 log10(tecu = t) = 1.27t + 1.04, p-valu 1.e87. empir distribut approxim laplac distribut (with = 0.78): ftecu(tecu = t) e 1.27t (22) linear law fail valu rmse greater 10 tecus, explain fact that519 extrem exampl error greater value. linear approxim fails520 valu rmse lower end, < 0.75 tec values. empir cumul fraction error figur 17. normal log frequenc histogram forecast rmse. 521 greater given tecu valu present tabl 4. interestingly, accumul probability522 diminish fast, prob( > 4tecus) lower 1 65 pixels, prob( > 8tecus) is523 lower 1 8000 pixels. however, explain section 5.3, extrem valu error are524 isol border highli ioniz regions.525 526 6. conclusions527 paper, present forecast method tec maps, base local information528 model possibl local distortions. addit previou map prediction,529 decomposit space span compon tangent manifold maps.530 physic justification, chang horizon 6 hour consist small changes531 trajectori follow sequence. perform accept forecast532 horizon 6 hours. horizon 24 hours, perform differ freezing533 maps, indic both, hypothesi underli model tangent space not534 hold time horizon, simpl linear combin past observ is535 model tec map dai horizon. explain horizon, the536 chang ioniz extern origin deriv time series.537 version june 8, 2018 submit remot sens. 24 25 author contributions: methodology, e.m.m., a.g.r, m.h.p. h.y.; software, e.m.m. a.g.r; validation,538 e.m.m., a.g.r, m.h.p. h.y.; formal analysis, e.m.m., a.g.r, m.h.p. h.y.; data curation, a.g.r;539 writingreview & editing, e.m.m. a.g.r.540 funding: research fund project tec2015-69266-p (mineco/feder, ue).541 acknowledgments: author grate intern gnss servic (igs; [36]) providing542 gnss open-data ionospher open-products.543 conflict interest: author declar conflict interest.544 references545 1. garca rigo, a., mont moreno,e., hernndez pajares,m., juan,j. m., sanz,j., aragn angel,a. salazar,d.546 global predict vertic total electron content ionospher base gp data. radio scienc 46,547 no. 6. 2011548 2. bniguel, yannick, iurii cherniak, alberto garcia-rigo, pierrick hamel, manuel hernndez-pajares, roland549 kameni, anton kashcheyev et al. monitor ionospher network: case studi scintil and550 electron content variability. annal geophysicae, vol. 35, no. 3, p. 377. copernicu gmbh, 2017.551 3. silvestrin, pierluiggi, michael berger, yann kerr, jordi font. esa second earth explor opportunity552 mission: soil moistur ocean salin mission-smos. ieee geoscienc remot sens newsletter553 118 (2001): 11-14.554 4. garca-rigo, a., d. roma-dollase, m. hernndez-pajares, h. lyu, z. li, n. wang, m. terkildsen et al.555 contribut real time near real time ionospher monitor iag rtim-wg. iag-iaspei joint556 scientif assembly. 2017.557 5. statu ig ionospher product futur developments. ig analysi center workshop (2008)558 6. schaer, s., socit helvtiqu de scienc naturelles. commiss godsique. map predicting559 earth ionospher global posit system. institut fur geodesi und photogrammetrie, eidg.560 technisch hochschul zrich. (vol. 59)561 7. cander, lj r., m. m. milosavljevic, s. s. stankovic, s. tomasevic. ionospher forecast techniqu by562 artifici neural network. electron letter 34, no. 16 (1998): 1573-1574.563 8. francis, n. m., p. s. cannon, a. g. brown, d. s. broomhead. nonlinear predict ionospheric564 paramet fof2 hourly, daily, monthli timescales. journal geophys research: space physic 105,565 no. a6 (2000): 12839-12849.566 9. tulunay, ersin, erdem turker senalp, sandro maria radicella, yurdanur tulunay. forecast total567 electron content map neural network technique. radio scienc 41, no. 4 (2006).568 10. muhtarov, plamen, ivan kutiev. autocorrel method tempor interpol short term569 predict ionospher data. radio scienc 34, no. 2 (1999): 459-464.570 11. dick, m. i., m. f. levy, l. r. cander, i. kutiev, p. muhtarov. short-term ionospher forecast over571 europe. iee nation confer antenna propagation, 1999. pp. 105-107. iet, 1999.572 12. stanislawska, iwona, zbigniew zbyszynski. forecast ionospher quiet disturb fof2573 valu singl location. radio scienc 36, no. 5 (2001): 1065-1071.574 13. muhtarov, p., i. kutiev, lj r. cander, b. zolesi, g. franceschi, m. levy, m. dick. european ionospheric575 forecast mapping. physic chemistri earth, c: solar, terrestri planetari scienc 26, no.576 5 (2001): 347-351.577 14. krankowski, andrzej, nadegda p. sergeenko, lubomir w. baran, irk i. shagimuratov, marina v. rogova.578 short-term forecast total electron content.artifici satellit 40 (2005): 137-146.579 15. hernndez-pajares, m., juan, j. m., sanz, j. new approach global ionospher determin using580 ground gp data. journal atmospher solar-terrestri physics, 61(16), 1237-1247.581 16. ors, r., hernndez-pajares, m., juan, j. m., sanz, j. improv global ionospher vtec map by582 krige interpol technique. journal atmospher solar-terrestri physics, 67(16), 1598-1609.583 17. ors, r., hernndez-pajares, m., juan, j. m., sanz, j., garca-fernndez, m. perform different584 tec model provid gp ionospher corrections. journal atmospher solar-terrestri physics, 64(18),585 2055-2062586 version june 8, 2018 submit remot sens. 25 25 18. hernndez pajares, m., juan, j. m., sanz, j., colombo, o. l. applic ionospher tomographi to587 real time gp carrier phase ambigu resolution, scale 400 - 1000 high geomagnetic588 activity. geophys research letters, 27(13), 2009-2012.589 19. roma-dollase, david, manuel hernndez-pajares, andrzej krankowski, kacper kotulak, reza590 ghoddousi-fard, yunbin yuan, zishen li et al. consist seven differ gnss globl ionospheric591 mpping techniqu solr cycle. journal geodesi (2017): 1-16.592 20. garca rigo, a. (2012). contribut ionospher determin global posit system: solar593 flare detect predict global map total electron content. phd thesis, upc594 21. hernndezpajares, m., j. m. juan zornoza, j. sanz subirana, r. farnworth, s. soley.(2011) egno test595 bed ionospher correct octob novemb 2003 storms, ieee transact geoscience596 remot sensing, vol. 43,no. 10, octob 2005."597 22. venkateswarlu, g., sarma, a. d. (2017). new techniqu base grei model forecast of598 ionospher gp signal delai gagan data. progress electromagnet research, 59, 33-43.599 23. huang, z., li, q. b., yuan, h. (2015). forecast ionospher vertic tec 1-h ahead genetic600 algorithm neural network. advanc space research, 55(7), 1775-1783.601 24. meng, x., mannucci, a. j., verkhoglyadova, o. p., tsurutani, b. t. (2016). forecast ionospheric602 total electron content respons high-spe solar wind streams. journal space weather space climate,603 6, a19.604 25. feltens, j., m. angling, n. jackson-booth, n. jakowski, m. hoque, m. hernndez pajares, a. aragn angel, r.605 ors, r. zandbergen. compar test ionospher model driven gp measurements.606 radio scienc 46, no. 6 (2011).607 26. hernndez-pajarez, manuel, david roma dollase, andrzej krankowski, alberto garca rigo, raul608 or prez compar perform seven differ global vtec ionospher model ig context.609 intern gnss servic workshop (ig 2016): sydney, australia februari 8-12, 2016, pp. 1-13. international610 gnss servic (igs), 2016.611 27. gonzalez, r. c., woods, r. e (2008). digit imag processing. addison-welsley612 28. simard, p., lecun, y. denker, j.s., (1993). effici pattern recognit new transformation613 distance. advanc neural inform process systems, pp. 50-58.614 29. simard, p., lecun, y., denker, j., victorri, b. (1998). transform invari pattern recognition615 tangent distanc tangent propagation. neural networks: trick trade, pp. 549-550.616 30. hastie, t. simard, p (1995). learn prototyp model tangent distance. advanc neural617 inform process system , pp. 999-1006.618 31. goodfellow, i., bengio, y., courville, a. (2016). deep learn (adapt comput machine619 learn series). adapt comput machin learn series, 800.620 32. friedman, j., hastie, t. tibshirani, r. (2001). element statist learning. springer seri in621 statistics., 800.622 33. mills, terenc c (1991). time seri techniqu economists. cambridg univers press623 34. (2018), matplotlib documentation, avail from: boxplot.html (access 1 februrari 2018)625 35. lyu, haixia, manuel hernndez-pajares, metin nohutcu, alberto garc-rigo, hongp zhang, jingnan626 liu. barcelona ionospher map function (bimf) applic northern mid-latitudes.627 gp solut 22 (2018): 1-13.628 36. dow, j. m., neilan, r., rizos, c.: intern gnss servic chang landscap global629 navig satellit systems, journal geodesy, 83, 191198, 2009.630 c 2018 authors. submit remot sens. possibl open access publication631 term condit creativ common attribut (cc by) license632 ( introduct justif method descript tangent space method transform map tangent direct model forecast structur paramet estim result improv forecast us tangent space comparison dct forecast method perform function latitud bia varianc decomposit forecast error histogram forecast error conclus refer