regular first order comput homogen multiscal analysi masonri structur nonam manuscript .
( insert editor ) regular first order comput homogen multiscal analysi masonri structur massimo petracca  luca pel  riccardo rossi  sergio oller  guido camata  enrico spacon receiv : date / accept : date abstract paper investig possibl us- ing classic first order comput homogen togeth simpl regular procedur base fractur energi micro-scale-constitu .
general geometr characterist length take account size macro-scal element well size rve ( constitu ) .
propos regular ensur object dissip energi macro-scal , respect size fe scale respect size rve .
propos method first valid bench- mark exampl , final appli numer simul experiment test in-plan load shear wall made period masonri .
massimo petracca (  ) cimn - centr internacion de metod numer en enginyeria , technic univers catalonia ( upc ) , barcelona 08034 , spain depart engin , univers `` g.d  annunzio '' chieti pescara , pescara 65127 , itali e-mail : mpetracca @ cimne.upc.edu e-mail : massimo.petracca @ unich.it luca pel  riccardo rossi  sergio oller cimn - centr internacion de metod numer en enginyeria , technic univers catalonia ( upc ) , barcelona 08034 , spain e-mail : luca.pela @ upc.edu e-mail : rrossi @ cimne.upc.edu e-mail : oller @ cimne.upc.edu guido camata  enrico spacon depart engin , univers `` g.d  annunzio '' chieti pescara , pescara 65127 , itali e-mail : g.camata @ unich.it e-mail : espacon @ unich.it keyword comput multiscal homogeniza- tion  period microstructur  strain local  characterist length  fractur energi regulariza- tion  masonri shear wall 1 introduct formul phenomenolog closed-form con- stitut law analysi heterogen quasi- brittl materi masonri still challeng- ing task [ 45 , 46 ] .
evolut macroscop prop- erti high influenc complex behavior micro-structur phenomena damaged-induc anisotropi , stress redistribut among micro-structur constitu strain local .
context , difficult take account influenc evolv- ing micro-structur macroscop properti , es- pecial strain local occur micro- structur lead complex dissip mechan structur level .
three main approach model kind heterogen materi .
first approach direct numer simul ( dns ) classic 1-scale fe model use , inform micro-structur explic- it model .
method provid best accuraci take account micro-structur influenc structur behavior .
interfac model use mul- tisurfac plastic propos [ 26 ] describ in-plan behavior masonri .
kind mod- ele , brick mortar joint explicit mod- ele , nonlinear behavior lump in- terfac element .
approach effici small-scal structur ( i.e .
structur member test laboratori ) .
deal large-scal analysi 2 massimo petracca et al .
comput cost becom unafford , well effort requir prepar geometr model .
second approach known concurr multi- scale method ( cmm ) .
multiscal model , in- volv studi multipl length scale well exchang inform among .
partic- ular approach micro-structur scale adapt insert resolv structur model , thus es- tablish strong coupl macro micro scale .
work subject found [ 24 , 25 ] , among other .
third approach known comput ho- mogen method ( chm ) .
similar cmm , base multiscal model , informa- tion obtain multipl length scale .
assum- ing length scale separ , approach establish weak coupl .
micro- structur featur physic insert structur model , case cmm , model call repres volum element ( rve ) associ integr point macroscop mesh .
rve , consid rep- resent sampl micro-structur , use obtain homogen respons macroscop strain field , thus emul equival homogen medium .
due flexibl ( assumpt made homogen constitut respons ) model use model larg class materi character complex micro-structur , linear nonlinear behavior [ 9 , 41 , 43 , 44 , 47 , 54 , 55 ] .
although classic first order chm success- fulli use model micro-structur exhibit stabl behavior , recogn give non-object result deal strain-soften materi .
fact rve loos repres upon strain local .
last year , sever modif classic chm propos , review recent develop found [ 35 ] refer therein .
approach regular re- spons rve use higher order theori macro-scal , inform mate- rial characterist length natur taken account [ 3 , 16 , 17 , 18 , 22 , 23 , 52 ] .
other , known continuous- discontinu approach , up-scal rve respons traction-separ law ( upon strain local ) use discontinu insert macro-scal model [ 6 , 8 , 30 , 31 , 32 , 33 , 37 , 39 ] .
anoth issu re- late loss repres rve choic proper boundari condit appli rve .
studi topic done [ 13 ] , novel boundari condit propos , use concept rotat period avoid cos- train crack propag orient .
context masonri model , work continuous- discontinu comput homogen found [ 30 , 35 ] model in-plan behavior ma- sonri structur , later extend studi shell element analysi out-of-plan be- havior [ 32 , 33 ] , work comput homoge- nizat use cosserat continuum macro-scal found [ 16 , 17 ] .
previous approach base first order homogeniza- tion fractur energi regular consid characterist length use microstructur con- stitut model equal characterist length macro-scal finit element [ 4 ] .
done [ 16 ] compar classic first order homogeniza- tion cosserat-bas homogen .
pa- per propos extens fractur energy-bas regular two-scal comput homogeniza- tion base classic first order continuum theori .
main aim allow usag first order computa- tional homogen analysi quasi-brittl micro-structur .
main novelti propos ap- proach resid consist definit frac- ture energi base regular , order account characterist length finit element scale , well size rve .
paper organ follow : section 2 present main concept classic comput homog- enize , without refer particular class micro-structur , sake simplic , as- sume small strain theori .
section 3 , issu in- troduc strain-soften materi describ , propos regular procedur deriv .
section 4 , first benchmark test use assess propos regular respect simpl mode fractur test .
final section 5 , attent given model masonri structur , complic test in-plan load shear wall .
2 classic first order comput homogen section give brief summari main con- cept basic equat classic first order com- putat homogen , standard first or- der continuum theori assum scale .
present work assum infinitesim strain theori .
main work-flow classic chm rep- resent figur 1 .
regular first order comput homogen multiscal analysi masonri structur 3 fig .
1 : work-flow classic comput homoge- nizat procedur defin three main step : 1 .
down-scal macro-micro transit , macroscop strain point macroscop mesh , transfer micro-scal , use appli boundari condit rve mesh ; 2 .
solut micro-scal boundari valu problem ( bvp ) , done numer method , fem consid ; 3 .
up-scal ormicro-macro transit , macro- scale stress tensor macro-scal tangent op- erat obtain via homogen procedur .
2.1 down-scal macro-micro transit macroscop strain m , point xm macro-scal domain instant , ob- tain volum averag microscop strain field  defin point x micro-scal do- main instant : m ( xm , ) = 1 v    ( x , ) dv = 1 v   su dv = 1 v   u s nda ( 1 ) n outward unit normal field rve boundari  .
assum microscop dis- placement field addit split linear part ( coars scale contribut ) fluctuat part u ( fine scale contribut ) u ( x , ) = m ( xm , ) x + u ( x , ) ( 2 ) way microscop strain field split constant part ( coars scale contribut ) fluctuat part  ( fine scale contribut )  ( x , ) = m ( xm , ) +  ( x , ) ( 3 ) insert definit microscop strain field ( eq .
( 3 ) ) definit macroscop strain field ( eq .
( 1 ) ) , one obtain : m ( xm , ) = m ( xm , ) + 1 v   su dv ( 4 ) provid minim kinemat constraint microscop displac fluctuat field sat- isfi kinemat admiss :   su dv =   u s nda = 0 ( 5 ) last step macro-micro transit defin boundari condit appli rve dis- placement fluctuat field , order micro-bvp solv .
follow work [ 34 ] , typic sub- set kinemat admiss microscop displace- ment fluctuat briefli summar follow- ing .
 zero displac fluctuat u ( x , ) = 0 x   ( 6 ) displac fluctuat vanish everi point rve domain , thus whole rve undergo uniform strain equal macro-scal strain field .
 zero boundari displac fluctuat u ( x , ) = 0 x   ( 7 ) displac fluctuat vanish bound- ari rve .
 period boundari displac fluctuat u ( x +  , ) = u ( x   , )  pair { x +  , x   }   ( 8 ) x+ x   two opposit point rve boundari  .
model constraint displace- ment fluctuat boundari rve period .
4 massimo petracca et al .
 minim constrain boundari displac fluc- tuation uniform boundari traction  ( x , ) n ( x ) = m ( xm , ) n ( x ) x   ( 9 )  ( x , ) microscop stress field .
shown [ 34 ] , distribut stress rve boundari , reactiv minim kinemat constraint given eq .
( 5 ) , satisfi eq .
( 9 ) 2.2 solut micro-scal bvp assum inertia forc neglig , prin- cipl virtual work establish rve equilibrium variat equat    ( x , ) : s dv    b ( x , )  dv    te ( x , )   da = 0   v ( 10 ) hold instant t. eq .
( 10 ) , b ( x , ) bodi forc field rve domain , te ( x , ) extern traction field boundari rve , v appropri space virtual displac  rve , subject one constraint defin 2.1 .
key ingredi definit multiscal consti- tutiv model hill-mandel principl macro- homogen [ 20 , 29 ] , energi averag theorem es- tablish macroscop stress power must equal volum averag microscop stress power rve m : m = 1 v    :  dv ( 11 ) kinemat admiss microscop strain rate field  , i.e .
( follow addit split coars scale fine scale contribut ) microscop strain rate field form :  = m +s u  u  v ( 12 ) prove [ 34 ] , hill-mandel principl equiva- lent requir bodi forc surfac traction rve pure reactiv , i.e .
reaction chosen kinemat constraint , pre- scribe independ .
way rve equilibrium reduc :    ( x , ) : s dv = 0 ( 13 ) 2.3 up-scal micro-macro transit last step homogen procedur consist find homogen macroscop stress tensor ( requir homogen tangent oper ) af- ter rve equilibrium found .
shown [ 19 , 42 ] , definit homogen stress tensor de- rive direct hill-mandel principl addit split microscop strain , as- sumption model .
insert split micro- scopic strain rate given eq .
( 12 ) , hill-mandel principl eq .
( 11 ) , follow relat obtain : m : m = 1 v    : m dv + 1 v    : s u dv  u  v ( 14 ) valid kinemat admiss u , case u = 0 , follow relat obtain : m : m = 1 v    : m dv m ( 15 ) valid macroscop strain rate field , lead- ing : m = 1 v    ( x , ) dv ( 16 ) thus homogen macroscop stress tensor obtain volum averag microscop stress field rve .
2.4 interpret comparison multiscal method alreadi mention section 1 , chm allow straight- forward interpret within framework varia- tional multiscal method ( vmm ) .
main idea consid continu displac field u decompos coars fine compon u = u+ u ( 17 ) u defin  coars  scale contribut ( i.e .
one describ coars fe mesh ) u  fine  scale contribut ( i.e .
one would correspond detail solv coars fe mesh ) .
correspond test function regular first order comput homogen multiscal analysi masonri structur 5 name w w .
use decomposit strain  : = su becom  = su+su ( 18 ) follow standard multiscal procedur [ 21 ] , one shall point introduc model obtain u .
done appli galerkin approach level fine scale give   w ( su ) dv =   wf dv    w ( su ) dv ( 19 ) defin  fine  scale problem even- tualli solv one , case , provid suitabl discret fine scale domain ( , way actual comput w ) .
problem complet one prescrib suitabl boundari condit u .
vmm communiti customari assum that  w ( su ) dv = 0 rework ( apply- ing green-gauss theorem ) give   w ( us n ) da = 0 ( 20 ) case chm , w consid discontin- uous function defin ( local integr point ) finit element discret rve .
assumpt , eq .
( 19 ) eq .
( 20 ) restrict rve volum give finit element problem  rve w   ( su ) dv =  rve wf dv   rve w   ( su ) dv ( 21 )  rve w ( us n ) da = 0 ( 22 ) interest , eq .
( 22 ) coincid call  min- imal  boundari condit u .
observ u = 0 ( rv e ) constraint u peri- odic ( rv e ) special case compli boundari condit .
observ also assumpt period u need deriv minim boundari condit .
3 fracture-energy-bas regular two-scal fe comput homogen essenti aspect numer model mesh ob- jectiv , defin requir result must independ adopt discret .
continuum exhibit strain-soften , strain local narrow zone energi dissip accord size , outsid materi unload elast .
hand , fem context , standard local continuum model use ( i.e .
materi respons comput function local strain ) , local zone relat domain ( volum area ) finit element .
thus , strain soften appear , dissip domain coincid one strip element finit ele- ment mesh , sinc dissip total energi proport size finit element , en- ergi dissip would diminish element becom smaller upon mesh refin , lead non-object result depend fe size .
solut problem , wide use , propos first [ 5 ] , later address sever author ( [ 10 , 36 , 40 ] , among other ) .
author point fem framework , concept strain soften consid characterist materi alon , sinc relat frac- ture energi gf size finit element energi dissip occur .
comput width fractur process comput element de- pend geometri dimens .
compu- tation width known element characterist length lch .
accord model , soften law depend materi fractur energi per unit crack surfac area gf element characteris- tic length lch , way follow relat hold : gf = w = w v lch = gf lch ( 23 ) w total energi dissip fractur process , crack surfac area , gf fractur energi per unit volum , v volum dissip zone .
refer notat given figur 2 , eq .
( 23 ) rewritten : gf = w ht = w htlch lch = gf lch ( 24 ) two-scal fe analysi , concept characteris- tic length parent element ( element contain- ing constitut law need regular ) 6 massimo petracca et al .
( ) strong discontinu ( b ) regular smear discontinu fig .
2 : represent displac strain field mode fractur , regular process obvious , sens non-linear be- havior generat constitut model associ domain micro-scal , dissip fi- nalli occur domain macro-scal .
one con- sider characterist length fe micro-scal , one would obtain correct dissip rve , , chang size rve size fe macro-scal , one would obtain non-object respons macro-scal .
re- quirement mesh-object correct dissip satisfi regular employ scale analysi .
suggest regular paramet constitut model use micro-scal adjust take account nest featur multiscal homogen procedur .
start point assum constitut law micro- scale regular use modifi character- istic length lch ,  , defin function char- acterist length may enter problem ( see figur 3 ) : lch ,  = f ( lch ,  , lch , , lch , rv e ) ( 25 ) lch , is characterist length fe micro-scal , lch , characterist length fe macro-scal , lch , rv e characterist length rve .
characterist length fe ( micro macro scale ) alway comput accord geometri , in- terpol integr scheme consid finit element [ 49 ] .
fig .
3 : fractur energi base regular 2-scale fem obtain definit modifi characterist length , defin energi wrv e , dissip damag domain rve : wrv e , = gf lch ,  vrv e , = gf lch ,  lch ,  t hrv e ( 26 ) vrv e , damag domain rve , hrv e length rve direct crack , t thick rve .
 smear  dissip energi whole rve domain , defin- ing equival specif fractur energi gf : gf = wrv e , vrv e = wrv e , lch , rv e hrv e t = gf lch ,  lch ,  lch , rv e ( 27 ) integr specif fractur energi dis- sipat domain macro-scal get total energi wm dissip macro-scal : wm =  gf dvm ( 28 ) wm = gf lch , hm tm ( 29 ) regular first order comput homogen multiscal analysi masonri structur 7 hm tm respect length thick crack macro-scal .
substitut eq .
( 27 ) eq .
( 29 ) , equat actual dissip energi  seek structur level w = gf hm tm ( 30 ) obtain definit modifi characterist length , use micro-scal , provid proper dissip macro-scal : wm = gf lch ,  lch ,  lch , rv e lch , hm tm = gf hm tm ( 31 ) lch ,  = lch ,  lch , lch , rv e ( 32 ) eq .
( 32 ) seen characterist length micro-scal multipli scale factor ( constant rve ) ratio characterist length parent-el macro-scal characterist length rve .
procedur regard 2-step smear discontinu : ( ) first , discontinu smear local band rve ( eq .
( 26 ) ) , width lch ,  , length hrv e ; ( ii ) , discontinu ( form local band rve ) smear local element structural-level ( eq .
( 27 ) , eq .
( 28 ) , eq .
( 29 ) ) .
[ 4 ] , modifi characterist length use micro-scal taken equal characterist length macro-scal fe .
context , howev , author deal composit made dam- ageabl matrix long fiber .
long fiber typic orient along load direct , allow damag spread wide area .
case damag distribut whole rve domain , lo- calize may happen structur level .
contrari , masonri local alreadi visi- ble rve , thus requir consid length scale regular procedur .
note howev , method propos [ 4 ] re- cover eq .
( 32 ) , set lch ,  = lch , rv e .
[ 31 ] local rve homogen toward discontinu band width equal rve characterist length .
approach propos work , correspond lch , = lch , rv e , thus leav- ing characterist length microstructur ele- ment unchang .
eq .
( 26 ) defin total energi dissip dam- age part rve , assum total length crack equal length rve crack direct ( hrv e ) , thus assum straight crack .
let  assum instead rve crack non- straight , total length equal hrv e ,  = 1 scale factor measur tortuos crack .
eq .
( 26 ) becom wrv e , = gf lch ,  lch ,  t hrv e ( 33 ) eq .
( 30 ) , refer total energi dissip real crack simul , assum straight ( crack rve ) length equal length specimen crack direc- tion hm .
consid instead non-straight crack , eq .
( 30 ) becom w = gfhm tm ( 34 ) thus eq .
( 31 ) becom wm = gf lch ,  lch ,  lch , rv e lch , hm tm = gf hm tm ( 35 ) tortuos factor  appear side equat , cancel , modifi char- acterist length defin eq .
( 32 ) remain unchang .
4 mode fractur test test report section meant assess regular capabl propos method respect simpl mode fractur test .
specimen rectangular plate state plane-stress subject uniaxi tensil load .
micro-structur assum matrix period pattern circular void ( note void emul soft linear elast materi report tabl 1 ) .
regulariza- tion respect macro-scal fe size size rve check perform analy- sis two differ macro-scal discret two differ rve sampl size , total four analys .
analys conduct without regular procedur better show differ .
detail geometri , two macro-scal mod- el , two rves , given respect [ fig- ure 4 , figur 5 , figur 6 ] , detail me- chanic properti micro-structur constitu given tabl 1 .
period boundari displac fluctuat employ multiscal analysi , sinc exampl expect crack align period direct .
8 massimo petracca et al .
local continuum damag model use describ constitut behavior matrix rve .
main concept model summar .
detail reader refer [ 10 , 12 ] refer therein .
constitut equat defin  = ( 1 )  = ( 1 ) c :  ( 36 ) stress tensor  obtain function effect stress tensor  , comput to- tal strain tensor  fourth order isotrop linear elast constitut tensor c , damag index , rang zero undamag materi , one complet damag materi .
order comput damag index , relat current ef- fectiv stress state , necessari introduc scalar measur , term equival stress  .
exampl assum rankin criterion , equival stress comput follow :  = [ + :  : + ] 1/2 ( 37 ) + posit part effect stress ten- sor , defin + = 3 i=1 ipi  pi ( 38 ) pi eigenvector associ prin- cipal stress i , symbol  macaulay bracket ( x = x , x  0 , x = 0 , x < 0 ) ,  non-dimension fourth order tensor defin  = p1  p1  p1  p1 ( 39 ) damag irrevers process , intro- duce anoth scalar quantiti , term damag thresh- old r , repres largest valu ever reach equival stress  load histori .
damag threshold r time t+t evalu r = max ( r0 , max ( rt ,  ) ) ( 40 ) rt damag threshold previous ( con- verg ) time step , r0 initi damag threshold ( one defin elast limit ) case r0 = ft .
accord , follow damag criterion introduc :  (  , r ) =   rt  0 ( 41 ) way , damag index , time interv [ , t+t ] , grow  > rt .
test damag assum evolv accord follow exponenti law : ( r ) = 1 r0 r exp { 2hdis ( r0  r r0 ) } ( 42 ) hdis discret soften paramet .
de- scribe section 3 , discret problem soften- ing law adjust accord size dissip zone ( ldis ) , way follow equat hold : gf ldis = gf ( 43 ) specif dissip energi gf , expo- nential soften law , calcul : gf = ( 1 + 1 hdis ) f2t 2e ( 44 ) discret soften paramet calcul hdis = ldis lmat  ldis ( 45 ) lmat = 2egf/f2t .
standard 1-scale fe analy- sis , ldis assum equal characterist length fe ( ldis = lch ) .
use constitut law rve 2-scale fe analysi , ldis equal modifi characterist length lch ,  , defin eq .
( 32 ) .
analysi perform use krato multi- physic [ 14 ] , free open-sourc framework devel- opment multidisciplinari solver , develop cimn , pre post-process done gid [ 1 ] , also develop cimn .
result obtain without propos regulariza- tion procedur ( figur 7a ) show four wide distinct force-displac curv .
expect , respons brittl larger rves and/or finer mesh macro-scal .
appli propos regular analys give respons ( figur 7b ) , thus show object respect macro-scal fe size rve size .
macro-scal displac field micro-scal maximum princip strain , end analysi , shown figur 8 .
regular first order comput homogen multiscal analysi masonri structur 9 properti valu ( materi 1 ) valu ( materi 2 ) unit young  modulus 14000.0 1.0 n/mm2 poisson  ratio 0.15 0.15 - type continuum damag model linear elast - tensil maximum stress 2.2 - n/mm2 tensil fractur energi 0.8 - n/mm damag criterion rankin - - soften law exponenti - - tabl 1 : materi properti 0 500 1000 1500 2000 2500 0 0.2 0.4 0.6 0.8 1 1.2 1.4 f rc e ( n ) top displac ( mm ) macro 1x1 - rve 1x1 macro 1x1 - rve 3x3 macro 2x2 - rve 1x1 macro 2x2 - rve 3x3 ( ) 0 500 1000 1500 2000 2500 0 0.2 0.4 0.6 0.8 1 1.2 1.4 f rc e ( n ) top displac ( mm ) macro 1x1 - rve 1x1 macro 1x1 - rve 3x3 macro 2x2 - rve 1x1 macro 2x2 - rve 3x3 ( b ) fig .
7 : force-displac curv : ( ) without regular ; ( b ) regular fig .
8 : macro-scal displac field - rves maximum princip strain field ( regular ) 10 massimo petracca et al .
fig .
4 : geometri model boundari condit ( ) ( b ) fig .
5 : macro-scal mesh : ( ) macro 1x1 - mesh size=1000 ; ( b ) macro 2x2 - mesh size=500 ( ) ( b ) fig .
6 : ( ) rve 1x1- size=100 ; ( b ) rve 3x3 - size=300 5 applic masonri structur .
numer model shear wall section , propos method use simu- late in-plan behavior masonri structur .
shear wall common use in-plan shear test .
consid experiment result obtain [ 48 ] refer assess capabl pro- pose approach .
first , brief descript select experiment test given 5.1 , adopt rve constitut model use micro-structur constitu describ 5.2 .
proceed multiscal simul , direct numer simula- tion ( dns ) perform check capabl constitut model emul main behav- ior masonri wall , result discuss 5.3 .
final result obtain multiscal simul compar experiment result dns result 5.4 .
analysi perform use krato multi- physic [ 14 , 15 ] , free open-sourc framework develop multidisciplinari solver , develop cimn , pre post-process done gid [ 1 ] , also develop cimn .
5.1 experiment test : tu eindhoven shear wall geometri wall ( denot w1 ) well boundari condit repres figur 9 .
wall open made one layer solid brick dimens 210mm  52mm  100mm , 10mm thick mortar joint [ 48 ] .
wall subject two load stage : ( ) first , uniform pres- sure load 0.3n/mm2 appli top wall , ( ii ) horizont load appli dis- placement control confin way , keep top wall horizont preclud vertic displace- ment .
experiment failur mechan obtain test wall shown figur 10 .
5.2 rve micro-scal constitut law wall consid section made run bond masonri , thus show period textur .
take advantag period micro-structur , pe- riodic boundari displac fluctuat ( see eq .
( 8 ) ) enforc boundari rve .
applic , assumpt period boundari fluc- tuation might enforc unphys constraint crack direct [ 13 ] .
howev , specif case masonri crack main take place follow pe- riodic geometri weak mortar joint .
sens , period assumpt spoil actual crack- ing direct , case failur bed/head joint case staircas crack .
mesh brick mortar joint consist structur grid standard displacement-bas 4-node quadrilat- eral plane stress element , uniform size 10.0mm , shown figur 11 .
regular first order comput homogen multiscal analysi masonri structur 11 ( ) ( b ) fig .
9 : wall w1 - tu eindhoven shear wall [ 48 ] .
ge- ometri load stage : ( ) stage 1 : uniform vertic load ; ( b ) stage 2 : horizont displac vertic confin ( ) ( b ) fig .
10 : experiment crack pattern fig .
11 : rve mesh .
unit mm constitut model use micro-structur constitu briefli present , use direct numer simul multiscal comput homogen .
constitu , brick mortar joint , assum isotrop .
nonlinear behavior simul mean local continuum damag model improv scalar isotrop damag model de- scribe section 4 .
take account differ behavior materi tension compres- sion , bi-dissip d+/d damag model adopt , follow work [ 53 ] , stress state comput  = ( 1 d+ ) + + ( 1 d )  ( 46 ) +and are posit negat part effect stress tensor  :  = c :  ( 47 ) + = 3 i=1 ipi  pi ( 48 )  =   + ( 49 ) d+ d respect tensil compress damag index , affect respect posi- tive + negat  part effect stress ten- sor  .
two scalar measur introduc , term equival stress +  , order identifi  load- ing  ,  unload   reload  situat general state stress .
present work chosen dif- ferent damag surfac adopt [ 53 ] .
specif , form damag surfac , base one propos [ 28 ] , use tensil compress state , slight differ , order better captur shear behavior masonri compon ( especi mortar joint ) .
12 massimo petracca et al .
equival stress +  comput  = 1 1  ( i1 +  3j2 + 1 max ) ( 50 ) + = 1 1  ( i1 +  3j2 +  max ) ft fcp ( 51 )  = b  1 2b  1 ( 52 )  = fcp ft ( 1  )  ( 1 +  ) ( 53 ) i1 first invari stress tensor , j2 second invari stress deviat , max maximum princip stress , b ratio bi-axi uniaxi compress strength .
con- stant 1 eq .
( 50 ) introduc better control effect compress surfac shear strength model .
constant rang 0 ( lead drucker-prag criterion ) 1 ( lead criterion propos [ 28 ] ) .
ft fcp respec- tive tensil compress peak stress , ft coincid initi non linear uniaxi tension , fcp  coincid initia- tion non linear uniaxi compress fc0 , due initi harden .
choic motiv fact tension harden consid .
final term ft fcp introduc eq .
( 51 ) relat + tensil strength ft .
damag irrevers process , two scalar quantiti introduc , term damag thresh- old r , repres largest valu ever reach equival stress  load his- tori .
damag threshold r time t+t evalu r = max ( r0 , max ( rt ,   ) ) ( 54 ) r+0 = ft ( 55 ) r0 = fc0 ( 56 ) r+0 r  0 repres initi damag thresh- old respect tension compress ( i.e .
elast limit uniaxi tension ft compress 15 10 5 0 5 15 10 5 0 5 1  2  +   ( 1 = 0.00 )   ( 1 = 0.25 )   ( 1 = 0.50 )   ( 1 = 1.00 ) inact tensil surfac x = fc0 x = fcp x = ft x = bfc0 inact compress surfac fig .
12 : initi damag surfac ( 2d plane-stress ) fc0 ) .
accord , follow damag criteria in- troduc :  (  , r ) =   rt  0 ( 57 ) plot superposit two damag sur- face , princip stress space 2d plane-stress case , given figur 12 .
compress surfac plot differ valu constant 1 .
sinc surfac defin stress state , neces- sari make inact ( point figur 12 dash line ) certain condit : 1. compress surfac allow evolv least one princip stress negat 2. tensil surfac allow evolv least one princip stress posit tensil damag index d+ calcul accord follow equat : d+ ( r+ ) = 1 r+0 r+ exp { 2hdis ( r+0  r + r+0 ) } ( 58 ) hdis discret soften paramet ,  calcul explain eq .
( 45 ) .
result tensil uniaxi law given figur 13 .
evalu compress damag index dan ad hoc formul adopt , order regular first order comput homogen multiscal analysi masonri structur 13 fig .
13 : tensil uniaxi law fig .
14 : compress uniaxi law obtain compress uniaxi law like one given figur 14 .
curv consist : 1 ) linear part [ ( 0 , 0 )  ( 0 , 0 ) ] , 2 ) harden part [ ( 0 , 0 )  ( p , p ) ] , 3-4 ) two soft- ene part [ ( p , p )  ( k , k ) ] [ ( k , k )  ( u , u ) ] , 5 ) final constant residu stress part [ ( u , u )  ( + , u ) ] .
part 2,3 4 quadrat bezier curv .
one three control point defin shape curv , end-posit , tangent curv end-posit .
tensil case , discret problem uni- axial curv need regular way shade area curv gc/ldis , present work ldis equal modifi charac- terist length lch ,  , defin eq .
( 32 ) .
materi properti brick mortar joint , use next dns multiscal simul , sum- mariz tabl 2 .
valu taken analysi conduct [ 26 , 27 ] .
materi parame- ter govern compress behavior mortar joint adapt obtain correct compress be- havior masonri composit materi .
fact simul plane stress behavior adopt , captur typic increas compres- sive capac mortar joint , due confin effect surround brick .
anoth possibl cope issu could general plane state model [ 2 ] .
properti brick mortar joint unit e 16700.0 800.0 n/mm2  0.15 0.15 - t 2.0 0.25 n/mm2 gt 0.08 0.016 n/mm 0 3.0 2.0 n/mm2 p 11.5 8.5 n/mm2 r 2.0 2.0 n/mm2 gc 1.0 80.0 n/mm p 0.003 0.04 - kb 1.2 1.6 - k1 0.0 0.16 - tabl 2 : materi properti brick mortar joint 5.3 direct numer simul section , result obtain dns discuss compar experiment result .
allow assess capabl constitu- tive model describ 5.2 repres in-plan behavior shear-wal .
discret consist structur mesh standard displacement-bas 4-node quadrilater plane stress element .
size dis- cretize 10mm .
nonlinear static analysi conduct two stage : 1 .
first stage , uniform pressur 0.3n/mm2 appli top wall , load control ; 2 .
second stage , horizont nodal load ap- pli top-right corner wall , dis- placement control .
second stage , vertic displac top wall , kept fix valu reach previous step .
figur 15 show structur respons term hor- izont top displac total horizont reac- tion .
result obtain dns good agreement experiment result , also term obtain failur mechan , seen tabl 3 tabl 4 .
14 massimo petracca et al .
0 10 20 30 40 50 60 0 0.5 1 1.5 2 2.5 3 h ri zo n ta l ac ti n ( k n ) horizont displac ( mm ) experiment numer ( meso-model ) fig .
15 : load-displac curv context , interest highlight main featur character behavior kind ex- periment ( detail descript see [ 27 ] ) .
end , five signific snapshot analysi extract .
snapshot identifi horizon- tal top displac ux = [ 0.5 , 1.1 , 1.8 , 2.5 , 3.0 ] mm .
obtain result seen tabl 3 tabl 4 , term displac , maximum princip strain , minimum princip stress , tensil damag compres- sive damag .
first non-linear appear horizont top dis- placement ux = 0.5mm , horizont tensil crack develop bottom-right top-left part wall .
first stage , compress stress form sev- eral parallel strut orient along direct given central point brick .
horizontal-top- displac ux = 1.1mm , staircas diagon crack appear center wall , proceed toward support mortar joint .
stage sever crack , yet fulli open uniqu crack , due presenc brick still be- low tensil peak stress .
format diagon crack also produc first visibl chang slope load-displac curv .
stage be- tween horizontal-top-displac ux = 1.8mm ux = 2.5mm character previous men- tion crack join form uniqu diagon crack fulli reach support .
join crack due tensil failur brick .
stage , also visibl chang compress stress , rotat form two separ strut .
open diagon crack lead full develop- ment shear mechan ultim displace- ment ux = 3.0mm .
5.4 multiscal simul order assess propos method , multiscal homogen analysi perform four differ mesh , denot mesh 7x7 , mesh 8x8 , mesh 9x9 , mesh 15x15 , shown figur 16 .
macro-scal model consist structur mesh 4- node quadrilater plane-stress finit element .
or- der improv perform rather coars discret , enhanc assum strain ( ea ) quadrilater element propos [ 51 ] use .
( ) mesh 7x7 ( b ) mesh 8x8 ( c ) mesh 9x9 ( ) mesh 15x15 fig .
16 : adopt mesh macro-scal result obtain four analys good agreement dns predict .
figur 17 show obtain load-displac curv close follow curv dns .
furthermor seen upon mesh refin relat error among curv diminish , thus show object re- spons thank regular procedur propos research .
coarsest mesh ( 7x7 ) show pre- matur failur compress corner probabl due sudden loss bear capac ele- ment involv nonlinear process .
howev , al- readi 8x8 mesh show better agreement 0 10 20 30 40 50 60 0 0.5 1 1.5 2 2.5 3 h ri zo n ta l ac ti n ( k n ) horizont displac ( mm ) experiment numer ( meso-model ) homogen ( mesh 7x7 ) homogen ( mesh 8x8 ) homogen ( mesh 9x9 ) homogen ( mesh 15x15 ) fig .
17 : load-displac curv regular first order comput homogen multiscal analysi masonri structur 15 top displac ux ( mm ) max min ( n/mm2 ) 0.5mm 1.1mm 1.8mm 2.5mm 3.0mm tabl 3 : dns .
increment contour plot ( ux ) horizont top displac , ( max ) maximum princip strain , ( min ) minimum princip stress 16 massimo petracca et al .
top displac d+ d 0.5mm 1.1mm 1.8mm 2.5mm 3.0mm tabl 4 : dns .
increment contour plot ( d+ ) tensil damag , ( d ) compress damag regular first order comput homogen multiscal analysi masonri structur 17 final stage , final 9x9 15x15 mesh start show smoother transit toward compress failur .
15x15 mesh practic point view may seem best choic analyz problem , sinc fe size macro-level smaller rve size .
howev , 15x15 case intent ad- dress show mesh insensit propos regular method .
case coarser mesh actual look appropri , sinc fe size macro-level larger rve size .
case , main failur mechan , displac forc capac correct repres despit mesh coars .
tabl 6 show obtain result term displace- ment , maximum princip strain minimum princi- pal stress .
particular , seen shape crack ( term maximum princip strain ) redistribut compress stress close resembl obtain dns .
tabl 5 show final state ( term maximum princip strain , tensil compress damag ) three signific rves .
first rve ( rve 1 ) show prevail mode failur , tensil damag concentr one bed joint .
first sourc non-linear appear test , vertic confin still low .
second rve ( rve 2 ) show typic staircas failur due shear low confin pressur .
rve taken center wall , main diagon crack start .
final third rve ( rve 3 ) taken bottom-left corner wall , main diagon crack ultim trigger collaps wall .
failur happen later stage test , due fact vertic displac top wall constrain , area subject sig- nific concentr compress stress .
rve success show first staircas damag pattern , fol- low failur brick vertic split .
smear crack approach adopt research , togeth proper fractur energi regular , provid numer result remark agreement experiment crack pattern masonri shear wall .
howev , must note general propos regular solv ( neither attempt ) well-known problem mesh-bia depend fe solut , , prefer direct might still exist model depend orient mesh .
issu howev address care choos finit element model employ coars mesh , demonstr recent work [ 7 , 10 , 11 , 12 , 38 ] .
particular element formul employ current work ( ea [ 51 ] ) make reason- abli insensit mesh bias .
5.5 comput cost import aspect kind simul comput cost .
even studi scope paper , section give brief com- parison dns multiscal simula- tion .
note specimen describ 5.1 quit small ( 1m  1m ) per- fect candid multiscal simul .
nevertheless analyz comparison experimen- tal result .
exploit advantag propos multiscal model , second dns conduct larger model ( 3m  3m ) scale version origin one .
case multiscal simul carri , use macro-scal dis- cretize ( 7 x 7 mesh ) prove suffici obtain good result analysi ( see figur 18a figur 18b ) .
tabl 7a tabl 7b show computa- tional cost dns multiscal simul term memori usag ( real ) time .
give rve max d+ d rve 1 rve 2 rve 3 tabl 5 : final state three signific rves 18 massimo petracca et al .
top displac ux max min 0.5mm 1.1mm 1.8mm 2.5mm 3.0mm tabl 6 : chm .
increment contour plot ( ux ) horizont top displac , ( max ) maximum princip strain , ( min ) minimum princip stress regular first order comput homogen multiscal analysi masonri structur 19 0 10 20 30 40 50 60 0 0.5 1 1.5 2 2.5 3 h ri zo n ta l ac ti n ( k n ) horizont displac ( mm ) numer ( meso-model ) homogen ( mesh 7x7 ) ( ) 0 20 40 60 80 100 120 140 0 0.5 1 1.5 2 2.5 3 3.5 4 h ri zo n ta l ac ti n ( k n ) horizont displac ( mm ) numer ( meso-model ) homogen ( mesh 7x7 ) ( b ) fig .
18 : load-displac curv origin ( ) scale model ( b ) dns model number node number element averag time per iter memori 1m  1m 11152 10934 1.51 sec .
120mb 3m  3m 77064 76502 9.72 sec .
730mb ( ) number node number element number rves number node ( rve ) number element ( rve ) averag time per it- erat memori 64 49 196 322 356 4.97 sec .
275mb ( b ) tabl 7 : comput cost direct numer simul ( ) multiscal simul 7x7 mesh ( b ) object comparison , measur time refer entir simul , averag durat singl global iter ( i.e .
total durat load step , divid number equilibrium iter ) .
furthermor time measur spe- cific load step almost entir model nonlinear rang .
observ , multiscal simul prove effici respect dns deal larg structur ( altern micro- structur small compar specimen ) .
dns penal use larg model due increas time memori requir , main re- quir storag solut larg linear sys- tem equat .
contrari , multiscal simu- lation penal use small model , overhead homogen process domin .
comput done singl ma- chine intel core i7-2670qm-2.20ghz cpu 8.00 gb ram .
code parallel use openmp .
6 conclus classic first order comput homogen well establish framework use captur effect complex micro-structur structur level .
howev recogn suffer spu- rious depend macro-mesh size well rve size , strain local take place .
paper , author propos simpl regular- izat techniqu allow use classic first or- der comput homogen problem involv- ing strain local , keep set , thus simplic , unchang .
context smear crack approach ( sca ) , fracture-energy- base regular , common use 1-scale fe anal- ysis deal strain-soften materi , ex- 20 massimo petracca et al .
tend 2-scale fe analysi .
propos regu- larize procedur ensur object dissipa- tion macro-scal , embed definit micro-scal characterist length ( use reg- ular micro-structur constitut law ) , size finit element scale well size rve .
achiev mean scal- ing factor constant rve .
particular interest fact exist fe code implement- ing classic comput homogen need margin chang evalu scale fac- tor .
propos method valid basic bench- mark test well involv analys in- plane load masonri shear wall , show satisfactori result .
specif , applic pro- pose multiscal procedur show remark agree- ment result given dns .
anal- ysis masonri shear wall , propos model shown capabl micro-scal repres local tensil , compress shear failur due complex interact unit joint .
macro-scal , model correct describ phe- nomenolog structur respons .
propos mul- tiscal approach robust object differ mesh discret .
acknowledg research receiv finan- cial support graduat school univers  g .
 annunzio  chieti-pescara , italian depart civil protect relui project , mineco ( ministerio de economia competitividad spanish govern ) erdf ( european region develop- ment fund ) micropar project ( identif mechan strength paramet structur masonri experiment method numer micro-model , ref num .
bia2012-32234 ) excel programm knowledg generat mineco , eaci project ( enhanc accuraci comput experiment framework strain local failur mechan , ref .
mat2013-48624-c2-1-p ) .
s. oller acknowledg support european research council advanc grant : erc-2012-adg 320815 comp-des-mat `` advanc tool comput design engin materi '' refer 1 .
( 2002 ) gid : person pre post preprocessor 2 .
addessi , sacco e ( 2014 ) kinemat enrich plane state formul analysi masonri panel .
european journal mechanics-a/solid 44:188200 3 .
addessi , sacco e , paolon ( 2010 ) cosserat model period masonri deduc nonlinear homogen .
european journal mechanics- a/solid 29 ( 4 ) :724737 4 .
badillo ha ( 2012 ) numer model base multiscal homogen theori .
applic composit materi structur .
phd thesi , universitat politcnica de catalunya barcelonat- ech 5 .
baant z , oh b ( 1983 ) crack band theori fractur concret .
bordas-dunod , url http : //books.google.it/book ? id=x9citwaacaaj 6 .
belytschko , loehnert , song jh ( 2008 ) mul- tiscal aggreg discontinu : method circumv loss materi stabil .
interna- tional journal numer method engineer- ing 73 ( 6 ) :869894 7 .
benedetti l , cervera , chiumenti ( 2015 ) stress-accur mix fem soil failur shallow foundat involv strain local plastic .
comput geotechn 64:3247 8 .
bosco e , kouznetsova v , geer ( 2015 ) multi- scale comput homogenizationloc propag discontinu use x-fem .
inter- nation journal numer method engi- neer 102 ( 3-4 ) :496527 9 .
car e , zalamea f , oller , miquel j , oat e ( 2002 ) numer simul fiber reinforc composit materials-two procedur .
interna- tional journal solid structur 39 ( 7 ) :1967 1986 10 .
cervera , chiumenti ( 2006 ) mesh object tensil crack via local continuum damag model crack track techniqu .
comput method appli mechan engin 196 ( 1 ) :304320 11 .
cervera , chiumenti , codina r ( 2010 ) mix stabil finit element method nonlinear solid mechan .
part ii : strain local .
comput method appli mechan engin 199 ( 37 ) :25712589 12 .
cervera , pel l , clement r , roca p ( 2010 ) crack-track techniqu local damag quasi-brittl materi .
engin fractur me- chanic 77 ( 13 ) :24312450 13 .
coenen e , kouznetsova v , geer ( 2012 ) novel boundari condit strain local analy- ses microstructur volum element .
interna- tional journal numer method engi- neer 90 ( 1 ) :121 , doi 10.1002/nme.3298 , url http : //dx.doi.org/10.1002/nme.3298 14 .
dadvand p , rossi r , oat e ( 2010 ) object- orient environ develop finit ele- ment code multi-disciplinari applic .
archiv comput method engin http : //books.google.it/book ? id=x9citwaacaaj http : //books.google.it/book ? id=x9citwaacaaj http : //dx.doi.org/10.1002/nme.3298 regular first order comput homogen multiscal analysi masonri structur 21 17 ( 3 ) :253297 15 .
dadvand p , rossi r , gil , martorel x , cotela j , juanper e , idelsohn sr , oat e ( 2013 ) migra- tion generic multi-phys framework hpc environ .
comput & fluid 80:301309 16 .
de belli ml ( 2009 ) cosserat base multi-scal techniqu masonri structur .
: phd thesi 17 .
de belli ml , addessi ( 2011 ) cosserat base multi-scal model masonri structur .
interna- tional journal multiscal comput engi- neer 9 ( 5 ) 18 .
geer , kouznetsova vg , brekelman wam ( 2003 ) multiscal first-ord second-ord com- putat homogen microstructur to- ward continua .
intern journal multi- scale comput engin 1 ( 4 ) 19 .
hernndez ja , oliv j , huesp ae , caicedo ( 2012 ) high-perform model reduct proce- dure multiscal simul .
127 , monograph cimn 20 .
hill r ( 1965 ) self-consist mechan com- posit materi .
j mech phys solid 13:213222 21 .
hugh tj , feijo gr , mazzei l , quinci jb ( 1998 ) variat multiscal method-a paradigm comput mechan .
comput method appli mechan engin 166 ( 1 ) :324 22 .
kouznetsova v , geer mgd , brekelman wam ( 2002 ) multi-scal constitut model hetero- geneous materi gradient-enhanc com- putat homogen scheme .
intern journal numer method engin 54 ( 8 ) :12351260 23 .
kouznetsova v , geer , brekelman w ( 2004 ) multi-scal second-ord comput homoge- nizat multi-phas materi : nest finit el- ement solut strategi .
comput method ap- pli mechan engin 193:55255550 , advanc comput plastic 24 .
lloberas-val , rixen , simon , sluy l ( 2011 ) domain decomposit techniqu ef- ficient model brittl heterogen materi .
comput method appli mechan en- gineer 200 ( 13 ) :15771590 25 .
lloberas-val , rixen , simon , sluy l ( 2012 ) multiscal domain decomposit analysi quasi-brittl heterogen materi .
interna- tional journal numer method engineer- ing 89 ( 11 ) :13371366 26 .
loureno pb , rot jg ( 1997 ) multisurfac inter- face model analysi masonri structur .
jour- nal engin mechan 123 ( 7 ) :660668 27 .
lourenco pb ( 1996 ) comput strategi masonri structur .
phd thesi , tu delft , delft univers technolog 28 .
lublin j , oliv j , oller , oat e ( 1989 ) plastic-damag model concret .
intern journal solid structur 25 ( 3 ) :299326 29 .
mandel j ( 1971 ) plasticit classiqu et viscoplas- ticit .
springer-verlag 30 .
massart , peerl r , geer ( 2007 ) en- hanc multi-scal approach masonri wall com- putat local damag .
interna- tional journal numer method engin 69 ( 5 ) :10221059 31 .
massart tj ( 2003 ) multi-scal model damag masonri structur 32 .
mercatori b , massart ( 2011 ) coupl two- scale comput scheme failur peri- odic quasi-brittl thin planar shell applica- tion masonri .
intern journal numer method engin 85 ( 9 ) :11771206 33 .
mercatori b , bouillard p , massart ( 2009 ) multi- scale detect failur planar masonri thin shell use comput homogenis .
engi- neer fractur mechan 76 ( 4 ) :479499 34 .
neto ead , feijo ra ( 2006 ) variat foun- dation multi-scal constitut model solid : small larg strain kinemat formul .
lncc research develop ( 16 ) 35 .
nguyen vp , stroeven , sluy lj ( 2011 ) multi- scale continu discontinu model het- erogen materi : review recent develop- ment .
journal multiscal model 3 ( 04 ) :229 270 36 .
oliv j ( 1989 ) consist characterist length smear crack model .
intern journal numer method engin 28 ( 2 ) :461 474 37 .
oliv j , caicedo , roubin e , hernndez j , hue- spe ( 2014 ) multi-scal ( fe2 ) analysi materi failur cement/aggregate-typ composit struc- ture .
comput model concret struc- ture p 39 38 .
oliv j , dia , huesp ae ( 2014 ) crack-path field strain-inject techniqu computa- tional model propag materi failur .
comput method appli mechan en- gineer 274:289348 39 .
oliv olivella x , caicedo silva , roubin e , huesp ae , et al ( 2014 ) continuum approach comput multi-scal model fractur .
key engin materi 627:349352 40 .
oller ( 2001 ) fractura mecnica : un enfoqu global .
edicion cimn upc 41 .
oller , miquel canet j , zalamea f ( 2005 ) com- posit materi behavior use homogen 22 massimo petracca et al .
doubl scale method .
journal engin me- chanic 131 ( 1 ) :6579 42 .
ortolano jm , hernndez ja , oliv j ( 2013 ) compar studi homogen strategi multi-scal analysi materi .
135 , mono- graph cimn 43 .
otero f , martnez x , oller , salomn ( 2012 ) studi predict mechan perfor- manc nanotube-reinforc composit .
com- posit structur 94:29202930 44 .
otero f , oller , martinez x , salomn ( 2015 ) numer homogen composit materi analysi .
comparison micro mechan formul .
composit structur 122:405416 45 .
pel l , cervera , roca p ( 2011 ) continuum dam- age model orthotrop materi : applic masonri .
comput method appli mechan engin 200 ( 9 ) :917930 46 .
pel l , cervera , roca p ( 2013 ) orthotrop damag model analysi masonri struc- ture .
construct build materi 41:957 967 47 .
quintero rd , oller , nallim lg ( 2012 ) nonlinear homogen techniqu solv masonri struc- ture problem .
composit structur 94 ( 2 ) :724 730 48 .
raijmak , vermeltfoort ( 1992 ) deform control test masonri shear wall : report b- 92-1156 .
url http : //books.google.it/book ?
id=humtpgaacaaj 49 .
rot jg ( 1988 ) comput model con- crete fractur .
phd thesi , technisch hogeschool delft 50 .
scott mh , fenv gl ( 2003 ) krylov subspac ac- celer newton algorithm .
: proc. , 2003 asc structur congress 51 .
simo jc , rifai ( 1990 ) class mix assum strain method method incompat mode .
intern journal numer meth- od engin 29 ( 8 ) :15951638 52 .
trovalusci p , masiani r ( 2003 ) non-linear microp- olar classic continua anisotrop discon- tinuous materi .
intern journal solid structur 40 ( 5 ) :12811297 53 .
wu jy , li j , faria r ( 2006 ) energi releas rate- base plastic-damag model concret .
interna- tional journal solid structur 43 ( 3 ) :583 612 54 .
zucchini , loureno p ( 2002 ) micro-mechan model homogenis masonri .
in- ternat journal solid structur 39 ( 12 ) :32333255 55 .
zucchini , loureno pb ( 2009 ) micro- mechan homogenis model masonri : applic shear wall .
intern journal solid structur 46 ( 3 ) :871886 http : //books.google.it/book ? id=humtpgaacaaj http : //books.google.it/book ? id=humtpgaacaaj introduct classic first order comput homogen fracture-energy-bas regular two-scal fe comput homogen mode fractur test applic masonri structur .
numer model shear wall conclus
