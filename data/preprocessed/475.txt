robust algorithm implicit descript immers geometri background mesh baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 research art icl open access robust algorithm implicit descript immers geometri background mesh daniel baumgrtner1* , johann wolf1, riccardo rossi2, pooyan dadvand2 roland wchner1 *correspondence: 1technisch universitt mnchen, arcisstr. 21, 80333 mnchen, germani list author inform avail end articl abstract paper present robust algorithm, allow implicitli track immers geometri background mesh. background mesh assum unstructur discret tetrahedrons. contain geometri assum given triangul surface. background mesh, immers geometri describ implicitli discontinu distanc function base level-set approach. distanc function allow consid both, double-sid geometri like membran shell structures, single-sid object enclos volum univoc defined. second case, discontinu distanc function complement continu sign distanc function, rai cast appli identifi close volum regions. furthermore, adapt mesh refin emploi provid necessari resolut background mesh. propos algorithm handl arbitrarili complic geometries, possibl contain model error (i.e., gaps, overlap non-uniqu orient surfac normals). import advantag algorithm embarrassingli parallel natur operations. characterist allow straightforward parallel mpi. develop implement open sourc framework kratosmultiphys avail bsd license. capabl implement demonstr applic exampl involv practice-ori geometries. result final show, algorithm abl complic geometri background mesh, approxim qualiti directli control mesh refinement. keywords: immers boundari method, implicit geometri description, embed geometry, boundari tracking, distanc function, level-set approach, local best-fit approximation, rai casting, adapt mesh refin introduct increas matur numer techniqu allow perform detail mechan simul take account geometr complex, possiblymov objects, provid suitabl comput mesh avail simulation. unfortun avail mesh bottleneck geometr complex increases. consider, example, situat flow object shall computed. follow classic approaches, correspond fluid domain author(s) 2018. articl distribut term creativ common attribut 4.0 intern licens ( permit unrestrict use, distribution, reproduct medium, provid appropri credit origin author(s) source, provid link creativ common license, indic chang made. 0123456789().,: volv baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 2 40 discret body-fit mesh, i.e., mesh match boundari object. requir local match boundaries, however, problemat object repres complic geometry, complet race car, object contain fine details, like hole screw. cases, proper resolut boundari requir lot manual model effort lead impract high mesh density. correspond limit easili understood try qualiti open sourc mesh gener like [15]. situat wors move object need taken account, like problem fluid-structur interaction. cases, requir main- tain body-fit mesh result heavi mesh updat procedures, eventu fail larg movement rotat involved. furthermore, simul problem chang topolog (like flow simul land gear aircraft deployment) virtual impossible, mesh graph changes. immers boundari method appear possibl remedi problems. gener idea immers boundari method place model object directli given background mesh, identifi object boundari rel background mesh, us background mesh implicit descript immers boundari eventu perform mechan analysis. advantag is, body-fit mesh requir anymor give rise significantli decreas model effort. hand, oper caus intersect comput domain, i.e., backgroundmesh, object skin. correspondingly, algorithm requir identifi intersect immers object implicitly. obvious, implicit geometr represent object strongli depend grid size background mesh. is, coars mesh repres immers object accur body-fittedmesh geometr detail lost local refin performed.however, properti necessarili bad, exploit run simul intention reduc level fidelity, e.g. context multiresolut paradigm. approach perform comput base immers boundari method develop years. field cfd, review immers boundari meth- od given [6]. extend formul consid fluid-structur interact present [7]. recent develop focus finit element method describ [811]. exampl context finit volum method given [12]. field structur mechanics, finit cell method (fcm) reli immers boundari formul [13,14]. earlier proposit repres solid structur background mesh elabor [15]. approach above, focu volumetr objects, recent propos isogeometr b-rep analysi (ibra) us similar idea analyz thin-wal structur describ trim geometri cad. ibra, geometri consid- eration, repres e.g. membran shell, immers underli nurbs- surfac patch actual geometri describ cut-out arbitrarili curv free-form shape [1618]. differ works, focu current paper consider- ation immers boundari formul solut physic problem, develop robust algorithm allow implicit description, track baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 3 40 reconstruct geometri immers background mesh. general, algorithm repres basi immers boundari methods. consid case unstructur tetrahedr meshes, intersect immers object given form triangul surfaces. immers geometri describ implicitli discontinu distanc function base level-set approach. allow consid both, double-sid geometries, like sails, fluid flow sides, single-sid objects, enclos volum univoc defined. second case, discontinu distanc function complement continu sign distanc function. case, identif insid outsid regions, associ respect posit neg distance, emploi rai cast approach. rai cast improv cascad techniqu order enhanc robust deal dirti geometries. furthermore, adapt mesh refinement, base techniqu describ [19], emploi provid necessari intend resolut background mesh. propos approach allow handl arbitrarili complic geometries, possibl contain model error (gaps, overlap non-uniqu orient surfac nor- mals). import advantag altern embarrassingli parallel natur oper involved, allow straightforward parallel mpi, provid copi object skin own mpi domains. develop current work implement test framework kratosmultiphys [20,21] avail bsd licens [22]. despit focu implicit geometri descript paper, noted, special attent requir propos approach, includ discontinu distanc function, emploi solut physic problems. detail discuss correspond implic far scope paper, especi finit element context, situat case shall briefli comment following. us discontinu distanc function inevit impli finit element space conform cut faces. consid non-conformity, special strate- gi typic emploi formul condit immers bound- aries. discuss strategi subject paper, readili conclud formul non-trivi task, particularli difficult discret immers boundari integr purposes. however, worthwhil note, area non-conform tend zero smooth surfac infinit refin backgroundmesh. context, author found, appli boundari con- dition base discontinu shape function addit treatment non-conform effect approach solut physic problems, variat crime committed. e.g., studi author flow solver uti- lize discontinu shape function describ [23] result agreement publish data gener cfd analysis. this, however, mean gener result differ strategi need devis altern solver formul employed. paper organ follows: implicit geometri represent mean level-set approach section introduc main approach repres immers geome- tri background mesh mean level-set approach. necessari spatial search algorithm determin intersect element correspond intersect baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 4 40 point describ octree-bas spatial search determin intersect sec- tion. inform intersect elements, actual represent immers geometri discontinu distanc function discuss geometr represent immers object discontinu distanc function section. section, relat challeng systemat prepar specif solut approach elaborated. effici improv implicit geometri repre- sentation, local refin strategi present refin strategi improv approxim qualiti section. identif close region continu- ou distanc function section, addit continu distanc function introduced, requir inside-outsid distinct case enclos volumes. finally, exampl immers geometri differ featur challeng section, develop implement concept demonstr applic exampl have challeng respect immers geometry. implicit geometri represent bymean level-set approach paper, consid case geometri describ triangul surfac immers unstructur tetrahedr background mesh. object implicitli immers geometri respect background mesh, particular focu possibl handl arbitrarili complic geometries. kei idea leverag is, tetrahedron background mesh intersect immers geometri plane (which case, e.g., hexahedrons). furthermore, assumed, case given tetrahedron intersect pattern exactli form cut plane, properli approximated, e.g., best-fit techniques. given descript cut plane intersect tetrahedron, final possibl reconstruct approxim immers geometry. cut plane immers geometry, call level-set approach, describ [24], utilized. provid implicit definit geometri zero isosurfac smooth function defin background mesh. typically, function chosen sign distanc geometri interest, sign defin neg geometri posit other. idea distanc function visual fig. 1. figure, distanc function associ node backgroundmesh closest sign distanc given immers geometry. sign chosen accord normal orient immers geometry. immers geometri appear zero distanc isosurface. provid object consid enclos volume, definit sign distanc univocal. case us continu distanc function defin provid obviou advantag guarante implicit surfac descript continu face intersect elements. are, however, case definit sign distanc univocal. example, consid case fig. 2, show open geometri intersect background mesh (one think cut sail 2d fluid mesh). node n1 belong time label element (e1, e2). hence, assum orient baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 5 40 fig. 1 distanc function implicitli immers geometri fig. 2 need discontinu distanc function deal arbitrari complic geometri potenti non-uniqu definit sign distanc given geometries, neg sign distanc consid e2 posit sign distanc e1, obvious impossible. order successfulli captur except abl arbitrarili complic geometries, distanc function used, defin pure ele- mental basis. is, distanc comput individu element background mesh node. element descript impli node differ distanc valu consid differ elements. concept element-wis comput distanc illustr fig. 3. custom give rise central characterist approach: approx- imat immers geometri turn pure local oper distanc function discontinu immers boundary. note, discontinu distanc function stronger represent properti compar continu one. obvious, continu distanc repres term element-wis discontinu distanc contrari obvious true. matter fact, element-wis comput distanc allow approxim arbitrarili complic geometri background mesh. qualiti approxim determin qualiti baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 6 40 fig. 3 element-wis comput distanc approxim cut plane tetrahedron. note also, have pure local oper distanc comput independ element background mesh. parallel approach straight-forward effective, benefici term comput efficiency. also, seen later, inher discontinu aris represent immers geometri consid neglig assum suffici refin background mesh. given coars mesh, choic possibl refin strategi describ refin strategi improv approxim qualiti section. special case deal close geometri immers background mesh, typic requir determin node background mesh ly insid close region on outside. special case, continu distanc function defin readili comput sign distanc neg distanc indic point insid posit sign point outsid close region. therefore, case includ close immers geometries, continu distanc function reconstruct basi abovement discontinu one. rai cast approach assign result nodal distanc sign. appear robust solution, detail identif close region continu distanc function section. summary, propos strategi implicitli repres immers geometri insid background mesh follows: first, immers geometri describ element-wis distanc local approxim cut plane. process correspond formul discontinu distanc function. problem involv complic geometries, adapt mesh refin appli prior step. then, case immers geometri contain close bodies, discontinu distanc function com- plement continu sign nodal distancesmai determined. comput distanc functions, immers geometri final describ implicitli respect background mesh readili reconstruct basi given distanc values. process summar fig. 4. follow chapter individu step overal process. correspond chapter referenc figure. octree-bas spatial search determin intersect immers geometri implicitli respect given background mesh, determin element immers geometri intersect given element background mesh. end, spatial search techniqu applied. spatial search typic expensive, effici method context immers approach particularli important. baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 7 40 input: background tet-mesh & triangul surfac geometri (e.g. stl) comput element distanc discontinu distanc function refin background mesh nessecari (5) output: implicit geometri descript respect background mesh close geometri included? comput sign nodal distanc contin distanc function (6) determin sign nodal distanc rai cast construct contin discontinu distanc function y n tet intersect geometry? (3) loop tet determin local cut plane (4) tet node comput distanc cut plane (4) y n fig. 4 algorithm implicit geometri descript base combin discontinu continu distanc function (section contain detail referenc brackets) present work, necessari intersect element immers geometri given element backgroundmesh. thatmatter, valid assum background mesh model convex hull immers geometri nb > ng , nb ng number background geometri elements, respectively. straightforward algorithm, identifi intersections, geometri element check element background mesh correspond algorithm complex o(nb ng ). highli refin background mesh quickli lead explos comput costs. call advanc spatial search techniques. luckily, spatial search type repres classic problem scienc approach avail [25]. idea approach divid domain subdomain order object search base divisions. regular divis domain lead bin search structur [2628], hierarch divis lead tree search structur [2931]. bin structur best option homogen distribut objects. contrast that, hierarch structur suitabl distribut high concentr object irregular shapes, respectively. baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 8 40 fig. 5 distribut leaf cell result quadtre data structur gener circular geometri consecut level refin present case object search irregular domain, i.e., given element background mesh necessari search intersect element immers geometry, immers geometri arbitrarili shape repres irregular domain, spatial search base octre appear best solution. method, block-shap bound box immers geometri divid equal cells, cell partit cell case element immers geometri contained. process perform time desir level refinement. final distribut cell refer leaf cells. result, domain geometri repres tree-lik data structure, i.e., octre 3d quadtre 2d. exampl distribut leaf cell result quadtre data structur given fig. 5. partit techniqu type [31]. work mid-point partit base work [32] emploi basic data structure. have identifi suitabl data structure, follow gener procedur propos perform spatial search: first, basic octre data structur repres immers geometri created. then, element background mesh assign point- er correspond leaf cell intersect with. base link inform domains, intersect test immers geometri background mesh eas significantly. instead check element backgroundmesh element immers geometry, check given background element small subset geometri element potenti intersec- tions. reduc complex intersect test originallyo(nb ng ) order ofo(nb log(ng )). result algorithm determin intersect point background mesh immers geometri spatial search describ visual fig. 6. shown figure, correspond algorithm contain main steps: baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 9 40 input: background tet-mesh & triangul surfac geometri search subset leaf cell inersect tet gener bound box tet cell intersect tet (box-tet intersection)? gener octre base immers geometri output: intersect brackground mesh & immers geometri loop tet element background mesh determin intersect tet & geometri subset leaf cell y determin leaf cell intersect bound box (box-box intersection) loop intersect leaf cell add cell contain n loop tet edg check intersect triangl & tet edg (triangle-lin int.) loop leaf cell contain loop triangl leaf cell fig. 6 algorithm base octre data structur determin intersect point background mesh immers geometri first, octre repres immers geometri creat loop element background mesh initialized. then, loop, second main step determin octre leaf cell inter- sect given element background mesh (which assum tetrahedron). set cell effici determin combin rough intersect test subsequentmor accur one. rough test, bound box construct given tetrahedron check leaf cell octre box intersect with. reduc costli box-tetrahedron intersect test simpl boxbox algorithm [33]. intersect found, accu- rate test follow check actual box-tetrahedron intersection. accur test algorithm describ [34]. result second main step, set baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 10 40 fig. 7 approxim immers geometri intersect element background mesh fig. 8 sign nodal distanc valu defin cut plane intersect element zero isosurface. cut plane local approxim immers geometri (blue area) leaf cell contain (triangular) geometri element possibl intersect obtained. set store contain associ given background element. given contain element background mesh, main step identifi actual intersect points. detect intersect point tetrahedron triangl geometr complex problem, step divid loop basic tests. basic tests, intersect point deter- mine subsequ test tetrahedron edg given triangles, involv basic comput intersect point rai triangle. have perform main step element backgroundmesh loop, intersect point immers geometri final determined. geometr represent immers object discontinu distanc function implicit geometri represent mean level-set approach section gen- eral approach implicitli repres immers object background mesh introduced. context, tetrahedr background mesh triangul immers geometri assumed. correspond algorithm summar fig. 4. chapter discuss comput element distanc algorithm. present wai visual correspond approxim immers geometry. visual basi discuss approxim quality. comput element distanc tetrahedr background mesh assumed, best possibl represent geometr singl background element plane. therefore, present baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 11 40 work, arbitrari boundari immers object repres collect pla- nar cut planes, intersect element background mesh exactli defin plane. principl conceptu illustr fig. 7. conse- quenc local reduct immers geometri cut plane, approxi- mation qualiti strictli limit densiti background mesh. accord previous introduc discontinu level-set approach, cut plane separ defin intersect element zero isosurfac eman sign distanc valu associ nodes. obtain correspond zero isosurfaces, basic step performed: 1. determin intersect point background mesh immers geome- try, 2. determin specif cut plane intersect background element base local intersect pattern, 3. comput node intersect element sign distanc cut plane. step previou enumer algorithm present fig. 6. determin cut plane discuss section . assum cut plane determin available, set sign nodal distanc final comput follows: di = n n (ni p). (1) here, nodal distanc valu element background mesh, di, com- pute nodal coordin ni, normal vector n repres orient cut plane, correspond base pointp plane given inter- section points. concept visual fig. 8. note, propos approach set sign nodal distanc valu comput pure local operation. hence, background element set nodal distances. therefore, following, set distanc refer element distances. element distanc final defin discontinu (element-wise) distanc function. have defin discon- tinuou distanc function, approxim immers structur appear zero isosurfac background mesh. visual approxim immers geometri toevaluatewheth propos algorithmcan repres immers object properly, necessari visual geometr approxim eman implicit descrip- tion distanc function. visual provid import insight immers object seen backgroundmesh. obtain visualization, triangular mesh recreat given distanc valu post-process routine. precisely, loop intersect background elements, intersect point given element recomput sign distanc values. then, intersect point form triangl depend number intersect points. exactli points, triangl directli defined. case background element intersect points, triangl created. background element ignor reconstruction. element inter- baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 12 40 sect points, correspond quadrilater area recreat neighbor triangl similar orientation. triangl final collect contain andmai visual common surfac mesh. procedur conceptu visual fig. 9a. figure, distanc valu di dj comput edg tetrahedron separately. valu distanc correspond edg nodesni andnj immers boundary. product distanc valu positive, correspond element intersect immers geometry. case product negative, however, mean tetrahedron intersect edg correspond intersect point p comput linear interpolation: p = |dj||di| + |dj| ni + |di| |di| + |dj| nj . (2) given example, distanc valu indic tetrahedron intersected, linear interpol result element intersect point intersect points. correspondingly, triangl reconstructed. triangl eventu repres local reconstruct immers bound- ari seen tetrahedron (the background mesh). complic exampl given fig. 9b, implicit represent immers cylind visualized. import realiz result triangular surfac mesh (a) differ origin immers surfac mesh (i given stl) serv visual purposes. thus, supposedli bad qualiti reconstruct surfac mesh (see blue mesh fig. 9b) result chosen visual techniqu implications. import rememb follow-up sections, result surfac approxim shown featur line better distinct individu geometr aspects. determin cut plane differ intersect pattern explain comput element distanc section, order implicitli immers object, boundari approxim collect planar cut plane defin intersect element background mesh. therefore, cut plane determin depend local intersect pattern. deter- mine pattern challeng oper differ geometriesmai local result intersect pattern. that, uniqu definit cut plane possible. thus, numer special case consid order obtain robust algorithm. determin cut plane import scenario dis- cuss section. scenario correspond intersect pattern conceptu visual tabl 1. note, scenario visual 2d readili transfer three-dimension case. approxim planar surfac planar face intersect background element, differ intersect pattern considered, i.e., pattern intersect point (see fig. 10). case intersect point ly common plane given cut plane accur defin immersedboundary.th correspond baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 13 40 b fig. 9 visual geometri approxim result implicit descript immers object discontinu distanc function. concept: visual surfac reconstruction. b example: approxim immers cylind cut plane defin possibl given intersect point surfac normal vector immers boundary. evalu correspond approxim quality, algorithm test case simpl triangul plate immers box-shap background mesh 19,000 elements, fig. 11a. test process follows: first, element distanc comput describ comput element distanc section, immers planar surfac treat introduc above. then, approxim surfac reconstruct visual follow approach introduc visual approxim immers geometri section. result approx- imat immers structur present fig. 11b. seen figure, rectangl describ appli method region edges. issu trace fact background element edg intersect complet approxim immers boundari area possibl (compar scenario tabl 1). however, point earlier, approxim error inher immersedapproachanddu limitedmesh resolution. canbewel reducedbi refin strategi discuss refin strategi improv approxim qualiti section. baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 14 40 tabl 1 scenario immers geometri lead differ intersect patternsth geometr complex increas tabl scenario visual possibl approxim planar intersect case immers boundari planar intersect ele- ment, cut plane determin exactli repres boundari slight curvatur case orient immers boundari slightli chang- ing, exact represent boundari possibl any- cut plane easili determin minim approxim error sharp edg sharp edg locat element describ singl cut plane. best approxim cut plane chamfer edg boundari element definit cut plane, possibl approxim case boundari intersect- ing, plane replac boundari singl follow fit criterion incomplet intersect case, local approxim immers boundari sign distanc valu impossible. case ignored. note, however, correspond approxim error inher immers approach limit mesh resolution. reduc refin strategi fig. 10 relev intersect pattern immers plane face. intersect points. b intersect point approxim curv surfac oppos planar geometries, curv surfac gener approxim exactli singl cuttingplan thenorm vector immersedboundari chang direct intersect element. therefore, decis bemad term normal vector base point order plane best approxim immers boundary. end differ case considered: case: intersect point case conceptu visual fig. 12. sake clariti compar follow solutions, actual dimension situat reduc correspond two-dimension case loss generality. baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 15 40 fig. 11 test case evalu surfac approxim immers planar geometries. test setup: plate immers box-shap background mesh 19,000 elements. b reconstruct immers boundari (a) fig. 12 concept approxim slightli curv immers boundari background element given intersect pattern intersect point (p1,p2,p3), good approx- imat immers boundari easili obtain triangl form intersect points. therefore, cut plane defin triangle, intersect point chosen base point plane normal vector deriv cross product edges: n = p1p2 p1p3. (3) case: intersect point case intersect nodes, point gener locat common plane anymore. case, best-fit approach chosen comput cut plane minim distanc intersect points. formul correspond optim problem, recal equat defin nodal distanc di correspond background element: d1 = n n (pa p1), (4a) d2 = n n (pa p2), (4b) d3 = n n (pa p3), (4c) d4 = n n (pa p4). (4d) baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 16 40 here, n defin unknown normal approxim plane. pa defin base point plane pi repres posit th intersect point. equat rewritten matrix form follows: d = nnp, (5) matrix p collect distanc vector intersect point base point plane: p = pa p1 pa p2 pa p3 pa p4 . (6) optim compromis cut plane, squar approxim applied, unknown normal vector unknown base point chosen nodal distanc minimized: minim n,pa f : f = d2 = 1n2 n t ptp n. (7) equat thematrix productptp summar amatrixa. reduc problem, base point predefin averag point given intersect points: pa = 1 4 4 i=1 pi, . (8) furthermore, unit surfac normal required, that: ntn = 1. (9) final formul least-squar problem reads: minim n ntan subject ntn 1 = 0. (10) correspond constrain quadrat optim problem. solv unknown compon normal vector n = {nx, ny, nz}, lagrang function l formul lagrangian multipli : l(n, ) = ntan + (ntn 1). (11) stationari point l obtain base follow necessari conditions: l n = + n = 0 (12a) l = ntn 1 = 0. (12b) baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 17 40 fig. 13 special intersect pattern curv geometri edg background mesh intersect twice. 3d example. b close-up exampl eq. (12a), rearrang follow eigenvalu problem obtained: = n. (13) here, denot eigenvalu thematrixa andn correspond eigenvector.with knowledg mind, eq. (13) multipli nt , result in: ntan = . (14) left hand equat character object function f [refer eq. (7)], deduc (14) object valu minim n correspond eigenvector symmetr matrix smallest eigenvalue. normal best fit cut plane intersect point chosen eigen- vector. correspond eigenvalu problem solv iter gauss-seidel method. case: double-intersect edgesanoth special intersectionpatternwhichha tobe consid- er immers geometri have curv surface, case double-intersect edges. intersect pattern shown fig. 13. figure, curv geometri (blue) immers non-vis backgroundmesh intersect select tetrahedron background mesh (green) points, edg tetrahedron intersect twice. situat conceptu sketch fig. 14a. sketch seen, approxim immers boundari base ona set signeddist valu onlyposs left element.th right element intersect point defin proper cut plane. therefore, geometri immers right element neglected. left element problemat double-intersect edg allow uniqu definit cut plane. solut problem, immers boundari approxim plane minim distanc intersect points. strategi appli case intersect points. number intersect point increas time. correspondingli cut plane baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 18 40 b fig. 14 approxim strategi immers geometri slightli curv lead double-intersect edges. conceptu illustr problem. b conceptu illustr solut strategi defin base point pa, averag n intersect points: pa = 1 n n i=1 pi, (15) surfac normal n, correspond eigenvector associ smallest eigenvalu follow matrix a: = ptp = pa p1 ... pa pn t pa p1 ... pa pn . (16) solut strategi determin cut plane immers geometri slightli curv lead double-intersect edg conceptu illustr fig. 14b. have present strategi approxim cut plane case curv geometri immers backgroundmesh, result approxim qualiti shall inves- tigat following. test exampl sphere posit box-shap background mesh. background mesh correspond pla- nar test case shown fig. 11a. construction, sphere intersect background mesh case appear (i.e., background element intersect points, element double-intersect edges). test process follows: element distanc comput describ comput element distanc section, curv surfac treat introduc above. then, approxim surfac reconstruct visual- iz follow approach introduc visual approxim immers geometri section. result approxim immers sphere present fig. 15a, b differ resolut background mesh. qualit observ figure, spheric geometri captur algorithm visibl defect reconstruct surface. fur- thermore, curvatur adequ resolv depend refin backgroundmesh. worthwhil note, introduc special case consid here, approxim sphere visibl defect baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 19 40 fig. 15 surfac approxim sphere immers background mesh. reconstruct immers boundari (a) given coars background mesh. b reconstruct given fine background mesh. c reconstruct consid double-intersect edg b fig. 16 conceptu illustr intersect pattern sharp edg insid singl background elements. case: intersect point uniqu defin plane. b case: approxim plane requir fit local unsuccess approxim cut plane (see fig. 15c). pre- viou results, conclude, present algorithm abl handl immers geometri slight curvatures. approxim surfac sharp edg descript sharp edg singl background element gener pos- sibl present approach cut plane defin element. however, situat appear frequent immers geometri complet smooth. proper approxim sharp edg found. approximation, differ intersect pattern shall distinguished. pattern conceptu illustr fig. 16. main differ pattern number intersect points. fig. 16a background element exactli intersect point necessari uniqu defin approxim cut plane (i.e., three- dimension case), scenario fig. 16b exhibit intersect point neces- sary, singl cut plane defin fit procedure. handl situations, follow procedur proposed: case, defin cut plane directli base given intersect point choos normal direct unit vector averag normal connect surfaces. result chamfer represent edge. second case similar case curv geometri intersect element points. correspondingly, best-fit procedure, baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 20 40 b fig. 17 strategi approxim sharp edg singl background elements. case: intersect point uniqu defin plane. b case: approxim plane requir fit fig. 18 surfac approxim cube immers coars background mesh demonstr implicit descript sharp edg (featur line hidden) describ approxim curv surfac section, follow case. solut strategi conceptu illustr fig. 17. have present strategi approxim sharp edg singl background ele- ments, result approxim qualiti shall investig following. test exampl cube posit box-shap background mesh. background mesh correspond planar test case shown fig. 11a. test process follows: element distanc comput describ comput element distanc section, sharp edg planar sur- face treat introduc approxim planar surfac section. then, approxim surfac reconstruct visual follow approach introduc visual approxim immers geometri section. result approxim immers cube present fig. 18. shown figure, cube approxim planar areas. however, expect approxim strategies, irregularli chamfer edg observed. rough represent actual geometry, best possibl context present level-set approach. luckily, however, correspond approxim error effect reduc mean mesh refinement, shown refin strategi improv approxim qualiti section. baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 21 40 b fig. 19 improp / misalign approxim cut plane case boundari intersect singl background element. boundari intersect singl element. bwrong approxim cut plane follow best-fit approach approxim case boundari intersect specif background element definit cut plane, possibl approximation, case intersect boundaries, plane. plane replac boundari singl determin follow fit criterion. so, accept inform singl boundari lost. loss information, however, necessarili bad characteristic. matter fact, allow properli immers geometri badli model contain overlap duplic geometries. precisely, boundari intersect background element replac singl one, overlap dupli- cate geometri simpli overseen caus problems. i.e., robust treatment dirti geometri inher properti pre- sent approach. specif strategi approxim immers boundari cut plane describ following: consid conceptu illustr problem fig. 19a. figur visual case distinct immers boundari travers element backgroundmesh. correspond intersect pattern character fact intersect point double-intersect edges. therefore, obviou wai approxim immers boundari cut plane best-fit approach, like propos previou section similar intersect patterns. however, actual approxim immers boundari singl plane determin best-fit procedure, possibl obtain approxim geometri depict fig. 19b. seen figure, best-fit approachmai result approxim cut plane optim place intersect points, orient clearli wrong. instead, expect cut plane align opposit surfaces. therefore, order obtain properli align approxim case background element intersect immers boundaries, advis follow best fit approach. instead, recommend both, base point surfac normal cut plane determin averag approach. averag approach, base point cut plane defin averag intersect points, eq. (15). surfac normal comput mean vector m surfac normal intersect point background element consideration: baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 22 40 fig. 20 approxim properli align cut plane case multipl boundari cross singl background element b fig. 21 problemat intersect pattern approxim wing background mesh. aw model. b element immers boundari sharp edg wing n = 1 m m i=1 ni, (17) avoid cancel case individu surfac normal point opposit directions, mean enclos angl exce 90, vector firstli align sum. i.e., iff ni n1 < 0, ni = ni. final approach illustr fig. 20. alreadyment above, solut approxim immers boundari singl cut plane advantag immers object containmodel errors. however, plai import role case taper structur immers background mesh. example, consid wing shown fig. 21a. put wing arbitrari tetrahedr background mesh, like lot element sharp edge, intersect immers boundari (see fig. 21b). therefore, proper treatment case decis overal approxim quality. achiev approxim qualiti present wing discuss refin strategi improv approxim qualiti section context mesh refinement. summar strategi determin local cut plane previou subsect describ determin local cut plane case planar geometries, curv geometri geometri sharp edg bound- ari intersect background element twice. cases, base point normal vector correspond cut plane defin directli intersec- tion point follow averaging, respect best-fit procedure. approach baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 23 40 fig. 22 strategi determin cut plane given intersect background element. determin requir base pointpa normal vector n.pi denot intersect point chosen individu case, depend number intersect point local intersect pattern. figur 22 summar propos overal strategi determin cut plane given intersect background element. refin strategi improv approxim qualiti context immers methods, size element background mesh gener defin length scale towhich geometr detail immersedobject canb resolved. consequ smaller length scale simpli neglected. approxim qualiti directli depend resolut background mesh and, necessary, control mean refin strategies. note depend approxim qualiti resolut background mesh actual seen benefici characterist inher allow handl flaw descript immers geometri (like gaps, overlaps, etc.) allow exploit multiresolut analysi case complex investig scenarios. case approxim qualiti improved, adapt mesh refin step proposed: first, loop element background mesh, ele- ment satisfi specifi refin criterion tagged. then, second loop elements, tag element refin algorithm describ [19]. refin criterion, local approxim qualiti utilized, i.e., element shall tagged, caus problem approxim immers geometry. paper, problemat case considered. conceptu summar fig. 23. problemat case identifi element background mesh intersect immers geometri such, contain edg cut twice (see fig. 23a). order properli approxim immers geometri case, correspond element refin opposit surfac fall differ element background mesh. second indic problemat case possibl chang surfac normal immers object singl background element (see fig. 23b). object baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 24 40 b c fig. 23 problemat case tag refinement. double-intersect edges. b high chang curvature. c element cut plane slightli curv planar, chang normal vector small, i.e., refin necessary. curvatur larg object chang direct element, element need refined. therefore, case normal orient immers geometri chang singl background element, pair surfac normal intersect points, n1 n2, compared. correspond angular chang exce adjust limit , element tag refinement. indicator, consid case background element slightli touch immers object cut plane approxim (e.g., edg element cut, fig. 23c). point earlier geometri- cal represent immers object discontinu distanc function section, elementswhereno cut plane canb approxim simpli ignored.a thiswil obvi- ousli introduc error approxim immers geometry, refin shall trigger here. note, unlik previou cases, refin case complet cure problem element edg immers geometry. refinement, problemmai reduc neglig influence. final adapt mesh refin algorithm pseudocod read follows: //1 tag problemat element refin element backgroundmesh determinecuttingpattern() ncut_edg < 3 ndouble_intersected_edg > 0 (n1,n2) > then: tagelement() end end // 2. refin tag element element backgroundmesh element.istagged() then: refineelement() end end test propos algorithm, wing geometri fig. 21 place initi background mesh coars discret includ 4.0e5 elements. coars dis- cretiz present context means, size element background baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 25 40 fig. 24 model setup test propos refin strategi regard possibl improv approxim immers objects. overal model setup wing place background mesh. b section view background mesh wing size comparison mesh larg compar characterist dimens immers object. size comparison, refer fig. 24, show overal setup section view wing. result approxim wing refin background mesh follow procedur discuss geometr represent immers object discontinu distanc function section present fig. 25a. seen, refinement, surfac wing porou lead trail edg approximated. however, appli refin iter ( = 30), result improv significantly, shown fig. 25b. refin background mesh final result continu better resolv geometry, fig. 25c, d.after level refin good surfac qualiti obtained. regard backgroundmesh, number element hardli increas level refinement. addit element introduc critic areas, i.e., edg region low geometri reso- lution. quickli fix larg surfac repair compar slower edges. want resolv geometr details, sharp edg here, level refin necessary. present case lead 2.2e6 element repetit propos refin strategy. amatt fact, abl resolv sharp edg import characterist propos approach. particularli relev case edg plai domi- nant role (e.g., immers cfd analysi bluff bodies). highlight feature, fig. 26 show surfac approxim simpl cube immers refin background mesh contain 2.3e6 elements. setup correspond test case sharp edg introduc approxim surfac sharp edg section. result surfac approxim non-refin background mesh present fig. 18. contrast that, fig. 26b show result surfac approxim time refin background mesh. compar figures, seen, refinement, edg approxim cube significantli chamfered. mean mesh refinement, how- ever, edg captur good overal approxim qualiti obtained. baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 26 40 fig. 25 approxim immers wing geometri background mesh differ level refinement. refin (4.0e5 elements). b 1 level refin (4.4e5 elements). c 3 level refin (6.2e5 elements). d 5 level refin (2.2e6 elements) fig. 26 approxim cube immers refin background mesh. section view refin background mesh immers cube (node entir background mesh highlighted). b result surfac approxim refin background mesh note, critic region background mesh, i.e., cube edges, refined. region affect approxim qualiti remain unchanged. figur 26a visual adapt refin highlight node background mesh. seen figure, origin regular distribut node interrupt accumul node edges. accumu- baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 27 40 102 103 104 105 106 107 number background element 10-4 10-3 10-2 10-1 er ro r adapt refin 102 103 104 105 106 107 number background element 10-4 10-3 10-2 10-1 uniform refin 102 103 104 105 106 107 number background element 10-4 10-3 10-2 10-1 er ro r uniform refin fig. 27 quantit studi approxim error sphere immers continu refin background mesh (the dot indic level refin follow differ strategies) lation edg addit elements, introduc background mesh refinement. previou focu onqualit aspects, quantit evalu geometr approxim qualiti present following. precis defin test case, sphere radiu r = 0.4 posit box-shap background mesh, refin times, uniformli intersect adapt present algorithm = 1 (i.e., surfac normal immers geometri singl intersect background element chang degree, correspond element refined). everymesh, follow errormeasur evaluated: = ||r ri||max (18) equation, ri repres approxim radiu i-th node approxi- mate sphere, || ||max maximum norm. figur 27 summar result study. figur seen, refin strategi (adapt uni- form) error continu reduceswith increas level refinement. lowest valu order 1e4,mean approxim radiu deviat analyt 0.025%. differ case number element introduc obtain accuracy. best accuraci uniform refin obtain 1e6 elements, adapt refin yield better approxim elements. note, element refin problemat intersect case mention above. level refin mesh coars compar sphere dimensions, basic element consid problematic. consequence, result uniform adapt refin similar. however, fourth refin iter problemat background elements, adapt refin quickli pai off. note also, refin non-problemat elements, baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 28 40 local result problemat element again, explain sudden error increas iter uniform strategy. previou result section, concluded, propos com- binat adapt mesh refin implicit geometri descript result high qualiti surfac approxim amanag number element background mesh. identif close region continu distanc function special case close geometri shall describ implicitli given background mesh, algorithm present following, allow distinguish region insid close domain region outsid it. approach reli continu distanc function formul base discontinu distanc function present geometr represent immers object discon- tinuou distanc function section. continu distanc function construct assign node backgroundmesh uniqu neg distanc valu li insid immers geometry, uniqu posit distanc valu else. propos algorithm consist follow basic steps: 1. calcul element distances: calcul intersect element separ nodal distanc follow introduc discontinu distanc calculation. 2. determin absolut nodal distances: determin node background mesh uniqu distanc valu find smallest distanc valu associ node intersect neighbor elements. 3. determin signs: determin node li insid outsid close region special tailor rai cast algorithm. step recal techniqu introduc geometr represent immers object discontinu distanc function section second step correspond straightforward operation. thus, following, focu step. step, determin given node li insid outsid close geometry. oper known literatur point-in-polygon (pip) problem [3537]. algorithm solv pip problem. reli watertight boundari proper orient surfac normals. however, case complic geometri model practice, characterist guaranteed. correspondingly, approach propos following, util information. instead, algorithmbas rai cast elaborated.note, common altern rai cast approach base voxelization, e.g. [38,39]. however, algorithm strongli depend voxel size non-clean geometries, altern avoided. basic rai cast rai cast algorithm develop arthur appel render purpos 1968 [40]. gener differ applic analysi intersect point rai given 3d object geometri interest. common us techniqu solv pip problem. baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 29 40 fig. 28 concept rai cast identifi insid outsid close geometry: start outsid determin statu given node follow statu ray, chang intersect boundari existingmethods, classic approach rai intersectionmethod [35]. thismethod, random rai emit point result number intersect rai surfac contour given 3d object counted. number even, point outsid 3d object. odd, point consid inside. slightli modifi version method current work solv problem assign sign nodal distanc values. modif mainli introduc increas algorithm robust case defici (dirty) geometries. modif following: instead start point interest, rai shot point outsid domain node background mesh, point outsid again. so, rai align cartesian directions. improv effici intersect search fact start end outsid later purpos rai validation. given ray, intersect immers geometri rai determined, direct ray, intersect caus chang statu (insid outsid immers geometry). is, start point outside, intersect indic rai enter insid immers geometry. intersect indic rai outsid again, forth. posit actual node determin current statu cross ray. finally, posit sign assign node distanc valu rai indic region outsid neg valu else. 2d exampl approach illustr fig. 28. modif rai cast algorithm discuss follow sections. improv non-watertight geometri rai cast techniqu determinist behavior clean geometri rai univoc determin node insid outside. however, non-watertight geometri aremani possibl basic techniqu fails. consid non-watertight geometri gap overlap depict fig. 29, failur case are: 1. rai pass exactli gap (see fig. 30a). case rai intersect boundari continu outsid geometry. baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 30 40 fig. 29 non-watertight geometri gap overlap fig. 30 error model geometry, lead erron color (wrong identif insid / outsid status). situat gaps. b situat overlap 2. rai pass overlap (see fig. 30b). situation, rai detect intersect point enter geometri lead wrong conclus second intersect outside. deal problems, propos us rai specif node interest, i.e., rai coordin direction, decid node posit voting. concept adopt approach simplifi repair polygon model [41]. three-dimension case example, rai pass gap overlap region, rai vote correct result. node posit determin correctly. figur 31 conceptu illustr approach two-dimension case rays. experi authors, simpl idea work practic handl major model error cost increas rai cast time. however, neglig compar rest algorithm present paper. propos mechan vote work practice, lit- tle possibl rai pass conflict area lead wrong conclusions. end improv included: 1. rai validation: rai construct start outsid end there, rai validated. is, rai end color inside, clearli invalid. rai consid voting. exampl baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 31 40 fig. 31 concept voting: rai vote certain node insid outside. decis base votes. here, rai vote outsid inside. note 3d, ray, draw possibl fig. 32 improv increas robust rai cast algorithm. exclus invalid rai voting. b local rai cast exclus invalid rai prevent fals conclus respect node posit given fig. 32a. 2. collaps adjac hits: rai detect intersect close (in com- parisonwith element size), collaps order better dealwith overlaps. 3. local rai cast : invalid rai result situat rai con- sider invalid valid on differ results. cases, local rai cast neighbor node known color (inside/outsid status) performed. therefore, local rai sent neighbor node colored. final color decid vote again. concept illustr fig. 32b. remarked, concept vote improv reduc theoret possibl failur zero. practice, yield robust algorithm determin sign distanc valu respect insid outsid areas. case includ double-sid geometri main advantag implicit geometri descript present cur- rent work deal double-sid geometri (like exampl membranes). geometri repres volum boundari explicitli defin close surface. object posit background mesh close geometry, rai cast approach readili appli deter- baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 32 40 fig. 33 combin close (solid line) double-sid structur (dash line): double-sid structur mark flag simpli ignor rai cast algorithm insid outsid area rai count hit double-sid object. end, previou mark-up introduced. is, case both, double-sid geometri close volum bodi immers background mesh, double-sid geometri flag prior rai casting. hit flag geometri simpli neglect actual rai cast afterwards. insid outsid area properli defined. concept illustr fig. 33. exampl immers geometri differ featur challeng chapter, implicit descript geometri background mesh present strategi test geometri vari complexity. goal demonstr capabl applic conjunct complex 3d geometries. therefore, test case differ field applic considered. sail model repres gener case surfac geometri immers comput background mesh. second case repres section model inflat hangar situat close volum geometri shall investigated. test case compris complet race car combin aforement case complex problem, expect industri examples. test procedur follows: first, geometri consider place simpl block-shap domain mesh equal distribut tetrahedr element obtain mesh softwar short period time. then, complet algorithm, present paper outlin fig. 4, appli implicitli immers geometri respect given background mesh. finally, implicit descript geometri reconstruct surfac approxim (see visual approxim immers geometri section), step compar origin model. note, following, visual background mesh omit avoid clutter. surfac geometri following, algorithm test surfac geometri immers regular block-shap comput mesh discret 800,000 tetrahedrons. geometri repres sail setup membran differ sizes. correspond model shown fig. 34. goal repres sail implicitli given baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 33 40 fig. 34 stl model sail repres background mesh background mesh, particular focu curv surfac area free edg approximated. appli present algorithm implicitli sail given back- groundmesh, surfac approxim present fig. 35a obtained. see, curv surfac region approxim differ sail clearli form unexpect approxim errors. free edg sharp corners, however, strike defect resolv actual edg sufficiently. matter fact, defect aris special inter- section patter geometri background mesh free edg consid problem mesh refinement. appli adapt refin introduc refin strategi improv approxim qualiti section, qualiti approxim significantli improv point free edg accur captured, fig. 35b. worthwhil mention, test case includ point differ geometr entiti (two sails) touch g0- continu connect form out. seen fig. 35b, area direct vicin connect point accur resolved, trace advantag discret distanc function identifi immers boundari pure local operation. close volum geometri section present algorithm test case close geometri immers regular block-shap comput mesh. goal firstly, implicit represent geometri show close shape, secondly, correctli distinguish insid outsid geometry. end, model section inflat hangar chosen, fig. 36a. region difficult repres accur case sections, larg surfac local connect sharp edg curved. baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 34 40 fig. 35 reconstruct surfac approxim sail immers block-shap background mesh. adapt refin background mesh (800,000 elements). bwith level adapt refin (ca. 4.5 mio. elements) fig. 36 section inflat hangar model implicit represent background mesh. stl model. b reconstruct approxim geometri refin background mesh (800,000 elements). c reconstruct approxim geometri adapt refin (9 mio. elements). d look insid approxim geometri baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 35 40 appli present algorithm implicitli hangar section background mesh initi 800,000 tetrahedrons, surfac approxim present fig. 36b obtained. tube surfac region clearli form expected, strike defect sharp edg ground. similarli previou section, low resolut background mesh, yield difficult intersect pattern area rapidli chang geometr characterist sharp edges. defect resolv adapt refin background mesh, fig. 36c. moreover, refin lead proper captur hangar close regions, fig. 36d. apart pure approxim immers geometry, insid out- region identifi follow approach describ identif close region continu distanc function section. figur 37 show correspond result arbitrari cross-sect hangar. figur seen, node insid geometr boundaries, node pressur- iz volume, tag neg sign distance, obtain posit sign. sign allow clear distinct differ part computa- tional mesh. correspond inform exampl util immers cfd simul interior exterior flow need treat differently. worthwhil mention, distinct perform refer surfac normal geometry. so, problem relat misalign nor- mals, occur practic applications, avoided. previou result evident, combin discontinu continu distanc function, propos paper, util effect repres close geometri background mesh. combin arbitrarili complex geometri have test both, close double-sid geometri individually, present algo- rithm section appli large-scal example, includ cases. model consider repres complet race car contain sim- ple complex geometr featur length-scal rang large-span surfac area detail geometr objects. correspond geometri depict fig. 38. refer discretization, block-shap tetrahedr mesh used, time, initi discret intention chosen coars (onli 40,000 elements). start coars discretization, background mesh gradual refined, case correspond implicit surfac represent evaluated. model consider contain lot details, improp representa- tion expect initi coars discretization. fact observ look result approxim depict fig. 39a. order abl captur geometri detail, signific refin refer mesh required. however, avoid explos number elements, utmost import concentr refin spot actual necessary. it, e.g., construct massiv refin element plane slightli curv surfaces. instead, concentr element complex detail crucial. kei success power adapt refin strategy. appli adapt refin propos success process, final possibl repres race car baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 36 40 fig. 37 sign nodal distanc cross-sect hangar (a posit sign indic node outsid tube neg sign node inside). posit cross-section. b sign nodal distanc valu fig. 38 stl model race car repres complex geometri includ surfac volum area differ length-scal detail background mesh, fig. 39b, c. result number element (1.6 106) remain accept range. particularli interest is, hollow region air duct driver cabin flat spoiler undertrai part gener detect resolved. note, displai featur line relat discret seen fig. 39 comput consequ reconstruct race car base implicit geometri descript background mesh (refer visual approxim immers geometri section visual baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 37 40 fig. 39 surfac approxim race car differ refin background mesh. refin (4.0e4 fluid elements). b 2 level refin (9.5e4 fluid elements). c 5 level refin (1.6e6 fluid elements). d close-up refin immers geometry). result accumul featur line reconstruct element indic indirectli region adapt refin actual refin background mesh. know mean featur lines, conclud fig. 39c, spot race car complex geometri difficult intersect pattern (spoiler, undertray, edges) refin wide surfac area planar parts. expect adapt refin strategy. despit refin far, local approxim error small scale,mostli edg (see close-up fig. 39d). local approxim error appear model contain small detail compar overal dimensions, i.e., resolut background mesh local coarse. fact, error avoid completely, however, refin background mesh, reduc scale impact acceptable. context, fig. 40 show best surfac approximation, obtain race car present work. conclus paper present robust algorithm implicitli triangul geometri tetrahedr background mesh. algorithm base level-set approach combin discontinu continu distanc function. that, allow both, double-sid close geometri singl background mesh, special requir discretization. given close geom- etri involved, rai cast approach suggest distinguish inner outer regions. allow treat individu region separ subsequ computa- baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 38 40 fig. 40 surfac approxim race car massiv refin background mesh (9e6 elements). iso-view. b front-view tional operation. improv respect robust basic rai cast introduc complex case handl practice. overal algorithm reli local definit cut planes. context, import intersect pattern identifi solut approxim proposed. detect actual intersections, octree-bas search algorithm proposed. shown, local descript cut plane major case properli approxim immers boundary. however, case elaborated, proper approxim immers boundari singl cut plane imposs inher depend resolut back- ground mesh. overcom problem increas gener approxim quality, adapt mesh refin propos integr overal algo- rithm. test exampl shown, systemat mesh refin effect appli reduc remain approxim error accept level. uniqu featur propos algorithm abil handl arbitrari shapes, geometri singl background mesh, common model error like gaps, overlap duplic objects. flexibl robust consequ baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 39 40 discontinu distanc formulation, local reduct cut pattern cut plane, rai casting, formul depend surfac normal information. particular advantag algorithm applic practic problems, case present model errors. geometri includ complet race car demonstr discuss context. summary, propos algorithm show solid basi geometri describ implicitli background mesh. typic applic scope immers cfd analysi object complex geometries. that, circumv time-consum imposs creation body-fit mesh cost reduc accuracy. furthermore, worthwhil note, algorithmmai geometry, track geometr changes. therefore, field applic conceivable, fluid-structur interact analysi ultra-lightweight structur shape optim involv big shapemodifications. aforement applic topic futur research. abbrevi cfd: comput fluid dynamics; cad: computer-aid design; mpi: messag pass interface; nurbs: non-uniform ration b-splines; stl: stereolithography; pip: point-in-polygon. author contribut author prepar manuscript. author read approv final manuscript. author detail 1technisch universitt mnchen, arcisstr. 21, 80333 mnchen, germany, 2intern center numer method engin (cimne), technic univers catalonia, campu nort upc, 08034 barcelona, spain. acknowledg author gratefulli acknowledg support european commiss project numexa (fp7-ict 611636) ulit (fp7-sme-2012 ga-314891). compet interest author declar compet interests. avail data andmateri softwar [22] freeli avail bsd license. consent public applicable. ethic approv consent particip applicable. fund applicable. publish note springer natur remain neutral regard jurisdict claim publish map institut affiliations. received: 22 januari 2018 accepted: 4 juli 2018 refer 1. si h. tetgen, delaunay-bas qualiti tetrahedr mesh generator. acm tran math softw. 2015;41(2):1111136. 2. schberl j. netgen advanc 2d/3d-mesh gener base abstract rules. comput vi sci. 1997;1(1):4152. 3. comput geometri algorithm library. 2017. www.cgal.org. access 28 dec 2017. 4. openfoam v5 user guide: mesh gener snappyhexmesh. 2017. snappyhexmesh/. access 28 dec 2017. 5. coll a. advanc gener nonstructur meshes. ph.d. thesis, upc barcelonatech 2014. 6. mittal r, iaccarino g. immers boundari methods. annu rev fluid mech. 2005;37:23961. 7. peskin cs. immers boundari method. acta numer. 2002;11:479517. www.cgal.org baumgrtner et al. adv. model. simul. eng. sci. (2018) 5:21 page 40 40 8. kamenski d, hsu mc, schilling d, evan ja, aggarw a, bazilev y, sack ms, hugh tjr. immersogeometr variat framework fluid-structur interaction: applic bioprosthet heart valves. comput method appl mech eng. 2015;284:100553. 9. codina r, baig j. approxim imposit boundari condit immers boundari methods. int j numer method eng. 2009;80(11):1379405. 10. hansbo p. nitsch method interfac problem comput mechanics. gamm-mitteilungen. 2005;28(2):183206. 11. burman e, clau s, hansbo p, larson mg, mass a. cutfem: discret geometri partial differenti equations. int j numer method eng. 2014;104(7):472501. 12. kim j, kim d, choi h. immersed-boundari finite-volum method simul flow complex geometries. j comput phys. 2001;171(1):13250. 13. parvizian j, dster a, rank e. finit cell method. comput mech. 2007;41(1):12133. s00466-007-0173-y. 14. dster a, parvizian j, yang z, rank e. finit cell method three-dimension problem solid mechanics. comput method appl mech eng. 2008;197(4548):376882. 15. belytschko t, parimi c, mo n, sukumar n, usui s. structur extend finit element method solid defin implicit surfaces. int j numer method eng. 2003;56(4):60935. 16. breitenberg m, apostolato a, philipp b, wchner r, bletzing ku. analysi aid design: nonlinear isogeometr b-rep analysi shell structures. comput method appl mech eng. 2015;284:40157. 10.1016/j.cma.2014.09.033. 17. breitenberg m. cad-integr design analysi shell structures. ph.d. thesis, technisch universitt mnchen 2016. 18. philipp b, breitenberg m, dauria i, wchner r, bletzing k-u. integr design analysi structur membran isogeometr b-rep analysis. comput method appl mechan eng. 2016;303:31240. 19. rossi r, cotela j, lafontain nm, dadvand p, idelsohn sr. parallel adapt mesh refin incompress flow problems. comput fluids. 2013;80:34255. 20. dadvand p, rossi r, oat e. object-ori environ develop finit element code multi-disciplinari applications. arch comput method eng. 2010;17(3):25397. s11831-010-9045-2. 21. dadvand p, rossi r, gil m, martorel x, cotela j, juanper e, idelsohn sr, oat e. migrat gener multi-phys framework hpc environments. comput fluids. 2013;80(supplement c):3019. compfluid.2012.02.004. 22. kratos-multiphysics. 2018. access 4 jan 2018. 23. ausa r, sousa f, buscaglia g. improv finit element space discontinu pressures. comput method appl mech eng. 2010;199:101931. 24. osher s, fedkiw r. level set method dynam implicit surfaces. in: appli mathemat sciences. (springer-verlag new york inc.). new york: springer; 2003. 25. ericson c. real-tim collis detection. in: morgan kaufmann seri interact 3d technology. san francisco: morgan kaufmann; 2005. 26. lhner r. bin: data structur spatial search time-vari data. commun numer method eng. 2006;23(12):11119. 27. munjiza a, andrew krf. nb contact detect algorithm bodi similar size. int j numer method eng. 1998;43(1):13149. 28. munjiza a, rougier e, john nwm. mr linear contact detect algorithm. int j numer method eng. 2006;66(1):4671. 29. bentlei jl. multidimension binari search tree associ searching. commun acm. 1975;18(9):50917. 30. mehta dp, sahni s, handbook data structur applications. in: chapman & hall/crc inform scienc series. new york: chapman & hall/crc; 2004. 31. samet h. foundat multidimension metric data structures. san francisco: morgan kaufmann; 2006. 32. frisken sf, perri rn. simpl effici travers method quadtre octrees. j graph tools. 2002;7(3):111. 33. teschner m, heidelberg b, mller m, pomeranet d, gross m. optim spatial hash collis detect deform objects. in: proceed vision, modeling, visual confer (vmv), vol. 3. munich; 2003. p. 4754. 34. akenine-mlls t. fast 3d triangle-box overlap testing. j graph tools. 2001;6(1):2933. 10867651.2001.10487535. 35. nordbeck s, rystedt b. cartographi point-in-polygon programs. bit numer math. 1967;7(1):3964. 36. huang c-w, shih t-y. complex point-in-polygon algorithms. comput geosci. 1997;23(1):10918. 37. schirra s, reliabl practic point-in-polygon strategies? in: proceed 16th annual european symposium algorithms, berlin, heidelberg: springer; 2008. p. 744755. 38. ishida t, takahashi s, nakahashi k. effici robust cartesian mesh gener building-cub method. j comput sci technol. 2008;2:43546. 39. huang j, yagel r, filippov v, kurzion y. accur method voxel polygon meshes. in: ieee symposium volum visualization. pp. 119126 (1998). 40. appel a. techniqu shade machin render solids. in: proceed spring joint conference, new york: acm, april 30mai 2 1968. p. 3745. 41. nooruddin fs, turk g. simplif repair polygon model volumetr techniques. ieee tran visual comput graph. 2003;9(2):191205. robust algorithm implicit descript immers geometri background mesh abstract introduct implicit geometri represent mean level-set approach octree-bas spatial search determin intersect geometr represent immers object discontinu distanc function comput element distanc visual approxim immers geometri determin cut plane differ intersect pattern approxim planar surfac approxim curv surfac approxim surfac sharp edg approxim case boundari intersect summar strategi determin local cut plane refin strategi improv approxim qualiti identif close region continu distanc function basic rai cast improv non-watertight geometri case includ double-sid geometri exampl immers geometri differ featur challeng surfac geometri close volum geometri combin arbitrarili complex geometri conclus acknowledg refer