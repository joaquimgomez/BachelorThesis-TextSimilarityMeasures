embed techniqu finit element heat flow problem embed discontinu m.davari1, r.rossi2 p.dadvand2 1 depart strength materi structur engineering, polytechn univers catalonia, barcelona, spain 2 intern center numer method engin (cimne), depart strength materi structur engineering, polytechn univers catalonia, barcelona, spain abstract present paper explor solut heat conduct problem consid discontinu embed mesh align arbitrari angl respect mesh edges. altern approach propos solut problem. differ approach compar alternatives, extend finit element method (x-fem), current propos attempt preserv global matrix graph order improv performance. altern compris enrich finit element (fe) space obtain addit new local degre freedom allow captur discontinu element. new degre freedom static condens prior assembly, graph final changed. approach base us modifi fe-shap function substitut standard on cut elements. imposit neumann dirichlet boundari condit consid embed interface. result propos method compar refer solut obtain standard fe mesh contain actual discontinuity. 1. introduct paper focus solut conduct problem domain contain gap prescrib posit space. salient featur work that, instead modifi geometri domain gap model physic boundary, emb geometr descript structur mesh continu gap. introduct gap impli physic solut suffer discontinuity, potenti primari variabl (the temperature) gradients. featur make difficult approxim solut standard, continu fe approach, mesh body-fit gap geometry. well-known approach treatment discontinu element extend finit element method (x-fem) [18]. x-fem numer techniqu enrich function ad fe approxim space provid abil reproduc specif featur solution. enrich normal region near discontinu cracks, holes, similar materi interfaces. x-fem numer model compris type element region near discontinuity: fulli enrich element cut discontinu partial enrich element (blend elements) cut discontinu enrich node (see figur 1). disadvantag standard x-fem special move discontinu mentioned: 1. graph final chang need ad global degre freedom fe approxim space. 2. enrich function consid element contain discontinu element adjac them. figur 1: enrich node element standard x-fem base difficulties, explor us distinct method capabl captur discontinu element issu blend elements. methods, call 'method i' method ii, base us pure local enrich fe space. methods, new functions, control new local degre freedom, ad cut element neighbour element unmodified. moreover, new addit function local cut element, condens final assembly. therefore, graph final changed. method, call 'method iii' paper, base modif nodal shape function sole elements, cut discontinuities. independ specif choic definit improv approxim scheme, new shape function shall guarante regular requir need solut problem interest. conduct problem, requir shape function 1, embed gap. verifi replac shape function consid method iii, enrich explor method ii. practic implic method 'variat crime' invalid avail converg proof. present work heurist method appear work reliabl despit lack guarantee. thus, paper structur follows: begin write govern equat heat conduct problem. section 3, 4, 5 propos methods. discuss imposit neumann dirichlet condit embed boundari section 6. section 7 conclud paper discuss benchmark problems. 2. govern equat heat conduct consid domain 2 shown figur 2 immers discontinu . equat transient heat transfer conduct absenc energi sourc is: . () = 0 (1) t temperature, t time, materi density, cp specif heat, k thermal conductivity. heat equation, type boundari condit considered: = (2) = (3) . = (4) repres wall temperatur impos portion boundari , prescrib temperatur impos (dirichlet type boundari condit ), prescrib heat flux impos (neumann type boundari condition). galerkin fe formul obtain multipli eq. (1) appropri test function w integr comput domain [9]. figur 2: schemat represent heat conduct immers discontinuity. discret variat equat (1) defin appli galerkin weight residu method green theorem shown below: ( , ) + (,) = () (5) test function ( , ) = ( , ) (6) (,) = (, ) (7) () = (, ) (8) determin fe field, solut domain divid set finit number triangl element h. hence, temperatur element interpol nodal valu written as: () =() 3 =1 (9) shape function nodal temperatur node th element. substitut (9) weak form (5), obtain follow matrix form: = + (10) t vector nodal unknown temperatures, c capacit matrix, k stiff conduct matrix, neumann boundari flux term boundari triangl element, extern flux term immers boundari = , = 1,3 (11) = . , = 1,3 (12) = = 1,3 (13) = = 1,3 (14) = = 1,3 (15) differenti eq. (10) integr time. sake simplicity, choos backward euler scheme. result time-discret problem follows: 1 = + (16) 3. method (enrich finit element method) mentioned, seek propos distinct techniqu emb discontinu search space. section, introduc pure local enrich fe space. new degre freedom ad local sole element intersect embed gap, object captur discontinu (kink jumps) solution. enrich basi form combin nodal shape function associ mesh (standard fe part) discontinu shape function associ addit degre freedom (enrich parts). rest elements, standard fe interpol applied. mention [8], possibl wai construct suitabl enrich space (1 apart gap) ad new degre freedom cut element enrich functions. example, field scalar, three-nod triangular element cut int degre freedom node. however, degre freedom element cut (one enrich function captur discontinu element). thus, element adjac cut element enrich node element contain int. words, element cut int immedi neighbour enrich [10]. kei differenti method respect mention [8] enrich function ad cut element new local degre freedom, depend neighbour elements. kei idea exploit new degre freedom pure local, static condens elementari level final assembly. therefore, size graph final linear solv standard case. local approach appeal comput point view, clear that, enrich function zero element boundaries, discontinu solut construct boundari enrich element neighbour. impli 0 continu violat edg intersect interfac (figur 3). hence, variat crime produc propos shape function employed. later 'crime' pai off, satisfactori behaviour test exampl considered, effici implement possibl strict local propos approach. figur 3: continu statement function enrich element let consid piecewis linear approxim temperatur field th(x) defin cut triangular element k. element split sub-el k + k (figur 4). accord splitting, approxim function th compris standard fe enrich part () = () 3 =1 + () 2 =1 + () 2 =1 (17) right-hand equation, term standard fe part, second term enrich part relat weak (kinks) strong (jump) discontinu respectively. individu variabl stand () : approxim function () : standard fe function node : standard temperatur degre freedom node () : local enrich function weak discontinu : addit degre freedom, associ weak discontinu () : local enrich function strong discontinu : addit degre freedom, associ strong discontinu figur 4. typic element subel + interfac . figur 5 show weak strong discontinu shape function typic triangular element. figur 5: addit function contain weak discontinu function (on left side) strong discontinu function (on right side) cut triangular element. hence, defin weak equat element cross interface, decompos weak form equat (10) part test function belong standard enrich part (weak strong ), substitut equat (17) it. result following: ( + + ) [ ( + + ) + ( + + ) ] = (18) ( + + ) [ ( + + ) + ( + + ) ] = (19) ( + + ) [ ( + + ) + ( + + ) ] = (20) here, sub-index s refer standard temperatur degre freedom sub-index e h refer addit degre freedom associ weak strong discontinu respectively. assum equal 1 ( + ), matrix form discret problem be: [ [ ] (33) [ ] (34) [ ] (43) [ ] (44) ] [ ] (71) = [ ] (71) (21) , , valu , current time step and: = 1 + . . . = 1 + . . . = 1 + . . . = 1 + . . . = 1 + . . . = 1 + . . . = 1 + . . . = 1 + . . . = 1 +. . . , = 1,3 , = 1,2 base fact enrich function local element, elimin n elementari level final assembl follow manner: ([ss] [se sh] [ ee eh hh ] 1 [ es hs ])n = + [se sh] [ ee eh hh ] 1 [ ] (22) 4. method ii case, previous, new local enrich shape function added. differ enrich shape function defin basi standard fe shape function () = () +() (23) () standard fe shape function node characterist user function + = { 0 + 1 , = { 1 + 0 advantag altern eas construct enrich functions, readili obtain 3d case. note enrich function sole cut elements; otherwise, origin shape function retrieved. hence, cut triangular element k divid sub-el k + k (figur 4), approxim form discontinu temperatur field () finit element form written () = () 3 =1 + () 3 =1 (24) figur 6 show enrich shape function method typic triangular element. figur 6: enrich function method ii triangl element thus, discret problem (5) decompos test function , belong standard discontinu respectively. problem written as: ( + ) [ ( + ) + ( + +) ] = (25) ( + ) [ ( + ) + ( + ) ] = (26) sub-index s e refer standard addit degre freedom respectively. linear written block as: [ ] [ ] = [ ] (27) , , valu , , current time step , = 1,3 = 1 + . . . = 1 + . . . = 1 + . . . = 1 + . . . mention before, new addit function local element, cut, static condens prior assembly. therefore, similar previou method, size graph final linear solv changed, result in: (ss se[ee] 1es) n = + se[ee] 1 (28) 5. method iii (modifi xfem method) try method propos [11]. instead ad special functions, fe shape function cut element modifi captur discontinu insid element. ad extra degre freedom maintain continu cut borders. modif local comput element element. form nodal basi sens valu correspond node zero nodes. defin them, simpli carri valu node intersect edg eman interface. explanation, consid triangular element abc cut interfac point p q, manner divid subparts, call sub-triangl apq sub- quadrilater bcqp (figur 5). case, assum linear segment. let ta, tb, tc denot nodal valu discret variabl t h, interpol triangl abc. let arbitrarili denot triangl apq 'plus' quadrilater bcqp 'minus' side. approxim discontinuous, plu side, function th need determin plu node (ta). similarly, t h minu depend minu node (tb tc). valu point (p, q) carri node origin triangul ly edg side. therefore, way, plu , valu p q ta, t h constant: = ta (29) similarly, minu side, valu p tb, valu q tc. choos adopt q1 interpol bcqp nodal valu subdivid quadrilater triangles, bcp cqp. instanc minu triangl cqp, th linear function take valu tc vertex c, valu tc vertex q, valu tb vertex p. anyway, nodal valu given, interpol immediate. notic interpol lead th discontinu . function t h, restrict edg triangle, uniqu determin valu node ly endpoint edge. basic function na, nb, nc defin piecewis affin insid sub- triangles, apq, bcp, cqp. remain defin valu vertic sub-triangles, i.e. point a, b, c, p, q. however, discontinu , valu (plu minus) given point p q. valu = 0 (a)cn= 0 (a)bn= 1 (a) na(b) = 0 nb(b) = 1 nc(b) = 0 na(c) = 0 nb(c) = 0 nc(c) = 1 na(p +) = 1 nb(p +) = 0 nc(p +) = 0 na(p -) = 0 nb(p -) = 1 nc(p -) = 0 na(q +) = 1 nb(q +) = 0 nc(q +) = 0 na(q -) = 0 nb(q -) = 0 nc(q -) = 1 signific featur method unlik previou methods, shape function 0 cut border (but int) shape function section origin propos [11] (more details, 3d version basic functions, reference). present section explor applic dirichlet bc cut interfac us penalti approach (see section 5). shape function typic triangular element shown figur 8. figur 7: partit singl finit element sub-el follow interfac pq figur 8: modifi shape function discontinu space addit unknown (use method iii) 6. impos boundari condit discontinu insid element(interface) impos neumann-typ boundari condit interfac cut element straightforward, need comput integr flux interface. particular, applic adiabat boundari condit (zero heat flux), term includ flux interface, s, omitted. imposit dirichlet boundari condit is, hand, littl involv node present boundari strongli appli condition. specif techniqu implement dirichlet boundari condit x-fem proposed, lagrang multipli method [1215], penalti method [16], nitsch method [1719]. case, lagrang multipli method consid methods, penalti method chosen method order ensur enrich variabl assum desir valu boundary. 6.1: implement lagrang multipli method method i, addit degre freedom lagrangian multipli order impos dirichlet constraint, e.g. zero valu temperatur interface. let consid triangular fe mesh contain discontinu . know, function discontinu interfac decompos sub-interfac + (see figur 9). approach implement integr point sub-interfac + . figur 9: triangl element contain int gauss point sub-el int + int hence, ad lagrang multipli term equat (21), form enrich variabl lagrang multipli written block follow manner: [ [ ] (33) [ ] (34) [ ] (34) [ ] (43) [ ] (44) [ ] (44) [ ] (43) [ ] (44) [ 0 0 0 0 ] (44) ] x [ ] (111) = [ 0 0 ] (111) (30) + + + = 1,2 = 1,3 + + + = 1,2 = 1,3 + + + , = 1,2 + + + , = 1,2 + + + , = 1,2 import point case, enrich local, defin addit lagrangian multipli local enrich element, static condens form enrich variabl lagrang multipliers. note gener possibl (sinc diagon block correspond lagrang multipli zero). possibl case sole condens local enrich unknown lagrangian multiplier. obviou advantag global matrix modified, local contribut adjust enforc desir dirichlet constraint. result condens follows: ( [] [ ] [ 0 0 0 0 ] 1 [ ] ) n = + [ ] [ 0 0 0 0 ] 1 [ 0 0 ] (31) 6.2: implement lagrang multipli method ii method, fact enrich function added, degre freedom lagrangian multipliers, order impos dirichlet constraint. thus, matrix form (27) rewritten [ [ ] (33) [ ] (33) [ ] (33) [ ] (33) [ ] (33) [ ] (33) [ ] (33) [ ] (33) [ 0 0 0 0 ] (33) ] x [ ] (91) = [ 0 0 ] (91) (32) + + + , = 1,3 = , = 1,3 + + + , = 1,3 6.3: implement penalti method iii state earlier, method iii enrich function ad captur discontinu (see section 5). practic consequ static condens procedur emploi altern viabl here. reason, penalti method chosen enforc dirichlet boundari condition. explication, liner equat kt=f, penalti method appli boundari condit larg number modifi stiff matrix right-hand vector (k+)t = f+ (33) = + + + = + + + 7. exampl section 1. exampl 1 heat conduct domain (0,6) (0,6) cut immers discontinu int consid (see figur 10). thermal conduct k entir domain temperatur set boundari bottom, analyt exact solut zero-prescrib temperatur impos interfac ( = 0) be: { 1 ( 1 ) < 0 = 2 ( ) ( ) > figur 11 12 behaviour temperatur obtain method i, ii, iii comparison exact solut coars mesh. note temperatur distribut exactli match expect outsid cut elements. behaviour contour line cut element pure visual artefact. area, post-processor assum result interpol linearli nodal results, produc shown distribut unabl account presenc enrich functions. figur 10: geometr boundari condit heat conduct domain immers discontinu (mesh size = 1.0) figur 11: contour line temperatur zero-prescrib temperatur impos interfac figur 12: comparison temperatur field method i, ii, iii exact solut valu temperatur (sai zero) impos interfac (mesh size = 1.0) figur 13: converg rate error l2-norm nodal temperatur element respect mesh iter method iii figur 11, result obtain method ii exact, method iii show accept result (the interpol error l2()-norm order 2 , figur 13). mean temperatur set zero interface, method iii valu temperatur origin node element zero shape function. contrast, method ii, valu temperatur origin node obtain temperatur zero interface. 2. exampl 2 consid stationari heat conduct domain similar previou exampl boundari conditions, discontinu immers domain (see figur 14). temperatur (dirichlet boundari condition) gradient (neumann boundari condition) enforc zero separ int. result obtain propos method compar result classic fe method discontinu match mesh (see figur 15). comparison shown figur 1623. figur 14: mesh boundari condit thermal domain embed interfac conform element edg (mesh size = 0.22) figur 15: mesh boundari condit thermal domain interfac (gap) fit mesh (mesh size = 0.22) figur 16: contour line temperatur neumann boundari condit impos (. = 0) interfac (mesh size equal 0.22) figur 17: comparison temperatur field section 1-1 method i, ii, iii, classic fe method (mesh size = 0.22) figur 18: contour line temperatur neumann boundari condit impos (. = 0) interfac (mesh size equal 0.055) figur 19: comparison temperatur field section 1-1 method i, ii, iii, classic fe method (mesh size = 0.055) figur 20: contour line temperatur valu temperatur impos zero ( = 0) interfac dirichlet boundari condit (mesh size = 0.22) figur 21: temperatur field (at section 1-1) valu temperatur impos zero interfac (mesh size = 0.22) figur 22: contour line temperatur temperatur valu impos zero ( = 0) interfac dirichlet boundari condit (mesh size = 0.055) figur 23: temperatur field (at section 1-1) temperatur valu impos zero interfac (mesh size = 0.055) results, discontinu immers adiabat boundari condit temperature, method iii better converg coars mesh, method ii shown better result size mesh decreases. however, zero- prescrib temperatur (dirichlet boundari condition) impos interface, propos method shown accur coars fine mesh. result agre expectation. explanation, poor converg method iii happen concept modifi shape function, method (see section 5). therefore, valu temperatur zero interfac cut element. contrast, method ii temperatur triangl node calcul valu temperatur zero exactli interface. 3. exampl 3 experience, investig heat conduct problem domain geometry, embed diagon discontinu cut domain. mesh boundari condit domain shown figur 24. gradient temperatur set zero embed discontinuity. end, result propos method compar refer solut discontinu fit mesh (see figur 25-31). figur 24: mesh boundari condit domain embed diagon discontinu (mesh size = 0.22) figur 25: mesh boundari condit domain gap (discontinuity) fit mesh (mesh size = 0.22) figur 26: contour line temperatur field discontinu immers adiabat boundari condit temperatur (mesh size equal 0.22) figur 27: discontinu temperatur field neumann boundari condit impos (mesh size equal 0.22) figur 28: comparison temperatur field section 22 propos method classic fe method (mesh size = 0.22) figur 29: contour line temperatur field discontinu immers adiabat boundari condit temperatur (mesh size equal 0.055) figur 30: discontinu temperatur field neumann boundari condit impos interfac (the mesh size equal 0.055) figur 31: comparison temperatur field section 22 propos method classic fe method (the mesh size = 0.055) figur 32: converg rate error l2-norm nodal temperatur element respect mesh iter method i, ii, iii evid figur 32, result obtain domain gap (discontinu fit mesh) select refer solutions, converg rate interpol error method ii show higher order method iii. 4. exampl 4 example, consid heat conduct flow comput domain contain curv discontinu instead straight one. similar previou examples, valu chosen thermal conduct k entir domain. temperatur boundari set 10 20 respect (see figur 33). neumann dirichlet boundari condit impos embed interfac separately. temperatur field obtain propos method compar correspond classic fe method mesh body-fit gap geometri (see figur 34). result shown figur 3542. clear that, method shown accept behaviour near interfac (except tip embed interface), method ii exhibit significantli better behaviour method iii. note tip interface, propos method exhibit differ conform mesh method. differ occur failur choos cut element tips. words, element cut complet enriched, contain tip cut interfac completely. hence, element consid normal, non-cut elements. figur 33: mesh boundari condit flow domain curv discontinu fit mesh (mesh size = 0.22) figur 34: mesh boundari condit flow domain gap fit mesh (mesh size = 0.22) figur 35: temperatur field heat conduct flow heat flux set zero (t. n = 0) interfac (mesh size equal 0.22) figur 36: comparison temperatur field section 33 heat flux set zero (t. n = 0) interfac (mesh size = 0.22) figur 37: temperatur field heat conduct flow heat flux set zero (t. n = 0) interfac (mesh size equal 0.055) figur 38: comparison temperatur field section 33 heat conduct flow heat flux set zero (t. n = 0) interfac (mesh size equal 0.055) figur 39: temperatur field heat conduct flow zero-prescrib temperatur (tint = 0) impos interfac (mesh size equal 0.22) figur 40: comparison temperatur field section 33 heat conduct flow zero-prescrib temperatur impos interfac (mesh size = 0.22) figur 41: temperatur field heat conduct flow zero-prescrib temperatur impos interfac (mesh size = 0.055) figur 42: comparison temperatur field section 33 heat conduct flow zero-prescrib temperatur impos interfac (mesh size = 0.055) conclus embed method propos heat conduct problem embed discontinu align arbitrari angl respect mesh edges. compris local enrich fe space. approach add addit degre freedom local object captur discontinu element. case, order impos dirichlet constraint, lagrang multipli method considered. featur method form enrich variabl lagrang multipli static condens prior assembly. second method, similar one, consist enrich fe space. method differ method fact enrich function obtain incorpor characterist user function standard nodal shape functions. thus, enrich function captur discontinu element (we add new addit degre freedom). here, lagrang multipli addit degre freedom static condens final assembly, method. method have abil captur discontinu element enrich function local modif nodal shape function element explored. penalti method chosen impos dirichlet boundari condit interface. therefore, size graph final linear changed. comput cost reduc omiss re-calcul matrix graph. obviou advantag method, compar cases, c0 continu ensur adjac elements. so, final conclud methods, comput cost reduc size graph final linear kept standard case; methods, add new function amplitud govern intern degre freedom depend neighbour elements; method c0 continu violat edg intersect interface, seen method appear work satisfactorili real case despit defect; method accept result exhibit potenti suitabl altern exist fe space embed discontinuities. acknowledg author wish acknowledg support erc ulit (fp7-314891), numexa (fp7-611636) realtim (fp7-246643) project refer 1. sven, g. r. arnold, extend pressur finit element space two-phas incompress flow surfac tension. 2007, academ press professional, inc. p. 40-58. 2. sawada, t. a. tezuka, llm x-fem base interfac model fluid structur interact non-interface-fit mesh. comput mechanics, 2011. 48(3): p. 319- 332. 3. motasoares, c.a., et al., enrich space-tim finit element method fluid-structur interact - i: prescrib structur displacement, iii european confer comput mechanics. 2006, springer netherlands. p. 399-399. 4. henning, s. f. thomas-peter, extend finit element method two-phas free-surfac flows: systemat study. 2011, academ press professional, inc. p. 3369- 3390. 5. fries, t.-p. t. belytschko, extended/gener finit element method: overview method applications. intern journal numer method engineering, 2010. 84(3): p. 253-304. 6. coppola-owen, a.h. r. codina, improv eulerian two-phas flow finit element approxim discontinu gradient pressur shape functions. intern journal numer method fluids, 2005. 49(12): p. 1287-1304. 7. chessa, j. t. belytschko, extend finit element method two-phas fluid. journal appli mechanics, 2003. 70: p. 10-17. 8. belytschko, t., et al., arbitrari discontinu finit elements. intern journal numer method engineering, 2001. 50: p. 9931013. 9. o.c. zienkiewicz r.l. taylor, finit element method-th basis. 2000, oxford,: butterworth-heinemann. 10. chessa, j., p. smolinski, t. belytschko, extend finit element method (xfem) solidif problems. intern journal numer method engineering, 2002. 53: p. 19591977. 11. ausas, r.f., f.s. sousa, g.c. buscaglia, improv finit element space discontinu pressures. method appli mechan engineering, 2010. 199: p. 1019-1031. 12. sebastian, k. m. kurt, levelset base fluid topolog optim extend finit element method. structur multidisciplinari optim 2012. 46(3): p. 311 - 326. 13. rivera, c.a., et al., parallel finit element simul incompress viscou fluid flow domain decomposit lagrang multipliers. journal comput physic 2010. 229(13): p. 5123-5143. 14. belytschko, t., y. lu, y, l. gu, element free galerkin methods. intern journal numer method engineering, 1994. 37(2): p. 229256. 15. belgacem.f.b, mortar finit element method lagrang multipliers. numerisch mathematik, 1999. 84. 16. zhu, t. s.n. atluri, modifi colloc method penalti formul enforc essenti boundari condit element free galerkin method. comput. mech., 1998. 21(3): p. 211-222. 17. hansbo.a hansbo.p, unfit finit element method, base nitsche' method, ellipt interfac problems. method appli mechan engineering, 2002. 191: p. 5537 - 5552. 18. griebel, m. m.a. schweitzer, particle-partit uniti method. v: boundari conditions, in: s. hildebrandt, h. karcher (eds.), geometr analysi nonlinear partial differenti equations. springer, 2002: p. 517540. 19. babuska, i., u. banerjee, j.e. osborn, meshless gener finit element methods: survei major results, in: m. griebel, m. a. schweitzer (eds.), meshfre method partial differenti equations. lectur note comput scienc engineering, springer-verlag, 2001. 26: p. 120. ,-. repres wall temperatur impos portion boundari ,-., ,-. prescrib temperatur impos ,-. (dirichlet type boundari condit ), ,-. prescrib heat flux impos ,...