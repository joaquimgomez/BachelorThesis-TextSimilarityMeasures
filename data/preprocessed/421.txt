comput mechan manuscript no. (will insert editor) finit element model intern multipl local crack savva saloustro luca pel miguel cervera pere roca date receipt accept insert later abstract track algorithm constitut effici numer techniqu model fractur quasi- brittl materials. succe repres local crack numer model mesh-induc di- rection bias. current avail track algorithm import limitation: crack origin ei- ther boundari discret domain predefin crack-root element prop- agat orientation. paper aim cir- cumvent drawback propos novel track algorithm simul crack start point mesh propag orientations. enhanc allow simul structur case-studi experienc multipl cracking. propos approach valid simu- lation benchmark exampl experiment test structur frame in-plan loading. mesh- bia independ numer solution, computa- tional cost predict collaps mechan track algorithm discussed. savva saloustro luca pel miguel cervera pere roca depart civil environment engin technic univers catalonia, upc-barcelonatech jordi girona 1-3, 08034 barcelona, spain. intern center numer method engin (cimne) gran capit, s/n, 08034 barcelona, spain. e-mail: e-mail: e-mail: e-mail: keyword continuum damag mechan crack- track damag local quasi-brittl materi shear/flexural/tensil crack 1 introduct half centuri pioneer work ngo & scord [1] rashid [2], numer simul crack quasi-brittl materi challeng- ing task. wide rang novel formul propos field comput fail- ur mechanics, date thing panacea realist effici numer analy- si failur quasi-brittl materials. fact, analyst consid aspect choos adequ numer tool: realist nu- meric model cracking, accur simul materi behaviour bearabl computa- tional cost. realist model crack impli loca- tion direct crack spurious affect mesh topology. situat commonli refer mesh-induc direct bias. depen- denci numer simul mesh common limit smear discret crack approach [3]. defect trigger research, first, possibl limit numer dis- crete problem and, second, adequ remedi overcom them. propos solut depend percept origin numer problem. approach interven mathemat formul continuum problem, gradient-enhanc [4, 5], non-loc [6, 7] micropolar [8, 9] models. formul aim overcom error produc spatial discret continuum domain, 2 savva saloustro et al. mix formul [10], crack-track techniqu [11, 12, 13, 14] [15, 16, 17] enrich finit element nodes. finally, approach report literatur base modif materi model [18]. review issu interest reader refer [19, 20]. equal import numer object model cracking, accur simul materi behaviour. descript mechani- cal behaviour quasi-brittl materi necessit proper failur criterion constitut law soft- en behaviour control fractur energy. account behaviour model ap- pli simul quasi-brittl materi base plastic [21, 22, 23], continuum damag model [24, 25] combin [26, 27, 28]. pre- viou isotrop formul complement anisotrop model [29, 30, 31]. years, increas effort develop numer- ical method consid interact compo- nent composit materi (e.g. concrete, masonry). methodolog base comput ho- mogen [32, 33, 34, 35, 36, 37, 38], micro- model techniques, known direct numer simulations, includ inform ma- terial micro-structur [39, 40]. micro- multi-scal model approaches, sophist character remark level accuracy, hardli applica- ble studi large-scal structur problem ex- perienc multipl cracking. signifi- comput cost requir models. consequence, continuum finit element model (also known macro-modelling) base classi- cal smear crack-approach foreground applic large-scal concret [41] masonri structur [42, 43, 44]. aim work appli know-how object mesh-loc approach analysi structur quasi-brittl materi expe- rienc multipl cracking. adopt numer tech- niqu classic smear crack approach enhanc local crack-track algorithm [16]. choic justifi follow reasoning. firstly, track algorithm provid numer solut free mesh-induc direct bia [45, 16, 17, 46, 47, 48]. secondly, particular track algorithm ef- fectiv combin constitut model suitabl quasi-brittl materials, like anisotrop [31, 49] isotrop on [26]. additionally, import featur algorithm possibl defin minimum distanc discret cracks. exclus zone surround crack render possibl con- sider indirectli size materi mesoscal (e.g. masonri units), composit simplifi homogen continuum numer simulation. finally, overhead comput cost lim- ited, allow effici simul multipl crack- ing problem large-scal structures. date approach track algorithm focus crack nucleat bound- ari domain pre-exist flaw prop- agat singl orient (see instanc [46, 47, 50, 51, 52, 53]). confin applic track algorithm narrow famili structur prob- lems, origin crack known prior analysis, impos includ materi geometr perturb analys nu- meric domain. additionally, structur problem crack start arbitrari point analys domain propag opposit ori- entat addressed. main novelti present work resid enhanc crack-track algorithm techniqu allow initi propag crack element discret domain. particular, propos methodolog extend us local crack-track algorithm simul crack start interior discret domain propag opposit orienta- tions. novel contribut origin methodol- ogi [16] make possibl effici simul local- iz crack shear, flexur traction, priori definit locat analyst. origin aspect propos method identif potenti crack path prior oc- currenc damage, differ approach recent propos [54]. paper structur follow way. section 2 present underli continuum damag model. section 3 outlin methodolog simul format propag intern crack us crack-track algorithm. propos numer strategi valid simul single-crack problem intern fractur (brazilian split test) analysi complex multi-crack problem (frame wall one-door open- ing test horizont loading), section 4. finally, conclus summar section 5. 2 continuum damag model work, constitut model base con- tinuum damag mechan present [25] simul fracture. model benefit us separ damag scalar index distinguish finit element model intern multipl local crack 3 tensil compress damage. im- portant characterist simul degrad materi concret masonri differ capac tension compression. local model base concept propos lee & fenv [27], comi & perego [55], wu et al. [28], pel et al. [56], voyiadji et al. [57], mazar et al. [58]. et al. [59] pereira et al. [60] recent propos nonloc counterpart models. constitut model establish concept effect stress tensor , base strain equival principl [61] relat strain tensor accord follow equat = c : (1) c stand isotrop linear-elast consti- tutiv tensor (:) tensor product contract indices. aim model differ respons tension compression, effect stress split tensil + compress . tensor respect defin + = 3 j=1 jpj pj (2) = + (3) j stand j-th princip stress valu tensor pj unit vector respect prin- cipal direct j. symbol denot macaulai bracket (x = x, x 0 ,x = 0, x < 0). follow that, intern damag variabl introduc d+ d, denot ten- sile damag second compress one. constitut relat express = (1 d+)+ + (1 d) (4) loading, unload reload condit dis- tinguish us scalar posit quantities, tension + second compress , term equival stresses. valu depend stress tensor assum failur criteria. work, failur criterion present [26] valu equival stress tension compress + = h [max] 1 1 [ 3j2 + i1 + max ] f+ f (5) = h [min] 1 1 [ 3j2 + i1 + max ] (6) = ( fb /f ) 1 2 ( fb /f ) 1 (7) = (1 ) f f+ (1 + ) (8) equat fb f biaxial uniaxi compress strength respectively, i1 de- note invari effect stress tensor, j2 second invari effect deviator stress tensor, max min stand maximum minimum princip stress respectively. failur surfac case plane stress shown fig- ur 1. h [] denot heavisid step function. tensil damag activ stress state first, sec- ond fourth quadrant princip stress space, figur 1, compress damag stress state quadrant. 1 = 3 1 /f + 3 /f + 2 = 0 fig. 1: adopt damag surfac plane-stress con- dition [26]. damag criteria defin [62] ( r, ) = r 0 (9) r intern stress-lik variabl repres current damag threshold respect ex- pansion damag surface. consequence, initi valu equal uniaxi stress ten- sion r+0 = f + compress r0 = f vari accord r = max [ r0 , max i(0,n) ( )] (10) evolut intern damag variabl d defin [63] d = 1 r0 r exp { 2hd ( r0 r r0 )} (11) 4 savva saloustro et al. equat (11), hd 0 stand discret soften parameter, includ ensur mesh- size object result consid compress tensil fractur energi materi gf char- acterist finit element length. particular, spe- cific dissip energi (i.e. dissip energi unit volume) tension compress d regular consid characterist crack width ldi relat area (for two-dimension elements) volum (for three-dimension elements) finit element crack band accord equat [64] dldi = g f (12) specif dissip energi damag model exponenti soften [65] d = ( 1 + 1 hd ) (f) 2 2e (13) equat (12) (13) previous intro- duce soften paramet defin hd = ldi lmat ldi (14) current work, two-dimension linear trian- gular element ldi = 2a, de- note area element. select refin accord work oliv [66]. mate- rial characterist length lmat discret soften parameterhmat depend materi properti accord [16, 65] lmat = 1 hmat = 2egf (f) 2 (15) note regular stress versu strain mod- els, present one, shown equival traction versu displac jump model fractur mechan [67], x-fem e-fem formul [68]. 3 model crack local track techniqu discuss introduction, current avail crack-track algorithm focu simu- lation crack start boundari dis- cretiz domain propag singl ori- entation. drawback limit applic algorithms, analysi structur experienc intern crack shear cracks. overcom limitation, work local-crack track algorithm present cervera et al. [16] adequ enhanc simul crack initi intern element mesh propag opposit orientations. section present main featur algorithm fo- cuse novel contributions. method appli constant strain node element extend type two-dimension fi- nite element (see [17]). local crack-track algorithm constitut enhanc classic smear crack approach. algorithm call begin load increment numer analysi prior eval- uation stresses. purpos identifi label element pertain crack path current increment. elements, evalu stress comput accord nonlinear constitut law defin section 2. contrariwise, element fall crack path linear elast stress-strain relation. procedur carried-out crack-track algorithm identif new cracks. new crack start element accord tensil dam- ag criterion defin equat (5) (9). check perform dis- cretiz domain element ly boundari exist crack-track algorithms. necessari identifi allow initi intern cracking. element satisfi failur criterion equat (9) (+ = 0) defin crack root elements. control damag dispers small discret domain, simul separ individu cracks, possibl us exclus radiu criterion. criterion, in- troduc [16], defin crack root element highest valu tensil equival stress + radiu rexcl (see figur 2a). valu rexcl defin priori, accord mesoscal geometri heterogen material. follow procedure, coordin crack origin defin stored. depend locat crack root element dis- cretiz domain. famili intern crack root elements, crack origin defin centroid triangular element, i.e. intersect point median (figur 2a). hold corner ele- ments, remain boundari element midpoint ly mesh boundari selected. second algorithm, defi- nition crack root crack tip elements, identif follow element pertain crack path. procedur differ crack root elements, i.e. boundari intern ones. finit element model intern multipl local crack 5 fig. 2: simul intern crack crack-track technique: (a) intern crack root element opposit vector crack propagation, (b) label potenti element crack, (c) label potenti element second crack us maximum curvatur criterion. boundari crack root element, vector drawn, start crack origin location, direct perpen- dicular defin maximum princip stress. intersect vector neigh- bour element defin exit point po- tential element crack. similarly, start point follow potenti element crack recognised. procedur follow identifi propag path consolid crack crack tip elements. case crack ori- gin point exit point crack previou crack element. contrarili crack start boundary, cracks, shear ones, initi in- terior propag opposit orientations. account damag typology, algorithm enhanc differ procedure. start crack origin point intern crack root element, vector ( v e,1) ( v e,2) defined, have direct perpendicular maximum prin- cipal stress opposit orient (figur 2a). fol- low this, identif potenti crack element current increment take steps. first, element pertain path defin orient vector ( v e,1) identifi start- ing crack origin point follow process describ boundari crack root element (figur 2b). conclud label to- ward crack, element ly opposit face recognis start crack origin point intern crack root, orient vector ( v e,2) (figur 2c). figur 3 present main step label case inter- nal cracks. describ procedur definit crack propag stop altern conditions: (i) potenti element belong differ crack, i.e. crack join (meet criterion figur 3); (ii) crack reach mesh boundari (boundari criterion figur 3); (iii) stress-stat potenti element lower pre-defin threshold (stress threshold criterion figur 3). threshold conveni de- fine term failur criterion experi demonstr label complet inequ + f+ < 0.75 hold [16]. select element crack depend local valu stress justifi local natur present crack-track algorithm. choic conveni term computa- tional effici case multipl crack com- pare global crack-track algorithm [16], meet difficulti bend stress states, local calcul princip stress di- 6 savva saloustro et al. fig. 3: flowchart includ main step crack-track algorithm identif crack path start interior discret domain. rection rel poor high stress- gradients, result spuriou chang crack di- rection. avoid non-realist result, algorithm enhanc procedur apropo correc- tion crack propagation. procedure, term maximum curvatur criterion, activ el- ement ly propag crack select potenti element. idea compar crack direct defin crack-tip element ( ve), accord princip stresses, direct vectori sum crack direct ( vc) potenti damag element neighbourhood radiu rneigh (see figur 2c). rel angl larger maximum angl amax, vector vc definit crack direction. valu rneigh amax explicitli pre-defined. conclud procedur crack root crack tip elements, crack-track algo- rithm ends. element label potential, damag ones, allow damag accord constitut model describ section 2. rest, stress-strain relationship remain linear elast current load increment. flexibl design format present algo- rithm allow possibl enhanc account divers problems. branch criterion crack- root/tip element allow simul crack- branch problems. however, develop reli- abl criteria necessari success combin track algorithm [20]. import ex- tension, current develop authors, concern model intersect cracks. im- provement allow simul problem includ- ing load-revers (e.g. seismic actions). 4 numer exampl section present exampl demonstr capac propos crack-track algorithm simul intern multipl local fractur quasi- brittl materials. brazilian split finit element model intern multipl local crack 7 test, case intern crack propag to- ward end test specimen. second frame wall door opening, test in-plan loading. exampl demonstr ca- paciti propos techniqu simul boundary, intern multipl local cracks. 4.1 benchmark mesh objectivity: brazilian split test numer applic consid simula- tion brazilian split test. exampl objectives. firstly, valid capac propos algorithm simul crack initi interior discret domain propa- gate opposit orientations. secondly, in- vestig depend approach mesh discretization, term direct size finit elements. finally, provid inform comput cost induc us track algorithm. fig. 4: geometri test scheme brazilian split test. 4.1.1 experiment set-up failur pattern brazilian split test, test specimen circular cross-sect diamet d depth l (figur 4). test consist appli compress forc diamet test cylind failur occurs. failur pattern character tensil crack, start interior test specimen propag boundari fol- low direct appli compress forces, i.e. diamet test specimen. ob- tain valu maximum load defin split tensil strength test material. brazilian split test standard method es- timat split tensil strength geomateri concret [69] rock [70]. 4.1.2 numer simul dimens consid numer simula- tion, respect figur 4, d = 15 cm, = d/10 = 1.5 cm. cylind analys plane strain conditions. typic materi properti con- crete adopted: e = 30.1 gpa, f+ = 2.2 mpa, v = 0.25, f = 20 mpa, = 2400 kg/m3, g+ = 50 j/m2, g = 15000 j/m2. track pa- ramet rexcl= 0.5 cm, amax = 45 rneigh = 0.5 cm. experi simul impos vertic displac upper bear plate. numer solut discret problem perform step-by-step manner. step, correspond- ing nonlinear equat solv us newton-raphson method line-search pro- cedure. converg increment attain ratio iter residu forc norm total extern forc lower 103 (0.1%). numer calcul perform enhanc version finit element programm comet [71], pre- post-process gid [72]. softwar develop intern cen- ter numer method engin (cimne), barcelona. 4.1.3 mesh-induc bia section focus sensit numer solut typolog discretization, term orient size finit elements. figur 5 present mesh study- ing depend numer solut direct mesh. discret unstructur manner averag element sizes, region damag expected, he=0.5 cm (984 nodes, figur 5a) he=0.25 cm (1711 nodes, figur 5b), respectively. region discret structur manner meshes, averag element size he=0.5 cm. note mesh design avoid align predomi- nant direct triangular element ver- tical axis, crack expect occur. capabl numer 8 savva saloustro et al. x y z 0 0 0 0 0 0 0 0 0 0 0 gid x y z 0 0 0 0 0 0 0 0 0 0 0 gid x y z 0 0 0 0 0 0 0 0 0 0 0 gid x y z 0 0 0 0 0 0 0 0 0 0 0 gid mesh-a mesh-b mesh-cii mesh-d (a) (b) (c) (d) fig. 5: mesh mesh-induc direct bia study. mesh-a mesh-b mesh-cii mesh-d x y z 0.099818 0.99818 0.89836 0.79854 0.69872 0.59891 0.19964 0.49909 0.39927 0.29945 0 gid x y z 0.099958 0.99958 0.89963 0.79967 0.69971 0.59975 0.19992 0.49979 0.39983 0.29988 0 gid x y z 0.09999 0.9999 0.89991 0.79992 0.69993 0.59994 0.19998 0.49995 0.39996 0.29997 0 gid x y z 0.099313 0.99313 0.89382 0.7945 0.69519 0.59588 0.19863 0.49656 0.39725 0.29794 0 gid (a) crack-track x y z 0.099789 0.99789 0.8981 0.79831 0.69852 0.59873 0.19958 0.49894 0.39915 0.29937 0 gid x y z 0.099934 0.99934 0.89941 0.79947 0.69954 0.59961 0.19987 0.49967 0.39974 0.2998 0 gid x y z 0.098389 0.98389 0.8855 0.78711 0.68872 0.59033 0.19678 0.49195 0.39356 0.29517 0 gid x y z 0.09909 0.9909 0.89181 0.79272 0.69363 0.59454 0.19818 0.49545 0.39636 0.29727 0 gid (b) crack-track fig. 6: mesh-induc direct bia sensitivity. contour tensil damag index (d+) peak load differ meshes: (a) crack-track algorithm, (b): crack-track algorithm. techniqu provid mesh-bia independ results. particular, structur mesh mesh-c (994 nodes, figur 5c) side rectangular triangl creat angl -10, 80, 125 horizont axis. structur mesh mesh-d (1016 nodes, fig- ur 5d) structur region split two, triangl lower mirror on upper part. figur 6 present contour d+ tensil dam- ag index analys us propos track algorithm. result us- ing classic smear crack approach present larg spread damag discret domain. addition, local damag depend spurious mesh. better visualis plot maximum princip strains, figur 7. us track algorithm successfulli address aforement flaw classic smear crack ap- proach, result vertic crack eman interior mesh propag load direct meshes. apart sensit numer solut direction mesh, effect finit element size investigated. aim, simula- tion perform addit mesh keep mesh-orient mesh-c, chang size finit elements. mesh-c mean el- ement size he=0.075 m (384 nodes, figur 8a), mesh-c he=0.025 m (1983 nodes, figur 8c). refin mesh posit effect simul expect crack direct classic smear crack-approach (figur 9a 10a). finit element model intern multipl local crack 9 mesh-a mesh-b mesh-cii mesh-d x y z 0.0007423 0.0075351 0.0067803 0.0060256 0.0052708 0.0045161 0.0014971 0.0037613 0.0030066 0.0022518 -1.246e-05 gid x y z 0.0014385 0.014912 0.013415 0.011918 0.010421 0.0089239 0.0029355 0.0074268 0.0059297 0.0044326 -5.8637e-05 gid x y z 0.0014656 0.014761 0.013284 0.011807 0.010329 0.008852 0.0029429 0.0073748 0.0058975 0.0044202 -1.166e-05 gid x y z 0.00037873 0.0039188 0.0035255 0.0031321 0.0027388 0.0023454 0.00077207 0.0019521 0.0015588 0.0011654 -1.4613e-05 gid(a) crack-track x y z 0.00067703 0.006822 0.0061393 0.0054565 0.0047737 0.0040909 0.0013598 0.0034081 0.0027254 0.0020426 -5.7514e-06 gid x y z 0.001215 0.012905 0.011606 0.010307 0.0090081 0.0077092 0.0025138 0.0064104 0.0051115 0.0038127 -8.3859e-05 gid x y z 0.0003322 0.0033494 0.0030142 0.0026789 0.0023437 0.0020084 0.00066745 0.0016732 0.0013379 0.0010027 -3.0412e-06 gid x y z 0.00034331 0.0034602 0.0031139 0.0027676 0.0024213 0.0020749 0.00068964 0.0017286 0.0013823 0.001036 -3.0143e-06 gid(b) crack-track fig. 7: mesh-induc direct bia sensitivity. contour maximum princip strain (max) peak load differ meshes: (a) crack-track algorithm, (b): crack-track algorithm. x y z 0 0 0 0 0 0 0 0 0 0 0 gid x y z 0 0 0 0 0 0 0 0 0 0 0 gid x y z 0 0 0 0 0 0 0 0 0 0 0 gid mesh-c mesh-c mesh-c (a) (b) (c) fig. 8: mesh mesh-siz sensit study. vertic crack simulated, finer mesh, spuriou spread damag local band reduc mesh refin (figur 9a). hand, us track algorithm predict expect vertic crack pattern independ discret size (figur 9b figur 10b. tabl 1 present comparison peak load obtain perform analysi analyt solution. calcul formula propos [69, 70] p/l = dfsp 2 (16) p/l capac unit length fsp split tensil strength. valu consid equal fsp = f+/0.9 accord eurocod 2 [73]. good agreement analyt result achiev track algorithm used. contrariwise, larg spread damag numer solut track algorithm lower unrealist capac- iti specimen. 4.1.4 comput cost tabl 2 present comput cost, term time memori resources, need perform analys tracking-algorithm. numer analys perform singl machin equip intel core i7-4790-3.60ghz cpu 16.0 gb ram. 10 savva saloustro et al. mesh-c mesh-c mesh-c x y z 0.099698 0.99698 0.89729 0.79759 0.69789 0.59819 0.1994 0.49849 0.39879 0.2991 0 gid x y z 0.09999 0.9999 0.89991 0.79992 0.69993 0.59994 0.19998 0.49995 0.39996 0.29997 0 gid x y z 0.099998 0.99998 0.89998 0.79998 0.69999 0.59999 0.2 0.49999 0.39999 0.29999 0 gid (a) crack-track x y z 0.099508 0.99508 0.89557 0.79606 0.69656 0.59705 0.19902 0.49754 0.39803 0.29852 0 gid x y z 0.098389 0.98389 0.8855 0.78711 0.68872 0.59033 0.19678 0.49195 0.39356 0.29517 0 gid x y z 0.099919 0.99919 0.89927 0.79935 0.69943 0.59952 0.19984 0.4996 0.39968 0.29976 0 gid (b) crack-track fig. 9: mesh-siz sensitivity. contour tensil damag index (d+) peak load differ meshes: (a) crack-track algorithm, (b): crack-track algorithm. mesh-c mesh-c mesh-c x y z 0.00043921 0.0044836 0.0040342 0.0035848 0.0031355 0.0026861 0.00088858 0.0022367 0.0017873 0.001338 -1.017e-05 gid x y z 0.0014656 0.014761 0.013284 0.011807 0.010329 0.008852 0.0029429 0.0073748 0.0058975 0.0044202 -1.166e-05 gid x y z 0.0035159 0.035239 0.031714 0.02819 0.024665 0.02114 0.0070407 0.017615 0.01409 0.010566 -8.8677e-06 gid(a) crack-track x y z 0.00035163 0.0036729 0.0033038 0.0029348 0.0025658 0.0021968 0.00072066 0.0018277 0.0014587 0.0010897 -1.7391e-05 gid x y z 0.0003322 0.0033494 0.0030142 0.0026789 0.0023437 0.0020084 0.00066745 0.0016732 0.0013379 0.0010027 -3.0412e-06 gid x y z 0.0013574 0.014194 0.012768 0.011342 0.0099154 0.0084891 0.0027837 0.0070627 0.0056364 0.00421 -6.8985e-05 gid(b) crack-track fig. 10: mesh-siz sensitivity. contour maximum princip strain (max) peak load differ meshes: (a) crack-track algorithm, (b): crack-track algorithm. finit element model intern multipl local crack 11 no-track track mesh analyt ca- paciti [kn/m] capac [kn/m] differ ana- lytic [%] capac [kn/m] differ ana- lytic [%] mesh-a 575.96 537.56 -6.67 579.39 0.60 mesh-b " 538.22 -6.55 585.29 1.62 mesh-c " 514.98 -10.06 539.65 -6.30 mesh-c " 529.66 -8.04 544.44 -5.47 mesh-c " 532.35 -7.57 549.10 -4.66 mesh-d " 529.14 -8.13 554.09 -3.80 tabl 1: comparison numer analyt result propos track algorithm brazilian split test. no-track track overhead track mesh number node memori [mb] cpu-tim [s] memori [mb] cpu-tim [s] memori [%] cpu-tim [%] mesh-a 984 1.33 14.52 1.56 13.06 17.29 -10.06 mesh-b 1711 2.37 28.66 2.78 24.96 17.30 -12.91 mesh-c 384 0.52 4.38 0.61 5.07 17.31 15.75 mesh-c 994 1.35 10.47 1.58 13.15 17.04 25.60 mesh-c 1983 2.76 24.98 3.24 32.74 17.39 31.06 mesh-d 1016 1.38 10.61 1.62 13.48 17.39 27.05 tabl 2: comput cost us track algorithm brazilian split test. seen, track algorithm effi- cient term memori requir com- putat time. arrai necessari label element result addit memori requir 17 % track al- gorithm. perform analys com- putat time overhead track increases, expected, increas number degre freedom, maximum overhead 31% case refin mesh-c. note case (mesh-a mesh-b) comput cost us- ing track algorithm lower calcul it. improve- ment non-linear iter converg rate correct damag local track- ing algorithm. 4.2 structur application: frame wall door open section, investig capac pro- pose algorithm simul respons large- scale structur problem exhibit multipl cracking. simul experi consist in-plan lat- eral load full-scal unreinforc masonri frame open [74]. structur exampl select complex given structur interact pier spandrel, repre- sent meaning case differ type crack traction, shear flexure. fact, test capac approach repres experiment crack pattern redis- tribut action structur member soon differ crack appear. 4.2.1 experiment set result masonri built yellow tuff brick dimen- sion 150 300 100 mm3 hydraul mortar 10 mm thickness. wall overal dimens 5100 mm length, 3620 mm height 310 mm thick- ness. spandrel open li timber lintel bond length 150 mm sides. experiment test perform steps. initially, distribut load appli pier result v = 200 kn . fol- low applic horizont displac d left wall keep vertic load con- stant. figur 11a illustr geometri load configur experiment. figur 11b figur 11c result crack structur spandrel respectively. in-plan load ac- tivat differ failur phenomena masonri result- ing complex crack structure. partic- ular, horizont crack form base pier debond unit mortar. flexur cracking, cross unit 12 savva saloustro et al. v (a) (b) v d (c) fig. 11: (a) geometri load configur experiment. crack end experi (b) frame (c) spandrel (pictur adapt [74]). fig. 12: discret domain numer sim- ulation. mortar-unit interface, appear locat lower upper spandrel. finally, report damag diagon shear crack start middl spandrel extend diagon opposit corners. detail descript experiment setup, load pro- cedur damag pattern reader refer origin work [74]. 4.2.2 numer simul experiment test simul numeri- cal algorithm present section 3. materi wall ideal homogen proper- ti deriv avail experiment data [74], appropri valu literatur chosen non-avail materi parameters. consti- tutiv model section 2 approxim masonri behaviour. work, focu given capac algorithm simul differ- ent typolog local crack observ particular example. masonry, select materi properti e = 1.54 gpa, f+ = 0.13 mpa, v = 0.2, f = 3.9 mpa, = 1200 kg/m3, g+ = 15 j/m2 , g = 35000 j/m2, ratio uniaxi biaxial com- pressiv strength consid fb /f = 1.15. lin- ear elast behaviour assum timber lintel young modulu e = 15 gpa. connect masonri timber lintel model care order provid realist represent actual interact neighbour materials. interconnect model soft layer thick 10 mm limit strength stiff (e = 0.02 gpa, f+ = 0.01 mpa, v = 0.2, f = 3.9 mpa, g+ = 5 j/m2 , g = 35000 j/m2). zone seen continu counterpart no-tens discontinu interface. follow experiment, numer simul consist steps: first, applic dead load vertic forc equal 200 kn pier, second, increment applica- tion horizont displac left structure, keep load step constant. masonri frame discret unstructur mesh 2d plane-stress three-nod triangl av- erag mesh size = 4 cm (10678 nodes) (figur 12). refer case input paramet lo- cal crack-track algorithm rexcl= 300 mm (equal length bricks), amax = 45 rneigh = 200 mm. influenc valu investig section 4.2.5. finit element model intern multipl local crack 13 (a) (b) (c) (d) (e) (f) fig. 13: tensil damag contour for: (a) d = 1.5 mm, (b) d = 3.3 mm, (c) d = 12.3 mm, (d) d = 17.3 mm, (e) d = 20.7 mm. (f) maximum princip strain contour d = 20.7 mm. fig. 14: tensil damag contour (a) maximum prin- cipal strain (b) analysi smear crack approach crack-track techniqu (horizon- tal displac d = 25 mm) 4.2.3 result discuss figur 13 illustr sequenc tensil crack obtain numer analysis. numer simulation, includ appli- cation dead load load 200 kn piers, damag occurs. verti- cal crack corner spandrel damag occur structur second stage analysi (figur 13a). increas horizont displac result format horizont crack base pier (figur 13b) subsequ rocking. follow this, intern crack start form spandrel (figur 13c- d). finally, horizont displac 21 mm, diagon shear crack total form secondari flexur crack observ spandrel (figur 13e). appreci figur 13f obtain damag good agreement result crack pattern experi (figur 11b-c). open local crack end analysis, displai contour tensil princip strain figur 13f, locat end spandrel, middl pier experiment. finally, note numer simul particular exampl imposs crack-track techniqu enhanc intern cracking. apart intern shear crack- ing affect middl spandrel, flexur crack left start bound- ari numer domain. numer result classic smear crack approach, enhanc given crack-track technique, illustr figur 14. 14 savva saloustro et al. crack base pier local singl row elements, facilit align- ment mesh expect crack direction. contrarily, dispers damag observ region flexur crack spandrel, solut bias mesh topology. spuriou spread damag result unreal- istic releas elast energi elast unload- ing element surround damag ones. consequence, capac structur reduc be- fore reach necessari forc open intern shear crack observ experimentally. limit classic smear crack approach prevent captur correctli experiment obtain damage. figur 15 present smear crack strain field result numer analysi experi- ment perform micro-model approach parisi et al. [75]. result obtain track al- gorithm (see figur 13e & figur 13f) agre damag pattern simul micro-model. (a) (b) fig. 15: micro-model [75] simul in-plan load masonri frame: (a) mesh, (b) smear crack strain field (pictur adapt [75]). figur 16 present comparison nu- meric experiment load-displac diagrams. us crack-track algorithm allow cap- ture correctli experiment obtain failur curve, term maximum strength ductil 0 20 40 60 80 100 120 140 160 180 200 0 5 10 15 20 25 h o ri z o n ta l f o rc e f [ k n ] horizont displac d [mm] experiment parisi et al. 2013 numer - crack-track numer - crack-track fig. 16: load-displac graph experiment test numer analyses. structure. signific loss stiff relat rock pier rel crack base, result increas open flexur crack opposit end spandrel (see figur 13b). damag domin caus loss stiff structur shear crack form spandrel, result sudden drop appli forc displac 20 mm. import aspect numer result capac reproduc satisfactorili loss struc- tural stiff occur differ fractur phenomena load history. es- sential evalu seismic capac exist structure, design new one, common procedur (e.g. [76, 77]) reli realist estim initi stiffness, ductil strength reduction. crack-track techniqu used, load versu displac graph fail repres correct sequenc fractur nonlin- ear range, brittl shear crack spandrel. 4.2.4 comput cost exampl brazilian split test, tabl 3 present inform comput cost us track algorithm particular example. addit requir memori lie rang valu brazilian split test, i. 16% higher track algorithm. process time pro- pose techniqu 11% higher classic smear crack approach. finit element model intern multipl local crack 15 no-track track overhead track memori [mb] cpu-tim [s] memori [mb] cpu-tim [s] memori [%] cpu-tim [%] 16.97 238.06 19.62 264.03 15.61 10.90 tabl 3: comput cost us track algorithm frame wall door open example. (a) (b) (c) (d) fig. 17: contour tensil damag (top) maximum princip strain (bottom): (a) rexcl = 0.1 m, (b) rexcl = 0.2 m, (c) rexcl = 0.3 m, (d) rexcl = 0.5 m (horizont displac d = 0.21 m). 4.2.5 effect track paramet section present sensit analysi crack- track paramet assess influenc nu- meric results. figur 17 present obtain damag pattern differ valu exclus radiu rexcl= [0.1; 0.2; 0.3; 0.5 m]. expected, exclus radiu rexcl signific effect numer simu- lation, affect distribut crack analys structure. valu lower unit size re- sult denser crack spandrel, chang respons structur damag pattern. particular, rexcl = 0.1 m crack appear end spandrel, facilit rock mode structure, shear crack middl spandrel reproduced. chang structur respons appreci load vs displac graph figur 18, rexcl = 0.1 m typic graph rock failur mode obtained, however, sudden drop at- tribut shear crack spandrel. contrary, valu higher 0.2 m chosen, numer model reproduc experiment obtain structur respons (figur 17b-d figur 18). ac- tually, valu exclus radiu lower 0.2 m 0 20 40 60 80 100 120 140 160 180 200 0 5 10 15 20 25 h o ri z o n ta l f o rc e f [ k n ] horizont displac d [mm] r excl = 0.1 m r excl = 0.2 m r excl = 0.3 m r excl = 0.5 m fig. 18: sensit structur capac rexcl. account intern microstructur masonri defin size brick. result demonstr util ex- clusion radius. failur mechan masonri struc- ture determin rel posit crack consequ divis structur macroblocks. rel geometri strength compon plai decis role type crack masonri structures. appreci 16 savva saloustro et al. 0.2 m 0.3 m 0.5 m 35 45 55 fig. 19: sensit damag distribut spandrel amax rneigh. fig. 20: sensit structur capac amax rneigh experiment test investigation, crack occur mainli joint brick mortar. continuum finit element model ignor intern geometri composit fail captur failur mechan determin it. drawback partial overcom us exclus radius, perceiv wai account size effect unit continuum finit element model. contrary, micro-model simul crack phenomenon direct wai priori detail ge- ometr definit problem, cost comput time larg higher pro- pose model. disadvantag micro-model ren- der hardli applic analysi larg complex structures. propos model base crack-track method show good compromis accuraci comput cost. figur 19 20 present crack affect spandrel rel load displac curv respect differ combin amax rneigh rexcl = 0.3 m. exclus radiu defined, effect amax rneigh minor global respons structure. shear crack middl spandrel ident combin correct parameters. anticipated, shear cracking, domi- nant case, affect parameters, contrari crack bend stress state (see [16]). restrict chang crack curvatur low valu amax small effect sec- ondari flexur crack affect lower upper boundari spandrel. case, collaps mechan ident investig valu amax rneigh. 5 conclus structur behaviour construct quasi- brittl materials, concret masonry, deter- mine format discret crack defin collaps mechanism. continuum finit element ap- proach base classic smear crack approach simul poorli complex respons (a) repres damag spread unrealist wai (b) numer solut determin mesh- induc direct bias. circumv drawbacks, articl pro- pose us crack-track techniqu real- istic simul crack structur quasi- finit element model intern multipl local crack 17 brittl materials. novel algorithm present simul crack start locat discret domain make possibl simul boundari intern cracking. contri- bution, capac approach al- low nucleat new crack priori definit user, extend applic field track algorithm structur assess new exist structures. numer exampl valid propos algorithm: brazilian split test in-plan load frame wall door opening. numer simul prove capabl model repres correctli format propa- gation tensile, flexur shear crack discret domain. accur represent model crack phenomena produc realist simul experiment failur mechan correct estim nonlinear respons structure. model yield damag pattern re- alist well-known smear crack approach. limit comput cost propos ap- proach accuraci render reliabl tool analysi complex structur problem experienc multipl cracking. track techniqu propos model intern crack shown ro- bust conjunct finit element formul materi models. acknowledg research receiv finan- cial support mineco (ministerio economia y competitividad spanish government) erdf (european region develop fund) mul- tima project (multiscal techniqu experiment numer analysi reliabl masonri struc- tures, ref. num. bia2015-63882-p) eaci project (enhanc accuraci comput experiment frame- work strain local failur mechanisms, ref. mat 2013-48624-c2-1-p). author gratefulli acknowledg dr. fulvio parisi provid inform experiment data. refer 1. d. ngo c. scordelis, finit element analy- si reinforc concret beams, aci journal, vol. 64, no. 3, pp. 152163, 1967. 2. y. rashid, ultim strength analysi pre- stress concret pressur vessels, nuclear engi- neer design, vol. 7, pp. 334344, apr 1968. 3. j. mosler g. meschke, embed crack vs. smear crack models: comparison elementwis discontinu crack path approach empha- si mesh bias, method appli mechan engineering, vol. 193, no. 30-32, pp. 33513375, 2004. 4. r. h. j. peerlings, r. borst, w. a. m. brekel- mans, j. h. p. vree, gradient enhanc damag quasi-brittl materials, intern journal numer method engineering, vol. 39, no. 19, pp. 33913403, 1996. 5. a. simone, g. n. wells, l. j. sluys, continu discontinu failur gradient- enhanc continuum damag model, method appli mechan engineering, vol. 192, pp. 45814607, oct 2003. 6. z. p. baant f. b. lin, nonloc smear crack model concret fracture, journal structur engineering, vol. 114, pp. 24932510, nov 1988. 7. j. vree, w. brekelmans, m. van gils, com- parison nonloc approach continuum dam- ag mechanics, comput & structures, vol. 55, pp. 581588, 1995. 8. r. borst, simul strain localization: repprais cosserat continuum, engin computations, vol. 8, pp. 317332, apr 1991. 9. r. borst, l. sluys, h.-b. mhlhaus, j. pamin, fundament issu finit element analys local deformation, engineer- ing computations, vol. 10, no. 2, pp. 99121, 1993. 10. l. benedetti, m. cervera, m. chiumenti, stress-accur mix fem soil failur shallow foundat involv strain local plasticity, comput geotechnics, vol. 64, pp. 3247, mar 2015. 11. m. jirsek t. zimmermann, embed crack model. ii. combin smear cracks, intern journal numer method engineering, vol. 50, no. 6, pp. 12911305, 2001. 12. g. n. well l. j. sluys, new method model cohes crack finit elements, in- ternat journal numer method en- gineering, vol. 50, no. 12, pp. 26672682, 2001. 13. n. mo t. belytschko, extend finit ele- ment method cohes crack growth, engineer- ing fractur mechanics, vol. 69, pp. 813833, 2002. 14. p. dumstorff g. meschke, crack propaga- tion criteria framework x-fem-bas structur analyses, intern journal nu- meric analyt method geomechanics, vol. 31, pp. 239259, feb 2007. 15. m. cervera m. chiumenti, mesh object tensil crack local continuum damag model crack track technique, method appli mechan engineering, 18 savva saloustro et al. vol. 196, no. 1-3, pp. 304320, 2006. 16. m. cervera, l. pel, r. clemente, p. roca, crack-track techniqu local damag quasi-brittl materials, engin fractur me- chanics, vol. 77, no. 13, pp. 24312450, 2010. 17. a. slobbe, m. hendriks, j. rots, smooth- ing propag smear cracks, engineer- ing fractur mechanics, vol. 132, pp. 147168, dec 2014. 18. m. jirsek p. grassl, evalu direct mesh bia concret fractur simul continuum damag models, engin fractur mechanics, vol. 75, no. 8, pp. 19211943, 2008. 19. r. borst, fractur quasi-brittl materials: review continuum damage-bas approaches, engin fractur mechanics, vol. 69, pp. 95 112, 2001. 20. t. rabczuk, comput method fractur brittl quasi-brittl solid : state-of-the- art review futur perspectives, isrn appli mathematics, vol. 2013, pp. 161, 2012. 21. w.-f. chen, plastic reinforc concrete. mcgraw-hill, 1982. 22. w.-f. chen, constitut equat engineer- ing materials, vol. 2 plastic modelling. el- sevier, 1994. 23. p. h. feenstra r. borst, composit plas- ticiti model concrete, intern journal solid structures, vol. 33, pp. 707730, feb 1996. 24. j. mazar g. pijaudier-cabot, continuum damag theori - applic concrete, journal engin mechanics, vol. 115, no. 2, pp. 345 365, 1989. 25. m. cervera, j. oliver, r. faria, seismic evalu- ation concret dam continuum damag mod- els, earthquak engin & structur dynam- ics, vol. 24, no. 9, pp. 12251245, 1995. 26. j. lubliner, j. oliver, s. oller, e. oate, plastic-damag model concrete, intern journal solid structures, vol. 25, no. 3, pp. 299326, 1989. 27. g. lee g. l. fenves, plastic-damag model cyclic load concret structures, journal engin mechanics, vol. 124, no. 8, pp. 892 900, 1998. 28. j. y. wu, j. li, r. faria, energi re- leas rate-bas plastic-damag model con- crete, intern journal solid struc- tures, vol. 43, no. 3-4, pp. 583612, 2006. 29. e. papa, unilater damag model masonri base homogenis procedure, mechan cohesive-frict materias, vol. 1, no. febru- ary, pp. 349366, 1996. 30. p. b. loureno, anisotrop soften model masonri plate shells, journal structur engineering, vol. 126, no. 9, pp. 10081016, 2000. 31. l. pel, m. cervera, p. roca, or- thotrop damag model analysi masonri structures, construct build materials, vol. 41, pp. 957967, 2013. 32. j. lopez, s. oller, e. oate, j. lubliner, homogen constitut model masonry, in- ternat journal numer method en- gineering, vol. 46, no. 10, pp. 16511671, 1999. 33. v. kouznetsova, m. g. d. geers, w. a. m. brekelmans, multi-scal constitut model heterogen materi gradient-enhanc comput homogen scheme, interna- tional journal numer method engineer- ing, vol. 54, pp. 12351260, jul 2002. 34. a. zucchini p. b. loureno, micro- mechan model homogenis ma- sonry, intern journal solid struc- tures, vol. 39, pp. 32333255, jun 2002. 35. p. b. loureno, g. milani, a. tralli, a. zuc- chini, analysi masonri structures: review recent trend homogen techniques., canadian journal civil engineering, vol. 34, no. 11, pp. 14431457, 2007. 36. c. calderini s. lagomarsino, continuum model in-plan anisotrop inelast behav- ior masonry, journal structur engineering, vol. 134, no. 2, pp. 209220, 2008. 37. j. oliver, m. caicedo, e. roubin, a. huespe, j. hernndez, continuum approach computa- tional multiscal model propag fracture, method appli mechan en- gineering, vol. 294, pp. 384427, 2015. 38. m. petracca, l. pel, r. rossi, s. oller, g. camata, e. spacone, regular order com- putat homogen multiscal analysi masonri structures, comput mechanics, dec 2015. 39. p. b. loureno j. g. rots, multisurfac in- terfac model analysi masonri structures, journal engin mechanics, vol. 123, no. 7, pp. 660668, 1997. 40. l. macorini b. a. izzuddin, non-linear in- terfac element 3d mesoscal analysi brick- masonri structures, intern journal nu- meric method engineering, vol. 85, pp. 1584 1608, mar 2011. 41. s. oliveira r. faria, numer simul collaps scenario reduc scale test arch dams, engin structures, vol. 28, no. 10, finit element model intern multipl local crack 19 pp. 14301439, 2006. 42. p. roca, m. cervera, g. gariup, l. pel, structur analysi masonri histor con- structions. classic advanc approaches, archiv comput method engineer- ing, vol. 17, pp. 299325, jul 2010. 43. j. carvalho, j. ortega, p. b. loureno, l. f. ramos, h. roman, safeti analysi mod- ern heritag masonri buildings: box-build recife, brazil, engin structures, vol. 80, pp. 222240, 2014. 44. n. mend p. b. loureno, sensit analy- si seismic perform exist masonri buildings, engin structures, vol. 80, pp. 137 146, 2014. 45. p. jger, p. steinmann, e. kuhl, local track algorithm simul three- dimension discontinuities, comput me- chanics, vol. 42, no. 3, pp. 395406, 2008. 46. s.-n. roth, p. lger, a. soulamani, com- bine xfem-damag mechan approach con- crete crack propagation, method ap- pli mechan engineering, vol. 283, pp. 923 955, jan 2015. 47. y. zhang, r. lackner, m. zeiml, h. a. mang, strong discontinu embed approach standard so formulation: element formulation, energy-bas crack-track strategy, valida- tions, method appli mechan engineering, vol. 287, pp. 335366, 2015. 48. s. saloustros, l. pel, m. cervera, crack-track techniqu local cohesive- friction damage, engin fractur mechan- ics, vol. 150, pp. 96114, 2015. 49. l. pel, m. cervera, s. oller, m. chiu- menti, local map damag model orthotrop materials, engin fractur me- chanics, vol. 124-125, pp. 196216, 2014. 50. c. linder a. raina, strong discontinu approach multipl level model solid fail- ure, method appli mechan engineering, vol. 253, pp. 558583, 2013. 51. m. h. motamedi, d. a. weed, c. d. fos- ter, numer simul mix mode (i ii) fractur behavior pre-crack rock strong discontinu approach, intern jour- nal solid structures, vol. 85-86, pp. 4456, 2016. 52. j.-b. li, x.-a. fu, b.-b. chen, c. wu, g. lin, model crack propag extend scale boundari finit element method base level set method, comput structures, vol. 167, pp. 5068, 2016. 53. j. y. wu, f. b. li, s. l. xu, extend em- bed finit element continu displace- ment jump model local failur solids, method appli mechan- ic engineering, vol. 285, pp. 346378, 2015. 54. s. feld-payet, v. chiaruttini, j. besson, f. feyel, new march ridg algorithm crack path track regular media, inter- nation journal solid structures, vol. 71, pp. 5769, 2015. 55. c. comi u. perego, fractur energi base bi- dissip damag model concrete, interna- tional journal solid structures, vol. 38, no. 36-37, pp. 64276454, 2001. 56. l. pel, m. cervera, p. roca, continuum damag model orthotrop materials: applica- tion masonry, method appli mechan engineering, vol. 200, pp. 917930, feb 2011. 57. g. z. voyiadjis, z. n. taqieddin, p. i. kat- tan, theoret formul coupl elast plastic anisotrop damag model concret us- ing strain energi equival concept, in- ternat journal damag mechanics, vol. 18, no. 7, pp. 603638, 2009. 58. j. mazars, f. hamon, s. grange, new 3d damag model concret monotonic, cyclic dynam loadings, materi structures, pp. 37793793, 2014. 59. w. he, y. f. wu, y. xu, t. t. fu, ther- modynam consist nonloc damag model concret materi unilater effects, com- puter method appli mechan engineer- ing, vol. 297, pp. 371391, 2015. 60. l. f. pereira, j. weerheijm, l. j. sluys, new rate-depend stress-bas nonloc damag model simul dynam tensil failur quasi- brittl materials, intern journal impact engineering, vol. 94, pp. 8395, 2016. 61. j. lemaitr j. l. chaboche, aspect phe- nomenologiqu la ruptur par endommage- ment, journal mcaniqu applique, vol. 2, no. 3, 1978. 62. j. c. simo j. w. ju, strain- stress-bas continuum damag models-i. formulation, inter- nation journal solid structures, vol. 23, no. 7, pp. 821840, 1987. 63. j. oliver, m. cervera, s. h. oller martinez, j. lubliner, isotrop damag model smear crack analysi concrete, proc. sci-c aid analysi design concret structures, no. february, pp. 945957, 1990. 20 savva saloustro et al. 64. z. bazant b. oh, crack band theori frac- ture concrete, materi structures, vol. 16, pp. 155177, 1983. 65. m. cervera, viscoelast rate-depend continuum damag models, monographi n-79, tech. rep., barcelona, 2003. 66. j. oliver, consist characterist length smear crack models, intern journal numer method engineering, vol. 28, no. 2, pp. 461474, 1989. 67. j.-y. wu m. cervera, equival traction- stress-bas approach model local failur solids, jour- nal mechan physic solids, vol. 82, pp. 137163, 2015. 68. m. cervera j.-y. wu, conform strong, regularized, embed smear discon- tinuiti approach model local fail- ur solids, intern journal solid structures, vol. 71, pp. 1938, 2015. 69. astm:c496/c496m, standard test method split tensil strength cylindr concret specimens, astm international, no. 336, pp. 15, 2011. 70. astm:d3967-08, standard test method split- ting tensil strength intact rock core speci- mens, astm international, 2008. 71. comet, coupl mechan thermal anal- ysis, 2013. 72. gid, person pre post-processor, 2014. 73. en 1992 (eurocod 2), design concret struc- tures, tech. rep., london, 1992. 74. n. augenti, f. parisi, a. prota, g. manfredi, in-plan later respons full-scal ma- sonri subassemblag inor- ganic matrix-grid strengthen system, jour- nal composit construction, vol. 15, no. 4, pp. 578590, 2011. 75. f. parisi, g. p. lignola, n. augenti, a. prota, g. manfredi, nonlinear behavior ma- sonri subassemblag strengthen- ing inorgan matrix-grid composites, jour- nal composit construction, vol. 15, no. 5, pp. 821832, 2011. 76. en 1998-1 (eurocod 8), design structur earthquak resistance, 1 gener rule seismic action rule buildings, 2003. 77. p. fajfar, capac spectrum method base in- elast demand spectra, earthquak engin & structur dynamics, vol. 28, pp. 979993, sep 1999. introduct continuum damag model model crack local track techniqu numer exampl conclus