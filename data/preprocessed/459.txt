microsoft word - paper_2_phase_v05.doc upcommon portal del coneix obert la upc aquesta s una cpia la versi author final draft d'un articl publicat la revista comput particl mechanics. la publicaci final est dispon springer trav copi author 's final draft version articl publish journal comput particl mechanics. final public avail springer articl publicat / publish article: flores, r.m. [et al.] (2018) implicit unsteadi hydraul solver suspend cut transport manag pressur wells. comput particl mechan . doi:10.1007/s40571-018-0204-9 1 implicit unsteadi hydraul solver suspend cut transport manag pressur well r. flores1*, e. ortega2, a. ilin3, d. simpkins4 e. oate1 *correspond author: (+34) 93 401 6038 1intern center numer method engin (cimne), c/ gran capitn s/n, 08034 barcelona, spain 2serra hunter professor escola superior denginyeri industrial, aeroespaci y audiovisu terrassa, universitat politcnica catalunya (eseiaat-upc), c/ colom 11, 08222 terrassa, spain 3weatherford international, 11909 fm 529 road, houston, texa 77041, usa 4formerli weatherford international, houston, texas, usa abstract. present simul tool transient event complex hydraul networks. code includ model transport suspend cut near-vert wells. unstructur finit volum formul implicit time integr chosen. uncondit stabil integr make method suitabl simul transient event wide rang characterist time scales. handl fast transient (e.g. fluid hammer events) long-term evolut (e.g. hole clean operations). softwar develop address need oil industri robust effici predict tool allow effect control manag pressur drill operations. physic model follow standard practic accept industri (e.g. mud rheologi computations). mathemat foundat algorithm describ follow valid case illustr capabl accuracy. finally, practic industri applic exampl provid demonstr real-world perform software. keywords: unsteady, hydraulics, oil well, cut transport. 1 introduct manag pressur drill (mpd) techniqu enabl precis control annular pressur allow drill well practic [1,2,3]. convent drill operations, mud outlet ambient pressure, reli hydrostat pressur (regul chang mud density) control. case narrow margin pore pressur format fractur threshold, convent drill unfeasible. maintain tighter pressur control (e.g. choke valv back-pressur pump surface) mpd overcom limit (see fig. 1). 2 mud & cut drillstr case case section format clean mud uncas section mud pump mud tank back-pressur pump choke valv c s e d s e g m e n t surfac back-pressur case point format fractur hydrostat head friction loss pressur d e p th annular mud pressur pore pressur fig. 1 simplifi schemat mpd (left) annulu pressur vs. depth diagram (right) however, ensur continu safety, accur control strategi short reaction time needed. call predict tool capabl comput respons control input (e.g. valv oper back-pressur pump settings) near real- time. moreover, timescal relev phenomena span order magnitude; fluid hammer event (10-2 s) hole clean activ (hour days). case analysi softwar abl provid solut timefram second safe oper maintained. request weatherford intern plc, intern center numer method engin (cimne) develop unsteadi solver hydraul network includ model suspend cut transport. weatherford specif demand capabl solv short long transient second commod desktop hardware. allow futur incorpor technolog automat control system [4]. common choic solv water hammer problem method characterist [5,6]. however, explicit techniqu best suit uniformli space grids, increasingli complex speed sound fluid constant ineffici comput long-term respons hydraul network. hand, 3 implicit methods, usual base finite-differ schemes, proposed. allow larger time steps, improv behaviour comput slow transient [7,8]. unfortunately, comput cost time step implicit method tend high, make ineffici appli fluid hammer simul [9]. thus, choic method (implicit/explicit) usual depend time scale (long/short, respectively). paper present effici implicit method suitabl simul short long transients, steady-st simulation. greatli simplifi analysi tasks, singl tool appli situations. algorithm deriv scheme propos [10] analysi fully-incompress fully-compress single-phas flows. origin method adapt slightli compress fluid (such drill muds) expand deal two-phas flow (mud suspend cuttings). detail numer scheme presented, follow valid case demonstr accuraci effici solver. finally, import conclus drawn. 2 govern equat consid weatherford oper requir inform avail instrumentation, follow assumpt ware develop mathemat model: 1d flow insid rigid pipe. compress drill mud small. bore near-vert veloc surfac network high cut remain suspended. rock cut incompress behav dispers phase, interact cut neglected. motion suspend cut domin viscosity, cut slip veloc comput directli local flow conditions. cut veloc approxim parallel pipe axis. also, friction forc cut pipe wall minor import compar viscou stresses. 4 temperatur field known instant. effect temperatur fluid behaviour considered, temperatur input data. geometri motion (e.g. drill string displacement) defin extern affect flow field. basic equat 1d fluid flow, exampl [11], simplifi accord assumptions. basic idea scheme [10] appli modifi equat order obtain effici numer model. chang basic equat summar next. 2.1 single-phas conserv statement 1d mass balanc equat conserv form pipe segment 0 v t x , (1) denot fluid density, v velocity, x streamwis coordin t stand time. conserv form momentum balanc given by: 2 w x vv fp g t x x , (2) p fluid pressure, fw denot wall friction forc unit length, pipe cross-sect gx streamwis compon gravity. left-hand (lhs) (2) simplifi continu equat (1): 2vv v v v v v v v v t x t x t x t x , (3) yield non-conserv form momentum balanc w x fv v p v g t x x . (4) flow veloc small compar speed sound c, clearli case oil well v1 m/s, continu equat (1) simplifi densiti gradient neglig small. us speed sound write densiti fluctuat term pressur gradient, turn estim (4) 5 2 2 2 2 ; v p p v v v v v v v m x c x x x x c x x , (5) mach number /m v c introduc 2 s p c . mach number small, densiti gradient term continu equat safe neglected: v v x x , (6) yield acoust approxim 0 v t x . (7) general, mach number small densiti gradient term equat dropped. convect term v v x lh (4) non-linear complic numer solut equations. kei featur algorithm develop [10] replac static pressur p stagnat pressur p0 20 1 2 p p q p v , (8) dynam pressur q introduced. introduc stagnat pressur momentum balanc equat (4) recal densiti gradient ignor virtu small mach number: 0 w x p fv g t x . (9) common practic hydraul analysi ignor convect term order simplifi solut scheme. equat (9) achiev effect remain exact (within frame small compressibility) effect convect term contain insid dynam (q) stagnat pressure. 2.2 conserv statement two-phas flow method [10] computation efficient, unfortun restrict single-phas flows. here, techniqu extend case biphas flow (drill mud suspend rock cuttings) simplifi equat model assumpt state begin section 2. follow subscript m, s mix shall refer, respectively, 6 drill mud, suspend cut overal mixture. mass conserv balanc phase ,k k k k k ka v k m s t x , (10) k denot net mass sourc (per unit length) phase k. subscript k m (mud) s (suspend cuttings). ak fraction cross section occupi phase k, written term volum fraction (xk) k ka ax . principle, momentum balanc phase requir determin veloc field. however, practice, drag forc experienc suspend cut comput accurately. mainli issues. first, cut wide variat size shapes, repres geometri gives, most, rough approxim real drag force. second, particl identical, precis drag correl avail fluid complex rheologi (which precis case drill muds). add field applic simpl model calibr easili required, particl drag correl approxim best. mind simpler effici approach chosen. assum motion suspend particl domin viscosity, particl slip veloc slip s mv v v comput assum buoyancy, gravit drag forc act equilibrium 0 0s s x s p g d x , (11) s particl volum ds drag forc experi (which function slip velocity). note that, convenience, assum 0 p p x x comput buoyanc force. approxim valid long variat cross-sect duct smooth. furthermore, given approxim natur drag estimation, high level accuraci need pressur gradient. remark (11) algebra equat comput cut slip velocity, easier solv respect momentum balanc statement (which partial differenti equation). equat need complet determin motion system, momentum balanc mud, instead momentum balanc overal mixtur 7 chosen. equat simpler because, consid mixture, forc mud cut intern enter balance: mix o mixmix mix x v p f g t x , (12) averag mixtur densiti mix m m s sx x . equival mixtur wall forc includ viscou forc momentum defect creat extern cut sources, any: mix w w s s extf l v v . (13) (13) w wall viscou stress, lw denot pipe perimet vext veloc cut introduc flow. cut fed low veloc (vs>vext) creat drag forc mixture, mixtur slow transfer momentum extern cut order equal speeds. realist cut feed rate term small safe ignored. note approxim (12), total pressur p0 comput dynam pressur mud 2 0 1 2 m mp p v , exact equat requir dynam pressur mixture. practice, error introduc approxim smaller uncertainti evalu friction forc (given complex rheologi mud) limitation. simplif realiz motion particl domin viscou forces, acceler mud particl similar. stand reason because, acceler significantli different, particl slip veloc large, clog short time. accept assum mix m v v t t us equat comput directli mud velocity: 1m o w x mix v p f g t x . (14) 2.3 physic model order fulli determin solut 0, , , , ,m s m s mx x v v p mass momentum conserv equat (10) (14) supplement addit correl describ physic respons system. includ mud equat state, correl wall friction stress cut drag force. model 8 adopt explain briefli subsections, check refer provid complet description. 2.3.1 equat state follow standard practic oil industry, polynomi express comput mud density: 2 21 1 1 2 2 2m b p c p t b p c p , (15) t denot temperatur coeffici ai, bi ci material-dependent. speed sound easili comput (15) 1 1 2 22 1 2 2m b c p t b c p c p . (16) note that, simplicity, possibl us p0 instead p comput density: 2 2 2 ( , ) ( , ) ( , ) 1 ( , ) 1 2 2 m m o m o m m v m p t p t p p p t p t p c . (17) given mach number small, conclud (17) ( , ) ( , )m o mp t p t . 2.3.2 wall viscou stress follow standard practic oil industri friction loss comput procedur outlin api rp 13d standard [13] herschel-bulklei (hb) non- newtonian fluid model [14]: ny k , (18) y yield stress, k consist factor, n flow index denot shear rate. hb model prefer includes, special cases, newtonian, bingham plastic power-law fluids. comput wall friction stress wall shear rate determin 8w hyd gv d . (19) express 4 hyd w d l hydraul diamet duct combin geometri shear-rat correct factor g 9 3 1 1 4 2 n g n , (20) =0 drill pipe =1 annular space. refer wall shear stress given 4 3 n ref n w y wk , (21) gener reynold number computed: 2 8 mg ref w v . (22) standard [13] give semi-empir correl fan friction factor cf function reg. friction coefficient, wall shear stress final determined: 2 1 2 w m fv c . (23) 2.3.3 cut drag forc order comput cut slip veloc relat (11) correl particl drag forc needed. follow result [12] linear depend assum 0 0 term slip slip s sv v s s slipv term d d d d v v , (24) vterm termin veloc (in vertic fall) particl immers drill mud. particl drag termin veloc equal particl weight minu buoyant forc term s s s mv d g . (25) termin settl veloc comput walker may correl [15,16]. method assum circular disc diamet ds thick hs flat fall. empir correl shear stress termin veloc provided. follow standard practic oil industry, field unit used: 2 lbf 7,9 100ft term s s mh , (26) particl size measur inch densiti lbm/gal. hb fluid model shear rate termin veloc comput 10 1 1s n term y term k , (27) turn yield appar viscos termin shear rate: 479 cptermterm term . (28) finally, termin veloc ft 0,0203 s s term term term m d v . (29) particl drag zero slip veloc comput express gel strength spheric particl 2 0slip s yv d d , (30) however, express yield result incompat walker may model (i.e. predict 0term slip sv v d d ). address issu drag rest comput using: 0slip term y s sv v term d d . (31) equat (11) (24) together, slip veloc particl determined: 0 0 0 slip term slip term slip s s x s v s sv v v p v g d d d x . (32) note magnitud particl drag smaller 0slip v d slip veloc set zero instead valu predict (32). 3 numer model algorithm build advantag ref. [10], extend method includ effect suspend cuttings. solut scheme staggered, altern veloc correct pressure/concentr correct steps. spatial discret staggered, combin finit differ veloc correct step unstructur finit volum comput pressur concentrations. subsect detail formulation. 11 3.1 problem discret 3.1.1 spatial discret spatial discret scheme staggered, pressur concentr evalu node grid (xi) veloc comput midpoint (xi+1/2) shown fig. 2. xi1 xi+1xixi1/2 xi+1/2 vi1/2 pi1 xi1 vi+1/2 li1/2 li+1/2 pi xi pi+1 xi+1 i1 i+1 fig. 2 stagger spatial discret mud veloc equat (14) solv second-ord center finit differ scheme mass conserv equat (10) solv cell-cent finit volum scheme (second-ord space accur too). cell interfac locat midpoint neighbour node (where veloc computed). volum cell given by: 1/2 1/2 1/2 1/2 2 l l . (33) note pipe cross-sect defin midpoint (i.e. pipe segment constant area, section chang take place nodes). 3.1.2 tempor discret complex mud rheologi nonlinear cut slip veloc correl achiev converg solut implicit integr difficult. increas robust solut procedur backward euler time integr advanc equat time [17]. applic hand stabil simplic deem import accuracy, first-ord time accuraci consid accept trade-off. thus, given od 1 d , ,..., 1,..., d j j n x t x x j n t ; (34) 12 unknown advanc time solv algebra 1, ,..., 1,..., t t t j j t t t t j n x x t t x x j n t , (35) t denot time step size. notat simpl possible, assum variabl evalu end time increment explicitli indicated. valu start time step denot superscript 0. thus, eq. (35) becomes: 0 1, ,..., 1,..., j j j n x x t x x j n t , (36) 3.2 veloc comput 3.2.1 mud (mixture) veloc updat discret form mixtur momentum balanc equat (12) 0 1/2 11/2 1/2 1/2 m m mix o o mix mix xi v v l p p p l g t , (37) mixtur pressur drop given by: mix mix mw mw s s ext l l p f l v v . (38) case local pressur drop (minor losses) exist, (38) augment minor lossp k q , kloss dimensionless loss factor. factor function time (e.g. simul valv closures). equat (37) nonlinear, pmix function velocity, solv iter (note pressur concentr fixed, updat later stage algorithm). start approxim valu mud veloc 1/2 j m iv , j iter counter, seek improv solut 1 1/2 1/2 1/2 j j j m m iv v v , (39) 0 1/2 1/2 1/2 1/2 1 1/2 1/2 j j m m m mix j j mix o o mix mix x mix v v v l t p p p p l g v . (40) veloc correct step j obtain 13 1/2 1/2 1/2 1/2- j j j ik v b e = , (41) 1/2 1/2 1/2 0 1/2 1/2 0 0 1 1/2 1/2 1/2 , , . j j mix mix m mix m mix x j j mix m mix l p k l t v v b l g p p t l v e p t (42) (38) linear factor (42) written as: 1/2 1/2 1/2 j j mix s mw mw m l k l t v , (43) assum cut slip veloc depend mud velocity. veloc updat step (39) repeat converg achieved. 3.2.2 cut veloc updat cut slip veloc obtain solv algebra equat (25). model particl drag describ (24)-(32) used, equat becomes: 0 0 1 00 1/2 term s sv vi v s s x s s mv term d dp p g d v v l v . (44) equat (44) linear straightforward solv v computed. 3.3 concentr pressur comput 3.3.1 mass balanc discret nomenclatur fig. 2, rate chang mass certain speci contain insid cell is: 1/2 1/2 d d k p k k ki ii x f f l t , (45) k denot phase (cut mud) f flux cell interfaces: 1/2 1/2 k k k k f v x . (46) appli backward euler rule (45) yield 14 0 0 1/2 1/2i k k k k k k ki iix x f f lt . (47) again, equat nonlinear solv iteratively. streamlin notat shall drop iter counter us tild denot initi guess. thus, write improv densiti concentr estim ;k k k k k kx x x . (48) insert (48) (47) discard high order term give 0 0 1/2 1/2 k k k k k k k k k k k k k ii x x x x t f f f f l , (49) rearrang as: 1/2 1/2 0 0 1/2 1/2 k k k k k ki ii k k k k k k kii x x f f t f f l x x t . (50) note 2 unknown node (50) 0 ;s m sx x . (51) mud densiti correct replac pressur variat through: 0 2m m p c , (52) yield updat equat suspend cut fraction pressure: 1/2 1/2 0 1/2 1/2 s s s si s s ext s s sii x f f t f f lm x x t , (53) 0 2 1/2 1/2 0 0 1/2 1/2 m m s m mi m m m m m m mi p x x f f t c f f x x t . (54) 15 3.3.2 flux linear order comput updat variabl (53) (54) flux increment linearized. achiev steps, start veloc linear follow complet fluxes. chang mud veloc pressur cut concentr variat estim eq. (37): 11/2 1/2 1/2 mix mix m o o x mixi m l p v p p lg t v . (55) experi show term rh (55) extrem important. neglect lead poor pressur estim lack convergence. chang mixtur densiti midpoint written as: 1 1/2 1 1 1 1/2 2 2 2 2 2 m m s s m m s si mix m m s s m m s si s m s m s s s m s si x x x x x x x x x x x x . (56) note that, low compress mud, assum m m m mx x . combin (55) (56) yield linear veloc correction: 1/2 1/2 1 1 1 1/22 mix mix m m x o o s m s s m si l p v t v lg p p x x . (57) cut veloc linear obtain ad (57) linear slip veloc comput (44): 0 0 11/2 1/2 1/2 0term s term s m ii s sv v v v v v p p l d d . (58) linear flux obtain (46), assumpt that, low mach number, densiti variat neglig compar chang velocity: 16 1/2 1/2 k k k k k k f x v v x . (59) particular, mud flux variat 1/2 1/2 1/2 1/21/2 1/2 1/2 1/2 11/2 1/2 2 m m m m m mi ii m m m m s si ii f x v v x v x v x x ; (60) chang cut flux 1/2 1/2 1/2 1/21/2 1/2 1/2 1/2 11/2 1/2 2 s s s s s si ii s s s s s si ii f x v v x v x v x x , (61) variat mud cut veloc given (57) (58). 3.4 solut procedur global solut obtain follow steps: 1. initi variabl appropri initi condit (or guess solut case time march steady-state). 2. solv updat veloc iter scheme (41). 3. updat cut veloc (44). 4. updat pressur cut concentr solv linear equat (53) -(54). 5. step 2 converg achieved. 6. continu time step (updat boundari condit time increment) proce step 2. 3.5 convect stabil equat contain diffus transport cut (it pure convect phenomenon) solut subject instabl (odd-even decoupling). fact, given discret second-ord space-accurate, godunov theorem [18] state linear scheme subject spuriou oscil near discontinuities. simpl workaround revert order space accuraci cut transport. 17 easili achiev alter interfaci flux cut appear rh (53). second-ord center discret flux is: 11/2 1/2 1/22 center s s s s s s s si ii f av x av x x . (62) replac first-ord upwind approxim improv stabil 1/2 1/2 upwind s s s s ii f av x , (63) assum cut node node i+1. case revers flow cut concentr evalu node i+1 (the valu upstream node chosen). upwind approxim increas numer diffus cuttings, consid limitation. real case random distribut cut size shapes, slip veloc uniform. therefore, cut transport veloc variable, caus streamwis smooth cut concentration. extra diffus creat upwind approxim qualit similar effect, detriment qualiti solution. 3.6 move drillstr surge/swab simul (i.e. comput effect vertic displac drillstring) node grid set motion reflect chang geometry. basic equat easili modifi account drillstr velocity. 3.6.1 veloc updat move drillstr equat retain form section 3.2 friction loss comput equival mud veloc given by: drillpip annulu 2 m dp eq dp m m m v v v v v v , (64) vdp denot drillpip longitudin velocity. 3.6.2 mass balanc move drillstr arbitrari lagrangian-eulerian (ale) framework [19], discret mass conserv statement (47) 18 0 0 0 1/2 1/2 1 al al p p p p p p p ii x x f f l t , (65) flux modifi account interfac velocity: 1/2 1/2 al p p p g pi f v v x . (66) grid veloc (vg) interfac interpol nodal velocities: 1 1/2 2 g gi g v v v . (67) 4 applic exampl illustr perform method section present benchmark case refer solut available, follow real-world applic example. 4.1 quasi-steadi mud transport test valid mud rheologi model long-term pressur drop horizont pipe segment compar result api rp 13d standard [13]. relev problem data are: pipe length: l = 100 m pipe diameter: d = 20 cm mud density: = 1900 kg/m3 speed sound: c = 1100 m/ fann viscomet readings: 3 = 7, 6 = 8, 300 = 38, 600 = 63 characterist wave propag time sound wave pipe / 0,1ct l c s . time scale long compar tc dynam effect expect neglig quasi- steadi solut obtained. pressur drop pipe segment ramp linearli 0 5 bar period 1000 s result numer model compar steady-st predict [13]. fig. 3 show excel agreement numer model. 19 0 0.1 0.2 0.3 0.4 0.5 1 2 3 4 5 6 7 8 9 d ri v g p ss u ( m p ) velocity(m/s) apirp13d transientsolv fig. 3 quasi-steadi pressur drop 4.2 surge/swab test valid al formul case slow drillstr motion analysed. analysi time larg compar resid time pressur wave dynam effect neglig incompress steadi solut reference. 3000 ft (900 m) drillstr section depict fig. 4 studied. 1000 ft 2 ft 1 ft 3 ft 1000 ft 1000 ft cb x fig. 4 move drillstr test case geometri drillpip lower 1 ft/ (0,3 m/s) minut rais origin position. hole diamet 3 ft (90 cm) drillpip diamet vari 2 ft section 1 ft section b. pipe closed, mud flow annulus. assum incompress annular flow veloc easili estimated: 2 2 2 2 2 2 2 1 0,8 ; 0,125 3 2 3 1 dp b dp ft ft v v v v s s . (68) 20 output simulation, shown fig. 5 10 s steps, match close expect results. 1 0.8 0.6 0.4 0.2 0 0.2 0.4 0.6 0.8 1 0 20 40 60 80 100 120 140 160 f lo w v e lo ci ty ( ft /s ) time(s) sectiona sectionb fig. 5 outlet flow veloc surge/swab test case 4.3 steady-st cut transport vertic annulu test valid solid transport capability, predict numer model check detail experiment result [20]. transport capabl differ combin drill mud cut size measur rang mud veloc insid vertic annulus, repres condit real wells. result express term effect cut transport ratio /s mr v v ; improv hole clean larg valu r (i.e. close 1) desirable. walker may method describ section 2.2.3 us paramet cut geometri (disk equival diamet thickness). diamet taken hydraul diamet cuttings, equival thick calibr experiment data, usual direct measur termin settl velocity. inform available, model calibr directli match transport ratio [20] singl valu mud velocity. behaviour model evalu vari mud veloc wide range. interestingly, disk equival thick depend weakli actual particl size. advantageous, reduc need recalibr model cut characterist changed. hand, observ advis recalibr disk 21 thick mud vastli differ rheolog properti test small anular velocities, i.e. 30 ft/min (0,15 m/s). fig. 6 compar experiment vs. numer result differ cut sizes. refer [20] complet descript experiment conditions. agreement satisfactori complet rang veloc (the scatter raw experiment measur larger differ data sets). 35 40 45 50 55 60 65 70 75 80 85 90 50 75 100 125 150 175 200 225 tr n sp o rt r ti o ( % ) annularvelocity(ft/min) experimental(smallcuttings) numerical(smallcuttings) experimental(mediumcuttings) numerical(mediumcuttings) experimental(largecuttings) numerical(largecuttings) fig. 6 effect cut size transport ratio (8x4 annulus, mud#1, 12 ppg mud, 100 rpm drillpip rotation) effect mud densiti (fig. 7) mud rheologi (fig. 8) studied, yield satisfactori result (deviat smaller spread experiment data). 22 30 40 50 60 70 80 90 100 25 50 75 100 125 150 175 200 225 tr n sp o rt r ti o ( % ) annularvelocity(ft/min) experimental(12ppgmud) numerical(12ppgmud) experimental(15ppgmud) numerical(15ppgmud) fig. 7 effect mud densiti transport ratio (8x4 annulus, mud#1, medium cuttings, h=0.45, drillpip rotation) 30 40 50 60 70 80 90 100 25 50 75 100 125 150 175 200 225 tr n sp o rt r ti o ( % ) annularvelocity(ft/min) experimental(mud#1) numerical(mud#1) experimental(mud#2) numerical(mud#2) fig. 8 effect mud rheologi transport ratio (8x4 annulus, 12 ppg mud, medium cuttings, h=0.45, drillpip rotation) 4.4 fast pressur transient (water hammer) viscou effect test fast-transi (wave tracking) capabl valid experiment studi present [21]. setup involv pipe segment constant head water tank upstream end motor valv outlet (fig. 9). start steady-st 23 conditions, valv close follow predefin law pressur point duct monitored. href 0,33 m 31,67 m motor valv constant-level tank sump 16 mpressur measur fig. 9 experiment setup water hammer test fig. 10 show good agreement experiment numer result pressur midpoint duct. small differ expect refer [21] give valv closur law tabul form. simul code minor loss pipe outlet. loss factor comput instant valv posit table. however, pressur surg extrem sensit interpol algorithm used, caus minor discrepancies. fig. 10 pressur evolut pipe midpoint 4.5 real-world applic exampl illustr real-world perform algorithm (mostli point view cpu time, reliabl experiment data real well freeli available) typic simul 39 400 ft-deep (12 km) pressur manag presented. sudden 24 actuat choke valv rig work steadi condit simulated. comput start time-march stationari condit follow fluid hammer event. geometri taken directli logs, includ total 273 cell drillpipe, annulu underbit (the drillstr partial raised, bit posit depth 6 km). given code problem deal non-uniform grid (a oppos program base method characterist explicit finit volum solvers) cell size match exactli log intervals. thus, smooth geometri transfer data uniform mesh. time-march steadi condit take 0,078 second core i5-4200u cpu (note low-pow low-perform processor). physic time simul 13 minutes, comput run 10 000 time faster real time. possibl adapt time step scheme used, dynam adjust time increment obtain best compromis iter converg step size. solver optimum perform obtain approxim 7 global iter loop perform time step. steadi condit reach (that defin point rel veloc pressur chang fall 10-6) pressur increas 85 psi (0,59 mpa) last 1 s prescrib outlet. simul run 200 addit step time increment 40 ms track wave propag well. analysi requir 0,14 second cpu indic above. 25 0.2 0.1 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0 1 2 3 4 5 6 7 8 9 10 11 12 p ss u c h n g e ( m p ) depth(km) t=1 t=2 t=3 t=4 t=5 t=6 t=7 t=8 fig. 11 pressur surg propag annulu underbit evolut pressur insid annulu underbit second interv shown fig. 11 (the pressur insid drillstr computed, includ jet loss bit, data remov plot sake clarity). note anomal propag depth 2 km. transit second case segment caus partial reflect increas pressur area restriction. 5 conclus unsteadi hydraul network solver pressur manag cut transport near-vert oil well presented. effici implicit time integr code provid unifi framework simul long-term evolut (e.g. hole clean operations) fast transient (e.g. fluid hammer event emerg control). method account complex drill mud rheologi mean industry- standard herschel-bulklei model compress effects. formul base stagnat (total) pressur effect convect deriv veloc includ implicitly, yield simpl set equat solv efficiently. abil method accur model benchmark cases, steadi transient, demonstrated. finally, practic applic exampl real oil presented, show excel perform software. evolut 26 time scale rang second hour comput fraction second. provid valuabl predict tool ensur safe drill operations. equival field si unit text includ field unit wide petroleum industry. list equival si units. tabl 1 equival petroleum field unit si. magnitud symbol section field unit si equival particl size ds, hs 2.3.3 0,0254 m densiti 2.3.3 lbm/gal (ppg) 119,8264 kg/m3 friction stress 2.3.3 lbf/100 ft2 0,4788026 pa dynam viscos 2.3.3 cp 0,001 pa s veloc v 2.3.3, 4.2 ft/ 0,3048 m/ fann viscomet read 4.1 (degree) 1 length l, d 4.2, 4.5 ft 0,3048 m veloc v 4.3 ft/min 0,00508 m/ acknowledg research partial fund weatherford international. conflict statement behalf authors, correspond author state conflict interest. refer [1] malloi kp et al. (2009) managed-pressur drilling: not. iadc/sp manag pressur drill underbalanc oper confer exhibition. san antonio tx, usa [2] elliot d et al. (2011) manag pressur drill eras lines. schlumberg oilfield review 23(1): 14-23 [3] van riet ej, reitsma d (2003) develop test fulli autom accur control downhol pressur drill operations. spe/iadc middl east drill technolog confer & exhibition. abu dhabi, uae [4] guo c et al (2010) manag pressur drill micro flux technolog allow safer drill highli sour reservoirs. intern oil ga confer exhibit china. beijing, china [5] streeter vl, wyli eb (1998) fluid mechan (intern 9th revis ed.). mcgraw-hil higher education, new york [6] lohrasbi ar, attarnejad r (2008) water hammer analysi characterist method. american journal engin appli scienc 1(4): 287-294 27 [7] amein m, chu hl (1975) implicit numer model unsteadi flows. journal hydraul divis - asc 101(6): 717-731 [8] wyli eb, streeter vl (1970) network transient calcul implicit method. 45th annual meet societi petroleum engin aime. houston tx, usa [9] ghidaoui m et al. (2005) review water hammer theori practice. appli mechan review - asm 58: 49-76 [10] greyvenstein gp (2002) implicit method analysi transient flow pipe networks. intern journal numer method engin 53: 1127-1143 [11] anderson jd (1995) comput fluid dynamics: basic applications. mcgraw-hill, new york [12] celigueta ma et al (2016) fem-dem techniqu studi motion particl non-newtonian fluids. applic transport drill cut wellbores. comput particl mechan 3(2): 263- 276 [13] (2010) rheologi hydraul oil-wel fluid - api recommend practic 13d (6th ed.). american petroleum institute, washington-dc [14] herschel wh, bulklei r (1926) konsistenzmessungen von gummi-benzollsungen, kolloid zeitschrift 39: 291300 [15] walker re, may tm (1975) design mud carri capacity. journal petroleum technolog 259: 893-900 [16] bourgoyn at, millheim kk, chenevert me, young fs (1986) appli drill engineering. spe textbook series, richardson-tx, pp 173-183 [17] lomax h, pulliam th, zingg dw (2003) fundament comput fluid dynamics. springer, berlin [18] godunov sk (1954) differ method shock waves. phd thesis, moscow state university. [19] stein e, borst r, hugh tjr (eds.) (2004) encyclopedia comput mechanics. wiley, hoboken-nj, vol. 1: chapter 14 [20] sifferman tr, mayer gm, haden el, wahl ha (1974) drill-cut transport full-scal vertic annuli. journal petroleum technology, 26(11): 1295-1302 [21] araya w, chaudhri m (2001) unsteadi friction rough pipes. journal hydraul engin 127(7): 607-618 caratula springercluster.pdf upcommon portal del coneix obert la upc aquesta s una cpia la versi author final draft d'un articl publicat la revista comput particl mechanics. la publicaci final est dispon springer trav copi author 's final draft version articl publish journal comput particl mechanics. final public avail springer articl publicat / publish article: