tec forecast base manifold trajectori articl tec forecast base manifold trajectori enriqu mont moreno 1 , * id , alberto garca rigo 2,3 id , manuel hernndez-pajar 2,3 id heng yang 1 id 1 depart signal theori communic , talp research center , technic univers catalonia , barcelona , spain 2 upc-ionsat , technic univers catalonia , barcelona , spain 3 ieec-cte-cra , institut  estudi espaci de catalunya , barcelona , spain * correspond : enric.mont @ upc.edu ; tel .
: +34-934016435 academ editor : name version june 8 , 2018 submit remot sen .
abstract : paper , present method forecast ionospher total electron content1 ( tec ) distribut intern gnss servic  global ionospher map .
forecasting2 system give estim valu tec distribut base linear combin of3 previous tec map ( i.e .
set 2d array index time ) , comput tangent4 subspac manifold associ map .
use tangent space map justified5 allow model possibl distort one observ next trajectori on6 tangent manifold map .
coeffici linear combin last observations7 along tangent space estim time stamp order minim mean square8 forecast error regular term .
estim made time stamp adapt9 forecast short-term variat solar activity..10 keyword : total electron content ; ionospher ; forecast ; tangent distanc ; gnss11 1 .
introduction12 capabl monitor forecast space weather near-earth environ , particular13 ionospher , becom critic nowaday .
number applic can14 benefit estim nowcast forecast ionospher state .
particular , reli on15 global navig satellit system ( gnss ) satellit base augment system ( sbas ) .16 fact , perturb ionospher state affect multipl system reli signal propagate17 ionospher refract media .
inde , sever ionospher disturb impli loss of18 lock gnss receiv locat earth  surfac on-board leo satellit , egno performance19 degrad event [ 21 ] , [ 2 ] , degrad precis posit , among other .
addit , monitoring20 near-earth environ also help take appropri decis space launch operators21 ( [ 4 ] , [ 20 ] ) .
context , one decad ago european space agenc ( esa ) alreadi show their22 interest two-day ahead predict mission plan , particular , soil moistur and23 ocean salin mission [ 3 ] , [ 5 ] , [ 1 ] .24 sever method forecast ionospher paramet estim gnss data have25 develop last year .
instanc [ 6 ] , approach esa , base extrapolation26 spheric harmon coeffici , upc approach [ 1 ] , base discret cosine27 transform ( dct ) .
one method estim vertic total electron content ( vtec ) map to28 combin sever predict vtec global ionospher map ( gim ) , done context of29 intern gnss servic ( ig ) ionospher work group ( ig iono-wg ) .30 addit , method base neural network also develop [ 7 ] , [ 8 ] , [ 9 ] , [ 23 ] ,31 autocorrel autocovari procedur [ 10 ] , [ 11 ] , [ 12 ] , linear regress [ 13 ] , [ 14 ] , grey32 submit remot sens. , page 1  25 www.mdpi.com/journal/remotesens http : //www.mdpi.com https : //orcid.org/0000-0002-4907-0494 https : //orcid.org/0000-0001-6226-4851 https : //orcid.org/0000-0002-9687-5850 https : //orcid.org/0000-0002-1583-2307 http : //www.mdpi.com/journal/remotesens version june 8 , 2018 submit remot sen .
2 25 model [ 22 ] .
hand , method develop depend physic models,33 [ 24 ] , one consid jpl global ionospher thermospher model ( gitm ) .34 tec forecast method reli time seri upc vertic tec ( vtec ) gims35 ( label uqrg ) comput tomion v1 softwar frame intern gnss service36 ( ig ; [ 36 ] [ 15 ] ) .
tomion softwar main develop one author manuscript37 ( mhp ) consist two main version : tomion v1 , focus estim electron38 content model , most base gnss dual-frequ measur ionospher tomographic39 krige interpol ; tomion v2 , consist hybrid geodet tomographic40 ionospher model allow precis ionospher determin precis posit , among41 gps radio-occult data process , see [ 15 ] , [ 18 ] , [ 17 ] , [ 16 ] .
particular , either uqrg 15-min42 resolut 1-day latenc upc real-tim vtec map ( label urtg ) , computed43 continu 30-second rate , ingest forecast approach .
case , gims44 provid bidimension vtec valu assum thin single-lay ionospher model height of45 450 km consid world-wid regular grid everi 5 /2.5 longitude/latitud rang ( i.e .
7146 latitudin 72 longitudin point account total 5112 vtec valu per map ) .
note that47 build forecast time seri , map transform local-tim sun-fix reference48 frame.49 brief , way calcul vtec valu tomion reli simultan estim the50 electron densiti valu ionospher electron content distribut , consid basi functions51 partit voxel , ambigu ionospher combin carrier phase .
both52 set paramet estim forward kalman filter .
, slant total electron content53 ( stec ) affect gnss receiver-satellit signal estim li = l1  l2  istec + bi .54 i = 2  1  1.05 i = 40.3/ f 2i .
bi carrier-phas ionospher ambiguity,55 estim part tomion process chain deriv upc gim .
addit , kriging56 interpol techniqu [ 16 ] use fill gap lack data , given inhomogeneous57 sparsiti gnss receiv [ 25 ] , [ 26 ] .58 result present work obtain uqrg map , sinc proven59 best perform independ tec measur - jason test - altimeter60 data , well independ gnss receiv -dstec test- among differ ig model ( the61 detail , see [ 19 ] ) .
particular , result paper deriv uqrg data years62 2014 -coincid mild 24th solar cycl maximum- , 2015 2016.63 2 .
justif method64 method propos evolut forecast method base bi-dimensional65 discret cosin transform ( 2d-dct ) [ 1 ] [ 20 ] .
origin decid use dct method66 analog video compress method base predict code ( instanc , see chapter67 8 [ 27 ] ) .68 analog lie fact time evolut tec map understood series69 imag , map index tempor index .
suitabl use 2d-dct70 describ tec map due smooth map , i.e .
low spacial frequency71 compon .
word , typic energi ( > 95 % ) concentr normalized72 horizont vertic frequenc less 1/10 .
properti allow forecast base a73 small subset coeffici dct transform domain , given map reconstructed74 low distort .
therefor , instead deal whole map , method model the75 time evolut subset dct coeffici account tempor chang of76 general shape ioniz zone .
meant forecast done use basi extracted77 low frequenc compon dct span space possibl tec global map ( in78 linear algebra sens ) .
result predict correct throughout map except the79 area correspond transit differ level ionize , border these80 high-ion region ( main case appleton-hartre anomali ) .
region occupi a81 version june 8 , 2018 submit remot sen .
3 25 small area whole map , specif region contribut forecast82 error .
therefor , tempor distort shape area highest ionize not83 well model local .
new forecast model inspir fact .
, although border84 region repres small fraction whole area/map forecast , account of85 error.86 exampl , present forecast two differ time year differ solar87 activ .
decid select differ date order show error edg high88 ionize zone occur differ level solar activ .
also show , effect occur a89 lesser extent model propos articl .
figur 1 2 correspond prediction90 dct method figur 8 tangent plane method present articl .
figur 191 correspond month may ( lower solar activ , see figur 13 ) , 2 month february.92 figur 8 comput dates.93 improv due use tangent plane evid fact area an94 error 20 tecus ( total electron content , defin 1 tecu=1016 el/m2 ) are95 locat much smaller area error maps.96 figur 1 .
forecast mean dct method horizon 3 hour .
time stamp , 2016-05-12 15:15:00 ( year-month-day hour : minut : second ) .
current map ( upper left ) , futur map ( upper right ) , forecast ( lower left ) , forecast error ( lower right ) .
97 98 version june 8 , 2018 submit remot sen .
4 25 figur 2 .
forecast mean dct method horizon 3 hour .
time stamp , 2016-02-21 13:15:00 ( year-month-day hour : minut : second ) .
current map ( upper left ) , futur map ( upper right ) , forecast ( lower left ) , forecast error ( lower right ) .
order solv problem model simultan smooth region map the99 chang border high-ion region decid use differ basi ( sense100 element linear combin span subspac ) allow model chang the101 border due differ distort shape high-ion region .
set transformations102 might allow model chang border , might small rotat , small horizont or103 vertic displac , thicken thin border , hyperbol ( shear ) distort .
the104 interest transform resid fact one time stamp next , changes105 map border ioniz region might categor mix above106 mention transformations.107 techniqu creat basi model chang border ioniz region is108 base idea deform prototyp .
techniqu use pattern recognit dealing109 common distort optic charact recognit ( ocr ) ( see instanc , [ 28 ] , [ 29 ] [ 30 ] ) .110 idea assum imag , case map denot p , point high dimensional111 space .
71x72 pixel map p consid point space dimens 71x72 = 5112 , i.e.112 p  r5112 .
model local chang one map next , assum transformation113 ( p ,  ) , creat anoth imag , parameter  .
exposit method , follow114 notat present [ 29 ] .115 figur 3 , show diagram method .
note given point p , creat trajectory116 space r5112 , introduc small linear chang along direct space .
exampl of117 version june 8 , 2018 submit remot sen .
5 25 figur 3 .
tangent space manifold map  2016-01-19 10:30:00 ( year-month-day hour : minut : second )  figur , distort , parameter  , consist rotat map .
thus , denote118 set point x r5112 rotat  set sp = { x| x = ( p ,  ) } .
the119 figur , trajectori follow x , i.e .
new imag obtain small rotat p , represented120 parabola , one-dimension curv embed space possibl map r5112 .
note121 know valu pixel map p , structur transform ( case122 rotat ) , character trajectori r5112 manifold , one comput tangent123 vector point .
tangent vector repres line intersect curv manifold at124 p , repres vector ~t .
small valu  , approxim ( p ,  ) taylor125 expans around  = 0:126 ( p ,  ) = ( p , 0 ) +  s ( p ,  )  + ( 2 )  p + ~t ( 1 ) exampl , allow anoth transform , vertic translat , would a127 differ trajectori along one dimension manifold correspond tangent vector .
hence,128 two tangent vector : ~trot ~tytran , defin tangent plane , construct first order129 approxim chang map/point p transform new point tangent130 plane:131 ( p ,  )  p + rot~trot + ytrans~tytran ( 2 ) general exampl , denot estim forecast map future132 time valu  + h p+h , function current map p time  plus point the133 tangent plane span set tangent vector ~tdist .
tangent space ~tdist defin list134 distortions/transform listdist defin follow list:135 listdist = { x/y-transl , thickening/thin , rotat , parallel hyperbol , diagonal136 hyperbol } 137 paramet h allow model fact forecast horizon might differ from138 sampl rate .
forecast horizon  + h express follows,139 p+h = 0p  +  dlistdist d~t  ( 3 ) version june 8 , 2018 submit remot sen .
6 25 criterion determin valu weight d equat 3 might minimization140 l2 norm error observ  + h , combin observation141  , along linear combin compon tangent space ~tdist , is:142 { d|d  listdist }  argmin d dlistdist p+h  0p +  dlistdist d~t   2 ( 4 ) note dimens p much higher number paramet d , problem is143 well pose .
initi model equat 4 extend improv , take account the144 fact ionize region chang slowli time , therefor could use set previous145 map { p1 ,    , pn } order give better forecast .
tangent space previous maps146 also comput , combin linear set previous map .
give rise two147 possibl strategi estim forecast:148 ) past map pi , estim valu d element tangent space mean of149 equat 3 , give partial estim  + h map , p+hi .
afterward final estimation150 done linear regress partial estimate.151 b ) comput tangent space map { p1 ,    , pn } , linear regression152 use n map tangent space.153 although linear combin follow anoth linear combin equival single154 linear combin , note estim point view , coeffici obtain method155 ) differ one obtain b ) .
preliminari experi ( done use data of156 year 2014 ) , found although estim method ) allow us interpret the157 forecast , use test signific order ass number past map relev the158 forecast .
nevertheless method b ) gave better perform rmse sens .
addit insight159 obtain ) relev previous snapshot forecast future160 uniform along time , i.e. , sometim relev snapshot past minutes,161 case relev snapshot hour past.162 methodolog reason , use data year 2014 train determin structure163 algorithm , data year 2015 independ valid contrast dataset , finally164 data year 2016 character perform new forecast model , i.e .
results165 deriv data seen comput paramet model deciding166 structur .
methodolog done order diminish possibl effect overfit and167 select bias .
preliminari experi test differ machin learn techniqu [ 32 ] .168 select forecast algorithm evalu two experiment frameworks,169 ) use histor set valu ( one year ) order estim paramet forecasting170 techniqu .
method advantag use larg set machin learning171 algorithm .
drawback , lead complic model take account all172 possibl featur time evolut map .
machin learn algorithm can173 train approach .
particular evalu linear regress , lasso , clustering174 ( k-mean ) , cart neural network ( mlp ) .175 b ) use data limit number map prior current one .
drawback method176 use regular linear regress .
methods177 need much higher number exampl .
advantag approach one deal178 fact , although ionize pattern similar larg region , high179 variabl , shape , morpholog ionize region time seri of180 map .
shape border ionize region chang slowli rate change181 differ part border uniform .
justifi introduct the182 tangent space , model local chang , estim coeffici linear183 regress local data order select relev components.184 version june 8 , 2018 submit remot sen .
7 25 preliminari experi show method ) produc greater error b ) .
we185 discard method : neural network , svm , cart , infeas training186 model approach b ) .187 evolut region highest ionize slow tec forecast case , and188 chang differ time epoch concentr border region highest189 ionize , decid use method took account small distort .
done by190 comput tangent vector ( also call lie deriv ) differ kind local spatial191 distort .
tangent vector space dimens 5112 repres imag of192 71x72 , forecast consist linear combin past map respect set tangent193 vector set distort ( geometr algebra detail see next subsect ) .194 3 .
descript tangent space method195 section , follow [ 29 ] , defin equat comput tangent196 space list distort listdist defin section 2 .
differ implementation197 forecast tec map one propos [ 29 ] ocr , smooth finite198 differ approxim deriv .
case ocr , smooth done means199 2d low pass filter necessari order assur smooth curvatur border the200 new templat .
case , test differ smooth techniqu , linear low pass filters,201 total variat smooth , result deterior perform .
therefor , we202 approxim deriv finit differ without smooth : s ( p ,  )   s ( p ,  )  203 finit differ comput use second order central differ interior grid points204 map .
boundari map , deriv approxim first order difference205 border point ( i.e tec valu ) correspond nearest inner grid point.206 , interior grid point map , discret approxim comput as207 follows:208  f ( x , ) x  f ( x + 1 , )  f ( x 1 , ) 2 ( 5 ) and209  f ( x , ) y  f ( x , + 1 )  f ( x , y 1 ) 2 ( 6 ) border point map , discret approxim comput as:210  f ( x , ) x  f ( x , )  f ( x 1 , ) 2 ( 7 ) and211  f ( x , ) y  f ( x , )  f ( x , y 1 ) 2 ( 8 ) construct tangent vector possibl seven transformations:212 listtran f orm = { x-translat , y-translat , rotat , parallel hyperbol transform , diagonal213 hyperbol transform , thicken thin transform } 214 defin oper refer origin coordin center map , which215 case : ( 71/2 , 72/2 ) , local perturb distort denot  .
figur 4,216 show tangent space given map ( upper left ) observ time stamp  2016-02-21 13:30:00  217 ( year-month-day hour : minut : second ) .
equat defin direct span the218 tangent space following:219 1 .
x/y-translation:220 version june 8 , 2018 submit remot sen .
8 25 figur 4 .
compon tangent space correspond map observ  2016-02-21 13:30:00  tx : [ x ]  [ x +  ] ty : [ x ]  [ x +  ] ( 9 ) correspond lie oper defin : lx =  x ly =  y221 2 .
rotat small angl :222 tr : [ x ]  [ x cos (  )  sin (  ) x sin (  ) + cos (  ) ] ( 10 ) correspond lie oper defin : lr =  x  x  y223 3 .
parallel/diagon hyperbol transformation:224 parallel hyperbol transform defin shear transform ( left ) , diagonal225 hyperbol transform ( right ) defin squeez mapping.226 tp : [ x ]  [ x + x y y ] td : [ x ]  [ x + y + x ] ( 11 ) correspond lie oper defin as:227 lp = x  x   y ( parallel ) ld =  x + x  y ( diagon ) 228 4 .
thicken thin transformation:229 tt : [ x ]  [ x + rx + ry ] ( rx , ry ) =  f ( x )  f ( x )  ( 12 ) correspond lie oper defin : lt =  f ( x )  =  (  x ) 2 + (  y ) 2230 5 .
scale transformation:231 version june 8 , 2018 submit remot sen .
9 25 ts : [ x ]  [ x + x + y ] ( 13 ) correspond lie oper defin : lp = x  x +  y232 3.1 .
transform map along tangent directions233 effect map small perturb  direct compon of234 tangent space summar figur 5 , 6 7 .
figur present two group maps,235 correspond two differ direct tangent space .
figur 5 , show effect of236 move map , along  rotat  direct ( left group ) , along  thicken  direct ( right237 group ) .
left group four map show origin map ( upper left ) , tangent map small238 rotat map , ( lower ) two reconstruct map opposit direct .
effect moving239 map either along posit direct tangent space , i.e .
p + 0.1~t rotat slight the240 map clockwis , along negat direct anticlockwis .
note shift valu  = 0.1 in241 case impli notic rotat , also increas background level ionization.242 analog , tangent direct relat thickening/thin transform ( right ) , increases243 area ioniz region ad ( thicken ) p + 0.1~t , reduc area ( thin ) , when244 subtract , i.e .
p 0.1~t .
figur 6 , show effect scale transform ( left group ) , shift figur 5 .
rotat manifold ( left group ) thicken manifold ( right group )  2016-01-19 10:30:00  245 vertic direct ( right group ) .
effect scale transform diagon displac of246 ioniz region , effect vertic shift bare notic .
highlight the247 size factor  differ scale .
practic , seen instanc figur 9 , the248 valu weight dimens tangent space differ size , valu 249 take valu wide rang .
term relat rotat small , term relat the250 y-translat much higher .
valu  = 0.1 give rise clear rotat ioniz area figure251 5 , valu bare chang map , shown figur 6 ( right ) .
case horizontal252 shift analog case vertic shift.253 figur 7 , show effect hyperbol ( shear ) transform map , accounts254 diagon deform map .
note case , scale factor  , increas the255 background ionize level , model reason well chang high ioniz region.256 effect chang background ioniz level taken account forecast model257 introduc bias term forecast , intercept.258 version june 8 , 2018 submit remot sen .
10 25 figur 6 .
scale transform ( left group ) y-translat ( right group )  2016-01-19 10:30:00  figur 7 .
diagon hyperbol transform ( left group ) parallel hyperbol transform ( right group )  2016-01-19 10:30:00  4 .
model forecaster259 4.1 .
structure260 section , present model forecast map given horizon .
this261 model base idea present section 2.262 univari time seri ( see , instanc , [ 33 ] ) , forecast model sometim consist linear263 combin past sampl .
case , analog consist linear combin of264 time seri last n map { p1 ,    , pn } , correspond tangent space .
the265 select past lag , took account fact general pattern ionize a266 main period one day .
thus , along map insid time window near current267 observ , select time window approxim time lag 24 hour prior the268 current map .
problem model select model estim well known machin learning269 version june 8 , 2018 submit remot sen .
11 25 ( see instanc [ 32 ] , chapter 7 8 ) .
case time seri , special difficult problem , due270 correl sampl presenc cyclic pattern differ origin scales.271 methodolog reason , divid data three set order decoupl process272 select structur paramet model .
potenti configur the273 forecast model ( i.e .
set lag previous map tangent space ) , defin optim set of274 delay estim algorithm train year , i.e .
2014 , valid perform for275 differ configur rmse evalu data year 2015 .
final , independ data276 year 2016 left report perform .
list time horizon use work is277 follow : horizon = { 1/2h , 1h , 2h , 3h , 6h , 24h } 278 structur forecast evalu includ differ time lag prior p0 ,279 time lag center multipl 24 hour p0 .
addit , possibl inclusion280 tangent map , possibl combinations.281 interest result best perform obtain use delay lag multiples282 forecast horizon , inclus neighborhood p024h.283 general structur model forecast horizon h includ use list delay284 lag i summar tabl 1.285 tabl 1 .
list time lag i weight  forecast model .
note subindex   , run along tangent space list listdist state output input 0 input 1 input 2 input 3 input 4 input 5 train 0 0  h 0  2h 0  3h 0  24h 0  h  24h 0  2h  24h forecast 0 + h 0 0  h 0  2h 0 + h  24h 0  24h 0  h  24h weight 0 , d,0 1 , d,1 2 , d,2 3 , d,3 4 , d,4 5 , d,5 figur 9 , plot valu estim paramet  , forecast horizon h = 1hour .
plot show term correspond delay neighbourhood p024h ( i.e .
one day ) signific contribut .
effect much lower delay lag 48 hour , decid includ use delay improv perform valid databas ( i.e .
year 2015 ) , increas signific complex model .
anoth effect consist appear experi contribut forecast came current map , along tangent space , forecast power greater lag diminish quick .
thus , context forecast limit 0  2h .
also order model fact might global chang ionize , introduc intercept intercept .
forecast done mean follow formula , p+h = intercept +  llistlag lp l +  dlistdist  llistlag d , l~t l ( 14 ) set element tangent space summar listdist , explain detail the286 subsect 3.287 4.2 .
paramet estimation288 subsect argu criteria select estim algorithm model289 present equat 14 .
model consist linear combin map , weight the290 coeffici l d , l , estim differ criteria .
set structur of291 delay , valu coeffici  , determin forecast step minim a292 cost function , therefor make forecast robust respect solar maximum/minimum293 condit .
analog equat 4 , minim forecast error restrict on294 possibl weight .
note estim paramet done use near past295 map p0 time 0 .
specif , order estim paramet model use as296 version june 8 , 2018 submit remot sen .
12 25 time indic row  train  tabl 1 , forecast done use time indic the297  forecast  row .
note tabl , lower row , defin notat weights298 associ delay.299 use last sampl ( i.e .
sampl row  train  tabl 1 ) for300 estim weight justifi empir fact perform forecaster,301 exhibit better rmse .
estim paramet ( i.e .
train ) done use the302 whole year result perform signific wors .
explan local ( the303 tempor sens ) variat map , greater contribut relat weight past304 sampl tangent space fix set weight comput long time series.305 drawback use small set sampl estim paramet system306 equat might underdetermin suffer problem collinear .
therefor order307 deal problem , criterion estim paramet regularization308 term .
regular term consist penal norm weight .
case using309 norm l2 method known ridg regress , case use norm l1 method is310 known lasso ( see instanc [ 32 ] chapter 3 ) .
differ norm ridge311 regress introduc constant  diagon covari matrix result uniform312 decreas valu estim paramet , lasso algorithm paramet 313 determin level sparsiti , i.e .
number paramet valu equal zero.314 optim criterion present equat 15 , regular term d , d , lli315 correspond ridg regress li = l2 , lasso li = l1 .
also considered316 use norm l1 error term , i.e .
p+h  p+hi l1 .
norm penal small valu of317 error , influenc outlier estim weight small .
problem at318 hand , use norm error term , gave much higher proport map least319 negat valu tec .
therefor select l2 norm error term , give following320 cost function .
implement done work , result present use ridge321 regress regular ,  select cross-valid data year 2014.322 differ perform obtain use ridg regress lasso neglig , and323 ridg regress select run time faster.324 { d , d , l }  argmin d , d , l p+h  p+hi l2 +  d , d , lli ( 15 ) typic exampl shown figur 8 present forecast horizon 3 hour , two different325 time stamp , i.e .
2016-05-12 15:15:00 ( left ) 2016-02-21 13:15:00 ( right ) .
comparison purposes326 figur 1 2 show exampl perform use dct forecast same327 condit .
benchmark follow determin perform system will328 use frozen map , defin predict made current map keep its329 vtec valu constant sun-fix refer frame , i.e .
consid local-tim / latitud coordinates.330 rmse ratio forecast , use frozen map forecast 76 % , be331 seen figur 12 mode histogram ratio rmse .
weight associated332 estim shown figur 9 .
note presenc posit intercept bias intercept,333 model , contribut background ionize differ element are334 combin linear , possibl increas background ionize .
addit note that335 main contribut forecast , come current map , strong negat component336 vertic deviat .
third import contribut forecast relat map at337 0 + h  24h ,  tangent space long vertic direct .
hand contribut of338 map 1 2 hour case marginal.339 forecast map vectpr ( lower right ) much smoother either current map pnow the340 target map pfutur .
addit distribut error reproduc observ borders341 ioniz region accumul error , case part border error reach a342 maximum 9.5 tecus.343 version june 8 , 2018 submit remot sen .
13 25 figur 8 .
forecast horizon 3 hour ( tangent space method ) , time stamp , 2016-05-12 15:15:00 ( left group ) 2016-02-21 13:15:00 ( right group ) .
group plot , current map ( pnow upper left ) , target map ( pfutur , upper right ) , predict error ( lower left ) , forecast ( vectpr lower right ) .
forecast tec valu alway posit ( train valid year ) , except for344 small fraction case 30 minut 1 hour forecast .
case forecast 1hour,345 123 map least one negat pixel , total 34536 ( i.e whole year ) .346 case , negat valu , substitut valu frozen predict the347 latitude/longitud forecast negative.348 5 .
results349 section summar perform forecast system base tangent350 space .
first result consist comparison error sens total tec rmse ( i.e .
the351 mean valu pixel map ) .
compar forecast use tangent space ( which352 denot tangent space method ) forecast creat consid chang map a353 most sun-fix refer frame ( local-tim vs latitud ) , denot frozen map method.354 given time seri n map , map time  consist tecu valu xlon , lat and355 estim valu xlon , lat rmse comput as:356 rmse =  1 nlat  nlon nlat  lat=1 nlon  lon=1 ( xlon , lat  x  lon , lat ) 2 ( 16 ) figur 10 shown comparison forecast rmse time seri tangent space357 method frozen map method interv 10 day month march 2016.358 figur comparison method done horizon 30 minut , 1 hour , 3359 hour 1 day .
rmse time seri tangent space method ( red ) , systemat below360 frozen method ( blue ) case 30 min , 1 hour 3 hour , period error of361 day .
case horizon 1 day , forecast error methods.362 rmse result comput mean map , mention section 2 , main363 contribut error origin border high ioniz region .
therefor tec364 valu present subsect averag low error region border .
the365 version june 8 , 2018 submit remot sen .
14 25 figur 9 .
weight one hour forecast time  2016-02-21 13:15:00  .
term dpdisttim , indic tangent space s ( p , dist ) dist = ~tdist correspond time lag .
version june 8 , 2018 submit remot sen .
15 25 result repres general behaviour algorithm , compat results366 averag entir year , shown tabl 2.367 figur 10 .
time evolut tec rmse , case forecast tangent space method ( red ) , frozen map method ( blue ) differ horizon ( see annot upper part figur ) figur 11 present boxplot ( see [ 34 ] ) forecast error differ horizons,368 comput whole year .
one see case , except 1 day , forecast error in369 term forecast rmse obtain tangent space method better use frozen map .
the370 proport improv summar tabl 2 .
improv refer the371 median valu , also rang error extern whisker ( defin range372 quartil q1 ( i.e .
percentil 25 % ) less 1.5 time interquartil rang , i.e .
difference373 q3 ( i.e .
percentil 25 % ) q1 , , first datum greater q1 1.5  ( q3q1 ) 374 extrem given last datum less q3 + 1.5  iqr ) .
seen the375 figur , dispers around mean correspond tangent space method lower , the376 sens enclos smaller margin , also sens systemat lower value.377 anoth featur lower preval high valu outlier case tangent space378 method.379 figur 11 .
box plot tec rmse , case forecast frozen valu ( left ) tangent space ( right ) , horizon ( see tick label figur ) version june 8 , 2018 submit remot sen .
16 25 tabl 2 .
ratio rmse tangent space forecast frozen map wrt actual map differ horizon .
horizon 1/2h 1h 2h 3h 6h 24h ratio 84.99 % 77.65 % 71.35 % 69.34 % 87.23 % 95.76 % tabl 2 , show ratio root mean squar error ( rmse ) , tangent space method vs380 frozen map method .
rmse case comput mean n , map corresponding381 year , forecast made everi 15 minut .
rmse comput follows:382 rmse =  1 n  nlat  nlon n  =1 nlat  lat=1 nlon  lon=1 ( xlon , lat  x  lon , lat ) 2 ( 17 ) tabl seen case ratio forecast rmse 100 % , the383 tangent space method give lower rmse forecast mean .
figur 12 show histogram of384 ratio time interv 42 day .
note maxima histogram coincid approximately385 mean valu shown tabl 2 , due low varianc skew the386 histogram .
note also coeffici tangent space forecast comput each387 forecast , result perform method bias solar cycl , , have388 seen empir total rmse proport under mean tec .
thus although the389 tangent space method better freez , rmse also depend solar cycl conditions.390 391 result differ horizon show perform follow convex shape , a392 minimum error 3 hour horizon .
particular perform 1/2 hour 6 hour , has393 mean valu 85 % , wors horizon { 1 , 2 , 3 } hour .
case 1/2 hour394 due fact rate chang state ionospher slow , horizon395 small room improv forecast .
small chang state ionosphere396 reflect fact rmse due freez mean 2 tec , lower at397 forecast horizon seen figur 10 .
interest histogram shown figur 12,398 number sampl error greater 100 % much higher case also399 upper valu much higher , account fact histogram ratio between400 number small.401 trend seen figur 12 boxplot , spread forecast errors402 error increas function horizon .
nevertheless note reflect figur 12 , the403 tangent space forecast intermedi horizon give lower limit % error , number404 sampl error greater 100 % much lower .
indic qualiti tangent405 space forecast sens total rmse better case freez , horizons406 except 24 hours.407 hand , horizon 6 hour perform degrad , compar the408 perform 1/2 hour , indic hypothesi small chang tangent space409 ( see section 3.1 ) , begin entir valid .
final horizon 24 hour , performance410 differ much freez map , indic , hypothesi underlying411 model tangent space hold , also simpl linear combin past412 observ enough model tec map day  horizon .
forecast mean of413 tangent space slight better freez last observ , figur 12 show the414 ratio perform two system shape similar gaussian , mean at415 95 % , standard deviat near 10 % .
hand boxplot figur 11 ( left ) , show a416 median rmse 5 tecus , might accept .
note although found the417 compon 24 hour relev forecast short term horizon , seem adequate418 version june 8 , 2018 submit remot sen .
17 25 figur 12 .
histogram forecast rmse ratio tangent space method , frozen map method .
upper left horizon 30 min , upper right horizon 1h lower left horizon 3h lower right horizon 24h .
2016-01-10 2016-02-21 , total 4080 map .
forecast long horizon .
, short-term predict , map 24 hour in419 advanc complement inform last observ help improv forecast by420 make use period ionize patter .
hand , horizon directly421 24 hour , inform yield last observ enough good forecast.422 comparison purpos , figur 13 , show time evolut rmse tecus a423 whole year differ forecast horizon ( 3 hour ) .
figur consist superposit the424 instantan rmse low pass filter ( zero phase , move averag cut frequency425 1/ ( 0.5month ) ) time seri .
shape tempor evolut rmse whole year is426 similar forecast horizon .
first featur notic season compon with427 maximum activ spring autumn superpos cyclic compon period of428 28 day .
case forecast mean tangent space model , differ the429 maximum minimum low pass filter version 1.5 tecus , mean valu spring430 3.5 tecus , summer 2 winter 2.5 tecus .
variabl error much431 version june 8 , 2018 submit remot sen .
18 25 lower summer .
variabl much higher would expect case gaussian432 distribut ( see section 5.4 ) , local peak 6 tecus occur certain moment 14433 day time seri .
test done year 2014 2015 , activ higher , and434 result analog , systemat increas low pass filter rmse 1 tecus .
note435 , methodolog point view ( machin learn ) , analog mere indicative,436 year use determin structur forecast .
figur 13 .
time evolut whole year total rmse tecus horizon 3 hour .
left , frozen forecast , red time seri low pass filter .
right forcast mean tangent space method .
437 5.1 .
improv forecast due use tangent space comparison dct forecasting438 method439 section , compar propos approach forecast system use440 tangent space origin vtec map ( label map ) one base dct441 ( dct method ) .
case , number free paramet model lower the442 tangent model , mean comparison equal term .
hand , possibility443 comparison equal number degre freedom would use number of444 map equal number element tangent map .
case , either took map further445 past , increas differ map forecast , increas the446 number recent map , high correl input given therefor bad conditioned447 problem .
improv due use tangent space , shown tabl 3 .
result is448 use tangent space coeffici improv forecast result horizon , except for449 24h .
case ( except horizon 24h ) use tangent space improv result the450 dct method .
24h case explain fact tangent space model local distortions,451 account chang long rang .
note confid margin ( standard452 deviat ) shown , use 34626 map comput mean valu rmse453 gave extrem small values.454 455 5.2 .
perform function latitude456 next analyz perform algorithm function latitud .
analyz the457 whole year 2016 set horizon 1 hour , total 34626 map .
note test year458 differ year use determin valid structur forecast .
for459 version june 8 , 2018 submit remot sen .
19 25 tabl 3 .
improv ratio rmse tangent space forecast frozen map use tangent space forecast vs case use tangent space map .
horizon 1/2h 1h 2h 3h 6h 24h ratio tang space method 84.99 % 77.65 % 71.35 % 69.34 % 87.23 % 95.76 % ratio use map 89.08 % 80.90 % 76.95 % 73.07 % 91.45 % 94.08 % ratio dct method 87.75 % 78.25 % 74.38 % 71.21 % 88.94 % 89.11 % present result select horizon 1 hour , order show perform a460 situat best worst case.461 rmse function latitud defin ; rmse ( lat ) =  1 n  nlon n  =1 nlon  lon=1 ( xlon , lat  x  lon , lat ) 2 ( 18 ) xlon , lat begin section 5 .
figur 14 , compar , latitud mean462 valu rmse tecus tangent space method vs. frozen map method .
result of463 tangent space method ( left ) systemat give lower valu rms compar frozen464 map method ( right ) latitud , signific improv 30 degrees465 north 30 degre south .
maximum differ 1 tecu maxima , i.e .
8466 degre north , 20 degre south .
hand latitud 50 degre ( north south ) ,467 perform method similar , due fact ionize activ latitud is468 much lower near equat , case rmse 1 tecu .
equat there469 dip rmse profil .
tangent distanc forecast better 0.5 tecus .
fact that470 forecast error locat around 30 degre shape profil , explained471 spacial distribut forecast error , tend locat margin ionized472 zone shown figur 8 .
distribut error map also explain dip the473 forecast error equat .
figur 15 show profil root mean squar the474 valu tecus , whole year 2016 ( left ) ratio rmse tangent space method the475 frozen map method ( right ) also year 2016 .
case present result function of476 latitud .
figur 15 ( left ) , mean tecu valu concentr around equat , with477 mean valu case latitud near equat 25 tecus , decreas the478 latitud get near pole .
note first comparison figur 14 , tell us forecasting479 error mean 10 % .
last fact , nuanc fact forecast error is480 uniform map , distribut border ioniz part map .
figure481 15 ( right ) ratio tangent distanc forecast frozen map , show two minima , locat at482 ( 9-20 ) degre north ( 13-25 ) degre south , 75 % , indic use the483 tangent distanc forecast produc reduct 25 % mean forecast error , regions484 higher ionize .
best improv , given two crest appleton-hartree485 anomali , side side equat .
therefor tangent distanc method capabl modelling486 region high tec gradient .
note coeffici  forecast re-estim for487 predict , mean movement anomali track real time .
the488 forecast improv region near pole lower , explain these489 region lower activ show smaller rate chang .
figur hint possibl of490 design perform index might assign differ penal error depend on491 level activ relat latitude.492 5.3 .
bias varianc decomposit forecast error493 next analyz bias varianc decomposit forecast error , defin follows:494 given map p forecast map p , error decompos as:495 version june 8 , 2018 submit remot sen .
20 25 figur 14 .
rmse tangent space method ( left ) vs. rmse frozen map method ( right ) function latitud .
e [ ( p p ) 2 ] = bias [ p ] 2 + var [ p ] ( 19 ) term defin as:496 bias [ p ] = e [ p p ] ( 20 ) and497 var [ p ] = e [ p2 ]  e [ p p ] 2 ( 21 ) version june 8 , 2018 submit remot sen .
21 25 figur 15 .
root mean squar tecus function latitud ( left ) .
ratio rmse tangent distanc forecast error frozen forecast error ( right ) .
figur 16 , show analysi contribut error var [ p ] ( left tecus2 ) the498 bias [ p ] 2 ( right tecus2 ) function latitud .
varianc forecast near equat is499 12 tecus , explain fact main contribut error appear500 concentr border ioniz region , variat move region .
it501 seen instanc figur 8 , high error valu occupi small part map , local at502 edg high ionize region .
valu peak reach order 9 tecus , while503 error inner part much lower , order 1 tecu .
therefor , observ variance504 understood varianc gaussian distribut , varianc bimodal505 distribution.506 version june 8 , 2018 submit remot sen .
22 25 hand , forecast system almost unbias ( see figur 16 right ) , contribution507 bias total error alway less 0.1 % .
note figur differ scale.508 explan low bias tangent distanc forecast error associ most509 effect set paramet describ degre freedom system .
note section 4.2 , we510 comment dealt fact estim paramet  might undetermined.511 figur 16 .
decomposit forecast error varianc  var [ f ( x ) ] ( left ) vs bias bias [ f ( x ) ] 2 ( right ) .
note unit tecus2 5.4 .
histogram forecast error512 histogram forecast error tecus shown figur 17 .
histogram computed513 pixel 34626 map , give number sampl greater 166 million , is514 size map time number map , i.e .
72x72x34626 .
particular , high error valu are515 version june 8 , 2018 submit remot sen .
23 25 tabl 4 .
empir fraction valu greater tecu valu .
tecu 2 4 6 8 10 12 prob (  > tecu ) 1.95 1001 1.48 1002 9.84 1004 1.21 1004 2.81 1005 8.16 1006 locat border high ioniz region , account tail error histogram .
in516 log frequenc histogram see distribut follow approxim line , be517 describ :518 log10 ( tecu = ) = 1.27t + 1.04 , p-valu less 1.e87 .
empir distribut approxim laplac distribut (  = 0.78 ) : ftecu ( tecu = )  e 1.27t ( 22 ) linear law fail valu rmse greater 10 tecus , explain fact that519 extrem exampl error greater valu .
linear approxim also fails520 valu rmse lower end , < 0.75 tec valu .
empir cumul fraction error figur 17 .
normal log frequenc histogram forecast rmse .
521 greater given tecu valu present tabl 4 .
interest , accumul probability522 diminish fast , prob (  > 4tecus ) lower 1 65 pixel , prob (  > 8tecus ) is523 lower 1 8000 pixel .
howev , explain section 5.3 , extrem valu error are524 isol border high ioniz regions.525 526 6 .
conclusions527 paper , present forecast method tec map , base local information528 model possibl local distort .
addit use sever previous map make prediction,529 make decomposit space span compon tangent manifold maps.530 physic justif , chang horizon less 6 hour consist small changes531 along trajectori follow sequenc .
perform accept forecast532 horizon 6 hour .
horizon 24 hour , perform differ much freezing533 map , indic , hypothesi under model tangent space not534 hold time horizon , also simpl linear combin past observ is535 enough model tec map day  horizon .
explain horizon , the536 chang ionize extern origin deriv time series.537 version june 8 , 2018 submit remot sen .
24 25 author contribut : methodolog , e.m.m. , a.g.r , m.h.p .
h.i .
; softwar , e.m.m .
a.g.r ; validation,538 e.m.m. , a.g.r , m.h.p .
h.i .
; formal analysi , e.m.m. , a.g.r , m.h.p .
h.i .
; data curat , a.g.r ; 539 writingreview & edit , e.m.m .
a.g.r.540 fund : research fund project tec2015-69266-p ( mineco/fed , ue ) .541 acknowledg : author also grate intern gnss servic ( ig ; [ 36 ] ) providing542 gnss open-data ionospher open-products.543 conflict interest : author declar conflict interest.544 references545 1 .
garca rigo , a. , mont moreno , e. , hernndez pajar , m. , juan , j .
m. , sanz , j. , aragn angel , .
salazar , d.546 global predict vertic total electron content ionospher base gps data .
radio scienc 46,547 .
6 .
2011548 2 .
bniguel , yannick , iurii cherniak , alberto garcia-rigo , pierrick hamel , manuel hernndez-pajar , roland549 kameni , anton kashcheyev et al .
monitor ionospher network : two case studi scintil and550 electron content variabl .
annal geophysica , vol .
35 , .
3 , p. 377 .
copernicus gmbh , 2017.551 3 .
silvestrin , pierluiggi , michael berger , yann kerr , jordi font .
esa second earth explor opportunity552 mission : soil moistur ocean salin mission-smo .
ieee geoscienc remot sens newsletter553 118 ( 2001 ) : 11-14.554 4 .
garca-rigo , a. , d. roma-dollas , m. hernndez-pajar , h. lyu , z. li , n. wang , m. terkildsen et al.555 contribut real time near real time ionospher monitor iag rtim-wg .
iag-iaspei joint556 scientif assembl .
2017.557 5 .
status ig ionospher product futur develop .
ig analysi center workshop ( 2008 ) 558 6 .
schaer , s. , socit helvtiqu des scienc naturell .
commiss godsiqu .
map predicting559 earth  ionospher use global posit system .
institut fur geodesi und photogrammetri , eidg.560 technisch hochschul zrich .
( vol .
59 ) 561 7 .
cander , lj r. , m. m. milosavljev , s. s. stankov , s. tomasev .
ionospher forecast techniqu by562 artifici neural network .
electron letter 34 , .
16 ( 1998 ) : 1573-1574.563 8 .
franci , n. m. , p. s. cannon , a. g. brown , d. s. broomhead .
nonlinear predict ionospheric564 paramet fof2 hour , daili , month timescal .
journal geophys research : space physic 105,565 .
a6 ( 2000 ) : 12839-12849.566 9 .
tulunay , ersin , erdem turker senalp , sandro maria radicella , yurdanur tulunay .
forecast total567 electron content map neural network techniqu .
radio scienc 41 , .
4 ( 2006 ) .568 10 .
muhtarov , plamen , ivan kutiev .
autocorrel method tempor interpol short term569 predict ionospher data .
radio scienc 34 , .
2 ( 1999 ) : 459-464.570 11 .
dick , m. i. , m. f. levi , l. r. cander , i. kutiev , p. muhtarov .
short-term ionospher forecast over571 europ .
iee nation confer antenna propag , 1999. pp .
105-107 .
iet , 1999.572 12 .
stanislawska , iwona , zbigniew zbyszynski .
forecast ionospher quiet disturb fof2573 valu singl locat .
radio scienc 36 , .
5 ( 2001 ) : 1065-1071.574 13 .
muhtarov , p. , i. kutiev , lj r. cander , b. zolesi , g. de franceschi , m. levi , m. dick .
european ionospheric575 forecast map .
physic chemistri earth , part c : solar , terrestri planetari scienc 26 , no.576 5 ( 2001 ) : 347-351.577 14 .
krankowski , andrzej , nadegda p. sergeenko , lubomir w. baran , irk i. shagimuratov , marina v. rogova.578 short-term forecast total electron content.artifici satellit 40 ( 2005 ) : 137-146.579 15 .
hernndez-pajar , m. , juan , j. m. , sanz , j .
new approach global ionospher determin using580 ground gps data .
journal atmospher solar-terrestri physic , 61 ( 16 ) , 1237-1247.581 16 .
or , r. , hernndez-pajar , m. , juan , j. m. , sanz , j .
improv global ionospher vtec map by582 use krige interpol techniqu .
journal atmospher solar-terrestri physic , 67 ( 16 ) , 1598-1609.583 17 .
or , r. , hernndez-pajar , m. , juan , j. m. , sanz , j. , garca-fernndez , m. perform different584 tec model provid gps ionospher correct .
journal atmospher solar-terrestri physic , 64 ( 18 ) ,585 2055-2062586 version june 8 , 2018 submit remot sen .
25 25 18 .
hernndez pajar , m. , juan , j. m. , sanz , j. , colombo , o. l. applic ionospher tomographi to587 real time gps carrier phase ambigu resolut , scale 400 - 1000 km high geomagnetic588 activ .
geophys research letter , 27 ( 13 ) , 2009-2012.589 19 .
roma-dollas , david , manuel hernndez-pajar , andrzej krankowski , kacper kotulak , reza590 ghoddousi-fard , yunbin yuan , zishen li et al .
consist seven differ gnss globl ionospheric591 mpping techniqu one solr cycl .
journal geodesi ( 2017 ) : 1-16.592 20 .
garca rigo , .
( 2012 ) .
contribut ionospher determin global posit system : solar593 flare detect predict global map total electron content .
phd thesi , upc594 21 .
hernndezpajar , m. , j. m. juan zornoza , j. sanz subirana , r. farnworth , .
soley .
( 2011 ) egno test595 bed ionospher correct octob novemb 2003 storm , ieee transact geoscience596 remot sens , vol .
43 , .
10 , octob 2005 .
`` 597 22 .
venkateswarlu , g. , sarma , a. d. ( 2017 ) .
new techniqu base grey model forecast of598 ionospher gps signal delay use gagan data .
progress electromagnet research , 59 , 33-43.599 23 .
huang , z. , li , q .
b. , yuan , h. ( 2015 ) .
forecast ionospher vertic tec 1-h ahead use genetic600 algorithm neural network .
advanc space research , 55 ( 7 ) , 1775-1783.601 24 .
meng , x. , mannucci , a. j. , verkhoglyadova , o. p. , tsurutani , b. t. ( 2016 ) .
forecast ionospheric602 total electron content respons high-spe solar wind stream .
journal space weather space climate,603 6 , a19.604 25 .
felten , j. , m. angl , n. jackson-booth , n. jakowski , m. hoqu , m. hernndez pajar , a. aragn angel , r.605 or , r. zandbergen .
compar test four ionospher model driven gps measurements.606 radio scienc 46 , .
6 ( 2011 ) .607 26 .
hernndez-pajarez , manuel , david roma dollas , andrzej krankowski , alberto garca rigo , raul608 or prez compar perform seven differ global vtec ionospher model ig context.609 intern gnss servic workshop ( ig 2016 ) : sydney , australia februari 8-12 , 2016 , pp .
1-13 .
international610 gnss servic ( ig ) , 2016.611 27 .
gonzalez , r. c. , wood , r. e ( 2008 ) .
digit imag process .
addison-welsley612 28 .
simard , p. , lecun , y. denker , j.s. , ( 1993 ) .
effici pattern recognit use new transformation613 distanc .
advanc neural inform process system , pp .
50-58.614 29 .
simard , p. , lecun , y. , denker , j. , victorri , b .
( 1998 ) .
transform invari pattern recognition615 tangent distanc tangent propag .
neural network : trick trade , pp .
549-550.616 30 .
hasti , t. simard , p ( 1995 ) .
learn prototyp model tangent distanc .
advanc neural617 inform process system , pp .
999-1006.618 31 .
goodfellow , i. , bengio , y. , courvill , .
( 2016 ) .
deep learn ( adapt comput machine619 learn seri ) .
adapt comput machin learn seri , 800.620 32 .
friedman , j. , hasti , t. tibshirani , r. ( 2001 ) .
element statist learn .
springer seri in621 statistics. , 800.622 33 .
mill , terenc c ( 1991 ) .
time seri techniqu economist .
cambridg univers press623 34 .
( 2018 ) , matplotlib document , avail : https : //matplotlib.org/api/_as_gen/matplotlib.pyplot.624 boxplot.html ( access 1 februrari 2018 ) 625 35 .
lyu , haixia , manuel hernndez-pajar , metin nohutcu , alberto garc-rigo , hongp zhang , jingnan626 liu .
barcelona ionospher map function ( bimf ) applic northern mid-latitudes.627 gps solut 22 ( 2018 ) : 1-13.628 36 .
dow , j. m. , neilan , r. , rizo , c. : intern gnss servic chang landscap global629 navig satellit system , journal geodesi , 83 , 191198 , 2009.630 c 2018 author .
submit remot sen .
possibl open access publication631 term condit creativ common attribut ( cc ) license632 ( http : //creativecommons.org/licenses/by/4.0/ ) .633 https : //matplotlib.org/api/_as_gen/matplotlib.pyplot.boxplot.html https : //matplotlib.org/api/_as_gen/matplotlib.pyplot.boxplot.html https : //matplotlib.org/api/_as_gen/matplotlib.pyplot.boxplot.html http : //creativecommons.org/licenses/by/4.0/ .
introduct justif method descript tangent space method transform map along tangent direct model forecast structur paramet estim result improv forecast due use tangent space comparison dct forecast method perform function latitud bias varianc decomposit forecast error histogram forecast error conclus refer
