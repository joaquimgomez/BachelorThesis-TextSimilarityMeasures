robust algorithm implicit descript immers geometri within background mesh baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 https : //doi.org/10.1186/s40323-018-0113-8 research art icl open access robust algorithm implicit descript immers geometri within background mesh daniel baumgrtner1* , johann wolf1 , riccardo rossi2 , pooyan dadvand2 roland wchner1 *correspond : daniel.baumgaertn @ tum.d 1technisch universitt mnchen , arcisstr .
21 , 80333 mnchen , germani full list author inform avail end articl abstract paper present robust algorithm , allow implicit describ track immers geometri within background mesh .
background mesh assum unstructur discret tetrahedron .
contain geometri assum given triangul surfac .
within background mesh , immers geometri describ implicit use discontinu distanc function base level-set approach .
distanc function allow consid ,  double-sid  geometri like membran shell structur ,  single-sid  object enclos volum univoc defin .
second case , discontinu distanc function complement continu sign distanc function , wherea ray cast appli identifi close volum region .
furthermor , adapt mesh refin employ provid necessari resolut background mesh .
propos algorithm handl arbitrarili complic geometri , possibl contain model error ( i.e. , gap , overlap non-uniqu orient surfac normal ) .
anoth import advantag algorithm embarrass parallel natur oper .
characterist allow straightforward parallel use mpi .
develop implement within open sourc framework  kratosmultiphys  avail bsd licens .
capabl implement demonstr various applic exampl involv practice-ori geometri .
result final show , algorithm abl describ complic geometri within background mesh , wherea approxim qualiti may direct control mesh refin .
keyword : immers boundari method , implicit geometri descript , embed geometri , boundari track , distanc function , level-set approach , local best-fit approxim , ray cast , adapt mesh refin introduct increas matur numer techniqu allow perform detail mechan simul take account geometr complex , possiblymov object , provid suitabl comput mesh avail throughout simul .
unfortun avail mesh becom bottleneck geometr complex increas .
consid , exampl , situat flow around object shall comput .
follow classic approach , correspond fluid domain  author ( ) 2018 .
articl distribut term creativ common attribut 4.0 intern licens ( http : //creativecommons.org/licenses/by/4.0/ ) , permit unrestrict use , distribut , reproduct medium , provid give appropri credit origin author ( ) sourc , provid link creativ common licens , indic chang made .
0123456789 ( ) . ,  : volv http : //crossmark.crossref.org/dialog/ ? doi=10.1186/s40323-018-0113-8 & domain=pdf http : //orcid.org/0000-0003-4832-8913 http : //creativecommons.org/licenses/by/4.0/ baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 2 40 would discret  body-fit  mesh , i.e. , mesh match boundari object .
requir local match boundari , howev , problemat object repres complic geometri , say complet race car , object contain mani fine detail , like hole screw .
case , proper resolut boundari requir lot manual model effort lead impract high mesh densiti .
correspond limit may easili understood tri qualiti open sourc mesh generat like [ 15 ] .
situat becom even wors move object need taken account , like problem fluid-structur interact .
case , requir main- tain body-fit mesh result heavi mesh updat procedur , eventu fail larg movement rotat involv .
furthermor , simul problem chang topolog ( like flow simul land gear aircraft deploy ) becom virtual imposs , sinc mesh graph chang .
 immers boundari method  appear possibl remedi problem .
general idea immers boundari method place model object interest direct given background mesh , identifi object  boundari relat background mesh , use background mesh along implicit descript immers boundari eventu perform mechan analysi .
advantag , body-fit mesh requir anymor give rise signific decreas model effort .
hand , oper caus intersect comput domain , i.e. , backgroundmesh , object  skin .
correspond , algorithm requir identifi intersect describ immers object implicit .
obvious , implicit geometr represent object strong depend grid size background mesh .
, coars mesh repres immers object accur body-fittedmesh geometr detail lost unless local refin performed.howev , properti necessarili bad , exploit run simul intent reduc level fidel , e.g .
done context multiresolut paradigm .
mani approach perform comput base immers boundari method develop year .
field cfd , review immers boundari meth- od given [ 6 ] .
extend formul consid fluid-structur interact present [ 7 ] .
recent develop focus finit element method describ [ 811 ] .
exampl context finit volum method given [ 12 ] .
field structur mechan , finit cell method ( fcm ) reli immers boundari formul [ 13,14 ] .
earlier proposit repres solid structur background mesh elabor detail [ 15 ] .
besid approach , most focus volumetr object , recent propos isogeometr b-rep analysi ( ibra ) use similar idea analyz thin-wal structur describ trim geometri cad .
ibra , geometri consid- erat , repres e.g .
membran shell , immers under nurbs- surfac patch actual geometri describ cut-out arbitrarili curv free-form shape [ 1618 ] .
differ work , focus current paper consider- ation immers boundari formul solut physic problem , develop robust algorithm allow implicit descript , track baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 3 40 reconstruct geometri immers within background mesh .
general , algorithm repres basi immers boundari method .
consid case unstructur tetrahedr mesh , intersect immers object given form triangul surfac .
immers geometri describ implicit use discontinu distanc function base level-set approach .
allow consid ,  double-sid  geometri , like sail , fluid flow side ,  single-sid  object , enclos volum univoc defin .
second case , discontinu distanc function complement continu sign distanc function .
case , identif  insid   outsid  region , associ respect posit negat distanc , done employ ray cast approach .
ray cast improv use cascad techniqu order enhanc robust deal  dirti  geometri .
furthermor , adapt mesh refin , base techniqu describ [ 19 ] , employ provid necessari intend resolut background mesh .
propos approach allow handl arbitrarili complic geometri , possibl contain model error ( gap , overlap non-uniqu orient surfac nor- mal ) .
import advantag altern embarrass parallel natur oper involv , allow straightforward parallel use mpi , provid copi object skin own mpi domain .
develop current work implement test within framework kratosmultiphys [ 20,21 ] avail bsd licens [ 22 ] .
despit focus implicit geometri descript paper , note , special attent requir propos approach , includ discontinu distanc function , employ solut physic problem .
detail discuss correspond implic far beyond scope paper , interest especi finit element context , situat case shall briefli comment follow .
use discontinu distanc function inevit impli finit element space conform across cut face .
consid non-conform , special strate- gie typic employ formul condit along immers bound- ari .
discuss strategi subject paper , one readili conclud formul non-trivi task , particular sinc difficult discret immers boundari integr purpos .
howev , worthwhil note , area non-conform tend zero smooth surfac infinit refin backgroundmesh .
context , author found , appli boundari con- dition base discontinu shape function without addit treatment non-conform may effect approach solut physic problem , even though variat crime commit .
e.g. , studi author flow solver uti- lize discontinu shape function describ [ 23 ] show result agreement publish data general cfd analysi .
, howev , mean general result differ strategi need devis altern solver formul employ .
paper organ follow :  implicit geometri represent mean level-set approach  section introduc main approach repres immers geome- tri within background mesh mean level-set approach .
necessari spatial search algorithm determin intersect element correspond intersect baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 4 40 point describ  octree-bas spatial search determin intersect  sec- tion .
use inform intersect element , actual represent immers geometri discontinu distanc function discuss  geometr represent immers object use discontinu distanc function  section .
section , also relat challeng systemat prepar specif solut approach elabor .
effici improv implicit geometri repre- sentat , local refin strategi present  refin strategi improv approxim qualiti  section .
 identif close region use continu- ous distanc function  section , addit continu distanc function introduc , requir inside-outsid distinct case enclos volum .
final ,  exampl immers geometri differ featur challeng  section , develop implement concept demonstr various applic exampl challeng respect immers geometri .
implicit geometri represent bymean level-set approach paper , consid case geometri describ triangul surfac immers unstructur tetrahedr background mesh .
object implicit describ immers geometri respect background mesh , wherea particular focus possibl handl arbitrarili complic geometri .
key idea leverag , tetrahedron background mesh intersect immers geometri plane ( case , e.g. , hexahedron ) .
furthermor , assum , case given tetrahedron intersect pattern exact form cut plane , may proper approxim , e.g. , best-fit techniqu .
given descript cut plane everi intersect tetrahedron , final possibl reconstruct approxim immers geometri .
describ cut plane henc immers geometri , call  level-set approach  , describ [ 24 ] , util .
latter provid implicit definit geometri zero isosurfac smooth function defin background mesh .
typic , function chosen sign distanc geometri interest , wherea sign defin negat one side geometri posit .
idea distanc function visual fig .
1 .
figur , distanc function associ node backgroundmesh closest sign distanc given immers geometri .
sign may chosen accord normal orient immers geometri .
immers geometri appear zero distanc isosurfac .
provid object consid enclos volum , definit sign distanc univoc .
case use continu distanc function well defin provid obvious advantag guarante implicit surfac descript continu across face intersect element .
, howev , mani case definit sign distanc univoc .
exampl , consid case fig .
2 , show two open geometri intersect background mesh ( one may think cut two sail within 2d fluid mesh ) .
node n1 belong time two label element ( e1 , e2 ) .
henc , assum orient baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 5 40 fig .
1 distanc function implicit describ immers geometri fig .
2 need discontinu distanc function deal arbitrari complic geometri due potenti non-uniqu definit sign distanc given geometri , must negat sign distanc consid part e2 posit sign distanc part e1 , obvious imposs .
order success captur except abl describ arbitrarili complic geometri , distanc function use , defin pure ele- mental basi .
, distanc comput individu element background mesh rather node .
element descript impli node may differ distanc valu consid part differ element .
concept element-wis comput distanc illustr fig .
3 .
custom give rise central characterist approach : approx- imat immers geometri turn pure local oper distanc function becom discontinu along immers boundari .
note , discontinu distanc function stronger represent properti compar continu one .
obvious , sinc continu distanc repres term element-wis discontinu distanc contrari obvious true .
matter fact , element-wis comput distanc allow approxim arbitrarili complic geometri within background mesh .
qualiti approxim therebi determin qualiti baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 6 40 fig .
3 element-wis comput distanc approxim cut plane within tetrahedron .
note also , pure local oper distanc comput independ element background mesh .
parallel approach henc straight-forward effect , benefici term comput effici .
also , seen later , inher discontinu aris represent immers geometri may consid neglig assum suffici refin background mesh .
given coars mesh , choic possibl refin strategi describ  refin strategi improv approxim qualiti  section .
special case deal close geometri immers background mesh , typic also requir determin node background mesh lie insid close region one outsid .
special case , continu distanc function well defin may readili use comput sign distanc negat distanc indic point insid posit sign point outsid close region .
therefor , case includ close immers geometri , continu distanc function reconstruct basi abovement discontinu one .
ray cast approach use assign result nodal distanc sign .
latter appear robust solut , detail  identif close region use continu distanc function  section .
summari , propos strategi implicit repres immers geometri insid background mesh follow : first , immers geometri describ element-wis distanc local approxim cut plane .
process correspond formul discontinu distanc function .
problem involv complic geometri , adapt mesh refin appli prior step .
, case immers geometri contain close bodi , discontinu distanc function com- plement continu one sign nodal distancesmay determin .
comput distanc function , immers geometri final describ implicit respect background mesh may readili reconstruct basi given distanc valu .
process summar fig .
4 .
follow chapter detail individu step overal process .
correspond chapter referenc figur .
octree-bas spatial search determin intersect describ immers geometri implicit respect given background mesh , determin whether element immers geometri intersect given element background mesh .
end , spatial search techniqu appli .
sinc spatial search typic expens , effici method context immers approach becom particular import .
baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 7 40 input : background tet-mesh & triangul surfac geometri ( e.g .
stl ) comput element distanc use discontinu distanc function refin background mesh nessecari ( 5 ) output : implicit geometri descript respect background mesh close geometri includ ?
comput sign nodal distanc use contin distanc function ( 6 ) determin sign nodal distanc use ray cast construct contin discontinu distanc function n tet intersect geometri ?
( 3 ) loop tet determin local cut plane ( 4 ) tet node comput distanc cut plane ( 4 ) n fig .
4 algorithm implicit geometri descript base combin discontinu continu distanc function ( section contain detail referenc bracket ) present work , necessari find intersect element immers geometri given element backgroundmesh .
thatmatt , valid assum background mesh model convex hull immers geometri nb > ng , nb ng number background geometri element , respect .
straightforward algorithm , identifi intersect , everi geometri element may check element background mesh correspond algorithm complex ( nb  ng ) .
high refin background mesh quick lead explos comput cost .
call advanc spatial search techniqu .
luckili , spatial search type repres classic problem comput scienc various approach avail [ 25 ] .
idea behind mani approach divid domain subdomain order object search base divis .
regular divis domain therebi lead bin search structur [ 2628 ] , wherea hierarch divis lead tree search structur [ 2931 ] .
bin structur best option homogen distribut object .
contrast , hierarch structur suitabl distribut high concentr object irregular shape , respect .
baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 8 40 fig .
5 distribut leaf cell result quadtre data structur generat around circular geometri use eight consecut level refin sinc present case object search irregular domain , i.e. , given element background mesh necessari search intersect element immers geometri , wherea immers geometri arbitrarili shape henc repres irregular domain , spatial search base octre appear best solut .
method , block-shap bound box around immers geometri divid eight equal cell , cell partit anoth eight cell case element immers geometri contain .
process perform sever time desir level refin .
final distribut cell refer leaf cell .
result , domain geometri repres tree-lik data structur , i.e. , octre 3d quadtre 2d .
exampl distribut leaf cell result quadtre data structur given fig .
5 .
mani partit techniqu type [ 31 ] .
work mid-point partit base work [ 32 ] employ basic data structur .
identifi suitabl data structur , follow general procedur propos perform spatial search : first , basic octre data structur repres immers geometri creat .
, everi element background mesh assign point- er correspond leaf cell intersect .
base link inform domain , intersect test immers geometri background mesh eas signific .
instead check everi element backgroundmesh element immers geometri , one check given background element small subset geometri element potenti intersec- tion .
reduc complex intersect test originallyo ( nb  ng ) order ofo ( nb  log ( ng ) ) .
result algorithm determin intersect point background mesh immers geometri use spatial search describ visual fig .
6 .
shown figur , correspond algorithm contain three main step : baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 9 40 input : background tet-mesh & triangul surfac geometri search subset leaf cell inersect tet generat bound box around tet cell intersect tet ( box-tet intersect ) ?
generat octre base immers geometri output : intersect brackground mesh & immers geometri loop tet element background mesh determin intersect tet & geometri subset leaf cell determin leaf cell intersect bound box ( box-box intersect ) loop intersect leaf cell add cell contain n loop tet edg check intersect triangl & tet edg ( triangle-lin int . )
loop leaf cell contain loop triangl leaf cell fig .
6 algorithm base octre data structur determin intersect point background mesh immers geometri first , octre repres immers geometri creat loop element background mesh initi .
, within loop , second main step determin octre leaf cell inter- sect given element background mesh ( assum tetrahedron ) .
set cell effici determin combin rough intersect test subsequentmor accur one .
rough test , bound box construct around given tetrahedron check leaf cell octre box intersect .
reduc cost box-tetrahedron intersect test simpl boxbox algorithm [ 33 ] .
intersect found , accu- rate test follow check actual box-tetrahedron intersect .
accur test done use algorithm describ [ 34 ] .
result second main step , set baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 10 40 fig .
7 approxim immers geometri within intersect element background mesh fig .
8 sign nodal distanc valu defin cut plane intersect element zero isosurfac .
cut plane local approxim immers geometri ( blue area ) leaf cell contain ( triangular ) geometri element possibl intersect obtain .
set store contain associ given background element .
given contain element background mesh , one last main step identifi actual intersect point .
detect intersect point tetrahedron triangl geometr complex problem , step divid loop sever basic test .
basic test , intersect point deter- mine subsequ test tetrahedron edg given triangl , involv basic comput intersect point ray triangl .
perform last main step element backgroundmesh loop , intersect point immers geometri final determin .
geometr represent immers object use discontinu distanc function  implicit geometri represent mean level-set approach  section gen- eral approach implicit repres immers object within background mesh introduc .
context , tetrahedr background mesh triangul immers geometri assum .
correspond algorithm summar fig .
4 .
chapter discuss detail comput element distanc within algorithm .
also present way visual correspond approxim immers geometri .
visual basi discuss approxim qualiti .
comput element distanc sinc tetrahedr background mesh assum , best possibl represent geometr detail within singl background element plane .
therefor , present baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 11 40 work , arbitrari boundari immers object repres collect pla- nar cut plane , wherea intersect element background mesh exact one defin plane .
principl conceptu illustr fig .
7 .
conse- quenc local reduct immers geometri cut plane , approxi- mation qualiti strict limit densiti background mesh .
accord previous introduc discontinu level-set approach , cut plane separ defin intersect element zero isosurfac eman sign distanc valu associ node .
obtain correspond zero isosurfac , three basic step perform : 1 .
determin intersect point background mesh immers geome- tri , 2 .
determin specif cut plane intersect background element base local intersect pattern , 3 .
comput node intersect element sign distanc cut plane .
first step previous enumer done use algorithm present fig .
6 .
determin cut plane discuss section .
assum cut plane alreadi determin henc avail , set four sign nodal distanc may final comput follow : di = n n  ( ni  p ) .
( 1 ) , nodal distanc valu element background mesh , di , com- pute nodal coordin ni , normal vector n repres orient cut plane , correspond base pointp plane given one inter- section point .
concept visual fig .
8 .
note , propos approach set four sign nodal distanc valu comput pure local oper .
henc , background element set nodal distanc .
therefor , follow , set distanc refer element distanc .
element distanc final defin discontinu ( element-wis ) distanc function .
defin discon- tinuous distanc function , approxim immers structur appear zero isosurfac within background mesh .
visual approxim immers geometri toevaluatewheth propos algorithmcan repres immers object proper , necessari visual geometr approxim eman implicit descrip- tion distanc function .
visual provid import insight immers object  seen  backgroundmesh .
obtain visual , triangular mesh recreat given distanc valu post-process routin .
precis , within loop intersect background element , intersect point given element recomput four sign distanc valu .
, intersect point use form triangl depend number intersect point .
exact three point , triangl direct defin .
case background element one two intersect point , triangl creat .
background element henc ignor reconstruct .
element inter- baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 12 40 sect four point , correspond quadrilater area recreat two neighbor triangl similar orient .
triangl final collect contain andmay visual common surfac mesh .
procedur conceptu visual fig .
9a .
figur , two distanc valu di dj comput everi edg tetrahedron separ .
valu describ distanc two correspond edg nodesni andnj immers boundari .
product distanc valu posit , correspond element intersect immers geometri .
case product negat , howev , mean tetrahedron intersect edg correspond intersect point p comput linear interpol : p = |dj||di| + |dj|  ni + |di| |di| + |dj|  nj .
( 2 ) given exampl , distanc valu indic tetrahedron intersect , wherea linear interpol result one element four intersect point one three intersect point .
correspond , three triangl reconstruct .
three triangl eventu repres local reconstruct immers bound- ari seen two tetrahedron ( background mesh ) .
complic exampl given fig .
9b , implicit represent immers cylind visual .
import realiz result triangular surfac mesh ( a ) differ origin immers surfac mesh ( i given stl ) serv visual purpos .
thus , suppos bad qualiti reconstruct surfac mesh ( see blue mesh fig .
9b ) result chosen visual techniqu implic .
import rememb follow-up section , result surfac approxim shown featur line better distinct individu geometr aspect .
determin cut plane differ intersect pattern explain  comput element distanc  section , order implicit describ immers object , boundari approxim collect planar cut plane defin intersect element background mesh .
therefor , cut plane determin depend local intersect pattern .
deter- mine pattern challeng oper sinc differ geometriesmay local result intersect pattern .
, uniqu definit cut plane possibl .
thus , numer special case consid order obtain robust algorithm .
determin cut plane import scenario dis- cuss section .
scenario correspond intersect pattern conceptu visual tabl 1 .
note , scenario visual 2d readili transfer three-dimension case .
approxim planar surfac planar face intersect background element , two differ intersect pattern consid , i.e. , one pattern three anoth one four intersect point ( see fig .
10 ) .
case intersect point lie common plane given cut plane accur defin immersedboundary.th correspond baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 13 40 b fig .
9 visual geometri approxim result implicit descript immers object discontinu distanc function .
concept : visual surfac reconstruct .
b exampl : approxim immers cylind cut plane defin use three possibl four given intersect point togeth surfac normal vector immers boundari .
evalu correspond approxim qualiti , algorithm test case simpl triangul plate immers box-shap background mesh around 19,000 element , see fig .
11a .
test process follow : first , element distanc comput describ  comput element distanc  section , wherea immers planar surfac treat introduc .
, herebi approxim surfac reconstruct visual follow approach introduc  visual approxim immers geometri  section .
result approx- imat immers structur present fig .
11b .
seen figur , rectangl well describ appli method except region around edg .
issu trace back fact background element edg intersect complet therefor approxim immers boundari area possibl ( compar last scenario tabl 1 ) .
howev , point earlier , approxim error inher immersedapproachanddu limitedmesh resolut .
canbewel reducedbi refin strategi discuss  refin strategi improv approxim qualiti  section .
baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 14 40 tabl 1 scenario immers geometri lead differ intersect patternsth geometr complex increas top bottom tabl scenario visual possibl approxim planar intersect case immers boundari planar within intersect ele- ment , cut plane determin exact repres boundari slight curvatur case orient immers boundari slight chang- ing , exact represent boundari possibl any- cut plane easili determin minim approxim error sharp edg sharp edg locat within element describ singl cut plane .
best approxim cut plane chamfer edg sever boundari sinc element per definit one cut plane , possibl approxim case sever boundari intersect- ing , plane replac boundari singl one follow fit criterion incomplet intersect case , local approxim immers boundari use four sign distanc valu imposs .
henc case must ignor .
note , howev , correspond approxim error inher immers approach due limit mesh resolut .
well reduc refin strategi fig .
10 relev intersect pattern immers plane face .
three intersect point .
b four intersect point approxim curv surfac oppos planar geometri , curv surfac general approxim exact singl cuttingplan sinc thenorm vector immersedboundari chang direct within intersect element .
therefor , decis bemad term normal vector base point order describ plane best approxim immers boundari .
end three differ case consid : case : three intersect point case conceptu visual fig .
12 .
sake clariti compar follow solut , actual three dimension situat reduc correspond two-dimension case without loss general .
baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 15 40 fig .
11 test case evalu surfac approxim immers planar geometri .
test setup : plate immers box-shap background mesh  19,000 element .
b reconstruct immers boundari ( a ) fig .
12 concept approxim slight curv immers boundari within background element given intersect pattern three intersect point ( p1 , p2 , p3 ) , good approx- imat immers boundari easili obtain triangl form intersect point .
therefor , cut plane defin triangl , wherea one intersect point chosen base point plane normal vector deriv cross product two edg : n = p1p2  p1p3 .
( 3 ) case : four intersect point case four intersect node , point general locat common plane anymor .
case , best-fit approach chosen comput cut plane minim distanc intersect point .
formul correspond optim problem , first recal equat defin four nodal distanc di correspond background element : d1 = n n  ( pa  p1 ) , ( 4a ) d2 = n n  ( pa  p2 ) , ( 4b ) d3 = n n  ( pa  p3 ) , ( 4c ) d4 = n n  ( pa  p4 ) .
( 4d ) baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 16 40 , n defin unknown normal approxim plane .
pa defin base point plane pi repres posit  th intersect point .
equat rewritten matrix form follow : = nnp , ( 5 ) wherea matrix p collect distanc vector intersect point base point plane : p =   pa  p1 pa  p2 pa  p3 pa  p4   .
( 6 ) find optim compromis cut plane , least squar approxim appli , unknown normal vector well unknown base point chosen nodal distanc minim : minim n , pa f : f = d2 = 1n2  n ptp n. ( 7 ) last equat thematrix productptp summar amatrixa .
reduc problem , base point predefin averag point given intersect point : pa = 1 4 4 i=1 pi , .
( 8 ) furthermor , unit surfac normal requir , : ntn = 1 .
( 9 ) final formul least-squar problem read : minim n ntan subject ntn  1 = 0 .
( 10 ) correspond constrain quadrat optim problem .
solv three unknown compon normal vector n = { nx , ny , nz } , lagrang function l formul use lagrangian multipli  : l ( n ,  ) = ntan +  ( ntn  1 ) .
( 11 ) stationari point l obtain base follow necessari condit : l n = + n = 0 ( 12a ) l  = ntn  1 = 0 .
( 12b ) baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 17 40 fig .
13 special intersect pattern curv geometri edg background mesh intersect twice .
3d exampl .
b close-up exampl first eq .
( 12a ) , rearrang follow eigenvalu problem obtain : = n .
( 13 ) ,  denot eigenvalu thematrixa andn correspond eigenvector.with knowledg mind , eq .
( 13 ) multipli nt , result : ntan =  .
( 14 ) left hand side equat character object function f [ refer eq .
( 7 ) ] , one deduc ( 14 ) object valu minim n correspond eigenvector symmetr matrix smallest eigenvalu .
henc normal best fit cut plane four intersect point chosen eigen- vector .
correspond eigenvalu problem solv use iter gauss-seidel method .
case : double-intersect edgesanoth special intersectionpatternwhichha tobe consid- ere immers geometri curv surfac , case double-intersect edg .
intersect pattern shown fig .
13 .
figur , curv geometri ( blue ) immers non-vis backgroundmesh intersect select tetrahedron background mesh ( green ) six point , wherea top edg tetrahedron intersect twice .
situat conceptu sketch fig .
14a .
sketch seen , approxim immers boundari base ona set four signeddist valu onlyposs left element.th right element enough intersect point defin proper cut plane .
therefor , part geometri immers right element must neglect .
also left element problemat sinc double-intersect edg allow uniqu definit cut plane .
solut problem , immers boundari approxim plane minim distanc intersect point .
strategi alreadi appli case four intersect point .
number intersect point increas time .
correspond cut plane baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 18 40 b fig .
14 approxim strategi immers geometri slight curv lead double-intersect edg .
conceptu illustr problem .
b conceptu illustr solut strategi defin base point pa , averag n intersect point : pa = 1 n n i=1 pi , ( 15 ) surfac normal n , correspond eigenvector associ smallest eigenvalu follow matrix : = ptp =   pa  p1 ... pa  pn     pa  p1 ... pa  pn   .
( 16 ) solut strategi determin cut plane immers geometri slight curv lead double-intersect edg conceptu illustr fig .
14b .
present strategi approxim cut plane case curv geometri immers backgroundmesh , result approxim qualiti shall inves- tigat follow .
test exampl sphere posit box-shap background mesh .
background mesh correspond one alreadi use pla- nar test case shown fig .
11a .
construct , sphere intersect background mesh case appear ( i.e. , background element three four intersect point , element double-intersect edg ) .
test process follow : first element distanc comput describ  comput element distanc  section , wherea curv surfac treat introduc .
, herebi approxim surfac reconstruct visual- ize follow approach introduc  visual approxim immers geometri  section .
result approxim immers sphere present fig .
15a , b two differ resolut background mesh .
qualit observ figur , spheric geometri well captur algorithm visibl defect along reconstruct surfac .
fur- thermor , curvatur may adequ resolv depend refin backgroundmesh .
worthwhil note , one introduc special case consid , approxim sphere would visibl defect due baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 19 40 fig .
15 surfac approxim sphere immers background mesh .
reconstruct immers boundari ( a ) given coars background mesh .
b reconstruct a given fine background mesh .
c reconstruct a without consid double-intersect edg b fig .
16 conceptu illustr intersect pattern sharp edg insid singl background element .
case : intersect point uniqu defin plane .
b case : approxim plane requir fit local unsuccess approxim cut plane ( see fig .
15c ) .
pre- vious result , one conclud , present algorithm abl handl immers geometri slight curvatur .
approxim surfac sharp edg descript sharp edg within singl background element general pos- sibl sinc present approach one cut plane defin per element .
howev , situat appear frequent unless immers geometri complet smooth .
henc proper approxim sharp edg found .
find approxim , two differ intersect pattern shall distinguish .
pattern conceptu illustr fig .
16 .
main differ pattern number intersect point .
wherea fig .
16a background element exact mani intersect point necessari uniqu defin approxim cut plane ( i.e. , three three- dimension case ) , scenario fig .
16b exhibit intersect point neces- sari , singl cut plane defin fit procedur .
handl situat , follow procedur propos : first case , one defin cut plane direct base given intersect point choos normal direct unit vector averag normal connect surfac .
result chamfer represent edg .
second case similar case curv geometri intersect element four point .
correspond , best-fit procedur , baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 20 40 b fig .
17 strategi approxim sharp edg within singl background element .
case : intersect point uniqu defin plane .
b case : approxim plane requir fit fig .
18 surfac approxim cube immers coars background mesh demonstr implicit descript sharp edg ( featur line hidden ) alreadi describ  approxim curv surfac  section , follow case .
two solut strategi conceptu illustr fig .
17 .
present strategi approxim sharp edg within singl background ele- ment , result approxim qualiti shall investig follow .
test exampl cube posit box-shap background mesh .
background mesh correspond one alreadi use planar test case shown fig .
11a .
test process follow : first element distanc comput describ  comput element distanc  section , wherea sharp edg planar sur- face treat introduc  approxim planar surfac  section .
, herebi approxim surfac reconstruct visual follow approach introduc  visual approxim immers geometri section  .
result approxim immers cube present fig .
18 .
shown figur , cube well approxim along planar area .
howev , expect approxim strategi , also irregular chamfer edg observ .
inde rough represent actual geometri , still best possibl context present level-set approach .
luckili , howev , correspond approxim error may effect reduc mean mesh refin , shown  refin strategi improv approxim qualiti  section .
baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 21 40 b fig .
19 improp / misalign approxim cut plane case sever boundari intersect singl background element .
sever boundari intersect singl element .
bwrong approxim cut plane follow best-fit approach approxim case sever boundari intersect sinc specif background element per definit one cut plane , possibl approxim , case sever intersect boundari , plane .
plane replac boundari singl one determin follow fit criterion .
, must accept inform singl boundari lost .
loss inform , howev , necessarili bad characterist .
matter fact , allow proper describ immers geometri even bad model contain overlap duplic geometri .
precis , sever boundari within one intersect background element replac singl one , overlap dupli- cate geometri simpli  overseen  therefor caus problem .
i.e. , robust treatment  dirti geometri  inher properti pre- sent approach .
specif strategi approxim sever immers boundari one cut plane describ follow : consid conceptu illustr problem fig .
19a .
figur visual case two distinct immers boundari travers element backgroundmesh .
correspond intersect pattern character fact three intersect point double-intersect edg .
therefor , obvious way approxim immers boundari cut plane would best-fit approach , much like alreadi propos previous section similar intersect pattern .
howev , one actual approxim immers boundari singl plane determin best-fit procedur , possibl obtain approxim geometri depict fig .
19b .
seen figur , best-fit approachmay result approxim cut plane inde  optim  place intersect point , orient clear wrong .
instead , one would expect cut plane align two opposit surfac .
therefor , order obtain proper align approxim case background element intersect two immers boundari , advis follow best fit approach .
instead , recommend , base point surfac normal cut plane determin averag approach .
averag approach , base point cut plane defin averag intersect point , see eq .
( 15 ) .
surfac normal comput mean vector surfac normal intersect point background element consider : baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 22 40 fig .
20 approxim proper align cut plane case multipl boundari cross singl background element b fig .
21 problemat intersect pattern approxim wing background mesh .
awe model .
b element sever immers boundari sharp edg wing n = 1 m i=1 ni , ( 17 ) avoid cancel case individu surfac normal point opposit direct , mean enclos angl exceed 90 , vector first align first sum .
i.e. , iff ni  n1 < 0 , ni = ni .
final approach illustr fig .
20 .
alreadyment , solut approxim sever immers boundari singl cut plane advantag immers object containmodel error .
howev , also play import role case thin taper structur immers background mesh .
exampl , consid wing shown fig .
21a .
put wing arbitrari tetrahedr background mesh , like lot element around sharp edg , intersect sever immers boundari ( see fig .
21b ) .
therefor , proper treatment case decis overal approxim qualiti .
achiev approxim qualiti present wing discuss  refin strategi improv approxim qualiti  section context mesh refin .
summar strategi determin local cut plane previous subsect describ determin local cut plane case planar geometri , curv geometri geometri sharp edg bound- ari intersect background element twice .
case , base point normal vector correspond cut plane defin either direct intersec- tion point follow averag , respect best-fit procedur .
approach baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 23 40 fig .
22 strategi determin cut plane given intersect background element .
determin requir base pointpa normal vector n.pi denot intersect point chosen individu case , depend number intersect point well local intersect pattern .
figur 22 summar propos overal strategi determin cut plane given intersect background element .
refin strategi improv approxim qualiti context immers method , size element background mesh general defin length scale towhich geometr detail immersedobject canb resolv .
consequ everi detail smaller length scale simpli neglect .
approxim qualiti henc direct depend resolut background mesh , necessari , may control mean refin strategi .
note depend approxim qualiti resolut background mesh may actual seen benefici characterist sinc inher allow handl flaw descript immers geometri ( like gap , overlap , etc . )
allow exploit multiresolut analysi case complex investig scenario .
case approxim qualiti must improv , adapt mesh refin two step propos : first , loop element background mesh , ele- ment satisfi specifi refin criterion tag .
, second loop element , tag element refin use algorithm describ [ 19 ] .
refin criterion , local approxim qualiti util , i.e. , element shall tag , caus problem approxim immers geometri .
within paper , three problemat case consid .
conceptu summar fig .
23 .
first problemat case identifi element background mesh intersect immers geometri , contain edg cut twice ( see fig .
23a ) .
order proper approxim immers geometri case , correspond element refin two opposit surfac fall differ element background mesh .
second indic problemat case possibl chang surfac normal immers object within singl background element ( see fig .
23b ) .
object baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 24 40 b c fig .
23 problemat case tag refin .
double-intersect edg .
b high chang curvatur .
c element cut plane slight curv even planar , chang normal vector small , i.e. , refin necessari .
curvatur larg object chang direct within element , element need refin .
therefor , case normal orient immers geometri chang within singl background element , everi pair surfac normal intersect point , n1 n2 , compar .
correspond angular chang exceed adjust limit  , element also tag refin .
third last indic , consid case background element slight touch immers object cut plane approxim ( e.g. , one edg element cut , see fig .
23c ) .
point earlier  geometri- cal represent immers object use discontinu distanc function  section , elementswhereno cut plane canb approxim simpli ignored.a thiswil obvi- ousli introduc error approxim immers geometri , refin shall trigger .
note , unlik previous two case , refin case complet cure problem alway one element edg immers geometri .
refin , problemmay reduc neglig influenc .
final adapt mesh refin algorithm pseudocod read follow : //1 tag problemat element refin element backgroundmesh determinecuttingpattern ( ) ncut_edg < 3 ndouble_intersected_edg > 0  ( n1 , n2 ) >  : tagel ( ) end end // 2 .
refin tag element element backgroundmesh element.istag ( ) : refineel ( ) end end test propos algorithm , wing geometri fig .
21 place initi background mesh coars discret includ 4.0e5 element .
 coars  dis- cretize present context mean , size element background baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 25 40 fig .
24 model setup test propos refin strategi regard possibl improv approxim immers object .
overal model setup wing place background mesh .
b section view background mesh around wing size comparison mesh larg compar characterist dimens immers object .
size comparison , refer fig .
24 , show overal setup well section view around wing .
result approxim wing without refin background mesh follow procedur discuss  geometr represent immers object use discontinu distanc function  section present fig .
25a .
seen , without refin , surfac wing quit porous lead trail edg well approxim .
howev , alreadi appli one refin iter (  = 30 ) , result improv signific , shown fig .
25b .
refin background mesh final result continu better resolv geometri , see fig .
25c , d.after five level refin alreadi good surfac qualiti obtain .
regard backgroundmesh , number element hard increas first three level refin .
addit element introduc around critic area , i.e. , most along edg region low geometri reso- lution .
quick fix larg surfac repair compar slower edg .
one want resolv geometr detail , sharp edg , level refin necessari .
present case lead 2.2e6 element five repetit propos refin strategi .
amatt fact , abl resolv sharp edg import characterist propos approach .
becom particular relev case edg play domi- nant role ( e.g. , immers cfd analysi bluff bodi ) .
highlight featur , fig .
26 show surfac approxim simpl cube immers refin background mesh contain 2.3e6 element .
setup correspond test case sharp edg introduc  approxim surfac sharp edg  section .
result surfac approxim non-refin background mesh present fig .
18 .
contrast , fig .
26b show result surfac approxim six time refin background mesh .
compar figur , seen , without refin , edg approxim cube signific chamfer .
mean mesh refin , how- ever , edg well captur good overal approxim qualiti obtain .
baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 26 40 fig .
25 approxim immers wing geometri within background mesh differ level refin .
refin ( 4.0e5 element ) .
b 1 level refin ( 4.4e5 element ) .
c 3 level refin ( 6.2e5 element ) .
5 level refin ( 2.2e6 element ) fig .
26 approxim cube immers refin background mesh .
section view refin background mesh immers cube ( node entir background mesh highlight ) .
b result surfac approxim within refin background mesh note , critic region background mesh , i.e. , most around cube edg , refin .
region affect approxim qualiti remain unchang .
figur 26a visual adapt refin highlight node background mesh .
seen figur , origin regular distribut node interrupt accumul node most around edg .
accumu- baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 27 40 102 103 104 105 106 107 number background element 10-4 10-3 10-2 10-1 er ro r adapt refin 102 103 104 105 106 107 number background element 10-4 10-3 10-2 10-1 uniform refin 102 103 104 105 106 107 number background element 10-4 10-3 10-2 10-1 er ro r uniform refin fig .
27 quantit studi approxim error sphere immers continu refin background mesh ( dot indic six level refin follow two differ strategi ) lation around edg due addit element , introduc background mesh refin .
previous focus onqualit aspect , quantit evalu geometr approxim qualiti present follow .
precis defin test case , sphere radius r = 0.4 posit box-shap background mesh , refin sever time , uniform everi intersect adapt use present algorithm  = 1 ( i.e. , surfac normal immers geometri within singl intersect background element chang one degre , correspond element refin ) .
everymesh , follow errormeasur evalu :  = ||r  ri||max ( 18 ) equat , ri repres approxim radius i-th node approxi- mate sphere , ||  ||max maximum norm .
figur 27 summar result studi .
figur seen , refin strategi ( adapt uni- form ) error continu reduceswith increas level refin .
lowest valu therebi order 1e4 , mean approxim radius deviat analyt one 0.025 % .
differ case number element introduc obtain accuraci .
best accuraci uniform refin obtain 1e6 element , wherea adapt refin yield even better approxim around one third element .
note , element refin show one three problemat intersect case mention .
first four level refin mesh coars compar sphere dimens , basic element consid problemat .
consequ , result uniform adapt refin similar .
howev , fourth refin iter less less problemat background element , adapt refin quick pay .
note also , refin non-problemat element , might baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 28 40 local result problemat element , explain sudden error increas last iter uniform strategi .
previous result section , conclud , propos com- binat adapt mesh refin implicit geometri descript result high qualiti surfac approxim amanag number element background mesh .
identif close region use continu distanc function special case close geometri shall describ implicit within given background mesh , algorithm present follow , allow distinguish region insid close domain region outsid .
approach reli continu distanc function formul base discontinu distanc function present  geometr represent immers object use discon- tinuous distanc function  section .
continu distanc function construct assign node backgroundmesh uniqu negat distanc valu lie insid immers geometri , uniqu posit distanc valu els .
propos algorithm consist follow three basic step : 1 .
calcul element distanc : calcul intersect element separ nodal distanc follow introduc discontinu distanc calcul .
2 .
determin absolut nodal distanc : determin node background mesh uniqu distanc valu find smallest distanc valu associ node intersect neighbor element .
3 .
determin sign : determin node lie insid outsid close region use special tailor ray cast algorithm .
first step recal techniqu introduc  geometr represent immers object use discontinu distanc function  section second step correspond straightforward oper .
thus , follow , focus last step .
last step , determin whether given node lie insid outsid close geometri .
oper known literatur point-in-polygon ( pip ) problem [ 3537 ] .
sever algorithm solv pip problem .
mani reli watertight boundari proper orient surfac normal .
howev , case complic geometri model practic , none two characterist guarante .
correspond , approach propos follow , util inform .
instead , algorithmbas ray cast elaborated.not , common altern ray cast would approach base voxel , see e.g .
[ 38,39 ] .
howev , algorithm strong depend voxel size non-clean geometri , altern avoid .
basic ray cast ray cast algorithm first develop arthur appel render purpos 1968 [ 40 ] .
sinc general various differ applic analysi intersect point ray given 3d object geometri interest .
common use techniqu solv pip problem .
among sever baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 29 40 fig .
28 concept ray cast identifi insid outsid close geometri : start outsid determin status given node follow status ray , chang intersect boundari existingmethod , classic approach ray intersectionmethod [ 35 ] .
thismethod , random ray emit point interest result number intersect ray surfac contour given 3d object count .
number even , point outsid 3d object .
odd , point consid insid .
slight modifi version method use within current work solv problem assign sign nodal distanc valu .
modif main introduc increas algorithm  robust case defici (  dirti  ) geometri .
one modif follow : instead start point interest , ray alway shot point outsid domain node interest within background mesh , point outsid .
, ray align cartesian direct .
latter improv effici intersect search fact start end outsid may later use purpos ray valid .
given ray , intersect immers geometri ray determin , wherea direct ray , everi intersect caus chang status ( insid outsid immers geometri ) .
, start point outsid , first intersect indic ray enter insid immers geometri .
anoth intersect indic ray outsid , forth .
posit actual node interest determin current status cross ray .
final , posit sign assign node  distanc valu ray indic region outsid negat valu els .
2d exampl approach illustr fig .
28 .
modif ray cast algorithm discuss follow section .
improv non-watertight geometri ray cast techniqu determinist behavior clean geometri one ray enough univoc determin whether node insid outsid .
howev , non-watertight geometri aremani possibl basic techniqu fail .
consid non-watertight geometri gap overlap depict fig .
29 , failur case : 1 .
ray pass exact gap ( see fig .
30a ) .
case ray make intersect boundari continu still outsid geometri .
baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 30 40 fig .
29 non-watertight geometri gap overlap fig .
30 error model geometri , lead erron color ( wrong identif insid / outsid status ) .
situat gap .
b situat overlap 2 .
ray pass overlap part ( see fig .
30b ) .
situat , ray would detect two intersect point enter geometri lead wrong conclus second intersect outsid .
deal problem , propos use sever ray specif node interest , i.e. , one ray everi coordin direct , decid node posit vote .
concept adopt approach simplifi repair polygon model [ 41 ] .
three-dimension case exampl , one ray pass gap overlap region , two ray would vote correct result .
henc node  posit determin correct .
figur 31 conceptu illustr approach two-dimension case two ray .
experi author , simpl idea work well practic handl major model error cost increas ray cast time .
howev , latter neglig compar rest algorithm present paper .
propos mechan vote work well practic , still lit- tle possibl two even ray pass conflict area lead wrong conclus .
end sever improv includ : 1 .
ray valid : sinc ray construct start outsid also end , ray valid .
, ray end still color insid , clear invalid .
henc ray consid vote .
exampl baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 31 40 fig .
31 concept vote : two ray vote whether certain node insid outsid .
decis made base vote .
, one ray vote outsid insid .
note 3d , one ray , draw possibl fig .
32 improv increas robust ray cast algorithm .
exclus invalid ray vote .
b local ray cast exclus invalid ray prevent fals conclus respect node posit given fig .
32a .
2 .
collaps adjac hit : ray detect two intersect close ( com- parisonwith element size ) , collaps order better dealwith overlap .
3 .
local ray cast : invalid ray may result situat ray con- sider invalid two valid one give differ result .
case , local ray cast neighbor node known color ( inside/outsid status ) perform .
therefor , local ray sent neighbor one node color .
final color decid vote .
concept illustr fig .
32b .
remark , concept vote improv reduc theoret possibl failur zero .
practic , yield robust algorithm determin sign distanc valu respect insid outsid area .
case includ double-sid geometri one main advantag implicit geometri descript present cur- rent work deal double-sid geometri ( like exampl membran ) .
geometri repres volum boundari explicit defin close surfac .
object posit background mesh togeth close geometri , ray cast approach readili appli deter- baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 32 40 fig .
33 combin close ( solid line ) double-sid structur ( dash line ) : double-sid structur mark flag simpli ignor ray cast algorithm mine insid outsid area sinc ray also count hit double-sid object .
end , previous mark-up introduc .
, case , double-sid geometri close volum bodi immers background mesh , double-sid geometri flag prior ray cast .
hit flag geometri simpli neglect actual ray cast afterward .
henc insid outsid area may proper defin .
concept illustr fig .
33 .
exampl immers geometri differ featur challeng chapter , implicit descript geometri within background mesh use present strategi test sever geometri vari complex .
goal demonstr capabl applic conjunct complex 3d geometri .
therefor , three test case differ field applic consid .
first one sail model repres general case surfac geometri immers comput background mesh .
second case repres section model inflat hangar situat close volum geometri shall investig .
last test case compris complet race car henc combin aforement case complex problem , expect industri exampl .
test procedur follow : first , geometri consider place simpl block-shap domain mesh equal distribut tetrahedr element may obtain mesh softwar within short period time .
, complet algorithm , present paper outlin fig .
4 , appli implicit describ immers geometri respect given background mesh .
final , implicit descript geometri use reconstruct surfac approxim ( see  visual approxim immers geometri  section ) , last step compar origin model .
note , follow , visual background mesh omit avoid clutter .
surfac geometri follow , algorithm test surfac geometri immers regular block-shap comput mesh discret 800,000 tetrahedron .
geometri repres sail setup three membran differ size .
correspond model shown fig .
34 .
goal repres sail implicit within given baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 33 40 fig .
34 stl model sail repres within background mesh background mesh , wherea particular focus well curv surfac area free edg approxim .
appli present algorithm implicit describ sail within given back- groundmesh , surfac approxim present fig .
35a obtain .
latter one see , curv surfac region approxim well three differ sail clear form without unexpect approxim error .
free edg sharp corner , howev , strike defect resolv actual edg suffici .
matter fact , defect aris special inter- section patter geometri background mesh free edg consid problem mesh refin .
appli adapt refin introduc  refin strategi improv approxim qualiti  section , qualiti approxim signific improv point free edg accur captur , see fig .
35b .
worthwhil mention , test case includ point differ geometr entiti ( two sail ) touch g0- continu connect form .
seen fig .
35b , also area direct vicin connect point accur resolv , trace back advantag discret distanc function identifi immers boundari pure local oper .
close volum geometri section present algorithm test case close geometri immers regular block-shap comput mesh .
goal see first , whether implicit represent geometri also show close shape , second , whether correct distinguish insid outsid geometri .
end , model section inflat hangar chosen , see fig .
36a .
region difficult repres accur case bottom section , larg surfac local connect sharp edg curv .
baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 34 40 fig .
35 reconstruct surfac approxim sail immers block-shap background mesh .
without adapt refin background mesh ( 800,000 element ) .
bwith four level adapt refin ( ca .
4.5 mio .
element ) fig .
36 section inflat hangar model implicit represent background mesh .
stl model .
b reconstruct approxim geometri without refin background mesh ( 800,000 element ) .
c reconstruct approxim geometri adapt refin ( 9 mio .
element ) .
look insid approxim geometri baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 35 40 appli present algorithm implicit describ hangar section within background mesh initi 800,000 tetrahedron , surfac approxim present fig .
36b obtain .
even though tube surfac region clear form expect , strike defect around sharp edg ground .
similar previous section , most low resolut background mesh , yield difficult intersect pattern area rapid chang geometr characterist sharp edg .
defect resolv adapt refin background mesh , see fig .
36c .
moreov , refin lead proper captur hangar  close region , see fig .
36d .
apart pure approxim immers geometri , also insid out- side region identifi follow approach describ  identif close region use continu distanc function  section .
figur 37 show correspond result arbitrari cross-sect hangar .
figur may seen , node insid geometr boundari , node part pressur- ize volum , tag negat sign distanc , wherea other obtain posit sign .
sign allow clear distinct differ part computa- tional mesh .
correspond inform may exampl util immers cfd simul interior exterior flow need treat differ .
worthwhil mention , distinct perform without refer surfac normal geometri .
, problem relat misalign nor- mal , often occur practic applic , avoid .
previous result evid , combin discontinu continu distanc function , propos paper , util effect repres close geometri within background mesh .
combin arbitrarili complex geometri test , close double-sid geometri individu , present algo- rithm section appli large-scal exampl , includ case .
model consider repres complet race car contain rather sim- ple well complex geometr featur various length-scal rang large-span surfac area detail geometr object .
correspond geometri depict fig .
38 .
refer discret , block-shap tetrahedr mesh use , wherea time , initi discret intent chosen coars ( 40,000 element ) .
start coars discret , background mesh gradual refin , case correspond implicit surfac represent evalu .
sinc model consider contain lot detail , improp representa- tion expect initi coars discret .
fact observ look result approxim depict fig .
39a .
order abl captur geometri detail , signific refin refer mesh requir .
howev , avoid explos number element , utmost import concentr refin around spot actual necessari .
, e.g. , construct massiv refin element around plane slight curv surfac .
instead , concentr element around complex detail crucial .
key success power adapt refin strategi .
appli adapt refin propos success process , final possibl repres race car baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 36 40 fig .
37 sign nodal distanc cross-sect hangar ( posit sign indic node outsid tube negat sign node insid ) .
posit cross-sect .
b sign nodal distanc valu fig .
38 stl model race car repres complex geometri includ surfac volum area differ length-scal detail within background mesh , see fig .
39b , c. result number element ( 1.6  106 ) therebi remain accept rang .
particular interest see , hollow region air duct driver cabin well flat spoiler undertray part general detect resolv .
note , display featur line henc relat discret seen fig .
39 use comput consequ reconstruct race car base implicit geometri descript within background mesh ( refer  visual approxim immers geometri  section visual baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 37 40 fig .
39 surfac approxim race car differ refin background mesh .
refin ( 4.0e4 fluid element ) .
b 2 level refin ( 9.5e4 fluid element ) .
c 5 level refin ( 1.6e6 fluid element ) .
close-up last refin immers geometri ) .
result accumul featur line reconstruct element indic indirect region adapt refin actual refin background mesh .
know mean featur line , one conclud fig .
39c , spot race car complex geometri difficult intersect pattern ( spoiler , undertray , edg ) refin much wide surfac area planar part .
expect adapt refin strategi .
despit refin far , still local approxim error small scale , most around edg ( see close-up fig .
39d ) .
local approxim error still appear model contain small detail compar overal dimens , i.e. , resolut background mesh local still coars .
fact , error avoid complet , howev , refin background mesh , may reduc scale impact accept .
context , fig .
40 show best surfac approxim , obtain race car within present work .
conclus paper present robust algorithm implicit describ triangul geometri within tetrahedr background mesh .
algorithm base level-set approach combin discontinu continu distanc function .
, allow describ , double-sid close geometri within singl background mesh , without special requir discret .
given close geom- etri involv , ray cast approach suggest distinguish inner outer region .
allow treat individu region separ subsequ computa- baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 38 40 fig .
40 surfac approxim race car massiv refin background mesh ( 9e6 element ) .
iso-view .
b front-view tional oper .
improv respect robust basic ray cast introduc complex case may handl practic .
overal algorithm reli local definit cut plane .
context , import intersect pattern identifi solut approxim propos .
detect actual intersect , octree-bas search algorithm propos .
shown , local descript cut plane major case proper approxim immers boundari .
howev , case elabor , proper approxim immers boundari singl cut plane imposs due inher depend resolut back- ground mesh .
overcom problem increas general approxim qualiti , adapt mesh refin propos integr overal algo- rithm .
sever test exampl shown , systemat mesh refin may effect appli reduc remain approxim error accept level .
uniqu featur propos algorithm abil handl arbitrari shape , sever geometri within singl background mesh , common model error like gap , overlap duplic object .
flexibl robust consequ baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 39 40 discontinu distanc formul , local reduct cut pattern one cut plane , ray cast , formul depend surfac normal inform .
particular advantag algorithm therefor applic practic problem , even case present model error .
sever geometri includ complet race car demonstr discuss context .
summari , propos algorithm show solid basi whenev geometri describ implicit within background mesh .
typic applic would within scope immers cfd analysi object complex geometri .
, may circumv time-consum even imposs creation body-fit mesh cost reduc accuraci .
furthermor , worthwhil note , algorithmmay use describ geometri , also track geometr chang .
therefor , field applic conceiv , fluid-structur interact analysi ultra-lightweight structur shape optim involv big shapemodif .
aforement applic topic futur research .
abbrevi cfd : comput fluid dynam ; cad : computer-aid design ; mpi : messag pass interfac ; nurb : non-uniform ration b-spline ; stl : stereolithographi ; pip : point-in-polygon .
author  contribut author prepar manuscript .
author read approv final manuscript .
author detail 1technisch universitt mnchen , arcisstr .
21 , 80333 mnchen , germani , 2intern center numer method engin ( cimn ) , technic univers catalonia , campus nort upc , 08034 barcelona , spain .
acknowledg author grate acknowledg support european commiss project numexa ( fp7-ict 611636 ) ulit ( fp7-sme-2012 ga-314891 ) .
compet interest author declar compet interest .
avail data andmateri use softwar [ 22 ] freeli avail bsd licens .
consent public applic .
ethic approv consent particip applic .
fund applic .
publish  note springer natur remain neutral regard jurisdict claim publish map institut affili .
receiv : 22 januari 2018 accept : 4 juli 2018 refer 1 .
si h. tetgen , delaunay-bas qualiti tetrahedr mesh generat .
acm tran math softw .
2015 ; 41 ( 2 ) :1111136 .
https : //doi.org/10.1145/2629697 .
2 .
schberl j. netgen advanc front 2d/3d-mesh generat base abstract rule .
comput vis sci .
1997 ; 1 ( 1 ) :4152 .
https : //doi.org/10.1007/s007910050004 .
3 .
comput geometri algorithm librari .
2017. www.cgal.org .
access 28 dec 2017 .
4 .
openfoam v5 user guid : mesh generat snappyhexmesh .
2017. https : //cfd.direct/openfoam/user-guide/ snappyhexmesh/ .
access 28 dec 2017 .
5 .
coll .
advanc generat nonstructur mesh .
ph.d. thesi , upc barcelonatech 2014 .
6 .
mittal r , iaccarino g. immers boundari method .
annu rev fluid mech .
2005 ; 37:23961 .
7 .
peskin cs .
immers boundari method .
acta numer .
2002 ; 11:479517 .
https : //doi.org/10.1145/2629697 https : //doi.org/10.1007/s007910050004 www.cgal.org https : //cfd.direct/openfoam/user-guide/snappyhexmesh/ https : //cfd.direct/openfoam/user-guide/snappyhexmesh/ baumgrtner et al .
adv .
model .
simul .
eng .
sci .
( 2018 ) 5:21 page 40 40 8 .
kamenski , hsu mc , schilling , evan ja , aggarw , bazilev , sack ms , hugh tjr .
immersogeometr variat framework fluid-structur interact : applic bioprosthet heart valv .
comput method appl mech eng .
2015 ; 284:100553 .
9 .
codina r , baig j .
approxim imposit boundari condit immers boundari method .
int j numer method eng .
2009 ; 80 ( 11 ) :1379405 .
https : //doi.org/10.1002/nme.2662 .
10 .
hansbo p. nitsch  method interfac problem comput mechan .
gamm-mitteilungen .
2005 ; 28 ( 2 ) :183206 .
https : //doi.org/10.1002/gamm.201490018 .
11 .
burman e , claus , hansbo p , larson mg , mass a. cutfem : discret geometri partial differenti equat .
int j numer method eng .
2014 ; 104 ( 7 ) :472501 .
https : //doi.org/10.1002/nme.4823 .
12 .
kim j , kim , choi h. immersed-boundari finite-volum method simul flow complex geometri .
j comput phys .
2001 ; 171 ( 1 ) :13250 .
https : //doi.org/10.1006/jcph.2001.6778 .
13 .
parvizian j , dster , rank e. finit cell method .
comput mech .
2007 ; 41 ( 1 ) :12133 .
https : //doi.org/10.1007/ s00466-007-0173-i .
14 .
dster , parvizian j , yang z , rank e. finit cell method three-dimension problem solid mechan .
comput method appl mech eng .
2008 ; 197 ( 4548 ) :376882 .
https : //doi.org/10.1016/j.cma.2008.02.036 .
15 .
belytschko , parimi c , mos n , sukumar n , usui s. structur extend finit element method solid defin implicit surfac .
int j numer method eng .
2003 ; 56 ( 4 ) :60935 .
https : //doi.org/10.1002/nme.686 .
16 .
breitenberg , apostolato , philipp b , wchner r , bletzing ku .
analysi comput aid design : nonlinear isogeometr b-rep analysi shell structur .
comput method appl mech eng .
2015 ; 284:40157 .
https : //doi.org/ 10.1016/j.cma.2014.09.033 .
17 .
breitenberg m. cad-integr design analysi shell structur .
ph.d. thesi , technisch universitt mnchen 2016 .
18 .
philipp b , breitenberg ,  auria , wchner r , bletzing k-u .
integr design analysi structur membran use isogeometr b-rep analysi .
comput method appl mechan eng .
2016 ; 303:31240 .
19 .
rossi r , cotela j , lafontain nm , dadvand p , idelsohn sr .
parallel adapt mesh refin incompress flow problem .
comput fluid .
2013 ; 80:34255 .
20 .
dadvand p , rossi r , oat e. object-ori environ develop finit element code multi-disciplinari applic .
arch comput method eng .
2010 ; 17 ( 3 ) :25397 .
https : //doi.org/10.1007/ s11831-010-9045-2 .
21 .
dadvand p , rossi r , gil , martorel x , cotela j , juanper e , idelsohn sr , oat e. migrat generic multi-phys framework hpc environ .
comput fluid .
2013 ; 80 ( supplement c ) :3019 .
https : //doi.org/10.1016/j .
compfluid.2012.02.004 .
22 .
kratos-multiphys .
2018. https : //github.com/kratosmultiphys .
access 4 jan 2018 .
23 .
ausa r , sousa f , buscaglia g. improv finit element space discontinu pressur .
comput method appl mech eng .
2010 ; 199:101931 .
24 .
osher , fedkiw r. level set method dynam implicit surfac .
: appli mathemat scienc .
( springer-verlag new york inc. ) .
new york : springer ; 2003 .
25 .
ericson c. real-tim collis detect .
: morgan kaufmann seri interact 3d technolog .
san francisco : morgan kaufmann ; 2005. https : //doi.org/10.1016/b978-1-55860-732-3.50001-2 .
26 .
lhner r. empti bin : data structur spatial search time-vari data .
commun numer method eng .
2006 ; 23 ( 12 ) :11119 .
https : //doi.org/10.1002/cnm.959 .
27 .
munjiza , andrew krf .
nbs contact detect algorithm bodi similar size .
int j numer method eng .
1998 ; 43 ( 1 ) :13149 .
28 .
munjiza , rougier e , john nwm .
mr linear contact detect algorithm .
int j numer method eng .
2006 ; 66 ( 1 ) :4671 .
29 .
bentley jl .
multidimension binari search tree use associ search .
commun acm .
1975 ; 18 ( 9 ) :50917 .
https : //doi.org/10.1145/361002.361007 .
30 .
mehta dp , sahni , handbook data structur applic .
: chapman & hall/crc comput inform scienc seri .
new york : chapman & hall/crc ; 2004 .
31 .
samet h. foundat multidimension metric data structur .
san francisco : morgan kaufmann ; 2006 .
32 .
frisken sf , perri rn .
simpl effici travers method quadtre octre .
j graph tool .
2002 ; 7 ( 3 ) :111 .
https : //doi.org/10.1080/10867651.2002.10487560 .
33 .
teschner , heidelberg b , mller , pomeranet , gross m. optim spatial hash collis detect deform object .
: proceed vision , model , visual confer ( vmv ) , vol .
3 .
munich ; 2003. p. 4754 .
34 .
akenine-mlls t. fast 3d triangle-box overlap test .
j graph tool .
2001 ; 6 ( 1 ) :2933 .
https : //doi.org/10.1080/ 10867651.2001.10487535 .
35 .
nordbeck , rystedt b .
comput cartographi point-in-polygon program .
bit numer math .
1967 ; 7 ( 1 ) :3964 .
https : //doi.org/10.1007/bf01934125 .
36 .
huang c-w , shih t-i .
complex point-in-polygon algorithm .
comput geosci .
1997 ; 23 ( 1 ) :10918 .
37 .
schirra , reliabl practic point-in-polygon strategi ?
: proceed 16th annual european symposium algorithm , berlin , heidelberg : springer ; 2008. p. 744755 .
38 .
ishida , takahashi , nakahashi k. effici robust cartesian mesh generat building-cub method .
j comput sci technol .
2008 ; 2:43546 .
https : //doi.org/10.1299/jcst.2.435 .
39 .
huang j , yagel r , filippov v , kurzion .
accur method voxel polygon mesh .
: ieee symposium volum visual .
pp .
119126 ( 1998 ) .
https : //doi.org/10.1109/svv.1998.729593 .
40 .
appel .
techniqu shade machin render solid .
: proceed spring joint comput confer , new york : acm , april 30may 2 1968. p. 3745 .
https : //doi.org/10.1145/1468075.1468082 .
41 .
nooruddin fs , turk g. simplif repair polygon model use volumetr techniqu .
ieee tran visual comput graph .
2003 ; 9 ( 2 ) :191205 .
https : //doi.org/10.1109/tvcg.2003.1196006 .
https : //doi.org/10.1002/nme.2662 https : //doi.org/10.1002/gamm.201490018 https : //doi.org/10.1002/nme.4823 https : //doi.org/10.1006/jcph.2001.6778 https : //doi.org/10.1007/s00466-007-0173-i https : //doi.org/10.1007/s00466-007-0173-i https : //doi.org/10.1016/j.cma.2008.02.036 https : //doi.org/10.1002/nme.686 https : //doi.org/10.1016/j.cma.2014.09.033 https : //doi.org/10.1016/j.cma.2014.09.033 https : //doi.org/10.1007/s11831-010-9045-2 https : //doi.org/10.1007/s11831-010-9045-2 https : //doi.org/10.1016/j.compfluid.2012.02.004 https : //doi.org/10.1016/j.compfluid.2012.02.004 https : //github.com/kratosmultiphys https : //doi.org/10.1016/b978-1-55860-732-3.50001-2 https : //doi.org/10.1002/cnm.959 https : //doi.org/10.1145/361002.361007 https : //doi.org/10.1080/10867651.2002.10487560 https : //doi.org/10.1080/10867651.2001.10487535 https : //doi.org/10.1080/10867651.2001.10487535 https : //doi.org/10.1007/bf01934125 https : //doi.org/10.1299/jcst.2.435 https : //doi.org/10.1109/svv.1998.729593 https : //doi.org/10.1145/1468075.1468082 https : //doi.org/10.1109/tvcg.2003.1196006 robust algorithm implicit descript immers geometri within background mesh abstract introduct implicit geometri represent mean level-set approach octree-bas spatial search determin intersect geometr represent immers object use discontinu distanc function comput element distanc visual approxim immers geometri determin cut plane differ intersect pattern approxim planar surfac approxim curv surfac approxim surfac sharp edg approxim case sever boundari intersect summar strategi determin local cut plane refin strategi improv approxim qualiti identif close region use continu distanc function basic ray cast improv non-watertight geometri case includ double-sid geometri exampl immers geometri differ featur challeng surfac geometri close volum geometri combin arbitrarili complex geometri conclus acknowledg refer
