reduc order model thermal coupl low mach flow rey et al. adv. model. simul. eng. sci. (2018) 5:28 research art icl open access reduc order model thermal coupl low mach flow ricardo reyes1* , ramon codina1,2, joan baiges1 sergio idelsohn2,3 *correspondence: 1universitat politcnica catalunya, jordi girona 13, edifici c1, 08034 barcelona, spain list author inform avail end articl abstract paper present collect techniqu formul projection-bas reduc order model (rom) zero mach limit thermal coupl navierstok equations. formul deriv standard proper orthogon decomposit model reduction, includ modif improv drawback caus inher non-linear navierstok equations: hyper-rom techniqu base mesh coarsening; implicit rom subscal formul base variat multi-scal framework; petrovgalerkin project necessari case non-symmetr terms. end article, test propos rom formul 2d 3d version example: differenti heat cavity. keywords: reduc order models, finit element method, variat multiscale, hyper-reduction, thermal coupl flow, low mach number flow introduct main purpos paper develop model reduct formul suitabl thermal coupl flows, expand techniqu projection-bas model reduc- tion develop applic fluid dynamicsmostli incompress navierstok equationsto zero mach limit navierstok equat develop [1,2]. follow model reduct develop [3] choos podmodel reduct approach. pod, projection-bas model reduction, aim phe- nomena repres computation expens numer method surrog lower dimension model. surrog model obtain project comput expens numer approxim previous com- pute reduc space. thus, model reduct arrang stages: offlin part, solut obtain high fidel order model (fom) build desir reduc order subspace; onlin part, project origin model reduc subspac rom built subsequ solved. tradit podmodel reduct approach present certain drawback con- sider non-linear complex problems: ad comput cost repres non-linear linear comput model, inher numer instabl caus navierstok formulation, non-optim project reduc space caus asymmetr natur formulation. author(s) 2018. articl distribut term creativ common attribut 4.0 intern licens ( permit unrestrict use, distribution, reproduct medium, provid appropri credit origin author(s) source, provid link creativ common license, indic chang made. 0123456789().,: volv rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 2 20 overcom issue, wide varieti method inspir work everson sirovich [4] introduc [510], term hyper-rom coin ryckelink [11]. famili method consist sampl geometr domain. paper, propos idea hyper-rom differ sampl way: set rom geometr space smaller origin one. this, appli mesh base methods, impli interpol develop rombasi includ coarser mesh. stabil fom rom, follow approach: vm framework. fom case, follow stabil formul thermal coupl zero mach limit navierstok equat develop [12], orthogon subgrid- scale (oss) defin [13]. rom case, propos analog method oss defin orthogon rom sub-space. lastly, solv non-optim reduc space projection, us petrov galerkin project instead standard galerkin project propos [7]. specif case mesh base methods, pod-rom method seen solut origin problem project method [14], petrovgalerkin project satisfi non-singular equat fom symmetric. articl organ follows. section, present brief descript zero mach number limit navierstok model. second section, briefli idea model reduct explan pod compress techniqu construct basis. section, present modifi finit element (fe)-rom implementation, includ stabil vms, new propos hyper-rom method, petrovgalerkin projection. fourth section, present exampl consist differenti heat cavity, 2d 3d cases. finally, close paper conclusions. thermal coupl flow problem let start describ gener thermal coupl navierstok formul nonlinear convectiondiffusionreact equat pose time interv (0, tf ) domain rd boundari , as: m(y )ty + l(y ;y ) = f , , t > 0, (1) nonlinear oper l defin as: l(y ;y ) ..= ai(i )ii ( k ij(i )jy ) + s(y )y , (2) boundari initi conditions: y = y d, t > 0, (3a) nik ijji niafi y = tn n , t > 0, (3b) y = y 0 , t = 0, (3c) y = (u, p, t ) vector unknown (veloc u, pressur p temperatur t ), n geometr unit outward normal vector , f known vector d + 2 rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 3 20 compon m, ai, k ij s (d + 2 d + 2) mass, convection, diffusion, reaction matric respectively. usual summat convent implied, indic run 1 number space dimens d, convect matrix ai = aci + f split order defin appropri dirichlet (d) neumann (n ) boundari conditions. lowmach number model follow descript themodel [1], zeromach limit navierstok model base split pressur relev parts: mechan p, behav incompress boussinesq approximations; thermodynam pth, constant domain depend energi ad domain time dependent. previou notat thermal coupl flows, formul written as: m = 0 0 0 0 0 0 0 cp , aci = iui 0 0 0 0 0 0 0 cpui , f = 0 0 ei 0 ei 0 0 0 0 0 , k ii = 0 0 0 0 0 0 0 , k ij = ej ei 23ei ej 0 0 0 0 0 0 0 0 , s = 0, f = g ddt dpth dt + q , (4) 0 vector rd zero components, ei unit vector i-th cartesian direction, d d ident matrix, fluid density. viscos , thermal conduct , specif heat constant pressur cp, heat capac ratio constant physic properties; g q repres bodi forc vector given extern heat sourc respectively. consid state equat necessari close system, simplicity, work focu exclus ideal gases, p = rt state equat r specif ga constant. finally, formul complet thermodynam pressur equations: open flow (un = ), thermodynam pressur determin global conserv equat (eq. 5a); close flow (un = ), ther- modynam pressur determin boundari condit (eq. 5b): pth = pth0 1 t0 d 1 t d (5a) || ( 1) dpth dt + 1p th n ud = qd + n td (5b) model reduct projection-bas rom reli exist reduc dimension sub-spac approxim solut space. let defin high dimension space yh dimens m, orthonorm basis. then, i-th compon elementi h yh rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 4 20 written linear combin yh,i = m k=1(yh,i, k ) k , (:, :) l 2-inner product. note yh approxim continuousinfinit dimensionalspace. formost case exact basi unknown,w candefin lower-dimension space yr yh dimensionm, approximatesyh asm m, basis. test basis, approxim i-th compon element y h yh,i m k=1 k y k , accuraci approxim depend accur basi compar exact basi . construct basi follow previou work model reduct fe [3,7,9], us pod statist procedur wai build reduc order sub-spac basi . object podmethod find basi collect high-fidel snapshot us basi desir reduc sub-space. let organ set data previous obtain solut problem eq. 1, n -collect snapshot y sh,j = y h,j y h ensemble: {y sh,j}nj=1 = {y sh,1,y sh,2, . . . ,y sh,n }, (6) y h mean valu snapshots. now, let denot {k}mk=1 orthonorm basi yh, member y h,j ensembl eq. 6 approxim as: y h,j y h + m k=1 (y sh,j , k )k . (7) pod consist find orthonorm basi {k}mk=1, that, k {1, . . . , m} mean squar error element y h,j , 1 j n , correspond j-th partial sum eq. 7 minim average: min {}mk=1 1 n n j=1 y sh,j m k=1 (y sh,j , k )k 2 , subject (i,j) = ij , 1 i, j m. (8) solv problem eq. 8 follow singular valu decomposit (svd) snapshot collect eq. 6, result left singular-vector decomposi- tion repres basi {k}mk=1. here, base eckartyoungmirski theorem defin reduc basi simpli truncat left singular-vector column as: {k}mmk=1 . criterion truncation, us retain energi defin [3] as: = m k=1 k m k=1 k , (9) k svd non-zero singular values. rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 5 20 remark note wai approxim , wai basi reduc order sub-spac (a on [15,16]). projection- base model reduct formul valid basi regardless techniqu obtain it. remark paper, snapshot data obtain fe approxim therefore, basi approxim fe space yhof dimens mwhich turn approxim space continu problem. fe-rom formul have state equat repres physic problem standard model reduct approach, fe-rom approxim problem. section, let denotei function continu spacewherei exist. instead follow standard galerkin approxim variat problemwher fe space denot yhwe construct approxim space yr y rom. fe space assum built fe partit th = k domain . order fe interpol irrelev discussion. introduc notat (:, :) = (:, :) (:, :) , l2-inner product respectively, integr product functionsif squar integr product integrated, defin variat problem find y r yr , that: (m(y )ty r ,r) + b(y ;y r ,r) = l(r) r yr , (10) r test function problem written form b l defin as: b(y ;y r ,r) ..= ( aci (y )ii r ,r ) (afi (y )y r , ir) + (k ij(i )jy r , ir ) + (s(y )y r ,r) , (11) l(r) ..= (f ,r) + ( tn,r ) . (12) note term y approxim y r eq. 11 involv non-linearities. section discuss linear scheme wai approxim terms. vm fe-rom given well-known lack stabil galerkin standard formulationpres convect domin regimesa stabil techniqu necessary. inspir previ- ou work acknowledg instabl issu [17,18] vm framework problem fe approximations, develop fe-rom-subgrid- scale (sgs), resembl fe-sgs. start split unknown continu problem y y r , resolv fe-rom standard approximation; remaind y , fe- rom-sgs. wai re-defin approxim continu space y = yr y , sg space y space complet yr y . then, rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 6 20 variat form problem eq. 10 expand two: find y r yr y y , that: (m(y )ty r ,r)+b(y ;y r ,r) + (m(y )t y ,r) + b(y ; y ,r) = l(r) r yr , (13a) (m(y )ty r , )+b(y ;y r , ) + (m(y )t y , ) + b(y ; y , ) = l() y . (13b) desir avoid deriv subscal y , re-writ bilinear form b(y ; y ,r) eq. 13a integr part element assum exact traction continu inter-el boundaries, yielding: (m(y )ty r ,r) + b(y ;y r ,r) + (m(y )t y ,r) + k ( y ,l(y ;r) ) k = l(r) r yr , (14) (:, :)k l2 inner product element k , l adjoint lineal oper l(y ; :). follow formul [12], adjoint oper l is: l(y ;r) ..= t (m(y )r) af j (y )jr acj (y )jr jkij (y )ir + s(y )r . (15) subscal approxim point, describ set equations: fe-rom one, term described; fe-rom-sg one. order solv second system, follow standard vm formulation. integr part terms, neglect traction inter-el boundaries, replacingu byut t ; re-writ eq. 13b as: k ( t (m(y )y ), ) k + k ( l(y ; y ), ) k = k ( r(y ,y r), ) k y , (16) residu defin asr(i ,y r) = fm(y )ty r l(y ;y r), linear oper defin l(y ;y r) ..= i(aci (y )y r) + f (y r)ii ( k ij(i )jy r ) + s(y )y r , with: f = 0 0 ei 0 ei 0 ui t 0 0 0 . (17) re-writ eq. 16 follow way: t (m(y )y ) + l(y ; y ) = r(y ,y r) + r k th, (18) r term ensur eq. 18 belong y definit depend choic y . now, algebra approxim l(y ; y ) 1(y )y , re-writ eq. 18 as: t (m(y )y ) + 1(y )y = r(y ,y r) + r k th, (19) rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 7 20 matrix stabil paramet depend k coeffici oper l. import notic far matrix depend choic approxim space yr , us definit stabil paramet fe approxim problem. case, us definit algebra oper given [2,13]: 1(y ) = 1m (y )i 0 0 0 1c (y ) 0 0 0 1e (y ) , (20) stabil paramet defin as: 1 m = c1 h2 + c2 |u| h , (21a) 1 c = c1m h2 , (21b) 1 e = c1 h2 + c2 cp|u| h , (21c) h element size c1 c2 algorithm constants. complet approxim subscales, remain defin term r , is, choos appropri subscal space y . base orthogon properti basi work develop [13,19], defin subscal space y = y y r , thought orthogon approxim space yr , impli having: y y r , (22a) y y r , (22b) r y . (22c) numer comput r follow supposit [20], orthogon yr y defin respect weight inner product (y ,)m = (y ,m(y )). follow condit subscal y satisfy: (m(y )y ,r) = 0 r yr . (23) replac orthogon condit (eq. 23) eq. 19, obtain: k ( t (m(y )y ),r ) = 0 r yr , k ( r(y ,y r) 1(y )y ,r ) + k ( r ,r ) = 0 r yr . (24) follow r follow project space y respect l2-inner product, denot r : r = r (r(y ,y r) + 1(y )y ) . (25) rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 8 20 replacingr intoeq. 19, andus approxim r ( 1(y )y ) = m1(y )1(y ) r( m(y )y ) = 0 present [20], express fe-rom-sgs: t (m(y )y ) + 1(y )y = r (r(y ,y r)) , (26) r ..= r defin orthogon project onyr , ident yr . finally, introduc orthogon condit (eq. 23) eq. 14, neglect term m(y )ty residu r eq. 26due orthogon y given by( m(y )ty , ) = 0, rearrang eqs. 14 26, state problem eq. 13 find y r yr y y , that: (m(y )ty r ,r) + b(y ;y r ,r) + k ( y ,l(y ;r) ) k = l(r), (27a) t (m(y )y ) + 1(y )y = r (r(y ,y r)) , (27b) adjoint oper l residu r redefin as: l(y ;r) = s(y )r af j (y )jr acj (y )jr jkij (y )ir , r(y ,y r) = f l(y ;y r). remark follow analysi perform deriv orthogon sg [13,19], come similar definit fe-rom-sgs, import differ li definit orthogon project eq. 26. fe case project space y h , fe-rom approxim space y r . remark choic stabilizationparamet follow fourier analysi [13]. inform repres reduc basi correspond resolv scale fom, subscal fom rom continu solut approxim fom. remark theprevi definitionof fe-rom-sg equival thedynam orthog- onal sgsmodel [20]; import acknowledg subscal imple- ment tempor term (quasi-static), orthogon yr . extens analysi fe equival model depict [12,20]. time discret time integr scheme appli discret time fe-rom fe-rom-sg equat (eq. 27). consid result [21], shown time integr subscal order accur finit element equat affect accuraci scheme, choos work backwarddifferenti formula (bdfs): second order fe-rom equat order fe-rom-sg ones. set uniform partit rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 9 20 time interv analysi [0, tf ],with t time step n superscript denot current time step, approxim tempor deriv eq. 27 using: ty r |n+1 y n+1r t ..= 3y n+1 r 4y nr + y n1r 2t , (28a) t y |n+1 y n+1 t ..= y n+1 y n t . (28b) replac time integr scheme (eq. 28b) eq. 27b equat subscales: y n+1 = t (y n+1) ( r ( r(y n+1,y n+1r ) ) + m(y n+1) y n t ) , (29) matrix effect stabil paramet defin t (y n+1) ..= ( m(y n+1) t + 1(y n+1) )1 . now, replac eq. 29 integr scheme (eq. 28a) eq. 27a, get: ( m(y n+1) y n+1r t ,r ) + b(y n+1;y n+1r ,r) + k ( t (y n+1) r ( r(y n+1,y n+1r ) ) ,l(y n+1;r) ) k + k ( t (y n+1)m(y n+1) y n t ,l(y n+1;r) ) k = l(r), (30) linear solv non-linear present term involv y , implement linear scheme base picard method. terminolog [20], time step n + 1, solv eq. 30 iter + 1, non-linear term approxim ways: y n+1,ir , linear subscales; y n+1,i r + y n+1,i, nonlinear subscales. thenw solv eq. 29 iter j+1, approxim non-linear term way: linear subscal (y n+1,i+1r ); non-linear subscal (y n+1,i+1 r + y n+1,j). discret approxim discret represent fe-rom problem composit fe rom approximations. fe space yh defin con- tinuou piece-wis polynomi function domain , write dis- crete approxim unknown y y h(x, t) ..= n i=1n (x i)i i(t), n (xi) shape function node i. contrast, rom approxim unknown y y (t) y + mk=1 ky k (t). approximations, spaceyr twoways: fe space yh, repres orthogon basi , rom approxim problem, discret continu piece-wis polynomi functions. way, write discret represent y r as: rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 10 20 y r(x, t) ..= n i=1 n (xi) [ y + m k=1 k (xi)i k (t) ] , x , t > 0. (31) petrovgalerkin project formul present introduc non-symmetr linear oper l l, necessari optim project wai give feasibl solut [14]. solv lack optim projection, replac tradit galerkin project petrovgalerkin project defin [7]. let re-writ linear version eq. 30 linear system: lyr = r (32) discret basi matrix, l r discret left right hand side eq. 30, yr discret unknown. appli natur wai petrovgalerkin project defin w = l matrix column vector form basi project space allow transform left hand eq. 32 posit semi-defin matrix. project eq. 32 space get: wly r = wr, llyr = lr. (33) orthogon properti basi = i, eq. 33 resembl petrovgalerkin rom formul [7,9]: llyr = lr (34) hyper-rom lastly, order reduc comput cost evaluatingnonlinear terms,wepropos mesh-bas hyper-rom altern sampling-bas domain reduct algorithm [510]. mesh-bas hyper-rom consist solut describ rom problem coarser mesh fom. implement techniqu straightforwardli write discret approxim (eq. 31) function new coarser mesh. ideally, coarsen perform function import area geometry, achiev exist mesh refin algorithms. subsequ examplesw test techniqu uniform coarsen themesh. remark pod basi obtain sampl mesh-bas solutiona fe exampleth coarsen mesh impli interpol basis. numer exampl section present exampl consist 2d 3d version initi transient adifferenti heat caviti aspect ratio 1similar theonepres [12,22]. exampl flow consid ideal ga physic properti r = 287.0 jkgk , cp = 1004.5 jkgk , = 0.001 m s . rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 11 20 comput domain problem defin = [0, l] [0, l] 2d problem, = [0, l] [0, l] [0, l] 3d problem, l = 1 m. temperatur wall perpendicular x-coordin (horizontal) fix th = 960 k tc = 240 k; adiabat boundari condit prescrib remain walls. additionally, slip imperm condit set walls, togetherwith homogen graviti forc g prescrib neg y-coordin (vertical). initi thermodynam pressure, temperatur densiti set pth0 = 101, 325 pa, t0 = 600 k, 0 = 0.58841 kgm3 respectively, dimensionless prandtl rayleigh number set pr = cp = 0.71 ra = 2|g| 2cp (thtc) (th+tc) = 3.55 10 6. fomsolut (a refer solut construct snapshots), follow vm formul present [20], dynam orthogon sg model. cases, us constant time step size t = 0.01 s. finit element mesh (describ below) time step slightli higher critic time step explicit scheme advection, turn order viscou effects. us implicit scheme, restrict critic time step size, observ serv justifi choic adequate. addition follow examples, test differenti heat caviti aspect ratio 8 analyz [23], get inconclus results. dimension case 2d problem, us 2 uniform structur mesh compos quadrilater ele- ments: 10,000 element mesh size h = 0.01, solv fom rom; 2500 element mesh size h = 0.02, test hyper-rom formulation. construct basis, collect 500 snapshot velocity, pressur temperatur 4 time step 20 s interval. figur 1, 2, 3, temperatur contour solut obtain fom, rom, hyper-rom formul respectively. evalu accuraci rom hyper-rom formulations, perform seri numer test 12 differ set basis, vari retain energi 1 = 0.99 12 = 0.3. figur 4 depict number vector basi function retain energy. fig. 1 fom temperatur contour t = 1, t = 2, t = 3 s 2d differenti heat caviti rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 12 20 fig. 2 rom temperatur contour t = 1, t = 2, t = 3 s 2d differenti heat caviti fig. 3 hyper-rom temperatur contour t = 1, t = 2, t = 3 s 2d differenti heat caviti 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0 0 5 10 15 20 25 30 35 40 45 50 55 # basi vector fig. 4 number basi vector 2d figs. 5 6 compar nusselt number fom, rom, hyper-rom solutions. nusselt number calcul integr local nusselt number hot cold wall nu(x, t)d, local nusselt number defin as: nu(x, t) = l th tc n t (x, t), x , t > 0. (35) expected,weobserv amorediffus behaviour, themean thefluctu nusselt number, fewer basi vector included. hyper-rom result appear behaviour rom lower amplitude. additionally, rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 13 20 6.5 7.0 7.5 8.0 8.5 9.0 9.5 10.0 10.5 11.0 11.5 rom n u ss e lt rom rom 6.5 7.0 7.5 8.0 8.5 9.0 9.5 10.0 10.5 11.0 11.5 0 1 2 3 4 5 6 7 8 9 10 romh n u ss e lt time 0 1 2 3 4 5 6 7 8 9 10 romh time 0 1 2 3 4 5 6 7 8 9 10 romh time fom fomh 1 2 3 4 5 6 7 8 9 10 11 12 fig. 5 nusselt number evolut hot wall -14.0 -13.5 -13.0 -12.5 -12.0 -11.5 -11.0 -10.5 -10.0 -9.5 rom n u ss e lt rom rom -14.0 -13.5 -13.0 -12.5 -12.0 -11.5 -11.0 -10.5 -10.0 -9.5 0 1 2 3 4 5 6 7 8 9 10 romh n u ss e lt time 0 1 2 3 4 5 6 7 8 9 10 romh time 0 1 2 3 4 5 6 7 8 9 10 romh time fom fomh 1 2 3 4 5 6 7 8 9 10 11 12 fig. 6 nusselt number evolut cold wall includ fom solut (label fomh ) coarser mesh evalu hyper-rom formul relat fe mesh coarsening. comput initi transient period physic phenomenaw choos rootmean squar thenusselt errorov hot cold wallsa wai tomeasur overal error. discret l2-norm error nusselt numberfor time step iover node coordin xa boundari defin as: rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 14 20 103 102 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0 r m sh 103 102 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0 r m sc 103 102 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0 rm s rom romh fomh fig. 7 rm convergence. hot wall hrms, cold wall c rms, mean rm = ((nurom(x a) nufom(xa))2 (nufom(xa)) 2 , (36) root squar mean ifor n time step defin as: rm = n i=1 ( 2i n ) . (37) figur 7 show converg rm hot cold walls, mean valu rms. includ converg error fom coars mesh. converg error clear slope, behav expected, error decreas addit basi vectors. import notic appear optim valu = 1the maximum number basi vectorswher error reach minimum; consid result occur near = 1, believ attribut overfit phenomenon. idea explor [24,25], attribut lack smooth noisi low energi basi vectors. overal result hyper-rom adequate, given error order rom coars mesh fom solutions. evalu tempor evolut perform discret fourier transform nusselt number. figs. 8 9 compar nusselt number spectra hot cold wall respectively. againw reduc basi vector lead amor diffus solution. contrast fig. 7, nusselt number spectra observ rom hyper- rom spectra tend fom spectra approach = 1. comput time, fig. 10 show speedup case initi conditions, time step, configuration. expect comput time reduc coarser mesh used. import note computa- tional time romand hyper-rom decreas solut smaller linear have fewer non-linear iterations. dimension case 3d problem, us 2 uniform structuredmesh compos regular hexahedr elements: 64,000 element mesh size h = 0.025, solv rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 15 20 10-4 10-3 10-2 10-1 100 1 n u ss e lt 2 3 4 10-4 10-3 10-2 10-1 100 5 n u ss e lt 6 7 8 10-4 10-3 10-2 10-1 100 10-1 100 101 9 n u ss e lt frequenc (hz) 10-1 100 101 10 frequenc (hz) 10-1 100 101 11 frequenc (hz) 10-1 100 101 12 frequenc (hz) fom rom romh fig. 8 fourier transform nusselt number hot wall 10-4 10-3 10-2 10-1 100 1 n u ss e lt 2 3 4 10-4 10-3 10-2 10-1 100 5 n u ss e lt 6 7 8 10-4 10-3 10-2 10-1 100 10-1 100 101 9 n u ss e lt frequenc (hz) 10-1 100 101 10 frequenc (hz) 10-1 100 101 11 frequenc (hz) 10-1 100 101 12 frequenc (hz) fom rom romh fig. 9 fourier transform nusselt number cold wall fom rom; 35937 element mesh size h = 0.03, solv hyper-rom. construct basis, collect 500 snapshot velocity, pressur temperatur 2 time step 10 s interval. rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 16 20 0 10 20 30 40 50 60 0.4 0.5 0.6 0.7 0.8 0.9 1.0 s p e e d u p rom romh fomh fig. 10 speedup rom hyper-rom fig. 11 streamlin t = 10 fom, rom hyper-rom = 0.8 0.4 0.5 0.6 0.7 0.8 0.9 1.0 5 10 15 20 25 30 35 40 45 # basi vector fig. 12 number basi vector 3d figur 11 show comparison streamlin fom, rom hyper-rom solu- tion time step simulation. test 3d problem perform similar test on 2d problem 6 differ set bases, vari retain energi 1 = 0.99 6 = 0.5 fig. 12 depict number vector basi function retain energy. 2d problem, 3d case comput nusselt number, root mean squar nusselt error discret fourier transform nusselt number hot cold walls, get similar results. figs. 13 14 compar nusselt number spectra hot cold walls. result behav similar wai 2d case, rom hyper-rom rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 17 20 10-7 10-6 10-5 10-4 1 n u ss e lt 2 3 10-7 10-6 10-5 10-4 10-1 100 101 4 n u ss e lt frequenc (hz) 10-1 100 101 5 frequenc (hz) 10-1 100 101 6 frequenc (hz) fom rom rom-h fig. 13 fourier transform nusselt number hot wall 10-7 10-6 10-5 10-4 1 n u ss e lt 2 3 10-7 10-6 10-5 10-4 10-1 100 101 4 n u ss e lt frequenc (hz) 10-1 100 101 5 frequenc (hz) 10-1 100 101 6 frequenc (hz) fom rom rom-h fig. 14 fourier transform nusselt number cold wall dissipative, spite ratio mesh smaller. believ attribut qualiti basis, directli depend qualiti snapshot construct it. figur 15 show root mean squar nusselt error rom hyper-rom, show similar result 2d case, includ overfit phenomena retain energi approach 1. figur 16 show speedup rom hyper-rom solutions. reduct comput time 3dproblem larger achiev 2dproblem, similar basi vectors. rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 18 20 10-3 10-2 0.5 0.6 0.7 0.8 0.9 1.0 r m sh 10-4 10-3 10-2 0.5 0.6 0.7 0.8 0.9 1.0 r m sc rom romh fig. 15 rm convergence. hot wall h rm cold wall c rm 25 30 35 40 45 50 55 60 65 70 0.5 0.6 0.7 0.8 0.9 1.0 s p e e d u p rom romh fig. 16 speedup rom hyper-rom conclus work develop formul allow perform rom zero mach number navierstok approximation. purpos describ set tool allowu tackl themain problem arise: lack stability, ad com- putat cost non-linear non-optim project reduc space. solv lack stability, propos vms-fe-rom formul follow characteristics: implicit formulation, reduc offlin cost eas implementation. built vm framework, incorpor non-linear term adjoint oper (eq. 15), relev complex flows. itmaintain orthogon definition, propos [18,26], sub-spac yr y . residual-based, shown eq. 18. work stabil coeffici on develop vms- fe formul [2,12]. work focus sole us dynam subscales, possibl construct method quasi-stat subscal stabil techniques. solv ad comput cost, propos mesh-bas hyper-rom contrari tradit sample-bas methods, requir algorithm rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 19 20 select sampl points. numer experi perform hyper-rom method behav appropriately, induc expect ad diffus solution. natur extens mesh-bas hyper-rom method us mesh refin techniqu improv comput time accuraci method. finally, tackl non-optim project non-linear formulation, differ interpret petrovgalerkin projectionorigin describ [7]in order includ formulation. author contribut author contribut manuscript write numer experiments. code numer simul develop femuss rr. author read approv final manuscript. author detail 1universitat politcnica catalunya, jordi girona 13, edifici c1, 08034 barcelona, spain, 2centr internacion mtode numric lenginyeria (cimne), campu nord upcc/gran capit s/n, edifici c1, 08034 barcelona, spain, 3intituci catalana recerca estudi avanat (icrea), passeig lu compani 23, 08010 barcelona, spain. acknowledg r. rey acknowledg scholarship receiv colciencias, colombian government. r. codina acknowledg support receiv icrea academia research program, catalan government. compet interest author declar compet interests. publish note springer natur remain neutral regard jurisdict claim publish map institut affiliations. received: 28 juli 2018 accepted: 19 novemb 2018 refer 1. princip j, codina r. mathemat model thermal coupl low speed flows. adv theor appl mech. 2009;2(2):93112. 2. princip j, codina r. stabil finit element approxim low speed thermal coupl flow. int j num method heat fluid flow. 2008;18:83567. 3. sirovich l. turbul dynam coher structures. i: coher structures. iisymmetri transformations. iiidynam scaling. q appl math. 1987;45:56171. 4. everson r, sirovich l. karhunen-lov procedur gappi data. j opt soc a. 1995;12(8):165764. org/10.1364/josaa.12.001657. 5. barrault m, madai y, nguyen nc, patera at. empir interpol method: applic effici reduced-basi discret partial differenti equations. compt rendu math. 2004;339(9):66772. org/10.1016/j.crma.2004.08.006. 6. nguyen nc, patera at, perair j. best point interpol method effici approxim parametr functions. int j num method eng. 2008;73(4):52143. 7. carlberg k, bou-mosleh c, farhat c. effici non-linear model reduct least-squar petrovgalerkin project compress tensor approximations. int j num method eng. 2011;86(2):15581. 1002/nme.3050. 8. ryckelynck d, vincent f, cantournet s. multidimension priori hyper-reduct mechan model involv intern variables. comput method appl mech eng. 2012;225228:2843. 005. 9. baig j, codina r, idelsohn sr. numer simul coupl problem engineering. in: idelsohn sr, editor. reduced-ord model strategi finit element approxim incompress navierstok equations. cham: springer; 2014. p. 189216. 10. hernndez ja, caicedo ma, ferrer a. dimension hyper-reduct nonlinear finit element model empir cubature. comput method appl mech eng. 2017;313:687722. 11. ryckelynck d. priori hyperreduct method: adapt approach. j comput phys. 2005;202(1):34666. doi.org/10.1016/j.jcp.2004.07.015. 12. avila m, princip j, codina r. finit element dynam nonlinear subscal approxim low mach number flow equations. j comput phys. 2011;230(22):79888009. 13. codina r. stabil finit element approxim transient incompress flow orthogon subscales. comput method appl mech eng. 2002;191(39):4295321. 14. saad y. iter method spars linear systems, vol. 8. philadelphia: societi industri appli mathematics. p. 1447. 9780898718003. rey et al. adv. model. simul. eng. sci. (2018) 5:28 page 20 20 15. schimd pj. dynam mode decomposit numer experiment data. j fluid mech. 2010;656:528. 16. chinesta f, ladevez p, cueto e. short review model order reduct base proper gener decomposition. arch comput method eng. 2011;18(4):395. 17. baig j, codina r, idelsohn s. reduced-ord subscal pod models. comput method appl mech eng. 2015;291:17396. 18. iliescu t, wang z. variat multiscal proper orthogon decomposition. convec domin convec diff eq. 2011;82(283):22. 19. codina r. stabil incompress convect orthogon sub-scal finit element methods. comput method appl mech eng. 2000;190:157999. 20. avila m, codina r, princip j. larg eddi simul low mach number flow dynam orthogon subgrid scales. comput fluids. 2014;99:4466. 21. codina r, princip j, guasch o, badia s. time depend subscal stabil finit element approxim incompress flow problems. comput method appl mech eng. 2007;196(2124):241330. 1016/j.cma.2007.01.002. 22. qur pl, weisman c, pailler h, vierendeel j, dick e, becker r, braack m, lock j. model natur convect flow larg temperatur differences: benchmark problem low mach number solvers. 1. refer solutions. esaim. 2005;339:60916 10.1051/m2an. 23. christon m, gresho pm, sutton sb. comput predict natur convect flow enclosures. ljinmf. 2002;40:95380. 24. baig j, codina r, idelsohn s. explicit reduced-ord model stabil finit element approxim incompress navier-stok equations. int j num method fluids. 2013;72(12):121943. fld.3777. 25. gier s, iliescu t, john v, well d. supg reduc order model convectiondomin convectiondiffusion-react equations. comput method appl mech eng. 2015;289:45474. 1016/j.cma.2015.01.020. 26. azaez m, chacn rebollo t, rubino s. streamlin deriv projection-bas pod-rom convection-domin flows. : numer analysis. arxiv e-prints. 2017. arxiv:1711.09780. reduc order model thermal coupl low mach flow abstract introduct thermal coupl flow problem low mach number model model reduct construct basi fe-rom formul vm fe-rom subscal approxim time discret linear discret approxim petrovgalerkin project hyper-rom numer exampl dimension case dimension case conclus acknowledg refer