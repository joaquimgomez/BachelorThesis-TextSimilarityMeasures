simul three-dimension viscoplast flow adapt mesh refin jordi cotela-dalmau1,2, riccardo rossi1,2, antonia larese1,2 1 cimn - centr internacion metod numer en enginyeria, campu nord upc, c/gran capita s.n. 08034 barcelona, spain. 2 universitat politecnica catalunya, upc barcelona tech, c/gran capita s.n. 08034 barcelona, spain. abstract paper present finit element solver simul steadi non-newtonian flow problems, regular bingham model, adapt mesh refin capabilities. solver base stabil formul deriv vari- ation multiscal (vms) framework. choic allow introduct posteriori error indic base small scale solu- tion, drive mesh refin procedur base element subdivision. approach appli solut seri benchmark exam- ples, allow valid formul assess capabl model 2d 3d non-newtonian flows. keyword adapt mesh refinement; bingham model; viscoplast fluids; variat mul- tiscal stabilization; 1 introduct choic comput mesh crucial aspect practic finit element analysis. us unstructur mesh allow obtain higher level part domain solut chang rapidly, region interest. time, coarser resolut solut smooth reduc comput requirements. clearly, us singl static mesh limit advantag approach evolv solutions, requir analyst adequ design mesh, guid intuit expect behavior. good choic possibl priori, especi studi complex geometries. repres partic- ularli problemat issu case viscoplast fluids, adequ mesh resolut crucial properli flow and, particular, captur transit yield unyield regions. complex problem case difficult draw previou experience, dynam adapt mesh viabl method reduc comput time. reason, varieti adapt mesh 1 refin (amr) techniqu develop year adjust comput mesh respons obtain solut (see exampl [1] [2]). amr techniqu typic involv components: indic identifi region obtain solut larg error refin strategi local modifi mesh resolut respons larg detect error. aspect problem address turn current paper provid pictur propos technique. extens literatur exist error estim techniques, start pioneer work babuska rheinboldt [3]. widespread option us posteriori error estim techniqu quantifi error solut (a exampl [4, 5, 2, 6, 7]). gener idea approach us comput solut assess accuracy. us amr techniqu viscoplast flow remain compar un- explored. specif case bingham fluids, previou studi appli adapt remesh techniqu plane axisymmetr flow [8, 9, 10]. approach extend three-dimension free surfac flow [11], describ shallow water approximation. cases, refin driven indic base dissip energi solution, larger area high veloc gradients, mesh complet re- gener size distribut obtain valu indicator. applic amr techniqu viscoplast materi forg process [12]. reference, mesh refin preserv mesh qualiti simul metal casting. current paper explor us error indic motiv variat multiscal (vms) stabil techniqu [13, 14], pro- vide basi underli finit element formulation. forerunn techniqu emploi origin present convection-diffus problem [15] recent extend navier-stok equa- tion [16, 17] solv incompress newtonian flow problems. kei idea propos error indic actual simple: vm solver base construct model fine scale variabl (repres solut resolv mesh) term larg scale on (the describ finit element mesh). small scale model design provid consist solutions, tend zero mesh refined. thus, small scale construct error indicator: if, given element patch elements, magnitud small scale solut large, mesh like rel coars region model. provid indic identifi area need refinement. approach close relat solver technolog employed. crucially, deriv natur vm formul defin problem hand. such, appli case nonlinear rheolog behavior, focu current work, extend mention newtonian version method. knowledg approach appli context. abl identifi area larg error domain, modifi comput mesh increas overal accuracy. differ grid modif strategi propos late eight- i [18, 19, 20], involv exampl local mesh modif [21], movement 2 mesh node solut auxiliari elast problem [22], mesh morph techniqu [23] edg stretch [24]. techniqu re- quir user specifi nodal edge-bas refin target, involv obtain measur error (or indicator) node edg mesh improved. contrari techniqu emploi base element (rather nodal) refin strategi [16, 25]. approach follow error indic signal list element refined. element subdivid neighbor modifi mesh conform preserved. approach repres good match chosen error indicator, evalu element independently. propos procedur origin develop refin distribut memori context [16] allow mpi-parallel refinement. present paper organ follows: section 2, vm finit ele- ment formul solut stationari bingham flow problem introduced. section 3 describ mesh refin algorithm error indic identifi region refined. present result simul three-dimension bingham flow test case section 4, allow evalu capabl present approach. finally, conclud remark given section 5. 2 non-newtonian flow solver 2.1 govern equat problem consid present work describ sta- tionari form navier-stok equations. given domain rd (with d = 2, 3) contain fluid densiti extern forc f act it, relationship fluid stress veloc u given u u = f (1) u = 0 . (2) eqs. (1) (2) combin condit boundari domain , defin = d n , d n repres dirichlet neumann part boundary, respectively. boundari condit express u = u0 d (3) n = t n , (4) u0 impos veloc dirichlet boundari d, n outward unit normal neumann boundari n t impos traction. stress tensor eq. (1) decompos volumetr part, depend pressur p, deviator stress tensor, , = p + (5) second order ident tensor. constitut model requir close formulation, give expres- sion deviator stress . behavior broad class fluid 3 describ gener newtonian law appar viscos , given = 2s (6) appar viscos is, general, variabl depend charac- terist flow, s strain rate tensor, defin s = su = 1 2 ( u + (u)t ) . (7) stress strain rate tensori quantities, introduc follow- ing invari measur magnitud = 2 s : s = 1 2 : , (8) allow us constitut relat eq. (6) multi-dimension setting. present work us regular bingham model flow. bingham fluid [26, 27] materi resist shear stress lower threshold value, known yield stress 0, flow constant viscos p, call plastic viscosity, larger shear stress applied. behavior repres notat eq. (6) appar viscos defin < 0 = p + 0 0. (9) unfortunately, discontinu natur bingham model introduc numer difficulties, appar viscos infinit strain rate lower yield stress. possibl approach explor litera- ture address issue. reformul problem variat inequ [28, 29, 30] us oper split method [31, 32, 33, 34] augment lagrangian approach [35, 36] solv problem. second introduct regular constitut relat [37, 38, 39, 40, 41]. us technique, replac eq. (9) regular express better suit numer simulation. adopt express propos papanastasi [39], given = p + 0 ( 1 em ) , (10) m regular coeffici dimens time. relationship law shown fig. 1, seen regular law eq. (10), repres dot lines, tend ideal model eq. (9) valu regular coeffici m increased. remark us regular model introduc error solution, signific determining, example, particular problem stabl (the solut static) yields, develop flow solution. quantifi [42], address papanastasi regularization, others. effect magnifi small valu regular coeffici m odd fact larg valu m result problem harder solv numerically. such, care choos valu m avoid compromis obtain solution. 4 strain rate 0 s tr e s s increas m regular ideal p figur 1: bingham model. 2.2 weak formul us standard galerkin approach obtain variat form problem, multipli eqs. (1) (2) test function w, q integr simul domain . integr part term correspond stresses, incorpor neumann boundari condit eq. (4) expression, obtain w u u d + 2sw : su d w p d = wf d + n wt d (11) q u d =0. (12) ensur problem given eqs. (11) (12) well-posed, need specifi appropri function space unknown u, p test function w, q guarante integr bounded. case velocities, requir function spatial deriv square-integrable, is, u vd [h1()]d. furthermore, requir function vd verifi dirichlet boundari condit problem, given eq. (3). similar requir momentum test function w, zero dirichlet boundari d. denot w v0 [h1()]d. case pressur continu equat test function q, ensur square-integr domain, denot p, q q l2(). finit element solut problem defin eqs. (11) (12) known suffer stabil issu that, particular, preclud us equal-ord interpol veloc pressure. solv problem introduc vm formul [13, 14]. denot finit element discret problem domain h = e e, e repres subdomain correspond element e, in- troduc discret solut problem uh vh,ph qh, vh vd qh q discret space defin finit element interpolation. vm approach base decompos problem variabl larg 5 scale part, identifi finit element solution, small scale u = uh + u p = ph + p, (13) small scale variabl u, p repres continu solut resolv finit element approximation. scale separ eq. (13) introduc eqs. (11) (12) obtain vm formul problem. test function belong discret space wh vh0 v0 qh qh, obtain wh uh uh d + 2swh : suh d wh ph d e e uh wh u d e e (2swh) u d e e wh p d = whf d + n wht d (14) qh u = e e qhu d. (15) deriv eqs. (14) (15) eqs. (11) (12), integr part element subdomain e term involv small scale variabl u p. allow obtain express depend small scale valu small scale spatial derivatives. note that, so, neglect term involv element boundari integrals. understood consid small scale function vanish element boundari (see exampl [43] detail derivation). model small scale solut requir close formulation. possibl us algebra sub-grid scale (asgs), defin [44]. asgs, small scale consid proport residu strong form momentum continu equations, evalu discret solution. result follow express small scales: u = 1r m (uh, ph) = 1 (f uh uh + 2suh ph) (16) p = 2r c (uh) = 2 ( uh) , (17) rm (uh, ph) r c (uh) correspond residu form eqs. (1) (2) evalu finit element solut uh, ph, 1 2 scalar stabil parameters. valu 1 2 chosen follow [45, 46], is, paramet origin design newtonian version method [44] replac newtonian viscos appar viscos . seen equival neglect depend veloc design stabil parameters. follow approach, stabil paramet defin term characterist element length h 1 = ( 2 uh h + 4 h2 )1 2 = + uhh 2 , (18) denot standard euclidean vector norm. 6 altern choic small scale us orthogon sub-grid scale (oss) [43, 47, 48, 49, 46]. oss formulation, larg scale residu orthogon finit element space model small scale variables. express u = 1 (f uh uh + 2suh ph m) (19) p = 2 ( uh c) , (20) m (uh, ph) c (uh) l2 project residu finit element space, is, solut auxiliari project problem wh m d = wh (f uh uh + 2suh ph) d (21) qh c d = qh uh d. (22) worth mention viscou term 2suh appear eqs. (16) (19), momentum project eq. (21), zero element interior evalu linear finit elements, involv second deriv piecewis linear functions. exampl present work us linear elements, term neglect following. introduc oss small scale model variat form prob- lem, given eqs. (14) (15), follow weak formul obtain wh uhuh d + 2swh : suh d wh ph d + e e uhwh1 (uh uh +ph) d e e wh2 ( uh c) d = whf d + n wht d + e e uhwh1 (f m) d (23) qhu + e e qh1 (uhuh +ph) d = e e qh1 (f m) d. (24) similarly, asg formul recov drop term involv m c eqs. (23) (24). final remark, note vm repres gener framework write stabil weak formulations. sense, final weak problem engend asg oss seen encompass well-known stabil techniqu supg/pspg [50] galerkin-least squar (gls) [51]. 2.3 matrix formul us standard linear finit element function interpol larg scale veloc pressur solutions. introduc interpol eqs. (23) 7 (24) shape function node test function wh, ph succession, obtain follow equat [ c + k + sk g + sg d + sd l ] [ u p ] = [ f + sm sc ] , (25) u p repres vector nodal valu veloc pressure, respectively. block appear matrix right hand vector eq. (25) obtain finit element assembl differ integr appear stabil equations. b repres node indices, i, j correspond spatial direct na finit element function associ node a, galerkin term eqs. (23) (24) rise follow block matric cabij = e na ( uh k nb xk ) ij d k ab = e btacbb d gabi = e na xi nb d d ab j = e na nb xj d fai = e na fi d + n nati d, (26) ij correspond kroneck delta. defin viscou matrix k ab, strain rate matrix b constitut matrix c, 2d given ba = xna 0 0 yna yna xna c = 2 0 0 0 2 0 0 0 1 (27) 3d defin ba = xna 0 0 0 yna 0 0 0 zna yna xna 0 0 zna yna zna 0 xna c = 2 0 0 0 0 0 0 2 0 0 0 0 0 0 2 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 , (28) introduc notat ()na = na/() compactness. analogously, discret term aris vm stabiliza- 8 tion allow write sk ab ij = e ( uh k na xk ) 1 ( uh l nb xl ) ij d + e na xi 2 nb xj d sg ab = e ( uh k na xk ) 1 nb xi d sd ab j = e na xj 1 ( uh k nb xk ) d lab = e na xk 1 nb xk d sm = e ( uh k na xk ) 1 (fi mi ) d e na xi 2 c d sc = e na xk 1 (fk mk ) d. (29) eq. (25) contain multipl non-linear terms: con- vectiv term, term involv appar viscos , stabil paramet 1, 2 and, oss, projections, non-linear depend velocity. problem linear fixed-point iteration. case oss stabilization, associ problem solv calcul projections. problem correspond discret form eqs. (21) (22), defin [ mm 0 0 mc ] [ m c ] = [ rm rc ] , (30) m c repres vector nodal valu momentum mass projections, respectively, differ term matrix right hand vector obtain finit element assembl local contribut given mm ab ij = e nanbij d rm = e na ( fi uh k uh xk ph xi ) d mc ab = e nanb d rc = e na ( uh xi ) d. (31) note non-zero matrix block left hand eq. (30) structur mass matrix. practice, approxim diagon mass matrix, allow obtain project solut diagon linear system. 3 mesh refin strategi 3.1 error estim mesh refin strategi driven error indicator, identifi region simul domain mesh resolut increased. us error indic base scale separ introduc vm models, follow idea hauk et al. [15]. approach, origin 9 present convection-diffus problem, extend navier- stoke equat [16] [17]. main idea approach us magnitud small scale veloc model, which, case, given eq. (16) asg eq. (19) oss error indicator. small scale veloc ultim proport residu form origin momentum equat (or project mesh), magnitud interpret measur error solution. mind, defin indic error element e (ie) 2 = u2 = e u u d. (32) introduc definit small scale veloc eq. (32), expres- sion particular consid stabil formul ( iasgs )2 = e 21 rm 2 d (33) ( ioss )2 = e 21 rm m 2 d. (34) indic obtain deriv small scale model stabil and, element level, proport local residual, weight squar stabil paramet 1. oss variant, indic eq. (34) involv differ local residu project residual. idea compar local smooth field quantiti relat error estim zienkiewicz zhu [52]. measur elements, obtain distribut error indi- cator domain. identifi element estim larger prescrib tolerance, split accord algorithm describ follow section. 3.2 refin algorithm element larger error identified, us mesh re- finement algorithm improv mesh resolution. adopt algorithm present [16], improv resolut exist tri- angular tetrahedr mesh. refin strategi origin develop easili applic distribut memori environ design requir minim inform local element refined. given triangular mesh, idea procedur refin iden- tifi element introduc new node mid-point edg quadrisect origin triangle. neighbor element divid maintain mesh consistency: refin edg bisect edge, element refin edg divid new triangles. procedur appli tetrahedr meshes, fulli refin element divid new tetrahedra adjac element refin accordingly. main step refin procedur illustr figur 2 2d case describ follow 10 (a) (b) (c) (d) figur 2: refin procedure: (a) identifi element refine; (b) divid edg insert new nodes; (c) remov element split edges; (d) creat new element recov conform mesh. 1. iter mesh elements, evalu error indic given eq. (33) asg eq. (34) oss. 2. error indic larger predefin toler given ele- ment, mark edg need refinement. step repres fig. 2(a). 3. new node creat mid-point edg identifi need refinement, shown fig. 2(b). nodal data and, particular, initi guess veloc pressure, interpol node defin origin edge. 4. element refin edg delet (see fig. 2(c)). note includ element error indic larger tolerance. 5. new element creat predefin patterns, depend edg origin element split. step repre- sent fig. 2(d). step rel straightforward 2d case, involv 3d problems, number possibl edg split pattern larger. direct interest reader origin refer algorithm [16] details. note that, cases, 3d refin involv creation extra node center origin tetrahedron. note refin procedur preserv qualiti fulli refin elements, new element angl origin one. unfortunately, case element edg refined, mesh qualiti significantli degrad type partial refin perform repeatedli patch elements. multipl techniqu allevi issue. mesh qualiti trivial preserv allow complet refin (quadrisection) 11 elements, maintain conform requir impli refin entir domain. possibl relax introduc non- conform mesh hang nodes, typic requir constrain success refin neighbor element differ refin level. alternatively, us differ algorithm mark refin el- ement (see exampl [53, 54]) limit mesh degrad produc success refinement. altern viabl docu- ment literature, requir compar inform neighbors. given easili avail distribut memori environment, main consider design emploi algorithm [16], here. present paper, follow differ strategy: allow repeat par- tial refinement, appli local improv strategi refin iter improv qualiti final mesh. 2d exampl pre- sent section 4 us algorithm describ [55], base reconnect node adjac elements. 3d cases, us pro- cedur present [56], consist take cluster adjac element chang local topology, ad delet node reconnect element improv mesh quality. 4 numer result formul present previou page implement krato multiphys framework finit element solver [57]. us implement simul benchmark problem intent evalu capabl adapt refin techniques. fi- nite element formulation, mesh refinement, author combin particl finit element method (pfem) simul non-newtonian flow [58, 59, 60]. choic parameters, includ regular paramet m problem-specif values, load incre- ments, base previou experi author similar problem (see [45]). linear system equat appear solut procedur solv amgcl algebra multigrid solver [61]. 4.1 poiseuil flow test case simpl poiseuil flow impos pressur gradient. defin 6 1 m plane channel, shown fig. 3, prescrib pressur variat p = 2 103 pa right left extremes. no-slip condit impos remain side channel. fluid densiti = 1 kg/m3 plastic viscos p = 10 pa s regular coeffici set m = 103 s. consid cases: bingham flow yield stress 0 = 100 pa newtonian case, recov take viscos = p eq. (6). start simul unstructur mesh shown fig. 4, con- tain 66 node 92 triangular elements. problem solv iteratively: solut flow problem follow mesh refin algorithm, 12 l = 6 m h = 1 m no-slip condit no-slip condit x y left extern presur a' right extern presur figur 3: poiseuil flow geometri boundari conditions. figur 4: poiseuil flow initi mesh. procedur repeat error indic smaller fix toler element mesh. simul seri case absolut indic toler rang 103106m2s1 studi sensit propos approach tol- eranc valu error indicator, test asg oss approaches. number element obtain case shown fig 5, veloc profil central transvers section domain, correspond section aa fig. 3, shown fig. 6 newtonian fluid test fig. 7 bingham flow. cases, obtain result compar analyt solut poiseuil flow, given eq. (35) (see exampl [62]). 106 105 104 103 toler 102 103 104 105 106 n u m . e le m e n ts asg oss (a) newtonian fluid. 106 105 104 103 toler 101 102 103 104 105 106 n u m . e le m e n ts asg oss (b) bingham fluid. figur 5: poiseuil flow number element end simul differ error indic tolerances. 13 0.4 0.2 0.0 0.2 0.4 y (m) 0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 u (m / s ) analyt tol. 106 tol. 104 (a) newtonian fluid (asgs). 0.4 0.2 0.0 0.2 0.4 y (m) 0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 u (m / s ) analyt tol. 106 tol. 104 (b) newtonian fluid (oss). figur 6: newtonian poiseuil flow streamwis veloc profil differ error indic tolerances. 0.4 0.2 0.0 0.2 0.4 y (m) 0.1 0.0 0.1 0.2 0.3 0.4 0.5 0.6 u (m / s ) analyt tol. 106 tol. 104 (a) bingham fluid (asgs). 0.4 0.2 0.0 0.2 0.4 y (m) 0.1 0.0 0.1 0.2 0.3 0.4 0.5 0.6 u (m / s ) analyt tol. 106 tol. 104 (b) bingham fluid (oss). figur 7: bingham poiseuil flow streamwis veloc profil differ error indic tolerances. 14 ux (y) = 1 2p ( p x )(( h1 + h 2 )2 (h1 y)2 ) h 2 y < h1 = 0 ( p x )1 1 2p ( p x ) h21 h1 y < h2 = 0 ( p x )1 1 2p ( p x )(( h 2 h2 )2 (y h2)2 ) h2 y h2 uy = 0 (35) newtonian case, solut reduc parabol profil while, bingham case, flow yield region close wall, shear stress concentrated, central region move rigidly. central region constant streamwis veloc solv small error rel coars meshes. result, refin concentr close wall bingham case overal number element lower, observ fig. 5(b). confirm fig. 8, show final mesh obtain lowest toler oss formul newtonian bingham fluids. seen figure, spatial distribut refin differ cases, uniform newtonian fluid concentr close walls, correspond yield regions, bingham case. seen fig. 5(a), oss formul result roughli time element asg given tolerance. figure, observ that, small tolerances, refin fail start. seen fig. 5(b) asg simul toler 103m2s1 oss case toler 103m2s1 104m2s1, new element added. case produc solut close zero everywhere, yield region fail appear. fig. 6 observ good agreement analyt solut newtonian case, number element requir large, seen fig. 5(a). understand results, calcul effici chosen indicators. effici error indic ratio estim real error, case given by: = u uh u uh = ( e (u uh) (u uh) d )1/2 (36) u exact solution, given eq. (35), uh approxim finit element solution. interest compar global valu indic global error, comput sum squar valu element ig = ( e i2 )1/2 = ( e u uh2 )1/2 . (37) distribut effici index given solut step differ case shown fig. 9. observ that, newtonian asg case, effici far ideal valu 1. spite this, effici index tend larger area need refinement, exampl close border bingham cases, gradient solut larger. 15 (a) initi mesh. (b) newtonian fluid. (c) bingham fluid. figur 8: poiseuil flow refin mesh oss case error indic toler 106m2s1. 16 (a) newtonian fluid (asgs). (b) bingham fluid (asgs). (c) newtonian fluid (oss). (d) bingham fluid (oss). figur 9: poiseuil flow distribut effici index differ test cases. evolut global valu indic error, evalu accord eq. (37), case indic toler 106m2s1 present fig. 10. observ plots, error indic behavior true error, valu directli relat magnitud true error. explain gener behavior refin algorithm correct, effici index given case necessarili close one. 4.2 plane extrus simul plane extrus bingham fluid die 3 1 reduct cross-section. problem present [63] revisit [45], solv fix fluid mesh asg formul present section 2 [46, 64], simul oss stabilization. simul domain seen fig. 11, us symmetri problem simul half domain. slip boundari condit impos wall wall-norm compon veloc restricted. flow driven ram pressur appli left domain, gener pressur gradient. fluid paramet report tabl 1. argu [63], present settings, smooth wall small plastic viscosity, problem analog perfect plastic problem. 17 0 2 4 6 iter 103 102 101 100 m g n u d e indic error (a) newtonian fluid (asgs). 0 5 10 15 iter 104 103 102 101 100 m g n u d e indic error (b) bingham fluid (asgs). 0 5 10 15 iter 104 103 102 101 100 m g n u d e indic error (c) newtonian fluid (oss). 0 5 10 iter 104 103 102 101 100 m g n u d e indic error (d) bingham fluid (oss). figur 10: poiseuil flow global indic valu error differ test cases. 18 6 m 6 m 3 m 1 m symmetri slip wall slip walla figur 11: plane extrus geometri boundari conditions. paramet valu fluid densiti = 100 kg/m3 yield stress 0 = 1000 pa fluid viscos p = 10 6 pa s regular coeffici m = 1000 s tabl 1: plane extrus flow paramet problem. exact solut plastic problem, obtain slip line theory, report lublin [65]. solut predict format slip line appli pressur reach p = 4 3 ( 1 + 2 ) 0 3427 pa. (38) simul perform asg oss variant formulation. increas normal pressur appli left end domain increment 2 pa step, start 0 maximum valu pmax = 5000 pa. step, mesh refin algorithm im- prove mesh resolution, absolut toler error indic 106m2s1. light result previou example, set addit control, limit minimum area refin element 104 m2 prevent excess refin local regions. domain initi discret unstructur mesh compos 102 node 152 linear triangles. evolut strain rate refin mesh differ valu ram pressur oss case shown fig. 12. ram pressur increases, yield region character high strain rate develops, match slip line mechanism. finit element mesh refin accordingly, follow high strain rates. fig. 13 show evolut mesh size simul evolves. number element requir solv problem uniform low valu ram pressur yield zone develops. point, number element increas rapidli materi start flow. new element concentr yield regions, observ fig. 12, refin process continu yield region expands. mesh end simulation, correspond extern pressur 5000 pa, compos approxim 14500 node 28700 element oss test 15100 node 30100 element asg case. veloc fluid left boundari (measur point fig. 11) relat ram pressur fig. 14. valu yield pressur expect perfect plasticity, given eq. (38), indic fig. 14 dot line. observ veloc low pressur reach 19 0.72 0.613 0.507 0.4 0.293 0.167 0.08 (a) 0 pa (152 elements). (b) 3448 pa (2203 elements). (c) 3454 pa (3572 elements). (d) 3462 pa (9932 elements). (e) 3500 pa (19846 elements). (f) 3750 pa (23388 elements). (g) 4000 pa (24781 elements). (h) 4500 pa (27075 elements). figur 12: plane extrusion, oss case evolut strain rate (left) comput mesh (right) increas valu appli ram pressure. 20 0 1000 2000 3000 4000 5000 appli pressur 0 10 20 30 n u m . e le m e n ts ( 1 0 3 ) oss asg figur 13: plane extrus evolut number elements. 0.0 0.1 0.2 0.3 v eloc (m/s) 3100 3200 3300 3400 3500 3600 r m p r e s s u r e (p ) ossrefined. asgsrefined. ossuniform 30k elem. ossuniform 700k elem. p lastic solution. figur 14: plane extrus appli pressur vs. inlet velocity. roughli 3460 pa, materi start flow, acceler rapidly. chang correspond format yield zone extrus section, observ fig. 12. agreement expect behavior, materi start flow higher pressur predict perfect plastic theory. plastic theori predict yield p = 3427 pa, simul solut predict yield pressur rang p = 3450 3460 pa. sense, recal plastic solut correspond exactli problem, account presenc convect term equat fact regular constitut equat instead pure plastic behavior. evalu effect refin procedure, compar result obtain adapt mesh refin obtain uniform mesh size. numer settings, simul problem uniform triangular meshes. design contain 28000 elements, number close finest mesh refin procedure, predict yield p = 3540 3550 pa range. second mesh design element size similar small- est element produc refin procedur contain 700000 element predict yield p = 3460 3470 pa range, closer dynam refin result. velocitypressur relat case plot fig. 14. compar solut obtain adap- tive mesh refin produc compar number uniform size elements, observ adapt mesh refin posit effect qualiti solution, produc yield pressur closer obtain finer mesh. 21 100 101 102 103 bingham number 0.75 0.80 0.85 0.90 0.95 1.00 y / h reference. asg solution. oss solution. figur 15: 2d caviti flow vertic posit vortex center, compar result [66]. 4.3 caviti flow consid flow 2d caviti fill bingham fluid. problem set follow mitsouli zisi [66]. defin squar domain = (0, h) (0, h), impos horizont veloc ux = 1 m/ y = h zero veloc remain contour nodes. model configur leaki cavity, is, left right corner node fix horizont velocity. condit re-impos refin step, wall node immedi corner zero velocity, node exist previou iterations. fluid densiti set = 1 kg/m3 dynam viscos yield region p = 1 pa s. simul multipl case differ yield stresses, correspond rang valu bingham number, defin bn = 0h p ux . (39) regular coeffici set m = 300 s. again, start rel coars uniform mesh compos 2900 node 5600 triangular ele- ment solv problem iteratively, mesh refin phase solution. absolut toler error indic set 106m2s1 maximum 10 refin step allow origin ele- ment. rang bingham number considered, problem result singl recircul vortex interior cavity, develop closer wall bingham number increases. vertic posit vortex center differ case compar result report [66] fig. 15. result agreement reference, obtain slightli higher posit center higher bingham numbers. final distribut yield unyield region correspond veloc- iti streamlin shown fig. 16 oss simulations. number element obtain refin shown fig. 17 asg case fig. 18 oss cases. case, observ asg indi- cator result significantli larger number element given tolerance. caviti flow essenti 2d problem rang valu testing, simul 3d case order valid approach tetrahedra. geometri problem shown fig. 19 follow 22 (a) bn = 2. (b) bn = 20. (c) bn = 200. (d) bn = 5. (e) bn = 50. (f) bn = 500. figur 16: 2d caviti flow veloc streamlin distribut yield (light) unyield (dark) region oss simulations. 5 10 15 20 refin step 20 40 60 n u m . e le m e n ts ( 1 0 3 ) bn = 2. bn = 20. bn = 200. (a) bn = 2, 20, 200 5 10 15 20 refin step 10 20 30 40 50 n u m . e le m e n ts ( 1 0 3 ) bn = 5. bn = 50. bn = 500. (b) bn = 5, 50, 500 figur 17: 2d caviti flow evolut number element asg simulations. 23 5 10 15 20 refin step 4 6 8 10 12 14 16 n u m . e le m e n ts ( 1 0 3 ) bn = 2. bn = 20. bn = 200. (a) bn = 2, 20, 200 5 10 15 20 refin step 4 6 8 10 12 14 16 n u m . e le m e n ts ( 1 0 3 ) bn = 5. bn = 50. bn = 500. (b) bn = 5, 50, 500 figur 18: 2d caviti flow evolut number element oss simulations. x,uxz,uz y,ui ux=uy=uz=0 ux=1 uy=uz=0 ux=uy=uz=0 ux=uy=uz=0 uz=0 uz=0 figur 19: 3d caviti flow geometri veloc boundari conditions. definit elia et al. [67]. domain cube h = 1 m, veloc fix (ux, 0, 0) side. take y vertic axis, veloc set zero side cube normal flow. remain sides, parallel flow top, normal (z) compon veloc restricted. 3d case, us reynold number = 1 bingham number bn = 5. fluid paramet defin 2d case, fix veloc ux = 1m/ yield stress 0 = 5 pa. regular coeffici set m = 1000 s. given over-refin observ asg case, 3d simul perform oss. flow simul 10 solut steps, refin solution. start uniform tetrahedr mesh 30 divis edge, contain approxim 51000 node 277000 elements, final mesh 113000 node 612000 element obtained. final distribut yield unyield region veloc streamlin shown fig. 20. vortex center case place vertic posit y/h = 0.848, agreement 2d result shown fig. 15. 4.4 flow sudden expans final 3d test case, simul flow squar sudden expan- sion oss. problem studi [68, 69] herschel-bulklei fluid repres three-dimension version common planar ax- 24 figur 20: 3d caviti flow veloc streamlin distribut yield (light) unyield (dark) regions. isymmetr expans (see exampl [70, 71, 72]). cross section problem shown fig. 21 model flow differ geometries, correspond expans width ratio w/h = 2 w/h = 4. 5h 15h 2h 2w symmetri solid wall solid wall figur 21: sudden expans geometry. take account symmetri problem, fourth expans simulated, result comput domain shown fig. 22. no-slip boundari condit model solid walls, no- penetr condit set symmetri planes. flow driven pressur gradient impos inflow outlet section domain. problem solv reynold bingham number equal one, calcul h refer length refer veloc u0 defin [68] u0 = 1 p ( h p x 0 ) h, (40) p/x impos pressur gradient. appli extern pressur 10 increment load steps, refin iteration. load process finished, simul 5 extra step load ensur final solut requir addit re- finement. distribut yield unyield region differ section observ fig. 23 w/h = 2 expans fig. 24 w/h = 4 case. case exhibit qualit similar behavior, agreement result obtain references. far expansion, yield region appear close wall shear produc wall friction, core unyield materi remain center. close expansion, high veloc gradient develop flow adapt chang cross-sect 25 (a) w/h = 2 (b) w/h = 4 figur 22: sudden expans simul domains. a' b b' c c' (a) view. (b) aa (c) bb (d) cc figur 23: sudden expansion, w/h = 2 yield (dark) un- yield (light) regions. a' b b' c c' (a) view. (b) aa (c) bb (d) cc figur 24: sudden expansion, w/h = 4 yield (dark) un- yield (light) regions. 26 2 4 6 8 10 12 14 step 0 100 200 300 400 500 600 700 n u m . e le m e n ts ( 1 0 3 ) w/h = 2 w/h = 4 figur 25: sudden expans evolut number element simulation. (a) initi mesh. (b) final mesh. figur 26: sudden expansion, w/h = 2 view comput meshes. (a) initi mesh. (b) final mesh. figur 27: sudden expansion, w/h = 4 view comput meshes. central core yield completely. corner expans region stationari unyield materi appears, unaffect main flow. previou cases, simul initi uniform tetrahe- dral mesh, compos approxim 5000 node 22000 element w/h = 2 case 10000 node 53000 element w/h = 4 case. evolut number element solut shown fig. 25. number element grow appli pressur gradient increas stabil load process finishes, result final grid 106000 node 596000 element w/h = 2 case 123000 node 694000 element w/h = 4 expansion. initi final mesh expans case shown fig. 26 w/h = 2 test fig. 27 w/h = 4 case. observ refin area coincid yield regions, higher veloc gradient gener found: close solid wall expans section. 5 conclud remark present vm finit element formul non-newtonian flow problems. error indic base scale separ introduc vm methods, combin formul mesh refin procedur obtain solver adapt mesh refinement. chosen mesh 27 refin strategy, base edg splitting, work triangular tetrahedr meshes, allow simul 2d 3d problems. approach solv multipl benchmark exampl literature, start uniform, rel coars mesh let refin procedur increas mesh resolut region interest. result suggest us adapt mesh refin help obtain good qualiti solut start mesh suffici resolution. valid procedur allow identifi issu propos error indicator, particular evalu effici section 4.1. indic tend larger area larger error, valu directli relat magnitud error, ratio quantiti appear problem-dependent. introduc difficulti choos toler error indicator, magnitud estim immedi deduc quantiti interest. notably, understood maximum admiss local error. practice, introduc potenti over- under-refin issues, indic toler difficult set priori. observ section 4.3, where, fix tolerance, us asg indic result significantli element oss simulation, littl effect accuraci obtain solution. step mitig issu introduc control minimum element size allowed, ensur refin procedur stop. view issues, obviou venu improv test refin approach indicators. refin procedur independ choic indicator, straightforward modification. addition, refin procedur extend complex geometries, quadrilater hexahedr elements, intro- duce split pattern geometries. similarly, introduc node split edge, scheme higher order elements. note that, limit test bingham flow problems, present formul directli applic fluid yield, particular straightforward us gener herschel bulklei model. venu futur work applic present solver time-depend problems. oss formul extend (fix mesh) dynam problem [46] refin procedur set evolv turbul flow [16]. however, note reference, expand adapt refin procedur allow possibl coarsen mesh respons small valu error indic welcom addit context. allow refin area accord evolut flow, optim number element simulation. finally, us regular formul rais question de- serv investigation. necessari elimin singular bingham law acceler converg method solution, reg- ular introduc error solution, independ mesh error indicator. gain better understand fact open door improv approach, valu regular paramet m adjust adapt procedure. 28 acknowledg author gratefulli acknowledg support spanish ministe- rio educacion doctor grant fpu program. research partial support spanish ministri economi competitive- ness (ministerio economa y competitividad, mineco) project eaci (mat2013-48624-c2-1-p). financi support erc advanc grant project safecon (adg-267521) european research council t-mappp project (fp7 peopl 2013 itn-g.a.n607453) greatli acknowledged. refer [1] carei gf. comput grids: generations, adapt & solut strategies. crc press, 1997. [2] ainsworth m, oden jt. posteriori error estim finit element analysis. john wilei & sons, ltd, 2000. [3] babuska i, rheinboldt wc. error estim adapt finit element computations. siam journal numer analysi 1978; 15(4):736754, doi:10.1137/0715049. [4] babuska i, rheinboldt wc. a-posteriori error estim finit ele- ment method. intern journal numer method engin 1978; 12(10):15971615, doi:10.1002/nme.1620121010. [5] ainsworth m, oden jt. posteriori error estim finit element analysis. method appli mechan engin 1997; 142(12):1 88. [6] john v. numer studi posteriori error estim convection- diffus equations. method appli mechan engi- neer 2000; 190(5-7):757 781. [7] papastavr a, verfurth r. posteriori error estim station- ari convection-diffus problems: comput comparison. method appli mechan engin 2000; 189(2):449 462. [8] saramito p, roquet n. adapt finit element method viscoplast fluid flow pipes. method appli mechan engi- neer 2001; 190(4041):5391 5412. [9] roquet n, saramito p. adapt finit element method bingham fluid flow cylinder. method appli mechan engin 2003; 192(31-32):3317 3341. [10] roquet n, saramito p. adapt finit element method viscoplast flow squar pipe stick-slip wall. journal non-newtonian fluid mechan 2008; 155(3):101 115. 29 [11] bernabeu n, saramito p, smutek c. numer model non-newtonian viscoplast flows: ii. viscoplast fluid gener tridimension topographies. intern journal numer analysi model jan 2014; 11(1):213228. dedic professor francisco j. lisbona occas 65th birthday. [12] boussetta r, coupez t, fourment l. adapt remesh base posteriori error estim forg simulation. method appli mechan engin 2006; 195(4849):6626 6645, doi: comput metal form- ing. [13] hugh tjr. multiscal phenomena: green functions, dirichletto neumann formulation, subgrid scale models, bubbl origin sta- biliz methods. method appli mechan engin 1995; 127(1-4):387401. [14] hugh tjr, feijoo gr, mazzei l, quinci jb. variat multiscal methoda paradigm comput mechanics. method appli mechan engin 1998; 166(1-2):324. advanc sta- biliz method comput mechanics. [15] hauk g, doweidar mh, miana m. multiscal approach error esti- mation adaptivity. method appli mechan en- gineer 2006; 195(13-16):15731593. tribut thoma j.r. hugh occas 60th birthday. [16] rossi r, cotela j, lafontain nm, dadvand p, idelsohn sr. parallel adap- tive mesh refin incompress flow problems. comput & fluid 2013; 80(0):324 355. [17] hauk g, fuster d, lizarraga f. variat multiscal posteriori error estim systems: euler navier-stok equations. method appli mechan engin 2015; 283:1493 1524. [18] perair j, vahdati m, morgan k, zienkiewicz oc. adapt remesh compress flow computations. journal comput physic 1987; 72(2):449 466. [19] lohner r. adapt remesh transient problems. method appli mechan engin 1989; 75(13):195 214. [20] selmin v, formaggia l. simul hyperson flow unstructur grids. intern journal numer method engin 1992; 34(2):569606. [21] zienkiewicz oc, wu j. automat direct refin adapt anal- ysi compress flows. intern journal numer method engin 1994; 37(13):21892210. [22] chiandussi g, bugeda g, onat e. simpl method automat up- date finit element meshes. commun numer method engin 2000; 16(1):119. 30 [23] sieger d, menzel s, botsch m. rbf morph techniqu simulation- base design optimization. engin comput 2014; 30(2):161 174. [24] hachem e, feghali s, codina r, coupez t. anisotrop adapt mesh monolith variat multiscal method fluidstructur interac- tion. comput & structur 2013; 122(0):88 100. comput fluid solid mechan 2013 proceed seventh mit confer com- putat fluid solid mechanics. [25] cotela dalmau j. applic turbul model civil engineerng. phd thesis, universitat politecnica catalunya 2016. [26] bingham ec. fluiditi plasticity. mcgraw-hill, 1922. [27] oldroyd jg. ration formul equat plastic flow bingham solid. mathemat proceed cambridg philosoph societi 1 1947; 43:100105. [28] duvaut g, lion jl. inequ mechan physics. springer-verlag berlin heidelberg, 1976. [29] glowinski r. numer method nonlinear variat problems. springer, 1984. [30] huilgol r. fluid mechan viscoplasticity. springer, berlin heidelberg, 2015. [31] dean ej, glowinski r, guidoboni g. numer simul bing- ham visco-plast flow: old new results. journal non-newtonian fluid mechan 2007; 142:3662. [32] huilgol r, z. prolegomena variat inequ numeri- cal scheme compress viscoplast fluids. journal non-newtonian fluid mechan 2009; 158:113126. [33] huilgol rr, kefayati ghr. natur convect problem bingham fluid operator-split method. journal non-newtonian fluid me- chanic 2015; 220:2232. [34] sanchez fj. applic first-ord oper split method bing- ham fluid flow simulation. comput & mathemat applic 1998; 36 (3):7186. [35] glowinski r, tallec pl. augment lagrangian operator-split method nonlinear mechanics. siam, philadelphia, 1989; . [36] zhang j. augment lagrangian approach bingham fluid flow lid-driven squar caviti piecewis linear equal-ord finit elements. method appli mechan engin 2010; 199:3051 3057. [37] bercovi m, engelman m. finite-el method incompress non- newtonian flows. journal comput physic 1980; 36(3):313 326. 31 [38] tanner ri, milthorp jf. numer simul flow fluid yield stress. numer method laminar turbul flow, taylor c, johnson ja, smith wr (eds.), pineridg press, 1983; 680690. proceed intern conference, seattle. [39] papanastasi tc. flow materi yield. journal rheologi (1978-present) 1987; 31(5):385404. [40] souza mend pr, dutra ess. viscos function yield-stress liquids. appli rheologi 2004; 14(6):296302. [41] mitsouli e. flow viscoplast materials: model computations. rheologi review 2007., british societi rheology, 2007; 135178. [42] frigaard ia, nouar c. usag viscos regularis method visco-plast fluid flow computation. journal non-newtonian fluid mechan 2005; 127(1):1 26. [43] codina r. stabil finit element approxim transient incompress- ibl flow orthogon subscales. method appli me- chanic engin 2002; 191(39-40):4295 4321. [44] codina r. stabil finit element method gener stationari incompress flows. method appli mechan engi- neer 2001; 190(20-21):2681 2706. [45] lares a. coupl eulerian-pfem model simul overtop- ping rockfil dams. phd thesis, universitat politecnica catalunya. upc barcelonatech 2012. [46] moreno e, lares a, cervera m. model bingham herschel bulklei flow mix p1/p1 finit element stabil orthogon subgrid scale. journal non-newtonian fluid mechan 2016; 228:1 16. [47] rossi r, lares a, dadvand p, onat e. effici edge-bas level set finit element method free surfac flow problems. intern journal numer method fluids, doi: 10.1002/fld.3680 2013; 71 (6):687 716. [48] lares a, rossi r, oat e. finit element model free surfac flow variabl poros media. archiv numer method engin doi: 10.1007/s11831-014-9140-x 2014; . [49] moreno e, cervera m. elemento finito mixto estabilizado para flujo confinado bingham y herschelbulklei part i: formulacion. revista internacion metodo numerico para calculo y diseno en ingeniera 2015; press. [50] tezduyar t. stabil finit element formul incompress flow computations. advanc appli mechan 28, hutchinson jw, wu ty (eds.). elsevier, 1991; 1 44. 32 [51] hugh tjr, franca lp, hulbert gm. new finit element formul comput fluid dynamics: viii. galerkin/least-squar method advective-diffus equations. method appli mechan engin 1989; 73(2):173189. [52] zienkiewicz oc, zhu jz. simpl error estim adapt pro- cedur practic engineerng analysis. intern journal nu- meric method engin 1987; 24(2):337357, doi:10.1002/nme. 1620240206. [53] dorfler w. converg adapt algorithm poisson equation. siam journal numer analysi 1996; 33(3):11061124, doi:10.1137/ 0733054. [54] nochetto rh, siebert kg, veeser a. multiscale, nonlinear adapt approximation. multiscale, nonlinear adapt approximation: dedi- cate wolfgang dahmen occas 60th birthday, devor r, kunoth (eds.). chap. theori adapt finit element methods: in- troduction, springer berlin heidelberg: berlin, heidelberg, 2009; 409542, doi:10.1007/978-3-642-03413-8 12. [55] frei pj, georg pl. mesh generation: applic finit elements. 2nd edn., john wilei & sons, ltd, 2008. [56] damato jp, vener m. cpugpu framework optim qual- iti larg meshes. journal parallel distribut comput 2013; 73(8):1127 1134. [57] dadvand p, rossi r, gil m, martorel x, cotela j, juanper e, idelsohn sr, onat e. migrat gener multiphys framework hpc en- vironments. comput & fluid 2013; 80(0):301 309. [58] lares a, rossi r, onat e, toledo m. physic numer modeliza- tion behavior rockfil dam overtop scenarios. dam mainten rehabilit ii. crcpress balkema. isbn:978-0-415- 61648-5 2010; :479487. [59] lares a, rossi r, onat e, idelsohn s. coupl pfem-eulerian ap- proach solut porou fsi problems. comput mechanics, doi: 10.1007/s00466-012-0768-9 2012; 50 (6):805819. [60] lares a, rossi r, onat e, toledo m, moran r, campo h. numer experiment studi overtop failur rockfil dams. interna- tional journal geomechan (asce) 2013; :10.1061/(asce)gm.1943 5622.0000 345. [61] demidov d, shevchenko d. modif algebra multigrid effect gpgpu-bas solut nonstationari hydrodynam problems. journal comput scienc 2012; 3(6):460 462, doi: 1016/j.jocs.2012.08.008. gener comput scientists: rus- sian federation. 33 [62] moreno e. elemento finito mixto estabilizado para flujo viscoplasticos. phd thesis, universitat politecnica catalunya. upc barcelonatech 2014. [63] peric d, slijepcev s. comput model viscoplast fluid base stabilis finit element method. engin comput 2001; 18(3/4):577591. [64] moreno e, cervera m. elemento finito mixto estabilizado para flu- jo confinado bingham y herschelbulklei part ii: solucion numericas. revista internacion metodo numerico para calculo y diseno en ingeniera 2015; press. [65] lublin j. plastic theory. macmillan publish company: new york, 1990. [66] mitsouli e, zisi t. flow bingham plastic lid-driven squar cavity. journal non-newtonian fluid mechan 2001; 101(13):173 180. [67] elia r, martin m, coutinho a. parallel edge-bas solut viscoplast flow supg/pspg formulation. comput mechan 2006; 38(4-5):365381. [68] burgo gr, alexandr an. flow develop herschelbulklei fluid sudden threedimension squar expansion. journal rheologi 1999; 43(3):485498. [69] alexandr an, mcgilvreai tm, burgo g. steadi herschelbulklei fluid flow three-dimension expansions. journal non-newtonian fluid me- chanic 2001; 100(13):77 96. [70] sheen hj, chen wj, wu js. flow pattern annular flow axisymmetr sudden expansion. journal fluid mechan 11 1997; 350:177188. [71] alleborn n, nandakumar k, raszilli h, durst f. contribut twodimension flow sudden expansion. journal fluid me- chanic 1 1997; 330:169188. [72] mitsouli e, huilgol rr. entri flow bingham plastic expan- sions. journal non-newtonian fluid mechan 2004; 122(13):45 54. xiiith intern workshop numer method non-newtonian flows. 34 1 introduct 2 non-newtonian flow solver 2.1 govern equat 2.2 weak formul 2.3 matrix formul 3 mesh refin strategi 3.1 error estim 3.2 refin algorithm 4 numer result 4.1 poiseuil flow 4.2 plane extrus 4.3 caviti flow 4.4 flow sudden expans 5 conclud remark