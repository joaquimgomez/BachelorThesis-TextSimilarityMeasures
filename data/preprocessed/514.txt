high-perform model reduct techniqu comput multiscal homogen j.a. hernandeza,c,, j. olivera,b, a.e. huespeb,d, m.a. caicedoa, j.c. cantea,c acentr internacion metod numer en enginyeria (cimne), technic univers catalonia, edificio c1, campu norte, jordi girona 1-3, barcelona 08034, spain be.t.s. denginy camins, canal ports, technic univers catalonia, edificio c1, campu norte, jordi girona 1-3, barcelona 08034, spain ce.t.s. denginyeri industri aeronautica terrassa, technic univers catalonia, c/ colom, 11, terrassa 08222, spain dcimec, conicet, guem 3450, 3000 santa fe, argentina abstract novel model-ord reduct techniqu solut fine-scal equilibrium problem appear comput homogen presented. reduc set empir shape function obtain partit version account elastic/inelast charact solut proper orthogon decomposit (pod). hand, shown standard approach replac nonaffin term interpol construct pod mode lead ill-pos formula- tions. demonstr ill-posed avoid enrich approxim space span gradient empir shape functions. furthermore, interpol point chosen guided, accuraci requirements, stabil considerations. approach assess homogen highli complex porou metal material. comput result comput complex independ size geometr complex repres volum element. speedup factor order magnitud compar finit element analysi maximum error stress 10%. correspond author email address: (j.a. hernandez) preprint submit comput. method appl. mech. engrg. march 19, 2014 keywords: multiscale, homogenization, model reduction, high-perform reduced-ord model, hyperreduction, pod 1. introduct 1.1. motiv goal major challeng macro-scal continuum descript het- erogen materi composit polycrystallin metal (that exhibit clear heterogen composit micro-, meso-, scale, regarded, practic purposes, homogen macro-scale) li determin constitut connection, macro-stress macro-strains, accur reflect properti geometr arrang distinct phase finer scale. well- known [34] that, hypothes period statist ho- mogeneity, hand; scale separation, hand, constitut link systemat establish solving, point coars scale, boundari valu problem (bvp) certain represen- tativ microscop subdomain. strain-driven formul bvp, macro-strain given point act load parameter, form appropri essenti boundari conditions, associ macro- stress obtain volum averag i.e., homogen correspond micro-stress field. method deal solut bvp rang pure ana- lytic approach direct comput methods, two-level, fi- nite element (fe2) method [29]. analyt approach computation inexpensive, valid certain type geometr constitu- tive simpl micro-structures. contrast, direct comput method limit scope impos aforement hypothes statist homogen scale separ meth- ods, microscop bvp coarse-scal point attack approxim spatial discret pertin solut strategy, thus, circumv need introduc ad-hoc, simplifi as- sumption topolog arrang micro-phas and/or collect constitut behavior. needless say, versatil di- rect comput homogen come signific price: enorm comput cost. 2 extrem (pure analyt direct comput methods), homogen strategi term semi- analytical, combin analyt result numer computa- tions. case transform field analysi (tfa) [25] variant thereof [49, 50, 56, 30], base pre-comput certain characterist oper (strain local influenc tensors) inform obtain solv carefulli chosen batteri fine-scal bpvs. method notabl widen scope classic analyt approach maintain low computa- tional cost, predicated, lesser greater extent, ad-hoc assumpt connect constitut descript in- volv phases. consider new materi unstudi composit semi-analyt approaches, thus, requir addit research effort specialist field eventu modif correspond mathemat numer formul contrast direct computa- tional homogen approaches, fe2 method, formul material-independent, versatile. current state affair field two-scal homogen call, thus, unifi homogen approach combin some- advantag direct comput homogen analyt semi-analyt techniques. desir homogeniza- tion method comput cost virtual independ geomet- ric complex consid repres volume, analyt semi-analyt techniques. time, interest arriv method mathemat formul dispens ad-hoc, simplifi assumpt relat composit heterogen material; i.e, enjoi versatility, unrestrict applic user- friendli insofar total reliev model exceedingli difficult task visual assumpt direct compu- tation homogen methods. goal present paper desir attribut achieved, arbitrarili complex het- erogen materi inelast range, so-cal [47] reduced-basi (rb) approxim solut fine-scal bvps. 1.2. reduced-basi method gener speaking, reduced-basi approxim class ofgalerkin approxim procedur employs, oppos fe method, 3 similarli classic rayleigh-ritz solut techniqu [19], global sup- port basi functions. main differ respect classic rayleigh- ritz scheme basi function mode construct polynomi transcendent function (sines, cosin ...), determin larger set previous comput finit element (fe) method classic solut techniqu solut bvp appropri select valu input interest. function commonli term empir basi function [41], qualifi empir mean deriv comput experiments. 1.2.1. dimension reduct note earlier, input load paramet fine- scale problem macro-scal strain tensor. accordingly, start point construct basi function consist solving, fe method, batteri bvp various, repres macro-strain histories. outcom fe calcul data set compris ensembl thousand (depend number time step strain histori discretized) displac field solut (also call snapshots). snapshot bare correl other, dimens manifold span prove overli high, render- ing entir approach impract longer qualifi truli reduc basi method. fortunately, present paper, gen- eral, snapshot displai strong linear correl i.e., redund information, and, addition, con- tain deform mode irrelev qualiti coarse-scal predictions. requir obtain lower dimension repre- sentat solut data set, therewith desir reduc basis, automat mean identifi remov redund irrelev in- formation, preserving, possible, essenti features. problem remov unnecessari complex huge data set uncov domin pattern central concern disciplin dig- ital imag compress [60] patter recognit [8], few, effici dimension reduct (or data compression, common parlance) algorithm exist deal it. present work, emploi simplest popular di- 4 mension reduct algorithms: proper orthogon decomposition1 (pod). infer propos homogen method, like analyt semi-analyt strategies, introduc sim- plific solv fine-scal bvp. however, oppos analytical, lesser extent, semi-analyt procedures, simplif introduc modeler, automat carri abovement dimension reduct method (in offlin stage, prior overal multiscal analysis). words, propos method, task discern essenti not2 entir deleg itself, hence, success depend depth insight, experience, knowledg base model discret exercis choos appropri strain path offlin fe analyses. featur natur confer advantag versatil user-friendli enjoi direct comput methods. 1.2.2. numer integr global shape function determined, step introduc effici method numer evalu integr appear weak form cell bvp. cours simpli us gauss quadratur formula sampl point (a total number ng = o(n), n number mesh nodes) underli finit element model. akin integrating, say, third- order polynomi function thousand sampl pointsa proflig wast comput resources. displac solut cell bvp constrain lie reduced-ord space dimens nu << n, reason expect correspond stresses, intern forc jacobian resid reduced-ord space dimens order o(nu), consequently, p = o(nu) << ng sampl point suffic principl accur evalu correspond integrals. challeng question confront locat p sampl point and, loos speaking, determin associ 1by constrain cell deform deform mode determin pod, automat obtain genuin reduced-ord model (rom) cell. 2discern essenti is, accord m.ashbi [4], kei success comput model (i.e., strike right balanc accuraci simplicity) 5 weight function maximum accuraci integr attained. approach model reduct literatur that, directli indi- rectly, deal fundament question broadli classifi interpolatori method [7, 33, 54, 18, 5] gauss-typ quadratur strategi [3, 39]. type approaches, integrand integrand approxim linear combin reduc set empir modes. interpolatori approaches, coeffici approxim ob- tain interpol set pre-select sampl points; criterion choos locat point minim interpo- lation error finit element snapshots. gauss-typ quadratur procedures, hand, select sampl point cal- culat accompani weight factor simultan carri out, guid criterion minimum integr error snapshots. bvp consideration, output volum av- erag stress cell domain and, therefore, accuraci requir integr equilibrium equation, ap- proxim stress themselves. reason attent focus interpolatori integr strategies, variabl subject spatial interpol precis stresses. 1.3. origin work idea exploit synergist combin multiscal model- ing reduc basi approxim admittedli new. specif context two-scal homogenization, recent explor boy- aval [10], yvonnet et al. [62], monteiro et al. [51]. trace idea articl deal gener hierarch multi- scale techniqu presuppos scale separ peri- odicity/statist homogeneity, both, namely, multiscal finit element method [53, 26, 27], heterogen multiscal method [2, 1], multiscal approach base proper gener decomposi- tion (pgd)[21]. however, note cite paper confront previous described, crucial question effi- cientli integr result reduced-ord equations, simpli because, [10, 53, 26, 27, 2, 1], integr issu fine-scal bvp address work bear affin relat correspond coarse-scale, input parameter, linear elasticity, and, consequently, integr pre-computed, i.e., evalu offline, impact onlin comput cost. thus, develop reduced-ord model 6 endow efficient, mesh-siz independ integr scheme abl handl materi composit research area that, best author knowledge, remain uncharted. 1.3.1. main origin contribut theori underli reduced-ord model (roms) incorpor effici interpolatori integr scheme embryon stage develop gener propos parametr bvp date 2004 [7] fundament issu remain addressed. fore- crucial question well-posed result algebra equations: replac integrand, non- affin term integrand, reduced-ord interpol lead well-posed, discret problem ? examin reduc basi literatur indic appar research far confront ill- pose reduced-ord equations, fact certainli promot view uniqu solut taken grant full-ord model well-posed. unfortunately, so: demonstr paper choic reduced-ord space interpol integrand resid profound impact well-posed discret problem. particular, that, case fine-scal boundary-valu problem, wide adopt [33] approach determin basi function space (converged) fe snapshot lead in- variabl ill-posed, discret formulations. main origin contribut present work field reduced-ord model develop interpolatori integr method safe overcom type ill- posedness. gist method expand interpol space embraces, asid span pod stress basi functions, space gener li novelti gradient (reduced-order) shape functions. furthermore, shown that, contrast situat encount standard interpolatori scheme parametr bvp [33], bvp consideration, number particular placement sampl point integr domain influenc notabl spectral properti (posit definiteness) jaco- bian matrix govern equation, therefore, converg charac- terist accompani newton-raphson solut algorithm. innov ingredi present paper point select algorithm acknowledg peculiar choos desir sampl point guided, accuraci requir (minim interpol 7 error fe stress snapshot), stabil considerations. 2. rve equilibrium problem section, present variat statement finit element discret fine-scal equilibrium problem, which, recall, pa- rameter bvp wish effici solv reduced-basi approx- imation. 2.1. preliminari let rd (d = 2, 3) subvolum characterist length l << lm ( lm characterist length macro-continuum m , figur 1) repres heterogen materi whole. micro- structur exhibit statist homogeneity, domain receiv repres volum element (rve), micro-structur displai periodicity, commonli known repeat unit cell (ruc), simpli unit cell [24]. sequel, acronym rve refer . m w ( )w m l m 1 ( )d v m x w = w m l l<< m x x ( ) x macro-strain (input) macro-stress (output) rve cell cell equilibrium problem figur 1: first-ord homogenization. homogen approach adopt work commonli known first-ord homogen [32, 40], strain field (x) point x assum decompos macroscop fluctuat contri- butions; hypothesi infinitesim deformations, decomposi- tion written as: (x) = m +su(x). (1) 8 here, m stand 3 macroscop strain tensor (the input paramet problem) su denot symmetr gradient displac fluctuat field (thi field is, turn, basic unknown problem). implicit scale separ assumpt fact fine-scal de- format influenc coarse-scal behavior volum averag rve. shown (see, instance, ref. [22]) im- pli boundari condit (bcs) prescrib rve homogen (i.e., a0u = 0 , a0 certain linear operator). natur choic repeat unit cell emploi period boundari condit (see refs. [9, 48] detail prescrib type bcs). statist homogen micro-structures, contrast, certain latitud choic boundari condit (vanish fluctuations, uniform tractions, quasi-period condit . . . ). exampl shown later, vanish boundari condit (u = 0 ). 2.2. variat formul 2.2.1. trial test space trial space, i.e., set kinemat admiss displac fluc- tuation fields, defin formal vu = { u h1()d | a0u = 0, } , (2) h1()d stand sobolev space function possess squar integr deriv . note set form vector space. test function appear variat statement shown follow kinemat admiss variat ( := u v, u,v vu), vu have structur vector space impli that, rve equilibrium problem, space trial test function coincide. 2.2.2. formal statement consid time discret interv [t0, tf ] = nstp n=1[tn, tn+1]. current valu microscop stress tensor n+1 x pre- sume entir determin by, hand, current valu 3macroscop variabl identifi append subscript m, variabl associ fine scale design bare symbols. instance, shall write m (x) denot macroscop strain tensor fine-scal strain field, respectively. 9 microscop strain tensor n+1(x) = mn+1 +sun+1(x), and, hand, set microscop intern variabl n+1 encapsul his- tori microscop deformations. relationship variabl establish (phenomenological) rate constitut equations; equa- tion vari point point rve (multiphas materials). likewise, consid rve contain void distribut domain. (incremental) rve equilibrium problem time tn+1 state follow (see ref. [22]): given initi data {un(x), mn, n(x)} prescrib macroscop strain tensor mn+1, un+1 vu s : n+1(mn+1 +sun+1, n+1) d = 0, (3) vu. actual output fine-scal bvp displac fluctuat field se, macroscop stress tensor m |n+1, defin volum averag rve microscop stresses: m |n+1 := 1 v n+1 d, (4) v stand volum rve. order notat uncluttered, superindex n+1 drop quantiti assum evalu time tn+1; confus apt up, pertin distinct introduced. 2.3. finit element formul let = ne n=1 e finit element discret rve. assum discret fine consid exact fe approxim solut indistinguish accuraci level inter- est. let {n1(x), n2(x) . . .nn(x)} (n denot number node discretization) set shape function associ discretization. approxim u vu vu u(x; m ) u(h)(x; m) = n i=1 ni(x)u i(m ), (5) (x) (h)(x) = n i=1 ni(x)i , (6) 10 u rd rd (i = 1, 2 . . . n) denot nodal valu displac fluctuat test functions, respectively. insert approxim eq.(3), exploit arbitrari coeffici (i = 1, 2 . . . n), arriv follow set discret equilibrium equa- tion (repeat indic impli summation): ni xj ij(m +su(h), ) d = 0 (i = 1 . . . d; = 1 . . . n). (7) introduc voigt notation4, equat express matrix format as: b t (m +bu , ) d = 0, (8) usual, numer evalu integr eq.(8) carri gaussian quadrature: b t d ng g=1 wgb t(xg)(xg, ; ) = 0. (9) here, ng = o(n) stand total number gauss point mesh; wg denot weight associ g th gauss point xg (thi weight includ quadratur weight correspond jacobian determinant.); b(xg) (xg, ; ) stand b-matrix stress vector gauss point xg, respectively. 3. comput reduc basi basic, intuit pictur strategi comput reduc basi project rve equilibrium equat (3) given introductori section. following, idea strategi rigor footing. begin note that, func- tional analysi standpoint, term model reduct conceptu akin 4here, conveni us so-cal modifi voigt notat standard one. modifi voigt notation, stress strain tensor repres column vector ({} {}, respect ) shear compon multipli 2. advantag notat conventional, engin voigt notat equival norms; viz., = : = {} = {}t {}. reader urg consult [20] detail notation. 11 common term model discretization, connot transi- tion higher-dimension lower-dimension solut spaces. model discret refer (classical) passag infinit dimension space vu finit element subspac vhu vu, model reduct denot transit finit dimension space vhu significantli smaller manifold vu vhu reduced-ord space. transit carri directly, sequenti steps, namely, sampl input paramet space dimension reduction. 3.1. sampl input paramet space construct finit element space kinemat admiss func- tion vhu , restrict place motion mesh node impos boundaries. finit element solut space, thus, presuppos constraint motion interior node mesh. however, actuality, interior node fluctuat freely, indepen- dentli other, accord deform pattern dictat constitut law govern mechan behav- ior distinct phase rve5. mean solut finit element equilibrium equat (3) given valu macro-strain tensor m actual live smaller subspac vu vhu (in parlanc model reduct [47, 57], vu manifold induc parametr depend bvp input variables). yet, general, subspac precis determined; content construct approxim span displace- ment fluctuat solut obtain judici chosen set nhst input strain histori { tm 1, tm 2, . . . tm nhst}. suppose, simplicity, strain histori discret equal number step nstp, let uk(x) = u(x; tm j i), k = (i 1)nhst + j (10) denot displac fluctuat solut j th time step th strain histori (i = 1, 2 . . . nhst, j = 1, 2 . . . nstp). approxim space vu, henceforth call snapshot space, defin as: 5a note lublin [45], constitut law regard intern restrict kind deform bodi suffer 12 vsnpu = span { u1(x),u2(x), . . .unsnp(x) } vu, (11) nsnp = nstpnhst total number snapshots. matrix containing, columns, nodal valu displac fluctuat solutions: xu = [ u 1 u 2 unsnp ] rndnsnp (12) correspondingli term (displac fluctuations) snapshot ma- trix. 3.2. dimension reduct definit step transit high-dimension finit element space vhu desir reduced-ord space vu fine-scal bvp final pose dimension reduct process, which, point introductori section, domin deform pattern rve respons identifi unveil wash inessentials. accomplish central task, emploi partit version proper orthogon decomposition6. 3.2.1. elastic/inelast reduc basi function proper orthogon decomposit multidimension data fit procedur intend obtain sequenc orthogon basi func- tion span best approxim space snapshots. such, pod pure data-driven process agnost physic origin data. instance, pod basi construct purposes, complet immateri given snapshot correspond pure linear elast solut solut inelast regime. task discrimi- nate featur rve respons essenti exclus guid statist considerations: elast respons hap- pen poorli repres snapshot ensemble, pod regard unimport contribut snapshots, and, conse- quence, basi function largest associ singular valu i.e., essenti mode hardli contain inform range. accur replic appar trivial linear elast behavior, thus, forc rel larg number basi functions, 6see appendix brief descript pod. 13 translat signific increas overal onlin comput cost. fact certainli place pod-bas reduc basi approach competit disadvantag compar semi-analyt homogen approach nonlinear transform field analysi [50], captur exactli (and effortlessly) linear elast respons rve. elimin shortcoming, propos slightli differ strat- egi construct reduc basis. essenc propos partit space snapshot vsnpu elast (v snp u,el) inelast (v snp u,inel) subspaces: vsnpu = v snp u,el v snp u,inel, (13) ( symbol direct sum subspac [55]) obtain reduc basi union base subspaces. below, strategi detail. step determin orthogon basi vsnpu,el . simpli perform independent, linear elast finit element analysi rve (me = 6 3d problem 7, = 3 plane strain), orthonorm result displac fluctuat fields. elast mode consid basi function reduc basis: span{1,2, . . . ,me} = v snp u,el . (14) dispos set elast basi functions, comput (orthogonal) project snapshot uk orthogon comple- ment vsnpu,el (which precis aforement inelast space v snp u,inel): ukinel := u k i=1 i,u k l2() i, k = 1, 2 . . . nsnp. (15) ensembl inelast snapshot {ukinel} nsnp k=1 pre- viousli describ pod appli obtain remain nu basi functions. thus, final have: vu = v snp u,el v snp u,inel = span{ elast mode 1,2, . . . ,6, essenti inelast mode 7, . . . ,nu }. (16) 7strictli speaking, propos decomposit valid materi govern rate-independ constitut equations. 14 3d problems, vu = span{ elast mode 1,2,3, essenti inelast mode 4, . . . ,nu }. (17) plane strain. place elast mode posi- tions, reduced-ord model guarante deliv linear elast solut accuraci underli (full-order) finit element model (obviously, provid nu me). detail concern numer implement appar- entli novel best author knowledg basi construct strategi appendix b. 4. galerkin project reduc subspac seek pose boundary-valu problem repres eq.(3) reduced-ord space vu vhu span basi function {1,2, . . . ,nu}. end, approxim test vu trial u vu function follow linear expansions: u(x; m ) u(x; m) = nu i=1 i(x)u (m ), (18) (x) (x) = nu i=1 i(x) , (19) u(x) (x) low-dimension approxim trial test functions, respect (hereafter, asterisk symbol denot low-dimension approxim associ variables). insert eqs. (18) (19) eq.(3), exploit arbitrari coeffici (i = 1, 2 . . . nu), arriv follow set nu equilibrium equations: si(x) : (x; m +su, ) d = 0, = 1, 2 . . . nu. (20) express reduc basi function equat term finit element shape function (through express i(x) = n i=1ni(x)ii), (in voigt notation): b t (x)(x; m +b u , ) d = 0, = 1, 2 . . . nu, (21) 15 compactly: b t(x)(x; m +b u , ) d = 0. (22) here, u = [ u1 u 2 unu ]t rnu denot vector contain reduc displac fluctuat basic unknown reduced-ord problem b : rsnu stand reduc b-matrix, defin as: b (x) := b(x). (23) matrix connect gradient displac fluctuat field vector reduc displac fluctuations: su = nu i=1 b iu = b [ b 1 b 2 . . . b nu ] u u1 u2 ... unu = bu = bu . (24) implement purposes, expedi express eq.(23) term element bmatrices. end, write: b(x) = { b e(x), ifx e 0, (25) rsdne denot local b-matrix element e (ne, turn, number node e). thus, b (x) = b(x) = be(x)e. (26) equation, e rdnenu repres block matrix corre- spond ne node finit element e (e = 1, 2 . . . ne). 5. stress approxim space arriv efficient, mesh-siz independ integr scheme, crucial question addressed, namely, determin 16 vector space (hereaft denot vapr ) low-dimension ap- proxim stress field8 lie order obtain accur time well-pos rom; calcul optim loca- tion sampl integr points. attent section confin aspect relat stress approxim space; issu relat select sampl points, hand, examin section 7. 5.1. reduced-ord subspac static admiss stress (v) sight, problem construct o(nu)-dimension repre- sentat stress field similar problem address section 3 concern reduc basi displac fluctuations: set orthogon basi function { 1(x), 2(x) . . .n(x)} (n = o(nu)) span accur approxim set possi- ble stress solut is, set static admiss stresses. ac- cordingly, follow procedur describ section 3, comput finit element, stress distribut rve repres macro- strain histories9. then, elastic/inelast dimension reduct process set forth section 3.2.1 appli result ensembl stress solu- tion {1(x),2(x) . . .nsnp(x)}, order identifi elast essenti inelast stress modes. space span mode denot v term reduced-ord subspac static admiss stress : v = span{ elast stress mode 1(x), 2(x), . . . ,me(x), essential, inelast stress mode me+1(x),me+2(x), . . . ,n(x)}. (27) 8it mention introductori section central idea effici inter- polatori approach numer integr reduced-ord bvp replac nonaffin term integrand low-dimension interpolants. case, glanc reduced-ord equilibrium equat (21) readili reveal offending, non- affin term stress field reduc b-matrix b = b(x) independ input paramet m need subject approximation. 9the practic consist choic strain trajectori us comput displac fluctuat snapshot 17 5.2. ill-posed hp-rom let try construct low-dimension approxim stress field, denot by10 , linear combin describ stress reduc basi make vapr = v; i.e., (x; m ,u ) (x; m ,u ) = n i=1 i(x)ci(m ,u ), (28) ci r (i = 1, 2 . . . n). strategi approxim offend- ing, nonaffin term bvp linear combin pre-comput basi function obtained, turn, sampl nonaffin term eval- uat solut successfulli appli authors, appar report comput pitfalls, wide gamut problems: nonlinear monoton ellipt nonlinear parabol bpv [46, 33], nonlinear miscibl viscou finger porou media [17, 18], uncertainti quantif invers problem [31], nonlinear heat con- duction problem [5, 6], cite few. however, closer examin rve equilibrium problem reveal that, case, standard strategi prove complet fruitless, lead patent ill-pos reduced-ord equations. this, let substitut approxim (28) eq.(21): b t (x)(x; m ,u ) d b t (x)(x; m ,u ) = n i=1 ( b t (x) i(x) d ) ci(m ,u ) = 0. (29) virtu eq.(23), bracket integr preced equat rephras as: b t (x) i(x) d = t ( b t (x) i(x) d ) , = 1, 2 . . . n. (30) basi function i(x) (i = 1, 2 . . . n) is, construction, linear com- binat stress snapshot collect offline, finit element 10notic that, keep notat convent introduc section 4, low-dimension approxim stress field repres attach asterisk stress symbol. 18 analysis; thus, write = nsnp j=1 ij j (i = 1, 2 . . . n), ij r correspond coeffici linear combination. insert equat eq.(30) consid j (j = 1, 2 . . . nsnp) finit element stress solut fulfil finit element equilibrium equat (8), final arriv at: t nsnp j=1 ij =0 ( b t j d ) = 0, = 1, 2 . . . n, (31) is, integr (30) appear equilibrium equat (29), hence, left-hand equat itself, vanish ident regardless valu modal coeffici ci r (i = 1, 2 . . . n), therefore, regardless valu reduc displac fluctuat u ill-posedness. 5.3. propos remedy: expand space approach clear forego discuss root caus ill- posed li fact set admiss stress field (v) form vector space, and, consequently, pod stress mode v (i = 1, 2 . . . n) linear combin turn self- equilibr fields. thus, reduced-ord problem well-posed, approxim space vapr form static admiss stresses, includ static inadmiss field i.e. stress function satisfi reduced-ord equilibrium equat (21). plausibl rout determin low-dimension approxim space embrac static admiss static inadmiss stress collect, offlin finit element calculations, converg stresses, unconverg on i.e., gener- at correspond iter algorithm, perform pod-bas dimension reduct ensembl snapshots. present work, however, pursu approach preclud ne- cessiti undertak computation labori aspect objection guarante span selected, unconverg stress snapshot cover entir space static inadmiss stress process. idea emploi approach origin conceived, fulli developed, author recent monograph [35]. here, theori underli idea elabor cast formal function analysis. 19 5.3.1. continuum formul origin consider gener standpoint, prove con- venient rephras left-hand reduced-ord equilibrium equat eq.(21) action certain linear oper g : l2() s rnu stress field rve: b t d = bi,l2() = (g[])i = 1, 2 . . . nu. (32) invok orthogon decomposit l2() s induc oper- ator, obtains: l2() s = n (g) span{bi} nu i=1 , (33) n (g) stand nullspac g. rve equilibrium equa- tion vanish right-hand term, follow n (g) actual space static admiss stress fields. orthogon complement, span{bi} nu i=1, constru abovement space static inadmiss stresses. kei fact space inher nu-dimension and, thus, need perform dimen- sional reduct whatsoev unconverg snapshot arriv desir basis: strain-displac function {b1,b2. . .bnu} linearli independ (albeit orthogonal) serv purpose. accord preced decomposition, l2() re- solv (see figur 2): = ad + in, ad,in l2() = 0, (34) ad n (g) span{bi} nu i=1 stand static admiss static inadmiss compon , respectively. follow standard approach, static admiss compon ad i.e., stress solut wish calcul given input m forc lie span pod mode (i = 1, 2 . . . n) obtain converg snapshots: ad = n i=1 ic ad , (35) cadi r (i = 1, 2 . . . n) correspond modal coefficients. non- equilibr compon in, hand, resid natur span 20 reduc strain-displac functions, directli writei.e., introduc approximations: = nu i=1 b ic , (36) cini r (i = 1, 2 . . . nu). low-dimension approxim re- quir propos integr method, denot follow ex (the append superscript ex mean stress approxim expand space), final obtain sum eq.(35) eq.(36) : ex = n i=1 ic ad + nu j=1 b jc j . (37) substitut approxim equilibrium equation, * * * 1 2 span( , ... ) b b b ad 1 2 span( , ... ) n s (space static admiss stresses) (space static inadmiss stresses) (pod stress modes) figur 2: expand space approach. stress approxim space expand embraces, span stress pod modes, span reduc strain-displac function {b 1 ,b 2 . . .bnu}. reduced-ord rve equilibrium prob- lem boil reduc displac fluctuat vector u make non-equilibr compon vanish (in(u , m ) = 0 ). gets: b t ex = nu j=1 ( b t b jd ) cinj = 0, = 1, 2 . . . nu. (38) {b1,b2. . .bnu} linearli independ functions, imme- diat clear equat hold if: cinj (m ,u ) = 0, j = 1, 2 . . . nu, (39) 21 i.e., nu coeffici multipli b l2() (i = 1, 2 . . . nu) identi- calli zero. adopt propos integr approach, thus, reduced- order rve equilibrium problem (21) transform problem find- ing, given input macroscop strain tensor m , reduc displac fluctuat vector u rnu make non-equilibr compon (defin eq.(36)) vanish. nutshell, ill-posed exhibit discret problem adopt standard approach pod mode elimin expand stress approxim space embrac span reduc strain-displac function (or strain modes11) bi l2() (i = 1, 2 . . . nu): vapr = v span{bi} nu i=1 = span{ n stress mode 1, 2 . . .n , nu strain mode b 1,b 2. . .b nu }. (40) 5.3.2. discret formul typic finit element implementations, stress gradient shape function calcul store gauss point underli spatial discretization. practic reasons, thus, prove imper reformul explain expand space strategi treat magnitud spatial discret variables, defin gauss points. discret counterpart continu defin field l2() bi l2() (i = 1, 2 . . . nu) denot s rng b =[ b 1 b 2 b nu ] rngsnu, term global stress vector, global matrix strain modes, respectively. global stress vector s construct stack stress vector (xg; ) rs (g = 1, 2 . . . ng) gauss point finit element grid singl column vector: s := [ t (x1; ) t (x2; ) t (xng ; ) ]t . (41) similarly, global matrix strain mode b construct as: b := [ b t (x1) b t (x2) bt (xng) ]t . (42) 11 indeed, function bi l2() (i = 1, 2 . . . nu) view fluctuat strain modes, symmetr gradient displac fluctuat modes, eq. 23. 22 have definit (41) (42) hand, approxim eq.(22) gauss quadratur written as: b t (x)(x; ) d ng g=1 wgb t (xg)(xg; ) = 0 b t ws = 0, = 1, 2 . . . nu, (43) w diagon matrix contain weight gauss point: w := w1i 0 0 0 0 w2i 0 0 ... ... ... ... ... 0 0 0 0 wngi (44) (here, denot s x s ident matrix). assum wg > 0 (g = 1, 2 . . . ng) gauss quadratur rule neg weight exclud considerations, choleski decomposit w (w = w 1/2 w 1/2), reexpress eq.(43) b t ws = (b t w 1/2)(w 1/2s) = 0. (45) defin weight global stress vector weight matrix strain mode := w 1/2 = [ w1 t (x1; ) w2 t (x2; ) wng t (xng ; ) ]t , (46) b := w 1/2b = [ w1b t (x1) w2b t (x2) wngb t (xng) ]t (47) respectively, insert definit eq.(41), final arriv at: b t = 0, (48) equivalently, b t = 0, = 1, 2 . . . nu, (49) show static admiss weight stress vector orthog- onal, sens standard euclidean inner product, weight strain mode bi t (i = 1, 2 . . . nu). 23 compar eq.(48) eq.(32), clear bt plai role oper g eq.(32). analog eq.(33), thus, write r ng = n (bt ) range(b) (50) n (bt ) range(b) denot null space rang (or column space) bt b, respectively, consequ decompos r ng = ad +in (51) ad n (bt ) range(b). continu case (see eq.(35)), static admiss compon ad approxim linear combin pod basi vector obtain converg stress snapshots12: ad = n i=1 cadi = c ad, (52) = [ 1 2 n ] denot (weighted) stress basi matrix cad rn stand vector modal coeffici associ basi matrix. likewise, non-equilibr compon pertain column space b, directli write = bcin, (53) cin rnu . low-dimension (weighted) stress vector ex requir propos integr method final obtain sum eq.(53) eq.(52). ex = cad + bcin, (54) compact format: ex = exc. (55) ex := [ b ] , (56) 12the methodolog obtain mode svd similar explain section 3.2 displac fluctuat modes. 24 c = [ cad cin ] . (57) matrixex rngs(nu+n) defin eq.(56) call expand basi matrix (weighted) stresses, c rn+nu correspondingli term expand vector modal coefficients. insert approxim (54) eq.(48), consid bt = 0 bt rank matrix, final arriv equilibrium condit deriv continuum case (see eq. 39): cin(u , m ) = 0. (58) equat solv u , desir equilibr stress vector obtain evalu eq.(52): = cad(u , m). (59) 6. high-perform rom step develop propos integr scheme deduc closed-form express vector modal coeffici cad rn cin rnu term stress valu comput set p = o(nu) pre-specifi sampl point (to chosen set gauss point underli finit element mesh). end, need introduc notat terminology. 6.1. gappi vector let = {i1, i2 . . .ip} {1, 2 ng} denot set indic sampl points. notationally, write (i) rp design subvector contain row associ sampl points; viz.: (i) := [ wi1 t (xi1 , ) wi2 t (xi2, ) wip t (xip, ) ]t (60) (when confus apt arise, parenthet subscript indic set sampl indic dropped, shall simpli write ). prove conceptu advantag regard restrict gappi terminolog goe work everson et al. [28] stress vector (i) result applic certain boolean oper 25 p (i) : r ng rp vector (i.e., = p (i)). p (i) select oper associ sampl indic i. oper cours appli y rngsz (z n). instance, restrict matrix weight strain mode defin b := p (i)b . furthermore, straighforward p (i)p t (i) = i, (61) (here (ng s)x(ng s) ident matrix) p (i)(ay) = (p (i)ap t (i))(p (i)y) (62) rngsng y rngsz. 6.2. least-squar fit spirit classic polynomi quadrature, newton-cot formula [36], modal coeffici cad rn cin rnu determin fit low-dimension approxim (54) weight stress calcul pre-specifi sampl points. notic that, variabl subject approxim stress vector-valu function, total number discret point fit coincid number spatial sampl point (p), equal product number time number stress compon (s). well-posed fit problem, thus, demand p s n+nu, i.e., number discret point equal greater number paramet adjusted. equal hold, n+nu p multipl s; thus, exact fit gener possibl arbitrari valu n nu, recours approxim fit made. respect, follow standard approach least-squares, best-fit criterion, i.e., minim squar deviat observ () fit ( ex = + bb) valu (in context, ob- serv signifi calcul pertin constitut equation). minim problem state as: c = [ cad cin ] = arg min arn ,brnu ( a+ bb ) (63) stand standard euclidean norm. let ex = p (i)ex = [ b] gappi expand basi matrix, suppos sampl indic chosen ex rank, i.e.: rank(ex) = rank([ b]) = n + nu. (64) 26 then, shown (see, instance, ref. [23]) solut standard, least-squar problem provid follow vector coefficients: c = [ cad cin ] = ex , (65) ex := m 1 (ex t ex)1 ex t (66) so-cal pseudo-invers matrix ex. recal ultim aim deriv closed-form express cin cad function . thus, remain extric sub- vector express (65). partit m = ex t ex ex t term gappi stress basi matrix gappi matrix strain mode b: c = [ cad cin ] = [ t t b b t b t b ]1 [ t b t ] . (67) invok blockwis invers formula 2x2 block symmetr matric [11], tediou algebra releg appendix c final arriv follow express cad cin c ad = ( bcin), (68) cin = s1b t ( ) , (69) denot pseudoinvers gappi stress basi matrix : = ( t )1 t (70) s := b t (i) (note s invert virtu hypothesi repres eq.(64)). 6.2.1. reconstruct matrix let examin express (68) modal coeffici cad multipli static admiss compon global stress vector. 27 since, solution, cin = 0, that: cad = ( b =0 cin ) = . (71) (notic result obtain directli solv minim problem (63) b = 0). substitut equat eq.(59) yields: = cad = r = r , (72) r := = ( t )1 t . (73) inspect eq.(72) reveal matrix r rngsp defin oper allow reconstruct (weighted) static admissi- ble stress vector rng (weighted) stress valu ( rps) calcul pre-select sampl point i. reason, shall us term weight reconstruct matrix (or simpli reconstruct matrix) refer operator. emphas matrix depend pod stress basi matrix select sampl indic i.e., independ input parameter, macro-strain mand, therefore, pre-comput offline. 6.3. hyperreduc rve equilibrium equat express set static inadmiss coeffici cin rnu, know that, solution, coeffici vanish; thus, eq.(69), c in(u , m) = s 1 b t ( ) (u , m ) = 0. (74) s nonsingular matrix, condit equival b t ( ) (u , m) = 0. (75) furthermore, examin eq.(73) eq.(75) readili show bracket term eq.(75) submatrix recon- struction matrix r form row associ sampl point i, i.e.: = p (i)( ) = p (i)r = r. (76) 28 substitut express (76) eq.(75) final lead to: b t (i r)(u , m) = 0. (77) previous note (see figur 2), purpos enforc condit cin(u , m ) = 0 ensur stress solut li entir space equilibr stresses. equat (77) viewed, thus, hyperreduc form origin rve equilibrium equation. observ 6.1. hyperreduc qualifi coin d. ryckelynck [58, 59] indic eq.(77) result subsequ step complex reduction: firstly, number degre freedom (when pass finit element model rom emploi stan- dard gauss quadrature), and, secondly, number integr point (when pass standard rom baptized13 high- perform rom ). doubl complex reduct better appre- ciat rephras eq.(77) fe equat (9) format similar eq.(48), viz.: b t b t (i r) = bt = 0, (78) ng g=1 wgb t(xg)(xg, ; ) = b t = 0, (79) respect (here, b rngsnd finit element counterpart b, de- fine eq.(42)). eq.(79), eq.(48) eq.(78) disposal, abovement process complex reduct symbol repre- sent fem b t = 0 1streduc. n d nu = stand. rom b t = 0 2ndreduc. ng p = hp-rom b t = 0, (80) 13 term high-performance, reduced-ord model (hp-rom) highlight tremend gain perform afford model standard rom, let full-order, finit model. numer exampl shown section 9, report speedup factor order magnitudes. 29 relat b rngsnd, b rngsnu b rpsnu b = b b := (i r)b = (i r)p (i)b, (81) p = o(nu) << ng = o(n). interest reduct complex rve equilibrium equat reflect gradual reduct dimens b oper act weight vector stresses. 6.3.1. physic interpret asid compress version original, full-ord cell condi- tion, hyperreduc equat (77) altern interpret balanc observ fit intern forc select sam- pling points. interpret readili identifi realiz product r appear eq.(77) (weighted) vector fit stress select sampl points. indeed, virtu eq.(72) and, consid properti select oper p (i), r = p (i)(r) = p (i) = . (82) equality, eq.(77) express b t = b t , or, re- vert original, summat notat ji wjb t(xj)(xj ; ) = ji wjb t(xj) (xj ; ). (83) note side equat repres physic quantity, namely, sum intern forces, reduc coordinates, sampl gauss point {xi1 ,xi2 xip}. differ li stress emploi comput intern forces. left-hand side, calcul observ stress stress aris directli evalu correspond constitut equation, whereas, right- hand side, fit stress is, stress obtain fit approxim construct pod stress basi function 1,2 . . .n observ data. thus, hp-rom equilibrium con- dition (83) tell that, solution, sum intern forc pre-select sampl point comput observ fit stresses14 coincide. 14it mention respect that, general, (xj ; ) 6= (xj ; ) 30 6.4. jacobian matrix needless say, depend stress reduc vector reduc displac fluctuat u gener non-linear, and, thereby, iter method requir solv eq.(77). emploi stan- dard newton-raphson procedure. iter scheme correspond procedur given follow express (the parenthet superscript indic iter number): u (k+1) = u (k) k(k)1f (k), (84) f (k) = b t (i r) (m ,u (k)) (85) k (k) = b t (i r) c(m ,u(k)) b. (86) equation, c rpsp denot block diagon matrix contain- ing algorithmic, constitut tangent matric sampl point: c := c(xi1; ) 0 0 0 0 c(xi2 ; ) 0 0 ... ... ... ... ... 0 0 0 0 c(xip; ) . (87) 6.4.1. posit definit relev overal robust propos method, worthwhil point digress discuss thoroughli spectral properti jacobian matrix repres eq.(86). particular, interest ascertain posit definit algorith- mic tangent matric c(xi1 ; ), c(xi2 ; ), c(xip) select sampl points, matrix c, ensur posit definit jacobian matrix k occur classic gauss quadratur rule posit weights, and, not, remedi appli obtain desir property. number data item fit (p s) greater number stress mode (n). observ fit stress coincid stress vector wish approxim pertain column space stress basi matrix 31 posit definit jacobian matrix (86) requir function defin f (u) = utku = (bu)t(i r) c(bu) (88) posit non-zero u rnu . b rank matrix virtu eq.(64), condit f (u) > 0 equival to: g(v) = vt(i r) cv > 0 (89) non-zero v range(b). further, need demonstr r rngsng recal r matrix map vector observ stress vector fit stress actual repres orthogon projection15 column space gappi stress basi matrix . shown simpli note r is, hand, symmetric: r t = (( t )1 t )t = ( t )t t = r (90) and, hand, idempotent: r 2 = ( )2 = =i ( t )1 t ( t )1 t = ( t )1 t = r. (91) properti hand, decompos v range(b) v = v|| +v (92) v|| = rv range() compon v column space v = (i r)v compon v orthogon complement range(). introduc decomposit eq.(89), arriv g = v t cv +v t cv||. (93) term v t cv preced equat is, virtu posit definit c, emin posit nonzero v rps, said principl second term v t cv||: numer experi show sign rel magnitud term depend chosen set sampl indic i. 15 r so-cal hat matrix linear regress model [52]. 32 remark 6.1. observation, follow posit defi- nite jacobian matrix k determined, spectral properti c, surprisingli number locat rve sampl point emploi integration. forego remark natur lead wonder possibl select sampl indic ensur posit definit k (assuming, obviously, c enjoi property). shed light question, let divid eq.(93) v t cv (notic hypothesi (64) preclud possibl v zero) g = g v t cv = 1 + v t cv|| v t cv . (94) suppos now, sake argument, c symmetric. case, equat legitim rewritten as: g = 1 + cos(v,v||) c v|| c v c , (95) cos(v,v||) c = v,v|| c v c v|| c . (96) equation, , c symbol inner product defin c (i.e., x,y c = xtcy), c denot norm associ inner product (x2 c = x,x c ). eq.(94), deduc suffici (yet necessary) condit g > 0, k posit definite, v|| c v c < 1 (97) nonzero v range(b), equival (set v = bu): rbu c (i r)bu c < 1 (98) nonzero u rnu . 33 us guidelin choos posit definit jacobian matrix k infer inequ (98). firstly, given fix number sampl point p, express (98) indic point select column gappi strain basi matrix b = p (i)b = [b1 b 2 . . . b nu ] are, loos speaking, orthogon possibl range(r) = range() column space gappi stress basi matrix = p (i). doing, factor defin f c := nu i=1 rbi 2c nu i=1 (i r)bi 2c , (99) diminish, would, consequently, left-hand inequ eq.(98). practice, however, factor f c criterion guid select sampl points, simpli defin term norm induc c, matrix virtual chang time step iteration. content estim factor norm; instance, emploi standard euclidean norm , get f c ff := nu i=1 rbi 2 nu i=1 (i r)bi 2 = rbf (i r)bf , (100) f stand frobeniu norm. asid seek orthogon b r, express (99) sug- gest wai lower factor ff reduc ratio defin f := rf rf . (101) r and, consequently, ir matric repres orthogon projec- tions, rf = rank(r) = n irf = p s n. therefore, f = n p s n . (102) 34 observ 6.2. expression, thus, conclud increas number sampl point p keep number stress mode n constant contribut reduc factor ff eq.(98), and, hence, improv spectral properti (posit defineteness) jacobian matrix k. notic properti total consist fact that, limit case take gauss point (p = ng), reduc matric r b degener order counterpart r b, condit rb = 0 hold span subspac mutual orthogonal, make ff = fc = 0. 7. select sampl point theoret issu discuss present work se- lection set gauss point underli finit element mesh appropri sampl interpol points. least, set sampl indic = {i1, i2 . . . ip} chosen gappi expand basi matrix rank (see section 6.2): rank( ex (i)) = rank([(i) b (i)]) = n + nu. (103) set sampl indic fulfil necessari condit said admissible. 7.1. optim criteria 7.1.1. accuraci model reduct problem, overrid concern choos sampl point accuraci approximation: like posit point maximum similar high- fidelity, finit element solut reduced-ord counterpart ob- tained. specifically, output bvp macroscop stress response, aim set sampl point minim follow error estimate: em,(, i) := nsnp i=1 m m i(, i)2, (104) m = m ( tm k j) denot finit element, macroscop stress respons correspond k th (k = 1, 2 . . . nstp) time step 35 training16 strain trajectori tm j (j = 1, 2 . . . nhst); m i(, i) low-dimension approximation. cauchy-schwarz inequality, approxim pertin integr gauss quadrature, write em, 2 1 v nsnp i=1 i(x) i(x;, i)2 d 1 v nsnp i=1 ng g=1 wgi(xg) wg i(xg;, i)2 = 1 v nsnp i=1 i(, i)22 = 1 v x x(, i)2f (105) x = [ 1 2 nsnp ] x(, i) = r(i)(p (i)x). error estim macroscop stress defin eq.(104) is, thus, bound frobeniu norm differ (weighted) stress snapshot matrix x obliqu projection, x, range(). bound, design e, admit follow decomposit 17 e 2 = 1 v x x()2f + 1 v x()x(, i)2f , (106) x orthogon project x rang , i.e., x = tx. note term right-hand eq.(106) depend stress basi matrix, emploi sampl indices; provides, thus, estim stress truncat error. term actual measur quality, term accuracy, given set admiss sampl point second oneit provid (a priori) estim stress reconstruct error. shall denot term erec : erec := 1 v x()x(, i)f . (107) reason cost evalu express eq.(107) 16the term training, which, incidentally, borrow neural network litera- ture [38], text refer offlin gener snapshots. 17thi decomposit follow easili pythagorean theorem (just notic t (x x) = 0 ). 36 independ number gauss points18, significantli lower case origin error estim em,, shall us follow erec error estim guid select sampl points. 7.1.2. spectral properti optim given set sampl point measur term accuraci approximation. demonstr sec- tion 6.4, number particular placement point influenc spectral properti (posit definiteness) jacobian matrix equilibrium equation, therefore, converg characterist accompani newton-raphson algorithm. saw that, preserv posit definit full-ord jacobian matrix, strive choos sampl indic factor defin previous eq.(100): ff (,b , i) = r(i)b(i)f (i r(i))b(i)f (108) small possible. 7.2. optim approach: basic stabil sampl point unfortunately, minim approxim error repres express eq.(107) minim eq.(108) gener con- flict goals. instance, numer experi selec- tion driven exclus accuraci considerations, result jacobian matrix indefinit certain state deform especi inelast deform severe, lead occasion converg fail- ures. goal balanc order arriv accur time robust solut scheme. accomod conflict requirements, propos heurist strategi basic consist treat minim eq.(107) 18indeed, column-wis orthogonal, minim eq.(107) equival min- imiz differ coeffici respect projections. number coeffici equal number snapshots, normal lower number gauss points. 37 eq.(108) separated, sequenti problem spirit so- call greedi optim algorithms19 [44]. set sampl point assum divid disjoint subset ib: = ib. (109) subset = {i1, i2, ip} obtain minim error estim given eq.(107), viz.: = arg min k{1,2...ng} erec (,k). (110) set determined, remain sampl indic ib = {j1, j2 jpb} (p + pb = p) calcul ib = arg min k{1,2...ng} ff (,b , k). (111) remark 7.1. note minim problem repre- sent eq.(110) essenc problem address (standard) interpolatory-based, model reduct approach determining, given set empir basi functions, optim locat associ interpol points. reason, shall refer set point aris solv minim problem standard basic sampl point best interpol point nguyen et al. [54], magic point madai et al. [46].. contrast, necess introduc point attempt solv problem (111) consequ expand stress ap- proxim space place main innov featur approach, present model reduct strate- gies. shall {xib(1), xib(2) . . .xib(pb)} set stabil sampl points. number basic sampl point satisfi necessari condit p n/s. general, take p = n suffic ensur highli satisfactori approximations. many, hand, stabil sampl point ad safe render posit definit jacobian matrix repres rang macroscop state deform 19a greedi method algorithm solv problem make local optim choic step hope find global optimum. 38 question answer empirically. exampl present section, conserv answer us stabil sampl point displac basi mode (pb = nu). deal discret minim problem (110), hierarch interpol point (hpi) method propos nguyen et al. [54]. essenc method construct, greedi fashion, set indic solv sequenc one-dimension minim problems. minim problem (111) address heurist base greedi paradigm. particular, k th (k = 1, 2 . . . pb) index select solv following, one-dimension minim problem: ib(k) = arg min j{1,2...ng} ff (,b ,k(j)) (112a) k = {ib(1), ib(2) ib(k 1), j}. (112b) 8. summari lastly, reader conveni easi reference, onlin reduced- order problem, offlin step lead hyperreduc oper appear onlin problem, summar box 8.1 8.2. 9. numer result section intend illustr perform assess effi- cienci propos model reduct strategi solv fine scale bvp correspond porou metal materi plane strain conditions. 9.1. microstructur descript void ellipt shape (with eccentr equal 0.3), randomli distribut (with poros equal 0.3), align major ax rang length accord cumul probabl distribut displai figur 3.b 0.2 1.5 mm. mechan behavior metal matrix model rate-independent, von mise elastoplast model endow follow non-linear, isotrop harden satur law (consult ref. [61] detail implement elastoplast model): u() = 0 + h + ( 0)(1 exp()). (118) 39 1. comput fe displac fluctuat stress snaphot repre- sentative, input macro-strain histories. appli appendix b elastic/inelast pod result snapshot matric obtain displac fluctuat stress basi matric ( rndnu rngsn , respectively). 2. calcul weight matrix fluctuat strain mode b r ngsn eqs. (26) (47). 3. select set sampl indic optim basi matric b follow procedur sketch section 7. 4. finally, , b i, construct hyperreduc -order matric b rpsnu t rsps; express matric read: b = (i r)b = (i p (i)r)(p (i)b) (113) t := 1 v [ w1i w2i wngi ] r (114) r = ( t )1 t = p (i). box 8.1: offlin stage. pre-comput reduc basi hyperreduc operators. here, u stand yield stress, 0 denot equival plastic strain; 0 = 75.0 mpa, = 100.0 mpa, = 2500.0 h = 5000 mpa materi constants. young modulu poisson coefficient, hand, equal em = 75gpa m = 0.3, respect (these materi constant correspond approxim aluminum). 9.2. rve finit element discret size rve determin conduct finit element anal- yse squar domain increas size subject vanish displac fluctuat boundari conditions. macroscop stress respons calcul repres macroscop strain path (stretch- ing longitudin transvers directions, shearing) sampl 20x20 mm2 practic indistinguishable. fact indi- cate subvolum 20x20 mm2 (or greater) consid repres volum element (rve) porou materi study. 40 1. initi data: u n rnu (reduc vector displac fluc- tuation tn), mn (macroscop strain vector tn), {n(xi1), n(xi2), . . .n(xip)} (intern variabl tn select sampl points). 2. input data: mn+1 (macroscop strain vector tn+1) 3. given initi input data, u n+1 rnu b t (mn+1,u n+1) = 0, (115) = [ wi1 t (xi1, ) wi2 t (xi2 , ) wipt (xip, ) ]t (116) (here, (xii, ) denot stress vector evalu ith sampl point correspond constitut equation). 4. output data: eq.(116) solv u n+1, updat macroscop stress vector m |n+1 = t (mn+1,u n+1). (117) box 8.2: onlin stage (solut hyperreduced-ord rve equilibrium problem given macroscop strains). finit element discret correspond particular 20x20 mm2 rve emploi ensu simul shown figur 3.a. number (four-nod bilinear) element ne = 9746, number node n = 11825. emploi quadratur formula, hand, standard 2x2 gauss rule, total number gauss point amount- ing ng = 4ne = 38984. overcom incompress issu maintain displacement-bas formul present preced sections, commonli known b-bar approach adopted20. con- stitut differenti equat integr time classic (fulli 20thi mean that, case, reduc b-matrix b(x) appear for- mulat hp-rom construct gradient shape functions, indic eq.(23), modifi b-matrix eman three-field hu-washizu variat principl [61] 41 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 pore major axi (mm) c u m u la ti v e p ro b b il y figur 3: a) finit element mesh rve correspond porou metal material. b) cumul probabl distribut follow length pore major axes. implicit) backward-eul scheme. 9.3. sampl paramet space 0 1 2 3 4 5 6 7 x 10 -3 (50 snaphots) longitudin stretch transvers stretch shear m c ro s c o p ic s tr time step (50 snaphots) (50 snaphots) ( ) xm ( ) ym ( ) xym ( ) 0 ym = ( ) 0 xm = ( ) 0 xm =( ) 0 xym = ( ) 0 xym = ( ) 0 ym = figur 4: macro-strain trajectori gener displac stress snap- shots. 42 step process construct reduc basi sampl input paramet space; saw section 3.1 that, fine-scal bvp, process amount select repres macroscop strain histories. macroscop strain histori (nhst = 3) case studi depict figur 4. strain trajectories, (independent) strain compon follow linear ascend path magnitud compon set zero. time domain strain histori discret nstp = 50 equal space steps, result total number nsnp = nhst nstp = 150 snapshots. remark 9.1. task sampl input paramet space akin experiment process materi paramet standard phenomenolog model calibr laboratory. analogy, rve plai role correspond experiment specimen, macro-strain train trajectori repres load path pertin calibr tests. hindsight elementari physic consider there- fore aid restrict number strain histori (and snapshots) necessari character response. instance, behavior materi compos rve govern rate-independ constitut model (a case hand), know necessari studi respons vari rate deformation. strategi effici sampl input paramet space gener model reduct context refs. [12, 13, 15, 42]. 9.4. dimension reduction: priori error analysi finit element displac fluctuat stress field comput time step input strain trajectori shown multipli correspond weight matric (m w 1/2) stored, snapshot matric xu rndnsnp (n d = 11825 2 = 23650) x rngsnsnp (ng s = 38984 4 = 155936), respectively. then, matric subject svd-based, elastic/inelast dimension reduct process sketch section 3.2.1 describ appendix b order gener optim set basi vector displac fluctuat stress solut spaces. elucid basi vector constitut essenti mode response, plot figur 5 dimensionless pod truncat error estim defined, displac fluctuations, as: 43 1 3 5 7 9 11 13 15 17 19 0 10 20 30 40 50 60 70 number basi vector elast mode inelast mode p o d t ru n c ti o n e rr o r (% ) displac fluctuat stress ( , )un ns ( ) u e% ( ) trun es% 6 7 8 9 10 11 0 1 2 3 4 5 figur 5: pod truncat error estim eu (for displac fluctuations, eq.(119)) etrun (for stresses, eq.(120)) versu number basi vector em- ploi approxim (nu n, respectively). portion 6 11 mode shown magnifi form. eu(nu) := xu x u(nu)f xuf , (119) stresses: etrun (n) := x x(n)f xf , (120) x u(nu) x (n) orthogon project xu x span nu n basi vectors, respectively. ob- serv figur 5 error measur decreas monoton increas order truncat mere consequ optim properti svd, approxim rate; decai pronounc 1 6 modes, gradual thereafter, tend asymptot zero number mode increases. trun- cation error stress displac fluctuat n = nu = 6 5%. term dimension reduction, mean data contain snapshot matric compress factor (nu/nsnp) 100 = (6/150) 100 = 4% retain 95% informa- tion essenti information. 6 basi function (3 elast 3 inelastic) stress displac fluctuations, therefore, regard essenti mode character mechan 44 b) 2nd basi c) 3rd basi d) 4th basi e) 5th basi f) 6th basi a) 1st basi figur 6: contour plot euclidean norm 6 displac fluctuat mode (i, = 1, 2 . . .5). deform shape scale factor 15. respons concern rve. wai illustration, plot figur 6 contour plot euclidean norm 6 essenti displac fluctuat mode (i, = 1, 2 . . . 6). 9.5. sampl point 9.5.1. basic sampl point stress displac fluctuat basi vector de- termined, offlin step consist select set finit element gauss pointsof optim set sampl points. fol- low strategi describ section 7.2, carri select comput locat call basic sampl point {xi(1),xi(2) . . .xi(p)}. assess effici emploi hierar- chical interpol point method, abbrevi hipm, plot figur 7 estim pod truncat (shown previous figur 5) total stress error versu number stress mode n (in algorithm, assum p = n). total stress error estim 45 1 3 5 7 9 11 13 15 17 19 0 10 20 30 40 50 60 truncat error total error (use basic sampl points) number stress basi vector s tr e s s p p ro x im ti o n e rr o r (% ) ( )n 6 7 8 9 10 11 0 1 2 3 4 5 figur 7: estim pod truncat (etrun , eq.(120)) total (e, eq.(121)) stress error versu number basi vector emploi approxim (n). total error estim comput set basic sampl point (e = e(n, i), p = n). portion 6 11 mode shown magnifi form. defin e(n, i) := x x(n, i)f xf (121) x(n, i) denot obliqu project (calcul sampl point i) x span n basi vector (1,2 . . .n). appreci figur 7 total error trun- cation error curv practic coincident, fact indic contribut reconstruct error : erec = e2 etrun 2 = x(n)x(n, i)f xf (122) ( error introduc result p sampl point instead entir set finit element gauss points, section 7.1.1) neglig comparison discrep truncat pod basis. n = p = 6, instance, reconstruct error 3% total stress error. view results, clear refin algorithm select basic sampl point principl necessary: emploi hipm optim algorithm, 46 heuristic, satisfactorili fulfil purpose. wish lower stress approxim error, far effect simpli increas level truncation. 9.5.2. stabil sampl point ( ) b p 4p = 4p = 5p = 5p = 6p = 6p = 7p = 7p = 8p = 8p = 9p = 9p = 10p = 10p = 11p = ( ) u p n ns s= = ( ) u p n ns s= = 11p = ( ) b p indefinit jacobian matrix definit posit jacobian matrix 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 -0.2 -0.15 -0.1 -0.05 0 0.05 0.1 0.15 number sampl pointsstabil m im u m e ig e n v lu e o f s y m (k ) 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 number stabil sampl point (a) f f (b) * m k m , figur 8: a) factor ff (defin eq.(99)) versu number stabil sampl point pb vari number basic sampl point p (with p = n = nu). b) minimum eigenvalu kmin (over time step iter p) symmetr reduced-ord jacobian matrix k versu number stabil sampl point pb. concern term stabil sampl points, figur 8.a contain graphs, vari level truncation, factor ff defin 47 eq.(100) function number stabil sampl point pb. studi influenc includ point spectral properti posit definet stiff matrix, graph accompanied, figur 8.b, plot minimum eigenvalu kmin (over time step iter case) symmetr reduced-ord ja- cobian matrix k versu pb. seen ff decreas monoton number stabil sampl point increases, decreas reflected, theoret anticip section 6.4.1, improv spectral properti reduced-ord jacobian matrix (higher kmin pb raises). clarity, minimum number stabil sampl point required, level truncation, render posit definit k plot- ted figur 9. plot, glean that, roughly, higher ( )n 4 5 6 7 8 9 10 11 0 1 2 3 4 5 6 7 level truncat n o . o f s ta b . s m p . p o ts figur 9: minimum number stabil sampl point requir jacobian matrix k definit posit level truncat n = nu = p (deduc figur 8). level truncat (and number basic sampl points), stabil sampl point appear need ensur posit definit k. n = p = 6, ad stabil sampl point suffices, n = p = 11, 7 point required. observ 9.1. valu shown figur 9 correspond minimum pb lead posit definit k prescrib strain path coincid train strain trajectori (displai figur 4 ). unfor- tunately, guarante jacobian matrix exhibit desir properti prescrib strain histori differ train ones. thus, view uncertainty, robustness, prefer stai caution regard us 48 1st point 1st point 2nd point 2nd point 4th point 3rd point 3rd point 4th point 5th point a) basic sampl point b) stabil sampl point 5th point 6th point 6th point figur 10: locat rve finit element (mark red) contain p = pb = 6 basic stabil sampl points. stabil sampl point minimum number indic analy- si base train strain trajectories. author experi safe estim pb simpli pb = p is, equal number basic stabil sampl points. adopt rule, au- thor observ converg failur whatsoever, exampl consider case shown here. locat p = 6 basic sampl point correspond- ing pb = 6 stabil sampl point depict figur 10. 9.6. posteriori errors: consist analysi error measur displai previous figur 5 7 depend outcom svd snapshot matrices; calculated, thus, actual construct reduced-ord model. error analys base measur serv us purpos provid hint stress displac fluctuat mode need sat- isfactorili replic full-order, finit element solution, thereby, prospect evalu viabil reduc basi approach itself. however, priori error estim tell story. ex- pression (121) stress approxim error presum stress 49 solut chosen sampl point provid finit ele- ment model, ignor fact that, actually, reduced-ord model, gener case nonlinear, dissip materials, stress infor- mation point given time step pollut truncat (in displac fluctuat stresses) reconstruct (in stresses) error origin previou time steps. quantifi extent amalgam accumul error affect predict furnish hp-rom, necessari perform consist analysis. gener speaking, reduc basi approxim said consist if, limit truncation, introduc addit error solut problem data construct basi function acquir [14]. bvp consideration, thus, consist impli that, input macro-strain path trajectori emploi train process, result obtain hp-rom converge, n nu increase, solut furnish full-order, finit element model. condit check d p . fl u c tu ti o n e rr o r (% ) s tr e s s e rr o r (% ) level truncat (a) (b) priori estim posteriori estim ( ) u n ns= )( ue% )( rom u e% 6 10 14 18 22 26 30 34 0 5 10 15 20 25 30 6 10 14 18 22 26 30 34 0 5 10 15 20 25 30 35 40 level truncat ( )un ns= priori estim posteriori estim )(es% )( rom es% figur 11: comparison evolut priori posteriori error measur versu level truncat (use nu = n = p = pb). a) displac fluctuat (see eqs. 119 123). b) stress (see eqs. 121 124) studi evolut error measur defin eromu (nu, n, i) := xu x rom u (nu, n, i)f xuf , (123) displac fluctuations, erom (nu, n, i) := x xrom(nu, n, i)f xf , (124) 50 level truncat ( )un ns= 4 8 12 16 20 24 28 32 34 1 1.5 2 2.5 / rom e es s% % figur 12: ratio erom /e posteriori priori measur stress approxim error level truncat (use nu = n = p = pb). stresses. ( superscript rom append highlight that, unlik x u x eqs. (119) (121), x rom u x rom matric displac fluctuat stress snapshot comput hp- rom). figur 11.a 11.b contain graph posteriori error measures, respect priori counterpart eu (eq. 119) e (eq. 121), versu level truncation. clear graph consistency, sens given above, observ term displac fluctuat stresses: posteriori error measur eromu e rom mimic essenti decreas tendenc priori counterpart eu e, respectively. seen priori error estim eu e constitut (rather tight) lower bound posteriori counterpart eromu e rom , respectively. better appreciated, stresses, figur 12, ratio erom /e versu level truncat plotted. degre approxim achiev propos hp-rom quantifi engin fashion figur 13, plot, case train strain histori (stretch longitudin direction), longitudinal, macroscop stress-strain curv comput fe model, hand, hp-rom nu = n = 6, 7, 8 modes, hand. observ maximum de- viation fe respons 6 mode (3 elast 3 inelastic) take place onset plastic yield 8%; remarkably, deform continues, deviat gradual diminishes, practic 51 finit element m. hp-rom, 6n = ( ) xm hp-rom, 7n = hp-rom, 8n = m c ro s c o p ic l o n g u d l s tr e s s ( m p ) macroscop longitudin strain 0 1 2 3 4 5 6 x 10 -3 0 25 50 75 100 125 150 figur 13: longitudin macroscop stress versu longitudin macroscop strain com- pute fem hp-rom n = nu = 6, 7, 8. a) finit element model b) hp-rom ( 6) u n ns = = ( ) ( ) y mpa m figur 14: contour plot transvers stress comput end train strain histori a) fem (b) hp-rom n = nu = 6. deform shape exagger (by factor 20). neglig end process. furthermore, increas or- der truncat n = nu = 8, differ hp-rom fem respons virtual impercept level deformation. 52 resembl hp-rom fem result appreci term stress distribut contour plot shown figur 14. visually, discern differ contour plots. 9.7. train error studi present preced subsect aim exam- in error incur approxim snapshot solut space vsnpu reduced-ord subspac vu vsnpu span pod basi vector terminolog section 3.1, check vu vsnpu , solut provid hp-rom converg obtain fem. recal snapshot space vsnpu (presum representative) subspac vu, manifold vhu induc parametr depend fine-scal bvp prescrib macroscop strain history. conse- quently, gener arbitrari input strain trajectori hp-rom solut converg solut provid fem. complet error assess analysis, thus, necessari estim error inher sampl paramet space train er- ror judg select train strain trajectori gener snapshot subspac repres solut space21 vu. ideally, carri error assess pick up, guid sound, statistically-bas procedure, suffici larg set strain path compar solut comput fem hp-rom input strain path vari level truncation. degre rigor, however, scope present work. here, limit analyz qualiti hp-rom approxim obtain differ input strain histories, namely, uniaxi compress test, biaxial loading/unload test. 21to mathemat term appeal analogy, introduc remark 9.1, train rve reduced-ord model calibra- tion standard phenomenolog model calibr hp-rom train test displai previous figur 4, shown model abl exactli replic behavior rve test nu = n suffici large. similarli situat encount deal standard phenomenolog- ical models, remain assess capabl propos hp-rom predict behavior rve condit differ calibr (training) process. 53 ( ) ym ( ) 0 xm = ( ) 0 xym = level truncat m c ro s c o p . s tr e s s e rr o r (% ) ( ) u n ns= 4 6 8 10 12 14 16 18 20 22 24 26 28 30 10 0 20 30 40 50 60 101 20 time step a) b) m c ro . s tr 30 40 50 -6 -4 -2 0 x 10 -3 figur 15: a) strain trajectori emploi assess train errors. b) plot macroscop error estim erom,m (see eq.(125)) correspond test trajectori versu level truncat (n = nu) 9.7.1. uniaxi compress strain path emploi assess displai figur 15.a; repres monoton compress transvers direct (the model, figur 4, train stretch shear, com- pression, tests). purpos evalu qualiti hp-rom ap- proximation, conveni introduc follow macroscopic22 stress error estimate: erom,m := ntstp i=1 m i,rom m (n, nu, i)2 ntstp i=1 m i2 , (125) m i,rom m denot macroscop stress ith time step comput fem hp-rom, respectively. error estim plot figur 15.b versu level truncat nu = n. observ error goe zero number emploi mode increase. particular case, thus, addit error sampl 22recal output solv fine-scal bvp macroscop stress tensor; thus, error estim defin eq.(125) (erom,m ) provid mean- ing indic qualiti approxim stress error measur defin previous eq.(124) (erom ). suit examin converg prop- erti hp-rom approximation, minim problem underli svd pose term frobeni norm. 54 paramet space. remark 9.2. simpl exampl fittingli illustr acclaim advantag pod/galerkin reduced-ord approach black box meth- od artifici neural network base partit offline-onlin comput paradigm: pod/galerkin reduced-ord ap- proach preserv physic problem wish model and, consequence, abl physically-bas extrapolations. instance, case, reduced-ord model abl exactli replic (for suffi- cientli larg nu = n) macroscop compress behavior rve, inform deform state suppli model calibr (training) phase; hp-rom aware, figur speaking, matrix materi rve exhibit similar behavior tension compress (j2 plasticity). 9.7.2. biaxil loading/unload test ( ) xm 0 20 40 60 80 100 120 140 160 180 200 -4 -3 -2 -1 0 1 2 3 4 x 10 -3 time step m c ro s c o p ic s tr ( ) ym ( ) xym figur 16: second strain trajectori emploi assess train errors. sever test assess error associ train process provid strain trajectori shown figur 16. indeed, train- ing strain histori figur 4 includ monotonic, uniaxi stretching, strain histori displai figur 16 consist cycl biaxial, load- ing/unload stretch (time step 1 100) biaxial loading/unload 55 0 3 6 9 12 15 18 21 24 4 6 8 10 12 14 16 18 20 22 24 26 28 30 500 1500 2500 3500 4500 5500 4 6 8 10 12 14 16 18 20 22 24 26 28 30 level truncat actual ( ) u n ns= 2 g g u n n p n = level truncat (a) ( ) u n ns= m c ro s c o p . s tr e s s e rr o r (% ) l o c l s p e e d u p f c r (b) estim figur 17: a) macroscop error estim erom,m (see eq.(125)) versu level truncat (n = nu) case test trajectori shown figur 16,. b) local speedup factor sloc (defin eq.(126)) report case versu level truncation. plot accompani graph ratio ng/p, ng = 38984 total number gauss point finit element mesh, p = 2n number sampl point emploi numer integr hp-rom. compress (time step 101 200). graph macroscop error esti- mator (125) correspond input strain path function level truncat repres figur 17.a. readili perceiv that, case, contrast situat encount previous discuss input strain trajectory, macroscop stress zero number pod mode includ basi increases. rather, graph drop sharpli 24% approxim 5% n = nu = 5 (second inelast mode), fluctuat erratically, appar trend, be- tween 3% 10% level accuraci that, nevertheless, deem 56 macro y (hp-rom, 6)nss = macro y (finit element m.) macro x (hp-rom, 6)nss = macro x (finit element m.) ( ) x e m c ro s c o p ic s tr e s s ( m p ) macroscop longitudin strain -3.5 -3 -2.5 -2 -1.5 -1 -0.5 0 0.5 1 1.5 2 2.5 3 3.5 -150 -100 -50 0 50 100 150 3 x 10 - figur 18: longitudin transvers macroscop stress versu longitudin macro- scopic strain comput fem hp-rom n = nu = 6 (for case test trajectori shown figur 16) . accept practic applications. clear pictur accuraci approxim particular case n = nu = 6 obtain stress-strain diagram shown figur 18. 9.8. speedup analysi lastly, turn attent main concern present work: issu comput efficiency. given error level, time propos hp-rom speed calcul rve respons respect refer finit element model? let defin local speedup factor ratio sloc := tfe(n, ng) trom(n, nu, p) , (126) tfe trom denot cpu time requir comput fe hp-rom macro-stress responses, respectively, induc given input strain history23 figur 17.b, graph speedup factor 23the comput cost associ offlin stage gener snapshot plu compar neglig expens appli pod select sampl 57 report case input strain path figur 16 function number pod mode includ analysi (recal respect nu = n = p/2). plot figur 17.b ratio ng/p, i.e., relat total number integr point finit element model ( ng = 38984) reduc order model (p). glean figur 17.b report speedup factor order magnitud ratio ng/p; i.e.: sloc ng p = ng 2n , (127) (thi indic evalu stress integr point domin total comput cost). result doubt influenc bias particular program languag code style emploi us in-house, non-vector matlab program operat- ing linux platform, and, consequently, trend exactli observ program languag and/or platforms, serv provid idea tremend gain perform achiev propos rom; n = p = 6 modes, instance, comput cost reduc factor 3600, captur 95% full-order, high-fidel inform essenti information. 10. conclud remark strike featur propos reduced-ord model conceptu simplic rve equilibrium equat hyperreduced-ord form: sum (reduced) intern forc pre- select sampl point ident result calcul observ stress fit stresses. condit appears, hind- sight, reasonable, obviou ensur maximum resembl reduced-ord full-ord respons sampl point difficult arriv benefit integr procedur base notion expand approxim space advoc present paper. pointsha deliber rule speedup analysi because, two-scal homogen contexts, rve equilibrium problem solv sheer number time and, consequently, overhead cost quickli amortized. 58 hyperreduc form rve equilibrium equat excel conceptu simplicity; correspond solut scheme simpl implement. take departur point exist fe code, replac typic loop element fe code loop pre-select sampl point {xi1 ,xi2, . . .xip}. stress vector correspond constitut tangent matric obtain stage loop store gappi weight vector matrix c, respec- tively, and, residu vector jacobian matrix comput b t b t c b , respectively. notic assembl process needed, worri impos boundari conditions. converg achieved, macroscop stress valu simpli calcul m = t. emphas oper count solv hyperreduc rve equat updat macroscop stress vector de- pend exclus reduc dimens nu p (number fluctuat mode number sampl points, respectively). likewise, storag histori data (intern variables) requir pre-select sampl points. comput save accrue, thus, term number operations, term memori requirements. success propos homogen strategi predic assumpt displac stress field induc parametr depend input macroscop strain approxim (rela- tively) low-dimension functions. numer result shown preced section suggest that, general, assumpt expect hold case materi govern strain harden law small strain regim regardless geometr complexity, number distribut heterogen rve. however, mean appar conclus easili extend (kinemat phenomenologically) complex scenarios, involv larg deformations, strain localization, decohesion, etc. instance, deform be- havior rve affect multipl propag crack repres parsimoni manner, case strain hardening? number mode necessari accur replic respons combi- natori increas number potenti crack path (i.e., geometr complex rve)? undoubtedly, complex, non- linear scenarios, task sampl paramet space i.e., choos macro-strain histori obtain snapshot complicated, rich possibl deform pattern (void closure, propag discontinu ...), difficult carri 59 intuit basi (a present paper). therefore, desir systemat crucial task, provid statist mean certify, speak, repres chosen snapshots. likewise, topolog variat caus phenomena render pod-bas compress algorithm inappropri collaps dimens snapshot space; cases, nonlinear dimension reduct method isomap algorithm [43] suitable. research front current progress report forth- come publications. acknowledg research lead result receiv fund from, hand, european research council european union seventh framework programm (fp/2007-2013) / erc grant agreement n. 320815, advanc grant project comp-des-mat, and, hand, spanish ministri scienc innov grant bia2011-24258. a. proper orthogon decomposit formal statement pod problem goe follows: given ensembl snapshot {u1,u2, . . .unsnp}, set nu < nsnp orthogon basi function {1,2, . . .nu} (i vsnpu ) error defin eu(nu) := nsnp k=1 uk puk2l2() (128) minimized. here, puk repres project uk subspac span basi function {i}nui=1, l2() symbol l2 norm. shall denot (i = 1, 2 . . . nu) column vector contain valu basi function node underli finit element mesh. likewise, matrix form vectors, = [ 1 2 ] rndnu , call reduc basi matrix. reduc basi matrix comput snapshot matrix xu mean singular valu decomposit (svd) follow (see 60 ref. [16] details). defin matrix24 mij := ni(x)nj(x) d i, j = 1, 2 . . . n. (129) let m = m t m choleski decomposit m, let xu denot matrix defin as: xu := mxu. (130) then, comput reduc svd [37] xu, is, factor xu = u sv t , (131) v rnsnpr (r rank xu) u rndr stand matric right left singular vectors, respectively; s rrr diagon matrix contain singular valu xu. th column reduc basi matrix final relat th left singular vector xu express = m 1 u i, = 1, 2 . . . nu. (132) b. elastic/inelast reduc basi matrix appendix devot provid detail concern actual numer implement elastic/inelast partit strategy, pre- sent section 3.2.1, comput reduc basi matric (displac fluctuations). step arriv desir matrix basi summar following. 1. comput finit element stress solut representative, input macro- strain histories. 2. store displac fluctuat solut comput time step macro-strain trajectori displac fluctuat snapshot matrix xu rndnsnp: xu = [ u 1 u 2 unsnp ] (133) 24 note that, densiti factor, matrixm similar mass matrix appear finit element implement dynam problems. implement purposes, simpli us lump version matrix. 61 3. pick xu minimum (me = 6 3d problems, = 3 plane strain) linearli independ column correspond pure elast solutions. store column matrix zelu . 4. perform reduc singular valu decomposit (svd) matrix defin z el u := mz el u (134) m matrix choleski factor m ( m = m t m). basi matrix range(zelu ) final obtain d el := m 1 d el (135) d el rndme matrix left singular vector aris svd z el u . principle, d el desir elast basi matrix el. however, del enjoi optim properti respect xuit optim respect matrix z el u chosen elast snapshots. 5. consist approximation, thus, prefer deriv el elast compon xu orthogon project xu range(d el); express project reads: x el u = d el(del t mxu) (136) elast basi matrix final calcul xelu as: el := m 1 el . (137) el matrix left singular vector emerg re- duce svd x el u := mx el u ; i. x el u = el s el u v el u t . 6. calcul inelast compon x inu snapshot matrix xu as: x u = xu xelu ; (138) is, x inu orthogon project xu orthogon complement, range(xu), range( el). 7. inelast snapshot matrix x inu appli pod order identifi unveil essenti energet inelast fluctuat modes. carri reduc svd x u = mx u : x u = d s u v u t . (139) 62 th pod basi vector x inu given by: ini = m 1 d , = 1, 2 . . . nu me. (140) 8. desir basi matrix rndnu adopt final form: = [el in] = [ elast mode el1 el 2 elm essenti inelast mode in1 2 innum ] (141) c. block matrix pseudoinvers expand basi matrix invers 2x2 symmetr block matrix given follow express (see, instance, ref. [11]): m1 = [ b bt c ]1 = [ a1 +a1bs1bta1 a1bs1 s1bta1 s1 ] (142) s = cbta1b (143) so-cal schur complement m. formula deriv closed-form express modal coeffici cad cin (see section 6.2). departur point equat eq.(67): [ cad cin ] = ([ b]) = [ t t b b t b t b ]1 [ t b t ] , (144) ([ b]) design pseudo-invers gappi expand basi matrix. setting: = t , b = t b , c = b t b , (145) insert eq.(142) eq.(144), obtain expansion: cin = s1 ( bta1t + bt ) (146) cad = ( ( a1 +a1bs1bta1 ) t a1bs1bt ) = a1 t +a1b c s1 ( bta1t + bt ) = a1 t +a1bcin. (147) 63 substitut eq.(145) equation, take ac- count that: = ( t )1 t (148) final gets: c ad = ( bcin), (149) cin = s1b t ( ) , (150) s = b t (i )b. (151) refer [1] abdulle, a., bai, y., 2012. adapt reduc basi finit element het- erogen multiscal method. [2] abdulle, a., bai, y., 2012. reduc basi finit element heterogen multiscal method high-ord discret ellipt homogeniza- tion problems. journal comput physics. [3] an, s., kim, t., james, d., 2009. optim cubatur effici integr subspac deformations. acm transact graphic 27 (5), 165. [4] ashby, m., 1992. physic model materi problems. materi scienc technolog 8 (2), 102111. [5] astrid, p., 2004. reduct process simul models: proper or- thogon decomposit approach. technisch universiteit eindhoven. [6] astrid, p., weiland, s., willcox, k., backx, t., 2008. miss point estim model describ proper orthogon decomposition. automat control, ieee transact 53 (10), 22372251. [7] barrault, m., maday, y., nguyen, n., patera, a., 2004. empir interpolationmethod: applic effici reduced-basi discretiza- tion partial differenti equations. compt rendu mathematiqu 339 (9), 667672. 64 [8] bishop, c., en ligne), s. s., 2006. pattern recognit machin learn- ing. vol. 4. springer new york. [9] bohm, h., 1998. short introduct basic aspect continuum micromechanics. cdl-fmd report 3. [10] boyaval, s., 2007. reduced-basi approach homogen period setting. arxiv preprint math/0702674. [11] boyd, s., vandenberghe, l., 2004. convex optimization. cambridg univ pr. [12] bui-thanh, t., 2007. model-constrain optim method re- duction parameter large-scal systems. ph.d. thesis, citeseer. [13] bui-thanh, t., willcox, k., ghattas, o., 2008. model reduct large-scal system high-dimension parametr input space. siam journal scientif comput 30 (6), 32703288. [14] carlberg, k., bou-mosleh, c., farhat, c., 2011. effici non-linear model reduct least-squar petrovgalerkin project com- pressiv tensor approximations. intern journal numer method engin 86 (2), 155181. [15] carlberg, k., farhat, c., 2008. compact proper orthogon decom- posit basi optimization-ori reduced-ord models. aiaa paper 5964, 1012. [16] carlberg, k., farhat, c., 2011. low-cost, goal-ori compact proper orthogon decompositionbasi model reduct static systems. intern journal numer method engin 86 (3), 381 402. [17] chaturantabut, s., sorensen, d., 2009. applic pod deim dimens reduct nonlinear miscibl viscou finger porou media. [18] chaturantabut, s., sorensen, d., 2010. discret empir interpola- tion nonlinear model reduction. in: decis control, 2009 held jointli 2009 28th chines control conference. cdc/ccc 2009. proceed 48th ieee confer on. ieee, pp. 43164321. 65 [19] cook, r., 1995. finit element model stress analysis. john wilei sons., new york. [20] couegnat, g., 2008. approch multiechel du comport mecaniqu materiaux composit renfort tisse. ph.d. thesis, universit scienc et technologies-bordeaux i. [21] cremonesi, m., neron, d., guidault, p.-a., ladeveze, p., 2013. pgd- base homogen techniqu resolut nonlinear multi- scale problems. method appli mechan engineer- ing 267, 275292. [22] souza neto, e., feijoo, r., 2006. variat foundat multi- scale constitut model solid: small larg strain kinemat formulation. lncc research & develop report 16. [23] devore, r., iserles, a., suli, e., 2001. foundat comput mathematics. cambridg univ pr. [24] drago, a., pindera, m., 2007. micro-macromechan analysi het- erogen materials: macroscop homogen vs period mi- crostructures. composit scienc technolog 67 (6), 12431263. [25] dvorak, g., wafa, a., bahei-el-din, y., 1994. implement transform field analysi inelast composit materials. compu- tation mechan 14 (3), 201228. [26] efendiev, y., galvis, j., gildin, e., 2012. local-glob multiscal model reduct flow high-contrast heterogen media. journal comput physics. [27] efendiev, y., galvis, j., thomines, f., 2012. systemat coarse-scal model reduct techniqu parameter-depend flow highli het- erogen media applications. [28] everson, r., sirovich, l., 1995. karhunenloev procedur gappi data. journal optic societi america 12 (8), 16571664. [29] feyel, f., chaboche, j., 2000. fe-2 multiscal approach model elastoviscoplast behaviour long fibr sic/ti composit materials. method appli mechan engin 183 (3), 309 330. 66 [30] fish, j., shek, k., pandheeradi, m., shephard, m., 1997. comput plastic composit structur base mathemat homogeniza- tion: theori practice. method appli mechan engin 148 (1-2), 5373. [31] galbally, d., fidkowski, k., willcox, k., ghattas, o., 2010. non-linear model reduct uncertainti quantif large-scal invers problems. intern journal numer method engin 81 (12), 15811608. [32] geers, m., kouznetsova, v., brekelmans, w., 2010. multi-scal compu- tation homogenization: trend challenges. journal computa- tional appli mathemat 234 (7), 21752182. [33] grepl, m., maday, y., nguyen, n., patera, a., 2007. effici reduced- basi treatment nonaffin nonlinear partial differenti equations. mathemat model numer analysi 41 (3), 575605. [34] gross, d., seelig, t., 2011. fractur mechanics: introduct micromechanics. springer. [35] hernandez, j. a., oliver, j., huespe, a., caicedo, m., 2012. high- perform model reduct procedur multiscal simulations. monograph cimn (isbn:978-84-9939640-6-1). url [36] hoffman, j. d., 2001. numer method engin scientists. marcel dekker. [37] hogben, l., 2006. handbook linear algebra. chapman & hall/crc. [38] hu, y., hwang, j., perry, s., 2002. handbook neural network signal processing. journal acoust societi america 111, 2525. [39] kim, t., james, d., 2009. skip step deform simul onlin model reduction. in: acm siggraph asia 2009 papers. acm, pp. 19. [40] kouznetsova, v., 2002. comput homogen multi- scale analysi multi-phas materials. 67 [41] krysl, p., lall, s., marsden, j., 2001. dimension model reduct non-linear finit element dynam solid structures. intern journal numer method engin 51 (4), 479504. [42] kunisch, k., volkwein, s., 2010. optim snapshot locat comput- ing pod basi functions. esaim: mathemat model numeri- cal analysi 44 (3), 509. [43] li, z., wen, b., zabaras, n., 2010. comput mechan respons variabl polycrystallin microstructur dimension re- duction techniques. comput materi scienc 49 (3), 568581. [44] lovasz, l., pelikan, j., vesztergombi, k., 2003. discret mathematics: elementari beyond. springer. [45] lubliner, j., 1990. plastic theory. mcmillan, new york. [46] maday, y., nguyen, n., patera, a., pau, g., 2007. general, multipur- pose interpol procedure: magic points. [47] maday, y., patera, a., turinici, g., 2002. reliabl real-tim solut parametr partial differenti equations: reduced-basi output bound methods. [48] michel, j., moulinec, h., suquet, p., 1999. effect properti com- posit materi period microstructure: comput ap- proach. method appli mechan engin 172 (1- 4), 109143. [49] michel, j., suquet, p., 2003. nonuniform transform field analysis. intern journal solid structur 40 (25), 69376955. [50] michel, j., suquet, p., 2004. comput analysi nonlinear com- posit structur nonuniform transform field analysis. method appli mechan engin 193 (48-51), 54775502. [51] monteiro, e., yvonnet, j., he, q., 2008. comput homogeniza- tion nonlinear conduct heterogen materi model reduction. comput materi scienc 42 (4), 704712. 68 [52] montgomery, d., runger, g., 2010. appli statist probabl engineers. wiley. [53] nguyen, n., 2008. multiscal reduced-basi method parametr ellipt partial differenti equat multipl scales. journal comput physic 227 (23), 98079822. [54] nguyen, n., patera, a., peraire, j., 2008. best point interpol method effici approxim parametr functions. int. j. numer. meth. engng 73, 521543. [55] quarteroni, a., sacco, r., saleri, f., 2000. numer mathematics. springer, new york. [56] roussette, s., michel, j., suquet, p., 2009. nonuniform transform field analysi elastic-viscoplast composites. composit scienc technolog 69 (1), 2227. [57] rozza, g., 2009. reduc basi method stoke equat domain non-affin paramet dependence. comput visual scienc 12 (1), 2335. [58] ryckelynck, d., 2005. priori hyperreduct method: adapt approach. journal comput physic 202 (1), 346366. [59] ryckelynck, d., 2009. hyper-reduct mechan model involv intern variables. intern journal numer method en- gineer 77 (1), 7589. [60] salomon, d., 2004. data compression: complet reference. springer- verlag new york incorporated. [61] simo, j. c., hughes, t. j. r., 1998. comput inelasticity. springer, new york. [62] yvonnet, j., he, q., 2007. reduc model multiscal method (r3m) non-linear homogen hyperelast media finit strains. journal comput physic 223 (1), 341368. 69 introduct motiv goal reduced-basi method dimension reduct numer integr origin work main origin contribut rve equilibrium problem preliminari variat formul trial test space formal statement finit element formul comput reduc basi sampl input paramet space dimension reduct elastic/inelast reduc basi function galerkin project reduc subspac stress approxim space reduced-ord subspac static admiss stress (v*) ill-posed hp-rom propos remedy: expand space approach continuum formul discret formul high-perform rom gappi vector least-squar fit reconstruct matrix ``hyperreduced'' rve equilibrium equat physic interpret jacobian matrix posit definit select sampl point optim criteria accuraci spectral properti optim approach: basic stabil sampl point summari numer result microstructur descript rve finit element discret sampl paramet space dimension reduction: priori error analysi sampl point basic sampl point stabil sampl point posteriori errors: consist analysi ``training'' error uniaxi compress biaxil loading/unload test speedup analysi conclud remark proper orthogon decomposit elastic/inelast reduc basi matrix block matrix pseudoinvers expand basi matrix