upcommon portal del coneix obert de la upc http : //upcommons.upc.edu/e-print aquesta s una cpia de la versi author  final draft d'un articl publicat la revista intern journal numer method engin url d'aquest document upcommon e-print : http : //hdl.handle.net/2117/86862 articl publicat / publish paper : franci , a. , oat , e. carbonel , j. m. ( 2015 ) , effect bulk tangent matrix partit solut scheme near incompress fluid .
int .
j. numer .
meth .
engng , 102 : 257277 .
doi : 10.1002/nme.4839 .
http : //upcommonsdev.upc.edu/ http : //upcommonsdev.upc.edu/ http : //upcommons.upc.edu/e-print http : //hdl.handle.net/2117/86862 intern journal numer method engin int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl [ version : 2002/09/18 v2.02 ] effect bulk tangent matrix partit solut scheme near incompress fluid alessandro franci1 , eugenio onate1,2 , josep maria carbonell1,2 1 centr internacion de metod numer en enginyeria ( cimn ) campus nort upc , 08034 barcelona , spain email : falessandro , onat @ cimne.upc.edu 2 universitat politecnica de catalunya ( upc ) , email : cpuigbo @ cimne.upc.edu summari purpos paper studi effect bulk modulus iter matrix analysi quasi-incompress free surfac fluid flow use mix lagrangian finit element formul partit solut scheme .
practic rule set valu pseudo-bulk modulus priori tangent bulk stiff matrix improv condit linear system algebra equat also given .
effici propos strategi test sever problem analyz advantag modifi bulk tangent matrix regard stabil pressur field , converg rate comput speed analys .
techniqu test fic/pfem lagrangian formul present [ 18 ] easili extend quasi-incompress stabil finit element formul .
copyright c 2010 john wiley & son , ltd. key word : quasi-incompress fluid , bulk modulus , mass conserv , ill-condit , finit calculus , finit element method , particl finit element method , partit scheme .
1 .
introduct various approach develop last year approxim fluid flow mean quasi-incompress materi .
practic , consid navier-stok problem modifi mass conserv equat slight compress ad fluid .
previous work , see exampl [ 21 , 30 ] , fluid compress introduc relax incompress contraint mean penalti paramet  follow manner : v = 1  p ( 1 ) correspond : cimn , edificio c1 , campus nort , upc , gran capitan s/n , 08034 barcelona , spain contract/gr sponsor : publish art research council ; contract/gr number : 981846389 receiv 17 januari 2007 copyright c 2010 john wiley & son , ltd. revis 2 a. franci , e. onat j.m .
carbonel v volumetr strain rate p pressur ( assum posit tension ) .
classic mass conserv equat fulli incompress fluid recov eq .
( 1 ) consid  .
altern , small compress fluid introduc consid actual bulk modulus fluid  , give oper physic mean , [ 7 , 12 , 30 ] .
mass conserv equat written : v = 1  p t ( 2 )  = c2 ,  densiti c speed sound fluid .
work , latter approach follow .
success quasi-incompress formul fluid mechan reli import advantag numer point view .
obvious one eq .
( 1 ) eq .
( 2 ) give direct relat two unknown field navier-stok problem , veloc pressur .
extrem use problem solv use partit scheme velocity-pressur relat crucial deriv tangent matrix momentum equat .
furthermor , anoth import drawback fulli incompress scheme elud .
fact , incompress constraint lead diagon block zero matrix global matrix system .
consequ , pivot procedur requir solv numer kind linear system .
well known comput cost associ oper high increas number degre freedom problem .
compress term eman eq .
( 1 ) ( 2 ) fill diagon global matrix overcom numer difficulti .
hand , quasi-incompress scheme insert numer model paramet typic high valu lead differ numer instabl .
exampl , larg valu penalti paramet , equal , physic valu bulk modulus , compromis qualiti analys even prevent converg solut scheme , [ 30 ] .
reason , general , valu actual bulk modulus reduc arbitrarili so-cal pseudo bulk modulus .
nevertheless , excess small valu pseudo bulk modulus chang drastic mean continu equat origin navier- stoke problem ; word , incompress constraint would satisfi .
furthermor , bulk modulus proport speed sound propag materi .
henc , guarante order magnitud veloc problem sever time smaller veloc sound medium .
paper , present new numer solut scheme near incompress fluid excel converg mass preserv featur .
method base use pseudo-bulk modulus p tangent matrix use iter solut discret momentum equat written lagrangian form ( use instanc finit element method ( fem ) [ 30 ] ) , actual physic valu bulk modulus  use numer solut mass conserv equat .
pseudo-bulk modulus p defin  priori  proport actual bulk modulus fluid ( i.e .
p =  0 <  < 1 ) .
simpl procedur comput scale factor  present .
method propos work improv term mass conserv overal effici numer solut scheme versus similar method use arbitrarili defin pseudo-bulk modulus continu mass conserv copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut scheme 3 equat [ 2326 ] .
method present also relat so-cal augment lagrangian ( al ) procedur solv navier-stok equat incompress [ 2 , 3 , 8 , 9 , 28 ] weak compress [ 4 , 27 ] flow .
key problem al procedur definit al paramet use modifi origin set momentum equat defin adequ precondit matrix .
method propos pseudo-bulk modulus play role al paramet momentum equat .
hand ,  compress  form mass conserv matrix use togeth adequ stabil procedur base finit calculus ( fic ) techniqu [ 15 , 16 , 20 , 22 ] .
fic stabil method ensur correct solut quasi fulli incompress situat equal order interpol use veloc pressur , case work linear interpol use variabl .
inde procedur comput pseudo-bulk modulus work appli estim al paramet near incompress fluid .
method test analysi quasi-incompress fluid use stabil lagrangian fic-fem formul present [ 18 ] .
mention work , particular class lagrangian fem term particl finit element method ( pfem , www.cimne.com/pfem ) [ 6 , 13 , 14 , 19 ] use .
pfem treat mesh node particl freeli move even separ main fluid domain repres , instanc , effect water drop .
mesh connect node discret domain govern equat solv use stabil fem .
linear interpol adopt pressur veloc field .
choic fullfil so-cal lbb inf  sup condit [ 5 , 7 , 29 ] .
mention , requir stabil provid finit calculus ( fic ) method [ 15 , 16 , 20 , 22 ] .
lay-out paper follow .
first section govern equat quasi-incompress lagrangian fluid given .
fulli discret form deriv use finit element space newmark scheme time .
fic-stabil form [ 18 ] problem introduc numer model .
, increment solut discret equat deriv .
formul describ , effect bulk modulus solut scheme studi .
particular , effect linear solver converg , qualiti solut pressur field , rate converg scheme mass conserv fluid analyz .
effici method predict optimum valu pseudo bulk modulus propos .
particular fulli incomprens fluid briefli describ .
last part paper numer result water flow obtain method propos shown .
good properti numer scheme term general accuraci comput effici discuss .
2 .
lagrangian formul quasi-incompress fluid 2.1 .
govern equat fulli discret form govern equat problem linear momentum balanc equat mass conserv equat quasi-incompress fluid .
lagrangian descript , equat read : copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 4 a. franci , e. onat j.m .
carbonel linear momentum balanc equat  dvi dt  ij xj  bi = 0 , , j = 1 , ns t  ( 0 , ) ( 3 ) vi bi veloc bodi forc compon along ith cartesian axi ,  densiti fluid , ns number space dimens ( i.e .
ns = 3 3d problem ) ij compon cauchi stress tensor .
mass conserv equat v  1  p t = 0 , t  ( 0 , ) ( 4 ) v volumetr strain rate  bulk modulus fluid .
boundari condit vi  v p = 0 v ( 5a ) ijnj  p = 0 t ( 5b ) v p p , = 1 , ns prescrib veloc prescrib traction dirichlet ( v ) neumann ( t ) boundari , respect .
govern equat discret space use linear shape function veloc pressur field accord standard galerkin finit element method ( fem ) [ 29 ] .
time discret perform use classic trapezoid rule [ 1 ] .
fulli discret form problem read : ( 2 t mv + k ) vn+1 + qpn+1 = fn ( 6a ) 1 t mp ( pn+1  pn ) qt vn+1 = 0 ( 6b ) : fn = fv + mv ( 2 t vn + vn ) ( 6c ) previous equat , subindic refer time step variabl comput upper bar denot nodal valu unknown .
exampl , pn nodal pressur time tn = nt .
matric introduc ( 6 ) assembl element contribut given box 1 .
copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut scheme 5 mvij =  e nti njd , kij =  e bti dbjd , qij =  e bti mnjd mpij =  e 1  ninjd , fvi =  e nti bd +  t nti td bi =   ni x 0 0 0 ni y 0 0 0 ni z ni y ni x 0 ni z 0 ni x 0 ni z ni y   ni =   ni 0 00 ni 0 0 0 ni   ni linear shape function =    4/3 2/3 2/3 0 0 0 4/3 2/3 0 0 0 4/3 0 0 0 2 0 0 sym .
2 0 2   , = [ 1 , 1 , 1 , 0 , 0 , 0 ]  dynam viscos fluid box 1 .
element form matric vector eq .
( 6 ) 2.2 .
stabil procedur use fic interpol order veloc pressur field fullfil so-cal lbb inf  sup condit [ 5 ] .
consequ numer scheme need stabil .
requir stabil introduc via finit calculus ( fic ) techniqu present [ 18 ] .
mention work , fic-bas stabil finit element formul quasi-incompress lagrangian fluid present success appli analysi sever free surfac flow problem .
formul show excel mass preserv properti .
detail formul lie outsid object work found [ 18 ] .
basic , linear momentum equat chang stabil mass conserv equat copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 6 a. franci , e. onat j.m .
carbonel read :   q  dp dt d +    c2 d2p dt2 d   qvd +    q xi (  xi ( 2ij ) + p xi + bi ) d   t q [ dvn dt  2 hn ( 2n + p tn ) ] d = 0 ( 7 ) index (  ) n denot normal project variabl  stabil paramet given :  = ( 8 h2 + 2  ) 1 ( 8 ) h  characterist distanc space time , respect .
practic , h  order magnitud element size time step increment , respect [ 18 ] .
discret form stabil mass conserv equat read : ( 1 t mp + 1 t2 mpp + l + mb ) pn+1 qt vn+1 = gn ( 9 ) : gn = fp + 1 t mppn + 1 t mpp ( pn t + pn ) ( 10 ) matric vector introduc stabil term assembl element contribut given box 2 .
mppij =  e   ninjd , lij =  e  ( 5tni ) 5njd , mbij =  t 2 hn ninjd fpi =  t qni [ dvn dt  2 hn ( 2n  tn ) ] d  e 5tnibd box 2 .
element form stabil matric vector eq .
( 9 ) ( 10 ) .
2.3 .
linear linear momentum equat increment solut quasi-incompress form mass conserv equat ( 2 ) use linear linear momentum equat yield direct relat pressur increment veloc .
way , easi split unknown solv global system mean partit increment scheme .
iter matrix solv momentum residu vector refer nodal veloc , nodal pressur appear momentum residu vector right hand side .
linear form momentum equat time step ( + 1 ) -th iter read : hivv i+1 = rim ( 11 ) copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut scheme 7 momentum residu vector rm iter matrix hv given rim = mv v + kvi + qpi  fiv ( 12a ) hv = mt + k + kv ( 12b ) mt mass contribut iter matrix comput : mtij =  e nti  t njd ( 13 ) kv so-cal bulk ( volumetr ) matrix comput follow way : kv =  e btmtpm tbd , p =  ( 14 ) p pseudo-bulk modulus  posit number 0 <   1 .
shown next section paramet key-rol prevent ill- condit iter matrix hv .
notic matrix approxim exact tangent matrix updat lagrangian scheme [ 17 ] .
concern notat , upper indic denot iter converg loop subindic denot time step variabl comput .
consid time interv [ n , n+ 1 ] iter follow step carri : step 1 .
comput nodal veloc increment v hvv = rim  v ( 15 ) step 2 .
updat nodal veloc vi+1n+1 = v n+1 + v ( 16 ) step 3 .
comput nodal pressur pi+1 hipp i+1 n+1 = 1 t mppn + 1 t2 mpp ( 2pn  pn1 ) + gt vi+1n+1 + f p  p i+1 n+1 ( 17 ) hp = 1 t mp + 1 t2 mpp + l + mb ( 18 ) step 4 .
updat nodal posit xi+1n+1 = x n+1 + 1 2 ( vi+1n+1 + vn ) t ( 19 ) step 5 .
check converg verifi : ri+1v = v vn  ev ( 20a ) ri+1p = pi+1n+1  p n+1 pn  ep ( 20b ) ev ep prescrib error norm nodal veloc nodal pressur , respect .
exampl solv work , ev = ep = 10 4 fix .
condit ( 20 ) satisfi , next time step consid .
detail solut scheme use pfem found [ 18 ] .
copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 8 a. franci , e. onat j.m .
carbonel figur 1 : 2d water slosh .
initi geometri finit element mesh .
number element 705 number node 428 averag mesh size 0.4 h1 7 h2 3 10 viscos 103 pas densiti 103 kg/m3 bulk modulus 2.15109 pa tabl : 2d water slosh .
problem data .
3 .
studi effect physic bulk modulus iter matrix linear system describ previous section suffer numer instabl due ill-condit iter matrix hv ( 12b ) .
problem alreadi point previous work similar partit scheme use [ 2326 ] .
ill-condit iter matrix linear momentum equat orgin differ order magnitud two main contribut : mass matrix mt ( 13 ) bulk matrix kv ( 14 ) ( contribut viscous matrix k ( 12b ) neglig low valu viscos ) .
typic term bulk matrix order magnitud larger mass matrix .
reliabl measur qualiti matrix condit number [ 1 ] .
general matrix , condit number defin : c = cond ( ) =    a1  ( 21 ) , work ,   denot norm-2 matrix .
condit number c give indic accuraci result matrix invers linear equat solut .
valu c close 1 indic well-condit matrix .
deterior qualiti matrix hv affect direct converg iter linear solver .
work , iter bi conjug gradient ( bcg ) solver use toler fix 106 .
time step increment affect high condit iter matrix hv .
fact , mt invers proport time increment kv depend linear ( see eq .
( 13 ) ( 14 ) ) .
reason , hv well-condit tight rang time increment .
object section show drawback ill-condit matrix iter solut scheme .
sake clariti , numer exampl use visual quantifi inconveni .
problem chosen 2d water slosh rectangular tank .
initi geometri problem finit element mesh use analysi shown figur 1 .
data problem collect tabl .
highlight import time step condit iter matrix , problem solv two differ time increment without reduc valu modulus matrix kv (  = 1 ) .
use time step t=10 3s , iter matrix copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut scheme 9 condit number c=41 , t= 102s , condit number c=3009 .
larger time step use , linear system even solv .
deterior reflect number iter linear bcg solver : former case averag number iter around 20 , latter around 177 .
clear , also lead signific increas comput time solv time step .
ill-condit linear system also affect rate converg iter loop scheme given eq .
( 15 - 20 ) .
graph fig .
2 converg rate  r  pressur veloc field t=1.75s display .
valu obtain use eq .
( 20 ) consid time step increment t=102s.convergencecomparison page 1 1 5 9 13 17 21 25 0.00001 0.0001 0.001 0.01 0.1 1 veloc pressur iter r figur 2 : 2d water slosh ( =1 ) .
converg veloc pressur t=1.75 s. observ , especi pressur field , converg criteria eq .
( 20b ) satisfi .
fact , pressur error 25 iter still larger pre-defin toler ep = 10 4 .
lack good converg pressur field produc two main inconveni : pressur solut accur mass conserv preserv .
pressur contour t=1.75 shown fig .
3 .
concern mass conserv fluid , fig .
4 show accumul mass variat absolut valu versus time .
20 second simul , percentag mass loss 9.8 % correspond mean volum variat 4.9  103 % time step .
4 .
optimum valu paramet  previous section shown use  = 1 matrix kv , iter matrix hv ( 12b ) ill-condit certain rang time step increment .
princip consequ limit choic time step increment bad converg linear iter solver iter loop describ eq .
( 15 - 20 ) .
inconveni overcom previous public [ 25 , 26 ] substitut physic bulk modulus smaller pseudo bulk modulus p .
way , possibl copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 10 a. franci , e. onat j.m .
carbonel figur 3 : 2d water slosh ( =1 ) .
pressur contour t=1.75 s. figur 4 : 2d water slosh ( =1 ) .
accumul percentag mass variat absolut valu versus time .
extend applic partit scheme larger rang time increment .
howev , strategi base heurist criteria use wide problem requir specif valu p .
word , pseudo bulk modulus work well certain analysi fail differ one .
section , present general techniqu predict priori valu paramet  defin pseudo bulk modulus p eq .
( 14 ) ( p =  ) .
shown strategi improv substanti condit linear system .
enhanc highlight solv problem previous section compar respect result .
point previous section , numer problem associ iter copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut schemes11 matrix hv ( 12b ) due differ order magnitud contribut given kv ( 14 ) mt ( 13 ) .
paramet  eq .
( 14 ) aris linear pressur term momentum equat [ 18 ] use scale ad hoc contribut kv order guarante well-condit system .
shown oper interfer mass conserv fluid .
reason modif affect qualiti iter matrix rate converg linear momentum equat , continu equat , mass conserv constraint impos , modifi .
featur repres innov versus previous approach pseudo bulk modulus also use mass conserv equat .
work , paramet  comput :  = mean ( |mt | ) mean ( | kv | ) ( 22 ) oper ( |  | ) denot mean absolut valu non-zero matrix compon kv =  e btmtmtbd ( 23 ) paramet  enforc term contribut kv iter matrix hv order magnitud mt .
uniform mesh element characterist size h ,  estim follow :   n2c    h2  t2 ( 24 ) nc valu shape function ni element center follow approxim done : ni x  1 h ( 25 ) henc , water consid (  = 103kg/m3  = 2.15  109pa ) linear triangl use ( n = 1/3 ) ,  follow depend mesh size time step .
  5.17  108  ( h t ) 2 ( 26 ) typic , paramet  calcul begin time step first iter non linear loop .
also comput everi time step , certain instant analysi begin analysi .
order magnitud  vari analysi , unless time step chang , refin mesh perform .
case ,  need calcul squar depend paramet h t .
numer result present paper obtain comput  via eq .
( 22 ) begin analys .
paramet  comput assign local element global whole mesh .
calcul global , element bulk contribut iter matrix valu  , otherwis comput eq .
( 22 ) perform consid separ element mesh ; .e .
element differ valu  .
former approach reduc comput cost work wors local copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 12 a. franci , e. onat j.m .
carbonel approach non uniform finit element discret .
particular , recommend use local approach refin mesh perform ( next section , problem refin zone studi ) .
paper , unless otherwis mention , global approach comput  use .
5 .
particular fulli incompress fluid fulli incompress fluid  =  matrix mp vanish discret form mass conserv equat ( eq .
( 6 ) box 1 ) .
use larg finit valu pseudo-bulk modulus p express volumetr matrix kv still use case , help obtain accur solut veloc pressur reduc mass loss iter per time step .
good estim p case obtain p = 100 ( h t ) 2 .
6 .
numer result object section assess enhanc solut given bulk matrix scale priori use paramet  comput eq . ( 22 ) .
method test solv two repres free surfac problem involv flow water : slosh problem introduc section 3 collaps water column rigid obstacl present [ 11 ] .
so-cal dam break problem chosen demonstr strategi affect incompress contraint method abl simul problem impact fluid .
numer result compar experiment one .
slosh dam break problem , comparison perform scale bulk matrix scheme  =1 given .
order show applic general method , differ averag mesh size time step consid problem .
note dynam slosh problem complet differ dam break one .
6.1 .
water slosh tank problem fig .
1 solv use paramet  comput eq . ( 22 ) .
t=103s ,  = 0.154 , t=102s , =0.0053 .
time step increment , result condit number iter matrix c =23 averag number iter linear bcg solver around 15 .
improv versus non reduc scheme evid , compar number present section 3 .
reduc number iter linear solver , also reduc comput time .
exampl , problem solv t=102s durat slosh simul 20s , total comput time case =1 2746s =0.0053 reduc 1600s .
also converg non linear loop improv correct valu  .
fig .
5 6 converg veloc pressur field , respect , obtain =1 =0.0053 , compar .
faster converg solut use smaller valu  notic .
fig .
7 pressur solut time t=1.75s obtain =0.0053 illustr .
copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut schemes13 convergencecomparison page 1 1 5 9 13 17 21 25 0.00001 0.0001 0.001 0.01 0.1 1 = 1 optimum  iter r ( v ) figur 5 : 2d water slosh .
converg veloc t=1.75s =1 =0.0053 .
figur 6 : 2d water slosh .
converg pressur t=1.75s =1 =0.0053 .
appreci remark enhanc respect case =1 ( see fig .
3 ) .
note element generat free surfac region adjac boundari due coars mesh remesh criteria comput .
obtain better result , smaller averag mesh size refin mesh free surfac region use .
state section 3 , converg continu equat affect conserv mass fluid .
shown converg pressur improv use good predict . consequ , also mass conserv better ensur use copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 14 a. franci , e. onat j.m .
carbonel figur 7 : 2d water slosh ( =0.0053 ) .
pressur contour t=1.75s .
=0.0053 use =1 .
graph fig .
8 percentag accumul mass variat ( absolut valu ) versus time obtain =1 =0.0053 compar .
better mass preserv solut smaller valu  remark .
figur 8 : 2d water slosh .
accumul mass variat absolut valu along durat analysi .
solut =1 =0.0053 .
graph fig .
9 accumul mass variat obtain =0.0053 illustr .
20 second simul , scheme reduc valu  accumul mass variat 0.52 % correnspond mean volum variat time step 1.7103 % .
solut =0.0053 guarante better conserv mass case =1 .
repres anoth evid ( quasi ) -incompress constraint copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut schemes15 affect reduct bulk matrix iter matrix solv momentum equat .
figur 9 : 2d water slosh ( =0.0053 ) .
accumul mass variat versus time .
variat mesh size order verifi applic method , slosh problem solv use t=103s differ mesh size .
particular , follow averag mesh size use : h =0.1m , 0.15m , 0.2m , 0.3m 0.4m .
problem solv set =1 comput priori reduc valu use eq . ( 22 ) .
tabl fig .
10 collect data result .
number iter linear solver consid qualiti indic analys .
shown previous section valu relat condit number iter matrix .
curv fig .
10 show , forese , reduc valu  guarante better result respect use  = 1 .
mesh , number iter requir linear solver reach converg solut smaller .
furthermor , result show strategi applic coars fine mesh .
variat time step problem fig .
1 solv use differ time step : 0.0001s , 0.0005s , 0.001s , 0.005s , 0.01s , 0.02s .
mesh use mean size 0.15m .
numer result obtain reduc valu  set =1 compar .
tabl fig .
11 summar problem data result .
, iter linear solver paramet chosen indic qualiti analys : smaller valu , better condit linear system .
graph fig .
11 show accuraci method depend time step increment , suitabl valu  use .
valu t , number iter 16 condit number chang .
furthermor , use correct valu  allow us solv problem time increment ,  fix 1 , result accept t=0.005s .
larger time step result use =1 copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 16 a. franci , e. onat j.m .
carbonel averag degre freedom number iter mesh size ( veloc ) =1 optimum  0.4 682 20 15 ( =0.535 ) 0.3 1220 27 15 ( =0.304 ) 0.2 2782 41 15 ( =0.136 ) 0.15 5002 55 16 ( =0.0801 ) 0.1 5840 70 15 ( =0.0361 ) figur 10 : 2d water slosh .
number iter linear solver differ number veloc degre freedom .
result =1 optimum valu . accur analys even converg .
mesh refin zone mention previous section , paramet  squar depend mesh size ( see eq . ( 24 ) ) .
reason , discret uniform global estim  might guarante well-condit linear system .
case , local comput  recommend .
slosh problem solv use mesh shown fig .
12 t = 0.01s .
spatial discret two differ mean size : center h=0.1m h=0.4m elsewher .
problem solv use =1 comput optimum valu global local .
mean number iter requir linear solver converg htese three option 319 , 21 17 respect .
henc , local approach guarante best result type non-uniform mesh .
fig .
13 solut time = 0.1s obtain local approach illustr .
case high viscos high viscos may improv condit iter matrix hv .
fact , copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut schemes17 t ( ) number iter =1 optimum  0.02 fail 16 ( =2.00 105 ) 0.01 523 16 ( =8.01 104 ) 0.005 244 16 ( =3.20 103 ) 0.001 55 16 ( =8.01 102 ) 0.0005 30 16 ( =3.89 101 ) 0.0001 6 16 ( =8.01 ) figur 11 : 2d water slosh .
number iter linear solver differ time step increment .
result =1 optimum valu . contribut k opposit sign versus kv .
slosh problem solv valu dynam viscos =102pas .
time increment t = 102s .
fig .
14 solut = 5 .5s obtain two approach illustr .
strategi converg almost numer valu .
show propos method also use high viscous fluid .
condit number hv use  =1 c=2318 ( note , expect , valu lower obtain water slosh case )  = 5.35 103 c=23 .
conclus , high viscous fluid , propos method work also lead better condit tangent matric  =1 .
6.2 .
collaps water column rigid obstacl section , collaps water column induc instant remov vertic wall studi .
previous exampl , problem first solv coars mesh .
comparison solut obtain =1 given .
, problem solv vari mean size mesh differ time step increment .
copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 18 a. franci , e. onat j.m .
carbonel figur 12 : 2d water slosh .
finit element mesh refin zone .
figur 13 : 2d slosh refin zone .
solut time = 0.1s obtain local approach .
result obtain optimum valu  compar experiment result present [ 10 ] .
object show reduct bulk modulus iter matrix affect numer solut class impact problem solv also larger time step .
initi geometri problem illustr fig .
15 .
tabl ii data problem collect .
problem first solv coars discret ( mean element size h=0.0125m ) .
solut obtain optimum valu  =1 compar term condit number iter matrix number iter linear solver .
t=104s , matrix hv condit number c=1028 c=60 , =1 =0.0535 , respect , correspond 1251 14 iter linear solver , respect .
discret time increment t=103s , eq .
( 22 ) yield valu copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut schemes19 figur 14 : 2d high viscous fluid slosh .
pressur contour = 5 .5s .
left : numer result  = 1 .
right : result  = 5 .35  103 .
figur 15 : 2d dam break .
initi geometri .
l 0.146 h 0.048 0.024 viscos 103 pas densiti 103 kg/m3 bulk modulus 2.15109 pa tabl ii : 2d dam break .
problem data .
=0.000535 .
condit number hv iter linear solver use time step increment ten time smaller .
convers , =1 , condit number grow c=102090 iter scheme converg .
variat mesh size problem fig .
15 solv t=104s use unstructur mesh follow mean element size : h= 0.004m , 0.005m , 00075m , 0.01m , 0.0125m .
problem solv set =1 comput priori optimum valu use eq . ( 22 ) .
previous section , number iter linear solver consid qualiti indic analysi .
tabl fig .
16 data result collect .
fig .
16 confirm effici method affect mesh size .
word , well-condit iter matrix guarante coars fine mesh indiffer .
variat time step problem solv differ time step : t=0.00005s , 0.0001s , 0.0005s , 0.001s , 0.0025s .
mesh use mean size h=0.005m .
tabl 17 collect problem data copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 20 a. franci , e. onat j.m .
carbonel averag degre freedom number iter mesh size ( veloc ) =1 optimum  0.0125 618 70 17 ( =0.0536 ) 0.01 978 82 18 ( =0.0345 ) 0.0075 1694 100 16 ( =0.0205 ) 0.005 5002 163 16 ( =0.00868 ) 0.004 6106 196 17 ( =0.00559 ) figur 16 : 2d dam break .
number iter linear solver differ number veloc degre freedom .
result =1 optimum valu . result number iter analys solv =1 optimum valu  .
fig .
17 confirm conclus previous section .
strategi affect time step , contrari case =1 , impos limit rang time step increment solv problem .
exampl , present problem , time step increment constrain geometri dynam problem .
word , maximum time step increment one guarante fluid particl cross boundari .
present problem chosen mesh , maximum time step increment t=2.5  103s .
fig .
18 pressur field comparison experiment result [ 10 ] = 0 .1s , = 0 .2s = 0 .3s shown .
good agreement obtain .
7 .
conclus work , analysi effect physic bulk modulus iter matrix partit finit element scheme analysi quasi-incompress fluid present .
copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut schemes21 t ( ) numer iter =1 optimum  2.5  103 fail 15 ( =1.39 105 ) 1.0  103 fail 15 ( =8.68 105 ) 5.0  104 1000 16 ( =3.47 104 ) 1.0  104 163 16 ( =8.68 103 ) 5.0  105 79 16 ( =3.47 102 ) figur 17 : 2d dam break .
number iter linear solver differ time step .
result =1 optimum valu  .
shown result linear system ill-condit certain time step increment .
shown reason differ order magnitud contribut bulk mass matric solut system .
typic , bulk matrix term larger mass one .
consequ ill-condit algebra equat converg linear iter solver iter loop deterior .
general , effici easi implement strategi overcom problem propos .
techniqu base use pseudo bulk modulus p =  0 <  < 1 matrix kv order improv condit global iter matrix hv .
express comput optimum valu reduct paramet  given .
optimum valu  comput local global , time step first solut step .
depend problem , one altern prefer .
paramet  function scale bulk matrix term iter matrix order magnitud mass matrix one .
- numer exampl shown propos techniqu improv stabil pressur field , converg rate iter solut also comput speed analysi iter system .
also illustr strategi affect chang time step copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 22 a. franci , e. onat j.m .
carbonel figur 18 : 2d dam break .
pressur contour comparison experiment results/left [ 10 ] = 0 .1s , = 0 .2s = 0 .3s .
numer result obtain t = 0.0025s  = 1 .39  105 .
mesh .
furthermor , shown method also advantag viscous fluid local refin mesh .
latter case , local comput paramet  recommend .
final , shown possibl simul impact fluid reduc valu  without affect actual compress fluid .
acknowledg research support advanc grant project safecon european research council .
copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut schemes23 refer [ 1 ] k.j .
bath .
finit element procedur .
prentice-hal , new jersey , 1996 .
[ 2 ] m. benzi , g.h .
golub j. liesen .
numer solut saddl point problem .
acta numerica , 14:1137 , 2005 .
[ 3 ] m. benzi , m.a .
olshanskii z. wang .
modifi augment lagrangian precondit incompress navier-stok equat .
int .
j. num .
meth .
fluid , 66:486508 , 2011 .
[ 4 ] d. bresch , e.d .
fernandez-nieto , i.r .
ionescu p. vigneaux .
augment lagrangian method compress visco-plast flow .
applic shallow dens avalanch .
new direct mathemat fluid mechan .
alexand v. kazhikhov memori volum .
seri book advanc mathemat fluid mechan .
a.v .
fursikov , g.p .
galdi v.v .
pukhnachev ( ed .
) , birkhaus verlag basel , switzerland , 5789 , 2010 .
[ 5 ] f. brezzi .
exist , uniqu approxim saddle-point problem aris lagrang multipli .
revu francais  automatiqu , informatiqu , recherch operationnell .
seri roug .
analys numeriqu , 8 ( r-2 ) :129151 , novemb 1974 .
[ 6 ] j.m .
carbonel , e. onat , b. suarez .
model ground excav particl finite-el method .
journal engin mechan , 136:455463 , 2010 .
[ 7 ] j. donea a. huerta .
finit element method flow problem .
wiley , 2003 .
[ 8 ] h.c. elman , d.j .
silvest a.j .
wathen .
finit element fast iter solver applic incompress fluid dynam .
oxford seri numer mathemat scientif comput .
oxford univers press , oxford , 2005 .
[ 9 ] m. fortin r. glowinski .
augment lagrangina : applic numer solut boundari valu problem .
north-holland , amsterdam , 1983 .
[ 10 ] d.m .
greav .
simul viscous water column collaps use adapt hierarch grid .
intern journal numer method engin , 50:693711 , 2006 .
[ 11 ] b. hubner , e. walhorn , d.dinkler .
monolith approach fluid-structur interact use space-tim finit element .
comput method appli mechan engin , 193:20872104 , 2004 .
[ 12 ] s.r .
idelshon , j. marti , a. limach , e. onat .
unifi lagrangian formul elast solid incompress fluid : applic fluid-structur interact problem via pfem .
comput method appli mechan engin , 197:17621776 , februari 2008 .
[ 13 ] s.r .
idelsohn , e. onat , f. del pin .
particl finit element method : power tool solv incompress flow free-surfac break wave .
intern journal numer method engin , 61:964989 , 2004 .
copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl 24 a. franci , e. onat j.m .
carbonel [ 14 ] a. lares , r. rossi , e. onat , s.r .
idelsohn .
valid particl finit element method ( pfem ) simul free surfac flow .
intern journal computer- aid engin softwar , 25:385425 , 2008 .
[ 15 ] e. onat .
deriv stabil equat advective-diffus transport fluid flow problem .
comput .
meth .
appl .
mech .
engng .
151:233267 , 1998 .
[ 16 ] e. onat .
stabil finit element method incompress viscous flow use finit increment calculus formul .
comput method appl mech engrg .
182 ( 12 ) :355 370 , 2000 .
[ 17 ] e. onat j.m .
carbonel .
updat lagrangian finit element formul quasi fulli incompress fluid .
research report pi393 , cimn .
submit comput .
mechan , 2013 .
[ 18 ] e. onat , a. franci , j.m .
carbonel .
lagrangian formul finit element analysi quasi-incompress fluid reduc mass loss .
accept intern journal numer method fluid , doi : 10.1002/fld.3870 .
[ 19 ] e. onat , s.r .
idelsohn , f. del pin , r. aubri .
particl finit element method .
overview .
intern journal comput method , 1:267307 , 2004 .
[ 20 ] e. onat .
possibl finit calculus comput mechan .
int .
j. num .
meth .
engng .
60 ( 1 ) :255281 , 2004 .
[ 21 ] e. onat , p. nadukandi , s.r .
idelsohn , j. garca , c. felippa .
famili residual- base stabil finit element method stoke flow .
intern journal numer method fluid , 65 ( 1-3 ) :106134 , 2011 .
[ 22 ] e. onat , a. vall , j.garca .
comput turbul flow use finit calculus- finit element formul .
intern journal numer method engin , 54:609637 , 2007 .
[ 23 ] p. ryzhakov .
doctor thesi : lagrangian fe method coupl problem fluid mechan .
universitat politecnica de catalunya , barcelona , spain , 2010 .
[ 24 ] p. ryzhakov , j. cotela , r. rossi , e. onat .
two-step monolith method effici simul incompress flow .
accept intern journal numer method fluid , doi : 10.1002/fld .
[ 25 ] p. ryzhakov , e. onat , s.r .
idelsohn .
improv mass conserv simul incompress flow .
intern journal numer method engin , 90:14351451 , 2012 .
[ 26 ] p. ryzhakov , r. rossi , s.r .
idelsohn , e. onat .
monolith lagrangian approach fluid-structur interact problem .
comput mechan , 46:883899 , 2010 .
[ 27 ] g. vinay , a. wach j.f .
agass .
numer simul weak compress bingham flow : restart pipelin flow waxi crude oil .
j. non-newtonian fluid mechs. , 136 ( 23 ) :93105 , 2006 .
copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl effect bulk tangent matrix partit solut schemes25 [ 28 ] s. vincent , al sarthou , j.p. caltagiron , f. sonilhac , p. fevrier , c. mignot g. pianet .
augment lagrangian penalti method simul two-phas flow interact move solid .
applic hydroplan flow interact real tire tread pattern .
j. comput .
physic , 203 ( 4 ) :956983 , 2013 .
[ 29 ] o.c .
zienkiewicz r.l .
taylor .
finit element method .
basi fundament .
( 6th ed . ) .
elsevi butterworth-heinemann , oxford , 2005 .
[ 30 ] o.c .
zienkiewicz , r.l .
taylor , p. nithiarasu .
finit element method fluid dynam , volum 3 ( 6th ed . ) .
elsiev , oxford , 2005 .
copyright c 2010 john wiley & son , ltd. int .
j. numer .
meth .
engng 2010 ; 00:16 prepar use nmeauth.cl upcommon portal del coneix obert de la upc http : //upcommons.upc.edu/e-print aquesta s una cpia de la versi author  final draft d'un articl publicat la revista journal hydrolog .
url d'aquest document upcommon e-print : http : //hdl.handle.net/2117/86862 articl publicat / publish paper :
