microsoft word - paper_2_phase_v05.doc upcommon portal del coneix obert de la upc http : //upcommons.upc.edu/e-print aquesta s una cpia de la versi author  final draft d'un articl publicat la revista comput particl mechan .
la publicaci final est dispon springer trav de http : //dx.doi.org/10.1007/s40571-018-0204-9 copi author 's final draft version articl publish journal comput particl mechan .
final public avail springer via http : //dx.doi.org/10.1007/s40571-018-0204-9 articl publicat / publish articl : flore , r.m .
[ et al . ]
( 2018 ) implicit unsteadi hydraul solver suspend cut transport manag pressur well .
comput particl mechan .
doi:10.1007/s40571-018-0204-9 http : //upcommonsdev.upc.edu/ http : //upcommonsdev.upc.edu/ http : //upcommons.upc.edu/e-print http : //dx.doi.org/10.1007/s40571-018-0204-9 http : //dx.doi.org/10.1007/s40571-018-0204-9 1 implicit unsteadi hydraul solver suspend cut transport manag pressur well r. flores1* , e. ortega2 , a. ilin3 , d. simpkins4 e. oate1 *correspond author : rflore @ cimne.upc.edu , ( +34 ) 93 401 6038 1intern center numer method engin ( cimn ) , c/ gran capitn s/n , 08034 barcelona , spain 2serra hunter professor escola superior  enginyeri industri , aeroespaci audiovisu de terrassa , universitat politcnica de catalunya ( eseiaat-upc ) , c/ colom 11 , 08222 terrassa , spain 3weatherford intern , 11909 fm 529 road , houston , texa 77041 , usa 4former weatherford intern , houston , texa , usa abstract .
present simul tool transient event complex hydraul network .
code includ model transport suspend cut near-vert well .
unstructur finit volum formul implicit time integr chosen .
uncondit stabil integr make method suitabl simul transient event wide rang characterist time scale .
handl fast transient ( e.g .
fluid hammer event ) well long-term evolut well ( e.g .
hole clean oper ) .
softwar develop address need oil industri robust effici predict tool allow effect well control manag pressur drill oper .
physic model follow standard practic accept industri ( e.g .
mud rheolog comput ) .
mathemat foundat algorithm describ follow valid case illustr capabl accuraci .
final , practic industri applic exampl provid demonstr real-world perform softwar .
keyword : unsteadi , hydraul , oil well , cut transport .
1 introduct manag pressur drill ( mpd ) techniqu enabl precis control annular pressur allow drill well may otherwis practic [ 1,2,3 ] .
convent drill oper , mud outlet ambient pressur , reli hydrostat pressur ( regul chang mud densiti ) well control .
case narrow margin pore pressur format fractur threshold , convent drill becom unfeas .
maintain tighter pressur control ( e.g .
use choke valv back-pressur pump surfac ) mpd overcom limit ( see fig .
1 ) .
2 mud & cut drillstr case case section format clean mud uncas section mud pump mud tank back-pressur pump choke valv c e e g e n surfac back-pressur case point format fractur hydrostat head friction loss pressur e p th annular mud pressur pore pressur fig .
1 simplifi schemat mpd well ( left ) annulus pressur vs. depth diagram ( right ) howev , ensur continu safeti , accur well control strategi short reaction time need .
call predict tool capabl comput respons well control input ( e.g .
valv oper back-pressur pump set ) near real- time .
moreov , timescal relev phenomena span mani order magnitud ; fluid hammer event ( 10-2 ) hole clean activ ( hour day ) .
case analysi softwar abl provid solut within timefram second safe oper maintain .
request weatherford intern plc , intern center numer method engin ( cimn ) develop unsteadi solver hydraul network includ model suspend cut transport .
weatherford specif demand capabl solv short long transient less ten second use commod desktop hardwar .
would allow futur incorpor technolog automat well control system [ 4 ] .
common choic solv water hammer problem method characterist [ 5,6 ] .
howev , explicit techniqu best suit uniform space grid , becom increas complex speed sound fluid constant ineffici comput long-term respons hydraul network .
hand , 3 implicit method , usual base finite-differ scheme , propos .
allow larger time step , thus improv behaviour comput slow transient [ 7,8 ] .
unfortun , comput cost per time step implicit method tend high , make ineffici appli fluid hammer simul [ 9 ] .
thus , choic method ( implicit/explicit ) usual depend time scale interest ( long/short , respect ) .
paper present effici implicit method suitabl simul short long transient , well steady-st simul .
great simplifi analysi task , singl tool appli situat .
algorithm deriv scheme propos [ 10 ] analysi fully-incompress fully-compress single-phas flow .
origin method adapt slight compress fluid ( drill mud ) expand deal two-phas flow ( mud suspend cut ) .
detail numer scheme present , follow valid case demonstr accuraci effici solver .
final , import conclus drawn .
2 govern equat consid weatherford  oper requir inform avail well instrument , follow assumpt ware made develop mathemat model :  1d flow insid rigid pipe .
 compress drill mud small .
 well bore near-vert veloc surfac network high enough cut remain suspend .
 rock cut incompress behav dispers phase , interact cut neglect .
 motion suspend cut domin viscos , cut slip veloc comput direct local flow condit .
cut veloc approxim parallel pipe axi .
also , friction forc cut pipe wall minor import compar viscous stress .
4  temperatur field well known everi instant .
effect temperatur fluid behaviour must consid , temperatur part input data .
 well geometri motion ( e.g .
drill string displac ) defin extern affect flow field .
basic equat 1d fluid flow , see exampl [ 11 ] , simplifi accord assumpt .
basic idea scheme [ 10 ] appli modifi equat order obtain effici numer model .
chang basic equat summar next .
2.1 single-phas conserv statement 1d mass balanc equat conserv form pipe segment   0 v x       , ( 1 )  denot fluid densiti , v veloc , x streamwis coordin stand time .
conserv form momentum balanc given :    2 w x vv fp g x x             , ( 2 ) p fluid pressur , fw denot wall friction forc per unit length , pipe cross-sect gx streamwis compon graviti .
left-hand side ( lhs ) ( 2 ) simplifi use continu equat ( 1 ) :       2vv v v v v v v v v x x x x                                          , ( 3 ) thus yield non-conserv form momentum balanc w x fv v p v g x x                .
( 4 ) flow veloc small compar speed sound c , someth clear case oil well v1 m/s , continu equat ( 1 ) simplifi densiti gradient neglig small .
use speed sound write densiti fluctuat term pressur gradient , turn estim ( 4 ) 5 2 2 2 2 ; v p p v v v v v v v x c x x x x c x x                         , ( 5 ) mach number /m v c introduc 2 p c     .
mach number small , densiti gradient term continu equat safe neglect : v v x x        , ( 6 ) yield acoust approxim 0 v x         .
( 7 ) general , whenev mach number small densiti gradient term equat drop .
convect term v v x    lhs ( 4 ) non-linear complic numer solut equat .
key featur algorithm develop [ 10 ] replac static pressur p stagnat pressur p0 20 1 2 p p q p v    , ( 8 ) dynam pressur q introduc .
introduc stagnat pressur momentum balanc equat ( 4 ) recal densiti gradient ignor virtu small mach number : 0 w x p fv g x          .
( 9 ) common practic hydraul analysi ignor convect term order simplifi solut scheme .
equat ( 9 ) achiev effect remain exact ( within frame small compress ) effect convect term contain insid dynam part ( q ) stagnat pressur .
2.2 conserv statement two-phas flow method [ 10 ] comput effici , unfortun restrict single-phas flow .
, techniqu extend case biphas flow ( drill mud suspend rock cut ) simplifi equat model assumpt state begin section 2 .
follow subscript , mix shall refer , respect , 6 drill mud , suspend cut overal mixtur .
mass conserv balanc phase       , k k k k k ka v k x           , ( 10 ) k denot net mass sourc ( per unit length ) phase k. subscript k either ( mud ) ( suspend cut ) .
ak fraction cross section occupi phase k , written term volum fraction ( xk ) k ka ax .
principl , one momentum balanc per phase requir determin veloc field .
howev , practic , drag forc experienc suspend cut comput accur .
due main two issu .
first , cut show wide variat size shape , repres geometri must use give , , rough approxim real drag forc .
second , even particl ident , precis drag correl avail fluid complex rheolog ( precis case drill mud ) .
could add field applic simpl model calibr easili requir , particl drag correl approxim best .
mind simpler effici approach chosen .
assum motion suspend particl domin viscos , particl slip veloc slip mv v v  comput assum buoyanc , gravit drag forc act equilibrium 0 0s x p g x          , ( 11 ) s particl volum ds drag forc experi ( function slip veloc ) .
note , conveni , assum 0 p p x x      comput buoyanc forc .
approxim valid long variat cross-sect along duct smooth .
furthermor , given approxim natur drag estim , high level accuraci need pressur gradient .
remark ( 11 ) algebra equat comput cut slip veloc , much easier solv respect momentum balanc statement ( partial differenti equat ) .
anoth equat need complet determin motion system , could momentum balanc mud , instead momentum balanc overal mixtur 7 chosen .
equat simpler , consid mixtur , forc mud cut intern enter balanc : mix mixmix mix x v p f g x           , ( 12 ) averag mixtur densiti mix sx x    .
equival mixtur wall forc includ viscous forc momentum defect creat extern cut sourc , :  mix w w extf l v v    .
( 13 ) ( 13 ) w wall viscous stress , lw denot pipe perimet vext veloc cut introduc flow .
cut fed low veloc ( vs > vext ) creat drag forc mixtur , mixtur slow transfer momentum extern cut order equal speed .
realist cut feed rate term small safe ignor .
note approxim made ( 12 ) , total pressur p0 comput dynam pressur mud 2 0 1 2 mp p v  , exact equat would requir dynam pressur mixtur .
practic , error introduc approxim smaller uncertainti evalu friction forc ( given complex rheolog mud ) serious limit .
simplif made realiz motion particl domin viscous forc , acceler mud particl must similar .
stand reason , acceler signific differ , particl slip veloc would becom larg , clog well short time .
therefor accept assum mix v v      use equat comput direct mud veloc : 1m w x mix v p f g x a          .
( 14 ) 2.3 physic model order fulli determin solut  0 , , , , , mx x v v p  mass momentum conserv equat ( 10 ) ( 14 ) must supplement addit correl describ physic respons system .
includ mud equat state , correl wall friction stress well cut drag forc .
model 8 adopt explain briefli next subsect , check refer provid complet descript .
2.3.1 equat state follow standard practic oil industri , polynomi express use comput mud densiti :  2 21 1 1 2 2 2m b p c p b p c p       , ( 15 ) denot temperatur coeffici ai , bi ci material-depend .
speed sound easili comput ( 15 )  1 1 2 22 1 2 2m b c p b c p c p        .
( 16 ) note , simplic , possibl use p0 instead p comput densiti :   2 2 2 ( , ) ( , ) ( , ) 1 ( , ) 1 2 2 v p p p p p p p c                        .
( 17 ) given mach number small , conclud ( 17 ) ( , ) ( , ) mp p t  .
2.3.2 wall viscous stress follow standard practic oil industri friction loss comput use procedur outlin api rp 13d standard [ 13 ] use herschel-bulkley ( hb ) non- newtonian fluid model [ 14 ] : ny k     , ( 18 ) y yield stress , k consist factor , n flow index  denot shear rate .
hb model prefer includ , special case , newtonian , bingham plastic power-law fluid .
comput wall friction stress wall shear rate first determin 8w hyd gv   .
( 19 ) express 4 hyd w l  hydraul diamet duct combin geometri shear-rat correct factor g 9     3 1 1 4 2 n g n                 , ( 20 ) =0 drill pipe =1 annular space .
refer wall shear stress given 4 3 n ref n w wk            , ( 21 ) general reynold number comput : 2 8 mg ref w v   .
( 22 ) standard [ 13 ] give semi-empir correl fan friction factor cf function reg .
use friction coeffici , wall shear stress final determin : 2 1 2 w fv c  .
( 23 ) 2.3.3 cut drag forc order comput cut slip veloc relat ( 11 ) correl particl drag forc need .
follow result [ 12 ] linear depend assum 0 0 term slip slip sv v slipv term v v      , ( 24 ) vterm termin veloc ( vertic fall ) particl immers drill mud .
particl drag termin veloc equal particl weight minus buoyant forc   term mv g    .
( 25 ) termin settl veloc comput use walker may correl [ 15,16 ] .
method assum circular disc diamet ds thick hs flat fall .
empir correl shear stress termin veloc provid .
follow standard practic oil industri , field unit use :   2 lbf 7,9 100ft term mh          , ( 26 ) particl size measur inch densiti lbm/gal .
use hb fluid model shear rate termin veloc comput 10   1 1s n term term k             , ( 27 ) turn yield appar viscos termin shear rate :  479 cptermterm term      .
( 28 ) final , termin veloc ft 0,0203 term term term v           .
( 29 ) particl drag zero slip veloc often comput express gel strength spheric particl 2 0slip yv d    , ( 30 ) howev , express sometim yield result incompat walker may model ( i.e .
predict 0term slip sv v   ) .
address issu drag rest comput use : 0slip term sv v term    .
( 31 ) use equat ( 11 ) ( 24 ) togeth , slip veloc particl determin : 0 0 0 slip term slip term slip x v sv v v p v g x                 .
( 32 ) note whenev magnitud particl drag smaller 0slip v  slip veloc set zero instead valu predict ( 32 ) .
3 numer model algorithm build advantag ref .
[ 10 ] , extend method includ effect suspend cut .
solut scheme stagger , altern veloc correct pressure/concentr correct step .
spatial discret also stagger , use combin finit differ veloc correct step unstructur finit volum comput pressur concentr .
next subsect describ detail formul .
11 3.1 problem discret 3.1.1 spatial discret spatial discret scheme stagger , pressur concentr evalu node grid ( xi ) veloc comput midpoint ( xi+1/2 ) shown fig .
2. xi1 xi+1xixi1/2 xi+1/2 i vi1/2 pi1 xi1 vi+1/2 li1/2 li+1/2 pi xi pi+1 xi+1 i1 i+1 fig .
2 stagger spatial discret mud veloc equat ( 14 ) solv use second-ord center finit differ scheme mass conserv equat ( 10 ) solv use cell-cent finit volum scheme ( second-ord space accur ) .
cell interfac locat midpoint neighbour node ( veloc comput ) .
volum cell given : 1/2 1/2 1/2 1/2 2 l l a     .
( 33 ) note pipe cross-sect defin midpoint ( i.e .
pipe segment constant area , section chang take place node ) .
3.1.2 tempor discret due complex mud rheolog nonlinear cut slip veloc correl achiev converg solut implicit integr difficult .
increas robust solut procedur backward euler time integr use advanc equat time [ 17 ] .
applic hand stabil simplic deem import accuraci , first-ord time accuraci consid accept trade-off .
thus , given system ode   1 , , ... , 1 , ... , j j n x x x j n   ; ( 34 ) 12 unknown advanc time solv algebra system  1 , , ... , 1 , ... , j j j n x x x x j n          , ( 35 ) t denot time step size .
keep notat simpl possibl , assum variabl evalu end time increment unless explicit indic .
valu start time step denot superscript 0 .
thus , eq .
( 35 ) becom :   0 1 , , ... , 1 , ... , j j j n x x x x j n      , ( 36 ) 3.2 veloc comput 3.2.1 mud ( mixtur ) veloc updat discret form mixtur momentum balanc equat ( 12 )           0 1/2 11/2 1/2 1/2 mix mix mix xi v v l p p p l g            , ( 37 ) mixtur pressur drop given :  mix mix mw mw ext l l p f l v v        .
( 38 ) case local pressur drop ( minor loss ) exist , ( 38 ) augment minor lossp k q , kloss dimensionless loss factor .
factor function time ( e.g .
simul valv closur ) .
equat ( 37 ) nonlinear , pmix function veloc , must solv iter ( note pressur concentr fix , updat later stage algorithm ) .
start approxim valu mud veloc 1/2 j iv   , j iter counter , seek improv solut 1 1/2 1/2 1/2 j j j iv v v        , ( 39 )         0 1/2 1/2 1/2 1/2 1 1/2 1/2 j j mix j j mix mix mix x mix v v v l p p p p l g v                              .
( 40 ) veloc correct step j obtain 13 1/2 1/2 1/2 1/2- j j j ik v b e    = , ( 41 )   1/2 1/2 1/2 0 1/2 1/2 0 0 1 1/2 1/2 1/2 , , .
j j mix mix mix mix x j j mix mix l p k l v v b l g p p l v e p                                            ( 42 ) use ( 38 ) linear factor ( 42 ) written : 1/2 1/2 1/2 j j mix mw mw l k l v                , ( 43 ) assum cut slip veloc depend mud veloc .
veloc updat step ( 39 ) repeat converg achiev .
3.2.2 cut veloc updat cut slip veloc obtain solv algebra equat ( 25 ) .
model particl drag describ ( 24 ) - ( 32 ) use , equat becom :  0 0 1 00 1/2 term sv vi v x mv term dp p g v v l v                    .
( 44 ) equat ( 44 ) linear straightforward solv v comput .
3.3 concentr pressur comput 3.3.1 mass balanc discret use nomenclatur fig .
2 , rate chang mass certain speci contain insid cell :        1/2 1/2 k p k k ki ii x f f l         , ( 45 ) k denot phase ( cut mud ) f flux cell interfac :  1/2 1/2 k k k k f v x a   .
( 46 ) appli backward euler rule ( 45 ) yield 14        0 0 1/2 1/2i k k k k k k ki iix x f f lt           .
( 47 ) , equat nonlinear must solv iter .
streamlin notat shall drop iter counter use tild denot initi guess .
thus , write improv densiti concentr estim ; k k k k k kx x x       .
( 48 ) insert ( 48 ) ( 47 ) discard high order term give         0 0 1/2 1/2 k k k k k k k k k k k k k ii x x x x f f f f l                          , ( 49 ) rearrang :               1/2 1/2 0 0 1/2 1/2 k k k k k ki ii k k k k k k kii x x f f f f l x x                             .
( 50 ) note 2 unknown per node ( 50 ) 0 ; sx x     .
( 51 ) mud densiti correct replac pressur variat : 0 2m p c     , ( 52 ) yield updat equat suspend cut fraction pressur :               1/2 1/2 0 1/2 1/2 si ext sii x f f f f lm x x                        , ( 53 )           0 2 1/2 1/2 0 0 1/2 1/2 mi mi p x x f f c f f x x                                .
( 54 ) 15 3.3.2 flux linear order comput updat variabl ( 53 ) ( 54 ) flux increment must linear .
achiev two step , start veloc linear follow complet flux .
chang mud veloc due pressur cut concentr variat estim eq .
( 37 ) :      11/2 1/2 1/2 mix mix x mixi l p v p p lg v                  .
( 55 ) experi show last term rhs ( 55 ) extrem import .
neglect lead poor pressur estim lack converg .
chang mixtur densiti midpoint written :               1 1/2 1 1 1 1/2 2 2 2 2 2 si mix si si x x x x x x x x x x x x                                                             .
( 56 ) note , due low compress mud , assum mx x   .
combin ( 55 ) ( 56 ) yield linear veloc correct :             1/2 1/2 1 1 1 1/22 mix mix x si l p v v lg p p x x                                     .
( 57 ) cut veloc linear obtain ad ( 57 ) linear slip veloc comput ( 44 ) :      0 0 11/2 1/2 1/2 0term term ii sv v v v v v p p l                 .
( 58 ) linear flux obtain ( 46 ) , togeth assumpt , due low mach number , densiti variat neglig compar chang veloc : 16  1/2 1/2 k k k k k k f x v v x           .
( 59 ) particular , mud flux variat                     1/2 1/2 1/2 1/21/2 1/2 1/2 1/2 11/2 1/2 2 mi ii si ii f x v v x v x v x x                                        ; ( 60 ) chang cut flux                     1/2 1/2 1/2 1/21/2 1/2 1/2 1/2 11/2 1/2 2 si ii si ii f x v v x v x v x x                                        , ( 61 ) variat mud cut veloc given ( 57 ) ( 58 ) .
3.4 solut procedur global solut obtain follow step : 1 .
initi variabl appropri initi condit ( guess solut case time march steady-st ) .
2 .
solv updat veloc iter scheme ( 41 ) .
3 .
updat cut veloc ( 44 ) .
4 .
updat pressur cut concentr solv linear system equat ( 53 ) - ( 54 ) .
5 .
go back step 2 converg achiev .
6 .
continu next time step ( updat boundari condit time increment ) proceed step 2 .
3.5 convect stabil equat contain diffus transport cut ( pure convect phenomenon ) solut subject instabl ( odd-even decoupl ) .
fact , given discret second-ord space-accur , godunov  theorem [ 18 ] state linear scheme subject spurious oscil near discontinu .
simpl workaround revert first order space accuraci cut transport .
17 easili achiev alter interfaci flux cut appear rhs ( 53 ) .
second-ord center discret flux :          11/2 1/2 1/22 center si ii f av x av x x              .
( 62 ) replac first-ord upwind approxim improv stabil       1/2 1/2 upwind ii f av x     , ( 63 ) assum cut move node node i+1 .
case revers flow cut concentr would evalu node i+1 ( valu upstream node must alway chosen ) .
upwind approxim increas numer diffus cut , consid limit .
real case random distribut cut size shape , slip veloc uniform .
therefor , cut transport veloc variabl , caus streamwis smooth cut concentr .
extra diffus creat upwind approxim qualit similar effect , detriment qualiti solut .
3.6 move drillstr surge/swab simul ( i.e .
comput effect vertic displac drillstr ) node grid set motion reflect chang well geometri .
basic equat easili modifi account drillstr veloc .
3.6.1 veloc updat move drillstr equat retain form section 3.2 except friction loss comput use equival mud veloc given : drillpip annulus 2 otherwis dp eq dp v v v v v v       , ( 64 ) vdp denot drillpip longitudin veloc .
3.6.2 mass balanc move drillstr use arbitrari lagrangian-eulerian ( ale ) framework [ 19 ] , discret mass conserv statement ( 47 ) becom 18        0 0 0 1/2 1/2 1 ale ale p p p p p p p ii x x f f l            , ( 65 ) flux modifi account interfac veloc :     1/2 1/2 ale p p p g pi f v v x a       .
( 66 ) grid veloc ( vg ) interfac interpol nodal veloc :       1 1/2 2 g gi g v v v     .
( 67 ) 4 applic exampl illustr perform method section present four benchmark case refer solut avail , follow real-world applic exampl .
4.1 quasi-steadi mud transport test valid mud rheolog model long-term pressur drop along horizont pipe segment compar result api rp 13d standard [ 13 ] .
relev problem data :  pipe length : l = 100  pipe diamet : = 20 cm  mud densiti : = 1900 kg/m3  speed sound : c = 1100 m/s  fann viscomet read : 3 = 7 , 6 = 8 , 300 = 38 , 600 = 63 characterist wave propag time sound wave along pipe / 0,1ct l c s  .
time scale long compar tc dynam effect expect neglig quasi- steadi solut obtain .
pressur drop across pipe segment ramp linear 0 5 bar period 1000 result numer model compar steady-st predict [ 13 ] .
fig .
3 show excel agreement numer model .
19 0 0.1 0.2 0.3 0.4 0.5 1 2 3 4 5 6 7 8 9 ri v g p ss u ( p ) veloc ( m/s ) api rp 13d transient solver fig .
3 quasi-steadi pressur drop 4.2 surge/swab test valid ale formul case slow drillstr motion analys .
use analysi time larg compar resid time pressur wave dynam effect neglig incompress steadi solut use refer .
3000 ft ( 900 ) well two drillstr section depict fig .
4 studi .
1000 ft 2 ft 1 ft 3 ft 1000 ft 1000 ft cb x fig .
4 move drillstr test case geometri drillpip lower 1 ft/s ( 0,3 m/s ) one minut rais back origin posit .
hole diamet 3 ft ( 90 cm ) drillpip diamet vari 2 ft section 1 ft section b .
pipe close , mud flow annulus .
assum full incompress annular flow veloc easili estim : 2 2 2 2 2 2 2 1 0,8 ; 0,125 3 2 3 1 dp b dp ft ft v v v v       .
( 68 ) 20 output simul , shown fig .
5 10 step , match close expect result .
1 0.8 0.6 0.4 0.2 0 0.2 0.4 0.6 0.8 1 0 20 40 60 80 100 120 140 160 f lo w v e lo ci ty ( ft /s ) time ( ) section section b fig .
5 outlet flow veloc surge/swab test case 4.3 steady-st cut transport vertic annulus test valid solid transport capabl , predict numer model check detail experiment result [ 20 ] .
transport capabl differ combin drill mud cut size measur rang mud veloc insid vertic annulus , repres condit found real well .
result express term effect cut transport ratio /s mr v v ; improv hole clean larg valu r ( i.e .
close 1 ) desir .
walker may method describ section 2.2.3 use two paramet describ cut geometri ( disk equival diamet thick ) .
diamet taken hydraul diamet cut , equival thick must calibr use experiment data , usual direct measur termin settl veloc .
inform avail , model calibr direct match transport ratio [ 20 ] singl valu mud veloc .
behaviour model evalu vari mud veloc wide rang .
interest , disk equival thick found depend weak actual particl size .
advantag , reduc need recalibr model cut characterist chang .
hand , observ might advis recalibr disk 21 thick mud vast differ rheolog properti test small anular veloc , i.e .
30 ft/min ( 0,15 m/s ) .
fig .
6 compar experiment vs. numer result three differ cut size .
pleas refer [ 20 ] complet descript experiment condit .
agreement quit satisfactori complet rang veloc ( scatter raw experiment measur larger differ two data set ) .
35 40 45 50 55 60 65 70 75 80 85 90 50 75 100 125 150 175 200 225 tr n sp rt r ti ( % ) annular veloc ( ft/min ) experiment ( small cut ) numer ( small cut ) experiment ( medium cut ) numer ( medium cut ) experiment ( larg cut ) numer ( larg cut ) fig .
6 effect cut size transport ratio ( 8  x4  annulus , mud # 1 , 12 ppg mud , 100 rpm drillpip rotat ) effect mud densiti ( fig .
7 ) mud rheolog ( fig .
8 ) also studi , yield satisfactori result ( deviat alway smaller spread experiment data ) .
22 30 40 50 60 70 80 90 100 25 50 75 100 125 150 175 200 225 tr n sp rt r ti ( % ) annular veloc ( ft/min ) experiment ( 12ppg mud ) numer ( 12ppg mud ) experiment ( 15ppg mud ) numer ( 15ppg mud ) fig .
7 effect mud densiti transport ratio ( 8  x4  annulus , mud # 1 , medium cut , h=0.45  , drillpip rotat ) 30 40 50 60 70 80 90 100 25 50 75 100 125 150 175 200 225 tr n sp rt r ti ( % ) annular veloc ( ft/min ) experiment ( mud # 1 ) numer ( mud # 1 ) experiment ( mud # 2 ) numer ( mud # 2 ) fig .
8 effect mud rheolog transport ratio ( 8  x4  annulus , 12 ppg mud , medium cut , h=0.45  , drillpip rotat ) 4.4 fast pressur transient ( water hammer ) viscous effect test fast-transi ( wave track ) capabl valid experiment studi present [ 21 ] .
setup involv pipe segment constant head water tank upstream end motor valv outlet ( fig .
9 ) .
start steady-st 23 condit , valv close follow predefin law pressur sever point along duct monitor .
href 0,33 31,67 motor valv constant-level tank sump 16 mpressur measur fig .
9 experiment setup water hammer test fig .
10 show good agreement experiment numer result pressur midpoint duct .
small differ must expect refer [ 21 ] give valv closur law tabul form .
simul code use minor loss pipe outlet .
loss factor comput instant valv posit tabl .
howev , pressur surg extrem sensit interpol algorithm use , caus minor discrep .
fig .
10 pressur evolut pipe midpoint 4.5 real-world applic exampl illustr real-world perform algorithm ( most point view cpu time , reliabl experiment data real well freeli avail ) typic simul 39 400 ft-deep ( 12 km ) pressur manag well present .
sudden 24 actuat choke valv rig work steadi condit simul .
comput start time-march stationari condit follow fluid hammer event .
geometri taken direct well log , includ total 273 cell drillpip , annulus underbit ( drillstr partial rais , bit posit depth 6 km ) .
given code problem deal non-uniform grid ( oppos program base method characterist explicit finit volum solver ) cell size match exact log interv .
thus , smooth geometri due transfer data uniform mesh .
time-march steadi condit take 0,078 second core i5-4200u @ 1.6ghz cpu ( note low-pow low-perform processor ) .
physic time simul 13 minut , thus comput run 10 000 time faster real time .
possibl due adapt time step scheme use , dynam adjust time increment obtain best compromis iter converg step size .
solver found optimum perform obtain approxim 7 global iter loop perform everi time step .
steadi condit reach ( defin point relat veloc pressur chang fall 10-6 ) pressur increas 85 psi ( 0,59 mpa ) last 1 prescrib outlet .
simul run 200 addit step time increment 40 ms track wave propag along well .
analysi requir 0,14 second cpu indic .
25 0.2 0.1 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0 1 2 3 4 5 6 7 8 9 10 11 12 p ss u c h n g e ( p ) depth ( km ) t=1s t=2s t=3s t=4s t=5s t=6s t=7s t=8s fig .
11 pressur surg propag along annulus underbit evolut pressur insid annulus underbit one second interv shown fig .
11 ( pressur insid drillstr also comput , includ jet loss bit , data remov plot sake clariti ) .
note anomal propag depth 2 km .
due transit first second case segment caus partial reflect togeth increas pressur area restrict .
5 conclus unsteadi hydraul network solver pressur manag cut transport near-vert oil well present .
due effici implicit time integr code provid unifi framework simul long-term evolut well ( e.g .
hole clean oper ) well fast transient ( e.g .
fluid hammer event emerg well control ) .
method account complex drill mud rheolog mean industry- standard herschel-bulkley model compress effect .
use formul base stagnat ( total ) pressur effect convect deriv veloc includ implicit , yield simpl set equat solv effici .
abil method accur model sever benchmark case , steadi transient , demonstr .
final , practic applic exampl real oil well present , show excel perform softwar .
evolut well 26 time scale rang second hour comput fraction second .
provid valuabl predict tool ensur safe drill oper .
equival field si unit text includ field unit wide use petroleum industri .
list equival si unit .
tabl 1 equival petroleum field unit si .
magnitud symbol section field unit si equival particl size ds , hs 2.3.3 0,0254 densiti  2.3.3 lbm/gal ( ppg ) 119,8264 kg/m3 friction stress  2.3.3 lbf/100 ft2 0,4788026 pa dynam viscos  2.3.3 cp 0,001 pa veloc v 2.3.3 , 4.2 ft/s 0,3048 m/s fann viscomet read  4.1  ( degre ) 1 length l , d 4.2 , 4.5 ft 0,3048 veloc v 4.3 ft/min 0,00508 m/s acknowledg research partial fund weatherford intern .
conflict interest statement behalf author , correspond author state conflict interest .
refer [ 1 ] malloy kp et al .
( 2009 ) managed-pressur drill : .
iadc/sp manag pressur drill underbalanc oper confer exhibit .
san antonio tx , usa [ 2 ] elliot et al .
( 2011 ) manag pressur drill eras line .
schlumberg oilfield review 23 ( 1 ) : 14-23 [ 3 ] van riet ej , reitsma ( 2003 ) develop test fulli autom system accur control downhol pressur drill oper .
spe/iadc middl east drill technolog confer & exhibit .
abu dhabi , uae [ 4 ] guo c et al ( 2010 ) manag pressur drill micro flux technolog allow safer drill high sour reservoir .
intern oil gas confer exhibit china .
beij , china [ 5 ] streeter vl , wyli eb ( 1998 ) fluid mechan ( intern 9th revis ed . ) .
mcgraw-hil higher educ , new york [ 6 ] lohrasbi ar , attarnejad r ( 2008 ) water hammer analysi characterist method .
american journal engin appli scienc 1 ( 4 ) : 287-294 27 [ 7 ] amein , chu hl ( 1975 ) implicit numer model unsteadi flow .
journal hydraul divis - asc 101 ( 6 ) : 717-731 [ 8 ] wyli eb , streeter vl ( 1970 ) network system transient calcul implicit method .
45th annual meet societi petroleum engin aim .
houston tx , usa [ 9 ] ghidaoui et al .
( 2005 ) review water hammer theori practic .
appli mechan review - asm 58 : 49-76 [ 10 ] greyvenstein gp ( 2002 ) implicit method analysi transient flow pipe network .
intern journal numer method engin 53 : 1127-1143 [ 11 ] anderson jd ( 1995 ) comput fluid dynam : basic applic .
mcgraw-hil , new york [ 12 ] celigueta et al ( 2016 ) fem-dem techniqu studi motion particl non-newtonian fluid .
applic transport drill cut wellbor .
comput particl mechan 3 ( 2 ) : 263- 276 [ 13 ] ( 2010 ) rheolog hydraul oil-wel fluid - api recommend practic 13d ( 6th ed . ) .
american petroleum institut , washington-dc [ 14 ] herschel wh , bulkley r ( 1926 ) konsistenzmessungen von gummi-benzollsungen , kolloid zeitschrift 39 : 291300 [ 15 ] walker , may tm ( 1975 ) design mud carri capac .
journal petroleum technolog 259 : 893-900 [ 16 ] bourgoyn , millheim kk , chenevert , young fs ( 1986 ) appli drill engin .
spe textbook seri , richardson-tx , pp 173-183 [ 17 ] lomax h , pulliam th , zingg dw ( 2003 ) fundament comput fluid dynam .
springer , berlin [ 18 ] godunov sk ( 1954 ) differ method shock wave .
phd thesi , moscow state univers .
[ 19 ] stein e , de borst r , hugh tjr ( ed . )
( 2004 ) encyclopedia comput mechan .
wiley , hoboken-nj , vol .
1 : chapter 14 [ 20 ] sifferman tr , mayer gm , haden el , wahl ha ( 1974 ) drill-cut transport full-scal vertic annuli .
journal petroleum technolog , 26 ( 11 ) : 1295-1302 [ 21 ] araya w , chaudhri ( 2001 ) unsteadi friction rough pipe .
journal hydraul engin 127 ( 7 ) : 607-618 caratula springercluster.pdf upcommon portal del coneix obert de la upc http : //upcommons.upc.edu/e-print aquesta s una cpia de la versi author  final draft d'un articl publicat la revista comput particl mechan .
la publicaci final est dispon springer trav de http : //dx.doi.org/10.1007/s40571-018-0204-9 copi author 's final draft version articl publish journal comput particl mechan .
final public avail springer via http : //dx.doi.org/10.1007/s40571-018-0204-9 articl publicat / publish articl :
