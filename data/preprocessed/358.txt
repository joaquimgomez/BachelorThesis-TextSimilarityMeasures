cohesive.ep intern journal numer method engin int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl [version: 2002/09/18 v2.02] comput homogen multiscal crack modelling. implement comput aspects. vinh phu nguyen 1, oriol lloberas-val 1, martijn stroeven 1, lambertu johann slui 1 1delft univers technology, faculti civil engin geosciences, p.o. box 5048, 2600 ga delft, netherland summari comput homogen procedur cohes adhes crack model materi heterogen microstructur recent present comput. method appl. mech. engrg. 2010; doi:10.1016/j.cma.2010.10.013. macroscop materi properti cohes crack obtain inelast deform manifest local band (model continuum damag theory) microscop scale. macroscop behavior adhes crack deriv respons microscal sampl repres microstructur insid adhes crack. manuscript, extend theori present comput. method appl. mech. engrg. 2010; doi:10.1016/j.cma.2010.10.013 implement details, solut cyclic loading, crack propagation, numer analysi converg characterist multiscal method treatment macroscop snapback multiscal simulation. numer exampl includ crack growth simul extend finit element given demonstr perform method. copyright c 2000 john wilei & sons, ltd. kei words: repres volum element (rve), quasi-brittl materials, softening, multiscale, comput homogenization, cohes law, fracture, xfem, interfac element 1. introduct homogen heterogen materi subject intens research past decades. particular homogen method, comput homogen (ch) [1], util predict mechan behavior materi have complex microstructures, [2, 3, 4, 5] others. mechan problem describ linear nonlinear deform thermal problem [6, 7] multi-phys (thermo-mechanical) problem [8] recent address method. applic encompass structur [9, 10, 11, 12, 13]. unifi variat basi ch theori bulk materi recent present [14]. implement finit element (fe) framework, method known fe2 [15] scheme or, generally, multilevel finit element method [16]. correspond to: delft univers technology, faculti civil engin geosciences, p.o. box 5048, 2600 ga delft, netherland receiv februari 23, 2011 copyright c 2000 john wilei & sons, ltd. revis februari 23, 2011 2 v.p. nguyen et al. [17], studi homogen focuss mainli determin effect properti macroscop bulk materials. [17], author develop comput homogen scheme materi layer possess heterogen microstructure. behavior macroscal materi layer (the macro-lay follow initi elast cohes law) come microscal fe comput microstructur explicitli discretized. follow studi includ [18, 19, 20, 21]. accord [22], review recent develop ch methods, homogen materi layer qualifi homogen (initi elastic) cohes laws. comput homogen great success predict behaviour nonlinear heterogen materials, soften materi method limit use. major reason homogen respons object respect size micro-sampl (known repres volum element (rve)) defin microscal boundari valu problem (bvp)- larger micro-sampl brittl macroscop respons is. words, rve exist standard comput homogen techniqu soften materials, state [23]. second reason, important, sensit macroscal respons respect macroscal discret soften (the macroscop bvp ill-posed) [24]. [24] problem solv coupled-volum techniqu regular preserv micro-sampl coupl size macroscal element. overcom second drawback, [25, 26] macroscal local band fix width insert microscal localization. latest develop method [27]. somewhat similar method, multiscal aggreg discontinu (mad) method, present [28, 29] crack introduc macroscal materi stabil lost, crack direct open deriv microscal information. method work materi period microstructur (becaus rve defin unit cell), particularli masonri [25, 26] fiber reinforc composit [28, 29]. method util materi random microstructure, sensit method respect size micro-sampl checked. recently, multiscal method impact model viscoelast solid have random microstructur contain field evolv microcrack given [30]. [31], new ch scheme crack model object respect micro- sampl size presented. method suffer aforement drawback standard ch methods. restrict discret crack microscale. mean behavior macroscop cohes crack deriv open micro-crack. [32], author present similar method suitabl quasi-brittl soften materi soil concret damag smear zone microscale. method, behavior macroscop cohes crack come inelast deform microscal local band (modelled, instance, continuum damag theory). method implement fe2 set sens constitut behavior materi point macro-crack defin comput (e.g., fly) microscop sample. object method respect micro-sampl size demonstr [32] exist rve soften materi posit confirm [33]. present manuscript continu [32]. new contribut paper three-fold. present implement copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 3 detail includ new wai comput macroscop tangent. discuss extens method loading/unload case present simpl wai handl macroscop snapback multiscal computation. final numer exampl includ crack propag simul converg characterist studi propos multiscal scheme given assess perform method. possibl enhanc comput speed discussed. method implement fe2 set usual classifi multiscal method weak coupl macro- micro-models. multiscal model failur materi strong coupl macro- micro-model report [34, 35, 36, 37]. detail classif exist multiscal methods, reader refer [29]. multiscal method strong macro-micro coupl given [38] elasto- plastic multiphas materi [24] quasi-brittl soften materials. method adequ moder jump scale principl separ scale macroscop microscop length scale hold. remaind paper structur follows. section, finit element model util macroscal microscal discuss constitut laws. section 3 present comput homogen scheme adhes cohes cracks. section 4 describ implement comput aspect propos multiscal crack model framework. final section, numer exampl given demonstr perform method. 2. macroscal microscal model manuscript, notat adopt tensor notat matrix/engin notation. matrix notation, symbol tensor denot matric connect symbol (use express operators) skip e.g., stress-strain relat written = d : tensor notat equival (use voigt notation) written = d matrix notation. macroscal microscal fe formul adopt small-strain kinemat assumption. 2.1. macroscal model let consid dimension solid m shown fig.(1) boundari denot m. prescrib traction t impos neumann boundari tm m prescrib displac impos dirichlet boundari um m. discontinu surfac dm compos cohes crack coh adhes crack adh . emphas materi heterogeneous, macroscal solid model homogen effect properti come heterogen microscal model. discret equat quasi-stat equilibrium read f ext m = f int m fbulkm + f cohm (1) literature, adhes crack refer adhes layers, materi layer predefin interfaces. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 4 v.p. nguyen et al. t tm um m coh adh tm figur 1. dimension heterogen solid contain cohes crack heterogen adhes crack. note coh repres portion cohes crack tm non-zero. f extm extern forc vector, f int m intern forc vector consist bulk forc vector fbulkm cohes forc vector f coh m . given f ext m = m n t bd + t m n t td (2) f bulk m = m b t md (3) f coh m = d m n t tmd (4) m macroscal cauchi stress tensor, b bodi forc vector tm cohes traction crack dm. manuscript, subscript m m indic quantiti belong macroscal microscale, respectively. macroscal quantiti like b appear microscal written subscript m. strain-displac matrix b shape function matrix n, depend specif finit element, specifi subscript. cohes cracks, special version extend finit element method (xfem) [39, 40], phantom node method [41, 42, 43] used. heavisid enrich used, crack grow element-wise. adhes cracks, stick simpler option zero-thick interfac element (also known cohes zone element simpli cohes elements) detail [44, 45, 46, 47]. 2.1.1. constitut model bulk vicin cohes crack assum linear elast effect properti determin pre-process step (befor multiscal simul starts). m = d0 : m (5) m macroscal strain tensor d0 fourth order tensor contain copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 5 effect elast moduli, comput convent homogen theory, refer section 3.1.2 procedure. behavior adher join adhes crack independ microstructur adhes crack. model constitut laws. sake paper, adher assum linear elastic. behavior macroscal cohes adhes crack come microscal models. macroscal cohes law gener given tm = ([[u]]m,m) (6) [[u]]m displac jump macro-crack m microscal stress tensor. note cohes crack, cohes law (tm, [[u]]m) initi rigid adhes crack, (tm, [[u]]m) initi elastic. refer extrins intrins cohes model accord [48]. 2.1.2. macroscal cohes tangent equilibrium equat (1) solv increment iter manner macroscal nodal displac um. newton-raphson iter given load step, solv linear ki1m u m = f int,i1 m f extm . contribut macroscal tangent stiff matrix includ bulk stiff cohes stiff matrices. formula standard report here. given k coh m = d m n t tmnd (7) tm, macroscal cohes tangent, defin tm = [[u]]m (8) 2.2. microscal model w h m m figur 2. microscal model: random heterogen materi undergo local damage. contour plot show damag field (white color undamag materi black color complet damag material). copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 6 v.p. nguyen et al. microscal model, shown fig.(2), w h rectangular domain m extern boundari m heterogen explicitli resolved. geometri micro-model (w, h morpholog microstructur constituents) depend macroscal crack micro-model associ cohes adhesive, fig.(1). let denot characterist length micro-constitu d (e.g., mean diamet inclus matrix/inclus material) dimens microscal model larg i.e., w, h d order homogen quantiti independ microstructur randomness. condit fulfilled, propos ch scheme object respect micro-sampl size. 2.2.1. constitut model damag microstructur constitu model simpl isotrop damag model. stress-strain relat given [49] m = (1 )dem : m (9) scalar damag variabl (0 1) fourth order tensor dem contain elast moduli. microscal strain tensor denot m. damag govern follow exponenti law [50] = 1 [1 + exp(i)], (10) (residu stress), (soften slope) (damag threshold) denot inelast parameters. above, histori variabl evolv accord kuhn-tuck condit f 0, 0, f = 0 (11) load function f = eq eq so-cal non-loc equival strain. load function evalu integr points. 2.2.2. fe model microscal regular local damag model given above, util implicit gradient enhanc formul present [51] non-loc equival strain eq comput local equival strain eq accord eq c2eq = eq (12) tensil failur studi work, eq follow mazar definit [50] c posit valu paramet dimens length squared. equat (12) solv boundari condit eq n = 0 m n outward unit normal boundari m. discuss potenti consequ boundari condit non-loc interact microstructur phase given [33]. note multiscal framework present work restrict gradient enhanc regular type given eq.(12). regular method integr type non-loc theori [52] viscou regular approach [53] equal util well. fe equat read [51] copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 7 m b t umd = f ext m ([[u]]m) (13a) m n t neqd + m b t cbeqd = m n t eqd (13b) bu standard strain-displac matrix, n row vector contain shape function discret eq b = n. emphas rh eq.(13a) differ formul given [51]. propos multiscal scheme, micro model coupl integr point macro-crack, load displac jump integr point. thus, microscop extern forc vector depend macroscop displac jump. note microscale, inertia forc bodi forc neglect suggest [54]. equat (13) written gener format f int m (um) = f ext m ([[u]]m) (14) um microscal nodal unknown vector. note um contain nodal displac nodal non-loc equival strain degre freedom (dofs) eq. note bold symbol eq indic nodal valu correspond non-loc equival strain field eq. 3. macro-micro coupl 3.1. macro-micro coupl cohes crack problem solv given displac jump [[u]]m integr point macro-crack, correspond traction tm. borrow idea convent ch theori bulk solid, achiev transform [[u]]m microscal model associ integr point, microscal bvp solved. macro-tract tm defin function microscal stresses. figur (3) show multiscal cohes crack model framework comput homogenization. difficulti li defin link yield object macroscop respons respect size micro-sampl sens micro-sampl larg independ microstructur randomness, larger sampl lead response. shown [33, 32] extract microscal respons load damag domain (rather entir microscal domain convent homogen theory), homogen respons independ micro-model size long micro-sampl suffici larg homogen properti independ microstructur randomness. achiev recent emerg failur zone averag techniqu [33] briefli describ follows. reduc implement complex resources, work, assum rve integr point macro-crack identical. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 8 v.p. nguyen et al. t t tm t m um u m m d m m solv micro bvp n x1m x2m [[u]]m [[u]]m tm, tm macro cohes crack micro local band micro unload damag band figur 3. schemat represent multiscal cohes crack scheme. let denot d microscal region contain gauss point damag loading. mathemat d defin d = {x m | (x) > 0, f(x) = 0} (15) f load function, section 2.2.1. activ damag domain comput accumul tribut area gauss point damag loading. homogen strain dam defin volum averag microscal counterpart d dam = 1 |d| d md (16) || denot measur domain. domain integr comput numer quadratur rule integr microscal stiff matrices. defin displac activ damag domain d project dam macro-crack plane udam = dam (ln), l = |d| h (17) l averag width local band d n outward unit normal vector crack. note express obtain case local copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 9 band cut micro sampl points, lower edg upper edge, fig. (3). is, however, valid assumpt consid mode failur studi work. shown [32] (tm,udam) curv object respect size micro-model exhibit domin local band. case materi have random complex microstructur tensil shear loadings. therefore, [[u]]m defin equal udam, obtain object macroscal cohes law (tm, [[u]]m). final homogen relat given ur = [w l]c0 tm + [[u]]m + udam (18) c0 project complianc tensor d 1 0 macro-crack plane ur displac right edg rve. above, udam udam evalu moment microscal soften occur defin moment neg eigenvalu tm detected, [32] deriv details. note term rh equat linear total microscal displacement. mention eq. (18) resembl equat (19) [31] limit case l go zero (which case [31] discret micro crack assumed). macroscal load step n macroscal newton-raphson iter i, gauss point gp [[u]]m, equat microscal given f int m (um) = f ext m ([[u]]m) ur(um) = [w l]c0 tm + [[u]]m + udam (19) solv microscal nodal unknown um macro-tract tm. equat solv iter impos initi displac micro-model, microscal equilibrium equat eq.(19)1 solved, eq.(19)2 checked. satisfied, new valu initi displac calcul process repeat equat eq.(19) satisfied. detail process [32]. box (1) show pseudocod multiscal crack framework. note step (a) box (1) microscal bvp solv p > 1 times. crucial differ propos method standard fe2 method. macro-tract tm macroscal cohes tangent matrix tm deriv [32] given by, respect tm = 1 h nb i=1 f int m,i (20a) tm = 1 h m t k ,r m m (20b) nb number node right edg micro-sampl boundari condit (bcs) appli (detail bc micro-model given section 3.3) [2nb 2] matrix m given m = [ 1 0 1 0 1 0 0 1 0 1 0 1 ]t (21) copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 10 v.p. nguyen et al. box 1 flowchart multiscal crack framework implement fe2 setting. 1. macroscal load step n newton-raphson iter (a) loop element comput f cohm (1) i. loop integr point crack segment macro-jump [[u]]m comput tm tm microscal comput a. solv micro-problem given eq.(19) (2) b. comput macro-tract tm eq.(20a) c. comput macro-tang tm eq.(20b) comput f cohm tm comput kcohm tm ii. end loop integr point (b) end loop element 2. proce iter 3. converg load step n, commit state micro-models. (1) comput bulk contribut fbulkm standard fem. (2) state (nodal unknown intern variables) reset previou converg values. [2nb 2nb] matrix k,rm microscal stiff matrix associ right edg displac dofs. detail comput matrix tm given section 4.2. note tm gener symmetr microscal stiff matrix non- symmetr adopt damag constitut law. 3.1.1. crack initiation/propag criterion follow [31] initiation/propag criterion growth direct macroscal cohes crack pure macroscop i.e., macro-crack propag base macroscal stress field. note microstructur effect contribut macro-crack initiation/propag macroscal stress field comput effect properties, eq.(5). util maximum princip stress criterion crack initiation/propag indic non-loc stresses, comput weight averag stresses, crack tip determin crack direct propos [40]. note [28, 27, 29] macro-crack direct comput inform micro-model. opinion, make sens microscop length scale magnitud macroscop length scale. remark 3.1. work [25, 26] failur criterion base microscop inform macroscop crack initiation/propagation. scheme, macroscop crack macroscop bulk coupl rve, us microscop failur criterion. quasi-brittl heterogen materials, util elast macroscop stress drive forc crack initi suffer disadvantag (i) pre-failur harden stage captur (ii) predict peak overshoot. extens current multiscal scheme report [55] copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 11 macro-crack initi base microscop local criterion. refer remark 3.3 discuss macroscop stress reason adopt drive crack initiation/propagation. l b r t 1 2 34 figur 4. boundari condit impos micro model comput effect elast constants. 3.1.2. effect elast constant effect elast moduli tensor d0 determin analyt comput homogen theory. applic micro-sampl simpl morpholog circular ellipt inclusions, kind microstructur chosen work. detail [5], sake completeness, kei equat given. bc micro-model consist period boundari condit eq.(22), fig.(4), prescrib displac eq.(23) ut = ub + u4 u1 ur = ul + u2 u1 (22) prescrib displac corner node q = 1, 2, 4 defin uq = m xq,m = dtq m, dq = 1 2 2x1m 0 0 2x2m x2m x 1 m q (23) switch matrix-vector notat second equality. above, xq,m denot nodal coordin node q respect microscop coordin x1m x2m, cf. fig. (3). effect elast tangent moduli d0 given d0 = 1 |m| dkqqd t, d = [d1 d2 d4] (24) 6 6 matrix kqq obtain condens microscal stiff matrix. detail [5]. summary, computed0, impos strain vector [, 0, 0] corner node 1, 2 4 micro-mesh. microscal bvp (for effect elast properties, microscal bvp simpli linear elast problem) solv period bcs. converg linear copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 12 v.p. nguyen et al. equat condens obtain kqq equat (24) comput d0. note d0 symmetr fact microscop stiff matrix symmetric. remark 3.2. worth note that, materi random heterogen microstructure, dimens micro-model comput elast effect properti differ dimens micro-model determin macroscal cohes law. 3.1.3. tensil strength homogen materi evalu maximum stress criterion requir tensil strength homogen material. homogen multiscal scheme, valu defin ultim load micro-model ultm subject horizont tensil loading. words, pre-process step, micro-model load tension horizont direct (bc describ section 3.3) ultim load comput ultm = 1 h nb i=1 f int m,i() (25) denot instanc peak attained. 3.1.4. micro model activ unlik convent homogen approach bulk materi adhes crack micro-model link macroscal integr point ab initio, multiscal cohes crack scheme present work, micro-model brought scene new crack segment initiated. behavior new crack segment come soften regim micro-model, micro-model load undeform state peak. end, micro-model loaded, load control, zero f = ultm h homogen bc period bc describ section 3.3 = 1 , small posit number, introduc ensur converg activ step. furthermore, node right edg micro- model forc undergo displac shown fig.(5). activated, micro-model load displac control, forc f aforement constraint removed. impli crack initiation/propag criterion read im ultm im denot maximum macroscal princip stress. coupl macro-model micro-model summar fig.(6). note pre-failur nonlinear (hardening) micro-model, indic fig.(6) darker region, captur macro-model. therefore, assumpt harden negligible. seen, homogen cohes law strictli initi rigid small harden portion. remark 3.3. assumpt neglig microscop harden hold, modif propos scheme made. option comput macroscal bulk constitut model fly well. crack nucleation, macroscal bulk integr point longer coupl micro-model follow linear elast achiev divid f number sub-step ensur convergence. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 13 1 2 3 4 5 f m figur 5. forc control activ micro-model cohes crack insertion. forc appli node 1 node right edg forc displac node 1. um fm neglect m = d0 : m tm = ([[u]]m,m) ultm ultm figur 6. coupl macro- micro-model cohes crack modelling. law effect properti evalu crack nucleat moment. option share similar method given [27]. scope manuscript present [55]. 3.1.5. principl scale separ section discuss issu principl scale separ cohes crack multiscal model. let recal quantiti averag propos model- bulk materi surround crack crack itself. principl scale separ appli bulk homogen requir dimens micro-sampl (for bulk homogenization) smaller macroscop lengthscal macroscal field (stress strain) uniform micro-sample. crack homogenization, order satisfi principl scale separation, micro-sampl small compar macroscal fractur process zone (fpz) averag quantiti (e.g., tm [[u]]m) constant it. fpz know priori, condit current check posteriori. potenti solut cohes integr point fpz, principl scale separ hold, micro-model smaller dimens used. kind rve-siz adapt topic futur research. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 14 v.p. nguyen et al. 3.2. macro-micro coupl adhes crack t t tm t m um u m m 1m1m 2m 2m solv micro bvp n x1m x2m [[u]]m [[u]]m tm, tm tadh w tadh zero-thick interfac element micro local band figur 7. schemat represent multiscal adhes crack scheme. figur (7) present scheme multiscal framework adhes crack thick tadh joint adher 1 m 2 m. behavior adhes crack determin mean micro-model repres microstructur insid crack. case micro-model width w equal tadh refer case case w < tadh denot case ii, follow convent adopt [31]. 3.2.1. case micro-model width w equal tadh, ur = [[u]]m. multiscal scheme trivial. macro-jump directli impos right edg rve, microscal bvp solved. macro-tract macroscal cohes tangent comput eqs.(20a) (20b). scheme present [17] small strain problem later [18] finit deform share similar given [21]. 3.2.2. case ii homogen relat adhes crack case micro- model width smaller adhes crack thick i.e., w < tadh deriv [31] microscal discret crack [32] microscal local damage. final equat given ur = (w tadh)c0 tm + [[u]]m (26) copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 15 provid homogen relat microscal inform macroscal cohes law (tm, [[u]]m). compar express eq.(18) (for cohes cracks) show eq.(26) obtain eq.(18) l = tadh (the complianc scale tadh) udam = 0 (sinc adhes crack present macro-model onset simulation). equat need solv microscal given f int m (um) = f ext m ([[u]]m) ur(um) = (w tadh)c0tm + [[u]]m (27) consist microscal equilibrium eq.(14) homogen relat eq.(26). equat solv iter scheme similar cohes cracking, reader refer [32] details. emphas equat differ cohes crack, eq.(19), sens filter microscop linear respons macro-jump equat microscal inelast displacements, adjust microscop linear displac case ii solut match case solution. emphas homogen relat given eq.(26) applic soften regime, eq.(27) ensur solut soften regim coincid solut obtain case algorithm (for consid problem). linear regim solv case algorithm ur = (w/tadh)[[u]]m . transit linear regim soften regim detect appear neg eigenvalu macro cohes tangent tm [25]. flowchart multiscal adhes crack scheme ident cohes cracks, cf. box (1). differ li step (a)- solv eq.(14) case scheme solv eq.(27) case ii scheme. discuss trade-off case case ii scheme given problem given [32]. remark 3.4. homogen equat (26) resembl equat deriv [31], briefli present scheme adhes crack multiscal model follow reasons. case scheme exactli given mere completeness. case ii scheme, [31] consid microscop discret crack studi microscop diffus damage. furthermore, note iter scheme solv eq.(27) differ solut techniqu adopt [31]. 3.3. boundari condit microscal model boundari condit boundari node micro-mesh given period bc : ut = ub + u2 u1 fix bc : ul = 0 prescrib bc : ur = g([[u]]m) (28) guarante linear respons obtain case case ii algoritm identical, [32] explaination. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 16 v.p. nguyen et al. independ node depend node interior pull con 1 t b l r 2 figur 8. illustr node group simpl micro-mesh. fig.(8) notations. above, u indic microscal displac dofs, g([[u]]m) = [[u]]m case adhes crack model. cohes scheme case ii adhes scheme, reader refer [32] details. note notat sequel. kind bc given [17] refer hybrid bcs/semi-period bc [18]. 4. algorithm aspect section, implement detail presented. note basic implement multilevel fem instanc [5]. effici solut microscal nonlinear problem period bc discuss first. extract macroscal cohes tangent matrix tm microscal stiff probe method presented. advantag method avoid invers large, spars matrix explicit partit sub-matrices. treatment arbitrari macro-crack orient i.e., crack coordin align global coordin system, given. best author knowledge, work homogen focus mainli monoton loading. present discuss comput homogen loading/unload cases. finally, resolv snapback macroscop scale dissipation-bas arc-length control [56] presented. 4.1. solut micro problem follows, master-slav method, solv microscop linear period constraints, present details. emphas [18] topic given. however, present somewhat differ implement section need subsequ presentation. section, subscript m (indic microscal quantities) omit sake clarity. let write period bc given section 3.3 follow format ud = cui (29) c depend matrix; subscript d denot depend independ copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 17 degre freedom, respectively, fig.(8). microscal nodal unknown vector written term independ nodal valu u = [ ui ud ] = [ c ] ui tui (30) [3ni 3ni] unit matrix (ni number independ nodes) t so-cal transform matrix rectangular matrix. microscal linear rearrang [ kii kid kdi kdd ] [ ui ud ] = [ ri rd ] (31) r residu vector. substitut eq.(30) pre-multipli side tt obtain [ ct ] [ kii kid kdi kdd ] [ c ] ui = [ ct ] [ ri rd ] (32) yield sought-for reduc k ui = r (33) k, [3ni 3ni] matrix r, [3ni 1] vector, given k = ttkt r = ttr (34) usual eq.(33) solv independ displac increment depend displac increment comput eq.(29) (e.g., [5, 18]). here, prefer solut method alter dimens stiff matrix. advantages. first, need track dof correspond unknown linear solver. second, need store new, constrain matrix (k) linear solv iter solver. case origin matrix, appli matrix t matrix-vector multiplication. advantag parallel comput processor setup appli constraint have modifi commun data structur linear solver. precisely, follow solv instead eq.(33) [ ttkmt 0 0 ] [ ui ud ] = [ r ud ] (35) words, matrix k augment trivial equat iud = ud dimens km. unit matrix 2d. note gradient enhanc damag model microscale, dof node. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 18 v.p. nguyen et al. remark 4.1. motiv premultipli eq. (31) tt order obtain eq. (32) follows. matrix t essenti encod relationship independ dof dofs, includ depend dofs. mean matrix ttkt view project matrix k vector space span independ dofs. words, equat project vector space span independ dof solv resulting, smaller equations. 4.2. probe method comput macroscal cohes tangent equat (35) written follow format converg state microscal bvp kaam k ab m 0 kbam k bb m 0 0 0 uam ubm ud = 0 fb ud (36) b denot dof associ node right edg dof remain node exclud nodes, fig.(8). allow follow condens k ,bb m u b m = fb (37) k ,bb m = k bb m kbam (kaam )1kabm (38) [3nb 3nb] matrix filter k,rm , [2nb 2nb] matrix involv displac dof node b, follow k ,r m = t k ,bb m (39) [3nb 2nb] boolean matrix. note fe formul adopt microscop scale involv displac dof (e.g., non-loc integr damag model) step skipped. substitut eq.(38) eq.(20b) yield tm = 1 h m t t[kbbm kbam (kaam )1kabm ]am (40) materi complex multi-phas microstructures, microscal stiff matrix large, spars matrix invers partit oper obvious inefficient. order avoid them, us so-cal probe techniqu simpl techniqu construct matrix, tm, seri matrix-vector products. matrix built columnwis manner. column tm comput multipli rh eq.(40) e1 = [1 0] t t 1 m = 1 h m t t[kbbm f kbam (kaam )1kabm f ], f = ame1 (41) order comput kbbm f k ab m f , suffic follow matrix-vector multipl copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 19 [ kaam k ab m kbam k bb m ] [ 0 f ] = [ kabm f kbbm f ] [ g h ] (42) column tm given t 1 m = 1 h m t t[h kbam (kaam )1g] (43) comput (kaam ) 1g, suffic solv follow linear [ kaam k ab m kbam k bb m ] [ u 0 ] = [ g 0 ] (44) finally, comput kbam (k aa m ) 1g = kbam u, follow matrix-vector multipl [ kaam k ab m kbam k bb m ] [ u 0 ] = [ kaam u kbam u ] [ m l ] (45) summarize, column consist tangent moduli given t 1 m = 1 h m t t(h l) (46) consist solut linear eq.(44) matrix-vector multiplications. manner, second column tm comput e2 = [0 1] t. demonstrated, procedur follow directli need matrix inversion. furthermore, calcul involv total rve matrix. explicit sub-matrix needed. eas implementation, procedur given box 2. remark 4.2. emphas [57] author propos perturb method comput macroscop tangent multilevel finit element set altern standard condens procedure. reason avoid larg memori requir store microscop sub-matrices. present implement standard condens util need alloc new sub-matrix. 4.3. handl arbitrari macro-crack direct discuss far appli case angl (n, x1m) zero. case shown fig.(9a), options. option, geometri micro-model rotat order align macro-crack, fig.(9b). accord second option (adopt work), applic materi microstructur have isotrop geometri (e.g., random microstructur target materi work), posit micro-model fixed, fig.(9c), proce follows. global macro- jump vector transform local coordin associ point crack surfac [[u]]n = q[[u]]m (47) local jump vector boundari condit impos rve boundaries. compon [[u]]n boundari condit x 1 m direct copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 20 v.p. nguyen et al. box 2 comput macroscal cohes tangent probe method 1. assembl micro stiff 2. construct modifi matrix eq.(35) (1) 3. initi 3n 1 vector d = 0 f1 = 0, n total number micro node 4. = 1, 2, (a) comput f = mei (b) set d[b] = f (c) comput rh = kmd, g = rhs[a], h = rhs[b] (d) solv linear kmu = f1 f1[a] = g (2) (e) comput rh = kmu, m = rhs[a], l = rhs[b] (f) comput column tim = 1 h mt(h l) 5. end (1) need iter solver. (2) homogen boundari condit u[b] = 0. m m x 1 m x2m n (a) (b) (c) figur 9. arbitrari macro crack orient (a), rotat rve geometri (b) (c)-fix rve geometri (applic microstructur have isotrop geometry). second x2m direction. solv rve problem, obtain macro- traction tangent local coordin system, tn tns, eq.(20a) eq.(20b), respectively, transform global coordin follow tm = qtns, tm = qtnsq (48) q orthogon transform matrix, [58]. emphas option rotat micro-model geometry, fig. (9b), materi have microstructur preferenti direct (e.g., masonry). remark 4.3. note option describ fig. (9b) gener i.e., appli materi option given fig. (9c) save comput effort materi isotrop geometry. emphas propos approach, fig. (9c), work non-proport loadings. example, initi load caus damag micro- copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 21 sample, unload occurs, load direct changed, subsequ caus micro-sampl damaged. damag phase micro-sampl anisotrop violat assumpt isotropi micro-sampl propos approach develop i.e., propos algorithm invalid. 20 2 05 50 2 20 2 20 2 70 2 450 e 25000 n/mm2 0.2 3e-05 0.999 5000 c 3.5 mm2= = = = = = figur 10. inclin materi layer have period void microstructure. unit length mm. exampl illustr idea, let consid problem shown fig.(10) consist homogen elast adher join void damag adhes layer. sampl fix vertic direct edg horizont direct left right edges. bc ensur homogen state deform obtain integr point adhes crack. simul perform plane stress condit mean uniform vertic displac impos edge. finit element mesh direct numer simul (dns) model multiscal model (case model w = tadh = 20 mm) given fig.(11). paper, four-nod linear interfac element newton-cot integr (2 integr points) rule adopt model adhes crack. figur (12) give comparison load-displac curv dn multiscal models. multiscal solut properli follow dn solution. attribut small discrep solut mismatch geometri boundari adhes layer dn multiscal simulations, fig. (13). damag pattern dn rve shown fig. (14). 4.4. loading/unload treatment 4.4.1. adhes crack-cas let consid case (micro sampl width w equal tadh). ur = [[u]]m, unload handl natur i.e., macroscal unload follow microscal unloading. therefore, work needed. 4.4.2. adhes crack-cas ii/cohes crack case ii, ur 6= [[u]]m cohes cracks, failur zone averag scheme fail unload occur (becaus activ damag domain d empty). reasons, loading/unload treat histori variabl maximum open displac reach [[u]]maxm . assum secant copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 22 v.p. nguyen et al. dn mesh fe2 mesh figur 11. inclin materi layer: dn mesh multiscal meshes. line denot interfac elements. 0 5 10 15 20 25 30 35 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 lo d [ n ] displac [mm] (x10-2) dn fe2 figur 12. inclin materi layer: comparison load-displac curv dn multiscal (case i). dn multiscal figur 13. inclin materi layer: geometri mismatch dn multiscal (case i) models. unloading, macro traction defin tm = tmaxm [[u]]maxm [[u]]m (49) tmaxm comput [[u]] max m analyt lack phenomenolog cohes law, comput micro-model correspond state right unload occurs. note macro unloading, micro-model load copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 23 figur 14. damag pattern dn (left) rve associ interfac element (right). micro-bvp need solved. u 100 2 0 0 20 20 40 20 40 40 figur 15. simpl problem (all unit mm) vertic materi layer have thick 40 mm. layer period void microstructure. rve (void radiu 5) shown right investigated. exampl handl loading/unload multiscal simulation, consid simpl test given fig.(15) consist adher join adhes layer 40 mm thickness. prescrib displac u equal 0.4 mm, sampl unload reload final failur sample. plane stress condit assumed. materi properti micro-model fig.(10) soften slope = 3000. load-displac curv shown fig.(16) verify, case (micro-model 4040 40 20) case ii (micro-model 20 20) schemes, object macroscal respons respect adopt micro-model loading/unload excitations. 4.5. macroscal snapback dissipation-bas arc-length control trace equilibrium path snap snapback point tradition undertaken mean path-follow method (also known arc-length methods), instanc [59, 60]. eleg method, dissipation-bas arc-length method, recent introduc [56, 61] trace complex equilibrium paths, [43] applic copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 24 v.p. nguyen et al. 0 10 20 30 40 50 60 70 80 90 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 lo d [ n ] displac [mm] (x10-2) 20x20 40x20 40x40 figur 16. multiscal cohes law unload behavior. examples. section, present preliminari studi resolv macroscop snapback multiscal setting. note particular materi model microscale, microscal snapback occurred. happen, solut report [62]. best knowledge, multiscal simul involv macroscop microscop snapback report literature. accord dissipation-bas arc-length method [56, 61], macroscal equat given f int m (um) = f (,um) = 0 (50) f unit forc vector, so-cal load factor constraint equat that, given load step, defin manner predefin energi released. detail [56, 61]. contrari arc-length methods, defin term global quanti need track area local nonlinear take place. usually, set fall follow bound min max (51) example, express max = legic [61] pum method crack extend singl element converg step. fe2 setting, chosen smaller micro-model converge. univers rule ensur converg macro-model micro-model miss macro-model converge, correspond macroscal load step resolv smaller . figur (17) describ consid problem show macroscop snapback behavior. macro-mesh simpli compos four-nod quadrilater (q4) element interfac element behavior come micro-samples, 40 20 mm2 case scheme 20 20 mm2 case ii scheme. plane stress condit assumed. macroscal load-displac curv obtain differ valu min given fig. (18). copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 25 100 5 0 1 5 045 o 2020 4020 e 25000 0.2 e 25000 n/mm2 0.2 3e-05 0.999 5000 c 3.5 mm2= = = = = = = = figur 17. simpl test macro-snapback. void radiu 5. unit length mm. 0 5 10 15 20 25 30 35 40 45 50 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 lo d [ n ] displac [mm] (x10-2) (a) min = 0.02 nmm, case 0 5 10 15 20 25 30 35 40 45 50 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 lo d [ n ] displac [mm] (x10-2) (b) min = 1e 04 nmm, case 0 5 10 15 20 25 30 35 40 45 50 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 lo d [ n ] displac [mm] (x10-2) 20x20 40x20 (c) min = 1e 04 nmm, case ii figur 18. handl macroscop snapback dissipation-bas arc-length control multiscal adhes crack scheme. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 26 v.p. nguyen et al. u2 0 0 10010 10 20 20 figur 19. simpl problem cohes crack show macroscop snapback. unit mm. 0 10 20 30 40 50 60 70 80 90 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 lo d [ n ] displac [mm] (x 10-2) figur 20. handl macroscop snapback dissipation-bas arc-length control multiscal cohes crack scheme. cohes cracks, let consid problem depict fig.(19). materi paramet micro-model given fig.(17) = 6000. plane stress condit assumed. load-displac curv given fig.(20). valu min = 1e 03 nmm used. shown dissipation-bas arc-length control present [56] seamlessli adopt propos multiscal crack model framework. mention secant unload critic assumpt allow arc-length control work. 5. numer exampl section, numer exampl given demonstr perform propos multiscal method. example, simpl macro-sampl uni-axi tension analyzed. microstructur is, however, complex random multi-phas material. aim exampl verifi object method respect micro-model size. converg properti present method investig second example. wedg split test analyz exampl comparison dn given. finally, failur singl edg notch beam (sen) involv propag copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 27 curv crack given final example. finit element mesh section gener gmsh [63] concret micro-sampl fourth exampl creat space [64]. 5.1. rve exist test 15 x 15 mm2 20 x 20 mm2 300 1 0 0 1010 15 15 20 20 figur 21. geometry, finit element discret macro-model (left) micro-sampl (right) rve exist test. unit mm. matrix aggreg itz e [n/mm2] 25000 30000 20000 [-] 0.2 0.2 0.2 [-] 5e-06 0.5 3e-06 [-] 0.999 0.999 0.999 [-] 1500 1500 1500 c mm2 0.2 0.2 0.2 tabl i. materi paramet differ phase random heterogen material. order verifi object multiscal solut respect micro-model size, problem shown fig.(21) devised. satisfact failur criterion, im 0.97ultm , vertic crack initi middl element (we allow crack example). behavior crack come fe comput realiz micro-sampl three-phas materi (aggregate, matrix interfaci transit zone (itz)) materi paramet tabl (i). sampl correspond 45% volum fraction aggreg (of radiu vari 2.5 mm 5.0 mm). width itz 0.25 mm. microscal fe mesh consist 10 052 18 208 three- node triangl element (t3 elements) 15 15 mm2 20 20 mm2 sample, respectively. plane strain condit assum micro-models. effect elast moduli d0 comput comput homogen approach describ section 3.1.2 microstructur concret mesoscale. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 28 v.p. nguyen et al. d 15 0 = 29903.0 7485.55 1.15865 7485.55 29905.9 0.919313 1.15865 0.919313 11213.6 ,d200 = 29804.3 7456.68 0.135379 7456.68 29812.1 0.0845691 0.135379 0.0845691 11173.7 (52) micro-sampl 15 15 mm2 20 20 mm2, respectively. object macroscal solut respect micro-model size judg fig.(22) show macroscal load-displac curv obtain micro- samples. emphas micro-sampl smaller 1515 mm2 yield differ macroscal solut micro-sampl larg [33]. homogen cohes law given figure. note crack insert slightli ultim load micro-model, homogen cohes law initi rigid convent cohes laws. 0 2 4 6 8 10 12 14 16 0 0.1 0.2 0.3 0.4 0.5 lo d [ n ] displac [mm] (x 10-2) 15x15 20x20 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0 0.1 0.2 0.3 0.4 0.5 tr ct io n [ n ] open [mm] (x 10-2) 15x15 20x20 figur 22. rve exist test: object macroscop load-displac diagram obtain microstructur (left) homogen traction-open law (right). remark 5.1. number load increment requir solv macroscop bvp moment crack nucleat final failur denot n. macroscal load increment averag number m newton-raphson iterations. macroscal newton- raphson iter solv 2p micro-bvp (in exampl crack segment 2 integr points). therefore, total number micro-bvp nm 2p. consid n = 60, m = 4 p = 2, simpl exampl solv 480 micro-bvp dimens 30 156 dof (for 15 15 mm2 sample). needless say, advanc techniqu capabl reduc comput cost propos multiscal scheme necessary. promis avenu model order reduct method appli microscal damag model. basic idea set [7, 65]. 5.2. converg properti multiscal scheme exampl aim give hint converg properti multiscal scheme present before: adhes crack scheme (case case ii) cohes crack scheme. us consist tangent matrix microscal yield optim quadrat converg rate microscal problem converg properti microscal copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 29 problem standard reported. rather, focu converg perform newton-raphson iter method macroscal iter scheme solv eqs.(19) (27). adhes cracks, let reconsid problem given fig.(15), section 4.4. materi properti micro-model fig.(10). sampl load displac control constant step u = 0.0001 mm. case scheme (micro- model 40 20 mm2), load-displac diagram number newton-raphson (nr) iter requir macroscal load increment given fig.(23). quadrat converg rate observ tabl (ii). note load step 31 difficult slope vertical. explain 6 nr iter requir step. 0 10 20 30 40 50 60 70 80 90 0 0.1 0.2 0.3 0.4 0.5 0.6 lo d [ n ] displac [mm] (x10-2) 40x20 31 0 1 2 3 4 5 6 7 0 8 16 24 32 40 n u m b e r o f it ra tio n s p e r st e p load step number figur 23. adhes scheme-cas i: load-displac curv newton- raphson iter macroscal load step. residu r standard scale residu current iter iteration, read r = f extm f intm f extm f intm 1 (53) |||| l2 norm. step no. iter no. residu r 31 1 4.6334e-02 2 2.4752e-02 3 2.5577e-02 4 3.5018e-03 5 1.1404e-04 6 1.3562e-07 36 1 3.3328e-02 2 1.7055e-04 3 4.3285e-09 tabl ii. adhes scheme-cas i: perform macroscal newton-raphson method. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 30 v.p. nguyen et al. turn attent adhes crack-cas ii scheme. case, 20 20 mm2 micro-model used. figur (24) show load-displac diagram number nr iter requir macroscal load increment. attribut need larg number nr iter (19) macroscal load step 31 facts. vertic slope load-displac curv point. second step 31 transit step harden regim soften regime. let recal us differ scheme harden soften parts, section 3.2.2. steep soften slope = 3000 (so far = 5000 used), figur (25) obvious show maximum number nr iter 4. fig.(24) give number micro-bvp solv macroscal nr iterations. seen, far peak, micro-bvp solv time macroscal nr iter similar standard fe2 methods. 0 10 20 30 40 50 60 70 80 90 0 0.1 0.2 0.3 0.4 0.5 0.6 lo d [ n ] displac [mm] (x10-2) 20x20 31 0 4 8 12 16 20 0 8 16 24 32 40 n u m b e r o f it ra tio n s p e r st e p load step number 0 1 2 3 4 0 31 62 93 124 155 n u m b e r o f m ic ro b v p macro newton-raphson iter figur 24. adhes scheme-cas ii: load-displac curv (top left), newton- raphson iter macroscal step (top right) number micro-bvp macroscal newton-raphson iter (bottom). cohes crack homogen scheme, problem given fig.(19) consid again. materi properti micro-model fig.(10) = 1000 smooth macroscal equilibrium path. figur (26) show load-displac diagram number nr iter requir macroscal load increment. nr iter need macroscal step round peak. reduct residu macroscal load increment peak tabul tabl (iii). fig.(26) give number micro-bvp solv macroscal nr iterations. far copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 31 0 10 20 30 40 50 60 70 80 90 0 0.1 0.2 0.3 0.4 0.5 0.6 lo d [ n ] displac [mm] (x10-2) 20x20 0 1 2 3 4 5 0 10 20 30 40 50 n u m b e r o f it ra tio n s p e r st e p load step number figur 25. adhes scheme-cas ii, smooth respons = 3000: load-displac curve, newton- raphson iter macroscal step. 0 10 20 30 40 50 60 70 80 90 100 0 0.5 1 1.5 2 2.5 lo d [ n ] displac [mm] (x 10-2) 20x20 0 1 2 3 4 0 22 44 66 88 110 n u m b e r o f it ra tio n s p e r st e p load step number 0 1 2 3 0 83 166 249 332 415 n u m b e r o f m ic ro b v p macro newton-raphson iter figur 26. cohes crack scheme: load-displac curv (top left), newton- raphson iter macroscal step (top right) number micro-bvp macroscal newton-raphson iter (bottom). peak, micro-bvp solv time macroscal nr iter similar standard fe2 methods. 5.3. wedg split test wedg split test, given fig.(27), studi example. sampl matrix-fib materi (with weak transit zone, itz, model matrix-fib interfac debonding). order reduc comput cost, microstructur explicitli copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 32 v.p. nguyen et al. step no. iter no. residu r 17 1 1.0189e-02 2 6.9791e-04 3 2.5718e-06 18 1 5.8094e-03 2 1.2804e-04 3 3.3568e-08 tabl iii. cohes crack scheme: perform macroscal newton-raphson method. 50 2 0 0 7 0 7 0 30 70 effect properti 5 5 10 sampl fiber radiu 0.85 itz thick 0.08 figur 27. wedg split test: geometri (unit mm) boundari conditions. resolv region notch crack expect develop grow. rest (shade region) model homogen linear elast effect properti (the young modulu 12647.66 n/mm2 poisson ratio 0.2). materi red region follow isotrop non-loc damag model describ section 2.2.1 materi paramet given tab.(iv). analysi perform plane stress state displac control. exampl special design order comparison propos multiscal model dns. simpl microstructur taken singl local band promoted. fe discret dn model, shown fig.(28), consist 25 368 three-nod triangl element 12 778 node (36 366 dofs). finit element mesh macro-model micro-model multiscal simul given fig.(29). im 0.999ultm , macro-crack initiates/propagates. example, symmetry, crack direct macroscal forc horizontal. evolut damag dn evolut macro-crack fe2 model shown figs.(30-31). observ fig.(30) macro-crack multiscal model run slightli local band dns. attribut fact (i) macroscop load increment larger fe2 simul dn (ii) differ failur criterion- dns, strain-bas damag copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 33 matrix fiber itz e [n/mm2] 25000 30000 20000 [-] 0.2 0.2 0.2 [-] 5e-05 0.5 3e-05 [-] 0.999 0.999 0.999 [-] 100 100 100 c mm2 0.005 0.005 0.005 tabl iv. materi paramet differ phase fiber-reinforc composite. initi criterion fe2 stress-bas crack initi criterion adopted. observ fig.(32) boundari effect properli handl multiscal model. remedi appli period bc interior rve (e.g., rve far boundaries) better tailor bc boundari rves. element allow damag figur 28. wedg split test: fe mesh dn model (25 368 three-nod triangl elements). element matrix phase upper (red color) allow damaged. comparison load-displac curv dn multiscal model (denot fe2) depict fig.(33). peak load obtain dn 48.70 n peak load obtain multiscal model 48.36 n. curv associ multiscal model smooth fact (i) macroscop load increment step larg (to reduc comput time) (ii) mesh macro-model coars (keep mind pum implementation, crack grow element-wise). emphas order fair comparison dn fe2, have, dns, prevent damag start corners, fig.(28). concern comput cost, dn time 14 hour fe2 time 4 hour i.e., 3 time faster. 5.4. singl edg notch beam exampl curv propag crack analysi present multiscal cohes crack framework, let consid singl edg notch beam given fig.(34). problem studi experiment [66] numer monoscal set by, instance, copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 34 v.p. nguyen et al. figur 29. wedg split test: fe mesh multiscal model. macro-mesh consist 1426 three-nod triangl element micro-mesh compos 4092 t3 elements. crack initi point grow horizont right edge. rve, element matrix phase right (red color) allow damaged. macro-crack direct horizont micro local band vertical, algorithm given section 4.3 used. 2525 figur 30. wedg split test: damag pattern dn model (top) crack path damag rve fe2 model peak. [40] multiscal set [29, 31]. [31], author studi influenc microstructur macroscal ultim load. post-peak respons reported. here, focu issu robust propos multiscal scheme. aim complet multiscal analysi curv crack propag achieved. comparison dn performed. beam concret material. behavior macro-crack, initi lower-right notch propag curv trajectori right lower-right support, come microscal fe comput perform 10 10 mm2 micro-model shown fig.(35b). fe discret given fig.(35). load platen model steel. plane stress condit assum micro-model. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 35 figur 31. wedg split test: damag pattern dn model (top) moment local band approach right edg specimen crack path damag rve fe2 model. left rve right rve figur 32. boundari effects: period boundari condit suitabl boundari rves. materi paramet constitu three-phas microstructur tabl (i) c = 0.1 mm2. maximum macroscal princip stress exce 99% ultm , crack initi propag direct determin non-loc stress field crack tip, section 3.1.1. deal curv crack exampl crack direct align micro-sampl algorithm given section 4.3 used. analysi perform dissipation-bas arc-length method [56] sub-step scheme propos [67]. sub-step techniqu allow us rel larg macroscal load increment dramat reduc comput cost fe2 computations. basic idea scheme appli multiscal cohes crack model solut micro-bvp, eq.(191), obtain (the correspond macroscal load increment big), displac impos rve divid sub-steps. emphas resolv diverg micro-model sub-step cheaper resolv macro-model smaller macro load increment. deform shape sen beam given fig.(36) curv crack path copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 36 v.p. nguyen et al. 0 10 20 30 40 50 0 0.1 0.2 0.3 0.4 0.5 lo d [ n ] displac [mm] (x 10-2) dn fe2 figur 33. wedg split test: comparison load-displac curv dn multiscal cohes crack scheme. 1 0 0 440 20 20 20 2 0 20 5 p/11 10p/11 b figur 34. singl edg notch beam (sen): geometri (all unit mm), boundari conditions. depth beam 100 mm. crack mouth slide displac (cmsd) defin differ vertic displac point b. experiment observ captur well. respons sen beam, measur term load p versu cmsd, given fig.(37). 6. conclus manuscript, detail concern implement comput aspect multiscal cohesive/adhes crack model framework comput homogen presented. behavior macroscal crack deriv finit element comput realiz microscal sampl underli heterogen microstructur undergo local damag explicitli taken account. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 37 10 1 0 (a) macro-model (b) micro-model figur 35. sen beam: fe mesh macro-model (1219 q4 elements) micro-model (5280 t3 elements). figur 36. sen beam: deform configur beam (magnifi factor 500) snapshot damag micro-models. 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 0 0.0005 0.001 0.0015 0.002 0.0025 0.003 f o rc e p [ kn ] cmsd [mm] 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0 0.001 0.002 0.003 0.004 0.005 tr ct io n [ n ] open [mm] figur 37. sen beam: load p cmsd (left) typic homogen cohes law (right). copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 38 v.p. nguyen et al. issu includ loading/unloading, macroscop snapback, arbitrari crack orient converg characterist multiscal scheme addressed. effici implement master-slav method solv nonlinear equat constraint discussed. probe method given comput macroscal tangent matrix microscal stiff matrix invers partit operations. given numer exampl method failur analysi solid random heterogen microstructur undergo local damage. util better design materi adjust underli microstructur constitu shape properties. like comput homogen method, propos method computation demand limit applicability. convent us parallel computers, model reduct techniqu appli microscal damag model dramat reduc comput cost comput homogen base multiscal simulations. model adaptivity, microscal comput integr point fractur process zone whilst point follow analyt cohes law, capabl enhanc speed propos method. acknowledg financi support delft center comput scienc engin (dcse) gratefulli acknowledged. author thankfulli appreci discuss dr. erik jan lingen habenara, netherlands. refer [1] p. m. suquet. local global aspect mathemat theori plasticity. a. sawczuk g. bianchi, editors, plastic today: modelling, method applications, page 279310, london, 1985. elsevier. [2] r.j.m. smit, w.a.m. brekelmans, h.e.h. meijer. predict mechan behavior nonlinear heterogen system multi-level finit element modeling. method appli mechan engineering, 55:181192, 1998. [3] s. ghosh, k. lee, s. moorthy. scale analysi heterogen elastic-plast materi asymptot homogen voronoi cell finit element model. method appli mechan engineering, 132:63116, 1996. [4] c. miehe, j. schroder, j. schotte. comput homogen analysi finit plastic simul textur develop polycrystallin materials. method appli mechan engineering, 171(3-4):387418, 1999. [5] v. kouznetsova, w. a. m. brekelmans, f. p. t. baaijens. approach micro-macro model heterogen materials. comput mechanics, 27(1):3748, 2001. [6] i. ozdemir, w.a.m. brekelmans, m.g.d. geers. comput homogen heat conduct heterogen solids. intern journal numer method engineering, 73:185204, 2008. [7] e. monteiro, j. yvonnet, q.c. he. comput homogen nonlinear conduct heterogen materi model reduction. comput materi science, 42(4):704 712, 2008. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 39 [8] i. ozdemir, w.a.m. brekelmans, m.g.d. geers. fe2 comput homogen thermo-mechan analysi heterogen solids. method appli mechan engineering, 198(3-4):602613, 2008. [9] b.c.n. mercatoris, ph. bouillard, t.j. massart. multi-scal detect failur planar masonri shell comput homogenisation. engin fractur mechanics, 76(4):479499, 2009. [10] e. w. c. coenen, v. g. kouznetsova, m. g. d. geers. comput homogen heterogen sheets. intern journal numer method engineering, 83(8- 9):11801205, 2010. [11] b.c.n. mercatori t.j. massart. coupl two-scal comput scheme failur period quasi-brittl planar shell applic masonry. intern journal numer method engineering, 85(9):11771206, 2011. [12] c. oskay. two-level multiscal enrich methodolog model heterogen plates. intern journal numer method engineering, 80:11431170, 2009. [13] c. oskai g. pal. multiscal failur model analysi heterogen plates. intern journal damag mechanics, 19:575610, 2010. [14] d. peric, e.a. souza neto, r.a. feijoo, m. partovi, a.j.c. molina. micro-to-macro transit multi-scal analysi non-linear heterogen materials: unifi variat basi finit element implementation. intern journal numer method engineering, 2010. press. [15] f. feyel. multiscal fe2 elastoviscoplast analysi composit structures. comput materi science, 16(1-4):344354, 1999. [16] f. feyel. multilevel finit element method (fe2) respons highli non-linear structur gener continua. method appli mechan engineering, 192:32333244, 2003. [17] k. matous, m. g. kulkarni, p. h. geubelle. multiscal cohes failur model heterogen adhesives. journal mechan physic solids, 56(4):15111533, 2008. [18] c.b. hirschberger, s. ricker, p. steinmann, n. sukumar. comput multiscal model heterogen materi layers. engin fractur mechanics, 76(6):793812, 2009. [19] m. g. kulkarni, p. h. geubelle, k. matous. multi-scal model heterogen adhesives: effect particl decohesion. mechan materials, 41(5):573583, 2009. [20] m.v. cid alfaro, a.s.j. suiker, c.v. verhoosel, r. borst. numer homogen crack process fibre-epoxi layers. european journal mechan - a/solids, 29(2):119131, 2010. [21] m. g. kulkarni, k. matous, p. h. geubelle. coupl multi-scal cohes model failur heterogen adhesives. intern journal numer method engineering, 84(8):916946, 2010. [22] m.g.d. geers, v.g. kouznetsova, w.a.m. brekelmans. multi-scal comput homogenization: trend challenges. journal comput appli mathematics, 234(7):21752182, 2010. [23] i.m. gitman, h. askes, l.j. sluys. repres volume: exist size determination. engin fractur mechanics, 74(16):25182534, 2007. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 40 v.p. nguyen et al. [24] i.m. gitman, h. askes, l.j. sluys. coupled-volum multi-scal model quasi-brittl material. european journal mechan - a/solids, 27(3):302327, 2007. [25] t. j. massart, r. h. j. peerlings, m. g. d. geers. enhanc multi-scal approach masonri wall comput local damage. intern journal numer method engineering, 69(5):10221059, 2007. [26] t.j. massart, r.h.j. peerlings, m.g.d. geers. structur damag analysi masonri wall comput homogenization. intern journal damag mechanics, 16(2):199 226, 2007. [27] t.j. massart b.c.n. mercatoris. assess period homogenisation-bas multiscal comput scheme quasi-brittl structur failure. intern journal multiscal comput engineering, 7(2):153170, 2009. [28] t. belytschko, s. loehnert, j.h. song. multiscal aggreg discontinuities: method circumv loss materi stability. intern journal numer method engineering, 73(6):869894, 2008. [29] t. belytschko j.h. song. coarse-grain multiscal crack propagation. intern journal numer method engineering, 81(5):537563, 2010. [30] f.v. souza d.h. allen. multiscal model impact heterogen viscoelast solid contain evolv microcracks. intern journal numer method engineering, 82(4):464504, 2010. [31] c.v. verhoosel, j.j.c. remmers, m.a. gutierrez, r. borst. comput homogenis adhes cohes failur quasi-brittl solids. intern journal numer method engineering, 83(8-9):11551179, 2010. [32] v.p. nguyen, o. lloberas-valls, m. stroeven, l.j. sluys. homogenization-bas multiscal crack modelling: micro-diffus damag macro-cracks. method appli mechan engineering, 200(9-12):12201236, 2011. [33] v.p. nguyen, o. llobera valls, m. stroeven, l.j. sluys. exist repres volum soften quasi-brittl materials-a failur zone averag scheme. method appli mechan engineering, 199(45-48):30283038, 2010. [34] p.a. guidault, o. allix, l. champaney, j.p. navarro. two-scal approach homogen comput crack structures. comput & structures, 85(17- 18):13601371, 2007. [35] t. hettich, a. hund, e. ramm. model failur composit x-fem level set multiscal framework. method appli mechan engineering, 197(5):414424, 2008. [36] s. eckardt c. konke. adapt damag simul concret heterogen multiscal models. journal algorithm & comput technology, 2:275297, 2008. [37] o. lloberas-valls, d. j. rixen, a. simone, l. j. sluys. multiscal domain decomposit analysi quasi-brittl heterogen materials. intern journal numer method engineering, 2010. (submitted, octob 19, 2010). [38] a. ibrahimbegov d. markovic. strong coupl method multi-phas multi- scale model inelast behavior heterogen structures. method appli mechan engineering, 192(28-30):30893107, 2003. [39] n. moes, j. dolbow, t. belytschko. finit element method crack growth remeshing. intern journal numer method engineering, 46(1):131150, 1999. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl comput homogen crack quasi-brittl materi 41 [40] g. n. well l. j. sluys. new method model cohes crack finit elements. intern journal numer method engineering, 50(12):26672682, 2001. [41] j. mergheim, e. kuhl, p. steinmann. finit element method cohes crack modelling. pamm, 4(1):350351, 2004. [42] j.h. song, p.m.a. areias, t. belytschko. method dynam crack shear band propag phantom nodes. intern journal numer method engineering, 67(6):868893, 2006. [43] f. van der meer l. sluys. phantom node formul mix mode cohes law split laminates. intern journal fracture, 158(2):107124, 2009. [44] x.p. xu a. needleman. numer simul fast crack growth brittl solids. journal mechan physic solids, 42(9):1434, 1397, 1994. [45] m. ortiz a. pandolfi. finite-deform irrevers cohes element three-dimension crack-propag analysis. intern journal numer method engineering, 44(9):12671282, 1999. [46] j. c. j. schelleken r. borst. numer integr interfac elements. intern journal numer method engineering, 36(1):4366, 1993. [47] g. beer. isoparametr joint/interfac element finit element analysis. intern journal numer method engineering, 21(4):585600, 1985. [48] d. v. kubair p. h. geubelle. compar analysi extrins intrins cohes model dynam fracture. intern journal solid structures, 40(15):38533868, 2003. [49] j. lemaitre. cours damag mechanics. springer-verlag, 1996. [50] j. mazar g.pijaudier-cabot. continuum damag theori - applic concrete. journal engin mechan divis asce, 115:345365, 1989. [51] r. h. j. peerlings, r. borst, w. a. m. brekelmans, j. h. p. vree. gradient enhanc damag quasi-brittl materials. intern journal numer method engineering, 39:33913403, 1996. [52] g.pijaudier-cabot z.p.bazant. nonloc damag theory. asm journal appli mechanics, 113:15121533, 1987. [53] j. simo j. ju. strain- stress-bas continuum damag models-i. formulation. intern journal solid structures, 23(7):821840, 1987. [54] c. miehe. comput micro-to-macro transit discret micro-structur heterogen materi finit strain base minim averag increment energy. method appli mechan engineering, 192(5-6):559591, januari 2003. [55] v. p. nguyen, m. stroeven, l. j. sluys. continuous-discontinu multiscal method model cohes crack random heterogen quasi-brittl materials. method appli mechan engineering, 2011. submitted. [56] m.a. gutierrez. energi releas control numer simul failur quasi-brittl solids. commun numer method engineering, 20(1):1929, 2004. [57] i. temiz p. wriggers. comput macroscop tangent multiscal volumetr homogen problems. method appli mechan engineering, 198:495510, 2008. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl 42 v.p. nguyen et al. [58] k.j. bathe. finit element procedures. prentic hall, 1996. [59] r. borst. comput post-bifurc post-failur behavior strain-soften solids. comput structures, 25(2):211224, 1987. [60] m. g. d. geers. enhanc solut control physic geometr non-linear problems. ii-compar perform analysis. intern journal numer method engineering, 46(2):205230, 1999. [61] c. v. verhoosel, j. j. c. remmers, m. a. gutierrez. dissipation-bas arc-length method robust simul brittl ductil failure. intern journal numer method engineering, 77(9):12901321, 2009. [62] t.j. massart, r.h.j. peerlings, m.g.d. geers. dissipation-bas control method multi-scal model quasi-brittl materials. compt rendu mecanique, 333(7):521527, 2005. [63] c. geuzain j.-f. remacle. gmsh, three-dimension mesh gener built-in pre- post-process facilities. intern journal numer method engineering, 79(11):13091331, 2009. [64] m. stroeven p. stroeven. space simul aggreg matter applic cement hydration. cement concret research, 29(8):12991304, 1999. [65] p. kerfriden, p. gosselet, s. adhikari, s. bordas. bridg proper orthogon decomposit method augment newton-krylov algorithms: adapt model order reduct highli nonlinear mechan problems. method appli mechan engineering, 200(5- 8):850866, 2010. [66] e. schlangen. experiment numer analysi fractur process concrete. phd thesis, delft univers technology, 1993. [67] d.d. somer, e.a. souza neto, w.g. dettmer, d. peric. sub-step scheme multi-scal analysi solids. method appli mechan engineering, 198(9- 12):10061016, 2009. copyright c 2000 john wilei & sons, ltd. int. j. numer. meth. engng 2000; 00:16 prepar nmeauth.cl view public statsview public stat introduct macroscal microscal model macroscal model constitut model macroscal cohes tangent microscal model constitut model fe model microscal macro-micro coupl macro-micro coupl cohes crack crack initiation/propag criterion effect elast constant tensil strength homogen materi micro model activ principl scale separ macro-micro coupl adhes crack case case ii boundari condit microscal model algorithm aspect solut micro problem probe method comput macroscal cohes tangent handl arbitrari macro-crack direct loading/unload treatment adhes crack-cas adhes crack-cas ii/cohes crack macroscal snapback dissipation-bas arc-length control numer exampl rve' exist test converg properti multiscal scheme wedg split test singl edg notch beam conclus