segreg runge-kutta time integr convection-stabil mix finit element scheme wall-unresolv le incompress flow oriol colomesa, santiago badiaa,b acentr internacion metod numer lenginyeria (cimne), parc mediterrani la tecnologia, upc, estev terrada 5, 08860 castelldefels, spain buniversitat politecnica catalunya, jordi girona 1-3, edifici c1, 08034 barcelona, spain. abstract work, develop high-perform numer framework larg eddi simul (les) incompress flows. spatial discret nonlinear carri mix finit element (fe) scheme supplement symmetr project stabil convect term penalti term diverg constraint. addit term introduc discret level prove act implicit le models. order perform meaning wall-unresolv simulations, consid weak imposit boundari condit nitsches-typ scheme, tangenti compon penalti term design act wall law. next, segreg runge-kutta (srk) scheme (recent propos author laminar flow problems) appli le simul turbul flows. introduct penalti term trace acceleration, method exhibit excel stabil properti implicit explicit treatment convect terms. srk scheme excel large-scal simulations, reduc comput cost linear solv split veloc pressur comput time integr level, lead uncoupl systems. pressur darcy-typ problem easili precondit tradit block-precondit scheme requir poisson solver. end, coerciv system solved, effect precondit multilevel domain decomposit schemes, optim scalable. framework appli taylor-green turbul channel flow benchmark order prove accuraci convection- stabil mix fe le model srk time integrators. scalabl precondit techniqu (in space only) proven step srk scheme taylor-green flow uniform meshes. moreover, turbul flow naca profil solv applic propos algorithm realist problem. keywords: larg eddi simulation, turbulence, variat multiscale, wall models, runge-kutta 1. introduct numer simul turbul flow wide scientif purpos highli de- mand industri solv larg engin problems. algorithm emploi comput fluid dynam (cfd) field constantli evolving, adapt new trends, tailor continu chang comput requirements. increas comput power acquir new improv supercomput involv addit advanc softwar abl execut machines. simul incompress turbul flow involv resolut multipl scales, space time, challeng numer problem. direct numer simul (dns) turbul flow captur physic phenomena scales, smallest ones. approach inconveni consum larg comput resources, impract real industri problems, exploit supercomputers. techniqu increasingli save lot comput cost larg eddi simul (les), basic consist separ flow coars scale fine one, simul coarser model finer [1]. order model fine scale le method, consid physic base approach defin addit model term continu level, pure numer approach preprint submit method appli mechan engin februari 24, 2017 introduc modif govern equations. numer approach commonli denot implicit le (iles) (see, e.g., [2]). variat multiscal (vms) method introduc hugh [3, 4] framework develop stabl accur numer approxim partial differenti equations, prevent numer instabl aris standard galerkin finit element (fe) method used. us vm method il method firstli suggest [5, 6, 7] and, then, vm method develop iles. scale vm approach base orthogon definit subscal space propos [8], name orthogon subscal (oss) method. oss-typ method requir includ residu stabil term end stabl accur algorithms, point [9], term-by-term oss stabil proposed. involv term pressur stabil (sinc equal order interpol used) term convect stabilization. finally, [10], inf-sup stabl mix fe consid symmetr project stabil convect term. note orthogon projector consid framework, like, e.g., local-typ project [11, 12]. complet assess vms-type solver le turbul flow [13, 10]. briefly, method consid analys show compar level accuracy, convection-stabil mix method cheaper term cpu cost. common approach cfd field consid strong imposit dirichlet boundari conditions, i.e., impos solut node dirichlet boundary. approach lead inaccur solut situations, special le method consid simul wall-bound turbul flows. le method motiv under-resolv meshes, insuffici captur boundari layer appear wall-bound flows. effect captur properli solut boundari layer affect mean flow, result imprecis simulations. thus, intens refin requir boundari layer order fully-resolv meshes, destroi desir cost reduct natur schemes. order overcom issue, wall law considered, e.g., weak imposit dirichlet boundari condit contemplated. nitsche-typ weak imposit consid [14] later improv wall law base approach turbul flow [15]. alternatively, robin-typ boundari condit consid [16] weaken no-penetr no-slip boundari conditions. exampl weak dirichlet boundari condit [17]. [14, 15] wall-norm compon veloc dirichlet boundari impos strongly. approach want avoid ill-pos definit curv boundaries, normal vector defin nodes; note box-typ domain consid [14, 15]. paper consid nitsch type weak imposit wall-norm compon wall law techniqu standard nitsch imposit tangent component, [18, 19]. notic before, turbul phenomena character have spatial scales, multiscal descript time. then, time discret import issu simul kind flows. author favor implicit time integr scheme avoid time step restrict given courant-friedrichs-lewi (cfl) number. however, high reynold number, hyperbol cfl number (given convect term) kept order uniti (see, e.g., [20]). then, common practic consid semi-implicit time integr scheme convect term treat explicit, avoid need satisfi stringent parabol cfl condition. see, e.g., [21], fractional-step method runge-kutta time integr used. exampl type time integr scheme [22], semi-implicit bdf time integr scheme consid vms-le spatial discret approach. time integr turbul flow practic applic involv fractional- step method segreg veloc pressur computations, clear reduct compu- tation time. way, avoid monolith indefinit split origin problem smaller coerciv problems. however, fractional-step method limit order accuraci second order; fact pressur extrapol momentum equation, higher order scheme unstabl (see [23]). hand, high order monolith solver computation demanding. effici block-precondit techniqu (see, e.g., [24]), solv veloc pressur problem solver iteration, iter usual pres- sure problem [10]. order solv situation, segreg runge-kutta (srk) time integr 2 scheme incompress navier-stok equat recent propos [25], test laminar flows. scheme base main goals. first, segreg veloc pressur comput time integr level, need perform addit fraction step techniqu spoil high order accuracy. second, preserv order accuraci veloc pressures. work, assess scheme turbul flows. stated, favour implicit-explicit (imex) version srk scheme consist treat implicitli diffus term explicitli convect term. velocity-pressur segreg introduc srk scheme lead elasticity-typ darcy- type problems. problem coercive, second straightforwardli precondit simpl block-precondit strategi involv mass poisson solver [10]. result, us srk scheme drastic simplifi linear solve, compar indefinit system aris monolith formulations. try solv increasingli larger problem supercomputers, effici exploit increas level parallelism, i.e., build scalabl solvers. coerciv natur build block srk time integration, work consid us balanc domain decomposit constraint (bddc) preconditioners, firstli introduc [26], follow implement describ [27, 28]. perform srk time integr combin block-precondit bddc domain decomposit precondit analyz work. main contribut paper are: us convection-stabil mix fe combin weakli enforc normal tangent veloc trace nitsch type methods, follow line [14, 15, 18, 19], order maintain under-resolv mesh domain, reduc comput cost (sect. 2) applic assess newli introduc srk scheme turbul flow il model extens weak dirichlet boundari conditions, order split problem segreg veloc pressur solver reduc order accuraci time (sect. 3) develop highli scalabl parallel framework il simul turbul flows, combin srk time integration, block preconditioning, highli scalabl implement bddc solver (sect. 4) assess result method il simul turbul incompress flow (sect. 5) develop line develop highli accur high-perform comput framework le simul incompress turbul flows. articl organ follows. sect. 2 navier-stok problem state weak imposit dirichlet boundari condit described. introduc mix fe formul convect stabil oss sect. 2.3. srk method, peculiar weak boundari condit considered, defin sect. 3. sect. 4 block-precondit techniqu parallel solver defined. differ test consid numer result section (sect. 5), taylor-green vortex flow, turbul channel flow test, flow airfoil defin naca 0012 geometry. finally, conclus point sect. 6. 2. convection-stabil mix fe scheme 2.1. navier-stok equat let bound domain rd, d = 2, 3 number space dimensions, = boundari (0, t ] time interval. strong form transient navier-stok problem consist find veloc field u pressur field p tu u + u u +p = f (0, t ], (1) u = 0 (0, t ], (2) 3 f forc vector kinemat viscosity. bold charact denot vector tensors. equat (1) (2) need suppli appropri boundari initi conditions. boundari divid dirichlet (d) neumann (n ) part d n = d n = . then, boundari initi condit written u = ug d (0, t ], (3) (pi + (u +ut )) n = qn n (0, t ], (4) u(x, 0) = u0(x) {0}, (5) n unit outward vector normal . order deriv weak form problem (1)-(5), defin notat hereinafter. denot lp(), 1 p <, space function p-th power absolut integr . particular, case p = 2, hilbert space scalar product (u, v) (u, v) := u(x) v(x)d (6) induc norm ul2() u = (u, u)1/2. abus notation, symbol (6) integr product functions, l2(), scalar vector fields. space function distribut deriv order m l2() denot hm(). focu case m = 1, hilbert space. h10 () set function h1() zero trace . furthermore, denot h1() topolog dual h10 () , dualiti pair h1() h10 (). given banach space x, lp(0, t ;x) bochner space time depend function x-norm lp(0, t ). equat (1)-(5) deriv weak form problem, consist find [u, p] l2(0, t ;v0) l1(0, t ;q0) (tu,v) +b(u, (u, p), (v, q)) = f ,v+ qn ,vn v v0, q q0, (7) satisfi initi condit (5) weak sense. v0 := h10() q0 := l2()/r. form b(u, (u, p), (v, q)) defin b(u, (u, p), (v, q)) := (u,v) + b(u,u,v) (p, v) + (q, u) (8) triliniar form convect term b(u,v,w) defin skew-symmetr version b(u,v,w) = 1 2 (u v,w) 1 2 (v,u w) + 1 2 (v, (u n)w)n . (9) 2.2. weak dirichlet boundari condit situat strong imposit dirichlet boundari condit (3) neg effect simul performance. case, instance, le method wall-bound flow problems. known le method difficulti try solv wall-bound problem (see, e.g., [29, 30]). issu solv kind problem le method boundari layer appear wall captur properli under-resolv meshes. then, need element wall order point viscou sublay (y+ 1) (see [31]). usually, requir satisfi us stretch meshes, element boundari coarser on middl channel. despit that, engin problem import captur properli large-scal flow properti fine scales, focus effect boundari layer mean flow instead try solv properli boundari layer itself. direction, approach us fact veloc profil boundari layer shown relat wall-norm distanc [31]. know relation, impos weak boundari condit 4 dirichlet boundari enforc traction gener wall given analyt expression. approach follow bazilev co-work [15], show weakly-impos boundari condit provid result strongly-impos on stretch meshes, improv significantli accuraci uniform meshes. weak dirichlet boundari condit used, function space test function lose properti have zero trace d, v v q q. therefore, consid term aris us integr part weak form navier-stok equat (7). includ follow term bilinear form. b(u, (u, p), (v, q)) =b(u, (u, p), (v, q)) (10) ((pi + 2su) n,v)d + 1 2 ((u n)u,v)d . assum u n = 0, term charg enforc given traction wall written (wt,v)d = ( w (u ug) u ug ,v ) d = (b(u ug),v)d , (11) t denot normal vector act direct traction w wall shear stress magnitude. term (11) penalti term paramet b := w u ug . (12) addit term, consid boundari term aris call nitsch method (see [32, 33]). then, result bilinear form (equival (8)) read bweak(u, (u, p), (v, q)) =b(u, (u, p), (v, q)) (13) + (b(u ug),v) ((q + 2 sv) n, (u ug)). note sign pressur test function second term (13) chang skew-symmetri velocity-pressur blocks. definit traction paramet w come minim residu spald equat y+ = f(u+) = u+ + eb ( eu + 1 u+ (u+) 2 2 (u+) 3 6 ) , (14) = 0.4, b = 5.5, y+ := yu wall distanc u+ := uh u mean flow veloc non- dimension wall units. case, distanc wall approxim proport wall-norm mesh size, y = hb p2cb , w = u 2 . here, hb denot wall-norm mesh size comput quadratur point, p order interpol fe, cb posit algorithm constant. deeper descript method algorithm comput paramet b [15]. however, work, author impos strongli normal compon veloc (u n = 0 d), thing want avoid current work. notic introduct present paper, normal vector defin node belong curv boundaries. [18] normal compon veloc wall enforc weakly, ad addit term account weak no-penetr condition. follow approach [19], split penalti term distinguish normal tangenti counterparts. let consid function v v. split normal tangenti compon follow v = (v n)n + (v (v n)n) = (n n)v + (i n n)v. (15) introduc decomposit (15) penalti term (b(u ug),v)d , consid dif- ferent penalti paramet component, b,n b,t, obtain equival penalti term (b,n(u ug), (n n)v)d + (b,t(u ug), (i n n)v)d . (16) 5 case, normal tangenti vector appear (11) read t = (inn)(uug) (inn)(uug) . us wall law base definit nitsch paramet tangenti component, defin wall-norm compon nitsch paramet proport origin express [14], lead follow definit b,n := cbp 2 hb , (17) b,t := w (i n n)(u ug) . (18) (17), constant tune adjust model. assess paramet select sect. 5.2. case, larg valu need stabil purpos symmetr version nitsch (or interior penalty) method (see [34]). replac penalti term (13) on (16), new express bilinear form bweak(u, (u, p), (v, q)) = b(u, (u, p), (v, q)) (19) + (b,n(u ug), (n n)v)d + (b,t(u ug), (i n n)v)d ((u ug), (qi + 2sv) n)d . order improv stabil segreg time integr scheme propos sect. 3, add addit boundari term weakli enforc trace time deriv tu d. point justifi remark 3.3. case, bilinear form read bweak,t(u, (u, p), (v, q)) = bweak(u, (u, p), (v, q)) (20) + (b,t,n(tu tug), (n n)v)d + (b,t,t(tu tug), (i n n)v)d , b,t,n := tb,n b,t,t := tb,t. let note term (20) dimension consist definit penalti parameters. 2.3. mix fe method convect stabil order defin semi-discret problem, consid fe partit th domain , construct conform fe space veloc field, vh v, pressur field, qh q. galerkin fe problem equival (7) consist find [uh, ph] l2(0, t ;vg,h) l1(0, t ;q0,h) (tuh,vh) +b(uh, (uh, ph), (vh, qh)) = f ,vh+ q,vhn vh v0,h,qh q0,h (21) initi condit (5) satisfi weak sense. v0,h q0,h denot set function belong vh qh, respectively, zero trace d. moreover, veloc field function space defin vg,h := {vh vh : vh|d = ug}. hand, weak boundari condit considered, problem result find [uh, ph] l2(0, t ;vh) l1(0, t ;qh) (tuh,vh) +bweak,t(uh, (uh, ph), (vh, qh)) = f ,vh+ q,vhn vh vh,qh qh. (22) note case uh,vh vh ph, qh qh. henceforth, assum case dirichlet boundari condit considered, i.e., d 6= , impos weakly, make us bilinear form defin (20). follow approach given codina [9], build vm method orthogon definit subscal essenti term guarante stabil ad galerkin fe formulation. consid orthogon project convect term pressur gradient term separately. approach reads: [uh, ph] l2(0, t ;vh) l1(0, t ;qh) (tuh,vh) +bweak,t(uh, (uh, ph), (vh, qh)) + ( m h (uh uh),uh vh ) h (23) + ( m h (ph),qh ) h + (c uh, vh)h = f ,vh vh vh,qh qh. 6 (23), stabil paramet m c usual defin m = ( c1 h2 + c2|a| h )1 , (24) c = h2 c1m , (25) h mesh size c1 c2 algorithm constants. altern (25) consid follow definit c c = cc ( + c1 c2 h|uh| ) , (26) result introduc (24) (25) consid new constant cc. approach analyz [10], implicit treatment project considered. static linear version algebra subgrid scale (asgs) method, perform mention method test le incompress turbul flows, compar convection- stabil mix fes. inf-sup stabl velocity-pressur fe pair used, pressur gradient project ap- pear (23) neglected, term requir stabil purposes. considerations, final semi-discret problem current work base consist find [uh, ph] l2(0, t ;vh) l1(0, t ;qh) (tuh,vh) +bweak,t(uh, (uh, ph), (vh, qh)) + (muh uh,uh vh)h (27) (mh,uh vh)h + (c uh, vh)h = f ,vh vh vh,qh qh, h := h(uh uh) project convect term fe space, satisfi (mh,vh) = (muh uh,vh) vh vh. (28) (27), term left-hand side, (c uh, vh)h, usual call grad-div stabil term, gener requir ensur stabil problem. nevertheless, stabl mix fe discret used, influenc grad-div stabil accuraci method essential. shown term influenc mass conserv [35], influenc comput cost linear solver [36, 37]. [10], effect term assess taylor-green vortex problem turbul channel flow test convection- stabil mix fe methods. let final note convection-stabil method instead oss, us l2 projector. instead, local project oper h () consid [11, 12]. arbitrari symmetr project stabil convect term, method reads: (tuh,vh) +bweak,t(uh, (uh, ph), (vh, qh)) + ( m h (uh uh), h (uh vh ) )h + (c uh, vh)h = f ,vh vh vh,qh qh, 3. segreg runge-kutta time integr 3.1. matrix form let consid convection-stabil mix fe scheme appli galerkin fe problem (21) (with strong imposit boundari conditions). (it obtain replac bilinear form (20) (8) definit stabil problem (27).) uh, ph h defin nodal valu {ua}a=1,...,nu , {p b}b=1,...,np { c}c=1,...,n , uh(x) = nu a=1 a(x)u a, ph(x) = np b=1 b(x)p b, h(x) = n c=1 (x) c, 7 {a,i}a=1,...,nu;i=1,...,d, {b}b=1,...,np {c,i}c=1,...,n ;i=1,...,d langrangian base as- sociat vh qh. nu, np n total node velocity, pressur project fields. matrix form stabil problem strong dirichlet condit written follows: mu0 0 + k + c + g bd 0 0 bt 0 m = fu0 0 , (29) mab := (a,b), k ab := 2(a,sb), cab := (a,u b), aab := m(u a,u b)+ c( a,b), gab := (a, b), dab := (a,b), bab := m(u a,b), mab := m(a,b), b node identification. note d = gt , boundari condit considered. 3.2. time integr segreg runge-kutta scheme focus time integr problem (29) consid applic srk scheme. srk method propos [25] successfulli test laminar flows. main goal kind time integr segreg veloc pressur computations, give system easier solved, take advantag imex runge-kutta scheme. us rung-kutta scheme allow us high order integr time extra implement efforts. furthermore, kind time integrators, adapt time step techniqu easili (see [38]). let consid matrix problem (29), written compact form term veloc project field follow mu = f(u) + g(u,), (30a) bt u + m = 0. (30b) f g certain oper contain term integr implicitli explicitly, respectively. particular defin srk method linear viscou term integr implicitli nonlinear terms, convect project terms, pressur term integr explicitly. case, oper f g read f(u) :=ku, (31) g(u,) :=fu (c + )u b (32) + g ( dm1g )1 ( dm1 ((k + c + )u + b fu) ) . note choic lead linear problem time step term integr implicitli viscou term. fact highlight project veloc field treat implicitly, make us symmetr project stabil scheme straightforward. choic defin oper f g, e.g., convect project term integr implicitly. later case, result nonlinear coupl veloc project fields. general, choos definit (31)-(32) interest solv turbul flows, time step restrict hyperbol cfl condit smaller restrict time step size requir captur small time scale flow. remark 3.1. term (c uh, vh)h integr explicitli introduc parabol cfl condition, restrict hyperbol one. thus, matrix treat explicitli treat term implicitly, c evalu previou time step. spoil accuracy, stabil term ident zero continu level. proce time integr scheme equat (30a). let consid imex rk method s stages, veloc project stage i, ui i, 1 s comput 8 1 t mui = 1 t mun + j=1 aijf(uj) + i1 j=1 aijg(uj ,j), (33a) bt ui + mi = 0. (33b) aij aij coeffici implicit explicit butcher tableau, respectively. manipulation, rewrit (33) 1 t mui = 1 t mun + j=1 aijf(uj) + i1 j=1 aijg(uj ,pj ,j), (34a) bt ui + mi = 0, (34b) dm1g(pi) = dm1 ((k + c + )ui + bi fu(ti)) . (34c) let g(u,p,) := fu (c+a )ubgp, i.e., oper equival defin (32) pressur variabl introduced. final updat s stage read follow 1 t mun+1 = 1 t mun + s i=1 bif(ui) + big(ui,pi,i), (35a) bt un+1 + mn+1 = 0, (35b) dm1g(pn+1) = dm1 ((k + c + )un+1 + bn+1 fu(tn+1)) . (35c) note equat (34c) (35c) equival solv darci type problem, follow express [ m g d 0 ] [ u pk ] = [ fu(tk) (k + c + )uk bk 0 ] , (36) k n+1, depend equat solving, u auxiliar veloc field, satisfi discret incompress constraint. then, practice, equat (34c) (35c) implement darci problem (36), effici solv block precondit techniqu (see sect. 4). remark 3.2. note srk scheme pressur stabil terms, i.e., typic vm scheme involv residu stabil oss scheme equal-ord velocity-pressur pairs. reason srk scheme design index-2 algebra differenti equat (a incompress navier-stok equations) numer scheme destroi mathemat structur problem. thus, stabl mix fe requir srk schemes. 3.3. weak dirichlet boundari condit srk scheme us weak boundari condit favour deal curv boundaries. case, srk time integr scheme account boundari term describ (10), (19) (20). algebra form (27)-(28), weak dirichlet boundari condit used, read follows: ( m + m ) u 0 0 + k + k + c + c + + m g + g bd + d 0 0 bt 0 m = fu + fu, + fu,fp, 0 , (37) addit term mab := (b,t,n(n n)a,b)d + (b,t,t(i n n)a,b)d , m ab := (b,n(nn)a,b)d+(b,t(inn)a,b)d , kab := 2(a, sb n)2(sa n,b)d , cab := 1 2 (a, (un)b), gab := (a, bin), d ab := (ain,b)d , f u, := b(a,ug)2( san,ug)d , fau, := (b,t,n(n n)a, ug(tk))d + (b,t,t(i n n)a, ug(tk))d , f p, := (ai n,ug)d , 9 b node identification. velocity-pressur block keep skew-symmetri d = gt . note incompress constrain equat case read du = fp,, (38) d := (d+d). (we note matrix time-independent, i.e., td = 0.) deriv (38) time oper row (37), dm1mu + dm1 [ (k + c + + m)u + gp + b ] = dm1fu, (39) m := (m + m), k := (k + k), c := (c + c), g := (g + g) fu := (fu + fu, + fu,). fact dm1mu = fp,, (39) pressur dm1gp = dm1 [ fu (k + c + + m)u b ] fp,, (40) fap, = (ai n, ug), = 1, ..., np. thus, weak dirichlet boundari condit srk time integr schemes, darci type problem equival (36) solv is[ m g d 0 ] [ u pk ] = [ fu(tk) (k + c + + m)uk bk fp,(tk) ] , (41) k correspond stage updat n+ 1. remark 3.3. note auxiliar unknown u (41) approxim u. enforc dirichlet data strongly, condit straightforwardli appli u, m involv free values. however, trace u d enforc sens consid weak imposit (19), potenti lead stabil issu segreg schemes. order solv problem, includ addit weak enforc term (over acceleration) (20) transfer pressur m. remark 3.4. srk scheme perturb discret mass conserv equat time-depend dirichlet boundari condit enforc strongly. hand, discret diverg con- straint exactli fulfil srk scheme weak imposit dirichlet data cases. reason favour combin srk scheme weak dirichlet boundari conditions. [25] details. 3.4. adapt time-step techniqu advantag multi-stag time integr scheme, like srk method, adapt time step techniqu straightforwardly. fact, srk scheme, usag adapt time step techniqu requir extra evalu final veloc update, involv mass matrix solver, [39, 40]. approach defin adapt time step follow pi11 control method describ [38] suggest [40], comput time step size tn+1 = ( rn+1 )1/k ( rn rn+1 )1/k tn tn+1 tn, = 0.8 tol, tol given toler 1 105 0.8 safeti factor. local error rn+1 = u u error step (eps) control rn+1 = (u u)/tn error unit step (epus) controlled. case k = p+ 1 (eps) second (epus) k = p, p order time integr scheme comput estim veloc u. work favour ep definition. moreover, treat explicit version srk scheme, limit time step size guarante cfl condit satisfied. parabol cfl condition, cfl = t (h/p2)2 , hyperbol cfl condition, cflu = ut (h/p2) , exce bound 1.0, time step reject reduc accord safeti factor , tn+1,new = tn+1,old. 10 4. scalabl solver incompress navier-stok equat section briefli discuss construct effici scalabl solver linear system aris space-tim discret navier-stok equat sect. 2-3. look block precondit techniqu differ system involv srk scheme. next, consid bddc precondition extract concurr exploit parallel contexts. note imex version srk scheme considered, result (30) solv sequentially, i.e., solv veloc block explicit project comput project follow stage. focus darcy-typ equat (41), consid lu factor form ap := [ m g d 0 ] = [ 0 dm1 ] [ m g 0 sp ] , (42) sp := dm1g schur complement respect p. case consid block- precondition base inexact lu factor ap, determin upper triangular matrix, p (ap) := [ m g 0 sp ]1 = [ m1 m1gs1p 0 s1p ] . (43) solut (36) precondit gmre method involv comput invers matric m sp. approach follow approxim m1 defin m1 , applic diagon dd preconditioner. invers schur complement s1p ) approxim applic bddc precondition lp. fact choic optim (i.e., oper spectral equivalent) straightforward, fact sp lp equival (see, e.g., [41]) fact bddc precondition optim scalabl (see, e.g., [42]). matrix system aris equat (35a) (35b) solv precondit gmre diagon dd precondition approxim m1 m1 , respectively. bddc method, firstli introduc dohrmann [26], domain decomposit method, reli decomposit fe mesh set subdomains. main properti bddc possibl extend algorithm multilevel approach, base fe-typ structur coars matrix pattern (see, e.g., [43]). property, fully-distributed, communicator- aware, recursive, interlevel-overlap message-pass implement multilevel balanc domain decomposit constraint (mlbddc) precondition develop [28]. works, excel weak scalabl result obtain resolut 3d laplacian elast problem structur unstructur grids, show excel weak scalabl half million core ten billion unknowns. fortunately, imex srk scheme block-precondit techniqu comment above, solver need simul turbul flows. result, bddc method implement mlbddc propos [28] readili used. situat mesh partit lead singular coars problems, especi laplacian-typ problem. problem overcom us perturb bddc addit properli scale mass matrix preconditioner, [44]. approach sect. 5.3, non-structur mesh partit used. remark 4.1. develop weakli scalabl optim precondition monolith incom- pressibl navier-stok scheme complic task. far know, develop provabl scalabl method restrict far mix fe discontinu pressur (see [45]). result, applied, e.g., taylor-hood fe sect. 5. remark 4.2. note problem solv parallel framework spatial domain, time integr treat sequentially. thus, consid space parallelism, exploit time parallelism. talk scalabl method, refer scalabl solver given time step sequenti time integr scheme. construct parallel solvers, space time nonlinear turbul flow open issu scope paper. however, initi 11 research direct bddc solver [46]. issu import practic limitations. e.g., naca simulation, requir heavi time step till reach statist relev outputs, requir huge comput resources. remark 4.3. note scalabl result shown sect. 5.1.3 carri uniform meshes. realist applications, mesh usual unstructur precondit problem challenging, mainli irregular decomposit domain. case, precondition work shown scalabl unstructur mesh [47]. 5. numer test section consid numer simul popular incompress turbul flow benchmarks. suitabl convection-stabil inf-sup stabl fe weak boundari condit srk time integr scheme le model larg scale problem assess tests. first, analyz advantag srk method tgv problem, weak scalabl analysi performed. suitabl weak boundari condit wall-bound flow analyz turbul channel flow test. finally, result shown turbul flow airfoil. shown [10] convection-stabil mix method great potenti le models, especi comput cost taken account. work aim check perform method combin srk time integr scheme weak imposit boundari condit wall law. cases, motiv reduc comput cost simul 1) split origin indefinit problem smaller coerciv system 2) us under-resolv mesh boundari layers. 5.1. taylor-green vortex flow taylor-green vortex (tgv) wide benchmark turbul numer simulations. consist free-evolv flow start analyt solution, domain (0, 2)3, period boundari condit (see, e.g., [48]). initi condit given follow express u(x, y, z, 0) = uxui uz = u0 cos(x) sin(y) sin(z)u0 sin(x) cos(y) sin(z) 0 , (44) p(x, y, z, 0) = p0 + 1 16 (cos(2x) + cos(2y)) (cos(2z) + 2) , u0 = 2 3 sin ( + 2 3 ) . choos = 0, give mean initi veloc u0 = 1. solv tgv problem reynold number = 1600. problem solv t = 0.0 t = 10.0 result compar dn brachet et al [48]. discret domain differ choic number element order approximation, q2/q1 q3/q2 taylor-hood velocity-pressur pairs. consid algorithm paramet (c1 = 12.0, c2 = 4.0, cc = 4.0) [10] tgv test mix fes. 5.1.1. monolith vs segreg runge-kutta first, want compar result obtain monolith approach, second order crank-nicolson time integr scheme, on comput imex version srk method. later case us (3-3) scheme (see [25]). result shown fig. 1 comput differ discretizations, 163 q2/q1 fe 323 q2/q1 fes. energi evolut energi dissip rate depict fig. 1(a) 1(b), respectively. method exhibit similar behavior. differ smaller spatial mesh refined. 12 0.05 0.06 0.07 0.08 0.09 0.1 0.11 0.12 0.13 0 2 4 6 8 10 e n e rg y time energi evolut srk oss_iss 3-3 16 q2/q1 srk oss_iss 3-3 32 q2/q1 monolith oss iss 16 q2/q1 monolith oss iss 32 q2/q1 dn (a) energi evolut 0 0.002 0.004 0.006 0.008 0.01 0.012 0.014 0.016 0 2 4 6 8 10 d s ip ti o n r te time energi dissip rate (total) srk oss_iss 3-3 16 q2/q1 srk oss_iss 3-3 32 q2/q1 monolith oss iss 16 q2/q1 monolith oss iss 32 q2/q1 dn (b) total energi dissip rate figur 1: energi total energi dissip rate evolut 333 veloc dof 5.1.2. hp-refin adapt time-step techniqu clearli refin mesh result comput fig. 1 convection-stabil mix fe converg dns. moreover, shown [10] 323 q3/q2 element mesh fine accur result schemes. main problem explicit imex time integr scheme restrict cfl number. case imex version srk scheme, diffus term treat implicitli restrict satisfi parabol cfl, convect term treat explicitly. then, restrict time step size order satisfi hyperbol cfl condition, i.e., cflu t|u|/(h/p2) < 1 everywhere. restrict import mesh refined, i. e. h reduced, p increased. import reason runge-kutta scheme possibl easili implement adap- tive time step technique, sect. 3.4. import point kind techniqu dynam (and automatically) adapt time step order satisfi physic numer requirements. physic requir time step size given chang solution, numer requir given cfl condition. order check perform srk method adapt time stepping, solv tgv problem differ mesh size interpolations. particular, us 163 323 fe mesh q2/q1 q3/q2 discretizations, depict fig 2. look kinet energi evolut (fig. 0.05 0.06 0.07 0.08 0.09 0.1 0.11 0.12 0.13 0 2 4 6 8 10 e n e rg y time energi evolut 16-q2/q1 (32^3 vel. dofs) 32-q2/q1 (64^3 vel. dofs) 16-q3/q2 (48^3 vel. dofs) 32-q3/q2 (96^3 vel. dofs) dn (a) energi evolut 0 0.002 0.004 0.006 0.008 0.01 0.012 0.014 0.016 0 2 4 6 8 10 d si p ti o n ra te time total energi dissip rate 16-q2/q1 (32^3 vel. dofs) 32-q2/q1 (64^3 vel. dofs) 16-q3/q2 (48^3 vel. dofs) 32-q3/q2 (96^3 vel. dofs) dn (b) total energi dissip rate figur 2: energi total energi dissip rate evolut refin mesh 2(a)) total energi dissip rate (fig. 2(b)), clearli mesh refin solut tend dn result. import highlight improv 13 result higher order spatial approxim used. q3/q2 mix fe better result q2/q1, dofs. behaviour observ compar 163 q3/q2 element mesh, 483 veloc dofs, 323 q2/q1 element discretization, 643 veloc dofs. seen mesh result better agreement dn solution. state above, mesh refin direct implic time step size explicit imex scheme used. determin influenc refin adapt time step technique, time step evolut case consid subsection, fig. 3. initi time step t0 = 5 102 cases. seen coarser mesh (163 q2/q1 elements) allow higher time step, constantli increas differ time step solut high. occur t = 4.0, moment time step size adapted, remain 0.1 0.12. 163 q3/q2 323 q2/q1 similar behavior, stage time step increas cfl restrict violated, point time step reduced, show sawtooth pattern begin simulation. pattern repeat solut time step differ requir smaller time step accur solution. concern finest mesh, 323 q3/q2, cfl restrict prevail physic phenomena restriction. consequently, time step sawtooth pattern observ simulation. 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 1 2 3 4 5 6 7 8 9 10 t im e s te p s iz e time time step evolut 16-q2/q1 (32^3 vel. dofs) 32-q2/q1 (64^3 vel. dofs) 16-q3/q2 (48^3 vel. dofs) 32-q3/q2 (96^3 vel. dofs) figur 3: time step size evolut refin mesh 5.1.3. scalabl analysi simul perform fempar (finit element multiphys mas- sive parallel) numer software. fempar open source, parallel hybrid openmp/mpi, object- orient (oo) framework which, features, provid basic tool effici parallel distributed-memori implement substructur domain decomposit solver [49, 27, 28]. parallel framework, import issu scalabl algorithm larg scale problem solved. mean that, refin mesh, need have scalabl solver increas elaps cpu time number processor increased. check suitabl imex srk algorithm larg scale problem perform weak scalabl test solv tgv problem. let denot h characterist length subdomain partit l domain. consid structur mesh partit cube [0, l]3. weak scalabl test local problem constant, i.e., h/h fixed. order preserv local reynold number (i.e., rel import terms), h h constant increas l; note impli increas number fe subdomain (processors). hence, refer problem comput domain size l0 = 2, scalabitilti analysi domain size l = l0, = {1, 2, 3, 4, 5}. subdomain size h = l0/4. let note propos local reynold number constant weak scalabl analysi challeng typic weak 14 scalabl analys reduc h h keep l constant. analysis, processor use, challeng physic problem solv (with reynold number increas linearli l), second viscou term increasingli dominant, tend fulli resolv dn simulations. comput time step taylor-green problem time step size t = 5 102 imex version (1-2) scheme q2/q1 mix fes. report number solver iter cpu time consum resolution. differ local mesh size consid effect local mesh size scalabl solver. particular, consid cases: h/h = {4, 8, 12}. total processor solv problem (l/h)3 = (4)3. smallest mesh solv problem analysi 163 q2/q1 fe mesh, biggest 2403 q2/q1 fe mesh, lead 680 million dofs. solut comput hlrn-iii crai hannov (germany). particular, us crai xc40 mpp2 equip intel xeon haswel 12-cpu core node. follow result comput two-level bddc solver, consid corners, edg face subdomain partit coars (see [49, 27, 28] details). recal step srk (1-2) scheme consist resolut specifi algorithm 1. note solver need step, p1 = pn. algorithm 1: srk resolut time step (1-2) scheme 1. solv initi pressur (equat (34c)). 2. solv second-stag momentum (equat (34a)-(34b)). 3. solv second-stag pressur (equat (34c)). 4. solv veloc updat (equat (35a)). 5. solv project updat (equat (35b)). 6. solv pressur updat (equat (35c)). fig. 4 depict solver iter elaps cpu time constant local reynold number weak scalabl analysi differ local mesh sizes. solver iter plot (fig. 4(a), fig. 4(c), fig. 4(e)) cpu time plot (fig. 4(b), fig. 4(d), fig. 4(f)) shown linear systems; pressur system cpu time ad second set plots. build time includ time consum integr matric vector time consum comput preconditioners. look solver iterations, number iter linear solv kept constant number processor increased, independ local mesh size. notic local mesh size increase, number iter decreas littl systems. further, observ solver iter column fig. 4 that, expected, veloc updat project updat number solver iterations. caus fact system solv mass matrix, differ veloc updat mass matrix scale 1 t . observ well-known fact that, term solver iterations, hardest pressur solver (equat (34c) (35c)). refer consum cpu time, conclus look fig. 4(b), fig. 4(d), fig. 4(f), expens resolut momentum (equat (34a)- (34b)). number solver iter smaller pressur computations, term time consumed, momentum equat resolut expensive, count pressur solvers. differ comput time requir momentum equat versu pressur ones, number dof solved. account veloc project field comput second order polynomial, q2, pressur order, q1. then, vectori field versu scalar field, second order interpol versu order one. leav asid mass matrix blocks, size equat solv veloc block momentum comput 24 time larger aris pressur block darci computations, take account pressur solv (41). 15 12 14 16 18 20 22 24 26 28 64 512 1728 4096 8000 # te ra ti o n s # processor solver iter momentum veloc updat project updat pressur initi pressur stage pressur updat (a) iterations, h/h = 4 0 1 2 3 4 5 6 7 8 9 10 64 512 1728 4096 8000 c p u t im e ( s) # processor elaps cpu time build solv momentum solv pressur solv momentum updat solv project updat (b) cpu time, h/h = 4 10 12 14 16 18 20 22 24 26 28 64 512 1728 4096 8000 # te ra ti o n s # processor solver iter momentum veloc updat project updat pressur initi pressur stage pressur updat (c) iterations, h/h = 8 0 2 4 6 8 10 12 14 64 512 1728 4096 8000 c p u t im e ( s) # processor elaps cpu time build solv momentum solv pressur solv momentum updat solv project updat (d) cpu time, h/h = 8 8 10 12 14 16 18 20 22 24 26 64 512 1728 4096 8000 # te ra ti o n s # processor solver iter momentum veloc updat project updat pressur initi pressur stage pressur updat (e) iterations, h/h = 12 0 5 10 15 20 25 64 512 1728 4096 8000 c p u t im e ( s) # processor elaps cpu time build solv momentum solv pressur solv momentum updat solv project updat (f) cpu time, h/h = 12 figur 4: weak scalabl test. number iter elaps cpu time solv time step tgv problem differ local mesh sizes. keep discuss cpu time shown fig. 4, comput momentum pressur system scale term time. perform easi explanation, given ratio fine coars bssc sizes. coars size depend number processor (subdomains) bddc method. order magnitud smaller fulli parallel component, consid serial solver coars component. further, coars problem size increas number processors. thus, point, non-scal coars solver dominant. corners, edg face subdomain considered, total degre freedom coars equival local mesh q2 element (without interior node) element subdomains. consequently, h/h = 4 local mesh, expect weak scalabl 64 (43) processors, h/h = 8 512 (83) processors, h/h = 12 1728 (123) 16 processors. fact see fig. 4, where, take account local mesh interior dof insid element, result expect scalabl performance. order better results, reduc size coars consid corner edg subdomain. fig. 5 depict result obtain case, h/h = 12 local mesh size. seen subdomain face ignored, number solver iter increase, fig. 5(a). despit that, trade-off have solver iter smaller equations, ignor subdomain face coars worth. fig. 5(b), momentum scalabl 8.000 processor local problem expens coars one. scale time pressur solver local problem smaller coars us q1 element pressur field. case, 5 10 15 20 25 30 64 512 1728 4096 8000 # te ra ti o n s # processor solver iter momentum veloc updat project updat pressur initi pressur stage pressur updat (a) iter 0 5 10 15 20 25 64 512 1728 4096 8000 c p u t im e ( s) # processor elaps cpu time build solv momentum solv pressur solv momentum updat solv project updat (b) cpu time figur 5: weak scalabl test. number iter elaps cpu time solv time step tgv problem h/h = 12 corner edg coars level. coars problem recurs approxim bddc preconditioner, lead multilevel bddc method. shown multilevel bddc implement fempar abl scale 2 million subdomain half million mpi task level laplacian problem level elast problem [28]. consid multilevel extens here, consid extrem scales. 5.2. turbul channel flow = 395 previou section test suitabl propos vm method imex srk time integr scheme le simul homogen turbulence. that, aim perform method wall-bound turbul flows. order check behaviour propos approach, solv turbul channel flow (tcf) test reynold number base wall veloc = 395. main purpos test assess accuraci solut weak boundari condit formul given bilinear form describ (19). tcf problem solv box domain [0, 2] [0, 2] [0, 2/3], x-direct flow direction, call stream-wis direction, y-direct wall-norm direction, z-direct span-wis direction. homogen dirichlet boundari condit veloc dof weakli impos wall-norm direct boundari (y = y = ), period boundari condit defin stream-wis span-wis directions. fig. 6 depict schemat geometri comput domain test. select problem paramet accord dn comput perform moser et al [50, 51] (mkm-dns), compar result cite work. bulk mean veloc half channel height taken equal one, u = 1 = 1. estim reynold number base bulk mean veloc known, = u2/ 13, 750 (see [31]). therefore, obtain valu viscosity, = 1.4545 104 determin friction veloc magnitud reynold number base friction veloc u = re/ = 5.745 102. thus, wall shear stress read w = u2 = 3.3010 103. forc 17 figur 6: channel comput domain. equival pressur gradient impos drive movement flow stream-wis direction, fx = w/. initi solut propos [52] reach statist steadi state faster, consist unidirect veloc profil fluctuation: ux = c ( 1 y8 ) + lx 2 sin(y) co ( 4x lx ) sin ( 2z lz ) , (45) uy = (1 + cos(y)) sin(y) sin ( 4x lx ) sin ( 2z lz ) , uz = lz 2 sin ( 4x lx ) sin(y) co ( 2z lz ) . constant c chosen wai field fluctuat bulk mean veloc u = 1.0. fluctuat constant 10% bulk mean velocity. solv problem us differ meshes, compos 163 q2/q1 q3/q2 fes. consid stretch mesh wall-unresolv uniform mesh wall-norm direction. construct stretch mesh follow hyperbol function defin [13] stretch paramet = 2.75. accord [10], algorithm constant appear (24) (26) chosen c1 = 12.0, c2 = 8.0 cc = 32.0. constant appear weak boundari condit formul set cb = 32.0. moreover, analyz effect constant cc uniform mesh considered, plai import role mix fe methods. 5.2.1. effect cc uniform mesh effect constant cc appear equat (26) studi [10] case strong imposit boundari condit us stretch mesh captur boundari layer. section aim check perform method chang cc algorithm paramet uniform mesh weak dirichlet boundari conditions. case, order avoid influenc weak imposit wall normal component, enforc strongli wall-norm velocity, e.g. u n = 0 d. fig. 7 energi evolut solut differ valu cc t = 0.0 t = 100.0, comput 163 q2/q1 mesh. shown uniform meshes, high valu cc make solut energi conserving, energi dissip properly. valu cc = 1.0 case reach statist stabl state, t 280.0, lowest global energy. note case cc = 0.0 result overdissip method, show import ad grad-div term, notic [10]. then, follow section us cc = 1.0. 5.2.2. influenc wall-norm compon signific differ approach follow respect propos [15] treatment normal component. [15] no-penetr condit considered, mean normal compon veloc impos strongly, u n = 0 d. propos 18 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0 20 40 60 80 100 e n e rg y time energi evolut 0.0 1.0 2.0 4.0 8.0 16.0 32.0 figur 7: energi evolut tcf test differ valu cc. weak boundari imposit wall-norm direction, reason comment above. state sect. 2.2, defin differ penalti parameters. tangenti component, base wall law, wall-norm component, proport origin penalti paramet propos [14], b,n := cbp 2 hb . obvious, solut wall closer obtain impos strongli normal component, penalti term disturb solution. order determin best valu , solv tcf test t = 0.0 t = 100.0, differ valu = {1.0, 10, 100, 1000} 163 q2/q1 fe uniform mesh. problem solv imex srk scheme adapt time step technique. fig. 8 energi evolut differ valu . clearli choic larg implic result low valu used. (it well-known stabil nitsch boundari condit prove larg valu (see [34]). low valu , case = 1.0, solut start dissip energi earli stage simulation. increas , result tend on obtain consid strong imposit normal component, denot strong. = 10.0 follow simulations. 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0 20 40 60 80 100 e n e rg y time energi evolut 1e0 1e1 1e2 1e3 strong figur 8: energi evolut tcf test differ valu . 5.2.3. comparison strong week imposit dirichlet boundari condit analyz effect paramet dirichlet boundari condit impos weakli wall-norm component, let check perform approach follow work compar strong dirichlet boundari condit definition. compar result 19 present [10], tcf test solv strong dirichlet boundari condit stretch mesh. tabl 1 state distanc wall nearest veloc dof stretch uniform mesh, differ discretizations. tabl 1: distanc wall nearest veloc dof wall units. mesh type discret y+ stretch 163 q2/q1 1.6 163 q3/q2 1.0 uniform 163 q2/q1 24.7 163 q3/q2 16.5 element size given tabl 1 direct implic choic time integr scheme used. want us imex version srk scheme ensur hyperbol cfl condit satisfied. consequently, stretch mesh stronger restrict uniform mesh, given discretization. thus, fact need resolut boundari layer affect spatial mesh dns-like time step size. particular test, uniform mesh 163 q2/q1 elements, critic time step size tcrit = 0.025, stretch mesh discret tcrit = 0.007. follow [53], good time step choic particular tcf implicit time integr scheme t = 0.03. take account imex version srk scheme time faster time step implicit one, consid imex srk uniform mesh implicit srk scheme (with t = 0 03) stretch mesh. tcf test solv t = 0.0 reach statist stabl state, store statist 30.0 seconds, accumul 1000 samples. result 163 q2/q1 element mesh shown fig. 9, mean stream-wis veloc plot (fig. 9(a)) veloc fluctuat stream-wise, wall-norm span-wis direct (figs. 9(b), 9(c) 9(d), respectively). stretch mesh used, weak boundari condit imposit recov result strong case. similar result observ veloc fluctuations. expected, heavili under-resolv mesh boundari layer (see tabl 1), mean stream-wis veloc profil given uniform mesh weak boundari condit littl bit far dn result result obtain strong boundari condit stretch mesh (see fig. 9(a)). analogously, look fig. 9(b), stream-wis veloc fluctuat depicted, nearest wall point far dn curv weak uniform case. however, far boundari layer, result close dn coarser space-tim mesh. behaviour observ wall-norm span-wis veloc fluctuations, figur 9(c) 9(d). improv solut observ higher order discret space. behaviour shown fig. 10 uniform mesh weak boundari condit imposit compar stretch mesh strong boundari conditions, 163 q2/q1 163 q3/q2 element mesh. look mean stream-wis veloc profil shown fig. 10(a), solut converg dn result refin mesh. perform observ veloc fluctuations. instance, look stream-wis veloc fluctuat shown fig. 10(b) seen nearest wall node far dn q3/q2 discretization, remain point close dn curve. refer wall-norm span-wis veloc fluctuat depict figur 10(c) 10(d), respectively, better result obtained, special point near wall. import highlight 1) similar result obtain strong weak imposit dirichlet boundari condit stretch meshes, 2) weak imposit allow under-resolv mesh good agreement dn far wall. 5.3. flow airfoil low reynold number aim section appli numer scheme work simul turbul incompress flow airfoil, particularli naca 0012 airfoil [54]. naca 20 0 5 10 15 20 25 1 10 100 u + y+ mean stream-wis veloc stretch - weak uniform - weak stretch - strong mkm-dn (a) mean stream-wis veloc 0 1 2 3 4 5 6 0 50 100 150 200 250 300 350 u ' y+ stream-wis veloc fluctuat stretch - weak uniform - weak stretch - strong mkm-dn (b) rm stream-wis veloc fluctuat 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 50 100 150 200 250 300 350 v ' y^+ wall-norm veloc fluctuat stretch - weak uniform - weak stretch - strong mkm-dn (c) rm wall-norm veloc fluctuat 0 0.2 0.4 0.6 0.8 1 1.2 1.4 0 50 100 150 200 250 300 350 w ' y^+ span-wis veloc fluctuat stretch - weak uniform - weak stretch - strong mkm-dn (d) rm span-wis veloc fluctuat figur 9: mean stream-wis veloc rm veloc fluctuat differ mesh types. airfoil wide benchmark real life problem, airplan wind turbin wing base profiles. numer simul experi wind tunnel configur type airfoil. naca 0012 configur (see, e.g., [55, 56, 57], like naca 4412 wide studi (see, e.g., [58, 59]). type airfoil benchmark literatur aerospatiale-a airfoil, exampl lesfoil project [60]. type problem mesh design plai import role. particular, proper space boundari layer. strong definit dirichlet boundari condit considered, simul wall-resolv le (wrles). accord [61], coher structur appear turbul boundari layer captur wrle method near-wal node mesh locat wall distanc y+ < 2 stream-wis cell size rang 50 < x+ < 150. otherwise, wall law model consid weak imposit dirichlet boundari conditions, simul wall-model le (wmles). concern check feasibl propos method wmle method simul turbul flow aircraft. simul flow characterist stressed, deal simpli turbul flows, difficulties, like presenc laminar boundari layers, transit laminar turbul regimes, wall-bound flow flow separ curv surfaces. fact le method shown us flow turbul structur domin large-scal structures, like tgv test present sect. 5.1 homogen turbul problem (see [13]). despit that, simul near-wal flow le method demonstr challeng task, manli complex physic phenomena, like reduct larg scale structur near wall, flow anisotropy, mesh sensit high aspect ratios. work discuss suitabl le method simul flow airfoil. case european project lesfoil [60], differ academ 21 0 5 10 15 20 25 1 10 100 u + y+ mean stream-wis veloc q2/q1- uniform weak q3/q2- uniform weak q2/q1 - stretch strong q3/q2 - stretch strong mkm-dn (a) mean stream-wis veloc 0 1 2 3 4 5 6 0 50 100 150 200 250 300 350 u ' y+ stream-wis veloc fluctuat q2/q1- uniform weak q3/q2- uniform weak q2/q1 - stretch strong q3/q2 - stretch strong mkm-dn (b) rm stream-wis veloc fluctuat 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 50 100 150 200 250 300 350 v ' y^+ wall-norm veloc fluctuat q2/q1- uniform weak q3/q2- uniform weak q2/q1 - stretch strong q3/q2 - stretch strong mkm-dn (c) rm wall-norm veloc fluctuat 0 0.2 0.4 0.6 0.8 1 1.2 1.4 0 50 100 150 200 250 300 350 w ' y^+ span-wis veloc fluctuat q2/q1- uniform weak q3/q2- uniform weak q2/q1 - stretch strong q3/q2 - stretch strong mkm-dn (d) rm span-wis veloc fluctuat figur 10: mean stream-wis veloc rm veloc fluctuat refin mesh. industri group work aim identifi potenti le predict method separ high-reynolds-numb airfoil flows. case, simul geometri aerospatiale-a airfoil oper chord reynold number equal 2.1 106 angl attack equal 13.3o mach number 0.15. author work naca type airfoils. case [62, 63, 64], us le method simul flow naca4412 airfoil studi unstructured, structur semi-structur grids, respectively. paper, current test intent serv proof concept propos method realist applications. work literatur deal challeng configurations, i.e. high reynold number high angl attack (see [62, 63, 64, 65]), restrict modest scenario. consid low reynold number moder angl attack. main reason consid case possibl compar result obtain weak treatment dirichlet boundari condit obtain strong imposit dirichlet boundaries, need spend comput resources. furthermore, keep proof concep aim mind, interest long term computations, requir obtain averag values. thus, compar instantan quantiti obtain turbul fulli developed. 5.3.1. test set consid us convection-stabil mix fe formul describ sect. 2.3. us weak imposit dirichlet boundari condit tangenti normal veloc components, detail sect. 2.2. srk scheme integr equat time, describ sect. 3. test studi flow naca 0012 airfoil span-wis length 0.16c, c chord length. 11(a) depict geometri studi airfoil. comput domain defin inlet outlet boundari 10 chord length awai airfoil surface. inlet boundari free-stream veloc u = 10 settled, 22 x y z gid (a) naca 0012 airfoil geometry. x y z gid (b) naca 0012 coars mesh. figur 11: naca 0012 airfoil geometri coars mesh. outlet boundari left free. consid angl attack = 6 deg reynold number base chord length rec = 2.3 104, [66, 67]. simul test structur c-type mesh airfoil profile. consid differ 2-dimension mesh quadrilaterals, differ refin near wall, extrud span-wis direction. goal differ mesh assess perform weak imposit dirichlet boundari condit airfoil surfac refin mesh. defin mesh wai fine element airfoil surface, turbul boundari layer, wake region, coars element far field region. 11(b) depict view coarsest mesh. focus finest mesh, lead edge, near wall-nod locat y 2.0 104c, lead wall distanc y+ < 1. distanc kept constant laminar region increas constantli reach maximum y 2.0 103 trail edge, wall distanc restrictive. maximum stream-wis element length x 0.028c locat suction airfoil, give normal distanc x+ 40. mesh size satisfi condit need captur boundari layer phenomena. coarsest mesh, near wall-nod locat y 1.2 103c lead wall distanc order y+ 2. distanc constantli increas reach valu y 6.4 103c trail edge, grater finest mesh. mesh, maximum stream-wis element length x 0.032c equival normal distanc x+ 50. comput 3d test coarsest mesh, constant span-wis element length equal z 0.02c. spatial discret q2/q1 mix fes. us algorithm pa- rameters, c1 = 12.0, c2 = 8.0 cc = 32.0, accord [10]. problem solv imex version srk method introduc previou test (3-3) scheme adapt time step technique, expos sect. 3.4. adapt time step size automat evolves, tend t = 5.0 104c/u, give maximum hyperbol cfl 0.3. 5.3.2. simul result discuss order check suitabl propos method start 2-dimension simul compar result obtain finest coarsest meshes. computations, begin initi solut comput solv stoke problem. solv problem t = 0.0 t = 1.0 equival 10 time unit (1 time unit = c/u). effect 2d mesh weak boundari conditions. analyz effect constant cc solution, proce check effect constant appear definit weak imposit wall-norm compon dirichlet boundary. case select differ values, = 10, 100 solv problem coars mesh t = 0.0 t = 1.0. case = 1000 discard comput cost greater two. analysis, seen 12, littl differ observ laminar transit turbul flow differ valu . furthermore, compar solut obtain strong imposit boundari condit fine mesh, result similar laminar transition. thing chang flow start evolv turbul behaviour, t = 0.5, differ differ paramet select begin increase. solut strong boundari condit coars mesh explod turbul 23 start developing; expected, energi dissip produc airfoil law. case consid weak boundari imposit stable, drag coeffici similar obtain strong boundari condit finer mesh, 12(a). however, look 12(b), = 10 lift coeffici start increas refer solution, = 100 coeffici remain order fine mesh (with strong boundari conditions). given results, follow comput us = 100. 0 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0 0.2 0.4 0.6 0.8 1 c _d time drag coeffici evolut beta = 10.0 beta = 100.0 strong - coars strong - fine (a) drag coefficient. -0.002 0 0.002 0.004 0.006 0.008 0.01 0.012 0.014 0.016 0.018 0 0.2 0.4 0.6 0.8 1 c _l time lift coeffici evolut beta = 10.0 beta = 100.0 strong - coars strong - fine (b) lift coefficient. figur 12: drag lift coeffici 2d comput differ values. instantan flow field 3d case. analyz effect weak dirichlet boundari condit two-dimension mesh, check perform 3d case. us initi solut extrud solut 2d case t = 1.0. then, let flow evolv reach 3d description, occur time unit. section analyz instantan flow fields, try identifi turbul structur gener wing. 13 veloc isosurfac u = 25.0 color pressur value. figur clearli flow transit laminar regim lead edg turbul flow, start 3d flow develop near maximum wing thick point. studi structur aris turbul flow, us q-criterion defin q = 1 2 (||2 |(u)|2), vortic strain rate tensor. isosurfac q = 5 105 depict 14, gener 2d coher vortic break near maximum thick point, turn hairpin vortices. similar result obtain [66], finer mesh solv problem. 15 present view q = 5 105 isosurface. there, 24 11.599 23.198 34.797 1.173e-02 4.641e+01 |velocity| figur 13: veloc isosurfac u = 25.0. 11.369 22.738 34.107 1.136e-02 4.549e+01 |velocity| figur 14: q-criterion isosurfac q = 5 105 color veloc magnitude. posit 2d coher vortex, locat x/c = 0.37. result similar obtain [66], 2d vortex locat x/c = 0.41 finer mesh. 0.370 figur 15: view q-criterion isosurfac q = 5 105. 25 6. conclus work, consid convection-stabil mix fe combin weak imposit boundari condit includ wall law model. convection-stabil fe method prove accur le scheme [10]. motiv explor combin weak boundari condit under-resolv le mesh boundari layers, order maintain low comput cost compar fulli resolv dn simulations. hand, srk time integr scheme time integration. srk method recent propos [25]. work, analyz time behavior turbul flow simulations. scheme computation appeal segreg veloc pressur comput time integr level, keep arbitrari high equal-ord accuraci unknowns. finally, block-precondit bddc precondition end highli scalabl solvers. output combin highli scalabl accur high-perform framework le simul incompress flows. note combin build block rational it. srk scheme appli index-2 systems, typic pressure-stabil fe solver destroi property. thus, mix fe method required, convect stabil requir produc stabl scheme high reynold number model effect subgrid scales. hand, us imex srk (with explicit convection) scheme block-precondition solver pressur solver need reduc linear system solv coerciv problems. possibl scalabl precondition problems, e.g., multilevel domain decomposit solvers, scalabl solver indefinit monolith problem particular situat [45]. applic srk method simul turbul incompress flow test tgv benchmark, show practic result achiev consid srk time integr versu monolith scheme. converg propos le scheme dn solut demonstr refin h p considered, give accur result p-refin (a expect smooth solutions). advantag srk scheme easi implement time adapt techniqu allow automat time step adapt numer physic requirements. issu address tgv test, seen method abl adapt numer restrict given cfl condit physic requir given chang solution. combin srk schemes, block-preconditioning, bddc precondition lead excel weak scalabl results, test tgv benchmark 8000 core uniform meshes. furthermore, three-level mlbddc algorithm achiev weak scalabl higher number processors, follow idea [28]. check perform propos scheme wall-bound tcf test. case, includ us weak dirichlet boundari condit wall law base tangenti traction weak imposit wall-norm component. approach lead accept results, wall-unresolv uniform mesh considered. further, stretch meshes, us strong weak dirichlet boundari condit lead similar results. seen weak imposit dirichlet boundari condit suitabl srk method considered. first, continu equat pollut strong imposit tempor deriv veloc diverg boundary. occur time-depend boundari condit impos dirichlet boundary. furthermore, weak imposit veloc wall-norm compon consid work, avoid complex impos strongli compon curv boundaries. acknowledg work partial fund european research council fp7 programm idea start grant no. 258443 - comfus: comput method fusion technol- ogy. o. colom gratefulli acknowledg support receiv catalan govern fi fellowship. 26 refer [1] p. sagaut, larg eddi simul incompress flows, vol. 3, springer berlin, 2000. [2] j. p. boris, f. f. grinstein, e. s. oran, r. l. kolbe, new insight larg eddi simulation, fluid dynam research 10 (4-6) (1992) 199. [3] t. j. hughes, multiscal phenomena: green functions, dirichlet-to-neumann formulation, subgrid scale models, bubbl origin stabil methods, method appli mechan engin 127 (1-4) (1995) 387401. [4] t. j. hughes, g. r. feijoo, l. mazzei, j.-b. quincy, variat multiscal method - paradigm comput mechanics, method appli mechan engin 166 (12) (1998) 324. [5] t. j. r. hughes, l. mazzei, a. a. oberai, a. a. wray, multiscal formul larg eddi simulation: decai homogen isotrop turbulence, physic fluid 13 (2) (2001) 505512. [6] t. j. r. hughes, a. a. oberai, l. mazzei, larg eddi simul turbul channel flow variat multiscal method, physic fluid 13 (6) (2001) 17841799. [7] r. codina, stabil finit element approxim transient incompress flow orthogo- nal subscales, method appli mechan engin 191 (3940) (2002) 4295 4321. [8] r. codina, stabil incompress convect orthogon sub-scal finit element methods, method appli mechan engin 190 (1314) (2000) 15791599. [9] r. codina, analysi stabil finit element approxim oseen equat orthogon subscales, appli numer mathemat 58 (3) (2008) 264283. [10] o. colomes, s. badia, j. principe, mix finit element method convect stabil larg eddi simul incompress turbul flows, method appli mechan engin 304 (2016) 294 318. [11] s. badia, stabil finit element method base scottzhang projector. circumvent- ing infsup condit stoke problem, method appli mechan engin 247248 (0) (2012) 6572. [12] m. braack, e. burman, local project stabil oseen problem interpret variat multiscal method, siam journal numer analysi 43 (6) (2006) 25442566. [13] o. colomes, s. badia, r. codina, j. principe, assess variat multiscal model larg eddi simul turbul incompress flows, method appli mechan engin 285 (2015) 3263. [14] y. bazilevs, t. j. r. hughes, weak imposit dirichlet boundari condit fluid mechanics, comput & fluid 36 (1) (2007) 1226. [15] y. bazilevs, c. michler, v. m. calo, t. j. r. hughes, weak dirichlet boundari condit wall- bound turbul flows, method appli mechan engin 196 (4952) (2007) 48534862. [16] v. john, slip friction penetr resist boundari condit navierstok equationsnumer test aspect implementation, journal com- putat appli mathemat 147 (2) (2002) 287300. [17] l. davidson, lesfoil: european project larg eddi simul high-lift airfoil high reynold number, in: chalmer public librari (cpl), 2000. 27 [18] y. bazilevs, c. michler, v. calo, t. hughes, isogeometr variat multiscal model wall- bound turbul flow weakli enforc boundari condit unstretch meshes, com- puter method appli mechan engin 199 (13) (2010) 780790. [19] m.-c. hsu, i. akkerman, y. bazilevs, wind turbin aerodynam alevms: valid role weakli enforc boundari conditions, comput mechan 50 (4) (2012) 499511. [20] h. choi, p. moin, effect comput time step numer solut turbul flow, journal comput physic 113 (1) (1994) 14. [21] h. le, p. moin, improv fraction step method incompress navier-stok equations, journal comput physic 92 (2) (1991) 369379. [22] d. forti, l. dede, semi-implicit bdf time discret navierstok equat vms-le model high perform comput framework, comput & fluid 117 (2015) 168182. [23] s. badia, r. codina, algebra pressur segreg method incompress navier-stok equations, archiv comput method engin 15 (3) (2008) 343369. [24] s. badia, a. f. martn, r. planas, block recurs lu precondition thermal coupl incompress inductionless mhd problem, journal comput physic 274 (2014) 562591. [25] o. colomes, s. badia, segreg rungekutta method incompress navierstok equations, intern journal numer method engin 105 (5) (2016) 372400. [26] c. r. dohrmann, precondition substructur base constrain energi minimization, siam journal scientif comput 25 (1) (2003) 246258. [27] s. badia, a. f. martn, j. principe, highli scalabl parallel implement balanc domain decomposit constraints, siam journal scientif comput 36 (2) (2014) 190218. [28] s. badia, a. f. martn, j. principe, multilevel balanc domain decomposit extrem scales, siam journal scientif comput 38 (1) (2016) 2252. [29] p. r. spalart, strategi turbul model simulations, intern journal heat fluid flow 21 (3) (2000) 252263. [30] p. spalart, w. jou, m. strelets, s. allmaras, comment feasibl le wings, hybrid rans/l approach, advanc dns/le 1 (1997) 48. [31] s. b. pope, turbul flows, cambridg univers press, 2000. [32] j. nitsche, uber ein variationsprinzip zur losung von dirichlet-problemen bei verwendung von teilraumen, die keinen randbedingungen unterworfen sind, abhandlungen au dem mathematis- chen seminar der universitat hamburg 36 (1) (1971) 915. [33] r. stenberg, techniqu approxim boundari condit finit element method, journal comput appli mathemat 63 (13) (1995) 139148. [34] d. arnold, interior penalti finit element method discontinu elements, siam journal numer analysi 19 (4) (1982) 742760. [35] a. linke, collis cross-shap domain - steadi 2d navier-stok exampl demonstrat- ing import mass conserv cfd, method appli mechan engin 198 (41-44) (2009) 32783286. [36] m. olshanskii, a. reusken, grad-div stablil stoke equations, mathemat compu- tation 73 (248) (2004) 16991718. 28 [37] t. heister, g. rapin, effici augment lagrangian-typ precondit oseen problem grad-div stabilization, intern journal numer method fluid 71 (1) (2013) 118134. [38] g. soderlind, automat control adapt time-stepping, numer algorithm 31 (1-4) (2002) 281310. [39] k. gustafsson, control theoret techniqu stepsiz select explicit runge-kutta methods, acm trans. math. softw. 17 (4) (1991) 533554. [40] k. gustafsson, control-theoret techniqu stepsiz select implicit runge-kutta meth- ods, acm trans. math. softw. 20 (4) (1994) 496517. [41] h. c. elman, d. j. silvester, a. j. wathen, finit element fast iter solvers: appli- cation incompress fluid dynamics, oxford univers press, 2005. [42] s. c. brenner, r. scott, mathemat theori finit element methods, softcov reprint hardcov 3rd ed. 2008 edition, springer, 2010. [43] j. mandel, b. sousedk, c. dohrmann, multispac multilevel bddc, comput 83 (2) (2008) 5585. [44] s. badia, h. nguyen, balanc domain decomposit perturbation, submitted. [45] j. li, o. widlund, bddc algorithm incompress stoke equations, siam journal numer analysi 44 (6) (2006) 24322455. [46] s. badia, m. olm, space-tim balanc domain decomposition, submitted. [47] s. badia, a. f. martn, j. principe, scalabl inexact balanc domain decomposit constraint overlap coarse/fin corrections, parallel comput 50 (2015) 124. [48] m. brachet, direct simul three-dimension turbul taylor-green vortex, fluid dynam research 8 (14) (1991) 18. [49] s. badia, a. f. martn, j. principe, implement scalabl analysi balanc domain decomposit methods, archiv comput method engin 20 (3) (2013) 239262. [50] r. d. moser, j. kim, n. n. mansour, direct numer simul turbul channel flow re=590, physic fluid 11 (4) (1999) 943945. [51] j. kim, p. moin, r. moser, turbul statist fulli develop channel flow low reynold number, journal fluid mechan 177 (1987) 133166. [52] p. moin, j. kim, numer solut time-depend viscou incompress fluid flow involv solid boundaries, journal comput physic 35 (3) (1980) 381392. [53] v. gravemeier, m. w. gee, m. kronbichler, w. a. wall, algebra variat multiscale- multigrid method larg eddi simul turbul flow, method appli me- chanic engin 199 (1316) (2010) 853864. [54] e. n. jacobs, k. e. ward, r. m. pinkerton, characterist 78 relat airfoil section test variable-dens wind tunnel, naca-report-460. [55] r. e. sheldahl, p. c. klimas, aerodynam characterist seven symmetr airfoil section 180-degre angl attack us aerodynam analysi vertic axi wind turbines, tech. rep. sand-80-2114, sandia nation labs., albuquerque, nm (usa) (1981). [56] w. mccroskey, critic assess wind tunnel result naca 0012 airfoil, tech. rep., dtic document (1987). 29 [57] j. a. rivera, b. e. dansberry, r. m. bennett, m. h. durham, w. a. silva, naca0012 benchmark model experiment flutter result unsteadi pressur distributions, nation aeronaut space administration, langlei research center, 1992. [58] a. j. wadcock, investig low-spe turbul separ flow airfoils, tech. rep. (1987). [59] r. c. hastings, b. r. williams, studi flow field near naca 4412 aerofoil nearli maximum lift., tech. rep. (1984). [60] l. davidson, d. cokljat, j. frohlich, m. a. leschziner, c. mellen, w. rodi, lesfoil: larg eddi simul flow high lift airfoil: result project lesfoil support european union 1998 2001, springer scienc & busi media, 2012. [61] u. piomelli, j. r. chasnov, large-eddi simulations: theori applications, in: m. hallback, d. s. henningson, a. v. johansson, p. h. alfredsson (eds.), turbul transit modelling, no. 2 ercoftac series, springer netherlands, 1996, pp. 269336. [62] k. e. jansen, stabil finit element method comput turbulence, method appli mechan engin 174 (34) (1999) 299317. [63] h.-j. kaltenbach, h. choi, large-eddi simul flow airfoil structur mesh, tech. rep. (1995). [64] s. schmidt, m. franke, f. thiele, assess sg model le appli naca 4412 airfoil, in: 39th aerospac scienc meet exhibit, american institut aeronaut astronautics. [65] c. p. mellen, j. frohlich, w. rodi, lesson lesfoil project large-eddi simul flow airfoil, aiaa journal 41 (4) (2003) 573581. [66] r. kojima, t. nonomura, a. oyama, k. fujii, large-eddi simul low-reynolds-numb flow naca airfoils, journal aircraft 50 (1) (2013) 187196. [67] d.-h. kim, j.-h. yang, boundari layer near-wak measur naca 0012 airfoil low reynold number (aiaa) (2009). 30 introduct convection-stabil mix fe scheme navier-stok equat weak dirichlet boundari condit mix fe method convect stabil segreg runge-kutta time integr matrix form time integr segreg runge-kutta scheme weak dirichlet boundari condit srk scheme adapt time-step techniqu scalabl solver incompress navier-stok equat numer test taylor-green vortex flow monolith vs segreg runge-kutta hp-refin adapt time-step techniqu scalabl analysi turbul channel flow re=395 effect cc uniform mesh influenc wall-norm compon comparison strong week imposit dirichlet boundari condit flow airfoil low reynold number test set simul result discuss conclus