make nonlinear manifold learn model interpretable: manifold grand tour paulo j.g. lisboaa, jose d. martn-guerrerob, alfredo vellidoc,d aliverpool john moor univers (ljmu), liverpool, unit kingdom, e-mail: buniversitat valencia (uv), valencia, spain, cuniversitat politecnica catalunya (upc), barcelona, spain dcentro investigacion biomedica en red en bioingeniera, biomaterial y nanomedicina (ciber-bbn), cerdanyola del valles, spain, e-mail: abstract dimension reduct requir produc visual high dimen- sional data. framework, straightforward approach visualis high dimension data base reduc complex apply- ing linear project tumbl project ax defin sequenc gener grand tour data. propos smooth nonlinear topograph map data distribut guid grand tour, increas effect approach prioritis linear view data consist global data structur maps. consequ approach enabl direct visualis topograph map project space discern structur data. experimen- tal result standard databas report paper, self-organis map gener topograph mapping, illustr practic valu propos approach. main novelti propos definit systemat wai guid search data view grand tour, select priorit them, base nonlinear manifold models. keywords: manifold learning, grand tour, data visualisation, nonlinear dimension reduction, linear project preprint submit expert system applic juli 17, 2015 1. introduct explor environment, unusual, counterintu- itive, try visual first. appli explor data (vellido et al., 2011). visualis process straightforward data set compris hand attributes, data visualis readili implemented, instanc multipl scatter-plots. however, high dimension data requir applic advanc methods. involv applic project map algorithm important, necessary, stage data analysis. special true interpret result requir analysi (vellido et al., 2012). techniqu data visualisation-ori instanc gener famili dimension reduct (dr) methods. frequent dr method involv linear combina- tion covariates. method advantag non-linear counterpart gap observ data seen particular pro- jection (reveal data group structure), gap known present close dimension project increased. pop- ular method princip compon analysi (pca), typic appli practic biplot (jolliffe, 2002). approach compens limitations, particular sensit nois lack ro- bust criterion choos adequ number pcs, straightforward interpret result projections. alternatively, non-linear dimension reduct (nldr) (lee verleysen, 2007) method potenti power model complex high-dimension data. method well-suit map topolog structur data, especi region well-separ lin- ear discrimin functions, or, equivalently, mean valu repres densiti function deviat normality. manifold learn method nldr famili techniqu attempt repres multivari data assum close approxi- 2 mate low-dimension manifolds, typic chosen 2-dimension visualis purposes. however, method gener complex surfac possibl occurr folds, result overfitting. more- over, project data visual map heavili condit assum structur map necessarili provid clear pictur empir data density. order increas interpret manifold learn techniques, combin gener model nldr linear project methods. altern approach produc differ view data aris success linear projections. framework gener compre- hensiv rang low-dimension project grand tour propos dian cook colleagu (buja et al., 2005; cook swayne, 2007). approach, data effect tumbl systemat wai view prism low-dimension linear projections, look indic structure, typic gap sub-popul cohorts. use- ful visualis obtained, need easi straightfor- ward wai obtain them, method recent implement r packag (wickham et al., 2011), user-friendli graphic user interfac (gui) (huang et al., 2012). approach power principle, reckon search procedur expedit prioritis inform view data; goal main novelti pro- pose approach compar (buja et al., 2005; cook swayne, 2007). (lecerf bouchard, 2012), method base select candid projec- tion space project proposed. propos method pursu goal differ complet perspective, requir user-interact two-dimension track emploi guid three-dimension project data need space- fill patterns. conjectur that, prioritising, effect introduc implicit narr process visual data analysis. ad contextu inform wai storytel potenti provid 3 action knowledg (segel heer, 2010). prioritis inform view data effect provid nldr methods. therefore, study, propos nldr manifold base surfac roll-out sequenc linear projections, know cross region high data density. approach intend us power linear project leverag data coverag gener nldr methods, particular self-organis map (som) network (kohonen, 2000) gener topograph map (gtm) (bishop et al., 1998a). particular, method aim quickli discov gap data distri- bution, consist hierarch structur explicitli avail prior clustering. propos methodolog manifold grand tour. remain paper start summari descript manifold learn model som gtm, overview cohort- base linear visualisation, improv pca data label cluster class membership, inform available. follow detail descript manifold grand tour procedure. em- piric result public domain data set illustr applic method. 2. method 2.1. overview topograph map decad wit quick develop nonlinear manifold learn method analysi multivari data. exampl in- clude local linear embed (rowei saul, 2000) laplacian eigen- map (belkin niyogi, 2003). survei method focu paper. instead focu consolid techniqu similar goal differ formalisation, som (kohonen, 2000) gtm (bishop et al., 1998a). 4 2.1.1. self-organis map probabl best-known wide nldr method data visualisa- tion kohonen som, variants. strictli manifold learn model, method attempt model data discret ver- sion low-dimension manifold consist topolog order grid prototypes. som algorithm procedur simultan perform combina- tion vector quantis topograph representation. nonlinear prevent som mainstream applic fields. som consist discret layer (map) unit neuron arrang low dimension regular grid (often 2d, visualisation). neu- ron k (k = 1, . . . ,k) related, embed function, d dimension vector y, usual call prototyp weight vector. let x = {xn}nn=1 data set vector x dimens d. initialis weight vector yk, algorithm find closest prototyp data vector xj (j = 1, . . . , n), known best match unit (bmu) ykj index kj , comput kj = argmink {d(xj ,yk)}, d(, ) commonli defin euclidean distanc l2(xj ,mk) = xj mk, altern l1 l, instance, considered. bmu relat closest neighbour neighbourhood func- tion h(, ). differ function considered, gaussian common choice. prototyp yi updat accord y (t+1) = y (t) + (t)h(t)(xi,yc) ( x(t) y(t)i ) , t time, x(t) x randomli se- lect time t, 0 (t) 1 denot learn rate. origin version som make separ updat model pa- ramet data point, taken time, batch version make updat basi data points. variant algorithm, updat equat rewritten kernel regress form 5 (mulier cherkassky, 1995), given iteration, as: yk = k (f (uk,uk)xk) (1) xk = 1 nv k jg k xj mean group gk nv k data point assign given node k, f (u,uk) = nkh(u,uk)/ k nkh(u,uk) 2.1.2. gener topograph map heurist definit som inspir develop method that, retain function advantages, set principl probabl theori framework. result gtm (bishop et al., 1998a) manifold learn model that, som, main appeal simultan provis multivari data cluster exploratori data visualisation. basic formul extend target goal divers time seri model (olier vellido, 2008) , outlier detect (vellido et al., 2009), un- supervis featur select (etchel et al., 2006), semi-supervis learn (cruz vellido, 2011), others. gtm latent variabl model (lvm). lvm attempt model observ data definit parsimoni set non-observable, latent variabl (bishop, 1998). specifically, lvm express distribu- tion p(x) variabl x1, . . . , xd observ data x term smaller number latent variabl u1, . . . , ul, l < d and, visualisa- tion, l 3. that, joint distribut p(x,u) decompos product margin distribut p(u) latent variabl condi- tional p(x|u) observ data given latent variables. condit distribut p(x|u) express term map latent space data space involv nois process. definit lvm involv describ condit distribut map function margin distribut p(u). these, distribut p(x) 6 data obtain marginalis latent variables: p(x) = p(x|u)p(u)du (2) gtm, finit number latent point k = 1, . . . ,k, usual space regular lattice, map observ data space, defin prototyp point. prototyp imag accord map function form gener regress model, d-dimension prototypes, yk, defin as: yk = w(uk), (3) set m basi function m (gaussian standard model) introduc nonlinear model, w d m matrix adapt weight paramet wdm, associ basi function m observ data dimens d. prototyp vector yk consid repres data point xn closer prototype. sense, model cluster data set result vector quantis process. set prototyp resid smooth manifold (where smooth confer map function itself) wrap observ data x = {xn}nn=1. condit distribut observ data variables, given latent variables, p(x|u), involv nois model varianc 1, defin as: p(x|u,w, ) = ( 2 )d/2 exp{ 2 d d=1 (xd yd(u))2}, (4) order integr latent variabl out, need defin margin distribut p(u). regular squar lattic k latent point distribut accord p(u) = k k=1 (u uk). definit make integr 7 eq.(2) analyt tractable. data distribut becomes: p(x|w, ) = 1 k k k=1 p(x|uk,w, )} (5) expression, complet model likelihood defined, maxi- mum likelihood approach estim adapt parame- ter model, usual expectation-maximis (em) (dempster et al., 1977). detail complet procedur (bishop et al., 1998a,b). data visualisation, result obtain maximis step em algorithm direct applic bay theorem invert map latent space observ data space, produc condit probabl latent point given observ data point: p(uk|xn) = p(xn|uk,w, )k k=1 p(xn|uk ,w, ) , (6) refer respons latent point gen- erat observ data point, rkn p(uk|xn). respons obtain data visualis form posterior mode project xn: k mode n = argmax{kn} rkn (which impli assign observ data point latent point highest respons generation), posterior mean project umeann = k k=1 rknuk (place observ data point locat latent space result responsibility-weight combin latent point locations). 2.2. grand tour concept grand tour publish origin form asi- mov colleagu (asimov, 1985; buja asimov, 1985) explor high- dimension data travel seri 2d-plane data projected. way, grand tour introduc sequenti ele- ment explor process aim obtain new insight 2d visualis data remain occult otherwise. point (wegman, 2003), grand tour is, effect, anim data. 8 anim requir illus continu achiev ensur navig chang smoothli time. achiev (wegman, 2003) continu geometr transforma- tion coordin possibl orient coordin axes. grand tour defin trajectori grassmannian manifold g(2, d), space 2d plane origin. effici calcul space-fil curv manifold low-dimension project high-dimension data spaces. number differ algorithm implement grand tour develop time descrip- tion scope paper. reader refer (wegman et al., 2002), discuss approach found, recent public (buja et al., 2005) grand tour relat data visuali- sation methods. paper, altern propos restrict slide view- finder grand tour trajectori previous obtain smooth manifold model data distribution, obtain nonlinear topograph model. gener limit faster visualis process aim visit inform perspect simpli complement nldr manifold method addit linear project data, interpret structur featur gap cluster margin shape profiles, straightforward. improv aris linear project ax chosen knowledg data possible, instanc cohort label aris cluster class tags. subject section. 2.3. cohort-bas visualis scatter matric pure linear dr method visualis frequent util singular valu span largest varianc data, pca biplot (jolliffe, 2002). approach us visual verifi known correl at- tributes, pc visualis 9 explain rel small proport data varianc data. mention introduction, guarante pc provid faith represent data. result, true compact group data sever mix represent space loss inform incur projection. popul cohort labelled, straightforward decompos data covari matrix cohort mean varianc cohort respect correspond mean point. justifi linear model discrimin featur separ cohorts, basi second order statist suffici parameteris multivari normal distribut which, turn, consist assumpt linear separ surfaces. cohort-bas visualis scatter matric method describ (lisboa et al., 2008) start follow ident show total varianc matrix, st , express sum within- between-group scatter matric defin cohort mean mi: st = sw + sb , (7) st = n i=1 ((xi m)t (xi m)), (8) sw = nc j=1 nj i=1 ((xi mj)t (xi mj)), (9) sb = nc j=1 (nj(mj m)t (mj m)) (10) m overal data mean; nc number label cohort nj number item cohort j. so-cal separ matrix defin extend intuit concept 10 ratio varianc mean within-covari matrix, follow mt = s 1 w sb . (11) matrix replac data covari matrix calcul eigenvector largest eigenvalues, form project directions, inform cohort labels. extens method case covari matrix data singular (lisboa et al., 2008). 2.4. manifold grand tour (mgt) propos visualis data straightforward. given topograph map data, pass peak data densiti distribution, assum 2d structur map, mgt procedur describ follows: fit topograph map data (a gtm experi report paper, variant som altern method used). start arbitrari node, e.g. corner map, direct edg node defin node nearest neighbours. two-dimension structur squar cell defin plane, orthonorm span coordin ax obtain gram-schmidt orthogonalisation. cohort-bas visualis method describ section 2.3 (or, instance, pca), direct maximum spread data defin project axi gram-schmidt. complet data displayed, project manifold coordin axes, required, project linear 3d space span ax defin above. 11 node repeat previou steps. view data requir node topograph map, axi rotat eigenvector covari (or separating) matrix next. order, reduc size correspond eigenvalue, return eigenvalu proceed node, dimens chang slowly, smooth topograph map. success iter inform separ data cohort gradual reduce. limit method view data bound lie space span edg link success node topograph map span matrix defin axi visualis perspective. matrix separ matrix, dimension space limit rank matrix, number distinct cohort minu one. however, varianc matrix used, clearli rank. cases, qualiti visualis depend to- pograph map cover data. case, eigenvector structur matric deriv second-ord statist grassman- nian manifold tour guides. follow experiments, suffici iter eigenvector largest eigenvalu separ matrix defin orthogon direct cell topograph surfac cover data. 3. experi 3.1. materi propos methodolog multivari data visualis test differ real data sets: italian oliv oil (cook swayne, 2007; forina et al., 1983) music (cook swayne, 2007). 12 italian oliv oil data set consist 572 sampl 10 variables. variabl percentag composit fatti acid lipid fraction oils, determin authenticity. remain- ing variabl contain inform classes, kinds: super-class countri level: north, south, island sardinia; collect area classes: northern region (umbria, east west liguria), south (north south apulia, calabria, sicily), island sardinia (inland coastal sardinia). goal distinguish oil differ region area itali base combin fatti acids. cluster correspond class differ shape eight-dimension data space defin concentr fatti acids. music data set consist 62 sampl seven variables. data produc read differ song music edit softwar amadeu ii r, snip save 40-second clip wav file. audio convert numer data r program language. mean variabl following: artist: abba, beatles, eels, vivaldi, mozart, beethoven, enya. type: rock, classical, new wave. average, varianc maximum frequenc left channel (three variables). amplitud loud sound. median locat 15 highest peak periodogram. analysi goal data set group track small number cluster accord similar term audio characteristics, enlighten whether, instance, rock classic track distinguishable. knowledg applied, instance, arrang track digit music player, recommend base track similarity. 13 3.2. experiment set adapt paramet gtm model analyz data de- scribe previou section initi follow standard procedur describ (bishop et al., 1998a): weight matrix w, embodi map latent observ data space, defin mini- mize differ prototyp vector yk defin eq.(3) vector gener observ space partial pca process. invers nois model varianc paramet initi invers 3rd pca eigenvalue. initialis procedur shown reliabl ensur replic result guarante random initialis parameters. differ gtm squar lattic size explor but, end, conve- nient achiev trade-off (which proport size lattice) practic visual interpretability. analys data, suitabl layout gtm lattic 15 15 grid, chosen report experiments. order avoid data overfitting, regular version gtm used. regularis encourag smoother manifold what, fact, com- plexiti control process achiev addit regularis term log-likelihood model, becomes: lreg = n n=1 ln p(xn|w, ) 1 2 w2. (12) here, regularis coeffici w vector result concaten differ column vector weight matrix w. optimis paramet accomplish bayesian for- malism and, particular, evid approxim (mackay, 1991; vellido et al., 2003). manifold yield gtm, visualis produc accord procedur describ section 2.4. 14 3.3. result discuss 3.3.1. italian oliv oil data set expect gtm-base mgt produc us visualis project data ax defin gtm node procedur describ section 2.4. figur 1 show select repres project illustration: plot repres project cluster mix extens overlap. difficult separ region mere visual inspection. plot, instead, show project cluster neatli separated, intermedi case (neither well-separ plot, mixed-up one) shown middl plot. although, sake brevity, result omitted, emphas project node produc meaning plot show differ main class (south, sardinia north) clearly. moreover, result match achiev (cook swayne, 2007), reveal presenc intern structur spe- cialli cluster 2 (sardinian origin), shown form sub- cluster (inland coastal sardinia). clearli reveal detail sub-class (umbria, east west liguria, north south apulia, cal- abria, sicily, inland coastal sardinia) represent figur 2, inland repres blue triangl coast black pentagrams. 3.3.2. music data set italian oliv oil data set, regular gtm correspond music data set gener manifold degre folding, relev visualis produc project data ax defin gtm node accord propos mgt procedure. summarily, figur 3 show project data differ node gtm. middl plot repres visualis especi helpful, differ cluster (rock, classical, new wave) appear clearli separated, situat revers plot, 15 3 2 1 0 1 2 3 2 1.5 1 0.5 0 32101234 3 2 1 0 1 2 3 0.5 0 0.5 1 1.5 2 figur 1: chosen illustr mgt project italian oliv oil data set, colour- label main class (south: red crosses, sardinia: green circl north: magenta squares), defin differ gtm nodes. plot exempli- fi project cluster clearli separated, middl plot correspond project difficult visual disentangl cluster structure. repres project cluster easili differentiated. previou data set, presenc intern structure, 16 2.521.5 10.5 1.5 1 0.5 0 0.5 1 1.5 2.5 2 1.5 1 0.5 0 0.5 1 1.5 1.510.500.5 figur 2: chosen illustr mgt project italian oliv oil data set, time colour-label detail sub-class structure, defin differ gtm nodes. intern structur sardinian cluster shown sub-clust (black pentagram blue triangles) obviou singl flat visualis data provid gtm, remarkable. particularli true rock, certain intern structur classic visual discerned. explain fact classic music norm style rock and, result, influenc artist relev definit intern structure. effect like predomin small data set analyz experiments. 17 0 1 2 3 4 3 2 1 0 1 2 3 4 3 2 1 0 1 2 3 2 1 0 2 1 0 1 2 2 1.5 1 0.5 0 0.5 1 1.5 2 2.5 figur 3: chosen illustr mgt project music data set, colour-label main class (rock repres red stars, classic green circl new wave blue squares), defin differ gtm nodes. plot exemplifi project cluster clearli separated, middl plot correspond project differ degre visual cluster overlapping. 4. conclus paper present new approach nldr method orient multivari exploratori data visualis combin model flex- 18 ibil method, gtm, interpret linear model data visualisation. report experiments, gtm guid grand tour real data set us recent propos lin- ear dr method data visualisation, base cluster approach. achiev result illustr suitabl propos method produc us represent intuit reveal intern data structure. paper involv relev theoret advanc respect stan- dard grand tour view select random accord data-smart guide, manifold gener nonlinear gtm. work improv complet approach present (lecerf bouchard, 2012), user interact two-dimension track requir guid dimension projections. main limit studi re- late number class structur high number class difficult visualization; common problem kind visualizations. finally, import remark appeal ad- vantag propos method straightforwardli extend altern manifold learn algorithms. refer refer asimov, d., 1985. grand tour: tool view multidimension data. siam journal scienc statist comput 6, 128143. belkin, m., niyogi, p., 2003. laplacian eigenmap dimension reduct data representation. neural comput 15 (6), 13731396. bishop, c. m., 1998. learn graphic models. m.i.t. press, ch. latent variabl models, pp. 371404. bishop, c. m., svensen, m., williams, c., 1998a. gtm: gener topo- graphic mapping. neural comput 10 (1), 215234. 19 bishop, c. m., svensen, m., williams, c. k. i., 1998b. advanc genera- tive topograph mapping. neurocomput 21 (13), 203224. buja, a., asimov, d., 1985. grand tour methods: outline. in: comput scienc statistics: proceed seventeenth symposium interface. pp. 6367. buja, a., cook, d., asimov, d., hurley, c., 2005. handbook statist vol- um 24: data mine data visualization. elsevier, ch. comput method high-dimension rotat data visualization, pp. 391 414. cook, d., swayne, d. f., 2007. interact dynam graphic data analysis. springer verlag, berlin, germany. cruz, r., vellido, a., 2011. semi-supervis analysi human brain tumour partial label mr information, manifold learn models. intern journal neural system 21 (1), 1729. dempster, a. p., laird, n. m., rubin, d. b., 1977. maximum likelihood incomplet data em algorithm. journal royal statist societi seri b-statist methodolog 39 (1), 138. etchells, t. a., nebot, a., vellido, a., lisboa, p. j. g., mugica, f., 2006. learn important: featur select rule extract vir- tual course. in: proceed esann 2006. pp. 401406. forina, m., armanino, c., lanteri, s., tiscornia, e., 1983. food research data analysis. appli scienc publishers, ch. classif oliv oil fatti acid composition, pp. 189214. huang, b., cook, d., wickham, h., 2012. tourrgui: gwidget gui tour explor high-dimension data low-dimension projections. journal statist softwar 49 (6), 112. 20 jolliffe, i. t., 2002. princip compon analysis, 2nd edition. springer seri statistics, springer verlag, berlin, germany. kohonen, t., 2000. self-organ maps. inform scienc series, springer, berlin, germany. lecerf, l. m., bouchard, g. m., 06 2012. adapt grand tour. url lee, j. a., verleysen, m., 2007. nonlinear dimension reduction, informa- tion scienc statistics. springer, berlin, germany. lisboa, p. j. g., ellis, i. o., green, a. r., ambrogi, f., dias, m. b., 2008. cluster-bas visualis scatter matrices. pattern recognit let- ter 29 (13), 18141823. mackay, d., 1991. bayesian method adapt models. ph.d. thesis, cali- fornia institut technology, u.s.a. mulier, f., cherkassky, v., 1995. self-organ iter kernel smooth- ing process. neural comput 7 (6), 11651177. olier, i., vellido, a., 2008. advanc cluster visual time seri gtm time. neural network 21 (7), 904913. roweis, s., saul, l., 2000. nonlinear dimension reduct local linear embedding. scienc 290 (5500), 23232326. segel, e., heer, j., 2010. narr visualization: tell stori data. ieee transact visual graphic 16 (6), 11391148. vellido, a., el-deredy, w., lisboa, p., 2003. select smooth genera- tive topograph mapping. ieee transact neural network 14 (4), 847852. vellido, a., martn, j. d., lisboa, p. j. g., 2012. make machin learn model interpretable. in: proceed esann 2012. pp. 163172. 21 vellido, a., martn, j. d., rossi, f., lisboa, p. j. g., 2011. see believing: import visual real-world machin learn applications. in: proceed esann 2011. pp. 219226. vellido, a., romero, e., gonzalez-navarro, f. f., belanche-munoz, l., julia- sape, m., arus, c., 2009. outlier explor diagnost classif multi-centr 1h-mr brain tumour database. neurocomput 72 (13 15), 30853097. wegman, e. j., , solka, j. l., 2002. mathemat visual high dimension data. indian journal statistics, seri 64 (2), 429452. wegman, e. j., 2003. visual data mining. statist medicin 22 (9), 1383 1397. wickham, h., cook, d., hofmann, h., buja, a., 2011. tourr: r packag explor multivari data projections. journal statist softwar 40 (2), 118. 22