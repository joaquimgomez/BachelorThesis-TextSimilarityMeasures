doubl hierarchi method. parallel 3d contact method interact spheric particl rigid fe boundari dem 1 23 comput particl mechan issn 2196-4378 comp. part. mech. doi 10.1007/s40571-016-0109-4 doubl hierarchi method. parallel 3d contact method interact spheric particl rigid fe boundari dem miquel santasusana, joaqun irazbal, eugenio oat & josep maria carbonel 1 23 articl protect copyright right held exclus owz. e- offprint person us shall self-archiv electron repositories. wish self-arch article, us accept manuscript version post website. deposit accept manuscript version repository, provid publicli avail 12 month offici public later provid acknowledg given origin sourc public link insert publish articl springer' website. link accompani follow text: "the final public avail link.springer.com. comp. part. mech. doi 10.1007/s40571-016-0109-4 doubl hierarchi method. parallel 3d contact method interact spheric particl rigid fe boundari dem miquel santasusana1 joaqun irazbal1 eugenio oate1 josep maria carbonell1 received: 3 februari 2016 / revised: 16 march 2016 / accepted: 17 march 2016 owz 2016 abstract work, present new methodolog treatment contact interact rigid boundari spheric discret element (de). rigid bodi part present large-scal simulations. sur- face rigid part commonli mesh finit element-lik (fe) discretization. contact detect calcul thosed discret boundari straightforward address differ approaches. algorithm present paper consid- er contact de geometr primit fe mesh, i.e. facet, edg vertex. so, origi- nal hierarch method present horner et al. (j eng mech 127(10):10271032, 2001) extend new insight lead robust, fast accur 3d contact algorithm fulli parallelizable. implement method develop order deal ideal triangl quadrilaterals. boundari dis- cretiz type geometries, method easili extend higher order planar convex polyhedra. detail descript procedur follow treat wide rang case presented. descript develop algorithm valid verifi practic examples. parallel capabl obtain perform present studi industri applic example. keyword discret element method contact detect hierarch search particlesolid contact interact b joaqun irazb miquel santasusana 1 intern center numer method engin (cimne), barcelona, spain 1 introduct cundal [7] present idea dem 1979, numer techniqu increas popularity, being, nowadays, themost power effici tool reproduc behaviour granular materials. dem approach, materi grain repres rigid particle. deform themateri repres interact particles. particl rigid, normal tangenti contact defin materi constitut behaviour. themethod formulation, definit appro- priat contact law fundament fast contact detect signific import dem calculations. contact statu individu objects, particl (de/d contact) particl bound- ari element (e.g. de/f contact) calcul rel posit previou time step updat contact forc current step. rel comput cost contact detect total comput cost high dem simulations, so, problem recogn contact precis effici receiv consider attent litera- ture [26,41]. note term fe articl refer solut partial equat mean finit element method. instead term refer geometri element (triangles, quadrilaterals, etc.) discret boundaries. traditionally, contact detect split stages: global neighbour search local contact resolution. concerningglobalneighbour search comput cost reduc o(n 2) all-to-al check o(n ln(n )). han et al. [16] compar common global neighbour search algorithm (cell-bas tree- based) simul spheric particles. numer 123 author' person copi comp. part. mech. test show better perform cell-bas algo- rithm (d-cell [42] nb [27]) tree-bas on (adt [2] sdt [12]), special large-scal problems. note effici depend cell dimens and, general, size distribut affect performance. han et al. [16] suggest cell size time averag discret object size 2d time 3d problems. worth note effici algorithms, cost global neighbour search repres typic 5 % total compu- tation, total cost search reach valu 75 % [17], special search involv non-spher geometri triangles, quadrilaterals, etc. sens focu place local contact resolut check optim theglobalneighbour search algorithms. character contact boundaries, solut report resolv particl solid interact problems. simplest on glued-spher approach [21], approxim com- plex geometri (i.e. rigid bodi boundari surface) collect spheric particl retain simplic- iti particle-to-particl contact interaction. approach, however, geometr inaccur computation intens introduct excess number particles. easi approach (use numer codes, e.g. abaqus) defin boundari analyti- cal surfaces. approach computation inexpensive, appli certain specif scenarios, us infinit surfac disturb calculation. complex approachwhich combin accuraci versa- tiliti resolv contact particl (sphere typically) finit element boundari mesh. method account possibl contact primit fe mesh surface, i.e. facet, edg vertex contact. horner et al. [17] kremmer et al. [22] develop hierarch contact resolut algorithm contact problem spheric particl triangular ele- ments, zang et al. [44] propos similar approach account quadrilater facets. dang et al. [9] upgrad method introduc numer correct improv smooth stability. su et al. [34] develop com- plex algorithm involv polygon facet rigid method includ elimin procedur resolv contact differ non-smooth contact situ- ations. approach, however, consid case spheric particl contact enti- ti differ surfac time (multipl contacts) lead inaccur contact interaction. upgrad rigid-ii method present later su et al. [35] method propos hu et al. [18] account mul- tipl contact situations, complex elimin procedur differ contact scenario distin- guish, difficult code practice. recent chen et al. [6] present simpl accur algorithm cover situations. elimin procedure, how- ever, requir special databas comput parallel. work, doubl hierarchi method (h2), local contact resolution, introduced. consist sim- ple contact algorithm base fe boundari approach special design resolv effi- cientli intersect sphere triangl planar quadrilater work fine higher order planar convex polyhedra. two-lay hierarchi appli upgrad classic hierarchi method present horner [17]; hierarchi contact type follow hierarchi distance. classifi type contact (facet, edg vertex) contact neigh- bour hierarchicalway,whil distance-bas hierarchi determin contact valid relev on removed. import issu consid work par- allel comput crucial practic purpos dem code. industri applic involv larg num- ber particl fine definit boundari which, case, turn larg number fe boundari conditions. therefore, algorithm present design awai code canwork effici parallel computations. clear advantag above- mention publications. nakashima [28] method presum paralleliz zang [44] su [35] remark import futur parallel algorithm exceptions. summarizing, contact search framework present design satisfi follow requirements: includ poly-dispers element both: fe des. allow differ fe geometri primit (triangle, quadrilateral, polygon). ensur contact continu non-smooth region (edg vertices). resolvemultipl contact contact differ enti- ti simultaneously. need low memori storage. simple, fast accurate. fulli parallelizable. tabl 1 summar strength drawback review contact detect methods. method base stor- ing potenti contact late remov invalid on (rigid-ii [35], hu et al. [18], chen et al. [6] h2) accurate. treat case larg indenta- tion (rel size fe) solut contact continu non-smooth region bound- ary. method have, however, limit 123 author' person copi comp. part. mech. tabl 1 strength drawback differ contact detect algorithm evalu glu sph. analyt hierarch rigid rigid-ii hu chen h2 [21] [9,17,22,44] [34] [35] [18] [6] wide size rate des/f contact element typolog boundari shape flexibl multi-contact simpl effici accur low storag upgrad deform fe larg indent contact continu - symbol () impli method satisfi property. hand, symbol () mean method satisfi property. symbol () denot properti appli method () mean that, method satisfi property, limit fact real deform geometri sphere repres dem. indent represents, instead, local deform near contact region. fact, concav transit boundary, error con- tact detect common method includ h2 method presented. sect. 7 analys h2 framework bound error provid differ situations. paper start introduct basic for- mulat method classic algorithm de/d contact search. propos strategi de/f contact search includ novel dou- ble hierarchi method (h2) described. valid analysi exampl perform critic situat (where literatur method fail) presented. final result scalabl parallel comput given. 2 dem formul algorithm implement thedemcod call dempack (www.cimne.com/dempack/) insid krato [8], open-sourc softwar framework develop numer method solv multidisci- plinari engin problems. 2.1 basic formul dem base character materi mean defin interact constitu particles. interact describ de/d contact mechan defin particl kinematics. basic dem formulation, translat rotat motion particl defin standard equat dynam rigid bodies. spheric particle, equat written m u = f , (1) = t , (2) u, uu are, respectively, particl centroid displace- ment, second deriv fix coordin systemx, angular velocity, angular acceleration, m particl mass, inertia dyadic respect par- ticl centr mass, f result forc t result moment central axes. f t comput sum (i) forc moment appli particl extern loads, fext andtext, respectively, (ii) contact interactionswith neigh- bour sphere boundari finit element fi j , j = 1, , nc, particl consider j neighbour index rang 1 number element sphere nc contact (iii) forc moment result extern damping, fdamp andtdamp, respectively, written f = fext + nc j=1 fi j + fdamp (3) t = text + nc j=1 r j c fi j + tdamp (4) r j c vector connect centr mass i-th particl contact point pci j j-th parti- 123 author' person copi www.cimne.com/dempack/ comp. part. mech. (a) (b) fig. 1 decomposit contact forc normal tangenti compon [30]. contact particles. b forc decomposit cle. figur 1 show contact forc spheric particl [30]. contact interact sphere repres contact forc fi j f j (fig. 1), satisfi (fi j = f j ). forc fi j decompos normal tangenti components, f j n f j t , respect (fig. 1) fi j = fi jn + fi jt = fnni j + fi jt , (5) ni j unit vector normal contact surfac contact point. tangenti forc f j t , tangenti direct t j (fig. 1), written f j t = ft1 ti j1 + ft2 t j 2 , (6) ft1 ft2 tangenti forc compon tangenti direct t1 t2, respectively. contact forc fn, ft1 ft2 obtain constitut model formul contact rigid fe. larg avail- abl contact model [32,33,37] compat contact algorithm present article. exampl includ perform formul summa- rize [5]. standard constitut model dem character normal (kn) tangenti (kt ) stiffness, normal (dn) tangenti (dt ) local damp coeffici contact interfac coulomb friction coeffici () repres schemat fig. 2 case dis- crete spheric particl [32]. similar model usual appli sphere-f contact. equat (1) (2) integr time simpl central differ scheme [30]. translat motion (n + 1)-th time step calcul follows: = f n m , (7) un+ 1 2 = 12 + unt (8) fig. 2 dem standard contact interfac model [31] un+1 = + un+ 12 t . (9) integr scheme calcul incre- ment rotat motion time step , , n = i1tn , (10) n+ 12 = n 12 + nt (11) = n+ 12 t . (12) explicit integr time yield high comput effici enabl solut larg models. dis- advantag explicit integr scheme condit numer stability, impos limit maximum time step t determin highest natur fre- quenci [46]. 2.2 de/f contact themain focu thiswork thedynam particl (des) contact rigid boundari (fes). singl forc contact entiti (facet, edge, vertex) suffic physic particl but, general, fe deform solid characterized. contact forc transfer finit element node interpol base fe shape function [17]. linear triangles, simpl linear interpol fi = ni (xpc )f, ni (xpc ) = 1 + 2 + 3 , [1, 3] (13) wherexpc positionof contact point andi area triangl form contact point opposit vertic vertex fe (fig. 3). 2.2.1 non-smooth contact applic constitut contact law thehertz- mindlin [25] requir contact surfac smooth present uniqu normal point. de/f contact, usually, origin geometri present region requir fulfilled. moreover, smooth sur- face loos featur discret mean 123 author' person copi comp. part. mech. fig. 3 punctual forc f nodal interpol three-nod triangl mean linear shape function express area coordin fes. situations, special treatment non- smooth region appli requir condit ensur reason results. follow condit analys work bywellmann [39]: contact constitut model appli normal contact facet vanish interpenetr elements. discontinu contact forc contact point evolv facet edg wai round order avoid unphys result numer instabilities. energi conserv elast frictionless impact. us present contact determin algorithm help select contact model ensur objectives. addition want method yield result geometr depend nevermesh dependent. practic achiev shown follow sect. 6 limit detail sect. 7. 2.2.2 extens deform fe direct applic hierarchy-bas contact algorithm deform solid yield inaccur result particl come contact non-smooth part discret surfac instabl caus sudden appear contact forc non-smooth transit fe. horner et al. [17], nakashima et al. [28] michael et al. [24], few, clas- sic hierarchical-bas algorithm linear interpol forc tiresoil interact applic fe deform accounted. reason case size de rel small compar size fe penetr neglig compar de radiu (small deformation). fig. 4 neighbour find scheme. fe intersect domain valid entiti h2 method major problem solved, method conceiv purpos fact concentr contact forc point clear disadvantage. general, situat detail analysi strain stress conducted, accur scheme used. han et al. [14,15] wellmann [39] present algo- rithm purpose. 3 de/f contact search algorithm de/f contact search differ de/d sens search differ group geometri intersect gener complex computation expens trivial sphere sphere case. involves, general, resolut non-linear equat (see case superquadr [4,39] polyhedra [3,10,29]). choic sphere de triangl quadrilater fe clever choic particular check effici way. contact search split global neigh- bour search local contact resolution. strategi base split local contact resolut stages: (a) fast intersect test (b) doubl hierarchi method. stage schemat shown fig. 4. 3.1 global search algorithm themain purpos global search determin fast rough searchwhich potenti neighbour element domain. basic cell-bas algorithm [42] chosen parallel omp adapt de/f search. fe domain select build search bin take advantag fact usual spatial distribut fe regular case fixed. algorithm addit featur search bin built dynam consid fe belong intersect bound box de fe domains. figur 5a show intersect evolv long simul goe on. hand, thede insid intersect domain (i )will look neighbours. reduc significantli contact pair 123 author' person copi comp. part. mech. (a) (b) (c) (d) (e) (f) (g) fig. 5 sketch show search algorithm basic contact level. evolut bound box intersect . b bound box fe . c bin fe . d hash table. e bound box de . f intersect cells. g local contact resolut check and, therefore, global search perform increased. global search, fe associ boundingbox (febbx , debbx ) tag posi- tion element search bin rapidli check potenti neighbours. hash tabl structur depict fig. 5d relat cell bound box febbx fall it. rectangular hexahedr bound- ing box encompass type element chosen here. step need perform neighbour search global search level follows: (a) set bound box intersect domain (fig. 5a). (b) set bound box fe (fig. 5b). (c) gener search bin base size posit bound box febbx fe (fig. 5c). (d) place fe search bin (look coor- dinat associ bound box febbx ) build hash tabl (fig. 5d). (e) set bound box de (fig. 5e). (f) particl obtain potenti neigh- bour search bins. check intersect debbx febbx fe ly sur- round cell (fig. 5f). 3.2 local resolut thefast intersectiontest,wedeterminewhichpotenti fe neighbour actual contact particle. fast potenti neighbour adjac cell checked. therefore, detail contact comput determin type contact, contact point, normal direction, etc. skipped. hand, good accuraci determin contact neighbour needed. want avoid fill contact pool fe contact elimin treat subsequently. procedur describ sect. 4. second stage, doubl hierarchi method take place contact characterization. determin type contact neighbour, contact relev on remov avoid instabl redund contact evalu non-smooth region contact transitions. detail contact characterist fulli determin stage valid neighbour entities. h2 method directli appli tradit local contact resolut check, split give code higher modularity, i.e. contact characteriza- 123 author' person copi comp. part. mech. tion appli contact entities. in-hous code krato split yield higher effici (sect. 6). 4 fast intersect test effici algorithm design determin intersec- tion sphere contact triangl planar quadrilater describ here. adapt procedur exist graphic bibliographi [11,20] case facet contact (insid fe) occur substanti higher frequenc compar edg vertex geometr contact types. [18] type con- tact frequenc (facet, edge, vertex) determin differ number particl rel sizes. test work planar convex polygon n sides. loop potenti fe neighbour provid global neighbour search algorithm. fe contact store arrai sphere. 4.1 intersect test plane contain fe check determin particl intersect m plane form m-th planar finit element em . repres fig. 6. outward-point normal plane calcu- late cross product t pair edg taken counter-clockwise. bewritten follow form, permut tensor jk edg formed, example, consecut vertic v1, v2, v3: ti = jk(v2j v1j ) (v3k v2k) (14) normal unit length obtain normal plane n n = tt (15) fig. 6 intersect particl plane form plane fe case zero-thick wall contact side fe, sens normal set point outward particl centre. normal defined, distanc thede centrec planem determin take known point plane, vertex va , d = 3 i=1 ( ni ci ni vai ) (16) distanc d compar radiu r. |d | r, contact sphere fe possible. case, proce checks. otherwise, contact current fe discard jump check potenti fe neighbour. 4.2 inside-outsid test purpos test determin contact insid fe (facet contact) outsid (edge, vertex contact). appli case |d | r. modifi- cation inside-outsid statu check [38] used. project cm centr c plane m form element em normal n calcul cm = c d n (17) step evalu project cm li insid outsid fe em respect edg ea form vertic va va+1(vn = v0) (see fig. 7). edg ea , comput cross product sign sa ea = va+1 va (18) sa = (ea (cm va) ) n (19) product positive, project point cm turn insid triangl respect edge. loop proce edges. result edge, contact occur facet fe (inside) fig. 7 inside-outsid check project point edg edg 123 author' person copi comp. part. mech. contact assured. otherwise, edg outsid statu found, loop abort automat contact facet found. current valu edg index store auxiliari variabl index step contact vertic edg checked. 4.3 intersect test edg test need case |d | r inside-outsid test failed. us idea edg contact happen edg inside-outsid check yield insid status. therefore, recommend test edg ea [indexe, n ] start vertex fail previou test skip previou on (note edg check expens one). approach chen et al. [6]. first, shortest distanc edg e particl centr c calcul compar radiu r (fig. 8). distanc calcul find contact point pc, = pc c (20) pc = va + p e ea (21) ea = va+1 va (22) p distanc result project vector connect centr c vertex va edg ea : p = (c va) ea (23) > r, contact edg possibl check start edg ea+1. otherwise, r determin pc lies, edge, help , defin = pea (24) case 0 1 impli edg contact. therefore, con- tact fast intersect test finish yield posit result. fe neighbour save current algorithm proce check potenti fe neighbour. otherwise, test fail current edg ea , connect vertic (va va+1) evaluated. valu < 0 indic check va ; hand, > 1 vertex test va+1. fig. 8 intersect particl edg 4.4 intersect test vertex vertex va consideration, calcul squar distanc centr c: dva 2 = i<3 i=0 ( ci vai )2 (25) dva 2 r2, fast intersect test yield pos- itiv result test finishes. test move check edg ea+1 subsequ vertices. recal purpos fast intersect test mere determin intersect sphere fe planar convex polygon. intersect vertex edg assur actual contact point. case, however, omit stage check subsequ edg vertic contact point happen closer. 4.5 fast intersect test scheme algorithm planar convex polygon n side summar tabl 2. 5 doubl hierarchi (h2) method procedur appli list fewith contact fast intersect test gener particle. case previou fast check oper directli appli local contact resolut disadvantag potenti fe tested. develop differ stages: contact type hierarchi (sect. 5.1) con- tact fe contact entiti higher prioriti determined. distanc hierarchi (sect. 5.2) elimin procedur take place determin contact point dis- 123 author' person copi comp. part. mech. tabl 2 fast intersect test scheme tanc prioriti redund fals eliminated. 5.1 contact type hierarchi basi procedur primit hier- archi sub-entities, i.e. facet n -side polygon fig. 9 contact type hierarchi triangle. facet higher hierarchi edg vertices. edg higher hierarchi vertic fig. 10 contact facet. edg vertic discard con- tact check hierarchi n edg compos it. turn edg ea hierarchi vertic va, va+1. figur 9 outlin contact type hierarchi triangle. algorithm organ sequenc entity- check levels. particl contact facet fe contact search edg vertices, lower hierarchi level, discard (see fig. 10). otherwise, contact fe facet exist, contact check continu sub-entities. similarly, edg level, contact edg cancel contact check vertic belong edge. cancel out, however, contact check edg hierarchi level. tabl 3 sect. 5.1.4 displai pseudocod contact type detection. time new contact entiti determin contact type hierarchy, distanc hierarchi (sect. 5.2) take place immedi after. distanc hierarchi determin new contact entiti redund non-valid, cancel previous on new valid contact entiti consid de. 123 author' person copi comp. part. mech. tabl 3 contact type hierarchi algorithm loop fe neighbour contact em . (1) facet level project centr plane cm (eq. 17). perform inside-outsid test (sect. 4.2) contact: distanc hierarchi (tabl 4) stop! else: (2) index indexe. (2) edg level loop edg ea [indexe, n ]. perform edg check (sect. 4.3). contact distanc hierarchi (tabl 4). (de r < 0) (3) va . (de r > 1) (3) va+1. continu edge. (3) vertex level perform vertex check (sect. 4.4). contact distanc hierarchi (tabl 4). edg level check edge. valid contact entiti geometr contact char- acterist store follows: contact point pc. fe nodal weights. contact type: facet, edg vertex. note geometr characterist distance, normal vector contact local axi recalcul later contact constitut law appli and, thus, option store stage. 5.1.1 facet level check proce wai explain sect. 4, check intersect plane form fe (sect. 4.1). fast intersect test perform previous |d | r necessarili true contact fe. otherwise, previou fast intersect test carri out, condit appli discard fe contact. next, inside-outsid test (sect. 4.2) per- formed. test tell project cm (eq. 17) li facet (insid fe) outside, contact edg vertices. figur 11 show exampl project cm insid outsid fe facet. valu cross product sign sa obtain eq. 19 edg ea obtain weight shape function contact point. area need (a) (b) fig. 11 exampl project cm insid fe facet (a) (facet con- tact) outsid (b) (no facet contact) triangle. cm insid facet. b cm outsid facet. fig. 12 triangular area calcul shape function valu planar convex quadrilater calcul simpli half cross product sign: = sa/2. weight nodal shape function contact point calculated. triangle: n1 = 2 t , n2 = 3 t , n3 = 1 t (26) t = 1 + 2 + 3 (27) four-nod convex quadrilater (fig. 12 follow express appli introduc zhong [45]): n1 = 23 q , n2 = 34 q n3 = 41 q , n4 = 12 q (28) q = (1 + 3)(2 + 4) (29) note cross product sign sa evalu respect edg ea yield neg valu check 123 author' person copi comp. part. mech. fig. 13 contact edge. vertic belong edg dis- card contact check stop project centr cm li outside. current edg index index store check appoint sect. 4.3. project cm (eq. 17) li insid facet, contact point pc. highest hierar- chy level facet, contact type hierarchi finish fe. distanc hierarchi call necessari contact characterist saved. 5.1.2 edg level level edg check detail sect. 4.3 appli edg ea [indexe, n ] start edg yield outsid statu facet level. contact edg ea check lower level vertic associ it, va va+1, discard (fig. 13). contact check follow edg discarded, however, hierarchi level term contact type. distanc hierarchi determin valid new contact elimin substitut previou ones. kei differ fast intersect test check automat stop contact entiti found. nodal weight obtain paramet (eq. 24) edg ea . figur 14 show graphic determined, na = 1 , na+1 = (nn = n0) (30) equat 30 show valu node connect edg ea . rest node null valu shape functions. edg contact check fail distanc (eq. 20) lower radiu (de r) closest vertex (base calcul ) checked. check proce fig. 14 weight edg contact triangl fig. 15 contact edg vertex. contact exist edg e3 exist vertex v2 case (found edge, vertex none) edges. 5.1.3 vertex level vertex check describ sect. 4.4. figur 15 illus- trate edg ea hierarchi vertic va, va+1 thenon-contiguousoneva+2. shape function weight 1 vertex 0 rest. usual distanc hierarchi call contact detect and, contact valid, characterist stored. 5.1.4 contact type hierarchi scheme scheme tabl 3 assum fast intersect test taken place already. loop neighbours. check perform parallel particl model. 5.2 distanc hierarchi spheric particl be, general, contact differ fe entities. contact result penetr introduc penalti method 123 author' person copi comp. part. mech. fig. 16 contact fe mesh element smaller indent contact redund invalid inform and, therefore, eliminated. scenario shown fig. 16 contact element e2, e3 e4 detected. collis sphere normal plane, forc appli plane surfac sphere normal direct magnitud given penetr independ posit x y plane. therefore, contact forc come edg element e2 e4 taken account. solv distance-bas hierarchi elimin procedur take place time new contact entiti contact type hierarchy. procedur basic compar contact vector project another. new contact vector vci = c pci project previous con- tact vector vc j = c pc j vice versa. follow express obtained: pri, j = vci vc j vc j , pr j,i = vc j vci vci (31) contact check perform algorithm pre- sent tabl 4: tabl 5 show exampl elimin proce- dure perform differ possibl cases. left contact vector represented. graphi- cal interpret project given example. right side, final relev contact vectors, distanc hierarchi yields, shown. situation, contact edg element e2 e4 taken account, projections, pr2,3 pr4,3, facet contact vector element e3 modul contact vector vc3 itself. second situation, sphere contact facet element e4, edg element e3 share edg element e1 e2 appear differ contact vector vc1 vc2 given contact type hierarchi stage. vector appear directli figur tabl 5 calcul c pc1 tabl 4 distanc hierarchi check given new contact contact type hierarchy: (1) loop exist contact ( j = 1, . . . , n) project vci vc j : pri, j = vci vc jvc j project vc j vci : pr j,i = vc j vcivci (pri, j vc j) : invalid contact. (2) (false) break loop. (pr j,i vci) : j invalid contact. discard j ! continu loop. (2) (true). (2)valid contact (true/false) (true) : valid contact! save contact details. (false) : invalid contact! discard i!. andcpc2, respectively. first, note contact vc1 vc2 arbitrarili discard elimin procedur mathemat vector. let assum vc1 kept vc2 discarded. hand, project pr3,4 contact vector vc3 contact vector vc4 discard contact element e3. finally, contact element e4 e1 discard project valu pr1,4 = 0 pr4,1 = 0 (thei form 90 angle) smaller contact vector length. contact taken account, expected. main advantag method li wide generality. work fine tradit conflic- tive situat multi-contact fe transit present. consist order neigh- bour store affect final result. test carri valid (sect. 6) forc vector appropri direction. 5.3 note type fe geometri take advantag gener method, algorithm appli directli n -side planar con- vex polygon fe. weight calcul barycentr coordin introduc meyer et al. [23] analys sukumar [36]: ni = cot(i ) + cot(i ) pc vi2 (32) definit shown fig. 17. contact surfac non-planar quadrilater curv element scope paper. gener involv minim problem [43]. however, chen [6] propos averag normal relax contact criterion. 123 author' person copi comp. part. mech. tabl 5 contact elimin case contact point vector relev contact vector situat 1 situat 2 fig. 17 angl form vector vi pc edg connect node polygon 5.4 note type geometri industri applic us accur strategi model particl classi- cal spheric particles. popular on superquadr [39], level set function [1], cluster sphere [13]. choic model particl sphere cluster techniqu provid solut good ratio accuraci comput cost adapt perfectli present algorithm and, thus, make contact search fast paralleliz appli explain technique. 6 valid section, exampl carri test dif- ferent aspect algorithm performance. first, exampl carri test perform critic sit- uationswheremost literaturemethodswould fail.next, industri applic exampl serv test method term scalabl parallel computation. 6.1 benchmark critic situat follow test correspond practic situations, serv instead valid contact calcul procedure. benchmark carri hertzian contact law [5]. 6.1.1 facet, edg vertex contact benchmark repres sphere, low stiff order achiev larg indentation, contact differ boundari mesh triangles. case, sphere fall height (1 m) 123 author' person copi comp. part. mech. fig. 18 benchmark layout 0.0 0.5 1.0 1.5 2.0 500 0 500 1000 1500 2000 2500 0.0 0.5 1.0 1.5 2.0 0.0 0.2 0.4 0.6 0.8 1.0 1.2 1.4 (a) (b) fig. 19 result obtain benchmark tests. forc exert fe de. b posit centr vertic perpendicular contact entiti is, respectively, facet, edg vertex. figur 18 show benchmark displai tabl 6 simul parameters. damp applied, energi conserv ball return initi posit rebound. sphere expect follow vertic tra- jectori ident result cases. graph fig. 19a show that, indent greater 30 % radiu lead multipl contact kind entities, forc appli vertic direct (y direction). this, conclud contact elimin procedur perform correctly. result exactli differ- ent scenario (facet, edg vertex contact). verifi energi gain dissip rebound maximum height observ fig. 19b. good test method work properli normal contact types: facet, edg vertex independ mesh indent achiev (alwai lower radius). 6.1.2 continu contact essenti ensur continu contact forc non-smooth contact region fe element transitions. follow example, continu normal forc presented. set boundari contact transfer surfac triangular element (facet contact) edg vertices. frictionless rotation-fre sphere trajectori path enforc (a shown fig. 20) indent constant (0.01m contact facet f 1 f 2 orwith edg e). simul paramet on present tabl 6. continu met, forc modul same. direct contact forc evolv vertic (normal f 1) horizont (normal f 2) smooth transition. achiev fact algorithm give higher hierarchi edg vector calcul join contact point centr sphere (fig. 21). result discontinu aris contact evolv facet contact edg contact vice versa, contact forc constant simula- tion equal 76.063 n, expected. continu normal forc concav transit tangenti forc differ element fulli assured. error small practic situations, consid import quantifi awar of. report sect. 7. 123 author' person copi comp. part. mech. fig. 20 simul scheme tabl 6 simul paramet materi properti radiu (m) 0.3 densiti (kg/m3) 100 friction coeffici de/f 0.3 young modulu (pa) 105 poisson ratio 0.2 calcul paramet initi veloc (de) (m/s) [0.0, 0.0, 0.0] graviti (m/s2) [0.0,9.81, 0.0] time step (s) 105 neighbour search frequenc 5 6.1.3 multipl contact goal test check method determin correctli case sphere contact ele- ment. set exampl consist sphere fall planewith differ shape holes, shown fig. 22a. simul paramet present tabl 7. example, damp applied. graph fig. 23 show velocitymodulu de involv simulation. seen sphere veloc 2.5 s simul close 0, expect final equilibrium posit reach sphere involv simultan contact vertic edges. 6.1.4 mesh independ follow exampl simul ball slide plane friction. sphere set vertic equilibrium plane horizont veloc imposed. sphere start sliding, angular veloc progres- sive increas constant valu slide event finish roll occur thereafter. schemat depict fig. 24a. analyt solut calcul valid simul equilibrium equat kinemat com- patibl condit basic coulomb friction law. moment inertia sphere = 2/5mr2. follow obtain combin slide rotat phase: v(t) = v0 gt (33) x(t) = v0t 1/2gt2 (34) (t) = rmg t = 5g 2r t (35) equat 35 come integr angular accelera- tion case zero initi angular velocity. constant roll event occur tangenti veloc v match angular veloc time radiu r: v = r tc = 2v0 7g (36) time t > tc, equat motion follows: v(t) = 5 7 v0 (37) x(t) = 12v 2 0 49g + 5 7 v0(t t0) (38) (t) = 5v0 7r (39) fig. 21 forc appli surfac edg sphere differ instant simulation. contact f 1. b contact e. c contact e. d contact f 2 123 author' person copi comp. part. mech. fig. 22 multipl contact test geometri tabl 7 simul paramet materi properti radiu (m) 0.3 densiti (kg/m3) 100 friction coeffici de/f 0.3 young modulu (pa) 106 poisson ratio 0.2 restitut coeffici 0.4 calcul paramet initi veloc (de) (m/s) [0.0, 0.0, 0.0] graviti (m/s2) [0.0,9.81, 0.0] time step (s) 105 neighbour search frequenc 1 set simul shown fig. 24b. case compared, involv slide plane dis- cretiz singl quadrilater element, case plane discret 80 triangular elements. paramet simul previou example, detail tabl 7. sphere given initi veloc 5m/ x direction. simul 0.0 0.5 1.0 1.5 2.0 2.5 0.0 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 fig. 23 de veloc run 1 s. simul result plot analyt solut fig. 25. numer solut includ plot fig. 25 differ mesh turn negligible. tabl 8 valu displac (x), veloc (v) angular veloc () end simu- lation (t = 1) presented. exampl show result practi- calli independ boundari mesh selected. side, simulationperformed, numer result agre perfectli theoret solution. case notic discontinu normal tan- gential contact forc transit betweenboundaryfes. sect. 7 note issu given too. 6.2 algorithm behaviour industri exampl order evalu overal method behaviour, sim- ulat particl mixer carri out. model repres rotari mixer contact occur de differ fe entiti (facets, edg vertices) boundari mesh compos triangular quadrilat- eral elements. additionally, simul evalu parallel behaviour. 6.2.1 descript simul figur 26 27 geometri initi arrange- ment simul compos 29559 des, 848 triangular fe 1600 quadrilater fes. tabl 9 present materi properti simul paramet used. calcul carri assum hertzian contact law [5]. integr equat motion classic central differ integr scheme [30]. additionally, test, roll resistancemo ad tomodel particl irreg- 123 author' person copi comp. part. mech. fig. 24 benchmark slide sphere plane friction. problem definition. b simul set (a) (b) 0.0 0.2 0.4 0.6 0.8 1.0 time (s) 0 1 2 3 4 5 d p l. (m ) v el . (m /s ) displ.num. vel.num. ang. vel. num. solut 14 12 10 8 6 4 2 0 n g. v el . (r d /s ) fig. 25 numer result displac veloc x angular veloc z compar theoret solut tabl 8 result end simul quadrilater triangl analyt x (m) 3.9021 3.9022 3.9182 error (%) 0.4102 0.4071 v (m/s) 3.5410 3.5410 3.5714 error (%) 0.8528 0.8528 (rad/s) 11.9788 11.9788 11.9048 error (%) 0.0062 0.0062 fig. 26 geometri horizont rotari mixer. distanc express meter ularities. case, improv classic roll resist model present wensrich katterfeld [40] developed, order avoid instabl fig. 27 mesh horizont rotari mixer simulation. de initi arrangement. b triangular fes. c quadrilater fe tabl 9 simul paramet materi properti radiu (m) 0.0035 densiti (kg/m3) 1000 friction coeffici de/d 0.5 friction coeffici de/f 0.75 young modulu (pa) 107 poisson ratio 0.2 roll friction coeffici 0.001 restitut coeffici 0.4 calcul paramet rotat veloc (rad/s) 18.85 time step (s) 5 105 neighbour search frequenc 1 simul time (s) 20.0 appear rel 0. complet new approach [19]. 6.2.2 simul result code perform serial dempack code test intel xeon e5-2670. took 29 h, 20 min 30 s serial run 20 s simul 123 author' person copi comp. part. mech. tabl 10 serial perform code industri exampl split fast + h2 direct h2 method de/d contact search (%) 53.9 51.4 de/f contact search (%) 20.7 23.9 creat bin (%) 4.5 4.2 fast intersect (%) 15.1 h2 method (%) 1.2 19.7 total time (s) 105,630 111,041 fig. 28 sphere arrang 20 s comprehend 400,000 time steps. result perform code present tabl 10. specif case, involv approxim 30k 2.5k fe, seen calcul effort de/f contact search repres 20% total cpu time.th result show split thefast intersect h2 method code turn 5% faster signific improv case, contact de/de. seen cost h2 method low (onli 1%) split applied. figur 28 displai arrang sphere 20 s. mixer simul consid great contact (de/d de/fe) involves. 6.2.3 code perform parallel graph fig. 29 code perform openmp parallel comput strategy. base result conclud that, despit speedup far ideal linear case, fact contact check algorithm total parallel help performance. 6.2.4 perform search algorithm analysi perform industri exam- ple order detect fe treat 8421 0.0 0.2 0.4 0.6 0.8 1.0 t/ t 1 8421 1 2 3 4 5 6 7 8 fig. 29 scalabl test result stage introduc fig. 4 sect. 3 local resolut present split fast intersect test (sect. 4) doubl hierarchi method (sect. 5). fig. 30 show result 0.5 s simul correspond 1.5 turn helices. cumul count follow variabl represented: fe potential: number time fast intersect test (sect. 4) call (number fe potenti neigh- bour checked) averag number particles. fe contact: averag number fe particl yield posit result (have intersectionwith sphere) fast intersect test. entitywith valid contact: averag number relev entiti particl determin h2 method. figur 30 show number potenti neighbour treat larg compar fe actual contact, ratio 30:1. fact improv per- formanc shown tabl 10 conclud good choic perform split addition bring modular code. 123 author' person copi comp. part. mech. 7 method limit 7.1 normal forc concav transit limit method common revis penalty-bas contact algorithm occur contact slightli non-convex surface. error introduc method analys quantifi normal forc case spheric concav transitions. penalti method introduc indent account local elast deform discret ele- ment contact event allow imposit contact condit weak form. us rigid geome- tri non-phys indent introduc error contact detection. constitut law hertz-mindlin present limit term small deform order work fine. rule apply, however, non-smooth region basic assumpt met contact detect error arise. sphere move horizont plane reach transit plane b form acut angl plane (fig. 31a). situation, region defin current contact plane plane n form common edg normal second plane nb. sphere centr 0.0 0.1 0.2 0.3 0.4 0.5 time (s) 100 101 102 103 104 105 ve ra ge u n ts p er p rt ic le fe potenti fe contact entiti valid contact fig. 30 count fe check differ stage (a) (b) fig. 31 error emerg concav transitions. error region. b con- tact 2 plane region discontinu forc occur. contact plane b detect centr c normal project plane b form tangenti contact. figur 31b show new contact detected, indent t exist and, therefore, new contact forc valu introduc discontinuity. geometr relations, error quanti- fi ratio absolut valu new forc fnb absolut valu current forc fna. valu express function chang angl indent ratio t/ rel sphere radiu r: = fnbfna = { t/ linear case (t/)3/2 hertzian case (40) geometr relationship set = /r rel indent measure, follow express obtained: t = r(cos() + 1) cos() (41) final follow express found: = cos()+1 cos() linear case( cos()+1 cos() )3/2 hertzian case (42) solut plot case (linear hertzian) differ chang angl differ indent ratios. figur 32 show indent 1%of radiu ( = 0.01) small chang angl 10 error produced, however, indent 3.3% error measur reach valu = 0.41 hertzian case ( = 0.55 linear case) turn sudden 0 10 20 30 40 50 60 70 80 90 chang angl (degrees) 0.0 0.2 0.4 0.6 0.8 1.0 e rr m ea su = 0.001 = 0.01 = 0.033 = 0.1 = 0.25 = 0.5 = 0.75 = 0.98 hertzian linear fig. 32 valu measur error function chang angl indent ratio 123 author' person copi comp. part. mech. forc magnitud fnb = 0.41fna direct nb. error tend 0 angl chang tend 90 occur obtus angles. hand, lower chang angl is, greater error is. bound 100% error = 1.0 extrem case coplanar transition. luckili frequent case consid distanc hierarchi (sect. 5.2) toler detect coplanar cases. note error depend geometr condit indent ratio rel sphere boundari fe mesh quality, depend solv doubl hierarchi method. 7.2 tangenti forc element inmanydemcodes, tangenti forc appli bymean increment scheme requir track forc particl neighbour. prob- lem aris particl move element histor tangenti forc reset zero con- tact determin new element. common review contact algorithm introduction. solv complex data structure, error introduc low practic situations. prove sect. 6 case mesh indepen- dence,which combin tangenti slide rolling, show neglig error. case larger error on slide tangenti forc kept maximum (gener coulomb friction value) higher roll event. situat error measur term miss work force-displac diagram shown fig. 33 correspond linear contact law [7,33] normal tangenti directions. average, particl linear stiff valu kn kt slide transit finit element character- fig. 33 schemat force-displac diagram discontinu introduc element transit slide event linear contact law istic length l rel indent follow error work tangenti force: et = error area total area = 1/2(kn) 2/kt knl 1/2(kn)2/kt = kn/kt 2l kn/kt 2 kn kt l (43) example, linear model shfer [33] suggest ratio kn/kt 7/2, particle-structur friction coeffici = 0.3, error integr tangenti forc displac valu et = 0.525 /l . mean larg indent 10% characterist size l fe yield error approxim 5%. 8 conclud remark new contact detect algorithm, doubl hierarchi method, present paper. themethod, accurate, robust efficient, develop perform extrem cases, de fe size dif- ferent rel indent consider high. method differ- ent type contact fe provid high level accuraci term contact forc continu fe transit allow multi-contact scenario high mesh indepen- denc low effort. design easi implement adapt exist dem code. addition, algorithm conceiv fulli parallelizable, essenti order allow calcul real case great discret finit elements. contact calcul split stages: global neigh- bour search local contact resolution. furthermore, local contact resolut level split phases. one, fast intersect test, aim determin fe contact de, discard effici fe contact de. fe contact known, second phase, doubl hierarchy, take place order accur calcul contact characterist remov invalid contacts. accuraci robust propos algorithm verifiedwith differ benchmark tests. test develop order evalu contact elimin energi conserv (see fig. 18) situat involv possiblemast contact entity: facet, edg vertex.addit test showhow code behav multi-contact (see fig. 22a), contact continu (see fig. 20) mesh independ (see fig. 24). industri exampl (sect. 6.2) present comput efficiency. share memori parallel perform limit serial part 123 author' person copi comp. part. mech. code. have possibl parallel import code, contact detection, allow comput speed scale up. result prove split local resolut fast intersect doubl hierarchi method greatli improv overal performance. highlight limit us method clearli defin analys paper. first, geometri contact element (triangle, quadrilateral, polygon) convex detail sect. 5.3. second place highlight method best suit predict contact forc calcul forc fe cer- tain condit detail sect. 2.2.2. final appoint method work perfectli normal forc calcul surfac present convex transi- tion larg indent (see exampl sect. 6.1). present discontinu normal con- tact forces, however, deal concav transit surfac form small angl indent small. also, slide situat differ element non-smal indentations, error continu tangenti contact forc arise. error introduc cases, ismost time neglig practic cases, quantifi sect. 7. notwithstand limitations, propos algo- rithm wide rang de/f simulations. acknowledg work carri financi support spanish mineco balam project (bia2012- 39172). refer 1. andrad je,limkw,avilacf,vlahin (2012)granular element method comput particl mechanics. comput method appl 241244:262274 2. bonet j, perair j (1991) altern digit tree (adt) algorithm 3d geometr search intersect problems. int j numer method eng 31(1):117 3. boon cw, houlsbi gt, utili s (2012) new algorithm contact detect convex polygon polyhedr particl discret element method. comput geotech 44:7382 4. boon cw, houlsbi gt, utili s (2013) new contact detect algorithm three-dimension non-spher particles. powder technol 248:94102 5. casa g, mukherje d, celigueta ma, zohdi ti, onat e (2015) modular, partitioned, discret element framework industri grain distribut system rotat machinery. comput mech. doi:10.1007/s40571-015-0089-9 6. chen h, zhang yx, zang m, hazel pj (2015) accur robust contact detect algorithm particle-solid interact combin finite-discret element analysis. int j numer method eng 103(8):598624 7. cundal p, stracko (1979)a discret numericalmodel granular assemblies. gotechniqu 29(1):4765 8. dadvand p, rossi r, oat e (2010) object-ori environ- ment develop finit element code multi-disciplinari applications. arch comput method eng 17(3):253297 9. dang hk, meguid ma (2013) effici finite-discret element method quasi-stat nonlinear soil-structur interact prob- lems. int j numer anal method geomech 37(2):130149 10. eli j (2014) simul railwai ballast crushabl poly- hedral particles. powder technol 264:458465 11. ericson c (2004) real-tim collis detect (themorgan kauf- mann seri interact 3d technology). morgan kaufmann publish inc., san francisco 12. feng yt, owen drj (2002) augment spatial digit tree algorithm contact detect comput mechanics. int j numer method eng 55(2):159176 13. garcia x, xiang j, latham jp, harrison jp (2009) cluster overlap sphere algorithm repres real particl discret element modelling. gotechniqu 59(9):779784 14. han k, peric d, crook a, owen d (2000a) combin finite/discret element simul shot peen processespart i: studi 2d interact laws. eng comput 17(5):593620 15. han k, peric d, owen d, yu j (2000b) combin finite/discret element simul shot peen processespart ii: 3d interac- tion laws. eng comput 17(6):680702 16. han k, feng y, owen d (2007) perform comparison tree- base cell-bas contact detect algorithms. eng comput 24(2):165181 17. horner da, peter jf, carrillo (2001) larg scale discret ele- ment model vehicle-soil interaction. j eng mech-asc 127(10):10271032 18. hu l, hu g, fang z, zhang y (2013) new algorithm contact detect spheric particl triangul mesh bound- ari discret element method simulations. int j numer method eng 94(8):787804 19. irazb gonzlez j (2015) numer model railwai ballast discret element method. master thesi 20. karabassi ea, papaioannoug,theohari t,boehma (1999) inter- section test collis detect particl systems. jgraphtool 4(1):2537 21. kodamm, bharadwaj r, curti j, hancock b, wassgren c (2009) forc model consider glued-spher discret element method simulations. chem eng sci 64(15):34663475 22. kremmer m, favier jf (2001) method repres bound- ari discret element modellingpart ii: kinematics. int j numer method eng 51(12):14231436 23. meyer m, barr a, lee h, desbrun m (2002) gener barycen- tric coordin irregular polygons. j graph tool 7(1):1322 24. michael m, vogel f, peter b (2015) dem-fem coupl simula- tion interact tire tread granular terrain. comput method appl mech eng 289:227248 25. mindlin r (1949) complianc elast bodi contact. j appl mech 16:259268 26. munjiza (2004) combin finite-discret element method, 1st edn. wiley, hoboken 27. munjiza a, andrewskrf (1998) nb contact detect algorithm bodi similar size. int j numermethod eng 43(1):131149 28. nakashima h, oida (2004) algorithm implement soiltir contact analysi code base dynam fede method. j terramech 41(23):127137, 14th intern confer istv 29. nezami eg, hashash yma, zhao d, ghaboussi j (2004) fast contact detect algorithm 3-d discret elementmethod. com- geotech 31(7):575587 30. oat e, rojek j (2004) combin discret element finit element method analysi geomechan problems. comput method appl mech eng 193:30873128 123 author' person copi comp. part. mech. 31. oat e, zrate f,miquel j, santasusanam,celiguetama,arrufat f, gandikota r, valiullin k, ring l (2015) local constitut model discret elementmethod.appl geomateri concrete. comput mech 2(2):139160 32. renzo ad,maio fpd (2004) comparison contact-forc model simul collis dem-bas granular flow codes. chem eng sci 59(3):525541 33. shfer j, dippel s, wolf d (1996) forc scheme simul granular materials. journal physiqu 6(1):522 34. su j, gu z, xu xy (2011) discret element simul particl flow arbitrarili complex geometries. chem eng sci 66(23):60696088 35. su j,guz,zhangm,xuxy(2014)an improvedvers ofrigid discret element simul particl flow arbitrarili complex geometries. powder technol 253:393405 36. sukumar n, tabarraei (2004) conform polygon finit ele- ments. int j numer method eng 61(12):20452066 37. thornton c, cummin sj, cleari pw (2011) investig compar behaviour altern contact forc model dur- ing elast collisions. powder technol 210(3):189197 38. wang sp, nakamachi e (1997) inside-outsid contact search algorithm finit element analysis. int j numer method eng 40(19):36653685 39. wellmann c (2011) two-scal model granular materi coupl de-f appoach. ph.d. thesis, institut fr kontinu- umsmechanik, leibniz universitt hannov 40. wensrich cm, katterfeld (2012) roll friction techniqu model particl shape dem. powder technol 217:409 417 41. william jr, oconnor r (1999) discret element simul contact problem. arch comput method eng 6(4):279304 42. william jr, perkin e, cook b (2004) contact algorithm partit n arbitrari size objects. eng comput 21(2/3/4):235 248 43. wrigger p (2002) comput contact mechanics. wiley, chichest 44. zang m, gao w, lei z (2011) contact algorithm 3d dis- crete finit element contact problem base penalti function method. comput mech 48:541550 45. zhongz (1993) finit element procedur contact-impact prob- lems. oxford univers press, new york 46. zienkiewicz o, taylor r, fox d (2014) finit element method solid structur mechanics, 7th edn. butterworth- heinemann, oxford 123 author' person copi doubl hierarchi method. parallel 3d contact method interact spheric particl rigid fe boundari dem abstract 1 introduct 2 dem formul 2.1 basic formul 2.2 de/f contact 2.2.1 non-smooth contact 2.2.2 extens deform fe 3 de/f contact search algorithm 3.1 global search algorithm 3.2 local resolut 4 fast intersect test 4.1 intersect test plane contain fe 4.2 inside-outsid test 4.3 intersect test edg 4.4 intersect test vertex 4.5 fast intersect test scheme 5 doubl hierarchi (h2) method 5.1 contact type hierarchi 5.1.1 facet level 5.1.2 edg level 5.1.3 vertex level 5.1.4 contact type hierarchi scheme 5.2 distanc hierarchi 5.3 note type fe geometri 5.4 note type geometri 6 valid 6.1 benchmark critic situat 6.1.1 facet, edg vertex contact 6.1.2 continu contact 6.1.3 multipl contact 6.1.4 mesh independ 6.2 algorithm behaviour industri exampl 6.2.1 descript simul 6.2.2 simul result code perform serial 6.2.3 code perform parallel 6.2.4 perform search algorithm 7 method limit 7.1 normal forc concav transit 7.2 tangenti forc element 8 conclud remark acknowledg refer