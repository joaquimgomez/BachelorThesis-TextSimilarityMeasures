simp-all: gener simp method base topolog deriv concept received: 15 march 2019 revised: 21 2019 accepted: 4 june 2019 doi: 10.1002/nme.6140 r e s e r c h r t c l e simp-all: gener simp method base topolog deriv concept a. ferrer1,2 1centr mathmatiqu appliques, cole polytechnique, universit paris-saclay, palaiseau, franc 2centr internacion mtode numric en enginyeria (cimne), campu nord upc, barcelona, spain correspond a. ferrer, centr mathmatiqu appliques, cole polytechnique, universit paris-saclay, 91128 palaiseau, france; centr internacion mtode numric en enginyeria (cimne), campu nord upc, edifici c-1, c/jordi girona 1-3, 08034 barcelona, spain. email: fund inform european union' horizon 2020 research innov programme, grant/award number: 712949; agenc busi competit govern catalonia summari topolog optim emerg year promis research field wide rang applications. success approaches, simp method, base regular problem propos penaliza- tion interpol function. work, propos altern interpol function, simp-al method base topolog deriv con- cept. first, strong relat plane linear elast hashin-shtrikman (h-s) bound topolog derivative, provid new interpret one. then, simp-al interpo- lation remain h- bound regardless materi interpolated. result allow interpret intermedi valu real microstructures. finally, verifi numer result con- venienc propos simp-al interpol obtain auto-pen optim design wider rang cases. matlab code simp-al interpol function provided. keyword hashin-shtrikman bounds, simp, topolog derivative, topolog optim 1 introduct recent years, topolog optim research field itself, arous scientif commun provid success solut industri problems.1 traditionally, topolog optim seek design light-weight structur compon lose stiff capabilities. years, address field applic equal success. propose, approach emerg decades. initially, topolog optim successfulli address regular techniques. simp method repres probabl celebr strategy. characterist function, usual weak (white) stiff (black) subdomains, regular allow intermedi values, words, allow presenc grai areas. frequently, regular represent characterist commonli name densiti function. usually, challeng character materi properti intermedi valu densiti function (grai areas). character commonli describ interpol function. refer work bends sigmund,2 simp method propos polynomi interpol function that, cases, li insid hashin-shtrikman (h-s) bounds. lead grai area interpret microstructures. additionally, depend natur materials, simp method propos weak interpol penalization, consequently, larg grai area appear. open access articl term creativ common attribut license, permit use, distribution, reproduct medium, provid origin work properli cited. 2019 authors. intern journal numer method engin publish john wilei & sons, ltd. int j numer method eng. 2019;120:361381. wileyonlinelibrary.com/journal/nm 361 362 ferrer sense, novel project method enabl promis black white topologies.3 however, grai area appear project method, final topolog significantli suboptim influenc materi properti provid correspond interpolation. circumv limit order fulfil h- bounds, interpol function proposed. exampl work stolp svanberg4 dzierzanowski.5 alternatively, concept shape derivative, shape optim establish refer strategi solv topolog optim problems. usually, domain describ level-set function that, turn, advect shape deriv express object function. case, shape deriv plai role veloc field hamilton-jacobi equation.6 algorithm requir consid initi holes, increas merged, result new topolog iterations, optim shape present intermedi valu clearli defin boundary. likewise, topolog deriv address topolog optim intent consid intermedi values. concept base studi sensit function circular (or ellipsoidal) inclus weak materi insert stiff materi (or vice-versa). asymptot expans solv exterior problem, obtain topolog deriv close formula certainli measur adequaci insert certain point weak/stiff inclusion. valu concept frequent exploit level-set algorithms. pioneer work amstutz andr7 clear example. approach work allair et al8 yamada et al.9 additionally, literatur discret evolutionari algorithms, like beso,10 competit alter- nativ solv problem. high effici clear larg problems, signific progress achiev increas avail comput power. years, numer techniqu decreas compu- tation cost topolog optim problem developed, like adapt mesh refinement11 polytree-bas adapt polygon finit element method.12 although, sight, describ approach different, connect observ work amstutz13 case topolog deriv simp method approach, especi poisson ratio stiff materi 13. present work follow gener result work. main result present work connect topolog deriv h- bounds. result allow new physic interpret topolog deriv concept. then, base topolog derivative, propos simp-al interpolation. apart free heurist parameters, show, second main result work, remain h- bound regardless stiff weak materi properti want interpolate. result provid physic interpret term microstructur simp-al interpolation. note propos interpol strategi conveni characterist function appear insid differenti operator. case, interpol needed, example, work s et al.14 valid results, differ case present compar simp-al simp interpol function relat h- bounds. finally, numer exampl comput influenc conveni interpol function optim topologies. additionally, matlab code simp-al interpol provided. work organ follows. section 2 present bimateri topolog optim problem. section 3 introduc concept topolog deriv present topolog deriv isotrop materi term shear bulk modulus. h- bound briefli present section 4 connect topolog derivative. special kind ration function work defin section 5, simp-al interpol function present section 6. section 7 includ comparison simp simp-al relat h- bounds. additionally, numer exampl comput observ influenc interpol function optim topologies. present work conclud section 8. 2 topolog optim formul 2.1 exact topolog optim problem let fix domain split 1 0 regularity, fulfil 1 0 = 1 0 = . let boundari defin = split d n let space , , defin = { h1() |d = u0} , = { h1() |d = 0} , = l(, {0, 1}). (1) ferrer 363 then, let defin characterist function fourth-ord tensor c() (x) = { 0 x 0 1 x 1 c() = (1 )c0 + c1. (2) constitut tensor c0 c1 plane stress linear elast defin c1 = 21i + (1 1)i c0 = 20i + (0 0)i i, (3) repres fourth- second-ord ident tensor and1, 1 and0, 0 bulk shear modulu materi 1 0, respectively. introduc bilinear linear form linear elast problem a(,u, v) = su c() su l(v) = n t v, (4) exact topolog optim problem defin follows: u min. ,u j(,u) = l(u) s.t. v a(,u, v) = l(v) v , (5) where, case, cost j(,u) stand complianc function. 2.2 relax topolog optim problem difficulti solv exact problem usual circumv propos relax version it, replac characterist function density-lik function (x) [0, 1], which, contrast characterist function, intermedi values. thus, exact topolog optim problem rewritten follow regular topolog optim problem: = l(, [0, 1]) u min. ,u j(,u) = l(u) s.t. v a(,u, v) = l(v) v , (6) bilinear linear form defin a(,u, v) = su c() su l(v) = n t v. (7) case, constitut tensor take follow form: c() = 2()i + (() ())i i, (8) () c([0, 1], [0, 1]) () c ([0, 1], [0, 1]) interpol function proposed. comput complianc gradient. let complianc function l(u) defin (7) let u solut elast problem defin (6), gradient complianc take follow form: g() = su c() su, (9) c() deriv constitut tensor defin (8). result, let defin implicit function f() f() = a(,u(), v) l(v) = 0 v , (10) 364 ferrer let comput differential. ellipt arguments,15 state v provid coerciv constitut tensor, exist uniqu u solv a(,u(), v) = l(v). thus, defin densiti variat , state f( + ) = f() = 0, consequently, f( + ) f() = a( + ,u( + ), v) a(,u(), v) = a( + ,u( + ), v) a( + ,u(), v) + a( + ,u(), v) a(,u(), v) = a( + ,u() + du(), v) a( + ,u(), v) + da(,u(), v) + o(||||2) = a( + ,du(), v) + da(,u(), v) + o(||||2) = a(,du(), v) + da(,u(), v) + o(||||2) = 0, (11) da(,u(), v) frchet deriv respect argument bilinear form a(,u, v) du() frchet deriv u . then, differenti complianc comput l(u( + )) l(u()) = a(,u(),du()) + o(||||2) = a(,du(),u()) + o(||||2) = da(,u(), v) + o(||||2) = [a( + ,u(), v) a(,u(), v)] + o(||||2) = su (c( + ) c()) su + o(||||2) = su (c()) su + o(||||2) = dl() + o(||||2), (12) symmetr behavior bilinear form result (11). note that, neglect higher-ord terms, suppos remind o(||||2) small enough. proof end relat gradient g() complianc frchet deriv dl(u) riesz represent theorem, ie, dl() = g. 3 topolog deriv given domain (unperturbed) r2, let insert certain point x small circular inclus b radiu > 0. new (perturbed) domain (see figur 1). definit 1. let j() j() valu function unperturb perturb domain. certain posit function f() f() 0 0, typically, f() = 2, defin topolog deriv j() follow limit: gt(x) = lim 0+ j() j() () . (13) remark 1. note express (13) defined, need ask function j() admit follow asymptot expansion: j() j() = ()gt(x) + o( ()). (14) definit 2. given young' modulu poisson' ratio matrix b inclus b, repres em, m ei, respectively, defin fourth-ord polar tensor p p = p1i + p2i i, (15) figur 1 topolog deriv concept ferrer 365 paramet p1 p2 follow values: p1 = 1 + 1 (1 + )(1 ) p2 = 1 2 ( ) + 1 [( 23) + 12] + 2 , (16) coeffici , , , 1, 2, 3 form = 1 + m 1 m , = 3 m 1 + m , = ei em , (17) 1 = 1 + 1 + m , 2 = 1 1 m , 3 = i(3m 4) + 1 m(3m 4) + 1 . (18) proposit 1. let u solut elast problem defin (6), let complianc l(u) defin (7), let polar tensor p express definit 1, topolog deriv point x, defin definit 1, follows: gt(x) = (x) p su(x), (19) s symmetr gradient oper = cm su stress cm constitut tensor matrix domain. proof. result trivial obtain propos asymptot expans solut topolog- ical perturb problem analyt solv associ exterior problem. work novotni sokoowski16 details. result valu poisson ratio, work giusti et al.17 easier comparison h- bounds, seek rewrit topolog deriv term shear bulk modulus. topolog deriv term shear bulk modulus. let defin paramet m = mm 2m+m m = m term shear bulk modulu matrix m, insert i, let defin shear bulk polar paramet q q q = q(m, , m), q = q(m, , m) q(t1, t2, t3) = (t1 + t3) t1(t2 + t3) . (20) then, topolog deriv x written term shear bulk modulu (of matrix inclusion) follows: gt(x) = su(x) dc su(x) dc = 2di + [d d]i i, (21) paramet d d d = m(i m)q d = m(i m)q. (22) obtain expression, let shear bulk polar coeffici q q comput q = p (m i) q = p (m i) p = p1 p = 2p1 + p2. (23) insert lame paramet relat plane stress e = 4 + , = + coeffici defin (17) (18) replac (16), write shear bulk polar coeffici follows: q = ( m + mm 2m+m ) m ( + mm 2m+m ) q = (m + m) m(i + m) , (24) 366 ferrer precis q(m, , m) q(m, , m ). then, replac relat (23) (15), directli rewrit polar tensor p = pi+ 1 2 (p p)i i. proof end replac relat constitut tensor matrix cm = 2mi + (m m)i topolog deriv express (19). remark 2. clearli identifi differ cases. (i) stiffer inclus insertion: defin case sai that, point x 0 parametersm = 0, m = 0, add inclus paramet = 1 = 1. then, topolog deriv gt0 scenario take point x follow form: gt0 (x) = su(x) dc0 su(x), (25) dc0 = 20(1 0)q0i + [ 0(1 0)q0 0(1 0)q0 ] i, (26) q0 = q(0, 1, 0), q0 = q(0, 1, 0 ), 0 = 00 20+0 , 0 = 0 posit values. (ii) weaker inclus insertion: similarly, defin opposit case identifi point x 1 matrix paramet asm = 1, m = 1 paramet inclus asi = 0 = 0. then, topolog deriv gt1 take point x follow form: gt1 (x) = su(x) dc1 su(x), (27) dc1 = 21(0 1)q1i + [ 1(0 1)q1 1(0 1)q1 ] i, (28) q1 = q(1, 0, 1), q1 = q(1, 0, 1 ), 1 = 11 21+1 1 = 1 posit values. remark 3. follow semin work amstutz,13 think propos interpol scheme gradient 1 0 coincid precis topolog derivative. distinguish scenarios. (i) stiffer inclus insertion: = 2 b(x, ) zero otherwise, b(x, ) repres small circular ball center x radiu . mean that, replac small circular domain matrix small circular inclusion, add small density. then, want taylor' expans (12) match asymptot expans (14), defin interpol that, x 0 ( = 0), g(0) = gt0(x) = c (0) = dc0 = { (0) = 0(1 0)q0 (0) = 0(1 0)q0, (29) (ii) weaker inclus insertion: case, = 2 b(x, ) zero otherwise. mean that, replac small circular domain matrix small circular inclusion, subtract small density. similarly, match expansions, defin interpol that, x 1 ( = 1), g(1) = gt1(x) = c (1) = dc1 = { (1) = 1(1 0)q1 (1) = 1(1 0)q1. (30) 4 connect topolog deriv hashin-shtrikman bound h- bounds. let suppos composit materi shear bulk constitut properti h h com- pose two-phas materi fraction volum [0, 1]. let assum shear bulk modulu constitu composit 0 0 1 1 satisfi 1 > 0. then, shear bulk modulu ferrer 367 composit materi h h upper lower bound regardless arrang phases. addition, bounds, commonli call isotrop h- bounds, written, case shear modulus, lb() = 0(1 ) + 1 (1 )(1 0)2 0 + 1(1 ) + 00 20+0 ub() = 0(1 ) + 1 (1 )(1 0)2 0 + 1(1 ) + 11 21+1 (31) similarli bulk modulu case lb() = 0(1 ) + 1 (1 )(1 0)2 0 + 1(1 ) + 0 ub() = 0(1 ) + 1 (1 )(1 0)2 0 + 1(1 ) + 1 . (32) bound develop work hashin shtrikman.18 refer book bends sigmund19 allaire.20 remark 4. note bound express follow gener form (gener h- bounds): hs() = 0(1 ) + 1 (1 )(1 0)2 0 + 1(1 ) + , (33) shear bulk h- bound recov choos valu describ follow table. remark 5. note deriv h- bound compon rewritten follows: { lb(0) = 0(1 0)q0 ub(1) = 1(1 0)q1 { lb(0) = 0(1 0)q0 ub(1) = 1(1 0)q1. (35) fact, wai rewrit h- bound deriv obtain simpl calculations. equat (33), gener h- bound rewritten hs() = 0dhs0 (1 ) + 1d hs 1 dhs0 (1 ) + d hs 1 dhs0 = (1 0)2 0 + , dhs1 = (1 0)2 1 + , (36) consequently, deriv gener h- bound express hs() = dhs0 d hs 1 (1 0)[ dhs0 (1 ) + d hs 1 ]2 . (37) 368 ferrer thus, valu compon hs(0) = dhs1 dhs0 (1 0) = 0 + 1 + (1 0) hs(1) = dhs0 dhs1 (1 0) = 1 + 0 + (1 0). (38) insert (34) (37) definit q (20), deriv h- bound shear modulu 0 ( = 0) 1 ( = 1) lb(0) = (0 + 0)(1 0) 1 + 0 = 0(0 1)q(0, 1, 0) = 0(1 0)q0 lb(1) = (1 + 0)(1 0) 0 + 0 = 1(1 0)q(1, 0, 0) ub(0) = (0 + 1)(1 0) 1 + 1 = 0(0 1)q(0, 1, 1) ub(1) = (1 + 1)(1 0) 0 + 1 = 1(1 0)q(1, 0, 1) = 1(1 0)q1. (39) similarly, deriv h- bound bulk modulu 0 ( = 0) 1 ( = 1) written lb(0) = (0 + 0)(1 0) 1 + 0 = 0(0 1)q(0, 1, 0) = 0(1 0)q0 lb(1) = (1 + 0)(1 0) 0 + 0 = 1(1 0)q(1, 0, 0) ub(0) = (0 + 1)(1 0) 1 + 1 = 0(0 1)q(0, 1, 1) ub(1) = (1 + 1)(1 0) 0 + 1 = 1(1 0)q(1, 0, 1) = 1(1 0)q1. (40) topolog deriv h- bound derivative. main result work. let defin materi compon shear bulk materi properti 0, 0 1, 1, respectively, let propos interpol function model mixtur mean fraction volum = [0, 1] close 0 coincid h- lower bound close 1 h- upper bound. then, gradient complianc coincid topolog deriv 0 1. result, equat (9), write gradient complianc (when isotrop lower upper bound interpol function) follows: glb(0) = su clb(0) su clb() = 2lb()i + [lb() lb()]i gub(1) = su cub(1) su cub() = 2ub()i + [ub() ub()]i i. (41) then, identifi coeffici (39) (40) precis on establish topolog deriv (29) (30), thus, { c lb(0) = dc0 x 0 c ub(1) = dc1 x 1. (42) finally, (42) equat (25), (27), (9), obtain { glb(0) = gt0(x) x 0 gub(1) = gt1(x) x 1. (43) ferrer 369 remark 6. result confirm materi neighborhood infinitesim inclus insert perturb domain comput topolog deriv understood homogen microstructur circular inclus (h- bound microstructures) fraction volum valu equival infinitesim inclus volume. that, order studi chang compliance, topolog deriv concept propos fact insert h- microstructures. 5 ration function definit 3. let introduc follow particular famili ration functions: = { c([0, 1], [0, 1]) | () = a2 + b + cd + 1 } , (44) a, b, c, d 1 scalar paramet determin fix valu deriv extremes, ie, (0) = 0, (0) = . 0, (1) = 1, (1) = . 1. (45) remark 7. note function equival follow expression: () = d01(1 ) + 0d0(1 ) + 1d1 d0(1 ) + d1 d01 = . 1 . 0 (1 0)2 d0 = . 1 (1 0) d1 = (1 0) . 0. (46) result easili obtain comput deriv ration function () = ad2 + 2a + (b cd) (d + 1)2 (47) impos condit (45). then, solv equat valu paramet a, b, c, d. = . 1 . 0 + (1 0)2 . 1 + (1 0) , b = 20(1 0) + . 1 . 0 1 . 0 . 10 . 1 + (1 0) , c = 0, d = 2(1 0) ( . 1 + . 0) . 1 + (1 0) . (48) remark 8. note that, definit above, follow properti holds: d01 = (f1 f0)(d0 d1) d0d1. remark 9. gener h- bound upper lower bound shear bulk modulu ration functions. easili seen impos d01 = 0, d0 = dhs0 = (1 0)2 0 + , d1 = dhs1 = (1 0)2 1 + (49) gener ration equat (46) obtain hs() = 0dhs0 (1 ) + 1d hs 1 dhs0 (1 ) + d hs 1 , (50) precis gener h- equat (33). 370 ferrer 6 simp-al method idea simp-al method precis propos interpol gradient complianc coincid topolog deriv 0 1. shown equat (43), case isotrop materials, equival impos deriv h- lower bound 0 deriv h- upper bound 1 shear bulk modulu interpolations. definit 4. simp-al function fsa() defin ration functionwith h- bound deriv (lower = 0 upper = 1) deriv paramet . 0 . 1. . 0 = hs(0) = 0 + 0 1 + 0 (1 0) . 1 = hs(1) = 1 + 1 0 + 1 (1 0). (51) remark 10. note shear bulk simp-al interpol function sa() sa() rewritten follow compact form: sa() = (1 0)(0 1)(1 ) + 0(1 + 0 )(1 ) + 1(0 + 1) (1 + 0)(1 ) + (0 + 1) sa() = (1 0)(0 1)(1 ) + 0(1 + 0)(1 ) + 1(0 + 1 ) (1 + 0)(1 ) + (0 + 1) , (52) 0 = 00 20+0 , 1 = 11 21+1 , 0 = 0, 1 = 1 previous defin (34). express easili obtain comput ration function paramet d01, d0, d1 defin equat (46). case simp-al interpolation, written dsa01 = . 1 . 0 (1 0) 2 = (1 0)2 ( 0 + 0 1 + 0 1 + 1 0 + 1 1 ) = (1 0)3(0 1) (0 + 1)(1 + 0) dsa0 = . 1 (1 0) = (1 0) ( 1 + 1 0 + 1 1 ) = (1 0)2 0 + 1 dsa1 = (1 0) . 0 = (1 0) ( 1 0 + 0 1 + 0 ) = (1 0)2 1 + 0 . (53) paramet let build simp-al gener interpol function f sa() sa() = dsa01 (1 ) + 0d sa 0 (1 ) + 1d sa 1 dsa0 (1 ) + d sa 1 = (1 0)(0 1)(1 ) + 0(1 + 0)(1 ) + 1(0 + 1) (1 + 0)(1 ) + (0 + 1) , (54) express obtain multipli upper lower part fraction (0+1)(1+0) (10)2 . finally, correspond f0, f1, 0, 1 paramet valu case shear bulk modulus. differ ration functions. let b ration function b(0) a(0), a(1) b(1), fa(0) = fb(0), fa(1) = fb(1) [0, 1]. then, a() b() [0, 1]. (55) ferrer 371 obtain result, step differ fa fb posit [0, 1]. (i) comput differ function. let comput function fc differ ration function fa fb. c() = a() b() = nc() dc() , (56) numer nc() written nc() = na()db() nb()da() { na() = da01(1 ) + 0d 0 (1 ) + 1d 1 nb() = db01(1 ) + 0d b 0 (1 ) + 1d b 1 (57) denomin dc() dc() = da()db() { da() = da0 (1 ) + d 1 db() = db0 (1 ) + d b 1. (58) (ii) comput differ function numerator. sake compactness, write numer matrix form nc() = [ (1 ) (1 ) ] da01 0da0 1da1 [ db0 d b 1 ] db01 0db0 1db1 [ da0 d 1 ] [ (1 ) ] = = [ (1 ) (1 ) ] da01d b 0 d b 01d 0 d 01d b 0 d b 01d 0 0da0 d b 0 0d b 0 d 0 0d 0 d b 1 0d b 0 d 1 1da1 d b 0 1d b 1 d 0 1d 01d b 0 1d b 01d 0 [ (1 ) ] = = [ (1 ) (1 ) ] [n11 n12 0 n22 n31 0 ][ (1 ) ] = = (1 )2n11 + (1 )2n12 + (1 )n22 + (1 )n31 = = (1 ) [ (1 )n11 + n12 + n22 + n31 ] = (1 ) [ (1 )(n11 + n22 + n31) + (n12 + n22 + n31) ] = (1 ) [ (1 )c0 + c1 ] , (59) c0 = n11 + n22 + n31 c1 = n12 + n22 + n31. note that, remark 8, n11, n12, n22, n31 written n11 = [ (1 0) ( da0 d 1 ) da0 d 1 ] db0 [ (1 0) ( db0 d b 1 ) db0 d b 1 ] da0 = = (1 0) ( db0 d 1 d b 1 d 0 ) + ( db1 d 1 ) da0 d b 0 n12 = [ (1 0) ( da0 d 1 ) da0 d 1 ] db1 [ (1 0) ( db0 d b 1 ) db0 d b 1 ] da1 = = (1 0) ( db0 d 1 d b 1 d 0 ) + ( db0 d 0 ) da1 d b 1 n22 = 0 ( db0 d 1 d b 1 d 0 ) n31 = 1 ( db0 d 1 d b 1 d 0 ) . (60) sum n22 n31 n22 + n31 = (1 0)(db0 d 1 d b 1 d 0 ). thus, write coeffici c0 c1 simplifi form c0 = ( db1 d 1 ) da0 d b 0 , c1 = ( db0 d 0 ) da1 d b 1 . (61) 372 ferrer (iii) comput differ function denominator. equat (58), simpli dc() = [ da0 (1 ) + d 1 ] [ db0 (1 ) + d b 1 ] . (62) (iv) posit differ possibl scenarios. idea analyz numer denomin differ sign possibl cases. first, note that, b , imag unbound (should [f0, f1]). thus, (62), follow scenario possible: d0, d1 > 0 d0, d1 < 0. (63) then, assumpt b(0) a(0) a(1) b(1) entail follow inequalities: b(0) a(0) = [ (1 0) db1 ] [ (1 0) da1 ] = da1 d b 1 0 = db1 da1 a(1) b(0) = [ (1 0) + da0 ] [ (1 0) + db0 ] = da0 d b 0 0 = db0 da0 . (64) view (64), summar possibl scenario follow table. table, case 1, 2, 3 possibl case make fa fb satisfi condit (63), consequently, rest case included. thus, guarante posit function fc reason follows: case 1: { c1, c0 > 0 = nc() > 0 da() > 0, db() > 0 = dc() > 0 = c() > 0 [0, 1] case 2: { c1, c0 < 0 = nc() < 0 da() < 0, db() > 0 = dc() < 0 = c() > 0 [0, 1] case 3: { c1, c0 > 0 = nc() > 0 da() > 0, db() < 0 = dc() > 0 = c() > 0 [0, 1]. (66) remark 11. base result shown above, obvious, h- upper bound h- lower bound. indeed, ub(0) lb(0) = 0 + 1 1 + 1 (1 0) 0 + 0 1 + 0 (1 0) = (1 0)2(1 0) (1 + 0)(1 + 0) 0 (67) lb(1) ub(1) = 1 + 0 0 + 0 (1 0) 1 + 1 0 + 1 (1 0) = (1 0)2(1 0) (0 + 0)(0 + 0) 0, (68) f1, f0 0 coerciv reason 1 0, 0 0 fulfil definit tabl (34) shear bulk modulus. thus, expected, h- bound shear bulk modulu h- lower bound. ub() lb() ub() lb() [0, 1]. (69) ferrer 373 simp-al h- bounds. point, simp-al interpol bulk shear modulu rest h- bounds, ub() sa() lb() ub() sa() lb() [0, 1]. (70) result certainli second main contribut work. it, verifi condit state equat (55). fact, h- upper bound simp-al interpol function fulfil construct ub(0) sa(0) = ub(0) lb(0) 0 sa(1) ub(1) = 0. (71) condit ub(0) lb(0) 0 shown (67). proce similarli h- lower bound. construction, sa(0) lb(0) = 0 sa(1) ub(1) = lb(1) ub(1) 0, (72) condit sa(1) ub(1) = lb(1) ub(1) 0 proven (67). 7 comparison simp simp-al celebr simp interpol function19 propos basic combin properti materi follows: c() = (1 p)c0 + pc1, (73) p penal parameter, frequent taken p = 3. 7.1 interpol function comparison seek section compar interpol follow differ situations. (a) material-void interpol regular topolog optimization, materi domain (base material) usual interpol void material, model extrem weak material. discuss work bends sigmund,2 standard simp propos isotrop interpolation, correspond intermedi valu (gray) interpret situat composit materi compos base materi void materi (the interpola- tion function remain outsid h- bounds). circumv limitation, adapt valu penal paramet (in term poisson ratio valu base materi 1) propos aforement work2 two-dimension plane stress case chang penal paramet follows: p p(1) = max ( 2 1 1 , 4 1 + 1 ) . (74) adapt penal parameter, simp method remain h- bound 0 0 0 0. following, interpol choic adapt simp. compar simp, simp-all, adapt simp, work, propos sequenc composit materi compos isotrop base materi properti (e1 = 1, 1 {13, 0,0.5,0.75,0.9}) void materi properti (e0 = 103, 0 = 13). note valu 0 e0 0 relevance. simp, adapt simp, simp-al interpol function depict figur 2 relat shear bulk h- bounds. view results, poisson ratio = 13, interpol behav similarly. fact, simp adapt simp coincid p(13) = 3. additionally, simp 374 ferrer 0 0.5 1 densiti 0 0.1 0.2 0.3 0.4 shear modulu 0 0.5 1 densiti 0 0.2 0.4 0.6 0.8 bulk modulu 0 0.5 1 densiti 0 2 4 6 shear modulu 0 0.5 1 densiti 0 0.5 1 1.5 2 2.5 shear modulu 0 0.5 1 densiti 0 0.2 0.4 0.6 0.8 1 shear modulu 0 0.5 1 densiti 0 0.1 0.2 0.3 bulk modulu 0 0.5 1 densiti 0 0.1 0.2 0.3 bulk modulu 0 0.5 1 densiti 0 0.1 0.2 0.3 0.4 bulk modulu 0 0.5 1 densiti 0 0.1 0.2 0.3 0.4 0.5 shear modulu 0 0.5 1 0 0.2 0.4 0.6 bulk modulu densiti figur 2 shear bulk interpol function comparison interpol void materi (e0 = 103, 0 = 13) sequenc stiff materi (e1 = 1 1 decreasing). contrast simp, simp adaptive, simp-al interpol remain h- bound simp-al interpol function h- bound deriv valu extrem valu (the lower bound = 0 upper bound = 1). coincid prove work bends sigmund19 obtain construction. case, interpol remain h- bounds. however, soon 1 decreases, simp, simp adaptive, simp-al start differing. fact, simp-al simp adapt interpol function, contrast simp, remain h- bound expected. additionally, note soon 1 decreases, eg, 1 = 0.9, p = 40 (case (e)), adapt simp interpolation, comparison simp-al interpolation, increas extrem markedli result possibl limit solv topolog optim problems. (b) bimateri interpol gener case, weak materi necessari stiff base material, topolog optim problem fact bimateri optim problem. aim decid appro- priat us materi other, case grays, combin both. differ case presented. (case (a)) seek model steel-aluminum composite. sense, materi proper- ti taken e0 = 13, 0 = 0.35, e1 = 1, 1 = 0.3. second exampl (case (b)) intend model extrem case materi larger bulk modulu valu materi larger shear modulu value. aim, materi properti consid e0 = 0.9, 0 = 0.9, e1 = 1, 1 = 0.3. ferrer 375 0 0.5 1 densiti 0.2 0.4 0.6 0.8 bulk modulu 0 0.5 1 densiti 0.2 0.4 0.6 0.8 bulk modulu 0 0.5 1 densiti 0 1 2 3 4 5 shear modulu 0 0.5 1 densiti 0.1 0.2 0.3 0.4 shear modulu figur 3 interpol function comparison interpol real materials. simp adapt interpol defined. contrast simp, simp-al remain h- bound despit bound close bimateri problem, valu penal paramet p simp interpol function unclear. following, penal paramet valu p = 3. simp adapt method defined. correspond h- bounds, simp, simp-al method depict figur 3. expected, case (a b), simp function fall outsid h- bounds. however, space h- bound significantli narrow, simp-al interpol function come lie insid them, state equat (70). thus, us simp-al interpol conveni simp interpol 1 13 conveni (from physic point view) differ valu 1 solv bimateri problems. 7.2 numer exampl comparison order numer effect differ kind interpol functions, cantilev beam exampl solv sequenc case describ figur 2. size domain 2 1 left clamped. distribut vertic forc unit valu appli 0.2 center right side. domain equip structur triangular mesh 20 000 element cartesian grid split cell triangles. densiti function approxim p1 lagrangian finit element functions21 follow filter appli densiti function: k = isk nin isk ni , (75) k densiti valu element k sk set node element k, work amstutz et al22 details. filter defin discret sense, term shape functions. filter depend distanc possible. consid complianc cost function volum (volum target stiff materi v = 0.5) constraint topolog optim problem. additionally, consid mma algorithm,23 wide community, solv problem stop criteria toler 104 maximum number iter nmax = 5000. design variabl initi stiff materi overal domain ( = 1). depict figur 4, observ similar optim topolog regardless interpol poisson ratio stiff materi close 1 = 13. additionally, number iter finite-el solver eval- uation similar. exampl comput matlab standard pc (3.40 ghz processor 64-bit architecture). however, differ appear 1 smaller. optim topolog simp interpol requir larg number iter finite-el solver evalu converg grai area appear. probabl small penal valu appear case (see figur 2). case simp adaptive, penal valu large, free numer instabilities, nonstan- dard topolog appear. likewise, signific comput effort term iter requir converge. contrast, simp-al interpol behav adequ term optim topolog comput effort 376 ferrer figur 4 cantilev beam exampl sequenc differ material-void interpol differ interpol functions. standard isotrop materi (1 = 13), interpol behav similarly. 1 negative, grai area appear simp larger number converg iter needed. adapt simp present larg grai area noncompetit cost function larger number converg iter appear. simp-al interpol present grai areas, number iter remain small, object function achiev consider smaller values. comparison simp, simp-al method evid auto-pen effect wider rang case [colour figur view wileyonlinelibrary.com] consid standard poisson ratio values, typic = 13. case (c), simp method converge. note that, compar cost valu interpol fuzzy, grai areas, interpol propos differ stiff values. cases, simp interpol propos valu stiffer physic possibl (out h- bounds). stiff comparison physic sense, cost optim topolog obtain interpol evalu simp-al interpol (jsa). valu cost (compliance) shown figur 4 normal valu cost initi guess. admittedly, simp-al inter- polation, decreas cost case (e) 35% obtain compar simp interpol 30% compar simp adapt interpolation. result show conveni simp-al interpol extrem isotrop materi (see, example, work greav et al24) bimateri problem considered. finally, grai area appear simp method probabl intermedi valu interpol competitive, seen figur 2. larg stiff valu (more physic possible) provid intermedi values. case, simp behav auto-pen interpol function. contrast, simp-al auto-pen cases. thoroughli surpris since, shown equat (43), topolog deriv (use simp-al interpolation) propos fact insert h- microstructur near extrem values. thus, possibl ad certain densiti (or insert certain stiffer inclusions) competit provid small stiff increment. intuitively, microstructur weak materi small number circular inclus transmit bare load, make it, general, attract optim point view. explain propos simp-al interpolation, contrast simp, evid result figur 4 auto-pen behavior studi cases. ferrer 377 8 conclus main contribut work summar follow points. first, show equat (43) topolog deriv complianc precis linear approx- imat h- bound (lower bound weak upper bound stiff material). words, topolog deriv complianc equival insert h- bound microstructur (circular inclusions). result strongli relat concept allow new interpret topolog derivative. second, propos simp-al method, new interpol function shear bulk modulus. defin ration function build deriv coincid h- lower bound deriv weak materi h- upper bound deriv stiff material, make gradient coincide, shown (43), topolog deriv stiff weak material. kei point simp-al interpol equat (70), shown stai h- bound regardless materi interpolated, allow interpret intermedi valu real microstructures. third, compar simp-al simp simp adapt interpol function. observ similar behavior 1 close 13 differ behavior smaller. contrast simp, simp-al interpol shown stai h- bounds, numer verifi result equat (70), case weak-stiff materi challeng case interpol gener isotrop materials. finally, concern numer examples, observ similar behavior optim topolog = 13. however, smaller, simp-al method shown obtain 20% stiffer topologies, free grai area smaller comput cost. comparison simp, result show simp-al method auto-pen wider rang cases. author' point view, alternative, simp-al interpol method under- stood gener simp method, adequ kind interpol materials, physic meaning, free heurist parameters, extra comput effort. sense, simp-al interpol bridg gap topolog deriv commun simp community, allow us reg- ular algorithm second us topolog deriv concept. matlab implement simp-al interpol avail provid appendix. acknowledg research lead result receiv fund european union' horizon 2020 research inno- vation programm mari skodowska-curi grant agreement no. 712949 (tecniospr plus) agenc busi competit govern catalonia. thank dr samuel amstutz assist develop methodology, help deepli understand topic comment greatli improv manuscript. orcid a. ferrer refer 1. pedersen cbw, alling p. industri implement applic topolog optim futur needs. in: bends mp, olhoff n, sigmund o, eds. iutam symposium topolog design optim structures, machin materials. dordrecht, netherlands: springer; 2006:229-238. 2. bends mp, sigmund o. materi interpol scheme topolog optimization. arch appl mech. 1999;69(9):635-654. 10.1007/s004190050248 3. wang f, lazarov bs, sigmund o. project methods, converg robust formul topolog optimization. struct multidiscip optim. 2011;43(6):767-784. 4. stolp m, svanberg k. altern interpol scheme minimum complianc topolog optimization. struct multidiscip optim. 2001;22:116-124. 378 ferrer 5. dzierzanowski g. comparison materi interpol scheme optim composit properti plane shape optimization. struct multidiscip optim. 2012;46:693-710. 6. allair g, jouv f, toader a-m. structur optim sensit analysi level-set method. j comput phys. 2004;194(1):363-393. 7. amstutz s, andr h. new algorithm topolog optim level-set method. j comput phys. 2006;216(2):573-588. www.sciencedirect.com/science/article/pii/s0021999105005656 8. allair g, gournai f, jouv f, toader am. structur optim topolog shape sensit level set method. control cybern. 2005;34(1):59. 9. yamada t, izui k, nishiwaki s, takezawa a. topolog optim method base level set method incorpor fictiti interfac energy. comput method appl mech eng. 2010;199(45-48):2876-2891. 10. huang x, xie ym. new look eso beso optim methods. struct multidiscip optim. 2008;35(1):89-92. 11. baig j, martnez-fruto j, herrero-prez d, otero f, ferrer a. large-scal stochast topolog optim adapt mesh refin coarsen two-level parallel scheme. comput method appl mech eng. 2019;343:186-206. 12. nguyen-xuan h. polytree-bas adapt polygon finit element method topolog optimization. int j numer method eng. 2017;110(10):972-1000. 13. amstutz s. connect topolog sensit analysi materi interpol scheme topolog optimization. struct multidiscip optim. 2011;43(6):755-765. 14. s lfn, amigo rcr, novotni aa, silva ecn. topolog deriv appli fluid flow channel design optim problems. struct multidiscip optim. 2016;54(2):249264. 15. brezi h. function analysis, sobolev space partial differenti equations. new york, ny: springer science; 2010. 16. novotni aa, sokoowski j. topolog deriv shape optimization. berlin, germany: springer-verlag; 2013. interact mechan mathemat series. 17. giusti sm, ferrer a, oliv j. topolog sensit analysi heterogen anisotrop elast problem. theoret computa- tional aspects. comput method appl mech eng. 2016;311:134-150. 18. hashin z, shtrikman s. variat approach theori elast behaviour multiphas materials. j mech phy solids. 1963;11(2):127-140. 19. bends mp, sigmund o. topolog optimization: theori method applications. berlin, germany: springer-verlag; 2003. 20. allair g. shape optim homogen method. new york, ny: springer-verlag; 2002. appli mathemat sciences; vol. 146. 21. ern a, guermond j-l. theori practic finit elements. vol. 159. new york, ny: springer scienc busi media; 2013. 22. amstutz s, dapogni c, ferrer a. consist relax optim design problem coupl shape topolog derivatives. numerisch mathematik. 2018;140(1):35-94. 23. svanberg k. method move asymptotesa new method structur optimization. int j numer method eng. 1987;24(2):359-373. 24. greav gn, greer al, lake rs, rouxel t. poisson' ratio modern materials. natur materials. 2011;10(11):823. cite article: ferrer a. simp-all: gener simp method base topolog deriv concept. int j numer method eng. 2019;120:361381. appendix simp-al matlab code appendix, provid simplifi matlab code facilit us simp-al interpol reader. code avail simp_all_interpolation.m function devis start topolog optim code. time comput interpol function neglig make usabl well-establish interpol functions. constitut interpol tensor deriv provid usual comput complianc function gradient compliance. obtain interpol function, comput shear bulk modulu addit parameters. then, coeffici ration function computed. finally, differenti respect densiti variabl obtain derivative. ferrer 379 11 % dc ( rho ) : deriv isotrop materi constitut tensor respect 12 % densiti function rho . 13 % 14 % remark 1: condit requir e1 , e0 , nu1 , nu0 ( e>0 15 % 1<nu < 0.5) , refer strong weak materi 16 % materi b . , prefer strong weak 17 % follow topolog optim name . 18 % 19 % remark 2: version simpal interpol function intend 20 % 2d plane stress problem . 21 % 22 % remark 3: simpal interpol evidenc fulfil hashin shtrikman 23 % ( hs) bound possibl combin materi properti . 24 % , densiti function take intermedi valu , result 25 % constitut tensor interpret homogen constitut 26 % tensor micro structur strong weak materi 27 % rel fraction volum intermedi densiti valu . 28 % 29 % remark 4: simpal interpol free penal heurist 30 % paramet . 31 % 32 % remark 5: interpol built hand 33 % constitut tensor coincid c0 ( constitut tensor e0 , nu0 34 % materi properti ) rho =0 c1 ( respect e1 , nu1 ) rho =1 35 % hand constitut tensor deriv 36 % rho =0 rho =1 coincid topolog deriv 37 % complianc dc0 dc1 , . e ., 38 % c (0) = c0 , c (1) = c1 , 39 % dc (0) = dc0 , dc (1) = dc1 . 40 % 41 % remark 6: opt provid dc complianc 42 % ( integr f u = integr e ( u ) :c( rho ) : e ( u ) ) topolog optim 43 % problem , gradient directli obtain e ( u ) : dc ( rho ) : e ( u ) . 44 % 45 % shear bulk modulu 46 mu = e , nu ) e /(2 (1+ nu )); 47 kappa = e , nu ) e /(2 (1 nu )); 48 % 49 mu0 = mu( e0 , nu0 ); 50 mu1 = mu( e1 , nu1 ); 51 % 52 kappa0 = kappa ( e0 , nu0 ); 53 kappa1 = kappa ( e1 , nu1 ); 54 % 55 % auxiliar materi properti 56 eta mu = mu, kappa )( kappa mu)/(2 mu+kappa ); 57 eta kappa = mu, kappa ) mu; 58 % 59 eta mu0 = eta mu ( mu0, kappa0 ); 60 eta mu1 = eta mu ( mu1, kappa1 ); 1 f u n c t o n [c , dc ] = s m p l l n t e r p o l t o n ( e1 , e0 , nu1 , nu0 ) 2 % simpal n t e r p o l t o n f u n c t o n alex fer r , march 2019 . 3 % 4 % e0 , nu0 : young modulu poisson r t o o f s o t r o p c weak m t e r l 5 % e1 , nu1 : young modulu poisson r t o o f s o t r o p c s t r o n g m t e r l 6 % 7 % c( rho ) : s o t r o p c c o n s t t u t v e t e n s o r n t e r p o l t e d s o t r o p c 8 % m t e r l p r o p e r t e s o f s t r o n g ( e1 , nu1 ) weak m t e r l ( e0 , nu0 ) 9 % d e n s t y f u n c t o n rho . 10 % 61 % 62 e ta kappa0 = eta kappa ( mu0 , kappa0 ) ; 63 e ta kappa1 = eta kappa ( mu1 , kappa1 ) ; 64 % 65 % s o t r o p c f o u r t h o rde r t e n s o r n voigt n o t t o n 380 ferrer 66 i1 = ey ( 3 ) ; i1 ( 3 , 3 ) = 1 / 2 ; 67 i2 = [ 1 1 0 ; 1 1 0 ; 0 0 0 ] ; 68 aiso = alpha , beta ) lpha i1 + beta i2 ; 69 % 70 % c o e fi c e n t s ( n= numer , d = denomin ) o f r t o n l f u n c t o n 71 n01 = f0 , f1 , eta0 , e ta1 ) ( f 1 f 0 ) ( e ta1 eta0 ) ; 72 n0 = f0 , f1 , e ta0 ) f 0 ( f 1 + eta0 ) ; 73 n1 = f0 , f1 , e ta1 ) f 1 ( f 0 + eta1 ) ; 74 d0 = f1 , e ta0 ) ( f 1 + e ta0 ) ; 75 d1 = f0 , e ta1 ) ( f 0 + e ta1 ) ; 76 % 77 n01 mu = n01 ( mu0 , mu1 , eta mu0 , eta mu1 ) ; 78 n01 kappa = n01 ( kappa0 , kappa1 , eta kappa0 , e ta kappa1 ) ; 79 % 80 n0 mu = n0 ( mu0 , mu1 , eta mu0 ) ; 81 n0 kappa = n0 ( kappa0 , kappa1 , e ta kappa0 ) ; 82 % 83 n1 mu = n1 ( mu0 , mu1 , eta mu1 ) ; 84 n1 kappa = n1 ( kappa0 , kappa1 , e ta kappa1 ) ; 85 % 86 d0 mu = d0 ( mu1 , eta mu0 ) ; 87 d0 kappa = d0 ( kappa1 , e ta kappa0 ) ; 88 % 89 d1 mu = d1 ( mu0 , eta mu1 ) ; 90 d1 kappa = d1 ( kappa0 , e ta kappa1 ) ; 91 % 92 % den ty f u n c t o n ( symbol ic o rde r f o r f u r t h e r d ff e r e n t t o n ) 93 rho = sym ( rho , p o s t v e ) ; 94 % 95 % simpal r t o n l f u n c t o n 96 f = n01 , n0 , n1 , d0 , d1 , rho ) . . . 97 ( n01 (1 rho ) ( rho ) + n0 (1 rho ) + n1 rho ) / ( d0 (1 rho )+ d1 rho ) ; 98 % 99 mu = f ( n01 mu , n0 mu , n1 mu , d0 mu , d1 mu , rho ) ; 100 kappa = f ( n01 kappa , n0 kappa , n1 kappa , d0 kappa , d1 kappa , rho ) ; 101 % 102 % s o t r o p c c o n s t t u t v e t e n s o r . 103 csym = s m p l f y ( aiso (2 mu , kappa mu ) ) ; 104 % 105 % shear bulk modulu d e r v t v e s 106 dmu = d ff (mu ) ; 107 dkappa = d ff ( kappa ) ; 108 % 109 % s o t r o p c c o n s t t u t v e t e n s o r d e r v t v e 110 dcsym = aiso (2 dmu , dkappa dmu) ; 111 % 112 % ord r ob ta handl f u n c t o n n s t e d o f symbol ic e x p r e s s o n 113 % d r e c t l y e v l u t e c o n s t t u t v e t e n s o r ( d e r v t v e ) f o r 114 % v e c t o r o f d e n s t e s , us o f matlabfunct ( ) . 115 n s t r e = 3 ; % number o f s t r e s s compon n voigt n o t t o n n p lane s t r e s s 116 dc = c e l l ( n s t r e , n s t r e ) ; 117 f o r =1: n s t r e 118 f o r j =1: n s t r e 119 f csym ( , j )==0 120 c{ , j } = rho ) z e r o s ( s z e ( rho ) ) ; 121 dc { , j } = rho ) z e r o s ( s z e ( rho ) ) ; 122 e l s e 123 c{ , j } = matlabfunct ( csym ( , j ) ) ; 124 dc { , j } = matlabfunct ( dcsym ( , j ) ) ; 125 end 126 end 127 end 128 end ferrer 381 following, present exampl interpol function common finit element context. 1 f u n c t o n u s e e x m p l e o f s m p l l n t e r p o l t o n 2 % us exampl o f simpal n t e r p o l t o n f u n c t o n f o r comput 3 %compl ianc t s g rad en t , alex fer r , 2018 . 4 % 5 % given m t e r l s o t r o p c p r o p e r t e s v l u e s 6 e1 = 1 ; 7 e0 = 0 . 0 1 ; 8 nu1 = 1 / 3 ; 9 nu0 = 1 / 3 ; 10 % bui ld simpal n t e r p o l t o n o f c o n s t t u t v e t e n s o r 11 [c , dc ] = s m p l l n t e r p o l t o n ( e1 , e0 , nu1 , nu0 ) ; 12 % 13 %in tex t o f fe problem , f o r g iven number o f gauss p o n t s ngau 14 % number o f e lement nelem o f f o r exampl 15 nelem = 1000 ; 16 ngau = 4 ; 17 % 18 % f o r g iven d e n s t y v l u e s 0 <= rho <= 1 o f dimens 19 % dim ( rho ) = ngau x nelem o f f o r exampl 20 rho = rand ( ngau , nelem ) ; 21 % 22 % f o r g iven s t r n t e n s o r v l u e s n voigt n o t t o n ( n s t r e = 3) 23 % ob ta in t h e s o l u t o n o f fi n t e element problem ku=f o f f o r exampl 24 n s t r e s = 3 ; 25 s t r n = rand ( n s t r e s , ngau , nelem ) ; 26 % 27 %although t cheaper f u, d e fi n n g dv ( weight jacobian ) 28 dv = rand ( ngau , nelem ) ; 29 %the compl ianc comput 30 c = 0 ; 31 f o r s t r e s = 1 : n s t r e s 32 f o r j s t r e s = 1 : n s t r e s 33 s t r = squeez ( s t r n ( j s t r e s , : , : ) ) ; 34 aux = s t r . c{ s t r e s , j s t r e s } ( rho ) . s t r . dv ; 35 c = c + sum ( aux ( : ) ) ; 36 end 37 end 38 % 39 % g r d e n t o f compl ianc 40 g = z e r o s ( ngau , nelem ) ; 41 f o r s t r e s = 1 : n s t r e s 42 f o r j s t r e s = 1 : n s t r e s 43 s t r = squeez ( s t r n ( j s t r e s , : , : ) ) ; 44 g = g s t r . dc { s t r e s , j s t r e s } ( rho ) . s t r ; 45 end 46 end 47 end simp-all: gener simp method base topolog deriv concept abstract introduct topolog optim formul exact topolog optim problem relax topolog optim problem topolog deriv connect topolog deriv hashin-shtrikman bound ration function simp-al method comparison simp simp-al interpol function comparison numer exampl comparison conclus refer