mix aggreg finit element method unfit discret stoke problem | siam journal scientif comput | vol. 40, no. 6 | societi industri appli mathemat copyright siam. unauthor reproduct articl prohibited. siam j. s\mathrm{c}\mathrm{i}. c\mathrm{o}\mathrm{m}\mathrm{p}\mathrm{u}\mathrm{t}. \mathrm{c}\bigcirc 2018 societi industri appli mathemat vol. 40, no. 6, pp. b1541--b1576 mix aggreg finit element method unfit discret stoke problem\ast santiago badia\dagg , alberto f. martin\ddagg , \mathrm{a}\mathrm{n}\mathrm{d} francesc verdugo\ddagg abstract. work, consid unfit finit element method numer approx- imat stoke problem. well-known kind method lead arbitrarili ill-condit system poorli approxim flux unfit interfaces/boundaries. order solv issues, consid recent propos aggreg finit element method, origin motiv coerciv problems. however, well-posed stoke problem far sub- tle reli discret inf-sup condition. consid mix finit element method satisfi discret version inf-sup condit body-fit mesh analyz discret inf-sup affect consid unfit case. propos differ aggreg mix finit element space combin simpl stabil terms, includ pressur jump and/or cell residuals, fix potenti defici aggreg inf-sup. carri complet numer analysis, includ stability, optim priori error estimates, condit number bound affect small cut cell problem. sake conciseness, re- strict analysi hexahedr mesh discontinu pressur spaces. thorough numer experiment bear numer analysis. aggreg mix finit element method ultim appli problem nontrivi geometries. kei words. embed boundary, unfit finit elements, stokes, inf-sup, condit am subject classifications. 65n12, 65n15, 65n30 doi. 10.1137/18m1185624 1. introduction. unfit finit element (fe) techniqu receiv increas- ing attent appeal practic situations. tech- niqu avoid gener body-fit meshes, bottleneck large-scal simulations. particularli well-suit multiphas multi- physic applic move interfac (e.g., fractur mechan [1], fluid-structur interact [2], free surfac flow [3]) applic vari domain (e.g., shape topolog optim [4], addit manufactur three- dimension (3d) print [5], stochast geometri problem [6]). unfit fe method name differ ways. design captur interfaces, usual denot extend fe method [7], denot embed unfit method motiv simul problem (usual simple) background mesh (see, e.g., cutfem method [8] finit cell method [9, 10, 11]). useful, unfit fe method known drawbacks. pose prob- lem numer integr imposit dirichlet boundari condit \ast submit journal' comput method scienc engin section 4, 2018; accept public (in revis form) octob 31, 2018; publish electron decemb 18, 2018. funding: work partial fund european union exaqut project h2020 framework programm (grant agreement 800898). author receiv sup- port catalan govern icrea acad\`emia research program. author receiv support secretaria d'universitat recerca catalan govern framework beatriu pin\'o program (grant 2016 bp 00145). \dagger depart civil environment engineering. universitat polit\`ecnica catalunya, jordi girona 1-3, edifici c1, 08034 barcelona, spain \ddagger cimn centr internacion m\`etod num\`er en enginyeria, upc, estev terrada 5, 08860 castelldefels, spain b1541 d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1542 s. badia, a. f. martin, f. verdugo lead ill-condit system [12]. unfit fe techniques, condit number discret linear depend characterist element size background mesh ratio cut cell total cell volum cell volum insid physic domain, arbitrarili small, lead so-cal small cut cell problem. method base fictiti materi [9] requir penalti term goe zero power mesh size optim convergence. thus, condit number result linear system asymptot affect small cut cell problem. detail converg behavior fictiti materi methods, [13]. precondit iter linear solver suitabl standard fe method robust formulations. recently, robust domain decomposit precondition abl deal cut cell propos [14] order methods, precondition requir special treatment robust direct solut local-to-subdomain systems. hand, ill-pos degre freedom (dofs) cut cell lead poorli approxim flux unfit boundaries/interfaces, especi critic interface-coupl problem like fluid-structur interaction. author recent propos [15] unfit fe formulation, refer aggreg finit element method (agfem), fix small cut cell problem ellipt partial differenti equat (pdes). novel method reli so-cal aggreg finit element (agfe) spaces, ground cell aggrega- tion techniqu judici chosen linear constraint conflict dof respect interior ones. approach appli grad-conform (global continuous) space discontinu fe space arbitrari order. agfem lead well-pos galerkin formul ellipt problems, viz., stabil term need method consist introduc artifici dif- fusion. furthermore, result linear system condit number scale element size background mesh wai standard fe method body-fit meshes. method implement fempar, large-scal fe softwar packag [16, 17]. exist approaches, salient ghost penalti for- mulat cutfem method [8, 18]. wide version method requir comput high order deriv facet high order fes, dispos gener fe code expens compute, certainli complic implement method harm code performance. version ghost penalti method requir comput high order deriv reli macroel mesh structur propos problem (see, e.g., [19] poisson equat [20, 21] time-depend convection-diffus equat move domains). b-spline approximations, consid so-cal extens extrapol techniqu (see, e.g., [22, 23, 24]). work close agfem [15] sens problemat dof associ b-spline small support insid physic domain elimin constrain linear combin well-pos dofs. aggreg approach new discontinu galerkin (dg) method (see, e.g., [25, 26, 27]), situat easier, con- formiti kept. fact, aggreg techniqu dg [25, 26, 27] cast discontinu agfems. us mix fe method unfit mesh explor previou works. combin ghost penalti stabil inf-sup stabl element unfit fe approxim stoke problem origin address [28] triangular mesh dimensions. analysi reli d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1543 continu inf-sup condit interior domain, viz., union interior cell (not intersect boundary), order prove pressur stabil interior cells, cut cell pressur stabil reli ghost penalti stabilization. extens work interfac stoke problem mini element propos [29] (see [30] similar strategy). analys [28, 29, 30] reli assumpt discret inf-sup constant bound awai zero uniformli h. uniform stabil trivial, prove far triangular/tetrahedr mesh mix fe (see [31]). altern mix fe methods, global stabil residual-bas pressur jump order scheme combin ghost penalti stabil [32]. global residual-bas stabil [23, 24] b-spline approximations. work, propos combin agfem approach, fix small cut cell problem numer approxim ellipt pdes, mix fe spaces. unsurprisingly, develop mix agf space satisfi discret version inf-sup condit straightforward. discret inf-sup condit requir perfect balanc veloc pressur spaces, boundary- cell intersect arbitrary, lead larg set possibl cell aggreg geometries. consid hexahedr mesh arbitrari order mix fe space discontinu pressur analyz potenti defici unfit inf-sup term set improp aggreg interfac requir ad- dition stabilization.1 abstract stabil analysi assumpt stabil allow defin effect stabil terms. propos algorithms. combin standard aggreg tensor-product lagrangian fe interior residual-bas pressur jump face stabil improp ag- gregat facets, respectively. second make us agf space term serendipity-bas extens tensor-product lagrangian fe combin pressur jump stabil improp facets. result scheme quadrilateral/hexahedr meshes, order approxim select user, algorithm requir comput (higher order one) deriv cell boundari (unlik ghost penalty/cutfem approaches), in- volv minim stabil consequ artifici diffus (e.g., pressur jump stabil small subset facet close interface). complet numer analysi show uniform stabil (that reli potenti ill inf-sup condit union interior cells), optim priori error estimates, condit number bound respect mesh size cell boundari inter- section. remark featur approach expos high degre message-pass parallel assembl process, suitabl develop highli scalabl parallel unfit fe framework distribut memori computers, far miss literature. fact, highli scalabl par- allel implement agfem nonconform h-adapt octre meshes, ground p4est effici octre handl [33], develop fempar [16, 17]. apart abil control geometri approxim error local adapt region high geometr variability, octre mesh effici gener- ated, refin coarsened, partitioned, 2:1 balanc hundr thousand processor [33], main reason favor sort mesh approach. outlin work follows. section 2, introduc stoke problem and, section 3, brief introduct fe spaces, notat fol- 1in case, idea extend tetrahedr mesh mix fe spaces. d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1544 s. badia, a. f. martin, f. verdugo lows. section 4 devot definit agf space mathemat properties. discret agfem approxim stoke problem pro- pose section 5, stabil term defin yet. section 6 devot complet numer analysi mix agfems. specifically, section 6.1, perform abstract stabil analysi assumpt mix agf space stabil terms. differ algorithm satisfi assumpt propos section 6.2 6.3. priori error estim condit number bound independ cut cell intersect boundari prove section 6.4 6.5, respectively. complet set numer experi section 7. close work, conclus drawn section 8. 2. problem statement. let consid open bound physic domain \omega \subset \bbbr d (where d = 2, 3 physic space dimension) lipschitz boundari \gamma , occupi viscou fluid. consid dirichlet boundari condit \gamma breviti exposition; introduct neumann boundari condit straightforward. stoke problem, scale pressur invers diffus coefficient, read follows: veloc field \bfitu : \omega \rightarrow \bbbr d pressur field p : \omega \rightarrow \bbbr - \delta \bfitu +\bfnabla p = \bfitf \omega , \bfnabla \cdot \bfitu = 0 \omega , \bfitu = \bfitg \gamma ,(1) \bfitf bodi forc \bfitg prescrib dirichlet data, satisfy\int \gamma \bfitg \cdot \bfitn = 0, \bfitn stand outward normal. order uniqu determin pressure, addition enforc \int \omega p = 0. us standard notat sobolev space (see [34]). particular, l2(\omega ) scalar product denot (\cdot , \cdot )\omega \omega \subset \bbbr d. make abus notation, repres h1(\omega ) dualiti pair way. l20(\omega ) subspac function l2(\omega ) zero mean value. sobolev space x, denot norm \| \cdot \| x . particular, l2(\omega ) norm denot \| \cdot \| \omega h 1(\omega ) norm \| \cdot \| 1,\omega . seminorm sobolev space w k,p(\omega ) denot | \cdot | wk,p(\omega ), simpli | \cdot | 1,\omega h1(\omega ). given function g \in h 1 2 (\partial \omega ), subspac function h1(\omega ) trace equal g repres h1g (\omega ). vector-valu sobolev space repres boldfac letters. let assum \bfitf \in \bfitl 2(\omega ) \bfitg \in \bfith 1 2 (\gamma ). weak form stoke problem (1) read follows: (\bfitu , p) \in \bfith 1\bfitg (\omega )\time l20(\omega ) (\bfnabla \bfitu ,\bfnabla \bfitv )\omega - (p,\bfnabla \cdot \bfitv )\omega - (q,\bfnabla \cdot \bfitu )\omega = (\bfitf ,\bfitv )\omega (2) (\bfitv , q) \in \bfith 1\bfzero (\omega ) \time l20(\omega ). well-posed linear problem reli fact diverg oper \bfith 1\bfzero (\omega ) surject l 2 0(\omega ). exist constant \beta depend \omega (see, e.g., [35]) inf p\in l20(\omega ) sup \bfitv \in \bfith 1\bfzero (\omega ) (p,\bfnabla \cdot \bfitv )\omega \| p\| \omega \| \bfitv \| 1,\omega \geq \beta > 0.(3) follow exposition, consid numer approxim problem fe methods. particular, interest discret stoke problem unfit fe methods, i.e., mesh fit \omega . 3. fe spaces. let consid open polyhedr domain \omega partit \scrk h(\omega ) set cells. consid case cell hexahe- dra/quadrilater (hex mesh) cell tetrahedra/triangl (tet mesh). d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1545 cell k \in \scrk h(\omega ), defin local fe space follows. abstract defini- tion ciarlet, fe repres triplet \{ k,\scrv ,\sigma \} , k compact, connected, lipschitz subset \bbbr d, \scrv vector space functions, \sigma set linear function form basi dual space \scrv \prime . element \sigma so-cal dof fe; denot number dof n\sigma . dof written \sigma \in \scrn \sigma . = \{ 1, . . . , n\sigma \} . defin basi \{ \phi a\} a\in \scrn \sigma \scrv \sigma a(\phi b) = \delta ab a, b \in \scrn \sigma . function so-cal shape function fe, one-to-on map shape function dofs. work, consid differ concret vector space \scrv : (1) space \scrp q(k) polynomi degre equal q; (2) space \scrq q(k) polynomi degre equal q respect refer space coordinate; (3) space \u \scrq q(k) polynomi superlinear degre equal q (see [36] details). \u \scrq q(k) hex mesh lead serendip fe. sake simplicity, assum cell mesh topolog (for given field) polynomi order.2 order build global continu fe spaces, denot \scrn (k) set n\sigma lagrangian node order q cell k \scrp q(k) tet \scrq q(k) hexs. set nodal values, i.e., \sigma a(v) . = v(\bfitx a) \in \scrn (k), basi dual space \scrv \prime . definition, hold \phi a(\bfitx b) = \delta ab, \bfitx b space coordin node b correspond set nodes. next, assum local-to- global dof map result global space \scrc 0 continuous. lead follow \scrc 0(\omega ) global fe spaces: (1) space \scrp q,h(\omega ) function cell restrict belong \scrp q(k) tet mesh; (2) space \scrq q,h(\omega ) (resp., \u \scrq q,h(\omega )) function cell restrict belong \scrq q(k) (resp., \u \scrq q(k)) hex mesh. note discontinu fe spaces, definit dof flexible, intercel continu enforced. us global space \scrp - q,h(\omega ) piecewis discontinu function belong \scrp q(k), arbitrari cell topology. space vector-valu function compon space repres boldfac letters. given function v, defin local interpol nodal lagrangian fe \pi ik(v) . = \sum a\in \scrn (k) \sigma a(v)\phi = \sum a\in \scrn (k) v(\bfitx a)\phi a, k \in \scrk h(\omega ).(4) easi check interpol oper fact projection. global interpol \pi ih(\cdot ) defin sum cell correspond local inter- polators, i.e., \pi ih(v) = \sum k\in \scrk h(\omega ) \pi k(v). 4. aggreg finit element spaces. section, defin agf spaces. refer [15] details. first, introduc geometr concept relat us embed boundari methods, cell aggreg algorithm, map vertices, edges, face (vefs) cut cell aggregates. next, us geometr aggreg defin agf space unfit meshes. finally, provid trace invers inequalities, approxim 2the polynomi space defin physic space cell, instead reli refer cell map refer physic space. approach equival affin maps, second appeal lower comput cost. converg prop- erti serendip fe deterior map affin [37]. fortunately, equival hold cartesian hex mesh below. d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1546 s. badia, a. f. martin, f. verdugo properti follow section analyz stabil obtain priori error estimates. following, assum hex mesh used. practice, interest cartesian hex meshes, cell repres scale d-cube. restrict simplifi implement issues, polynomi base physic space obtain map refer cell polynomi bases, fact hold gener (first-order) hex meshes. however, agf space readili obtain tet mesh idea below. 4.1. embed boundari setup cell aggregation. usual em- bed boundari methods, consid artifici domain \omega \mathrm{a}\mathrm{r}\mathrm{t} simpl shape easili mesh conform cartesian grid \scrk \mathrm{a}\mathrm{r}\mathrm{t}h . = \scrk h(\omega \mathrm{a}\mathrm{r}\mathrm{t}) char- acterist size h includ physic domain \omega \subset \omega \mathrm{a}\mathrm{r}\mathrm{t} (see figur 1(a)). numer analysis, geometr error considered. practic imple- mentation, domain boundari implicitli defin zero level-set given scalar function \psi \mathrm{l}\mathrm{s}, i.e., \gamma . = \{ \bfitx \in \bbbr d : \psi \mathrm{l}\mathrm{s}(\bfitx ) = 0\} . lead approxim \omega h \omega , e.g., march cubes--lik algorithm, lead approxim boundari \gamma h. omit subscript sake concis notation, distinct important. let defin quantiti \eta k . = | k\cap \omega | | k| paramet \eta 0 \in (0, 1]. cell \scrk \mathrm{a}\mathrm{r}\mathrm{t} h classifi follows: cell k \in \scrk \mathrm{a}\mathrm{r}\mathrm{t}h \eta k \geq \eta 0 interior cell ; 3 k \cap \omega = \emptyset , k extern cell ; otherwise, k cut cell (see figur 1(b)). set interior (resp., extern cut) cell repres \scrk \mathrm{i}\mathrm{n}h union \omega \mathrm{i}\mathrm{n} \subset \omega (resp., (\scrk \mathrm{e}\mathrm{x}\mathrm{t}h ,\omega \mathrm{e}\mathrm{x}\mathrm{t}) (\scrk \mathrm{c}\mathrm{u}\mathrm{t} h ,\omega \mathrm{c}\mathrm{u}\mathrm{t})). furthermore, defin set activ cell \scrk h . = \scrk \mathrm{i}\mathrm{n}h \cup \scrk \mathrm{c}\mathrm{u}\mathrm{t} h union \omega \mathrm{a}\mathrm{c}\mathrm{t}. assum background mesh quasi- uniform (see, e.g., [38, p. 107]) reduc technicalities, defin characterist mesh size h. (a) (b) intern cell cut cell extern cell fig. 1. embed boundari setup. consid partit \omega nonoverlap cell aggregates. aggreg compos cut cell interior cell. besides, cell aggreg connected, i.e., aggreg span multipl disjoint domains. partit comput strategi describ algorithm 4.1 below. 3for \eta 0 = 1, interior cell cell k \subset \omega . however, weaken definit take lower valu \eta 0, consid interior cell on larg portion interior. d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1547 algorithm 4.1 (cell aggreg algorithm). 1. mark interior cell touch cut cell untouched. 2. untouch cell, touch cell connect facet f f \cap \omega \not = \emptyset , aggreg cell touch cell belong aggreg contain closest interior cell. touch cell fulfil requirement, choos arbitrarily, e.g., cell connect facet area insid physic domain, smaller global label. 3. mark touch cell aggreg step 2. 4. repeat step 2 3 cell aggregated. figur 2 show illustr step algorithm 4.1 \eta 0 = 1. black line repres boundari aggregates. note step 1 step 2, line adjac cell removed, mean adjac cell merg aggregate. aggreg scheme easili appli arbitrari spatial dimensions. touch untouch aggregates' boundari \partial \omega (a) step 1. (b) step 2. (c) step 3. (d) step 4. fig. 2. illustr cell aggreg scheme defin algorithm 4.1 \eta 0 = 1. note definit aggreg (5) consid aggreg cell insid \omega simplifi notat numer analysis. forthcom sections, need upper bound size aggreg gener algorithm 4.1 term cell mesh size h, i.e., characterist size aggreg bound \gamma h \gamma independ h cut cell intersect boundary. given mesh, constant \gamma bound follow result taken [15, lemma 2.2]. lemma 4.2. assum cut cell k0 \in \scrk \mathrm{a}\mathrm{c}\mathrm{t}h cell path \{ k0,k1, . . . ,kn\} satisfi following: (1) consecut cell share facet f f \cap \omega \not = \emptyset ; (2) kn interior cell; (3) n \leq n\mathrm{m}\mathrm{a}\mathrm{x}, n\mathrm{m}\mathrm{a}\mathrm{x} fix integer. then, constant \gamma 2n\mathrm{m}\mathrm{a}\mathrm{x} + 1. lemma state aggreg size bound term n\mathrm{m}\mathrm{a}\mathrm{x}, i.e., number cell need travers facet connect cut cell interior one. note larg valu n\mathrm{m}\mathrm{a}\mathrm{x} appear deal underresolv geometr details. thus, finer mesh contribut decreas n\mathrm{m}\mathrm{a}\mathrm{x} and, turn, aggreg size. numer result [15, section 6.3] \gamma tend \gamma = 2 dimens \gamma = 3 dimens practic cases. however, complex geometries, local mesh adapt requir captur small geometr detail reduc aggreg size. d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1548 s. badia, a. f. martin, f. verdugo algorithm 4.1 lead partit \scrt h aggregates, aggreg defin term set cell (5) . = \~a \cap \omega , \~a .= \{ \cup nai=0ki : ki \in \scrk h\} , (without loss generality) k0 \in \scrk \mathrm{i}\mathrm{n}h owner interior cell, repres \scro (a). thus, \in \scrt h trim boundari \~a correspond untrim aggregate. following, trim aggreg refer aggregates. construct algorithm 4.1, hold (1) na \geq 0; (2) interior cell aggreg cut cell (na = 0) remain same; (3) interior cell aggregate, i.e., ki \not \subset \omega > 0; (4) cut cell belong aggregate. interior/cut cell k \in \scrk h, defin owner (interior) cell \scro (k) owner \scro (a) aggreg \in \scrt h contain cell, i.e., k \cup nonzero measur dimens d. thus, owner interior cell cell itself. construct map that, given outer vef, i.e., vef belong cut cell \scrk \mathrm{c}\mathrm{u}\mathrm{t}h belong interior cell \scrk \mathrm{i}\mathrm{n} h , provid aggreg owner aggreg contain (see figur 3). map arbitrarili built, e.g., consid smallest aggreg contain vef. map outer vef b interior cell owner repres \scro (b).4 (a) outer vertex aggreg map (b) outer face aggreg map untrim aggreg cell outer face outer vertex fig. 3. map outer facet vertex aggreg owner. small pointer denot aggreg owner. pointer vertex facet belong aggreg owner obvious. aggreg (a) (b) same, aggreg bound clearer (a). 4.2. aggreg finit element spaces. goal defin fe space cell aggreg introduc above, order end unfit fe space domain \omega , optim approxim properti affect small cut cell problem. goal section start pair inf-sub stabl fe space (i.e., velocity-pressur pair fe space satisfi discret version inf-sup condit body-fit meshes) end aggreg version fe pair (which affect small cut cell problem). process defin aggreg version given fe space introduc systemat differ type interpolations. sake simplicity, present method gener scalar-valu field. techniqu eventu appli fe 4after cell aggreg vef owner definition, defin map \scro (\cdot ) that, given outer vef cut cell, provid owner (interior) cell. d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1549 (a) \scrv inh (b) \scrv h (c) \scrv act h \circ node \scrn \mathrm{i}\mathrm{n}h \bullet node \scrn \mathrm{a}\mathrm{c}\mathrm{t}h \time node \scrn \mathrm{o}\mathrm{u}\mathrm{t}h fig. 4. fe spaces. space pressur field, compon fe space veloc field (which scalar fe spaces). let repres \scrv h(\omega ) gener global (continu discontinuous) lag- rangian fe space, i.e., \scrq q,h hex mesh \scrp q,h tet meshes, arbitrari order q. introduc activ fe space associ activ portion background mesh \scrv \mathrm{a}\mathrm{c}\mathrm{t}h . = \scrv h(\scrk \mathrm{a}\mathrm{c}\mathrm{t}h ) interior fe space \scrv \mathrm{i}\mathrm{n} h . = \scrv h(\scrk \mathrm{i}\mathrm{n}h ). activ fe space \scrv \mathrm{a}\mathrm{c}\mathrm{t}h (see figur 4(c)) function space typic unfit fe method (see, e.g., [14, 12, 9]). well-known \scrv \mathrm{a}\mathrm{c}\mathrm{t}h lead arbitrari ill-condit system integr fe weak form physic domain \omega (if stabil techniqu remedi it). obviou interior fe space \scrv \mathrm{i}\mathrm{n}h (see figur 4(a)) affect problem, usabl defin \omega . herein, propos altern agf space \scrv h defin \omega present ill-condit issu relat \scrv \mathrm{a}\mathrm{c}\mathrm{t}h . end, defin set node \scrv \mathrm{i}\mathrm{n}h \scrv \mathrm{a}\mathrm{c}\mathrm{t} h \scrn \mathrm{i}\mathrm{n} h \scrn \mathrm{a}\mathrm{c}\mathrm{t} h , respect (see figur 4). defin set outer node \scrn \mathrm{o}\mathrm{u}\mathrm{t}h . = \scrn \mathrm{a}\mathrm{c}\mathrm{t}h \setminu \scrn \mathrm{i}\mathrm{n} h (e.g., node belong outer vef figur 3). outer node on lead condit problem small cut cell problem (see, e.g., [12]). space global shape function \scrv \mathrm{i}\mathrm{n}h \scrv \mathrm{a}\mathrm{c}\mathrm{t} h repres \{ \phi b : b \in \scrn \mathrm{i}\mathrm{n}h \} \{ \phi b : b \in \scrn \mathrm{a}\mathrm{c}\mathrm{t}h \} , respectively. function uh \in \scrv \mathrm{i}\mathrm{n}h written uh = \sum a\in \scrn \mathrm{i}\mathrm{n} h uah\phi a, analog function \scrv \mathrm{a}\mathrm{c}\mathrm{t}h . space \scrv h defin take start point \scrv \mathrm{a}\mathrm{c}\mathrm{t} h ad judici defin constraint node \scrn \mathrm{o}\mathrm{u}\mathrm{t}h . order defin \scrv h, observ that, nodal lagrangian fe spaces, one-to-on map dof node (points) fe mesh. global continu fe spaces, defin owner vef outer node b \in \scrn \mathrm{o}\mathrm{u}\mathrm{t}h , denot \scro \mathrm{v}\mathrm{e}\mathrm{f}(b), lowest-dimension vef contain node b. result, composit outer-vef-to-cell-own map \scro (\cdot ) outer- dof-to-vef-own map \scro \mathrm{v}\mathrm{e}\mathrm{f}(\cdot ) lead outer-dof-to-cell-own map, namely, \scro \circ \scro \mathrm{v}\mathrm{e}\mathrm{f}(\cdot ). abus notation, denot map \scro (b) outer dof b. discontinu fe spaces, dof belong cell itself, continu enforced. thus, dof owner outer-dofs-to-cel map trivial defin cell aggregation. continu enforc cells, definit dof flexible. given function vh \in \scrv \mathrm{i}\mathrm{n}h cell k \in \scrk \mathrm{i}\mathrm{n} h , defin uniqu polynomi \xi kh (vh) : \bbbr d \rightarrow \bbbr restrict cell k coincid fe function, d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1550 s. badia, a. f. martin, f. verdugo i.e., vh(\bfitx ) = \xi k h (vh)(\bfitx ), \bfitx \in k. ingredients, defin \scrv h \subset \scrv \mathrm{a}\mathrm{c}\mathrm{t} h subset function \scrv \mathrm{a}\mathrm{c}\mathrm{t}h that, dof \in \scrn \mathrm{o}\mathrm{u}\mathrm{t} h , vah = \sigma a(\xi \scro (a) h (vh)) = \sum b\in \scrn (\scro (a)) \sigma a(\xi \scro (a) h (\phi b))\sigma b(vh).(6) construction, function \scrv h uniqu determin dof \scrv \mathrm{i}\mathrm{n}h . thus, defin extens oper \scre h : \scrv \mathrm{i}\mathrm{n}h \rightarrow \scrv h \subset \scrv \mathrm{a}\mathrm{c}\mathrm{t} h given uh \in \scrv \mathrm{i}\mathrm{n} h provid fe function \scre h(uh) \in \scrv \mathrm{a}\mathrm{c}\mathrm{t}h outer nodal valu comput (6). figur 5 illustr extens oper \scre h(\cdot ). thus, agf space rang operator, i.e., \scrv h . = \scre h(\scrv \mathrm{i}\mathrm{n}h ) \subset \scrv \mathrm{a}\mathrm{c}\mathrm{t} h . function \scrv \mathrm{a}\mathrm{c}\mathrm{t} h \scrc 0 continuous, \scrv h \subset \scrv \mathrm{a}\mathrm{c}\mathrm{t}h , function \scrv h \scrc 0 continuous. note (6) make sens continu discontinu spaces, and, e.g., tensor- product serendip space hex mesh lagrangian fe tet meshes. case, definit (6) gener space dof nodal evaluations. (a) dof owner (b) vh \in \scrv inh (c) \scre (vh) \in \scrv h fig. 5. illustr extens oper \scre h(\cdot ). red arrow repres exterior dof interior cell map \scro (\cdot ). function vh equal 1 dof associ root cell aggreg displai (a) equal 0 elsewhere. formula (6), extend function \scre h(vh) 1 exterior dof cell owner root cell aggreg (a). note dof aggreg need share cell owner. 4.2.1. nodal lagrangian aggreg finit element spaces. particular, nodal-bas lagrangian fe space (which includ tensor-product \scrq q,h(\scrk h) serendip space \u \scrq q,h(\scrk h) hex mesh \scrp q,h(\scrk h) tet meshes), previou express reduc (7) vh(\bfitx a) = \sum b\in \scrn (\scro (a)) vh(\bfitx b)\phi b(\bfitx a). comput constraint straightforward simpli involv evalu shape function polynomi cell set point belong cell, viz., node aggreg cut cell. definit dof ownership simple: vef cell contain node relat dof minimum dimension, uniqu defined. 4.2.2. discontinu aggreg finit element spaces. let comment discontinu fe spaces, e.g., \scrp - q,h(\scrk h) hex meshes. easi check discontinu spaces, agf space analog defin d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1551 \scrv h = \{ v : v| \in \scrp - q (a) \in \scrt h\} .(8) equival definit base (6) (8) straightfor- ward. us aggreg techniqu dg method used, e.g., [39, 27]. 4.2.3. aggreg finit element serendip extension. now, assum constraint extens oper com- pute shape function on local fe space owner interior cell (see (6)). here, consid gener case shape function base (and correspond span spaces) differ. particular, interest tensor-product lagrangian space cell hex mesh, comput constraint correspond serendip basi (preserv- ing order approximation). later on, affect accuraci posit properti consid stabl mix agf space (see section 6.3). let introduc notation, order distinguish tensor-product serendip fe spaces. serendip fe hex meshes, i.e., \u \scrq q(k), rep- resent unisolv set node \u \scrn (k), i.e., correspond nodal valu basi dual space, cardin \u n\sigma (see [36, figur 1]). correspond shape function dof repres \{ \u \phi a\} a\in \u \scrn (k) \{ \u \sigma a\} a\in \u \scrn (k), respec- tively. serendip spaces, denot correspond nodal interpol (4) \u \pi ik(v). constrain outer dof \in \scrn \mathrm{o}\mathrm{u}\mathrm{t}h function vh \in \scrv \mathrm{a}\mathrm{c}\mathrm{t} h vah = \sigma a(\xi \scro (a) h \circ \u \pi \scro (a)(vh))) = \sum b\in \u \scrn (\scro (a)) \sigma a(\xi \scro (a) h ( \u \phi b))\u \sigma b(vh), analogously, (9) vh(\bfitx a) = \sum b\in \u \scrn (\scro (a)) vh(\bfitx b)\u \phi b(\bfitx a). lead new agf space \u \scrv h correspond extens oper \u \scre h. note serendip extens combin standard lagrangian fe space \scrv \mathrm{a}\mathrm{c}\mathrm{t}h . fact, case consid work. 4.3. mathemat properties. following, list fe inequ sections. us \lesssim b < cb posit constant c, analog \gtrsim \eqsim . us c denot constant, differ differ appearances. word constant work denot independ respect h cut cell intersection, i.e., affect small cut cell problem. constant depend \gamma \eta 0. cut cell, hk defin cell, independ cut. let consid arbitrari fe space \scrv h. follow invers inequ hold (see, e.g., [38]): \| \bfnabla uh\| k \lesssim h - 1 k \| uh\| k ,(10) \| \partial \bfitn uh\| \gamma \cap k \lesssim h - 1 2 k \| \bfnabla uh\| k ,(11) d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1552 s. badia, a. f. martin, f. verdugo k \in \scrk h, \bfitn outward normal (in appearance, respect \gamma \mathrm{d} \cap k), \partial \bfitn . = \bfitn \cdot \bfnabla . invers inequ (10)--(11) hold untrim aggreg \~a, simpli recal cell \~a. furthermore, follow trace inequ (see [40]): \| u\| \partial k \lesssim h - 1 2 k \| u\| k + h 1 2 k\| \bfnabla u\| k u \in h 1(k),(12) \| u\| \gamma \cap k \lesssim h - 1 2 k \| u\| \omega \cap k + h 1 2 k\| \bfnabla u\| \omega \cap k u \in h 1(\omega \cap k)(13) anyk \in \scrk h. result prove idea [40, lemma 3] [41, lemma 3.1] assumpt mesh fine captur geometr detail curvatur \gamma bound (see [40, 41] details). note fe function (defin cut cellk), (13) hold physic comput domain boundary, continu solut make sens physic domain. extens oper \scre h(\cdot ) \u \scre h(\cdot ) satisfi follow stabil bounds. standard extens oper consid tet hex meshes, serendip extens oper hex meshes. lemma 4.3. given function uh \in \scrv \mathrm{i}\mathrm{n}h , hold \| \scre h(uh)\| \omega \mathrm{a}\mathrm{c}\mathrm{t} \lesssim \| uh\| \omega \mathrm{i}\mathrm{n} , \| \u \scre h(uh)\| \omega \mathrm{a}\mathrm{c}\mathrm{t} \lesssim \| uh\| \omega \mathrm{i}\mathrm{n} , \| \bfnabla \scre h(uh)\| \omega \mathrm{a}\mathrm{c}\mathrm{t} \lesssim \| \bfnabla uh\| \omega \mathrm{i}\mathrm{n} , \| \bfnabla \u \scre h(uh)\| \omega \mathrm{a}\mathrm{c}\mathrm{t} \lesssim \| \bfnabla uh\| \omega \mathrm{i}\mathrm{n} . proof. proof \scre h(\cdot ) [15, corollari 5.3] gener agf space, \scrv \mathrm{i}\mathrm{n}h discontinu fe space gradients. result \u \scre h(\cdot ) prove analogously. combin previou lemma invers inequ (10) un- trim aggreg lead follow global invers inequ function agf space: \| \bfnabla \scre h(uh)\| \omega \mathrm{a}\mathrm{c}\mathrm{t} \lesssim h - 1\| uh\| \omega \mathrm{i}\mathrm{n} uh \in \scrv \mathrm{i}\mathrm{n} h .(14) given interior fe space \scrv \mathrm{i}\mathrm{n}h , defin standard scott--zhang inter- polat definit [42]. let defin extend scott--zhang inter- polant follows: (1) perform standard interior scott--zhang interpol \scrv \mathrm{i}\mathrm{n}h assign interior dof \in \scrn \mathrm{i}\mathrm{n} h arbitrari vef/cel 5 \~ka \subset \omega \mathrm{i}\mathrm{n} contain owner vef a, comput mean valu function \~ka, repres \sigma sz,a \~ka (\cdot ); (2) extend interior function \omega extens oper \scre h(\cdot ) (or \u \scre h(\cdot )), lead function \scrv h (or \u \scrv h). thus, extend scott--zhang interpol read \pi szh (u)(\bfitx ) . = \sum a\in \scrn \mathrm{i}\mathrm{n} h \sigma sz,a \~ka (u)\scr (\phi a(\bfitx )). serendipity-extend interpolant, repres \u \pi szh (u), obtain above, \u \scre h(\cdot ) instead. 5even choic arbitrary, permit \~ka \subset \omega vertex, restrict applic interpol \scrc 0(\omega ) function pointwis sense. note concept vef/cel ownership dof extend nonnod dof (see, e.g., [16]). d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1553 theorem, prove approxim properti extend scott--zhang interpolant. statement theorem, repres \nu (a) union owner aggreg owner neighbors, i.e., \nu (a) . = \{ \scro (b) : \cap b \not = \emptyset , b \in \scrt h\} . note \not \subseteq \nu (a) \subset \omega \mathrm{i}\mathrm{n} general. theorem 4.4. let consid agf space \scrv h \scrp q(a) \subset \scrv h(a) \in \scrt h, q \in \bbbn +. let consid function u \in wmp (\omega ), 1 \leq p \leq \infti , m \leq q+1, m \geq d p = 1 m > d p p > 1. given \in \scrt h k \in \scrk h k \subseteq a, hold \| u - \pi szh (u)\| w sp (k) \lesssim h m - s| u| wmp (\nu (a))(15) 1 \leq s \leq m. result appli serendipity-extend agf space \u \scrv h correspond interpol \u \pi szh (\cdot ). proof. standard serendip interpol analyz analogously. scott--zhang moment \sigma sz,a \~ka (\cdot ) bound wmp (\omega ) ow trace theo- rem, i.e., w lp(\omega ) \subset l1( \~ka) \~ka facet cell (see [42]). hand, \scre (\phi a(\bfitx )) \subset wmp (k) cell k \in \scrk h, combin shape function bound nodal valu (see (6) lemma 4.3). moreover, definit extens operator, nodal valu \pi szh (\cdot )| constrain dof owner interior cell dof owner cell neighbor a. thus, readili obtain \| \pi szh (u)\| wmp (a) \leq c\| u\| wmp (\nu (a)). next, consid arbitrari function \pi (u) \in wmp (\omega ) \pi (u)| k \in \scrp q(\nu (a)) \subset \scrv h(\nu (a)) (note inclus hold serendip extension). fact \pi szh (\cdot ) project \scrv h construct yield \pi (u)| = \pi szh (\pi (u))| a. thus, have: \| u - \pi szh (u)\| wmp (k) \leq \| u - \pi (u)\| wmp (k) + \| \pi sz h (\pi (u) - u)\| wmp (k) \lesssim \| u - \pi (u)\| wmp (k)+\| \pi (u) - u\| wmp (\nu (a)) \lesssim \| u - \pi (u)\| wmp (\nu (a)). \nu (a) open bound domain lipschitz boundari definit characterist size bound \gamma h, us deny--lion lemma (see, e.g., [35]). result, \pi (u) minim right-hand side, hold \| u - \pi szh (u)\| wmp (k) \lesssim | u| wmp (\nu (a)). sobolev embed theorem trace theorem yield \| u - \pi szh (u)\| w sp (k) \leq c(a)| u| wmp (\nu (a)).(16) order elimin depend constant size a, us stan- dard homogen (or scaling) arguments. consid scale refer aggreg unit diameter, recal (16) scale domain, us corre- spond chang variabl push inequ origin aggreg (see, e.g., [38, lemma 4.3.8] details). prove lemma. 5. approxim stoke problem. section, consid fe approxim stoke problem (1) agf space unfit meshes. focu inf-sup stabl space (velocity-pressur pair fe space satisfi discret version inf-sup condit body-fit meshes), extend aggreg strategi section 4. section, veloc pressur space repres \bfitv h mh, respectively. usual unfit d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1554 s. badia, a. f. martin, f. verdugo fe methods, dirichlet boundari condit enforc strongly. instead, consid nitsche-typ weak imposit dirichlet data [43, 44]. provid consist numer scheme optim converg rate (also high-ord elements) commonli embed boundari commun (see, e.g., [32] applic unfit discret stoke problem). import ingredi unfit fe approxim integr cut cells. refer [14] detail exposit particular techniqu paper. ingredients, defin stoke operator, ah(\bfitu h, ph,\bfitv h, qh) . = ah(\bfitu h,\bfitv h) + bh(\bfitv h, ph) - bh(\bfitu h, qh) + jh(\bfitu h, ph,\bfitv h, qh),(17) ah(\bfitu h,\bfitv h) . = (\bfnabla \bfitu h,\bfnabla \bfitv h)\omega - (\partial \bfitn \bfitu h,\bfitv h)\gamma - (\partial \bfitn \bfitv h,\bfitu h)\gamma + \tau (h\bfitu h,\bfitv h)\gamma ,(18) bh(\bfitv h, ph) . = - (\bfnabla \cdot \bfitv h, ph)\omega + (\bfitn \cdot \bfitv h, ph)\gamma ,(19) \tau larg posit constant, stabil purposes. right-hand read lh(\bfitv h, qh) . = (\bfitf ,\bfitv h)\omega + gh(\bfitf ,\bfitv h). pressur stabil term jh correspond potenti modif right-hand-sid gh consist defin section 6.2 6.3, motiv numer analysis. discret stoke problem final read follows: (\bfitu h, ph) \in \bfitv h \time mh ah(\bfitu h, ph,\bfitv h, qh) = lh(\bfitv h, ph) \foral (\bfitv h, qh) \in \bfitv h \time mh.(20) follow analysis, restrict hexahedr mesh dis- continu pressures. similar idea appli inf-sup stabl mix fe tetrahedr mesh continu pressures, consid case sake conciseness. thus, notat section 4.2, us follow global agf spaces: space \scrq q,h, q \geq 1, local fe space tensor-product lagrangian \scrq q(k) cell k \in \scrk h, constraint defin standard express (7); space \u \scrq q,h, q \geq 1, local fe space tensor-product lagrangian \scrq q(k) cell k \in \scrk h, serendip extens (9) comput constraints; discontinu space \scrp - q,h, q \geq 0, defin (8). 6. numer analysis. section, perform stabil analysi fe method (17). first, section 6.1, consid abstract stabil analysis, i.e., prove inf-sup condit assumpt mix agf space stabil terms. differ algorithm satisfi assumptions, stable, propos section 6.2 6.3. priori error estim method obtain section 6.4. finally, section 6.5, prove condit number bound independ cut cell intersect boundary, i.e., small cut cell problem. analysi discret problem obvious reli well-posed continu problem, i.e., inf-sup condit (3). sake concis notation, distinguish actual comput domain \omega h physic domain \omega . import distinguish definit inf-sup constant, i.e., \beta (\omega ) versu \beta (\omega h). general, \beta (\omega h) tend d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1555 zero h \rightarrow 0. lower bound \beta (\cdot ) reli decomposit domain finit number strictli star-shap domains. \beta (\omega h) tend zero h \rightarrow 0 prove number bound awai zero \omega h. fortunately, construct comput domain \omega h prove fact \beta (\omega h) bound or, more, converg \beta (\omega ). particular, \omega h polygon h-approxim \omega sens [45, definit 4.5], hold | \beta (\omega ) - \beta (\omega h)| \leq c(\omega )h. follows, simpli consid \beta . = infh<h0 \beta (\omega h) h0 fine mesh size repres topolog geometri hand. 6.1. abstract stabil analysis. section, analyz well- posed discret stoke problem (17) abstract setting, fe space stabil term explicitli stated. instead, analysi assumpt ingredients. defin follow norms: | | | \bfitu | | | 2h . = \| \bfnabla \bfitu \| 2\omega + \| h - 1 2\bfitu \| 2 \gamma , | | | \bfitu , p| | | 2 h . = | | | \bfitu | | | 2h + \| p\| 2 \omega .(21) follow lemma, prove stabil continu properti differ term compos stoke oper (17). lemma 6.1. larg posit constant \tau (18), hold \bfitu h, \bfitv h \in \bfitv h ah(\bfitu h,\bfitu h) \geq \gamma a| | | \bfitu h| | | 2 h, ah(\bfitu h,\bfitv h) \leq \xi a| | | \bfitu h| | | h| | | \bfitv h| | | h, bh(\bfitv h, qh) \leq \xi b| | | \bfitv h| | | h\| qh\| \omega (22) posit constant \gamma a, \xi a, \xi b. proof. continu stabil ah found, e.g., [15, theorem 5.7]. continu bh obtain term cauchy--schwarz inequ second inequ (13) (14) (see [32]). let type common aggreg topologies. first, defin rect- angular cuboid aggreg on shape (possibl ad inact cells); e.g., aggreg figur 6(a) except l- shape aggreg left. second, line aggreg cell center lie straight line. figur 6(a), l-shape squar aggreg line aggregates. let defin set interior aggreg facet fab . = \partial \cap \partial b, a, b \in \scrt h, \scrf h . = \{ fab : a, b \in \scrt h\} . note that, \subset \omega aggreg \in \scrt h definit (5), fab includ cut facet cut cell. finally, introduc concept improp facet aggregates, on requir type stabilization. definit 6.2 (improp aggreg set \bfitv h). improp aggreg set \scrt - h defin subset aggreg \scrt h rectangular cuboid shape (see figur 6(a)). complement repres \scrt +h . = \scrt h \setminu \scrt - h . definit 6.3 (improp facet set \bfitv h). improp facet set \scrf - h set facet f \in \scrf h aggreg af , bf \in \scrt h share face line aggreg (see figur 6(a)). complement repres \scrf +h . = \scrf h \setminu \scrf - h . d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1556 s. badia, a. f. martin, f. verdugo (a) improp aggreg (in blue) def. 6.2 improp facet (in red) def. 6.3. (b) reduc set improp facet (in red) stabil algorithm 6.13. fig. 6. illustr improp aggreg facets. definit 6.2, (a) improp aggreg blue. improp aggreg l-shape ones, on rectangular shapes. improp facet definit 6.2 on red (a). l-shape aggreg square-shap aggreg corner line aggregates; interior boundari facet improper. (b) restrict set facet stabil definit algorithm 6.13 section 6.3 serendip extension. note reduc facet stabil hold dimens second-, third-, fourth-ord fe serendip extension, idea dimens simplicity. red facet (a), red on (b) stabilized, on aggreg share interior cell. section section 6.2, follow assumpt veloc fe space. assumpt holds, e.g., consid veloc agf space standard extens second- higher-ord fe space interior cells. assumpt 6.4. exist q \in \bbbz +, q \geq 2, \bfscrq q(a) \subset \bfitv h(a) \in \scrt h. let roadmap follow rest section order stabil (17). first, need prove discret weak inf-sup condit mix agf space \bfitv h \time mh assumpt 6.4. order that, construct stabl quasi -fortin interpolant6 lemma 6.5, prove weak inf-sup space aggregate-const pressur lemma 6.6. make us aggregatewis bubbl function (for proper aggreg \scrt +h only), obtain extra pressur stabil addit assumpt mix agf space lemma 6.7. combin lemma lead final weak inf-sup condit theorem 6.8. result show defici weak inf-sup condition. assumpt 6.9, state properti satisfi pressur stabil correct deficiency. final prove inf-sup condit ah theorem 6.10. lemma 6.5 (quasi-fortin interpolant). \bfitv \in \bfith 1\bfzero (\omega ), exist func- tion \pi qf h (\bfitv ) \in \bfitv h (23) \int f \bfitv \cdot \bfitn = \int f \pi qf h (\bfitv ) \cdot \bfitn \foral f \in \scrf + h , | | | \pi qf h (\bfitv )| | | h \leq \xi qf \| \bfitv \| 1,\omega , posit constant \xi qf > 0. 6we us quasi-fortin interpol provid properti standard fortin interpol (see, e.g., [35]) proper facet \scrf + h . d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1557 proof. facet f \in \scrf +h line aggreg a, b \in \scrt h definition. fact combin assumpt 6.4 ensur exist quadrat facet bubbl (24) \int f \bfitphi fh \cdot \bfitn \gtrsim | f | > 0, \| \bfitphi f h \| \infti \lesssim 1, \bfitphi f h \cdot \bfitn = 0 \partial ab. note inequ true b line aggregates, fe facet interface, i.e., interior cells. given function \bfitv \in \bfith 1\bfzero (\omega ), let consider, e.g., extend scott--zhang interpol \pi szh (\bfitv h) optim approxim properti theorem 4.4. agf space serendip extensions, consid \u \pi szh (\bfitv h) instead. (24), proper facet f \in \scrf +h , comput \zeta f (\bfitv ) \in \bbbr \zeta f (\bfitv ) \int f \bfitphi fh \cdot \bfitn = \int f (\bfitv - \pi szh (\bfitv )) \cdot \bfitn defin \bfitzeta h(\bfitv ) = \sum f\in \scrf + h \bfitphi fh \zeta f (\bfitv ) \in \bfitv h. thus, take \pi qf h (\bfitv ) . = \pi szh (\bfitv ) + \bfitzeta h(\bfitv ), readili check equal (23). next, prove stabil quasi-fortin interpolant. bound \zeta f (\bfitv ), f \in \scrf +h , follows. let repres af , bf \in \scrt h aggreg share f abf . = af \cup bf . properti facet bubbl (24), extend scott--zhang approxim properti (15), invers inequ (13), cauchy--schwarz inequ yield \zeta f = \int f (\bfitv - \pi szh (\bfitv )) \cdot \bfitn \int f \bfitphi fh \cdot \bfitn \lesssim \int f (\bfitv - \pi szh (\bfitv )) \cdot \bfitn | f | \lesssim \| \bfitv - \pi szh (\bfitv )\| f | f | 1 2 (25) \lesssim h - d - 1 2 \| \bfitv - \pi szh (\bfitv )\| \partial af \lesssim h - d - 1 2 (h - 1 2 \| \bfitv - \pi h(\bfitv )\| af + h 1 2 | \bfitv - \pi h(\bfitv )| 1,af ) \lesssim h - d - 2 2 \| \bfitv \| 1,\nu (af ). scale arguments, result (24) (25), fact interior cell k \in \scrk \mathrm{i}\mathrm{n}h , cardin set \{ \in \scrt h : k \subseteq \nu (a)\} bound independ h, | | | \bfitzeta h(\bfitv )| | | 2 h \leq \sum f\in \scrf + h \| \zeta f\bfitphi fh \| 2 1,abf \lesssim \sum f\in \scrf + h \zeta 2fh d - 2\| \bfitphi fh \| 2 l\infti (abf ) \lesssim \sum f\in \scrf + h \| \bfitv \| 21,\nu (af ) \lesssim \| \bfitv \| 2 1,\omega . result, combin stabil approxim scott--zhang pro- jector triangl inequality, lead stabil quasi-fortin interpol (23): | | | \pi qfh (\bfitv )| | | h \lesssim | | | \pi sz h (\bfitv )| | | h + | | | \bfitzeta h(\bfitv )| | | h \lesssim \| \bfitv \| 1,\omega . prove lemma. follows, us jump oper facets: [[p]](\bfitx ) = lim \epsilon \rightarrow 0+ (p(\bfitx + \epsilon \bfitn ) - p(\bfitx - \epsilon \bfitn )) \foral \bfitx \in f, \foral f \in \scrf h, \bfitn normal facet. d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1558 s. badia, a. f. martin, f. verdugo lemma 6.6. let consid mix fe space \bfitv h\time mh mh . = \scrp - 0,h\cap l 2 0(\omega ). then, ph \in \scrp - 0,h \cap l 2 0(\omega ), exist \bfitv h \in \bfitv h 1 \beta 0 \| ph\| 2 \omega \leq bh(\bfitv h, ph) + \sum f\in \scrf - h h\| [[p]]\| 2f , | | | \bfitv h| | | h \leq \| ph\| \omega ,(26) posit constant \beta 0. proof. reli continu inf-sup condit (3), ph \in \scrp - 0,h\cap l 2 0(\omega ) exist \bfitv \in \bfith 1\bfzero (\omega ) bh(\bfitv , ph) = - (\bfnabla \cdot \bfitv , ph)\omega + (\bfitv \cdot \bfitn , ph)\gamma = - \sum f\in \scrf h (\bfitv \cdot \bfitn , [[ph]])f \geq 1 \beta \| ph\| 2 \omega , \| \bfitv \| 1,\omega \lesssim \| ph\| \omega ,(27) integr part ad contribut cell share interior facet. properti quasi-fortin interpol (23), algebra manipulation, obtain b(\pi qf h (\bfitv ), ph)= - \bigl( \bfnabla \cdot \pi qfh (\bfitv ), ph \bigr) \omega + \bigl( \pi qf h (\bfitv ) \cdot \bfitn , ph \bigr) \gamma = - \sum f\in \scrf h \bigl( \pi qf h (\bfitv ) \cdot \bfitn , [[ph]] \bigr) f = - \sum f\in \scrf + h \bigl( \pi qf h (\bfitv ) \cdot \bfitn , [[ph]] \bigr) f - \sum f\in \scrf - h \bigl( \pi qf h (\bfitv ) \cdot \bfitn , [[ph]] \bigr) f = - \sum f\in \scrf + h (\bfitv \cdot \bfitn , [[ph]])f - \sum f\in \scrf - h \bigl( \pi qf h (\bfitv ) \cdot \bfitn , [[ph]] \bigr) f = - \sum f\in \scrf h (\bfitv \cdot \bfitn , [[ph]])f + \sum f\in \scrf - h \bigl( (\bfitv - \pi qfh (\bfitv )) \cdot \bfitn , [[ph]] \bigr) f .(28) bound term (28) trace inequ (13), local scott-- zhang interpol error estim theorem 4.4 \bfitv \in h1\bfzero (\omega ), second bound (27), young' cauchy--schwarz inequ follows:\sum f\in \scrf - h \bigl( (\bfitv - \pi qfh (\bfitv )) \cdot \bfitn , [[ph]] \bigr) f \leq \sum f\in \scrf - h \| \bfitv - \pi qfh (\bfitv )\| f \| [[ph]]\| f \lesssim \sum f\in \scrf - h (h - 1 2 \| \bfitv - \pi qfh (\bfitv )\| af + h 1 2 \| \bfitv - \pi qfh (\bfitv )\| 1,af )\| [[ph]]\| f \lesssim \sum f\in \scrf - h \| \bfitv \| 1,\nu (af )h 1 2 \| [[ph]]\| f \lesssim \alpha \| \bfitv \| 21,\omega + 1 \alpha \sum f\in \scrf - h h\| [[ph]]\| 2 f \lesssim \alpha \| ph\| 2 \omega + 1 \alpha \sum f\in \scrf - h h\| [[ph]]\| 2 f(29) d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1559 \alpha > 0. combin (27), (28), (29) \alpha larg enough, readili b(\pi qf h (\bfitv ), ph) \geq 1 \beta \| ph\| 2 \omega - c\alpha \| ph\| 2 \omega - c \alpha \sum f\in \scrf - h h\| [[ph]]\| 2 f \geq 1 \beta 0 \| ph\| 2 \omega - c \alpha \sum f\in \scrf - h h\| [[ph]]\| 2 f \beta 0 > 0. prove lemma. let defin l2 interpol extend discontinu lagrangian space follows. given ph \in \scrp - q,h 0 \leq r < q, defin \pi - ,r h (ph) \in \scrp - q,h solut of\bigl( \pi - ,r h (ph), qh \bigr) = (ph, qh)a \foral qh \in \scrp - r,h. lemma 6.7. exist \bfitvarphi h(ph) \in \bfitv h satisfi follow properties: 1 \beta \prime 0 \sum a\in \scrt + h \| ph - \pi - ,0 h (ph)\| 2 \leq bh(\bfitvarphi h(ph), ph), | | | \bfitvarphi h(ph)| | | 2 h \leq \sum a\in \scrt + h \| ph - \pi - ,0 h (ph)\| 2 . (30) proof. assumpt 6.4, proper aggreg \in \scrt +h (i.e., rect- angular cuboid), quadrat bubbl \bfitphi h \in \bfitv h(a) vanish \partial \setminu \gamma satisfi \bfitphi ah (\bfitx ) \geq 0, \int \bfitphi ah \gtrsim | a| > 0, \| \bfitphi h \| \infti \lesssim 1.(31) ph \in mh, defin \bfitvarphi h(ph) . = \sum a\in \scrt + h \phi ah h 2\bfnabla ph.(32) definit norm (21), trace inequ (13), invers inequ (14), readili obtain | | | \bfitvarphi h(ph)| | | h \lesssim h - 1\| \bfitvarphi h(ph)\| \omega . combin result fact \| \phi ah \| \infti ,a \lesssim 1 (32), prove continu bound (30): | | | \bfitvarphi h(ph)| | | 2 h \lesssim \sum a\in \scrt + h h2\| \bfnabla ph\| 2 = \sum a\in \scrt + h h2\| \bfnabla (ph - \pi - ,0 h (ph))\| 2 \lesssim \sum a\in \scrt + h \| ph - \pi - ,0 h (ph)\| 2 . next, note given proper aggreg \subset \scrt +h fe function \bfitv h, scale arguments, properti (31), equival norm finit dimension, c - (\bfitv h,\bfitv h)a \leq \bigl( \phi ah \bfitv h,\bfitv h \bigr) \leq c+ (\bfitv h,\bfitv h)a(33) posit constant independ h cut cell intersections. thus, integr part term (19) definit \bfitvarphi h(ph) statement d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1560 s. badia, a. f. martin, f. verdugo lemma 6.7, fact aggreg bubbl vanish interior facet aggreg boundaries, equival norm (33), obtain bh(\bfitvarphi h(ph), ph) = \sum a\in \scrt + h (\bfitvarphi h(ph),\bfnabla ph)a = \sum a\in \scrt + h h2 \bigl( \phi ah , | \bfnabla ph| 2 \bigr) \gtrsim \sum a\in \scrt + h h2\| \bfnabla ph\| 2 a. (34) hand, (ph - \pi - ,0 h (ph))| \in mh(a) \cap l 2 0(a), hold poincar\'e--wirting inequ scale argument \| ph - \pi - ,0 h (ph)\| \lesssim h\| \bfnabla (ph - \pi - ,0 h (ph))\| = h\| \bfnabla ph\| a.(35) combin (34) (35), prove lemma. theorem, combin inf-sup space aggregate-const pressur lemma 6.6 addit stabil lemma 6.7 prove desir weak inf-sup condition. theorem 6.8. let assum mix fe space \bfitv h\time \scrp - 0,h\cap l 2 0(\omega ) satisfi inf-sup condit (26) lemma 6.6. then, ph \in \scrp - q - 1,h, exist \bfitv h \in \bfitv h 1 \beta q \| ph\| 2 \omega \leq bh(\bfitv h, ph) + \sum f\in \scrf - h h\| [[ph]]\| 2 f+ \sum a\in \scrt - h \| ph + \pi - ,0 h (ph)\| 2 , | | | \bfitv h| | | h \leq \| ph\| , (36) posit constant \beta q. proof. let decompos bh(\bfitv h, ph) follows: bh(\bfitv h, ph) = bh(\bfitv h, \pi - ,0 h (ph)) + bh(\bfitv h, ph - \pi - ,0 h (ph)).(37) \bfitv h \time (\scrp - 0,h \cap l 2 0(\omega )) weakli inf-sup stabl statement theorem, i.e., satisfi (26), exist function \bfitv h 1 \beta 0 \| \pi - ,0h (ph)\| 2 \omega \leq bh(\bfitv h, \pi - ,0 h (ph)) + \sum f\in \scrf - h h\| [[\pi - ,0h (ph)]]\| 2 f , | | | \bfitv h| | | h \leq \| \pi - ,0 h (ph)\| \omega . (38) trace inequ (13), invers inequ (14), stabil \bfitv h weak inf-sup condit (38), young' cauchy--schwarz inequalities, second term (37) bound follows: bh(\bfitv h, \pi - ,0 h (ph) - ph) \lesssim \| \bfitv h\| 1,\omega \| ph - \pi - ,0 h (ph)\| \omega + h - 1 2 \| \bfitv h\| \gamma h 1 2 \| ph - \pi - ,0 h (ph)\| \gamma \lesssim | | | \bfitv h| | | h\| ph - \pi - ,0 h (ph)\| \omega \lesssim \alpha \| \pi - ,0h (ph)\| 2 \omega + 1 \alpha \| ph - \pi - ,0 h (ph)\| 2 \omega .(39) combin (37), (38), (39) \alpha small enough, 1 \beta \ast 0 \| \pi - ,0h (ph)\| 2 \omega \leq bh(\bfitv h, ph) + \sum f\in \scrf - h h\| [[\pi - ,0h (ph)]]\| 2 f + c\| ph - \pi - ,0 h (ph)\| 2 \omega ,(40) d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1561 \beta \ast 0 > 0. hand, \bfnabla ph \in \bfscrp - q - 2,h \bfitvarphi h(ph) \in \bfscrq q(a)\cap \bfith 10(a) \subset \bfitv h \in \scrt + h (see (32)). thus, combin inequ (30) lemma 6.7 (40), obtain, arbitrari posit constant \alpha \prime , bh(\bfitvarphi h(ph) + \alpha \prime \bfitv h, ph) \geq 1 \beta \prime 0 \sum a\in \scrt + h \| ph - \pi - ,0 h (ph)\| 2 + \alpha \prime \beta \ast 0 \| \pi - ,0h (ph)\| 2 \omega - \alpha \prime \sum f\in \scrf - h h\| [[\pi - ,0h (ph)]]\| 2 f - \alpha \prime c\| ph - \pi - ,0 h (ph)\| 2 \omega \geq 1 \beta \prime 0 \sum a\in \scrt + h \| ph - \pi - ,0 h (ph)\| 2 + \alpha \prime \beta \ast 0 \| \pi - ,0h (ph)\| 2 \omega - \alpha \prime \sum f\in \scrf - h h\| [[\pi - ,0h (ph)]]\| 2 f - \alpha \prime c \sum a\in \scrt + h \| ph - \pi - ,0 h (ph)\| 2 - \alpha \prime c \sum a\in \scrt - h \| ph - \pi - ,0 h (ph)\| 2 \geq 1 - \alpha \prime c\beta \prime 0 \beta \prime 0 \sum a\in \scrt + h \| ph - \pi - ,0 h (ph)\| 2 + \alpha \prime \beta \ast 0 \| \pi - ,0h (ph)\| 2 \omega - \alpha \prime \sum f\in \scrf - h h\| [[\pi - ,0h (ph)]]\| 2 f - \alpha \prime c \sum a\in \scrt - h \| ph - \pi - ,0 h (ph)\| 2 \geq 1 - \alpha \prime c\beta \prime 0 \beta \prime 0 \sum a\in \scrt h \| ph - \pi - ,0 h (ph)\| 2 + \alpha \prime \beta \ast 0 \| \pi - ,0h (ph)\| 2 \omega - \alpha \prime \sum f\in \scrf - h h\| [[\pi - ,0h (ph)]]\| 2 f - 1 - 2\alpha \prime c\beta \prime 0 \beta \prime 0 \sum a\in \scrt - h \| ph - \pi - ,0 h (ph)\| 2 .(41) next, note local invers inequ (10) true untrim aggregates. however, extens oper aggregatewis piecewis discontinu fe spaces, hold trim aggregates. trace inequ (12), invers inequ trim aggregates, triangl inequ yield\sum f\in \scrf - h h\| [[\pi - ,0h (ph)]]\| 2 f \leq \sum f\in \scrf - h h\| [[ph - \pi - ,0 h (ph)]]\| 2 f + \sum f\in \scrf - h h\| [[ph]]\| 2 f \lesssim \sum a\in \scrt h \| ph - \pi - ,0 h (ph)\| 2 + \sum f\in \scrf - h h\| [[ph]]\| 2 f .(42) invok (42) (41) pick \alpha \prime small enough, bh(\bfitvarphi h(ph) + \alpha \prime \bfitv h, ph) \gtrsim \| ph - \pi - ,0 h (ph)\| 2 \omega + \| \pi - ,0h (ph)\| 2 \omega - \sum f\in \scrf - h h\| [[ph]]\| 2 f - \sum a\in \scrt - h \| ph - \pi - ,0 h (ph)\| 2 \geq \| ph\| 2 \omega - \sum f\in \scrf - h h\| [[ph]]\| 2 f - \sum a\in \scrt - h \| ph - \pi - ,0 h (ph)\| 2 . d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1562 s. badia, a. f. martin, f. verdugo prove inequ theorem. furthermore, fact \| \pi - ,0h (ph)\| \omega \leq \| ph\| \omega , stabil (30), triangl inequality, | | | \bfitvarphi h(ph) + \alpha \prime \bfitv h| | | 2 h \leq | | | \bfitvarphi h(ph)| | | 2 h + | | | \alpha \prime \bfitv h| | | 2 h \lesssim \sum a\in \scrt + h \| ph - \pi - ,0 h (ph)\| 2 + \| \alpha \prime \pi - ,0h (ph)\| 2 \omega \leq \| ph\| 2 \omega . prove theorem. assumpt 6.9 (pressur stabilization). mix fe space \bfitv h \time mh, consid jh (pressur stabilization) posit semidefinit (\bfitu h, ph), (\bfitv h, qh) \in \bfitv h \time mh hold 1 \gamma j jh(\bfitu h, ph,\bfitu h, ph) \geq \sum a\in \scrt - h \| ph - \pi - ,0 h (ph)\| 2 + \sum f\in \scrf - h h\| [[ph]]\| 2 f - \gamma 2\gamma j | | | \bfitu h| | | 2 h,(43) jh(\bfitu h, ph,\bfitv h, qh) \leq \xi j | | | \bfitu h, ph| | | h| | | \bfitv h, qh| | | h(44) posit constant \gamma j \xi j . theorem 6.10. let assum mix fe space \bfitv h \time mh satisfi inf-sup condit (36) pressur stabil jh satisfi assumpt 6.9. hold 1 \beta d | | | \bfitu h, ph| | | h \leq sup (\bfitv h,qh)\in \bfitv h\time mh ah(\bfitu h, ph,\bfitv h, qh) | | | \bfitv h, qh| | | h (45) posit constant \beta d. proof. first, test function (\bfitu h, ph). inequ (22), ah(\bfitu h, ph,\bfitu h, ph) = ah(\bfitu h,\bfitu h) + jh(\bfitu h, ph,\bfitu h, ph) \geq \gamma a| | | \bfitu h| | | 2 h + jh(\bfitu h, ph,\bfitu h, ph). next, take test function (\bfitv h, 0), \bfitv h satisfi weak inf-sup (36) theorem 6.8, ah(\bfitu h, ph,\bfitv h, 0) = ah(\bfitu h,\bfitv h) + bh(\bfitv h, ph) + jh(\bfitu h, ph,\bfitv h, 0) \geq 1 \beta q \| ph\| 2 \omega - \sum f\in \scrf - h h\| [[ph]]\| 2 f - \sum a\in \scrt - h \| ph - \pi - ,0 h ph\| 2 + ah(\bfitu h,\bfitv h) + jh(\bfitu h, ph,\bfitv h, 0).(46) side, second inequ (22) young' cauchy--schwarz inequ yield ah(\bfitu h,\bfitv h) \leq \xi 2a 4\alpha | | | \bfitu h| | | 2 h + \alpha | | | \bfitv h| | | 2 h \leq \xi 2a 4\alpha | | | \bfitu h| | | 2 h + \alpha \| ph\| 2 \omega arbitrari constant \alpha . side, fact pressur stabil posit semidefinite, cauchy--schwarz young' inequalities, continu (44), stabil \bfitv h (36), d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1563 jh(\bfitu h, ph,\bfitv h, 0) \geq - 1 4\alpha jh(\bfitu h, ph,\bfitu h, ph) - \alpha jh(\bfitv h, 0,\bfitv h, 0) \geq - 1 4\alpha jh(\bfitu h, ph,\bfitu h, ph) - \alpha \xi j | | | \bfitv h| | | 2 h \geq - 1 4\alpha jh(\bfitu h, ph,\bfitu h, ph) - \alpha \xi j\| ph\| 2 \omega .(47) result, combin (46)--(47), take \alpha small enough, obtain ah(\bfitu h, ph,\bfitv h, 0) \gtrsim \| ph\| 2 \omega - \sum f\in \scrf - h h\| [[ph]]\| 2 f - \sum a\in \scrt - h \| ph - \pi - ,0 h (ph)\| 2 - jh(\bfitu h, ph,\bfitu h, ph) - | | | \bfitu h| | | 2 h.(48) take (\bfitu h + \alpha \prime \bfitv h, ph) test function \alpha \prime small enough, (47), (48), assumpt pressur stabil (43), final ah(\bfitu h, ph,\bfitu h + \alpha \prime \bfitv h, ph) \gtrsim | | | \bfitu h| | | 2 h + \alpha \prime c\| ph\| 2 \omega + jh(\bfitu h, ph,\bfitu h, ph) - \alpha \prime c \sum f\in \scrf - h h\| [[ph]]\| 2 f - \alpha \prime c \sum a\in \scrt - h \| ph - \pi - ,0 h (ph)\| 2 \gtrsim | | | \bfitu h| | | 2 h + \| ph\| 2 \omega + jh(\bfitu h, ph,\bfitu h, ph). hand, stabil \bfitv h (36) triangl inequ yield | | | \bfitu h + \alpha \prime \bfitv h, ph| | | h \lesssim | | | \bfitu h, ph| | | h + | | | \alpha \prime \bfitv h| | | h \lesssim | | | \bfitu h, ph| | | h + \| \alpha \prime ph\| \omega \lesssim | | | \bfitu h, ph| | | h. prove theorem. 6.2. mix agfem pressur stabilization. propos algo- rithm satisfi assumpt 6.9 stabil result theorem 6.10. algorithm 6.11. consid hex mesh, veloc space \bfitv h . = \bfscrq q,h, pressur space mh . = \scrp - q - 1,h integ q \geq 2. pressur stabil term taken jh(\bfitu h, ph,\bfitv h, qh) . = \sum f\in \scrf - h \tau j1h ([[ph]], [[qh]])f + \sum a\in \scrt - h \tau j2h 2 ( - \delta \bfitu h+\bfnabla ph, - \delta \bfitv h+\bfnabla qh)a, gh(\bfitf ,\bfitv h) . = \sum a\in \scrt - h h2 (\bfitf , - \delta \bfitv h +\bfnabla qh)a(49) posit algorithm constant \tau j1 \tau j2. agf space reli popular fe space \bfscrq q,h\time \scrp - q - 1,h interior cells. veloc field extend cut cell standard extens oper section 4.2.3, discontinu pressur field extend standard (discontinuous) one. choic motiv proof abstract discret inf-sup condition. theorem 6.12. method propos algorithm 6.11 pressur stabiliza- tion term satisfi assumpt 6.9 satisfi theorem 6.10. result, discret problem (20) well-pos \bfitf \in \bfitl 2(\omega ). d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1564 s. badia, a. f. martin, f. verdugo proof. requir assumpt 6.9, pressur stabil posit semi- definite. order prove (43) holds, us follow inequality. given function v, p hilbert space x u banach space y , defin \gamma 1 2 . = \| u\| y \| v\| x , have, young' inequ arbitrari constant \alpha > 1, 2\| p - v\| 2x = \| p - v\| 2 x + \| p\| 2 x + \| v\| 2 x - 2(p, v)x \geq \| p - v\| 2x + \biggl( 1 - 1 \alpha \biggr) \| p\| 2x - (\alpha - 1)\| v\| 2 x = \| p+ v\| 2x + \biggl( 1 - 1 \alpha \biggr) \| p\| 2x - \alpha - 1 \gamma \| u\| 2y . take \alpha = 1 + \gamma > 1, obtain 2\| p+ v\| 2x \geq \| p+ v\| 2 x + 1 1 + 1 \gamma \| p\| 2x - \| u\| 2 y . let consid x = l2(a), v = h\delta \bfitu h, p = h\bfnabla ph, y = \bfith 1(a), u = \omega 1 2\bfitu h, \in \scrt - h arbitrari posit constant \omega . invers inequ (10), h\| \delta \bfitu h\| \leq c\| \bfitu h\| 1, \~a, \gamma \geq c - 2\omega . previou bound lead to\sum a\in \scrt - h h2\| - \delta \bfitu h +\bfnabla ph\| 2 \geq c \sum a\in \scrt - h h2\| \bfnabla ph\| 2 \omega - \sum a\in \scrt - h \omega \| \bfitu h\| 2 1, \~a.(50) poincar\'e--wirting inequ scale argument yield \| ph - \pi - ,0 h (ph)\| \lesssim h\| \bfnabla (ph - \pi - ,0 h (ph)\| \omega = h\| \bfnabla ph\| \omega .(51) combin (50) (51), lemma 4.3, adjust \omega accordingly, jh(\bfitu h, ph,\bfitu h, ph) \geq \gamma j \sum a\in \scrt - h \| ph - \pi - ,0 h (ph)\| 2 + \gamma j \sum f\in \scrf - h h\| [[ph]]\| 2f - \gamma 2\gamma j \| \bfitu h\| 2 1,\omega posit constant \gamma j . thus, stabil term satisfi assumpt 6.9. continu (44) obtain trace inequ (12)--(13) invers inequ (14). result, (45), prove well-posed discret operator. furthermore, \bfitf \in l20(\omega ), easili prove gh(\bfitf ,\bfitv h) \leq \xi g\| \bfitf \| \omega | | | \bfitv h| | | h. 6.3. mix agfem serendip extension. section, propos mix agfem, make us serendip extens section 4.2.3. reli \bfscrq q,h\time \scrp - q - 1,h interior cells. veloc field extend cut cell serendip extens oper discontinu pressur field extend standard (discontinuous) one. choic motiv proof abstract discret inf-sup condition. method read follows. algorithm 6.13. consid hex mesh, veloc space \bfitv h . = \u \bfscrq q,h, pressur space mh . = \scrp - q - 1,h integ 2 \leq q \leq 2d - 2. pressur stabi- lizat term taken jh(ph, qh) . = \sum f\in \scrf - h \tau j1h ([[ph]], [[qh]])f(52) d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1565 posit algorithm constant \tau j1, gh(\bfitf ,\bfitv h) . = 0. dimensions, q \leq 2d - 3, improp facet set \scrf - h reduc further, consid facet satisfi correspond owner interior cell \scro (af ) \scro (bf ) share fe facet, i.e., | kaf \cap kbf | = \emptyset d - 1 sens (see figur 6(b)). note assumpt 6.4 hold case stabil prove differ strategy. analysi ident section 6.1. comment point differs. theorem 6.14. method propos algorithm 6.13 pressur stabiliza- tion term satisfi assumpt 6.9 satisfi theorem 6.10. result, discret problem (20) well-pos \bfitf \in \bfith - 1(\omega ). proof. first, note serendip fe order 2d - 2, unisolv set dof nodal valu cell boundari zero bubbl function (see [36] details). thus, serendip extens quadrat bubbl function owner cell aggreg zero \omega \setminu \omega \mathrm{i}\mathrm{n} q \leq 2d - 2. therefore, defin aggreg bubbl satisfi (31) aggregates; lemmas/theorem appli need cell interior stabil assumpt 6.4. dimensions, serendip fe order 2d - 3 includ dof correspond quadrat facet bubbles, facet bubbl owner interior cell aggreg extend zero. thus, root neighbor aggreg neighbors, exist facet bubbl satisfi (24). result, subset \scrf - h restrict state definit algorithm, previou lemmas/theorem hold (see figur 6(b)). hand, jh(\bfitu h, ph,\bfitu h, ph) = \sum f\in \scrf - h \tau j1h\| [[ph]]\| 2 f . readili check stabil term satisfi (43). continu result (44) readili obtain trace inequ (12)--(13). result, stabil term satisfi assumpt 6.9. result, (45), prove theorem. 6.4. priori error estimates. point, check algorithm 6.11 6.13 well-posed. next, want prove priori error esti- mate algorithms. proof result fairli straightforward, pressur stabil term consist pressur field h1(\omega ). usual, galerkin orthogonality, stabil theorem 6.12 6.14, approxima- biliti properti theorem 4.4 lead desir results. let note jump stabil (52) (also (49)) modifi integr (potentially) cut facet f \in \scrf h correspond facets. modif provid stabil affect consist method error analysi theorem 6.15 below. theorem 6.15. let consid discret solut (\bfitu h, ph) \in \bfitv h \time mh algorithm 6.11 6.13 (for given order q \geq 1). solut (\bfitu , p) stoke problem (2) belong \bfith \alpha +1(\omega )\time h\alpha (\omega ) \alpha \geq 1, follow priori error estim hold k . = min(q, \alpha ): | | | \bfitu - \bfitu h, p - ph| | | h \lesssim h k\| \bfitu \| hk+1(\omega ) + h k\| p\| hk(\omega ). d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1566 s. badia, a. f. martin, f. verdugo proof. first, let note bilinear form ah algorithm 6.11 6.13 consistent. p \in h1(\omega ), pressur jump stabil vanishes. obviou check interior residual-bas stabil vanish too. let consid extend scott--zhang projector compon veloc \pi szh (\bfitu ) pressur \pi szh (p). galerkin orthogon continu ah (which direct consequ continu result (22)--(44)) yield ah(\bfitu h - \pi szh (\bfitu ), ph - \pi sz h (p),\bfitv h, qh) = ah(\bfitu - \pi sz h (\bfitu ), p - \pi sz h (p),\bfitv h, qh) \leq \xi a| | | \bfitu - \pi szh (\bfitu ), p - \pi sz h p| | | h| | | \bfitv h, qh| | | h. take test function (\bfitv h, qh) global inf-sup condit theorem 6.10 satisfi previou inequality, readili | | | \bfitu h - \pi szh (\bfitu ), ph - \pi sz h (p)| | | h \leq \beta d ah(\bfitu h - \pi szh (\bfitu ), ph - \pi sz h (p),\bfitv h, qh) | | | \bfitv h, qh| | | h \leq \beta d\xi a| | | \bfitu - \pi szh (\bfitu ), p - \pi sz h (p)| | | h. finally, approxim properti extend scott--zhang projector the- orem 4.4 trace inequ (13) yield | | | \bfitu - \pi szh (\bfitu ), p - \pi sz h p| | | 2 h = \| \bfnabla (\bfitu - \pi sz h (\bfitu ))\| 2 \omega +\| h - 1 2 (\bfitu - \pi szh (\bfitu ))\| 2 \gamma +\| p - \pi sz h p\| 2 \omega \lesssim h2k\| \bfitu \| 2hk+1(\omega ) + h 2k\| p\| 2hk(\omega ). prove theorem. 6.5. condit number bounds. well-known extend fe space aggreg lead arbitrari ill-condit systems, small cut cell problem, i.e., ratio \eta k tend zero (see [12] details). thus, arbitrarili high condit number expect practic posit interfac control valu \eta k arbitrarili close zero. motiv agfem [15]. prove follow theorem agfem propos stoke problem lead condit number bound body- fit methods, i.e., depend cut cell intersection. repres | \cdot | \ell 2 euclidean norm vector matrices. theorem 6.16. condit number matric aris algorithm 6.11 6.13, i.e., \kappa (ah) . = | ah| \ell 2 | - 1h | \ell 2 , satisfi \kappa (ah) \leq c\kappa h - 2 posit constant c\kappa . proof. first, note \bfitu h \in \bfitv h state term global basi fe shape function \sum nu a=1 ua\bfitphi u. defin cartesian norm vector dof valu \bfitu h | \bfitu h| \ell 2 . proce analog pressure, e.g., ph =\sum np a=1 pa\phi p \in mh; note pressur space dimens np - 1 zero mean restriction, i.e., mh \subset l20(\omega ). let repres velocity-pressur function \bfitv h\time mh bold capit greek letters. given \phi h . = (\bfitu h, ph), defin | \phi h| 2\ell 2 . = | \bfitu h| 2\ell 2 + | ph| 2 \ell 2 . veloc compon pressure, fact eigenvalu local mass matrix interior cell bound (see, e.g., [46]) c - mh d| \bfitu h| 2\ell 2 \leq \| uh\| 2 \omega \mathrm{i}\mathrm{n} \leq c+mhd| \bfitu h| 2\ell 2 . result, combin stabil extens oper lemma 4.3, yield c - mh d| \bfitu h| 2\ell 2 \leq \| \bfitu h\| 2 \omega \leq c + mh d| \bfitu h| 2\ell 2 .(53) d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1567 proce analog pressur space. now, bound follow veloc norm invers inequ (14), trace inequ (12), norm relat (53), follows: | | | \bfitu h| | | 2 h = \| \bfnabla \bfitu h\| 2 \omega + \| h - 1 2\bfitu h\| 2 \gamma \lesssim h - 2\| \bfitu h\| 2 \omega \lesssim h d - 2| \bfitu h| 2\ell 2 . thus, | | | \phi h| | | 2 h \lesssim h d - 2| \phi h| 2\ell 2 \phi h \in \bfitv h\time mh. friedrich inequ (53) yield | \bfitu h| 2\ell 2 \leq c(\omega )h - d\| \bfitu h\| 2 \omega \lesssim c(\omega )h - d| | | \bfitu h| | | 2 h. result, c(\omega ) - 1hd| \bfitu h| 2\ell 2 \lesssim | | | \bfitu h| | | 2 h \lesssim h d - 2| \bfitu h| 2\ell 2 .(54) bound norm ah continu (from continu result (22) (44)) norm equival (54) veloc version (53) pressur follows: | ah| \ell 2 = max \bfphi h\in \bfitv h\time mh max \bfpsi h\in \bfitv h\time mh ah(\phi h,\psi h) | \phi h| \ell 2 | \psi h| \ell 2 \leq \xi | | | \phi h| | | h| | | \psi h| | | h | \phi h| \ell 2 | \psi h| \ell 2 \lesssim hd - 2.(55) make abus notation, us ah\phi h . = ah(\phi h, \cdot ). next, provid lower bound norm oper ah\phi h \phi h \in \bfitv h\time mh. inf-sup condit theorem 6.10 norm equival (54), obtain | ah\phi h| \ell 2 = max \bfpsi h\in \bfitv h\time mh ah(\phi h,\psi h) | \psi h| \ell 2 = max \bfpsi h\in \bfitv h\time mh ah(\phi h,\psi h) | | | \psi h| | | h | | | \psi h| | | h | \psi h| \ell 2 \geq \beta d| | | \phi h| | | h min \bfpsi h\in \bfitv h\time mh | | | \psi h| | | h | \psi h| \ell 2 .(56) combin (56) lower bound (54), | ah\phi h| \ell 2 \gtrsim hd| \phi h| \ell 2 . take \phi h = - 1 h \psi h, readili obtain | \psi h| \ell 2 \gtrsim h d| - 1h \psi h| \ell 2 . thus, | - 1 h | \ell 2 \lesssim h - d, which, (55), prove theorem. 7. numer experiments. main purpos section evalu perform agf space differ scenarios. start converg test (cf. section 7.2), numer valid priori error estim section 6.4 condit number bound section 6.5. next, consid move domain test (cf. section 7.3) order check robust method respect small cuts. finally, provid numer solut realist problem (cf. section 7.4) order illustr abil agfem deal complex geometr data. perform linear solver step analyz herein. implement optim scalabl solver stoke problem applic agfem consid futur work. 7.1. setup. cases, solv stoke problem (1) galerkin approxi- mation conform lagrangian fe space indic section 5. consid agf space convent on order evalu benefit cell aggregation. convent (unaggregated) case, use, cell k \in \scrk h, \scrq 2,h \scrp - 1,h space approxim veloc pressures, respect (e.g., dimensions, hexahedr element continu piecewis triquadrat shape function velocity, discontinu piecewis linear shape function pressure). aggreg case, consid algorithm 6.13 q = 2, i.e., space \u \scrq 2,h veloc compon (the aggreg version \scrq 2,h serendip extens section 4.2.3) aggreg counterpart \scrp - 1,h d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1568 s. badia, a. f. martin, f. verdugo pressure. order fulfil inf-sup stability, us facet-bas stabil given (52) aggreg space \tau j1 = 0.01 (the valu minim error simpl test set possibl constants). result usual (unaggregated) space label standard numer examples, result cell aggreg label aggregated. algorithm propos work implement tool provid object-ori hpc code fempar [16]. underli system linear equat solv mean robust spars direct solver mkl pardiso packag [47] special design symmetr indefinit matric (to fempar provid appropri interfaces). condit number estim provid comput outsid fempar matlab function condest. numer integr base local body-fit triangul cut cell triangl (in dimensions) tetrahedra (in dimensions), standard quadratur rule applied. local triangul cut cell obtain fempar nodal coordin intersect point cell edg unfit boundari delaunai method avail qhull librari [48, 49]. note submesh integr purpos complet independ cut cell (see [14] details). 7.2. converg test. consid stoke problem defin 2d 3d domain shown figur 7. 2d domain (cf. figur 7(a)) circular caviti defin set differ unit squar [0, 1]2 circl radiu r = 0.3 center c = (0.5, 0.5). 3d domain complex-shap caviti defin set differ unit cube [0, 1]3 3d bodi shape remind popcorn flake (cf. figur 7(b) 7(c)). ``popcorn-flake"" geometri literatur studi perform unfit fe method (see, e.g., [8]). popcorn flake geometri consid obtain take defin [8], scale factor 0.5 translat valu 0.5 direct bodi fit unit cube [0, 1]3. consid dirichlet boundari condit interior wall cavities, neumann condit impos facet unit squar unit cube (see figur 7). dirichlet boundari condit impos nitsche' method discuss section 5. physic domain \omega dirichlet boundari \gamma \mathrm{d} neumann boundari \gamma \mathrm{n} (a) 2d case. (b) 3d case (outer view). (c) 3d case (intern view). fig. 7. converg test: view problem geometries. d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1569 us method manufactur solut order problem known exact solution, comput discret errors. (man- ufactured) exact solut consid (57) \bfitu . = \bfitu \ast | \bfitu \ast | , p . = x3y3, \bfitu \ast = ( - y + 0.5, x+ 0.3)t , (x, y) \in \omega \subset \bbbr 2 dimensions, \bfitu \ast = (y - 0.5, - x - z - 0.3, y - 0.5)t , (x, y, z) \in \omega \subset \bbbr 3 dimensions. solut correspond (divergence-free) veloc field magnitud 1 spin point (x, y) = ( - 0.3, 0.5) 2d case line (x, y, z) = ( - z - 0.3, 0.5, z), z \in \bbbr , dimens (see figur 8). particular valu boundari condit (both dirichlet neumann) extern load defin (57) exact solut stoke problem (1). (a) 2d case. (b) 3d case. 10 fig. 8. converg test: view manufactur solut (vectors/streamlin color pressur field). numer approxim famili uniform cartesian mesh obtain divid direct unit squar cube 2m parts, m = 3, 4, . . . , 9 dimens m = 3, 4, 5 dimensions. obtain result displai figur 9, 10, 11. figur 9 show scale condit number underli linear sys- tem mesh refined. agf spaces, condit number scale expect convent fe method body-fit mesh (i.e., condit num- ber proport h - 2), confirm theoret condit number bound deriv section 6.5. behavior observ 2d 3d cases. line 3d case figur 9(b) points, abl estim condit number 3d mesh larg memori demand condest function matlab. benefit cell aggreg clearli illustr figur 9. standard fe space cell aggreg lead condit number scale proport h - 2. theoretically, condit number arbitrarili larg cell aggreg depend cell cut, lead practic errat scale condit number reach larg values, shown red line figur 9. hand, figur 10 11 report converg h1 semi- norm l2 norm discret error veloc field, l2 norm d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1570 s. badia, a. f. martin, f. verdugo standard aggreg 3.0 2.5 2.0 1.5 1.0 0.5 log10 (max(h)) 0 5 10 15 20 25 30 35 40 lo g 1 0 (c o n d e s t (a ) ) slope -2 (a) 2d case. 1.2 1.1 1.0 0.9 log10 (max(h)) 0 5 10 15 20 25 30 35 40 lo g 1 0 (c o n d e s t (a ) ) slope -2 (b) 3d case. fig. 9. converg test: scale condit number mesh refinement. standard aggreg 1 2 3 log10 ( (dof)1/d ) 10 9 8 7 6 5 4 3 2 1 lo g 1 0 ( | u h u | 1, |u | 1, ) slope -2 (a) veloc h1 semi-norm. 1 2 3 log10 ( (dof)1/d ) 10 9 8 7 6 5 4 3 2 1 lo g 1 0 ( u h u u ) slope -3 (b) veloc l2 norm. 1 2 3 log10 ( (dof)1/d ) 10 9 8 7 6 5 4 3 2 1 lo g 1 0 ( p h p p ) slope -2 (c) pressur l2 norm. fig. 10. converg test: converg discret error 2d case (d = 2). discret error pressur field 2d 3d cases, respectively. consid second polynomi order veloc pressures, optim converg order order converg veloc error measur l2 norm, second order veloc error h1 seminorm, d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1571 standard aggreg 1.2 1.4 1.6 1.8 2.0 log10 ( (dof)1/d ) 6 5 4 3 2 1 lo g 1 0 ( | u h u | 1, |u | 1, ) slope -2 (a) veloc h1 semi-norm. 1.2 1.4 1.6 1.8 2.0 log10 ( (dof)1/d ) 6 5 4 3 2 1 lo g 1 0 ( u h u u ) slope -3 (b) veloc l2 norm. 1.2 1.4 1.6 1.8 2.0 log10 ( (dof)1/d ) 6 5 4 3 2 1 lo g 1 0 ( p h p p ) slope -2 (c) pressur l2 norm. fig. 11. converg test: converg discret error 3d case (d = 3). second order pressur error l2 norm. plot agf space lead optim fe converg orders, turn confirm analysi section 6.4. note standard (unaggregated) fe space lead optim converg order 2d case (cf. figur 10). however, clearli case dimens (cf. figur 11). underli linear system ill-condit (reach condit number 1035 previous shown figur 9) gener reli result comput linear solver doubl precis float point arithmetics. potenti caus nitsche' method lose stabil case cut cell thin, provid standard method select penalti nitsche' method globally, instead cellwis definit reli local eigenvalu solvers. encount situat linear solver abl provid accur solut reason comment above; see, e.g., red line figur 11(c). note discret error standard aggreg method figur 10 11 close (for case solver provid meaning solut standard case). study, manufactur solut smooth, particular boundaries. however, flow problem boundari layers, converg rate expected, potenti offset error plot standard aggreg method fact aggreg increas characterist size (also reduc number dofs) vicin boundaries. case, h-adapt natur elegantli solv issue, object futur research. 7.3. move domain experiment. second numer experiment, studi robust unfit fe formul respect rel posit problem geometri background mesh. end, consid geometri definit parametr scalar valu \ell (cf. figur 12). 2d geometri circular cavity, radiu r = 0.225 d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1572 s. badia, a. f. martin, f. verdugo (a) 2d case. (b) 3d case (intern view). fig. 12. move domain experiment: view problem geometries. standard aggreg 0.3 0.4 0.5 0.6 0.7 ` 0 10 20 30 40 lo g 1 0 (c o n d e s t (a ) ) (a) 2d case. 0.3 0.4 0.5 0.6 0.7 ` 0 10 20 30 40 lo g 1 0 (c o n d e s t (a ) ) (b) 3d case. fig. 13. move domain experiment: condit number versu domain position. center locat arbitrari point diagon unit squar (cf. figur 12(a)). 3d domain caviti defin popcorn flake geometri (cf. figur 12(b)). case, scale popcorn flake converg test (cf. section 7.2) factor 0.5 place arbitrari point diagon unit cube. cases, posit bodi control valu paramet \ell (i.e., distanc center bodi select vertex square/cube). valu \ell varies, object rel posit respect background mesh changes. process, arbitrari small cut cell up, lead potenti ill-condit problems. experiment, consid background mesh discret unit square/cub 2m element direction, m = 5 2d case m = 4 3d case. figur 13 show condit number estim underli linear system versu \ell . plot gener sampl 200 differ valu \ell . observ agf space lead condit number nearli independ valu \ell , show agfem robust regardless cell cut. benefit aggreg clearli demonstr observ d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1573 inflow outflow 75.00.0 53.0 - 1.4 (a) problem geometry. (b) veloc (magnitude). (c) pressure. fig. 14. complex 3d examples: problem geometri numer solut stoke flow spheric obstacl (streamlin color veloc magnitud pressure). result associ standard fe spaces. case, condit number sensit posit geometri reach high valu (condit number greater 1035 3d case). 7.4. complex 3d examples. conclud numer exampl simul complex geometri order cell aggreg effect complex settings. complex exampl sim- ulat stoke flow set randomli spheric obstacl (see figur 14). (fluid) domain set differ unit cube [0, 1]3 spheric obstacles. consid homogen dirichlet condit (no-slip conditions) surfac spheric obstacl nitsche' method. inflow boundari face x = 0 unit cube (see figur 14(a)), impos prescrib polynomi inflow veloc profil value: \bfitu = (10y(i - 1)z(z - 1), 0, 0), (x, y, z) \in \gamma \mathrm{i}\mathrm{n} = \{ 0\} \time [0, 1]2. outflow boundari face x = 1 unit cube, impos homoge- neou neumann boundari conditions. impos homogen dirichlet condit remain face cube. problem simul background cartesian mesh defin cube 25 element direction. obtain nu- meric solut plot figur 14(b) 14(c). note approxim veloc clearli conform unfit surfac interpol slightli coarsen near surfac cell aggregation. second complex exampl stoke flow insid spiral pipe (see figur 15). radiu tubular cross section pipe 0.1, radiu spiral central axi 0.875. impos homogen dirichlet condit wall spiral. inflow boundari termin cross section pipe, i.e., disk center c = (0, 0.875, 0.86) radiu r = 0.1 (see figur 15(a)). inflow boundari impos parabol veloc profil valu \bfitu = \biggl( 10 - 10 r2 r2 , 0, 0 \biggr) , r \in [0, r] distanc point x inflow boundari center c. homogen neumann boundari condit consid outflow d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1574 s. badia, a. f. martin, f. verdugo inflow outflow 1001.8 2.8 \cdot 104 - 2.8 \cdot 10 - 5 (a) problem geometry. (b) veloc (magnitude). (c) pressure. fig. 15. complex 3d examples: problem geometri numer solut stoke flow spiral pipe (streamlin color veloc magnitud pressure). boundary. like previou example, problem simul uniform cartesian mesh unit cube 25 element direction. result shown figur 15(b) 15(c). note challeng exampl cell-aggreg strategi surfac volum ratio high, comput result reproduc perfectli laminar veloc field flow smoothli spiral pipe. 8. conclusions. work, develop mix agfem approx- imat stoke problem unfit meshes. consid standard extens oper definit agf space new reli extens serendip compon (for hex meshes). cell aggreg algorithm allow start fe mesh creat aggreg partit desir properties. agf space readili comput typic fe space plu simpl cellwis constraints. sake conciseness, consid start point mix fe method body-fit mesh discontinu pressur space hexahedr meshes, consid standard serendip extens veloc field. perform abstract stabil analysi reli set assumptions, order prove weak inf-sup condit mix agf spaces. analysi show potenti defici unfit discret inf-sup spaces. allow identifi subset aggregates/facet (close boundary), coin improp aggregates/facets; subset depend mix agf space used. base abstract stabil analysis, defin differ algorithm satisfi requir assumpt have stability. algorithm reli standard veloc extens plu interior (residual-based) stabil improp aggreg pressur jump stabil improp facets. second algorithm reli serendip extens veloc field compon pressur jump stabil improp facets. algorithms, complet numer analysi prove stability, priori error estimates, condit number bound affect small cut cell problem. complet set numer experi bear numer analysis. finally, mix agfem appli problem nontrivi geometries, viz., free flow medium inclus confin flow spiral. d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. mix aggreg finit element method b1575 acknowledgments. author want thank anonym refere thorough revis previou version manuscript. suggest com- ment substanti improv paper. author thankfulli acknowledg resourc marenostrum-iv technic support provid barcelona supercomput center (res-activityid: fi-2018-1-0014). refer [1] n. sukumar, n. mo\"es, b. moran, t. belytschko, extend finit element method three-dimension crack modelling, internat. j. numer. method engrg., 48 (2000), pp. 1549--1570. [2] s. badia, f. nobile, c. vergara, fluidstructur partit procedur base robin transmiss conditions, j. comput. phys., 227 (2008), pp. 7027--7051. [3] h. sauerland t.-p. fries, extend finit element method two-phas free- surfac flows: systemat study, j. comput. phys., 230 (2011), pp. 3369--3390. [4] e. burman, d. elfverson, p. hansbo, m. larson, k. larsson, shape optim cut finit element method, comput. method appl. mech. engrg., 328 (2018), pp. 242--261. [5] m. chiumenti, e. neiva, e. salsi, m. cervera, s. badia, j. moya, z. chen, c. lee, c. davies, numer model experiment valid select laser melting, addit manufacturing, 18 (2017), pp. 171--185. [6] c. lang, a. sharma, a. doostan, k. maute, heavisid enrich extend stochast fem problem uncertain materi interfaces, comput. mech., 56 (2015), pp. 753--767. [7] t. belytschko, n. mos, s. usui, c. parimi, arbitrari discontinu finit elements, internat. j. numer. method engrg., 50 (2001), pp. 993--1013. [8] e. burman, s. claus, p. hansbo, m. g. larson, a. massing, cutfem: discret geometri partial differenti equations, internat. j. numer. method engrg., 104 (2015), pp. 472--501. [9] d. schilling m. ruess, finit cell method: review context higher-ord structur analysi cad image-bas geometr models, arch. comput. method engrg., 22 (2014), pp. 391--455. [10] j. parvizian, a. dster, e. rank, finit cell method: h- p-extens embed domain problem solid mechanics, comput. mech., 41 (2007), pp. 121--133. [11] a. d\"uster, j. parvizian, z. yang, e. rank, finit cell method three-dimension problem solid mechanics, comput. method appl. mech. engrg., 197 (2008), pp. 3768--3782. [12] f. prenter, c. v. verhoosel, g. j. van zwieten, e. h. van brummelen, condit number analysi precondit finit cell method, comput. method appl. mech. engrg., 316 (2017), pp. 297--327. [13] m. dauge, a. d\"uster, e. rank, theoret numer investig finit cell method, j. sci. comput., 65 (2015), pp. 1039--1064. [14] s. badia f. verdugo, robust scalabl domain decomposit solver unfit finit element methods, j. comput. appl. math., 344 (2018), pp. 740--759. [15] s. badia, f. verdugo, a. f. martin, aggreg unfit finit element method ellipt problems, comput. method appl. mech. engrg., 336 (2018), pp. 533--553. [16] s. badia, a. f. martn, j. principe, fempar: object-ori parallel finit element framework, arch. comput. method engrg., 25 (2018), pp. 195--271. [17] fempar, [18] e. burman p. hansbo, fictiti domain finit element method cut elements: ii. stabil nitsch method, appl. numer. math., 62 (2012), pp. 328--341. [19] e. burman, ghost penalty, c. r. math., 348 (2010), pp. 1217--1220. [20] j. preuss, higher order unfit isoparametr space-tim fem move domains, master' thesis, univers gottingen, 2018. [21] c. lehrenfeld m. olshanskii, eulerian finit element method pde time- depend domains, arxiv:1803.01779, 2018. [22] k. h\"ollig, u. reif, j. wipper, weight extend b-spline approxim dirichlet problems, siam j. numer. anal., 39 (2001), pp. 442--462. [23] t. r\"uberg f. cirak, subdivision-stabilis immers b-spline finit element move boundari flows, comput. method appl. mech. engrg., 209 (2012), pp. 266--283. [24] t. r\"uberg f. cirak, fixed-grid b-spline finit element techniqu fluidstructur interaction, internat. j. numer. method fluids, 74 (2014), pp. 623--660. d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. b1576 s. badia, a. f. martin, f. verdugo [25] c. helzel, m. berger, r. leveque, high-resolut rotat grid method conserva- tion law embed geometries, siam j. sci. comput., 26 (2005), pp. 785--809. [26] a. johansson m. g. larson, high order discontinu galerkin nitsch method ellipt problem fictiti boundary, numer. math., 123 (2013), pp. 607--628. [27] f. kummer, extend discontinu galerkin method multiphas flows: spatial dis- cretization, center turbul research annual research briefs, 2013, pp. 319--333. [28] e. burman p. hansbo, fictiti domain method cut elements: iii. stabi- lize nitsch method stokes' problem, esaim math. model. numer. anal., 48 (2014), pp. 859--874. [29] p. hansbo, m. g. larson, s. zahedi, cut finit element method \{ stokes\} interfac problem, appl. numer. math., 85 (2014), pp. 90--114. [30] l. cattaneo, l. formaggia, g. f. iori, a. scotti, p. zunino, stabil extend finit element approxim saddl point problem unfit interfaces, calcolo, 52 (2015), pp. 123--152. [31] j. guzm\'an m. olshanskii, inf-sup stabil geometr unfit stoke finit elements, math. comp., 87 (2018), pp. 2091--2112. [32] a. massing, m. g. larson, a. logg, m. e. rognes, stabil nitsch fictiti domain method stoke problem, j. sci. comput., 61 (2014), pp. 604--628. [33] c. burstedde, l. c. wilcox, o. ghattas, p4est: scalabl algorithm parallel adap- tive mesh refin forest octrees, siam j. sci. comput., 33 (2011), pp. 1103--1133. [34] h. brezis, function analysis, sobolev space partial differenti equations, springer, new york, 2010. [35] a. ern j.-l. guermond, theori practic finit elements, springer, new york, 2004. [36] d. n. arnold g. awanou, serendip famili finit elements, found. comput. math., 11 (2011), pp. 337--344. [37] d. n. arnold, d. boffi, r. s. falk, approxim quadrilater finit elements, math. comp., 71 (2002), pp. 909--922. [38] s. c. brenner r. scott, mathemat theori finit element methods, springer, new york, 2010. [39] a. johansson m. g. larson, high order discontinu galerkin nitsch method ellipt problem fictiti boundary, numer. math., 123 (2013), pp. 607--628. [40] a. hansbo p. hansbo, unfit finit element method, base nitsche' method, ellipt interfac problems, comput. method appl. mech. engrg., 191 (2002), pp. 5537--5552. [41] h. wu y. xiao, unfit hp-interfac penalti finit element method ellipt interfac problems, arxiv:1007.2893, 2010. [42] l. r. scott s. zhang, finit element interpol nonsmooth function satisfi boundari conditions, math. comp., 54 (1990), pp. 483--493. [43] r. becker, mesh adapt dirichlet flow control nitsche' method, commun. numer. method engrg., 18 (2002), pp. 669--680. [44] j. nitsche, \"uber ein variationsprinzip zur l\"osung von dirichlet-problemen bei verwendung von teilr\"aumen, die keinen randbedingungen unterworfen sind, abh. math. semin. univer. hamb., 36 (1971), pp. 9--15. [45] c. bernardi, m. costabel, m. dauge, v. girault, continu properti inf-sup constant divergence, siam j. math. anal., 48 (2016), pp. 1250--1271. [46] h. c. elman, d. j. silvester, a. j. wathen, finit element fast iter solvers: applic incompress fluid dynamics, oxford univers press, new york, 2005. [47] intel mkl pardiso--parallel direct spars solver interface, articles/intel-mkl-pardiso. [48] qhull, [49] c. b. barber, d. p. dobkin, h. huhdanpaa, quickhul algorithm convex hulls, acm trans. math. software, 22 (1996), pp. 469--483. d ow nl oa d 01 /0 8/ 19 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp introduct problem statement fe space aggreg finit element space embed boundari setup cell aggreg aggreg finit element space nodal lagrangian aggreg finit element space discontinu aggreg finit element space aggreg finit element serendip extens mathemat properti approxim stoke problem numer analysi abstract stabil analysi mix agfem pressur stabil mix agfem serendip extens priori error estim condit number bound numer experi setup converg test move domain experi complex 3d exampl conclus