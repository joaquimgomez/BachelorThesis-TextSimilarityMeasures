variat multiscal base dissip model estim atmospher see joan baiges,1,2 ramon codina2,1 1 centr internacion metod numer lenginyeria (cimne), edifici c1, campu nord upc c/ gran capita s/n 08034 barcelona, spain 2 universitat politecnica catalunya, jordi girona 1-3, edifici c1, 08034 barcelona, spain telf: +0034 934016206 septemb 9, 2014 abstract work present numer model estim atmospher see observ sites. particular method base variat multiscal turbul model, main featur numer mechan deal stabil issu (convect inf-sup condit incompress flows) care model turbulence. base turbul model, develop express viscou thermal dissipations, num num, later evalu constant structur refract index c2n follow classic model develop tatarski. numer exampl behavior propos numer scheme appli turbul flow practic cases, includ convect boundari layer, flow insid transfer optic room, telescop enclosure. content 1 introduct 2 2 incompress navier-stok equat 4 2.1 problem statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 2.2 finit element approxim . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 2.3 turbul viscou dissip oss navier-stok equat . . . . . . . 7 2.4 discret time . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 2.5 fraction step split . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 3 heat transfer equat 10 3.1 problem statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10 3.2 finit element approxim . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 3.3 turbul thermal dissip oss heat transfer equat . . . . . . . . 11 3.4 discret time . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 4 atmospher see paramet 12 1 5 numer exampl 14 5.1 convect boundari layer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14 5.2 transfer optic coud room . . . . . . . . . . . . . . . . . . . . . . . . . . 18 5.3 flow telescop enclosur . . . . . . . . . . . . . . . . . . . . . . . . . 20 6 conclus 23 1 introduct observ univers ground base telescop facilities, effect atmospher turbul qualiti obtain data great importance. especi diamet telescop large, optic distort turbul effect signific prevent observ devic reach maximum theoret resolution. reason extens effort directions: develop adapt optic mechan allow correct phase distor- tion effects. achiev divid main mirror telescop smaller mirror allow sub-mirror independently, allow obtain correct image. approach successfulli appli new gener telescopes, number mirror main mirror need compos speed mirror need chang configur directli depend atmospher turbul intensity. select observ site provid optim atmospher conditions. specif locat world turn optim observ sites. them, canari island spain, hawaii usa atacama desert chile concentr largest telescop world thank pristin see conditions. design telescop facil minim turbul aero- dynam flow them. minim small eddi oscil air flow telescop mirror result optic distortion, mean correct adapt mechan lesser, turn result better acquir images. especi true case solar telescopes, larg tempera- ture gradient ground surfac radiat effect critic impact condit collect data. clear abl evalu suitabl observ site telescop facil design prior telescop construct kei get best possibl perform telescope. also, conveni abl quantifi characterist adapt optic mechan instal telescop beforehand. this, effort devot recent quantif atmospher see paramet numer simulation. numer model quantif temperatur structur func- tion present [20]. [29, 30] atmospher meso-nh numer model comput atmospher see observ site cerro paranal, chile. soon after, methodolog appli simul observ site roqu lo muchachos, canari islands, spain [31]. [7, 8, 6] larg eddi simul (les) model run weather forecast simul softwar character near-surfac optic tur- bulenc differ climat condit observ sites. see model make 2 us turbul kinet energi provid planetari boundari layer simul softwar comput see mauna kea, hawaii [10, 9]. [22] weather forecast model statist parametr refract index structur constant c2n present [35] order forecast see condit roqu lo muchachos, canari islands, spain. numer weather predict tool [1] comput turbul paramet allow characteris c2n island maui big island, hawaii, similar methodolog present [21]. methodolog common us numer weather predict tool simul see conditions, express c2n deriv differ mesoscal turbul models. [13] present strategi comput atmospher see parameters, which, knowledge, comput method capabl simul see condit local level; is, finit element comput fluid dynam simul resolut rang decimet meter instead mesoscal simul tool coars resolution. propos model comput refract index structur function c2n base larg eddi simul incompress flow temperatur fields, successfulli appli design phase advanc technolog solar telescop (atst) [28] european solar telescop (est) [3, 5]. work present model numer simul c2n function comput variat multiscal (vms) [26] base turbul model. finit element analysis, basic idea vm split unknown finite-el subgrid scale component, subscale. approxim adopt subscal defin numer model. interest featur vm capabl providing, time, numer stabil mechan studi equat (in case, incompress navier-stok equations) turbul model take account under-resolv scale (those captur finit element mesh). studi work [27, 18, 14, 15, 23] success results. advantag kind approach interfer numer stabil turbul model issu taken care numer subgrid scales. method present work orthogon subgrid scale vm method (oss). particular model numer subscal rich manner: subscal consid transient time, non-linear, orthogon finit element space. theoret analysi orthogonal-subscal vm turbul model present [24], extens campaign numer experi present [19]. conclus experi vm turbul model provid accur represent turbul phenomena competit comput cost, particular featur turbul model aris numer reason only. work us kinet energi thermal turbul dissip aris oss turbul model order quantifi refract index structur function. paper organ follows. finit element approxim incompress navier-stok equat present section 2, variat multiscal method kinet energi turbul dissip present model problem. section 3, finit element approxim heat transfer equat presented, oss formul thermal energi turbul dissip express temperatur problem. section 4 numer model comput see quantiti aris oss dissip presented. allow comput refract index structur function optic magnitud fri paramet greenwood frequency. numer exampl illustr perform propos numer 3 method section 5. finally, conclus close paper section 6. 2 incompress navier-stok equat 2.1 problem statement section summar orthogon subgrid-scal (oss) approach appli incompress navier-stok equat describ [11]. let consid transient in- compress navier-stok equations, consist find u : (0, t ) r3 p : (0, t ) r that: tu 2 su + u u +p = f , (1) u = 0 , (2) u = u d, (3) pn + n u = 0 n . (4) t > 0, tu local time deriv veloc field su = 12((u) t +u). r3 bound domain, viscosity, f given sourc term. d dirichlet boundary, veloc boundari condit applied. case numer simul aerodynam telescopes, correspond inflow boundari ground telescop surfaces. n neumann boundary, condit valu traction applied. aerodynam telescop simulations, correspond outflow boundary. appropri initi condit append problem. numer exampl section, sourc term f boussinesq buoyanc forces, appear temperatur gradient form: f = g( 0), thermal expans coefficient, g graviti acceler vector, 0 refer temperatur temperatur fluid. 2.2 finit element approxim let consid finit element approxim equat (1)-(4). defin v = h1()d, v0 = {v v | v = 0 d}. let q = l2() d(0, t ;q) distribut time valu q. variat problem consist find [u, p] l2(0, t ;v )d(0, t ;q) that: (v, tu) + v,u u+ 2 (sv,su) (p, v) = v,f v v0, (5) (q, u) = 0 q q, (6) u = u d. here, (, ) stand l2() inner product , integr product functions, necessarili l2(). let defin b ([v, q], [a;u, p]) := v,a u+ 2 (sv,su) (p, v) + (q, u) , 4 repres convect velocity. galerkin finit element approxim used, known semilinear form b suffer stabil issu convect natur flow, requir compat veloc pressur approxim space classic lbb inf-sup condition. stabil method develop deal issu past decades. them, stabil approach receiv recent year variat multiscal (vms) method. interest featur vm stabil term deriv pure numer reasons, motiv physic point view. physic approach come introduct decomposit gener solut problem finit element solut captur finit element mesh. order introduc subscal concept weak form (5), let consid finit element partit th := {k} defin domain , h denot element size. simplifi exposition, consid th quasi-uniform. partit construct finit element space vh v, qh q. seek approxim solut uh c1(0, t ;vh) ph c0(0, t ;qh). variat multiscal method deriv introduc subscal space veloc field v that: v = vh v . impli veloc solut field veloc test function decom- pose finit element fine scale part: u = uh + u, v = vh + v. decomposit appli pressur field introduc pressur sub- scale space q, describ [12]: q = qh q, p = ph + p, q = qh + q. also, consid subscal vanish element boundaries, contri- bution element face taken account, describ [17]. introduc split equat (5), integr part terms, discret variat problem obtain [uh, ph] vh qh, t [0, t ] u v , p q t [0, t ], that: (vh, tuh) +b ([vh, qh], [u;uh, ph]) + k vh, tuk + k vh u vh qh, uk k vh, pk = vh,f , (7) k v, tuh uh + u uh +phk + k v, tu u + u u +pk = v,f , (8) k q, uhk + k q, uk = 0, (9) 5 test function vh, qh, v, q, , k stand integr product function k. note that, incompress flows, 2 su = u. equat (8) subscal equation, provid closur express veloc pressur subscales, u p. follow step [18] consid equat veloc subscales, omit contribut pressur subscales. allow formul simpler method, implicitli assum veloc subscal residu momentum equations, instead driven incompress constraint. second term equat (8) model follows: k v,u + u uk ' 1 k v, uk , 1 k = ( c1 h2 + c2 |u| h ) , (10) c1 c2 algorithm constants. approxim subscal oper scalar term time product v, u justifi mean fourier analysi problem subscal [12]. replac express equat subscal obtain: k v, tuh uh + u uh +phk + k v, tuk + k 1k v, uk = v,f . (11) equat (11) yield express subscal element interior term finit element component, long v approxim space discontinu functions: tu + 1 k u = pv (f (tuh uh + u uh +ph)) , (12) p v denot project subscal space. equat (12 ) implicitli defin u function uh, ph t: u = u(uh, ph, t). (13) possibl choic space subscales, yield differ projec- tion oper p v . typic choic p v = i, result algebra subgrid-scal formul (asgs). formul favor vm model subscal space orthogon finit element space: v = v h v, consequence: p v = ph, ph l 2() project finit element space. formul call orthogon subgrid scale (oss) formulation. usual result sharper, diffus solut asg method. provid requir express subscal term finit element un- knowns. note equat (12) involv time deriv veloc subscales. consequence, subscal need track time time discret scheme required. note veloc convect term u = uh + u, lead non-linear express veloc subscales. pressur subscal model as: p = p(uh) := p 1 k pq ( uh) , p = c3h 2, (14) 6 follow procedur similar describ veloc subscal equat (10). again, q taken orthogon q: q = qh q. note equat (12) (14) need solv numer integr points, subscal need comput (numerically) integr appear (7). final formul incompress navier-stok equat proven stabl proper choic stabil constant c1 c2. equal important, motiv stabil term aris take account contribut solut captur finit element mesh. reason author [27, 18, 14, 15, 23] decid us numer subscal stabil mechanism, model physic undergo spatial tempor resolut finit element mesh. case navier-stok equat correspond model turbulence. 2.3 turbul viscou dissip oss navier-stok equat let focu numer dissip (and turbulent, attend physic mean subscales) scheme. defin kinet energi unit volum insid comput domain as: w := 1 2 |u|2. balanc kinet energi continu problem obtain take test function v equal veloc u, test function q equal pressur p, multipli (5) (6) densiti . manipul arriv to: t w + n uw = u, f 2 (su,su) , (15) dynam viscosity. equat (15) sai variat kinet energi comput volum t w flux kinet energi domain boundari n uw , increment kinet energi bodi forc u, f (extern power) decrement kinet energi viscou dissip = (u,u). discret counterpart (15) obtain take vh = uh, qh = ph (7): t wh + n (uh + u)wh = uh, f 2 (suh,suh) k uh, tuk + k uh + (uh + u) uh + ph, uk + k uh, pk , (16) with: wh := 1 2 |uh|2. term involv subscal right-hand equat (16) constitut viscou numer dissipation: dnum := k k num 7 num := uh tu (uh + (uh + u) uh + ph) u uhp. (17) hand, dissip finit element solution: dh = h, h : = 2|su|2. num appear contribut stabil term and, time, take account dissip subscales. order this, let studi simplifi problem neglect contribut pressur subscal p. let neglect contribut uh (which reason highli turbul flow considered, exact linear interpol space chosen uh). furthermore, account that, v v h v, then: k uh, tuk = 0. let defin kinet energi u: w := 1 2 |u|2 dissip u: d = k k , = 1k |u| 2, extern power uh u: ph := uh, f , p := u, f . let multipli (8) v = u. case (8) (16) have: t wh + n uwh +dh +dnum = ph, (18) t w + d dnum = p. (19) seen equat (18)-(19) num charg transfer energi larg (finit element) scale subgrid scales. this, num understood dissip caus turbul effect flow (see [19, 24]). interest observ plug equat subscal (12) express num (17) (again take account orthogon subscal neglect p uh): dnum = k k p v (u uh +ph) , pv (u uh +ph) k + k k p v (u uh +ph) , tu k . (20) term right-hand (20) positive. second term appear dynam subgrid scale considered. shown [16] local (in space time) negative, averag time num prove positive. local 8 neg valu num repres transfer energi small scale larg scales, phenomenon known backscatter, observ physic turbul flows. decomposit unknown contribut finit element scale subgrid scales, take account tempor deriv subscal allow oss method model backscatter. let stress backscatt model aris numer decomposit unknown physic model phenomena. numer exampl section dissip valu averag shown convect boundari layer case. numer exampl [16]. finally, total pointwis dissip account numer larg scale dissipation: = h + num, (21) go comput qualiti see estimators. 2.4 discret time discret time, reli finit differ time discretization. consid uniform partit [0, t ] size t. denot time depend function f approxim tn = nt fn tf n approxim tf t n. introduc notation, time discret problem is: [uh, ph] vh qh, t [0, t ] u v , p q t [0, t ], that: (vh, tu n+1 h ) +b ( [vh, qh], [u n+1;un+1h , p n+1 h ] ) + k vh, tu n+1 k + k vh un+1 vh qh, un+1 k k vh, pn+1 k = vh,f n+1 . (22) order approxim tu n+1 h , second order backward differ scheme used: tu n+1 h = 3 2 un+1h 2u n h + 1 2 un1h t . hand, order backward euler scheme integr subscal time: tu n+1 = un+1 t . suffici approxim subscales, since: u = o (k(f (tuh uh + u uh +ph)) , k = o(t). 2.5 fraction step split order minim comput time invert solv (22), reli fraction step split technique. decompos solut monolith solut simpler problems: convection-diffus equat veloc unknown, pressure- poisson equat project step. start note that, choic v = v h v : k vh, tu n+1 k = 0. 9 introduc intermedi veloc uh, consider: unh = u n h, un1h = u n1 h , intermedi veloc pressur subscal un+1and pn+1. step fraction step method are: 1. convection-diffus equation. solv intermedi quantiti un+1h , un+1and pn+1: (vh, tu n+1 h ) +b ( [vh, 0], [u n+1; un+1h , p n h] ) + k vh un+1 vh, un+1 k k vh, pn+1 k = vh,f n+1 , un+1 solut of: un+1 = u ( un+1h , p n h, t n+1 ) defin (13) pn+1 solut of: pn+1 = p(u n+1 h ), defin (14). 2. pressur poisson equation. solv pn+1h u n+1: (qh, un+1h ) k qh, un+1 k = 2t 3 ((pn+1h p n h),qh), un+1 solut of: un+1 = u ( un+1h , p n+1 h , t ) , (23) defin (13). tempor integr (23), consid = un. wai intermedi subscal veloc need track time. 3. project step: solv un+1h : 3 2t (vh,u n+1 h u n+1 h ) + (vh, (p n+1 h p n h) = 0. 3 heat transfer equat 3.1 problem statement section summar finit element approxim heat transfer equat oss approach. let consid transient heat transfer equation, consist find : (0, t ) r3 that: t + u = q , = d, n = 0 n, (24) temperatur field, thermal diffus q heat sourc term. initi condit append problem. 10 3.2 finit element approxim let defin = h1(), finit element space defin finit element partit h . galerkin finit element approxim equat (24) consist find h c1(0, t ; h) that: (h, th) + (h,u h) + (h,h) = h, q h h, (25) correspond initi boundari conditions. similarli navier-stok prob- lem, finit element approxim (25) suffer instabl problem caus convect term. stabil required, physic base numer stabil obtain vm method. follow process analog pre- sent section 2, subscal model function finit element temperatur solut field, h: t + 1 k = p (q (th h + u h)) , (26) k = ( c1 h2 + c2 |u| h )1 . c1 c2 algorithm constants, practic coincid c1 c2 equat (10). again, choic possibl space subgrid scales. navier-stok equations, advoc us orthogon subgrid scales, is, choos space temperatur subscal be: = h . stabil finit element heat transfer problem obtain introduc scale split equat (25) replac subscal approxim (26): (h, th) + (h,u h) + (h,h) + k h, t k + k h u h, k = (h, q) h h. (27) 3.3 turbul thermal dissip oss heat transfer equat navier-stok equations, deal numerical-turbul dissip oss scheme heat transfer equation. start defin thermal energi unit volum comput domain as: h = 1 2 cp 2, cp heat capac densiti fluid. continu thermal energi balanc equat obtain take = equat (25), multipli equat cp. manipulations, take account incompress u, obtain: t h + n uh = , cpq cp (,) . (28) case, variat thermal energi t h comput domain convect flux thermal energi domain boundari n uh, increment thermal energi caus heat sourc , cpq decrement thermal energi 11 caus thermal dissip = cp (,). discret counterpart equat (28) obtain take h = h equat (27): t hh + n uhh = h, cpq cp (h,h) k cph, t k + k cph + cpu h, k , (29) with: hh = 1 2 cp 2 h. term right-hand equat (29) call thermal numer dissipation: enum = k k num (30) num = cpht (cph + cpu h) . (31) num appear contribut stabil term and, num navier- stoke equations, model contribut dissip subscales. consequence, consid model turbul effect flow. note that, contrari models, turbul prandtl number relat turbul viscos turbul thermal diffus requir variat multiscal base turbul model heat transfer equation. total thermal dissip model as: = h + num (32) with: h = cp|h|2. 3.4 discret time associ time discret problem is: h h t [0, t ] that:( h, t n+1 h ) + ( h,u n+1 n+1h ) + ( h,n+1h ) + k h, t n+1 k + k h un+1 h, n+1 k = (h, q) h h. (33) second order backward differ scheme approxim t n+1 h order backward euler scheme approxim subscal deriv respect time, t n+1. 4 atmospher see paramet section paramet quantifi atmospher see facil observ site. relat numer approxim describ section 2 3. focu especi relat turbul dissip num num appear stabil discret finit element equat energi transfer non-resolv scale kolmogorov cascade. 12 final optic paramet aim simul numer fri paramet r0 greenwood frequenc fg. fri paramet essenti adapt optics. case telescop allow determin number segment segment mirror split, distanc actuat continu deform mirror, prescrib admiss rm distort wavefront [2]. design actuat base call greenwood frequency, indic fast atmospher chang defin bandwidth servo control adapt optic (see [33] details). however, paramet function integr optic path light beam structur constant cn refract index medium, n(x, t). [13] detail descript relationship r0, fg cn. structur function relat structur function temperature, humid joint structur paramet (see [32]). however, consid humid effect negligible. thus, write temperatur depend n n = n(), cn = dn d c, c structur function temperature. assum pressur equilibrium [34] cn = 79 106 2 pc, (34) p assum measur millibar absolut temperature. below, , p u denot solut continu problem defin equat (4) (24) overbar denot mean quantiti observ period. view (34), problem comput c. inerti rang kolmogorov spectrum assum temperatur passiv quantity, shown (see [33]) c2 = 2m 1/3 m , (35) empir valu call obukhov-corrsin constant (see [25, 36] extens discuss obukhov-corrsin constant valid approximation). (35), m denot mean molecular thermal diffus dissip m mean molecular dissip kinet energi flow. paramet given m := cp||2, m := 2|su|2. (36) problem closed: (36) (35) result (34) express comput cn term flow variabl u, p, point. question remain open want numer appli previou approxima- tion c2n c 2 . issu that, instead work u, p, , go work uh, ph, h, model veloc temperatur under-resolv scale u given equat (12) (26). point consid relat averag quantiti u, p, , finit element approximations. end recal filter unknown le model need maintain mean origin variables. close relationship present vm turbul model le filtering, assum true finit element variabl uh, ph, h. mean consid u uh, p ph, h. (37) 13 second point comput averag kinet thermal energi dissip m m. order us definit equat (21) (32), comput averag dissip = h + num, = h + num. (38) assum m, m, is, model account properli molecular dissipation. prove particular [24] simplifi setting. mean dissip approxim molecular dissip gener assumpt le models. approxim (37) (38) (35) insert result (34) that: cn = 79 1062h ph 1/21/6. (39) equat (39) express look for. allow comput structur function refract index term flow variabl result vm numer simulation. 5 numer exampl 5.1 convect boundari layer numer exampl consist convect boundari layer. exampl present [8] method estim atmospher see dutch atmospher le method (dales) presented. us compar optic pa- ramet obtain vm base dissip model on obtain smagorinski base dissip model present [13], dissip model base wale subgrid scale model . simul domain parallelepip base squar 10 height 2 km. air flow caus presenc heat flux inferior base (0.1 k m s1) horizont bodi acceler term ( 9.4325105 m s2). boundari condit period later boundari fluid allow trespass superior inferior boundari domain. wall law boundari condit [4] inferior boundary, caus presenc boundari layer example. initi condit given vertic temperatur gradient set 3 k km1 air rest. numer simul run 10000 seconds, time step 1 second. finit element mesh uniform structur tetrahedra mesh total 1.8 million elements. mesh resolut 150 m horizont 150 m vertically. fig. 1 show averag temperatur veloc profil vertic dimension. temperatur profil expect increas mean temperatur heat flux inferior boundari observed. greater height, temperatur valu closer initi condit temperatur profile. horizont veloc profile, boundari layer behavior recov larg veloc gradient close floor. moreover, slight decreas averag veloc observ region temperatur join initi constant vertic gradient (1000 m height). fig. 2 show snapshot veloc temperatur field end simulation. veloc snapshot allow hot air ground tend convect boussinesq forces. temperatur field, hand, smooth, larg temperatur gradient appear ground heat flux caus bubbl hot air appear. final fig. 3 show plot dissip valu kinet energi balanc end simul obtain oss variat multiscal method. plot correspond dissip valu comput 14 numer integr point extrapol node element. element partial white area correspond element dissip numer integr point neg (or dissip extrapol node element negative). plot nodal averag (through lump l2 projection) shown. nodal averag dissip valu posit everywhere. agreement expect behavior model backscatter, dissip valu local neg (account transmiss energi small scale larg scales), need posit averag space time. fig. 4 show comparison c2n field obtain oss base model comput viscou thermal dissip structur constants, smagorin- sky wale models. observ model yield qualit similar results: magnitud structur constant c2n larg close ground, larg temperatur gradient exist thermal heat flux. meters, c2n valu start diminish height (a cyan region denote), c2n coeffici magnitud larger region hot air bubbl move (vertic yellow patch close ground). mid-height region fig. 4 (correspond height 1000 m) hot bubbl disappear effect domin horizont flow. region, increas c2n valu observed. height 1500 m, c 2 n valu diminish again. non-trespass boundari condition, spuriou increas c2n valu observ wall. increas appear fact larg gradient veloc obtain non-trespass boundari condition, real open-flow boundari condit (which reproduc numer level). note c2n field smoother smagorinski wale model oss model. probabl caus fact smagorinski wale model dissip base gradient recov fields, dissi- pation oss model base compon residu orthogon finit element space, undoubtedli smooth. finally, fig. 5 show comparison horizont averag c2n valu end simulation, includ result [8] dale model. clear present result result [8] qualit similar. however, increas c2n mid-height occur lower height result [8]. largest differ obtain region close ground. caus fact c2n paramet sensit small variat temperatur gradients. region present largest temperatur gradients, small deviat comput temperatur gradient caus larg variat obtain c2n values. spite this, result present good agreement result [8], since, height (except region close ground), lai standard deviat mean distribut result statist collect [8]. result allow state c2n valu obtain orthogon subgrid scale model distribut qualit obtain physic base le model (smagorinsky, wale dale model [8]). c2n valu depend turbul dissip model, mean viscou thermal turbul dissip obtain oss method qualit on physic base le models. remarkable, express dissip motiv exclus numer argument case oss, contrast physic base argument deriv le turbul dissipations. 15 figur 1: temperatur (left) horizont veloc (right) averag profil figur 2: temperatur k (top) veloc (bottom) snapshot end simul 16 figur 3: dissip valu kinet energi balance: numer integr point (top) nodal averag (bottom) values. figur 4: c2n snapshot end simulation. bottom: variat multiscale, smagorinsky, wale model. 17 10 18 10 16 10 14 10 12 0 200 400 600 800 1000 1200 cn2 h e ig h t (m ) cn2 vs height cn2 smagorinski cn2 vm cn2 wale cn2 cheinetsiebesma cn2 cheinetsiebesma figur 5: averag (horizontally) c2n valu end simulation. comparison result [8]. green dot line repres valu lie standard deviat statist data collect [8]. 5.2 transfer optic coud room second exampl correspond transfer optic chamber coud room. geometri boundari condit case provid astrophys institut canari island design phase european solar telescop (est). fig. 6 show geometri boundari condit case. sphere plot repres concentr heat loads, consist 300 mm provid heat sourc 2w (7.0738 w/m2). thermal control consist air plenum blow air ambient temperatur (20 c), vertic veloc equal 1 m/s, vertic direct chamber (plenum area = 22.1 m2). return air plenum place lower chamber (plenum area = 314.16 m2). object case analyz see degrad transfer optic chamber. veloc boundari condit later wall heat sphere correspond wall-law condition. inflow veloc set 1 m/s, outflow veloc left free. numer simul run 100 seconds, flow consid complet developed. time step set 0.2 seconds. finit element mesh compos 3.4 million tetrahedra, local refin region close heat sphere (element size equal 0.03 m) larger element region far (element size equal 0.3 m) . fig. 7 show veloc temperatur snapshot flow complet de- veloped. veloc larger central region, inject air flow circulating. heat sphere oppos flow, caus boundari layer appear. neg effect result see conditions. tem- perature, largest temperatur temperatur gradient surfac heat spheres, hot air jet follow path vertic air inflow. fig. 8 show comparison c2n valu transfer optic room, obtain 18 figur 6: geometri transfer optic coud room (distanc mm) figur 7: veloc (left) temperatur c (right) snapshot transfer optic coud room. 19 oss, smagorinski wale models. clear model provid similar result case, c2n field smooth oss case. 5.3 flow telescop enclosur exampl simul atmospher see telescop enclosure. par- ticular, correspond tent design european - extrem larg telescop (e-elt) enclosure. fig. 9 show geometri enclosure. object simul evalu effect frontal wind shield atmospher seeing. enclosur 4 meter size window facilit natur ventil building. enclosur diamet 85 m, maximum height 79 m. extern domain simul 600 600 1500 m3 box. finit element mesh compos 3.3 million tetrahedra, element size rang 1 m (close telescope) 20 m (in open flow region). wall-law veloc boundari condit [4] set ground build surfaces, non-trespass boundari condit set later wall bound box. inflow veloc set 1 m/s. temperatur boundari conditions, impos follow express temperatur function height: = 12 0.7 ln ( z + 0.01 0.02 ) height z express meter result temperatur express c. initi temperatur profil depict fig. 10. fig. 11 show veloc temperatur field cut stream-wis direct flow fulli developed. turbul vortex appear telescope, largest veloc gradient occur surfac telescope. maximum absolut valu veloc appear flow detach telescop enclosure, low-spe recircul zone observ leeward telescope. temperatur field, maximum temperatur temperatur gradient surfac telescope. interior telescop show larger temperatur compar exterior domain, despit larg ventil window place order minim temperatur gradients. intermedi temperatur valu recircul area telescope. fig. 12 show comparison c2n profil obtain oss, smagorinski wale dissip models. previou cases, maximum valu c2n paramet region veloc temperatur gradient larger, coincid terrain ground, telescop enclosur surfac area detach flow occurs. low speed recircul zone telescop show larg valu c2n parameter, larg temperatur gradients. compar result models, result qualit equivalent, result smoother smagorinski wale models. let agreement remark account expres- sion calcul dissip motiv physic argument case le model and, contrary, numer argument case oss variat multiscal method. 20 figur 8: c2n snapshot coud room. variat multiscal (top left), smagorinski (top right) wale (bottom) models. 21 figur 9: extern geometri e-elt enclosure. front, perspect views. 4 5 6 7 8 9 10 11 12 0 100 200 300 400 500 600 t (c) h e ig h t (m ) figur 10: temperatur inflow boundari condit function height 22 figur 11: veloc temperatur field flow telescop enclosur 6 conclus work present numer model estim atmospher see observ sites. main featur propos model base numer dissip aris particular version variat multiscal method, orthogon subgrid scale method. advantag kind model reli fact that, decompos field coars fine scales, abl deal simultan sourc numer instabl model turbul effects. present work summar properti variat multiscal method, base model numer subscal complet possibl manner: subscal consid transient time, non-linear, orthogon finit element space. lead resolut numer stabil issu (advect us arbitrari interpol veloc pressure), rich represent turbul phenomena. base turbul model, develop express viscou thermal dissipations, num num, evalu constant structur refract index c2n follow classic model develop tatarski. numer exampl section test perform method practic cases, convect boundari layer, flow insid transfer optic room, flow telescop enclosure. case compar model result obtain smagorinski wale model evalu viscou thermal dissipations, and, convect boundari layer case, result present [8]. numer exampl method capabl accur estim c2n coefficients. fact provid new numer tool 23 figur 12: c2n field flow telescop enclosure. bottom: variat multiscale, smagorinski wale models. 24 evalu atmospher see add argument favor viabil implicit le method reli numer stabil mechan model turbulence. acknowledg work partial support european research council solarnet re- search network fp7 - 312495, partial support ministerio economa y competitividad spanish govern plan nacion investigacion 2012: aya2012-33490. joan baig gratefulli acknowledg support receiv micinn spanish govern juan la cierva postdoctor grant. ramon codina gratefulli acknowledg support receiv catalan govern icrea academia research program. refer [1] r.j. alliss b.d. felton. valid optic turbul simul numer weather predict model support adapt optic design. advanc maui optic space surveil- lanc technolog conference, volum 1, page 54, 2009. [2] j.m. beckers. adapt optic astronomy: principles, perfom applications. annual review astronomi astrophysics, 1993. [3] fcm bettonvil, r codina, rh hammerschlag, apl jagers, jnm kommers, sj van leverink, g sliepen, s visser. enclosur european solar telescop (est). spie as- tronom telescop instrumentation: observ frontier astronomi new decade, page 773333773333. intern societi optic photonics, 2010. [4] peter bradshaw georg p huang. law wall turbul flow. proceed royal societi london. seri a: mathemat physic sciences, 451(1941):165188, 1995. [5] l cavaller, m collados, j castro. perform simul conceptu design european solar telescop (est). proc. spie vol, volum 8336, page 83360g1, 2011. [6] s. cheinet, a. beljaars, k. weiss-wrana, y. hurtaud. us weather forecast charac- teris near-surfac optic turbulence. boundary-lay meteorology, 138:453473, 2011. [7] s. cheinet a. p. siebesma. impact boundari layer turbul optic propagation. optic atmospher propag adapt system x. proc. spie vol. 6747, page 112, 2007. [8] s. cheinet a. p. siebesma. variabl local structur paramet convect boundari layer. j. atmos. sci., 66:10021017, 2009. [9] t. cherubini s. businger. oper perspect model optic turbulence, see clearly: impact atmospher turbul propag extraterrestri radiation, t. cherubini s. busing (eds.). vbw publishing, 2010. [10] t. cherubini, s. businger, r. lyman. model optic turbul see mauna kea: verif algorithm refinement. j. appl. meteor. climatol., 47:30333043, 2008. [11] r. codina. stabil finit element method gener stationari incompress flows. method appli mechan engineering, 190:26812706, 2001. [12] r. codina. stabil finit element approxim transient incompress flow orthog- onal subscales. method appli mechan engineering, 191:42954321, 2002. [13] r. codina, j. baiges, d. perez-sanchez, m. collados. numer strategi comput optic paramet turbul flow: applic telescopes. comput & fluids, 39(1):87 98, 2010. 25 [14] r. codina j. principe. dynam subscal finit element approxim thermal coupl incompress flows. intern journal numer method fluids, 54:707730, 2007. [15] r. codina, j. principe, m. avila. finit element approxim turbul thermal coupl incompress flow numer sub-grid scale modelling. intern journal numer method heat & fluid flow, 20(5):492516, 2010. [16] r. codina, j. principe, s. badia. dissip structur long term behavior finit element approxim incompress flow numer subgrid scale modeling. multiscal method comput mechanics, page 7593. springer, 2011. [17] r. codina, j. principe, j. baiges. subscal element boundari variat two- scale finit element method. method appli mechan engineering, 198:838 852, 2009. [18] r. codina, j. principe, o. guasch, s. badia. time depend subscal stabil finit element approxim incompress flow problems. method appli mechan engineering, 196:24132430, 2007. [19] o. colomes, s. badia, r. codina, j. principe. assess variat multiscal model larg eddi simul turbul incompress flows. submitted. [20] a.f. baa m. sarazin. temperatur structur fuction complex terrain. eighth symposium turbul shear flows., page 16, munich septemb 9-11, 1991. [21] r. frehlich, r. sharman, f. vandenberghe, w. yu, y. liu, j. knievel, g. jumper. estim cn2 numer weather predict model output comparison thermosond data. journal appli meteorolog climatology, 49(8):17421755, 2010. [22] c giordano, j vernin, h vazquez ramio, c munoz-tunon, varela, h trinquet. atmo- spheric see forecast: wrf model valid situ measur orm. monthli notic royal astronom society, 430(4):31023111, 2013. [23] v. gravemeier. variat mulstiscal method laminar turbul flow. archiv comput mechanicsst art reviews, 13:249324, 2006. [24] o. guasch r. codina. statist behavior orthogon subgrid scale stabil term finit element larg eddi simul turbul flows. method appli mechan engineering, 261:154166, 2013. [25] r.j. hill. structur function spectra scalar quantiti inertial-convect viscous- convect rang turbulence. journal atmospher sciences, 46:22452251, 1989. [26] t.j.r. hughes, g.r. feijoo, l. mazzei, j.b. quincy. variat multiscal methoda paradigm comput mechanics. method appli mechan engineering, 166:324, 1998. [27] t.j.r. hughes, l. mazzei, k.e. jansen. larg eddi simul variat multiscal method. comput visual science, 3:4759, 2000. [28] s.l. keil, t.r. rimmele, j. wagner. advanc technolog solar telescope. earth, moon, planets, 104(1-4):7782, 2009. [29] e. masciadri, j. vernin, p. bougeault. 3d map optic turbul atmospher numer model. i. astron. astrophys. suppl. ser., 137:185202, 1999. [30] e. masciadri, j. vernin, p. bougeault. 3d map optic turbul atmospher numer model. ii. astron. astrophys. suppl. ser., 137:203216, 1999. [31] e. masciadri, j. vernin, p. bougeault. 3d numer simul optic turbul roqu lo muchacho observatori atmospher model meso-nh. astronomi & astrophysics, 365:699708, 2001. 26 [32] l.j. peltier j.c. wyngaard. structur function paramet convect boundari layer larg eddi simulation. journal atmospher sciences, 52:36413660, 1995. [33] f. roddier. adapt optic astronomy. cambridg univers press, 2004. [34] v.i. tatarski. wave propag turbul medium. dover publications, inc, 1961. [35] h. trinquet j. vernin. statist model forecast profil index structur constant. environ fluid mech, 7:397407, 2007. [36] l.p. wang, s. chen, j.g. brasseur. examin hypothesi kolmogorov refin turbul theori high resolut simulations. 2. passiv scalar fields. journal fluid mechanics, 400:163197, 1999. 27