pem fuel cell fault diagnosi hybrid methodolog base fuzzi pattern recognit techniqu pem fuel cell fault diagnosi hybrid methodolog base fuzzi pattern recognit techniqu antoni escobet a, ngela nebot b,n, francisco mugica b depart dipse, edifici mn1 technic univers catalonia (upc), campu manresa, avinguda le base manresa, 61-73, 08240 manresa, spain b depart lsi, technic univers catalonia (upc), c/jordi girona 1-3, 08034 barcelona, spain r t c l e n f o articl history: receiv 12 novemb 2013 receiv revis form 12 june 2014 accept 7 juli 2014 keywords: fault diagnosi fuel cell fuzzi induct reason visualblock-fir b s t r c t work, fault diagnosi methodolog term visualblock-fuzzi induct reasoning, i.e. visual- block-fir, base fuzzi pattern recognit approach present appli pem fuel cell power systems. innov methodolog base hybrid artifici intellig methodolog combin fuzzi approach known pattern recognit techniques. illustr potenti visualblock-fir, non-linear fuel cell simul propos literatur employed. simul includ set fault scenario frequent fault fuel cell systems. fault detect identif result obtain scenario present paper. remark propos methodolog compar favor model-bas methodolog base comput residu detect identifi propos fault rapidly. moreover, robust hybrid fault diagnosi methodolog studied, show good behavior level nois 20 db. & 2014 elsevi ltd. right reserved. 1. introduct polym electrolyt membran (pem) fuel cell devic allow direct transform chemic energi (hydrogen) electr energi (pukrushpan et al., 2004). energi convers clean by-product water heat. moreover, process effici level perform main fossil alternatives. others, advantag recent increas scientif product field years. potenti applic group cate- gories: gener electr stationari applications; residen- tial electron applic automot applications. applic automot sector particularli attrac- tive fact practic null emiss pollut agent (rajashekara, 2000). mean fuel cell environmentally-friendli altern convent fossil fuel significantli reduc pollut man-mad greenhous gases. all, pem fuel cell complex interrel system and, state recent research effort (feroldi, 2009), effici control crucial. differ control problem solv obtain correct oper system, i.e. control power flow fulfil power load, condit gener power, handl heat water suitabl hydrogen air supply. therefore, set auxiliari element valves, compressors, sensors, regulators, etc., need guarante fuel cell work optim way. reason, fuel cell system vulner differ set fault impli tempor perman damage. fault diagnosi system (fds) become, therefore, fundament order reduc possibl vulnerability. intens research activ fault diagnosi fuel cell stack system includ quantit qualit approaches. accord aitouch et al. (2012), fault diagnosi method classifi types: model-bas knowledge-bas approaches. model-bas approach priori knowledg model process assumed. however, inform avail dynam fuel cell model character multipl variabl strong coupl profound dynamics. model-bas approach primarili base statist techniques, order logic, control theory, mathemat modeling, simul (aitouch et al., 2011; escobet et al., 2009; rosich et al., 2014; wu et al., 2008a, 2008b; wang et al., 2011; zhang huang, 2011). knowledge-bas approach base data avail perform learning. exampl knowledge-bas approach signal processing, experiment method artifici intelligence. larg research area knowledge-bas fd fuel cell stack systems, special artifici intellig methods, like expert systems, neural networks, genet program (chavez-ramrez et al., content list avail sciencedirect journal homepage: www.elsevier.com/locate/engappai engin applic artifici intellig 0952-1976/& 2014 elsevi ltd. right reserved. n correspond author. tel.: 34 93 4137783; fax: 34 93 4137833. e-mail addresses: (a. escobet), (. nebot), (f. mugica). engin applic artifici intellig 36 (2014) 4053 www.sciencedirect.com/science/journal/09521976 www.elsevier.com/locate/engappai 2010; kamal et al., 2014; liu wang, 2003; nitsch et al., 2004; yousfi steiner et al., 2011; zheng et al., 2013). recent years, demand arisen develop fd robust uncertainty. context, fuzzi logic hybrid fuzzi approach appear offer good altern qualit fd methodolog (hissel et al., 2004, 2007; olteanu et al., 2012; tao et al., 2005; vural et al., 2009; becker karri, 2010). let look littl closer research clearli relat interests. hissel et al. (2004) present step direct fuel cell system diagnosis, propos sugeno-typ fuzzi model faults, i.e. accumul nitrogen and/or water anod compart import dry proton exchang membrane. sugeno model tune genet algorithm. conclus obtain state fuzzi diagnosi model help improv results. instance, author point thank fuzzi model 150 s need detect accumul nitrogen water anod compon fault. hissel et al. (2007) present new approach pem diagnosi base fuzzi k-mean clustering. fuzzi cluster algorithm produc cluster dimens featur space, correspond specif fault, i.e. specif behavior fuel cell stuck. olteanu co- worker propos sugeno-typ fuzzi model. case goal model polyelectrolyt membran fuel cell mean set fuzzi rule built base physic principles. therefore, research follow model-bas approach focus fault diagnosis. tao et al. us adapt neural- network fuzzi infer (anfis) build temperatur model pem fuel cell refer model control system, adjust model paramet control online. vural et al. us anfi model pem fuel cell oper conditions. model obtain abl predict fuel cell perform high accuraci easy, rapid cost effect way. becker karri build predict anfi models, case hydrogen flow rate, electrolyz system-effici stack-efficiency. model reliabl predict tool excel accuracy. notic tao et al. vural et al. becker karri research focus fault diagnosis. therefore, number work literatur propos fuzzi hybrid fuzzi fd pem fuel cell low. reason propos fd base fuzzi induct reason (fir) methodology. main motiv research explor ad valu fuzzi knowledge-bas approach altern knowledge-bas model-bas approaches, case non-linear dynam insuffici known. goal research allow toler fuel cell control mean addit fuzzi fault diagnosi oper real-time. idea mind, visualblock-fir fd base fuzzi induct reason (fir) methodolog present work. fir methodolog base hybrid fuzzi pattern recognit approach conceptu aris gener problem solv (klir elias, 2002). methodolog model qualit simul base system behavior structur knowledge. abil system easili describ classic method (e.g. differenti equations), i.e., systems, physic process awkward model. novelti work li fir methodolog model differ fault scenario plant faults, appli detect identif visualblock-fir algorithm detect isol fault occur fast possible. induct model identif techniques, neural network hybridizations, assum fix (although arbitrary) structur map knowledg contain train data set set paramet values. train data model identif phase, i.e., model phase. model identified, simul run base sole previous optim paramet values. techniqu suffer problem nor- malli unabl recognize, test data lie outsid range, model validated. contrast, fir non-parametr technique. train data character classifi model identif phase, map paramet sets. therefore, fir refer classifi train data set simul predict phase. properti make imposs fir extrapol gener simul and, therefore, predict valu physic possible. finally, fir self- assess capabl enabl warn user methodolog make riski predictions, i.e. predict found basi avail train data. prove us robust propos metho- dology, pem simul develop pukrushpan et al. (2004) modifi escobet et al. (2009), includ set typic fault scenarios, used. allow comparison result obtain visualblock-fir methodolog result achiev model-bas fault diagnosi methodolog present escobet et al. (2009). import mention chosen fault scenario describ escobet et al. (2009), data easili available. moreover, work, detect identif fault report take account possibl detect identifi them; account time need it. paper present time need propos methodolog detect identifi fault pem fuel cells. visualblock-fir fault diagnosi methodolog introduc section 2. section 3 describ pem fuel cell system. section 4 present applic visualblock-fir fuel cell result obtained. section 5 present studi robust nomenclatur pem polym electrolyt membran fd fault diagnosi anfi neural-network fuzzi infer fir fuzzi induct reason knn k-nearest neighbor 5nn 5-nearest neighbor efp equal frequenc partit mse mean squar error lpv linear paramet vari q accept measur c partial accept measur crel rel confid ia comput maximum number local cumul error possibl o2 oxygen excess ratio o2in oxygen input o2react oxygen react icm compressor current cm compressor speed vfc voltag appli cell ifc stack current vcm voltag appli compressor a. escobet et al. / engin applic artifici intellig 36 (2014) 4053 41 visualblock-fir methodology. finally, conclus research outlin section 6. 2. fault diagnosi methodolog necessari clarifi fuzzi induct reason (fir) methodolog respons identifi model repre- sent specif behavior system. fir model avail fir predict process forecast output valu system. hand, visualblock-fir methodolog fd base fir model previous mentioned. fd aim detect identifi differ fault occur time. visualblock-fir perform task modules, i.e. detect identification, user manag mean user-friendli framework. fault detect module, fir model fault occurred, set alarm case. identif fault module, type fault identified. follow section visualblock-fir describ and, necessary, fir model predict process explained. 2.1. visualblock-fir fault detect fault detect process visualblock-fir present fig. 1. figur grai box repres fir processes, white box constitut fault detect procedure. diagnosi methods, model allow check consist measur output predict behavior. inconsist detected, exist fault proved. propos approach, fir methodolog obtain qualit behavior model. data measur convert qualit tripl (class, membership, side) mean fir fuzzif process. class valu repres coars discret origin real-valu variable. fuzzi membership valu denot degre belong data fuzzi set. finally, valu indic quantit valu left right peak valu associ membership function. value, specialti fir techniqu commonli fuzzi logic, respons preserving, qualit triple, complet knowledg contain origin quantit value. defuzzif invers process fuzzification. fig. 2 illustr process fuzzif mean example. temperatur 23 1c fuzzifi class normal valu right fuzzi membership valu 0.755. determin number class variabl distribut class search space (shape membership functions) defin applica- tion' expert model avail set cluster algorithms, fuzzi c-means, equal frequenc partition, hier- archic clustering, k-means, etc. fir offer possibl us genet algorithm learn granular (number class variable) and/or shape membership functions. however, comput time larg option chosen. fuzzi forecast process predict qualit output valu qualit input data best fir model identified, repres current behavior system. fir model identifi line, fault detect process take place. fir model compos structure, call mask, pattern rule base, name input/output matrix. mask repres possibl causal dynam relat qualita- tive variables. repres matrix column correspond measur variable. certain number rows, repres tempor domain influenc output. row delai rel successor time interv trepres time laps consecut samplings. exampl mask present fig. 3. mask m-inputs, u1t2t; u4t2t; y1tt; u2t , denot i1; i2; i3; i4 respectively, m-output, o1, associ y1t. best mask mean optim process determin determinist state transit matrix. optim mask evalu respect maxim forecast power. mask that, framework allow masks, repres determinist state transit matrix? mask optim predict model. fir methodology, concept mask candid matrix introduced. mask candid matrix ensembl possibl masks, fromwhich best chosen mechan exhaust search. search strategi base genet algorithm implemented. optim mask function search legal mask complex two, i.e., mask singl m-input, find best one; proce search legal mask complex three, i.e., mask m-inputs, find best those; continu manner maximum allow complex (a parameter) reached. practic examples, qualiti mask grow increas complexity, reach maximum, decai fuzzif dynam comparison fuzzi forecast threshold detect alarm measur data real output valu envelop interv instantan error cumul error qualit data predict qualit triplet defuzzif fig. 1. visualblock-fir fault detect process. a. escobet et al. / engin applic artifici intellig 36 (2014) 405342 rapidly. possibl mask compar respect potenti merit. optim mask evalu respect maxim forecast power quantifi mean qualiti measure, base mainli shannon entropi (escobet et al., 2008). fig. 4 illustr input/output matrix (pattern rule based) obtain mask. left hand fig. 4 show excerpt qualit data matrix store class values. show numer symbol class valu present fig. 2, i.e. instead fresh, normal warm linguist valu us numer valu repres them. box symbol mask shift downward qualit data matrix. round hole mask denot posit m-inputs, squar hole indic posit m-output. class valu read qualit data matrix hole mask, place input/output matrix shown right hand fig. 4. row matrix repres pseudo-stat qualit state qualit rule (also call pattern rule). example, shade rule fig. 4 read follows: allm-input (i1, i2, i3, i4) valu 2 (correspond medium) m-output, o1, assum valu 1 (correspond low). forecast phase, futur qualit output state predict model mean infer engin (escobet et al., 2008). fir infer engin base variant k- nearest neighbor (knn) rule. 5nn pattern match algorithm core fir inferenc process. forecast output variabl obtain weight averag potenti conclu- sion result fire rules, anteced best match actual state, shown fig. 5. qualit simul process predict entir qualit triple, quantita- tive valu obtain needed. envelop drive fault detect process (see fig. 1) visualblock-fir. shown fig. 6, envelop compos upper bound (maximum value) lower bound (minimum value), delimit area real output signal expect lie. envelop comput appli defuzzif process nearest neighbor obtain fuzzi forecast process fir methodology. upper bound neighbor predict highest valu lower bound correspond neighbor predict lowest value. narrow envelop interv impli neighbor close other, mean inform avail behavior point time rich complete. contrast, wide envelop interv mean lot inform avail point time, therefore, nearest neighbor far awai other. import mind fir methodolog driven system' behavior reli structur knowledge, therefore, rich data avail crucial order assur identif accur reliabl model repres it. fault detect process check real signal li insid envelope. observ (real) valu leav bound specifi envelope, instantan error recorded, mean model predict longer repres specif point time. order reduc effect instantan error presenc nois measur unmodel dynamics, filter introduced, detect time window threshold error. instantan error record insid predetermin detect time window accumulated. cumul error surpass specifi threshold, alarm triggered, necessari identifi fault occur (see fig. 1). fig. 6 present exampl fir fault detect envelop concept time window 15 predict points. upper lower dot line repres upper lower bound envelope, respectively, continu line real output signal. figure, instantan error accumulated. seen, real valu leav envelop time point number 6 observ valu exce upper bound envelope, caus instantan error. occur point number 7 11. fresh normal warm m em rs hi p 0.5 0.755 1.0 10 20 23 30 landmark fuzzif quantit valu 23 c temperatur c qualit valu (triplet) [normal, 0.755, right] 2713 fig. 2. fir fuzzif process: exampl ambient temperatur variable. fig. 3. mask m-input (i1, i2, i3, i4) m-output (o1). fig. 4. deriv fir pattern rule base. a. escobet et al. / engin applic artifici intellig 36 (2014) 4053 43 threshold cumul error specifi exampl 3, therefore, alarm trigger point number 11 instantan error arrives. 2.2. visualblock-fir fault identif alarm triggered, fault identif process, describ fig. 7, starts. main process fault model library, model identified, line, fir methodology. detect process, grai box repres fir process white box constitut fault identifica- tion procedure. instant time, measur data, fuzzified, model store fault model librari obtain envelop interval. detect process, instantan error record fault model accumul time. predetermin identif time window defin number predict valu order identifi fault occurred. notic small-siz identif time window prefer impli fast model identification. order determin size time window necessari account system' dynamics. fact fir model differ fault available, possibl experi establish small us time window. accumul error comput model accept- abil measure. accept measur rel index rank model term abil predict new behavior system. measur allow us, reliabl way, identifi fault occurred. offer guidanc identif process face addit problems, e.g. produc fault foreseen fault avail fault model library, differ model identifi abl explain observ fault. accept measur ith model, qi, describ eq. (1). qi cicr 1 ci partial accept measur ith model creli rel confid take dispers fig. 5. fir predict process. alarm 1 2 3 4 5 6 7 10 11 12 138 90 14 maximum valu minimum valu real valu accumul error 0 0 0 0 0 0 1 2 2 2 2 3 3 3 3 fig. 6. exampl visualblock-fir fault detect envelop method. fig. 7. visualblock-fir fault identif process. a. escobet et al. / engin applic artifici intellig 36 (2014) 405344 ci valu account. ci obtain ad cumul error ith model, iai , comput maximum number local cumul error possibl (depend size identifi time window), iamax shown eq. (2). ci 1:0 iai=iamax 2 ci confid measure, i.e. real-valu number rang [0,1], larger valu indic increas confidence. rel confid obtain eq. (3). creli ci= n k 1 ck 3 model high valu ofci, creli high, model high ci valu well, creli smaller. model largest accept measur select best repres new behavior system, therefore, detect fault identified. 3. case study: pem fuel cell pem fuel cell electrochem cell chemic energi directli convert electricity, combin hydrogen fuel oxygen air, wast heat liquid water by- products. paper, simul pem fuel cell case studi fault diagnosis. simul us non-lin model control strategi propos pukrushpan et al. (2004) repres 75 kw fuel cell 381 cells. pem fuel simul allow incorpor fault (tabl 2) simulink environment. schemat diagram main subsystem pem fuel cell supervis variabl shown fig. 9. tabl 1 describ set paramet pem fuel cell study. air suppli consist air compressor feed atmospher air fuel cell cathode, suppli manifold connect compressor output air cooler input, air cooler static humidifi that, respectively, refriger humidifi air goe stack. major parasit power automot fuel cell spent air compressor, thus, import determin proper air flow. air flow excess reflect term oxygen excess ratio, defin ratio oxygen suppli oxygen cathode, i.e. o2 o2in=o2react. model guarante requir stoichiometri regul hydrogen, suppli pressur liquid hydrogen tank, mean control valve. electrochem principl fuel cell stack model order accur evalu electr product output stack. impli specif model equat anode, cathode, membran stack voltage. finally, cathod outlet manifold fuel cell consid model extern component. simul model describ normal oper mode purg anod considered, mean hydrogen anod consumed. assum temperatur fuel cell stack known constant dynam behavior slower rest model. transient phenomena captur model includ flow inertia dynam compressor, manifold fill dynam (both anod cathode), reactant partial pressures, membran tabl 1 paramet pem fuel cell. symbol variabl valu m,dry membran dry densiti 0.002 kg/cm 3 mm,dry membran dry equival weight 1.1 kg/mol tm membran thick 0.01275 cm n number cell stack 381 afc fuel cell activ area 280 cm 2 dc compressor diamet 0.2286 m jcp compressor motor inertia 5105 m2 van anod volum 0.005 m 3 vca cathod volum 0.01 m 3 vsm suppli manifold volum 0.02 m 3 vrm return manifold volum 0.005 m 3 cd,rm return manifold throttl discharg coeffici 0.0124 at,rm return manifold throttl area 0.002 m 2 ksm,out suppli manifold outlet orific constant 0.36293105 kg/( pa) kca,out cathod outlet orific constant 0.21773105 kg/( pa) kv motor electr constant 0.0153 v/(rad/s) kt motor torqu constant 0.0225 n-m/a rcm compressor motor circuit resist 1.2 tabl 2 descript fault scenario study. id fault descript type magnitud #1 suddenli increas friction mechan compon compressor parametr abrupt 100% increment (the constant duplicated) #2 compressor motor suffer overh parametr abrupt 100% increment (the constant duplicated) #3 fluid resist increas water block channel flood diffus layer parametr abrupt 50% reduct water flow #4 air leak air suppli manifold parametr abrupt 50% reduct air flow #5 increas voltag valu compressor motor turn parametr abrupt increas 30 v 60 v 100 200 300 400 500 600 160 180 200 220 train data test data st ac k cu rr en t second (s) fig. 8. stack current period set-point signal. a. escobet et al. / engin applic artifici intellig 36 (2014) 4053 45 humidity. deeper descript pem fuel cell simul refer lira et al. (2010). avail sensor import issu account fault diagnosis. studi case, provid measur compressor current icm, speed, cm, voltag appli compressor, vcm, cell, vfc. stack current ifc, regard measur disturb system. simul includ fault present tabl 2. fault #1 simul increment compressor constant and, similarly, fault #2 simul increment compressor motor resistance. fault translat chang compressor torque. fault #3 simul increment orific constant cathod output produc chang outlet air flow cathode. fault #4 simul increment suppli manifold outlet flow constant, translat chang outlet air flow suppli manifold. fault #5 simul increment lower voltag control suppli compressor motor, boundari influenc compressor torque. 4. fault diagnosi pem fuel cell fault diagnosi requir appli pem fuel cell detect isol fault propos studi case. order so, necessari identifi fir qualit model plant normal oper failur mode. 4.1. fir qualit model identif step build fd obtain fir qualit models, constitut model library. fig. 9 shows, measur data ifc, vcm, icm, cm, o2and vfc, input variables. load changes, current deliv fuel cell stack varies. point, fuel cell control adjust air pump order maintain appropri air feeding. study, pem fuel cell perturb period load change. load period draw current signal shown fig. 8, period 160 s amplitud 160 250 a. second period train model test them. input output variabl discret 3 classes. number class variabl determin model analysi signals. membership func- tion defin follow equal frequenc partit (efp) algorithm, distribut membership function search space wai class contain number train data points. case, necessari us genet algorithm optim discret parameters, fact predict result obtain propos discret valu good. fact fir model output, necessari identifi 4 model normal plant behavior 4 fault studied. total 24 differ model (4 outputs6 plant behaviors) identifi visualblock-fir readi perform fault detect identification. 24 scenarios, simul 3 complet signal period 160 s each, i.e. 480 s simul time, sampl rate 0.1 s, gener 4800 data points. 320 s (3200 data points) fir identifi model, final 160 s verifi model. mask obtain 24 scenario present consecut eq. (4). normal behaviour fault #1 fault #2 fault #3 fault #4 fault #5 t=icm c vcm icm c vcm icm c vcm icm c vcm icm c vcm icm c vcm icm t4t t3t t2t tt t 1 2 0 0 0 0 0 0 0 3 0 4 0 0 1 2 6666664 3 7777775 0 0 0 0 0 0 0 0 0 0 0 1 2 3 1 2 6666664 3 7777775 1 2 0 0 0 0 0 0 0 3 0 4 0 0 1 2 6666664 3 7777775 1 2 0 0 0 0 0 0 0 3 0 4 0 0 1 2 6666664 3 7777775 1 2 0 0 0 0 0 0 0 3 0 4 0 0 1 2 6666664 3 7777775 1 2 3 0 0 0 0 0 0 4 5 6 0 0 1 2 6666664 3 7777775 normal behaviour fault #1 fault #2 fault #3 fault #4 fault #5 t=cm c vcm cm c vcm cm c vcm cm c vcm cm c vcm cm c vcm cm t4t t3t t2t tt t 1 2 0 0 0 0 0 0 0 3 0 4 0 0 1 2 6666664 3 7777775 0 0 0 1 2 0 0 0 0 0 0 0 3 0 1 2 6666664 3 7777775 0 0 0 1 2 0 0 0 0 0 0 0 3 4 1 2 6666664 3 7777775 1 2 0 0 0 0 0 0 0 3 4 0 0 0 1 2 6666664 3 7777775 1 2 0 0 0 0 0 0 0 3 4 0 0 0 1 2 6666664 3 7777775 0 0 0 0 0 1 2 3 0 0 0 0 0 0 1 2 6666664 3 7777775 normal behaviour fault #1 fault #2 fault #3 fault #4 fault #5 t=o2 c vcm o2 c vcm o2 c vcm o2 c vcm o2 c vcm o2 c vcm o2 t4t t3t t2t tt t 0 0 0 1 2 0 0 0 0 0 0 3 4 0 1 2 6666664 3 7777775 0 0 0 0 0 0 0 0 0 1 2 3 0 0 1 2 6666664 3 7777775 0 0 0 1 2 0 0 0 0 0 0 0 3 4 1 2 6666664 3 7777775 0 0 1 0 0 0 0 0 0 0 0 2 3 0 1 2 6666664 3 7777775 0 0 1 0 0 0 0 0 0 0 0 2 3 4 1 2 6666664 3 7777775 1 2 3 0 0 0 0 0 0 4 5 6 0 0 1 2 6666664 3 7777775 normal behaviour fault #1 fault #2 fault #3 fault #4 fault #5 t=vfc c vcm vf c c vcm vf c c vcm vf c c vcm vf c c vcm vf c c vcm vf c t4t t3t t2t tt t 0 0 1 0 0 0 0 0 0 0 0 2 3 4 1 2 6666664 3 7777775 0 0 0 1 2 0 0 0 0 0 0 0 3 0 1 2 6666664 3 7777775 0 0 0 0 0 0 0 0 0 0 0 1 2 3 1 2 6666664 3 7777775 1 0 2 0 0 0 0 0 0 0 0 3 4 0 1 2 6666664 3 7777775 1 2 3 0 0 0 0 0 0 4 5 6 0 0 1 2 6666664 3 7777775 0 0 0 0 0 0 0 0 0 0 0 1 2 3 1 2 6666664 3 7777775 4 a. escobet et al. / engin applic artifici intellig 36 (2014) 405346 mean squar error percentag defin eq. (5) comput predict error. mse e ytyt2=2 h 100%; 2 e y2 t e yt 2 5 e mean value, y(t) output, quot predict valu 2 denot variance. 24 fir model identified, mean squar error lower 1102% obtain predict test sets. predict error low, mean model obtain repres accur system' behaviors. fir model store fault model librari fault identif phase visualblock-fir. taken account possibl fault includ fault model librari detect identified. therefore, set fault select accu- rately. however, possibl includ new fault model librari needed. hand, mask pattern rule base store model librari fault and, therefore, number fault larg memori burden on-lin applic problem. explained, fir data driven methodol- ogi infer model measur trajectories. induct model identif techniques, fir abl obtain good model poor and/or scarc data. statis- tical consider legal discret state record time (law kelton, 1990). thus, relat exist total number legal state number data point requir base model effort upon. total number legal state comput multipli number class input variables. obviously, fault detect identif accur fault model identifi repres accur behavior. however, mention earlier, fir self-assess capabl enabl know make predict found basi avail train data. 4.2. simul result turn detect identif perform visualblock-fir, differ experi perform intro- duce previous describ 5 faults. goal experi studi us approach detect identifi faults. fault #1 introduc second 150 plant work properly. figs. 10 11 dynam comparison fir model predict oxygen excess ratio,o2 , compressor current, icm, output variables, respectively. envelop comput time non fault model (most upper plot fig. 10), fault model (rest plot fig. 10). maximum minimum valu envelop repres dash line real data repres continu line. explain before, fir model identifi accur (have low predict errors) and, therefore, upper lower bound envelop are, figures, undistin- guishable. studi case, detect time window last 1 s, threshold cumul error 3 identif time window last 6 s. tabl 3 show detect identif time (s) output variabl fault analyzed. case fault #1, visualblock-fir need 0.4 s (4 samples) detect fault oxygen excess ratio compressor current output variabl analyzed. second 150.4 alarm trigger identif phase starts, seen figs. 10 11. compressor speed, cm, stack voltage, vfc, output variables, visualblock-fir need 0.5 0.8 s, respectively, detect fault occurred. case, time window 60 data point (correspond 6 s) determin fault occurred. second accept measur sure fault #1 produced. applic accept measur 1 (maximum value) obtained. figs. 10 11 seen second 156 envelop fault #1 contain real signal, mean fault #1 model repres current behavior plant. contrarily, envelop rest model contain real signal. ident result obtain analysi carri fault #2, summar tabl 3. seen second row table, detect output variabl quickli (from 0.4 1.5 s). identif perform good, i.e. 6 7 s need know fault occurred. experi appli fault #3 behavior compressor speed,cm, stack voltage, vfc, variabl extrem similar signal variabl plant work properli (there fault). clearli seen fig. 12, stack voltag signal. notic real signal insid envelop work properli (most upper plot fig. 12) happen fault #3 (middl plot fig. 12). reason, visualblock-fir abl detect fault #3 analyz cm vfc variables, shown tabl 3. experi appli fault #3 behavior compressor speed,cm, stack voltage, vfc, variabl extrem similar signal variabl plant work properli (there fault). clearli seen h2 inlet flow air inlet flow air outlet flow dc/dc convert electr load -+ ifc vcm icm cm o2 vfc fault detector fault model fir model air suppli (compressor control) fuel cell hydrogen suppli (tank control) static feedforward fig. 9. schemat diagram fd pem fuel cell (adapt feroldi et al. (2007)). a. escobet et al. / engin applic artifici intellig 36 (2014) 4053 47 fig. 10. visualblock-fir detect identif fault #1 oxygen excess ratio, o2 , output variable. fig. 11. visualblock-fir detect identif fault #1 compressor current, icm, output variable. a. escobet et al. / engin applic artifici intellig 36 (2014) 405348 fig. 12, stack voltag signal. notic real signal insid envelop work properli (most upper plot fig. 12) happen fault #3 (middl plot fig. 12). reason, visualblock-fir abl detect fault #3 analyz cm vfc variables, shown tabl 3. however, fault #3 rapidli detect identifi o2 icm variabl analyzed. clearli seen fig. 13, show dynam comparison fir model predict oxygen excess, o2 , output variable. case fault detect 0.4 s identifi 6 s. visualblock-fir obtain good detect identif result fault #4. before, abl detect fault 0.4 s need 6 s identifi it. however, abl detect fault compressor speed, cm, variabl taken account. reason outlin fault #3 valid here. fault #5 approach fact detect identif output variabl difficult previou fault (see row tabl 3). visualblock-fir need 2225 s detect fault 2831 s identifi it. notic second shown tabl 3 absolut seconds, i.e. identif time includ detect time. time increas need detect identifi fault consequ similar behavior output signal fault #5 behavior signal work properly, mainli posit semi-period signals. neg semi- period, signal behav differ another, allow detect fault. fig. 14 show detect identif result obtain visualblock-fir oxygen excess ratio,o2 , output signal fault #5. previou experi fault introduc plant second 150. visualblock-fir detect fault second 172.7, identifi second 178. result compar favor detect identifi- cation time obtain methodolog base comput residu present escobet et al. (2009), 2 s need detect fault #1 #2 30 s requir identifi faults. specif result report research relat fault #3, #4 #5. therefore, comparison research faults. hand, work lira et al. (2010) analyz faults; correspond #1 #4 faults. methodolog base comput residu lpv obser- ver. conclud methodolog possibl detect identifi fault studied. hand, research kamal et al. (2014) kamal yu (2011) fault presented, correspond fault #4. studi author propos us radial basi function networks. previou case, author report fault tabl 3 visualblock-fir perform fault (s). detect identif o2 cm icm vfc o2 cm icm vfc fault #1 0.4 0.5 0.4 0.8 6 6 6 6 fault #2 0.6 0.9 0.4 1.5 6 6 6 7 fault #3 0.4 0.4 6 6 fault #4 0.3 0.4 0.4 6 6 6 fault #5 22.7 23.5 22.3 25.3 28 29 28 31 fig. 12. envelop real signal fault #3 stack voltage, vfc, output variable. a. escobet et al. / engin applic artifici intellig 36 (2014) 4053 49 50 100 150 200 250 300 1 1.5 2 n f au lt o2 excess ratio fault detect (0,4s)real theshold 50 100 150 200 250 300 1 1.5 2 f au lt 1 real theshold 50 100 150 200 250 300 1 1.5 2 f au lt 2 real theshold 50 100 150 200 250 300 1 1.5 2 f au lt 3 fault identif (6s) real theshold 50 100 150 200 250 300 1 1.5 2 f au lt 4 real theshold 50 100 150 200 250 300 1 1.5 2 second (s) f au lt 5 real theshold fig. 13. .visualblock-fir detect identif fault #3 oxygen excess ratio, o2 , output variable. fig. 14. .visualblock-fir detect identif fault #5 oxygen excess ratio, o2 , output variable. a. escobet et al. / engin applic artifici intellig 36 (2014) 405350 studi detect identifi propos methodol- ogy, time inform included. interest remark usual paper literatur specifi time need detect identifi fault studied. report fault detect identified. reason possibl perform deeper comparison methodologies. 5. robust visualblock-fir order studi robust method developed, uniform white nois ad output variables. robust test fault differ nois levels. import clarifi nois includ signal identifi fir models, i.e. fir model identifi data noise, test fault detect identif nois environment. reason us noisi data obtain model twofold. hand, think model obtain nois detect identifi fault noisi environment, robust methodolog test higher depth. hand, real environments, possibl perform filter data model identif process. decis analyz robust studi happen nois ad sensor prerequisit test visualblock-fir real data. experi detect time window set 1 s, previou section, identif time window increas 6 10 s, cumul error need trigger alarm remain three. tabl 4 show time need visualblock-fir detect identifi fault level nois studied, i.e. 60, 40, 30 20 db. compar detect result tabl 3 4, easili seen nois 60 db 40 db ad signal, detect time signal nois all. make sens 60 db 40 db correspond 0.1% 1% noise, respectively. nois increased, time need visualblock-fir detect fault increased. however, detect time accept 3.5% 10% nois ad signal. fact, low compar result report escobet et al. (2009). notic percentag nois increas 1% envelop signal increas percentag specifi column tabl 4. rememb fir model obtain accur thus, impli narrow envelopes. fig. 15 show envelop signal obtain fault #1when nois 20 db ad output signals. case, percentag increment envelop 8%, allow fault detect identification. compar identif result tables, seen identif time increas 6 10 s nois ad output signals. fact identif time window increas 6 10 s order good identif performance. therefore, possibl identifi fault fewer seconds. however, identif time obtain fault satisfactori definit lower time report approach applic (escobet et al., 2009). 6. conclus visualblock-fir fault diagnosi present appli fuel cell system. fault studi work, i.e. increas friction compressor motor, compressor motor suffer overheating, fluid resist increas water block channel flood diffus layer, air leak air suppli manifold and, finally, increas voltag valu compressor motor turn. faults, detect time lower second half accomplish correct identif obtain 7 s. detect identif fault difficult similar behavior compressor speed, cm, stack voltage, vfc, signal plant work properly. fault, minimum detect time 22 25 s identif time 28 31 s (i.e. absolut seconds, includ detect tabl 4 visualblock-fir perform fault uniform white nois 60, 40, 30 20 db ad output signal (s). ad nois increment envelop (%) detect identif o2 cm icm vfc o2 cm icm vfc fault #1 0.1% (60 db) 0 0.4 0.5 0.4 0.8 10 10 10 10 1% (40 db) 0 0.4 0.5 0.4 0.9 10 10 10 10 3.5% (30 db) 2.5 0.5 0.7 0.4 0.8 10 10 10 10 10% (20 db) 8 0.7 1.4 0.5 1.7 10 11 10 11 fault #2 0.1% (60 db) 0 0.6 0.9 0.4 1.8 10 10 10 11 1% (40 db) 0 0.5 1.3 0.4 2.0 10 11 10 11 3.5% (30 db) 2.5 0.7 1.6 0.5 2.3 10 11 10 12 10% (20 db) 8 2.3 2.7 0.7 7.6 12 12 10 17 fault #3 0.1% (60 db) 0 0.4 0.5 10 10 1% (40 db) 0 0.4 0.4 10 10 3.5% (30 db) 2.5 0.4 0.6 10 10 10% (20 db) 8 0.6 19.6 10 29 fault #4 0.1% (60 db) 0 0.3 0.4 0.4 10 10 10 1% (40 db) 0 0.3 0.4 0.4 10 10 10 3.5% (30 db) 2.5 0.3 0.5 0.7 10 10 10 10% (20 db) 8 0.6 45.0 10 54 fault #5 0.1% (60 db) 0 22.8 23.4 22.3 25.3 32 33 32 35 1% (40 db) 0 22.6 23.5 22.4 24.7 32 33 32 34 3.5% (30 db) 2.5 23.5 23.6 22.7 25.9 33 33 32 35 10% (20 db) 8 25.9 33.0 23.6 35 41 33 a. escobet et al. / engin applic artifici intellig 36 (2014) 4053 51 time) found. result compar favor obtain comput residu approach (escobet et al., 2009). robust visualblock-fir studi ad differ level nois output signals. detect identif time shown increas slightli presenc noise. however, perform good valu 60, 40 30 db. assum singl fault occur time. however, near future, plan extend research fault condit multifault occur simultaneously. strongli believ methodolog develop work potenti appli real world fuel cell stack implement on-board applications. taken account identif fir model line that, model librari available, fds, i.e. visualblock-fir, abl perform detect identif real time. notic new model ad fault model librari anytim adjust reconfigur fd required. refer aitouche, a., yang, q., ould bouamama, b., 2011. fault detect isol pem fuel cell base nonlinear analyt redundancy. applic pariti space approach. eur. phys. j. appl. phys. 54 (2), 23408 (11 pages). aitouche, a., olteanu, s.c., ould bouamama, b., 2012. survei diagnost fuel cell stack systems. in: proceed 8th ifac symposium fault detection, supervis safeti technic process (safeprocess). mexico city, mexico, august 2931, pp. 8489. becker, s., karri, v., 2010. predict model pem-electrolyz perform adapt neuro-fuzzi infer systems. int. j. hydrog. energi 35 (18), 99639972. chavez-ramrez, a.u., muoz-guerrero, r., durn-torres, s.m., ferraro, m., brunac- cini, g., sergi, f., 2010. high power fuel cell simul base artifici neural network. int. j. hydrog. energi 35 (21), 1212512133. escobet, t., feroldi, d., lira, s., puig, v., quevedo, j., riera, j., serra, m., 2009. model-bas fault diagnosi pem fuel cell systems. j. power sourc 192, 216223. escobet, a., nebot, a., cellier, f.e., 2008. visual-fir: tool model identifica- tion predict dynam complex systems. simul. pract. theori 16, 7692. feroldi, d., 2009. control design pem fuel cell-bas system (ph.d.). universitat politcnica catalunya. feroldi, d., serra, m., riera, j., 2007. perform improv pemfc control cathod outlet air flow. j. power sourc 169 (1), 205212. hissel, d., pra, m.c., kauffmann, j.m., 2004. diagnosi automot fuel cell power generators. j. power sourc 128 (2), 239246. hissel, d., candusso, d., harel, f.h., 2007. fuzzy-clust durabl diagnosi polym electrolyt fuel cell dedic transport applications. ieee trans. veh. technol. 4 (5), 12112420. kamal, m.m., yu, d.w., yu, d.l., 2014. fault detect isol pem fuel cell stack independ rbf model. eng. appl. artif. intell. 28, 5263. kamal, m.m., yu, d., 2011. model-bas fault detect proton exchang membran fuel cell systems. int. j. eng. sci. technol. 3 (9), 115. klir, g.j., elias, d., 2002. architectur system problem solving. plenum press, ny. law, a., kelton, d., 1990. simul model analysis. mcgraw-hill, new york, ny. lira, s., puig, v., quevedo, j., husar, a., 2010. lpv model-bas fault diagnosi rel fault sensit signatur approach pem fuel cell. in: proceed 18th mediterranean confer control & autom congress. palac hotel, marrakech, morocco, june 2325, pp. 12841289. liu, w., wang, x.g., 2003. fault diagnosi pem fuel cell sp model on-lin expert system techniques. in: proceed iast intern confer model simulation. palm springs, ca, usa, februari 2426, pp. 188191. nitsche, c., schroedl, s., weiss, w., 2004. onboard diagnost concept fuel cell vehicl adapt modeling. in: proceed ieee intellig vehicl symposium. parma, italy, pp. 127132. olteanu, s.c., aitouche, a., oueidat, m., jouni, a., 2012. pem fuel cell model simul takagisugeno fuzzi model. in: proceed inter- nation confer renew energi develop countri (redec). 2829 november, pp. 17. pukrushpan, j.t., peng, h., stefanopoulou, a.g., 2004. control orient model analysi automot fuel cell systems. trans. asm 126, 1425. rajashekara, k., 2000. propuls strategi fuel cell vehicles. fuel cell technolog vehicles, pp. 179187. rosich, a., sarrate, r., nejjari, f., 2014. on-lin model-bas fault detect isol pem fuel cell stack systems. appl. math. model. 38 (1112), 27442757. tao, s., si-jia, y., guang-yi, c., xin-jian, z., 2005. model control pemfc fuzzi neural networks. j. zhejiang univ. sci. 6 (10), 10841089. fig. 15. envelop increment 8% fault #1, nois 20 db ad output signals. a. escobet et al. / engin applic artifici intellig 36 (2014) 405352 vural, y., ingham, d.b., pourkashanian, m., 2009. perform predict proton exchang membran fuel cell anfi model. int. j. hydrog. energi 34 (22), 91819187. wang, h., yuan, x.z., li, h., 2011. pem fuel cell diagnost tools. crc press, boca raton, fl, usa. wu, j., yuan, x.z., wang, h., blanco, m., martin, j.j., zhang, j., 2008a. diagnost tool pem fuel cell research: i: electrochem techniques. int. j. hydrog. energi 33 (6), 17351746. wu, j., yuan, x.z., wang, h., blanco, m., martin, j.j., zhang, j., 2008b. diagnost tool pem fuel cell research: ii: physical/chem methods. int. j. hydrog. energi 33 (6), 17471757. yousfi steiner, n., hissel, d., mootguy, p., candusso, d., 2011. diagnosi polym electrolyt fuel cell failur mode (flood dry out) neural network modeling. int. j. hydrog. energi 36 (4), 3067. zhang, l., huang, a.q., 2011. model-bas fault detect hybrid fuel cell photo- voltaic direct current power sources. j. power sourc 196 (11), 51975204. zheng, z., petrone, r., pra, m.c., hissel, d., becherif, m., pianese, c., yousfi-steiner, n., sorrentino, m., 2013. review non-model base diagnosi methodolog pem fuel cell stack systems. int. j. hydrog. energy. 38 (21), 89148926. a. escobet et al. / engin applic artifici intellig 36 (2014) 4053 53 pem fuel cell fault diagnosi hybrid methodolog base fuzzi pattern recognit techniqu introduct fault diagnosi methodolog visualblock-fir fault detect visualblock-fir fault identif case study: pem fuel cell fault diagnosi pem fuel cell fir qualit model identif simul result robust visualblock-fir conclus refer