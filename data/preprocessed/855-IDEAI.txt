us binari partit tree tree crown segment tropic rainforest hyperspectr imag g. tochona,b,, j.b. feretb,c,, s. valeroc, r.e. martinb, d.e. knappb, p. salembierd, j. chanussota,e, g.p. asnerb agipsa-lab, 11 rue de mathematiques, 38400 saint martin dheres, france. bdepart global ecology, carnegi institut science, 260 panama street, stanford, ca 94305, usa. ccesbio, 18 avenu edouard belin, 31400 toulouse, france. dtechnic univers catalonia (upc), jordi girona 1-3, edifici d5, 08034 barcelona, spain. efaculti electr engineering, univers iceland, reykjavk, iceland. abstract segment remot sens imag acquir tropic forest great numer ecolog applications, forest in- ventori conserv manag ecosystems, speci classif techniqu estim number individu highli valuabl inputs. paper, propos method hyperspectr imag segmentation, base binari partit tree (bpt) algorithm, appli site locat hawaiian panamean tropic rainforests. differ strategi combin spatial spectral dimension reduct compar prior construct bpt. su- perpixel gener method includ watersh transform mean shift cluster appli decreas spatial dimension provid initi partit map. princip compon analysi perform reduc email addresses: (g. tochon), (j.b. feret) preprint submit remot sens environ decemb 5, 2014 spectral dimension differ combin princip compo- nent compared. non-parametr region model base histograms, combin diffus distanc merg regions, build bpt. adapt prune strategi base size discontinu merg region propos compar exist prune strategy. finally, set criteria assess qualiti tree segment introduced. propos method correctli segment 68% tree crown produc reason pattern segment landscapes. keywords: binari partit tree, carnegi airborn observatory, hyperspectr imagery, segmentation, tree crown delineation, tropic forest 1. introduction1 grow need large-scal assess biodivers and2 speci rich ecosystems, mean improv forest conservation3 manag decisions. tropic rainforest ecosystem critical4 hotspot biodiversity, greatli contribut the5 world biotic varieti cover small percentag terrestrial6 surface. moreover, particularli vulner multipl factor pres-7 sure exploit natur resourc climat chang (asner8 et al., 2009; thoma et al., 2004; whitmor et al., 1990). context,9 inform forest structure, number, spatial distribut and10 identif individu trees, speci rich evolution, and11 dynam invas speci landscap highli sought after12 effici manag decis appli forest conservation. related13 field data collect extrem expensive, time-consum requir very14 2 skill field workers. constraint support technolog and15 method accur regular monitor evolut biological16 divers larg spatial scales. remot sens appear particularly17 effici tool applic (rasi et al., 2013; reich et al., 2013).18 however, monitor tropic forest ecosystem remot sens remains19 extrem challeng complex canopi term density,20 structur speci rich (pape et al., 2013; pouteau & stoll, 2012;21 somer & asner, 2013).22 inform deriv remot sens data,23 individu tree crown (itc) delin particularli import product24 assist fine-scal analysi ecolog process link veget struc-25 ture gap dynam (phinn et al., 2008), improv tree species26 identif (clark et al., 2005). indeed, region properti (texture, size,27 shape, radiometr variability) deriv itc delin on28 image, result combin spatial radiometr information.29 object-ori approach usual outperform tradit pixel-based30 method classif imag process applic as31 spectral unmix object detection, dramat enrich contextual32 inform deliv remot sens products. practice, high spatial33 resolut itc delin us help monitor speci interest,34 domin trees, rare invas speci kei indic for35 environment process (asner et al., 2008). detect36 illeg logging, log practic nowadai select assist by37 moder resolut satellit imag detect larg scale deforest (asner38 et al., 2005).39 3 segment method develop itc delin based40 high spatial resolut imageri deriv sensors, satellite41 high resolut imageri airborn light detect rang (li-42 dar) data. however, select segment algorithm critic as43 perform method usual strongli ecosystem-dependent.44 itc typic encount temper forest offer appeal-45 ing characterist develop segment algorithms. fact,46 tree regular shape elong silhouette, canopi is47 sparse. exist segment algorithm devot segmentation48 temper forest take advantag properties. instance, it49 assum forest area high resolut digit imageri itc50 repres bright pixel (the crown, illumin the51 sun) surround darker pixel (either shade portion crown the52 ground) (wulder et al., 2000). topograph analogy, itc be53 view peak vallei circl physic boundaries.54 vallei follow approach exploit idea encircl bright pixels55 darker boundaries, gougeon (1995); lecki et al. (2005,56 2003) segment conifer plantations, warner et al.57 (1998) decidu forests. reli topograph representation,58 region grow approach implement seed local maxima image,59 seed potenti locat itc. regions60 gradual expand seed stop criterion, base on61 presenc valleys, reached. region grow method validated62 australian eucalypt forest culvenor (2002); whitesid & ahmadb63 (2008) conifer forest erikson (2004); pouliot et al. (2002).64 4 marker-control watersh method analog region growing65 grei tone invert topograph representation, is,66 local maxima correspond itc local minima. instead of67 expand region bright valu dark ones, watersh flood up68 topograph map creat region correspond catchment basins.69 marker plai role seed region grow approach, and70 temper algorithm sensibl nois order avoid over-segmentation.71 approach valid wang et al. (2004) segment of72 canadian conifer forests. comparison vallei following, region73 grow marker-control watersh method conifer decidu-74 ou tree stand drawn ke & quackenbush (2011). templat matching75 appli itc regular elong shape. it76 consist synthet model tree shape collect templates77 gener ellips physic possibl paramet values.78 templat cross-correl potenti tree posit the79 digit image, locat highest correl consid to80 itc posit correspond templat assum the81 tree shapes. templat match olofsson (2002); pollock (1996,82 1998) conifer mix forests, comparison template83 match region grow approach appli delin swedish84 spruce stand erikson & olofsson (2005). finally, stochastic85 point process method model imag realiz mark point86 process ellipses. process, digit image, contain unknown87 number object (trees), unknown configuration88 (the ellipt shape orientation). energi term correspond fit89 5 model real imag defined, model iteratively90 adjust order decreas energi term iteration. prior knowl-91 edg gener distribut shape size need operate92 method, paramet easili deriv tree have93 similar structures. point process investig perrin et al. (2005)94 poplar plantat andersen (2003) conifer forests.95 methods, base strong hypothes crown size shape96 (exist uniqu maximum individu limit overlapping97 individuals) good result high resolut digit imag of98 temper forests. however, perform poorli appli tropical99 dens forest ecosystems, tree size shape highli variable, and100 individu usual overlap. varekamp & hoekman (2001) propos method101 base fourier parameter deform model interferometr syn-102 thetic apertur radar (insar) data. intensity, interferometric103 height-coordin coher magnitud measur proper in-104 sar imag system, match itc deform ellipses, applied105 method tropic forest locat kalimantant, indonesia. note106 zhou et al. (2010) appli mark point process high resolution107 imageri lidar-deriv canopi height order detect individu in108 high biomass mangroves, includ canopi species. results109 encouraging; replic appli dense110 tropic forest given rel low heterogen mangroves.111 decade, studi explor potenti spectroscopic112 imageri tree speci identif dens tropic forest (clark113 et al., 2005; feret & asner, 2013), tree crown delin (bunting114 6 & lucas, 2006) open mix forests. differenti speci is115 base spectral signature, relat leaf chemistri indi-116 vidual tree structure. detail spectral inform valuable117 input detect boundari neighbor tree dens tropic forests.118 however, come major challeng relat high dimensionality119 data need adapt algorithm autom tree crown120 segmentation. best knowledge, refer studi the121 segment tree crown hyperspectr imag tropic rainforests.122 imag segment appli dens tropic forest ill-pos task: a123 given imag segment level details, the124 complex architectur canopy. reason, better125 consist hierarchi segment collect of126 minim relat segmentations. allow user tune exploration127 level hierarchi precis goal (jung et al., 2014; tarabalka128 et al., 2012). mathemat tree structur suit hierarchical129 region-bas represent image. structure, node of130 tree repres given region correspond image, links131 node illustr particular relationship regions, as132 inclus adjacency. tree representations, binari partition133 tree (bpt) receiv attent lately. initi propos garrido134 (2002); salembi & garrido (2000) grayscal rgb images, bpts135 extend hyperspectr imageri valero et al.136 (2013a) classic hyperspectr remot sens tasks137 segment (valero et al., 2011a; veganzon et al., 2014), classifi-138 cation (alonso-gonzalez et al., 2013), unmix (drumetz et al., 2014) and139 7 object detect (valero et al., 2013b, 2011b) notably. effici the140 bpt achiev given task greatli impact pre-processing141 appli imag prior construct bpt post-142 process bpt represent itself, call pruning.143 consequently, propos follow studi adapt bpt repre-144 sentat segment hyperspectr imag tropic rainforests,145 adapt pre-process data prune bpt. the146 pre-process stage consist spectral spatial reduc data147 extract discrimin inform princip compon analysis148 (pca) spatial pre-segmentation, respectively. differ configurations149 pca reduct pre-segment algorithm are150 investigated. novel bpt prune strategy, dedic segmentation151 tree crown propos compar exist pruning152 strategy. method assess qualiti result segment also153 introduced, allow state effici spectral reduction154 configur pre-segment algorithm given context. pro-155 pose method test data set differ characteristics.156 paper organ follows: section 2 introduc data to157 test algorithm. section 3 present methodology, pre-158 process operations, construct prune bpt, the159 method develop assess perform segmentation. results160 introduc discuss section 4. finally, conclus and161 perspect applic method given section 5.162 8 2. materials163 site select conduct study. site, hereafter164 name hawaii, locat nanawal forest reserve, hawaii (usa).165 nanawal forest classifi lowland humid tropic forest, an166 averag elev 150 m sea level. mean annual precipit and167 temperatur 3200 mm.yr1 23c, respectively. forest canopy168 compris 17 species, invas non-n trees, a169 nativ speci remaining. remot sens data study170 acquir carnegi airborn observatori (cao) alpha sensor171 packag septemb 2007 (asner et al., 2007). cao-alpha equipped172 spectroscop imag measur 72 band visibl and173 near infrar (vnir) domain, small footprint light detection174 rang sensor (lidar) work simultaneously. studi site175 correspond 1980 1420 pixel imag 0.56 m ground sampling176 distance, cover area 70 hectar ground. spectral177 resolut campaign result acquisit 24 spectral178 band 28 nm width evenli space 390 nm 1044 nm.179 lidar acquisit perform discret return mode (4 returns)180 digit elev model (dem) canopi height model (chm)181 coregist hyperspectr data produced.182 second site, name panama, situat panama forest.183 data collect parqu nacion san lorenzo republic184 panama. site humid tropic forest mean annual precipitation185 3300 mm.yr1. mean annual temperatur 26c. canopi considered186 old growth forest popul tree 200-300 year age. canopi height187 9 rang 20 m maximum 45 m. data collect using188 carnegi airborn observatori airborn taxonom map system189 (cao-atoms) (asner et al., 2012), launch june 2011. cao-atoms190 integr sensor platform, includ new high fidelity191 visible-shortwav imag spectromet (vswir) measur 380-2510192 nm wavelength rang 5 nm spectral resolution, dual-laser, waveform193 lidar system, high-resolut visible-to-near infrar (vnir) imaging194 spectrometer. data acquir studi site correspond 600195 600 pixel vswir imag spatial resolut 2 m including196 224 spectral band (12 nm fwhm) evenli space 378 nm 2510197 nm co-regist dem chm. 175 band retain the198 vswir imag elimin unwant spectral band those199 correspond atmospher water absorption.200 total 160 itc hawaii 100 itc panama manually201 delin train operator, envi software, visual202 interpret hyperspectr imagery, order assess segmentation203 accuracy. particular care taken includ individu shape,204 size species. exampl manual delin itc observed205 figur 1 2.206 3. propos segment strategy207 3.1. principl binari partit tree208 remot sens imag earth surfac typic compos of209 semant region interest, buildings, trees, crop fields, . . .210 region follow hierarch organ (for instance, building211 10 (a) (b) figur 1: (a) rgb color composit hyperspectr sub-imag hawaii site (r=646 nm, g=561 nm, b=447 nm, stretch colors) itc manual delin (in white) (b) correspond canopi height model deriv lidar itc (in red). enclos neighborhood, enclos city), the212 place particular region hierarchi directli relat scale of213 explor (the scale explor build finer a214 neighborhood). analyz image, choos scale based215 intend level details, oper application-dependent.216 result, valuabl repres imag task-independent217 hierarchi regions, set explor level hierarchi afterwards218 base application. binari partit tree (bpt) solut to219 achiev hierarch region-bas represent image. starting220 initi partit imag (correspond individu pixels221 region defin preliminari segmentation), neighbor region are222 iter merg region remaining, and223 11 (a) (b) figur 2: (a) rgb color composit hyperspectr sub-imag panama site (r=634 nm, g=549 nm, b=463 nm, stretch colors) itc manual delin (in white) (b) correspond canopi height model deriv lidar. merg store tree structure. thus, correspond tree224 representation, leaf node correspond region initi partition225 image, root tree repres imag support, each226 node correspond region result merg two227 children regions. follow definition, tree structur corresponding228 initi partit n leav contain total 2n 1 nodes. figur 3a229 show differ step construct bpt, determined230 notions:231 - region model mr, specifi regionr mathematically232 handled, model union regions. region233 descriptor (for instanc mean grayscal valu figur 3a) used234 12 compar neighbor regions.235 - merg criterion o (ri,rj), quantifi similar be-236 tween neighbor region ri rj measur distanc between237 region models. thus, merg criterion determin which238 order region merged.239 prune step take place bpt construct completed.240 prune aim cut branch bpt new leaves241 prune tree achiev relev segment the242 application. construct tree gener definit of243 region model merg criterion, prune strategi application244 dependent. therefore, level explor defin pruning245 operation, differ prune strategi appli bpt are246 like produc differ segmentations. prune oper illustrated247 figur 3b.248 (a) (b) figur 3: (a) construct bpt, (b) exampl prune it. 13 3.2. methodology249 propos method summar flowchart displai figur 4.250 compos 4 differ steps, pre-process stage, the251 construct bpt, prune bpt qualiti evaluation252 produc segment map. pre-process stage compris data253 dimension reduct pre-segmentation, produc input the254 bpt construct stage. vari input configurations, study255 influenc segment qualiti evalu processes.256 moreover, introduc bpt prune strategi base evolut of257 region size branch bpt. compar new pruning258 strategi exist reli spectral graph parti-259 tion (alonso-gonzalez et al., 2013; valero, 2011). finally, present the260 metric qualiti assess segment maps.261 3.3. pre-process step262 construct bpt computation intens may263 problemat applic larg datasets. here, pre-processed264 data order reduc spectral spatial dimens data.265 3.3.1. spectral reduction266 detail spectral properti element (pixel object) extracted267 spectroscop imageri particularli interest classif pur-268 poses. however, strong correl exist contiguous269 bands, lead redund inform (thenkabail et al., 2004) com-270 putation intens processes. therefore, spectral reduct required271 extract relev inform elimin redundancies. principal272 14 compon analysi (pca) perform orthogon transform the273 initi spectral space space equal dimens show linear274 correl latent features. latent featur (name hereafter275 princip components, pcs) ranked, follow decreas amount276 varianc explained, criterion commonli perform com-277 ponent selection. indeed, pc explain low varianc usually278 contain noise. however, choic select pc explain most279 varianc lead suboptim select given application, the280 signal influenc factors, for281 consid applic lead high varianc valu (contrarily,282 lead high varianc valu interest). known for283 instanc influenc bright particularli strong radiometric284 signal measur veget high spatial resolut imagery285 pixel smaller itc (fung & ledrew, 1987; horler & ahern, 1986).286 indeed, angl view, illumin surfac geometri are287 respons direct effect shade. bright accounts288 total variance, factor relev criterion differ-289 entiat individu spectral variat bright particularly290 strong individu evid dissimilar itcs.291 hand, relev factor delin itc related292 individual- species-specif trait leaf chemistri (for instance,293 photosynthet pigment water content) veget structur (foliage294 density, leaf angl distribution, tree shape, etc). factor known295 significantli influenc spectral properti measur individual296 tree (cones et al., 1988; morton, 1986), influenc fea-297 15 ture pcs. opposite, select pc show irrelevant298 inform itc segment best case respons lower299 comput performances, worst case sourc nuisanc for300 accur delin itcs.301 studi influenc ident retain pc on302 qualiti tree crown segmentation. select exclus pc303 relat user abil visual assess presenc information304 allow speci discrimin pc. information, call discrimi-305 nant information, contain pc individuals306 group individu clearli distinguish background the307 component. follow spectral configur investigated:308 - initi unprocess hyperspectr data, show strong correla-309 tion bands,310 - output pca transformation, pc selection,311 - select pcs, visual select contain us inform for312 speci discrimination. discrimin inform visually313 assess user, base presenc pattern highlighting314 differ individuals, case, pc #1 selected315 reason explain earlier.316 - previous mention select pcs, plu pc #1.317 permiss strategi adopt visual examination: components318 show individu retain compon look noisy319 overall. varianc appropri select compo-320 nents, notic interest inform contain first321 16 half components. figur 5 exhibit subset imag corresponding322 hawaii site pcs. discrimin inform seen323 figur 5c 5f, individu clearli distinguish within324 components. tabl 1 specifi number band ident of325 pc case differ sites. tabl 1: number band perform bpt segment studi site ident compon selected. hawaii panama hyperspectr imag 24 175 pca transform 24 175 visual pc select + pc#1 8 22 visual pc select 7 21 compon select 2-8 2,3,5,9,10,12,13,15,17-21 visual inspect 23,25,28,29,33,34,42,46 326 3.3.2. spatial reduction327 partit initi construct bpt com-328 pose individu pixel (the finest partit scale) (valero et al., 2013a),329 region obtain preliminari segmentation. recom-330 mend prior inform known size final regions,331 option computation effici significantly332 decreas number node bpt. application, di-333 mension emerg itc rang ten pixel thousand of334 17 pixel largest individuals. therefore, preliminari segment of335 origin imag investig construct bpt. the336 main constraint pre-segment produc region smaller than337 individu tree order avoid group itc region, the338 algorithm includ region splitting. boundari regions339 obtain pre-segment respect possible340 actual boundari itc order recompos good341 accuracy. investig differ approach produc initial342 segment map, compar initi pixel343 level. approach deriv initi segment map based344 differ initi data differ segment methods:345 - approach lidar-deriv chm, present in346 figur 1b 2b. preliminari smooth appli the347 initi chm, includ applic 5 5 median filter followed348 discret step 0.5 m. discret chm was349 segment watersh algorithm (beucher & lantuejoul,350 1979; meyer & beucher, 1990), tend produc strongly-over-351 segment regions.352 - second approach base hyperspectr watersh segmenta-353 tion, expos noyel et al. (2007); tarabalka et al. (2010). first, the354 gradient map origin hyperspectr data computed, a355 robust color morpholog gradient (tarabalka et al., 2010). then, a356 classic watersh algorithm appli gradient map, once357 result strongli over-seg partition.358 18 - approach base mean shift cluster (comaniciu359 & meer, 2002) rgb represent hyperspectr data. bands360 center 646.0 nm (r), 560.7 nm (g) 447.0 nm (b) for361 hawaii, band center 638.83 nm (r), 548.77 nm (g) 458.71362 nm (b) panama. mean shift cluster performed363 freewar edg detect imag segment (edison,364 cases, result initi segment map satisfi after366 visual examination, obtain region small prevent367 individu merg region. figur 6 show initial368 segment map correspond methods.369 3.4. construct binari partit tree370 construct bpt start pre-process step com-371 pleted, depend definit region model merging372 criterion. commonli region model deal with373 hyperspectr imag (valero, 2011; valero et al., 2010a). choos to374 model hyperspectr region mean spectrum (also call order375 parametr region model), allow us simpl merg criteria mea-376 sure discrep spectra. however, merg criteria377 prove perform poorli discrimin tree speci tropical378 forest (clark et al., 2005), assum spectral homogen each379 region preserv spectral distribut variability. the380 non-parametr statist region model satisfi application,381 account spectral variabl region. case, region382 19 model set histogram follows:383 hr = ( h1r , . . . ,h m r ) (1) hir empir distribut reflect valu region384 r band m number spectral band image.385 m histogram convert probabl density386 function (pdf) normal (so sum bin equal 1). this387 allow us metric measur discrep pdfs. in388 particular, decid us diffus distance, propos ling & okada389 (2006), successfulli merg criterion bpt construction390 valero et al. (2010a). distance, detail 5, particularli robust to391 illumin chang allow handl case tree crown half-lit,392 half shaded. construct bpt initi comput of393 merg criterion pair neighbor regions. merging394 iter involv search neighbor region achieve395 lowest pair-wis similar pair neighbor region the396 current segment map. region consequ merged. is397 noteworthi method program favor merg very398 small region (calderero & marques, 2010), order decreas risk399 over-segment smooth final segmentation. practice, the400 averag region size segment map comput merging401 iteration, region size 15% averag size given402 merg priority.403 20 3.5. prune binari partit tree404 construct bpt, prune aim cut branches405 leav prune tree correspond meaning region regarding406 desir application. therefore, step critic achiev proper407 segmentation, goal design gener prune strategi giving408 optim itc delin forest type imag characteristics409 (spatial spectral resolutions), minim expert parametrization. many410 prune strategi investig literatur clas-411 sical (salembi & garrido, 2000) hyperspectr bpt (valero et al.,412 2010a,b). attempt design gener prune strategy, one413 cite minim energi cost function, recurs spectral414 graph partit (alonso-gonzalez et al., 2013; valero, 2011). former415 associ prune cost node bpt look partition416 minim overal cost, subject given number region parti-417 tion, us lagrangian multipliers. strategi requir the418 knowledg final number region imag operated. is419 inapplic studi paramet known priori. therefore,420 propos new prune strategi devot segment tree crowns421 hyperspectr imag compar result obtain using422 recurs spectral graph partitioning.423 3.5.1. recurs spectral graph partit prune strategy424 recurs prune strategi us refer compar our425 method base techniques: spectral graph partit (von luxburg,426 2007) normal cut (shi & malik, 2000). prune strategi analyzes427 branch bpt, seek best level partit sets,428 21 similar node given set high, the429 similar set low. given that, leaf bpt votes430 ancestor branch wish repres by. branch,431 cut node highest ratio vote with432 respect number leav hang it, order favor nodes433 close root greater number leav potenti a434 great number votes. partit process reli dissimilarities435 node bpt, assum particular knowledge436 current process image.437 3.5.2. evolut region size prune strategy438 above-pres prune strategi base spectral properti of439 graph construct bpt depend scene depicted440 hyperspectr imag application. however, not441 optim specif applic segment tree crowns442 tropic rain forest hyperspectr images. moreover, solv the443 graph partit problem computation intens large444 imag potenti huge bpts. overcom limitation, propose445 novel prune strategi adapt aforement vote process to446 tree crown segment tropic forests. initi segmentation447 map over-segmented, itc initi split regions.448 neighbor region belong itc theoret closer449 spectral neighbor region belong itc different450 species. result, region defin itc low pair-wise451 distanc merg earli iter merging452 algorithm. earli iter lead region reach critic size453 22 point neighbor region spectral dissimilar because454 contain itc belong differ species. final iterations455 merg process usual involv region compris several456 individuals. result, evolut region size leaf the457 bpt root show clear discontinu step region no458 longer agglomer leav it, merg instead default with459 grown region neighborhood. observ practic that460 accur delin itc correspond region defined461 right discontinuity, observ figur 7.462 novel prune strategi deriv observation: leaf votes463 node prior discontinu branch. introduction464 size threshold paramet allow detect discontinuity: a465 discontinu flag size differ consecut nodes466 exce threshold. prune decid leav voted:467 non-leaf node bpt number vote divid number468 leaves, bpt branch cut node ratio number469 nodes/numb leav highest branch. node have470 ratio branch, cut the471 farthest apart root, decreas chanc under-segmentation.472 set size threshold control discontinu height, it473 possibl influenc characterist size final regions: set of474 low threshold valu tend gener small region vote process475 sensit leap evolut region size. contrarily, a476 high valu lead larg region correspond segmentation. for477 hawaii site, threshold valu 200 2000 200 step wide have478 23 tabl 2: basic statist delin itc test sites. hawaii panama number itc 160 100 mean size (in pixels) 843 205 standard deviat 648 158 minim itc size 36 39 maxim itc size 3846 778 tested, panama site, averag crown size smaller,479 valu rang 150 1500 150 step wide tried.480 3.6. assess segment accuracy481 assess segment qualiti difficult task general, it482 requir definit meaning evalu criteria, criteria are483 defin respect given goal avail ground truth484 data. criteria literature, symmetr asymmetric485 distanc (cardoso & corte-real, 2005), ask refer segment to486 used. however, manual delin itc avail our487 case. tabl 2 displai basic statist itcs.488 tree pruned, itc describ corre-489 spond segment follow differ states: detected,490 over-segmented, under-segmented, missed. propos evalu the491 segment accuraci percentag itc classified492 correctli detect total number itc tested. very493 unlik automat delin crown exactli match manually494 24 delin one. inaccuraci regions, be495 evalu number misseg pixels, depend size of496 region manual delineated. therefore, defin follow some497 criteria integr margin error manual delin itcs498 obtain segment process. given manually499 delin itc, step retriev segment repres the500 itc best final segment map. practice, segment that501 share 50% pixel itc consid element the502 itc. case segment 50% pixel belonging503 itc, itc repres segment have highest504 percentag pixel it. consequently, itc compos one505 segment segments. following, c denot set pixels506 correspond itc, s = {s1, . . . , sitc} set segment in507 final segment map retriev compos itc. figur 8508 present process determin c classifi its509 correspond set segment s:510 - test concern over-segmentation. itc crown appears511 over-seg segment compos it, and512 case treat aside. s contain segment, overlap513 degre s c computed. defin by514 overlap = |c s| |c| (2) |c s| denot number pixel intersect c and515 s, |c| number pixel compos itc. represents516 itc captur segment repres it.517 25 consequently, overlap degre exce 0.7 (the518 segment repres itc contain 70% itc), the519 itc classifi missed.520 - itc missed, ratio degre s c computed,521 ratio = |s| |c| (3) ratio greater 1.5 (the segment 50% bigger than522 itc represents), itc classifi under-segmented.523 - itc miss under-segmented, classified524 detected.525 - case itc over-segmented, additional526 test examin sever over-segmentation. one527 segment s? {s1, . . . , sitc} s? account 85% the528 area cover s, overlap ratio degre s? such529 make itc detected, over-segmentation530 discard itc classifi detected. otherwise, itc531 remain over-segmented.532 previou case observ figur 9. threshold valu overal533 ratio degre discard over-segment set empirically. the534 influenc final segment qualiti input paramet (the initial535 segment map pca configuration) prune strategy536 assess percentag correctli delin itcs.537 26 4. result discussion538 4.1. results539 tabl 3: percentag correctli segment itc hawaii test site, accord chosen setting. set defin spectral reduct configur (no pca, pcs, select pcs), initi segment (pixel scale, mean shift clustering, hyperspectr watershed, watersh lidar) prune strategi (graph cut, region size discontinuity). region size discontinu prune strategy, threshold valu investigated: report maximum percentag correspond threshold valu (in parentheses). hawaii pca pc select pc 1st pc 1st pc graph cut pixel scale 15.0 24.4 28.1 33.8 mean shift 32.5 38.8 40.0 42.5 region size discontinu hyperspectr 6.9 (600) 30.6 (1400) 29.4 (1200) 40.0 (1600) lidar 36.9 (600) 47.5 (600) 47.5 (600) 48.8 (600) mean shift 28.1 (1000) 47.5 (1000) 45.6 (1600) 54.4 (1200) tabl 3 4 displai percentag itc correctli delin for540 hawaii panama test sites, respectively, respect varying541 input paramet prune strategies. investig pruning542 strategi denot graph cut recurs spectral graph partitioning543 strategy, region size discontinu propos evolut the544 region size strategy. initi segment map denot follows:545 27 tabl 4: percentag correctli segment itc panama test site, ac- cord chosen setting. set defin spectral reduct configur (no pca, pcs, select pcs), initi segment (pixel scale, mean shift clustering, hyperspectr watershed, watersh lidar) prune strategi (graph cut, region size discontinuity). region size discontinu prune strategy, threshold valu inves- tigated: report maximum percentag correspond threshold valu (in parentheses). panama pca pc select pc 1st pc 1st pc graph cut pixel scale 44.0 54.0 51.0 63.0 mean shift 54.0 54.0 59.0 61.0 region size discontinu hyperspectr 26.0 (150) 33.0 (150) 42.0 (150) 43.0 (450) lidar 39.0 (150) 55.0 (150) 51.0 (150) 49.0 (150) mean shift 45.0 (150) 63.0 (150) 66.0 (150) 68.0 (150) pixel scale initi pixel level, hyperspectr the546 hyperspectr watersh segmentation, lidar classic watershed547 algorithm appli lidar data, mean shift mean shift clustering.548 input imag bpt built denot pca, all549 pcs, select pc 1st pc select pc 1st pc for550 raw hyperspectr data, pca transform pc retained,551 pca transform select pcs, without552 pc#1 retained, respectively. threshold valu test the553 propos prune strategy, rang 200 2000 gap 200 for554 28 hawaii, 150 1500 gap 150 panama. maximum555 percentag correspond threshold valu reported. the556 highest percentag configur highlight red. both557 sites, configur involv spectral reduct perform pca with558 select pc exclud pc #1, initi segment result from559 mean shift cluster propos region size discontinu strategy560 prune bpt. rational conclus discuss the561 subsect 4.2. figur 10 displai segment result obtained562 sites.563 4.2. discussion564 4.2.1. pca configuration565 test sites, initi partit prune strategies, results566 signific improv pca transform perform with567 respect case bpt directli built raw hyperspectral568 data. conclud discrimin inform extract pca569 eas speci discrimin improv region model bpt.570 effici pca configuration, clear conclusion571 best strategi pc select of572 pc includ pc #1. fact littl variat term amount573 discrimin inform configurations, bands574 exlud configur contain us information575 speci discrimination. hand, discard pc improves576 results. explain section 3.3.1, pc contain brightness577 variat measur nir domain, highli non-discriminative578 feature. includ pc prejudici instanc tree579 29 crown half-lit, half-shaded. case, distanc two580 halv increas construct bpt histograms581 correspond pc signific differences. halves582 merg together, prevent tree crown correctly583 segment prune step. result, select pc without584 pc #1 includ configur give highest percentag of585 detect itc studi spectral reduct configurations.586 4.2.2. initi segment map587 pre-segment method investigated, hyperspectral588 watersh systemat give lowest percentag correctli segmented589 itcs. counter-intuit hyperspectr watersh produces590 smaller region segment method (see figur 6),591 decreas risk region group itcs592 together. however, precis analyz initi regions, can593 square-lik shape. opposite, initial594 region deriv lidar watersh mean shift cluster more595 heterogen shape size pertin boundari (some596 itc directli recogniz initi segment map). is597 plausibl fact hyperspectr watersh involv the598 comput multidimension gradient raw hyperspectr data.599 nois present data, low ground sampl resolution,600 lead imprecis gradient map. follow watersh gradient601 map produc region follow real edg image602 (high valu area gradient map), fake edg introduc the603 noise, initi region lack consistency. contrast, mean shift clustering604 30 lidar watersh base band raw hyperspectr data605 smooth version chm, respectively. consequently606 sensit nois gener accur regions. emphasizes607 necess initi segment map region relev enough608 recompos accur real boundari itcs. additionally,609 lidar watersh method tend produc larger initi region than610 mean shift cluster method (if neighbor tree same611 height, like group region instance), increasing612 risk final under-segmentation. panama site, itc a613 small size (205 pixel averag 100 delin itcs) and614 consequ sensibl under-segmentation, explain the615 lidar watersh slightli outperform mean shift clustering. this616 true hawaii test site itc larger size both617 segment method produc compar results.618 conversely, possibl merg combin bpt619 initi pixel level, chanc miss over-segment620 region. fact easier reconstruct real region borders621 partial known, case initi segment was622 correctli performed. particularli true expect region have623 larg size, explain mean shift cluster lead better results624 pixel scale hawaii site. however, mean shift clustering625 pixel scale initi similar result panama, smaller626 regions. nevertheless, number node bpt proport to627 number region initi partition. us mean628 shift cluster initi pre-segment prefer as629 31 drastic decreas number region initi partit (thus630 reduc comput load) degrad results.631 4.2.3. prune strategy632 challeng compar perform investigated633 prune strategies. said section 3.5, prune strategi strongly634 depend application. recurs spectral graph partit strategy635 tri gener possible, exploit dissimilar each636 branch bpt, type images. prune strategy, presented637 section 3.5.2 reli properti hold bpt built an638 imag contain region limit size range. the639 case forest area real region correspond tree crowns, which640 upper lower bound size physic reasons, ensur clear641 discontinu evolut region size corresponding642 bpt branch. analyz detect percentages, seen our643 propos prune strategi lead slightli better result recursive644 spectral graph cut prune strategy, confirm appropriate645 segment tree crowns.646 4.2.4. threshold valu propos prune strategy647 tune threshold valu propos prune strategi also648 import point. said section 3.5.2, threshold valu impact the649 averag region size final segment map. indeed, high threshold650 valu permiss term discontinu evolut region size651 branch larger discontinu allowed. consequently, leaves652 vote node closer root, larg final region potential653 32 under-segment image. hand, low threshold value654 sensit term discontinuity, favor small region final655 segment increas chanc over-segmentation. naturally,656 percentag over-seg (under-segmented) itc decreas (an657 increasing) function threshold value, observ figur 11.658 hand, percentag miss itc remain rel constant659 (an itc declar miss region match it). then660 clear threshold valu consid optim achiev a661 trade-off over-segment under-segment phenomena.662 explicit rule best valu achiev compromise,663 remark close averag size expected664 regions. matter fact, figur 11a show threshold valu achieving665 best trade-off over- under-segment hawaii, pc666 select pc #1 mean shift cluster 1000 1200 whereas667 tabl 2 exhibit mean itc size 843 pixels. panama, figur 11b gives668 optima threshold valu 150 300 averag itc size 205.669 differ averag itc size site be670 explain i) differ spatial resolut images671 (0.56 m hawaii 2 m panama), ii) structur differ of672 individu tree sites, explain physical, environmental673 anthrop factors. therefore, roughli estim threshold value674 base averag size expect region (regard characteristics675 imag segment), adapt valu depend result,676 needed. mean local automat adjust threshold value677 overcom supervis natur method ensuring678 33 robust highli variabl itc size.679 4.2.5. gener perform propos method680 tropic rainforest richest complex ecosystem in681 world. given densiti canopi term individu species,682 complex structure, achiev perfect delineation683 tree crown highli unrealistic. however, partial information684 allow better delimitation, identif enumer certain685 speci (such dominant, rare invas speci are686 kei indic environment processes) help ecologist better687 understand complex ecosystems. despit studi tree688 crown classif tropic rainforest (see exampl feret & asner689 (2013) clark et al. (2005)), is, best knowledge, reference690 studi segment tropic rainforests. bunt & luca (2006)691 develop segment method hyperspectr images, appli on692 compact airborn spectrograph imag (casi) data acquir mixed693 australian forests. report 70% success segment of694 tree cluster tree belong species, rel sparse695 veget covers. however, note signific drop segmentation696 accuraci dens complex canopies. result obtain proposed697 method (up 54.4 % hawaii 68% panama best cases) for698 delin tree crown characterist (such size, shape699 species) promising. moreover, segment result are700 visual consistent, seen figur 10. motiv pursue701 addit measur improv propos method, order better702 identifi segment tree crown tropic rainforests.703 34 5. conclusion704 accur automat delin tree crown tropic rain-705 forest allow applic object-ori methods, example706 estim leaf chemistry, tree speci identif proved707 perform better pixel-ori counterparts. task is708 extrem challeng complex ecosystems. here, present a709 method segment hyperspectr imag tropic rainforests,710 base binari partit trees. evalu method conducted711 test site present differ imag properti (ground sampling712 distanc number spectral bands) forestri characteristics. the713 contribut present studi following:714 - adapt gener bpt algorithm specif application,715 segment tree crown hyperspectr imag tropical716 rainforests. select pertin region717 model merg criterion.718 - introduct pre-process step includ spectral spatial719 dimension reduction. former, achiev pca transfor-720 mation, demonstr pca extract highlight discriminant721 inform appli imag acquir forest covers. also722 illustr low discrimin capac pc comparing723 pc combin input imag bpt construction.724 show initi bpt initial725 over-segment imag respect pixel level. we726 show pre-segment meet strict requir in727 35 term size border gener regions. result three728 differ segment algorithm compared. mean shift clustering729 prove effici method investigated.730 - introduct new bpt prune strategy, base voting731 process leaf bpt elect favorit ancestor. the732 vote depend evolut region size branch, as733 remark clear discontinu term region size node734 correspond region repres tree crown best. only735 prune strategi adapt segment forest areas,736 imag featur patchwork homogen regions. we737 compar novel prune strategi exist one,738 base spectral graph partitioning. result show proposed739 prune strategi adapt precis task.740 - introduct method assess segment quality, based741 knowledg refer region only. indeed, the742 high complex canopy, unrealist gener reference743 segment manually. overcom issue, itc manually744 delin account ground-truth. particular care was745 taken select itc size shapes, repres the746 speci diversity. propos classifi itc categories747 depend segment state, correctli detected, over-748 segmented, under-seg missed. segment qualiti was749 defin percentag itc correctli segmented.750 36 work lidar data optim way. now,751 lidar provid initi segment map, bpt being752 built raw transform hyperspectr data, reli on753 spectral properti scene. however, incorpor lidar during754 bpt construction, physic properti height diameter755 crown taken consideration. particular, us of756 lidar overcom case tree speci are757 aggreg like appear region only758 spectral properties. autom select pc contain discriminant759 inform autom tune threshold valu the760 bpt prune investig order propos method761 fulli unsupervised.762 acknowledgements763 present work joint collabor the764 gipsa-lab laboratori grenobl (france) depart global765 ecology, carnegi institut scienc stanford (usa). the766 gipsa-lab, work support project ximri, anr 2010767 intb 0208 01. carnegi airborn observatori possibl the768 gordon betti moor foundation; grantham foundat the769 protect environment; john d. catherin t. macarthur770 foundation; avatar allianc foundation; w. m. keck foundation; the771 margaret a. cargil foundation; mari ann nyburg baker g. leonard772 baker jr.; william r. hearst iii.773 774 37 appendix a. diffus distanc bpt merg cri-775 terion776 detail express diffus distanc as777 merg criterion construct bpt non-parametric778 statist region model. distanc propos ling & okada (2006)779 measur discrep histograms. underli idea is780 view differ histogram temperatur field. the781 distanc histogram base time need the782 temperatur distribut reach stabil heat diffus process, or783 equivalently, state temperatur field given time. opposed784 bin-to-bin distanc assum histogram align and785 compar bin histogram correspond bin other786 histogram, diffus distanc cross-bin distanc usabl even787 histogram aligned. specifically, histogram h1788 h2 p bin denot by789 ap p [1 : p ], (a.1) diffus distanc defin differ histogram:790 d0(ap) = h1(ap)h2(ap), (a.2) simul temperatur diffus process convolv current791 temperatur field gaussian kernel792 dm(ap) = [dm1(ap) g(ap)]2 m [1 : l] (a.3) g(x) stand gaussian kernel varianc , l number793 layer convolut process (the time diffus is794 38 stopped), 2 denot downsampl factor 2. distanc between795 histogram obtain sum l1 norm each796 layer:797 o (h1,h2) = l m=0 dm1 (a.4) with798 dm1 = p p=1 |dm(ap)| (a.5) diffus distanc successfulli adapt construct bpts799 valero et al. (2010a). ri rj neighbor region the800 bpt construction, hri = ( h1ri , . . . ,h m ri ) hrj = ( h1rj , . . . ,h m rj ) 801 respect region models, diffus distanc measur spec-802 tral band k similar pair histogram hkri h k rj ,803 o ( hkri ,h k rj ) . merg criterion region ri rj804 immedi follow ad contribut m spectral805 bands:806 o (ri,rj) = m k=1 o ( hkri ,h k rj ) (a.6) 807 references808 alonso-gonzalez, a., valero, s., chanussot, j., lopez-martinez, c., & salem-809 bier, p. (2013). process multidimension sar hyperspectr images810 binari partit tree. proceed ieee , 101 , 723747.811 andersen, h.-e. (2003). estim critic forest structur metric through812 spatial analysi airborn laser scanner data. ph.d. thesi university813 washington.814 39 asner, g. p., jones, m. o., martin, r. e., knapp, d. e., & hughes, r. f.815 (2008). remot sens nativ invas speci hawaiian forests.816 remot sens environ , 112 , 19121926.817 asner, g. p., knapp, d. e., boardman, j., green, r. o., kennedy-bowdoin,818 t., eastwood, m., martin, r. e., anderson, c., & field, c. b. (2012).819 carnegi airborn observatory-2: increas scienc data dimensionality820 high-fidel multi-sensor fusion. remot sens environ , 124 ,821 454465.822 asner, g. p., knapp, d. e., broadbent, e. n., oliveira, p. j., keller, m., &823 silva, j. n. (2005). select log brazilian amazon. science, 310 ,824 480482.825 asner, g. p., knapp, d. e., kennedy-bowdoin, t., jones, m. o., martin,826 r. e., boardman, j., & field, c. b. (2007). carnegi airborn observatory:827 in-flight fusion hyperspectr imag waveform light detect and828 rang three-dimension studi ecosystems. journal applied829 remot sens , 1 , 013536013536.830 asner, g. p., rudel, t. k., aide, t. m., defries, r., & emerson, r. (2009). a831 contemporari assess chang humid tropic forests. conservation832 biologi , 23 , 13861395.833 beucher, s., & lantuejoul, c. (1979). us watersh contour detec-834 tion. intern workshop imag processing: real-tim edg and835 motion detection/estimation, rennes, france..836 40 bunting, p., & lucas, r. (2006). delin tree crown australian837 mix speci forest hyperspectr compact airborn spectrographic838 imag (casi) data. remot sens environ , 101 , 230248.839 calderero, f., & marques, f. (2010). region merg techniqu infor-840 mation theori statist measures. imag processing, ieee transactions841 on, 19 , 15671586.842 cardoso, j. s., & corte-real, l. (2005). gener evalu image843 segmentation. imag processing, ieee transact on, 14 , 17731782.844 clark, m. l., roberts, d. a., & clark, d. b. (2005). hyperspectr discrimi-845 nation tropic rain forest tree speci leaf crown scales. remote846 sens environ , 96 , 375398.847 comaniciu, d., & meer, p. (2002). mean shift: robust approach toward848 featur space analysis. pattern analysi machin intelligence, ieee849 transact on, 24 , 603619.850 conese, c., maracchi, g., miglietta, f., maselli, f., & sacco, v. (1988). forest851 classif princip compon analys tm data. international852 journal remot sens , 9 , 15971612.853 culvenor, d. s. (2002). tida: algorithm delin tree crown in854 high spatial resolut remot sens imagery. comput & geoscienc ,855 28 , 3344.856 drumetz, l., veganzones, m. a., marrero, r., tochon, g., dalla mura, m.,857 plaza, a., chanussot, j. et al. (2014). binari partit tree-bas local858 41 spectral unmixing. hyperspectr imag signal processing: evolution859 remot sens (whispers), 7th intern ieee workshop on.860 erikson, m. (2004). speci classif individu segment tree861 crown high-resolut aerial imag radiometr morphologic862 imag measures. remot sens environ , 91 , 469477.863 erikson, m., & olofsson, k. (2005). comparison individu tree864 crown detect methods. machin vision applic , 16 , 258265.865 feret, j., & asner, g. (2013). tree speci discrimin tropic forests866 airborn imag spectroscopy. geoscienc remot sensing,867 ieee transact on, 51 , 7384.868 fung, t., & ledrew, e. (1987). applic princip compon analysis869 chang detection. photogrammetr engin remot sens , 53 ,870 16491658.871 garrido, l. (2002). hierarch region base process imag video872 sequences: applic filtering, segment inform retriev .873 ph.d. thesi universitat politnica catalunya-depart signal874 theori communications, barcelona, spain (april 2002).875 gougeon, f. a. (1995). crown-follow approach automat delin-876 eation individu tree crown high spatial resolut aerial images.877 canadian journal remot sens , 21 , 274284.878 horler, d., & ahern, f. (1986). forestri inform content thematic879 mapper data. intern journal remot sens , 7 , 405428.880 42 jung, j., pasolli, e., prasad, s., tilton, j., & crawford, m. (2014). a881 framework land cover classif discret return lidar data:882 adopt pseudo-waveform hierarch segmentation. select topics883 appli earth observ remot sensing, ieee journal , 7 ,884 491502.885 ke, y., & quackenbush, l. j. (2011). comparison method for886 automat tree crown detect delin high spatial resolution887 imagery. intern journal remot sens , 32 , 36253647.888 leckie, d. g., gougeon, f. a., tinis, s., nelson, t., burnett, c. n., &889 paradine, d. (2005). autom tree recognit old growth conifer890 stand high resolut digit imagery. remot sens environ ,891 94 , 311326.892 leckie, d. g., gougeon, f. a., walsworth, n., & paradine, d. (2003). stand893 delin composit estim semi-autom individual894 tree crown analysis. remot sens environ , 85 , 355369.895 ling, h., & okada, k. (2006). diffus distanc histogram comparison.896 vision pattern recognition, 2006 ieee society897 confer (pp. 246253). ieee volum 1.898 meyer, f., & beucher, s. (1990). morpholog segmentation. journal of899 visual commun imag representation, 1 , 2146.900 morton, a. (1986). moorland plant commun recognit landsat mss901 data. remot sens environ , 20 , 291298.902 43 noyel, g., angulo, j., & jeulin, d. (2007). morpholog segment of903 hyperspectr images. imag anal. stereol , 26 , 101109.904 olofsson, k. (2002). detect singl tree aerial imag template905 matching. forestsat symposium, heriot watt university, edinburgh.906 papes, m., tupayachi, r., martinez, p., peterson, a., asner, g., & powell, g.907 (2013). season variat spectral signatur genera rainforest908 trees. select topic appli earth observ remot sensing,909 ieee journal , 6 , 339350.910 perrin, g., descombes, x., & zerubia, j. (2005). point process forestri :911 applic tree crown detection. technic report 5544 inria.912 phinn, s., ticehurst, c., held, a., scarth, p., nightingale, j., & johansen,913 k. (2008). new tool monitor world heritag values. live a914 dynam tropic forest landscape, (pp. 591609).915 pollock, r. (1996). automat recognit individu tree aerial916 imag forest base synthet tree crown imag model . ph.d. thesis917 univers british columbia.918 pollock, r. (1998). individu tree recognit base synthet tree919 crown imag model. proc. intern forum automated920 interpret high spatial resolut digit imageri forestri (pp.921 2534). victoria, british columbia, canada.922 pouliot, d., king, d., bell, f., & pitt, d. (2002). autom tree crown923 detect delin high-resolut digit camera imageri of924 44 conifer forest regeneration. remot sens environ , 82 , 322925 334.926 pouteau, r., & stoll, b. (2012). svm select fusion (self) multi-source927 classif structur complex tropic rainforest. select topics928 appli earth observ remot sensing, ieee journal , 5 ,929 12031212.930 rasi, r., beuchle, r., bodart, c., vollmar, m., seliger, r., & achard,931 f. (2013). automat updat object-bas tropic forest cover932 classif chang assessment. select topic appli earth933 observ remot sensing, ieee journal , 6 , 6673.934 reiche, j., souza jr, c. m., hoekman, d. h., verbesselt, j., persaud, h.,935 & herold, m. (2013). featur level fusion multi-tempor alo palsar936 landsat data map monitor tropic deforestation937 forest degradation. select topic appli earth observ and938 remot sensing, ieee journal , 6 , 21592173.939 salembier, p., & garrido, l. (2000). binari partit tree efficient940 represent imag processing, segmentation, inform retrieval.941 imag processing, ieee transact on, 9 , 561576.942 shi, j., & malik, j. (2000). normal cut imag segmentation. pattern943 analysi machin intelligence, ieee transact on, 22 , 888905.944 somers, b., & asner, g. p. (2013). invas speci map hawaiian945 rainforest multi-tempor hyperion spaceborn imag spectroscopy.946 45 select topic appli earth observ remot sensing, ieee947 journal , 6 , 351359.948 tarabalka, y., chanussot, j., & benediktsson, j. a. (2010). segmentation949 classif hyperspectr imag watersh transformation.950 pattern recognition, 43 , 23672379.951 tarabalka, y., tilton, j. c., benediktsson, j. a., & chanussot, j. (2012). a952 marker-bas approach autom select singl segmentation953 hierarch set imag segmentations. select topic applied954 earth observ remot sensing, ieee journal , 5 , 262272.955 thenkabail, p. s., enclona, e. a., ashton, m. s., & van der meer, b. (2004).956 accuraci assess hyperspectr waveband perform vegetation957 analysi applications. remot sens environ , 91 , 354376.958 thomas, c. d., cameron, a., green, r. e., bakkenes, m., beaumont, l. j.,959 collingham, y. c., erasmus, b. f., siqueira, m. f., grainger, a.,960 hannah, l. et al. (2004). extinct risk climat change. nature, 427 ,961 145148.962 valero, s. (2011). hyperspectr imag process represent using963 binari partit trees. ph.d. thesi gipsa-lab, depart images964 signals, grenobl institut technology, grenoble, france.965 valero, s., salembier, p., & chanussot, j. (2010a). comparison merging966 order prune strategi binari partit tree hyperspectr data.967 imag process (icip), 2010 17th ieee intern confer on968 (pp. 25652568). ieee.969 46 valero, s., salembier, p., & chanussot, j. (2010b). new hyperspectr data970 represent binari partit tree. geoscienc remote971 sens symposium (igarss), 2010 ieee intern (pp. 8083).972 ieee.973 valero, s., salembier, p., & chanussot, j. (2011a). hyperspectr image974 segment binari partit trees. imag process (icip),975 2011 18th ieee intern confer (pp. 12731276). ieee.976 valero, s., salembier, p., & chanussot, j. (2013a). hyperspectr imag rep-977 resent process binari partit trees. ieee transactions978 imag process , 22 , 14301443.979 valero, s., salembier, p., & chanussot, j. (2013b). object recognit in980 urban hyperspectr imag binari partit tree representation. in981 igarss (pp. 40984101).982 valero, s., salembier, p., chanussot, j., & cuadras, c. m. (2011b). improved983 binari partit tree construct hyperspectr images: applic to984 object detection. geoscienc remot sens symposium (igarss),985 2011 ieee intern (pp. 25152518). ieee.986 varekamp, c., & hoekman, d. (2001). segment high-resolut insar987 data tropic forest fourier parameter deform models.988 intern journal remot sens , 22 , 23392350.989 veganzones, m., tochon, g., dalla-mura, m., plaza, a., & chanussot, j.990 (2014). hyperspectr imag segment new spectral unmixing-991 47 base binari partit tree representation. imag processing, ieee trans-992 action on, .993 von luxburg, u. (2007). tutori spectral clustering. statist and994 comput , 17 , 395416.995 wang, l., gong, p., & biging, g. s. (2004). individu tree-crown delineation996 treetop detect high-spatial-resolut aerial imagery. photogram-997 metric engin & remot sens , 70 , 351357.998 warner, t. a., lee, j. y., & mcgraw, j. b. (1998). delin iden-999 tific individu tree eastern decidu forest. proc.1000 intern forum: autom interpret high spatial resolution1001 digit imageri forestry, canadian forest service, pacif forestry1002 centr victoria, british columbia (p. 8191).1003 whiteside, t., & ahmadb, w. (2008). estim canopi cover eucalypt1004 domin tropic savanna extract tree crown very1005 high resolut imagery. geobia 2008geograph object base image1006 analysi 21st centuri , .1007 whitmore, t. c. et al. (1990). introduct tropic rain forests..1008 clarendon press.1009 wulder, m., niemann, k. o., & goodenough, d. g. (2000). local maximum1010 filter extract tree locat basal area high spatial1011 resolut imagery. remot sens environ , 73 , 103114.1012 zhou, j., proisy, c., descombes, x., hedhli, i., barbier, n., zerubia, j.,1013 gastellu-etchegorry, j.-p., & couteron, p. (2010). tree crown detect in1014 48 high resolut optic lidar imag tropic forest. remot sensing1015 (pp. 78240q78240q). intern societi optic photonics.1016 49 bpt construct bpt prune qualiti evalu initi segment segment score input imag hs imag lidar chm spectral reduct spatial reduct pre-process figur 4: flowchart propos method. blue, green yellow rectangl correspond input data, global oper describ section 3, output global operations, respectively. 50 figur 5: (a) sub-imag hawaii site (same band color stretch fig. 1 rgb representation). (b)-(f) correspond princip components. (a) (b) (c) (d) figur 6: (a) sub-imag hawaii site correspond initi segment (b) watersh algorithm appli lidar chm, (c) hyperspectr watershed, (d) mean shift clustering. 51 (a) (b) (c) (d) figur 7: evolut region (underlin red) branch bpt : (a) initi region/leaf, (b) region 21 mergings, (c) region 22 mergings, (d) plot correspond evolut region size branch. second dot correspond region 21 22 mergings, respectively. 52 s ratio overlap ratio overlap oversegmentation? light oversegment detect underseg miss overseg < 1.5 > 1.5 > 0.7 < 0.7 ye > 0.7 ye < 0.7 > 1.5< 1.5 figur 8: flowchart summar qualiti assess method 53 figur 9: manual delin itc (in red borders) segment result (in yellow borders) case: (a) correctli delineated, (b) missed, (c) under-segmented, (d) over-segmented. 54 (a) (b) (c) figur 10: visual result obtain mean shift clustering, pc select pc #1 size threshold 1200 hawaii (a,b) 150 panama (c). 200 400 600 800 1000 1200 1400 1600 1800 2000 0 10 20 30 40 50 60 70 80 90 100 threshold valu p e rc e n ta g e o f c s correctli segment overseg underseg miss (a) 200 400 600 800 1000 1200 1400 0 10 20 30 40 50 60 70 80 90 100 threshold valu p e rc e n ta g e o f c s correctli segment overseg underseg miss (b) figur 11: percentag itc correctli segmented, over-segmented, under- segment miss respect threshold value. result (a) hawaii site (b) panama site, pc select pc #1 mean shift clustering. 55 introduct materi propos segment strategi principl binari partit tree methodolog pre-process step spectral reduct spatial reduct construct binari partit tree prune binari partit tree recurs spectral graph partit prune strategi evolut region size prune strategi assess segment accuraci result discuss result discuss pca configur initi segment map prune strategi threshold valu propos prune strategi gener perform propos method conclus diffus distanc bpt merg criterion