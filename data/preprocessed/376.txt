nonam manuscript no. (will insert editor) pseudo-compress variat multiscal solver turbul incompress flow liang yang santiago badia ramon codina received: date / accepted: date abstract work, design explicit time-step solver simula- tion incompress turbul flow combin vm method artifici compressibility. evalu effect artifici compress accuraci explicit formul under-resolv le simulations. set benchmark solved, e.g., 3d taylor-green vortex problem turbul regimes. result method proven effect alterna- tive implicit method applic rang (in term problem size comput resources), provid compar result low mem- ori requirements. example, explicit approach, abl solv accur taylor-green vortex benchmark fine mesh 5123 cell 12 core 64 gb ram machine. keyword matrix-fre artifici compress method variat multiscal method (vms) explicit time step turbul incompress flow 1 introduct presenc turbulence, produc high reynold numbers, pose challeng numer simul navier-stok equations. captur scale turbul flow, known direct numer simul (dns) [28], larger scale larg eddi simula- tion (les), involv larg scale problem fine grid small time step liang yang school mathematics, scienc & engineering, citi univers london, northampton square, london ec1v 0hb, uk e-mail: santiago badia centr internacion metod numer en enginyeri (cimne), universitat politecnica catalunya (upc), 08860 castelldefels, spain e-mail: roman codina universitat politecnica catalunya (upc), campu nord, jordi girona 1-3, edifici c1, 08034 barcelona, spain 2 liang yang et al. [31]. take account small-scal flow featur time space, explicit method small time step appeal choice. sense, reason envisag increas matrix-fre scheme research struggl draconian memori requir forthcom super- computers. grid-bas method combin explicit time integr sup- plement artifici compress method. intens research area laminar flows, framework finit differ meth- od [9], finit volum method [26], characteristic-bas split method [29]. work, develop explicit finit element (fe) scheme turbu- lent flows. fe schemes, problem discretis navier-stok equat fe method fact tradit galerkin-bas fe scheme suitabl convect domin flow deal under-resolv simulations. second problem compat requir veloc pressur fe space stabil purposes, known lbb condition. variat multiscal method (vms) framework intro- duce overcom difficulti [22]. vm approach understood residual-bas stabilis fe method, so, singularli perturb natur navier-stok equat stabilis reynold number increases. hand, allow avoid complianc compat condi- tion (the so-cal discret inf-sup) veloc pressur spaces, so, abl us equal-ord interpolation. vm concept le turbul model navier-stok equations, suggest [10], exploit [23], analyt justifi [21]. develop vm framework consid subscal proport orthogon compon residu respect fe spaces, lead orthogon subscal vm techniqu [14]. improv consid transient evolut equat subscal component, lead dynam subscal [13]. situations, projection-bas vm method us variat project similar tradit filter equations, pro- vide numer orient turbul model feature. compar classic les-typ filters, vm method problem associ in- homogen non-commut filter wall-bound flows. further, vm method retain numer consist fe equations, smagorinsky- type model introduc error order h 4 3 . good numer result obtain approach, demonstr capabl compet tradit le turbul model approach (see e.g. [5,16]). numer solut vm discretis incompress flow tra- dition obtain pressur segreg scheme [1] monolith approach [5], requir solv linear system (possibly) nonlinear it- erations. larg scale problems, linear solv krylov iter solvers. order solv larg scale problem implicit methods, main requir us weakli scalabl precondit techniqu [3,4,30]. far, vm method restrict implicit time step tech- niques. however, explicit method (or matrix-fre lightweight implicit methods) favour situations, e.g., want tackl larger problem limit comput resources. result, paper investig possibl impos explicit time-step approach simul incompress turbul flow combin vm method titl suppress excess length 3 artifici compressibility. result scheme, artifici compress perturbation, provid accur under-resolv le simu- lation turbul flow limit memori consumption. propos scheme straightforwardli appli structur unstructur meshes. particular, (multi-)linear equal-ord veloc pressur interpol work. compar explicit methods, built-in sub-grid compo- nent act implicit le turbul model extra turbul model required. paper split follow sections. sect. 2, govern equa- tion navier-stok problem artifici compress formul presented. sect. 3 combin vm formul artifici compressibil- iti technique. sect. 4 present rang numer result order demonstr aspect describ previou sections, includ 2-d caviti flow, 2-d plane mix layer, 3-d caviti flow 3-d taylor green vortex. finally, conclud- ing remark sect. 5. 2 govern equat 2.1 incompress navier-stok equat let bound domain rd d = 2 3 spatial dimension, boundari = , let time interv [0, t ]. strong form incompress navier-stok problem consist find veloc field u pressur p tu 2u + u u +p = f (0, t ), u = 0 (0, t ), (1) f forc vector > 0 kinemat viscosity. (1) suppli appropri boundari initi conditions. boundari divid dirchilet boundari d neumann boundari n , satisfi d n = d n = . then, boundari initi condit read: u = u d (0, t ), (2a)( pi + (u+ (u)t ) ) n = t n (0, t ), (2b) u = u0 {0}, (2c) n unit outward vector normal surfac . simplifi exposition, consid pure dirichlet boundari d . 2.2 artifici compress method artifici compress formul replac diverg free constraint ad pseudo-tim deriv pressure. (1) modifi tu 2u + u u +p = f (0, t ) tp+ 1 u = 0 (0, t ) (3) 4 liang yang et al. (3), 1 artifici compress coeffici pseudo compress coefficient, artifici sound speed evalu c = 1. pressur wave speed c reach larg number, (3) approxim (1). relax incompress allow us explicit time step scheme. however, larg artifici pressur wave speed limit factor explicit time stepping. characterist veloc 1 = c2 = (ass||u||)2, ||u|| maximum norm veloc field, ass artifici sound speed coeffici usual take valu 1 10. steadi state problem, coeffici effect final solut residu converg 0. effect ass turbul flow investig transient numer example, 2d plane mix layer 3d taylor green vortex. numer experi indic valu ass 5 provid good satisfact incompress constraint. notic pressur behaviour (3) chang ellipt hyperbol (wave-propagation) charact artifici compress method, courant-friedrichs-lewi (cfl) condit necessari condit tempor stability. particular, problem consid time step size t t h c , factor depend time integr scheme safeti margin desired, h minimum mesh size. follows, assum time discretis uniform, time step size t. time step level denot superscript. 2.3 weak formul notat let introduc notation. l2() denot space function squar integr l 2 () . = { u : r | u 2 d < } . hilbert space scalar product (u, v) (u, v) . = u(x)v(x) d. (4) integr perform subdomain , denot (, ). h1() denot sobolev space squar integr function squar inte- gral deriv h 1 () . = { u : r | u,u l2() } . defin solut h1e() space test space h 1 0() h 1 e() . = { u h1()d | u = u } , h 1 0() . = { u h1()d | u = 0 } , titl suppress excess length 5 respectively. moreover, h1() denot topolog dual h10() , dualiti pair h1() h10(). then, standard weak form (3) following: time t, veloc u(, t) h1e() pressur p(, t) l2() (tu, v) + (u,v) (p, v) + u u, v = f , v v h10(), (tp, q) + 1 ( u, q) = 0 q l2(). (5) 2.4 galerkin fe method given fe partit domain , problem construct veloc solut space v eh h 1 e() lh l 2() set discret problem: time t, veloc uh(, t) v eh pressur p(, t)h lh (tuh, vh) + (uh,vh) (ph, vh) + uh uh, vh = f , vh (tph, qh) + 1 ( uh, qh) = 0, (6) vh v 0h qh lh, v 0 h construct v e h homoge- neou boundari conditions. comment above, known (6) suffer numer instabl high reynold number problems. also, veloc pressur solut space satisfi inf-sup condit order well-pos problem, bound pressur field. difficulti handl vm method. 3 explicit variat multiscal method general, vm method decompos solut u p larg scale compon subscal component. larg scale compon uh ph resolv fe mesh, whilst subscal compon u p approxi- mate certain analyt approach. let consid scale decomposit space h1e() l 2() h1e() = v h v l 2() = lh l, v l denot infinite-dimension space complet fe space v h lh approxim veloc pressur standard galerkin fe method. ()h () denot fe compon sub-grid component, re- spectively. thus, approxim veloc u pressur p u uh + u, p ph + p, uh v h , u v , ph lh, p l time t. split (5), yield (t (uh + u) , v) + ( (uh + u) ,v) (ph + p, v) + (uh + uh) (uh + uh) , v = f , v , (t (ph + p) , q) + 1 ( (uh + uh) , q) = 0. (7) 6 liang yang et al. 3.1 fe scale problem consid fe test function, i.e. v = vh v 0h q = qh lh. resolv large-scal compon (7) yield (t (uh + u) , vh) + ( (uh + u) ,vh) (ph + p, vh) + (uh + u) (uh + u) , vh = f , vh , (t (ph + p) , qh) + 1 ( (uh + u) , qh) = 0. let elabor term equations: import ingredi approach choos sub-grid space orthogon l2()-sens fe spaces. therefore, time deriv term (tu, vh) (tp, qh) vanish: (t (uh + u) , vh) = (tuh, vh) ; (t (ph + p) , qh) = (tph, qh) . satisfi orthogon practice. viscou term ( (uh + u) ,vh) simplifi ( (uh + u) ,vh) = (uh,vh) + k [ (u,vh)k + (u,n vh)k ] = (uh,vh) . term (u,vh)k vanish linear elements. term (u,n vh)k usual neglect practice, taken account strategi propos [12]. order avoid deriv sub-grid component, convect com- ponent re-written (uh + u) (uh + u) , vh = (uh + u) uh, vh u, (uh + u) vh , fact uh + u diverg free integr parts. avoid deriv sub-grid scales, mass conserv equa- tion re-written 1 ( (uh + u) , qh) = 1 ( uh, qh) 1 (u,qh) + 1 (n u, qh) , integr parts. before, sub-grid scale boundari term ne- glected. take account previou considerations, equat are: (tuh, vh) + uh, vh+ (uh,vh) (ph, vh) (p, vh) u,a vh = 0, (tph, qh) + 1 ( uh, qh) 1 (u,qh) = 0, . = uh + u. problem close approxim sub-grid scale veloc pressur proposed. titl suppress excess length 7 3.2 local sub-grid scale problem section, discuss sub-grid scale formul analyt- ical approxim solution. result, orthogon sub-grid scale explicit vm method given. sub-grid scale equat read (in strong form): tu + (uh + u) u u +p = ru, tp+ 1 u = rp, ru rp appropri residu fe compon defin ru = pu (tuh + (uh + u) uh uh +ph f) , rp = pp ( tph + 1 uh ) . pu pp project oper sub-grid scale space veloc pressure. case ident oper cases, recov origin vm method propos [22]. codina [11] propos enforc subscal orthogon fe veloc pressur spaces. lead pu . = u . = 1u, u l2-projector v h (use mass lumping), i.e., function f , comput nodal valu u(f) node fe mesh u(f) = fa , correspond nodal shape function. proce analog pp lh. next, consid follow algebra approxim nonlinear dif- ferenti system. refer [10] detail exposit sub-grid problem approximation, e.g., motiv base fourier transforms. time discretisation, e.g., implicit-explicit order time integration, ap- proxim dynam sub-grid model momentum equat read as: comput un+1 1 t u n+1 + 1 nu u n+1 = 1 t u n + r n u, n u = ( c1 h2 + c2|unh + u n| h )1 , analogously, u n+1 = nt t u n + n t r n u, 1 nt = 1 t + 1 u , (8) c1 c2 algorithm constants, set c1 = 4, c2 = 2 numer experiments. treat sub-grid scale term implicitli impli increas cpu cost. note previou express sub-grid scale requir integr points. pressur sub-grid scale compon treat similar way. again, follow motiv explain [10], compon from: 1 t p n+1 + 1 1 np p n+1 = 1 t p n +r n p , n p = h2 nu . term requir stabil converg bound [2]. fur- ther, exhaust numer analysi [16] advoc switch pressur sub-grid compon turbul flow simulations. work, follow approach. 8 liang yang et al. 3.3 time integr final algorithm motiv artifici compress method possibl us explicit time integr scheme flow equations. choic open, paper simpl second order time integr scheme fe solut order time integr veloc sub-grid scales, describ above. consist sub-grid scale multipli stabilis parameters, order time step size. note essenti behav critic time step forward euler time integr [15]. solver implement in- hous code fortran90 parallelis openmp. 2d matrix-vector implement illustr appendix. final algorithm depict below. titl suppress excess length 9 algorithm: pseudo-compress vm method incompress flow read u0h, p 0 h set u = 0, loop time step n loop elements, loop integr point 1. evalu veloc predict un+1h pressur predict p n+1 h time step n+ 1 second order approximation: u n+1 h = 3 2 u n h 1 2 u n1 h , p n+1 h = 3 2 p n h 1 2 p n1 h . 2. add nonlinear sub-grid scale compon convect veloc- iti a: = u n+1 h + u n . 3. calcul stabilis paramet nt (8). 4. evalu veloc sub-grid scales: u n+1 = t t u n u [t (a u n h +p n h)] 5. updat veloc pressur time step n + 1 solving: (u n+1 h , vh) = (u n h, vh)tr n u, (qh, p n+1 h ) = (qh, p n h)tr n p test function vh qh, r n u = ( un+1h , vh ) + ( un+1h ,vh ) ( p n+1 h , vh ) (un,a vh) f , vh rnp = 1 ( un+1h , qh ) 1 (un,qh) prescrib boundari condit u n+1 h = u 4 numer exampl section, consid 2d problem evalu explicit vm method. next, appli framework 3d turbul flow benchmarks. 4.1 two-dimension flow: lid-driven caviti problem consid document benchmark case lid-driven caviti flow test propos method implement 2d. scheme test problem configur shown fig. 1 (a) wall move right veloc ux = 1. vertic wall non-slip boundaries. 10 liang yang et al. 1. 0 1.0 non-slip boundari ux = 1; uy = 0ux = 1; uy = 0 (a) schemat diagram lid-driven flow problem 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 (b) comput domain: non-uniform structur mesh fig. 1 dimens lid driven flow 100100 non-uniform structur mesh = 100, = 1000, = 5000 = 10000, contain finer grid point near walls, emploi computation. target comput steadi state, studi effect ass case. artifici sound speed chosen c = 2||u||2. mesh grid point distanc x y direct set hyperbol tangent profile. example, y coordin term x coordin given by: y(x) = 0.5 + tanh(5(x 0.5)) 2 tanh(2.5) , 0 x 1, shown fig. 1 (b). plot vertic veloc profil horizont centrelin hor- izont veloc profil vertic centreline, differ reynold numbers, compar second order accur solut ghia et at. [19] fig. 2. good agreement refer result observed. present numer result = 100000 perform uniform grid 5122, 10242 20482 transient case. artifici sound speed chosen c = 3||u||2. fig. 3, notic coars grid diffus fine grid bilinear element meshsiz 10242 fine converg result lid-driven caviti flow = 100000. propos method captur transient featur caviti flow high reynold number. titl suppress excess length 11 (a) (b) (c) (d) fig. 2 2-d lid-driven flow. comparison veloc profil ghia et at. [19] mid- section reynold number: (a) = 100; (b) = 1000; (c) = 5000; (d) = 10000. 4.2 two-dimension flow: kelvin-helmholtz instabl kelvin-helmholtz instabl plane mix layer import case fluid dynamics. exampl lead usual perceiv turbulence, show featur flow common turbul certain sense, flow extrem sensit initi condit broadband energi spectrum slope k4 k3 develop [20]. problem set domain = [0, 1] [0, 1]. free slip boundari condit appli y = 0 y = 1. left right wall x = 0 x = 1, period boundari imposed, seen fig. 4. accord [6,20], initi veloc field set hyperbol tangent profil as: ux = ||u|| [ tanh ( 2y 1 0 ) + c y ] uy = ||u||c x ux uy veloc components, = ||u|| exp ( y0.5 0 )2 cos(x) white nois perturb express stream function formulation. ini- tial thick chosen 0 = 1/28 wave number = 8 reach 12 liang yang et al. (a) t = 2; grid: 5122 (b) t = 5; grid: 5122 (c) t = 15; grid: 5122 (d) t = 2; grid: 10242 (e) t = 5; grid: 10242 (f) t = 15; grid: 10242 (g) t = 2; grid: 20482 (h) t = 5; grid: 20482 (i) t = 15; grid: 20482 fig. 3 2-d lid-driven flow. evolut vortic field 50 < z < 50 reynold number = 100000 time t = 2, t = 5, t = 15 (from left right). artifici sound speed c = 3||u||2. unstabl wavelength [27]. ||u|| = 1 cnois = 103 taken. parameters, reynold number flow evalu = ||u||0 = 10000. bilinear quadrilater element emploi simul sequenc mesh 402, 802, 1602, 2402, 3202. mesh refin studi carri artifici sound speed c = 5||u||2. [20] report pressur stabilis petrov-galerkin (pspg) method fail converg finest grid 240 240 elements, whilst titl suppress excess length 13 free-slip boundari condit initi vortic thick free-slip boundari condit 1 .0 1.0 period boundari condit 0 fig. 4 schemat plane mix layer problem tabl 1 comput set 2d plane mix layer, run desktop machin element time step t ass cpu time (hrs) peak memori usag (mb) 402 3.2724 103 5||u|| 0.0066 0.5 802 1.6362 103 5||u|| 0.053 1.9 1602 4.9087 104 5||u|| 0.43 7.8 2402 1.6362 104 5||u|| 1.44 17.5 3202 9.66 104 5||u|| 3.45 31.1 3202 3.40 103 2.5||u|| 1.09 31.1 3202 2.77 104 10||u|| 13.4 31.1 3202 7.97 105 20||u|| 46.5 31.1 propos method solut stabl meshes. differ stage distinguished, seen fig. 5. kelvin-helmholtz vortic appear x-axis, merg vortic one. 1. develop primari eddies. primari eddi seen time unit 16. develop start similarli group 802, 1602, 2402, 3202. coarsest mesh 402, stage observed. 2. pair primari eddies. seen that, mesh refinement, pair start later. time unit 43, differ develop pair observed. 3. pair secondari eddies. second pair finish 80 time units, close result [25] (75 time units), earlier comparison [20] (115 time units) [24] (140 time units) 4. rotat final eddy. end second pairing, final eddi rotat fix position. valu vortic thick oscil stage ellipt shape vortex. integr kinet energi given ek = 1 || u u 2 d comparison purposes. tempor evolut kinet energi dissip rate defin = dek dt . 14 liang yang et al. (a) 10 (b) 20 (c) 40 (d) 50 (e) 60 (f) 70 (g) 80 (h) 90 (i) 180 fig. 5 2d plane mix layer. colour vortic 0 < < 50 veloc field finest mesh grid time unit: 10, 20, 40, 50, 60, 70, 80, 90, 180 mesh 3202. artifici sound speed c = 5||u||2. vortic thick evalu quantitatively. scalar vortic defin (x, y, t) = 1 2 ( uy x ux y ) . then, defin maximum vortic max max(t) = sup y[0,1] 1 0 (x, y, t) dx, titl suppress excess length 15 1 0 (x, y, t) dx denot integr mean period x direction. vortic thick (t) defin (t) = 2umax max(t) . 4.2.1 mesh refin fig. 6 show time histori kinet energy, kinet energi dissip rate vortic thick mesh refinement. eddi pair caus increas vortic thickness, energi dissipation. coarsest mesh size 40 40, simul captur eddi period captur final larg eddy. mesh 80 80 element suffici clearli observ develop stages. pair happen rel slower refin mesh. 4.2.2 effect artifici sound speed effect differ artifici sound speed meshsiz 320320 shown fig. 7. seen ass = 5 captur kei featur problem. lower ass number, higher kinet energi dissip rate oscil observed. 4.3 three-dimension laminar flow: lid-driven caviti 3d lid-driven caviti flow illustr fig. 8 studi examin perform propos method implementation. domain physic space = [0, 1] [0, 1] [0, 1]. wall move veloc ux = 1, uy = 0, uz = 0. vertic wall non-slip bound- aries. 1003 uniform structur mesh = 100 = 1000 emploi comput laminar flow. fig. 9 show isosurfac magnitud veloc |u| = 0.15 flow reach steadi state. artifici sound speed chosen c = 2||u||2, 2d. quantit veloc profil compar refer yang [32]. 4.3.1 one-dimension profil veloc profil mid-plan y = 0.5 centrelin illustr fig. 10 quantit comparisons. good agreement reach result obtain yang [32]. 4.3.2 two-dimension profil veloc magnitud mid-plan y = 0.5 correspond pressur field shown fig. 11. pressur field stabl equal veloc pressur interpolation, qualit agre result [18]. order flow pattern cubic caviti flow, streamlin plane x = 0.5, y = 0.5 z = 0.5 present fig. 12. effect 16 liang yang et al. 0 50 100 150 200 0.9 0.92 0.94 0.96 0.98 1 40 2 80 2 160 2 240 2 320 2 (a) evolut total kinet energi 0 50 100 150 200 -1 0 1 2 3 4 10 -3 40 2 80 2 160 2 240 2 320 2 (b) evolut kinet energi dissip rate 0 50 100 150 200 2 4 6 8 10 12 40 2 80 2 160 2 240 2 320 2 (c) evolut vortic thick fig. 6 2d plane mix layer. time histori kinet energy, kinet energi dissip rate vortic thick set q1q1 element 402, 802, 1602, 2402, 3202, artifici sound speed c = 5||u||2. titl suppress excess length 17 0 50 100 150 200 0.96 0.97 0.98 0.99 1 c = 2.5||umax|| c = 5||umax|| c = 10||umax|| c = 20||umax|| (a) evolut total kinet energi 0 50 100 150 200 -1 -0.5 0 0.5 1 1.5 2 10 -3 c = 2.5||umax|| c = 5||umax|| c = 10||umax|| c = 20||umax|| (b) evolut kinet energi dissip rate 0 50 100 150 200 0 2 4 6 8 10 12 c = 2.5||umax|| c = 5||umax|| c = 10||umax|| c = 20||umax|| (c) evolut vortic thick fig. 7 2d plane mix layer. effect differ artifici speed c = 2.5||u||2, c = 5||u||2, c = 10||u||2 c = 20||u||2 meshsiz 3202. 18 liang yang et al. 1.0 y x ux = 1, uy = 0, uz = 0ux = 1, uy = 0, uz = 0 1. 0 1.0 z fig. 8 schemat 3d lid-driven caviti flow (a) = 100 (b) = 1000 fig. 9 3d lid-driven cavity. isosurfac magnitud veloc |u| = 0.15, 1003 trilinear q1q1 element reynold number = 100 = 1000. (a) = 100 (b) = 1000 fig. 10 3d lid-driven cavity. comparison veloc profil mid-plan y = 0.5 refer data [32] reynold number 100 1000. artifici sound speed c = 2||u||2. titl suppress excess length 19 (a) veloc magnitude, = 100 (b) veloc magnitude, = 1000 (c) pressur field, = 100 (d) pressur field, = 1000 fig. 11 3d lid-driven cavity. isolin veloc magnitud pressur field mid-plan y = 0.5 cubic caviti = 100 = 1000. artifici sound speed c = 2||u||2. reynold number flow pattern observed. reynold number increases, strength secondari vortic enhanced. similar flow patten report [18]. 20 liang yang et al. (a) = 100 mid-plan x = 0.5 (b) = 1000 mid-plan x = 0.5 (c) = 100 mid-plan y = 0.5 (d) = 1000 mid-plan y = 0.5 (e) = 100 mid-plan z = 0.5 (f) = 1000 mid-plan z = 0.5 fig. 12 3d lid-driven cavity. streamlin mid-plan x = 0.5, y = 0.5 z = 0.5 cubic caviti reynold number 100 1000. artifici sound speed c = 2||u||2. titl suppress excess length 21 4.4 three-dimension turbul flow: taylor-green vortex taylor-green vortex problem wide numer simul turbul flow. flow transit turbul repres basic turbul decai mode similar decai homogen turbul [8,7]. domain physic space = [0, 2] [0, 2] [0, 2] period boundari condit directions. domain, initi veloc pressur defin ux = u0 cos(x) sin(y) sin(z) uy = u0 sin(x) cos(y) sin(z) uz = 0 p = p0 + 1 16 (sin(cos(2x) + cos(2y))(cos(2z) + 2) u0 = 1. initi veloc field fourier space mode locat wave number k = (1,1,1). reynold number flow defin = u0l equal 1600. primari method evalu tgv solut examin energi dissip rate. integr kinet energi given ek = 1 || u u 2 d. tempor evolut kinet energi dissip rate defin 1 = dek dt . second kinet energi dissip rate defin integr en- strophi problem: 2 = 2 || 2 d, vortic veloc field. trilinear element emploi simul sequenc mesh 100 2i 128 2i = 1, 2, 3. simul run singl processor desktop, includ case 5123. detail case set given tabl 2. report peak memori consumpt run. fig. 13 present vortic iso-surfac images. initi condit fig. 13(a) vortic scale correspond fourier modes. vortic iso-surfac similar result obtain implicit vm [16]. 4.4.1 effect artifici sound speed effect artifici sound speed (ass) test mesh size 1003. ass chosen 3, 5, 10, 20 time maximum veloc ||u||. fig. 14 show effect ass resolv energy, total kinet energi evolut dissip rate. observ resolv dissip similar cases. however, energi oscil seen time t = 0 t = 3 artifici compress scheme. ass number increases, 22 liang yang et al. (a) isosurfac || = 1 t = 0.0 (b) isosurfac || = 1 t = 2.0 (c) isosurfac || = 4 t = 4.0 (d) isosurfac || = 7 t = 6.0 (e) isosurfac || = 8 t = 9.0 (f) isosurfac || = 9 t = 11.0 fig. 13 taylor-green vortex. vortic isosurfac veloc color differ time step, mesh 5123 trilinear elements, artifici sound speed c = 5||u||2. titl suppress excess length 23 tabl 2 comput set 3d taylor green vortex, run 12 core machines, speed openmp element time step t ass cpu time (hrs) peak memori usag (gb) 1283 1.63 103 3||u|| 1 0.68 1283 4.90 104 5||u|| 3 0.68 1283 1.64 104 10||u|| 11 0.68 1283 3.08 105 20||u|| 55 0.68 2563 2.46 104 5||u|| 16 5.44 5123 1.23 104 5||u|| 253 43.51 oscil decreases, relax incompress strict. expected, larg ass number bring time step restrict caus comput time. tabl 2 illustr comput time requir differ ass values. taylor-green vortex problem, studi transit period laminar turbul flow turbul decay. energi oscil caus artifici compress scheme small turbul transition. result, ass equal 5||u|| chosen mesh refin simulations. 4.4.2 mesh refin fig. 15 show total kinet energi total energi dissip rate. di- rectli comput energi dissip rate predic compar dn result [17,7]. indic turbul structur under-resolv sub-grid scale plai signific role energi dissipation. pro- pose explicit variat multiscal method abl approxim un-resolv scale simul turbul flow. 4.4.3 energi spectra progress energi spectra time 5123 shown fig. 16(a). t = 2 energi confin small wave numbers. time progresses, energi begin cascad smaller scales. energi smallest scale peak t = 10. correspond maximum energi dissip rate. spectra t = 10 set mesh shown fig. 16(b). finer grid abl captur smaller energi scales. 5 conclus work, propos pseudo-compress vm solver turbul incompress flows. result, vms-type le model combin explicit time step techniques. analyz result scheme set benchmark tests. results, conclud obtain accur under-resolv le simul turbul flow propos explicit vm scheme limit memori consumption. par- ticular, transient numer examples, 2d kelvin-helmholtz instabl 3d taylor-green vortex, good converg respect artifici compress sound speed mesh size. 24 liang yang et al. 0 2 4 6 8 10 time 0.05 0.06 0.07 0.08 0.09 0.1 0.11 0.12 e n e rg y global energy, mesh size 1283 c = 3||umax|| c = 5||umax|| c = 10||umax|| c = 20||umax|| (a) total kinet energi 0 1 2 3 4 5 time 0.117 0.118 0.119 0.12 0.121 0.122 0.123 0.124 e n e rg y global energy, mesh size 1283 c = 3||umax|| c = 5||umax|| c = 10||umax|| c = 20||umax|| (b) close view 0 2 4 6 8 10 time -5 0 5 10 15 t o ta l d si p ti o n 10 -3 total dissipation, mesh size 1283 c = 3||umax|| c = 5||umax|| c = 10||umax|| c = 20||umax|| (c) total kinet dissip rate 0 1 2 3 4 5 time -4 -2 0 2 4 6 8 t o ta l d si p ti o n 10 -3 total dissipation, mesh size 1283 c = 3||umax|| c = 5||umax|| c = 10||umax|| c = 20||umax|| (d) close view 0 2 4 6 8 10 time 0 1 2 3 4 5 r e lv e d d si p ti o n 10 -3 resolv dissipation, mesh size 1283 c = 3||umax|| c = 5||umax|| c = 10||umax|| c = 20||umax|| (e) resolv dissip rate 0 0.5 1 1.5 2 2.5 3 3.5 4 time 0.4 0.6 0.8 1 1.2 1.4 1.6 r e lv e d d si p ti o n 10 -3 resolv dissipation, mesh size 1283 c = 3||umax|| c = 5||umax|| c = 10||umax|| c = 20||umax|| (f) close view fig. 14 taylor-green vortex. studi effect differ artifici sound speed resolv energy, total kinet energi evolut dissip rate grid 1283. acknowledg s. badia work partial fund european research council fp7 program idea start grant no. 258443 - comfus: comput method fusion technolog fp7 numexa project grant agreement 611636. s. badia r. codina gratefulli acknowledg support receiv catalan govern icrea academia research program. titl suppress excess length 25 0 2 4 6 8 10 12 time 0.05 0.06 0.07 0.08 0.09 0.1 0.11 0.12 0.13 e n er g y ref 1 (j debonis.) 1283 2563 5123 (a) total kinet energi 0 2 4 6 8 10 12 time 0 0.002 0.004 0.006 0.008 0.01 0.012 0.014 t o ta l d si p ti o n ref 1 (j debonis.) ref 2 (brachet et al.) 1283 2563 5123 (b) total kinet dissip rate fig. 15 taylor-green vortex. evolut total kinet energi kinet dissi- pation rate mesh refinement, artifici sound speed c = 5||u||2. 10 0 10 1 10 2 10 -5 10 -4 10 -3 10 -2 10 -1 10 0 128 3 256 3 512 3 (a) energi spectrum differ mesh size t = 10 10 0 10 1 10 2 10 -4 10 -3 10 -2 10 -1 10 0 t = 2 t = 4 t = 6 t = 8 t = 10 t = 12 k5/3 (b) evolut energi spectra differ time 5123 grid fig. 16 taylor-green vortex. energi spectrum taylor-green vortex problem, artifici sound speed c = 5||u||2. 6 appendix illustr matrix-vector implement 2d linear fe sim- plicity. nodal shape function associ node denot na(x) valu gauss point b repres nab . node repres lexicograph index (ia, ja), ia, ja = 0, 1. further, given -th axi direc- tion, = 1, 2, defin function tw(a, ) = tw(ia, ja, ) (1 ia, ja) = 1 (ia, 1 ja) = 2. us nodal quadratur numer integration, lead lump mass matrix. result, express 26 liang yang et al. nodal shape function deriv nodes, get: n (xb) = ab, n (xb) = ab n (xb) = n tw(a,) (xb), n (xtw(a,)) = n (xa), xb denot coordin node b kroneck delta. expressions, implement effici term matrix- free formul follow expressions. viscou term implement follows: k u (x)n (x)d = 4 b=1 u (xb)n b |j |wb = (u (xa) + u (xtw(a,)))n |j |wa. nonlinear convect term implement as: k au (x)an (x)d = 4 b=1 (au )(xb)a(xb)n b |j |wb = ((au a)(xa) + (au a)(xtw(a,)))n |j |wa. proce analog rest terms. refer 1. s. badia r. codina. algebra pressur segreg method incompress navier-stok equations. archiv comput method engineering, 15(3):343 369, 2008. 2. santiago badia ramon codina. multiscal approach transient stoke problem: dynam subscal anisotrop spacetim discretization. appli mathemat- ic computation, 207(2):415433, januari 2009. 3. santiago badia, alberto f. martn, javier principe. highli scalabl parallel imple- mentat balanc domain decomposit constraints. siam journal scientif computing, 36(2):c190c218, januari 2014. 4. santiago badia, alberto f. martn, javier principe. balanc domain decomposit extrem scales. siam journal scientif computing, press, 2015. 5. y. bazilevs, v.m. calo, j.a. cottrell, t.j.r. hughes, a. reali, g. scovazzi. varia- tional multiscal residual-bas turbul model larg eddi simul incom- pressibl flows. method appli mechan engineering, 197(1-4):173 201, 2007. 6. b.j. boersma, m.n. kooper, t.t.m. nieuwstadt, p. wesseling. local grid refin large-eddi simulations. journal engin mathematics, 32(2/3):161175, 1997. 7. m.e. brachet. direct simul three-dimension turbul taylor-green vortex. fluid dynam research, 8(1):18, 1991. 8. m.e. brachet, d. meiron, s. orszag, b.g. nickel, r.h. morf, u. frisch. small-scal structur taylor-green vortex. journal fluid mechanics, 130:411452, 1983. 9. a.j. chorin. numer method solv incompress viscou flow problems. journal comput physics, 2(1):1226, 1967. 10. r. codina. stabil finit element approxim transient incompress flow us- ing orthogon subscales. method appli mechan engineering, 191:42954321, 2002. 11. r. codina j. blasco. analysi stabil finit element approxim transient convection-diffusion-react equat orthogon subscales. comput visual science, 4:167174, 2002. titl suppress excess length 27 12. r. codina, j. principe, j. baiges. subscal element boundari vari- ation two-scal finit element method. method appli mechan engineering, 198:838852, 2009. 13. r. codina, j. principe, o. guasch, s. badia. time depend subscal sta- biliz finit element approxim incompress flow problems. method appli mechan engineering, 196:24132430, 2007. 14. r. codina o. soto. approxim incompress navier-stok equat orthogon subscal stabil pressur segreg anisotrop finit ele- ment meshes. method appli mechan engineering, 193:14031419, 2004. 15. r. codina o.c. zienkiewicz. cb versu gl stabil incompress navier-stok equat role time step stabil parameter. com- munic numer method engineering, 18:99112, 2002. 16. o. colomes, s. badia, r. codina, j. principe. assess variat multiscal model larg eddi simul turbul incompress flows. method appli mechan engineering, 285:3263, 2015. 17. jame debonis. solut taylor-green vortex problem high-resolut explicit finit differ methods. aiaa paper, 382:2013, 2013. 18. h ding, c shu, ks yeo, d xu. numer comput three-dimension in- compress viscou flow primit variabl form local multiquadr differ- ential quadratur method. method appli mechan engineering, 195(7):516533, 2006. 19. u. ghia, k.n. ghia, c.t. shin. high-r solut incompress flow navier-stok equat multigrid method. journal comput physics, 48(3):387411, 1982. 20. v. gravemeier. variat mulstiscal method laminar turbul flow. archiv comput mechanicsst art reviews, 13:249324, 2006. 21. o. guasch r. codina. statist behavior orthogon subgrid scale stabil term finit element larg eddi simul turbul flows. method appli mechan engineering, 261-262:154166, 2013. 22. t.j.r. hughes, g.r. feijoo, l. mazzei, j.b. quincy. variat multiscal methoda paradigm comput mechanics. method appli me- chanic engineering, 166:324, 1998. 23. t.j.r. hughes, l. mazzei, k.e. jansen. larg eddi simul vari- ation multiscal method. comput visual science, 3:4759, 2000. 10.1007/s007910050051. 24. v. john. assess model subgrid scale tensor ration le model. journal comput appli mathematics, 173(1):5780, 2005. 25. marcel lesieur, chantal staquet, pascal le roy, pierr comte. mix layer coher examin point view two-dimension turbulence. journal fluid mechanics, 192:511534, 1988. 26. a.g. malan, r.w. lewis, p. nithiarasu. improv unsteady, unstructured, artifici compressibility, finit volum scheme viscou incompress flows: ii. application. intern journal numer method engineering, 54(5):715729, 2002. 27. a. michalke. inviscid instabl hyperbol tangent veloc profile. journal fluid mechanics, 19:543556, 1964. 28. p. moin k. mahesh. direct numer simulation: tool turbul research. annual review fluid mechanics, 30(1):539578, 1998. 29. p. nithiarasu. effici artifici compress (ac) scheme base charac- terist base split (cbs) method incompress flows. intern journal numer method engineering, 56(13):18151845, 2003. 30. johann rudi, cristiano malossi, tobin isaac, georg stadler, michael gurnis, pe- ter wj staar, yve ineichen, costa bekas, alessandro curioni, omar ghattas. extreme-scal implicit solver complex pdes: highli heterogen flow earth man- tle. proceed intern confer high perform computing, networking, storag analysis, page 5. acm, 2015. 31. d.c. wilcox. turbul model cfd. turbul model cfd. dcw in- dustries, incorporated, 2006. 32. jaw-yen yang, shih-chang yang, yih-nan chen, chiang-an hsu. implicit weight eno scheme three-dimension incompress navierstok equations. journal comput physics, 146(1):464487, 1998. introduct govern equat explicit variat multiscal method numer exampl conclus appendix