upcommon portal del coneix obert la upc aquesta s una cpia la versi author final draft d'un articl publicat la revista intern journal numer method engin url d'aquest document upcommon e-prints: articl publicat / publish paper: franci, a., oate, e. carbonell, j. m. (2015), effect bulk tangent matrix partit solut scheme nearli incompress fluids. int. j. numer. meth. engng, 102: 257277. doi: 10.1002/nme.4839. intern journal numer method engin int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl [version: 2002/09/18 v2.02] effect bulk tangent matrix partit solut scheme nearli incompress fluid alessandro franci1, eugenio onate1,2, josep maria carbonell1,2 1 centr internacion metod numer en enginyeria (cimne) campu nort upc, 08034 barcelona, spain email: 2 universitat politecnica catalunya (upc), email: summari purpos paper studi effect bulk modulu iter matrix analysi quasi-incompress free surfac fluid flow mix lagrangian finit element formul partit solut scheme. practic rule set valu pseudo-bulk modulu priori tangent bulk stiff matrix improv condit linear algebra equat given. effici propos strategi test problem analyz advantag modifi bulk tangent matrix regard stabil pressur field, converg rate comput speed analyses. techniqu test fic/pfem lagrangian formul present [18] easili extend quasi-incompress stabil finit element formulations. copyright c 2010 john wilei & sons, ltd. kei words: quasi-incompress fluid, bulk modulus, mass conservation, ill-conditioning, finit calculus, finit element method, particl finit element method, partit scheme. 1. introduct approach develop year approxim fluid flow mean quasi-incompress material. practice, consid navier-stok problem modifi mass conserv equat slight compress ad fluid. previou works, exampl [21, 30], fluid compress introduc relax incompress contraint mean penalti paramet follow manner: v = 1 p (1) correspond to: cimne, edificio c1, campu norte, upc, gran capitan s/n, 08034 barcelona, spain contract/gr sponsor: publish art research council; contract/gr number: 981846389 receiv 17 januari 2007 copyright c 2010 john wilei & sons, ltd. revis 2 a. franci, e. onat j.m. carbonel v volumetr strain rate p pressur (assum posit tension). classic mass conserv equat fulli incompress fluid recov eq.(1) consid . alternatively, small compress fluid introduc consid actual bulk modulu fluid , give oper physic meaning, [7, 12, 30]. mass conserv equat written as: v = 1 p t (2) = c2, densiti c speed sound fluid. work, approach followed. success quasi-incompress formul fluid mechan reli import advantag numer point view. obviou eq.(1) eq.(2) direct relat unknown field navier-stok problem, veloc pressure. extrem us problem solv partit scheme velocity-pressur relat crucial deriv tangent matrix momentum equations. furthermore, import drawback fulli incompress scheme eluded. fact, incompress constraint lead diagon block zero matrix global matrix system. consequently, pivot procedur requir solv numer kind linear system. known comput cost associ oper high increas number degre freedom problem. compress term eman eqs.(1) (2) diagon global matrix overcom numer difficulties. hand, quasi-incompress scheme insert numer model paramet typic high valu lead differ numer instabilities. example, larg valu penalti paramet or, equally, physic valu bulk modulus, compromis qualiti analys prevent converg solut scheme, [30]. reason, generally, valu actual bulk modulu reduc arbitrarili so-cal pseudo bulk modulus. nevertheless, excess small valu pseudo bulk modulu chang drastic mean continu equat origin navier- stoke problem; words, incompress constraint satisfi all. furthermore, bulk modulu proport speed sound propag material. hence, guarante order magnitud veloc problem time smaller veloc sound medium. paper, present new numer solut scheme nearli incompress fluid excel converg mass preserv features. method base pseudo-bulk modulu p tangent matrix iter solut discret momentum equat written lagrangian form (use instanc finit element method (fem) [30]), actual physic valu bulk modulu numer solut mass conserv equation. pseudo-bulk modulu p defin priori proport actual bulk modulu fluid (i.e. p = 0 < < 1). simpl procedur comput scale factor presented. method propos work improv term mass conserv overal effici numer solut scheme versu similar method us arbitrarili defin pseudo-bulk modulu continu mass conserv copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut scheme 3 equat [2326]. method present relat so-cal augment lagrangian (al) procedur solv navier-stok equat incompress [2, 3, 8, 9, 28] weakli compress [4, 27] flows. kei problem al procedur definit al paramet modifi origin set momentum equat defin adequ precondit matrix. method propos pseudo-bulk modulu plai role al paramet momentum equations. hand, compress form mass conserv matrix adequ stabil procedur base finit calculu (fic) techniqu [15, 16, 20, 22]. fic stabil method ensur correct solut quasi fulli incompress situat equal order interpol veloc pressure, case work linear interpol variables. procedur comput pseudo-bulk modulu work appli estim al paramet nearli incompress fluids. method test analysi quasi-incompress fluid stabil lagrangian fic-fem formul present [18]. mention work, particular class lagrangian fem term particl finit element method (pfem, www.cimne.com/pfem) [6, 13, 14, 19] used. pfem treat mesh node particl freeli separ main fluid domain representing, instance, effect water drops. mesh connect node discret domain govern equat solv stabil fem. linear interpol adopt pressur veloc fields. choic fullfil so-cal lbb inf sup condit [5, 7, 29]. mention above, requir stabil provid finit calculu (fic) method [15, 16, 20, 22]. lay-out paper following. section govern equat quasi-incompress lagrangian fluid given. fulli discret form deriv finit element space newmark scheme time. fic-stabil form [18] problem introduc numer model. that, increment solut discret equat derived. formul described, effect bulk modulu solut scheme studied. particular, effect linear solver convergence, qualiti solut pressur field, rate converg scheme mass conserv fluid analyzed. effici method predict optimum valu pseudo bulk modulu proposed. particular fulli incomprens fluid briefli described. paper numer result water flow obtain method propos shown. good properti numer scheme term gener accuraci comput effici discussed. 2. lagrangian formul quasi-incompress fluid 2.1. govern equat fulli discret form govern equat problem linear momentum balanc equat mass conserv equat quasi-incompress fluid. lagrangian description, equat read: copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 4 a. franci, e. onat j.m. carbonel linear momentum balanc equat dvi dt ij xj bi = 0 , i, j = 1, ns t (0, t ) (3) vi bi veloc bodi forc compon ith cartesian axis, densiti fluid, ns number space dimens (i.e. ns = 3 3d problems) ij compon cauchi stress tensor. mass conserv equat v 1 p t = 0 , t (0, t ) (4) v volumetr strain rate bulk modulu fluid. boundari condit vi v p = 0 v (5a) ijnj t p = 0 t (5b) v p t p , = 1, ns prescrib veloc prescrib traction dirichlet (v) neumann (t) boundaries, respectively. govern equat discret space linear shape function veloc pressur field accord standard galerkin finit element method (fem) [29]. time discret perform classic trapezoid rule [1]. fulli discret form problem reads:( 2 t mv + k ) vn+1 + qpn+1 = fn (6a) 1 t mp (pn+1 pn)qt vn+1 = 0 (6b) where: fn = fv + mv ( 2 t vn + vn ) (6c) previou equations, subindic refer time step variabl comput upper bar denot nodal valu unknowns. example, pn nodal pressur time tn = nt. matric introduc (6) assembl element contribut given box 1. copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut scheme 5 mvij = e nti njd , kij = e bti dbjd , qij = e bti mnjd mpij = e 1 ninjd , fvi = e nti bd + t nti td bi = ni x 0 0 0 ni y 0 0 0 ni z ni y ni x 0 ni z 0 ni x 0 ni z ni y ni = ni 0 00 ni 0 0 0 ni ni linear shape function d = 4/3 2/3 2/3 0 0 0 4/3 2/3 0 0 0 4/3 0 0 0 2 0 0 sym. 2 0 2 , m = [1, 1, 1, 0, 0, 0] t dynam viscos fluid box 1. element form matric vector eqs.(6) 2.2. stabil procedur fic interpol order veloc pressur field fullfil so-cal lbb inf sup condit [5]. consequ numer scheme need stabilized. requir stabil introduc finit calculu (fic) techniqu present [18]. mention work, fic-bas stabil finit element formul quasi-incompress lagrangian fluid present successfulli appli analysi free surfac flow problems. formul show excel mass preserv properties. detail formul lie outsid object work [18]. basically, linear momentum equat chang stabil mass conserv equat copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 6 a. franci, e. onat j.m. carbonel reads: q dp dt d + c2 d2p dt2 d qvd + q xi ( xi (2ij) + p xi + bi ) d t q [ dvn dt 2 hn (2n + p tn ) ] d = 0 (7) index ()n denot normal project variabl stabil paramet given by: = ( 8 h2 + 2 )1 (8) h characterist distanc space time, respectively. practice, h order magnitud element size time step increment, respect [18]. discret form stabil mass conserv equat reads:( 1 t mp + 1 t2 mpp + l + mb ) pn+1 qt vn+1 = gn (9) where: gn = fp + 1 t mppn + 1 t mpp ( pn t + pn ) (10) matric vector introduc stabil term assembl element contribut given box 2. mppij = e ninjd , lij = e ( 5tni ) 5njd , mbij = t 2 hn ninjd fpi = t qni [ dvn dt 2 hn (2n tn ) ] d e 5tnibd box 2. element form stabil matric vector eqs.(9) (10). 2.3. linear linear momentum equat increment solut quasi-incompress form mass conserv equat (2) us linear linear momentum equat yield direct relat pressur increment velocities. way, easi split unknown solv global mean partit increment scheme. iter matrix solv momentum residu vector refer nodal veloc only, nodal pressur appear momentum residu vector right hand side. linear form momentum equat time step (i + 1 ) -th iter reads: hivv i+1 = rim (11) copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut scheme 7 momentum residu vector rm iter matrix hv given rim = mv v + kvi + qpi fiv (12a) hv = mt + k + kv (12b) mt mass contribut iter matrix comput as: mtij = e nti t njd (13) kv so-cal bulk (or volumetric) matrix comput follow way: kv = e btmtpm tbd , p = (14) p pseudo-bulk modulu posit number 0 < 1 . shown section paramet key-rol prevent ill- condit iter matrix hv. notic matrix approxim exact tangent matrix updat lagrangian scheme [17]. concern notation, upper indic denot iter converg loop subindic denot time step variabl computed. consid time interv [n, n+ 1] iter follow step carri out: step 1. comput nodal veloc increment v hvv = rim v (15) step 2. updat nodal veloc vi+1n+1 = v n+1 + v (16) step 3. comput nodal pressur pi+1 hipp i+1 n+1 = 1 t mppn + 1 t2 mpp(2pn pn1) + gt vi+1n+1 + f p p i+1 n+1 (17) hp = 1 t mp + 1 t2 mpp + l + mb (18) step 4. updat nodal posit xi+1n+1 = x n+1 + 1 2 (vi+1n+1 + vn)t (19) step 5. check converg verify: ri+1v = v vn ev (20a) ri+1p = pi+1n+1 p n+1 pn ep (20b) ev ep prescrib error norm nodal veloc nodal pressures, respectively. exampl solv work, ev = ep = 10 4 fixed. condit (20) satisfied, time step considered. detail solut scheme pfem [18]. copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 8 a. franci, e. onat j.m. carbonel figur 1: 2d water sloshing. initi geometri finit element mesh. number element 705 number node 428 averag mesh size 0.4 m h1 7 m h2 3 m d 10 m viscos 103 pa densiti 103 kg/m3 bulk modulu 2.15109 pa tabl i: 2d water sloshing. problem data. 3. studi effect physic bulk modulu iter matrix linear describ previou section suffer numer instabl ill-condit iter matrix hv (12b). problem point previou work similar partit scheme [2326]. ill-condit iter matrix linear momentum equat orgin differ order magnitud main contributions: mass matrix mt (13) bulk matrix kv (14) (the contribut viscou matrix k (12b) neglig low valu viscosity). typic term bulk matrix order magnitud larger mass matrix. reliabl measur qualiti matrix condit number [1]. gener matrix a, condit number defin as: c = cond(a) = a1 (21) where, work, denot norm-2 matrix a. condit number c give indic accuraci result matrix invers linear equat solution. valu c close 1 indic well-condit matrix. deterior qualiti matrix hv affect directli converg iter linear solver. work, iter bi conjug gradient (bcg) solver toler fix 106. time step increment affect highli condit iter matrix hv. fact, mt invers proport time increment kv depend linearli (see eqs.(13) (14)). reason, hv well-condit tight rang time increments. object section drawback ill-condit matrix iter solut scheme. sake clarity, numer exampl visual quantifi inconveniences. problem chosen 2d water slosh rectangular tank. initi geometri problem finit element mesh analysi shown figur 1. data problem collect tabl i. highlight import time step condit iter matrix, problem solv differ time increment reduc valu modulu matrix kv ( = 1). time step t=10 3s, iter matrix copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut scheme 9 condit number c=41 while, t= 102s, condit number c=3009. larger time step used, linear solved. deterior reflect number iter linear bcg solver: case averag number iter 20, 177. clearly, lead signific increas comput time solv time step. ill-condit linear affect rate converg iter loop scheme given eqs.(15 - 20). graph fig. 2 converg rate r pressur veloc field t=1.75 displayed. valu obtain eqs.(20) consid time step increment t=102s.convergencecomparison page 1 1 5 9 13 17 21 25 0.00001 0.0001 0.001 0.01 0.1 1 veloc pressur iter r figur 2: 2d water slosh (=1). converg veloc pressur t=1.75 s. observ that, especi pressur field, converg criteria eqs.(20b) satisfied. fact, pressur error 25 iter larger pre-defin toler ep = 10 4. lack good converg pressur field produc main inconveniences: pressur solut accur mass conserv preserved. pressur contour t=1.75 s shown fig. 3. concern mass conserv fluid, fig. 4 show accumul mass variat absolut valu versu time. 20 second simulation, percentag mass loss 9.8% correspond mean volum variat 4.9 103% time step. 4. optimum valu paramet previou section shown = 1 matrix kv, iter matrix hv (12b) ill-condit certain rang time step increments. princip consequ limit choic time step increment bad converg linear iter solver iter loop describ eqs.(15 - 20). inconveni overcom previou public [25, 26] substitut physic bulk modulu smaller pseudo bulk modulu p. way, possibl copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 10 a. franci, e. onat j.m. carbonel figur 3: 2d water slosh (=1). pressur contour t=1.75 s. figur 4: 2d water slosh (=1). accumul percentag mass variat absolut valu versu time. extend applic partit scheme larger rang time increments. however, strategi base heurist criteria wide problem requir specif valu p. words, pseudo bulk modulu work certain analysi fail differ one. section, present gener techniqu predict priori valu paramet defin pseudo bulk modulu p eq.(14) (p = ). shown strategi improv substanti condit linear system. enhanc highlight solv problem previou section compar respect results. point previou sections, numer problem associ iter copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut schemes11 matrix hv (12b) differ order magnitud contribut given kv (14) mt (13). paramet eq.(14) aris linear pressur term momentum equat [18] scale ad hoc contribut kv order guarante well-condit system. shown oper interfer mass conserv fluid. reason modif affect qualiti iter matrix rate converg linear momentum equations, continu equation, mass conserv constraint imposed, modified. featur repres innov versu previou approach pseudo bulk modulu mass conserv equation. work, paramet comput as: = mean(|mt |) mean(| kv |) (22) oper (| |) denot mean absolut valu non-zero matrix compon kv = e btmtmtbd (23) paramet enforc term contribut kv iter matrix hv order magnitud mt. uniform mesh element characterist size h, estim follows: n2c h2 t2 (24) nc valu shape function ni element center follow approxim done: ni x 1 h (25) hence, water consid ( = 103kg/m3 = 2.15 109pa) linear triangl (n = 1/3 ), follow depend mesh size time step. 5.17 108 ( h t )2 (26) typically, paramet calcul begin time step iter non linear loop. comput time step, certain instant analysi begin analysis. order magnitud vari analysis, time step changed, refin mesh performed. cases, need calcul squar depend paramet h t. numer result present paper obtain comput eq.(22) begin analyses. paramet comput assign local element global mesh. calcul globally, element bulk contribut iter matrix valu , comput eq.(22) perform consid separ element mesh; .e. element differ valu . approach reduc comput cost work wors local copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 12 a. franci, e. onat j.m. carbonel approach non uniform finit element discretizations. particular, recommend us local approach refin mesh perform (in section, problem refin zone studied). paper, mentioned, global approach comput used. 5. particular fulli incompress fluid fulli incompress fluid = matrix mp vanish discret form mass conserv equat (eq.(6) box 1). us larg finit valu pseudo-bulk modulu p express volumetr matrix kv us cases, help obtain accur solut veloc pressur reduc mass loss iter time step. good estim p case obtain p = 100 ( h t )2 . 6. numer result object section assess enhanc solut given bulk matrix scale priori paramet comput eq.(22). method test solv repres free surfac problem involv flow water: slosh problem introduc section 3 collaps water column rigid obstacl present [11]. so-cal dam break problem chosen demonstr strategi affect incompress contraint method abl simul problem impact fluids. numer result compar experiment ones. slosh dam break problems, comparison perform scale bulk matrix scheme =1 given. order applic gener method, differ averag mesh size time step consid problems. note dynam slosh problem complet differ dam break one. 6.1. water slosh tank problem fig. 1 solv paramet comput eq.(22). t=103s, = 0.154, t=102s, =0.0053. time step increments, result condit number iter matrix c =23 averag number iter linear bcg solver 15. improv versu non reduc scheme evident, compar number present section 3. reduc number iter linear solver, reduc comput time. example, problem solv t=102 durat slosh simul 20s, total comput time case =1 2746 =0.0053 reduc 1600s. converg non linear loop improv correct valu . figs. 5 6 converg veloc pressur fields, respectively, obtain =1 =0.0053, compared. faster converg solut smaller valu noticeable. fig. 7 pressur solut time t=1.75 obtain =0.0053 illustrated. copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut schemes13 convergencecomparison page 1 1 5 9 13 17 21 25 0.00001 0.0001 0.001 0.01 0.1 1 = 1 optimum iter r(v) figur 5: 2d water sloshing. converg veloc t=1.75 =1 =0.0053. figur 6: 2d water sloshing. converg pressur t=1.75 =1 =0.0053. appreci remark enhanc respect case =1 (see fig. 3). note element gener free surfac region adjac boundari coars mesh remesh criteria computation. obtain better result, smaller averag mesh size refin mesh free surfac region used. state section 3, converg continu equat affect conserv mass fluid. shown converg pressur improv good predict . consequently, mass conserv better ensur copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 14 a. franci, e. onat j.m. carbonel figur 7: 2d water slosh (=0.0053). pressur contour t=1.75s. =0.0053 =1. graph fig. 8 percentag accumul mass variat (in absolut value) versu time obtain =1 =0.0053 compared. better mass preserv solut smaller valu remarkable. figur 8: 2d water sloshing. accumul mass variat absolut valu durat analysis. solut =1 =0.0053. graph fig. 9 accumul mass variat obtain =0.0053 illustrated. 20 second simulation, scheme reduc valu accumul mass variat 0.52% correnspond mean volum variat time step 1.7103%. solut =0.0053 guarante better conserv mass case =1. repres evid (quasi)-incompress constraint copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut schemes15 affect reduct bulk matrix iter matrix solv momentum equations. figur 9: 2d water slosh (=0.0053). accumul mass variat versu time. variat mesh size order verifi applic method, slosh problem solv t=103 differ mesh sizes. particular, follow averag mesh size used: h =0.1m, 0.15m, 0.2m, 0.3m 0.4m. problem solv set =1 comput priori reduc valu eq.(22). tabl fig. 10 collect data results. number iter linear solver consid qualiti indic analyses. shown previou section valu relat condit number iter matrix. curv fig. 10 show, foreseeable, reduc valu guarante better result respect = 1. meshes, number iter requir linear solver reach converg solut smaller. furthermore, result strategi applic coars fine meshes. variat time step problem fig. 1 solv differ time steps: 0.0001s, 0.0005s, 0.001s, 0.005s, 0.01s, 0.02s. mesh mean size 0.15m. numer result obtain reduc valu set =1 compared. tabl fig. 11 summar problem data results. again, iter linear solver paramet chosen indic qualiti analyses: smaller valu is, better condit linear is. graph fig. 11 show accuraci method depend time step increments, suitabl valu used. valu t, number iter 16 condit number change. furthermore, correct valu allow solv problem time increment, fix 1, result accept t=0.005s. larger time step result =1 copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 16 a. franci, e. onat j.m. carbonel averag degre freedom number iter mesh size (velocities) =1 optimum 0.4 682 20 15 (=0.535) 0.3 1220 27 15 (=0.304) 0.2 2782 41 15 (=0.136) 0.15 5002 55 16 (=0.0801) 0.1 5840 70 15 (=0.0361) figur 10: 2d water sloshing. number iter linear solver differ number veloc degre freedom. result =1 optimum valu . accur analys converge. mesh refin zone mention previou sections, paramet squar depend mesh size (see eq.(24)). reason, discret uniform global estim guarante well-condit linear system. cases, local comput recommended. slosh problem solv mesh shown fig. 12 t = 0.01s. spatial discret differ mean sizes: center h=0.1m h=0.4m elsewhere. problem solv =1 comput optimum valu global locally. mean number iter requir linear solver converg htese option 319, 21 17 respectively. hence, local approach guarante best result type non-uniform meshes. fig. 13 solut time t = 0.1 obtain local approach illustrated. case high viscos high viscos improv condit iter matrix hv. fact, copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut schemes17 t (s) number iter =1 optimum 0.02 fail 16 (=2.00 105) 0.01 523 16 (=8.01 104) 0.005 244 16 (=3.20 103) 0.001 55 16 (=8.01 102) 0.0005 30 16 (=3.89 101) 0.0001 6 16 (=8.01 ) figur 11: 2d water sloshing. number iter linear solver differ time step increments. result =1 optimum valu . contribut k opposit sign versu kv. slosh problem solv valu dynam viscos =102pas. time increment t = 102s. fig. 14 solut t = 5 .5 obtain approach illustrated. strategi converg numer values. show propos method highli viscou fluids. condit number hv =1 c=2318 (note that, expected, valu lower obtain water slosh case) = 5.35 103 c=23. conclusion, highli viscou fluids, propos method work lead better condit tangent matric =1. 6.2. collaps water column rigid obstacl section, collaps water column induc instant remov vertic wall studied. previou example, problem solv coars mesh. comparison solut obtain =1 given. that, problem solv vari mean size mesh differ time step increments. copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 18 a. franci, e. onat j.m. carbonel figur 12: 2d water sloshing. finit element mesh refin zone. figur 13: 2d slosh refin zone. solut time t = 0.1 obtain local approach. result obtain optimum valu compar experiment result present [10]. object reduct bulk modulu iter matrix affect numer solut class impact problem solv larger time step. initi geometri problem illustr fig. 15. tabl ii data problem collected. problem solv coars discret (mean element size h=0.0125m). solut obtain optimum valu =1 compar term condit number iter matrix number iter linear solver. t=104s, matrix hv condit number c=1028 c=60, =1 =0.0535, respectively, correspond 1251 14 iter linear solver, respectively. discret time increment t=103 , eq.(22) yield valu copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut schemes19 figur 14: 2d high viscou fluid sloshing. pressur contour t = 5 .5s. left: numer result = 1. right: result = 5 .35 103 . figur 15: 2d dam break. initi geometry. l 0.146 m h 0.048 m d 0.024 m viscos 103 pa densiti 103 kg/m3 bulk modulu 2.15109 pa tabl ii: 2d dam break. problem data. =0.000535. condit number hv iter linear solver time step increment time smaller. conversely, =1, condit number grow c=102090 iter scheme converge. variat mesh size problem fig. 15 solv t=104 unstructur mesh follow mean element sizes: h= 0.004m, 0.005m, 00075m, 0.01m, 0.0125m. problem solv set =1 comput priori optimum valu eq.(22). previou section, number iter linear solver consid qualiti indic analysis. tabl fig. 16 data result collected. fig. 16 confirm effici method affect mesh size. words, well-condit iter matrix guarante coars fine mesh indifferently. variat time step problem solv differ time steps: t=0.00005s, 0.0001s, 0.0005s, 0.001s, 0.0025s. mesh mean size h=0.005m. tabl 17 collect problem data copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 20 a. franci, e. onat j.m. carbonel averag degre freedom number iter mesh size (velocities) =1 optimum 0.0125 618 70 17 (=0.0536) 0.01 978 82 18 (=0.0345) 0.0075 1694 100 16 (=0.0205) 0.005 5002 163 16 (=0.00868) 0.004 6106 196 17 (=0.00559) figur 16: 2d dam break. number iter linear solver differ number veloc degre freedom. result =1 optimum valu . result number iter analys solv =1 optimum valu . fig. 17 confirm conclus previou section. strategi affect time step and, contrari case =1, impos limit rang time step increment solv problem. example, present problem, time step increment constrain geometri dynam problem only. words, maximum time step increment guarante fluid particl cross boundaries. present problem chosen mesh, maximum time step increment t=2.5 103s. fig. 18 pressur field comparison experiment result [10] t = 0 .1s, t = 0 .2 t = 0 .3 shown. good agreement obtained. 7. conclus work, analysi effect physic bulk modulu iter matrix partit finit element scheme analysi quasi-incompress fluid presented. copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut schemes21 t (s) numer iter =1 optimum 2.5 103 fail 15 (=1.39 105) 1.0 103 fail 15 (=8.68 105) 5.0 104 1000 16 (=3.47 104) 1.0 104 163 16 (=8.68 103) 5.0 105 79 16 (=3.47 102) figur 17: 2d dam break. number iter linear solver differ time steps. result =1 optimum valu . shown result linear ill-condit certain time step increments. shown reason differ order magnitud contribut bulk mass matric solut system. typically, bulk matrix term larger mass ones. consequ ill-condit algebra equat converg linear iter solver iter loop deteriorated. general, effici easi implement strategi overcom problem proposed. techniqu base pseudo bulk modulu p = 0 < < 1 matrix kv order improv condit global iter matrix hv. express comput optimum valu reduct paramet given. optimum valu comput local globally, time step solut step. depend problem, altern preferable. paramet function scale bulk matrix term iter matrix order magnitud mass matrix ones. - numer exampl shown propos techniqu improv stabil pressur field, converg rate iter solut comput speed analysi iter system. illustr strategi affect chang time step copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 22 a. franci, e. onat j.m. carbonel figur 18: 2d dam break. pressur contour comparison experiment results/left [10] t = 0 .1s, t = 0 .2 t = 0 .3s. numer result obtain t = 0.0025 = 1 .39 105 . mesh. furthermore, shown method advantag viscou fluid local refin meshes. case, local comput paramet recommended. finally, shown possibl simul impact fluid reduc valu affect actual compress fluid. acknowledg research support advanc grant project safecon european research council. copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut schemes23 refer [1] k.j. bathe. finit element procedures. prentice-hall, new jersey, 1996. [2] m. benzi, g.h. golub j. liesen. numer solut saddl point problems. acta numerica, 14:1137, 2005. [3] m. benzi, m.a. olshanskii z. wang. modifi augment lagrangian precondit incompress navier-stok equations. int. j. num. meth. fluids, 66:486508, 2011. [4] d. bresch, e.d. fernandez-nieto, i.r. ionescu p. vigneaux. augment lagrangian method compress visco-plast flow. applic shallow dens avalanches. new direct mathemat fluid mechanics. alexand v. kazhikhov memori volume. seri book advanc mathemat fluid mechanics. a.v. fursikov, g.p. galdi v.v. pukhnachev (eds.), birkhaus verlag basel, switzerland, 5789, 2010. [5] f. brezzi. existence, uniqu approxim saddle-point problem aris lagrang multipliers. revu francais dautomatique, informatique, recherch operationnelle. seri rouge. analys numerique, 8(r-2):129151, novemb 1974. [6] j.m. carbonell, e. onate, b. suarez. model ground excav particl finite-el method. journal engin mechanics, 136:455463, 2010. [7] j. donea a. huerta. finit element method flow problems. wiley, 2003. [8] h.c. elman, d.j. silvest a.j. wathen. finit element fast iter solver applic incompress fluid dynamics. oxford seri numer mathemat scientif computation. oxford univers press, oxford, 2005. [9] m. fortin r. glowinski. augment lagrangina: applic numer solut boundari valu problems. north-holland, amsterdam, 1983. [10] d.m. greaves. simul viscou water column collaps adapt hierarch grids. intern journal numer method engineering, 50:693711, 2006. [11] b. hubner, e. walhorn, d.dinkler. monolith approach fluid-structur interact space-tim finit elements. method appli mechan engineering, 193:20872104, 2004. [12] s.r. idelshon, j. marti, a. limache, e. onate. unifi lagrangian formul elast solid incompress fluids: applic fluid-structur interact problem pfem. method appli mechan engineering, 197:17621776, februari 2008. [13] s.r. idelsohn, e. onate, f. del pin. particl finit element method: power tool solv incompress flow free-surfac break waves. intern journal numer method engineering, 61:964989, 2004. copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl 24 a. franci, e. onat j.m. carbonel [14] a. larese, r. rossi, e. onate, s.r. idelsohn. valid particl finit element method (pfem) simul free surfac flows. intern journal computer- aid engin software, 25:385425, 2008. [15] e. onate. deriv stabil equat advective-diffus transport fluid flow problems. comput. meth. appl. mech. engng. 151:233267, 1998. [16] e. onate. stabil finit element method incompress viscou flow finit increment calculu formulation. comput method appl mech engrg. 182(12):355 370, 2000. [17] e. onat j.m. carbonell. updat lagrangian finit element formul quasi fulli incompress fluids. research report pi393, cimne. submit comput. mechanics, 2013. [18] e. onate, a. franci, j.m. carbonell. lagrangian formul finit element analysi quasi-incompress fluid reduc mass losses. accept intern journal numer method fluids, doi: 10.1002/fld.3870. [19] e. onate, s.r. idelsohn, f. del pin, r. aubry. particl finit element method. overview. intern journal comput methods, 1:267307, 2004. [20] e. onate. possibl finit calculu comput mechanics. int. j. num. meth. engng. 60(1):255281, 2004. [21] e. onate, p. nadukandi, s.r. idelsohn, j. garca, c. felippa. famili residual- base stabil finit element method stoke flows. intern journal numer method fluids, 65(1-3):106134, 2011. [22] e. onate, a. valls, j.garca. comput turbul flow finit calculus- finit element formulation. intern journal numer method engineering, 54:609637, 2007. [23] p. ryzhakov. doctor thesis: lagrangian fe method coupl problem fluid mechanics. universitat politecnica catalunya, barcelona, spain, 2010. [24] p. ryzhakov, j. cotela, r. rossi, e. onate. two-step monolith method effici simul incompress flows. accept intern journal numer method fluids, doi: 10.1002/fld. [25] p. ryzhakov, e. onate, s.r. idelsohn. improv mass conserv simul incompress flows. intern journal numer method engineering, 90:14351451, 2012. [26] p. ryzhakov, r. rossi, s.r. idelsohn, e. onate. monolith lagrangian approach fluid-structur interact problems. comput mechanics, 46:883899, 2010. [27] g. vinay, a. wach j.f. agassant. numer simul weakli compress bingham flows: restart pipelin flow waxi crude oil. j. non-newtonian fluid mechs., 136(23):93105, 2006. copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl effect bulk tangent matrix partit solut schemes25 [28] s. vincent, al sarthou, j.p. caltagirone, f. sonilhac, p. fevrier, c. mignot g. pianet. augment lagrangian penalti method simul two-phas flow interact move solids. applic hydroplan flow interact real tire tread patterns. j. comput. physics, 203(4):956983, 2013. [29] o.c. zienkiewicz r.l. taylor. finit element method. basi fundamentals. (6th ed.). elsevi butterworth-heinemann, oxford, 2005. [30] o.c. zienkiewicz, r.l. taylor, p. nithiarasu. finit element method fluid dynamics,volum 3 (6th ed.). elsiever, oxford, 2005. copyright c 2010 john wilei & sons, ltd. int. j. numer. meth. engng 2010; 00:16 prepar nmeauth.cl upcommon portal del coneix obert la upc aquesta s una cpia la versi author final draft d'un articl publicat la revista journal hydrology. url d'aquest document upcommon e-prints: articl publicat / publish paper: