visual embed unsupervis extract abstract semant garcia-gasulla , d. & ayguad , e. & labarta , j. barcelona supercomput center ( bsc ) dario.garcia @ bsc.es bejar , j .
& cort , u. universitat politecnica de catalunya - barcelonatech suzumura t. & chen , r. ibm t.j. watson research center , usa decemb 16 , 2016 abstract vector-spac word represent obtain neural network mod- el shown enabl semant oper base vector arith- metic .
paper , explor exist similar inform vector represent imag .
purpos defin method- olog obtain larg , spars vector represent imag class , generat vector state-of-the-art deep learn architectur googlenet 20k imag obtain imagenet .
first evalu result vector-spac semant correl word- net distanc , find vector distanc strong correl linguist semant .
explor locat imag within vector space , find element close wordnet cluster togeth , regardless signific visual varianc ( e.g. , 118 dog type ) .
sur- prise , find space unsupervis separ complex class without prior knowledg ( e.g. , live thing ) .
afterward , consid vector arithmet .
although unabl obtain meaning result regard , discuss various problem encount , consid solv .
final , discuss impact research cognit system , focus role architectur use .
1 introduct deep learn network learn represent million featur compos network [ 8 ] .
provid train deep network ex- ception rich represent languag , allow perform detect classif remark precis .
far represent languag learnt deep network use straightforward , task like im- age classif .
howev , deep network represent use purpos , inform code within featur extract .
1  < 2016 > .
manuscript version made avail cc-by-nc-nd 4.0 licens http : //creativecommons.org/licenses/by-nc-nd/4.0/ doi : 10.1016/j.cogsys.2016.11.008 way vector-spac represent .
vector-spac explor vector arithmet .
approach taken [ 10 ] , author find syntact ( e.g. , singular/plur ) semant ( e.g. , male/femal ) regular vector represent word .
paper extract inform neural network model complex domain im- age .
lead us work deep network capabl captur complex varieti inform found visual domain .
use pre- viousli train network intern featur descriptor , build vector featur set imag use train network .
vector-spac built , analyz semant contain .
result provid insight represent learnt deep network model , open new set applic exploit deep network represent .
2 motiv word vector represent obtain neural network model found contain syntact semant inform [ 10 ] .
inform extract arithmet oper vector-spac , success use task machin translat [ 9 ] .
motiv paper explor exist similar inform imag vector represent , could use generic visual reason .
imag vec- tor represent extract convolut neural network ( cnn ) previous explor applic imag recognit task .
[ 3 ] explor perform featur learnt given data set recogniz- ing imag class differ data set .
author found top layer network seem cluster imag accord high level semant ( e.g. , outdoor vs indoor ) .
[ 14 ] went , consid util featur imag recognit problem fine-grain classif attribut select .
work built imag vector represent solv imag recognit task .
sinc top layer network opti- mize discrimin train , layer turn effect set featur avail task .
howev , repres abstract visual concept ( e.g. , imag class ) may may taught , rest layer may becom use , tri maxim representative- ness instead discrimin power .
mid-level layer paramet train one dataset success reus recogn differ dataset [ 12 ] , show relev learnt model .
popular field research right within deep learn multimod system , visual lan- guag model integr .
exampl devis [ 4 ] combin skip-gram model train larg corpus cnn train ilsvrc data .
thank inform provid languag model , devis make reason infer imag belong unknown class , known zero-shot predict .
multimodel system particular relev work propos [ 7 ] , combin image-sent embed long short-term memori .
author show exist regular per- form oper imag blue car - word blue + word red ' imag red car .
work explor similar regular , without use lan- guag model guid .
purpos build spars high-dimension represent imag class , tri obtain rich abstract empow 2 unsupervis process .
3 methodolog cnn train label imag learn visual pattern discrimin label .
deep network million pattern , imple- ment activ function ( e.g. , relu ) within network featur .
featur within deep network consequ provid signific piec visual inform descript imag , even maxim rele- vant discrimin ( top layer featur ) .
consid featur activ valu given imag , one fact look every- thing network see within imag , learnt train .
visual semant captur neural model thus found featur valu , valu repres vector analysi .
precis specif vector represent bound qualiti vari- eti pattern found deep network ; network capabl discrimin imag class higher precis provid richer imag descript .
maxim descript accuraci detail use googlenet ar- chitectur [ 17 ] , deep cnn ( 22 layer ) ilsvrc14 visual recognit challeng [ 15 ] .
use pre-train model avail caff deep learn framework [ 6 ] , train 1.2m imag imagenet test set task discrimin 1,000 imagenet hierarchi categori .
googlenet model compos 9 incept modul .
captur output 1x1 , 3x3 5x5 convolut layer top 9 modul build vector represent activ valu .
imag run train network , 27 differ layer combin produc 1 million activ , express presenc relev mani differ visual pattern input imag .
vector-build process treat compos featur independ variabl .
thus , imag high- dimension , spars vector represent compos 1m continu variabl .
execut describ paper perform two intel sandybridge-ep e5-2670/1600 20m 8-core 2.6 ghz 64 gb ram .
code use process activ featur produc figur graph avail https : //github.com/dariogarcia/tiramisu .
experi use 20,000 imag imagenet valid set , label 1,000 differ class , includ larg varieti object , anim , plant , etc .
imagenet class map differ wordnet synset concept , use advantag evalu process ( see evalu ) .
sampl imag use shown figur 1 .
3.1 imag class obtain vector 20,000 imag , perform abstract step build vector represent abstract class , use 1,000 class imag label .
build imag class vector combin specif imag vector belong class .
result aggreg , expect obtain repres valu variabl class , reduc variat found specif imag regard bright , context , scale etc..
number imag aggreg per class rang 11 32 .
aggreg imag 3 figur 1 : sampl imag use experi , obtain ima- genet 2012 valid set .
first row imag shown label class  n02504458 african eleph , loxodonta africana  , second row imag label class  n02676566 acoust guitar  , third row imag label  n02747177 ashcan , trash , garbag , wastebin , ash bin , ash-bin , ashbin , dustbin , trash barrel , trash bin  .
class vector size imag vector ( rough 1m variabl ) , comput arithmet mean imag avail class .
end aggreg process obtain 1,000 vector , correspond represent 1,000 leaf-nod categori imagenet hierarchi .
altern aggreg methodolog consid , discuss parametr section .
1,000 categori imagenet hierarchi correspond divers entiti .
simpl object , produc weak activ .
other complex found rich context , involv stronger activ .
variabl magnitud imag class vector may affect result similar metric , sinc class less lower activ consid closer class actual .
second sourc variabl found variabl behaviour neuron given locat within cnn .
typic , low-level neuron close input produc frequent stronger acti- vation , repres simpl pattern easier find .
hand , neuron higher within cnn produc spars activ , due special role .
elimin impact sourc variabl per- form normal process imag class vector .
normal vector valu layer layer , guarante inform avail visual resolut equal relev represent , imag class vector contain amount inform .
alter- nativ normal method , includ normal , consid , discuss parametr section .
imag class vector represent built aggreg normal activ sever imag within singl vector , depict figur 2 .
studi inform contain within result vector-spac comput imag class similar 4 figur 2 : featur extract , aggreg normal process use build imag class vector represent .
vector distanc measur .
use cosin similar build distanc ma- trix 1,000 class , use distanc vector-spac evalu ( compar sever distanc base wordnet ) analysi ( find cluster class ) .
4 evalu evalu consist inform captur propos em- bed space use label repres class .
imagenet label map wordnet concept , thus provid access lexic semant implement wordnet .
sinc vector represent suppos captur visual semant instead , signific gap expect .
nev- ertheless , wordnet remain sourc valid knowledg avail evalu .
distanc among imag class comput wordnet measur , typic use hypernym/hyponym lexic taxonomi [ 13 ] .
time comput imag class distanc vector-spac , use previous defin methodolog .
result , everi avail imag class , two set similar respect rest imag class , similar reduc rank .
spearman   provid measur correl two rank , bound -1 1 , valu close either -1 1 indic strong correl .
obtain  valu everi imag class , compar lexic visual rank .
consid  valu imag class obtain distribut correl , indic level semant coher wordnet taxonomi vector-spac whole .
consid six differ wordnet distanc maxim consist : three base path length concept ( path , lch wup ) three corpus- base focus specif concept ( res , jcn lin ) [ 13 ] .
addition- alli , use two differ corpus three corpus-bas measur , brown corpus , british nation corpus .
figur 3 show distribut correl vector embed nine wordnet mea- sure .
 valu most found 0.4 0.6 , indic strong correl rank 999 element .
result consist nine wordnet set ; averag  distribut 0.44 wors 5 figur 3 : histogram spearman   correl imag class vector similar comput method , nine wordnet similar measur ( three path length base : path , lch wup , three corpus-bas res , jcn lin use two differ corpus ) .
histogram contain 1,000  correl valu correspond correl everi class imagenet dataset .
case ( jcn bnc ) 0.49 best case ( res brown & res bnc ) .
re- sult indic vector represent contain larg amount semant inform also captur wordnet .
particular interest , con- sider wordnet captur visual semant color pattern , proport context .
4.1 parametr sever altern solut consid vector-build process describ methodolog section .
determin specif solut appropri follow evalu approach previous de- scribe .
option consid follow :  aggreg : comput imag class vector represent set imag vector use mean .
consid arithmet , geometr harmon mean .
 normal : normal vector consid normal ap- pli vector whole , 27 sub-vector normal base 27 layer found vector .
consid perform option appli singl imag vector , aggreg , imag class vector , aggreg .
also consid avoid normal step .
 distanc : comput distanc vector consid cosin euclidean distanc .
 threshold : decreas variabl consid ad activ threshold disregard activ valu 0 1 build imag vector represent , thus increas vector sparsiti .
test combin paramet , evalu base distribut correl produc .
found best set arithmet mean , imag class normal layer , cosin distanc threshold .
howev , imperfect natur evalu ( i.e. , use rank correl base lexic measur ) allow us definit 6 layer use layer top 22 % middl 55 % bottom 22 % mean  0.46 0.41 0.46 0.36 tabl 1 : mean  correl valu imag class vector similar comput method , nine wordnet similar measur , use subset layer cnn model .
assert set produc semant rich vector embed .
instead discuss paramet provid signific benefit term correl , thus recommend futur work , caus less definit effect .
aggreg normal paramet largest impact distribut correl , allow us confid set .
arithmet mean clear outperform geometr harmon mean , normal layer aggreg imag class achiev much higher correl either whole , origin imag vector , avoid normal togeth .
hand , distanc algorithm , particular use activ threshold , small impact distribut correl .
paramet choos option seem maxim correl ( cosin threshold ) , differ choic remain competit .
differ paramet analyz layer use build vector represent .
previous contribut argu best consid top layer activ use imag recognit task [ 3 , 14 ] .
contrari approach , methodolog use featur layer network , goal maxim repres .
valid notion , use certain layer network build embed space , explor correl wordnet set .
distribut correl fulli compar measur qualiti , provid formal evalu previous paramet .
howev , sinc need provid evid contrast previous work [ 3 , 14 ] regard layer use , decid show mean  obtain subset layer .
valu tabl 1 taken definit evid .
consid use featur belong top 22 % net- work ( i.e. , incept modul 5a 5b ) , featur middl 55 % ( i.e. , incept modul 4a , 4b , 4c , 4d 4e ) featur bottom 22 % network ( i.e. , incept modul 3a 3b ) .
result indic correl achiev middl 55 % similar correl achiev set 27 layer .
hand , correl achiev consid featur top 22 % bottom 22 % layer signific wors , still show correl .
result indic layer within network contain visual semant relev descript abstract imag class , regardless locat .
differ result previous work [ 3 , 14 ] explain differ method goal .
previous contribut focus singl imag represent imag recognit task .
sinc singl imag high variabl term bright , context , etc. , use dispers lower layer represent mayb counterproduct .
hand target high-level imag class represent , 7 much smaller variabl thank aggreg normal process appli .
result consid larger volatil part input ( i.e. , non-top layer ) seem potenti use knowledg represent process target abstract entiti .
5 cluster imag class analyz semant captur within defin vector-spac perform supervis analysi cluster , use wordnet hierarchi ground truth ; know imag class hyponym synset , explor distribut within embed space .
achiev visual result , appli metric multi-dimension scale [ 2 ] two dimens 1,000 imag class distanc matrix .
method build two-dimension map vector distanc respect pairwis origin similar .
first use two synset mani hyponym within imagenet categori : dog ( accord wordnet 118 special dog imag class ) wheel vehicl ( 44 special wheel vehicl imag classes1 ) .
highlight locat imag class belong one two set two-dimension similar map figur 4a .
first sight , two set highlight imag compos defin cluster .
although precis perfect , imag class belong wordnet categori clear assembl togeth vector-spac represent .
case dog , relev wide varieti dog comput , visual featur common ( e.g. , chihuahua , huski , poodl , great dane ) .
accord result , visual featur common dog weight vector represent variabl featur size , color proport .
probabl caus aggreg normal process , reduc import within imag class volatil properti .
cluster defin wheel vehicl imag class lower precis dog , probabl wheel vehicl vari dog ( e.g. , monocycl , tank , train ) .
nevertheless one wheel vehicl locat quadrant graph , indic larg reliabl set featur vector represent identifi type imag class .
one wheel vehicl locat outsid middle-left quadrant , low-right part figur 4a , correspond snowmobil , rather special type wheel vehicl seem differ everyth .
look figur 4a notic gap natur split imag class two set .
separ consist spars area visibl first sight graph .
explain phenomenon explor basic categor wordnet , separ imagenet class live thing , defin wordnet live ( live ) entiti rest .
paint imag belong live thing obtain graph figur 4b .
graph show separ found vector-spac correspond simpl categor strike precis , unsupervis cluster imag depend whether depict live thing .
mistak done correspond organ uniqu shape textur ( e.g. , lobster , 1to 44 class ad school bus , minibus trolleybus imag class , consid wheel vehicl .
8 b figur 4 : scatter plot imag class vector similar built metric multi-dimension scale .
( ) black circl belong imag label hy- ponym synset  dog , domest dog , cani familiari  dark grey circl belong imag label hyponym synset  wheel vehicl  .
( b ) black circl belong imag label hyponym synset  live thing , anim thing  .
basebal player , dragonfli ) thing often depict around live thing ( e.g. , snorkel , dog sled ) .
particular case rather controversi , coral reef live organ accord wordnet vector- space cluster .
encourag result tri obtain represent vector-spac show separ live organ rest clariti .
purpos test non-linear map distanc three dimens use isomap algorithm [ 18 ] .
featur extract network combin non-linear obtain class imag , kind transform highlight inher non-linear vector-spac .
figur 5 show evid separ among two synset also complex structur within class imag .
point assert vector represent captur larg amount high-level semant .
given sourc deep network provid 1,000 independ imag categori label , semant captur beyond vector space must origin visual featur .
boundari semant captur way howev hard defin , would requir us state learnt seen imag .
best notion far limit visual semant provid distinct live thing rest .
hors , salmon , eagl , lizard mushroom seem littl common visual , yet element cluster vector-spac .
structur pattern live thing seem therefor particular enough motiv distinct .
result open mani interest question intend address follow-up work .
9 figur 5 : scatter plot built isomap , analog figur 4b .
black circl belong imag label hyponym synset  live thing , anim thing  .
6 lesson imag equat word vector embed empow extract syntact semant reg- ular vector arithmet ( e.g. ,  king - man + woman = queen  ) [ 10 ] .
regular explor linguist context far form  a b b  , applic field like machin translat [ 9 ] .
imag class vector embed construct process defin method- olog section allow us consid exist similar regular within domain imag .
, result evalu section indic , visual semant encod within imag class vector , may possibl oper semant perform type visual arithmet rea- sone .
comparison linguist context , imag embed space build much larger dimension data variabl .
simplifi arithmet process consid simpler relat three operand , form  - b ' c  .
use subtract oper imag class vector , combin cosin similar measur ' oper find closest imag class result substract thus solv equa- tion .
given two imag , i1 i2 featur f , subtract i2 i1 f defin f ( i1  i2 ) = { f ( i1 )  f ( i2 ) , f ( i1 ) > f ( i2 ) 0 , otherwis substract oper defin featur level .
solv imag equat substract vector level appli featur compos 10 vector .
consid two differ scenario equat could appli .
one analyz imag class understood non-overlap concaten two class .
exampl could chair plus wheel , could produc imag class like offic chair wheelchair .
second scenario forese analyz imag class understood overlap combin two class .
case visual properti two mix class would need strong intertwin produc third .
exampl could wolf plus man , could produc werewolf .
explor imag equat describ found sever limi- tation prevent us obtain meaning result .
sinc work process describ limit , intend solv , hope research may benefit experi .
first problem face relat evalu imag equat , sinc obvious ground truth avail .
one could subject propos mani differ equat make visual sens , platypus - duck = beaver , turtl - shield = lizard motorcycl - motor = bicycl .
approach , besid hard scalabl sinc one  imagin quick run , may easili in- clude human bias implicit consider non-visu featur .
nevertheless , remain best avail evalu methodolog .
sinc avail test dataset , instead comput possibl equat , subject decid exact one ( lower ' oper valu ) make sens visual .
problem approach huge number possibl equat , comput cost comput .
exampl , use 1,000 differ class vector ob- tain imagenet dataset , compos rough 997 million differ equat form  - b ' c  ( notic cosin similar commut substract oper ) .
comput singl equat one need substract two vector compos one million featur , comput similar result third vector .
comput 997 million therefor problem requir huge amount comput resourc .
thus , effici code run parallel top high-perform infrastructur must solv problem .
anoth relev problem caus curs dimension .
imag class vector represent work compos rough one million featur .
consequ , result vector space defin one million dimens .
high-dimension space object high similar , distanc measur , euclidean distanc , troubl find meaning differ .
solv issu consid various dimension reduct method ( e.g. , princip compon analysi ) , well employ distanc measur resist high dimension ( see [ 1 ] ) .
7 implic cognit system deep learn network shown appropri solv spe- cific compon cognit system : percept .
unlik previous model , deep network process huge amount raw data , first learn later iden- 11 tifi abstract pattern character data complex task .
multipl non-linear , deep learn model solv cognit problem transform sub-symbol data symbol knowledg ; differ look see .
case cnns , model mimic anim visual cortex process imag two dimension matrix featur .
squar sub-part matrix process recept field , look previ- ousli learnt pattern filter input pictur ( i.e. , convolut ) .
output filter project two dimension matrix , goal iter appli convolut process larger part origin input matrix .
eventu , neuron fed full input matrix , produc data descriptor whole input .
current deep cnn architec- ture includ million filter distribut among sever layer , filter tune given purpos .
design make cnns see human essenc , perceiv small visual pattern small visual patch input , iter aggreg full visual percept obtain .
although deep learn appar solv problem percept definit larg rich represent languag , model seem limit higher-level purpos relat cognit ( e.g. , reason ) lack symbol oper mechan .
situat natur lead solut addit machin learn method plug top deep learn system , process represent built achiev high-level cognit process .
particular architectur one follow research , use represent languag learnt cnn ( pretrain googlenet model ) obtain specif input data ( imag vector class vector ) empow addit machin learn method ( cluster algorithm ) .
use architectur capabl perform high-level cognit concept discoveri , someth cnns , find cluster entiti correspond entiti ( e.g. , live thing ) .
current imposs say may overal impact deep learn cognit system .
howev assert least lowest level cognit , percept , replic model cnns .
combin architectur propos essenc behind deep learn success case ( e.g. , deep learn + classifi object recognit [ 5 ] , deep learn + tree search reinforc learn boardgam video game [ 16 , 11 ] ) , like next generat cognit system follow architectur well .
8 conclus paper present methodolog build vector represent imag class base featur origin learnt deep learn network .
goal extract visual semant captur deep network model , order make avail learn reason method .
unlik previous research , focus repres abstract class , aggreg normal singl imag belong concept .
consist methodolog allow us consid unpreced amount featur ( 1m ) .
analyz result vector-spac first look cluster 12 differ element common semant ( e.g. , dog , wheel vehicl ) .
varia- tion proport , size color within class seem domin essenti visual featur ( e.g. , share 118 kind dog ) , element cluster togeth within embed space .
exist high-level properti support untaught vector distinct be- tween live organ non-liv thing .
make us wonder limit learnt visual inform , straight- forward defin visual particular life .
general term , propos methodolog take larg volum pixel ( sub-symbol data ) translat concept abstract semant ( symbol knowledg ) .
workflow clear implic artifici cogni- tive system , tackl problem obtain symbol knowledg sub-symbol data , necessari step abstract reason real world percept .
practic , approach extract high-level knowledg imag deep network , make represent power cnn avail cognit purpos .
promis architectur cognit system .
iden- tifi cluster imag distinct vector-spac , find distinct trait set class could use visual learn , vector arith- metic could use reason artifici imag generat .
main follow-up work research goe direct , solv problem found appli vector arithmet , explor use deep learn represent outsid deep learn .
also intend appli work zero-shot predict task , approach would allow us tackl complet unsupervis manner .
9 acknowledg work partial support joint studi agreement .
w156463 ibm/bsc deep learn center agreement , spanish govern- ment programa severo ochoa ( sev-2015-0493 ) , spanish min- istri scienc technolog tin2015-65316-p project generalitat de catalunya ( contract 2014-sgr-1051 ) , core research evolut scienc technolog ( crest ) program japan scienc technolog agenc ( jst ) .
refer [ 1 ] charu c aggarw , alexand hinneburg , daniel keim .
 surpris behavior distanc metric high dimension space  .
: intern confer databas theori .
springer .
2001 , pp .
420 434 .
[ 2 ] ingwer borg patrick jf groenen .
modern multidimension scale : theori applic .
springer scienc & busi media , 2005 .
[ 3 ] jeff donahu et al .
 decaf : deep convolut activ featur generic visual recognit  .
: arxiv preprint arxiv:1310.1531 ( 2013 ) .
[ 4 ] andrea frome et al .
 devis : deep visual-semant embed model  .
: advanc neural inform process system .
2013 , pp .
2121 2129 .
13 [ 5 ] kaim et al .
 delv deep rectifi : surpass human-level perform imagenet classif  .
: proceed ieee in- ternat confer comput vision .
2015 , pp .
10261034 .
[ 6 ] yangq jia et al .
 caff : convolut architectur fast featur embed  .
: arxiv preprint arxiv:1408.5093 ( 2014 ) .
[ 7 ] ryan kiro , ruslan salakhutdinov , richard zemel .
 unifi visual- semant embed multimod neural languag model  .
: arxiv preprint arxiv:1411.2539 ( 2014 ) .
[ 8 ] yann lecun , yoshua bengio , geoffrey hinton .
 deep learn  .
: natur 521.7553 ( 2015 ) , pp .
436444 .
[ 9 ] toma mikolov , quoc v le , ilya sutskev .
 exploit similar among languag machin translat  .
: arxiv preprint arxiv:1309.4168 ( 2013 ) .
[ 10 ] toma mikolov , wen-tau yih , geoffrey zweig .
 linguist regulari- tie continu space word representations.  : hlt-naacl .
2013 , pp .
746751 .
[ 11 ] volodymyr mnih et al .
 play atari deep reinforc learn  .
: arxiv preprint arxiv:1312.5602 ( 2013 ) .
[ 12 ] maxim oquab et al .
 learn transfer mid-level imag rep- resent use convolut neural network  .
: comput vision pattern recognit ( cvpr ) , 2014 ieee confer .
ieee .
2014 , pp .
17171724 .
[ 13 ] ted pedersen , siddharth patwardhan , jason michelizzi .
 wordnet : : similar : measur related concept  .
: demonstr pa- per hlt-naacl 2004 .
associ comput linguist .
2004 , pp .
3841 .
[ 14 ] ali razavian et al .
 cnn featur off-the-shelf : astound baselin recognit  .
: comput vision pattern recognit workshop ( cvprw ) , 2014 ieee confer .
ieee .
2014 , pp .
512519 .
[ 15 ] olga russakovski et al .
 imagenet larg scale visual recognit chal- leng  .
: intern journal comput vision ( ijcv ) ( 2015 ) , pp .
1 42. doi : 10.1007/s11263-015-0816-i .
[ 16 ] david silver et al .
 master game go deep neural network tree search  .
: natur 529.7587 ( 2016 ) , pp .
484489 .
[ 17 ] christian szegedi et al .
 go deeper convolut  .
: arxiv preprint arxiv:1409.4842 ( 2014 ) .
[ 18 ] j .
b. tenenbaum , v. de silva , j. c. langford .
 global geometr framework nonlinear dimension reduct  .
: scienc 290.5500 ( dec. 2000 ) , pp .
23192323 .
14
