single-camera automat landmark peopl recognit ensembl regress tree computacin y sistemas, vol. 20, no. 1, 2016, pp. 1928 doi: 10.13053/cys-20-1-2365 issn 2007-9737 single-camera automat landmark peopl recognit ensembl regress tree karla trejo, cecilio angulo universitat politecnica catalunya, barcelona, spain abstract. activ appear model (aam) vision procedur statist match object shape appear images. main drawback techniqu come construct shape mesh. landmark manual place train shapes, aam time consum procedur automat appli new object observ images. approach automat landmark bodi shape imag aam train introduc paper. work exist appli automat landmark face bodi joints. here, explor possibl extend method bodi contour demonstr plausibl approach term accuraci speed measur experimentation. propos repres new research line human bodi pose track single-view camera. hence, implement real-tim lead peopl recogn robot endow minim vision resources, like webcam, human-robot interact tasks. keywords. activ appear model, statist matching, peopl recognition, bodi shape, automat landmarking, human-robot interaction. 1 introduct recognit core pursuit vision research [21, 2, 32]. task attempt attach semant visual data imag video. object recognit import recur subtop model built recogn object categori instanc [20, 24, 4]. subtop current get popular peopl recognit [31]. peopl recognit compris major interests: attach ident pictur video, build descript visual data peopl behaviour. descriptor lead varieti task perform base premises, like face recognit [23, 17, 33], pose estim [26], activ recognit [7, 28], peopl track [1], others. properli identifi human includ difficulti overtaken. imag video peopl high degre variabl shape texture. appear variat differ individuals, deform facial expression, pose illumin changes. account visual percept paramet resolution, contrast, brightness, sharpness, color balanc [5, 35, 27, 6]. model-bas techniqu repres promis approach model repres ident match unknown data. kind techniqu shown abl entir describ facial characterist reduc model, extract relev face inform background interfer [16, 15, 8]. activ appear model (aams) [9] gener model certain visual phenomenon. linear shape appearance, overall, aam nonlinear parametr model term pixel intensities. fit aam imag consist minim error input imag closest model instance. frequent applic aam includ medic imag interpretation, face recognit tracking. nevertheless, major issu li construct 2d shape mesh landmark place hand train images, computacin y sistemas, vol. 20, no. 1, 2016, pp. 1928 doi: 10.13053/cys-20-1-2365 karla trejo, cecilio angulo20 issn 2007-9737 long time consum process carri out. task construct aam hand- mark mesh call automat aam process automat local vertex mesh known automat landmarking. approach perform achiev task imag human faces, static dynamic, combin featur descriptor predictor [3, 34, 29]. however, state-of-the- art method emploi upgrad version aam combin decision-tre learn algorithms, lead outstand face align result [11, 18, 22]. rgb-depth sensor technolog contribut widen method scope [14], aim present work cover 2d data analyz accuraci computation expens instances. besides, exist vast bodi work estim articul human pose imag video. recent studi 2d pose estim imag reveal promin result regressor [12, 30, 25]. hence, approach introduc [22] face align select implement automat landmark bodi contour images. algorithm emploi cascad regressor combin decision-tre learning, conform suitabl combin new specif target bodi contour contain latest advanc methodolog automat aam human pose estimation. main contribut articl demonstr facial automat landmark approach extend bodi contour well. hence, object present work obtain solid evid algorithm current literatur implement adequ perform automat landmark task imag bodi contour accept accuracy. moreover, execut valid real-tim mean speed test. landmark imag obtain motion captur data [19] multipl camera view [13], annot small dataset. form, aam method applic enlarg peopl recognit track domain. experiment consist select repre- sent imag - differ subjects, 12 imag total - dataset 46 imag manual landmarked, order feed bodi shape predictor trainer. consid fourth subject shape predictor training. output trainer give gener shape model human bodi that, combin peopl detector, fit automat landmark bodi contour new imag presented, new frame train subject complet new fourth subject. result experi confirm that, proper adjustments, face align algorithm export human bodi low comput time testing, foster real-tim implement robot equip singl camera. rest paper organ follows. stage procedure, peopl detector train detail section 2. section 3 complet descript depict train process bodi shape predictor second stage system. stage present section 4, automat landmark readi go, experi conduct result analyzed. finally, conclus futur research line section 5. 2 peopl detector phase overal propos peopl detector training. implement imglab tool dlib c++ library1. set imag differ subject obtain webcam streaming, subset imag train peopl detector, stage system. hence, set 46 imag provid 4 differ subject webcam stream 640 480 standard size, 26 taken train peopl detector. matter fact, 46 imag duplic subsets. dataset share demonstr algorithm influenc 1 computacin y sistemas, vol. 20, no. 1, 2016, pp. 1928 doi: 10.13053/cys-20-1-2365 single-camera automat landmark peopl recognit ensembl regress tree 21 issn 2007-9737 prefer particular subject. 26 imag -from subject 2, subject 3, subject 4- input imglab tool abl annot dataset red bound box bodi subject label bodi detect (see figur 1). subject object anthropomorph form images. therefore, cross bound box necessari indic fals posit dlib c++ code ignor perform detections. fig. 1. annot imag imglab tool train peopl detector 2.1 train test conduct obtain suitabl train paramet best possibl detect results. moreover, variabl like number train imag tight bound box taken account. import train paramet peopl detector shown tabl 1 select values. dlib c++ librari goe step train kind slide window object detector publish [10] summar figur 2, appli hog featur descriptor linear svm baselin classifier. consequently, trainer usual svm c hyper-paramet (see tabl 1). favor valu c empir analyz perform train detector test set new images, imag train stage. general, higher valu c encourag fit train data better lead overfitting. tabl 1. default paramet valu set exampl program versu chosen valu run test paramet deafault valu select valu c 1 0.65 epsilon 0.01 0.01 target-s 8080 100100 upsampl flip ye trainer keep run risk gap small (less epsilon valu tabl 1). problem valu rang 0.1 0.01 plenti accurate. smaller valu prompt trainer solv svm optim higher accuracy, longer train. term target-s tabl 1 refer size pixel slide window detector. train data particular, upsampl function improv results. act pre-process step, upsampl increas size imag factor 2 allow detect smaller featur target object. case focus human silhouettes, larg detect circumstance. human bodi usual left-right symmetr increas train dataset ad mirror version imag flip option. step us doubl size train dataset 26 52 images, improv result significantly. remark train bound box bit loos bodies. train tight, detect tend partial. final corrections, peopl detector start detect like shown figur 3a, proper adjust achiev result figur 3b. bodi complic pose difficult entir includ detect box (figur 3c). nevertheless, set paramet final valu tabl 1 led obtain better detect particular instanc (figur 3d). computacin y sistemas, vol. 20, no. 1, 2016, pp. 1928 doi: 10.13053/cys-20-1-2365 karla trejo, cecilio angulo22 issn 2007-9737 fig. 2. overview featur extract object detect algorithm dalal triggs. histogram orient gradient featur vector extract detector window tile grid overlap blocks. detect window scan imag posit scales. finally, combin vector fed linear support vector machin object/non-object classif 3 bodi shape predictor function dlib c++ librari implement method describ [22], ensembl regress tree estim face landmark posit directli spars subset pixel intensities, achiev real-tim perform high qualiti predictions. similarly, train shape model estim bodi landmark locat evalu demonstr algorithm extrapol bodi contour well. directori bodi shape predictor contain train dataset separ test dataset. train dataset consist 4 imag subject 1, subject 2, subject 3; test dataset compris imag before, mirrored. imag annot rectangl bound human bodi 180 landmark bodi shape. object us train data learn identifi posit landmark human bodi new images. shape predictor trained, test previous unseen data, test dataset. 3.1 train study, assum work small train dataset (i) avail landmark dataset 2d human bodi contours, built train dataset hand, (ii) unrealist assum larg dataset hand-mad landmark people. train data load xml file have list imag dataset contain posit bodi detect box landmark (call part xml file) shown figur 4. total 180 landmark distribut hand, close (10 pixel away, approximately), bodi shape predictor trainer effici gener shape model. bodi shape predictor trainer paramet tuned. gener overview train depict figur 5, detail explan refer [22]. default valu computacin y sistemas, vol. 20, no. 1, 2016, pp. 1928 doi: 10.13053/cys-20-1-2365 single-camera automat landmark peopl recognit ensembl regress tree 23 issn 2007-9737 fig. 3. peopl detector results. (a) natur stand pose, detect box tight subject left hand missing. (b) imag (a) final select paramet variables, detect box loos target complet detection. (c) subject stretch spread limbs, detect box abl contain arm left foot. (d) imag (c) final select paramet variables, detect box miss tip subject right hand dlib c++ librari s function experimentation, higher oversampl valu effect boost train set size, small experiments; smaller nu valu reduc capac model explicitli increas regularization; smaller valu tree-depth, reduc model well. information, algorithm gener bodi shape model. gener model valid measur averag distanc (in pixels) bodi landmark obtain shape predictor accord train set, call mean train error. yet, real test li predictor perform unseen data. test recent creat shape model test set landmark mirror imag avoid hand-mark again, obtain mean test error valid exact wai train error counterpart. parametr test bodi shape predictor conduct far. set fig. 4. imag train dataset target bodi contain detect box shape landmark 180 enumer point valu 500 oversampling, nu equal 0.05, tree-depth valu 2, shape predictor take minut train obtain mean train error 9.03275 pixel mean test error 68.8172 pixels. proce stage shape model characteristics, overal method accuraci li mean test error valu reflect result shown section 4. 4 automat landmark detect peopl detector bodi shape model trained, time combin frontal human bodi imag estim pose. pose take form 180 connect landmark describ shape silhouett subject given image. again, pose estim creat dlib c++ librari s implement [22]. new test dataset built 12 remain imag initi 46 provid experimentation, time imag 4 subjects. subject 4 appear train stage peopl detector, includ train shape model. hence, subject 4 complet unseen target automat landmark process, peopl detector stage help overal computacin y sistemas, vol. 20, no. 1, 2016, pp. 1928 doi: 10.13053/cys-20-1-2365 karla trejo, cecilio angulo24 issn 2007-9737 fig. 5. flow chart associ cascad regressor train algorithm kazemi sullivan estim posit facial landmarks. regress function learn gradient tree boost sum squar error loss. core regress function tree-bas regressor fit residu target gradient boost algorithm. split node regress tree, decis base threshold differ intens pixel narrow bodi search area imag influenc shape fit procedure. now, let focu attent automat landmark detect result shown figur 6. frames, subject maintain natur stand pose littl variations. notic (figur 6a) second frame (figur 6b) algorithm abl refin detect better fit actual posit head feet. keep improv frame (figur 6c), algorithm actual manag obtain good estim real locat arm hand subject well. figur 6d algorithm tri catch pose subject partial side step visibl rang webcam, remarkable. experi requir regular stand pose gener object project mean want depend particular flashi pose trigger respons robot, robot notic identifi normal pass by, human notion human presence. however, import imag dataset peopl displai slightli ordinari pose (figur 7b), reveal scope limit fig. 6. automat landmarking. natur stand case subject regular distanc webcam algorithm face type case well. evid rescal distanc issu seen figur 7, algorithm make effort fit spread arm subject figur 7b. probabl similar frame one, algorithm end refin pose estimation. automat landmark experi perform 126 millisecond laptop intel core i5-480m 4gb ram memory. depend imag mean test time. however, computacin y sistemas, vol. 20, no. 1, 2016, pp. 1928 doi: 10.13053/cys-20-1-2365 single-camera automat landmark peopl recognit ensembl regress tree 25 issn 2007-9737 fig. 7. automat landmarking. special pose case subject approxim webcam procedur gener overpass 130 milliseconds, 80 90 millisecond correspond mere peopl detector stage. finally, present set imag figur 8 subject (the unseen subject 4). imag lead problem shape predict train stage peopl detector (figur 8a). final tune paramet achiev better detection. box reach head (figur 8b), good stage, shape predictor start landmark forehead instead. process strateg place 180 landmark train data shape predictor, consid hair unstabl featur major consequ it. thus, landmark start forehead encircl face person, constant human bodi featur implicitly. figur 8c figur 8d present disappoint outcom automat landmarking. real improv respect frame process grow wors estim spread arm instead spread leg shorten them; however, achiev fit left leg. fact regard significantli slower learn unseen bodi shape. subject maintain pose frames, appar fig. 8. difficult case. (a) test output peopl detector. (b) output select valu peopl detector test session. (c) worst automat landmark detect dataset. (d) automat landmark detect better second frame subject seen case help algorithm work easier image. problem appar li subject cloth unseen target fact complet black consider dispar color bodi parts, difficult overcom algorithm. 5 conclus futur work paper shown automat landmark approach human bodi shape carri imag singl camera. demonstr good perform term accuraci comput time. present prac- tical suitabl domest servic robot equip basic technolog resourc econom reason effici purposes. work left do, obtain result promis accomplish establish overal objectives. right adjust eventu achiev necessari perform implement primari stage 2d aam construction, subsequently, peopl recognit tasks. accuraci improv experiment tune shape predictor parameters, feed landmark computacin y sistemas, vol. 20, no. 1, 2016, pp. 1928 doi: 10.13053/cys-20-1-2365 karla trejo, cecilio angulo26 issn 2007-9737 imag train dataset. face detector stage us reduc fit error significantly. real-tim process live video stream webcam certainli immin step look forward to, algorithm clearli possess capabl like better chanc success, enabl peopl track tasks. futur work involv interest contri- bution like develop algorithm: inter-should distance. analogu inter-ocular distanc achiev face align problems, inter-should distanc appropri solut rescal distances. inter-hip distanc reinforc bodi landmark improv upcom results. acknowledg special thank davi king, author open sourc dlib c++ library, will assist commun users. research partial support patricia (tin2012-38416-c03-01) research project, fund spanish ministri economi competitiveness. k.a. trejo acknowledg receiv financi support conacyt grant. refer 1. andriluka, m., roth, s., & schiele, b. (2008). people-tracking-by-detect people-detection- by-tracking. ieee confer vision pattern recognition, pp. 18. 2. ayache, n. & faugeras, o. (1986). hyper: new approach recognit posit two-dimension objects. ieee transact pattern analysi machin intelligence, vol. 8, no. 1, pp. 4454. 3. baker, s., matthews, i., & schneider, j. (2004). automat construct activ appear mod- el imag code problem. ieee transact pattern analysi machin intelligence, vol. 26, no. 10, pp. 13801384. 4. belongie, s., malik, j., & puzicha, j. (2002). shape match object recognit shape contexts. ieee transact pattern analysi machin intelligence, vol. 24, no. 4, pp. 509522. 5. binford, t. (1971). visual percept computer. ieee confer system control. 6. black, m., fleet, d., & yacoob, y. (1998). framework model appear chang imag sequences. ieee intern confer vision, pp. 660667. 7. blank, m., gorelick, l., shechtman, e., irani, m., & basri, r. (2005). action space-tim shapes. ieee intern confer vision, volum 2, pp. 13951402. 8. blanz, v. & vetter, t. (2003). face recognit base fit 3d morphabl model. ieee transact pattern analysi machin intelligence, vol. 25, no. 9, pp. 10631074. 9. cootes, t., edwards, g., & taylor, c. (2001). activ appear models. ieee transact pattern analysi machin intelligence, vol. 23, no. 6, pp. 681685. 10. dalal, n. & triggs, b. (2005). histogram orient gradient human detection. ieee confer vision pattern recognition, volum 1, pp. 886893. 11. dantone, m., gall, j., fanelli, g., & van gool, l. (2012). real-tim facial featur detect condit regress forests. ieee confer vision pattern recognition, pp. 25782585. 12. dantone, m., gall, j., leistner, c., & van gool, l. (2013). human pose estim bodi part depend joint regressors. ieee confer vision pattern recognition, pp. 30413048. 13. dimitrijevic, m., lepetit, v., & fua, p. (2006). human bodi pose detect bayesian spatio-tempor templates. vision imag understanding, vol. 104, pp. 127139. 14. dopfer, a., wang, h.-h., & wang, c.-c. (2014). 3d activ appear model align intens rang data. robot autonom systems, vol. 62, no. 2, pp. 168176. 15. edwards, g., cootes, t., & taylor, c. (1998). face recognit activ appear models. european confer vision, volum 1407 lectur note science. springer berlin heidelberg, pp. 581595. computacin y sistemas, vol. 20, no. 1, 2016, pp. 1928 doi: 10.13053/cys-20-1-2365 single-camera automat landmark peopl recognit ensembl regress tree 27 issn 2007-9737 16. edwards, g., lanitis, a., taylor, c., & cootes, t. (1996). statist model face imag - improv specificity. british machin vision conference, pp. 765774. 17. edwards, g., taylor, c., & cootes, t. (1998). learn identifi track face imag sequences. ieee intern confer auto- matic face gestur recognition, pp. 260265. 18. fanelli, g., dantone, m., & van gool, l. (2013). real time 3d face align random forests-bas activ appear models. ieee intern confer workshop automat face gestur recognition, volum 0, pp. 18. 19. fossati, a., dimitrijevic, m., lepetit, v., & fua, p. (2007). bridg gap detect track 3d monocular video-bas motion capture. ieee confer vision pattern recognition, pp. 18. 20. grimson, e. (1990). object recognit computer: role geometr constraints. mit press, cambridge, ma, usa. 21. hoffman, d. & richards, w. (1983). part recognition. cognition, vol. 18, pp. 6596. 22. kazemi, v. & sullivan, j. (2014). millisecond face align ensembl regress trees. ieee confer vision pattern recognition, pp. 18671874. 23. kobayashi, h. & hara, f. (1993). basic studi dynam recognit human facial expressions. ieee intern workshop robot human communication, volum 11, pp. 271275. 24. lowe, d. (1999). object recognit local scale-invari features. ieee intern confer vision, volum 2, pp. 11501157. 25. marino, k. (2014). real time human pose estim boost random forest pose machines. robot institut summer scholar (riss) work papers, volum 2, carnegi mellon university, pp. 4549. 26. mori, g. & malik, j. (2002). estim human bodi configur shape context matching. european confer vision. lnc 2352, volum 3, pp. 666680. 27. nayar, s., murase, h., & nene, s. (1996). parametr appear representation. earli visual learning. pp. 131160. 28. oikonomopoulos, a., pantic, m., & patras, i. (2009). spars b-spline polynomi descriptor human activ recognition. imag vision computing, vol. 27, no. 12, pp. 18141825. 29. prabhu, u., seshadri, k., & savvides, m. (2012). automat facial landmark track video sequenc kalman filter assist activ shape models. trend topic vision, volum 6553 lectur note science. springer berlin heidelberg, pp. 8699. 30. ramakrishna, v., munoz, d., hebert, m., bagnell, a., & sheikh, y. (2014). pose machines: articul pose estim infer machines. european confer vision. 31. ramanan, d., forsyth, d., & zisserman, a. (2007). track peopl learn appearance. ieee transact pattern analysi machin intelligence, vol. 29, no. 1, pp. 6581. 32. turk, m. & pentland, a. (1991). eigenfac recognition. cognit neuroscience, vol. 3, no. 1, pp. 7186. 33. zhao, w., chellapa, r., phillips, p. j., & rosenfeld, a. (2003). face recognition: literatur survey. acm comput surveys, vol. 35, pp. 399458. 34. zhou, d., petrovska-delacretaz, d., & dorizzi, b. (2009). automat landmark locat combin activ shape model. ieee intern confer biometrics: theory, applications, systems, pp. 17. 35. zucker, s. (1981). vision human perception: essai discoveri constraints. intern joint confer artifici intelligence, volum 2, pp. 11021116. karla trejo ph.d. student automat control, robot vision doctor programm universitat politecnica catalunya - barcelonatech, spain. receiv technic degre 2006 programm analyst universidad colima, mexico, 2011 bachelor degre mechatron system design autom specialti instituto tecnologico colima, mexico. work zona zero - tecnologa informacion, mexico, embed system develop r&d depart 2012, mexican govern conacyt computacin y sistemas, vol. 20, no. 1, 2016, pp. 1928 doi: 10.13053/cys-20-1-2365 karla trejo, cecilio angulo28 issn 2007-9737 grant pursu m.s. degre universitat politecnica catalunya - barcelonatech, spain. student master program automat control robotics, select particip event held rockin eu project increasingli interest vision topics. 2014, karla trejo defend thesi activ appear model peopl recognit rgb-d sensors, receiv m.s. degree. she current extend work research conduct matter doctor studi member knowledg engin research group. cecilio angulo associ professor depart automat control universitat politecnica catalunya - barcelonatech, spain. receiv m.s. degre mathemat univers barcelona, spain, ph.d. degre scienc universitat politecnica catalunya - barcelonatech, spain, 1993 2001, respectively. 2011 serv director master degre automat control robotics. he current director knowledg engin research group, respons research project area robot learning. cecilio angulo author 250 technic publications. research interest includ cognit robotics, machin learn algorithms, vision applications. articl receiv 12/09/2015; accept 19/11/2015. correspond author karla trejo.