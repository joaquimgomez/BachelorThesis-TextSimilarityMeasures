variat multiscal base dissip model estim atmospher see joan baiges,1,2 ramon codina2,1 1 centr internacion de metod numer l  enginyeria ( cimn ) , edifici c1 , campus nord upc c/ gran capita s/n 08034 barcelona , spain 2 universitat politecnica de catalunya , jordi girona 1-3 , edifici c1 , 08034 barcelona , spain *jbaig @ cimne.upc.edu , telf : +0034 934016206 septemb 9 , 2014 abstract work present numer model estim atmospher see observ site .
particular method base variat multiscal turbul model , main featur numer mechan use deal stabil issu ( convect inf-sup condit incompress flow ) also take care model turbul .
base turbul model , develop express viscous thermal dissip , num num , later use evalu constant structur refract index c2n follow classic model develop tatarski .
numer exampl show behavior propos numer scheme appli turbul flow practic case , includ convect boundari layer , flow insid transfer optic room , telescop enclosur .
content 1 introduct 2 2 incompress navier-stok equat 4 2.1 problem statement .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
4 2.2 finit element approxim .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
4 2.3 turbul viscous dissip oss navier-stok equat .
.
.
.
.
.
.
7 2.4 discret time .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
9 2.5 fraction step split .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
9 3 heat transfer equat 10 3.1 problem statement .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
10 3.2 finit element approxim .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
11 3.3 turbul thermal dissip oss heat transfer equat .
.
.
.
.
.
.
.
11 3.4 discret time .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
12 4 atmospher see paramet 12 1 5 numer exampl 14 5.1 convect boundari layer .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
14 5.2 transfer optic coud room .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
18 5.3 flow around telescop enclosur .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
20 6 conclus 23 1 introduct observ univers use ground base telescop facil , effect atmospher turbul qualiti obtain data great import .
especi diamet telescop larg , optic distort due turbul effect becom signific enough prevent observ devic reach maximum theoret resolut .
reason extens effort done sever direct :  develop adapt optic mechan allow correct phase distor- tion effect .
achiev divid main mirror telescop smaller mirror allow sub-mirror move independ , allow obtain correct imag .
approach success appli new generat telescop , number mirror main mirror need compos speed mirror need chang configur direct depend atmospher turbul intens .
 select observ site provid optim atmospher condit .
specif locat around world turn optim observ site .
amongst , canari island spain , hawaii usa atacama desert chile concentr largest telescop world thank pristin see condit .
 design telescop facil minim amount turbul aero- dynam flow around .
minim small eddi oscil air flow around telescop mirror result less optic distort , mean correct done adapt mechan lesser , turn result better acquir imag .
especi true case solar telescop , larg tempera- ture gradient ground surfac due radiat effect critic impact condit collect data .
clear abl evalu suitabl observ site telescop facil design prior telescop construct key get best possibl perform telescop .
also , conveni abl quantifi characterist adapt optic mechan instal telescop beforehand .
due , sever effort devot recent quantif atmospher see paramet numer simul .
one first numer model quantif temperatur structur func- tion present [ 20 ] .
[ 29 , 30 ] atmospher meso-nh numer model use comput atmospher see observ site cerro paran , chile .
soon , methodolog appli simul anoth observ site roqu de los muchacho , canari island , spain [ 31 ] .
[ 7 , 8 , 6 ] larg eddi simul ( les ) model run weather forecast simul softwar use character near-surfac optic tur- bulenc differ climat condit observ site .
see model make 2 use turbul kinet energi provid planetari boundari layer simul softwar use comput see mauna kea , hawaii [ 10 , 9 ] .
[ 22 ] weather forecast model use togeth statist parametr refract index structur constant c2n present [ 35 ] order forecast see condit roqu de los muchacho , canari island , spain .
numer weather predict tool use [ 1 ] comput various turbul paramet allow characteris c2n island maui big island , hawaii , similar methodolog present [ 21 ] .
methodolog common use numer weather predict tool simul see condit , express c2n deriv differ mesoscal turbul model .
[ 13 ] present strategi comput atmospher see paramet , , knowledg , first comput method capabl simul see condit local level ; , use finit element comput fluid dynam simul resolut rang decimet meter instead use mesoscal simul tool coars resolut .
propos model comput refract index structur function c2n base larg eddi simul incompress flow temperatur field , success appli design phase advanc technolog solar telescop ( atst ) [ 28 ] european solar telescop ( est ) [ 3 , 5 ] .
work present model numer simul c2n function comput variat multiscal ( vms ) [ 26 ] base turbul model .
finit element analysi , basic idea vms split unknown finite-el part subgrid scale compon , subscal .
approxim adopt subscal defin numer model .
interest featur vms capabl provid , time , numer stabil mechan studi equat ( case , incompress navier-stok equat ) turbul model take account under-resolv scale ( captur finit element mesh ) .
studi sever work [ 27 , 18 , 14 , 15 , 23 ] success result .
advantag use kind approach interfer numer stabil turbul model issu taken care numer subgrid scale .
method use present work orthogon subgrid scale vms method ( oss ) .
particular model numer subscal rich manner : subscal consid transient time , non-linear , orthogon finit element space .
theoret analysi orthogonal-subscal vms turbul model present [ 24 ] , extens campaign numer experi present [ 19 ] .
conclus experi vms turbul model provid accur represent turbul phenomena competit comput cost , particular featur turbul model aris numer reason .
work use kinet energi thermal turbul dissip aris oss turbul model order quantifi refract index structur function .
paper organ follow .
finit element approxim incompress navier-stok equat present section 2 , variat multiscal method kinet energi turbul dissip also present model problem .
section 3 , finit element approxim heat transfer equat present , togeth oss formul thermal energi turbul dissip express temperatur problem .
section 4 numer model comput see quantiti aris oss dissip present .
allow us comput refract index structur function well optic magnitud interest fri paramet greenwood frequenc .
numer exampl illustr perform propos numer 3 method section 5 .
final , conclus close paper section 6 .
2 incompress navier-stok equat 2.1 problem statement section summar orthogon subgrid-scal ( oss ) approach appli incompress navier-stok equat describ [ 11 ] .
let us consid transient in- compress navier-stok equat , consist find u :   ( 0 , )  r3 p :  ( 0 , )  r : tu 2  su + u  u +p = f  , ( 1 )   u = 0  , ( 2 ) u = u d , ( 3 ) pn + n  u = 0 n .
( 4 ) > 0 , tu local time deriv veloc field su = 12 ( ( u ) +u ) .
  r3 bound domain ,  viscos , f given sourc term .
d dirichlet boundari , veloc boundari condit appli .
case numer simul aerodynam telescop , correspond inflow boundari ground telescop surfac .
n neumann boundari , condit valu traction appli .
aerodynam telescop simul , correspond outflow boundari .
appropri initi condit append problem .
numer exampl section , sourc term f due boussinesq buoyanc forc , appear due temperatur gradient form : f = g (   0 ) ,  thermal expans coeffici , g graviti acceler vector , 0 refer temperatur  temperatur fluid .
2.2 finit element approxim let us consid finit element approxim equat ( 1 ) - ( 4 ) .
defin v = h1 (  ) , v0 = { v  v | v = 0 d } .
let also q = l2 (  ) d ( 0 , ; q ) distribut time valu q .
variat problem consist find [ u , p ]  l2 ( 0 , ; v ) d ( 0 , ; q ) : ( v , tu ) + v , u  u+ 2 ( sv , su )  ( p ,   v ) = v , f v  v0 , ( 5 ) ( q ,   u ) = 0 q  q , ( 6 ) u = u d .
, (  ,  ) stand l2 (  ) inner product  ,  integr product two function , necessarili l2 (  ) .
let us also defin b ( [ v , q ] , [ ; u , p ] ) : = v ,  u+ 2 ( sv , su )  ( p ,   v ) + ( q ,   u ) , 4 repres convect veloc .
galerkin finit element approxim use , well known semilinear form b suffer stabil issu due convect natur flow , also requir compat veloc pressur approxim space due classic lbb inf-sup condit .
mani stabil method develop deal issu past decad .
amongst , one stabil approach receiv interest recent year variat multiscal ( vms ) method .
interest featur vms stabil term deriv pure numer reason , motiv physic point view .
physic approach come introduct decomposit general solut problem interest finit element part part solut captur finit element mesh .
order introduc subscal concept weak form ( 5 ) , let us consid finit element partit th : = { k } defin domain  , h denot element size .
simplifi exposit , consid th quasi-uniform .
partit construct finit element space vh  v , qh  q .
seek approxim solut uh  c1 ( 0 , ; vh ) ph  c0 ( 0 , ; qh ) .
variat multiscal method deriv introduc subscal space veloc field v : v = vh  v .
impli veloc solut field veloc test function also decom- pose finit element part fine scale part : u = uh + u , v = vh + v .
decomposit appli pressur field introduc pressur sub- scale space q , describ [ 12 ] : q = qh  q , p = ph + p , q = qh + q .
also , consid subscal vanish element boundari , although contri- bution element face also taken account , describ [ 17 ] .
introduc split equat ( 5 ) , integr part term , discret variat problem obtain find [ uh , ph ]  vh qh ,  [ 0 , ] u  v , p  q  [ 0 , ] , : ( vh , tuh ) +b ( [ vh , qh ] , [ u ; uh , ph ] ) +  k vh , tuk +  k vh  u  vh qh , uk   k   vh , pk = vh , f , ( 7 )  k v , tuh  uh + u  uh +phk +  k v , tu u + u  u +pk = v , f , ( 8 )  k q ,   uhk +  k q ,   uk = 0 , ( 9 ) 5 test function vh , qh , v , q ,  , k stand integr product two function k. note , incompress flow , 2  su = u .
equat ( 8 ) subscal equat , use provid closur express veloc pressur subscal , u p .
follow step [ 18 ] first consid equat veloc subscal , omit contribut pressur subscal .
allow us formul simpler method , implicit assum veloc subscal due residu momentum equat , instead driven incompress constraint .
second term equat ( 8 ) model follow :  k v , u + u  uk '  1 k v , uk ,  1 k = ( c1  h2 + c2 |u| h ) , ( 10 ) c1 c2 algorithm constant .
approxim subscal oper scalar term time product v , u justifi mean fourier analysi problem subscal [ 12 ] .
replac express equat subscal obtain :  k v , tuh  uh + u  uh +phk +  k v , tuk +  k 1k v , uk = v , f .
( 11 ) equat ( 11 ) yield express subscal element interior term finit element compon , long v approxim space discontinu function : tu +  1 k u = pv ( f  ( tuh  uh + u  uh +ph ) ) , ( 12 ) p v denot project onto subscal space .
equat ( 12 ) implicit defin u function uh , ph : u = u ( uh , ph , ) .
( 13 ) sever possibl choic space subscal , yield differ projec- tion oper p v .
typic choic p v = , result algebra subgrid-scal formul ( asg ) .
formul favor vms model take subscal space orthogon finit element space : v = v h  v , consequ : p v =  ph , ph l 2 (  ) project onto finit element space .
formul call orthogon subgrid scale ( oss ) formul .
usual result sharper , less diffus solut asg method .
provid requir express subscal term finit element un- known .
note equat ( 12 ) involv time deriv veloc subscal .
consequ , subscal need track time time discret scheme requir .
note also veloc convect term u = uh + u , lead non-linear express veloc subscal .
pressur subscal model : p = p ( uh ) : = p 1 k pq (   uh ) , p = c3h 2 , ( 14 ) 6 follow procedur similar one describ veloc subscal equat ( 10 ) .
, q taken orthogon q : q = qh q .
note equat ( 12 ) ( 14 ) need solv numer integr point , sinc subscal need comput ( numer ) integr appear ( 7 ) .
final formul incompress navier-stok equat proven stabl proper choic stabil constant c1 c2 .
equal import , motiv stabil term aris take account contribut part solut captur finit element mesh .
reason mani author [ 27 , 18 , 14 , 15 , 23 ] decid use numer subscal stabil mechan , also model physic undergo spatial tempor resolut finit element mesh .
case navier-stok equat correspond model turbul .
2.3 turbul viscous dissip oss navier-stok equat let us focus numer dissip ( also turbul , attend physic mean subscal ) scheme .
defin kinet energi per unit volum insid comput domain : w : = 1 2 |u|2 .
balanc kinet energi continu problem obtain take test function v equal veloc u , test function q equal pressur p , multipli ( 5 ) ( 6 ) densiti  .
manipul arriv :  t   w +   n  uw = u , f  2 ( su , su ) , ( 15 )  dynam viscos .
equat ( 15 ) say variat kinet energi comput volum  t   w due flux kinet energi domain boundari   n  uw , increment kinet energi due bodi forc u , f ( extern power ) decrement kinet energi due viscous dissip  =  ( u , u ) .
discret counterpart ( 15 ) obtain take vh = uh , qh = ph ( 7 ) :  t   wh +   n  ( uh + u ) wh = uh , f  2 ( suh , suh )   k uh , tuk +  k uh +  ( uh + u )  uh + ph , uk +  k   uh , pk , ( 16 ) : wh : = 1 2 |uh|2 .
term involv subscal right-hand side equat ( 16 ) constitut viscous numer dissip : dnum : =  k  k num 7 num : = uh  tu ( uh +  ( uh + u )  uh + ph )  u   uhp .
( 17 ) hand , dissip due finit element part solut : dh =   h , h : = 2|su|2 .
num appear due contribut stabil term , time , take account dissip due subscal .
order show , let us studi simplifi problem neglect contribut pressur subscal p .
let us also neglect contribut uh ( reason high turbul flow consid , exact linear interpol space chosen uh ) .
furthermor , take account , v  v h  v , :  k uh , tuk = 0 .
let us also defin kinet energi u : w : = 1 2 |u|2 dissip u : d =  k  k  ,  = 1k |u| 2 , extern power uh u : ph : = uh , f , p : = u , f .
let us multipli ( 8 )  take v = u .
case ( 8 ) ( 16 ) :  t   wh +   n  uwh +dh +dnum = ph , ( 18 )  t   w + d dnum = p .
( 19 ) seen equat ( 18 ) - ( 19 ) num charg transfer energi larg ( finit element ) scale subgrid scale .
due , num understood dissip caus turbul effect flow ( see [ 19 , 24 ] ) .
anoth interest observ done plug equat subscal ( 12 ) express num ( 17 ) ( take account orthogon subscal neglect p uh ) : dnum =   k k  p v ( u  uh +ph ) , pv ( u  uh +ph )  k +  k k  p v ( u  uh +ph ) , tu  k .
( 20 ) first term right-hand side ( 20 ) alway posit .
second term appear dynam subgrid scale consid .
shown [ 16 ] local ( space time ) negat , although averag time num prove posit .
local 8 negat valu num repres transfer energi small scale larg scale , phenomenon known backscatt , observ physic turbul flow .
decomposit unknown contribut finit element scale subgrid scale , take account tempor deriv subscal allow oss method model backscatt .
let us stress backscatt model aris numer decomposit unknown physic model phenomena .
see numer exampl section dissip valu averag shown convect boundari layer case .
anoth numer exampl found [ 16 ] .
final , total pointwis dissip account numer larg scale dissip :  = h + num , ( 21 ) go use comput qualiti see estim .
2.4 discret time discret time , reli finit differ time discret .
consid uniform partit [ 0 , ] size t .
denot time depend function f approxim tn = nt fn tf n approxim tf n. introduc notat , time discret problem : find [ uh , ph ]  vh  qh ,  [ 0 , ] u  v , p  q  [ 0 , ] , : ( vh , tu n+1 h ) +b ( [ vh , qh ] , [ u n+1 ; un+1h , p n+1 h ] ) +  k  vh , tu n+1  k +  k  vh  un+1  vh qh , un+1  k   k    vh , pn+1  k =  vh , f n+1  .
( 22 ) order approxim tu n+1 h , second order backward differ scheme use : tu n+1 h = 3 2 un+1h  2u n h + 1 2 un1h t .
hand , first order backward euler scheme use integr subscal time : tu n+1 = un+1  un t .
suffici approxim subscal , sinc : u = ( k ( f  ( tuh  uh + u  uh +ph ) ) , k = ( t ) .
2.5 fraction step split order minim comput time invert solv ( 22 ) , reli fraction step split techniqu .
decompos solut monolith system solut sever simpler problem : convection-diffus equat veloc unknown , pressure- poisson equat project step .
start note , choic v = v h  v :  k  vh , tu n+1  k = 0 .
9 introduc intermedi veloc uh , consid : unh = u n h , un1h = u n1 h , intermedi veloc pressur subscal un+1and pn+1 .
step fraction step method : 1 .
convection-diffus equat .
solv intermedi quantiti un+1h , un+1and pn+1 : ( vh , tu n+1 h ) +b ( [ vh , 0 ] , [ u n+1 ; un+1h , p n h ] ) +  k  vh  un+1  vh , un+1  k   k    vh , pn+1  k =  vh , f n+1  , un+1 solut : un+1 = u ( un+1h , p n h , n+1 ) defin ( 13 ) pn+1 solut : pn+1 = p ( u n+1 h ) , defin ( 14 ) .
2 .
pressur poisson equat .
solv pn+1h u n+1 : ( qh ,   un+1h )   k  qh , un+1  k =  2t 3 (  ( pn+1h  p n h ) , qh ) , un+1 solut : un+1 = u ( un+1h , p n+1 h , ) , ( 23 ) defin ( 13 ) .
tempor integr ( 23 ) , consid un = un .
way intermedi subscal veloc need track time .
3 .
project step : solv un+1h : 3 2t ( vh , u n+1 h  u n+1 h ) + ( vh , ( p n+1 h p n h ) = 0 .
3 heat transfer equat 3.1 problem statement section summar finit element approxim heat transfer equat use oss approach .
let us consid transient heat transfer equat , consist find  :  ( 0 , )  r3 : t + u     = q  ,  =  d , n   = 0 n , ( 24 )  temperatur field ,  thermal diffus q heat sourc term .
initi condit append problem .
10 3.2 finit element approxim let us defin  = h1 (  ) , finit element space defin finit element partit h   .
galerkin finit element approxim equat ( 24 ) consist find h  c1 ( 0 , ; h ) : ( h , th ) + ( h , u  h ) +  ( h , h ) = h , q h  h , ( 25 ) correspond initi boundari condit .
similar navier-stok prob- lem , finit element approxim ( 25 ) suffer instabl problem caus convect term .
stabil requir , physic base numer stabil obtain use vms method .
follow process analog one pre- sent section 2 , subscal model function finit element part temperatur solut field , h : t +  1 k  = p ( q  ( th  h + u  h ) ) , ( 26 ) k = ( c1  h2 + c2 |u| h ) 1 .
c1 c2 algorithm constant , practic coincid c1 c2 equat ( 10 ) .
, sever choic possibl space subgrid scale .
navier-stok equat , advoc use orthogon subgrid scale , , choos space temperatur subscal  :  = h  .
stabil finit element heat transfer problem obtain introduc scale split equat ( 25 ) replac subscal approxim ( 26 ) : ( h , th ) + ( h , u  h ) +  ( h , h ) +  k  h , t  k +  k  h  u  h ,   k = ( h , q ) h  h .
( 27 ) 3.3 turbul thermal dissip oss heat transfer equat done navier-stok equat , deal numerical-turbul dissip oss scheme heat transfer equat .
start defin thermal energi per unit volum comput domain  : h = 1 2 cp 2 , cp heat capac  densiti fluid .
continu thermal energi balanc equat obtain take  =  equat ( 25 ) , multipli equat cp .
manipul , take account incompress u , obtain :  t   h +   n  uh =  , cpq  cp (  ,  ) .
( 28 ) case , variat thermal energi  t   h comput domain due convect flux thermal energi domain boundari   n uh , increment thermal energi caus heat sourc  , cpq decrement thermal energi 11 caus thermal dissip  = cp (  ,  ) .
discret counterpart equat ( 28 ) obtain take h = h equat ( 27 ) :  t   hh +   n  uhh = h , cpq  cp ( h , h )   k  cph , t  k +  k  cph + cpu  h ,   k , ( 29 ) : hh = 1 2 cp 2 h. two last term right-hand side equat ( 29 ) call thermal numer dissip : enum =  k  k num ( 30 ) num = cpht  ( cph + cpu  h )  .
( 31 ) num appear due contribut stabil term , num navier- stoke equat , model contribut dissip due subscal .
consequ , consid model turbul effect flow .
note , contrari model , turbul prandtl number relat turbul viscos turbul thermal diffus requir variat multiscal base turbul model heat transfer equat .
total thermal dissip model :  = h + num ( 32 ) : h = cp|h|2 .
3.4 discret time associ time discret problem : find h  h  [ 0 , ] : ( h , t n+1 h ) + ( h , u n+1  n+1h ) +  ( h , n+1h ) +  k  h , t n+1  k +  k  h  un+1  h , n+1  k = ( h , q ) h  h .
( 33 ) second order backward differ scheme use approxim t n+1 h first order backward euler scheme use approxim subscal deriv respect time , t n+1 .
4 atmospher see paramet section describ paramet quantifi atmospher see facil observ site .
also relat numer approxim describ section 2 3 .
focus especi relat turbul dissip num num appear stabil discret finit element equat due energi transfer non-resolv scale kolmogorov cascad .
12 final optic paramet aim simul numer fri paramet r0 greenwood frequenc fg .
fri paramet essenti adapt optic .
case telescop allow determin number segment segment mirror split , distanc actuat continu deform mirror , prescrib admiss rms distort wavefront [ 2 ] .
design actuat also base call greenwood frequenc , indic fast atmospher chang defin bandwidth servo control adapt optic system ( see [ 33 ] detail ) .
howev , paramet function integr along optic path light beam structur constant cn refract index medium , n ( x , ) .
see [ 13 ] detail descript relationship r0 , fg cn .
structur function relat structur function temperatur , humid joint structur paramet ( see [ 32 ] ) .
howev , consid humid effect neglig .
thus , write temperatur depend n n = n (  ) , cn = dn d c , c structur function temperatur .
assum pressur equilibrium found [ 34 ] cn = 79 106  2 pc , ( 34 ) p assum measur millibar  absolut temperatur .
,  , p u denot solut continu problem defin equat ( 4 ) ( 24 ) overbar denot mean quantiti observ period .
view ( 34 ) , problem comput c .
inerti rang kolmogorov spectrum assum temperatur passiv quantiti , shown ( see [ 33 ] ) c2 = 2m 1/3 , ( 35 ) empir valu call obukhov-corrsin constant ( see [ 25 , 36 ] extens discuss obukhov-corrsin constant valid approxim ) .
( 35 ) , m denot mean molecular thermal diffus dissip m mean molecular dissip kinet energi flow .
paramet given m : = cp||2 , m : = 2|su|2 .
( 36 ) problem close : use ( 36 ) ( 35 ) result back ( 34 ) express comput cn term flow variabl u , p ,  point .
question remain open want numer appli previous approxima- tion c2n c 2  .
first issu , instead work u , p ,  , go work uh , ph , h , model veloc temperatur under-resolv scale u  given equat ( 12 ) ( 26 ) .
first point consid relat averag quantiti u , p ,  , finit element approxim .
end recal filter unknown les model need maintain mean origin variabl .
due close relationship present vms turbul model les filter , assum true also finit element variabl uh , ph , h .
mean consid u  uh , p  ph ,   h .
( 37 ) 13 second point comput averag kinet thermal energi dissip m m .
order make use definit equat ( 21 ) ( 32 ) , comput averag dissip  = h + num ,  = h + num .
( 38 ) assum   m ,   m , , model account proper molecular dissip .
prove particular [ 24 ] simplifi set .
mean dissip approxim molecular dissip general assumpt les model .
use approxim ( 37 ) ( 38 ) ( 35 ) insert result ( 34 ) found : cn = 79 1062h ph a 1/21/6 .
( 39 ) equat ( 39 ) express look .
allow us comput structur function refract index term flow variabl result vms numer simul .
5 numer exampl 5.1 convect boundari layer first numer exampl consist convect boundari layer .
exampl first present [ 8 ] method estim atmospher see use dutch atmospher les method ( dale ) present .
use compar optic pa- ramet obtain use vms base dissip model one obtain use smagorinski base dissip model present [ 13 ] , dissip model base wale subgrid scale model .
simul domain parallelepip whose base squar 10 km side height 2 km .
air flow caus presenc heat flux inferior base ( 0.1 k s1 ) horizont bodi acceler term ( 9.4325105 s2 ) .
boundari condit period later boundari fluid allow trespass superior inferior boundari domain .
also wall law boundari condit [ 4 ] use inferior boundari , caus presenc boundari layer exampl .
initi condit given vertic temperatur gradient set 3 k km1 air rest .
numer simul run 10000 second , time step 1 second .
finit element mesh uniform structur tetrahedra mesh total 1.8 million element .
mesh resolut 150 horizont 150 vertic .
fig .
1 show averag temperatur veloc profil along vertic dimens .
temperatur profil expect increas mean temperatur due heat flux inferior boundari observ .
greater height , temperatur valu get closer initi condit temperatur profil .
regard horizont veloc profil , boundari layer behavior recov larg veloc gradient close floor .
moreov , slight decreas averag veloc observ region temperatur join initi constant vertic gradient ( 1000 height ) .
fig .
2 show snapshot veloc temperatur field end simul .
veloc snapshot allow see hot air ground tend convect due boussinesq forc .
temperatur field , hand , smooth , larg temperatur gradient appear ground heat flux caus bubbl hot air appear .
final fig .
3 show plot dissip valu kinet energi balanc end simul obtain use oss variat multiscal method .
top plot correspond dissip valu comput 14 numer integr point extrapol node element .
element partial white area correspond element dissip numer integr point negat ( dissip extrapol node element negat ) .
bottom plot nodal averag ( lump l2 project ) shown .
nodal averag dissip valu posit everywher .
agreement expect behavior model backscatt , dissip valu local negat ( account transmiss energi small scale larg scale ) , need posit averag space time .
fig .
4 show comparison c2n field obtain use oss base model comput viscous thermal dissip structur constant , smagorin- sky wale model .
observ three model yield qualit similar result : magnitud structur constant c2n larg close ground , larg temperatur gradient exist due thermal heat flux .
first meter , c2n valu start diminish height ( cyan region denot ) , although c2n coeffici magnitud larger region hot air bubbl move ( vertic yellow patch close ground ) .
mid-height region fig .
4 ( correspond height 1000 ) hot bubbl disappear due effect domin horizont flow .
region , increas c2n valu observ .
height 1500 , c 2 n valu diminish .
due non-trespass boundari condit , spurious increas c2n valu observ top wall .
increas appear due fact larg gradient veloc obtain top non-trespass boundari condit , would real open-flow boundari condit ( reproduc numer level ) .
must also note c2n field smoother smagorinski wale model oss model .
probabl caus fact smagorinski wale model dissip base gradient recov field , dissi- pation oss model base compon residu orthogon finit element space , undoubt less smooth .
final , fig .
5 show comparison horizont averag c2n valu end simul , includ result [ 8 ] use dale model .
clear present result result [ 8 ] qualit similar .
howev , increas c2n mid-height occur lower height result [ 8 ] .
largest differ obtain region close ground .
caus fact c2n paramet sensit small variat temperatur gradient .
bottom region present largest temperatur gradient , small deviat comput temperatur gradient caus larg variat obtain c2n valu .
spite , result present good agreement result [ 8 ] , sinc , height ( except bottom region close ground ) , lay within one standard deviat mean distribut result statist collect [ 8 ] .
result allow state c2n valu obtain orthogon subgrid scale model show distribut qualit one obtain physic base les model ( smagorinski , wale dale model [ 8 ] ) .
sinc c2n valu depend turbul dissip model , mean viscous thermal turbul dissip obtain oss method qualit one physic base les model .
remark , express dissip motiv exclus numer argument case oss , contrast physic base argument use deriv les turbul dissip .
15 figur 1 : temperatur ( left ) horizont veloc ( right ) averag profil figur 2 : temperatur k ( top ) veloc ( bottom ) snapshot end simul 16 figur 3 : dissip valu kinet energi balanc : numer integr point ( top ) nodal averag ( bottom ) valu .
figur 4 : c2n snapshot end simul .
top bottom : variat multiscal , smagorinski , wale model .
17 10 18 10 16 10 14 10 12 0 200 400 600 800 1000 1200 cn2 h e ig h ( ) cn2 vs height cn2 smagorinski cn2 vms cn2 wale cn2 cheinetsiebesma cn2 cheinetsiebesma  figur 5 : averag ( horizont ) c2n valu end simul .
comparison result [ 8 ] .
green dot line repres valu lie within one standard deviat statist data collect [ 8 ] .
5.2 transfer optic coud room second exampl correspond transfer optic chamber coud room .
geometri boundari condit case provid astrophys institut canari island design phase european solar telescop ( est ) .
fig .
6 show geometri boundari condit case .
sphere plot repres concentr heat load , consist 300 mm provid heat sourc 2w ( 7.0738 w/m2 ) .
thermal control system consist air plenum blow air ambient temperatur ( 20 c ) , vertic veloc equal 1 m/s , vertic direct top chamber ( plenum area = 22.1 m2 ) .
return air plenum place lower part chamber ( plenum area = 314.16 m2 ) .
object case analyz see degrad transfer optic chamber .
veloc boundari condit later wall heat sphere correspond wall-law condit .
inflow veloc set 1 m/s , outflow veloc left free .
numer simul run 100 second , flow consid complet develop .
time step set 0.2 second .
finit element mesh compos 3.4 million tetrahedra , local refin region close heat sphere ( element size equal 0.03 ) larger element region far ( element size equal 0.3 ) .
fig .
7 show veloc temperatur snapshot flow complet de- velop .
veloc larger central region , inject air flow circul .
heat sphere oppos flow , caus boundari layer appear .
negat effect result see condit .
regard tem- peratur , largest temperatur temperatur gradient found surfac heat sphere , hot air jet found follow path vertic air inflow .
fig .
8 show comparison c2n valu transfer optic room , obtain use 18 figur 6 : geometri transfer optic coud room ( distanc mm ) figur 7 : veloc ( left ) temperatur c ( right ) snapshot transfer optic coud room .
19 oss , smagorinski wale model .
clear model provid similar result case , c2n field less smooth oss case .
5.3 flow around telescop enclosur last exampl simul atmospher see around telescop enclosur .
par- ticular , correspond one tentat design european - extrem larg telescop ( e-elt ) enclosur .
fig .
9 show geometri enclosur .
object simul evalu effect frontal wind shield atmospher see .
enclosur 4 meter size window facilit natur ventil build .
enclosur diamet 85 , maximum height 79 m. extern domain simul 600  600  1500 m3 box .
finit element mesh compos 3.3 million tetrahedra , element size rang 1 ( close telescop ) 20 ( open flow region ) .
wall-law veloc boundari condit [ 4 ] set ground build surfac , non-trespass boundari condit set later wall bound box .
inflow veloc set 1 m/s .
regard temperatur boundari condit , impos follow express temperatur function height :  = 12 0.7 ln ( z + 0.01 0.02 ) height z express meter result temperatur express c .
initi temperatur profil depict fig .
10 .
fig .
11 show veloc temperatur field cut along stream-wis direct flow fulli develop .
turbul vortex appear behind telescop , largest veloc gradient occur surfac telescop .
maximum absolut valu veloc appear flow detach telescop enclosur , low-spe recircul zone observ leeward telescop .
regard temperatur field , maximum temperatur temperatur gradient found surfac telescop .
interior telescop show larger temperatur compar exterior domain , despit larg ventil window put place order minim temperatur gradient .
intermedi temperatur valu also found recircul area behind telescop .
fig .
12 show comparison c2n profil obtain use oss , smagorinski wale dissip model .
previous case , maximum valu c2n paramet found region veloc temperatur gradient larger , coincid terrain ground , telescop enclosur surfac area detach flow occur .
low speed recircul zone behind telescop also show larg valu c2n paramet , due larg temperatur gradient .
compar result various model , result qualit equival , result smoother smagorinski wale model .
let us say agreement remark take account expres- sion calcul dissip motiv physic argument case les model , contrari , numer argument case oss variat multiscal method .
20 figur 8 : c2n snapshot coud room .
variat multiscal ( top left ) , smagorinski ( top right ) wale ( bottom ) model .
21 figur 9 : extern geometri e-elt enclosur .
front , top perspect view .
4 5 6 7 8 9 10 11 12 0 100 200 300 400 500 600 ( c ) h e ig h ( ) figur 10 : temperatur inflow boundari condit function height 22 figur 11 : veloc temperatur field flow around telescop enclosur 6 conclus work present numer model estim atmospher see observ site .
main featur propos model base numer dissip aris particular version variat multiscal method , orthogon subgrid scale method .
advantag use kind model reli fact , decompos field interest coars fine scale , abl deal simultan sourc numer instabl model turbul effect .
present work summar properti variat multiscal method , base model numer subscal complet possibl manner : subscal consid transient time , non-linear , orthogon finit element space .
lead resolut numer stabil issu ( advect use arbitrari interpol veloc pressur ) , also rich represent turbul phenomena .
base turbul model , develop express viscous thermal dissip , num num , use evalu constant structur refract index c2n follow classic model develop tatarski .
numer exampl section test perform method three practic case , name convect boundari layer , flow insid transfer optic room , flow around telescop enclosur .
three case compar model result obtain use smagorinski wale model evalu viscous thermal dissip , , convect boundari layer case , result present [ 8 ] .
numer exampl show method capabl accur estim c2n coeffici .
fact provid us new numer tool 23 figur 12 : c2n field flow around telescop enclosur .
top bottom : variat multiscal , smagorinski wale model .
24 evalu atmospher see also add argument favor viabil implicit les method reli numer stabil mechan model turbul .
acknowledg work partial support european research council solarnet re- search network fp7 - 312495 , partial support ministerio de economa competitividad spanish govern plan nacion de investigacion 2012 : aya2012-33490 .
joan baig grate acknowledg support receiv micinn spanish govern  juan de la cierva  postdoctor grant .
ramon codina grate acknowledg support receiv catalan govern icrea academia research program .
refer [ 1 ] r.j. alliss b.d .
felton .
valid optic turbul simul numer weather predict model support adapt optic design .
advanc maui optic space surveil- lanc technolog confer , volum 1 , page 54 , 2009 .
[ 2 ] j.m .
becker .
adapt optic astronomi : principl , perfom applic .
annual review astronomi astrophys , 1993 .
[ 3 ] fcm bettonvil , r codina , rh hammerschlag , apl jager , jnm kommer , sj van leverink , g sliepen , visser .
enclosur european solar telescop ( est ) .
spie as- tronom telescop instrument : observ frontier astronomi new decad , page 773333773333 .
intern societi optic photon , 2010 .
[ 4 ] peter bradshaw georg p huang .
law wall turbul flow .
proceed royal societi london .
seri : mathemat physic scienc , 451 ( 1941 ) :165188 , 1995 .
[ 5 ] l caval , collado , j castro .
perform simul conceptu design european solar telescop ( est ) .
proc .
spie vol , volum 8336 , page 83360g1 , 2011 .
[ 6 ] s. cheinet , a. beljaar , k. weiss-wrana , y. hurtaud .
use weather forecast charac- teris near-surfac optic turbul .
boundary-lay meteorolog , 138:453473 , 2011 .
[ 7 ] s. cheinet a. p. siebesma .
impact boundari layer turbul optic propag .
optic atmospher propag adapt system x. proc .
spie vol .
6747 , page 112 , 2007 .
[ 8 ] s. cheinet a. p. siebesma .
variabl local structur paramet convect boundari layer .
j. atmo .
sci. , 66:10021017 , 2009 .
[ 9 ] t. cherubini s. busing .
oper perspect model optic turbul , see clear : impact atmospher turbul propag extraterrestri radiat , t. cherubini s. busing ( ed . ) .
vbw publish , 2010 .
[ 10 ] t. cherubini , s. busing , r. lyman .
model optic turbul see mauna kea : verif algorithm refin .
j. appl .
meteor .
climatol. , 47:30333043 , 2008 .
[ 11 ] r. codina .
stabil finit element method general stationari incompress flow .
comput method appli mechan engin , 190:26812706 , 2001 .
[ 12 ] r. codina .
stabil finit element approxim transient incompress flow use orthog- onal subscal .
comput method appli mechan engin , 191:42954321 , 2002 .
[ 13 ] r. codina , j. baig , d. perez-sanchez , m. collado .
numer strategi comput optic paramet turbul flow : applic telescop .
comput & fluid , 39 ( 1 ) :87  98 , 2010 .
25 [ 14 ] r. codina j. princip .
dynam subscal finit element approxim thermal coupl incompress flow .
intern journal numer method fluid , 54:707730 , 2007 .
[ 15 ] r. codina , j. princip , m. avila .
finit element approxim turbul thermal coupl incompress flow numer sub-grid scale model .
intern journal numer method heat & fluid flow , 20 ( 5 ) :492516 , 2010 .
[ 16 ] r. codina , j. princip , s. badia .
dissip structur long term behavior finit element approxim incompress flow numer subgrid scale model .
multiscal method comput mechan , page 7593 .
springer , 2011 .
[ 17 ] r. codina , j. princip , j. baig .
subscal element boundari variat two- scale finit element method .
comput method appli mechan engin , 198:838 852 , 2009 .
[ 18 ] r. codina , j. princip , o. guasch , s. badia .
time depend subscal stabil finit element approxim incompress flow problem .
comput method appli mechan engin , 196:24132430 , 2007 .
[ 19 ] o. colom , s. badia , r. codina , j. princip .
assess variat multiscal model larg eddi simul turbul incompress flow .
submit .
[ 20 ] a.f .
de baa m. sarazin .
temperatur structur fuction complex terrain .
eighth symposium turbul shear flows. , page 16 , munich septemb 9-11 , 1991 .
[ 21 ] r. frehlich , r. sharman , f. vandenbergh , w. yu , y. liu , j. knievel , g. jumper .
estim cn2 numer weather predict model output comparison thermosond data .
journal appli meteorolog climatolog , 49 ( 8 ) :17421755 , 2010 .
[ 22 ] c giordano , j vernin , h vazquez ramio , c munoz-tunon , varela , h trinquet .
atmo- spheric see forecast : wrf model valid situ measur orm .
month notic royal astronom societi , 430 ( 4 ) :31023111 , 2013 .
[ 23 ] v. gravemei .
variat mulstiscal method laminar turbul flow .
archiv comput mechanicsst art review , 13:249324 , 2006 .
[ 24 ] o. guasch r. codina .
statist behavior orthogon subgrid scale stabil term finit element larg eddi simul turbul flow .
comput method appli mechan engin , 261:154166 , 2013 .
[ 25 ] r.j. hill .
structur function spectra scalar quantiti inertial-convect viscous- convect rang turbul .
journal atmospher scienc , 46:22452251 , 1989 .
[ 26 ] t.j.r .
hugh , g.r .
feijoo , l. mazzei , j.b. quinci .
variat multiscal methoda paradigm comput mechan .
comput method appli mechan engin , 166:324 , 1998 .
[ 27 ] t.j.r .
hugh , l. mazzei , k.e .
jansen .
larg eddi simul variat multiscal method .
comput visual scienc , 3:4759 , 2000 .
[ 28 ] s.l .
keil , t.r .
rimmel , j. wagner .
advanc technolog solar telescop .
earth , moon , planet , 104 ( 1-4 ) :7782 , 2009 .
[ 29 ] e. masciadri , j. vernin , p. bougeault .
3d map optic turbul use atmospher numer model .
part i. astron .
astrophi .
suppl .
ser. , 137:185202 , 1999 .
[ 30 ] e. masciadri , j. vernin , p. bougeault .
3d map optic turbul use atmospher numer model .
part ii .
astron .
astrophi .
suppl .
ser. , 137:203216 , 1999 .
[ 31 ] e. masciadri , j. vernin , p. bougeault .
3d numer simul optic turbul roqu de los muchacho observatori use atmospher model meso-nh .
astronomi & astrophys , 365:699708 , 2001 .
26 [ 32 ] l.j .
peltier j.c. wyngaard .
structur function paramet convect boundari layer larg eddi simul .
journal atmospher scienc , 52:36413660 , 1995 .
[ 33 ] f. roddier .
adapt optic astronomi .
cambridg univers press , 2004 .
[ 34 ] v.i .
tatarski .
wave propag turbul medium .
dover public , inc , 1961 .
[ 35 ] h. trinquet j. vernin .
statist model forecast profil index structur constant .
environ fluid mech , 7:397407 , 2007 .
[ 36 ] l.p. wang , s. chen , j.g .
brasseur .
examin hypothesi kolmogorov refin turbul theori high resolut simul .
part 2 .
passiv scalar field .
journal fluid mechan , 400:163197 , 1999 .
27
