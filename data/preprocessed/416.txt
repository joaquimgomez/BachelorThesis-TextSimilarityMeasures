adapt fixed-mesh al method free surfac flow joan baiges,1,2, ramon codina2,1, arnau pont2,1 ernesto castillo 3 1 centr internacion metod numer lenginyeria (cimne), edifici c1, campu nord upc c/ gran capita s/n 08034 barcelona, spain 2 universitat politecnica catalunya, jordi girona 1-3, edifici c1, 08034 barcelona, spain 3 universidad santiago chile, usach. av. bernardo ohiggin 3363, santiago chile, chile septemb 23, 2016 abstract work present fixed-mesh al method numer simul free sur- face flow capabl adapt finit element mesh cover background domain. mesh success refin unrefin time step order focu comput effort spatial region required. main ingredi formul us arbitrary-lagrangian-eulerian formul comput tempor derivatives, us stabil term stabil convection, stabil lack compat be- tween veloc pressur interpol spaces, stabil ill-condit introduc cut background finit element mesh, coupl algorithm adapt mesh refin procedur suitabl run distribut memori environments. algorithm step project mesh present algebra fraction step approach improv condit number linear system solved. method test numer examples. expect converg rate space time observed. smooth solut field veloc pressur obtain (a result contribut stabil terms). finally, good agreement numer result refer experiment data obtained. 1 introduct numer simul physic phenomena time face need simulat- ing problem physic domain evolv time. case instanc numer simul structur problem involv larg deformations, multifluid flow problem problem involv free surface, others. main issu case decid tackl movement. comput physic mesh used, instanc finit element simulations, mesh cover physic domain requir (other possibl requir comput mesh exist meshless method [56] spectral method [25], common day-to-dai engin practice). comput mesh need deal displac physic domain. cases, mesh adapt shape domain lagrangian formul [17] account larg displac geometr non-linearities, arbitrari lagrangian-eulerian (ale) formul [38]. solid dynam problem fluid-structur interact problem solid bodi subject larg deform anchor point [62], simul approach methods. cases, however, domain displace- 1 ment deform larg imposs mesh adapt shape new configur suffer element distort element folding. methodolog devis address situation. straightforward approach consist in, excess mesh deform reached, comput new mesh cover deform configur domain project result deform mesh new mesh [5, 37, 54]. however, step requir us extern softwar mesh deform domain, oper difficult perform simul run parallel environment. moreover, problem undergo larg quick deform step requir repeat time overal simul expens term comput time. altern approach remesh strategi instanc us meshless method requir comput mesh reli instead approxim space overlap function physic space [56]. particl finit element method [58] contrary, adopt pure lagrangian framework node finit element mesh track time. node kept simulation, element destroi regener time step deform large. approach (and work focused) known embed fix mesh methods. fix mesh method boundari physic domain need match boundari mesh. case boundari condit need appli bound- ari immersed, variat finit element equat physic mean mesh occupi physic domain. famili fix mesh method classifi precis depending, firstly, wai method deal imposit boundari conditions, secondly, wai deal time space integr fix mesh [55]. imposit dirichlet boundari conditions, approach exist us penalti term origin immers boundari method [50, 59], us lagrang multipli [15, 42, 43, 13, 33, 20, 16, 3] requir us addit unknown account flux dirichlet boundary, well-known nitsch method [57, 47, 44, 23], yield symmetric, stabl variat formul us limit penalti term valu need estimated. wai time space integr performed, approach adopt well. origin immers boundari method [59] fictiti domain method [43], comput mesh cover physic domain consid be, comput was, materi physic domain. approach conveni advantag properti deal fluid-structur interact problem partit approach face call added-mass effect [41, 9, 8, 21, 32], introduc error fact tempor deriv node close boundari comput veloc valu non-physical, meaningless domain. case approach like on present [61, 52, 51], kind approxim need order comput time deriv close interface. order cope issue, fixed-mesh al method [34] develop object accur comput tempor deriv node close boundari al strategi follow project step origin background mesh. methodolog isogeometr analysi appli problem free surfac flow recent (see [2, 4]). paper present extens fixed-mesh al method adapt framework simul free surfac flows. fixed-mesh al method [45] simul lost foam cast [35] applic free surfac flows. gener formu- lation detail implement ingredi like imposit dirichlet boundari condit immers boundari lagrang multipli strategi perform interpol restrict [34], extens fluid-structur interact [11, 12]. recently, fixed-mesh al method [60] context rigid bodies-fluid 2 interact parallel setting. here, extend method coupl ingredi allow us adapt setting. firstly, fixed-mesh al method adapt refin librari refficientlib [10], make method capabl run distribut memori parallel system handl mesh hang nodes. complement refin criteria forc mesh improv accuraci region close free surfac interface. secondly, stabil properti finit element formul enhanc geometri- cal configur free surfac cut mesh ill-condit manner. this, reli ghost stabil term [19] ensur that, independ geometri mesh free surface, result equat stabl good condit number. orthogon project involv type non-consist stabil terms, reli l2 project evalu non-linear iter order optim sparsiti pattern linear matrix. finally, split scheme navier-stok equat allow separ solut momentum pressur equations. split scheme common previou works, applic free surfac problem particular- iti highlight here. particular, type split scheme incompress navier-stok equat considered, pressur poisson equat base fraction step method pure algebra fraction step method. cases, specif term stabiliza- tion ill-condit cut finit element mesh considered. paper organ follows. section 2 fixed-mesh al formul presented. emphasi finit element formulation, tempor discretization, comput tempo- ral deriv track free surfac interfac level set method. section 3, algorithm detail project step mesh fixed-mesh al method ex- plained, particular applic parallel adapt set detailed. section 4, differ approach solut equat aris incompress- ibl navier-stok equat applic solut free surfac flow presented. section focu center requir addit stabil term solv free sur- face problem requir ingredi imposit dirichlet boundari condit pressur poisson equation. section 5, adapt approach fixed-mesh al method described. adapt algorithm, refin criteria implement explained. numer exampl illustr perform method present section 6, conclus close work section 7. 2 fixed-mesh al formul section summar fixed-mesh al formul new numer ingredi requir order obtain stabl accur solut adapt refin finit element method free surfac problems. summari split parts, cover main ingredi method: stabil finit element formulation, al mesh movement definition, level set function track project step. 2.1 physic set let defin background domain 0 rd d = 2,3 indic space dimensions. domain occupi fluid time interv [0,t ], denot (t) 0 effect occupi fluid time instant t [0,t ]. move boundari (t) call free surface, repres free(t) = (t) \( 0(t) ) . movement fluid time evolut free surfac caus fluid 3 domain (t) chang time, associ movement defin al domain veloc uuudom(xxx, t)rd , xxx 0 spatial coordinates. order let defin biject map point xxx (0) time instant t return point xxx = (xxx , t) (t). domain veloc defin uuudom(xxx, t) = (xxx , t) t . fixed-mesh al method, domain veloc coincid gener veloc fluid (t). fact, compon veloc free orthogon free surfac normal compon veloc boundari 0, 0, need coincid veloc fluid uuu(xxx, t) rd : nnn uuudom = nnn uuu free0, (1) nnn denot outward point normal free 0 uuu fluid velocity. rest 0 domain veloc defin spatial discret introduc wai biject natur (t) respect comput cost mesh distort minimized. defin al local tempor deriv function f f t = f ((xxx , t), t) t . take definit account, incompress navier-stok equat al frame refer written as: uuu t + (uuuuuudom) uuu ( 2suuu ) +p = fff , uuu = 0, fluid density, viscosity, p pressure, f vector bodi forc su symmetr u. boundari initi condit need provid problem. defin fluid stress = 2suuu piii, iii ident tensor. usual boundari condit subdivid neumann dirichlet boundari conditions: uuu = uuu d, nnn = hhh n , d dirichlet boundari n neumann boundary. simplifi exposit uuu = 000. consid free surfac flows, effect fluid outsid (t) neglected. also, effect surfac tension neglected, reason assumpt given dimens fluid properti engin problem interest in. case effect surfac tension negligible, taken account ad corre- spond boundari forc terms. consequence, boundari condit enforc free surfac is: nnn = 000 free. 4 figur 1: background domain 0 , fix background mesh. domain cover fluid (t) (in blue) evolv time. free surfac boundari free cut element mesh arbitrari manner. introduc need integr finit element equat region cover (t) elements, lead subintegration. 2.2 variat form let consid v = { v h1((t))d |v = 0 d } q = l2((t)). let l2(0,t ;v ) set function vnorm space l2 time d (0,t ;q) set function qnorm space distribut time. let defin forms: b([vvv,q] , [aaa;uuu, p]) : = vvv,aaa uuu+2 ( svvv,suuu ) (p, vvv)+(q, uuu) l([vvv,q]) : = vvv, fff + vvv,hhh n , aaa = uuuuuudom advect velocity. here, (, ) stand l2((t)) inner product, , integr (t) product functions, necessarili l2((t)), , n integr n product functions. weak form problem consist find [uuu, p] l2(0,t ;v )d (0,t ;q) that: ( vvv, uuu t ) +b([vvv,q] , [aaa;uuu, p]) = l([vvv,q]) vvv v,q q. (2) appropri initi condit need ad variat form. 2.3 finit element approxim order approxim problem (2) numer aim us finit element method back- ground mesh boundari necessarili match boundari (t). background mesh cover 0 cartesian gener unstructur gener purpos mesh gen- erators. note integr variat form (2) extend (t), subintegr need perform element cut fluid free surfac free. illustr fig. 1. let introduc finit element partit th := {k} defin domain 0, h denot element size. partit finit element space vhv qhq constructed. straightforward introduct finit element space equat (2) lead unstabl solut incompress navier-stok equat follow causes: instabl caus convect term, lead oscil solut cell reynold number large. requir compat condit veloc pressur approxima- tion space lbb [18] inf-sup condition. 5 ill-condit unstabl behavior caus subintegr element cut free surfac free. order overcom instabilities, stabil term need ad variat form (2). stabil term us classifi differ groups, fact similar share stabil mechanism. group stabil term correspond split orthogon subgrid scale stabiliza- tion (split-oss) present [30]. term allow avoid stabil problem convect term velocity-pressur inf-sup condit deriv variat multiscal framework [46]. form following: soss ([vvvh,qh] , [aaah;uuuh, ph])= k k aaah vvvh, pv (aaah uuuh) k((t))+ k k qh, pq (ph fff ) k((t)) . , k((t)) denot integr element k mesh element cover (t). stabil paramet k defin element level as: k = ( c1 h2 + c2 |aaah| h )1 , c1 c2 algorithm constant formul (see instanc [28, 29] sta- biliz formul incompress flow derived). c1 = 4 c2 = 2 numer examples. pv pq denot project space orthogon vh qh respectively, comput as: pv (aaah uuuh) = aaah uuuhpvh(aaah uuuh), pq (ph fff ) = (ph fff )pqh (ph fff ) , pvh certain project interpol oper vh pqh certain project interpol oper qh. note ad stabil term consistent, residu based. consist error decreas fast element size h thank approxim properti projector pvh pqh , final rate converg propos finit element method affect lack consist (see [30]). also, import remark integr stabil term extend (t). project oper result stabl formulation. formul opt l2 projection, involv solut equat involv mass matrix. numer examples, linear element used, opt lump mass matrix projection, yield easi invert project matrix, and, importantly, affect ill-condit cut fulfil discret maximum principle. second group stabil term charg avoid unstabl behavior caus subintegr element cut free. instabl ill-condit appear free surfac cut element close interior fluid node far awai extern nodes. caus contribut element integr extern node small compar contribut nodes, instabl appear. illustr fig. 2. solut issu propos [19] gener finit element problem call ghost penalti stabilization. main featur method allow add stabil term ensur control given field cut element harm converg rate method, ad penalti term consistent. consist error ghost term depend differ consid field interpol given projector: projector chosen wisely, consist error decreas mesh size wai converg method affected. [39] [19] detail elabor properti interpol ghost-penalti method. applic 6 figur 2: left: free surfac cut caus ill-condit final linear equations. right: definit domain cut(t) (in orange) integr ghost penalti stabil terms. ghost-penalti method flow problem [22, 24, 61]. work appli idea ghost penalti method incompress navier-stok equat context adapt fixed-mesh al method. stabil term add similar on stabil convect inf-sup condition, main differ integr extend (t) cut(t), compos region occupi element cut free layer neighbor element insid fluid. definit cut(t) illustr fig. 2. definit ghost penalti stabil term following: sghost ([vvvh,qh] , [aaah;uuuh, ph]) = k 1k vvvh, pvcut (uuuh) k(cut(t)) + k 2k qh, pqcut (ph fff ) k(cut(t)) , orthogon project cut element defin as: pvcut (uuuh) = uuuhpvh,cut(uuuh), pqcut (ph fff ) = ph fff pqh,cut (ph fff ) . note integr calcul project oper pvh,cut pqh,cut span cut(t) domain. previou cases, formul opt l2 project oper pvh,cut pqh,cut . again, lump mass matrix projector projector numer examples, linear element used. stabil paramet 1k 2k defin elementwis follows: 1k = c3h 2 1 k , 2k = c4k . seen defin function split-oss stabil parameter. ideally, c3 = 1 c4 = 1, practic case differ valu requir order obtain stabl solution. numer exampl present work, c3 = 0.5 c4 = 0.5 chosen, valu provid best numer results. finally, stabil formul incompress navier-stok equat back- 7 ground non-boundary-match mesh obtain follows: [uuuh, ph] ( vvvh, uuuh t ) +b([vvvh,qh] , [aaah;uuuh, ph]) +soss ([vvvh,qh] , [aaah;uuuh, ph])+sghost ([vvvh,qh] , [aaah;uuuh, ph]) = l([vvvh,qh]) vvvh vh,qh qh. (3) 2.4 tempor discret tempor discret reli simpl differenc schemes. consid uniform partit [0,t ] n time interv lengh t. veloc field time step n+ 1 denot uuun+1, discret time deriv denot tuuun+1. consid us second order backward differenc scheme, deriv comput as: tuuu n+1 = 3 2 uuu n+12uuun + 12 uuu n1 t . let suppos given comput domain time tn spatial coordin n, uuun pn known domain. veloc tn+1 obtain solut to: ( vvvh, tuuu n+1 h ) +b ( [vvvh,qh] , [ aaan+1h ;uuu n+1 h , p n+1 h ]) +soss ( [vvvh,qh] , [ aaan+1h ;uuu n+1 h , p n+1 h ]) +sghost ( [vvvh,qh] , [ aaan+1h ;uuu n+1 h , p n+1 h ]) = l([vvvh,qh]) vvvh vh,qh qh. (4) 2.5 finit element solut 0\(t) equat (4) provid final variat form solut uuuh ph (t). however, need valu unknown 0\(t), principl equat defin far solut problem unknown region. principl solut need region, conveni kind smooth extens ensur numer oscil sharp gradient artifici introduc algorithm. unknown us harmon extens (t) region 0\(t) region. veloc harmon extens uuu solving, time step: uuu = 0 (t), uuu = uuu (t). (t) repres domain limit layer node belong element cover (at partially) (t), (t), fig. 3. note dirichlet boundari condit problem enforc exactli (t) form extern face elements. similarly, harmon extens p solving, time step: p = 0 (t), p = p (t). denot uuuh p h standard finit element approxim uuu p, respectively. note tempor deriv solv harmon extensions. 8 figur 3: definit (t) (t) (in green) harmon extens uuuh ph 0\(t). 2.6 al mesh movement arbitrary-lagrangian-eulerian mesh movement possibl defin mesh veloc exist. essenti requisit mesh movement area mesh cover (tn) tn deform wai cover ( tn+1 ) tn+1. translat boundari condit compon mesh veloc normal extern boundaries, seen equat (1). movement rest domain, smooth extens mesh displac boundari need obtained. method exist minim element distortion, solv elast problem element vari stiff coefficients, laplac problems. case opt choice, result good geometri deform mesh. problem need solv interior 0 then: uuudom = 0 0, nnn uuudom = nnn uuu free0. problem solv finit element approximation. variat form problem principl standard, applic dirichlet boundari condit need account free immers 0 cut element mesh arbitrari manner. 0 boundary, contrary, dirichlet boundari condit easili applied, node mesh domain boundary. order enforc mesh veloc free reli symmetr method enforc boundari condit embed grid present [13] extend analyz [33, 49], understood link lagrang multipli method. method relat nitsch method, main advantag respect classic method requir estim valu penalti parameter, ensur result stabl respect imposit boundari conditions. let consid interpol space approxim mesh ve- lociti uuudom fluid veloc uuu. poisson problem comput smooth mesh veloc field domain interior, final variat form problem includ term enforc boundari condit free is: tn, uuuh,dom vh that: (vvvh,uuuh,dom)0 + vvvh,nnn ph (uuuh,dom)fre = vvvh,nnn ph (uuuh)fre vvvh vh, (5) p (uuuh,dom) tensor defin element cut free. obtain vol- 9 ume/boundari project uuuh,dom elementwis discontinu stress space h: 1 2 (h,p (uuuh,dom))fre = nnn h,uuuh,domfre h h, (6) free domain occupi element cut free (includ element insid (t) outsid it). stress space h usual taken order interpol lower space veloc vh, equal order interpol possible. equat (5) (6) coupl need solv simultaneously. however, take account h function elementwis discontinu extend singl element, express project comput element level condens prior matrix assembly. main featur method guarante stabil need penalti parameter. [13] detail descript method properties. 2.7 fixed-mesh al equat (4) provid stabil finit element formul incompress navier-stok equat al framework non-boundary-match mesh. however, addit ingredi- ent need introduc order deal simul comput domain under- goe larg deformations. cases, (t) chang shape greatli time evolves, mesh distort fold elements. solut issu classic al method build new mesh good element geometr properti configur time t proce project step distort mesh new mesh. however, build new mesh computation expens requir stop simul order mesh generator. main advantag fixed-mesh al method mesh need match boundari physic domain, origin undistort mesh cover 0 new mesh element distort large. algorithm step fixed-mesh al method following: simul start origin background mesh m (0) cover background domain 0, integr correspond equat (t), harmon extens equat (t). advanc time step, domain (t) changes. origin mesh m (0) need deform follow al strategy: mesh movement free follow normal veloc particles, point 0 mesh movement. mesh time instant t, m (t) obtain deform m (0) follow al mesh movement criteria. step time step (both choic possible), remesh step per- formed, consist project result m (t) m (0). this, redefin m (t)m (0) continu simulation. previou work fixed-mesh ale, number step project m (t) m (0) limit one, mean time step result project back- ground mesh call virtual mesh deformation. allow al mesh move- ment limit layer element surround free, mesh distort accumul time. work, contrary, open possibl allow formul deform mesh time step project origin background mesh. 2.8 level set function track boundari defin free surface, free, reli classic level set method. main featur level set method allow sharp track free 10 surfac free result accur definit fluid domain time t, (t). level set function defin wai that, time instant t: (t) = 0 free, (t)> 0 (t), (t)< 0 0\(t). import remark, solut level set problem adapt mesh. 2.8.1 initi strategi exist initi level set function. reli compu- tation posit (in fluid part) neg (in domain outsid (t)) distanc function free. however, approach reli search strategi expen- sive implement properli environment, enforc restrict || = 1, non-linear restrict need solv iteratively. approach initi reli distanc function, instead solv follow diffusion-react problem (see [12, 26] detail strategy): + s = g 0, (7) = 0 free, (8) nnn = 0 0, (9) nnn extern normal boundari 0, sourc term g defin as: g = 1 (t), g =1 0\(t), s reactiv term typic s = 1, valu possible. ensur smooth function accur track free surface. note condit (8) enforc gradient direct extern boundari normal null, element cut free, essenti boundari condit prevails. approach yield smooth initi field, main object pursue. again, equat solv finit element approach. dirichlet boundari condit (8) embed mesh, linked-lagrang multipli method [13] enforc boundari condition. let defin finit element space level set function h h1 () . variat problem solv initi level set function is: h h that: (h,h)0 + h,nnn ph (h)free = h,g0 h h, h correspond elementwis discontinu space level set stress ph project oper defin equat (6). result smooth initi level set field defin (t) domain. [13] detail linked-lagrang multipli method. time step simul level set function loos smooth difficult advect. case, call reiniti step required. this, reli algorithm us initi level set function. 2.8.2 transport level set function need evolv time (t) = 0 free(t). arbitrary-lagrangian eulerian methods, solv advect level set function fluid veloc (t) advect velocity: t +aaah = 0, (10) 11 advect veloc defin aaah = uuuh uuuh,dom. method pure eulerian, aaah = uuuh, method lagrangian free , aaah = 000 free equat (10) need solv (the rel posit free respect node mesh change). case fixed-mesh al method need distinguish cases: case correspond situat time step al simul comput result project deform background mesh. case, equat (10) solved, nodal valu level set function chang simul project background mesh performed. second case correspond situat result project fix background mesh time step. case opt follow options: solv equat (10), project level set function end time step mesh deformed. solv equat (10) aaah = uuuh avoid project step comput level set function. case opt second option, observ result smoother level set field long term. finit element solut equat (10), reli strategi similar appli navier-stok equations, particular convect need stabilized. 2.8.3 mass correct advect level set function guarante mass simul volum time step solv conserved. practic cases, usual result small mass lost time step. hundr thousand time step mass loss cumul repres signific fraction total volume. order avoid introduc mass loss correct scheme ensur total mass conserv time step. mechan consist comput mass lost end time step move level set function uniform manner direct orthogon free surfac order correct mass loss. mechan work global sense, ensur mass conserv local level. sfree area (length dimensions) free surface, vlost lost volum 0(t) level set function solut field prior mass correction, then: (t) = 0(t)+ vlost sfree pfree (nnn 0(t)) , follow definit pfree (nnn 0(t)) h(free) :( h,pfree (nnn 0(t)) ) free = h,nnn 0(t)free h h(free), free(t) defin region domain occupi element cut free(t). 3 algorithm strategi project step let start section remark method propos work implement distribut memori parallel platform. algorithm parallel achiev comput partit finit element mesh graph partit algorithms, specif parmeti [48] partit mesh graph. mesh partit algorithm approach nodal based, mean node belong singl subdomain processor, element belong multipl subdomain node own differ processors. 12 explain previou section, fixed-mesh al method involv stage time step unknown project background fix mesh. independ type project used, deal parallel framework element node integr point lai deform belong differ processor parallel subdo- main, introduc addit difficulti parallel spatial search multipl threads. possibl strategi exist treat issue. strategi reli take time step small relat mesh size free surfac cross element singl time step [60]. allow ensur look posit node integr point deform mesh, first-lay element adjac node integr point, local store processor own node. however, introduc limit time step size form courantfriedrichslewi condit (cfl) [36], conveni implicit method solv incompress navier-stok equations. second possibl approach introduc constraint time step size, effi- cienci reli fact time step larg compar cfl condition. consist start search element adjac node progress advanc search neighbor element success layers. search reach boundari processor subdomain sought element found, commun step requir order proce search neighbor subdomain. strategi independ time step size number subdomains. however, requir neighbor processor communi- cation step search layer elements, limit perform algorithm high-perform comput environments. moreover, implement adapt framework mesh hang nodes, requir advanc neighbor element differ refin levels, step straightforward code. approach consist implement octree-bas (quadtre dimensions) search algorithm effici depend time step size. precis approach adopt. import case implement search algorithm parallel framework. strategi follow build octre search data structur processor correspond subdomain. follow construct subdomain octre allow decid which, neighbor processors, contain sought element current processor. adapt fix mesh-al method number element posit node evolv time, octre need rebuilt time step. effici parallel implement pursu goe follows. processor (associ physic subdomain submesh), start comput coordin range, defin set maximum minimum nodal coordin coordin axis. allow subdivid rectangular prism enclos local subdomain subprisms, leaf tree. element assign leaf, take account element belong multipl leaf coordin node lai differ side virtual boundari delimit newli creat leafs. dynam link list store information. usual octre base search algorithms, number element leaf large, leaf subdivid element leaf reclassifi new subleafs. criteria order decid stop subdivis process need ensur classif search process efficient. point classifi instead elements, reason criteria stop subdivis process point leaf found. however, element occupi volume, lead infinit recursion. order avoid this, criteria stop recurs process applied: number element leaf smaller number element threshold, stop recurs process. 13 leaf level larger level threshold, stop recurs process. ratio size volum enclos leaf size element smaller leaf volum threshold, stop recurs process. build octre structur follow criteria, search local level carri out. time step large, search project success search element current processor. however, cases, special time step large, sought element belong differ processor. case conveni processor octre allow decid processor element look for. strategi similar explain element octree: first, processor send coordin rang processors. all-to-al commun process, involv commun real variabl space dimens need once. inform processor capabl build global processor octre follow step element octree. processor octre replic processors. processor built local element octree, processor built global processor octree, step spatial search coordin point integr point project step are: try find element insid point place local subdomain local element octree. element found, note element interpol coeffici search need perform multipl field interpolation. element local subdomain, choos candid subdomain element need look global processor octree. coordin point need sent candid processors. receiv coordin point processor need look current processor. look local element octre return flag indic element processor owner node. element found, note element interpol coeffici search need perform multipl field interpolation. preparatori stage done, interpol field deform background mesh effici by: interpol field point local correspond element local. interpol field point ask processor send processors. receiv interpol valu processor local node correspond- ing element local. follow criteria effici global octre search algorithm project step arbitrari field fixed-mesh al method obtained. 4 fraction step approach free surfac flow formul describ far allow solv free surfac problem involv incompress fluid finit elements. however, time step linear system need solv in- volv momentum continu equations. problem point number 14 figur 4: project deform background mesh. left: origin mesh. right: deform mesh. left: project process. differ processor subdomain exist case. left image, project deform background mesh performed. node lai processor deform undeform mesh (top left squar green nodes, instance). node however, need inform differ processor order project step. case left central blue star node, need interpol bottom-left red domain. inter-processor commun requir case. unknown large, linear system ill-condit despit stabil method em- ployed. case conveni tackl problem split global iter solut subsystem involv veloc pressur unknowns, known fraction step methods. following, approach fraction step split incompress navier-stok equat presented. base modif monolith incompress navier-stok equations, second associ pure algebra approach. 4.1 pressur poisson equat base fraction step method type fraction step scheme base solut laplacian approxim pressur schur complement propos [27]. scheme solut mono- lithic decompos solut simpler problems: convection-diffus equat veloc unknown, pressure-poisson equat project step. sum- mariz fraction step method backward euler time integr scheme, adapt type time integrator. start introduc intermedi veloc uuuh, consider: uuunh = uuu n h. step fraction step scheme following: 15 1. convection-diffus equation. solv intermedi quantiti uuun+1h : ( vvvh, t uuu n+1 h ) +b ( [vvvh,0] , [ aaan+1h ; uuu n+1 h , p n h ]) +soss ( [vvvh,0] , [ aaan+1h ; uuu n+1 h , p n h ]) +sghost ( [vvvh,0] , [ aaan+1h ; uuu n+1 h , p n h ]) = l([vvvh,qh]) , (11) aaan+1h = uuu n+1 h uuuh, 2. pressur poisson equation. solv pn+1h : (qh, uuun+1h )+soss ( [000,qh] , [ aaan+1h ; uuu n+1 h , p n+1 h ]) +sghost ( [000,qh] , [ aaan+1h ; uuu n+1 h , p n+1 h ]) = t((pn+1h p n h),qh), (12) 3. project step: solv uuun+1h : 1 t (vvvh,uuu n+1 h uuu n+1 h )+(vvvh,p n+1 h p n h) +sghost ( [vvvh,0] , [ 000;uuun+1h uuu n+1 h , p n h ]) = 0. (13) previou scheme provid wai decoupl solut veloc solut pressur unknown. however, error introduc affect accuraci solution: error fact momentum equat (11) solv intermedi veloc uuun+1h instead end step veloc uuu n+1 h . second sourc error caus natur boundari condit equat (12), implicitli state nnn ph = 0 0. caus spuriou pressur boundari layer appear wall comput domain. finally, mayb import sourc error case free surfac flows, dirichlet boundari condit need provid equat (12). dirichlet boundari condit enforc is: p = 0 free. condit appli linked-lagrang multipli method. low viscou flow approxim reasonable, effect viscos small. however, proper boundari condit appli be: nnn = 000 free. consequence, addit sourc error introduc fraction step method. moreover, equat (12) allow prescrib end step veloc valu direct normal boundary, nnn uuuh, sourc error. 4.2 algebra approach algebra approach fraction step method appear precis overcom error introduc laplacian base methods. algebra level skip discuss correct boundari condit imposed. fact, discret level, end-of-step veloc satisfi good boundari conditions. important, boundari condit impos pressure. [7] detail algebra pressur segreg method incompress navier-stok equations. numer exampl section 6 run algebra fraction step approach. depart algebra linear monolith problem, algebra counterpart equat (4):[ auu aup apu app ][ u p ] = [ ru rp ] , straightforward identif matric arrays. algebra approach us solv incompress navier-stok equat consist follow steps: 16 1. solv intermedi veloc un+1: auuu n+1 = ruauppn. (14) 2. solv algebra pressur poisson equation. solv pressur pn+1:( appapu [ l(auu) 1 aup ]) pn+1 = rpapuun+1apu [ l(auu) 1 aup ] pn, (15) l(auu)1 invers lump matrix auu. pure algebra approach fraction step solut incompress navier-stok equat work split oss stabil formul (4) linear finit elements. case lump auu matrix, l(auu), contain contribut stabil terms, involv spatial deriv uuuh, term disappear lumping. viscou convect term disappear contain spatial deriv uuuh. also, aup apu contain contribut stabil terms. caus linear elements, result approxim schur complement matrix: s = appapu [ l(auu) 1 aup ] , (16) ident explicitli built algebra method [31], schur complement matrix comput as: s = appdm1g, matrix d associ term (qh, ()), m lump mass matrix aris tempor deriv term (vvvh,t ()), g gradient matrix associ ( vvvh, ). note stabil effect ghost-penalti term remain formulation, equat (14) continu contain origin ghost-penalti term stabil veloc gradients, equa- tion (16) continu contain origin ghost-penalti term stabil pressur gradients. lump affect approxim schur complement equat (16). higher order elements, pure algebra approach directli built mono- lithic incompress navier-stok equations, lump mass matrix result singular matrix zero diagonal. cases, diagon easi invert approxim matrix auu devised. case stabil method like residu base supg method, case linear elements: case sta- biliz term aup apu matrices, stabil term affect qualiti approxim schur complement matrix. [7] detail review algebra fraction step methods. remark take account possibl build algebra fraction step method di- rectli matric monolith system, worth explain imple- ment in-hous parallel finit element comput code. finit element code reli petsc librari [14] solut linear system equations. features, petsc librari allow solv saddl point problem like incompress navier-stok equat build block preconditioners, call field split preconditioners. particular, algebra fraction step method describ equat (14)-(15) implement directli assembl monolith (4) pass follow commandlin option petsc linear solver: k s p t y p e r c h r d s o n k s p m x t 2 p c t y p e f e l d s p l t 17 p c f e l d s p l t t y p e s c h u r p c f e l d s p l t s c h u r f c t o r z t o n t y p e f u l l p c f e l d s p l t 0 f e l d s 0 ,1 p c f e l d s p l t 1 f e l d s 2 p c f e l d s p l t s c h u r p r e c o n d t o n s e l f p f e l d s p l t 1 m t s c h u r c o m p l e m e n t n v t y p e lump f e l d s p l t 1 k s p t y p e p r e o n l y f e l d s p l t 1 p c t y p e ksp moreover, exact solut monolith required, algebra fraction step method preconditioner. case richardson driver replac krylov method, number iter increment monolith solut recovered: k s p t y p e gmre k s p m x t 200 k s p t o l 1e8 p c t y p e f e l d s p l t p c f e l d s p l t t y p e s c h u r p c f e l d s p l t s c h u r f c t o r z t o n t y p e f u l l p c f e l d s p l t 0 f e l d s 0 ,1 p c f e l d s p l t 1 f e l d s 2 p c f e l d s p l t s c h u r p r e c o n d t o n s e l f p f e l d s p l t 1 m t s c h u r c o m p l e m e n t n v t y p e lump f e l d s p l t 1 k s p t y p e p r e o n l y f e l d s p l t 1 p c t y p e ksp 5 adapt approach previou section present stabil variat formul solut in- compress free surfac flow fixed-mesh al method finit elements. scheme need coupl adapt refin approach. adapt refin reli algorithm present [10], allow distribut memori parallel finit element code effici modifi mesh hierarch manner (both refin coarsen mesh possible) refin region comput domain required. follow summar main featur adapt refin algorithm coupl fixed-mesh al method. adapt refin algorithm base nodal parallel partition. mean node mesh belong processor, element belong multipl processor own node subdomain. feature, strongli link design parallel finit element code, introduc particular design hierarch mesh refiner, summar next: distribut data structur handl dimension unstructur mesh com- pose triangular, quadrilateral, tetrahedr hexahedr elements. approach capa- ble describ complex geometries, non-uniform refinements. processor store local inform partit distribut mesh. reduc memori consumption, allow scale thousand processors. parallel refin procedur base hierarch data structur refin ele- ment mesh, effici search neighbor element inter-processor level. data structur contain parent children pointer implemented, new refin level success ad substract comput mesh. 18 result mesh non conform hang node side level refine- ment meet. contrari adapt refin methods, algorithm propos enforc balanc restrict refin level adjac elements: jump refin level neighbor element arbitrarili large. parallel refin process, algorithm deal element node identif processor global element global point identifi structure. ensur global number structur gener nodal element inform trans- fer neighbor processor effici manner. balanc processor load dynam parallel repartit framework chang ownership mesh node load unbal reach certain threshold, transfer associ element correspond processors. contrari algorithm load rebalanc hierarch adapt mesh refinement, algorithm in- depend renumb strategi load rebalanc process. particular, graph partit scheme space-fil method load rebalanc used. despit interest properties, fixed-mesh al point view adapt refin algorithm act black box allow modifi mesh runtime, particularities: first, mesh refin criteria need provid algorithm decid area mesh need refined. secondly, finit element solver need deal hang node which, straightforward implement done, result non-conform discretizations. regard mesh refin criteria, simpl decis make algorithm used, enforc element occupi fluid suffici fine. defin refin level number hierarch parent (in refin process) element has. base this, criteria read follows: element occupi fluid refin level nref, refin it. element nlai layer element awai free surfac free refin level nreflai , refin it. element occupi fluid refin level greater nref, unrefin it. else, unrefin element. ensur refin level element cover fluid suffici fine addit refin introduc region surround free order accur represent geometri free surface. care need taken parallel implement refin criteria: explain [10], parallel refin algorithm requir refin criteria pass refin processors. problem nlai criteria geometr need propag free surfac layer elements. layer cross subdomain (attach parallel processor) another, commun needed. solut problem commun refin criteria mark node element refin proceed commun inform processor boundari usual nodal unknown commun nodal base partit finit element code. obviously, adapt refin strategi base error estim used, numer experi present work. wai deal hang nodes, main problem standard shape function hang node result non-conform finit element approximations. possi- ble deal non-conform approxim variat form (see instanc [6], 19 discontinuous-galerkin term deal discontinu shape function mesh hang nodes), specif design variat formul need develop physic equation. second possibl consist modifi shape function conforming. this, adapt refin algorithm present [10] provid infor- mation call hang parent averag coefficients, finit element solver proce consid mesh flat, instead hierarchical. procedur consist complet elimin hang node finit element equations, contribut test shape function ad hang parents, test shape function modified. general, test shape function hang parent node (hp), hang children node (hci), modifi follow manner: nhp(xxx) = nhp(xxx)+ nchild i=1 (nhp(xxxi)nhci(xxx), nhp nhci denot origin shape test function parent children node respectively, nhp(xxx) denot modifi hang parent shape function, xxxi denot posit space ith hang children. test shape function hang children node complet elimin final finit element problem. instanc exampl fig. 5. shape test function node 1, n1, modifi n1 that: n1 (xxx) = n1(xxx)+ 1 2 n3(xxx)+ 1 4 n4(xxx). similarly, test shape function node 2, n2, modifi n2 (xxx) that: n2 (xxx) = n2(xxx)+ 1 2 n3(xxx)+ 3 4 n4(xxx). shape test function node 3 4 complet elimin finit element equations, nodal valu recov finit element problem solv saying: u4 = 1 4 u1 + 3 4 u2, u3 = 1 2 u1 + 1 2 u2. note relat recursive, arbitrari differ refin level neighbor element possible. 20 figur 5: hang nodes. node 4 hang node, hang parent node 2 3. node 3 turn hang node, hang parent node 1 2. hang node valu unknown node 4, u4 is: u4 = 1 2 u3 + 1 2 u2 = 1 4 u1 + 3 4 u2. 6 numer experi section present numer experi illustr behavior propos method. 6.1 2d slosh rectangular tank numer exampl studi numer perform propos algorithm. this, bi-dimension tank dimens 1.731.05 m2 partial fill water height 0.6 m studied. tank subject horizont movement, character amplitud 0.031 m period 1.5 s: x = 0.031 sin ( 4 3 t ) . (17) set similar present section 6.2 fig. 12 , simul 2d numer method assess easily. 6.1.1 spatial converg exampl compar experiment results, result obtain finer finit element mesh. refer solut obtain solv problem rel fine uniform mesh compos 104960 linear elements. test perform consist studi spatial converg method. 10 time step simul time step 0.01 seconds. time step, posit free surfac 50 uniformli space height gaug measured, compar solut refer mesh. rel error comput as: e = 1.73 0 0.01 0 (hcoarse(x, t)hfine(x, t)) 2 dxdt, hcoarse(x, t) hfine(x, t) repres height free surfac abscissa x given time t, coars fine mesh respectively. time step simulated, cumul error caus time integr affect result converg study. order study, converg method, effect adapt mesh refinement, converg studi differ kind meshes: kind mesh, 21 figur 6: uniformli refin mesh (left) adapt refin mesh (right) converg studi 2d slosh tank. 10 0 10 1 10 6 10 5 10 4 10 3 10 2 slope 2 slope 1 e refin level uniform refin adapt refin figur 7: spatial converg 2d slosh rectangular tank. refin uniform. second one, criteria explain section 5 applied, 1 addit refin level 5 layer elements. fig. 6 show uniformli refin mesh, adapt refin mesh given refin level. note adapt refin mesh add element region flow occupi fluid, concentr element region surround free surface. fig. 7 show spatial converg result uniformli refin adapt refin cases. observ spatial converg ratio quadrat (a expected, linear element used), result improv low increas comput cost adapt refin technique. 6.1.2 tempor converg second test perform consist studi converg tempor discretization. this, consid fix element discret size (with uniformli refin mesh) result mesh compos approxim 7000 element studi effect variat time 22 10 2 10 3 10 5 10 4 10 3 10 2 10 1 slope 2 slope 1 e 1/ t s figur 8: tempor converg 2d slosh rectangular tank. step size. again, refer solut obtain consid small time step 0.001 s. example, viscos = 1pa s consid instead viscos water test requir turbul model. rel error associ tempor discret comput as: e = 1.73 0 (hcoarse(x, tend)hfine(x, tend)) 2 dx, hcoarse(x, tend) hfine(x, tend) repres posit free surfac end simul comput coars time step refer fine time step respectively. total simul time 0.32 s computed. fig. 8 show result obtain fixed-mesh al method. second order time integr (bdf2) equat (advect level set, integr navier-stok equations), second order time scheme obtain suffici refin time steps. 6.1.3 effect ghost stabil term interest evalu effect numer ingredi propos for- mulation. seen ghost penalti term harm spatial converg solution, follow test deactiv ghost penalti stabil term observ result term considered. expected, solut explod bad cut found. shown fig. 9 veloc field level set function bad cut configur shown ghost penalti stabil terms. veloc ghost stabil term explod expected, result non-phys posit comput free surface. also, condit number linear matrix explod 5.4 1014. hand, ghost stabil terms, veloc field control (although oscil node outsid physic domain, littl influenc (t) region), free surfac posit correct correspond physic configuration. condit number linear matrix bad configur 1.75 1011, large, better condit number ghost penalti stabil terms. 23 figur 9: effect ghost penalti stabil terms. top: result ghost penalti stabil term bad cut configuration. bottom: result ghost penalti stabil terms. 6.1.4 effect mass loss correct scheme studi effect mass loss correct terms. coars mesh (410 linear triangl elements) coars time step (0.2 s) used, dissip backward euler scheme. fig. 10 show initi volum water, volum water obtain with, mass correct scheme. expected, correct applied, great mass lost process. hand, mass conserv global mass correct scheme used. 6.1.5 effect level set reiniti scheme ingredi formul level set reiniti scheme. evalu result mesh 1640 linear triangl time step 0.1 s 200 step simulated. case considered: case reiniti all, second one, reiniti step time step. fig. 11 level set function posit free surfac present end simulation. observ level set function differ reiniti scheme used, posit free surfac practic cases, 200 reiniti steps. conclud propos reiniti scheme good option transport level set functions. 6.2 3d slosh rectangular tank exampl studi [40], numer physic experi per- form elev free surfac problem tracked. bi-dimension rectangular tank dimens 1.731.050.2 m partial fill water height 0.6 m. tank dimens initi configur free surfac shown fig. 12. 24 figur 10: effect mass loss correct scheme. top: initi level set configuration. bottom: level set posit end simul (left) (right) mass loss correct scheme. figur 11: effect level set reiniti scheme. left: reinitialization. right: reinitialization. 25 figur 12: initi configur slosh rectangular tank (1.731.050.2 m) problem. tank subject horizont movement, character amplitud 0.031 m period 1.5 s, oscil appli exampl section 6.1 equat (17). displac appli tank, interior fluid start oscillating. time histori elev (coordin y) height gaug situat coordin x = 0.05 m, z = 0.1 m measur compar experiment results. experiment result contribut depth coordin solut problem negligible, bidimension mesh dimens 1.731.05 m used. slip boundari condit allow free movement fluid tangenti direct enforc tank boundary. time step 0.01 s set second order backward differ scheme time integration. initi mesh 4000 element used, refin mesh built. mesh refin section cut free surface, allow better track fluid interface. case refin criteria follows: mesh refin level region surround free surfac layer element side. result comput cost similar origin problem refinement, allow higher precis select region. observ fig. 13, mesh success refin unrefin area surround free surfac solv fine mesh time step. linear equat strategy, algebra fraction step approach present section 4.2 used, allow solver iter monolith solut recovered. fig. 13 show veloc field free surfac time shortli water surfac impact tank ceiling. obtain veloc level set function field smooth, adapt mesh allow accur (and smoothly) captur geometri free surface, veloc pressur fields. fig. 14 show smooth pressur field simul steps. fig. 15 compar water surfac elev height gaug experiment case pre- sent [40] result obtain propos numer method. observed, natur oscil period fluid tank coincid forc oscil pe- riod, caus beat effect observed, amplitud fluid oscil increas mitig successively. good agreement obtained, oscil frequency, beat frequenc amplitud oscillations. beat period agreement exact, despit initi condit differ experiment numer problems. that, error oscil frequenc effect initi condit accumul measur height exactli overlap, beat period (of 12 s) correctli captur numer method. 26 figur 13: mesh posit free surfac (right) veloc vector (right) time instant simulation. vector color indic veloc magnitudes, vector arrowhead indic veloc direction. 27 figur 14: smooth pressur field slosh problem. 0 5 10 15 20 25 30 35 40 45 50 0.2 0 0.2 0.4 0.6 time (s) e le va tio n ( m ) experiment result adapt fmale figur 15: water surfac elev elev gaug situat x = 0.05, z = 0.1. 28 figur 16: free fall jet problem. left: free surfac plot. right: veloc vector field stationari state reached. vector color indic veloc magnitude, vector arrowhead indic direction. 6.3 free overfal experi numer exampl studi behavior free fall jet. problem set depict fig. 16. free surfac flow enter problem domain top-left area uniform horizont veloc 0.857 m/s, free surfac height 0.075 m. shortli entri point, canal abruptli end flow fall freeli form jet. case shape jet studi compar experiment result present [53]. case depart finit element mesh compos approxim 1000 triangular elements, adapt refin region free surfac region (4 hierarch level refin considered) mesh 33301 element obtained. time step set 0.01 s, second order backward differ time integr scheme used. simul run stationari state reached. shown fig. 16, result free surfac smooth point water jet separ canal wall, numer oscil appear treat instanc shock captur techniqu advect level set function. equival uniform refin mesh cover comput domain region compos 515690 , clear import gain requir comput effort obtained. adapt refin mesh stationari state reach depict fig. 17. mesh heavili refin area surround free surface, jump 4 refin level obtain neighbor elements. finally, fig. 18 result numer simul compar experiment result present [53]. agreement exact, thank capabl adapt fixed-mesh al method concentr comput effort critic regions, case free surfac special separ point jet depart canal start free fall movement. 6.4 green water flow experi numer exampl consist simul water flow deck ship follow impact result wave obstacle. known benchmark free surfac problem studi experiment maritim research institut netherland (marin). experiment data avail [1]. set problem following: larg tank open roof considered. side tank, gate aisl volum water lai rest constant free surfac height. gate prismat obstacl repres contain deck ship. obstacl static fluid-structur interact effect considered. initi configur depict fig. 19. experi start gate quickli open (the durat gate open process consid zero) result water wave impact obstacl wall tank. pressur 29 figur 17: free fall jet problem. adapt refin mesh level set function field stationari state reached. 0 0.1 0.2 0.3 0.4 0.5 0.6 0.05 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 experiment adapt fmale figur 18: comparison experiment numer simul result free fall jet prob- lem. 30 figur 19: kleefman dambreak experi initi configur time histori point surfac obstacl measur compar experiment results. initi mesh compos 3756 linear tetrahedr element used. slip boundari condit allow free movement fluid tangenti direct enforc walls. boundari condit enforc strong manner. time step mesh adapt addit level refin appli region occupi fluid, addit level refin appli layer element closest free surface. time step set 0.01 s total 6 s simulated. again, second order backward differ scheme integr problem time. finit element mesh success adapt averag half million element obtain comput mesh time step. mesh refin heavili local free surface. result adapt refin mesh element size equival uniform mesh half million element element size free surfac area uniformli appli comput domain, lead import save comput effort. fig. 20 posit free surfac time instant shown, mesh time steps. observed, mesh heavili refin region surround free surface, coarser fluid region farther free surface, ex- treme coars region domain occupi fluid, simulation. fig. 21 show comparison pressur time histori obtain nu- meric simul experiment results. numer experiment result good agreement qualit quantitatively. salient differ experi numer simul return wave (which impact obstacl t ' 5 s water reach left wall tank, right wall, return final collid obstacle) slightli delai numer experiments. apart this, pressur level time match pressur valu experiment result good accuracy. fig. 22 show veloc vector water surface. thank stabil term veloc field 31 smooth free surfac bad cut mesh element occur depend geometri free surface. 7 conclus work present adapt fixed-mesh al (arbitrary-lagrangian-eulerian) method free surfac flows. main ingredi propos strategi us stabil formu- lations, includ stabil term cut element free surfac term stabil convect classic lbb condition, us al frame refer accur comput tempor deriv contribut advect term, method prescrib boundari condit non-match meshes, coupl set adapt mesh refine- ment algorithms. adapt mesh refin algorithm allow solut problem distribut memori environ reduc overal comput cost focus comput effort region need time step. import compon formul simpl mass correct procedur ensur mass conserv global level simulation, effici algorithm element search project step deform background mesh, us algebra fraction step approach incompress navier-stok equat ensur result system equat easi solv time converg solut origin monolith problem. perform method test numer exampl repres slosh insid tank subject horizont acceleration, free fall jet, impact wave obstacl quick gaug opening. spatial tempor converg assessed, behavior ingredi formul successfulli tested. result obtain propos adapt fixed-mesh al method good agreement experiment results, obtain veloc pressur field smooth thank term stabil bad element cut convect inf-sup sourc instability. acknowledg author like acknowledg eric burman fruit discuss ghost penalti method. work partial fund elastic-flow project, ref. dpi2015-67857-r spanish government. j. baig acknowledg support spanish govern ramon y cajal grant ryc-2015-17367. r. codina acknowledg support receiv icrea academia research program catalan government. e. castillo gratefulli ac- knowledg support receiv conicyt (programa formacion capit o humano avanzado/becas-chil folio 72120080). refer [1] s.e.r.i. community. [2] i. akkerman, y. bazilevs, c. kees, m. farthing. isogeometr analysi free-surfac flow. journal comput physics, 230(11):4137 4152, 2011. special issu high order method {cfd} problems. [3] s. amdouni, m. moakher, y. renard. local project stabil fictiti domain method ellipt boundari valu problems. appli numer mathematics, 76:6075, 2014. 32 (a) t = 0.03 s (b) t = 0.6 s (c) t = 1.29 figur 20: (a) posit free surfac comput mesh instant simul green water flow case. 33 (d) t = 2.61 s (e) t = 3.87 s (f) t = 5.49 s figur 20: (b) posit free surfac comput mesh instant simul green water flow case . 34 0 2 4 6 8 2000 0 2000 4000 6000 8000 10000 12000 time (s) p ss u ( p ) experiment result numer result 0 2 4 6 8 2000 0 2000 4000 6000 8000 10000 time (s) p ss u ( p ) experiment result numer result 0 2 4 6 8 500 0 500 1000 1500 2000 time (s) p ss u ( p ) experiment result numer result 0 2 4 6 8 500 0 500 1000 1500 2000 2500 time (s) p ss u ( p ) experiment result numer result figur 21: comparison experiment numer valu pressur time histori point obstacl surfac (p1 p4). left right bottom: p1: (0.8245, 0.021, 0.4965), p2: (0.8245, 0.141, 0.4965), p3: (0.7635, 0.161, 0.4965), p4: (0.7235, 0.161, 0.4965) 35 (a) t = 0.03 s, vmax = 1.06 m/s. (b) t = 0.6 s, vmax = 1.73 m/s. (c) t = 1.29 s, vmax = 2.69 m/s. (d) t = 3.87 s, vmax = 1.86 m/s. (e) t = 5.49 s, vmax = 2.59 m/s. figur 22: veloc vector free surfac dam-break problem time steps. vector color indic veloc magnitud (with light red indic maximum velocity, dark blue indi- cate fluid rest), vector arrowhead indic flow direction. maximum fluid nodal veloc time step indic captions. 36 [4] r. amini, r. maghsoodi, n. z. moghaddam. simul free surfac problem iso- geometr analysis. journal brazilian societi mechan scienc engineering, 38(2):413421, 2016. [5] h. ask l. j. sluys. remesh strategi adapt al analysi strain localisation. european journal mechanics-a/solids, 19(3):447467, 2000. [6] s. badia j. baiges. adapt finit element simul incompress flow hy- brid continuous-discontinu galerkin formulations. siam journal scientif computing, 35(1):a491a516, 2013. [7] s. badia r. codina. algebra pressur segreg method incompress navier- stoke equations. archiv comput method engineering, 15(3):152, 2007. [8] s. badia, f. nobile, c. vergara. robin-robin precondit krylov method fluid- structur interact problems. method appli mechan engineering, 198:27682784, 2009. [9] s. badia, a. quaini, a. quarteroni. modular vs non-modular precondition fluid- structur system larg added-mass effect. method appli mechan engineering, 197:42164232, 2008. [10] j. baig c. bayona. refficientlib: effici load-rebalanc adapt mesh refin algorithm high perform comput physic meshes. submitted, 2015. [11] j. baig r. codina. fix mesh-al approach appli solid mechan fluid- structur interact problems. intern journal numer method engineering, 81:15291557, 2009. [12] j. baiges, r. codina, h. coppola-owen. fixed-mesh al approach nu- meric simul float solids. intern journal numer method fluids, 67(8):10041023, 2011. [13] j. baiges, r. codina, f. henke, s. shahmiri, w. a. wall. symmetr method weakli impos dirichlet boundari condit embed finit element meshes. intern jour- nal numer method engineering, 90(5):636658, 2012. [14] s. balay, s. abhyankar, m. f. adams, j. brown, p. brune, k. buschelman, l. dalcin, v. ei- jkhout, w. d. gropp, d. kaushik, m. g. knepley, l. c. mcinnes, k. rupp, b. f. smith, s. zampini, h. zhang. petsc web page. 2015. [15] h. barbosa t. hughes. finit element method lagrangian multipli bound- ary: circumv babuska-brezzi condition. method appli mechan engineering, 85:109128, 1991. [16] g. r. barrenechea f. chouly. local project stabil method fictiti domains. appli mathemat letters, 25(12):2071 2076, 2012. [17] t. belytschko, w. liu, b. moran. nonlinear finit element continua structures. john wiley, 2001. [18] f. brezzi m. fortin. mix hybrid finit element methods. springer verlag, 1991. [19] e. burman. ghost penalty. compt rendu mathematique, 348(21):12171220, 2010. 37 [20] e. burman. project stabil lagrang multipli imposit constraint interfac boundaries. numer method partial differenti equations, 30(2):567 592, 2014. [21] e. burman m. fernandez. stabil explicit coupl fluid-structur interact involv fluid incompressibility. method appli mechan engineering, 198:766784, 2009. [22] e. burman m. a. fernandez. unfit nitsch method incompress fluid-structur interact overlap meshes. method appli mechan engineer- ing, 279:497 514, 2014. [23] e. burman p. hansbo. fictiti domain finit element method cut elements: ii. stabil nitsch method. appli numer mathematics, 62(4):328341, 2012. [24] e. burman p. hansbo. fictiti domain method cut elements: iii. stabil nitsch method stoke problem. esaim: mathemat model numer analysis, 48(3):859874, 2014. [25] c. canuto, m. y. hussaini, a. m. quarteroni, a. thoma jr, et al. spectral method fluid dynamics. springer scienc & busi media, 2012. [26] e. castillo, j. baiges, r. codina. approxim two-fluid flow problem vis- coelast fluid level set method pressur enrich finit element shape functions. journal non-newtonian fluid mechanics, 225:37 53, 2015. [27] a. chorin. numer solut navierstok equat incompress fluid. aec research develop report, nyo-1480-82. new york university, new york, 1967. [28] r. codina. stabil finit element method gener stationari incompress flows. method appli mechan engineering, 190:26812706, 2001. [29] r. codina. stabil finit element approxim transient incompress flow orthogon subscales. method appli mechan engineering, 191:4295 4321, 2002. [30] r. codina. analysi stabil finit element approxim oseen equat orthogon subscales. appli numer mathematics, 58:264283, 2008. [31] r. codina s. badia. pressur segreg method fractional-step type finit element approxim incompress flow problems. method appli mechan engineering, 195:29002918, 2006. [32] r. codina j. baiges. finit element approxim transmiss condit fluid solid introduc boundari subgrid scales. intern journal numer method engineering, 87:386411, 2011. [33] r. codina j. baiges. weak imposit essenti boundari condit finit ele- ment approxim ellipt problem non-match meshes. intern journal numer method engineering, 2014. [34] r. codina, g. houzeaux, h. coppola-owen, j. baiges. fixed-mesh al approach numer approxim flow move domains. j. comput. phys., 228:15911611, 2009. 38 [35] h. coppola-owen r. codina. finit element model free surfac flow fix meshes. int. j. num. meth. fluids, 54:11511171, 2007. [36] r. courant k. friedrichs. superson flow shock waves. springerverlag, 1948. [37] p. dez a. huerta. unifi approach remesh strategi finit element h-adaptivity. method appli mechan engineering, 176:215229, 1999. [38] j. donea, a. huerta, j.-p. ponthot, a. rodriguez-ferran. encyclopedia comput mechan vol. 1: fundamentals., chapter 14: arbitrari lagrangian-eulerian methods, 2004. [39] a. ern j.-l. guermond. theori practic finit element. springer-verlag, 2004. [40] o. m. faltinsen, o. f. rognebakke, i. a. lukovsky, a. n. timokha. multidimension modal analysi nonlinear slosh rectangular tank finit water depth. journal fluid mechanics, 407:201234, 2000. [41] c. forster, w. wall, e. ramm. artifici ad mass instabl sequenti stagger coupl nonlinear structur incompress viscou flows. method ap- pli mechan engineering, 196:12781293, 2007. [42] a. gerstenberg w. wall. embed dirichlet formul 3d continua. interna- tional journal numer method engineering, 82:537563, 2010. [43] r. glowinski, t. pan, t. hesla, d. joseph, j. periaux. distribut lagrang multiplier/- fictiti domain method flow move rigid bodies: applic particul flow. int. j. num. meth. fluids, 30:10431066, 1999. [44] p. hansbo m. larson. discontinu galerkin method incompress nearli in- compress elast nitsch method. method appli mechan engineering, 191:18951908, 2002. [45] g. houzeaux r. codina. finit element model simul lost foam casting. int. j. num. meth. fluids, 46:203226, 2004. [46] t. hughes, g. feijoo, l. mazzei, j. quincy. variat multiscal methoda paradigm comput mechanics. method appli mechan engineering, 166:324, 1998. [47] m. juntunen r. stenberg. nitsch method gener boundari conditions. helsinki univers technology, institut mathematics, research report a530, 2007. [48] g. karypi v. kumar. fast high qualiti multilevel scheme partit irregular graphs. intern confer parallel processing, page 113122, 1995. [49] s. kollmannsberger, a. ozcan, j. baiges, m. ruess, e. rank, a. reali. parameter-free, weak imposit dirichlet boundari condit coupl trim non-conform patches. intern journal numer method engineering, 101(9):670699, 2015. [50] m.-c. lai c. peskin. immers boundari method formal second-ord accuraci reduc numer viscosity. j. comput. phys., 160:705719, 2000. [51] a. larese, r. rossi, e. onate. finit element model free surfac flow variabl poros media. archiv comput method engineering, 22(4):637653, 2015. 39 [52] r. lohner, j. cebral, f. camelli, j. baum, e. mestreau. adapt embedded/immers unstructur grid techniques. archiv comput method engineering, 14:279301, 2007. [53] e. marchi. free overfall. journal hydraul research, 31(6):777790, 1993. [54] e. mestreau, r. lohner, s. aita. tgv tunnel entri simul finit element code automat remeshing, 1993. aiaa paper 93-0890. [55] r. mittal g. iaccarino. immers boundari methods. annual review fluid mechanics, 37:239261, 2005. [56] v. p. nguyen, t. rabczuk, s. bordas, m. duflot. meshless methods: review implement aspects. mathemat comput simulation, 79(3):763813, 2008. [57] j. nitsche. uber ein varationsprinzip zu losung von dirichlet-problemen bei verwendung von teilraumen, die keinen randbedingungen unterworfen sind. abhandlungen au dem mathema- tisch seminar der universitat, 36:915, 1971. [58] e. onate, s. r. idelsohn, f. del pin, r. aubry. particl finit element method-an overview. intern journal comput methods, 1(02):267307, 2004. [59] c. peskin. flow pattern heart valves: numer method. j. comput. phys., 10:252 271, 1972. [60] c. samaniego, g. houzeaux, e. samaniego, m. vazquez. parallel embed boundari method fluid rigid-bodi interaction. method appli mechan engineering, 290:387 419, 2015. [61] b. schott w. wall. new face-ori stabil xfem approach 2d 3d incom- pressibl navierstok equations. method appli mechan engineering, 276:233265, 2014. [62] s. turek j. hron. propos numer benchmark fluidstructur interact be- tween elast object laminar incompress flow. h. j. bungartz m. schafer, editors, fluidstructur interact modelling, simulation, optimization, number 53 lec- ture note comput scienc engineering, page 371385. springer, berlin, 2006. isbn 3-540-34595-7. 40