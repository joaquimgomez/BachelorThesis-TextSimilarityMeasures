lodi.ep homogenization-bas multiscal crack modelling: micro diffus damag macro crack vinh phu nguyen 1,, oriol lloberas-valls2,, martijn stroeven3,, lambertu johann sluys4, delft univers technology, faculti civil engin geosciences, p.o. box 5048, 2600 ga delft, netherland abstract exist repres volum element (rve) class quasi-brittl materi have random het- erogen microstructur tensile, shear mix mode load demonstr deriv traction-separ relations, object respect rve size. comput homogen base multiscal crack model framework, implement fe2 setting, quasi-brittl solid complex random microstructur presented. object macroscop respons micro sampl size shown numer simulations. therefore, homogen scheme, object respect macroscop discret microscop sampl size, devised. numer exampl includ comparison direct numer simul given demonstr perform propos method. keywords: repres volum element (rve), quasi-brittl materials, softening, multiscale, homogenization, cohes law, fractur 1. introduct major natur engin materi materi deform failur process place multipl scale call multiscal materi (by multiscal mean multipl length scales). macroscop level observation, reason consid materi homogeneous, tradition model phenomenolog constitut laws. lower observ level (meso and/or micro) heterogen appear troublesom taken account phenomenolog constitut models. approach heterogen materi modelled. approach known direct numer simul (dns) brute-forc fullscal simulation, heterogen fine scale explicitli model coars scale model. guarante accuracy, comput effort impract (at current technology) limit applic dn approach. second approach base homogen concept emerg valuabl tool model heterogen materi effici way. approach, known concurr multiscal method, resembl domain decomposit methods. detail taxonomi multiscal methods, refer [1]. correspond author 1 2 3 4 preprint submit elsevi march 20, 2012 v o m l homogenization-bas multiscal model techniqu numer homogen [2] comput homogen [3], [4] detail discussion. numer homogen schemes, macroscop canon constitut model e.g., visco-plast model, assum paramet determin fit data produc finit element (or numer method) comput microscop sampl microstructur explicitli modelled. literature, numer homogen techniqu known unit cell methods. assumpt form macroscop constitut law, method appropri highli nonlinear problems. accord comput homogen techniques, macroscop materi point associ microscop sampl (with relev heterogeneities) provid macroscop constitut behavior. implement finit element (fe) framework, method known fe2 [5] scheme. method computation expensive, prove valuabl flexibl (due lack assumpt macroscop constitut model) tool analyz wide rang heterogen materi complex microstructur highli nonlinear behavior see, others, [6, 7, 8] [9] recent review. open sourc program homogen problem recent avail [10]. concept crucial import homogen method repres volum element (rve). singl exact definit rve arbitrari heterogen material. explain exist definit rve, [11] recent review. contribution, consid microscop sampl rve (i) increas size lead consider differ homogen properties, (ii) micro sampl size larg homogen properti independ microstructur random (iii) rve size small separation-of-scal principl holds. implicit assumpt usual fe2 model exist rve. correct assumpt linear harden regim [11]. however, longer case soften regim standard homogen method [11]. past year homogen scheme adhes crack (or materi layers) [12, 13, 14, 15] cohes crack [16, 17] develop traction-separ law obtain base finit element com- putat microscal complex microstructur materi explicitli modelled. homogen adhes cracks, [14] exist rve soften materi (under tensil mixed-mod loading) exhibit diffus damag reported. result recent present [15] fibre-epoxi materi show discret cracking. recently, [17] author prove exist rve soften materials, adhes cohes cracks, deriv traction-separ law microscop inelast stress strains. method appli materi simpl microstructur undergo discret cracking. [18, 1], author develop mad (multiscal aggreg discontinuities) method macro- scopic crack determin equival bunch microscal cracks. method restrict case separation-of-scal principl violat micro sampl match macro element linked. comput multiscal method model crack microstructur length scale magnitud macroscop length scale given [19, 20]. [21], exist rve quasi-brittl materi (under tensil loading) random complex hetero- geneou microstructur exhibit diffus damag confirm base special averag scheme, failur zone averag scheme, filter linear contribut micro sample. manuscript depart result report [21], go deriv cohes laws, object respect micro sampl size, soften materi random heterogen microstructur subject tensile, shear mixed-mod loading. confirm rve exist soften materi microstructur undergo diffus damage. present comput framework incorpor object cohes law iter fe2 set extens approach given [17] micro discret crack failur micro diffus damag fracture. similar aspects, major differ 2 work [17] two-fold. firstly, microstructur paper exhibit diffus damag i.e., homogen macroscop cohes law microscal local band. secondly, repres macroscal cohes law obtain materi random microstructur load conditions. structur paper follows. section 2, investig microstructur util continuum damag model given. section 3 present standard averag scheme, propos failur zone averag techniqu follow seri numer simul confirm exist rve soften materials. section, section 4, describ energet equival theorem link macroscop microscop models. multiscal algorithm adhes cohes crack given section 5 follow numer exampl given section 6. 2. microstructur constitut model 2.1. microstructur 40 x 40 40 x 20 20 x 20 figur 1: investig unit cell regular microstructure. unit mm. paper, microstructur considered. simpl void microstructur (radiu void equal 5 mm) sampl dimens 20 20 mm2, 40 20 mm2 40 40 mm2 shown fig.(1) studied. second type microstructur analyz contribut random heterogen materi three-phas materi matrix, aggreg interfaci transion zone (itz) surround aggregate, fig.(2). sampl dimens 15 15 mm2 20 20 mm2, shown fig.(3), correspond 45% aggreg volum fraction investigated. detail gener procedur sampl [22]. note consid bigger sampl differ realiz statist analysi exist rve kind materi given [21]. 2.2. constitut model damag sampl model simpl isotrop damag model regular gradient enhanc method [23]. sake completeness, model briefli summar here. stress-strain relat given [24] = (1 )de : (1) 3 itz matrix aggreg figur 2: finit element mesh three-phas materi sample: view (left) close-up view (right). 15 15 mm2 20 20 mm2 figur 3: micro sampl random heterogen materi (45% aggregate). 4 scalar damag variabl fourth order tensor contain elast moduli. damag govern follow exponenti law = 1 [1 + exp(i)], (2) (residu stress), (soften slope) (damag threshold) denot inelast parameters. variabl largest nonloc equival strain eq reached. nonloc equival strain defin accord implicit gradient enhanc damag formul given [23] eq c 2eq = eq (3) eq mazar local equival strain [25] c posit valu paramet dimens length squared. void microstructure, materi paramet includ young modulu e 25000 mpa, poisson ratio 0.2, damag threshold 310 5, = 0.999, = 5000 c = 3.5 mm2. heterogen material, materi paramet given tabl 1. matrix aggreg itz e [n/mm2] 25000 30000 20000 [-] 0.2 0.2 0.2 [-] 5e-06 0.5 3e-06 [-] 0.999 0.999 0.999 [-] 1500 1500 1500 c mm2 0.2 0.2 0.2 tabl 1: materi paramet differ phase random heterogen material. 3. object macroscop cohes law n s xm1 xm2 u uh w t b rl macro micro mode mode ii figur 4: left right: macro sampl crack, micro model, boundari condit tensil shear loading. period boundari condit edg denot dash lines. materi period considered. consid macro crack outward unit normal denot n unit tangent vector repres s. micro sampl m, rectangl dimens w h, underli microstructur explicitli 5 model associ integr point macro crack. let consid case n coincid xm1 fig.(4) microscal orthogon coordin system. deform mode macro crack includ mode open mode ii shearing, boundari condit (bcs) micro model on given fig.(4) mode mode ii cases. mixed-mod problems, bc combin bc mode mode ii. extern boundari micro sampl denot m compos t, b, l r. 3.1. standard averag techniqu macroscop homogen stress m given [26] m 1 wh m md = 1 wh m tm xmd = 1 wh r tm (xr xl)d + 1 wh t tm (xt xb)d (4) us anti-period tractions. manuscript, subscript m m indic quantiti belong macro micro scale, respectively. micro stress tensor, traction vector posit vector denot m, tm xm, respectively. quantiti associ top, bottom, left right edg micro sampl indic subscript t, b, l r, respectively, fig.(4). follow relat xr xl = wn, xt xb = hs (5) equat (4) m = 1 h r tmd n+ 1 w t tmd s (6) adopt fact nt = (1, 0) st = (0, 1), simplifi m = f intr,x h f intt,x w f intr,i h f intt,i w (7) f intr f int t sum nodal intern forc right edges, respectively. note homogen stress tensor symmetr rotat equilibrium micro sampl i.e., wf intr,i = hf int t,x. homogen strain tensor m given [26] m 1 wh m md = 1 wh m (um sym n)d (8) diverg theorem convert domain integr surfac integral. oper sym denot symmetr dyadic product. micro strain tensor displac vector repres m um, respectively. 6 elabor m = 1 wh { t [(umt u m b ) sym s] d + r [(umr u m l ) sym n] d } = 1 h usym s + 1 w usym n (9) us period displac field equality. matrix form, homogen strain tensor given m = ux w 1 2 ( ux h + uy w ) sym. uy h (10) macroscop traction vector tm assum project macroscop stress tensor crack plane [13, 17]. tm m n = f intr h (11) us eq.(7). homogen stress-strain (xm, x m) curv traction-displac (t x m, ux) diagram void sampl (see fig.(1)) subject tensil load given fig.(5). result left show bulk homogenization, linear elast respons object micro model size (due fact elast slope stress-strain curv young modulu e dimension) soften branch are, however, micro model size dependent. complet analysi sampl size depend homogen stress-strain diagram quasi-brittl materi random microstructure, [11]. contrary, interfac homogen [15, 14]5, linear respons invers proport width sampl i.e., e/w dimension problems. obviously, bulk interfac homogen base standard averag theorem result object micro sampl size. figur (6) show damag distribut samples. remark 3.1. introduc numer imperfect trigger local left void sampl 40 20 mm2 40 40 mm2, fig.(6). note target materi brittl random heterogen material, fig.(2), failur accompani occurr propag local band, fig.(7) (no numer imperfect need here). void microstructur mere serv exemplari materi illustr idea low comput cost. introduct artifici imperfect void sampl mimic behaviour real random heterogen materials. note 40 20 mm2 40 40 mm2 sampl bifurc solutions, homogen respons 20 20 mm2 sampl captur differ bifurc path, differ homogen response, fig.(5). however, demonstr [21] (see fig.(8)b), homogen macroscop respons size-independ proper averag techniqu sampl follow differ bifurc paths. discuss bifurc solut microscal scope manuscript. refer [27] relat discussion. 5by interfac homogenization, homogen quantiti traction displac right edge. 7 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 st ss [ m p ] strain [-] (x10-3) 20x20 40x20 40x40 (a) stress-strain 0 0.1 0.2 0.3 0.4 0.5 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 tr ct io n [ m p ] displac [mm] (x10-2) 20x20 40x20 40x40 (b) traction-displac figur 5: void sampl tension: bulk vs interfac homogenization. figur 6: damag pattern sampl horizont tensil loading. 8 3.2. failur zone averag techniqu [21], author propos special averag scheme name failur zone averag scheme exist rve random heterogen quasi-brittl materi soften regim proved. sake completeness, averag scheme describ shortly. let denot d activ damag domain i.e., region contain gauss point damag loading. accord continuum damag model, domain correspond gauss point satisfi > f = 0 (f load function), fig.(7) graphic illustration. defin homogen stress strain volum averag microscop stress strains, respectively, d m dam = 1 |d| d mdd dam = 1 |d| d mdd (12) || denot measur domain. domain integr convert surfac integr m 6, comput directli numer quadrature. averag filter linear contribut make standard stress-strain diagram micro-sampl size dependent. e d du figur 7: definit damag domain d averag performed: d = m \ e(elastic) \ du(unload damaged). fig.(8) homogen stress-strain diagram void sampl (see fig.(1)) obtain standard averag scheme (left) new failur zone averag method (right) given. figur (8a) clearli demonstr soften regim uniqu size rve- result report [28, 11]. however, fig.(8b) show stress-strain curv independ micro sampl size turn mean exist rve soften materi stress strain defin propos failur zone averaging. note absenc linear branch present curv fact failur zone averag develop failur band. base observ plu statist analysi present [21], author confirm exist rve quasi-brittl materi random heterogen microstructur exhibit local failur continuum damag model. 6note standard averaging, section 3.1, homogen quantiti directli relat micro quantiti boundary. 9 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 st ss [ m p ] strain [-] (x10-3) 20x20 40x20 40x40 0 0.2 0.4 0.6 0.8 1 1.2 0 0.05 0.1 0.15 0.2 0.25 0.3 st ss [ m p ] strain [-] (x10-3) 20x20 40x20 40x40 figur 8: respons micro sampl regular microstructur obtain standard averag (left) failur zone averag (right). 3.3. traction-separ law previou section shown that, perform averag activ damag domain d, homogen stress-strain curv obtain object respect micro sampl size. follows, go present method extract macroscop cohes law microscop respons activ damag domain independ micro sampl size. end, let defin displac damag udam follow udam = dam (ln) (13) l averag width local band equal |d| /h, section 4 definit l. figur (9) plot traction versu damag open (txm, u x dam) curv 7 void sampl tension obvious independ sampl sizes. notic conclus appli portion curv peak. defin macro crack open [[u]]m damag open udam shift left udam damag open correspond maximum traction [[u]]m = udam udam (14) obtain initi rigid macroscop traction-open relations. figur (10) reveal fact traction-open (txm, [[u]] x m) 8 relat uniqu regardless sampl size result recent report [17] microstructur exhibit discret cracking. note similar eq.(14) equat (19) [17] defin macro open displac non-elast micro displacement. result hold continuum damag model relev soften materials. glanc result surpris traction tm reflect tensil stress level micro sampl failur displac udam evalu area damag growth. nevertheless, explain rigor manner proper energet equival theorem given section 4. 7the traction-displac diagrams, shown fig.(5), re-given compar interfac homogen propos scheme. 8we shown (tx m , ux dam ) curv present fig.(9) procedur udam [[u]]m easili followed. 10 0 0.1 0.2 0.3 0.4 0.5 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 tr ct io n [ m p ] displac [mm] (x10-2) 20x20 40x20 40x40 0 0.1 0.2 0.3 0.4 0.5 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 tr ct io n [ m p ] open [mm] (x10-2) 20x20 40x20 40x40 figur 9: void sampl tension: traction vs. appli displac (left) traction vs. normal damag displac ux dam (right). 0 0.1 0.2 0.3 0.4 0.5 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 tr ct io n [ m p ] open [mm] (x10-2) 20x20 40x20 40x40 0 0.1 0.2 0.3 0.4 0.5 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 tr ct io n [ m p ] open [mm] (x10-2) 20x20 40x20 40x40 figur 10: traction vs. crack open displac diagrams. left: standard (comput directli eq.(13)) right, shift obtain eq.(14). 11 3.4. sampl shear mix mode load analysi repeat void sampl (see fig.(1)) shear loading, refer fig.(11) damag distribut deform configuration. result shear load given fig.(12) figur result correspond standard averag scheme figur respons obtain failur zone averag scheme. observ standard averag technique, stress-strain (bulk homogenization) traction-separ (crack homogenization) diagram sampl size dependent. contrary, failur zone averag scheme used, stress-strain traction- separ curv independ sampl size equival rve exist soften materi shear loading. figur 11: damag pattern void sampl shear load (magnif factor 50). next, mix mode load (a displac (ux, uy) impos right edg micro sample) perform sampl result given fig.(13) row show result mode second row give behavior mode ii. observ traction-separ curv independ sampl size. 3.5. exist rve materi random microstructur analysi final appli sampl random complex microstructure, fig.(3), tensil shear load conditions. result given fig.(14) fig.(15) confirm independ homogen respons respect sampl size failur zone averag extract inelast respons occur samples. refer [21] statist studi exist rve materi tensil load condition. shear load studi sampl combin statist analysi necessari prove applic propos averag technique. fig.(16) typic damag pattern sampl given. 4. energet equival theorem fractur occur insid bulk materi interfac differ materials. former, fractur surfac term cohes crack latter, term adhes (or interfacial) crack used. case cohes cracks, homogen appli finit element model repres bulk materi crack. case adhes cracks, adopt micro model repres materi adhes layer. section develop link macro micro model cohes adhes cracks. 4.1. cohes crack section 3.2 object (dam, dam) curv demonstr numer experiments. shown (tm,udam) diagram independ micro sampl size well. follows, go prove mathemat repres (tm,udam) diagram provid object (dam, dam) 12 0 0.1 0.2 0.3 0.4 0 0.05 0.1 0.15 0.2 0.25 0.3 sh e r st ss [ m p ] shear strain [-] (x10-3) 20x20 40x20 40x40 (a) stress-strain 0 0.1 0.2 0.3 0.4 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 sh e r tr ct io n [ m p ] displac [mm] (x10-2) 20x20 40x20 40x40 (b) traction-displac 0 0.1 0.2 0.3 0.4 0.5 0.6 0 0.2 0.4 0.6 0.8 1 sh e r st ss [ m p ] shear strain [-] (x10-3) 20x20 40x20 40x40 (c) failur stress-strain 0 0.1 0.2 0.3 0.4 0 0.2 0.4 0.6 0.8 1 sh e r tr ct io n [ m p ] slide [mm] (x 10-2) 20x20 40x20 40x40 (d) traction-slid figur 12: behaviour void sampl shear loading. row, standard homogen bulk crack second row, failur zone averag scheme bulk crack. 13 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0 0.05 0.1 0.15 0.2 0.25 0.3 20x20 40x20 40x40 0 0.1 0.2 0.3 0.4 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 20x20 40x20 40x40 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 20x20 40x20 40x40 0 0.1 0.2 0.3 0.4 0 0.05 0.1 0.15 0.2 0.25 0.3 20x20 40x20 40x40 ux [mm] (10 2) uy [mm] (10 2) tx m [m p ] tx m [m p ] ty m [m p ] ty m [m p ] [[u]]xm [mm] (10 2) [[u]] y m [mm] (10 2) figur 13: void sampl mix mode loading: standard averag versu failuz zone averaging, x-compon (top) y-compon (bottom). 14 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 st ss [ m p ] strain [-] (x10-3) 15x15 20x20 (a) stress-strain 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0 0.1 0.2 0.3 0.4 0.5 0.6 tr ct io n [ m p ] open [mm] (x10-2) 15x15 20x20 (b) traction-open figur 14: bulk versu crack homogen random microstructur tensil loading. 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0 0.2 0.4 0.6 0.8 1 st ss [ m p ] strain [-] (x10-3) 15x15 20x20 (a) stress-strain 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0 0.2 0.4 0.6 0.8 1 1.2 1.4 tr ct io n [ m p ] open [mm] (x10-2) 15x15 20x20 (b) traction-open figur 15: bulk versu crack homogen random microstructur shear loading. figur 16: damag pattern random heterogen sampl tension. note failur band periodic. 15 d w h l m, m lin, lin dam, dam tm,udam heterogen failur band equival failur band equival crack figur 17: local band equival crack energet equival consideration. curv (which demonstr extens [21], fig.(8)). end, need prove follow equat dam : damlh = tm udamh (15) left hand energi dissip activ damag zone d right hand dissip energi equival macro crack. note l width equival failur band equal |d| /h, fig.(17). proof follows. right hand equat elabor tm udamh = [dam n] [dam n]lh = damij dam ik njnklh = damij dam ik jklh = dam ij dam ij lh (16) us eq.(13) fact tm equal dam n equilibrium, fig.(18). above, jk kroneck delta tensor9. compar left hand eq.(15) conclud proof. accord fig.(17), proof correspond transit equival failur band crack. appli hill-mandel theorem [29] activ damag domain d, write 1 |d| d m : mdd = dam : dam (17) note equat obtain consid d independ domain. mathemat proof equat missing, present numer evid valid eq.(17) section 4.3. eq.(15), 1 wh d m : mdd = 1 w tm udam (18) 9we switch posit subscript dam superscript indici notat conveni reading. 16 dam dam n n tm figur 18: equilibriuum forc result tm = dam n. note relat prove eq.(15). lh written differ virtual work micro sampl linear virtual work. therefore, write 1 wh m m : mdm 1 wh l m : mdl = 1 w tm udam (19) l linear domain i.e., l = m \ d. virtual work equat term equat hill-mandel condit second term, eq.(19) rewritten 1 wh m tm umd w l w lin : lin = 1 w tm udam (20) homogen linear stress strain lin lin given lin = 1 (w l)h l mdl lin = 1 (w l)h l mdl (21) order comput term lin : lin, consid rectangular homogen sampl subject traction tm right edge. stress sampl given linxx = t x m, lin yy = 0, lin xy = t y m (22) equat express matrix-vector notat voigt notat linxx linyi linxi = 1 0 0 0 0 1 [ txm t y m ] tm (23) tensor notat lin = tm (24) third-ord tensor = n n n+ (n s+ s n) s, firstli given [17]. 17 now, lin : lin written lin : lin = lin : d 1 lin : lin = ( tm) : [d 1 lin : ( tm)] = tmp [ ijp(d lin ijkl) 1klm ] tmm = tmp (pji(d lin jikl) 1klm clin pm )tmm = tm clin tm (25) note second-ord tensor clin project crack plane fourth-ord complianc tensor d 1 lin [17]. derivation, minor symmetri d1lin used. substitut eq.(25) eq.(20) yield 1 wh m tm umd = w l w tm clin tm + 1 w tm udam (26) 1 w tm ur = w l w tm clin tm + 1 w tm udam (27) boundari condit shown fig.(4) adopt comput lh eq.(26). above, ur displac vector right edg micro sample. fact hold true tm yield ur = (w l)clin tm + udam (28) rewritten ur = (w l)c0 tm + udam + um (29) c0 second-ord complianc tensor c evalu undeform microscal configur um given um = (w l)[clin c0] tm (30) local band formed, nonlinear total microscal displac ur assum complet govern damag open udam. words, um = 0, eq.(29) ur = (w l)c0 tm + udam (31) eq.(14), equat rewritten follow ur = (w l)c0 tm + [[u]]m + udam (32) equat provid scale transit relat microscal respons macroscal cohes law (traction tm separ [[u]]m). note case micro sampl undergo discret crack (l = 0), reduc eq.(17) given [17]. 18 macro micro case case ii w = tadh w < tadhtadh figur 19: schemat represent homogen scheme adhes crack thick tadh. case refer micro sampl have w = tadh case ii correspond micro sampl have w < tadh. period bc denot dash lines. 4.2. adhes crack wai homogen scheme adhes crack developed, fig.(19). accord wai micro sampl width chosen equal thick adhes crack tadh, refer case fig.(19). author [17] propos second approach micro sampl width smaller adhes crack thickness, refer case ii fig.(19). 4.2.1. case case, micro model cover complet thick adhes crack displac micro model ur directli relat macro jump ur = [[u]]m (33) bc micro model. solv micro model, macro traction tm given eq.(11), [15, 17]. 4.2.2. case ii case adhes crack tadh consider larger microstructur constitu addition geometri thick direct periodic, homogen appli micro model have width smaller tadh. homogen relat cohes crack, eq. (32) modifi case adhes crack thick tadh follows. w = tadh, ur = [[u]]m, eq.(32) [[u]]m = (tadh l)c0 tm + [[u]]m + udam (34) solv udam substitut eq.(32) yield ur = (w tadh)c0 tm + [[u]]m (35) provid homogen relat microscal inform macroscal cohes law (tm, [[u]]m). note equat resembl eq.(35) [17]. 19 remark 4.1. homogen scheme case similar homogen scheme bulk material, fig.(21). result obtain scheme refer refer solution. case ii homogen scheme adjust solut smaller micro model match refer solution. appar homogen scheme us failur zone averag techniqu entir respons micro model map macro adhes crack. remark 4.2. homogen schemes, case case ii, yield result, argu case sufficient. us case ii, however, offer follow benefit smaller micro sampl result comput efforts; smaller micro sampl minim possibl microstructur snapback appearances, increas robust method. 4.3. numer verif equat 17 equat (17) rewritten m : mdam = dam : dam state volum averag (over d) microscop work equal work averag (over d) stress strains. equat bear similar hill-mandel theorem standard homogen schemes, current unabl provid rigor proof it. instead, present numer evid satisfact eq.(17) shown fig.(20). samples, period microstructur random microstructure, analyz uni-axi tension test. consid materi three-phas materi describ section 2.1. seen eq.(17) practic verified. 0 2 4 6 8 10 12 14 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 w o rk [ -] ( x1 0 -6 ) strain [-] (x10-3) averag work work averag m : mdam dam : dam (a) period microstructur 0 5 10 15 20 25 30 35 40 45 0 0.5 1 1.5 2 2.5 w o rk [ -] ( x1 0 -6 ) strain [-] (x10-3) averag work work averag m : mdam dam : dam (b) random microstructur figur 20: numer evid equat (17). 5. comput multiscal crack model previou section shown traction-separ law object micro model size obtain materi simpl underli microstructur complex random microstructur load condit includ tensile, shear mixed-mod loading. cohes law util ways, sequenti homogen scheme semi-concurr homogen method e.g., fe2 20 bulk homogen cohes crack homogen adhes crack homogen m m,dm tm,tm tm,tm [[u]]m [[u]]m, tm h h figur 21: schemat present bulk homogenization, adhes crack homogen cohes crack homogenization. case typic sens fe2 setting: input micro fe model macro kinemat variabl output micro fe model work conjug variabl plu tangent. however, cohes crack, input micro fe model includ open plu traction solv simultan micro displacements. 21 setting. accord former, micro model properli chosen dimens determined, example, rve size quantif procedur given [22, 11, 30], numer load differ load conditions, result cohes law snapshot later macroscop fe comput standard phenomenolog constitut laws10. spirit latter, direct coupl macro model micro models. figur (21) give schemat represent exist comput homogen method bulk materi [6, 7, 5, 8], materi layer (or interfaces) [13, 15, 14, 12] cohes crack [17]. section present comput homogen scheme cohes adhes crack homogen relat develop section 4. 5.1. adhes crack homogenization-cas homogen materi layer w = tadh firstli discuss [12] small strain problem later [13] case finit deformations. section, algorithm small deform given detail deriv tangent matrix presented. provid tangent form readili incorpor code (not case [13]). case case adhes crack homogenization, fig.(19), 2 2 cohes tangent matrix tm-the tangent rate format macro cohes law tm = tm[[u]]m, determin follows. illustr assum node right edge, traction rate defin eq.(11) [ txm t y m ] = 1 h [ f r,x 1 + f r,x 2 f r,y 1 + f r,y 2 ] = 1 h [ 1 0 1 0 0 1 0 1 ] f r,x 1 f r,y 1 f r,x 2 f r,y 2 (36) converg linear micro model ku = f , forc right edg written kur = fr, [ txm t y m ] = 1 h [ 1 0 1 0 0 1 0 1 ] k11 k 12 k 13 k 14 k21 k 22 k 23 k 24 k31 k 32 k 33 k 34 k41 k 42 k 43 k 44 u r,x 1 u r,y 1 u r,x 2 u r,y 2 (37) k condens stiff matrix accord degre freedom node right edge, [8] discuss static condens procedure. write displac right edg term macro open displacement, write [ txm t y m ] = 1 h [ 1 0 1 0 0 1 0 1 ] mt k11 k 12 k 13 k 14 k21 k 22 k 23 k 24 k31 k 32 k 33 k 34 k41 k 42 k 43 k 44 1 0 0 1 1 0 0 1 [ [[u]]xm [[u]] y m ] (38) obvious show macro cohes tangent matrix given tm = 1 h m t k m (39) 10thei known micromechan deriv traction-separ laws. 22 converg micro fe model, micro stiff matrix k static condens obtain right edg micro stiff matrix k final equat give macro cohes tangent matrix. iter macroscop load step, procedur comput macro traction macro materi tangent provid macro open displac [[u]]m given box (1). box 1 adhes crack homogenization-cas i. 1. given [[u]]m 2. comput u = [[u]]m 3. appli displac u rve right edg 4. solv rve problem 5. comput macro traction eq.(11) 6. comput macro tangent eq.(39) 7. macro model proce standard fe 8. macro model convergence, updat state micro model state (displac intern variables) reset previou converg values. 5.2. adhes crack homogenization-cas ii given macro open displac [[u]]m, dimens (w, h) micro model adhes thick tadh, equat want solv um tm follow fint(um) = fext(tm) ur(um) = [w tadh]c0tm + [[u]]m (40) words, solv micro equilibrium eq.(40)1 satisfi homogen relat eq.(35). above, fint fext micro intern extern forc vector, respectively. [17] solv simultan um tm. mean sought-for macro traction tm extern forc appli right edg micro sampl eq.(40)2 similar constraint equat arc-length control methods. method consid direct force-control comput homogen crack modelling. current implementation, follow displacement-control procedure, present sequel. model elast behavior crack follows. denot thick macro crack tadh, displac impos micro model read ur = (w/tadh)[[u]]m 11. way, macro linear respons object micro sampl size. proof relat ur = (w/tadh)[[u]]m linear regim follows. term displacements, eq.(40)2 rewritten ur = w tadh w ulin + [[u]]m = w tadh w ur + [[u]]m (41) fact ulin = ur used. solv equat ur yield ur = w tadh [[u]]m (42) 11note tangent given eq.(39) case scale factor w/tadh. 23 conclud proof. peak micro model observed, appear neg eigenvalu macro tangenttm propos [31], switch us algorithm given box (2) kind multiscal constitut box soften branch. seen, propos scheme iter displacement-control comput homogen scheme model cracks. emphas iter procedur converg numer simul present here. appeal point iter scheme compar force-control scheme [17] micro level, standard fe procedur readili reus facilit incorpor method exist fe codes. box 2 iter displacement-control homogen adhes cracks-cas ii. 1. given [[u]]m u 0 lin 2. comput ur = [[u]]m + ( w tadh w ) u0lin 3. appli displac ur rve right edg 4. solv rve problem 5. comput macro traction tm eq.(11) 6. comput linear displac ulin = wc0tm, c0 = t d 1 0 7. check converg (a) comput total micro displac ur = w tadh w ulin + [[u]]m (b) check ||ur ur|| < ||ur||. no, step 2 u 0 lin = ulin. else, proce step 8 8. comput macro materi tangent eq.(39) proce usual superscript 0 denot quantiti previou converg macroscop load step. left edg fix period boundari condit impos edges, fig.4. box (2), converg toler d0 homogen elast matrix computed, pre-process step i.e., multiscal problem starts, standard bulk homogen method see, instance, [8]. 5.3. cohes crack homogen equat need solv um tm, given macro jump [[u]]m compat displac udam, fint(um) = fext(tm) ur(um) = [w l(um)]c0tm + [[u]]m + udam (43) consist micro equilibrium equat eq.(43)1 homogen relat eq.(32). similar case adhes crack present previou section, solv iter displacement-control procedur given box (3). adhes cohes crack handl common displacement-control framework depend local band width l micro displac um. mainli focu extract object cohes law respons micro sample, crack initiation/propag base macroscop maximum principl stress criterion crack growth direct comput base nonloc stress crack tip, instanc [32], convention adopt monoscal crack modelling. notic [20], crack initi growth 24 direct base microscop responses. iter displacement-control procedur cohes crack summar box (3). box 3 iter displacement-control homogen cohes cracks. 1. run macro model ult, 1.0 2. insert crack segment proper direct (a) initi 2 micro model associ 2 gauss point crack segment (b) load 2 micro model load control (c) comput initi damag open udam 3. given [[u]]m, u 0 lin l 0 (a) comput ur = [[u]]m + udam + ( w l0 w ) u0lin (b) appli displac ur rve right edg (c) solv rve problem (d) comput macro traction tm eq.(11) (e) comput linear displac ulin = wc0tm, c0 = t d 1 0 (f) comput new local band width l = |d| /h (g) check converg i. comput total micro displac ur = [[u]]m + udam + w l w ulin ii. check ||ur ur|| < ||ur||. no, step 3b ur = ur. else, proce step 4 4. comput macro materi tangent eq.(39) proce usual. achiev subdivid number small load steps. superscript 0 denot quantiti previou converg macroscop load step. box (3), macroscop maximum princip stress denot ult ultim strength materi is, multiscal framework, ultim load microscal model (thi quantiti current determin load micro sampl pre-process step). crack initi equat ult, 1.0, propos [17], ensur time continu condit [33] fulfil (thu enhanc robust crack growth algorithm) importantli solut procedur micro model diverge. propos algorithm incorpor numer code capac model crack e.g., pum-bas (partit unity) enrich finit element [34, 32]. macroscop bulk behav elast effect properti comput base numer homogen appli micro samples. given strain vector, macroscop stress vector given m = d0m (44) 5.4. algorithm aspect robust effici implement propos multiscal framework, algorithm aspect considered. [17] relat detail given, section discuss techniqu order robust multiscal scheme. like fe2 simul diverg (or more) micro problem(s) occur. straightforward remedi problem (i) resolv macro load step led micro diverg smaller step size (ii) sub-step impos displac ur number smaller steps. current implementation, option. sub-step scheme discuss 25 [35] option worth considered. needless say, comparison study, mean numer experiments, techniqu necessari choos effici topic study. emphas propos scheme deal snapback behavior occur micro models12. macroscop snapback handl by, instance, energy-bas arc-length control given [36]. 6. benchmark problem 6.1. adhes crack figur (22) give benchmark problem verifi propos multiscal scheme. aim check macroscop respons object micro sampl size. materi paramet micro model given section 2.2. macro bulk materi elast materi young modulu 25000 n/mm2 poisson ratio zero. note contrari cohes crack, adhes crack, macroscop bulk relat microstructur adhes crack. plane stress condit assum macro model micro model well. thick interfac tadh assum 40 mm. u w = 2 0 0 m m h = 100 mm 20 20 40 20 40 40 figur 22: crack model interfac elements. cohes law extract micro fe comput bulk materi obei phenomenolog linear elast constitut law. case adhes crack homogen scheme given box (1), macroscop load-displac diagram correspond 4020 4040 sampl (note sampl 2020 case) given fig.(23)-left. respons obvious object micro sampl size. figur (23)-right present macroscop respons sampl new iter homogen scheme given box (2). result practic coincident. observ macroscal newton-raphson iteration, iter scheme (box (2)) converg iter toler = 104. far peak, contribut elast process negligible, number requir iter usual two. 12it notic snapback like occur micro samples. 26 0 10 20 30 40 50 60 70 80 90 0 0.2 0.4 0.6 0.8 1 lo d [ n ] displac [mm] (x10-2) 40x20 40x40 0 10 20 30 40 50 60 70 80 90 0 0.2 0.4 0.6 0.8 1 lo d [ n ] displac [mm] (x10-2) 20x20 40x20 40x20 0 10 20 30 40 50 60 70 80 90 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 lo d [ n ] displac [mm] (x10-2) 40x20 40x40 0 10 20 30 40 50 60 70 80 90 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 lo d [ n ] displac [mm] (x10-2) 20x20 40x20 40x20 figur 23: adhes crack benchmark problem: macroscop load displac (u) curv obtain standard scheme (left) iter displacement-control homogen scheme (right). figur correspond ductil fractur ( = 3000) brittl fractur ( = 5000). 27 6.2. cohes crack figur (24) depict simpl crack growth simul problem, bar uniaxi tension discret 3 four-nod quadrilater elements. refer section 2.2 materi paramet micro model (except = 1000). maximum princip stress bar exce 0.4475 mpa, 95% micro model ultim load ult , vertic crack is, symmetry, insert middl element. behavior crack govern microstructur shown fig.(24). plane stress condit assum micro models. aim exampl verifi object macroscop respons respect util microstructures. u2 0 0 10010 10 20 20 40 20 40 40 figur 24: cohes crack model pum cohes law come microscop fe computations. symmetry, vertic crack (dash line) insert middl element violat fractur criterion. unit mm. figur (25) present macroscop load-displac (u) curv clearli independ microstruc- ture obtain homogen macroscop cohes law shown right figure. note macro crack insert slightli ultim load micro models, homogen cohes law ini- tialli rigid convent cohes models. analyz effect paramet crack initiation/propag criterion ult overal macroscop response. result, report fig.(26) 2020 sample, show hardli consider effect paramet overal behavior macroscop sample. observ load drop macroscop load-displac diagram fact microscop dimens magnitud macroscop one. 6.3. verif method dn verifi propos multiscal method, let consid exampl shown fig.(27) solut obtain multiscal model go compar obtain dn . shade region model damag materi (materi paramet section 2.2 = 3000) rest behav elastically. finit element mesh dn model given fig.(28). case shade region repres microstructur materi layer thick tadh = 20 mm, finit element mesh multiscal model (adhes crack-cas i) given fig.(29). adequaci multiscal 28 0 10 20 30 40 50 60 70 80 90 100 0 0.5 1 1.5 2 2.5 lo d [ n ] displac [mm] (x 10-2) 20x20 40x20 40x40 0 0.1 0.2 0.3 0.4 0.5 0 0.5 1 1.5 2 2.5 tr ct io n [ n ] open [mm] (x 10-2) 20x20 40x20 40x40 figur 25: cohes crack problem: object macroscop load-displac diagram obtain microstructur (left) homogen traction-open law (right). 0 10 20 30 40 50 60 70 80 90 100 0 0.5 1 1.5 2 2.5 lo d [ n ] displac [mm] (x 10-2) =0.95 =0.99 80 82 84 86 88 90 92 94 0.3 0.35 0.4 0.45 0.5 0.55 lo d [ n ] displac [mm] (x 10-2) =0.95 =0.99 figur 26: cohes crack problem: consequ crack initi moment overal macroscop respons (left) close-up view (right). 29 1 0 0 u 4040 20 figur 27: verif test: geometri boundari conditions. unit mm. solut judg fig.(30) present comparison load-displac curv multiscal (denot fe2) simul dns. multiscal solut captur peak load later stage lower comput time (in particular exampl dn simul time approxim 10 time multiscal method). figur 28: verif test-dn model: finit element discret (14024 bilinear elements). multiscal cohes crack homogen scheme, finit element discret macro micro model present fig.(31). adequaci multiscal solut judg fig.(32) compar load-displac curv multiscal model dn model. multiscal solut captur peak load later stage well. dn simul requir approxim 6 time comput time multiscal model. emphas problem crack path known priori, us dn impract microstructur resolv lead prohibit comput expense. 30 1 0 0 4040 20 20 figur 29: verif test-multiscal model (adhes crack): finit element discret (2 bilinear element linear interfac element) coars scale model typic fine scale model (512 bilinear elements). 0 5 10 15 20 25 30 35 40 45 0 0.002 0.004 0.006 0.008 lo d [ n ] displac [mm] dn fe2 figur 30: verif test: comparison load-displac curv dn multiscale-cas adhes crack scheme. c b 20 20 figur 31: verif test-multiscal model (cohes crack): finit element discret (3 bilinear elements) coars scale model typic fine scale model (512 bilinear elements). 31 0 5 10 15 20 25 30 35 40 45 0 0.002 0.004 0.006 0.008 lo d [ n ] displac [mm] dn fe2 figur 32: verif test: comparison load-displac curv dn multiscal cohes crack scheme. 7. conclus contribut macroscop cohes law (both mode mode ii), independ micro sampl size, obtain quasi-brittl materi random heterogen microstructur load condit cohes adhes cracks. achiev extract activ inelast respons occur micro sampl (rather respons micro sampl standard homogen schemes) determin equival homogen macroscop ones. paper confirm exist rve quasi-brittl materi random microstructur exhibit damag smear averag fashion tensil shear loadings. hill energet equival condit combin propos failur zone averag scheme, homogen relat macroscop adhes cohes crack obtain materi exhibit diffus damage. propos homogen scheme consid aggreg micro local band macro discontinu crack energet equival manner. homogen scheme implement standard strain-driven fe2 framework successfulli verifi simpl numer examples. propos homogen scheme object respect micro model size apart independ macro micro finit element discretizations. method verifi compar direct numer simulation. futur work (i) extens current propos energet equival condit case simultan diffus damag discret crack e.g., decohes materi interfac occur microstructure, (ii) statist analysi repres macroscop cohes law sampl subject mix mode load (iii) studi effect volum fraction aggregates, shape aggreg result cohes laws. acknowledg financi support delft center comput scienc engin (dcse) gratefulli acknowledged. author gratefulli appreci discuss dr. clemen verhoosel. [1] t. belytschko j.h. song. coarse-grain multiscal crack propagation. intern journal numer method engineering, 81(5):537563, 2010. 32 [2] o. van der sluis, p. j. g. schreurs, w. a. m. brekelmans, h. e. h. meijer. overal behaviour heterogen elastoviscoplast materials: effect microstructur modelling. mechan materials, 32(8):449462, august 2000. [3] p. m. suquet. local global aspect mathemat theori plasticity. a. sawczuk g. bianchi, editors, plastic today: modelling, method applications, page 279310, london, 1985. elsevier. [4] i. m. gitman, h. askes, l. j. sluys. coupled-volum multi-scal model quasi-brittl material. european journal mechan - a/solids, 27(3):302327, 2007. [5] f. feyel. multilevel finit element method (fe2) respons highli non-linear structur gener continua. method appli mechan engineering, 192:32333244, 2003. [6] r.j.m. smit, w.a.m. brekelmans, h.e.h. meijer. predict mechan behavior nonlinear hetero- geneou system multi-level finit element modeling. method appli mechan engineering, 55:181192, 1998. [7] s. ghosh, k. lee, s. moorthy. scale analysi heterogen elastic-plast materi asymptot homogen voronoi cell finit element model. method appli mechan engineering, 132:63116, 1996. [8] v. kouznetsova, w. a. m. brekelmans, f. p. t. baaijens. approach micro-macro model hetero- geneou materials. comput mechanics, 27(1):3748, 2001. [9] m. g. d. geers, v. g. kouznetsova, w. a. m. brekelmans. multi-scal comput homogenization: trend challenges. journal comput appli mathematics, 234(7):21752182, 2010. [10] a. abdul a. nonnenmacher. short versatil finit element multiscal code homogen problems. method appli mechan engineering, 198(37-40):28392859, 2009. [11] i.m. gitman, h. askes, l.j. sluys. repres volume: exist size determination. engin fractur mechanics, 74(16):25182534, 2007. [12] k. matous, m. g. kulkarni, p. h. geubelle. multiscal cohes failur model heterogen adhesives. journal mechan physic solids, 56(4):15111533, 2008. [13] c. b. hirschberger, s. ricker, p. steinmann, n. sukumar. comput multiscal model heteroge- neou materi layers. engin fractur mechanics, 76(6):793812, 2009. [14] m. g. kulkarni, p. h. geubelle, k. matous. multi-scal model heterogen adhesives: effect particl decohesion. mechan materials, 41(5):573583, 2009. [15] m.v. cid alfaro, a.s.j. suiker, c.v. verhoosel, r. borst. numer homogen crack process fibre-epoxi layers. european journal mechan - a/solids, 29(2):119131, 2010. [16] c. v. verhoosel, j. j. c. remmers, m. a. gutierrez. partit unity-bas multiscal approach model fractur piezoelectr ceramics. intern journal numer method engineering, 2009. [17] c. v. verhoosel, j. j. c. remmers, m. a. gutierrez, r. borst. comput homogenis adhes cohes failur quasi-brittl solids. intern journal numer method engineering, 2010. 33 [18] t. belytschko, s. loehnert, j.h. song. multiscal aggreg discontinuities: method circumv loss materi stability. intern journal numer method engineering, 73(6):869894, 2008. [19] a. hund e. ramm. local constraint multiscal model non-linear materi behaviour. interna- tional journal numer method engineering, 70(13):16131632, 2007. [20] t.j. massart b.c.n. mercatoris. assess period homogenisation-bas multiscal comput scheme quasi-brittl structur failure. intern journal multiscal comput engineering, 7(2):153170, 2009. [21] v.p. nguyen, o. llobera valls, m. stroeven, l.j. sluys. exist repres volum soften quasi-brittl materials-a failur zone averag scheme. method appli mechan engineering, 2010. press, correct proof. [22] m. stroeven, h. askes, l. j. sluys. numer determin repres volum granular materials. method appli mechan engineering, 193(30-32):32213238, 2004. [23] r. h. j. peerlings, r. borst, w. a. m. brekelmans, j. h. p. vree. gradient enhanc damag quasi-brittl materials. intern journal numer method engineering, 39:33913403, 1996. [24] j. lemaitre. cours damag mechanics. springer-verlag, 1996. [25] j. mazar g.pijaudier-cabot. continuum damag theori - applic concrete. journal engin mechan divis asce, 115:345365, 1989. [26] t.i. zohdi p. wriggers. introduct comput micromechanics. springer-verlag, 2005. [27] k. matou p.h. geubelle. multiscal model particl debond reinforc elastom subject finit deformations. intern journal numer method engineering, 65:190223, 2006. [28] i.m. gitman, h. askes, l.j. sluys, o. lloberas. concept repres volum elastic, harden soften materials. proceed xxxii intern summer school-confer advanc problem mechanics, page 180184, saint petersburg (repino) russia, 2004. [29] r. hill. constitut macro-vari heterogen solid finit strain. proc. r. soc. lond., 326:131147, 1972. [30] c. pelissou, j. baccou, y. monerie, f. perales. determin size repres volum element random quasi-brittl composites. intern journal solid structures, 46(14-15):28422855, 2009. [31] t. j. massart, r. h. j. peerlings, m. g. d. geers. enhanc multi-scal approach masonri wall compu- tation local damage. intern journal numer method engineering, 69(5):10221059, 2007. [32] g. n. well l. j. sluys. new method model cohes crack finit elements. intern journal numer method engineering, 50(12):26672682, 2001. [33] k. d. papoulia, c.h. sam, s. a. vavasis. time continu cohes finit element modeling. intern journal numer method engineering, 58(5):679701, 2003. [34] n. moes, j. dolbow, t. belytschko. finit element method crack growth remeshing. intern journal numer method engineering, 46(1):131150, 1999. 34 [35] d.d. somer, e.a. souza neto, w.g. dettmer, d. peric. sub-step scheme multi-scal analysi solids. method appli mechan engineering, 198(9-12):10061016, februari 2009. [36] c. v. verhoosel, j. j. c. remmers, m. a. gutierrez. dissipation-bas arc-length method robust simul brittl ductil failure. intern journal numer method engineering, 77(9):1290 1321, 2009. 35 view public statsview public stat introduct microstructur constitut model microstructur constitut model object macroscop cohes law standard averag techniqu failur zone averag techniqu traction-separ law sampl shear mix mode load exist rve materi random microstructur energet equival theorem cohes crack adhes crack case case ii numer verif equat 17 comput multiscal crack model adhes crack homogenization-cas adhes crack homogenization-cas ii cohes crack homogen algorithm aspect benchmark problem adhes crack cohes crack verif method dn conclus