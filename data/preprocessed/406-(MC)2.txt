adjoint-bas adapt finit element method compress euler equat finit calculu mohammad kouhi, eugenio onat dimitri mavripli correspond author: e-mail: august 3, 2015 abstract paper, adjoint-bas error estim mesh adapt framework devel- op compress inviscid flows. algorithm emploi finit calculu (fic) scheme numer solut flow discret adjoint equat context galerkin finit element method (fem) triangular grids. fic scheme treat instabl normal gener numer solut fluid equat ad stabil terms, call streamlin term transvers term, origin central-bas discret formulation. non-linear equat result flow problem solv implicitli damp newton method accompani exact jacobian matrix. defect correct scheme implement iter solv linear equat relat adjoint problem benefit transpos jacobian matrix. iteration, linear system equat result fluid adjoint problem solv precondit gmre method. have cal- culat error specifi output function locally, h-refin methodolog base element subdivis perform refin candid elements. qualiti numer result prove capabl present approach adjoint-bas error estim mesh adapt problem differ flow regimes. keywords: compress euler equations; stabil finit element; finit calculus; dis- crete adjoint; h-refin 1 introduct adapt mesh refin (amr) effici mean reduc overal comput cost numer solut engin fluid problem model com- pressibl euler navier-stok equat [14]. basic idea amr control mesh resolut gener appropri fine mesh near zone solut error high assign coars mesh rest domain. techniqu abl improv accuraci flow solut high-error zone boundari layers, stagnat point shock waves. effect amr remark numer solut fluid flow emploi optim problem [5] appropri evalu practic output function lift drag coeffici important. main compon amr techniqu reliabl error estimator/ind mesh refin methodology. error estimator/ind introduc area current mesh refin need enhanc current mesh area ad new element task mesh refin methodology. base call feature-bas methods, consid flow gradient [4, 6] flow curvatur [3, 7, 8] error indic predict area refin needed. areas, fluid flow complex featur shock waves, boundari layer stagnat points. famili error indic predict flow featur accurately, necessarili provid effici estim practic engin output (such lift drag) wide design optim process. 1 *manuscript click view link refer order resolv drawback, famili error estimators/indicators, call output- base methods, develop recent emploi sensit specifi output function respect flow solut sensit predict implement adjoint variables. gener idea method estim global error output function inner product flow residu adjoint variabl posteriori. end, set problems, flow problem adjoint problem, need solv current coars mesh. numer solut flow equat provid flow variables, adjoint variabl evalu numer solut adjoint equations. applic output-bas method estim global error, consid local error indic zone function error desir tolerance. applic output-bas error estim mesh adapt method adjoint variabl context finit volum studi pierc gile [9] poisson equat nonlinear quasi-one-dimension euler equations. fol- lowing, pierc gile [10] investig approach two-dimension inviscid shock prob- lems. extens method compress two-dimension inviscid viscou flow deliv venditti darmof [11, 12]. park [13] emploi approach incompress compress three-dimension euler problem nemec et al. [14] demonstr complex geometries. context finit element discret method, becker rannach [15] develop adjoint-bas error estim mesh adapt viscou fluid flow, chemic reactiv flow, elasto-plast radi transfer problems. following, rannach [16] studi approach incompress viscou flow gile et al. [17] demonstr capabl techniqu drag lift coeffici bodi immers incompress viscou flow. base recent develop discontinu galerkin finit element method fluid problems, implement adjoint-bas error esti- mation present inviscid [18, 19] turbul viscou [20] flows. comprehens review adjoint-bas error estim mesh refin method comput fluid dynam laminar reynolds-averag navier-stok applic carri fidkowski darmof [21]. adjoint equat origin develop pironneau [22] jameson [23] com- putat deriv output function emploi gradient-bas optim methods. order solv adjoint equat differ procedures, continu formul discret formulation, develop researchers. continu- ou formul continu form govern flow equat differenti discretized, discret formul directli differenti discret form govern equations. continu adjoint formul advantag memori requirements, implement discret formul increas recent simplic implement uniqu capabl provid exact discret sensitivities. simplic come fact transpos global jacobian matrix, calcul implicit solut flow equation, util directli solut linear equat aris discret adjoint formulation. hand, treatment boundari condit straightforward case discret formulation. comprehens comparison continu discret adjoint formul present [24]. import properti relat adjoint-bas error estim adjoint consist ensur discret adjoint problem consist discret continu one. error estim problems, adjoint inconsist discret lead unsmooth oscillatori adjoint solut discontinu element deliv adapt un- necessari area lead suboptim converg rate function estim [25]. particular, discret base high-ord elements, enforc adjoint consist essenti obtain superconverg function estim [26, 27]. signific inter- est studi adjoint consist context finit differ method [28], stabil continu finit element method [27, 2933] discontinu galerkin finit element method [25, 34, 35]. central-bas discret formul emploi flow equations, establish fact addit stabil term origin equat re- 2 sult discret flow problem essenti avoid occurr numer instabl [36, 37]. famili stabil techniques, call finit cal- culu (fic) method successfulli implement stabil advective-diffus transport incompress fluid flow problem [3843]. recently, fic-bas stabil for- mulat numer solut compress euler navier-stok equat propos context galerkin fem kouhi onat [44, 45]. system equat obtain flow adjoint problem contain eigenvalues, stabil techniqu develop flow equat implement solv adjoint problem well. article, extend implement fic-fem stabil formul present [44] develop adjoint-bas error estim mesh adapt framework compress- ibl inviscid flows. equat obtain discret flow problem solv implicitli damp newton method benefit exact jacobian matrix propos [45]. iter step, inher linear result flow equa- tion solv precondit gmre method. transpos jacobian matrix, construct discret flow equat contain fic-bas stabil terms, emploi solut adjoint equations. paper, adjoint consist propos stabil method investig check smooth continu adjoint solut obtain present examples. amr perform local contribut function error conjunct classic h-refin methodology, candid element divid divid edg element two. order demonstr capabl fic-fem stabil formul output-bas error estim problems, exampl presented. studi qualiti results, present stabil formul provid stabil numer solut adjoint equat yield accur estim function error amr process. layout paper following: section 2 compress euler equat fic-fem stabil formul described. section 3 present deriv output-bas error estim adapt mesh refin method adjoint variables. solut strategi flow adjoint equat explain section 4. numer result correspond propos error estim mesh refin strategi differ output function subsonic, transon superson flow regim shown section 5. finally, conclus gener remark summar section 6. 2 flow problem formul 2.1 govern equat two-dimension (2d) compress euler equations, includ mass balance, momentum energi equations, consid work written follow conserv form u t + fi xi = 0 = 1, 2 (1) u f vector conserv variabl inviscid fluxes, respectively, express u = v1 v2 e fi = vi v1vi + pi1 v2vi + pi2 vi(p+ e) (2) , v, p e density, veloc vector, static pressur total intern energi unit mass, respectively. equat i, j = 1, nd nd number space dimens (nd = 2 2d flow problems) ij kroneck delta. defin r ideal ga constant neglect chemic reactions, equat state ideal ga follow form p = rt (3) 3 t temperatur ga obtain t = 1 r (e 0.5vjvj) (4) ratio specif heats. standard sum convent term repeat indic adopt paper, specified. 2.2 deriv stabil formul defin rd, rmi differenti form mass balanc equation, ith momentum equat energi equation, respectively, rd := t + (vj) xj (5) rmi := (vi) t + xj (vivj) + p xi (6) := (e) t + xj (vj(e+ p)) (7) i, j = 1, nd. stabil formul euler equat base fic scheme, present [44, 45], obtain rd 1 2 (1 ) sgn(rd) || .rd 1 2 1 |v|+ vc .(.fmi) = 0 (8) rmi 1 2 (1 ) sgn(rmi) vi |vi| .rmi 1 2 v |v|+ vc .rmi = 0 (9) 1 2 (1 ) sgn(re) t |t | .re 1 2 v |v|+ vc .re = 0 (10) constant coeffici rang zero one, characterist element size, sgn(.) denot sign function, |v| modulu veloc vector vc = p speed sound flow. also, .fmi diverg flux term correspond ith momentum equat express .fmi = (vivj) xj + p xi (11) detail deriv equat (8), (9) (10) [44, 45]. 2.3 space discret order discret obtain stabil formulation, finit element method (fem) select vector conserv variabl u approxim u u u = n j=1 njuj (12) vector u contain approxim valu correspond conserv variables. n matrix interpol shape functions, subscript index j repres valu j th node n number node element. work us 3-node triangl linear shape function (n = 3). 4 let defin approxim residu vector r rst vector approxi- mate primit variabl u r = rd rm1 rm2 rst = 1 rm1 rm2 u = vx vy t (13) rd, rmi denot finit element residu mass balanc equation, ith momentum equat energi equation, respectively. appli galerkin fem equat (8), (9) (10), integr inviscid flux term stabil term part neglect boundari contribut stabil terms, gener form fic-fem stabil formul problem domain boundari = obtain n. u t d n xi .fid+ n.fnd + nel e e 2 ai n xi .rstd+ nel e e 1 2 s n xi . u xi d = 0 (14) nel number element = 1, 2 (for 2d problems). equation, fi fn ith compon approxim inviscid flux vector f vector inviscid boundari flux normal vector boundary, respectively. equat (14), = |v|+vc stabil paramet stabil matric s ai s = (1 ) |rd| | u1| 0 0 0 0 |rm 1 | | u2| 0 0 0 0 |rm 2 | | u3| 0 0 0 0 |re| | u4| ai = .fmi 0 0 0 0 vi 0 0 0 0 vi 0 0 0 0 vi (15) .fmi diverg approxim finit element flux term correspond ith momentum equation. detail deriv propos stabil formul treatment boundari condit [44, 45]. discuss references, assumpt = 0.5 = (2e)1/2 e element area 2d problem suitabl results. hence, assumpt taken work. neglect tempor deriv term (i.e. term) equat 14 assem- bling element contribut equat (14), steady-st flow residu vector ri(u) correspond ith global node defin ri(u) = ni xi .fid+ ni .fnd + nel e e 2 ai ni xi .rstd+ nel e e 1 2 s ni xi . u xi d = 0 (16) subscript index repres valu correspond ith node. equat (16) non-linear equat solut present section 4.1. 5 3 output-bas amr 3.1 adjoint-bas error estim formul consid spatial domain resolut h relat coars mesh discretization. corre- spond output function jh defin jh = jh(uh) (17) uh vector discret flow variabl obtain satisfi non-linear flow equat rh(uh) = 0 coars mesh. also, consid spatial domain resolut h relat fine mesh discretization. assum uh solut flow equat rh(uh) = 0 fine mesh, output function jh express form jh = jh(uh) (18) let defin uhh flow variabl obtain spatial domain resolut h project spatial domain resolut h. general, taylor expans function jh (onli consid linear terms) solut uhh express jh(uh) jh(u h h ) + [ jh uh ] u h h (uh u h h ) (19) jh(u h h ) function valu fine mesh calcul u h h . also, vector [ jh uh ] u h h contain sensit function fine mesh respect flow variabl evalu uhh . defin t linear approxim total error function evalu fine mesh project solut coars one. equat (19), t repres t = jh(uh) jh(u h h ) = [ jh uh ] u h h (uh u h h ) (20) mention uhh essenti equal uh, u h h necessarili satisfi rh(u h h ) = 0. hence, equat (20) yield nonzero valu t. expans introduc jh(uh) equat (19) written flow residu rh(uh) follow form rh(uh) rh(u h h ) + [ rh uh ] u h h (uh u h h ) (21) [ rh uh ] u h h jacobian matrix flow residual, present equat (16), evalu uhh fine mesh. consid fact thatrh(uh) = 0, solut error (uhu h h ) appear equat (21) repres (uh u h h ) [ rh uh ] 1 u h h r(uhh ) (22) substitut equat (22) (20) give follow express total function error t = [ jh uh ] u h h [ rh uh ] 1 u h h rh(u h h ) (23) equat state evalu total function error t involv invers jacobian matrix process high comput cost. order avoid invert jacobian matrix directly, discret adjoint equat defin [ rh uh ]t u h h (h)uh h = [ jh uh ]t u h h (24) 6 (h)uh h vector discret adjoint variabl calcul uhh fine mesh. equat (24), formul total function error present equat (23) transform t = (h) t u h h rh(u h h ) (25) equat (25) deduc evalu total function error fine mesh requir adjoint variabl obtain solv discret adjoint equat (24) fine mesh. main idea prevent solv equat fine mesh, approxim (h)uh h solv adjoint equat initi coars mesh [ rh uh ]t h = [ jh uh ]t (26) h vector contain discret adjoint variabl correspond coars mesh. discret adjoint variabl comput coars mesh, project valu coars mesh fine mesh, call hh , calcul approxim discret adjoint variabl correspond fine mesh. let defin comput function error correct c approxim total function error t. project adjoint variables, c express t c = ( h h ) t rh(u h h ) (27) equat state c obtain inner product vector project adjoint variabl vector nonzero residuals. contrast equat (25), equat demonstr function error approxim predict solut fine mesh solv flow adjoint equat coars mesh proper project procedur fine mesh level. note project oper implement flow solut util discret adjoint variabl work. solut method equat (26) present section 4.2. 3.2 adapt criteria element-wis error indic ik defin contribut c correspond kth element belong coars mesh h form ik = ( h h ) t krh(u h h ) (28) fact, local error indic element k obtain inner product project adjoint variabl local residu vector comput subel element k coars mesh. order candid element refinement, adapt criteria emploi local error indic element compar element allow error |ik| > etol nel (29) etol denot posit desir error toler nel number element coars mesh. element satisfi equat (29) consid candid element refinement. 3.3 refin methodolog mesh refin methodolog implement work isotrop h-refin scheme candid element subdivid subelements. element subdivis process carri insert extra point edg midpoint suit triangl elements. candid element connect curv boundary, new insert point edg belong boundari adjust origin boundari surface. reason, correct coordin new surfac point perform end 7 adapt level implement quintic spline interpol base coordin origin surfac points. geometr interpret process depict figur 1. (a) (b) figur 1: isotrop mesh refin near curv boundary. (a) correction, (b) correction. consider taken account possibl gener hang point edg element split new point candid neighbour elements. case element hang point, anisotrop refin subel implemented, element hang point divid regularli subelements, shown figur 2. order qualiti mesh, anisotrop subel allow refin further. element requir refinement, anisotrop subel remov origin coars element isotrop refin subelements. figur 2: mesh refin process hang nodes: (a) isotrop refin candid elements, (b) isotrop refin element presenc hand nodes, (c) anisotrop refin element presenc hang node. 3.4 amr procedur error estim mesh adapt algorithm present work consist fol- low step 1- obtain flow variabl uh solv equat (16) coars mesh. 2- comput adjoint variabl h solv equat (26) coars mesh converg flow solut uh . 3- evalu project flow variabl uh h project adjoint variabl h h . 4- candid element refin equat (28) (29). 5- candid element exist, refin coars mesh return step 1. 8 amr procedur finish candid element refinement. mention refin level solut flow adjoint equat start previous project variables. project flow adjoint variabl current coars mesh embed fine perform linear higher-ord interpol method. requir valu solut coars mesh points, involv calcul least-squar gradient solution. work, suitabl result obtain simpl linear interpol method. 4 solut method section, solut strategi flow adjoint equat given equat (16) (26), respectively, presented. exact jacobian matrix need solut adjoint equat (see equat (26)), iter newton linear scheme exact jacobian matrix chosen solut approach nonlinear flow equat (i.e. equat (16)). adjoint equat given equat (26) correspond linear equations. solv directly, iter scheme present transfer equat defect correct form. 4.1 flow solut solut equat (16) perform follow newton method [ r u ]n = r(un) = un+1 (30) n iter number. begin solution, newton solver diverg start-up transient caus poor initi flow field. order overcom problem, damp newton method implement diagon term jacobian matrix augment damp factor [ ijmij ti + ri uj ]n unj = ri(u n) mij = ninjd (31) i, j = 1, nnode nnode total number node mesh m global mass matrix. equation, nodal (and pseudo) time step ti minimum element time step correspond element connect node i. element time step te candid element e determin uniform cfl number domain te = cfl |v|+ vc (32) work cfl number respons ad scalabl damp term startup process follow form cfl(n) = min(ncfl(0), cfl(max)) (33) cfl(0) = 0.01, cfl(max) = 1012 select 1.1 10.0 depend problem. pattern cfl, increas pseudo time step larg valu (cfl = 1012) damp unsteadi term vanish desir quadrat converg rate newton method achieved. linear equat (31) consist spars block matrix solv gmre method describ [46]. order improv converg method, precondit gmre algorithm base block-diagon precondit implement work. 9 4.2 adjoint solut omit subscript h equat (26), defect correct form adjoint equat written [ ijmij ti + [ r u ]t ]k kj = [ j u ]t [ r u ]t k k = k+1 k (34) k denot iter number. seen equation, pseudo time term ad diagon compon jacobian matrix provid diagon domin solver. direct benefit defect correct method. final converg solut obtain continu increas time step ti pattern present equat (32) (33). similarli flow equations, block-diagon precondit gmre method solut linear equat iter step equat (34). compar iter scheme develop solut flow adjoint equat (equat (31) (34)), system coeffici matrix except transpose. transpos oper chang eigenvalu coeffici matrix, system convergence. current work, hand-cod linear galerkin term stabil term equat (16) implement give spars jacobian matrix unstructur triangular mesh work. jacobian matrix base final steady-st flow solut store emploi solut adjoint equation. 5 numer result section, set numer exampl relat propos adjoint-bas error estim adapt mesh refin presented. exampl involv subson flow gaussian bump consist parts. firstly, behavior propos fic-fem formul conjunct present damp newton solver validated. second part, accuraci adjoint-bas error estim examin compar predict error obtain total function error t comput function error correct c true function error mesh levels. part, adapt mesh relat present element-wis error indic ik error converg graph deliv consid lift coeffici output functional. examples, capabl method presenc shock wave evalu studi transon flow naca0012 airfoil superson flow ramp. adapt level present examples, comput flow solver adjoint solver advanc fulli converg correspond residu machin zero (1e 14 doubl precision) obtained. error converg graph reduct function error versu number node accumul comput cost cpu time. comput cost correspond refin level consist consum cpu time solut flow adjoint equat previou refin level plu extra cpu time flow solut current adapt mesh. initi solut refin level obtain interpol converg flow solut previou level old mesh new one. uniform mesh refinement, comput cost includ cpu time singl flow solut uniformli refin mesh. 5.1 exampl i: subson flow bump compress flow freestream mach number 0.35 pass gaussian bump studi demonstr effect develop error estim adapt techniqu 10 subson regime. bump maximum thick 0.08 place center rectangular domain height 2 length 4. initi unstructur mesh, shown figur 3, contain 952 node 1902 3-node triangles. slip wall condit impos boundary, far field condit appli rest boundaries. figur 3: subson flow bump. initi uniform mesh. 1- flow adjoint solver main error estim mesh adapt procedur solut flow adjoint equations, characterist solver term accuraci effici affect qualiti final result adapt mesh refin process. reason, assum lift coeffici functional, numer result correspond solut flow adjoint equat initi mesh deliv demonstr behavior propos fic-fem formul conjunct present damp newton solver. obtain contour correspond pressur compon momentum adjoint variabl present figur 4 indic propos fic-fem formul give rise smooth solut domain coars mesh. smooth continu adjoint solut near boundari element demonstr consist present discret adjoint formul base fic-fem scheme. converg graph flow adjoint solver present iter strategi shown figur 5 quadrat converg obtain flow solver iter initi transient disappear cfl number slowli allow grow maximum value. expected, similar converg rate machin zero obtain adjoint equation. 11 (a) (b) figur 4: subson flow bump. (a) pressur contour (b) compon momentum adjoint variabl correspond initi uniform mesh. figur 5: subson flow bump. converg flow adjoint equat initi coars mesh. 2- error predict deliv scheme error predict valid set meshes, call coarse, intermedi fine mesh, consist 952, 3728 14852 nodes, respectively, lift coeffici consid output functional. idea compar true function error deduc mesh level on obtain total function error t comput function error correct c. 12 obtain valu function error correspond lift coeffici ratio valu demonstr tabl 1. seen ratio valu obtain total correct error asymptot approach uniti spatial resolut increased. expected, better compat true total error valu observ finest discretization. demonstr ratio valu correspond total error indic con- sider linear term taylor expans functional, present equat (19), capabl predict function appropriately. hand, ratio valu cor- respond correct error illustr propos project method adjoint variabl abl predict function error accurately. tabl 1: subson flow bump. comparison total correct adjoint predict error exact error lift coefficient. mesh exact t c t/exact c/exact coars 0.001562 0.001649 0.0012332 1.055 0.788 intermedi 0.0004081 0.0004233 0.0003507 1.037 0.859 fine 0.0001115 0.0001150 0.0001050 1.031 0.941 3- mesh adapt valid flow adjoint solver error predict scheme, effici develop adjoint-bas mesh adapt strategi present local error indic ik studi exampl consid lift coeffici output functional. procedur begin uniform mesh, previous shown figur 3, ter- minat criteria attain toler order 4 104 output functional. example, true function comput solut adapt mesh obtain refin initi mesh rel function differ order 105 consid consecut adapt meshes. figur 6 depict final adapt mesh obtain level refin consist 1472 nodes. figur indic major refin perform bump solut greater influenc output functional. also, obtain pressur contour compon momentum adjoint variabl correspond final adapt mesh present figur 7 demonstr final adapt mesh deliv smoother contour comparison on obtain initi uniform mesh plot figur 4. figur 6: subson flow bump. final adapt mesh lift coeffici refin levels. 13 (a) (b) figur 7: subson flow bump. (a) pressur contour (b) compon momentum adjoint variabl correspond final adapt mesh. figur 8a show converg lift error versu number node error converg adapt method compar uniform method. figur demonstr adapt approach refin level give rise rel similar function error uniform approach lower number nodes. example, mention number node gener adapt approach second refin level 8% gener uniform approach. (a) (b) figur 8: subson flow bump. comparison error converg lift coeffici relat uniform adapt mesh refin versu (a) number node (b) cpu time (sec). impress behaviour seen figur 8b cpu time comparison adapt approach demand cpu time uniform method smaller 14 number node resolv mesh adapt process. again, compar cpu time approach second refin level, seen comput cost consum adapt approach 11% uniform method. worth note cpu time adapt approach involv flow adjoint solut previou levels, cpu time singl flow solut refin mesh count case uniform approach. figur 9 depict converg graph lift coeffici correspond adapt refin error estim correct term relat uniform refinement. observ refin level adapt mesh produc nearli function valu obtain uniform mesh. although, agreement correct function valu calcul on adapt mesh poor primari refin levels, better agreement obtain refin levels. improv fact correct term calcul project adjoint variabl reduc mesh size project process deliv better agreement exact project values. figur 9: subson flow bump. converg graph lift coeffici differ refin methods. 5.2 exampl ii: transon flow past naca0012 example, transon flow past naca0012 flow conditionsm = 0.8 = 1.25 consid involv strong shock wave upper airfoil weak shock wave lower side. assum circular domain initi discret 3820 node 7258 3-node triangles. analysi domain detail initi mesh near airfoil shown figur 10. slip wall condit impos airfoil surface, far field condit appli outer boundary. adjoint-bas mesh adapt lift coeffici util exampl toler 104. 15 (a) (b) figur 10: transon flow past naca0012. (a) initi mesh gener circular domain; (b) detail mesh near airfoil. obtain pressur contour correspond initi mesh shown figur 11a demonstr fic-fem formul abl captur shock wave appear solut flow equation. contour relat compon momentum adjoint variabl obtain initi mesh depict figur 11b. result fic-fem formul yield smooth continu solut adjoint equat demonstr consist discret adjoint formul presented. (a) (b) figur 11: transon flow past naca0012. (a) pressur contour (b) compon momentum adjoint variabl correspond initi mesh. gener adapt mesh refin level shown figur 12a contain 8231 node 15874 3-node triangles. expected, mesh refin carri near zone higher import like lead trail edg vicin shock waves. obtain pressur contour refin level present figur 12b. note refin mesh deliv sharper shock wave comparison initi mesh. 16 (a) (b) figur 12: transon flow past naca0012. final result refin level lift coefficient: (a) adapt mesh (b) pressur contours. capabl propos error estim correct method demonstr figur 13a converg graph lift valu obtain differ refin method versu number node depicted. comparison converg graph relat uniform adapt mesh refin confirm function valu refin level obtain adapt method close agreement on obtain uniform refin method. also, predict valu refin level provid ad correct term compar on calcul adapt mesh. primari level larg differ observ correct function valu calcul ones, correct valu closer calcul on refin advanc refin level valu coincident. figur 13b show cpu time comparison uniform adapt meshes. seen larg save enhanc adjoint-bas mesh refinement. example, comput cost second refin level relat adapt mesh 17.5% relat uniform mesh. 17 (a) (b) figur 13: transon flow past naca0012. converg graph predict lift coeffici differ refin method versu (a) number node (b) cpu time (sec). 5.3 exampl iii: superson flow ramp example, flow mach number 3.0 pass ramp angl 19 consid investig effect propos adjoint-bas error estim mesh adapt method superson regim flow adjoint variabl discontinuous. analysi domain initi mesh consist 345 node 612 3-node triangl shown figur 14a. slip boundari condit appli domain far field condit impos rest boundaries. drag coeffici chosen output function exampl toler 104 used. contour pressur compon momentum adjoint variabl shown figur 14b 14c, respectively, demonstr fic-fem formul successfulli captur shock wave gener flow solut discontinu appear adjoint solution. (a) (b) (c) figur 14: superson flow past ramp. (a) initi mesh; (b) pressur contour (c) contour compon momentum adjoint variabl correspond initi mesh. base assum tolerance, refin level carri example. gener adapt mesh one, refin level consist 603, 1601 2336 nodes, respectively, shown figur 15. note shock wave expand domain length entirely, refin carri zone 18 higher effect drag coefficient. benefit implement adjoint-bas mesh adapt allow refin perform part domain minim impact output functional. (a) (b) (c) figur 15: superson flow past ramp. obtain refin mesh (a) one, (b) (c) refin levels. pressur contour depict figur 16 direct effect adjoint-bas mesh adapt improv resolut shock wave observed. also, obtain contour relat compon momentum adjoint variabl shown figur 17. (a) (b) (c) figur 16: superson flow past ramp. obtain pressur contour (a) one, (b) (c) refin levels. 19 (a) (b) (c) figur 17: superson flow past ramp. obtain contour compon momentum adjoint variabl (a) one, (b) (c) refin levels. figur 18a show converg histori calcul drag valu conjunct predict valu deliv addit correct term. graph confirm capabl adjoint-bas mesh refin approach deliv function valu uniform refin method refin level fewer number nodes. deduc graph adjoint solut involv discontinuities, accord correct function valu calcul on progress advanc refin process. previou examples, figur 18b depict converg graph function uniform adapt mesh versu cpu time. capabl adjoint-bas mesh refin reduc comput cost observed. instance, adapt mesh abl produc nearli function valu refin level consum 13.5% comput cost versu uniform mesh. (a) (b) figur 18: superson flow past ramp. converg graph drag coeffici differ refin method versu (a) number node (b) cpu time (sec). 6 conclud remark adjoint-bas error estim mesh adapt methodolog develop appli compress inviscid flow problem subsonic, transon superson regimes. solv flow adjoint equat coars mesh, error relat desir 20 function calcul inner product local residu adjoint variables. linear interpol emploi project flow adjoint variabl coars mesh fine one. mesh adapt procedure, error indic base local contribut function error conjunct classic h-refin methodolog used. flow equat discret fic-fem stabil formulation. damp newton method implement solv discret flow equat adjoint equat introduc defect correct form. iter step, linear equat deduc flow adjoint equat solv precondi- tion gmre solver. effici propos method demonstr compar present method uniform mesh refin term number node cpu time. develop current method 3d turbul viscou flow consid- er task research. extens work implement high-ord finit element method p-refin methodology. 7 acknowledg author like acknowledg financi support provid cimne. research partial support safecon project european research council. refer [1] t.j. baker. mesh adapt strategi problem fluid dynamics. finit element anal. design, 25:243273, 1997. [2] r. lohner. mesh adapt fluid mechanics. engin fractur mechanics, 50(5/6):819847, 1995. [3] j. peraire, m. vahdati, k. morgan, o. c. zienkiewicz. adapt remesh compress- ibl flow computations. journal comput physics, 72:449466, 1987. [4] o. c. zienkiewicz j. wu. automat direct refin adapt analysi com- pressibl flows. int. j. numer. meth. eng., 72:21892210, 1994. [5] m. kouhi, d. s. lee, g. bugeda, e. onate. multi-object aerodynam shape optimiza- tion moga coupl advanc adapt mesh refinement. comput fluids, 88:298312, 2013. [6] s.z. pirzadeh. adapt unstructur grid method grid subdivision, local remeshing, grid movement. aiaa paper, 99-3255, 1999. [7] p. nithiarasu oc. zienkiewicz. adapt mesh gener fluid mechan problems. int j numer. met.h eng., 47:629662, 2000. [8] d. li g. xia c.l. merkle. anisotrop grid adapt unstructur meshes. aiaa paper, 2001-0443, 2001. [9] n. a. pierc m. giles. adjoint recoveri superconverg function pde approximations. siam review, 42(2):247264, 2000. [10] n. a. pierc m. giles. adjoint defect error bound correct function estimates. j. comput. phys., 200:769794, 2004. [11] d.a. venditti d.l. darmofal. grid adapt function outputs: applic two-dimension inviscid flows. j. comput. phys., 176:4069, 2002. [12] d.a. venditti d.l. darmofal. anisotrop grid adapt function outputs: appli- cation two-dimension viscou flows. j. comput. phys., 187:2246, 2003. 21 [13] m.a. park. adjoint-based, three-dimension error predict grid adaptation. aiaa paper, 2002-3286, 2002. [14] m. nemec, m.j. aftosmis, m. wintzer. adjoint-bas adapt mesh refin complex geometries. aiaa paper, 2008-725, 2008. [15] r. becker r. rannacher. optim control approach posteriori error estim finit element methods. acta numerica 2000, 2001. [16] r. rannacher. adapt galerkin finit element method partial differenti equations. j. comput. appl. math., 128:205233, 2001. [17] m.b. giles, m.g. larson, m. levenstam, e. suli. adapt error control finit element approxim lift drag viscou flow. technic report na 97/06, oxford comput laboratory, oxford, 1997. [18] r. hartmann p. houston. adapt discontinu galerkin finit element method compress euler equations. j. comput. phys., 183:508532, 2002. [19] l. wang d. j. mavriplis. adjoint-bas h-p adapt discontinu galerkin method 2d euler equations. j. comput. phys., 228(20):76437661, 2009. [20] n. k. burgess d. j. mavriplis. hp-adapt discontinu galerkin method navier-stok equations. proceed siam confer comput scienc engineering, reno, nv, mar 2011. societi industri appli mathematics, 2011. [21] k.j. fidkowski d.l. darmofal. review output-bas error estim mesh adapt comput fluid dynamics. aiaa journal, 49(4):673694, 2011. [22] o. pironneau. optimum design fluid mechanics. journal fluid mechanics, 64(1):97110, 1974. [23] a. jameson. aerodynam design control theorgy. journal scientif computing, 3(3):233260, 1998. [24] s. nadarajah a. jameson. comparison continu discret adjoint ap- proach automat aerodynam optimization. aiaa 38th aerospac scienc meet exhibit, aiaa-2000-0667, reno, nv, januari 2000. [25] j. lu. posteriori error control framework adapt precis optim us- ing discontinu galerkin finit element method. ph.d. thesis, massachusett inst. technology, cambridge, ma, 2005. [26] n. a. pierc m. b. giles. adjoint recoveryof superconverg function pde approximations. siam review, 42(2):247264, 2011. [27] s. s. colli m. heinkenschloss. analysi streamline-upwind/petrov-galerkin method appli solut optim control problems. technic report tr02-01, depart comput appli mathematics, rice university, houston, tx, 2002. [28] j. e. hicken d. w. zingg. dual consist function accuracy: finite-differ perspective. journal comput physics, 256:161182, 2014. [29] j.e. hicken, j. li, o. sahni, a.a. oberai. adjoint consist analysi residual-bas variat multiscal methods. journal comput physics, 255:393406, 2013. [30] m. braack. optim control fluid mechan finit element symmetr stabi- lization. siam journal control optimization, 48(2):672687, 2009. [31] e. cyr, j. shadid, t. wildey. approach adjoint-bas posteriori analysi stabil finit element methods. siam journal scientif computing, 36:a766a791, 2014. 22 [32] p. houston, r. rannacher, e. suli. posteriori error analysi stabilis finit element approxim transport problems. comput. method appl. mech. engrg, 190:14831508, 2000. [33] r. rannacher. posteriori error estim least-squar stabil finit element schemes. comput. method appl. mech. engrg, 166:99114, 1998. [34] r. hartmann. adjoint consist analysi discontinu galerkin discretizations. siam j. numer. anal., 45(6):26712696, 2007. [35] r. hartmann p. houston. optim order interior penalti discontinu galerkin dis- cretiz compress navierstok equations. journal comput physics, 227(22):96709685, 2008. [36] j. donea a. huerta. finit element method flow problems. wiley, 2003. [37] o.c. zienkiewicz, r.l. taylor, p. nithiarasu. finit element method. vol. 3 fluid dynamics. elsevier, 6th edition, 2005. [38] e. onate. deriv stabil equat advective-diffus transport fluid flow problems. comput. meth. appl. mech. engng., 151:233267, 1998. [39] e. onate, j. garcia, s. idelsohn. alpha-adapt approach stabil finit element solut advective-diffus problem sharp gradients. new adv. adapt comp. met. mech., p. ladevez j.t. oden (eds.), elsevier, 1998. [40] e. onat m. manzan. gener procedur deriv stabil space-tim finit element method advective-diffus problems. int. j. num. meth. fluids., 31:203221, 1999. [41] e. onate. stabil finit element method incompress viscou flow finit increment calculu formulation. comp. meth. appl. mech. eng, 182:355370, 2000. [42] e. onat j. garcia. finit element method fluid-structur interact surfac wave finit calculu formulation. comput. meth. appl. mech. eng., 191:635660, 2001. [43] e. onate. possibl finit calculu comput mechanics. int. j. num. meth. engng, 60:255281, 2004. [44] m. kouhi e. onate. stabil finit element formul high-spe inviscid compress flow finit calculus. int. j. num. meth. fluids, 74(12):872897, 2013. [45] m. kouhi e. onate. implicit finit element formul compress navier-stok equat finit calculus. comput mechanics, 56(1):113129, 2015. [46] y. saad m. h. schultz. gmres: gener minimum residu algorithm solv nonsymmetr linear systems. siam journal scientif statist computing, 7:856 869, 1986. 23 latex sourc file click download latex sourc files: adjoint_amr_cor.zip