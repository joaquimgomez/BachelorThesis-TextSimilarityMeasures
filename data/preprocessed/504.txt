adjoint-bas adapt finit element method compress euler equat use finit calculus mohammad kouhi , eugenio onat dimitri mavripli correspond author : e-mail : kouhi @ cimne.upc.edu august 3 , 2015 abstract paper , adjoint-bas error estim mesh adapt framework devel- ope compress inviscid flow .
algorithm employ finit calculus ( fic ) scheme numer solut flow discret adjoint equat context galerkin finit element method ( fem ) triangular grid .
fic scheme treat instabl normal generat numer solut fluid equat ad two stabil term , call streamlin term transvers term , origin central-bas discret formul .
non-linear system equat result flow problem solv implicit use damp newton  method accompani exact jacobian matrix .
defect correct scheme implement iter solv linear system equat relat adjoint problem benefit transpos jacobian matrix .
iter , linear system equat result fluid adjoint problem solv use precondit gmres method .
cal- culat error specifi output function local , h-refin methodolog base element subdivis perform refin candid element .
qualiti numer result prove capabl present approach adjoint-bas error estim mesh adapt problem differ flow regim .
keyword : compress euler equat ; stabil finit element ; finit calculus ; dis- crete adjoint ; h-refin 1 introduct adapt mesh refin ( amr ) one effici mean reduc overal comput cost numer solut engin fluid problem model com- pressibl euler navier-stok equat [ 14 ] .
basic idea behind amr control mesh resolut generat appropri fine mesh near zone solut error high assign coars mesh rest domain .
techniqu abl improv accuraci flow solut around high-error zone boundari layer , stagnat point shock wave .
effect amr remark numer solut fluid flow employ optim problem [ 5 ] appropri evalu practic output function lift drag coeffici becom import .
main compon amr techniqu reliabl error estimator/ind mesh refin methodolog .
error estimator/ind introduc area current mesh refin need wherea enhanc current mesh area ad new element task mesh refin methodolog .
base call feature-bas method , one consid flow gradient [ 4 , 6 ] flow curvatur [ 3 , 7 , 8 ] error indic predict area refin need .
area , fluid flow most complex featur shock wave , boundari layer stagnat point .
although famili error indic predict flow featur accur , necessarili provid effici estim practic engin output ( lift drag ) use wide design optim process .
1 *manuscript click view link refer http : //ees.elsevier.com/aescte/viewrcresults.aspx ? pdf=1 & docid=5110 & rev=1 & fileid=114579 & msid= { cfa1da03-d628-4f0f-9bd6-420256da7386 } order resolv drawback , anoth famili error estimators/ind , call output- base method , develop recent employ sensit specifi output function respect flow solut sensit predict implement adjoint variabl .
general idea method estim global error output function inner product flow residu adjoint variabl posteriori .
end , two set problem , name flow problem adjoint problem , need solv current coars mesh .
numer solut flow equat provid flow variabl , wherea adjoint variabl evalu numer solut adjoint equat .
besid applic output-bas method estim global error , consid local error indic find zone function error desir toler .
applic output-bas error estim mesh adapt method use adjoint variabl context finit volum studi pierc gile [ 9 ] poisson equat well nonlinear quasi-one-dimension euler equat .
fol- low , pierc gile [ 10 ] investig approach two-dimension inviscid shock prob- lem .
extens method compress two-dimension inviscid viscous flow deliv venditti darmof [ 11 , 12 ] .
park [ 13 ] employ approach incompress compress three-dimension euler problem wherea nemec et al .
[ 14 ] demonstr complex geometri .
context finit element discret method , becker rannach [ 15 ] develop adjoint-bas error estim mesh adapt viscous fluid flow , chemic reactiv flow , elasto-plast radiat transfer problem .
follow , rannach [ 16 ] studi approach incompress viscous flow wherea gile et al .
[ 17 ] demonstr capabl techniqu drag lift coeffici bodi immers incompress viscous flow .
base recent develop discontinu galerkin finit element method fluid problem , sever implement adjoint-bas error esti- mation present inviscid [ 18 , 19 ] turbul viscous [ 20 ] flow .
comprehens review adjoint-bas error estim mesh refin method comput fluid dynam laminar reynolds-averag navier-stok applic carri fidkowski darmof [ 21 ] .
adjoint equat origin develop pironneau [ 22 ] jameson [ 23 ] com- putat deriv output function employ gradient-bas optim method .
order solv adjoint equat two differ procedur , name continu formul discret formul , develop research .
continu- ous formul continu form govern flow equat first differenti discret , wherea discret formul direct differenti discret form govern equat .
although continu adjoint formul advantag less memori requir , implement discret formul increas recent due simplic implement uniqu capabl provid exact discret sensit .
simplic come fact transpos global jacobian matrix , alreadi calcul implicit solut flow equat , util direct solut linear system equat aris discret adjoint formul .
hand , treatment boundari condit quit straightforward case discret formul .
comprehens comparison continu discret adjoint formul present [ 24 ] .
import properti relat adjoint-bas error estim adjoint consist ensur discret adjoint problem consist discret continu one .
error estim problem , adjoint inconsist discret lead unsmooth oscillatori adjoint solut discontinu element deliv adapt un- necessari area lead suboptim converg rate function estim [ 25 ] .
particular , discret base high-ord element , enforc adjoint consist essenti obtain superconverg function estim [ 26 , 27 ] .
signific inter- est studi adjoint consist context finit differ method [ 28 ] , stabil continu finit element method [ 27 , 2933 ] discontinu galerkin finit element method [ 25 , 34 , 35 ] .
regard central-bas discret formul employ flow equat , well establish fact addit stabil term origin system equat re- 2 sult discret flow problem essenti avoid occurr numer instabl [ 36 , 37 ] .
within famili stabil techniqu , call finit cal- culus ( fic ) method success implement stabil advective-diffus transport incompress fluid flow problem [ 3843 ] .
recent , fic-bas stabil for- mulat numer solut compress euler navier-stok equat propos context galerkin fem kouhi onat [ 44 , 45 ] .
sinc system equat obtain flow adjoint problem contain eigenvalu , stabil techniqu develop flow equat implement solv adjoint problem well .
articl , extend implement fic-fem stabil formul present [ 44 ] develop adjoint-bas error estim mesh adapt framework compress- ibl inviscid flow .
system equat obtain discret flow problem solv implicit use damp newton  method benefit exact jacobian matrix propos [ 45 ] .
iter step , inher linear system result flow equa- tion solv precondit gmres method .
transpos jacobian matrix , alreadi construct discret flow equat contain fic-bas stabil term , employ solut adjoint equat .
paper , adjoint consist propos stabil method investig check smooth continu adjoint solut obtain present exampl .
amr perform use local contribut function error conjunct classic h-refin methodolog , candid element divid four divid edg element two .
order demonstr capabl fic-fem stabil formul output-bas error estim problem , sever exampl present .
studi qualiti result , found present stabil formul provid enough stabil numer solut adjoint equat yield accur estim function error amr process .
layout paper follow : section 2 compress euler equat along fic-fem stabil formul describ .
section 3 present deriv output-bas error estim adapt mesh refin method use adjoint variabl .
solut strategi flow adjoint equat explain section 4 .
numer result correspond propos error estim mesh refin strategi differ output function subson , transon superson flow regim shown section 5 .
final , conclus general remark summar section 6 .
2 flow problem formul 2.1 govern equat two-dimension ( 2d ) compress euler equat , includ mass balanc , momentum energi equat , consid work written follow conserv form u t + fi xi = 0 = 1 , 2 ( 1 ) u f vector conserv variabl inviscid flux , respect , express u =      v1 v2 e     fi =     vi v1vi + pi1 v2vi + pi2 vi ( p+ e )     ( 2 )  , v , p e densiti , veloc vector , static pressur total intern energi per unit mass , respect .
equat , j = 1 , nd nd number space dimens ( nd = 2 2d flow problem ) ij kroneck delta .
defin r ideal gas constant neglect chemic reaction , equat state ideal gas follow form p = rt ( 3 ) 3 temperatur gas obtain =   1 r ( e 0.5vjvj ) ( 4 )  ratio specif heat .
standard sum convent term repeat indic adopt paper , unless otherwis specifi .
2.2 deriv stabil formul defin rd , rmi differenti form mass balanc equat , ith momentum equat energi equat , respect , rd : =  t +  ( vj ) xj ( 5 ) rmi : =  ( vi ) t +  xj ( vivj ) + p xi ( 6 ) : =  ( e ) t +  xj ( vj ( e+ p ) ) ( 7 ) , j = 1 , nd .
stabil formul euler equat base fic scheme , present [ 44 , 45 ] , obtain rd  1 2 ( 1  )  sgn ( rd )  || .rd  1 2  1 |v|+ vc  .
( .fmi ) = 0 ( 8 ) rmi  1 2 ( 1  )  sgn ( rmi ) vi |vi| .rmi  1 2  v |v|+ vc .rmi = 0 ( 9 )  1 2 ( 1  )  sgn ( ) t |t | .re  1 2  v |v|+ vc .re = 0 ( 10 )  constant coeffici rang zero one ,  characterist element size , sgn ( . )
denot sign function , |v| modulus veloc vector vc =   p  speed sound flow .
also , .fmi diverg flux term correspond ith momentum equat may express .fmi =  ( vivj ) xj + p xi ( 11 ) detail deriv equat ( 8 ) , ( 9 ) ( 10 ) found [ 44 , 45 ] .
2.3 space discret order discret obtain stabil formul , finit element method ( fem ) select vector conserv variabl u approxim u u  u = n  j=1 njuj ( 12 ) vector u contain approxim valu correspond conserv variabl .
n matrix interpol shape function , subscript index j repres valu j th node n number node element .
work use 3-node triangl linear shape function ( n = 3 ) .
4 let us defin approxim residu vector r rst well vector approxi- mate primit variabl  u r =     rd rm1 rm2 re     rst =     1 rm1 rm2 re      u =      vx vy t     ( 13 ) rd , rmi re denot finit element residu mass balanc equat , ith momentum equat energi equat , respect .
appli galerkin fem equat ( 8 ) , ( 9 ) ( 10 ) , integr inviscid flux term well stabil term part neglect boundari contribut stabil term , general form fic-fem stabil formul problem domain  boundari  =  obtain   n. u t d   n xi .fid+   n.fnd + nel  e  e  2 ai n xi .rstd+ nel  e  e 1 2 n xi .
  u xi d = 0 ( 14 ) nel number element = 1 , 2 ( 2d problem ) .
equat , fi fn ith compon approxim inviscid flux vector f vector inviscid boundari flux along normal vector boundari , respect .
also equat ( 14 ) ,  =  |v|+vc stabil paramet stabil matric ai = ( 1  )          |rd| |  u1| 0 0 0 0 |rm 1 | |  u2| 0 0 0 0 |rm 2 | |  u3| 0 0 0 0 |re| |  u4|         ai =     .fmi 0 0 0 0 vi 0 0 0 0 vi 0 0 0 0 vi     ( 15 ) .fmi diverg approxim finit element flux term correspond ith momentum equat .
detail deriv propos stabil formul well treatment boundari condit found [ 44 , 45 ] .
discuss refer , assumpt  = 0.5  = ( 2e ) 1/2 e element area 2d problem give suitabl result .
henc , assumpt taken work .
neglect tempor deriv term ( i.e .
first term ) equat 14 assem- bling element contribut equat ( 14 ) , steady-st flow residu vector ri ( u ) correspond ith global node defin ri ( u ) =    ni xi .fid+   ni .fnd + nel  e  e  2 ai ni xi .rstd+ nel  e  e 1 2 ni xi .
  u xi d = 0 ( 16 ) subscript index repres valu correspond ith node .
equat ( 16 ) non-linear system equat whose solut present section 4.1 .
5 3 output-bas amr 3.1 adjoint-bas error estim formul consid spatial domain resolut h relat coars mesh discret .
corre- spond output function jh defin jh = jh ( uh ) ( 17 ) uh vector discret flow variabl obtain satisfi non-linear flow equat rh ( uh ) = 0 coars mesh .
also , consid spatial domain resolut h relat fine mesh discret .
assum uh solut flow equat rh ( uh ) = 0 fine mesh , output function jh express form jh = jh ( uh ) ( 18 ) let us defin uhh flow variabl obtain spatial domain resolut h project onto spatial domain resolut h. general , taylor expans function jh ( consid linear term ) use solut uhh express jh ( uh )  jh ( u h h ) + [ jh uh ] u h h ( uh  u h h ) ( 19 ) jh ( u h h ) function valu fine mesh calcul use u h h .
also , vector [ jh uh ] u h h contain sensit function fine mesh respect flow variabl evalu use uhh .
defin t linear approxim total error function evalu fine mesh use project solut coars one .
use equat ( 19 ) , t repres t = jh ( uh )  jh ( u h h ) = [ jh uh ] u h h ( uh  u h h ) ( 20 ) mention uhh essenti equal uh , sinc u h h necessarili satisfi rh ( u h h ) = 0 .
henc , equat ( 20 ) yield nonzero valu t .
expans one introduc jh ( uh ) equat ( 19 ) written flow residu rh ( uh ) follow form rh ( uh )  rh ( u h h ) + [ rh uh ] u h h ( uh  u h h ) ( 21 ) [ rh uh ] u h h jacobian matrix flow residu , present equat ( 16 ) , evalu use uhh fine mesh .
consid fact thatrh ( uh ) = 0 , solut error ( uhu h h ) appear equat ( 21 ) repres ( uh  u h h )   [ rh uh ] 1 u h h r ( uhh ) ( 22 ) substitut equat ( 22 ) ( 20 ) give follow express total function error t =  [ jh uh ] u h h [ rh uh ] 1 u h h rh ( u h h ) ( 23 ) equat state evalu total function error t involv invers jacobian matrix process high comput cost .
order avoid invert jacobian matrix direct , discret adjoint system equat defin [ rh uh ] u h h ( h ) uh h = [ jh uh ] u h h ( 24 ) 6 ( h ) uh h vector discret adjoint variabl calcul use uhh fine mesh .
use equat ( 24 ) , formul total function error present equat ( 23 ) transform t =  ( h ) u h h rh ( u h h ) ( 25 ) equat ( 25 ) deduc evalu total function error fine mesh would requir adjoint variabl obtain solv discret adjoint equat ( 24 ) fine mesh .
main idea prevent solv system equat fine mesh , approxim ( h ) uh h made solv adjoint equat initi coars mesh [ rh uh ] h = [ jh uh ] ( 26 ) h vector contain discret adjoint variabl correspond coars mesh .
discret adjoint variabl comput coars mesh , project valu coars mesh fine mesh , call hh , calcul use approxim discret adjoint variabl correspond fine mesh .
let us defin comput function error correct c approxim total function error t .
use project adjoint variabl , c express t  c =  (  h h ) rh ( u h h ) ( 27 ) equat state c obtain inner product vector project adjoint variabl vector nonzero residu .
contrast equat ( 25 ) , equat demonstr function error approxim predict without solut fine mesh solv flow adjoint equat coars mesh along proper project procedur fine mesh level .
note project oper one implement flow solut util discret adjoint variabl work .
solut method equat ( 26 ) present section 4.2 .
3.2 adapt criteria element-wis error indic ik defin contribut c correspond kth element belong coars mesh h form ik =  (  h h ) krh ( u h h ) ( 28 ) fact , local error indic element k obtain inner product project adjoint variabl local residu vector comput subel element k coars mesh .
order find candid element refin , adapt criteria employ local error indic element compar element allow error |ik| > etol nel ( 29 ) etol denot posit desir error toler nel number element coars mesh .
element satisfi equat ( 29 ) consid candid element refin .
3.3 refin methodolog mesh refin methodolog implement work isotrop h-refin scheme candid element subdivid four subel .
element subdivis process carri insert extra point edg midpoint suit triangl element .
candid element connect curv boundari , new insert point edg belong boundari must adjust origin boundari surfac .
reason , correct coordin new surfac point perform end 7 adapt level implement quintic spline interpol base coordin origin surfac point .
geometr interpret process depict figur 1 .
     ( )      ( b ) figur 1 : isotrop mesh refin near curv boundari .
( ) correct , ( b ) correct .
consider must taken account regard possibl generat hang point one two edg element split new point due candid neighbour element .
case element one hang point , anisotrop refin two subel implement , wherea element two hang point divid regular four subel , shown figur 2 .
order keep qualiti mesh , anisotrop subel allow refin .
element requir refin , anisotrop subel remov origin coars element isotrop refin four subel .
   figur 2 : mesh refin process around hang node : ( ) isotrop refin two candid element , ( b ) isotrop refin element due presenc two hand node , ( c ) anisotrop refin element due presenc one hang node .
3.4 amr procedur error estim mesh adapt algorithm present work consist fol- low step 1- obtain flow variabl uh solv equat ( 16 ) coars mesh .
2- comput adjoint variabl h solv equat ( 26 ) coars mesh use converg flow solut uh .
3- evalu project flow variabl uh h project adjoint variabl h h .
4- find candid element refin equat ( 28 ) ( 29 ) .
5- candid element exist , refin coars mesh return step 1 .
8 amr procedur finish candid element refin .
mention refin level solut flow adjoint equat start use previous project variabl .
project flow adjoint variabl current coars mesh embed fine one perform either linear higher-ord interpol method .
former requir valu solut coars mesh point , wherea latter involv calcul least-squar gradient solut .
work , suitabl result obtain use simpl linear interpol method .
4 solut method section , solut strategi flow adjoint equat given equat ( 16 ) ( 26 ) , respect , present .
sinc exact jacobian matrix need solut adjoint equat ( see equat ( 26 ) ) , iter newton linear scheme exact jacobian matrix chosen solut approach nonlinear flow equat ( i.e .
equat ( 16 ) ) .
adjoint equat given equat ( 26 ) correspond linear system equat .
although system solv direct , iter scheme present transfer equat defect correct form .
4.1 flow solut solut equat ( 16 ) perform use follow newton  method [ r u ] n un = r ( un ) un = un+1  un ( 30 ) n iter number .
begin solut , newton solver may diverg due start-up transient caus poor initi flow field .
order overcom problem , damp newton  method implement diagon term jacobian matrix augment damp factor [ ijmij ti + ri uj ] n unj = ri ( u n ) mij =   ninjd ( 31 ) , j = 1 , nnode nnode total number node mesh global mass matrix .
equat , nodal ( pseudo ) time step ti minimum element time step correspond element connect node .
element time step te candid element e determin uniform cfl number domain te = cfl  |v|+ vc ( 32 ) work cfl number respons ad scalabl damp term startup process follow form cfl ( n ) = min ( ncfl ( 0 ) , cfl ( max ) ) ( 33 ) cfl ( 0 ) = 0.01 , cfl ( max ) = 1012  select 1.1 10.0 depend problem .
use pattern cfl , increas pseudo time step larg valu ( cfl = 1012 ) damp unsteadi term vanish desir quadrat converg rate newton  method achiev .
linear system equat ( 31 ) consist spars block matrix solv use gmres method describ [ 46 ] .
order improv converg method , precondit gmres algorithm base block-diagon precondit implement work .
9 4.2 adjoint solut omit subscript h equat ( 26 ) , defect correct form adjoint equat written [ ijmij ti + [ r u ] ] k kj = [ j u ]  [ r u ]  k k = k+1 k ( 34 ) k denot iter number .
seen equat , pseudo time term ad diagon compon jacobian matrix provid enough diagon domin system solver .
direct benefit defect correct method .
final converg solut  obtain continu increas time step ti use pattern present equat ( 32 ) ( 33 ) .
similar flow equat , block-diagon precondit gmres method use solut linear system equat iter step equat ( 34 ) .
compar iter scheme develop solut flow adjoint equat ( equat ( 31 ) ( 34 ) ) , found system coeffici matrix except transpos .
sinc transpos oper chang eigenvalu coeffici matrix , system converg .
current work , hand-cod linear galerkin term well stabil term equat ( 16 ) implement give spars jacobian matrix unstructur triangular mesh use work .
jacobian matrix base final steady-st flow solut store employ solut adjoint equat .
5 numer result section , set numer exampl relat propos adjoint-bas error estim adapt mesh refin present .
first exampl involv subson flow gaussian bump consist three part .
first , behavior propos fic-fem formul conjunct present damp newton solver valid .
second part , accuraci adjoint-bas error estim examin compar predict error obtain total function error t comput function error correct c true function error two mesh level .
last part , adapt mesh relat present element-wis error indic ik well error converg graph deliv consid lift coeffici output function .
next two exampl , capabl method presenc shock wave evalu studi transon flow naca0012 airfoil superson flow ramp .
adapt level present exampl , comput flow solver well adjoint solver advanc fulli converg correspond residu machin zero ( 1e  14 doubl precis ) obtain .
error converg graph show reduct function error versus number node accumul comput cost cpu time .
comput cost correspond refin level consist consum cpu time solut flow adjoint equat previous refin level plus extra cpu time due flow solut current adapt mesh .
initi solut refin level obtain interpol converg flow solut previous level old mesh new one .
regard uniform mesh refin , comput cost includ cpu time singl flow solut uniform refin mesh .
5.1 exampl : subson flow bump compress flow freestream mach number 0.35 pass gaussian bump studi demonstr effect develop error estim adapt techniqu 10 subson regim .
bump maximum thick 0.08 place center bottom side rectangular domain height 2 length 4 .
initi unstructur mesh , shown figur 3 , contain 952 node 1902 3-node triangl .
slip wall condit impos bottom boundari , wherea far field condit appli rest boundari .
figur 3 : subson flow bump .
initi uniform mesh .
1- flow adjoint solver sinc main part error estim mesh adapt procedur solut flow adjoint equat , characterist solver term accuraci effici affect qualiti final result adapt mesh refin process .
reason , assum lift coeffici function , numer result correspond solut flow adjoint equat initi mesh deliv demonstr behavior propos fic-fem formul conjunct present damp newton solver .
obtain contour correspond pressur first compon momentum adjoint variabl present figur 4 indic propos fic-fem formul give rise smooth solut domain even use coars mesh .
smooth continu adjoint solut near boundari element demonstr consist present discret adjoint formul base fic-fem scheme .
converg graph flow adjoint solver use present iter strategi shown figur 5 almost quadrat converg obtain flow solver iter initi transient disappear cfl number slowli allow grow maximum valu .
expect , almost similar converg rate machin zero obtain adjoint equat .
11  ( )  ( b ) figur 4 : subson flow bump .
( ) pressur contour ( b ) first compon momentum adjoint variabl correspond initi uniform mesh .
                                 figur 5 : subson flow bump .
converg flow adjoint equat initi coars mesh .
2- error predict deliv scheme error predict valid set mesh , call coars , intermedi fine mesh , consist 952 , 3728 14852 node , respect , lift coeffici consid output function .
idea compar true function error deduc two mesh level one obtain total function error t comput function error correct c .
12 obtain valu function error correspond lift coeffici well ratio valu demonstr tabl 1 .
seen ratio valu obtain total correct error asymptot approach uniti spatial resolut increas .
expect , better compat true total error valu observ finest discret .
demonstr ratio valu correspond total error indic con- sider linear term taylor expans function , present equat ( 19 ) , capabl predict function appropri .
hand , ratio valu cor- respond correct error illustr propos project method adjoint variabl abl predict function error accur .
tabl 1 : subson flow bump .
comparison total correct adjoint predict error exact error lift coeffici .
mesh exact t c t/exact c/exact coars 0.001562 0.001649 0.0012332 1.055 0.788 intermedi 0.0004081 0.0004233 0.0003507 1.037 0.859 fine 0.0001115 0.0001150 0.0001050 1.031 0.941 3- mesh adapt valid flow adjoint solver well error predict scheme , effici develop adjoint-bas mesh adapt strategi use present local error indic ik studi exampl consid lift coeffici output function .
procedur begin use uniform mesh , previous shown figur 3 , ter- minat criteria attain toler order 4  104 output function .
exampl , true function comput solut adapt mesh obtain refin initi mesh relat function differ order 105 consid two consecut adapt mesh .
figur 6 depict final adapt mesh obtain four level refin consist 1472 node .
figur indic major part refin perform around bump solut greater influenc output function .
also , obtain pressur contour well first compon momentum adjoint variabl correspond final adapt mesh present figur 7 demonstr final adapt mesh deliv smoother contour comparison one obtain initi uniform mesh plot figur 4 .
figur 6 : subson flow bump .
final adapt mesh lift coeffici four refin level .
13  ( )  ( b ) figur 7 : subson flow bump .
( ) pressur contour ( b ) first compon momentum adjoint variabl correspond final adapt mesh .
figur 8a show converg lift error versus number node error converg adapt method compar uniform method .
figur demonstr adapt approach refin level give rise relat similar function error uniform approach use lower number node .
exampl , mention number node generat adapt approach second refin level 8 % one generat uniform approach .
                      ( )                          ( b ) figur 8 : subson flow bump .
comparison error converg lift coeffici relat uniform adapt mesh refin versus ( ) number node ( b ) cpu time ( sec ) .
impress behaviour seen figur 8b cpu time comparison adapt approach demand much less cpu time uniform method due smaller 14 number node resolv mesh adapt process .
, compar cpu time approach second refin level , seen comput cost consum adapt approach 11 % one use uniform method .
worth note cpu time adapt approach involv flow adjoint solut previous level , cpu time singl flow solut refin mesh count case uniform approach .
figur 9 depict converg graph lift coeffici correspond adapt refin use error estim correct term well one relat uniform refin .
observ refin level adapt mesh produc near function valu one obtain uniform mesh .
although , agreement correct function valu calcul one adapt mesh poor primari refin level , better agreement obtain last refin level .
improv due fact correct term calcul project adjoint variabl reduc mesh size project process deliv better agreement exact project valu .
                      figur 9 : subson flow bump .
converg graph lift coeffici use differ refin method .
5.2 exampl ii : transon flow past naca0012 exampl , transon flow past naca0012 flow conditionsm  = 0.8  = 1.25 consid involv strong shock wave upper side airfoil weak shock wave lower side .
assum circular domain initi discret 3820 node 7258 3-node triangl .
analysi domain well detail initi mesh near airfoil shown figur 10 .
slip wall condit impos airfoil surfac , wherea far field condit appli outer boundari .
adjoint-bas mesh adapt lift coeffici util exampl toler 104 .
15 ( ) ( b ) figur 10 : transon flow past naca0012 .
( ) initi mesh generat circular domain ; ( b ) detail mesh near airfoil .
obtain pressur contour correspond initi mesh shown figur 11a demonstr fic-fem formul abl captur shock wave appear solut flow equat .
contour relat first compon momentum adjoint variabl obtain initi mesh depict figur 11b .
result show fic-fem formul yield smooth continu solut adjoint equat demonstr consist discret adjoint formul present .
 ( )  ( b ) figur 11 : transon flow past naca0012 .
( ) pressur contour ( b ) first compon momentum adjoint variabl correspond initi mesh .
generat adapt mesh four refin level shown figur 12a contain 8231 node 15874 3-node triangl .
expect , mesh refin most carri near zone higher import like lead trail edg well vicin shock wave .
obtain pressur contour four refin level present figur 12b .
note refin mesh deliv sharper shock wave comparison initi mesh .
16 ( )  ( b ) figur 12 : transon flow past naca0012 .
final result four refin level lift coeffici : ( ) adapt mesh ( b ) pressur contour .
capabl propos error estim correct method demonstr figur 13a converg graph lift valu obtain differ refin method versus number node depict .
comparison converg graph relat uniform adapt mesh refin confirm function valu refin level obtain adapt method close agreement one obtain uniform refin method .
also , predict valu refin level provid ad correct term compar one calcul adapt mesh .
although primari level larg differ observ correct function valu calcul one , correct valu becom closer calcul one refin advanc last refin level two valu coincid .
figur 13b show cpu time comparison uniform adapt mesh .
seen larg amount save enhanc use adjoint-bas mesh refin .
exampl , comput cost second refin level relat adapt mesh 17.5 % one relat uniform mesh .
17                         ( )                             ( b ) figur 13 : transon flow past naca0012 .
converg graph predict lift coeffici use differ refin method versus ( ) number node ( b ) cpu time ( sec ) .
5.3 exampl iii : superson flow ramp exampl , flow mach number 3.0 pass ramp angl 19 consid investig effect propos adjoint-bas error estim mesh adapt method superson regim flow adjoint variabl discontinu .
analysi domain initi mesh consist 345 node 612 3-node triangl shown figur 14a .
slip boundari condit appli bottom side domain wherea far field condit impos rest boundari .
drag coeffici chosen output function exampl toler 104 use .
contour pressur first compon momentum adjoint variabl shown figur 14b 14c , respect , demonstr fic-fem formul success captur shock wave generat flow solut well discontinu appear adjoint solut .
( )  ( b )  ( c ) figur 14 : superson flow past ramp .
( ) initi mesh ; ( b ) pressur contour ( c ) contour first compon momentum adjoint variabl correspond initi mesh .
base assum toler , five refin level carri exampl .
generat adapt mesh one , three five refin level consist 603 , 1601 2336 node , respect , shown figur 15 .
note although shock wave expand across domain length entir , refin carri zone 18 higher effect drag coeffici .
benefit implement adjoint-bas mesh adapt allow refin perform part domain minim impact output function .
( ) ( b ) ( c ) figur 15 : superson flow past ramp .
obtain refin mesh ( ) one , ( b ) three ( c ) five refin level .
pressur contour depict figur 16 direct effect adjoint-bas mesh adapt improv resolut shock wave observ .
also , obtain contour relat first compon momentum adjoint variabl shown figur 17 .
 ( )  ( b )  ( c ) figur 16 : superson flow past ramp .
obtain pressur contour ( ) one , ( b ) three ( c ) five refin level .
19  ( )  ( b )  ( c ) figur 17 : superson flow past ramp .
obtain contour first compon momentum adjoint variabl ( ) one , ( b ) three ( c ) five refin level .
figur 18a show converg histori calcul drag valu conjunct predict valu deliv addit correct term .
graph confirm capabl adjoint-bas mesh refin approach deliv almost function valu uniform refin method refin level use fewer number node .
also deduc graph although adjoint solut involv discontinu , accord correct function valu calcul one progress advanc refin process .
previous exampl , figur 18b depict converg graph function use uniform adapt mesh versus cpu time .
capabl adjoint-bas mesh refin reduc comput cost observ .
instanc , adapt mesh abl produc near function valu third refin level consum almost 13.5 % comput cost versus uniform mesh .
                         ( )                           ( b ) figur 18 : superson flow past ramp .
converg graph drag coeffici use differ refin method versus ( ) number node ( b ) cpu time ( sec ) .
6 conclud remark adjoint-bas error estim mesh adapt methodolog develop appli compress inviscid flow problem subson , transon superson regim .
solv flow adjoint equat coars mesh , error relat desir 20 function calcul inner product local residu adjoint variabl .
linear interpol employ project flow adjoint variabl coars mesh fine one .
mesh adapt procedur , error indic base local contribut function error conjunct classic h-refin methodolog use .
flow equat discret use fic-fem stabil formul .
damp newton method implement solv discret flow equat wherea adjoint equat introduc defect correct form .
iter step , linear system equat deduc flow adjoint equat solv use precondi- tion gmres solver .
effici propos method demonstr compar present method uniform mesh refin term number node well cpu time .
develop current method 3d turbul viscous flow consid- ere next task research .
anoth extens work implement high-ord finit element method p-refin methodolog .
7 acknowledg first author would like acknowledg financi support provid cimn .
research partial support safecon project european research council .
refer [ 1 ] t.j. baker .
mesh adapt strategi problem fluid dynam .
finit element anal .
design , 25:243273 , 1997 .
[ 2 ] r. lohner .
mesh adapt fluid mechan .
engin fractur mechan , 50 ( 5/6 ) :819847 , 1995 .
[ 3 ] j. perair , m. vahdati , k. morgan , o. c. zienkiewicz .
adapt remesh compress- ibl flow comput .
journal comput physic , 72:449466 , 1987 .
[ 4 ] o. c. zienkiewicz j. wu .
automat direct refin adapt analysi com- pressibl flow .
int .
j. numer .
meth .
eng. , 72:21892210 , 1994 .
[ 5 ] m. kouhi , d. s. lee , g. bugeda , e. onat .
multi-object aerodynam shape optimiza- tion use moga coupl advanc adapt mesh refin .
comput fluid , 88:298312 , 2013 .
[ 6 ] s.z .
pirzadeh .
adapt unstructur grid method grid subdivis , local remesh , grid movement .
aiaa paper , 99-3255 , 1999 .
[ 7 ] p. nithiarasu oc .
zienkiewicz .
adapt mesh generat fluid mechan problem .
int j numer .
met.h eng. , 47:629662 , 2000 .
[ 8 ] d. li g. xia c.l .
merkl .
anisotrop grid adapt unstructur mesh .
aiaa paper , 2001-0443 , 2001 .
[ 9 ] n. .
pierc m. gile .
adjoint recoveri superconverg function pde approxim .
siam review , 42 ( 2 ) :247264 , 2000 .
[ 10 ] n. .
pierc m. gile .
adjoint defect error bound correct function estim .
j. comput .
phys. , 200:769794 , 2004 .
[ 11 ] d.a .
venditti d.l .
darmof .
grid adapt function output : applic two-dimension inviscid flow .
j. comput .
phys. , 176:4069 , 2002 .
[ 12 ] d.a .
venditti d.l .
darmof .
anisotrop grid adapt function output : appli- cation two-dimension viscous flow .
j. comput .
phys. , 187:2246 , 2003 .
21 [ 13 ] m.a .
park .
adjoint-bas , three-dimension error predict grid adapt .
aiaa paper , 2002-3286 , 2002 .
[ 14 ] m. nemec , m.j. aftosmi , m. wintzer .
adjoint-bas adapt mesh refin complex geometri .
aiaa paper , 2008-725 , 2008 .
[ 15 ] r. becker r. rannach .
optim control approach posteriori error estim finit element method .
acta numerica 2000 , 2001 .
[ 16 ] r. rannach .
adapt galerkin finit element method partial differenti equat .
j. comput .
appl .
math. , 128:205233 , 2001 .
[ 17 ] m.b .
gile , m.g .
larson , m. levenstam , e. suli .
adapt error control finit element approxim lift drag viscous flow .
technic report na 97/06 , oxford comput laboratori , oxford , 1997 .
[ 18 ] r. hartmann p. houston .
adapt discontinu galerkin finit element method compress euler equat .
j. comput .
phys. , 183:508532 , 2002 .
[ 19 ] l. wang d. j. mavripli .
adjoint-bas h-p adapt discontinu galerkin method 2d euler equat .
j. comput .
phys. , 228 ( 20 ) :76437661 , 2009 .
[ 20 ] n. k. burgess d. j. mavripli .
hp-adapt discontinu galerkin method navier-stok equat .
proceed siam confer comput scienc engin , reno , nv , mar 2011 .
societi industri appli mathemat , 2011 .
[ 21 ] k.j .
fidkowski d.l .
darmof .
review output-bas error estim mesh adapt comput fluid dynam .
aiaa journal , 49 ( 4 ) :673694 , 2011 .
[ 22 ] o. pironneau .
optimum design fluid mechan .
journal fluid mechan , 64 ( 1 ) :97110 , 1974 .
[ 23 ] a. jameson .
aerodynam design via control theorgi .
journal scientif comput , 3 ( 3 ) :233260 , 1998 .
[ 24 ] s. nadarajah a. jameson .
comparison continu discret adjoint ap- proach automat aerodynam optim .
aiaa 38th aerospac scienc meet exhibit , aiaa-2000-0667 , reno , nv , januari 2000 .
[ 25 ] j. lu .
posteriori error control framework adapt precis optim us- ing discontinu galerkin finit element method .
ph.d. thesi , massachusett inst .
technolog , cambridg , , 2005 .
[ 26 ] n. .
pierc m. b. gile .
adjoint recoveryof superconverg function pde approxim .
siam review , 42 ( 2 ) :247264 , 2011 .
[ 27 ] s. s. colli m. heinkenschloss .
analysi streamline-upwind/petrov-galerkin method appli solut optim control problem .
technic report tr02-01 , depart comput appli mathemat , rice univers , houston , tx , 2002 .
[ 28 ] j. e. hicken d. w. zingg .
dual consist function accuraci : finite-differ perspect .
journal comput physic , 256:161182 , 2014 .
[ 29 ] j.e .
hicken , j. li , o. sahni , a.a. oberai .
adjoint consist analysi residual-bas variat multiscal method .
journal comput physic , 255:393406 , 2013 .
[ 30 ] m. braack .
optim control fluid mechan finit element symmetr stabi- lizat .
siam journal control optim , 48 ( 2 ) :672687 , 2009 .
[ 31 ] e. cyr , j. shadid , t. wildey .
approach adjoint-bas posteriori analysi stabil finit element method .
siam journal scientif comput , 36 : a766a791 , 2014 .
22 [ 32 ] p. houston , r. rannach , e. suli .
posteriori error analysi stabilis finit element approxim transport problem .
comput .
method appl .
mech .
engrg , 190:14831508 , 2000 .
[ 33 ] r. rannach .
posteriori error estim least-squar stabil finit element scheme .
comput .
method appl .
mech .
engrg , 166:99114 , 1998 .
[ 34 ] r. hartmann .
adjoint consist analysi discontinu galerkin discret .
siam j. numer .
anal. , 45 ( 6 ) :26712696 , 2007 .
[ 35 ] r. hartmann p. houston .
optim order interior penalti discontinu galerkin dis- cretize compress navierstok equat .
journal comput physic , 227 ( 22 ) :96709685 , 2008 .
[ 36 ] j. donea a. huerta .
finit element method flow problem .
wiley , 2003 .
[ 37 ] o.c .
zienkiewicz , r.l .
taylor , p. nithiarasu .
finit element method .
vol .
3 fluid dynam .
elsevi , 6th edit , 2005 .
[ 38 ] e. onat .
deriv stabil equat advective-diffus transport fluid flow problem .
comput .
meth .
appl .
mech .
engng. , 151:233267 , 1998 .
[ 39 ] e. onat , j. garcia , s. idelsohn .
alpha-adapt approach stabil finit element solut advective-diffus problem sharp gradient .
new adv .
adapt comp .
met .
mech. , p. ladevez j.t .
oden ( ed .
) , elsevi , 1998 .
[ 40 ] e. onat m. manzan .
general procedur deriv stabil space-tim finit element method advective-diffus problem .
int .
j. num .
meth .
fluids. , 31:203221 , 1999 .
[ 41 ] e. onat .
stabil finit element method incompress viscous flow use finit increment calculus formul .
comp .
meth .
appl .
mech .
eng , 182:355370 , 2000 .
[ 42 ] e. onat j. garcia .
finit element method fluid-structur interact surfac wave use finit calculus formul .
comput .
meth .
appl .
mech .
eng. , 191:635660 , 2001 .
[ 43 ] e. onat .
possibl finit calculus comput mechan .
int .
j. num .
meth .
engng , 60:255281 , 2004 .
[ 44 ] m. kouhi e. onat .
stabil finit element formul high-spe inviscid compress flow use finit calculus .
int .
j. num .
meth .
fluid , 74 ( 12 ) :872897 , 2013 .
[ 45 ] m. kouhi e. onat .
implicit finit element formul compress navier-stok equat use finit calculus .
comput mechan , 56 ( 1 ) :113129 , 2015 .
[ 46 ] y. saad m. h. schultz .
gmres : general minimum residu algorithm solv nonsymmetr linear system .
siam journal scientif statist comput , 7:856 869 , 1986 .
23 latex sourc file click download latex sourc file : adjoint_amr_cor.zip http : //ees.elsevier.com/aescte/download.aspx ? id=114578 & guid=227e84bb-2219-409d-98b1-8212b7af403f & scheme=1
