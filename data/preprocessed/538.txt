fixed-dens boundari condit overdamp langevin simul diffus channel l. ramrezpiscina departa fsica, universitat politecnica catalunya, avinguda doctor maranon 44, 08028 barcelona, spain (dated: june 12, 2018) consid numer integr langevin equat particl channel, presenc boundari condit fix concentr valu ends. kind boundari condit appear instanc consid diffus ion molecular channels, differ concentr side cellular membrane. applic over- damp limit brownian motion (lead order langevin equation) convenient, previou work difficulti associ limit implement boundari conditions. deriv algorithm that, unlik previou attempts, requir simul particl reservoir consider veloc variabl adjust parameters. simul brownian particl simpl case result agre perfectli theory, local concentr valu result particl flux nonequilibrium situations. algorithm appropri model complex ionic channel and, general, treatment analog boundari condit physic model order langevin equations. keywords: stochast differenti equations; numer simulations; brownian motion; boundari condi- tions; ion channel 1. introduct ionic channel protein structur nanometr scale permit cross specif ion cell membrane, lead import physiolog function [1]. ion flow channel driven concentr differ extracellular intracellular media, action electrostat forc membran potential. experi perform singl channel presenc strong fluctuations, ionic flux gate dynam channel [2]. model problem conveni consid diffus motion ion insid channel, combin specif dynam gate [1, 3]. semimicroscop approach achiev mean stochast differenti equations, langevin equations, ion posit variabl [47]. langevin equat emploi model larg varieti system fluctuat relev dynam [8, 9]. equations, dynam variabl obei stochast differenti equat microscop degre freedom substitut stochast term noises. consid langevin dynam popul brownian particles, repres individu ions, move molecular channel particl reservoir fix concentrations, correspond side membrane. low reynold number valu associ small scale impli inertia neglig safe overdamp limit langevin equation, mean problem formul set order stochast differenti equat particl positions. boundari condit brownian particl standard somewhat trivial simul (e.g. absorb reflect boundari condit [8]), fix concentr condit turn difficult implement effici overdamp case [10, 11]. previou attempt involv instanc simul particl reservoir [12, 13], consider random walk discrete-tim brownian dynam [14], emploi veloc variabl [15, 16], shoot method empir find simul paramet [17]. explicit deriv procedur satisfactori method boundari conditions, shortcomings, recent implement ionic channel simul [7, 18, 19]. simplicity, illustr method simul simpl cases, consist non-interact particl one-dimension static channel devoid biolog complexity. treatment boundari condit applic complex realist situations. outlin articl following. section state problem known theoret results, us interpret simulations. sec. 3 deriv algorithm boundari condit fix concentr values. sec. 4 perform numer simul order check method. view obtain result discuss assumpt implicit kind boundari conditions. end conclusions. 2 2. langevin equat fix concentr boundari condit consid tempor evolut ensembl independ brownian particles, move overdamp limit extern potenti v (x) channel length l. simplic consid dimension dynam x-direct particles. extens method three-dimension contact surfac fix concentr immediate. langevin equat posit x (0, l) particl x = dv (x) dx + (t), (1) friction coeffici (t) gaussian white nois zero mean correl given (t)(t) = 2kbt(t t). (2) nois act differ particl independ (uncorrelated). equat construct verifi fluctuation-dissip theorem, lead correct equilibrium solutions. nonequilibrium situat consid channel connect reservoir fix valu particl concentr place end channel, ad extern field act particles. let 1, 2 particl concentr (i.e. number particl unit length channel) x = 0, l respectively. case narrow channel connect larg volumes, valu 1, 2 relat three-dimension concentr ci (particl unit volum reservoirs) = aci, transvers section channel. note narrow channel larg mix reservoir flow ion neglig effect valu concentr reservoirs, permit consid constant valu boundari conditions. order theoret refer simul result conveni consid fokker-planck equat concentr (x, t) [8]: (x, t) t = x f(x)(x, t) +d 2 x2 (x, t), (3) drift veloc f(x) diffus coeffici d given f(x) = 1 dv dx , d = kbt (4) steadi solut eq. (3) boundari condit written (x) = ev (x)/kbt ( 1e v (0)/kbt j kbt x 0 ev (x )/kbt dx ) , (5) j steadi current particles, given j = kbt 1e v (0)/kbt 2ev (l)/kbt l 0 ev (x )/kbt dx . (6) particular case particl move action constant drift (for instanc charg q insid planar capacitor voltag , constitut model membran channel), write v (x) = q(x x1)/l. current j = q l 1 2 exp(q/kbt ) 1 exp(q/kbt ) . (7) larg voltag current control rate particl enter channel, translat depend boundari concentrations, depend sign voltage. is, q/kbt 1 j q2/l, q/kbt 1 j q1/l. limit regim present crossov current regul differ concentr boundari valu voltage. check numer result appropri consid case regimes. 3 3. numer algorithm 3.1. time-discret langevin dynam let consid tempor step t. explicit euler algorithm evolut posit variabl brownian particl eq. (1) calcul new x(t+t) valu old posit x(t): x(t+t) = x(t) + f(x(t))t+ 2dt , (8) gaussian random number zero mean unit variance. later us write equival formul mean condit probabl densiti p(x, x) = 1 4dt exp (x x f(x)t)2 4dt , (9) p(x, x)dx probabl particl posit interv (x, x + dx) end time step (at time t+t) posit x begin (at time t). express corresponds, constant drift (x-independ f), result directli obtain diffus motion origin langevin [eq. (1)]. eq. (9) exact t constant drift case. 3.2. boundari condit boundari condit implement follow way. particl evolv accord eq. (1) end time step particl escap limit system. moment particl disappear simul re-used. time exist certain probabl new particl enter boundari time step. new particles, insert given probability, start dynam initi posit (which determined), evolv rest particl time step exit system. object calcul insert probabl determin distribut initi positions. 3.2.1. rate new particl let consid left boundari x = 0. boundari x = l treat equival way. consid semi-infinit domain (, 0) (the particl reservoir) suppos exist infinit number virtual particl homogen concentr (particl unit length) 1, evolv dynam eq. (1) constant valu drift equal boundary, i.e. f = f(0). virtual particl enter posit x > 0 end time step t. let in(x) local densiti insid new particl previou step outsid system. calcul eq. (9) in(x) = 0 dx1p(x, x ) = 1 2 erfc ( x ft 4dt ) . (10) mean number particl enter boundari time step t calcul integr density. manipulations, known recurr relat integr error function [see instanc eq. (7.2.5) ref. [20]], n = 0 dxin(x) = 1 dt q(a), (11) function q(x) given = f t 4d (12) q(x) = x erfc(x) + 1 expx2. (13) 4 particl arriv independ events, number particl enter time step chosen poisson distribut mean number n calcul eq. (11). standard techniqu [21]. however, small t larg densities, n 1 gener poisson random number avoided. note small eq. (11) reduc n 1 dt/+ 1 2 1ft condit impos condit t, t (21d)1 t (1f)1. case neglect possibl o particl appear time step boundari identifi obtain mean valu probabl appear singl particle, i.e. p(1) n. algorithm reduc gener time step uniform random valu (0, 1), comparison p(1). p(1) particl enter boundary, particl enters. 3.2.2. posit enter particl number particl enter tempor step decided, initi posit determined. place exactli boundary, leav diffus immediately. basic initi posit new particl follow probabl (10), normal eq. (11). is, new posit enter particl probabl densiti p(x) given p(x) = 1 2 q(a) dt erfc ( x ft 4dt ) . (14) order sampl probabl density, standard method involv invers associ distribut function [21]. distribut function obtain integr probability. result p(x) f (x) = x 0 p(x) dx = 1 q ( xft 4dt ) q(a) . (15) then, new particl enter obtain uniform random number (0, 1), desir initi posit given x = f1(). (16) actual invers f (x) numerically, instanc save tabl seri valu f (x) begin simulation, perform interpol desir valu f (x). larg x (i.e. f (x) close 1) us approxim x ft+ 4kbtt ln(2 q(a)(1 ) (17) simul emploi newton method approxim guess fact deriv f (x) function p(x). wai obtain solucion eq. (16) iter yi+1 = 1 erfc yi ( 1 ey 2 (1 )q(a) ) (18) desir converg achieved. initi posit new particl obtain x = ft+ 4kbtt y (19) 4. simul result discuss 4.1. check algorithm perform simul brownian particl follow dynam eq. (1) channel length l = 4. chosen temperatur kbt = 25 friction paramet = 1000. tempor step taken t = 104. unit base length 1 nm, time 0.1 s energi 1 mev valu enter appropri order magnitud ionic molecular channels. check algorithm studi particl concentr channel result particl flux differ cases. particl densiti calcul n = 1000 spatial bin width x = l/n, count number particl insid bin step. 5 0 1 2 3 4 x 0 2 4 6 8 10 ( x) 8 10 12 8 10 12 figur 1: particl concentr vs. posit steadi state differ valu extern potenti boundari condit 1, 2. red (gray) lines: averag 10000 independ realiz system; black lines: averag singl realiz tempor window tmea = 10 6. top: q = 0, 1 = 2 = 10; middle: q = 8kbt , 1 = 2 = 10; bottom: q = 0, 1 = 1, 2 = 10. run test consid constant determinist drift f(x) = f , valu varied. conveni write f = q/l, q potenti energi differ end channel. q understood electr charg particl extern electr voltag respectively. situat consid differ valu concentr boundari condit end channel. simul case valu concentr end system, 1 = 2 = 10. case steadi particl distribut constant, equal valu boundaries, valu drift. measur densities, however, expect present larg fluctuat (sinc particl non-interacting, number bin follow poisson distribution, seen valu local densiti dispers order (x) = /x). conveni averag run independ realiz (reduc dispers 1/ n) perform time averag steadi state. shown fig. 1. present equilibrium situat extern field appli (i.e. q = 0). red (grai print version) line averag 10000 independ realizations, taken reach steadi state. result present correct steadi solution, dispers valu = 0.512 close expect fluctuat (x)/ n = 0.5. black line long tempor averag singl realiz steadi state window tmea = 10 6. dispers strongli reduced, seen result converg perfectli expect solut (x) = 10. impos extern field (q = 8kbt ) maintain boundari condit result shown middl fig. 1. averag 10000 independ realiz [red (gray) line] long tempor averag window tmea = 10 6 (black line). longer equilibrium situation, result agre steadi state solut = constant. dispers valu = 0.507 close expect valu 0.5. agreement remark concentr valu boundari impos simul mean rate new particl enter only, calcul boundari condit local valu drift, expect flux aspect solut problem. dynam particl (and eventu exit system) given exclus trajectori langevin equat (1), valu prescrib concentr data. worth 6 0 1 2 3 4 x 0 1 2 3 4 5 6 7 8 9 10 11 ( x) figur 2: particl concentr vs. posit simul constant extern field q = 8kbt . color (gray) line simul result averag 10000 independ realizations; black line theoret predict eq. (5). blue (dark gray) line: 1 = 1, 2 = 10; red (light gray) line: 1 = 10, 2 = 1. note boundari layer visibl near ends, occur approaches. note compar result particl densiti case extern field (top middl plot fig. 1), complet indistinguishable. present fluctuat uncorrel space, magnitude. local mean valu given solut fokker-planck equat (3), equat presenc constant drift equival switch move refer frame. situat homogen mean densiti invari result chang field expected. test steadi solut reach boundari differ concentr values. q = 0 1 = 1, 2 = 10 simul result local concentr present statist case fig. 1. case steadi solut valu constant slope. result converg theoret solut mean long tempor averaging. observ fluctuat larger higher concentr side, expected, reduc boundary. simul result theoret predict compar fig. 2 larg extern field q = 8kbt boundari condit differ concentr values. simul result (fluctuat color lines, grai print version) averag 10000 realizations. black line correspond theoret predict eq. (5). case (blue, dark gray, line) extern field concentr gradient drive flow direction, left side, case mechan act oposit directions. seen case agreement good. long tempor averag case obtain (not shown), result virtual indistinguish theoret lines. test predict particl flux, eq. (7). test consid situat differ concentr valu end channel, 1 = 10 2 = 1, perform simul differ valu drift, order span differ regimes. averag result time tmea = 10 6. fig. 3 theoret predict simul result particl flux channel agreement virtual perfect regimes: flux control concentr singl end (i.e. larg voltages, posit negative) current proport voltage, 7 -10 -5 0 5 10 15 20 q/k b t -0.2 -0.1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 j( q ) figur 3: particl flux (particl cross channel unit time, averag total time tmea = 10 6) vs. potenti energy, boundari condit 1 = 10 2 = 1. line: theoret predict eq. (7); symbols: simul results. observ differ j valu theori simul case smaller 103. crossov regim flux control concentr ends. fact, analyz obtain values, differ theoret result order magnitud expect statist uncertainti (sinc cross individu particl form independ events, total number tempor span tmea poisson process, impli varianc measur mean flux 2 j = j/tmeas). final simul case channel potenti barrier middle. repres ionic channel complex potenti landscape, presenc gate. follow shape gate refs. [7, 18, 19] add gaussian barrier constant drift, total potenti read v (x) = q(x x1)/l+ vb exp (x xb)2 2l2 , (20) vb height, l width, xb center posit barrier. taken valu vb = 8kbt , l = l/16, xb = l/2, potenti energi differ q = 8kbt . case constant forc term push particl right side, trap barrier result flow reduced. result observ slow transient larg number particl accumul reach steadi state. follow transient compar direct numer integr fokker-planck equat (3). result present fig.4. figur agreement good entir transient. remark rate particl accumul depend critic balanc enter exit particles, boundari conditions. 4.2. boundari condit revisit propos algorithm fix concentr boundari condit belong class method assign probabilist rule appear new particl boundari [1517]. import differ type 8 0 1 2 3 4 x 0 20 40 60 80 100 120 ( x, t) t=0.0 t=0.5 t=1.0 t=2.0 t=10 0 1 2 3 4 -8 -6 -4 -2 0 2 4 6 8 10 12 14 v (x )/ kt figur 4: particl concentr vs. posit transient (t = 0, 0.5, 1, 2) steadi state (t = 10). simul perform extern potenti q = 8kbt potenti barrier specifi eq. (20), represented. color (gray) lines: simul result averag 10000 independ realizations; black lines: numer integr eq. (3); dash line: appli potenti act particles. algorithm buffer zone particl reservoir method dynam boundari outsid simul buffer particles, impli assumpt dynam (for instanc size buffer zone, criteria maintain constant concentration) established. valid assumpt discuss term real physic hand. fact, present algorithm (and algorithm assum probabilist appear particl boundary) import assumpt implicitli assumed: probabl new particl enter depend past exit events, consequ boundari lose memori exit particl instantaneously. equival sai particl reservoir (which explicitli simulated) assum mix time step. immedi effect implicit loss tempor correl near boundaries. illustr consequ assumpt return simpl simul channel barrier valu prescrib concentr end channel. fig. 5 (top) result equilibrium situat extern field appli (q = 0) fig. 1 (top). tempor averag calcul shorter window tmea = 10 3. clearli perform tempor averag appear fluctuat radic differ perform averag independ realizations. concentr valu differ posit correl calcul tempor averages, contribut particl move diffus system, result shape fluctuat appear figure. short length fluctuat short live (their associ diffus time smaller diffus time 2/d) averag out. effect number independ observ statist quantiti correl time tcorr tempor window tmea order tmeas/2tcorr, result dispers reduc squar root effect number (see, instance, ref. [22]). long length fluctuat slower disappear long tempor averages. manifest larg dispers result seen center channel. dispers result strongli reduc boundaries, seen fig. 5 (top). loss tempor correl produc boundaries, fluctuat shorter correl time middl system. result statist dispers tempor averag shorter near 9 0 1 2 3 4 x 8 10 12 ( x) 8 10 12 figur 5: particl concentr vs. posit tempor averag tmea = 10 3 steadi state. top: q = 0; q = 8kbt . boundaries, averag concentr valu better converg prescrib valu boundari condit there. perform shorter tempor averag (not shown) dispers seen larger middl reduc ends, wai prescrib concentr valu verified. fig. 5 (bottom) present case concentr boundaries, appli field q = 8kbt . differ observ fig. 1, tempor averag longer invari chang field. dispers end reduc boundari condit verified, dispers middl channel smaller equilibrium case. determinist drift given extern field. particl averag remain ballist time order l/q, smaller diffus time, shorter time develop densiti fluctuations. lifetim largest fluctuat shorter equilibrium case and, consequence, simul time permit better averag observ dispers smaller. observ constitut indic langevin simul diffus particles, constant concentra- tion boundari condit impli assumpt mere specif mean concentr valu boundaries. illustr point let consid case solv simplest case small piec segment length l larg (or infinite) channel mean densiti free particl equilibrium. level fokker-planck equat mean densiti appropri boundari condit fix valu concentr end segment length l, i.e. consid here. level langevin dynam particles, expect case presenc densiti fluctuat larg scale (much larger piec size l), decai slowly, time order diffus time. then, finit time averag piec length l larg fluctuation, concentr valu boundari condit observed. contrary, wai implement boundari condit work (correspond fokker-planck equat solut mean density) correspond piec larger homogen system, instead length l boundari separ 10 reservoir perfectli mixed. precis loss correl boundari permit prescrib concentr valu observ tempor averages. 5. conclud remark deriv algorithm integr order addit langevin equat presenc fix concentr boundari conditions. method consist let disappear particl exit boundary, appear new particl near boundari accord prescrib condition. calcul appear probabl distribut initi posit new particles. method impli particl memori lost cross boundary, equival reset posit reservoir particl time step. permit elimin fluctuat larger size, hinder verifi boundari condit finit simulations. situat perfect mix reservoirs, method appropri model separ microscop dynam individu particl (i.e. channel) concentr dynam outsid (for instanc mean mesoscop hydrodynam models). resolut dynam boundari condit former. requir case result flux neglig effect reservoirs. import case channel join larg cavities. algorithm boundari condit close relat emploi work [1517], simul particl reservoir avoid consid stochast appear new particl boundary. particular ref. [17] remark prescript necessari initi posit new particl order avoid appear spuriou deplet boundari layer boundary, specif distribut new posit deriv provid flux known. fact limit procedur analyt resolv problem resort shoot method adjust simul parameter. contrari algorithm directli calcul appear new posit probabilities, depend desir boundari condit local drift boundary. result obtain case correct result us adjust parameter. check simul result condit appropri model molecular ionic channel cellular membrane, brownian dynam overdamp limit ion constant determinist drift correspond valu membran potential. result agre perfectli theoret predictions, (steadi transient) densiti distribut result mean flux. magnitud fluctuat agre expect values. point out, method adjust parameter, involv explicit simul particl reservoir consider veloc variabl irrelev low reynold limit. result trace residu boundari layers. appli model formul term trajectori brownian particl follow order addit langevin equat type eq. (1). special appropri langevin approach studi molecular channel model interact gate individu ion action membran potential, refs. [7, 18, 19]. acknowledg work perform context extens collabor prof. j.m. sancho area molecular channel dynamics, fruit discuss gratefulli acknowledged. work support ministerio economia y competividad (spain) feder (european union), project fis2015-66503-c3-2-p. [1] b. hille, ion channel excit membran (sinauer, sunderland, 2001), 3rd ed. [2] c. hammond, cellular molecular neurophysiolog (academ press, amsterdam, 2015), 4th ed. [3] d. g. levitt, annual review biophys biophys chemistri 15, 29 (1986). [4] k. cooper, e. jakobsson, p. wolynes, progress biophys molecular biologi 46, 51 (1985). [5] d. g. levitt, journal gener physiolog 113, 789 (1999). [6] k. lee w. sung, physica a: statist mechan applic 315, 79 (2002), issn 0378-4371, slow dynam process nature, url [7] l. ramrez-piscina j. m. sancho, epl (europhys letters) 108, 50008 (2014). 11 [8] c. w. gardiner, handbook stochast method physics, chemistri natur sciences, vol. 13 springer seri synerget (springer-verlag, berlin, 2004), 3rd ed., isbn 3-540-20882-8. [9] j. garca-ojalvo j. m. sancho, nois spatial extend system (springer, new york, 1999). [10] v. barcilon, d. chen, r. s. eisenberg, m. a. ratner, journal chemic physic 98, 1193 (1993), url [11] a. singer, z. schuss, b. nadler, r. s. eisenberg, phys. rev. e 70, 061106 (2004), url 10.1103/physreve.70.061106. [12] b. corry, m. hoyles, t. w. allen, m. walker, s. kuyucak, s.-h. chung, biophys journal 82, 1975 (2002). [13] a. gomez-marin j. m. sancho, phys. rev. e 77, 031108 (2008), url 77.031108. [14] m. f. schumaker, journal chemic physic 117, 2469 (2002). [15] r. s. eisenberg, m. m. klosek, z. schuss, journal chemic physic 102, 1767 (1995), url [16] b. nadler, z. schuss, a. singer, phys. rev. lett. 94, 218101 (2005), url physrevlett.94.218101. [17] a. singer z. schuss, phys. rev. e 71, 026115 (2005), url [18] l. ramrez-piscina j. m. sancho, european physic journal b 91, 10 (2018), url epjb/e2017-80569-5. [19] l. ramrez-piscina j. sancho, physica a: statist mechan applic 505, 345 (2018), issn 0378-4371, url [20] m. abramowitz, handbook mathemat functions, formulas, graphs, mathemat tables, (dover publi- cations, inc., new york, 1974), isbn 0486612724. [21] w. h. press, s. a. teukolsky, w. t. vetterling, b. p. flannery, numer recip 3rd edition: art scientif comput (cambridg univers press, new york, ny, usa, 2007), 3rd ed., isbn 0521880688, 9780521880688. [22] d. w. heermann, computer-simul method (springer-verlag, 1990), pp. 812.