balanc domain decomposit constraint perturb | siam journal numer analysi | vol. 54, no. 6 | societi industri appli mathemat copyright siam. unauthor reproduct articl prohibited. siam j. numer. anal. c 2016 societi industri appli mathemat vol. 54, no. 6, pp. 34363464 balanc domain decomposit constraint perturb santiago badia hieu nguyen abstract. paper, formul analyz perturb formul balanc domain decomposit constraint (bddc) method. prove perturb bddc polylogarithm bound condit number standard formulation. type properli scale zero-ord perturb considered: us mass matrix, us robin-typ boundari condition, i.e, mass matrix interface. perturbation, well- posed local neumann problem global coars problem automat guaranteed, coars degre freedom defin converg purpos well-posedness. allow simpler implement complic corner select algorithm needed. minim coars space face edg constraint considered. us extrem scale calcul coars problem usual bottleneck jeopard scalability. perturb add extra robust perturb formul work constraint fail elimin small number subdomain rigid bodi mode standard bddc space. extrem import solv problem unstructur mesh partit automat graph partition arbitrari disconnect subdomain possible. numer result provid support theoret findings. kei words. bddc, preconditioner, coars space, parallel solver, scalabl am subject classifications. 65n55, 65n22, 65f08 doi. 10.1137/15m1045648 1. introduction. develop highli scalabl linear solver solu- tion larg scale linear system aris finit element (fe) discret second-ord ellipt problem distributed-memori machin great import applications. work, consid nonoverlap domain decomposi- tion (dd) method [49], advantag partit fe mesh submesh defin effect precondition exploit larg level concur- rency. particular, focu variant balanc dd constraint (bddc) method. bddc method introduc 2003 dohrmann [18]. regard improv version balanc domain decomposit (bdd) method mandel [43]. close connect dual primal finit element tear interconnect (feti-dp) method [25, 24]. fact, eigenvalu precondit system approach ident [44, 41, 15]. bddc method particularli suit extrem scale simula- tions, allow aggress coarsening, comput differ level comput parallel, subdomain problem solv inexactli receiv editor octob 27, 2015; accept public (in revis form) octob 19, 2016; publish electron novemb 29, 2016. funding: work author fund european research council fp7 program idea start grant 258443, comfus: comput method fusion technology, fp7 numexa project grant agreement 611636. work author support catalan govern icrea acadmia research program. universitat politcnica catalunya, 08034 barcelona, spain, cimn centr interna- cional mtode numric en enginyeria, parc mediterrani la tecnologia, upc, 08860 castellde- fels, spain institut research development, dui tan university, 3 quang trung, danang, vietnam, cimn centr internacion mtode numric en enginyeria, parc mediterrani la tecnologia, upc, 08860 castelldefels, spain 3436 d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3437 [19, 42] by, e.g., amg cycle, straightforwardli extend multipl level [50, 45]. properti carefulli exploit seri paper [6, 7, 8, 9], extrem scalabl implement algorithm proposed, lead excel weak scalabl nearli half million core multilevel version (see [29, 30] weak scalabl extrem scale feti-dp method). bddc method base classif node subdomain inter- face corners, member edg faces, base geometr argument input mesh [49]. formul partial subassem- bled fe space continu subdomain weakli enforc quantities, e.g., valu subdomain corner mean valu subdomain edg subdomain faces. dimensions, enforc continu corner weakli scalabl method; i.e., number iter depend local problem size number processor global problem size. dimensions, continu mean valu edg and/or face enforc fast converg [25, 38]. role corner constraint bddc method attain scalability. ensur partial subassembl local problem global coars problem well-posed. structur mesh regular parti- tions, algorithm constraint simple, complic consid unstructur mesh complex three-dimension ge- ometri partit result parallel mesh partitioners, e.g., parmeti [27] pt-scotch [16]. order well-posedness, differ corner select al- gorithm consid [18, 40, 37, 48]. idea algorithm introduc corner constraint partial subassembl problem provabl well-pos corner constraint only. reason edg and/or face constraint usual consid purpos twofold. first, harder check edg face constraint fix rigid-bodi mode elast problems. second, corner constraint suffici well-posedness, partial subassembl systems, indefinit edg and/or face constraint used, reduc posit definit system elimin variabl associ corner [18]. consequently, us effici robust spars method work posit definit systems. altern allow us posit definit spars solver avoid corner constraint consid chang basi explicitli enforc edg face constraint [41, 37]. however, approach straightforward implement notabl chang sparsiti pattern partial subassembl matrices. corner select algorithm drawbacks. base experience, implement type algorithm involv time- consum task depend physic problem solv type fe formul used. example, implement corner select algorithm [48] scientif softwar fempar [4] 1,500 line code. furthermore, situat far complic subdomain disconnected, connect corner edges.1 far know, situat fulli consid formul corner select algorithm [40, 18, 48], lead breakdown bddc method. certainli possibl deal disconnect subdomains, increas 1a example, think elast dimens subdomain sharing, e.g., edge. rigid bodi mode pair subdomain nontrivial. d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3438 santiago badia hieu nguyen complex implement bddc method; solut problem bnn preconditioner, [5]. unfortunately, parmeti [27] pt- scotch [16] parallel mesh partition guarante connect subdomains, awar parallel mesh partition it. situat dramat adapt mesh refin space-fil curv effici load balancing, e.g., exploit morton order [1]. author opinion, find corner constraint guarante well-posed main issu reduc simplic bddc method. work, consid differ simpler approach base perturb formula- tion method. instead corner constraint guarante well-posedness, consid perturb partial subassembl system automat well- posed, regardless choic constraints. type perturb considereda zero-ord term, i.e., mass matrix, us robin-typ bound- ari conditions, i.e., perturb interfac mass matrix. certainly, need number constraint achiev scalability, simpli chosen base geometr properties. perturb local problem well-pos nonover- lap method [17, 22]. however, previou works, method coars space geometr coars space. therefore, pertur- bation affect coars space converg analysi methods. hold bddc method coars space depend formul local problems. fact, check scale coeffici [17, 22] complet differ on propos work requir scalabl purposes. perturb bddc method polylogarithm bound condit number scalable. addition, chosen constraint bddc space contain small subspac rigid bodi modes, prove eigenvalu precondit system, larg isol ones, bound usual bound standard bddc method. words, perturb bddc method scalabl number iter higher compar case rigid bodi mode fixed. further, perturb formulation, well-posed guarante spars direct method posit definit system need corner select mechanisms, corner constraint enforcement, chang basi edg face constraints. import benefit perturb formul fact reduc size coars problem, allow aggress coars- en strategi on standard bddc method. three-dimension problems, corner (includ introduc corner select algorithms) significantli contribut convergence. perturb bddc method consid smaller coars problem in- volv face and/or edges. point particularli import deal unstructur mesh partit gener mesh partition pro- lifer corners. coars problem bottleneck destroi scalability, strategi better suit larg scale simulations. rest paper organ follows. section 1, introduc model problem interfac problem nonoverlap methods. section 2, formul perturb bddc precondition presented. differ type perturb discuss section 3. propos precondition analyz section 4. section 5, numer experi provid verifi theoret d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3439 findings. end draw conclus section 6. 1.1. model problems. let bound domain polygon boundari rn, n = 2, 3. consid model problems. poisson equation. simplic exposition, consid poisson equat homogen dirichlet conditions. weak formul read follows: u(x) h10 () (1.1) a(u, v) = f, v v(x) h10 (), a(u, v) = u v dx, f, v = f(x) v(x)dx. case gener boundari condit involv modif right- hand side, theoret result apply. fact, consid nonhomogen boundari condit numer experi section. linear elasticity. let = dn , assum d clamp homogen dirichlet boundari condition, n subject surfac forc g, i.e., natur boundari condition. bodi forc f . let h10 (, d) n = {v h1()n : v|d = 0}. consid problem find u h10 (, d) n (1.2) a(u,v) = f ,v v h10 (, d) n, a(u,v) = 2 (u) : (v) dx+ div u div v dx, (u) : (v) = 3 i,j=1 ij(u)ij(v), ij(u) = 1 2 ( ui xj + uj xi ) , f ,v = ft v dx+ n gt vds. present work cover poisson linear elast prob- lems. general, proof given poisson problem, comment provid extend linear elast needed. let th shape-regular triangul size h vh h10 () correspond p1 space, i.e., space continu piecewis linear function th vanish . discret problem (1.1) uh vh (1.3) a(uh, v) = f, v v vh. let consid partit subdomain = jj=1j inter- subdomain interfac = jj=1j\. denot h subdomain characterist size. assum subdomain partit obtain aggreg element th. repres vh() interfac space piecewis discret harmon func- tion discret harmon subdomain. global schur complement oper sh : vh() vh(), vh() dual space vh(), defin (1.4) shv1, v2 = a(v1, v2) v1, v2 vh(). d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3440 santiago badia hieu nguyen , denot canon dualiti pairing, i.e, , v = (v). static condensation, process elimin compon function vh vanish reduc (1.3) problem pose interfac space vh() (see [14, section 7.5]), (1.5) shuh = fh, uh vh(), fh = f |vh(). goal formul effici precondition sh. 2. precondition formulation. 2.1. constraints. constraint bddc usual reli topolog clas- sific node interfac subdomain corners, node subdomain edg subdomain faces. subsection, concret definit geometr objects. denot h discret associ th. let n (p) set indic subdomain share node p h, i.e., n (p) = {j : p j h = h j}. node h classifi objects, object g maxim subset node set indices, i.e., n (p) = n (q) p, q g. denot | | cardin set n (g) set subdomain indic associ g, i.e., n (g) := n (p), p g . then, three-dimension space, g classifi face |n (g)| = 2 |g| > 1, edg |n (g)| > 2 |g| > 1, corner |g| = 1. two-dimension problems, g classifi edg |n (g)| = 2 |g| > 1 corner |g| = 1. similar classif introduc [37, 32, 48]. constraint bddc valu subdomain corner averag valu subdomain edg subdomain face. follow subsection, constraint longer respons well-posed local neumann problem global coars problem propos perturb formulation. therefore, chosen base potenti improv converg method. simplicity, work propos choos c, set constraints, decid type constraint want use. words, c contain corner constraints, edg constraints, face constraints, combin options; consid corner constraint dimens choic known noncompetit [24, 25]. 2.2. perturb bddc preconditioner. consid a(, ) perturb bi- linear form a(, ), assum a(, ) satisfi follow assumptions. assumpt 2.1. exist constant cl cu independ size domain (d), size subdomain (h), number subdomain (j) (2.1) cl a(v, v) a(v, v) cu a(v, v) v h10 (). assumpt 2.2. bilinear form a(, ) written a(u, v) = j j=1 aj(uj , vj) u, v h10 (), uj = u|j , vj = v|j , aj(, ) posit definit bilinear form h10 ()|j . assumpt 2.3. local perturb bilinear form aj(, ) introduc assump- tion 2.2 satisfi (2.2) c` aj(vj , vj) aj(vj , vj) vj h10 ()|j , d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3441 aj(u, v) = j u v dx c`> 0 depend size domain (d), size subdomain (h), number subdomain (j). step, present perturb formul bddc method. adopt notat similar [14, section 7.8]. let vh() space piecewis discret harmon function respect (w.r.t.) bilinear form a(, ). defin perturb global schur complement oper sh : vh() vh() follows: (2.3) shv1, v2 = a(v1, v2) v1, v2 vh(). let vj := vh|j vh(j) subspac vj member vanish j . let hj = vh()|j space local aj(, )-discret harmon functions. then, follow hj vj hj = {vj vj : aj(uj , vj) = 0 uj vh(j)}. introduc perturb bddc space associ a(, ): hc = {v l2() : vj = v|j hj , v continu valu constraint c}. (2.4) clearly, vh() hc. symmetr posit definit oper sc : hc hc defin (2.5) scu, v = j j=1 aj(uj , vj) u, v hc, uj = u|j , vj = v|j . note scu, v = shu, v u, v vh() hc. let ej : hj l2() trivial extens (by zero) operator. defin hj := {v hj : ejv hc}, space local aj(, )-discret harmon function interfac constraint c equal zero. hj equip symmetr posit definit oper sj : hj (h j ) defin (2.6) sju, v = aj(u, v) u, v hj . defin coars space perturb bddc preconditioner, (2.7) h0 = {v hc : aj(uj , vj) = 0 uj hj , vj = v|j , 1 j j}, symmetr posit definit oper s0 : h0 h0 follows: (2.8) s0u, v = scu, v u, v h0. obviously, space hc written (2.9) hc = h0 sc h , h|j = h j . remark 2.4. member function h0 satisfi constrain minim property; namely, v0 h0 aj(v0, v0) = min vjvj , vj=v0 c|j h aj(vj , vj). d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3442 santiago badia hieu nguyen order connect space h0 hj vh(), defin averag oper p : hc vh() follows: (2.10) (pv)(p) = 1 |n (p)| jn (p) vj(p) v hc, vj = v|j , p h. want formul precondition sh, sh, need connect vh() vh(). let q : vh() vh() oper defin (2.11) (qv)(p) = v(p) v vh(), p h. oper q (2.11) defin function vh() vh() complet determin nodal valu interface. here, emphas v qv ident interfac h, different. specifically, v harmon extens v|h w.r.t. bilinear form a(, ), qv harmon extens v|h w.r.t. bilinear form a(, ). finally, posit present perturb bddc precondition bbddc : v h() vh() sh. defin follows: bbddc = (qpe0)s10 (qpe0) t + n j=1 (qpej)s1j (qpej) t(2.12) = j j=0 pj 1 j (pj) t, pj = qpej . here, us e0 denot natur inject h0 hc. remark 2.5. note perturb bddc precondition formul perturb oper local subdomain solv global coars solve. perturb bilinear form satisfi assumpt 2.1 2.2, invert oper guarante regardless choic constraints. remark 2.6. emphas bbddc standard bddc precondition formul perturb problem (the pde associ perturb bilinear form). hybrid precondition origin schur oper sh schur oper perturb problem. reduc problem interfac requir solv local dirichlet problem origin form, form perturb precondition requir solv local neumann problem global coars problem perturb form. 3. choic perturb bilinear form. section, present prac- tical choic perturb bilinear form a(, ) subdomain components. 3.1. perturb mass matrix. bilinear form a(, ) aj(, ) chosen follows. a(u, v) = j j=1 aj(u, v), aj(u, v) = aj(u, v) + 1 d2 j uv dx,(3.1) d size (diameter) . emphas scale factor here, i.e., 1/d2, differ scale factor 1/h2 [21]. d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3443 lemma 3.1. bilinear form a(, ) aj(, ) defin (3.1) satisfi assump- tion 2.1 cl = 1 cu = 1 + c, assumpt 2.2, assumpt 2.3 c` = 1. here, constant c depend shape size. proof. inequ assumpt 2.1, 2.2, 2.3 straightforward. second inequ assumpt 2.1 follow friedrich inequ scale argument. here, c constant friedrich inequality, depend shape size (see, e.g, [49, corollari a.15]). case convex, accord [12], scale argument, c = 1/. 3.2. robin perturbation. bilinear form a(, ) defin a(u, v) = j j=1 aj(u, v), aj(u, v) = aj(u, v) + hn1j dn j uv ds,(3.2) d size domain , hj size subdomain j , n dimens physic space . robin perturb local neumann problems, case, pose robin boundari condit (hn1j /d n)u + u/nj = 0 j\, nj outward normal vector j . lemma 3.2. bilinear form a(, ) aj(, ) defin (3.2) satisfi as- sumption 2.1 cl = 1 cu = 1 + c, assumpt 2.2, assumpt 2.3 c` = 1. here, constant c depend size domain size subdomains. proof. need focu second inequ assumpt 2.1, inequ trivial. subdomain j , appli lemma a.17 [49] l = 1, f1(v) = vl2(), trace theorem, v h10 (), v2l2(j) c1|v| 2 h1/2(j) + c2v 2 l2(j) c1|v| 2 h1(j) + c2v 2 l2(j). scale argument fact partit quasi-uniform, exist constant c1, c2 (which depend shape j) v2l2(j) c1 h |v| 2 h1(j) + c2 h 1v2l2(j). sum inequ subdomains, 2v2l2() c1 max h |v| 2 h1() + c2 max h 1v2l2(). v h10 (), bound second term right friedrich inequality. appropri scaling, 2v2l2() c1 max h |v| 2 h1() + c2 max d 2h1|v|2h1(). h < d, follow v2 l2() c dn hn1 |v|2 h1(), c depend d h. remark 3.3. presentation, diffus coefficient, simplic expo- sition, assum 1. however, perturb bddc method extend case coeffici constant subdomain vari greatli d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3444 santiago badia hieu nguyen subdomain another. case, perturb bilinear form (3.1) (3.2) replac a(u, v) = j j=1 aj(u, v), aj(u, v) = j j u v dx+ j d2 j uv dx, a(u, v) = j j=1 aj(u, v), aj(u, v) = j j u v dx+ j h n1 j dn j uv ds, respectively. j denot (constant) diffus coeffici associ subdomain j . case coeffici jump align subdomain interface, perturb formul extend physics-bas bddc [10], recent develop bddc method especi target heterogen problems. remark 3.4. linear elasticity, similar perturb bilinear form used: a(u,v) = a(u,v) + 2 d2 ut v dx, a(u,v) = a(u,v) + 2hn1 dn ut v ds. result similar lemma 3.1 3.2 obtain proof lemma extend vector-spac case help korn inequality: vh1() c ((v), (v))l2() ( c 1 2 a(v,v) ) . remark 3.5. aspect ratio physic domain order 1, domain diamet d obtain mass matrix m pre- post-multipli vector on rais result 1/n, i.e., d = (1tm1) 1 n . geometr inform needed. similar statement hold diamet subdomain obtain good mesh partitioner, e.g., meti [26]. 4. converg analysis. section, analyz converg perturb bddc precondition solv (1.5). first, present tool connect function standard perturb bddc spaces. lemma 4.1 (energi minim properties). v vh() v vh() satisfi v = qv, follow inequ hold: a(v, v) a(v, v),(4.1) a(v, v) a(v, v).(4.2) proof. v = qv, v v ident . consequently, vj = v|j vj = v|j ident j . energi minim properti harmon functions, aj(vj , vj) aj(vj , vj) aj(vj , vj) aj(vj , vj). v v continu functions, add inequ j = 1, . . . , j obtain (4.1) (4.2). d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3445 continu notation. let v , e , f characterist finit element function subdomain corner v, subdomain edg e , subdomain face f , respectively. essenti discret harmon function vanish nodal point j v, e , f equal 1. us notat f . g denot f c g, c depend size domain (d), size subdomain (h), number subdomain (j), particularli constant cl, cu, c`. want explicitli deriv chang condit number come perturbation. follow lemma quot [21, lemma 4.5] (see [38, lemma 2] [49, lemma 4.24]). lemma 4.2. assum j union finit number shape-regular (trian- gular tetrahedral) elements. let f subdomain face j, let ih denot interpol oper finit element space vh. then, u vj (4.3) ih(fu)2 h 1/2 00 (f) . [1 + ln(hj/hj)]2 ( |u|2 h1/2(f) + 1 hj u2l2(f) ) , h1/200 (f)-norm defin h 1/2(j)-norm function extend zero j\f (cf. [49, section a.2]). note assumpt shape j technic requir analysis. attempt relax assumpt success dimen- sion (see [35]). however, bddc feti-dp, analysi reli lemma 4.2, work practic gener partitions, e.g., gener graph par- tition (see [24, 33, 34, 48, 7]). readi state main results. theorem 4.3. smallest eigenvalu precondit bbddcsh satisfi follow lower bound: min(bbddcsh) c1u =: m. proof. proof model proof [14, lemma 7.8.11]. main differ us assumpt 2.1 energi minim properti (4.2) connect perturb formul origin system. equat (2.11) impli v vh(), exist uniqu v vh() v = qv. (2.9) fact vh() hc, write v = v0 + v, v0 h0 v h . (4.4) v = p(v0 + v) = p ( e0v0 + j j=1 ej vj ) = (pe0)v0 + j j=1 (pej)vj , vj = v|j hj . consequently, (4.5) v = qv = qpe0v0 + j j=1 qpej vj = j j=0 pj vj . d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3446 santiago badia hieu nguyen (4.4), (2.6), (2.8), (2.5), (2.9), obtain j j=0 sj vj , vj = s0v0, v0 + j j=1 aj(vj , vj) = scv0, v0 + scv , v (4.6) = sc(v0 + v), (v0 + v) = scv, v = shv, v = a(v, v). energi minim properti (4.2) assumpt 2.1, a(v, v) a(v, v) cu a(v, v) = cu shv, v .(4.7) (4.5), (4.6), (4.7), follow cu shv, v a(v, v) = j j=0 sj vj , vj min v= j j=0 pj vj v0h0, vjh j , (1jj) j j=0 sj vj , vj . estim min(bbddcsh) follow directli abstract addit schwarz framework [14, 7.1.22]. let hc p defin similarli hc p, a(, ) replac a(, ) step lead (2.4) (2.10), respectively. emphas function hc satisfi constraint c function hc. follow assumpt introduc simplifi combin definit ac- ceptabl edg path [38] accept face path [39] case constant diffus coefficient. need analysi option geometr object includ c defin constraints. case coeffici vari subdomain another, origin definit accept path requir (cf. [38, 39, 49]). assumpt 4.4. subdomain a,b share edg face corner edge, share object, g, includ set constraint c, exist sequenc subdomain {a = j1 ,j2 , . . . ,jk = b} satisfi follow properties: (i) share common object g; (ii) j = 1, . . . , k 1, subdomain jm jm+1 share, apart g, object c type t; type t edg face predefined. lemma 4.5. let w hc u = w pw. assumpt 4.4 true, follow estim holds: |uj |2h1(j) . [1 + ln(h/h)] 2 knj |wk|2h1(k),(4.8) uj = u|j , wk = w|k , nj = {k : k j 6= }. consequently, j j=1 aj(uj , uj) . [1 + ln(h/h)]2 j j=1 aj(wj , wj)(4.9) or, equivalently, |pw| . [1 + ln(h/h)]2 |w| ,(4.10) p := p |w| := scw,w = j j=1 aj(wj , wj). d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3447 estim (4.8), (4.9), (4.10) typic analysi feti-dp [24], method close relat bddc. proofs, refer reader [38, lemma 10], [39, lemma 7], [49, lemma 6.36]. here, want emphas choic constraint c, assumpt 4.4 holds. remark 4.6. lemma 4.5 hold linear elasticity; however, requir constraint different. dimensions, need constraint order control rigid-bodi mode subdomain. example, us face constraints, constraint first-ord moment ad fulli control rigid-bodi modes. inform nonoverlap method elasticity, refer reader [36] [37]. theorem 4.7. largest eigenvalu precondit bbddcsh sat- isfi follow upper bound: max(bbddcsh) . cu cl min{c`, cl} [1 + ln(h/h)]2 =: m. proof. proof, follow main step proof [14, lemma 7.8.11] signific chang adapt perturb formulation. v vh(), consid arbitrari decomposit v = qpe0v0 + j j=1 qpej vj = j j=0 pj vj , v0 h0, vj hj , 1 j j . accord abstract addit schwarz framework [14, 7.1.21], theorem 4.7 follow (4.11) shv, v . cu cl min{c`, cl} [1 + ln(h/h)]2 n j=0 sj vj , vj . first, need connect perturb formul standard one. let h0, hj , p : hc vh() ej : hj l 2(), 1 j j , defin similarli h0, hj , p, ej w.r.t. a(, ) instead a(, ) (thei essenti space oper defin standard formul bddc [13, 14]). function h0, hj , h0, h j complet defin valu j = j , uniqu exist v0 h0 vj hj v0|j = v0|j , vj |j = vj |j . therefore, averag extens same; i.e., (4.12) pejvj = qpej vj = pj vj , j = 0, . . . , j. consequently, v = pe0v0 + j j=1 pejvj . let (4.13) v = pe0v0 + j j=1 pej vj =: j j=0 pj vj ; v vh() v = qv. impli v v ident interfac . energy-minim properti (4.1) assumpt 2.1, (4.14) a(v, v) a(v, v) c1l a(v, v). d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3448 santiago badia hieu nguyen (1.4), (2.3), (4.14), follow (4.15) shv, v = a(v, v) c1l a(v, v) = c 1 l shv, v . hand, (4.13), shv, v = sh j j=0 pj vj , j j=0 pj vj (4.16) 2 ( shp0v0, p0v0 + sh j j=1 pj vj , j j=1 pj vj ) . j j=0 shpj vj , pj vj , fact support pj vj li bound number subdomains. pj vj = qpj vj , pj vj vh() ident pj vj vh() . minim properti (4.2), follow shpj vj , pj vj = a(pj vj , pj vj) a(pj vj , pj vj)(4.17) = a(pejvj , pejvj) cu a(pejvj , pejvj), line (4.12) assumpt 2.1. step, relat a(pejvj , pejvj) aj(vj , vj). triangl inequ lemma 4.5 w = ejvj u = ejvj pejvj , obtain a(pejvj , pejvj) = j k=1 ak(pejvj , pejvj) j k=1 ( ak(ejvj , ejvj) + ak(ejvj pejvj , ejvj pejvj) ) . j k=1 ak(ejvj , ejvj) + [1 + ln(h/h)]2 j k=1 ak(ejvj , ejvj).(4.18) j = 0, a(pe0v0, pe0v0) . j k=1 ak(v0, v0) + [1 + ln(h/h)]2 j k=1 ak(v0, v0)(4.19) . [1 + ln(h/h)]2 j k=1 ak(v0, v0). j = 1, . . . , j , (4.18) impli a(pejvj , pejvj) . aj(vj , vj) + [1 + ln(h/h)]2aj(vj , vj)(4.20) . [1 + ln(h/h)]2aj(vj , vj). d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3449 (4.19), (4.20), assumpt 2.1 (for j = 0), assumpt 2.3 (for j = 1, . . . , j), a(pejvj , pejvj) . [1 + ln(h/h)]2 aj(vj , vj)(4.21) 1 min{c`, cl} [1 + ln(h/h)]2 aj(vj , vj) = 1 min{c`, cl} [1 + ln(h/h)]2 sj vj , vj . slight abus notat a0(, ) = j k=1 ak(, ) a0(, ) =j k=1 ak(, ). inequ (4.11) follow (4.15), (4.16), (4.17), (4.21). combin theorem 4.3 4.7, obtain follow main result. theorem 4.8. exist posit constant c, independ h, h, j , cu, cl, c`, (bbddcsh) = max(bbddcsh) min(bbddcsh) c (cu)2 cl min{c`, cl} ( 1 + ln h h )2 . claim well-posed perturb bddc depend choic constraint type partit utilized. however, theorem 4.7 4.8 reli valid lemma 4.5, choic constraint plai import role achiev good rate convergence. essenti condit proof lemma 4.5 object g, set constraint c accept path connect list subdomain associ g. step, studi happen condit hold. lemma 4.9. assum constraint c (4.8) hold subdomain index j, 1 j j . then, perturb bilinear form suggest section 3, following, weaker, estimate: |uj |2h1(j) . [1 + ln(h/h)] 2 (d/h)m knj ak(wk, wk),(4.22) m = n, dimens physic space, robin perturb used; otherwise, m = 2. proof. definit p (2.10), write (4.23) u(x) = kn (x) 1 |n (x)| (wj(x) wk(x)) x j , n (x) = {k : x k = k}. cut uj v , e , f write sum term nonzero individu subdomain corners, edges, faces, respectively, i.e., (4.24) uj = vj vuj + ej ih(euj) + fj ih(fuj). simplicity, present estim face terms. let f face d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3450 santiago badia hieu nguyen share subdomain j k. (4.23) lemma 4.2, ih(fuj)2 h 1/2 00 (f) = ih(f 12 (wj wk)) 2 h 1/2 00 (f ) . [1 + ln(hj/hj)]2 ( |wj |2h1/2(f) + 1 hj wj2l2(f) + |wk| 2 h1/2(f) + 1 hk wk2l2(f) ) . similar estim edg vertex term obtain proof [38, lemma 10] [49, lemma 6.36] modification. sum estim individu objects, follow (4.25) |uj |2h1(j) . [1 + ln(h/h)] 2 knj ( |wk|2h1/2(k) + 1 h wk2l2(k) ) . wk harmon function w.r.t. ak(, ), |wk|h1/2(k) = ak(wk, wk). addition, perturb mass matrix used, note hwk2l2(k) wk 2 l2(k). consequently, (4.25) (3.1) impli |uj |2h1(j) . [1 + ln(h/h)] 2 knj ( ak(wk, wk) + 1 h2 wk2l2(k) ) [1 + ln(h/h)]2 (d/h)2 knj ak(wk, wk).(4.26) case robin perturb used, (4.25) (3.2), |uj |2h1(j) [1 + ln(h/h)] 2 (d/h)n knj ak(wk, wk).(4.27) combin (4.26) (4.27), obtain (4.22). theorem 4.10. perturb bilinear form introduc section 3 used, extrem case constraint c, max(bbddcsh) . cu cl min{c`, cl} (d/h)m [1 + ln(h/h)]2 =: m,(4.28) (bbddcsh) c (d/h)m ( 1 + ln h h )2 ,(4.29) c depend mesh sizes, size domain subdomains, number subdomains. proof. proof combin theorem 4.3, depend choic c, modifi version proof theorem 4.7 lemma 4.9 instead lemma 4.5. remark 4.11. theorem 4.10 give bound condit number pre- condit case constraint used. bound increas number subdomain increases. perturb precon- dition constraint well-posed, scalabl one, like one-level dd method. d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3451 rest section, studi practic case set constraint c fail elimin small number piecewis constant function rigid-bodi mode bddc space. words, consid kersc 6= dim(kersc) dim(vh()), sc : hc hc counterpart sc standard formul bddc method, (4.30) scu, v = j i=1 aj(uj , vj) u, v hc, uj = u|j , vj = v|j . theorem 4.12. assum kersc 6= ; spectrum precondit system, count multiplicities, decompos (4.31) (bbddcsh) = s1 s2, |s1| dim(ker(sc)), s1 [m, m ], s2 [m, m ]. here, constant m, m, m defin theorem 4.3, 4.7, 4.10, respectively. proof. sake brevity, us b s refer bbddc sh, respectively. defin v0 = p ker(sc). vh() decompos (4.32) vh() = v0 s v 0 , i.e., sv0, v 0 = 0, v0 v0, v 0 v 0 . defin ((, )) := b1, , inner product vh(). clearly, bs spd w.r.t. ((, )). addition, v0 v0 v0 v 0 , (4.33) ((bsv0 , v0)) = ((bsv0, v 0 )) = sv0, v 0 = 0. let b1 = {1, . . . , n1} b2 = {n1+1, . . . , n1+n2} base v0 v 0 ; b = {1, . . . , n1+n2} basi vh(). let matrix represent bs w.r.t. basi b. (4.33), (4.34) ((bsj , i)) = ((bsi, j)) = 0 n1 + 1 j n1 + n2, 1 n1. jth column coeffici represent bsj w.r.t. b, (4.34) impli block diagon matrix = diag(a1,a2), a1 a2 matrix represent bs|v0 bs|v 0 w.r.t. base b1 b2, respectively. lead (a) = (a1) (a2). consequently, (bs) = (bs|v0) (bs|v 0 ). dim(v0) dim(ker(sc)), follow |(bs|v0)| dim(ker(sc)). theorem 4.3 4.10, lower bound weak upper bound (bs) obtained, hold regardless choic c, proof finish (4.35) max(bs|v 0 ) m. bs symmetr posit definit w.r.t. ((, )), follow (4.36) max(bs|v 0 ) = maxvv 0 , v 6=0 ((bsv, v)) ((v, v)) = max vv 0 , v 6=0 sv, v b1v, v . d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3452 santiago badia hieu nguyen v 0 contain piecewis constant function case poisson equat subdomain rigid-bodi mode case linear elasticity, result lemma 4.5 theorem 4.7 hold, estim (4.35) largest eigenvalu bs|v 0 . remark 4.13. constraint c fail elimin small number con- stant function rigid-bodi modes, i.e., ker(sc) 6= dim(ker(sc)) dim(vh()), theorem 4.12 indic eigenvalu precondit bound usual bound standard bddc methods. remain eigenvalu larger usual upper bound. however, isol (the number bound dim(ker(sc))). larg isol eigenvalu delai converg cg method iter- ation (cf. [2]), perturb bddc method scalable. obviously, number iter higher case piecewis constant func- tion rigid-bodi mode elimin bddc space addit constraints, consid smaller coars space. 5. numer experiments. section, studi numer experi verifi robust effici perturb bddc method. perturb formul built bddc precondition scientif comput softwar packag fempar (fe multiphys massiv paral- lel) [4], parallel hybrid mpi+openmp, object-ori framework massiv parallel fe simul multiscal multiphys problem govern pde [6, 7]. experi run marenostrum iii bsc (barcelona) hlrn-iii rrzn (hannover). experiments, standard perturb bddc precondition differ option constraint solv linear associ (1.5) cg method. number cg iter time (in seconds) reduc residu factor 1e-6 reported. here, time includ set-up time iter solver time. present data, c, e, f legend indic corner, edge, face constraint used, respectively. suffix 0 express standard bddc formul (no perturbation) used. suffix cd emphas corner select algorithm [48] standard bddc formul used. legend suffix, repres result perturb bddc formul corner select algorithm involved. addition, present result robin perturbation. perturb mass matrix yield ident result (see [11]). 5.1. poisson equat cube. experiment, compar per- formanc perturb standard bddc method poisson equat dis- cretiz structur meshes. consid problem describ (1.1), unit cube [0, 1] [0, 1] [0, 1]. right-hand function f chosen u = x+ y + z analyt solution. us uniform structur hexahedr mesh partit k k k, k = 3, . . . , 11, subdomain exactli shape regular partitions. order studi weak scalabl methods, k increas (the size subdomains, h, decreases), us smaller mesh size, h, h/h constant, i.e., constant local problem size. figur 1 show weak scalabl cg iter (the left column), time d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3453 8 10 12 14 16 18 0 200 400 600 800 1000 1200 1400 1600 1800 n u m b e r o f p c g te ra ti o n s #core weak scale (h/h=10) cef cef0 ce ce0 cf cf0 e ef f 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0 200 400 600 800 1000 1200 1400 1600 1800 t o ta l w ll c lo c k t im e ( s e c s .) #core weak scale (h/h=10) cef cef0 ce ce0 cf cf0 e ef f 8 10 12 14 16 18 20 22 0 200 400 600 800 1000 1200 1400 1600 1800 n u m b e r o f p c g te ra ti o n s #core weak scale (h/h=20) cef cef0 ce ce0 cf cf0 e ef f 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0 200 400 600 800 1000 1200 1400 1600 1800 t o ta l w ll c lo c k t im e ( s e c s .) #core weak scale (h/h=20) cef cef0 ce ce0 cf cf0 e ef f 8 10 12 14 16 18 20 22 24 0 200 400 600 800 1000 1200 1400 1600 1800 n u m b e r o f p c g te ra ti o n s #core weak scale (h/h=30) cef cef0 ce ce0 cf cf0 e ef f 2.8 3 3.2 3.4 3.6 3.8 4 4.2 4.4 4.6 0 200 400 600 800 1000 1200 1400 1600 1800 t o ta l w ll c lo c k t im e ( s e c s .) #core weak scale (h/h=30) cef cef0 ce ce0 cf cf0 e ef f 0 1000 2000 3000 4000 5000 6000 7000 8000 0 200 400 600 800 1000 1200 1400 n u m b e r o f d o f s #core size coars space cef cef0 ce ce0 cf cf0 e ef f fig. 1. poisson equat cube. (the right column). differ test cases, h/h = 10, 20, 30, reported. figur present (in row) size coars spaces, depend partition. figur 1, conclud perturb bddc method, d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3454 santiago badia hieu nguyen propos choic constraints, weakli scalable; namely, number iter constant number subdomain increases. perform perturb bddc method iter number time close standard bddc method. experiment, compar standard method, perturb bddc method requir extra iter reduc residu rel toler 1e-6. differ choic constraints, reconfirm corner constraint contribut converg method ef, e, f number iter cef, ce, cf, number iter cef0, ce0, cf0, respectively. choic corner constraint (which need perturb well-posed) outperform correspond choic corner constraint term time perturb not. term iter number, choic larger coars space (cf. row figur 1) gener requir fewer iterations, on e f. obviously, perform time depend choic constraint ratio h/h. order understand time performance, import note bddc method fine task (solv local neumann problems, comput contri- bution coars matrix, comput fine corrections, etc.), perform parallel processor, coars task (comput coars correction), central processor. roughli speaking, fine task expens (in comput communication) size local problem (also ratio h/h) increases, cost coars task rise size coars space larger. advanc implement bddc method fempar (cf. [7]), type task run parallel overlap run time. long run time coars task complet overlap run time fine tasks, perfect weak scalabl attained. h/h = 10, local problem small coars task clearli dominant. option larg coars space requir time us fewer iter (the overlap effective). situations, order overlap approach effective, multilevel bddc method requir [9]. h/h = 30, local problem reason large, fine task dictat time performance. perform term time resembl perform iter number test case. option larg coars space arriv solut shorter time. h/h = 20, first, fine task dominant. however, number subdomain increases, size coars space increases. coars task signific eventu domin option larger coars spaces, cef, cef0, ce, ce0. come experi linear elasticity. 5.2. poisson equat backward face step domain. exper- iment, compar perform perturb bddc standard bddc poisson equat discret unstructur meshes. consid problem describ (1.1), backward face step domain depict figur 2. solut type problem requir numer simul (turbulent) incompress flow pressur segreg techniqu [23, 3]. problem, homogen dirichlet boundari condit set boundari leftmost face, unknown constrain 1. set forc term f = cos(4x) cos(4y) cos(4z). d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3455 fig. 2. three-dimension backward face step domain unstructur tetrahedr mesh partit 64 subdomain metis. 10 12 14 16 18 20 22 24 26 32 64 128 256 512 1024 n u m b e r o f p c g te ra ti o n s #core weak scale (local problem size = 145k) cef cef0 e ef f 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 32 64 128 256 512 1024 t o ta l w ll c lo c k t im e ( s e c s .) #core weak scale (local problem size = 145k) cef cef0 e ef f 4000 8000 12000 16000 20000 64 128 256 512 1024 n u m b e r o f c o rs e d o f s #core size coars space cef cef0 e ef f fig. 3. poisson equat backward face step domain. experiment, start unstructur tetrahedr mesh roughli 20k, 40k, 80k, 160k elements, us uniform refin meti [26] creat set mesh 32, 64, 128, 256, 512, 1024 subdomains. number node subdomain kept roughli 145k. figur 3, plot number iterations, elaps time, number coars degre freedom (dofs) number subdomain (#cores). result close differ option constraints, better visibility, on cef0, cef, ef, e, f. d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3456 santiago badia hieu nguyen figur 3, iter count option bound number subdomain increases, vari experi subsect 5.1, structur mesh regular partit used. however, partit creat meti [26], control local problem sizenot shape size subdomain ratio h/h. take account, safe consid option constraint yield scalabl bddc variant. addition, perform perturb bddc (with cef) close standard bddc (with cef0) iter count time. option corner (ef, e, f), avail perturb bddc, work favor perform time. 5.3. elast long beam. experiment, compar perfor- manc perturb standard bddc method linear elast prob- lem (1.2) lam paramet = 0.1 = 1.0 bodi forc f = [0.0 -0.005 0.0]t . let long beam [0, 2] [0, 0.5] [0, 0.5]. us natur boundari condit boundari (the plane x = 0), homogen dirichlet boundari condit imposed. us uniform structur hexahedr mesh partit 4k k k, k = 2, . . . , 11, subdomains. figur 4 show displac beam (the solution). fig. 4. linear elasticitylong beam: displac beam bodi forc (right). test problem, simpli choos constraint associ geometr object discuss subsect 2.1 standard bddc method work. need us corner select algorithm switch perturb formulation. possibl options, carri experi cef, cef_cd, ef, e. figur 5 show weak scale term iter number (left column) time (right column), size coars space (last row) differ test case h/h = 10, 20, 30. result problem reconfirm earlier poisson equation. figur 5, clear studi option constraint succe make bddc method scalable. number iter constant number subdomain increases. option larger coars space requir fewer iter converge. however, time perform depend size local problems. small local problem (h/h = 10), coars task dominant, option smaller coars space perform better. larg local problem (h/h = 30), fine task dictat result, option larger coars d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3457 16 18 20 22 24 26 28 30 32 0 1000 2000 3000 4000 5000 6000 7000 n u m b e r o f p c g te ra ti o n s #core weak scale (h/h=10) cef cef_cd ef e 0 5 10 15 20 25 0 1000 2000 3000 4000 5000 6000 t o ta l w ll c lo c k t im e ( s e c s .) #core weak scale (h/h=10) cef cef_cd ef e 20 22 24 26 28 30 32 34 36 38 0 1000 2000 3000 4000 5000 6000 7000 n u m b e r o f p c g te ra ti o n s #core weak scale (h/h=20) cef cef_cd ef e 0 5 10 15 20 25 30 0 1000 2000 3000 4000 5000 6000 t o ta l w ll c lo c k t im e ( s e c s .) #core weak scale (h/h=20) cef cef_cd ef e 25 30 35 40 45 0 1000 2000 3000 4000 5000 6000 7000 n u m b e r o f p c g te ra ti o n s #core weak scale (h/h=30) cef cef_cd ef e 40 45 50 55 60 65 0 1000 2000 3000 4000 5000 6000 t o ta l w ll c lo c k t im e ( s e c s .) #core weak scale (h/h=30) cef cef_cd ef e 0 20000 40000 60000 80000 100000 120000 0 1000 2000 3000 4000 5000 6000 n u m b e r o f c o rs e d o f s #core size coars space cef cef_cd ef e fig. 5. linear elasticitylong beam: robin perturbation. space converg solut time. medium-s problem (h/h = 20), fine task domin small number subdomain eventu overtaken coars task number subdomain increases. conclusion, time-to-solut ultim goal, optim d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3458 santiago badia hieu nguyen choos constraint number iter requir minimal. choic constraint base size local problem number subdomain used. particularly, interest solv larg problem processors, option minim coars spaces, e f, like winners. emphas option avail perturb bddc method. 5.4. poisson equat heterogen coefficient. experi- ment, verifi claim remark 3.3 perturb bddc extend case diffus coeffici constant subdomain vari greatli subdomain another. consid problem describ (1.1), unit squar [0, 1][0, 1]. right-hand function f = 1. consid structur triangular mesh regular partit k k, k = 5, 10, 15, subdomains. ratio h/h kept constant 10. diffus coeffici defin log10(j) = mod(j, 5)/4, j subdomain index, number x-direct y-direction. figur 6 show coeffici partit case k = 10 = 6. basically, altern channel differ valu coefficient. fig. 6. partit coeffici distribut heterogen coeffici experiment. tabl 1, iter number option ce0, ce, e shown take valu {2, 4, 6}. options, number iter constant number subdomain increases. addition, perform perturb bddc method (ce) standard bddc method (ce0). tabl 1 iter number requir poisson equat heterogen coefficient. k 5 10 15 ce0 ce e ce0 ce e ce0 ce e 2 11 11 14 11 12 15 11 12 16 4 11 12 15 12 12 16 12 12 16 6 12 12 16 12 12 17 12 12 17 d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3459 5.5. poisson equat insuffici constraints. experiment, like verifi theorem 4.12 remark 4.13. studi weak scalabl perturb bddc method constraint exclud piecewis constant function bddc space. repeat experi subsect 5.1 float subdomains, constraint imposed. 2 4 6 8 10 12 14 16 18 20 0 200 400 600 800 1000 1200 1400 n u m b e r o f p c g te ra ti o n s #core weak scale (h/h=10) cef: 0 float subdomain cef: 1 float subdomain cef: 2 float subdomain cef: 3 float subdomain 4 6 8 10 12 14 16 18 20 22 0 200 400 600 800 1000 1200 1400 n u m b e r o f p c g te ra ti o n s #core weak scale (h/h=10) ce: 0 float subdomain ce: 1 float subdomain ce: 2 float subdomain ce: 3 float subdomain fig. 7. poisson equation: float subdomain constraint. figur 7 show iter number requir option cef ce differ set subdomain fail constraint. comparison, origin iter number constraint associ option enforc shown. iter number higher origin ones, constant number subdomain increases. words, scalabl maintain impos constraint elimin piecewis constant function bddc space. predict theorem 4.12 remark 4.13. 5.6. elast long beam disconnect subdomains. experiment, studi perturb bddc method maintain scalabl disconnect subdomain partition. work linear elast problem long beam describ previou subsection. how- ever, consid differ partit 8k2k2k, k = 1, . . . , 6, subdomain half consist disconnect parts. figur 8 show partit k = 1 left close-up disconnect subdomain right. experiment, size local problem test case h/h = 20 regular partition. however, special partition, size subdomain larger, ratio test case h/h = 30. experiment, corner detect algorithm [48] standard bddc method work. hand, perturb bddc method work scalabl (see figur 9). better predict theorem 4.12 case number rigid-bodi mode elimin bddc space proport number subdomains. however, number iter increas compar test case h/h = 30 regular partition. subdomain disconnected, increas number iter significant. 5.7. elast cross link. experiment, work realist problem, mechan object shown figur 10. un- structur tetrahedr meshes, uniform refin meti [26], creat 5 mesh 32, 89, 256, 711, 2048 subdomains. mesh, number d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3460 santiago badia hieu nguyen fig. 8. linear elasticitylong beam: partit disconnect subdomain (left) close-up disconnect subdomain (right). 40 45 50 55 60 0 1000 2000 3000 4000 5000 6000 7000 n u m b e r o f p c g te ra ti o n s #core disconnect subdomains: weak scale (h/h=20) cef ef e 0 50 100 150 200 250 300 350 400 450 0 1000 2000 3000 4000 5000 6000 7000 t o ta l w ll c lo c k t im e ( s e c s .) #core disconnect subdomains: weak scale (h/h=20) cef ef e fig. 9. linear elasticitylong beam: disconnect subdomains. node subdomain kept roughli 44k. largest mesh 25m element 4m nodes. 2048 subdomain mesh, disconnected. fig. 10. linear elasticitycross link: mechan object mesh partitioning. figur 11, plot result choic constraint associ cef_cd, cef, ef, e, f. standard bddc corner detect algorithm [48] fail handl largest mesh disconnect subdomain. perturb formul (cef, ef, e, f) converge. take account fact local problem size fix ratio h/h, option f d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3461 number iter bound independ number subdomains. words, scalable. expected, method face constraint (f) weakli scalable. fact face constraint only, rigid-bodi mode fixed. term time, option smaller coars spaces, ef, e, f, better performance. advantag time option signific number subdomain increases. largest mesh, option face constraint requir iterations, fastest option. 0 10 20 30 40 50 60 32 89 256 711 2048 n u m b e r o f p c g te ra ti o n s #core weak scale (rtol=1e-6) cef_cd cef e ef f 1 2 3 5 10 20 40 32 89 256 711 2048 t o ta l w ll c lo c k t im e ( s e c s .) #core weak scale (rtol=1.0e-06) cef_cd cef e ef f 0 20000 40000 60000 80000 100000 32 89 256 711 2048 n u m b e r o f c o rs e d o f s #core size coars space cef_cd cef e ef f fig. 11. linear elasticitycross link: weak scale test. 6. conclud remarks. work, formul analyz per- turb bddc method. method prove algorithm weakli scalable. verifi numer experi scalabl effici stan- dard method set coars constraints. moreover, reli constraint guarante well-posed offer freedom choos them. notably, implement face and/or edg constraint requir chang basi spars direct solver definit systems, corner con- straint corner select algorithm needed. choic lead small coars space ideal extrem scale computation. main advantag method perturb formul bring extra robust work constraint fail elimin small number rigid-bodi mode bddc space, partit disconnect subdomains. point great import deal unstructur mesh automat partitioners. present problem constant coeffici subdomain, work extend problem truli heterogen coeffi- d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3462 santiago badia hieu nguyen cients. known problems, complic strategi need defin constraints; e.g., perturb formul combin approaches, delux scale [20], adapt coars space [46, 31, 28, 47], especi physics-bas bddc [10], deal heterogen coefficients. perturb approach present simpl wai relax role corner constraints. base analysis, select constraint known result fast algorithm origin problem result fast algorithm perturb problem. thus, strategi choos constraint [36, 37] futur work. hand, proof theorem 4.12 provid wai rigor analyz converg properti precondition local defects. develop theori case constraint fix rigid-bodi modes, appli analysi fault- toler (resilient) preconditioners. topic critic forthcom exascal supercomputers. idea elabor elsewhere. acknowledgments. like thank editor anonym ref- erees, suggest help improv paper significantly. finally, author thankfulli acknowledg resources, technic expertise, assist provid red espaola supercomputacin north-german super- comput allianc (hlrn). refer [1] s. aluru f. e. sevilgen, parallel domain decomposit load balanc space- fill curves, proceed 4th intern confer high-perform computing, ieee, washington, dc, 1997, pp. 230235. [2] o. axelsson g. lindskog, rate converg precondit conju- gate gradient method, numer. math., 48 (1986), pp. 499523, bf01389448. [3] s. badia r. codina, algebra pressur segreg method incompress navier-stok equations, arch. comput. method engrg., 15 (2008), pp. 343369, //doi.org/10.1007/s11831-008-9020-3. [4] s. badia, a. f. martn, j. principe, fempar: finit element multiphys massiv parallel, [5] s. badia, a. f. martn, j. principe, enhanc balanc neumann-neumann precondi- tion comput fluid solid mechanics, internat. j. numer. method engrg., 96 (2013), pp. 203230, [6] s. badia, a. f. martn, j. principe, implement scalabl analysi balanc domain decomposit methods, arch. comput. method engrg., 20 (2013), pp. 239262, [7] s. badia, a. f. martn, j. principe, highli scalabl parallel implement bal- anc domain decomposit constraints, siam j. sci. comput., 36 (2014), pp. c190 c218, [8] s. badia, a. f. martn, j. principe, scalabl inexact balanc domain decomposit constraint overlap coarse/fin corrections, parallel comput., 50 (2015), pp. 124, [9] s. badia, a. f. martn, j. principe, multilevel balanc domain decomposit extrem scales, siam j. sci. comput., 38 (2016), pp. c22c52, 15m1013511. [10] s. badia h. nguyen, physics-bas balanc domain decomposit constraint heterogen problems, hal:hal-01337968 [math.na], 2016. [11] s. badia h. nguyen, relax role corner bddc perturb formulation, hal:hal-01337852 [math.na], 2016. [12] m. bebendorf, note poincar inequ convex domains, z. anal. anwendungen, 22 (2003), pp. 751756, d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. balanc domain decomposit perturb 3463 [13] s. c. brenner, function analyt framework bddc feti-dp, domain de- composit method scienc engin xvii, u. langer, m. discacciati, d. e. keyes, o. b. widlund, w. zulehner, eds., lect. note comput. sci. eng. 60, springer, berlin, 2008, pp. 239246, [14] s. c. brenner l. r. scott, mathemat theori finit element methods, 3rd ed., text appl. math. 15, springer, new york, 2008, 978-0-387-75934-0. [15] s. c. brenner l.-y. sung, bddc feti-dp matric vectors, comput. method appl. mech. engrg., 196 (2007), pp. 14291435, 2006.03.012. [16] c. chevali f. pellegrini, pt-scotch: tool effici parallel graph ordering, parallel comput., 34 (2008), pp. 318331, [17] y.-h. roeck p. le tallec, analysi test local domain-decomposit precon- ditioner, proceed 4th intern symposium domain decomposit method partial differenti equat (moscow, 1990), siam, philadelphia, 1991, pp. 112128. [18] c. r. dohrmann, precondition substructur base constrain energi min- imization, siam j. sci. comput., 25 (2003), pp. 246258, s1064827502412887. [19] c. r. dohrmann, approxim bddc preconditioner, numer. linear algebra appl., 14 (2007), pp. 149168, [20] c. r. dohrmann o. b. widlund, bddc algorithm delux scale three- dimension h(curl) problems, comm. pure appl. math., 69 (2016), pp. 745770, //doi.org/10.1002/cpa.21574. [21] m. dryja, b. f. smith, o. b. widlund, schwarz analysi iter substructur algorithm ellipt problem dimensions, siam j. numer. anal., 31 (1994), pp. 16621694, [22] m. dryja o. b. widlund, schwarz method neumann-neumann type three- dimension ellipt finit element problems, comm. pure appl. math., 48 (1995), pp. 121 155, [23] h. c. elman, d. j. silvester, a. j. wathen, finit element fast iter solvers: applic incompress fluid dynamics, 2nd ed., numer. math. sci. comput., oxford univers press, oxford, uk, 2014, oso/9780199678792.001.0001. [24] c. farhat, m. lesoinne, p. le tallec, k. pierson, d. rixen, feti-dp: dual-prim unifi feti methodpart i: faster altern two-level feti method, internat. j. numer. method engrg., 50 (2001), pp. 15231544, [25] c. farhat, m. lesoinne, k. pierson, scalabl dual-prim domain decomposit method, numer. linear algebra appl., 7 (2000), pp. 687714, 1099-1506(200010/12)7:7/8<687::aid-nla219>3.0.co;2-s. [26] g. karypi v. kumar, fast high qualiti multilevel scheme partit ir- regular graphs, siam j. sci. comput., 20 (1998), pp. 359392, s1064827595287997. [27] g. karypis, k. schloegel, v. kumar, parmetis: parallel graph partit spars matrix order library, tech. report, depart scienc en- gineering, univers minnesota, minneapolis, mn, 1997. [28] h. h. kim e. t. chung, bddc algorithm enrich coars space two- dimension ellipt problem oscillatori high contrast coefficients, multiscal model. simul., 13 (2015), pp. 571593, [29] a. klawonn, m. lanser, o. rheinbach, extrem scalabl nonlinear domain decomposit method ellipt partial differenti equations, siam j. sci. comput., 37 (2015), pp. c667c696, [30] a. klawonn, m. lanser, o. rheinbach, fe2ti: comput scale bridg dual- phase steels, parallel computing: road exascale, g. r. joubert, h. leather, m. parsons, f. petersfe, m. sawyer, eds., adv. parallel comput. 27, io press, ams- terdam, 2016, pp. 797806, [31] a. klawonn, p. radtke, o. rheinbach, feti-dp method adapt coars space, siam j. numer. anal., 53 (2015), pp. 297320, [32] a. klawonn o. rheinbach, parallel implement dual-prim feti method three-dimension linear elast transform basis, siam j. sci. comput., 28 (2006), pp. 18861906, d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp copyright siam. unauthor reproduct articl prohibited. 3464 santiago badia hieu nguyen [33] a. klawonn o. rheinbach, inexact feti-dp methods, internat. j. numer. method engrg., 69 (2007), pp. 284307, [34] a. klawonn o. rheinbach, robust feti-dp method heterogen dimen- sional elast problems, comput. method appl. mech. engrg., 196 (2007), pp. 1400 1414, [35] a. klawonn, o. rheinbach, o. b. widlund, analysi fetidp algorithm irregular subdomain plane, siam j. numer. anal., 46 (2008), pp. 24842504, [36] a. klawonn o. b. widlund, select constraint dual-prim feti method elast dimensions, domain decomposit method scienc en- gineering, lect. note comput. sci. eng. 40, springer, berlin, 2005, pp. 6781, //doi.org/10.1007/3-540-26825-1_5. [37] a. klawonn o. b. widlund, dual-prim feti method linear elasticity, comm. pure appl. math., 59 (2006), pp. 15231572, [38] a. klawonn, o. b. widlund, m. dryja, dual-prim feti method three- dimension ellipt problem heterogen coefficients, siam j. numer. anal., 40 (2002), pp. 159179, [39] a. klawonn, o. b. widlund, m. dryja, dual-prim feti method face con- straints, recent develop domain decomposit method (zrich, 2001), lect. note comput. sci. eng. 23, springer, berlin, 2002, pp. 2740, 978-3-642-56118-4_2. [40] m. lesoinne, feti-dp corner select algorithm three-dimension problems, do- main decomposit method scienc engin xiv, i. herrera, d. e. keyes, o. b. widlund, r. yates, eds., nation autonom univers mexico (unam), mexico city, mexico, 2003, pp. 217224. [41] j. li o. b. widlund, feti-dp, bddc, block choleski methods, internat. j. numer. method engrg., 66 (2006), pp. 250271, [42] j. li o. b. widlund, us inexact subdomain solver bddc algorithms, comput. method appl. mech. engrg., 196 (2007), pp. 14151428, 1016/j.cma.2006.03.011. [43] j. mandel, balanc domain decomposition, comm. numer. method engrg., 9 (1993), pp. 233241, [44] j. mandel, c. r. dohrmann, r. tezaur, algebra theori primal dual substructur method constraints, appl. numer. math., 54 (2005), pp. 167193, //doi.org/10.1016/j.apnum.2004.09.022. [45] j. mandel, b. sousedk, c. dohrmann, multispac multilevel bddc, computing, 83 (2008), pp. 5585, [46] j. mandel b. sousedk, adapt select face coars degre freedom bddc feti-dp iter substructur methods, comput. method appl. mech. engrg., 196 (2007), pp. 13891399, [47] c. pechstein c. r. dohrmann, unifi framework adapt bddc, tech. report ricam-report 2016-20, johann radon institut comput appli mathe- matic (ricam), austrian academi sciences, linz, austria, 2016. [48] j. stek, m. ertkov, p. burda, j. novotn, face-bas select corner 3d substructuring, math. comput. simul., 82 (2012), pp. 17991811, j.matcom.2011.06.007. [49] a. toselli o. widlund, domain decomposit methodsalgorithm theory, springer ser. comput. math. 34, springer-verlag, berlin, 2005. [50] x. tu, three-level bddc dimensions, siam j. sci. comput., 29 (2007), pp. 1759 1780, d ow nl oa d 01 /1 6/ 17 t o 5. 19 6. 89 .2 25 . r ed tr ib ut io n su bj ec t s ia m l ic en se o r py ri gh t; s ee h tt p: // w w w .s ia m .o rg /j ou rn al s/ oj sa .p hp introduct model problem precondition formul constraint perturb bddc precondition choic perturb bilinear form perturb mass matrix robin perturb converg analysi numer experi poisson' equat cube poisson' equat backward face step domain elast long beam poisson' equat heterogen coeffici poisson' equat insuffici constraint elast long beam disconnect subdomain elast cross link conclud remark refer