comput multiscal homogen framework account inerti effects: applic acoust metamateri model accept manuscript comput multiscal homogen framework account inerti effects: applic acoust metamateri model d. roca, o. lloberas-valls, j. cante, j. oliv pii: s0045-7825(17)30698-9 doi: reference: cma 11653 appear in: comput. method appl. mech. engrg. receiv date : 4 2017 revis date : 22 septemb 2017 accept date : 26 octob 2017 cite articl as: d. roca, o. lloberas-valls, j. cante, j. oliver, comput multiscal homogen framework account inerti effects: applic acoust metamateri modelling, comput. method appl. mech. engrg. (2017), pdf file unedit manuscript accept publication. servic custom provid earli version manuscript. manuscript undergo copyediting, typesetting, review result proof publish final form. note product process error discov affect content, legal disclaim appli journal pertain. comput multiscal homogen framework account inerti effects: applic acoust metamateri model d. rocaa,b, o. lloberas-vallsa,c, j. cantea,b, j. olivera,c, centr internacion metod numer en enginyeria (cimne) campu nord upc, modul c-1 101, c/ jordi girona 1-3, 08034 barcelona, spain b escola superior denginyeri industrial, aeroespaci audiovisu terrassa (eseiaat) technic univers catalonia (barcelona tech), campu terrassa upc, c/ colom 11, 08222 terrassa, spain c e.t. denginy camins, canal port barcelona (etseccpb) technic univers catalonia (barcelona tech), campu nord upc, modul c-1, c/ jordi girona 1-3, 08034 barcelona, spain abstract framework, base extend hill-mandel principl account inerti effect (multiscal virtual work principle), develop applic acoust problem context metamateri modelling. classic restrict mean valu micro-displac fluctuat gradient account saddle-point formul variat principl term lagrang functionals. physic interpret involv lagrang multipli readili obtained. framework specif tailor model phenomena involv local reson acoust meta- materi (lram). view, addit hypothes base scale separ split fulli coupl micro-macro set equat quasi-stat inerti system. solv consid project microscal equat natur modes, allow low-cost comput treatment multiscal problem. basis, issu numer captur local reson phenomena fe2 context addressed. object obtain result term macroscop finit element (fe) discretiza- tion check accuraci homogen procedur compar direct numer simul (dns). appear local reson band-gap model homogen 2d problem exten- sion multi-lay macroscop materi present initi attempt acoust metamateri design tailor band-gap attenuation. keywords: multiscal modelling, comput homogenization, inerti problems, acoust metamaterials, local reson phenomena 1. motiv field comput multiscal model experienc signific develop decad progress penetr differ applic field simulation-bas techniques. hierarch multiscal techniques, base homogen theory, special captur attent comput mechan commun given abil account microstructur physic phenomena impact macroscop scale. moreover, homogenization-bas multiscal simul regard significantli inexpens comput viewpoint compar (singl scale) direct numer simul (dns) concurr mul- tiscal techniqu [19, 1] micro macro level simultan process computations. featur obvious evid separ lower upper scale increases. focu center comput homogen techniqu constitut inform drive macroscop analysi comput consecut interact macro microscale. correspond author email address: (j. oliver) preprint submit elsevi novemb 10, 2017 words, explicit (or closed-form) macroscop constitut behaviour, obtain success comput perform repres volum element (rve) microstructure. macro/micro inter- action gener refer downscal upscaling, indic sens inform flow. exampl kind techniqu feyel chaboch [7], kouznetsova et al. [15] homogen non-linear behaviour complex microstructur considered. differ type boundari condit mieh koch [21], mesarov padbidri [20] chosen downscaling, impact solut field boundari rve. years, remark progress accomplish appli type techniqu wide rang quasi-stat applic includ complex materi behaviour soften lo- caliz phenomena verhoosel et al. [30], nguyen et al. [23, 22], oliv et al. [25], multiphys phenomena ozdemir et al. [26], larg deform [16] specif structur element beam plate [4]. comput homogen techniqu includ inerti effect constitut main subject current contribution. object present physic sound formul two-scal problem highlight main emerg applications, i.e. multiscal comput analysi design materi unusu properti submit dynam excitations. homogen approach includ inerti effect propos far, e.g. [14, 27, 29], formul rigor variat form recent state [5, 2], gener multiscal framework presented, ground kinemat admissibility, dualiti (relat forc stress-lik quantities) gener hill-mandel principl postul term variat statement name multiscal virtual power principl (mvpp). present contribution, attent focus applic aforement mvpp acoustics. allow simplif respect gener framework. order facilit correspond simpli- fy hypothes turn conveni modif mvpp saddle-point variat problem incorpor lagrang multipli associ kinemat restrictions. enabl deriv correspond- ing euler lagrang equat identif lagrang multipli repres macroscop dalembert forc (bodi forc minu inerti forces) overal stresses. formul particularli us multiscal design approach, target macroscop behaviour easili link microstructur design variables. defin multiscal setting, second contribut specif- ical tailor model acoust problems. specifically, studi sound cancel attenu acoust metamateri base local reson phenomena. instance, formul saddle-point prob- lem includ lagrang multipli enabl identifi limit frequenc band-gap term reson effect partial fulli restrict rve impact macroscop level. author knowledge, precedent dual formul written term lagrang multipli appear [3], macroscal forc stress identifi lagrang multipli link microscal field appli navier-stok equations. saddle-point problem formul emploi lagrang multipli obtain contribut fundament micro-macro balanc principles, allow clear interpret connect scale dynam context. current contribution, microstructur augment equat eman lagrang multipliers-bas approach (includ microscop displac lagrang multipli un- knowns) extended, acoust problems, minim kinemat constraint period boundari condi- tions. contrast approach [29, 18], resolut microstructur micro-macro constraint split superposit quasi-stat inerti solut (on result finit ele- ment rve equat differ materi phases). split ground superposit principl linear system follow assumpt acoust material: (i) macroscop strain produce, themselves, inerti microscop respons (quasi-stat system) (ii) macroscop displac produce, (independ strains), neglig microscop reactiv stress inerti respons (inerti system). aforement identif lagrang multipli plai fundament role justi- ficat assumptions. addition, quasi-stat provid directli homogenis stress lagrang multipli homogen constitut tensor appear classic quasi-stat homogen theory, inerti system, return macroscop inerti forc lagrang multipli (when bodi forc neglected). order reduc comput cost micro-macro coupl inerti system, specif reduc order model techniqu (rom) suggested, i.e. modal analysi approach microscop displac project space span domin reson modes. quasi-stat reduc inerti system provid close form express effect macroscop stress inerti forc 2 l l l macro-scal micro-scal x y rve unit cell rve figur 1: typic multiscal problem configuration. characterist size microscale, l, satisfi l l order preserv separ scales. lead homogen problem consid macroscal linear momentum balanc equations. particular micro macroscal displac field wave-lik solut infinit homogen media, macroscop linear momentum balanc equation, effect properties, turn dispers relation, i.e. given frequenc propag wave direction, wave number associ propag mode obtain macrostructure. effect local reson mode given frequenc captur macroscop dispers curv term band gap region wave attenu excit frequenc li obtain band-gap. specif featur propos framework craig-bampton reduct techniqu requir rve level [29] and, therefore, assumpt specif materi phase necessary, confer propos approach gener character. fact, craig-bampton techniqu [29] obtain relev dynam consid fulli fix matrix boundari reson mode account dynam dens inclusions. present approach, split quasistat dynam solut mention refer augment equat particular materi phases, allow gener descript intern dynamics, present microstructur phase particip reson behaviour. assumpt proven captur suffici local reson phenomena compar direct numer simul object homogen respons differ macroscop meshes. acoust problem modelling, microstructur topolog consid structur regular cell present contribution, strongli motiv us period boundari conditions, allow work gener simpler rve unit cells. date, contribut comput homogen acoust metamateri focu design microstructur period repeat macro level repres macro- scopic homogen layer (cf. [29, 18, 9, 10, 28]). industri point view, interest conceiv macrostructur heterogen body, e.g. compos layer differ underli reson microstructures. allow program metamateri assembl attenu wider spectrum frequenc char- acter certain nois sound. author knowledge, comput framework multidimension studi multi-lay acoust metamateri underli reson microstructur devis open possibl tackl enorm rang applic wider frequenc band obtain and, therefore, complex acoust signal attenuated. applic design metamateri- al countless, instance, devis acoust metamateri given target nois sourc frequenc spectra attenuated. order demonstr capabl propos formul comput model design lram, number 2d repres simul (both micro macro scales) carri work: first, dispers analys perform ideal (infinit homogeneous) medium; second, realist fe analysi taken design acoust panel consist finite-s layer lram attenu properti studied. finally, potenti materi acoust design aspect displai 3 model two-lay macroscop lram. 2. gener energet equivalence-bas homogen framework 2.1. multi-scal problem set-up let consid macroscop solid bodi occupi domain rm smooth boundari (for sake simplicity, present work, assum m = 2, formul gener valid m = 3). spatial coordin macroscal refer x set gener displac field defin u(x, t) : [0,t ] rm. (1) displac gradient tensor j defin j(x, t) = u(x, t) x xu(x, t) (2) j(x, t) = (x, t) + (x, t) (3) (x, t) = sxu(x, t) = 1 2 (u(x, t) x + x u(x, t)). (4) (x, t) = skewx u(x, t) = 1 2 (u(x, t) x x u(x, t)). (5) being, respectively, (symmetric) infinitesim strain tensor (skew-symmetric) infinitesim rotat tensor [24]. point x associ repres volum element (rve) microscal and, sometimes, possibl identifi period repetit structur known unit cell (cf. fig. 1). order distinguish variabl associ microscal macroscop counterparts, subscript refer former. follow rule, rve denot rm, smooth boundari spatial coordin refer y. also, sake readability, angl bracket / paper oper rve volum averag integr field (), 1 ()d; 1 ()d (6) . kinemat connect scale establish consid order expans kinemat variabl associ point x macroscale, u(y, t) = u(x, t) + j(x, t) (y y0) + u(y, t), (7) yu(y, t) = j(x, t) + yu(y, t), (8) u j local valu displac field gradient macroscop level, y0 coordin centroid rve u micro-fluctu field. context, impos fluctuat field symmetr gradient satisfy, time t [0,t ], u(y, t) = 0, u(y, t) = u(x, t); (9) sy u(y, t) = 0, syu(y, t) = (x, t). (10) equat (9) (10) fact y0 centroid rve domain and, therefore, y y0 = 0, considered. equat (9) (10) refer literatur minim kinemat restrict [2]. 4 remark 1. import note time scale macro micro scales, fix kinemat connect displac fields, establish relat rate (velocity) fields. particular, mean restrict (9) (10) satisfi rate field correspond symmetr gradients. 2.2. fundament hypothesi homogen framework propos gener inerti case classic hill-mandel principl quasi-stat problems. model deriv work blanco et al. [2], gener multiscal framework present base main hypotheses: (a) kinemat admiss scales, (b) mathemat dualiti macroscop force/stress quantiti correspond kinemat variables, (c) so-cal multiscal virtual power principle, deriv equilibrium equat variat arguments. [27], gener inerti case hill-mandel principl proposed. model propos ground applic macroscal classic postul continuum mechanics, i.e. linear angular momentum balanc laws: x (x, t) + f(x, t) = 0, (11) (x, t) = t(x, t), x , t [0,t ]. (12) macroscop stress f dalembert forc density. sake simplicity, remain present work context infinitessim strain elast behaviour (linear elasticity), framework cauchi continua, account bodi forc surfac traction extern action continuum medium [24]. equat (11) (12) complement dalembert forc densiti definit cauchi stress theorem appli boundari : f(x, t) = b(x, t) p(x, t), (13) (x, t) n(x) = t(x, t), x (14) b p bodi forc linear momentum densities, respectively, n t outward unit normal traction vector correspond boundary, respectively. note us dot accent () refer time deriv superscript ()t stand tensor transposition. now, context linear elasticity, microscale, assum (y, t) = c(y) : syu(y, t), (15) c(y) constitut elast tensor associ microscal materi phases. furthermore, given densiti field microscal (y), defin linear momentum densiti microscal p(y, t) = (y)u(y, t), (16) microscop dalembert forc densiti f(y, t) = b(y, t) p(y, t) = b(y, t) (y)u(y, t), (17) u microscop inerti force. remark 2. notic macroscop counterpart equat (15) (17) specif postul obtain result homogen procedure. 2.3. hill-mandel principl multiscal virtual power principl [2] postul energet equival scale regard gener classic hill-mandel principl quasi-stat problems. formul 5 given f(u(x, t)), (u(x, t)), x , t [0,t ] (18) f(u(y, t)), (u(y, t)), y , t [0,t ] (19) : sx u f u = : sy u f u , (20) u u u, whereu space kinemat admiss displacement-r fields, u microscal u := {u = u + xu (y y0) + u | u u0}, (21) which, turn, defin term spaceu0 admiss micro-fluctu displacement-r fields, u, u0 := { u : [0,t ] rm | u = 0; sy u = 0}. (22) remark 3. notic that, equat (20) (22), perturb u subject restriction, allow choose, given spatial point x, independ local valu u(x, t)|x=x sx u(x, t)|x=x . then, follow procedur [2], obtain express homogen valu local macroscop dalembert forc densiti stress: f = f ; (23) = f s (y y0) . (24) on, symbol s express s b = 1 2 (a b + b a). (25) insert result (23) (24) equat (20), return variat problem solv rve. denot u u, read u(y, t) : [0,t ] rm, u u fulfil p u + : syu b u = 0, u u0. (26) microscop counterpart equat (13) considered. remark 4. equat (26) constrain variat principl restrict solut inu (cf. equat (21)), i.e. fulfil u(y, t) u(x, t) = 0, syu(y, t) (x, t) = 0. (27) 6 2.4. lagrang functional-bas homogen variat problem equat (26) solved, given geometr materi distribut rve valu macroscop displac strain [2], prove conveni reformul saddle-point problem lagrang multipliers. way, work unconstrain perturb field obtain reaction constraint (27) directli lagrang multipli identification. similar approach adopted, instance, work blanco et al. [3], context so-cal multiscal virtual power principl homogen navier-stok equations. so, let consid variat statement (26) optim condit constrain minimiza- tion problem rve, (u; u) = p u + : syu b u = 0, (28) restrict u u u u0. disregard explicit express function (u), obtain extend lagrangian function ad constraint (9) (10) correspond lagrang multipliers, , respectively. yield follow saddle-point problem term unconstrain displac field u(y, t) : [0,t ] rm, (t) : [0,t ] rm, (t) : [0,t ] sym2(rm), fulfil {u,, } = arg min u max , {(u) u u : syu }. (29) optim condit saddle-point problem (29) result follow variat equations: (p b ) u + ( ) : syu = 0, u; (30) u u = 0, ; (31) syu : = 0, . (32) note that, contrast restrict variat equat (26), express (30) (32), variabl (includ perturb field u, ) total unconstrained. regard, advantag situation, appropri choos u that, particular, a) u = a,a spatial constant vector, gets, equat (30), = p b = f ; (33) b) u = (y y0),a spatial constant symmetr second-ord tensor, = + (p b) s (y y0) = f s (y y0) . (34) compar result express (23) (24), prior fulli solv equat (30) (32), identifi lagrang multipli local macroscop homogen dalembert forc densiti stress, respectively, (x, t) = f(x, t) = f (35) (x, t) = (x, t) = f s (y y0) (36) 7 classic variat problem formul saddle-point problem formul : syu f u = 0, u u0 f = f = f s (y y0) ( ) : syu (f + ) u = 0, u u = u su = hill-mandel principl : f u = : sy u f u = f = f s (y y0) unknown fields: u, , perturb restrictions: unknown field: u perturb restrictions: u u0 variat statement (unconstrained):vari statement (constrained): results:results: figur 2: summari kei concept equival homogen procedur base hill-mandel principl energet equival scales: classic variat formul saddle-point problem formulation. fig. 2 sketch kei idea involv propos homogen procedur presented. addition, fig. 3 show graphic represent action reaction involv rve problem. 3. applic acoust problem formul present far, take account minim kinemat restrict micro-displac strain field (see express (9) (10)) gener kind inerti problem far energet equival principl (and separ scales) holds. on, focu problem field acoustics, addit hypothes suitabl emploi order simplifi analysi interpret results. note that, context acoust problems, homogen scheme avail literature. instance, work sridhar et al. [29], extens hill-mandel principl inerti case substructur techniqu (name craigh bampton mode synthesis) deriv multiscal model local reson acoust metamaterials. propos homogen framework, eventu lead similar results, offer clear approach allow simplifi model context acoust problem simpli emploi physic hypothes requir reli substructur techniques. addition, on, bodi forc equat sec. 2 neglected, consid reason assumpt tackl acoust problems. f = b p p (37) f = b p p (38) 3.1. introduct period boundari condit deal period materi structur (such as, instance, problem involv acoust metamaterials), conveni impos addit set condit offer accur 8 x u(x, t) (x, t) f(x, t) = (x, t) (x, t) = (x, t) n u u figur 3: schemat represent rve problem. macroscop displac strain given point input associ rve system. macroscop stress dalembert forc densiti relat microscop traction forc n constant bodi forc f reactions, respectively. represent kinemat coupl scales. particular framework, prove suitabl consid period boundari condit micro-fluctu field u rve boundary. sake simplicity, let consid common case squar (or rectangular) rve1 (see fig. 4). order introduc period boundari conditions, consid boundari line () = ()1 () 2 (+) = (+) 1 (+) 2 , = () (+). let defin jump function () jk(y, t) = ()(y + `(y), t) ()(y, t), y (), (39) `(y) = `1, y ()1 `2, y ()2 (40) `i period vector associ boundari region () (cf. fig. 4). noted, definit `, jyk = `(y), y (). framework, period boundari condit formul (see equat (7)) juk = 0, juk = j jyk = j `, y (). (41) worth note that, construction, period boundari condit equat (41) fulfil follow equation: u s n = 0 u s n = sxu syu = sxu . (42) diverg theorem appli equat (42). therefore, period boundari conditions, auto- matic impos request minim kinemat restrict (10), later need impos more. then, period condit modifi space admiss micro-fluctu fieldsu0 tou0 , u0 := {u : [0,t ] rm | u = 0; juk = 0} u0. (43) 1more gener rve shape consid gener propos scheme. 9 () 1 () 2 `2 `1 (+) 1 (+) 2 rigid bodi displac homogen gradient displac micro-fluctu displac field u u j (y y0) u period boundari condit () = () 1 () 2 (+) = (+) 1 (+) 2 figur 4: micro-displac field compon represent period boundari typic 2d squar unit cell. period boundari condit appli micro-fluctu field order better repres kinemat connect specif problems. note express (23) (24), deriv consequ gener hill-mandel principle, valid context, micro-fluctu field chosen obtain them, u = 0, satisfi u u0 . addition, period boundari condit saddle-point problem (29) account simpli remov equat consid new field lagrang multipli (y) enforc restrict (41) point-wis boundari (). saddle-point problem (29) rephras u(y, t) : [0,t ] rm, (t) : [0,t ] rm, (y, t) : () [0,t ] rm, fulful {u,,} = arg min u max , {(u) u u (juk j `)() }, (44) constraint equat (41) considered, optim condit yield (p ) u + : syu juk() = 0, u; (45) u u = 0, ; (46) (juk j `) () = 0, . (47) remark 5. interestingly, note identif effect macro-inertia hold case, u = constant, juk = 0 syu = 0 equat (45), express 10 (33). macro-stress, relat considering, again, u = (yy0) (with constant symmetr second-ord tensor) (45) final yield s `() = + p s (y y0) = (48) juk = jyk = ` (see equat (41)) considered. remark 6. note that, contrast , turn constant rve, incorpor 3 new degre freedom extend lagrang multipli system, (y) point-wis variat boundari (), translat larg set degre freedom spatial discretized. hence, better, practice, strong-form imposit period boundari condit u equat (45) (47), semi-restrict saddle-point problem read u(y, t) : [0,t ] rm, u | juk = j `, (t) : [0,t ] rm, fulful {u,} = arg min u max {(u) u u }. (49) 3.2. multi-scal problem resolut follows, analysi focus problem that, macroscop level, follow setup: x = p, s.t. u(x, 0) = u0(x), u(x, 0) = v0(x), u(x, t) = u(x, t), x u (x, t) n(x) = t(x, t), x . (50) macroscop bodi forc neglected, b 0, u denot boundari region (such u = ) displac traction prescribed, respectively. resolut scheme start analysi rve, galerkin-bas spatial finit element dis- cretiz considered, result discret augment matrix form given m 0 0 0 0 0 0 0 0 u + k nt bt n 0 0 b 0 0 u = 0 u , (51) u stand vector micro-displac field nodal values, m k standard mass stiff matrices, respectively, n b addit matrices, deriv definit detail appendix a. 3.2.1. right-hand decomposit proce derivation, given rve linear, split subsystems, account right-hand equat (51): m 0 0 0 0 0 0 0 0 u(1) (1) (1) + k nt bt n 0 0 b 0 0 u(1) (1) (1) = 0 0 , (52) 11 x p = x u(x, t) (x, t) = ceff : sxu p = r u + qq quasi-stat compon inerti compon u 2 q + q = qt u modal project rve problem hypothesis: u 0, 0 hypothesis: 0 m 0 0 0 0 0 0 0 0 u + k nt bt n 0 0 b 0 0 u = 0 u figur 5: global homogen scheme appli acoust problems. macroscop displac strain action rve system. macro-stress obtain reaction quasi-stat compon rve system, macro-inerti force, account local micro-reson modes, come inerti compon rve system. 12 m 0 0 0 0 0 0 0 0 u(2) (2) (2) + k nt bt n 0 0 b 0 0 u(2) (2) (2) = 0 u 0 , (53) sum system (52) (53) return origin (51). remark 7. hypothes assum here, accept wide rang acoust problems, simplifi resolut approach cost establish certain limit frequenc model valid. noted, however, acoust applications, frequenc region rais 20 khz, typic upper bound human hear range, higher frequenc consid relev contexts. includ also, instance, low-frequ rang local reson acoust metamateri typic operate, given separ scale condit that, context, translat macroscop wavelength satisfi l [29]. make propos approach well-suit studi character local reson phenomena2. 3.2.2. quasi-stat solut focus subsystem (52), hypothesi assum macroscop strain acceler- ation tackl acoust (elast wave propagation) problem small consid rve behav quasi-stat [24], is, inerti respons neglig (u(1) 0). hypothesi support separ scale assumption, accord l and, therefore, macroscop strain time evolut (x, t) consid slow induce, themselves, relev microscop acceler u(1) (y, t). this, accord equat (33), allow anticip u(1) 0 (1) = u(1) 0, (54) make abl second row column (52), yield classic quasi-stat equations3 [ k bt b 0 ] [ u(1) (1) ] = [ 0 ] , (55) solv (1) give (1) = (1) = ceffmin : . (56) ceffmin classic elast effect (homogenized) quasi-stat constitut tensor. remark 8. case appli period boundari conditions, mention sec. 3.1, variabl (1) withdrawn equat (55) period boundari condit directli appli u(1) , lead ku (1) = st. (57) (1) = ceffper : . (58) detail resolut system (55) (57) comput ceffmin c eff appendix b.2. 2in addition, consid acoust homogen settings, microscop cell exhibit symmetri ax inerti compon macroscop stresses, u(y, t) s (y y0) , exactli equal zero. therefore, term neglect follows. 3where, hypothesi infinitesim microfluctu field, u(1) 0, consid case u = 0, remain condition, equat (52), nu (1) = u(1) = u + (y y0) + u(1) = u(1) 0 automat fulfilled. 13 3.2.3. inerti solut subsystem (53), small displac u appear right-hand drive actions, follow assumpt made4 (2) 0. (59) similarli previou case, hypothesi allow remov row column (53), result call inerti equations5 [ m 0 0 0 ] [ u(2) (2) ] + [ k nt n 0 ] [ u(2) (2) ] = [ 0 u ] (60) variabl (2) condens equat (60) give rise m u + k u = dtu, (61) u stand vector nodal valu fluctuation-lik field, d regard density-lik matrix coupl micro macro accelerations, m k are, respectively, mass stiff matric obtain condens restrict (60). detail deriv term given appendix b.3. on, refer (61) restrict inerti system. note express obtain case appli disregard period boundari condit consid (the differ matric involv defined, explain appendix b.3). result macroscop inerti force, read (2) = r u + d u, (62) r effect averag densiti tensor that, explain appendix b.3, specif cases, r = i, r u = u rve averag density, = . (63) remark 9. note that, accord equat (62), identifi compon homogen inerti forc account macroscop acceleration, r u, addit inerti term, d u (coupl micro-macro inerti forces), aris density-lik matrix, d, micro-fluctu acceler field, u, stem solut rve equat (61). anticip local reson phenomena result mutual cancel terms, give rise unusu dynam properties, frequenc band-gaps, tackl sec. 4. 3.3. modal analysi 3.3.1. micro-inerti problem project restrict mode hypothes resolut global rve allow isol inerti contribut micro-fluctu field transfer macroscal equat (61). now, order allow better interpret dynam role u plai macroscale, us consid gener eigenvalu problem restrict k m defin 4since, assumpt microfluctu gradient infinitesimal, sy u(2) 0, then, = 0, (2) = + sy u(2) 0, (2) = c : (2) 0. (2) (2) 0. 5where, addit condition, equat (53), bu (2) = (2) 0, automat fulfil assumpt infinitesim microfluc- tuation gradient. 14 = [ (1) ... (n) ] (64) = [(1) ... (n)]t (65) fulfil (k (k)m)(k) = 0, (k)t m(k) = 1 (66) second equat (66) simpli indic eigenmod mass-normalized. specif case dynam system, eigenvalu (k) identifi squar natur frequenc (k)2 ( (k) = (k)2 ), (k) k-th natur vibrat mode, fulfil t m = t k = 2 , (67) = diag[ (1) ... (n) ], (68) diagon matrix contain natur frequencies, (k) , restrict system. now, solut u project space span eigenmod u = k (k) q (k) = q , (69) q column vector modal amplitudes, q (k) , restrict system. note decomposit impli addit simplif long consid k rang 1 total number degre freedom (61). additionally, equat (61) project set mass-norm natur vibrat modes, yield t m q + t k q = t dtu, (70) which, take account equat (67), result 2 q + q = qtu, (71) q call coupl matrix q = d. (72) note that, introduc express (69) equat (62), obtain (2) = r u + qq. (73) equat (71) turn uncoupl degre freedom q(k) , facilit physic mathemat interpret solution. preced set rve problem project natur mode rve found, context bloch-floquet theory, [13]. however, specif issu present approach allow discrimin project relev mode basi inform provid coupl matrix equat (72), similarli [29]. 15 3.3.2. micro-inerti problem project unrestrict mode consid gener eigenvalu problem, term unrestrict k m equat (60), i.e. m u + ku = 0, (74) natur frequenc mass-norm vibrat mode matrices, case read , respectively. again, solut field u(2) problem (60) altern project space span unre- strict eigenmodes, , u(2) = q, (75) [ 0 0 0 ] [ q (2) ] + [ 2 tnt n 0 ] [ q (2) ] = [ 0 u ] . (76) altern project us tackl dynam effect rve system. 3.3.3. micro-inerti reduct let focu optim comput cost problem. purposes, us procedur insert call reduc order model (rom) techniques. goal solv problem optim low-dimens sub-spac span relev mode [8]. remark 10. note (71) has, principle, degre freedom u(2) origin system. however, coupl matrix q equat (73) reveals, natur vibrat mode effect macroscale. particular, rel import mode k assess correspond column, q(k), coupl matrix q, allow determin set relev mode associ column, q(k), negligible. set propos automat yield reduc order model microscal rve problem, i.e. base project fe problem equat (60) space span relev reson rve modes. seen sec. 4, number requir mode (rve degre freedom) enorm reduc comparison origin fe element problem, lead substanti reduct multiscal analysi comput cost. modal amplitud q (71) uncoupled, reduct perform retain relev mode amplitud ((k) , q (k) ) (71) correspond column q. additionally, point remark 7, particular context acoust problems, perform reduct consid macroscop frequenc rang restrict certain set limit frequenc lim. make relev mode associ higher natur frequenc interest framework allow remov correspond degre freedom system. regard, approach is, instance, especi well-suit analysi local reson acoust metamaterials, seen exampl sec. 4, comput cost reduct strategi applied. . 3.4. homogen macroscal problem 3.4.1. gener model hypothes consid rve resolut (see sec. 3.2.2 3.2.3), includ micro- inerti modal projection, obtain, effect macroscop inerti forc stress, p(x, t) = (1)(x, t) + (2)(x, t) (2)(x, t) = r u(x, t) + qq(x, t), (77) (x, t) = (1)(x, t) + (2)(x, t) (1)(x, t) = ceff : sxu(x, t). (78) equat (54) (59) considered. 16 introduc previou express macroscal equat (50) yield gener homogen equival problem macroscop problem: x (ceff : sxu) = (p (2)) = r u + qq, (79) microscop problem: q + 2 q = qtu. (80) equat (79) (80) constitut coupl equat allow solv macroscop microscop unknown u q, respectively. 3.4.2. model ideal wave propag problem note formul present far gener hypothes assum rve resolution. particular framework acoust problems, consid wave-lik solut kind u(x, t) = u( x t), (82) u amplitud function, angular frequenc (time frequency). equat (82), = n wavevector, n give propag direct correspond wavenumb (spatial frequency), turn relat wavelength accord = 2/. simplest represent plane wave constant frequenc propag direct n travel macroscop infinit structur come express u harmon function, typic formul complex number space u(x, t) = uei(n xt), (83) u(x, t) = 2uei(n xt), (84) sxu(x, t) = s uei(n xt). (85) where, sake simplicity, amplitud vector u rm assum constant. remark 11. emphas type wave equat (83) (85) solut ideal wave propag problems, typically: wave propag infinit homogen medium propag wave affect boundari condit (reflect waves, etc.). term ideal wave propag problem. context, look solut microscal problem modal amplitud vector q behav harmon oscil excit macroscop frequenc , satisfi q(t, ) = 2q(t, ), (86) gener solut q = q e it. replac express (86) equat (80), allow solv unknown q rve q(t, ) = ( 2i 2 )1qtu(x, t), (87) transfer macroscal (by replac equat (87) equat (79)), yield x (ceff : sxu) = (p (2)) = reff() u, (88) reff() = r + r(); r() = q(2 / 2 i)1qt. (89) 17 box 1 algorithm resolut multiscal homogen acoust problem data: - frequenc rang interest: [0, lim] - unit cell finit element discret results: mass matrix: m eq. (a.20) stiff matrix: k eq. (a.21) restrict matrices: n eq. (a.22) b eq. (a.23) addit matrices: eq. (b.25) y eq. (b.26) determin homogen mechan inerti properti (homogenization): - appli period boundari conditions? - comput matrix: t = - comput effect constitut tensor: ceffmin eq. (b.12) ye - comput matrices: p eq. (b.3) l eq. (b.4) l eq. (b.5) t = p - comput effect constitut tensor: ceffper eq. (b.22) - comput matric inerti problem: restrict mass matrix: m eq. (b.38) restrict stiff matrix: k eq. (b.37) averag densiti tensor: r eq. (b.34) density-lik matrix: d eq. (b.35) - modal analysi restrict rve system: (k 2 m) = 0 2 , - retain relev mode frequencies: (k) , (k) | d(k) > tol (k) < lim (81) - comput coupl matrix: q = d solv coupl macro-micro acoust problem (fe discret eq. (79) (80)): [ muu muq mqu kqq ] [ u q ] + [ kuu 0 0 kqq ] [ u q ] = [ f 0 ] 18 r effect averag densiti tensor defin appendix b.3 reff assum role effective, frequenc depend pseudo-dens tensor. note express (88) format wave equat equat (83) expect solution. fact, replac solut kind equat (88), obtain call dispers relation: d(, )u = [ nt c effn ( )2 reff() ] u = 0. (90) equat (90) provides, given pair (, n), correspond wavenumb amplitud unit vector u, result standard eigenvalu eigenvector problem. worth note preced altern set fast comput dispers properti materials, context bloch-floquet theory, [6, 12, 17]. however, work, goal detail comparison differ method establish assess variat base hierarch homogen procedur suitabl comput model real 2d 3d acoust problems. note that, general, guarante reff() posit definit frequenc . particular: a) excit frequenc equal natur frequenc unrestrict (74), = (n) , consid q = 2q equat (76) solv (2) yield k (n (k) )(n (k) ) t (k)2 2 (2) = uei(n xt). (91) now, multipli side equat (91) (n)2 2 take limit (n) yield (n(n) )(n (n) ) t(2) = 0. (92) long (n) < kern, equat (92) yield (2) = 0 disregard valu u. recal that, consid ideal case, macroscop inerti forc given (see equat (88)) (2) = reff u = 2reff() uei(n xt) = 0, (93) u, yield reff = 0. (94) mean that, excit frequencies, , equal natur frequenc unrestrict system, (n) , matrix reff null and, therefore, macroscop problem (79) quasi-static. addition, replac condit equat (90), yield = 0 = 2/ . b) excit frequenc approach natur frequenc restrict (61), (n) , equat (89) express index notat reveal reffi j () = ri j + k qikq jk (k) 2 1 , (95) now, regard matrix d equat (90), consid follow possibl situations: b1) (n) left ( . (n) ), reffi j + matrix d positive-definite, r (96) 19 tabl 1: materi geometr properti lram unit cell designs. paramet unit nylon steel materi id - 1 2 densiti m3 1100 7800 young modulu gpa 2 180 poisson ratio - 0.40 0.33 dim. unit config. config. b config. c l mm 5.000 5.000 5.000 r mm 1.250 0.500 1.250 r mm 1.875 1.000 1.750 b mm 0.100 0.100 0.100 b2) (n) right ( & (n) ), reffi j matrix d negative-definite, c im() re() = 0 (97) mean that, excit frequencies, , equal natur frequenc restrict system, (n) , compon pseudo-dens tensor, reff, pass + wavenumb pass real-valu imaginary-valued. remark 12. note case b2) (or, general, pure imaginari ), complex charact wavenumb make equat (83) u(x, t) = a(x)eit; a(x) = ue||n x, (98) a(x) impli amplitud decai propag direct (the wave amplitud decreas wave advances). consequ previou considerations, identifi frequenc interv bound natur fre- quenci restrict unrestrict problems, [, ], effect pseudo-dens matrix, r eff, be- come unbound negative-definit (at begin interval) subsequ evolv reff = 0 (at end interval), wavenumb remain imaginary-valued. addition, [, ] defin band incident frequenc macroscop wave get progress attenuated, local reson phenomena, advanc infinit medium accord equat (98). correspond so-cal frequenc band-gap [11]. specif determin band-gap posit frequenc domain analyt obtain consid ideal problem (infinit homogen media). otherwise, resort numer solut (see sec. 4 exampl illustr behaviour). 4. exampl following, algorithm sketch box 1 appli resolut number 2d multiscal homoge- nize acoust problems. 20 l b r r 1 2 e1 e2 figur 6: unit cell configur parameters. number correspond materi id tab. 1. (1) = 9.83 khz (2) = 10.49 khz (3) = 28.67 khz (4) = 30.31 khz (5) = 47.64 khz (1) = 5.32 khz (2) = 11.12 khz (3) = 15.66 khz (4) = 65.14 khz (5) = 78.52 khz restrict unrestrict q(1) = [ 39.39 0 ] q(2) = [ 0 0 ] q(3) = [ 0 41.99 ] q(4) = [ 23.37 0 ] q(5) = [ 0 18.68 ] figur 7: 5 vibrat mode associ natur frequenc unit cell configur unrestrict (top) restrict (bottom). correspond column q(k) coupl matrix q shown (unit kg1/2m3/2). 21 tabl 2: effect properti lram unit cell designs. param. unit config. config. b config. c ceff11 gpa 0.948 2.532 1.125 r11 m 3 2149 1208 2211 q(1)1 1/2m3/2 -39.39 17.42 -39.58 (1) khz 5.32 17.48 6.89 (1) khz 9.83 19.82 12.39 4.1. unit cell effect ideal problem consid infinit homogen domain macroscal assumpt consid develop sec. 3.4.2 applied. goal compar effect cell design acoust macroscop properties. macroscop problem equat (79) solv analytically, case, microscop equat (80) solv numer fe discretization. result obtain exampl repres actual materi behaviour, interest academ purpos provid control environ easili understand phenomena involv unusu properti acoust metamaterials. order achiev typic properti acoust metamaterials, unit cell design guarante exist relev reson mode frequenc rang (up 20 khz). accomplished, instance, call local reson acoust metamateri (lram), local reson phenomena occur condit meet consid assumptions. practic lram design, needs, least, follow element part unit cell: a) rigid compon support structure. element assum role matrix configuration, support reson element attach together. rel stiff element guarante separ scale l. b) dens compon act reson element. kei aspect practic lram design al- low element natur vibrat frequenc desir frequenc range. typic surround highli flexibl materi (or void regions) order promot appear low natur frequencies. frequenc band-gap size locat relat shape densiti elements. order displai facts, differ geometr configur considered. fig. 6 depict geometr paramet materi distribut consid refer unit cell. valu geometr materi properti consid exampl list tab. 1. mesh consist 2d linear triangular element 2000 degre freedom case. global homogen scheme sec. 3 appli consid period boundari condit prescrib micro-fluctu field point rve boundari order prevent rigid bodi motions. therefore, corner unit cell, micro-fluctu displac prescribed6 (thi similar work [29])7. mass stiff matric comput considering, respectively, 3 1 gaussian quadratur point integr element. modal analysi perform matlab consid fulli unrestrict k m restrict k m. unit cell configur a, fig. 7 show 5 vibrat mode associ natur frequenc unrestrict restrict systems. result vibrat modes, on (in frequenc rang interest) exhibit non-negligible8 compon correspond column 6period boundari condit extend restrict corners. 7numer experiment ad type restrict slightli improv homogen result (specif reason current investigated). however, proven restrict add symmetr correspond reaction squar rve cancel summat and, therefore, chang physic interpret lagrang multipli . 8the consid valu tol equat (81) tol = 108 22 coupl matrix q (see remark 10), appear good candid reson modes. focus longitudin wave (with wave amplitud propag direction), interest on context acoust problems, mode relevant. therefore, expect model captur effect macroscale. tab. 2 give specif effect properti (for horizont component) obtain analysi unit cell configuration. frequenc analysi macroscop problem perform frequenc rang 0 25 khz (a total number 500 evenli space frequenc test point considered) aim studi propag characterist horizont direct (n = e1). note hypothes assumed, effect constitut tensor, ceff equat (88), consid constant frequenc range. fig. 8, result macroscop acoust properties, compon densiti tensors, reff11 , r11, r11 (see equat (89)), normal wavenumb l/2 obtain dispers relat (90), shown. check phenomena anticip equat (96) (97) frequenc band interv (band-gap) [(1) , (1) ] there. 4.2. valid propos homogen model order valid homogen model acoust problem propos sec. 3 (see fig. 5), let consid realist macroscop problem, similar9 propos [29], consist small-width homogen macroscop layer. fig. 9 schemat repres macroscop problem setup. thick (horizontal) direction, 10 stack type unit cell consid defin macro-structure. vertic direc- tion, layer consid infinite-s correspond boundari condit applied. sake simplicity, properli captur local reson phenomenon, focu studi simul horizont plane wave propag finit macroscop domain analysi thick direct (see fig. 9). harmon wave given frequenc horizont direct prescrib macroscop left boundari layer u = u0 sin(t)e1 (see fig. 9). order repres vertic infinit dimens , period macroscop displac condit impos upper lower boundari , (+) (), respectively. unit cell, boundari condit previou example. right macroscop boundari left free, aim analys displac amplitud affect presenc frequenc band-gaps. valid propos homogen scheme compar result direct numer simul (dns) analysis, monoscal fem mesh consist linear triangular element (the consid rve calculations), on obtain homogen model differ macrocop fem mesh consist linear quadrilater element 4 gaussian integr points. frequenc analysi perform rang evenli space 500 excit frequenc 0 25 khz, amplitud ratio horizont displac upper-right corner (point b fig. 9) input harmon excit obtain (point fig. 9). result shown fig. 10. interest obtain frequenc band-gap similar predict ideal problem previou example. addition, peak shown curv correspond reson frequenc homogen macroscop medium. fig. 11, profil horizont displac amplitud steadi state respons upper boundari (+) shown, select frequencies, compar dn multiscal model. clearli observ attenu effect wave amplitud frequenc insid band-gap (see, instance, profil = 7.21 khz fig. 11). note result homogen differ dn increas frequenc analysi (see fig. 10). expect simplifi hypothes assum hold strongli closer get quasi-stat case ( = 0) effect higher-frequ reson mode (which neglect here) relevant. addition, increas macroscop frequenc approach separ scale limit, caus multiscal theori fail. however, result excel agreement 9it differ referenc work 2d charact homogen macroscop model consid contrast 1d model consid there. 23 0 5 10 15 20 25 -5000 -2500 0 2500 5000 0 5 10 15 20 25 0 0.025 0.050 0.075 0.100 0 5 10 15 20 25 -5000 -2500 0 2500 5000 0 5 10 15 20 25 0 0.025 0.050 0.075 0.100 0 5 10 15 20 25 -5000 -2500 0 2500 5000 0 5 10 15 20 25 0 0.025 0.050 0.075 0.100 frequenc (khz) frequenc (khz) densiti (kg m3) wavenumb (l/2) unit cell unit cell b unit cell c r11 r11 reff11 im() re() reson frequenc (restrict system) reson frequenc (unrestrict system) predict frequenc band-gap figur 8: compon effect pseudo-dens tensor (left column) correspond normal wavenumb (right column) unit cell configuration. frequenc band-gap defin reson frequenc restrict unrestrict rve system configuration. see, instance, unit cell a, (1) = 5.32 khz (1) = 9.32 khz fig. 7. notic sign chang r eff 11 (from + ) begin band reff11 = 0 end, imaginari charact wavenumb (respons attenu macroscop amplitude) band cases. number test frequenc 500, line plot actual repres frequenc test point studied. 24 u : u = u0 sin(t)e1 (+) () l = 50 mm dn (+) () homogen model ba ba l = 5 mm ... ... e1 e2 figur 9: macro-scal problem setup. harmon horizont displac prescrib left boundari dn (up) homogen model (down). period boundari condit appli upper lower boundari simul infinit materi extens vertic direction. mesh dn model compos 18400 triangular element homogen model, mesh 10, 40 250 (a figure) quadrilater element used. 25 0 5 10 15 20 25 1010 105 100 105 dn homog. (10 el.) homog. (40 el.) homog. (250 el.) frequenc (khz) u (b ) 1 /u (a ) 1 region figur 10: amplitud ratio horizont compon displac point b. comparison dn homogen model result differ number elements. amplitud ratio smaller 1 impli effect wave attenu larger 1 impli effect wave amplification. 500 test point consid rang [0, 25] khz, line plot repres actual frequenc tested. 0 10 20 30 40 50 -1 0 1 posit x1 (mm) u 1 | x (+ )/ u (a ) 1 dn homog. = 4.21 khz = 7.21 khz = 10.22 khz figur 11: amplitud ratio horizont compon displac boundari point horizont direction. comparison dn homogen model result differ input frequencies. frequenc rang interest, hypothes assum hold strongly. prove correct propos homogen scheme case. 4.3. approach lram design section 4.1 abl minor chang rve topolog lead differ result and, particular case, differ band-gap locat sizes. fact open wide rang possibl topolog optim design aiming, instance, control size locat frequenc band- gap (here altern term acoust attenu bands). let consid aim design artifici materi (metamaterial) optim attenu properties, instance, human hear range. materi homogen macro-structur (see sec. 4.2) limit number band-gap cover interv interest, follow question arises: stack homogen layer (everi attenu certain rang frequencies), design multi-lay materi attenu band span rang interest? fig. 12 show attenu curv correspond differ bi-lay materials, obtain dn homogen analysi equal perform exampl sec. 4.2. predict band-gap 26 0 5 10 15 20 25 1010 105 100 105 dn homog. 0 5 10 15 20 25 1010 105 100 105 dn homog. frequenc (khz) u (b ) 1 /u (a ) 1 frequenc (khz) u (b ) 1 /u (a ) 1 a) b) b c 25 mm 25 mm 25 mm 25 mm b c figur 12: amplitud ratio horizont compon displac point b multi-lay configurations: (a) layer 25 mm unit cell configur b predict band-gap region (shade areas) separated; (b) layer 2.5 cm unit cell configur c predict band-gap region (shade areas) overlapped. dn result compar obtain homogen model. amplitud ratio smaller 1 impli effect wave attenu larger 1 impli effect wave amplification. 27 correspond unit cell depict figure. again, compar dn solu- tion, realiz good perform propos multiscal homogen scheme non-homogen problems. case (a), predict band-gap unit cell lie separ region frequenc domain, macroscal observ addit low-level attenu li band-gap regions. second case (b), ideal predict band-gap overlap, non-homogenen solut show attenu band span ideal band-gap region relev attenu levels. sens design (b) improv design (a) purpos get continu wider attenu band multi- layer material. mere exemplif room comput design acoust metamaterials, case multi-lay configurations, reliabl homogen scheme, propos work, available. addit research subject current ongoing. 5. conclus work, hierarch multiscal homogen approach account inerti effect acoust problem present follow features: a) consider standard cauchi continua macro scale assum classic conserv linear angular momentum multiscal virtual power principl [2]. b) result mechan problem mathemat state unrestrict saddle-point problem incorpor lagrang multipli new dual unknowns. then, analyt identifi appropri choic perturb field explain physic manner term macroscop stress dalembert forc densiti terms. c) result formul final specifi acoust problems, assumpt (decomposit sum quasi-stat inerti systems) allow identifi simpl coupl term micro macroscal equations. addition, comput cost reduct strategy, base project restrict unrestrict natur mode microstructure, used. d) context, simple, physic meaning effici homogen scheme account inerti ef- fect proposed. scheme appli comput homogen acoust metamaterials. multiscal formul present contribut illustr number repres simula- tion homogen macrostructur heterogen macroscop bodi layer structure. case microstructur particular natur frequenc associ homogen portion macrostructure. framework repres start point coupl topolog optim tool order design specif microstructur render desir macroscop frequenc cancel attenu properties. left futur contribut complet comput materi design tool outlin base propos homogen procedur goal orient macroscop cost functions. shown present results, framework proven successfulli captur unusu macroscop behaviour acoust metamateri caus local reson phenomena significantli low comput cost. academ exampl valid expect frequenc band gap theoret bound (in term wave number) microscop eigenfrequ obtain constrain unconstrain cases. expect behaviour effect pseudo-density, i.e. nullifi reson frequenc unrestrict tend infinit restrict system, observ report valid test. multilay metamateri studi report second exampl suggest room design complex acoust metamateri capabl attenu specif target frequenc spectrum, e.g. human voice, en- vironment nois engin vibrations. view, combin suffici layer differ microscop topolog envisag cover desir spectrum frequenc attenuated. research is, how- ever, requir complement preliminari result open possibl studi complex constitut behaviour microscale, e.g. viscoelast effect dissip phenomena, order provid wider attenu frequenc rang effect attenu mechanisms. 28 acknowledg research lead result receiv fund european research council european union seventh framework programm (fp/2007-2013) / erc grant agreement n. 320815 (erc advanc grant project advanc tool comput design engin materi comp-des-mat). oriol lloberas-val gratefulli acknowledg fund receiv spanish ministri economi competit nation research plan 2014: mat2014-60919-r. appendix appendix a. finit element discret order solv rve problem, galerkin-bas discret consid spatial domain, microscal domain split ne elements, (e) , e = 1, 2 ... ne. (e) , solut field variat interpol u(y, t) = n(e) (y)u (e) (t) u(y, t) = na(y)u (t), (a.1) u(y, t) = n(e) (y) u (e) (t) u(y, t) = na(y) u (t), (a.2) u(y) = n(e) (y)u (e) u(y) = na(y)u , (a.3) superscript denot discret node solut field interpolated, interpol valu ua u , n (y) associ shape functions. compact form, u (e) u (e) dispos ua ua, respectively, column vector fashion, n (e) dispos n (y) row vector fashion. accord definitions, symmetr gradient displac field obtain syu(y, t) = b(e) (y)u(e) (t) syu(y, t) = ba(y)u (t), (a.4) syu(y) = b(e) (y)u(e) syu(y) = ba(y)u , (a.5) ba(y) defined, accord voigt notation, ba(y) = na/y1 0 0 na/y2 na/y2 n /y1 , (a.6) b(e) correspond arrang term matrix form. discret form variat state- ment (30) (32), written, element, b ub ((e) nbna ua + bbt c(e) baua nb bbt )(e) = 0, u b , (a.7) na ua(e) = u(e) , (a.8) baua(e) = (e) . (a.9) 29 or, matrix form, (e) n(e)t n(e) (e) u (e) + b(e)t c(e) b(e) (e) u (e) n(e)t (e) b (e)t (e) = 0, (a.10) n(e) (e) u (e) = u(e) , (a.11) b(e) (e) u (e) = (e) . (a.12) where, assum element compos singl materi phase, (e) correspond densiti c (e) constitut tensor. consid plane strain behaviour, c(e) expressed, voigt notation, c(e) = e(e) (1 + (e))(1 2(e)) 1 (e) (e) 0 (e) 1 (e) 0 0 0 (1 2(e))/2 , (a.13) e(e) element associ materi young modulu (e) poisson ratio. equat (a.10) (a.12) compactli written m(e) 0 0 0 0 0 0 0 0 u(e) + k(e) n(e)t b(e)t n(e) 0 0 b(e) 0 0 u(e) = 0 u (e) (e) , (a.14) m(e) = (e) n(e)t n(e) (e) , (a.15) k(e) = b(e)t c(e) b(e) (e) , (a.16) n(e) = n(e) (e) , (a.17) b(e) = b(e) (e) . (a.18) standard matrix assembl process, global result m 0 0 0 0 0 0 0 0 u + k nt bt n 0 0 b 0 0 u = 0 u , (a.19) m = e m(e) , (a.20) k = e k(e) , (a.21) n = e n(e) , (a.22) b = e b(e) , (a.23) big symbol denot matrix assembl operation. 30 appendix b. rve resolut appendix b.1. applic period boundari condit 2d case j equat (41) written j = + ; = [ 11 12 12 22 ] ; = [ 0 0 ] (b.1) (x, t) infinitesim in-plan rotat angle. order appli period boundari conditions, second equat express (41) discretized, yield u = [ p l l ] u , u(i) u() u(+) = 0 0 0 0 0 0 0 l l u(i) u() , (b.2) where, 2d voigt notation, p = 0 0 0 , (b.3) l = ... `1(y( j)) 0 `2(y( j))/2 0 `2(y( j)) `1(y( j))/2 ... , y( j) (), (b.4) l = ... `2(y( j)) `1(y( j)) ... , y( j) (), (b.5) superscript (i), () (+) refer intern node node ly boundari region () (+), respectively. appendix b.2. resolut quasi-stat appendix b.2.1. quasi-stat minim kinemat condit accord express (55), quasi-stat consid minim kinemat restrict read [ k bt b 0 ] [ u(1) (1) ] = [ 0 ] . (b.6) note (b.6) defin rigid bodi motion, urb, belong kernel k b, kurb = 0, (b.7) burb = 0. (b.8) mean that, close solut exist u(1) , solut (1) defin disregard valu urb. 31 then, prescrib arbitrarili 3 dof u(1) , (b.6) [ kff bf t bf 0 ] [ uf(1) (1) ] = [ 0 ] , (b.9) non-singular. schur complement kff condens bfk ff 1 b f t (1) = , (b.10) and, eventually, (1) (1) = (bfk ff 1 b f t ) 1. (b.11) express (b.11), identifi quasi-stat effect constitut tensor ceffmin = (b f k ff 1 b f t ) 1. (b.12) appendix b.2.2. quasi-stat period boundari condit discret optim condit problem (49), constrain period boundari conditions, yield ku(1) = r (1), kii k k i+ ki k k + k+i k + k ++ u(i) u() u(+) = 0 (1) (1) (b.13) superscript (i), () (+) refer, again, intern node node ly boundari region () (+), respectively. equat (b.13), (1) vector nodal lagrang multipli act boundari reaction impos period boundari conditions. notic u(1) equat (b.13) defin rigid bodi motion (involv in-plan translat rotation). now, appli period boundari condit (see equat (b.2)) (b.13), yield pt lt lt k [ p l l ] u(1) = pt lt lt 0 (1) (1) = 0 lt (1) lt (1) . (b.14) now, l rigid bodi rotat field, belong kernel k, kl = 0, ltk = 0 equat (b.14) rewritten [ pt lt ] k [ p l ] [u(1) ] = [ 0 lt (1) ] , (b.15) lt (1) = 0, (b.16) equat (b.16) simpli state equilibrium moment associ reaction (1). additionally, lt = (1) discret counterpart equat (48), [ k s t s c ] [ u(1) ] = [ 0 (1) ] , (b.17) 32 k = p tkp, (b.18) c = ltkl, (b.19) s = ltkp (b.20) note that, system (b.15) (b.17), homogen stress, (1), appear reaction action . equat (b.17), solut field u(1) defin rigid bodi translat (recal rotation, , remov origin (b.14) appear equation). hence, 2 dof u(1) need arbitrarili prescrib order avoid singular matrix. conditions, given , (b.17) solv (1), yield (1) = (c sf kff 1 sf t) : = ceffper : , (b.21) ceffper quasi-stat effect constitut tensor account period boundari conditions, read ceffper = c sf kff 1 sf t. (b.22) appendix b.3. resolut inerti recal equat (60), inerti rve read [ m 0 0 0 ] [ u(2) (2) ] + [ k nt n 0 ] [ u(2) (2) ] = [ 0 u ] . (b.23) order deal (b.23), us explicitli consid rigid bodi motion micro- displac field, u(2) , u(2) = [ y t ] c u(2) (b.24) = ... 1 0 0 1 ... , (b.25) y = ... (y( j)2 y (0) 2 ) y( j)1 y (0) 1 ... , (b.26) t = i, minim kinemat condit p, period boundari condit (b.27) c rigid bodi translation, infinitesim in-plan rotat angl u(2) remain compon solut field case assum role micro-fluctu like field. note that, drive action case = 0, period boundari condit account resolut scheme simpli set t = p instead t = i, case account minim kinemat restrictions. 33 now, introduc express (b.24) (b.23) pre-multipli equat [i y t]t, find itmi itmi itmt 0 ytmi ytmy ytmt 0 ttmi ttmy ttmt 0 0 0 0 0 c u(2) (2) + 0 0 0 0 0 0 0 0 0 ttkt ttnt 0 nt 0 c u(2) (2) = 0 0 0 u . (b.28) note y rigid bodi modes, k[i y] = 0, consid equat (b.28). furthermore, construct matrix n, easi verifi ni = and, y0 centroid rve, ny = 0. second equat (b.28), obtain = (ytmy)1ytm(c u(2) ), (b.29) substitut yield itmi itmt 0 ttmi ttmt 0 0 0 0 c u(2) (2) + 0 0 0 ttkt ttnt nt 0 c u(2) (2) = 0 0 u , (b.30) m = m(i y(ytmy)1ytm). (b.31) now, equat (b.30), obtain c = u ntu(2) . (b.32) introduc express (b.32) second equat (b.30) yield (2) = r u + d u(2) (b.33) r = itmi, (b.34) d = itm(i in)t. (b.35) finally, introduc express (b.32) (b.33) second equat (b.28), find m u (2) + k u (2) = dtu, (b.36) k = t tkt, (b.37) m = t t(i in)tm(i in)t. (b.38) remark 13. point here, construct matric m, y, itmi [ 0 0 ] , (b.39) itmi [ (y2 y(0)2 ) (y1 y(0)1 ) ] = y(0)2 y2 y1 y(0)1 . (b.40) 34 equat (b.40), case geometr center rve, y0, coincid center mass yg, i.e. y0 = yg = y , (b.41) matrix itmi automat vanishes, yield r = itmi = i, (b.42) d = itm(i in)t. (b.43) refer [1] t. belytschko, s. loehnert, j. h. song. multiscal aggreg discontinuities: method circumv loss materi stability. intern journal numer method engineering, 73(6):869894, 2008. [2] p. j. blanco, p. j. sanchez, e. a. souza neto, r. a. feijoo. variat foundat gener unifi theori rve-bas multiscal models. archiv comput method engineering, 23(2):191253, 2016. [3] p.j. blanco, a. clausse, r.a. feijoo. homogen navier-stok equat mean multi-scal virtual power principle. method appli mechan engineering, 315:760 779, 2017. [4] p. cartraud t. messager. comput homogen period beam-lik structures. intern journal solid structures, 43(34):686696, 2006. [5] e.a. souza neto, p.j. blanco, p.j. sanchez, r.a. feijoo. rve-bas multiscal theori solid micro-scal inertia bodi forc effects. mechan materials, 80, a:136 144, 2015. [6] david c dobson. effici method band structur calcul 2d photon crystals. journal computataion physics, 149: 363376, 1999. [7] f. feyel j. l. chaboche. fe2 multiscal approach model elastoviscoplast behaviour long fibr sic/ti composit materials. method appli mechan engineering, 183(3-4):309330, 2000. [8] j.a. hernandez, j. oliver, a.e. huespe, m.a. caicedo, j.c. cante. high-perform model reduct techniqu comput multiscal homogenization. method appli mechan engineering, 276:149 189, 2014. [9] m. i. hussein, g. m. hulbert, r. a. scott. dispers elastodynam 1d band materi structures: analysis. journal sound vibration, 289(4-5):779 806, 2006. [10] m. i. hussein, g. m. hulbert, r. a. scott. dispers elastodynam 1d band materi structures: design. journal sound vibration, 307(3-5):865 893, 2007. [11] m. i. hussein, m. j. leamy, m. ruzzene. dynam phonon materi structures: histor origins, recent progress, futur outlook. appli mechan reviews, 66(4):040802, 2014. [12] mahmoud hussein. reduc bloch mode expans period media band structur calculations. proceed royal societi london a: mathematical, physic engin sciences, 465:28252848, 2009. [13] mahmoud hussein gregori m hulbert. mode-enrich dispers model period materi multiscal mix finit element framework. finit element analysi design, 42:602612, 2006. [14] a. karamnejad, v. p. nguyen, l. j. sluys. multi-scal rate depend crack model quasi-brittl heterogen materials. engineer- ing fractur mechanics, 104:96 113, 2013. [15] v. kouznetsova, w. a. m. brekelmans, f. p. t. baaijens. approach micro-macro model heterogen materials. computa- tional mechanics, 27(1):3748, 2001. [16] v. kouznetsova, m. g. d. geers, w. a. m. brekelmans. multi-scal constitut model heterogen materi gradient- enhanc comput homogen scheme. intern journal numer method engineering, 54(8):12351260, 2002. [17] dimitri krattig mahmoud hussein. bloch mode synthesis: ultrafast methodolog elast band-structur calculations. physic review e, 90:063306, 2014. [18] a. krushynska, m. miniaci, v. g. kouznetsova, m g. d. geers. multilay inclus local reson metamaterials: two- dimension versu three-dimension modeling. journal vibrat acoustics, 139(2):024501, 2017. [19] o. lloberas-valls, d. j. rixen, a. simone, l. j. sluys. multiscal domain decomposit analysi quasi-brittl heterogen materials. intern journal numer method engineering, 89(11):13371366, 2012. [20] s. mesarov j. padbidri. minim kinemat boundari condit simul disord microstructures. philosoph magazine, 85(1):65, 2005. [21] c. mieh a. koch. comput micro-to-macro transit discret microstructur undergo small strains. archiv appli mechanics, 72(4):300317, 2002. [22] v. p. nguyen, o. lloberas-valls, m. stroeven, l. j. sluys. homogenization-bas multiscal crack modelling: micro-diffus damag macro cracks. method appli mechan engineering, 200(9-12):12201236, 2010. [23] v. p. nguyen, o. lloberas-valls, m. stroeven, l. j. sluys. exist repres volum soften quasi-brittl materials- failur zone averag scheme. method appli mechan engineering, 199(45-48):30283038, 2010. [24] j. oliv c. agelet. continuum mechan engineers. theori problems. edicion upc, barcelona, 2017. doi: 10.13140/rg.2. 2.25821.20961. 35 [25] j. oliver, m. caicedo, e. roubin, a. e. huespe, j. a. hernandez. continuum approach comput multiscal model propag fracture. method appli mechan engineering, 294:384 427, 2015. [26] i. ozdemir, w. a. m. brekelmans, m. g. d. geers. comput homogen heat conduct heterogen solids. inter- nation journal numer method engineering, 73(2):185204, 2008. [27] k. pham, v.g. kouznetsova, m.g.d. geers. transient comput homogen heterogen materi dynam exci- tation. journal mechan physic solids, 61(11):2125 2146, 2013. [28] o. sigmund j. s. jensen. systemat design phonon bandgap materi structur topolog optimization. philosoph transact royal societi london a: mathematical, physic engin sciences, 361(1806):10011019, 2003. [29] a. sridhar, v. g. kouznetsova, m. g. d. geers. homogen local reson acoust metamateri emerg enrich continuum. comput mechanics, 57(3):423435, 2016. [30] c. v. verhoosel, j. j. c. remmers, m. a. gutierrez. partit unity-bas multiscal approach model fractur piezoelectr ceramics. intern journal numer method engineering, 82(8):966994, 2010. 36 highlight variat homogen framework account inerti effects. resolut lagrang function analyt identif lagrang multipliers. applic comput model local reson metamaterials. specif coupl analysi acoust problems: linear decomposit solution. model order reduct base project domin microscal natur modes.