2015_prl_pfe_ang.dvi gestur learn execut humanoid robot dynam movement primit sammi pfeiffera, cecilio angulob, apal robotics. pujad 77-79, 08005 barcelona, spain bgrec research group, universitat politecnica catalunya. pau gargallo 5, 08028 barcelona, spain. abstract learn execut gestur humanoid robot develop implement work. gestur repres us dynam movement primit robot platform reem. ag- nostic knowledg consid design trajectories, approach easili extend robots. implement work involv record gestur differ procedures, robot, help user, extern devices. next, dynam movement primit repres motion gener trajectori final execut real humanoid robot. experi provid illustr knowledg acquir robot, repres form dynam systems, gener reproduc differ start conditions. keywords: dynam movement primitives, humanoid robot, knowledg acquisition, gestur represent 1. introduct gestur design kei point human robot commu- nication, far motion gestur import non- verbal signal human commun (hostett et al., 2007; radford, 2009). fact, robot gestur difficult task easier, reduc perceiv workload increas task perform (salem et al., 2011; lohs et al., 2014). however, knowledg acquisition, like new design gestur robot high number degre freedom, current tire chal- leng task mobil robot (breazeal et al., 2005; calinon billard, 2007). besides, new repres movement static sens fix initi designed, i.e. start end pose robot, follow trajectori (tenorth beetz, 2009). lim- correspond author email address: (cecilio angulo) it mechan behaviour barrier robot try physic express social mean gestures, discov new knowledg fron (trafton et al., 2013; moshkina et al., 2014; puigbo et al., 2015). us learn demonstr techniqu (argal et al., 2009) dynam movement primit (schaal, 2006; ijspeert et al., 2013), motion repre- sent like dynam system gener- aliz modifi initi valu tune parame- ter accord environment chang (ruckert davella, 2013). hence, instance, execut differ initi final pose similar, same, trajectori eas task make robot social. therefore, work approach cogni- tion dynam system perspective. unlik comput approach cognition, share idea cognit system special kind (puigbo et al., 2015), dynam approach exploit idea cognit system special kind dynam system. approach merg hierar- chical structure, comput approach link preprint submit pattern recognit letter juli 20, 2015 state dynam approach exeut dy- namic movement primitives. robot high number degre freedom refer on like reem, humanoid servic robot, reem-c, bipe robot, pal robotics, technolog- ical compani work research develop robots. develop bipe humanoid robots, reem-a (2004), reem-b (2006) reem-c (2013), prototyp mo- bile base, reem-h01 (2010), reem-h02 (2012) current version reem, work (see figur 1). work, latest reem prototyp (re- leas 2012), employed. full-siz hu- manoid servic robot act receptionist, enter- tain compliment guests, provid dynam inform present speech care centers, ho- tels, museums, shop mall airports. list characterist includes: weight 100 height 1.70 m, batteri autonomi 8 hours, 34 degre freedom 26 sensors. figur 1: pal robot robot evolut reem robot study. rest paper organ follows: first, introduc dynam movement primit short. then, softwar resourc impli develop listed, total procedur implement explain section. experiment result differ form knowledg acquisit describ section. finally, conclus research line offered. 2. dynam movement primit dynam movement primit (dmps) method trajectori control / plan deriv stefan schaal lab. present wai 2006 (schaal, 2006), updat 2013 auk ijspeert (ijspeert et al., 2013). detail illustr explan dynam movement primit (de- wolf, 2014). start trajectori defin dmp point attrac- tor dynam equation: y = y(y(g y) y) (1) y state, g goal, gain terms. kind seen propor- tional + deriv control signal govern target. forc term added, allow modifi trajectory: y = y(y(g y) y) + f (2) defin nonlinear function f desir behaviour non-trivi question. order gener trajectori time- independent, new system, call canon dynam system, introduced, have simpl dynamics: x = xx (3) canon start arbitrari value, instanc x0 = 1, goe 0 time goe infinity. hence, forc function f defin ba- si function i, defin canon x: f (x, g) = n i=1 iwi n i=1 x(g y0) (4) y0 initi posit wi weight given basi function i. usually, basi defin like gaussian function center ci, hi variance, = exp ( hi (x ci) 2 ) (5) forc function set gaussian funtion activ canon x converg target. weight summat normalized, multipli x(g y0) term, dimin- ish spatial scale term. incorpor x term forc function guar- ante contribut forc term goe zero time, canon does. moreover, 2 spatial scale mean set follow desir trajectori specif goal like abl goal farther awai closer scale version trajectory. finally, gener term tempor scale sought: abl follow trajectori differ speeds. term ad dy- namics, , like tempor scale term, give tempor flexibility, y = 2(y(y(g y) y) + f ) x = (xx) (6) slow set 0 1, speed set greater 1. now, forc term f make path converg target point, tempo- ral spatial scalability. order set follow specifi path, affect accelera- tion forc term. so, desir trajec- tori (in fact vector desir point trajectory) yd = {yd(t0), . . . , yd(tn)}, forc term need gen- erat trajectori calcul as, fd = yd y(y(g y) y) (7) forc term compris weight sum- mation basi function activ time (4), optim techniqu like local weight regress (lwr) select calcul weight wi forc function match desir tra- jectori fd. object function minim t i(t)(fd(t) wi(x(t)(g y0))) 2 (8) solut wi = stifd sti (9) s = xt0 (g y0) . . . xtn (g y0) , = i(t0) . . . 0 0 . . . 0 0 . . . i(tn) (10) figur 2: rviz visual reem robot. differ data sensor shown. 3. softwar resourc section mainli devot explain integra- tion effort softwar exist tools. shortli introduc aim understand imple- ment work. robot oper (ros) (foundation, 2014) framework set softwar librari tool build robot applications. driver state-of-the-art algorithms, power develop tool visual creat applications. 3.1. data acquisit simul softwar packag emploi following, rosbag. set tool record play- ing ro topic high perform wai (thomas, 2014). yaml. yaml aint markup languag (evans, 2014) human-read data serial format. rviz. 3d visual displai sensor data state inform ro (hershberg et al., 2014) (see figur 2). reem robot software. reem run ros. coupl implement packag (robotics, 2014) import work are: urdf implementa- tion robot descript plai motion packag store previous known movement wai point fashion allow user ask reproduc movements. 3 3.2. dmp gener scott niekum dmps. packag call dmp (niekum, 2014) develop scott niekum pro- vide gener implement dynam movement primit (dmps) (konidari et al., 2013). packag expos services: learn dmp demo: given demonstr tra- jectori dmp parameters, return learn multi- dimension dmp. set activ dmp: set activ multi-dimension dmp planning. dmp plan: creat partial plan start state goal state, current activ dmp. 3.3. movement moveit! framework (coleman et al., 2014) extens used, part outlin next. collis detection. collis check perform tak- ing account robot statu (pan et al., 2012). make us librari flexibl collis librari (pan, 2014) willow garage. kinematics. forward kinemat jacobian in- tegrated. default invers kinemat plug-in moveit! configur numer jacobian-bas solver. control manager. manag take care avail control split trajectori synchro- nize them. joint trajectori controller. develop moveit! moveit! take grant joint trajec- tori control (tsouroukdissian, 2014) work underly- ing control manager. 4. implement differ part work explain section. gener overview complet cycl learn gesture, learnt differ sources, creat trajectori safe ex- ecut seen diagram figur 3. figur 3: diagram process learn execut gesture. 4.1. record motion main input sourc emploi perform learn demonstration. learn previous known gestures. gestur cre- at hand (i.e.: specifi joint configur joint joint manual test slowly) plai recorded. approach impli autom wai ex- ecut record gestures. learn robot demonstration. creat in- terfac lower max current joint effect abl hand, motion taught di- rectli move robot. servic base interfac request actual current valu (in percentag maximum possibl mo- tor) set desir valu (see figur 4). learn extern devices. accept end effec- tor pose (a 6d repres posit orientation) learn devic like razer hydra leap motion motion trained. devic track user move- ment tool, like paddle, directli human like hand report posit world. learn- 4 figur 4: captur web interfac chang current limit motors. ing robot tfs1 implement (to learn plai motion). 4.2. gener dmp servic provid scott niekum learn sourc input explain pre- viou subsection. 4.2.1. improv record data record posit joint robot con- sist subscrib sourc inform (call ro topic) state joint publish constantli rate 50 hz. real life informa- tion noisi cases. nois 1the robot tf tree represent robot part current posit space. enabl learning, example, trajectori tip hand. make data useless learn from. filter meth- od evalu (mainli low-pass filters) and, eas implement good results, strategi con- sist down-sampl signal later appli cubic spline down-sampl point cho- sen. exampl trajectori arm right 6 joint arm right 7 joint present jerki plot- ted figur 5(a). veloc record execu- tion figur 5(b), confirm con- tinuou jump direct rotat joints. deploi 85%2 down-sampl signal connect trajectori point cubic spline, observ improv result figur 6. 2thi ideal valu test differ valu trade similar train gestur smooth result trajectory. 5 (a) origin captur trajectori positions. (b) origin captur trajectori velocities. figur 5: origin captur trajectori show evid jerkiness. trajectori current smoother, make abl gener trajectori dont robot shake. 4.2.2. paramet tune paramet tune us case learn demonstr ask new plan learnt. dmp parameters. work plai valu paramet dynam equat (1), left documentation. tune number basi functions, empir valu equival 20 base second durat record gestur gave best re- sults. evalu valu plan initi final condit coincid record on orig- inal trajectori generated. similar record trajectori gener analyzed. strategi evalu consist quantiz movement trajectori minim number basi functions. strategi train faster lead occasion sudden movements, danger robot mechan- ical parts. trajectori parameters. set parameters, need fine tune time resolut plan seconds. robot control behav better short step trajectori valu 0.02 second chosen. lower valu slow need comput dont add smooth perceiv execut robot. 4.3. check trajectori gener compar record data gener data initi final points, posit veloc plot check system. posit graphs. firstly, observ jerk- iness exist improv record demonstr tra- jectori movement slow short (figur 7(a)). next, learn demonstr gen- erat plan initi point final point learnt demonstr (figur 7(b)). finally, execut trajectori shown fig- ur 7(c). trajectori ident previou ones. littl differ plot depend- ing exact time start end trajecto- ries, down-sampl trajectori lesser point main focu appreci natur movement same. scale vari mini- mally. veloc graphs. similar system check per- form velocities. initially, trajectori figur 8(a) recorded. dont down-sampl veloc dmp server learn posit time information. figur 8(b) show veloc gener plan dmp server. notic smoother orig- inal ones. finally, veloc result execut plan depict figur 8(c). note bit jerki origin ones. 6 figur 6: final trajectori demonstr down-sampl cubic splines. 4.4. check collis data manipul perform abl send plan joint controllers. dmp plan includ positions, veloc time robot agnostic, sens account particular ge- ometri robot. hence, mandatori check provid trajectori safe. servic explain section 3.3 trajec- tori point check avoid robot collis environment. point fails, execut started. collis check process computation ex- pensiv operation. real test collis check gener trajectori took roughli 1/3 expect durat execut trajectory. in- stance, long trajectori call crowd salut du- ration 14 seconds. comput collis took approxim 4 seconds. trajectori compos 600 points. collis check take averag 0.007 seconds. larg delai ask reproduc ges- ture desir research complet try- ing allevi issue. down-sampl trajectori check collis point consid calcul worst case movement discard approach: trajectori point gener 0.02 second differ joint usual limit 1 meter second velocity, motor arm move time impli movement 0.14 meter end effector consid risky. 5. result experi implement illustr results. result work abil robot (like voic recogni- tion text speech) perform experi appeal vision work integrated. 5.1. learn plai motion demo robot perform pre-record move- ment creat hand make typic wav- ing motion. movement record fed dmp server learn it. next, plan start pose end pose request final executed. video public (pfeiffer, 2014c), part movement displai im- ag (see figur 9). demo differ time dur- ing execut learnt gesture. execut bit faster origin record step 7 stop record moment robot report fin- ish motion, happen shortli ac- tualli finish execut it. hence, experi fail movement ident plai video time hand let chang time motion preserv motion nature. 5.2. learn demonstr video public (pfeiffer, 2014a) experiment. part movement seen imag (see figur 10). experi robot start ask user joint group want use, option right arm, right hand, left arm, left hand combin them. user choos sentenc similar want us right arm. robot ask confirm lower current desir joint group, case right arm, user abl freely. next, user set initi posit ges- ture order robot start record motion. reem repli confirm understood order start recording. user perform motion. he/sh want stop record joint states, he/sh sai wait here. learn process starts. motion learnt, take time propor- tional number joint involv learn long motion was, reem inform user arm posit he/sh want start learnt gesture. user set pose andlet reem know com- pute gestur current posit (see figur 11). reem normal level maximum cur- rent joints, check gener trajectori safe final execut motion (see figur 12). motion finished, reem ask user set initi posit gener new gesture, enter loop user want stop it. user set initi pose provok trajectori gener dmp collis point, trajectori dont execut user informed. 5.3. learn end effector video public (pfeiffer, 2014b), part movement depicted. experi execut simul safeti reasons. demo, user design trajec- tori 6d world (i.e. posit orient end effector) extern device, case razer hydra controller. input mechan gener any- thing 6d pose input. demo test leap motion con- troller robot hand tip execut previous known gestur refer pose. trajectori recorded, dmp cartesian space learnt. now, ask invers kinemat (ik) necessari point trajectory, give previou robot state initi posit try ensur continu movement possible. shown trajectori simple, usual works, movement in- volv big area configur chang larg shake trajectory. trajectori joint space (ev- eri end effector cartesian pose translat joint configur joint group) skip safeti check step demo ik call ensur collis given con- figuration. 6. conclus learn execut gestur hu- manoid robot develop implemented. involv integr layer softwar low level high level cognit concepts. gestur repres us dynam movement primit robot platform reem. demonstr us dmp handi wai learn motion complex robot integr experi easy-to-us software. reem robot current abl learn gestur compos task learn differ step them. futur work, issu expanded: tra- jectori check faster; trajectori smoothli re-plan execution; train 8 figur 12: reem perform taught gesture. gestur extern devic safer faster. acknowledg thank pal robot let work project robot reem headquart great peopl interest work. research support patricia research project (tin2012-38416-c03-01), fund spanish ministri economi competitiveness. refer argall, b.d., chernova, s., veloso, m., browning, b., 2009. survei robot learn demonstration. robot autonom system 57, 469483. breazeal, c., kidd, c., thomaz, a., hoffman, g., berlin, m., 2005. effect nonverb commun ef- ficienc robust human-robot teamwork, in: intellig robot systems, 2005. (iro 2005). 2005 ieee/rsj intern confer on, pp. 708 713. doi:10.1109/iros.2005.1545011. calinon, s., billard, a., 2007. increment learn gestur imit humanoid robot, in: pro- 9 ceed acm/iee intern confer human-robot interact (hri), pp. 255262. coleman, d., sucan, i.a., chitta, s., correll, n., 2014. reduc barrier entri complex robot soft- ware: moveit! case study. comput research repositori abs/1404.3785. url: org/abs/1404.3785. dewolf, t., 2014. dynam movement prim- itiv 1: basics. url: //studywolf.wordpress.com/2013/11/16/ dynamic-movement-primitives-part-1-the-basics/. evans, c.c., 2014. yaml offici website. url: //www.yaml.org/. foundation, o.s.r., 2014. ro offici website. url: hershberger, d., gossow, d., faust, j., 2014. rviz ro wiki. url: hostetter, a.b., alibali, m.w., kita, s., 2007. hand eye: represent gestur reflect con- ceptual demands. languag cognit process 22, 313336. url: 01690960600632812, ijspeert, a.j., nakanishi, j., hoffmann, h., pastor, p., schaal, s., 2013. dynam movement primitives: learn attractor model motor behaviors. neu- ral comput 25, 328373. konidaris, g., kuindersma, s., niekum, s., grupen, r., barto, a., 2013. robot learning: recent exam- ples, in: proceed sixteenth yale workshop adapt learn systems, center system science, depart electr engineering, yale university. pp. 7176. lohse, m., rothuis, r., gallego perez, j., karreman, d.e., evers, v., 2014. robot gestur difficult task easier: impact gestur perceiv work- load task performance, in: chi 14 : proceed sigchi confer human factor com- pute systems, acm, new york, ny, usa. pp. 1459 1466. moshkina, l., trickett, s.b., trafton, j.g., 2014. so- cial engag public places: tale robot, acm, bielefeld, germany. pp. 382389. doi:10. 1145/2559636.2559678. niekum, s., 2014. dmp ro wiki. url: ros.org/dmp. pan, j., 2014. fcl offici github. url: github.com/flexible-collision-library/fcl. pan, j., zhang, l., manocha, d., 2012. collision-fre smooth trajectori comput clutter envi- ronments. intern journal robot research 31, 11551175. pfeiffer, s., 2014a. learn demonstr dmps. url: pfeiffer, s., 2014b. learn extern control dmps. url: pfeiffer, s., 2014c. learn previous known gestur dmps. url: gyrg4d-g4. puigbo, j., pumarola, a., angulo, c., tellez, r.a., 2015. cognit architectur gener purpos servic robot control. connect. sci. 27, 105117. url: 09540091.2014.968093, doi:10.1080/09540091. 2014.968093. radford, l., 2009. gestur matter? sen- suou cognit palpabl mathemat- ical meanings. educ studi mathe- matic 70, 111126. url: org/10.1007/s10649-008-9127-3, doi:10.1007/ s10649-008-9127-3. robotics, p.a.l., 2014. reem ro wiki. url: //wiki.ros.org/robots/reem. ruckert, e., davella, a., 2013. learn parametr dy- namic movement primit share synergi control robot musculoskelet systems. fron- tier comput neurosci 7, 138. doi:10. 3389/fncom.2013.00138. 10 salem, m., rohlfing, k., kopp, s., joublin, f., 2011. friendli gesture: investig effect multi- modal robot behavior human-robot interaction, in: ro-man, 2011 ieee, pp. 247252. doi:10.1109/ roman.2011.6005285. schaal, s., 2006. dynam movement primit - framework motor control human humanoid robotics, in: kimura, h., tsuchiya, k., ishiguro, a., witte, h. (eds.), adapt motion anim ma- chines. doi:10.1007/4-431-31381-8_23. tenorth, m., beetz, m., 2009. knowrob knowledg process autonom person robots, in: intelli- gent robot systems, 2009. iro 2009. ieee/rsj intern confer on, pp. 42614266. doi:10. 1109/iros.2009.5354602. thomas, d., 2014. rosbag ro wiki. url: wiki.ros.org/rosbag. trafton, j.g., hiatt, l.m., harrison, a.m., tamborello, f., khemlani, s.s., schultz, a.c., 2013. act-r/e: embodi cognit architectur human robot inter- action. journal human-robot interact 2, 3055. doi:10.5898/jhri.2.1.trafton. tsouroukdissian, a.r., 2014. joint trajectori control ro wiki. url: trajectory_controller. (a) down-sampl cubic spline trajectori position. (b) gener dmp server trajectori position. (c) execut trajectori gener dmp server trajec- tory, position. figur 7: check system. improv demonstration, gener execut trajectori position. 11 (a) origin captur trajectori velocity. (b) gener dmp server trajectori velocity. (c) execut trajectori gener dmp server trajec- tory, velocity. figur 8: check system. improv demonstration, gener execut trajectori velocity. figur 9: reem perform origin wave motion gener dmps. figur 10: user teach gestur move robot arm. figur 11: user set differ initi posit execut gesture. 12