regular order comput homogen multiscal analysi masonri structur nonam manuscript no. (will insert editor) regular order comput homogen multiscal analysi masonri structur massimo petracca luca pel riccardo rossi sergio oller guido camata enrico spacon received: date / accepted: date abstract paper investig possibl us- ing classic order comput homogen simpl regular procedur base fractur energi micro-scale-constituents. gener geometr characterist length take account size macro-scal element size rve (and constituents). propos regular ensur object dissip energi macro-scale, respect size fe scale respect size rve. propos method valid bench- mark examples, final appli numer simul experiment test in-plan load shear wall period masonry. massimo petracca () cimn - centr internacion metod numer en enginyeria, technic univers catalonia (upc), barcelona 08034, spain depart engineering, univers "g.dannunzio" chieti pescara, pescara 65127, itali e-mail: e-mail: luca pel riccardo rossi sergio oller cimn - centr internacion metod numer en enginyeria, technic univers catalonia (upc), barcelona 08034, spain e-mail: e-mail: e-mail: guido camata enrico spacon depart engineering, univers "g.dannunzio" chieti pescara, pescara 65127, itali e-mail: e-mail: keyword comput multiscal homogeniza- tion period microstructur strain local characterist length fractur energi regulariza- tion masonri shear wall 1 introduct formul phenomenolog closed-form con- stitut law analysi heterogen quasi- brittl materi masonri challeng- ing task [45, 46]. evolut macroscop prop- erti highli influenc complex behavior micro-structur phenomena damaged-induc anisotropy, stress redistribut micro-structur constitu strain localization. context, difficult account influenc evolv- ing micro-structur macroscop properties, es- pecial strain local occur micro- structur lead complex dissip mechan structur level. main approach model kind heterogen materials. approach direct numer simul (dns) classic 1-scale fe model used, inform micro-structur explic- itli modeled. method provid best accuraci take account micro-structur influenc structur behavior. interfac model mul- tisurfac plastic propos [26] in-plan behavior masonry. kind mod- eling, brick mortar joint explicitli mod- eled, nonlinear behavior lump in- terfac elements. approach effici small-scal structur (i.e. structur member test laboratory). deal large-scal analysi 2 massimo petracca et al. comput cost unaffordable, effort requir prepar geometr model. second approach known concurr multi- scale method (cmm). multiscal model, in- volv studi multipl length scale exchang inform them. partic- ular approach micro-structur scale adapt insert resolv structur model, es- tablish strong coupl macro micro scales. work subject [24, 25], others. approach known comput ho- mogen method (chm). similar cmm, base multiscal modeling, informa- tion obtain multipl length scales. assum- ing length scale separated, approach establish weak coupl them. micro- structur featur physic insert structur model, case cmm, model call repres volum element (rve) associ integr point macroscop mesh. rve, consid rep- resent sampl micro-structure, obtain homogen respons macroscop strain field, emul equival homogen medium. flexibl (no assumpt homogen constitut response) model model larg class materi character complex micro-structures, linear nonlinear behavior [9, 41, 43, 44, 47, 54, 55]. classic order chm success- fulli model micro-structur exhibit stabl behaviors, recogn non-object result deal strain-soften materials. fact rve loos repres strain localization. years, modif classic chm proposed, review recent develop [35] refer therein. approach regular re- spons rve higher order theori macro-scale, inform mate- rial characterist length natur taken account [3, 16, 17, 18, 22, 23, 52]. others, known continuous- discontinu approaches, up-scal rve respons traction-separ law (upon strain localization) discontinu insert macro-scal model [6, 8, 30, 31, 32, 33, 37, 39]. issu re- late loss repres rve choic proper boundari condit appli rve. studi topic [13], novel boundari condit proposed, concept rotat period avoid cos- train crack propag orientation. context masonri modeling, work continuous- discontinu comput homogen [30, 35] model in-plan behavior ma- sonri structures, later extend studi shell element analysi out-of-plan be- havior [32, 33], work comput homoge- nizat cosserat continuum macro-scal [16, 17]. previou approach base order homogeniza- tion fractur energi regular consid characterist length microstructur con- stitut model equal characterist length macro-scal finit element [4]. [16] compar classic order homogeniza- tion cosserat-bas homogenization. pa- propos extens fractur energy-bas regular two-scal comput homogeniza- tion base classic order continuum theory. main aim allow usag order computa- tional homogen analysi quasi-brittl micro-structures. main novelti propos ap- proach resid consist definit frac- ture energi base regularization, order account characterist length finit element scales, size rve. paper organ follows: section 2 present main concept classic comput homog- enization, refer particular class micro-structures, sake simplicity, as- sume small strain theory. section 3, issu in- troduc strain-soften materi described, propos regular procedur derived. section 4, benchmark test assess propos regular respect simpl mode fractur test. final section 5, attent given model masonri structures, complic test in-plan load shear walls. 2 classic order comput homogen section give brief summari main con- cept basic equat classic order com- putat homogenization, standard or- der continuum theori assum scales. present work assum infinitesim strain theory. main work-flow classic chm rep- resent figur 1. regular order comput homogen multiscal analysi masonri structur 3 fig. 1: work-flow classic comput homoge- nizat procedur defin main steps: 1. down-scal macro-micro transition, macroscop strain point macroscop mesh, transfer micro-scale, appli boundari condit rve mesh; 2. solut micro-scal boundari valu problem (bvp), numer method, fem considered; 3. up-scal ormicro-macro transition, macro- scale stress tensor macro-scal tangent op- erat obtain homogen procedures. 2.1 down-scal macro-micro transit macroscop strain m , point xm macro-scal domain instant t, ob- tain volum averag microscop strain field defin point x micro-scal do- main instant t: m(xm, t) = 1 v (x, t) dv = 1 v su dv = 1 v u s nda (1) n outward unit normal field rve boundari . assum microscop dis- placement field addit split linear (coars scale contribution) fluctuat u (fine scale contribution) u(x, t) = m(xm, t)x + u(x, t) (2) wai microscop strain field split constant (coars scale contribution) fluctuat (fine scale contribution) (x, t) = m(xm, t) + (x, t) (3) insert definit microscop strain field (eq. (3)) definit macroscop strain field (eq. (1)), obtains: m(xm, t) = m(xm, t) + 1 v su dv (4) provid minim kinemat constraint microscop displac fluctuat field sat- isfi kinemat admissible: su dv = u s nda = 0 (5) step macro-micro transit defin boundari condit appli rve dis- placement fluctuat field, order micro-bvp solved. follow work [34], typic sub- set kinemat admiss microscop displace- ment fluctuat briefli summar follow- ing. zero displac fluctuat u(x, t) = 0 x (6) displac fluctuat vanish point rve domain, rve undergo uniform strain equal macro-scal strain field. zero boundari displac fluctuat u(x, t) = 0 x (7) displac fluctuat vanish bound- ari rve. period boundari displac fluctuat u(x + , t) = u(x , t) pair {x + , x } (8) x+ x opposit point rve boundari . model constraint displace- ment fluctuat boundari rve periodic. 4 massimo petracca et al. minim constrain boundari displac fluc- tuation uniform boundari traction (x, t)n(x) = m(xm, t)n(x) x (9) (x, t) microscop stress field. shown [34] , distribut stress rve boundaries, reactiv minim kinemat constraint given eq. (5), satisfi eq. (9) 2.2 solut micro-scal bvp assum inertia forc negligible, prin- cipl virtual work establish rve equilibrium variat equat (x, t) : s dv b(x, t) dv te(x, t) da = 0 v (10) hold instant t. eq. (10), b(x, t) bodi forc field rve domain, te(x, t) extern traction field boundari rve, v appropri space virtual displac rve, subject constraint defin 2.1. kei ingredi definit multiscal consti- tutiv model hill-mandel principl macro- homogen [20, 29], energi averag theorem es- tablish macroscop stress power equal volum averag microscop stress power rve m : m = 1 v : dv (11) kinemat admiss microscop strain rate field , i.e. (follow addit split coars scale fine scale contributions) microscop strain rate field form: = m +s u u v (12) prove [34], hill-mandel principl equiva- lent requir bodi forc surfac traction rve pure reactive, i.e. reaction chosen kinemat constraints, pre- scribe independently. wai rve equilibrium reduc to: (x, t) : s dv = 0 (13) 2.3 up-scal micro-macro transit step homogen procedur consist find homogen macroscop stress tensor (and requir homogen tangent operator) af- ter rve equilibrium found. shown [19, 42], definit homogen stress tensor de- rive directli hill-mandel principl addit split microscop strain, as- sumption model. insert split micro- scopic strain rate given eq. (12), hill-mandel principl eq. (11), follow relat obtained: m : m = 1 v : m dv + 1 v : s u dv u v (14) valid kinemat admiss u, case u = 0, follow relat obtained: m : m = 1 v : m dv m (15) valid macroscop strain rate field, lead- ing to: m = 1 v (x, t) dv (16) homogen macroscop stress tensor obtain volum averag microscop stress field rve. 2.4 interpret comparison multiscal method mention section 1, chm allow straight- forward interpret framework varia- tional multiscal method (vmm). main idea consid continu displac field u decompos coars fine compon u = u+ u (17) u defin coars scale contribut (i.e. describ coars fe mesh) u fine scale contribut (i.e. correspond solv coars fe mesh). correspond test function regular order comput homogen multiscal analysi masonri structur 5 name w w. decomposit strain := su = su+su (18) follow standard multiscal procedur [21], shall point introduc model obtain u. appli galerkin approach level fine scale w (su) dv = wf dv w (su) dv (19) defin fine scale problem even- tualli solv one, case, provid suitabl discret fine scale domain (that is, wai actual comput w). problem complet prescrib suitabl boundari condit u. vmm commun customari assum w (su) dv = 0 rework (by apply- ing green-gauss theorem) w (u n) da = 0 (20) case chm, w consid discontin- uou function defin (local integr point) finit element discret rve. assumption, eq. (19) eq. (20) restrict rve volum finit element problem rve w (su) dv = rve wf dv rve w (su) dv (21) rve w (u n) da = 0 (22) interestingly, eq. (22) coincid call min- imal boundari condit u. observ u = 0 (in rv e) constraint u peri- odic (in rv e) special case compli boundari condition. observ assumpt period u need deriv minim boundari conditions. 3 fracture-energy-bas regular two-scal fe comput homogen essenti aspect numer model mesh ob- jectivity, defin requir result independ adopt discretization. continuum exhibit strain-softening, strain local narrow zone energi dissip accord size, outsid materi unload elastically. hand, fem context, standard local continuum model (i.e. materi respons comput function local strains), local zone relat domain (volum area) finit element. thus, strain soften appears, dissip domain coincid strip element finit ele- ment mesh, dissip total energi proport size finit elements, en- ergi dissip diminish element smaller mesh refinement, lead non-object result depend fe size. solut problem, wide used, propos [5], later address author ([10, 36, 40], others). author point fem framework, concept strain soften consid characterist materi alone, relat frac- ture energi gf size finit element energi dissip occurs. comput width fractur process comput element de- pend geometri dimension. compu- tation width known element characterist length lch. accord model, soften law depend materi fractur energi unit crack surfac area gf element characteris- tic length lch, wai follow relat holds: gf = w = w v lch = gf lch (23) w total energi dissip fractur process, crack surfac area, gf fractur energi unit volume, v volum dissip zone. refer notat given figur 2, eq. (23) rewritten as: gf = w ht = w htlch lch = gf lch (24) two-scal fe analysis, concept characteris- tic length parent element (the element contain- ing constitut law need regularized) 6 massimo petracca et al. (a) strong discontinu (b) regular smear discontinu fig. 2: represent displac strain field mode fracture, regular process obvious, sens non-linear be- havior gener constitut model associ domain micro-scale, dissip fi- nalli occur domain macro-scale. con- sider characterist length fe micro-scale, obtain correct dissip rve, then, chang size rve size fe macro-scale, obtain non-object respons macro-scale. re- quirement mesh-object correct dissip satisfi regular emploi scale analysis. suggest regular paramet constitut model micro-scal adjust account nest featur multiscal homogen procedure. start point assum constitut law micro- scale regular modifi character- istic length lch,, defin function char- acterist length enter problem (see figur 3): lch, = f(lch,, lch,m, lch,rv e) (25) lch,i characterist length fe micro-scale, lch,m characterist length fe macro-scale, lch,rv e characterist length rve itself. characterist length fe (both micro macro scale) comput accord geometry, in- terpol integr scheme consid finit element [49]. fig. 3: fractur energi base regular 2-scale fem obtain definit modifi characterist length, defin energi wrv e,d dissip damag domain rve as: wrv e,d = gf lch, vrv e,d = gf lch, lch, t hrv e (26) vrv e,d damag domain rve, hrv e length rve direct crack, t thick rve. smear dissip energi rve domain, defin- ing equival specif fractur energi gf as: gf = wrv e,d vrv e = wrv e,d lch,rv e hrv e t = gf lch, lch, lch,rv e (27) integr specif fractur energi dis- sipat domain macro-scal total energi wm dissip macro-scale: wm = gf dvm (28) wm = gf lch,m hm tm (29) regular order comput homogen multiscal analysi masonri structur 7 hm tm respect length thick crack macro-scale. substitut eq. (27) eq. (29), equat actual dissip energi seek structur level w = gf hm tm (30) obtain definit modifi characterist length, micro-scale, provid proper dissip macro-scale: wm = gf lch, lch, lch,rv e lch,m hm tm = gf hm tm (31) lch, = lch, lch,m lch,rv e (32) eq. (32) seen characterist length micro-scal multipli scale factor (constant rve) ratio characterist length parent-el macro-scal characterist length rve itself. procedur regard 2-step smear discontinuity: (i) first, discontinu smear local band rve (eq. (26)) , width lch,, length hrv e ; (ii) then, discontinu (now form local band rve) smear local element structural-level (eq. (27), eq. (28), eq. (29)). [4], modifi characterist length micro-scal taken equal characterist length macro-scal fe. context, however, author deal composit dam- ageabl matrix long fibers. long fiber typic orient load direction, allow damag spread wide area. case damag distribut rve domain, lo- caliz happen structur level. contrary, masonri local visi- ble rve, requir consid length scale regular procedure. note however, method propos [4] re- cover eq. (32), set lch, = lch,rv e . [31] local rve homogen discontinu band width equal rve characterist length. approach propos work, correspond lch,m = lch,rv e , leav- ing characterist length microstructur ele- ment unchanged. eq. (26) defin total energi dissip dam- ag rve, assum total length crack equal length rve crack direct (hrv e), assum straight crack. let assum instead rve crack non- straight, total length equal hrv e , = 1 scale factor measur tortuos crack. eq. (26) wrv e,d = gf lch, lch, t hrv e (33) eq. (30), refer total energi dissip real crack simulate, assum straight (a crack rve) length equal length specimen crack direc- tion hm. consid instead non-straight crack, eq. (30) w = gfhm tm (34) eq. (31) wm = gf lch, lch, lch,rv e lch,m hm tm = gf hm tm (35) tortuos factor appear side equation, cancel out, modifi char- acterist length defin eq. (32) remain unchanged. 4 mode fractur test test report section meant assess regular capabl propos method respect simpl mode fractur test. specimen rectangular plate state plane-stress subject uniaxi tensil load. micro-structur assum matrix period pattern circular void (note void emul soft linear elast materi report tabl 1). regulariza- tion respect macro-scal fe size size rve check perform analy- si differ macro-scal discret differ rve sampl sizes, total analyses. analys conduct regular procedur better differences. detail geometry, macro-scal mod- els, rves, given respect [fig- ur 4, figur 5, figur 6], detail me- chanic properti micro-structur constitu given tabl 1. period boundari displac fluctuat emploi multiscal analysis, exampl expect crack align period directions. 8 massimo petracca et al. local continuum damag model constitut behavior matrix rve. main concept model summar here. detail reader refer [10, 12] refer therein. constitut equat defin = (1 d) = (1 d)c : (36) stress tensor obtain function effect stress tensor , comput to- tal strain tensor fourth order isotrop linear elast constitut tensor c, damag index d, rang zero undamag material, complet damag material. order comput damag index, relat current ef- fectiv stress state, necessari introduc scalar measure, term equival stress . exampl assum rankin criterion, equival stress comput follows: = [ + : : + ]1/2 (37) + posit effect stress ten- sor, defin + = 3 i=1 ipi pi (38) pi eigenvector associ prin- cipal stress i, symbol macaulai bracket (x = x, x 0, x = 0, x < 0), non-dimension fourth order tensor defin = p1 p1 p1 p1 (39) damag irrevers process, intro- duce scalar quantity, term damag thresh- old r, repres largest valu reach equival stress load history. damag threshold r time t+t evalu r = max (r0, max (rt, )) (40) rt damag threshold previou (con- verged) time step, r0 initi damag threshold (the defin elast limit) case r0 = ft. accordingly, follow damag criterion introduced: (, r) = rt 0 (41) way, damag index d, time interv [t, t+t], grow > rt. test damag assum evolv accord follow exponenti law: d (r) = 1 r0 r exp { 2hdi ( r0 r r0 )} (42) hdi discret soften parameter. de- scribe section 3, discret problem soften- ing law adjust accord size dissip zone (ldis), wai follow equat holds: gf ldi = gf (43) specif dissip energi gf , expo- nential soften law, calcul as: gf = ( 1 + 1 hdi ) f2t 2e (44) discret soften paramet calcul hdi = ldi lmat ldi (45) lmat = 2egf/f2t . standard 1-scale fe analy- sis, ldi assum equal characterist length fe (ldi = lch). constitut law rve 2-scale fe analysis, ldi equal modifi characterist length lch,, defin eq. (32). analysi perform krato multi- physic [14], free open-sourc framework devel- opment multidisciplinari solvers, develop cimne, pre post-process gid [1], develop cimne. result obtain propos regulariza- tion procedur (figur 7a) wide distinct force-displac curves. expected, respons brittl larger rve and/or finer mesh macro-scale. appli propos regular analys respons (figur 7b), show object respect macro-scal fe size rve size. macro-scal displac field micro-scal maximum princip strain, end analysis, shown figur 8. regular order comput homogen multiscal analysi masonri structur 9 properti valu (materi 1) valu (materi 2) unit young modulu 14000.0 1.0 n/mm2 poisson ratio 0.15 0.15 - type continuum damag model linear elast - tensil maximum stress 2.2 - n/mm2 tensil fractur energi 0.8 - n/mm damag criterion rankin - - soften law exponenti - - tabl 1: materi properti 0 500 1000 1500 2000 2500 0 0.2 0.4 0.6 0.8 1 1.2 1.4 f o rc e (n ) displac (mm) macro 1x1 - rve 1x1 macro 1x1 - rve 3x3 macro 2x2 - rve 1x1 macro 2x2 - rve 3x3 (a) 0 500 1000 1500 2000 2500 0 0.2 0.4 0.6 0.8 1 1.2 1.4 f o rc e (n ) displac (mm) macro 1x1 - rve 1x1 macro 1x1 - rve 3x3 macro 2x2 - rve 1x1 macro 2x2 - rve 3x3 (b) fig. 7: force-displac curves: (a) regularization; (b) regular fig. 8: macro-scal displac field - rve maximum princip strain field (with regularization) 10 massimo petracca et al. fig. 4: geometri model boundari condit (a) (b) fig. 5: macro-scal meshes: (a) macro 1x1 - mesh size=1000;(b) macro 2x2 - mesh size=500 (a) (b) fig. 6: (a)rv 1x1- size=100; (b)rve 3x3 - size=300 5 applic masonri structures. numer model shear wall section, propos method simu- late in-plan behavior masonri structures. shear wall commonli in-plan shear tests. consid experiment result obtain [48] refer assess capabl pro- pose approach. first, brief descript select experiment test given 5.1, adopt rve constitut model micro-structur constitu describ 5.2. proceed multiscal simulation, direct numer simula- tion (dns) perform check capabl constitut model emul main behav- ior masonri wall, result discuss 5.3. final result obtain multiscal simul compar experiment result dn result 5.4. analysi perform krato multi- physic [14, 15], free open-sourc framework develop multidisciplinari solvers, develop cimne, pre post-process gid [1], develop cimne. 5.1 experiment test: tu eindhoven shear wall geometri wall (here denot w1) boundari condit repres figur 9. wall open layer solid brick dimens 210mm 52mm 100mm, 10mm mortar joint [48]. wall subject load stages: (i) first, uniform pres- sure load 0.3n/mm2 appli wall, (ii) horizont load appli dis- placement control confin way, keep wall horizont preclud vertic displace- ments. experiment failur mechan obtain test wall shown figur 10. 5.2 rve micro-scal constitut law wall consid section run bond masonry, show period texture. take advantag period micro-structure, pe- riodic boundari displac fluctuat (see eq. (8)) enforc boundari rve. applications, assumpt period boundari fluc- tuation enforc unphys constraint crack direct [13]. however, specif case masonri crack mainli place follow pe- riodic geometri weak mortar joints. sense, period assumpt spoil actual crack- ing direction, case failur bed/head joint case staircas cracks. mesh brick mortar joint consist structur grid standard displacement-bas 4-node quadrilat- eral plane stress elements, uniform size 10.0mm, shown figur 11. regular order comput homogen multiscal analysi masonri structur 11 (a) (b) fig. 9: wall w1 - tu eindhoven shear wall [48]. ge- ometri load stages: (a) stage 1: uniform vertic load; (b) stage 2: horizont displac vertic confin (a) (b) fig. 10: experiment crack pattern fig. 11: rve mesh. unit mm constitut model micro-structur constitu briefli presented, direct numer simul multiscal comput homogenization. constituents, brick mortar joints, assum isotropic. nonlinear behavior simul mean local continuum damag model improv scalar isotrop damag model de- scribe section 4. account differ behavior materi tension compres- sion, bi-dissip d+/d damag model adopted, follow work [53], stress state comput = ( 1 d+ ) + + ( 1 d ) (46) +and posit neg part effect stress tensor : = c : (47) + = 3 i=1 ipi pi (48) = + (49) d+ d respect tensil compress damag indexes, affect respect posi- tive + neg effect stress ten- sor . scalar measur introduced, term equival stress + , order identifi load- ing, unload reload situat gener state stress. present work chosen dif- ferent damag surfac adopt [53]. specifically, form damag surface, base propos [28], tensil compress states, slight differences, order better captur shear behavior masonri compon (especi mortar joints). 12 massimo petracca et al. equival stress + comput = 1 1 ( i1 + 3j2 + 1 max ) (50) + = 1 1 ( i1 + 3j2 + max ) ft fcp (51) = b 1 2b 1 (52) = fcp ft (1 ) (1 + ) (53) i1 invari stress tensor, j2 second invari stress deviator, max maximum princip stress, b ratio bi-axi uniaxi compress strengths. con- stant 1 eq. (50) introduc better control effect compress surfac shear strength model. constant rang 0 (lead drucker-prag criterion) 1 (lead criterion propos [28]). ft fcp respec- tive tensil compress peak stresses, ft coincid initi non linear uniaxi tension, fcp doesnt coincid initia- tion non linear uniaxi compress fc0, initi hardening. choic motiv fact tension harden considered. final term ft fcp introduc eq. (51) relat + tensil strength ft. damag irrevers process, scalar quantiti introduced, term damag thresh- old r, repres largest valu reach equival stress load his- tory. damag threshold r time t+t evalu r = max ( r0 , max ( rt , )) (54) r+0 = ft (55) r0 = fc0 (56) r+0 r 0 repres initi damag thresh- old respect tension compress (i.e. elast limit uniaxi tension ft compress 15 10 5 0 5 15 10 5 0 5 1 2 + (1 = 0.00) (1 = 0.25) (1 = 0.50) (1 = 1.00) inact tensil surfac x = fc0 x = fcp x = ft x = bfc0 inact compress surfac fig. 12: initi damag surfac (2d plane-stress) fc0). accordingly, follow damag criteria in- troduced: ( , r ) = rt 0 (57) plot superposit damag sur- faces, princip stress space 2d plane-stress case, given figur 12. compress surfac plot differ valu constant 1. surfac defin stress state, neces- sari inact (a point figur 12 dash lines) certain conditions: 1. compress surfac allow evolv princip stress neg 2. tensil surfac allow evolv princip stress posit tensil damag index d+ calcul accord follow equation: d+ ( r+ ) = 1 r+0 r+ exp { 2hdi ( r+0 r + r+0 )} (58) hdi discret soften parameters, calcul explain eq. (45). result tensil uniaxi law given figur 13. evalu compress damag index dan ad hoc formul adopted, order regular order comput homogen multiscal analysi masonri structur 13 fig. 13: tensil uniaxi law fig. 14: compress uniaxi law obtain compress uniaxi law like given figur 14. curv consist of: 1) linear [(0, 0) (0, 0)], 2) harden part[(0, 0) (p, p)], 3-4) soft- en part [(p, p) (k, k)] [(k, k) (u, u)], 5) final constant residu stress [(u, u) (+, u)]. part 2,3 4 quadrat bezier curves. control point defin shape curve, end-positions, tangent curv end-positions. tensil case, discret problem uni- axial curv need regular wai shade area curv gc/ldis, present work ldi equal modifi charac- terist length lch,, defin eq. (32). materi properti brick mortar joints, dn multiscal simulations, sum- mariz tabl 2. valu taken analysi conduct [26, 27]. materi parame- ter govern compress behavior mortar joint adapt obtain correct compress be- havior masonri composit material. fact simul plane stress behavior adopted, captur typic increas compres- sive capac mortar joints, confin effect surround bricks. possibl cope issu gener plane state model [2]. properti brick mortar joint unit e 16700.0 800.0 n/mm2 0.15 0.15 - t 2.0 0.25 n/mm2 gt 0.08 0.016 n/mm 0 3.0 2.0 n/mm2 p 11.5 8.5 n/mm2 r 2.0 2.0 n/mm2 gc 1.0 80.0 n/mm p 0.003 0.04 - kb 1.2 1.6 - k1 0.0 0.16 - tabl 2: materi properti brick mortar joint 5.3 direct numer simul section, result obtain dn discuss compar experiment results. allow assess capabl constitu- tive model describ 5.2 repres in-plan behavior shear-walls. discret consist structur mesh standard displacement-bas 4-node quadrilater plane stress elements. size dis- cretiz 10mm. nonlinear static analysi conduct stages: 1. stage, uniform pressur 0.3n/mm2 appli wall, load control; 2. second stage, horizont nodal load ap- pli top-right corner wall, dis- placement control. second stage, vertic displac wall, kept fix valu reach previou step. figur 15 show structur respons term hor- izont displac total horizont reac- tion. result obtain dn good agreement experiment results, term obtain failur mechanisms, seen tabl 3 tabl 4. 14 massimo petracca et al. 0 10 20 30 40 50 60 0 0.5 1 1.5 2 2.5 3 h o ri zo n ta l ac ti o n ( k n ) horizont displac (mm) experiment numer (meso-model) fig. 15: load-displac curv context, interest highlight main featur character behavior kind ex- periment (for detail descript [27]). end, signific snapshot analysi extracted. snapshot identifi horizon- tal displac ux = [0.5, 1.1, 1.8, 2.5, 3.0]mm. obtain result seen tabl 3 tabl 4, term displacement, maximum princip strain, minimum princip stress, tensil damag compres- sive damage. non-linear appear horizont dis- placement ux = 0.5mm, horizont tensil crack develop bottom-right top-left part wall. stage, compress stress form sev- eral parallel strut orient direct given central point bricks. horizontal-top- displac ux = 1.1mm, staircas diagon crack appear center wall, proceed support mortar joints. stage cracks, fulli open uniqu crack, presenc brick be- low tensil peak stress. format diagon crack produc visibl chang slope load-displac curve. stage be- tween horizontal-top-displac ux = 1.8mm ux = 2.5mm character previous men- tion crack join form uniqu diagon crack fulli reach supports. join crack tensil failur bricks. stage, visibl chang compress stresses, rotat form separ struts. open diagon crack lead develop- ment shear mechan ultim displace- ment ux = 3.0mm. 5.4 multiscal simul order assess propos method, multiscal homogen analysi perform differ meshes, denot mesh 7x7, mesh 8x8, mesh 9x9, mesh 15x15, shown figur 16. macro-scal model consist structur mesh 4- node quadrilater plane-stress finit elements. or- der improv perform coars discretizations, enhanc assum strain (eas) quadrilater element propos [51] used. (a) mesh 7x7 (b) mesh 8x8 (c) mesh 9x9 (d) mesh 15x15 fig. 16: adopt mesh macro-scal result obtain analys good agreement dn predictions. figur 17 show obtain load-displac curv close follow curv dns. furthermor seen mesh refin rel error curv diminishes, show object re- spons thank regular procedur propos research. coarsest mesh (7x7) show pre- matur failur compress corner probabl sudden loss bear capac ele- ment involv nonlinear process. however, al- readi 8x8 mesh show better agreement 0 10 20 30 40 50 60 0 0.5 1 1.5 2 2.5 3 h o ri zo n ta l ac ti o n ( k n ) horizont displac (mm) experiment numer (meso-model) homogen (mesh 7x7) homogen (mesh 8x8) homogen (mesh 9x9) homogen (mesh 15x15) fig. 17: load-displac curv regular order comput homogen multiscal analysi masonri structur 15 displac ux (mm) max min (n/mm2) 0.5mm 1.1mm 1.8mm 2.5mm 3.0mm tabl 3: dns. increment contour plot (ux) horizont displacement, (max) maximum princip strain, (min) minimum princip stress 16 massimo petracca et al. displac d+ d 0.5mm 1.1mm 1.8mm 2.5mm 3.0mm tabl 4: dns. increment contour plot (d+) tensil damage, (d) compress damag regular order comput homogen multiscal analysi masonri structur 17 final stage, final 9x9 15x15 mesh start show smoother transit compress failure. 15x15 mesh practic point view best choic analyz problem, fe size macro-level smaller rve size. however, 15x15 case intention ad- dress mesh insensit propos regular method. case coarser mesh actual look appropriate, fe size macro-level larger rve size. cases, main failur mechanisms, displac forc capac correctli repres despit mesh coarseness. tabl 6 show obtain result term displace- ment, maximum princip strain minimum princi- pal stress. particular, seen shape crack (in term maximum princip strains) redistribut compress stress close resembl obtain dns. tabl 5 show final state (in term maximum princip strain, tensil compress damage) signific rves. rve (rve 1) show prevail mode failure, tensil damag concentr bed joints. sourc non-linear appear test, vertic confin low. second rve (rve 2) show typic staircas failur shear low confin pressure. rve taken center wall, main diagon crack starts. final rve (rve 3) taken bottom-left corner wall, main diagon crack ultim trigger collaps wall. failur happen later stage test, fact vertic displac wall constrained, area subject sig- nific concentr compress stresses. rve successfulli show staircas damag pattern, fol- low failur brick vertic splitting. smear crack approach adopt research, proper fractur energi regularization, provid numer result remark agreement experiment crack pattern masonri shear walls. however, note gener propos regular solv (and attempt to) well-known problem mesh-bia depend fe solution, is, prefer direct exist model depend orient mesh. issu address carefulli choos finit element model emploi coars mesh, demonstr recent work [7, 10, 11, 12, 38]. particular element formul emploi current work (ea [51]) make reason- abli insensit mesh bias. 5.5 comput cost import aspect kind simul comput cost. studi scope paper, section give brief com- parison dn multiscal simula- tions. note specimen describ 5.1 small (1m 1m) per- fect candid multiscal simulation. analyz comparison experimen- tal results. exploit advantag propos multiscal model, second dn conduct larger model (3m 3m) scale version origin one. case multiscal simul carri out, macro-scal dis- cretiz (7 x 7 mesh) prove suffici obtain good result analysi (see figur 18a figur 18b). tabl 7a tabl 7b computa- tional cost dn multiscal simul term memori usag (real) time. rve max d+ d rve 1 rve 2 rve 3 tabl 5: final state signific rve 18 massimo petracca et al. displac ux max min 0.5mm 1.1mm 1.8mm 2.5mm 3.0mm tabl 6: chm. increment contour plot (ux) horizont displacement, (max) maximum princip strain, (min) minimum princip stress regular order comput homogen multiscal analysi masonri structur 19 0 10 20 30 40 50 60 0 0.5 1 1.5 2 2.5 3 h o ri zo n ta l ac ti o n ( k n ) horizont displac (mm) numer (meso-model) homogen (mesh 7x7) (a) 0 20 40 60 80 100 120 140 0 0.5 1 1.5 2 2.5 3 3.5 4 h o ri zo n ta l ac ti o n ( k n ) horizont displac (mm) numer (meso-model) homogen (mesh 7x7) (b) fig. 18: load-displac curv origin (a) scale model (b) dn model number node number element averag time iter memori 1m 1m 11152 10934 1.51 sec. 120mb 3m 3m 77064 76502 9.72 sec. 730mb (a) number node number element number rve number node (rve) number element (rve) averag time it- erat memori 64 49 196 322 356 4.97 sec. 275mb (b) tabl 7: comput cost direct numer simul (a) multiscal simul 7x7 mesh (b) object comparison, measur time refer entir simulation, averag durat singl global iter (i.e. total durat load step, divid number equilibrium iterations). furthermor time measur spe- cific load step entir model nonlinear range. observed, multiscal simul prove effici respect dn deal larg structur (or altern micro- structur small compar specimen). dn penal larg model increas time memori requirements, mainli re- quir storag solut larg linear sys- tem equations. contrary, multiscal simu- lation penal small models, overhead homogen process dominates. comput singl ma- chine intel core i7-2670qm-2.20ghz cpu 8.00 gb ram. code parallel openmp. 6 conclus classic order comput homogen establish framework captur effect complex micro-structur structur level. recogn suffer spu- riou depend macro-mesh size rve size, strain local take place. paper, author propos simpl regular- izat techniqu allow us classic or- der comput homogen problem involv- ing strain localizations, keep settings, simplicity, unchanged. context smear crack approach (sca), fracture-energy- base regularization, commonli 1-scale fe anal- ysi deal strain-soften materials, ex- 20 massimo petracca et al. tend 2-scale fe analysis. propos regu- lariz procedur ensur object dissipa- tion macro-scale, embed definit micro-scal characterist length (use reg- ular micro-structur constitut laws), size finit element scale size rve itself. achiev mean scal- ing factor constant rve. particular fact exist fe code implement- ing classic comput homogen need margin chang evalu scale fac- tor. propos method valid basic bench- mark test involv analys in- plane load masonri shear walls, show satisfactori results. specifically, applic pro- pose multiscal procedur show remark agree- ment result given dns. anal- ysi masonri shear wall, propos model shown capabl micro-scal repres local tensile, compress shear failur complex interact unit joints. macro-scale, model correctli phe- nomenolog structur response. propos mul- tiscal approach robust object differ mesh discretizations. acknowledg research receiv finan- cial support graduat school univers g. dannunzio chieti-pescara, italian depart civil protect relui project, mineco (ministerio economia y competitividad spanish government) erdf (european region develop- ment fund) micropar project (identif mechan strength paramet structur masonri experiment method numer micro-modelling, ref num. bia2012-32234) excel programm knowledg gener mineco, eaci project (enhanc accuraci comput experiment framework strain local failur mechanisms, ref. mat2013-48624-c2-1-p). s. oller acknowledg support european research council advanc grant: erc-2012-adg 320815 comp-des-mat "advanc tool comput design engin materials" refer 1. (2002) gid: person pre post preprocessor 2. addessi d, sacco e (2014) kinemat enrich plane state formul analysi masonri panels. european journal mechanics-a/solid 44:188200 3. addessi d, sacco e, paolon (2010) cosserat model period masonri deduc nonlinear homogenization. european journal mechanics- a/solid 29(4):724737 4. badillo ha (2012) numer model base multiscal homogen theory. applic composit materi structures. phd thesis, universitat politcnica catalunya barcelonat- ech 5. baant z, oh b (1983) crack band theori fractur concrete. bordas-dunod, url //books.google.it/books?id=x9citwaacaaj 6. belytschko t, loehnert s, song jh (2008) mul- tiscal aggreg discontinuities: method circumv loss materi stability. interna- tional journal numer method engineer- ing 73(6):869894 7. benedetti l, cervera m, chiumenti m (2015) stress-accur mix fem soil failur shallow foundat involv strain local plasticity. comput geotechn 64:3247 8. bosco e, kouznetsova v, geer m (2015) multi- scale comput homogenizationloc propag discontinu x-fem. inter- nation journal numer method engi- neer 102(3-4):496527 9. car e, zalamea f, oller s, miquel j, oat e (2002) numer simul fiber reinforc composit materials-two procedures. interna- tional journal solid structur 39(7):1967 1986 10. cervera m, chiumenti m (2006) mesh object tensil crack local continuum damag model crack track technique. method appli mechan engin 196(1):304320 11. cervera m, chiumenti m, codina r (2010) mix stabil finit element method nonlinear solid mechanics. ii: strain localization. method appli mechan engin 199(37):25712589 12. cervera m, pel l, clement r, roca p (2010) crack-track techniqu local damag quasi-brittl materials. engin fractur me- chanic 77(13):24312450 13. coenen e, kouznetsova v, geer m (2012) novel boundari condit strain local analy- se microstructur volum elements. interna- tional journal numer method engi- neer 90(1):121, doi 10.1002/nme.3298, url 14. dadvand p, rossi r, oat e (2010) object- orient environ develop finit ele- ment code multi-disciplinari applications. archiv comput method engin regular order comput homogen multiscal analysi masonri structur 21 17(3):253297 15. dadvand p, rossi r, gil m, martorel x, cotela j, juanper e, idelsohn sr, oat e (2013) migra- tion gener multi-phys framework hpc environments. comput & fluid 80:301309 16. belli ml (2009) cosserat base multi-scal techniqu masonri structures. in: phd thesi 17. belli ml, addessi d (2011) cosserat base multi-scal model masonri structures. interna- tional journal multiscal comput engi- neer 9(5) 18. geer m, kouznetsova vg, brekelman wam (2003) multiscal first-ord second-ord com- putat homogen microstructur to- ward continua. intern journal multi- scale comput engin 1(4) 19. hernndez ja, oliv j, huesp ae, caicedo m (2012) high-perform model reduct proce- dure multiscal simulations. 127, monograph cimn 20. hill r (1965) self-consist mechan com- posit materials. j mech phy solid 13:213222 21. hugh tj, feijo gr, mazzei l, quinci jb (1998) variat multiscal method-a paradigm comput mechanics. method appli mechan engin 166(1):324 22. kouznetsova v, geer mgd, brekelman wam (2002) multi-scal constitut model hetero- geneou materi gradient-enhanc com- putat homogen scheme. intern journal numer method engin 54(8):12351260 23. kouznetsova v, geer m, brekelman w (2004) multi-scal second-ord comput homoge- nizat multi-phas materials: nest finit el- ement solut strategy. method ap- pli mechan engin 193:55255550, advanc comput plastic 24. lloberas-val o, rixen d, simon a, slui l (2011) domain decomposit techniqu ef- ficient model brittl heterogen materials. method appli mechan en- gineer 200(13):15771590 25. lloberas-val o, rixen d, simon a, slui l (2012) multiscal domain decomposit analysi quasi-brittl heterogen materials. interna- tional journal numer method engineer- ing 89(11):13371366 26. loureno pb, rot jg (1997) multisurfac inter- face model analysi masonri structures. jour- nal engin mechan 123(7):660668 27. lourenco pb (1996) comput strategi masonri structures. phd thesis, tu delft, delft univers technolog 28. lublin j, oliv j, oller s, oat e (1989) plastic-damag model concrete. intern journal solid structur 25(3):299326 29. mandel j (1971) plasticit classiqu et viscoplas- ticit. springer-verlag 30. massart t, peerl r, geer m (2007) en- hanc multi-scal approach masonri wall com- putat local damage. interna- tional journal numer method engin 69(5):10221059 31. massart tj (2003) multi-scal model damag masonri structur 32. mercatori b, massart t (2011) coupl two- scale comput scheme failur peri- odic quasi-brittl planar shell applica- tion masonry. intern journal numer method engin 85(9):11771206 33. mercatori b, bouillard p, massart t (2009) multi- scale detect failur planar masonri shell comput homogenisation. engi- neer fractur mechan 76(4):479499 34. neto eads, feijo ra (2006) variat foun- dation multi-scal constitut model solid: small larg strain kinemat formulation. lncc research develop (16) 35. nguyen vp, stroeven m, slui lj (2011) multi- scale continu discontinu model het- erogen materials: review recent develop- ments. journal multiscal model 3(04):229 270 36. oliv j (1989) consist characterist length smear crack models. intern journal numer method engin 28(2):461 474 37. oliv j, caicedo m, roubin e, hernndez j, hue- spe (2014) multi-scal (fe2) analysi materi failur cement/aggregate-typ composit struc- tures. comput model concret struc- ture p 39 38. oliv j, dia i, huesp ae (2014) crack-path field strain-inject techniqu computa- tional model propag materi failure. method appli mechan en- gineer 274:289348 39. oliv olivella x, caicedo silva ma, roubin e, huesp ae, et al (2014) continuum approach comput multi-scal model fracture. kei engin materi 627:349352 40. oller s (2001) fractura mecnica: enfoqu global. edicion cimn y upc 41. oller s, miquel canet j, zalamea f (2005) com- posit materi behavior homogen 22 massimo petracca et al. doubl scale method. journal engin me- chanic 131(1):6579 42. ortolano jm, hernndez ja, oliv j (2013) compar studi homogen strategi multi-scal analysi materials. 135, mono- graph cimn 43. otero f, martnez x, oller s, salomn o (2012) studi predict mechan perfor- manc nanotube-reinforc composite. com- posit structur 94:29202930 44. otero f, oller s, martinez x, salomn o (2015) numer homogen composit materi analysis. comparison micro mechan formulations. composit structur 122:405416 45. pel l, cervera m, roca p (2011) continuum dam- ag model orthotrop materials: applic masonry. method appli mechan engin 200(9):917930 46. pel l, cervera m, roca p (2013) orthotrop damag model analysi masonri struc- tures. construct build materi 41:957 967 47. quintero rd, oller s, nallim lg (2012) nonlinear homogen techniqu solv masonri struc- ture problems. composit structur 94(2):724 730 48. raijmak t, vermeltfoort (1992) deform control test masonri shear walls: report b- 92-1156. url id=humtpgaacaaj 49. rot jg (1988) comput model con- crete fracture. phd thesis, technisch hogeschool delft 50. scott mh, fenv gl (2003) krylov subspac ac- celer newton algorithm. in: proc., 2003 asc structur congress 51. simo jc, rifai m (1990) class mix assum strain method method incompat modes. intern journal numer meth- od engin 29(8):15951638 52. trovalusci p, masiani r (2003) non-linear microp- olar classic continua anisotrop discon- tinuou materials. intern journal solid structur 40(5):12811297 53. wu jy, li j, faria r (2006) energi releas rate- base plastic-damag model concrete. interna- tional journal solid structur 43(3):583 612 54. zucchini a, loureno p (2002) micro-mechan model homogenis masonry. in- ternat journal solid structur 39(12):32333255 55. zucchini a, loureno pb (2009) micro- mechan homogenis model masonry: applic shear walls. intern journal solid structur 46(3):871886 introduct classic order comput homogen fracture-energy-bas regular two-scal fe comput homogen mode fractur test applic masonri structures. numer model shear wall conclus