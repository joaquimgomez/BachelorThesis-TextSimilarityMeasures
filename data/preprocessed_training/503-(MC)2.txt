nonam manuscript no. (will insert editor) monolith unifi approach fsi multi-fluid flow problem particl finit element method fix mesh p. becker1, s.r idelsohn1,2, e. onate1,3 received: date / accepted: date abstract paper describ strategi solv mul- tifluid fluid structur interact (fsi) problem lagrangian particl combin fix finit element (fe) mesh . method extens fluid-onli pfem-2 [14][15], us explicit inte- gration streamlin improv accuracy. result, convect term appear set equat solv fix mesh. enrich pressur field improv descript interfac phases. keyword multifluid fsi fix mesh lagrangian particl unifi approach 1 introduct simul fluid structur interact (fsi) prob- lem area grow applic field required. nowadai structures, build airplan boat optim minim costs, lead flexibl behaviour air water. furthermore, new area explored, biomed research fast grow stimul field. correspond to: pablo becker cimne, edificio c1, campu nord upc, carrer gran capita s/n, 08034, barcelona, spain tel.: +34 934 016 038 fax: +34 934 016 517 e-mail: 1centr internacion metod numer en en- ginyieria (cimne) 2institucio catalana recerca estudi avanat (icrea) 3departa resistencia materi estructur lengenyeria (rmee), universitat politecnica catalunya (upc) leav asid one-wai fsi methods, stagger weakli coupl algorithm common ap- proach treat fsi problems. method consist comput separ fluid solid domain, ensur forc balanc time step. popular method li speed possibil- iti us special solver structur fluid, desir properti subdomain gener treat differ frameworks. structur solver algorithm emploi lagrangian refer framework, fluid eulerian arbitrari lagrangian eulerian (ale) framework normal used. hand, strongli coupl algorithm solut consid converg forc balanc achiev interfaces. coupl fluid structur subdomains, call mono- lithic partit strategi developed. consist assembl solv equat singl system, partit al- gorithm split fluid solid domain, reli iter process achiev convergence. [16] strongli coupl monolith strategi propos treat simultan fluid solid framework. lagrangian ap- proach, possibl write momentum equa- tion solid fluid seamlessli minor differ stress memori solids. allow solv al equat unifi comput frame, highli improv ac- curacy. hand, deal larg defor- mation experi fluid phase, remesh algorithm implemented. allow avoid dis- tort meshes, extra comput cost associ delaunai triangul mesh stage. 2 p. becker1, s.r idelsohn1,2, e. onate1,3 follow line, work propos new method us discret solv techniqu phase present do- main. strategi extens particl fi- nite element method-second gener (pfem-2) de- velop multifluid [15]. pfem-2 base us lagrangian particl connect convect materi properti combin fix mesh, lead lagrangian formul with- need deform spatial mesh remesh- ing. materi point domain rep- resent lagrangian particles, possibl con- vect unlimit number variabl cost. furthermore, convect stage greatli improv follow streamlin veloc explicit way, improv accuraci order ex- plicit method keep comput cost low. particl convected, variabl project mesh, boundari identifi materi properti chang lagrangian solv fix mesh. furthermore, im- prove definit interfac enrich shape functions, physic problem ex- actli simul despit mesh match interfaces. paper structur follows. first, mono- lithic strategi pfem-2 described, section strategi treatment fsi prob- lem describ final valid exampl pre- sented. 2 monolith strategi multi-fluid fsi 2.1 mix framework: pfem-2 start point reduc complex prob- lem select right refer framework. ap- propriat choic lead simplif complex term higher accuraci result bet- ter approximations. follow line, lagrangian framework offer import advantag sim- pliciti equations. however, materi point configur chang continu time, necessari coupl set equat strategi solv movement materi points. current model base mix eulerian- lagrangian framework, combin advantag methods. achiev set particl combin fix fem mesh solv strat- egi known pfem-2 [14]. method obtain writing, given particl p, follow definit posit veloc given timestep n+ 1, v veloc acceleration. xn+1p = x n p + n+1 n vtdt (1a) vn+1p = v n p + n+1 n atdt (1b) explicit strategi (1a), convec- tive term complet uncoupl momen- tum equat lagrangian equat obtained. main advantag lagrangian particl convect obtain simpli move particl space solv includ convect term. set equat calcul mesh, possibl includ partial contribut par- ticl improv accuraci [14]. complet scheme requir solv step becomes: particl stage convect particl project info mesh stage solv eq updat particl particl scheme repres fix mass, materi point certain properti velocity. allow differ particl depend zone ensur better accuraci areas. note algorithm present paper, particl transport inform (solv convect term). however, certain case viscos low singl fluid, possibl solv partial momentum equat (1b) particles, explain [14]. despit strategi lead higher accuraci case analys article, lack gener requir simul fsi problems. figur 1 show streamlin integr sin- gle particle. step pure explicit , achiev convect particl veloc previou time step, picard [9] iter fashion. forc integr (if added), inform gather step, lagrangian particl step remain pure explicit, allow fast com- putat particl trivial paralleliz fast. remark: possibl imagin explicit con- vection step non linear iter pro- cess. iter process follow, new veloc calculated, particl coordin reset initi posit streamlin integr perform repeat tasks. however, practic experi sug- gest iter provid result titl suppress excess length 3 fig. 1: pfem-2 streamlin integr accur enough, numer data match ex- periment result larg time steps. particl convected, informa- tion project mesh. interfac drawn determin exact place properti change. defin mesh auxiliari scalar function valu zero these lines(2d) surfac (3d). correct locat interfac critical, finit element mesh enrich interfac explain later, allow accur solution. figur 2 show posit interfac given distribut particles. pro- jection kernel transfer inform par- ticl mesh critic strategy. inform store mesh, kernel accur guarante project field variables(in mesh) resembl field origin domain (particles). fail mean differ problem solv domain accuraci lost. fig. 2: interfac detect particles. red line = 0 have detect interface, equa- tion assembl solv implicitly. sound speed infinit incompress fluids, complet set equat calcul explicitli [17]. finally, equat solved, correct pass particl cycl restarted. detail convect stage procedur solv equat explain follow sections. 2.2 continuum equat explain section, us particl al- low omit convect term. equa- tion solv obtain coupl momentum balanc gener materi compress equation. together, equat provid exact solut problem thermal term con- sider uncoupl mechan equations. d(v) dt = + g (2) dp dt + .v = 0 equat (2) hold material, fluid solids, density, compress mod- ulus, v velocity, stress g mass forces. 2.2.1 continuum equat fluid particular case fluids, stress tensor de- pend current strain rate pres- sure: f = 2 ( vs ) p. aim work deal problem rel low veloci- ti v < 0.3c (where c speed sound), fluid consid incompressible. replac (2), equat fluid (3). d(v) dt = [ 2 ( v + (v)t 2 )] p+ g (3) .(v) = 0 note set equat stabil infinit sound speed caus incompress condition. 2.2.2 continuum equat solid hypoelast model provid excel constitu- tive model solid simplic direct applic veloc formulations. hypoelast mate- rial stress defin simpli rate deform as: = f(,d) dij = 1 2 ( vi xj + vj xi ) (4) definit hypoelast materi return rate stress stress itself. partic- ularli us veloc formul rate stress function f depend rate deform d (relat velocity) instead deformation. however, cauchi stress tensor object (it affect rigid bodi rotations). therefore, 4 p. becker1, s.r idelsohn1,2, e. onate1,3 stress measur required. truesdel stress rate elimin stress depend model simplicity, stress rate becomes: = f(d) (5) truesdel rate relat pk2 stress s provid exact stress rate given deformation. = j1f(n+1)s(n+1)ft (n+1) (6) tensor elast moduli truesdel stress rate ct : = ct : d = (i + 2i) : d d d + (7) lame parameters. seen equat (7) linear c depend . overrid inconvenience, jaumann [1] stress rate used, simplifi stress rate deform j plu rotation, avoid non- linear terms. j = (i + 2i) : d (8) approxim stress rate (9) in- stead exact truesdel stress, equat 6 written as: j (n+1) (i + 2i) : dn+1 = f(n+1)s(n+1)ft (n+1) (9) us finit differ time obtain s j (n+1) (i + 2i) : dn+1 = f(n+1) s(n+1) s(n) t ft (n+1) (10) f(n+1) s(n+1) t ft (n+1) = j (n+1) (i + 2i) : dn+1+ f(n+1) s(n) t ft (n+1) recal relat second pk stress cauchi stress j = fsft , lh becomes: j (n+1) (n+1) t = j (n+1) (i + 2i) : dn+1+ f(n+1) s(n) t ft (n+1) (11) reset refer framework time step known configur x(n+1) := x(n), cauchi stress previou time step directli be- come pk2 stress s(n) := (n). final stress new configur (13), subindex n+1 impli old stress updat new configuration. (n+1) = j1(n+1)f(n+1)(n)ft (n+1)+ t (i + 2i) : dn+1 (12) (n+1) = (n) n+1 +t ( tr(d n+1)i + 2 dn+1) (13) mimic formul veloc pressur fluids, us decompos stress pressur p = 1 3 tr() caus volumetr deform v = 1 3 tr(d) deviator caus deviator stress d = d v . (n+1) = (n) n+1 +t [ tr(dn+1)i + 2(dn+1 + v) ] (14) (n+1) = (n) n+1 +t [ (+ 2 3 ) tr(dn+1)i + 2(dn+1) ] (15) (n+1) = (n) n+1 +pi + (16) p = t (+ 2 3 ) tr(dn+1) (17) = 2t (dn+1) equat (16) (17) provid strategi up- date stress time step. detail explan deriv [16] [18]. 3 fix mesh domain 3.1 spatial discret chosen spatial discret finit element method [23]. consist divid domain elements, geometri defin nodes. un- known variabl valu node so- lution interpol nodal valu insid element. work linear shape function variables. fe discret test function w veloc q pressure, weak form [24] (2) (18). note stress term integr part avoid second deriv shape functions.( w, d(v) dt ) = (w, g) (w,)( q,.(vn+1) ) = 0 (18) titl suppress excess length 5 equat (18) omit boundari term appear integr parts. term boundari traction term appear edg finit element discretization: (w,n ) , boundari element n normal vector point- ing outwards. ommit term ensur stress continu guarante inter-el bound- aries, 1 2 boundari adja- cent elements. (w,n1 1)1 (w,n1 2)2 = 0 (19) ensur (19) satisfi particular inter- est work pressur field discon- tinou interfac differ materi properties. fullfil requir ommit term provid straightforward accur approach, discontinu occur pressur field. 3.2 stabil matrix form fluid phase finit element discret directli implement form (18) shape function veloc pressur unstabl fluid pressur stand inf-sup condi- tion [6]. moreover, differ function avoid restriction, suitabl solver contain zero diagon term pressur equat seen matrix form (20). equations, order finit differ acceler term advanc time. [ k() + m() t b bt 0 ] [ vn+1 pn+1 ] = [ 1 t mvn + mg 0 ] (20) order rais limit origin prob- lem, stabil term ad set equa- tion (18). state before, necessari stabil pressur equat fluid problem only. method so, mention work: pressure-stabilizing/petrov- galerkin (pspg) method [11] orthogon sub- grid scale (oss) stabil [4]. reason method add laplacian lhs, hold symmetri system. (21) final shape matrix pre- sent pspg method. oss method explicit project stage lead similar express projecion pressur rhs. [ k() + 1 t m() b bt l( 1 ) ] [ vn+1 pn+1 ] = [ 1 t mvn + mg btg ] (21) l( 1 ) laplacian pressure. en- hanc stabil procedur base finit in- crement calculu (fic) avoid need presuppos pressur free surfac solver stagger schemes. extend updat mix finit element lagrangian formul treat quasi fulli incom- pressibl fluid fsi problem present [19]. (21) solv choos appropri stabil paramet . work set = ( 1/t + 4/h 2 + 2v n/h )1 follow work [5]. depend t ad avoid veloc viscos zero, follow work [2]. 3.3 matrix form solid phase unlik fluids, solid consid incompress- ible. spatial discret variabl fluid formulation: linear el- ement pressur veloc (3 node triangl 2d 4 node tetrahedron 3d). deviator stress, independ variable, state variabl depend veloc unknowns. recal gener equat (2) split stress deviator volumetr components, reads: ( d(v) dt ) = ( p i) + g (22) dp dt + .v = 0 write weak form problem integrat- ing part gradient stress order avoid second deriv veloc con- vert gradient pressur transpos divergence, becomes:( w, d(v) dt ) = (w, ( p i)) + (w, g) (23)( q, dp dt + .v ) = 0 approxim time veloc lead stabl diffus algorithm. avoid shortcoming, newmark beta method se- lected. paramet set constant acceleration. 6 p. becker1, s.r idelsohn1,2, e. onate1,3 result express veloc integr be- comes: 2 vn+1 t = 2 vn t vn finit differ time pressure, di- vide second equat compress mod- ulu recal definit stress (16) gives:( w, vn+1 t ) (w, ( p i)) =( w, vn t + g ) ( w, ( nn+1 (p n) )) (24) ( q, pn+1 t +.v ) = ( q, pn t ) account increas deviator stress , implicit scheme avoid instabilities: d = s vn+1 (25) s standard strain-rat veloc matrix. finally, write equat matrix form, sys- tem express as: ( 2tm() +tk) b bt 1 t m( 1 ) vn+1 pn+1 = m()( 2tvn vn + g) + bnn+1 1 t m( 1 )pn (26) gener matric form fluid elements, stiff matrix k. account deviator stress only, construct modifi constitut matrix follow way: k = std s (27) d constitut matrix. note 2d simulations, coeffici d change. modif elimin strain dimension, mean plain strain state consid 2d cases. s = n x 0 0 0 n y 0 0 0 n z n y n x 0 0 n z n y n z 0 n x ; d = 4/3 2/3 2/3 0 0 0 2/3 4/3 2/3 0 0 0 2/3 2/3 4/3 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 equat (26) solv us stabil formul long solid materi incompressible. otherwise, pressur mass matrix zero stabil required. complic simpl stabil techniqu fluid element used. final addit hypothesi taken order linearis system. transform stress previou configur new con- figur requir updat veloc vn+1, make non-linear. simplif work consist previou step velocity, there- fore assum small acceler solids. hypothesi similar convec- tive term, show good accuraci case tested. 3.4 special consider interfac despit advantag fe discret pro- vides, bear sever limit variabl requir abrupt chang chosen fe space abl reproduce. example,when sharp chang densiti fluid problem, hy- drostat condit gravit forc lead differ valu pressur gradient. special critic fluid differ den- siti (i.e. air-water), term p = g chang abruptli interface. fig. 3: pressur distribut hydro- static case figur 3 show exact pressur distribut hydrostat case water air ob- tain linear elements. clear solut poor practic lead incorrect behavior interfac mass loss [7]. deal fsi problems, issu critical. reason strong dis- continu materi properties, particular stiff (or viscosity). simpl exampl illustr titl suppress excess length 7 box dens solid materi surround air gravit force. case pressur distribut shape illustr figur 4. fig. 4: pressur distribut solid bodi surround air gravit forc fulfil transmiss condit re- quir traction interfac continuous. neglect air pressure, condit satisfi xx = 0 boundari solid. implement solid model make us mean solid pressure, mean (take zz = 0) pressur solid (28): psolid = 1 3 yy 6= pair (28) pressur (28) clearli discontinu interface. linear (or continuous) element locat sharp boundary, discret pressur field detect non-exist gradient creat normal veloc fluid, seen fig- ur 5. violat fluid incompressibility, solver usual converg solut solid node low pressur structur flexibl be. 3.5 rais limitations: pressur enrich overcom problem standard finit ele- ments, space modifi allow accur reproduct solution. altern remesh zone interfac pass through. lead exact solut requir ad new degre freedom (dofs) new nodes. strategy, despit possible, com- putation expens resiz new space alloc memory, task fig. 5: close-up linear element locat interfac show interpol pres- sure field like slower solut sys- tem itself. altern new mesh enrichen fe space. enrich consist creat new dof interfac element static con- dens new unknown [10]. account gradient discontinu pres- sure, shape function propos [?] used. figur 6 seen total 6 function used, object uncoupl complet pressur sides. so, standard shape function interfac element replaced. function basic origin ones, integr calcul con- tribut partit sign match sign node. partit node differ sign, contribut ad enrich- ment function i, j k. words, origin shape function split interface, al- low freedom pressur field retain- ing partit unity. fig. 6: pressur shape functions: top: re- placement functions. bottom: enrich 8 p. becker1, s.r idelsohn1,2, e. onate1,3 stabil pressur equat equival ad artifici diffus variable. ad stabil interfac element in- evit lead innacur behavior solid phase dissip stresses. rea- son stabil elements. however, state previou sections, caus instabl non-fulfili inf-sup [4] condition. overrid problem, side interfac consid compress (use compress modulu solid phase). hypothesi correct, lead small error fluid volum chang sharp chang pressur timestep next. strategi yield exact results, avoid- ing pressur diffus interfac minim errors. remark: advantag set func- tion partit uniti conserved. importantly, impli reconstruct- ing pressur pn convect easier per- form accurately. strategi current implement consist follow steps: first, standard nodal project algorithm and, therefore, valu replac shape function set. have this, enrich shape function defin mean real nodal valu previou timestep n. ensur predict gradient normal direct minimized, reduc spuriou velocities. 3.5.1 ad new dof equat describ enrich function ad monolith strategi follow standard condens procedur [10]. defin notat n stan- dard shape function enrichments, extend (29). written veloc mass matric lack space. also, mass matric (both veloc pressure) multipli 1 t , omit reason. knn + mn bnn bnbnnt mn ( 1 ) 0 bn t 0 m( 1 ) vnn+1pn+1n pn+1 = 1tmnvnn + mngmn ( 1 )pnn m( 1 )pn (29) simplifi notation, written as:[ ann ][ xn x ] = [ fn f ] (30) condens enrich dof initi size recovered, as: axn = f (31) = ann ana1 (32) f = fn ana1 ff (33) 4 lagrangian particl domain 4.1 streamlin integr solv strategi describ previou section requir accur robust tool account convect term. aim pfem-2 achiev larg time step small errors, simpli particl ve- lociti multipli time step (x = vn t). main object obtain informa- tion possibl previou time step calcul new state particles. method chosen, fol- low strategi [14] singl fluids, streamlin integration. particl p, exact posi- tion time n+ 1 defin (34): xn+1p = x n p + n+1 n vtdt (34) unfortunately, veloc known contin- uousli time t discret time steps( n 1,n, n + 1 ... ). approxim trajectori veloc previou time step, new posit becomes: xn+1p x n p + n+1 n vndt (35) approxim valid quasi- stationari problems, lead sever error tran- sient phenomena. [14] shown singl fluid strategi valid. multi-fluid fsi problem differ properties, partic- ular density, make approxim unsuit cases. densiti jump important, fluid domin behaviour complet differ (ie: air water). exam- ple, break wave repres figur 7. follow- ing streamlin predict water particl trajec- tori lead incorrect results. overcom problem, streamlin integra- tion deactiv particl heavier fluid transit region lighter fluid. case, graviti taken act force, titl suppress excess length 9 fig. 7: break wave fluids. blue line: streamlin tn; green line: actual particl trajectori lead parabol (projectile) motion, known veloc particl taken start data. set distanc function 0 denser fluid region > 0 lighter fluid regions, updat posit denser fluid particl (36): xn+1p { xnp + n+1 n vndt xtp 0 xnp + n+1 n vnp + g t dt xtp > 0 (36) import notic method pure explicit correct comput convect term. iter process perform improv ac- curacy, exampl solv strategi result correct, despit larg time step cho- sen. special interest pfem-2 compar code us implicit strategi reli smaller time step obtain similar results. base test decid explicit comput convect term, provid excel bal- anc comput time accuracy. 4.2 project kernel particl convect new posit x p n+1 necessari project inform mesh order solv lagrangian equations. simplest project kernel consist directli shape function elements. example, definit interfac materi explained. particl associ materi interfac locat materi prop- erti change. distribut particl insid element defin complic curv im- possibl manag simpl shape function larg number particles. example, figur 8 particl wrong interface. reason instantan local interfac insid element simpli defin line (or plane 3d) take account weight averag shape functions. assum materi present (ie: air water), lighter given pos- itiv sign denser neg sign. pseudo, instantaneous, level-set function creat de- fine interfac valu zero. calcul valu jth node, particl neighbour element j used. weight- ing function defin standard shape function element node j posit particle. contribut particl added, locat interfac trivial (37). fig. 8: contribut particl j node j = n signin j n j (37) procedur extend variables, replac signi particl desir vari- able, scalar, vectori tensorial. ker- nel, project veloc written (38). (.) notat impli approx- imat velocity, take account convect term neglect contribu- tions. veloc start point finit element fix mesh solver. vn+1j = n vin j n j (38) worth note element shape function ni possibl kernel. example, function propos [22] assign higher weight particl closer node. set h 10 p. becker1, s.r idelsohn1,2, e. onate1,3 element size u = r/h, r distanc particl node, wendland kernel written (39). w j = 7 4h2 (1 + 2u)(1 u/2)4; (39) inform lagrangian domain project mesh comput performed, veloc particl up- dated. stage import replac particl veloc new, updat veloc correction. reason simple; mat- ter good kernel algorithm be, exact. replac unknown particl destroi valuabl data, lead excess artifici dif- fusion strategy. base this, updat stage particl transfer variat veloc (or variable) calcul mesh, is: vn+1j = v n+1 j vn+1j (40) 4.3 comput issu code speed code work develop c++ program environ krato [8]. krato open sourc multi-phys framework specif de- sign finit elements, eas task common fe codes, assembl equat find effici solver. ensur- ing low execut time particl convect stage critic number particl 10 20 time larger number element mesh given domain, mean million particl displac time step. optim parallel stage lead code spend approxim half execut time particl task half solut implicit equat mesh. current implement capabl solv phase flow accur execut time similar faster industri standard code openfoam, shown [14] phase flow [15] multi-fluids. 5 complet pfem-2 algorithm coupl strategi describ previou sec- tions, pfem-2 solver multi-fluid fsi obtained. step summar follows: step 1) convect particl streamlin step 2) project inform mesh, q fluid particl r solid particl common variabl solid v ariabl vn+1j = r+q vin j ir+q n j pnj = r pin j ir n j fluid variabl solid = r nuir 1 fluid = q iq 1 nsolid = r n ir 1 fluid = q iq 1 esolid = r eir 1 solid = r ir 1 step 3) detect interfac element step 4) estim pressur enrich step 5) assembl equat enrich step 6) solv equat step 7) recov condens dof step 8) updat veloc particles, pressur stress 6 numer exampl 6.1 rayleigh-taylor instabl classic benchmark multi-fluid test verifi solver. despit analyt result experiment data 2d check error, possibl compar numer results. et al. [13] present result reynold number = 256 lattic boltzmann scheme. initi conditions, result = 1000 [12]. geometri seen figur 9, discret 163000 elements. paramet simul are: q = 3 kg/m 3 q = g d3/2 m2/ p = 1 kg/m 3 p = g d3/2 m2/ gy = 10 m/s2 t = 0.01 s initi conditions: v = 0 = y 0(cos(2(x) ) + 1) + 2.0 0 = 0.1 figur 11, snapshot differ time step seen. reynold number analysed, result obtain match on [13],[12]. adimen- sional time tadim = t g/2 used. final po- titl suppress excess length 11 fig. 9: rayleigh-taylor instabl configura- tion sition advanc denser fluid (centre) rise bubbl (sides) compar result [12]. good match observed. 0,0 0,2 0,5 0,8 1,0 1,2 1,5 1,8 2,0 2,2 time 1,50 1,25 1,00 0,75 0,50 0,25 0,00 0,25 0,50 0,75 1,00 p os io n guermond pfem-2 fig. 10: vertic posit advanc bubbl rayleigh-taylor in- stabil = 1000 fig. 11: snapshot rayleigh- taylor instabl problem tadim = 1.0 , 1.5 , 1.75 , 2.0 , 2.25 , 2.5. = 256 6.2 static cantilev beam immers fluid test accuraci solver potenti enrich function uncoupl pressure, follow numer exampl designed. beam un- der small deform surround light fluid. inerti term neglect test static so- lution, lead stoke problem fluid. viscos set small possibl allow faster converg static solut maintain stability. geometri observ figur 12. materi properti are: q = 1 kg/m 3 p = 0.001 kg/m 3 e = 107pa p = 0.01pa. = 0 fig. 12: cantilev beam fluid geometri beam dimens l = 10 h = 1. ver- tical mass forc q = 1[m/s2] appli domain. accord timoshenko beam theori correct forc account buoyanc effect, vertic displac w tip wmax = (q p) ( q l4 8 e + 1 2 q l2 10/12 h ) = 0.001511 (41) structur mesh decreas element size creat check convergence. mesh size h = 1 h = 0.01 used. test influenc projec- tion algorithm, simul run with- projection. case, nodal pressur kept instead obtain particles. order test behaviour split ele- ments, mesh interfac solid phase fluid phase locat approxim middl elements, shown figur 13. case enrich shape function pressur imper strong discontinu materi properties, lead jump pressur field. variabl enrich allow dis- continuities, strong pressur gradient appear interfac and, therefore, result veloc field inaccurate. notic fig- ur 13 correctli repres pressur interfac elements, field print linear interpolation, realiti discontinu enrichments. figur 14 clear detriment effect project stage. algorithm pro- jection abl maintain quadrat converg 12 p. becker1, s.r idelsohn1,2, e. onate1,3 fig. 13: beam interfac pressur distribu- tion solid-onli case, result project converg slope 3/2. fig. 14: converg cantilev beam fluid despit solver project stage provid accur solution, lead accept error mesh size chosen. coars mesh element thickness, error low (at 10 % ). 6.3 turek fsi benchmark test strategi fulli coupl scenario, turek fsi benchmark [20] simulated. prob- lem typic refer valid new fsi strategi particularli challeng stag- gere scheme similar properti fluid solid. hand, monolith solver work particular difficul- ties. problem consist 2d rigid cylind at- tach elast beam immers fluid current. complet dimens probem paramet [20]. paper fix mesh 48500 triangl used. frequenc amplitud oscil analyz test accuracy. case test work = 200, parabol inlet veloc profil follow parameters: fluid = 1000 kg/m 3 fluid = 1pa. solid = 1000 kg/m 3 esolid = 1.4mpa solid = 0.4 t = 0.005 s figur 15 veloc contour observ stationari regim achieved. finally, fig- ur 16 vertic displac tip ob- served. tabl 1 result analyzed. compar turek solution, amplitud frequenc 10 % refer value. result con- sider accept consid triangular element present thick beam. frequenc amplitud turek 5.3 0.0707 pfem2 4.8 0.0610 tabl 1: pfem2 turek result fig. 15: turek fsi veloc contour fig. 16: tip displac turek fsi 6.4 3d benchmark: dynam cantilev beam exampl case test solver dynam tridimension problems, geometri pre- viou 2d cantilev beam select restor inerti term take width b = 1 obtain squar section. geometri seen figur 17, vertic mass forc initi movement. chosen mesh size h = 0.125 surround beam h = 0.6 distant fluid areas, total 283500 tetrahedron 4 million particles. time step set t = 0.001 properti solid 2d case: = 1 kg/m3 e = 107pa = 0 titl suppress excess length 13 fig. 17: tridimension cantilev geometri case densiti fluid negli- gible, possibl calcul analyt vibrat frequenc vacuum follow expression: vac = c4n e l4 (42) subscript n denot mode cn posit root equat (43) 1 + cos(cn) cosh(cn) = 0. (43) take vibrat mode, c1 = 1.8751 frequenc beam becomes: vac = c41 e l4 = 32.097 rad/ 5.108 hz (44) frequenc observ simul low fluid densiti (< 0.001kg/m3) 5.175hz, good agree- ment theoret value. slightli higher valu caus low number element thickness, lead stiffer behavior. test influenc fluid density, accord- ing van eysden [21] possibl estim lower vibrat mode rectangular section beam immers fluid follow formula: fluid = vac ( 1 + pb 4qh f )1/2 (45) f hydrodynam function de- pend viscos cross section beam. inviscid flow squar section f = 1.513 [3]. fluid densiti 0.0001kg/m3 0.99kg/m3 select valid code. result seen figur 18, togheth comparison (45). analyz graph, clear numer- ical solut diverg expect curv fluid densiti increases. caus limita- tion standard linear element ve- lociti field, lead interfac element assembl averag (base volumes) stiff properti fluid solid there- fore ad mass effect larger be. fig. 18: oscil frequenc 3d can- tillev beam differ fluid densiti analyz converg method mesh size, case fluid densiti f = 0.5kg/m 3 selected. mesh size h = 0.33 h = 0.08 (3 12 element thick beam). case interfac locat split element middl test worst case scenario. fig. 19: mesh converg oscil frequenc 3d cantilev beam quadrat converg mesh size observ figur 19, indic interact fluid beam accur simulated. 7 conclus futur work tool solv monolith multi-fluid fsi prob- lem developed. strategi base pfem- 2 origin formul [14] homogen fluids, allow fast comput maintain accuracy. 14 p. becker1, s.r idelsohn1,2, e. onate1,3 develop model make us lagrangian par- ticl fix mesh. mesh, enrich degre freedom (dofs) ad improv pressur field interfaces. ad extra dof al- low accur captur solut materi properti chang abruptli lead discontinu pressur gradients. hand, avoid resiz equations, new variabl static condens comput time significantli increased. exampl show standard veloc field accur coars mesh artifici ad mass effect caus fe linear shape functions. step, enrichen veloc variabl improv definit interfac reduc error need refin mesh. finally, major improv capabl solver ad advanc constitut model account realist behavior com- plex phenomena debri flows, solid stage rheolog model flow. al- low simul complet phenomena, initi deposit erod materi singl accur tool. currently, strategi simul process unifi frame. 8 acknowledg research lead result receiv fund- ing peopl programm (mari curi actions) european union seventh framework programm fp7/2007-2013/ rea grant agreement n 289911. work support erc advanc grant realtime, project adg-2009325, erc advanc grant safecon, project adg-26752 hfluid project nation rtd plan spanish ministri scienc innov i+d bia2010-15880. refer 1. belytschko, t., liu, w.k., moran, b., elkhodary, k.: nonlinear finit element continua structures. john wilei & son (2013) 2. bochev, p.b., gunzburger, m.d., lehoucq, r.b.: stabil finit element method stoke problem small time step limit. intern journal numer method fluid 53(4), 573597 (2007) 3. brumley, d.r., willcox, m., sader, j.e.: oscil cylind rectangular cross section immers fluid. physic fluid (1994-present) 22(5), 052,001 (2010) 4. codina, r.: stabil incompress convect orthogon sub-scal fi- nite element methods. method ap- pli mechan engin 190(13), 1579 1599 (2000) 5. codina, r.: stabil finit element approxim transient incompress flow orthogon subscales. method appli mechan- ic engin 191(39), 42954321 (2002) 6. codina, r., badia, s.: pressur segrega- tion method fractional-step type finit element approxim incompress flow prob- lems. method appli mechan engin 195(23), 29002918 (2006) 7. coppola, h.: finit element model free surfac fluid flow fix meshes. ph.d. thesis, universitat politecnica catalunya (2009) 8. dadvand, p., rossi, r., onate, e.: object- orient environ develop finit element code multi-disciplinari applications. archiv comput method engin 17(3), 253297 (2010) 9. deblois, b.m.: linear convect term navier-stok equations. method ap- pli mechan engin 143(3), 289297 (1997) 10. felippa, c.a.: introduct finit element meth- ods. univers colorado, boulder, colorado. edu/engineering/cas/courses. d/ifem. d (2004) 11. fries, t.p., matthies, h.g.: review petrov galerkin stabil approach extens meshfre methods. institut scientif com- puting, univ. braunschweiginst. technology, tr-2004-01, brunswick, germani (2004) 12. guermond, j.l., quartapelle, l.: project fem variabl densiti incompress flows. journal comput physic 165(1), 167188 (2000) 13. he, x., chen, s., zhang, r.: lattic boltzmann scheme incompress multiphas flow applic simul rayleightaylor insta- bility. journal comput physic 152(2), 642663 (1999) 14. idelsohn, s., nigro, n., gimenez, j., rossi, r., marti, j.: fast accur method solv incompress navier-stok equations. engineer- ing comput 30(2), 22 (2013) 15. idelsohn, s.r., marti, j., becker, p., onate, e.: analysi multifluid flow larg time step particl finit element method. inter- nation journal numer method fluid titl suppress excess length 15 (2014) 16. idelsohn, s.r., marti, j., limache, a., onate, e.: unifi lagrangian formul elast solid incompress fluids: applic fluidstructur interact problem pfem. method appli mechan engin 197(19), 17621776 (2008) 17. muneer, t.t., kubie, j., grassie, t.: heat trans- fer: problem solv approach. taylor & franci (2003) 18. onate, e., franci, a., carbonell, j.m.: particl fi- nite element method analysi industri form- ing processes. comput mechan pp. 123 (2014) 19. onate, e., franci, a., carbonell, j.m.: parti- cle finit element method (pfem) coupl ther- mal analysi quasi fulli incompress flow fluid-structur interact problem pp. 129 156 (2014) 20. turek, s., hron, j.: propos numer bench- mark fluid-structur interact elast object laminar incompress flow. springer (2006) 21. van eysden, c.a., sader, j.e.: reson frequen- ci rectangular cantilev beam immers fluid. journal appli physic 100(11), 114,916 (2006) 22. wendland, h.: piecewis polynomial, posit def- init compactli support radial function minim degree. advanc comput math- emat 4(1), 389396 (1995) 23. zienkiewicz, o., taylor, r.: finit element method: basis, vol. 1. butterworth-heinemann (2000) 24. zienkiewicz, o., taylor, r., zhu, j.z.: fi- nite element method: basic fundamentals, vol. 1, 6th edn. elsevi (2006)