1 time domain simul coupl sloshingseakeep problem sphfem coupling. b. servn-camas1,*, j.l. cercs-pita2, j. colom-cobb1, j. garca-espinosa1,3, a. souto-iglesias2 1 centr internacion metod numer en enginyeria (cimne), 2 cehinav res. gr., dmfpa, etsin, technic univers madrid (upm) 3 universitat politecnica catalunya, barcelonatech (upc), barcelona, spain * correspond author: +34-934054627 keywords: seakeeping, sloshing, coupling, sph, fem, lng abstract aim work carri numer simul time domain seakeep problem take account intern flow tanks, includ sloshing. aim, smooth particl hydrodynam (sph) solver simul intern flow tank coupl time domain finit element method (fem) diffractionradi solver develop seakeep problems. valid carri compar avail experiment data. good agreement obtain numer result experiment data found. 1. introduct seri marin oper and/or navig condit coupl intern flow tank seakeep dynam crucial configur global dynam respons vessel. assess coupl effect extrem import order estim viabil certain oper risk associ specif load condit navigation. navig condit and/or oper include: carri offshor vessels, equip anti-rol tanks, commonli oil&ga industry, consist deploi pipe systems, cables, drill equipment, etc. (see e.g. neve et al., 2009); refer offload oil liquefi natur ga (lng) float product storag offload (fpso) platform, bunker vessel float lng (flng) shuttle, regular vessel lng carrier, respectively, side-by-sid configur (see e.g. watai et al., 2015); transport partial fill tank lng storag flng tank (see zhao et al., 2011, review flng vessel hydrodynamics). 2 larg econom cost larger penalti case unexpect problem, plan mention oper definit fill level threshold tanks, requir deep understand coupl dynam vessel intern flows. order achiev understand import notic extern dynam usual resolv rel larg time scales, intern dynam incorpor violent slosh flows, requir resolv complex free-surfac dynam shorter time scales. addition, wave excit present, low wave amplitudes, motion usual linear amplitud frequenc moder larg wave amplitudes, respons extrem nonlinear. reasons, order simultan resolv seakeep intern flow dynamics, differ type solver typic them. instance, zhao et al. (2014a) us frequenc domain linear boundari element method (bem) approach obtain hydrodynam coeffici wave forces, coupl timedomain nonlinear potenti solver intern dynamics. exampl commonli cite refer kim et al. (2007) resort frequenc domain calcul resolv intern flow model euler equations, finit differ scheme. techniqu ship motion li et al. (2012) solv intern flow widespread open-sourc volum fluid (vof) base solver openfoam. numer method tradition adopt seakeep simulation, boundari element method (bem) domin like finit element method (fem). reason fact comput effort spent solv laplac equation. look like bem offer lower comput effort. however, cai et al. (1998) carri heurist studi comput effort requir solv laplac equat bem fem. studi conclud similar three-dimension problem discret size, number unknown bem fem o(n2) o(n3), respectively, n number unknown need dimens achiev desir discretization. comput cost o(n4) o(n3) respectively. therefore, bem effici problem low number unknowns, fem effici respect bem number unknown increases. consid comput capabl continu increases, complex problem undertaken, number unknown required. fem effici bem. 3 timedomain diffractionradi solver base finit element method (fem) previous (see ma yan, 2009, servn-cama garca-espinosa, 2013). capabl natur incorpor non-linear larger timedomain solver base frequenc domain pre-calcul on kim et al. (2007), li et al. (2012), zhao et al. (2014a). solver successfulli coupl moor model (ma yan, 2009), side-by-sid (yan ma, 2011) multi-bodi configur (servn-cama garca-espinosa, 2013). fem base solver have, however, author knowledge, model coupl slosh ship motions. onset violent sloshing, intern dynam extrem complex computation expens resolve. context, smooth particl hydrodynam (sph) solver competit option since, hand, abl cope extrem non-linear fragment free-surfac flows, hand, easili parallel cost competit graphic card process units. sph solver successfulli past solv coupl dynam singl degre freedom angular motion coupl slosh problem (bouscass et al., 2014a, 2014b, bulian et al., 2010) parallel gpu subject signific recent attent (see e.g. crespo et al. 2011; domingu et al. 2013; herault et al. 2010; nishiura et al. 2015). paper, intern flow dynam solv aquagpusph (cercs-pita, 2015) seakeep dynam solv seafem (servn-cama garca-espinosa, 2013). solvers, aquagpusph seafem, develop authors. paper organ follows: section 2 introduc intern flow wave diffract radiat solvers; section 3 describ rigid bodi dynam solver; section 4 focus detail coupl algorithm, commun solvers; section 5 present valid studi compar result obtain work experiment data avail differ case scenarios; finally, section 6 provid conclus work. 2. intern flow seakeep solver let mention seakeep intern flow solver independ developed, compiled, distribut software. hand, seakeep solver seafem, potenti fem time domain suit tool seakeep simul [1] develop intern center numer method engin (cimne) [2], collabor compassi [1]. 4 hand, intern flow solver aquagpusph, open-sourc 3d sph solver, acceler opencl order run gpus, develop model basin research group [3] technic univers madrid. 2.1. intern flow solver: aquagpusph 2.1.1. general. aquagpusph (cercs-pita, 2015) recent releas free 3d sph solver, licens gplv3, acceler opencl. aquagpusph sourc code developers' documentation, galleri images, videos, valid case new blog, avail download [4]. aquagpusph valid thoroughli document cercs-pita (2015), model slosh flow insid lead-cool fast nuclear reactor earthquake, focus evalu load caus fluid structure. cercs-pita (2015) solver valid fluid load wall (with emphasi pressur loads) dam-break flow tld case work canon represent anti-rol tank (bouscass et al., 2014a, 2014b; bulian et al., 2010). intern solver simul influenc anti-rol tank nonlinear ship motion solver base pre-calcul (in frequenc domain) diffract forc (cercos-pita et al., 2016, 2016b). 2.1.2. sph method. sph meshless numer method develop seventi appli nineti free-surfac flow (monaghan, 1994), base follow convolut integral: () = 1 () ()(| |, ) (1) scalar vectori function, kernel function (in specif applic quintic wendland function considered), fluid domain, () renorm factor: () = (| |, ) (2) convolut integr appli gener differenti oper , 5 () = 1 () ()(| |, ) (3) () gener unknown. however, expand express appli diverg theorem differenti oper conveni move kernel function: () = 1 () ( () ( , ) + () ()(| |, ) ) (4) previou equat outward orient normal boundary. tradition renorm factor () integr (so call boundari integral) neglect usag fluid extens enforc boundari conditions. however, recent years, possibl keep term attract research (see cercos- pita, 2015; ferrand et al., 2013; maci et al., 2012), and, matter fact, retain present implementation. hence, sph convolut (eq.(1)) allow evalu differenti oper known field values. practic purposes, integr eq. (4) numer evalu discret fluid domain set particles, transport flow properti lagrangian framework. end, gener particle, differenti volum comput = /, constant mass particle, density. therefore, discret version oper read: = 1 ( b (b , ) + b (| |, )) (5) area gener boundari element . 2.1.3. govern equations. methodolog describ appli navierstok equat weakli compress lagrangian formulation: = (6) = + 1 + (7) = (8) pa = 0 20 (( 0 ) 1) (9) 6 veloc gener materi particl a, graviti force, 0 0 densiti speed sound fluid respectively, incompress factor, stress tensor. 2.1.4. discretization. conserv consist reason (see colagrossi et al., 2009, 2011, 2013), differenti oper directli approxim equat eq. (5), conveni symmetrized. specifically, approxim differenti oper practis work read follows: = 1 ( (b ) + (b ) ) (10) = 1 ( ( 2 + 2 ) + ( 2 + 2 ) ) (11) 1 = (b ) (b ) |b | 2 (12) turbul model used, colagrossi et al. (2011, 2013, 2015) bouscass et al. (2014 a,b) show sph model fairli accur turbul dissip kind free-surfac flows, presenc wave breaking. matter fact, bouscass et al. (2014 a,b) capabl model sph coupl slosh angular motion problem. 2.1.5. boundari conditions. boundari conditions, consid neglig effect boundari layer kind slosh flows, free-slip boundari condit imposed. aim, boundari integrals, introduc campbel (1989), formal later kulasegaram et al. (2003), leff et al. (2009), ferrand et al. (2013) maci et al. (2012) used. method base contour integr present eq. (4) discret equat (10)-(11). free slip condit imposed, boundari affect viscou term comput includ eq. (12). us technique, geometr boundari discret flat area element typic size inter-particl distance. main advantag techniqu (see cercos- pita, 2015): 1. effici memori consumpt comput time. 7 2. abl deal complex geometries. 3. fulli consist neighbor limit; contrari boundari techniqu ghost fluid (see maci et al., 2012 details). 2.1.6. numer aspects. pure explicit numer scheme present above, correspond weakly- compress formul (monaghan, 1994), lead numer instabl extrem small time steps, addit diffusion, used. consid this, -sph diffus term work (see antuono et al. 2012, 2015), includ equat (10) = 1 ( (b ) + (b ) ) + 0 . (13) diffus term incorpor non-dimension coeffici valu taken 0.2, optim discuss antuono et al. (2012). factor approxim second deriv densiti field follow express = (b ) (b ) 2 . (14) differ formul factor avail literature. chosen antuono et al. (2012), preserv mass conserv exact hydrostat fields. time integr scheme, souto et al. (2006) discuss modifi predictor- corrector, second order space order veloc densities, present study. time step chosen consid courant condit pressur wave propag (the restrict problem) fulfilled, = 0.25 0 (15) 2.1.7. code acceler parallelization. aquagpusph code add exist free graphic processor unit (gpu) acceler alternatives, comput unifi devic architectur (cuda) base gpusph (herault et al., 2010) dualsphys (crespo et al., 2011). perform comparison solver provid cercs-pita (2015). main differ implement include: first, aquagpusph acceler parallel opencl. second, commonli boundari condit scheme implemented, includ boundari integr present studi (maci, 8 2012). third, aquagpusph python extensible, allow custom coupl solid bodi motions. kei featur led us opencl instead altern like cuda, openmp mpi (all successfulli sph implementations), summar follow list: (1) hardwar diversification: opencl restrict gpus, cpus, ibm cell architecture, abl deal them. featur taken consider framework selected, architectur best one, opencl like easier adapt new architectur creat future. sph develop requir 3 differ version software: serial cpu version, parallel cpu version cuda base version gpus. opencl standard, uniqu version code cover versions, moreover, simultaneously, allow us gpu cpu simulation. (2) highli moddabl application: opencl base glsl work method, code execut comput devic load compil run time, allow reli extern files. 2.2. potenti flow solver seakeep solver includ rigid bodi dynam solver wave diffractionradi solver. rigid bodi dynam solver describ follow section detail coupl aquagpusph. wave diffractionradi solver, consid wave problem govern potenti flow theory: = 0 incompress irrot flow, (16) + x + y z = 0 = free surfac kinemat boundari condition, (17) t + 1 2 + = 0 = free surfac dynam boundari condition, (18) + = 0 p bodi boundari condition, (19) z = 0 = boundari condition, (20) veloc potential, free surfac elevation, fluid domain, b repres wet surfac present bodies, repres local bodi veloc 9 bodi surface, veloc induc , normal vector , h water depth. pressur given point p = 1 2 pressur point p. (21) appli taylor seri expans free surfac boundari condit = 0, introduc stoke perturb solut = 1 + 2 + = 1 + 2 + , retain order terms, order wave problem govern 1 = 0 , (22) 1 1 z = 0 = 0, (23) 1 t + 1 = 0 = 0, (24) 1 0 + 1 0 = 0 0, (25) 1 z = 0 = h, (26) pressur given point p 1 = 1 pressur point p. (27) point on, superscript 1 omit order approach discussed. next, solut decompos = + =+ , incid wave veloc potenti free surfac elev respectively, fulfil = 0 , (28) z = 0 = 0, (29) t + = 0 = 0, (30) z = 0 = h. (31) incid wave describ solut eqs. (36)-(40) : = cosh(||(+)) cosh(||) sin( + ) , (32) = cos( + ) , (33) = 2 (cos() , sin()), wave length, wave direct propagation, wave frequency, phase delay. follow dispers relat holds: 10 2 = || tanh(||), (34) fluid pressur induc incid wave point p given = cosh(||(+)) cosh(||) co ( + ) . (35) diffractionradi veloc potenti free surfac elev respectively. then, order wave diffractionradi govern follow equations: 2 = 0 , (36) tt + = 0 = 0, (37) = 0 = , (38) = ( ) , (39) = 1 g t = 0. (40) pressur induc point p = pressur point p. (41) previou equations, domain assum infinit horizont directions. however, infinit domain consid numer point view. wave repres born bodi propag direct awai bodies, wave dissip let domain come interact bodies. then, sommerfeld radiat condit edg comput domain used: t + = 0 (42) r surfac limit domain horizont directions, cr prescrib wave phase velocity, normal vector r. numer scheme eq. (42) follows: +1 = () + (43) calcul phase veloc wave smaller frequenc (larger waves). eq. (42) let wave phase veloc escap domain. however, wave differ phase veloc (shorter waves) leav domain. then, wave dissip insert dynam free surfac boundari condit vari pressur free surfac pn+1/ = pa/ +()(z) +1 (44) 11 () damp coeffici set zero near field bodi (no dissipation), increas gradually, start given distanc body, order dissip wave diffract radiat body. associ matrix form govern equat fem = b + z0 + zh + r (45) standard laplacian matrix, b,z0 , zh r vector obtain integr correspond boundari condit , = 0, = , . fourth order pad scheme integr free surfac boundari condition, fourth order finit differ kinemat boundari condition: +1 2 + 1 = 1 12 ( +1 2 + 1) (46) +1 = 1 ( 25 12 +1 4 + 31 4 3 2 + 1 4 3) (47) time step obtain base follow stabil criteria: 2/ < ; minimum length vertic direct free surfac discret elements, stabil limit order 1, depend discret used. numer detail bodi dynam wave diffractionradi solver servn-cama garca-espinosa (2013). 3. bodi dynam problem assumpt small rotations, usual assumpt seakeep problems, bodi dynam float devic describ equat motion (use frame refer origin graviti center body): m = ext (48) m bodi mass matrix, bodi acceler vector, ext total extern forc moment vector. inertias, extern loads, includ hydrodynamic, hydrostatic, wave, come intern flow calculations, includ ext. then, eq. (48) solv n implicit newark averag acceler method. ext introduc straightforwardli bodi dynam solver. hence, bodi dynam solver account non-linear gener intern flow calculations, considered. 12 dynam solver integr diffractionradi solver packag calcul action wave load float body. then, bodi dynam solver implicit non-linear, requir iter order achiev converg time step. shown figur 1, iter loop time step. bodi posit vector, bodi veloc vector, bodi acceler vector, 0 extern forc hydrodynam loads, h hydrodynam loads, sph intern tank vector forc moment comput sph solver. regard superscripts, n repres current time step, k repres k-th iter solver loop, l repres l-th iter bodi dynam loop. figur 1: bodi dynam solver algorithm includ load intern flow solver. 13 hand, outer loop iter hydrodynam solver obtain diffractionradi problem. hand, inner loop iter bodi dynam solver updat load act bodi dynamics. look figur 1, observ diffractionradi problem bodi dynam solv time march loop, time step solvers. sph solver, requir smaller time step, exchang data bodi dynam solver carri time step. bodi dynam equations, bossak-newmark averag acceler method implement (wood et al., 2005). iter procedur inner loop requir relax scheme ensur convergence. aitken method relax bodi acceler aim acceler converg iter algorithm (iron tuck, 1969). let standard differ operator, l iter counter, result algorithm bodi dynam loop written as: (a) set iter = 1. (b) comput forc moment act body: ext, = ext(r, t ). (c) solve: (1 )m+1 t +mtt = ext,. (d) comput relax factor: +1 = 1 [1 (r, t r,+1 t )r,+1 t (r, t r,+1 t ) 2 ]. (e) relax step: r,+1 t = ( +1) t + +1 t . (f) check convergence. reach advanc iter = + 1 (b). 4. coupl scheme 4.1. commun issu seakeep intern flow solver work independ developed, compiled, distribut software. therefore, develop implement commun strategi kei point work. gener idea design coupl scheme trivial: bodi movement calcul seakeep solver sent intern flow solver forc moment evalu sent seakeep solver. exchang data, seakeep solver tcl interface, allow execut tcl script access differ intern data structur solver calcul process. 14 part, intern flow solver includ python-bas interface, develop interchang data extern sources. order implement commun scheme, tcl script [5] built, respons commun programs. script interpret execut seakeep solver commun differ instanc intern flow solver. figur 2 explain commun scheme used. exchang data carri respect instantan refer system. tabl 1 2 data sent seakeep solver intern flow solver vice versa. instantan refer time=t, r(t)xtytzt, defin r(0)x0y0z0 coincid global refer oxyz, r(t) describ trajectori point rigid bodi locat initi origin global system, ax xtytzt parallel global axes. understand refer system used, simpl rigid bodi movement present figur 3 show displac rotations. tabl 1: data sent seakeep solver intern flow solver t elaps simul time time-step r(t) = (xr(t), yr(t); zr(t)) coordin bodi refer point r refer global oxyz (t) = (x(t), y(t); z(t)) rotat angl refer global oxyz bodi vr(t) = (vx(t), vy(t); vz(t)) linear veloc bodi refer point r refer global oxyz (t) = (x(t), y(t); z(t)) angular veloc bodi refer global oxyz tabl 2: data sent intern flow solver seakeep solver f(t) = (fx(t), fy(t); fz(t)) intern flow forc refer global oxyz m(t) = (mx(t), my(t); mz(t)) intern flow moment refer global oxyz 15 seafem aquagpusph execut tcl interfac python script seafem initi structur batch file execut initi script b t c h f il e t h t r u n s ll o f q u g p u s p h s e f e m c ll t c l p ro ce ss t ia li za ti o n t c l ia liz ti o n p ro ce ss tcl initi process called: connect aquagpusph wait seafem connect p y t h o n n ia li za ti o n s cr ip t send aquagpusph tank mesh data (number particles, density, viscosity, numer parameters,). receiv tank mesh data (number particles, density, viscosity, numer parameters,) client. tcl wait gener input file necessari aquagpusph particl file fluid data file. gener necessari variabl calculation. close python initi script tcl wait batch file execut aquagpusph gener input files. aquagpusph python script defin problem. connect aquagpusph main program commun seafem. end initi process return seafem executable. wait seafem connect aquagpusph p y t h o n m p ro g ra m s cr ip t seafem end initi start time-loop. python wait s e f e m t im e lo o p s e f e m n e e d s e xt e rn l fo rc e s fr o m q u g p u sp h . c ll t c l s ta rt s te p p ro ce ss t c l s ta rt s te p p ro ce ss tcl wait aquagpusph us receiv movement t=n calcul t=n-1 t=n. q u g p u sp h t im e lo o p tcl get forc t=n aquagpusph send seafem tcl interfac forc t=n. (for t=0, send hydrostat forc only). tcl send seafem extern forces. end start step process python wait seafem extrapol load t=n+1 us bodi dynam solver obtain bodi movement t=n+1 s e f e m c ll t c l e n d s te p p ro ce ss t o s e n d m o ve m e n ts t o q u g p u sp h t c l e n d s te p p ro ce ss tcl get movement t=n+1 seafem tcl send movement aquagpusph. end end step process python receiv movement t=n+1. s e f e m e n d s th e t im e lo o p n d f h e s p ro b le m b y ls o c ll g t h e t c l e n d p ro b le m p ro ce ss t c l e n d p ro b le m p ro ce ss tcl commun aquagpusph problem finish finish calculations. tcl shut connect aquagpusph aquagpusph receiv commun seafem end proce stop calculations. figur 2: commun scheme. 16 figur 3: rigid bodi movement refer systems. 4.2. coupl algorithm kei point work coupl solver carri out. aforementioned, solver run time domain. therefore, coupl base exchang data tabl 1 2 specif time step running. time step requir sph solver (tsph) stabil criteria usual order 10 1000 time smaller time step seakeep solver (tfem), depend case study, grid resolut number particles. then, explicit stagger approach select adequ coupl solvers. scheme summar next: 1. load calcul intern flow solver = sent seakeep solver. 2. seakeep solver extrapol load intern flow solver = ( + 1) point lagrang polynomial. 3. seakeep solver calcul movement = ( + 1). 4. seakeep solver send movement intern flow solver = ( + 1) . 5. intern flow solver run = = ( + 1) interpol bodi movement sent seakeep solver ( + 1) . 17 figur 4 provid detail coupl algorithm implement seakeep intern flow solvers, forc moment sent seakeep solver respectively, extrapol forc moment respectively, linear angular movement intern tank respectively, linear angular veloc intern tank respectively. figur 1 show extern forc moment introduc bodi dynam solver begin time step, movement sent sph solver dynam solver converged. figur 4: intern flow-seakeep coupl algorithm. 18 5. valid 5.1. barg water tanks. 5.1.1. case descript order valid present coupl intern flow-seakeep solver, experiment result obtain molin et al. (2002) compar with. experi consist studi seakeep respons barge-lik ship, tank extend rel larg model. tank mid-ship transvers dimens close model breadth. figur 5 show barg layout tank figur 6 show unstructur mesh seakeep solver present case study. mesh size float line 2.5 cm, total 236,144 tetrahedr element used. figur 5: barg tanks. 19 figur 6: fem mesh. 5.1.2 case 1: water level tanks. case studi analyz water level 19cm tanks. achiev target draft 10.8cm, addit mass 40kg ad deck barge. tabl 3 provid particular barg includ addit mass. roll valu provid molin et al. (2002). numer simul carri free sway, heav roll order better approxim experiments. tank fill water level, movement occur oyz plane, tank simul second assum behav equally. figur 7 repres experiment result case studi tank fill water level (19 cm). roll rao experi obtain spectral analysi irregular motion tests. wave spectrum jonswap particular provid tabl 4. 20 tabl 3: barg main particular includ addit mass 40kg deck. length 3 m breath 1 m target draft 0.108 m displac 275kg xg 0 m yg 0 m zg 0.14 m radii gyrat respect g: rxx 0.3704 m figur 7: experiment result obtain molin et al. (2002) [34]. tabl 4: jonswap spectrum experiments. peak enhanc factor 2 signific wave height hs 6.6 cm peak period tp 1.6 s 21 5.1.2.1 monochromat wave test first, calibr roll damp account viscou effect carri out. monochromat test wave amplitud 2 cm wave frequenc = 4.026 rad/s, reson appears. test carri 105 particl 11% critic roll damp necessari reproduc rao valu experiments, larger 8% critic damp ludvigsen et al. (2013). secondly, test carri check effect increas number particl sph solver. select wave frequenc = 5.984 rad/s, correspond second reson frequenc figur 7. case simul includ damp factor c = 0.114ixxk44 , ixx roll inertia barg plu weights, k44 roll hydrostat restor coefficient. tabl 5 provid roll amplitud obtain case. amplif factor converges, slowly, valu 2.7. tabl 5: roll amplitud rad/m monochromat test cases. number particl rao roll [rad/m] 10,000 2.29 35,000 2.45 100,000 2.55 250,000 2.60 500,000 2.64 5.1.2.2 irregular wave test rao analysi test carri out. wave condit numer simul correspond jonswap spectrum similar characterist experi (see tabl 4). wave amplitud distribut mimic irregular wave condit experi provid appendix a. discret wave spectrum 51 frequenc 2.5 rad/ (thi frequenc resolut experiments). roll damp c = 0.114ixxk44 used. 22 figur 8 compar result obtain present work thousand particl experi calcul wadam ludvigsen et al. (2013) potenti flow approach account fluid dynam tank. observ wadam provid smooth curv results, experi present work bit nois obtain curve. believ sph approach fluid flow tank nonlinear, contribut energi transfer frequencies. figur 8: result comparison fem-sph coupl (present work), wadam ludvigsen et al. (2013) [35], experi molin et al. (2002) [34] water level tank (19cm+19cm). frequenc = 6 rad/s, experi larger valu obtain comput analyses. hand, result obtain work bit larger obtain wadam, compar experi frequenc awai = 6 rad/s. 23 5.1.2.3 comput time tabl 6 provid data comput effort need present approach. comput time correspond case present section 5.1.1. observ calcul fluid flow tank sph 3.5104 particl expens calcul seakeep behavior. furthermore, number particl bump 5105 solver take 98% calcul time. tabl 6: comput time number particl (ms) (ms) simul time (s) comput time (s) sph (%) fem (%) 10,000 1.17 10-3 10-2 30 1938 33.5 66.5 35,000 7.7 10-4 10-2 30 4109 68.4 31.6 100,000 5.4 10-4 10-2 30 13110 88.5 11.5 250,000 4.0 10-4 10-2 30 41577 95.5 4.5 500,000 3.2 10-4 10-2 30 98616 98.2 1.8 case present tabl 6, artifici speed sound sph set 10m/s, maximum particl veloc simul order 0.6m/s, keep mach number 0.06. 5.1.3 case 2: differ water level tanks. second case studi analyz case water level tank 19cm 39cm. addit mass necessari achiev target draft like previou case study. wave amplitud distribut mimic irregular wave condit experi provid appendix a. discret wave spectrum 101 frequenc rang 2.5 8 rad/ (frequenc resolut increas respect experi abl catch middl reson peak shown experiments). roll damp c = 0.114ixxk44 used. main particular barg case studi given tabl 7. 24 tabl 7: barg main particular addit mass deck. target draft 0.108 m displac 275kg xg 0 m yg 0 m zg 0.132 m radii gyrat respect g: rxx 0.414 m figur 9 compar result obtain present work experi calcul wadam ludvigsen et al. (2013). 105 particl 19cm fill tank, thousand particl 39cm fill tank. case study, reson peak appear. frequenc = 4 rad/ largest deviat numer experiment result found. but, frequenc = 5.25 rad/ appar deviat peak frequenc observ numer result sharp peak achiev similar valu experiment results. finally, frequenc = 7 rad/s, deviat frequenc observed, numer result predict peak value. figur 9: result comparison fem-sph coupl (present work), wadam ludvigsen et al. (2013) [35], experi molin et al. (2002) [34] differ water level tank (19cm+39cm) 25 5.2 antirol tank analysi bai rhee (1987) provid experiment raos, obtain model basin, suppli vessel equip anti-rol tank (art). later on, kim et. al (2002) kim et al. (2007) carri numer simul modifi s175 hull order compar result experiment data provid bai rhee (1987). modifi s175 hull kim et. al (2007) approxim suppli vessel bai rhee and, despit it, result obtain kim et. al (2007) numer show trend experiment ones. work, follow kim et. al (2007) approach modifi s175 hull approxim suppli hull bai rhee (1987). aspect ratio beam length, draft length kim et al. (2007), modifi s175 hull art. however, inform exact geometri found, posit graviti center inertias. therefore, estim paramet hull form. start s175 hull form provid ittc web site. then, proceed scale ship fulfil aspect ratio provid kim et. al (2007). result geometri provid [6]. longitudin posit graviti center art estim longitudin posit buoyanc center. transvers posit set y=0 vertic posit graviti center roll radii gyrat estim approxim roll rao result art provid kim et. al. (2007). tabl 8 9 provid main particular hull form art work. figur 10 show modifi s175 hull art place. tabl 8: modifi s175 main particular art length perpendicular () 47.6 m breadth 13.7088 m draft 3.9984 m displac 1498.4 t xfp 23.8 m xap -23.8 xg -0.73 m yg 0 zg -0.25 m radiu roll gyrat rxx 6.26 m 26 tabl 9: particular art length 2. 8 m breadth 13.699 m draft 2.4 m fresh water fill 50 % xt (mid tank) -0.73 m yt (mid tank) 0 m zt (base tank) -1.8564 m figur 10: modifi s175 hull art. roll rao obtain seri test monochromat wave normal respect maximum wave slope ak, wave amplitude, k wave number. damp factor c = 4ixxk44 calibr rao valu near resonance. 27 figur 11 compar experiment result obtain bai rhee (1987) numer result obtain work result shown art. 104 particl sph solver art sph simulation. modifi s175 calibr similar behavior suppli vessel bai rhee art, observ compar rao result art. insert art result tend on obtain bai rhee similar reduct roll movements. figur 11: experiment vs present work. roll rao monochromat wave test a/l = 0.005. roll rao obtain maximum wave slope ak. figur 12 present snapshot modifi s175 hull art reson wave frequenc case art. observ roll motion small, fluid flow insid art nonlinear, exhibit wave break phenomena. 28 figur 12: snapshot modifi s175 srt l/g = 1.55 a/l = 0.005. 5.3 2d vessel includ intern flow zhao et al. (2014b) carri seri two-dimension model test studi hydrodynam perform float liquefi natur ga (flng) section includ intern flow oscillations. refer flng section ballast fresh water equival solid weight respectively, clarifi coupl effects. rao motion respons intern slosh flow calcul base measur data. particular vessel section, intern tank, complet model provid tabl 10-12, figur 13 show 3d fem mesh model simulation. tabl 10: particular intern tank tank scale model scale length (m) 40 0.8 breadth (m) 10 0.2 water level (m) 18 0.36 mass (kg) 7.2 e+06 57.6 zg (m) -4.72 -0.0944 inertia respect tank cg ixx (kg m2) 1.15 e+09 3.69 radiu roll gyrat rxx (m) 12.7 0.25 29 tabl 11: particular vessel section section scale model scale length (m) 50 1 breadth (m) 17.5 0.35 mass (kg) 4.805 e+06 38 zg (m) -1.0473 -0.021 inertia respect section cg ixx (kg m2) 1.027 e+09 3.287 radiu roll gyrat rxx (m) 14.621 0.2924 tabl 12: particular complet model complet model scale model scale draft (m) 13.72 0.2744 mass (kg) 1.20 e+07 96.04 zg (m) -3.25 -0.065 inertia respect complet model cg ixx (kg m2) 2.22 e+09 7.1054 radiu roll gyrat rxx (m) 13.6 0.272 figur 13: fem 3d mesh 2d cross section. 30 white nois spectrum, energi densiti approxim experiments, carri simulations. consist 51 frequenc equal space min = 0.3918 rad/ max = 16.6165 rad/s, wave amplitud = 0.14 m. all, uncoupl simul equival solid weight carri calibr damp coefficients. compar solid weight experiment result (see figur 14, left), damp coeffici estim c33 = 0.24mk33 heave, c44 = 0.0554ixxk44 roll. secondly, coupl simul carri 104 particl tank. rao comparison provid figur 14 (right). overall, result obtain work fit experiment result provid zhao et al. (2014b). differ appear reson frequenc roll, experiment setup enforc 2d condition, fulli simul comput model. besides, numer result coupl problem show peak valu frequenc reson frequenc uncoupl problem. effect present experiment results, observ previou case studi antirol tank. appear peak surpris appear questionable. 1. conclus work, sph flow solver fem seakeep solver coupl perform simul seakeep dynam intern flow tank simultaneously. solver run independ timedomain, coupl algorithm, includ commun strategy, developed. sph-fem coupl show effect solv seakeep dynam coupl intern flow includ sloshing. valid case avail experiment data, provid good agreement. specif case studi modifi s175 hull antirol tank, slosh effect observed, good agreement found, demonstr capabl incorpor highli non-linear phenomena. result, propos coupl strategi capabl perform complex seakeep analysi coupl highli non- linear intern flow reason comput times. coupl solver appli futur work solv realist problem includ lng transport analysi complex slosh phenomena differ sea conditions. 31 figur 14: experiment versu present work. rao comparison. solid case left, liquid (coupled) case right. acknowledg research lead result receiv fund spanish ministri economi competit grant tra2013-41096-p (optimizacin del transport ga licuado en buqu lng mediant estudio sobr interaccin 32 fluido-estructura) ene2014-59194-c2-2-r (x-sheaks: campaa experiment y validacin). author gratefulli acknowledg support nvidia corpor donat tesla k20 gpu research. refer antuono m., colagrossi a. marron s., numer diffus term weakly-compress sph schemes, comput. phys. commun. 183, 2012, 5702580. antuono m., marron s., colagrossi a. bouscass b., energi balanc -sph scheme, comput. method appl. mech. eng. 289, 2015, 209226. bai k.j. rhee k.p., roll-damp tank test. project report, 1987, seoul nation university. bouscass b., colagrossi a., souto-iglesia a. cercos-pita j.l., mechan energi dissip induc slosh wave break fulli coupl angular motion system. i. theoret formul numer investigation, phys. fluid (1994present) 26, 2014a, 3. bouscass b., colagrossi a., souto-iglesia a. cercos-pita j.l., mechan energi dissip induc slosh wave break fulli coupl angular motion system. ii. experiment investigation, phys. fluid (1994present) 26, 2014b, 3. bulian g., souto-iglesia a., delorm l. botia-vera e., sph simul tune liquid damper angular motion, j. hydraul. res. 48 (extra issue), 2010, 2839. cai x., langtangen h.p., nielsen b.f. tveito a., finit element method fulli nonlinear water waves, j. comput. phys. 143, 1998, 544568. campbel p.m., new algorithm boundari valu problem smooth particl hydrodynamics, 1989, defens nuclear agency; usa. cercos-pita j.l., aquagpusph, new free 3d sph solver acceler opencl, comput. phys. commun. 192 (0), 2015, 295312. cercs-pita, j. l., bulian, g., prez-rojas, l., francescutto, a. (2016). coupl simul nonlinear ship motion free surfac tank. ocean engineering, 120:281288. cercs-pita, j. l. bulian, g. (2016b). cosimul ship motion slosh tanks. (under review) colagrossi a., antuono m. le touz d., theoret consider free-surfac role smoothed- particle-hydrodynam model, phys. rev. e (stat. nonlinear soft matterphys.) 79 (5),2009, 056701. 33 colagrossi a., antuono m., souto-iglesia a. le touz d., theoret analysi numer verif consist viscou smoothed-particl hydrodynam formul simul freesurfac flows, phys. rev. e 84, 2011, 26705. colagrossi a., souto-iglesia a., antuono m. marron s., smoothed-particle-hydrodynam model dissip mechan graviti waves, phys. rev. e 87, 2013, 023302. colagrossi a., bouscass b. marron s., energy-decomposit analysi viscou free-surfac flows, phys. rev. e 92, 2015, 053003. crespo a., dominguez j., barreiro a., gmez-gesteira m. roger b., gpus, new tool acceler cfd: effici reliabl smooth particl hydrodynam methods, plo 6, 2011, 6. leff m., le touz d. alessandrini b., normal flux method boundari sph, in: proceed 4th ercoftac spheric workshop sph appl. 2009, 149156. dominguez j.m., crespo a.j.c., valdez-baldera d., roger b.d. gmez-gesteira m., new multi-gpu implement smooth particl hydrodynam heterogen clusters, comput. phys. commun. 184, 2013, 18481860. ferrand m., laurenc d.r., roger b.d., violeau d. kassioti c., unifi semi-analyt wall boundari condit inviscid, laminar turbul flow meshless sph method int. j. numer. method fluid 71, 2013, 446472. herault a., bilotta g. dalrympl r.a., sph gpu cuda, j. hydraul. res. 48 (extra issue), 2010, 74 79. iron b.m. tuck r.c., version aitken acceler iteration, int. j. numer. method eng. 1, 1969, 275277. li y., zhu r., miao r. fan, j g., simul tank slosh base openfoam coupl ship motion time domain, j. hydrodyn., ser. b 24 (3), 2012, 450457. kim y., numer studi slosh flow coupl ship motionth anti-rol tank problem, j. ship res. 46 (1), 2002, 5262. kim y., nam b.w., kim d.w. kim y.s., studi coupl effect ship motion sloshing, ocean eng. 34, 2007, 21762187. kulasegaram s., bonet j., lewi w.r. profit m., variat formul base contact algorithm rigid boundari two-dimension sph applications, comput. mech. 33 (4), 2003, 316325. 34 ludvigsen, a., pan, z.y., gou, p., vada, t., 2013. adapt linear potenti theori solver outer hull account fluid dynam tanks. in: proceed asm 2013 32nd intern confer ocean, offshor arctic engin omae2013 june 914, nantes, france. ma q.w. yan s., qale-fem numer model non-linear interact 3d moor float bodi steep waves, int. j. numer. method eng. 78 (6), 2009, 713756. maci f., antuono m., gonzlez l.m. colagrossi a., theoret analysi no-slip boundari condit enforc sph methods, progress. theor. phys. 125 (6), 2011, 10911121. maci f., gonzlez l.m., cercos-pita j.l. souto-iglesia a., boundari integr sph formulation. consist applic isph wcsph, progress. theor. phys. 128 (3), 2012, 439462. molin, b., remy, f., rigaud, s., jouett ch., 2002. lng-fpsos: frequenc domain coupl analysi support liquid cargo motions. in: proceed inam conference, rethymnon, greece. monaghan j.j., simul free surfac flow sph, j. comput. phys. 110, 1994, 399406. neve m.a.s., merino j.a. rodrguez c.a., nonlinear model parametr roll stabil anti-rol tanks, ocean eng. 36 (14), 2009, 10481059. nishiura d., furuichi m. sakaguchi h., comput perform smooth particl hydrodynam simul shared-memori parallel computing, comput. phys. commun. 194 (0), 2015, 1832. servn-cama b. garca-espinosa j., acceler 3d multi-bodi seakeep simul unstructur finit elements, j. comput. phys. 252, 2013, 382403. souto-iglesia a., delorm l., roja l.p. abril s., liquid moment amplitud assess slosh type problem sph, ocean eng. 33, 2006, 1112. watai r.a., dinoi p., ruggeri f., souto-iglesia a. simo a.n., rankin timedomain method applic side-by-sid gap flow modeling, appl. ocean res. 50 (0), 2015, 6990. wood w.l., bossak m. zienkiewicz o.c., alpha modif newmark' method, int. j. numer. method eng. 5 (10), 2005, 15621566. yan, s., ma, q.w., cheng, x., 2011. fulli nonlinear simul float structur close proxim subject obliqu waves. in: proceed 21st intern offshor polar engin confer (isope). intern societi offshor polar engin (isope). zhao w.h., yang j., hu z.q. wei y.f., recent develop hydrodynam float liquid natur ga (fnlg), ocean eng. 38, 2011, 15551567. 35 zhao w., yang j., hu z. tao l., coupl analysi nonlinear slosh ship motions, appl. ocean res. 47 (0), 2014a, 8597. zhao w., yang j., hu z., xiao l. tao l., hydrodynam 2d vessel includ intern slosh flows, ocean eng. 84, 2014b, 4553. web refer [1] compassi (last accessed: januari 20th 2016): accessed: januari 20th 2016. [2] centr internacion metod numer en enginyeria (last accessed: januari 20th 2016): [3] cehinav res. gr., dmfpa, etsin, technic univers madrid (last accessed: januari 20th 2016). accessed: januari 20th 2016. [4] aquagpusph (last accessed: januari 20th 2016): [5] tcl (tool command language) [on-line] (last accessed: januari 20th 2016): [6] (last accessed: januari 20th 2016): (