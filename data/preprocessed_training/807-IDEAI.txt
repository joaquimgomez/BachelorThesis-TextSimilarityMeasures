tbme2554661.pdf 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 1 1 2 3 4 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 2 type 2 diabet screen test mean puls oximet enriqu mont moreno*, maria jose anyo lujan,monts torrr rusinol, paqui juarez fernandez, pilar nunez manrique, cristina aragon trivino, magda pedrosa miquel, marif alvarez rodrguez, m. jose gonzalez burguillo abstractin paper, propos method screen presenc type 2 diabet mean signal obtain puls oximeter. screen consist parts; analys signal obtain puls oximeter, second consist machine-learn module. consist end extract set featur form puls oximet signal. featur base physiolog considerations. set featur input machine-learn algorithm determin class input sample, i.e. subject diabet not. machine-learn algorithm random forests, gradient boosting, linear discrimin analysi benchmark. test databas 1, 157 subject (two sampl subject) collect commun health centres. mean receiv oper characterist (roc) area 69.4% (median valu 71.9% rang [75.4%61.1%]), specificity=64% threshold gave sensitivity=65%. present screen method detect diabet perform compar glycat haemoglobin (haemoglobin a1c hba1c) test, requir blood extraction, yield result minutes. index termstyp 2 diabetes; screening; machin learning; statist learning, boosting; photoplethysmography; signal pro- cessing; noninvas treatment. i. introduct current techniqu diagnos diabet base urine, glycat haemoglobin (haemoglobin a1c hba1c) oral glucos toler (ogtt) test [1], [2]. cases, test depend variat glucos level blood measur alter structur haemoglobin caus long exposur high level glucose. paper, propos method detect person diabet mean signal obtain puls oximeter. screen method advantages, diagnosi non-invas measur obtain puls oximetri requir work support spanish ministerio economa y competitividad, contract tec2015-69266-p. *enriqu mont moreno depart signal theori communications, universitat politecnica catalunya, campu nord, edifici d5, c/jordi girona, 1-3, 08034, barcelona, spain. author. tel.:+34 93 4016435;fax:+34 93 4016447. maria jose anyo lujan engin depart manager, synmed. avda. princip asturia 43, 08012 barcelona , espana monts torrr rusinol, paqui juarez fernandez, pilar nunez manrique, cristina aragon trivino, magda pedrosa miquel, marif alvarez rodrguez, m. jose gonzalez burguillo sap delta del llobregat. institut catala la salut (ics),c. rosell, 4-6. 08902 l hospitalet llobregat. spain laboratori analysi case urine, glycat haemoglobin, glucos toler test self-test hba1c kit requir blood sample. puls oximetri mean photoplethysmogram (ppg), give signal proport perfus blood dermis. paper, inform given ppg signal allow screen method detect presenc diabetes. paper structur follows: section ii, discuss physiolog properti reflect ppg signal. section iii, discuss signal process techniqu appli extract relev featur machin learn modul classification. section iv, justifi select machine-learn algorithms. section v, databas tested. section vii, present results, finally, section viii, discuss methodolog result work. diagnosi diabet establish measur plasma glucos [1], easi us screen method help identifi patient pre- diabet undiagnosed. accord survei 1988 1994 [3], preval diagnos diabet estim 5.1% u.s. adult population, preval undiagnos diabet 2.7%, mean person diabet undiagnosed. however, trend preval diabet increasing, accord [4], preval diagnos diabet 2050 7.2% (29 million persons). proport diagnos undiagnos diabet maintained, number undiagnos diabet million. england [5], preval grown 10% 2003 35% 2011. therefore, actual estim unreliable. case spanish population, nation studi [6] examin preval diabet impair glucos regul conduct 100 health centr 200910 5, 000 participants, preval diagnos diabet patient 7.8% percentag undiagnos diabet 6.0% (in cases, ci 0.7%). indic total 2.8 million persons. specif case region studi conducted, [7] preval rate known diabetes, unknown diabetes, impair glucos toler 6.4%, 3.9%, 11.9% men 6.9%, 3.4%, 11.9% women, respectively. us screen devic justifi increas preval type 2 diabet gener population. diagnosi criteria accord [1], 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 3 follows: symptom diabet causal glucos level greater 200mg/dl fast plasma glucos greater 126mg/dl plasma glucos level 2 h glucos toler test greater 200mg/dl criteria met repeat test, diagnost positive. earli diagnosi diabet important; accord [8] [9], half peopl meet diagnost criteria diabet undiagnosed, 12 year clinic recognition, patient diagnosed, 25% establish retinopathy, 50% clinic evid diabet tissu damag addit cardiovascular risk factors. advantag method propos paper reduct cost wide spread screen alert undiagnos diabet prediabet states. [10] cost identifi case $176 $236 (u dollar 2003, compar differ screen methods), correspond medic cost includ laboratori tests, personnel time, materi cost exclud non- medic cost transportation, time spent traveling. interestingly, author defin cost total cost detect divid total number case identified. test propos improv ratio test cost effect easi use. cost consist price puls oximeter, softwar run standard pc, usual avail test point purposes. need reagents, measur mechan simpl involv measur minut signal, need specialis technician. clinic implic method allow fast inexpens wai screen diabetes. state [11], shift glucos diagnost criteria hba1c, profound impact diagnosi diabet resources, time, cost need 2-h plasma glucos and/or fast plasma glucos diagnost test. method propos paper slightli lower perform hba1c test need reagents, allow test point care (e.g., doctor offic pharmacy), need blood extraction, result known immedi cost devic extrem low. allow test patient tested, need blood extraction, cost test, fact routin medic check tend short. clinic benefit come fact alternative, base glycat haemoglobin, give indirect indic chang structur haemoglobin, depend diet patient follow previou months. therefore, method propos depend diet, fals neg result diet patient followed. addition, explain section ii, underli measur relat alter cardiac arteri system, result test propos paper indirect indic extent diabet diseas harm cardiac patient. ii. physiolog factor explain extract featur section, justifi us signal obtain photoplethysmogram (ppg) measur indirectli hemodynam presenc hyperglycaemia damag produc diabet given subject. ppg give signal proport pressur puls cardiac cycle, shape puls influenc differ paramet arteri hemodynam state person. physiolog paramet affect dia- bete heart rate variabl (hrv) [12]. appendix give summari hrv measured. hrv statist chang presenc durat diabet allow characteris sever disease. [12] linear relationship hrv, durat diabetes, age; i.e., hrv decreas addit year, case diabetes, decreas larger proport durat disease. figur 1 [12], list exampl hrv compar hrv control individu patient diabetes, show sharp contrast variabl healthi diabet patients. assumpt work hrv deriv ppg waveform. assumpt back previou result literature. [13] test relationship hrv measur electrocardiogram record signal obtain ppg. check agreement statist tool conclud measur obtain mean ppg signal accur enough. paper, relev test show rr interv ecg align pp interval. addition, [14] author conduct extens review accuraci estim hrv puls rate variabl (prv), measur ppg. compar 32 publications, take account factors, prv accur healthi subject rest, discrep appear result physic mental stress, variabl somewhat overestim prv, reflect coupl effect respir cardiovascular system. assumpt work featur ecg infer ppg waveform process signal. instance, [15], simultan measur ecg ppg signal show correspond waveforms. mention above, [14] provid thorough summari literatur refer us comparison ppg technolog ecg. studi consid relat reliabl comput hrv ppg surrog ecg, show relationship systol peak diastol minima featur puls wave signal, allow differ puls interv substitut rr interval. strong assumpt make paper, plausibl support literature, that, ppg signal, processing, obtain surrog 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 4 q, r, t point pqrst complex ecg. surrog provid inform relat differ point ecg, us fact interv point reflect alter caus diabet disease. hand, empir paramet propos surrog improv classif rate. us paramet justifi follow- ing facts. instanc [16], show episod hypogly- caemia induc abnorm cardiac repolarisation, includ- ing lengthen qt interval, qt dispers normalis qtc, defin ratio qtc = qt/rr, dispers respect fraction rr interval. addit [17], show hypoglycaemia creat electrophysiolog alter caus pr interv shortening, st -segment depression, t -wave flattening, reduct t -wave area, qtc-interv prolongation. [18], that, children adolesc type 1 diabetes, qtc lengthen (note that, paper, correct qt interv defin qtc = qt/ rr), interest aspect that, increas length qtc, rang interv increas maximum valu 4 time mean value. contrast healthi individu [19], qtc prolong normal conditions, although, eat carbohydrate-rich meal effect hyperglycaemia temporarili increas qtc interval. ecg paramet alter flatten t wave, st -depression, pqt intervals, durat qr interval, justi- fi search surrog estim pqrst points, characterist shape wave form amplitud durations. find coincid framingham heart studi [20] that, epidemiolog point view associ hyperglycaemia reduc heart rate variability, effect especi mark diabetics. paper author suggest alter heart rate variabl caus presenc abnorm neural regulatori mechanisms. mechan explained, instanc [21], state cardiovascular autonom diabet neuropathi common diabetes-associ complic chang heart rate variabl earliest symptom, symptom diabet appear. studi coincid find heart rate variabl decreas function time case patient diabetes. interestingly, neural regulatori mechan affect presenc diabet control paramet affect shape ppg signal, blood pressur respir ( [21] [22]). iii. signal process ppg waveform record mean contec cms50d+ pulsi oximet usb connect standard desktop (for details, appendix b). total durat record minut follow stabilis signal. signal process modul consist submodules: activ detect module, purpos ensur qualiti signal, sens reject record signal low amplitud bad quality, caus movement subject incorrect placement puls oximeter. second process signal extract featur relev discrimin diabet non-diabet subjects. initi version high number candid featur set (about 110), reduc exploratori phase. avoid introduc signific biases, author decid featur select train machine-learn modul (see section iv) commun health centres, test fourth fifth. descript demographi commun health centr section v. shown result section vii, select featur introduc strong bia results. possibl valid strategies, author consid natur unit partit data commun health centre, strategi mix unknown confound variabl similar real-world situation. criterion select relev featur rank given random forest algorithm [23] backward featur select techniqu [24] classifi random forest algorithm gradient boost algorithm (see section iv justif select classif algorithms). note that, random forest common methods, criterion rank different; intern rank random forest algorithm base permut valu input features, backward featur select greedi search tri combin features. result rank consistent, set select subset featur present subsect iii-b. select set featur describ section iii-b, consist sets, ad total 69 featur input vector machine-learn algorithm. filter phase candid features, rel rank select featur flat, result fact that, rank take featur itself, member set featur appear mix coincid rank class features. addition, rank chang chc cross valid done. a. activ detect algorithm activ detect modul (adm) base finit state automaton implemented. activ detect algorithm guarante record signal suffici quality. detail activ detect modul describ [22]. criterion select one-minut analysi window trade-off fact short-term hrv roughli estim record minut (see apendix a) oper restrict (the time slot recordings) normal function commun health centr sampl collected. total number sampl analysi window 3, 600, correspond minut sampl rate 60 samples/second. adm 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 5 consist local classifi oper frame second (300 samples) local decis class signal/not signal. classifi decis featur kaiser teager energy, qi-zheng energy, spectral entropy, zero cross rate. local decis finit state-automaton state simpl rule decid signal correct record discarded. b. featur extract featur extract ppg signal obtain adm, vector 3, 600 length. denot signal x[n]. extract featur relat gener shape ppg signal heart rate variabl statistics. process extract features, ppg signal filter mean median 1d filter length 5 remov spuriou peaks. low-pass filter mean chebyshev filter type 2 order 7, cut-off normalis frequenc 1/8, 40db stopband, subsequ signal filter simpl pre-emphasi high-pass filter impulsion response: hpreemp[n] = [n] 0.98[n 1] (1) pre-process gave cleaner signal clearer systol peaks, diastol minima (which denot onset systole, slope points) presenc dicrot notch [14]. featur us process subsect iii-b2. 1) cepstral analysis: section, featur obtain cepstral analysi gener shape ppg signal. cepstral analysi characteris hrv [25] [26], specif case diabetics. us cepstral analysi allow better distinguish lf hf compon represent fewer parameters. advantag cepstral analysi transform convolut addit [27], allow rough separ inform concern state arteri cardiac excitation. note emphasis partial information, ppg signal give incomplet represent state circulatori system. short-term cepstrum. us short-term cepstrum justifi fact captur specif trait shape ppg signal mean coefficients. comput short-term cepstrum signal [27], signal x[n] divid frame xi length lframe = 240, overlap 50%, give sequenc nf frames, index indic frame number xi = [ x [(i 1) lframe] , x [(i 1) lframe + 1] , . . . , x [i lframe] ] (2) frame, cepstrum comput follows: csti = ifft (log (fft (xi))) (3) channel compon cepstrum correspond cepstral coefficients, retain nstcep = 10 coeffici mean cesptrum, denot reduc cepstral vector cri ci[1 : n st ceps]. finally, input featur correspond cepstrum defin mean valu frame cepstrum vector. cstmean = 1 nf nf i=1 cri (4) comput mean cepstrum justifi fact characteris state arteri patient mean approxim impulsion respons relat heart signal final observation. given xi understood vari excit convolv channel cepstrum transform convolut mix addition, mean valu unvari part, correspond channel. idea speech process determin spectral characterist channel [28]. long-term cepstrum. us long-term cepstrum justifi fact captur inform evolut shape ppg signal excitation, reflect period repetit basic shape signal. note that, contrast short-term cepstrum, long term averag cepstrum values. cepstrum given time seri consist addit convolut term gener observ signal x[n]. excit channel correspond differ cepstral coefficients, featur n ltcep = 20 coeffici cepstrum comput observ vector x[n]. cltglob = ifft (log (fft (x))) [1 : n lt ceps] (5) number coeffici retain case decid author inspect examples. zero cross rate cepstrum. wai captur hrv comput cepstral coeffici zero cross point x[n]. coeffici gener shape evolut period compon signal. denot featur czc, correspond nzccep = 10 cepstral coeffici distanc zero cross point xmean(x). gener comment cepstrum analysis. initi experiments, determin featur relevant, us lpc-cepstrum gave wors perform fast fourier transform (fft) base cepstrum, discarded. similar occur raw lpc coeffici line spectrum pair (lsp) coefficients, discarded. note 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 6 select number coeffici correspond implicit cepstral liftering, i.e., multipli cepstral sequenc puls shorter duration. us addit lifter function, ramp, improv performance, explain fact base classifi decis tree (see section iv), local decis node mean comparison, scale individu coeffici affect result. 2) surrog paramet : section ii, justifi us paramet ecg determin subject diabetes. section, present featur (indirectli relat ecg signal) allow distinguish subject diabetes. import rememb posit featur ecg reflect ppg signal. featur ecg rr distance, ppg signal x[n] correspond distanc systol peaks. rr distanc peak x[n], creat new vector denot xrr[n]. element xrr[n] distanc (in samples) peak x[n]. addition, determin featur ppg signal, record posit peaks, denot xpos[n]. ratio low-frequ high-frequ (hf ) energies. ratio low-frequ high-frequ energi hrv, comput fft length nfft (greater length signal xrr[n]) follows; xrr = fftnfft(xrr[n]) (6) xrr, comput energi hf lf bands. band case defin normalis frequenc (i.e., sampl frequenc correspond 1.0) 1 follows: lf = [0.0, 0.1] hf = [0.1, 0.2]. feature, took ratio sum absolut valu bin lh hf interv xrr, ratiolh2hf = 0.1nfft k=0 | xrr[k] |0.2nfft k=0.1nfft | xrr[k] | (7) posit highest peak rr cepstrum rr featur extract vector xrr[n], normalis frequenc correspond highest peak xrr coeffici cepstrum xrr[n] signal. featur denot follows: pospeakrr cepsrr. surrog featur next, surrog pqrst point ecg signal, creat vector contain inform critic point ppg signal. vector gener pre-process signal x[n] filter steps. first, x[n] filter mean high-pass filter emphasis point maxim slope maxima minima signal. 1note ambigu definition, follow definit given [29], differs, instance, matlab, normalis frequenc defin half sampl frequency. contrast [27] us normalis radian frequencies. filter hder[n] = [n] [n 2], yield xhpass[n] = x[n] hder[n]. next, sequenc xhpass[n] filter zero-phas [29] low-pass filter cut-off frequenc 0.05, (chebyshev filter type 2 order 8). low-pass filter design preserv maxima/minima xhpass[n] critical/turn point x[n]. new signal denot xcrtpnts[n]. low-pass filter zero phase, rel delai x[n] xcrtpnts[n] samples. therefore, vector xpos[n], infer posit r peak vector xcrtpnts[n]. align r point allow consider neighbour peaks. maxima/minima surrog real set point pqrst . note that, distanc peak obtain roughli consist distanc ecg, claim correspond points. claim plausibl explan surrog allow discrimin subject diabetes. statist deriv point informative, sens contribut discrimin classes. discuss section ii, known statist relat interv qt qtc relev problem hand. determin categori critic point xcrtpnts[n]. obtain immedi preced minimum peak xcrtpnts[n] align r point given xpos[n], posit correspond surrog q point, second obtain immedi follow maximum posit correspond surrog t point. statist relat peak immedi follow r peak, surrog s, discrimin information. set featur elabor distanc statist surrog interv qt , qtc = qt/ rr, qs, consist vector mean, median, inter-quantil range, absolut mean deviation, standard deviation, range. featur denoted, respect qtc stats, qs stats. demograph features. gener vector set demograph features, weight (w), height (h), ag (a), gender (g), bodi mass index (bmi), bodi fat percentag (bf). us bodi fat percentag justifi fact bodi fat predictor non-insulin depend diabet mellitu (see [30]). bf variabl comput formula adult given [31]. formula bf% = 1.20 bmi+0.23 ag 10.8 sex 54. inform subject smoke because, database, inform miss 20% records. vector demograph inform construct follows: xdemo = [w,h,a,g,bmi,bf ] (8) 3) final featur vector : final featur vector consist aggreg partial features, defin 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 7 follows: globalfea = [c st mean, c lt glob, czc, cepsrr, ratiolh2hf,po peak rr , qt, qtc stats,q stats,xdemo] (9) vector input machine-learn module. c. featur import state begin section, initi set variabl higher final used. note 9 differ categori features, rank 69 individu featur partial mixed, i.e. rank cluster variabl specif categories. hand, inform real impact categori featur import reproduc improv method. product random forest method score associ- at feature, proport degrad perform data given input permuted, maintain featur intact. degrad perform comput bag errors. allow rank variables, obtain rank score category. decid us perform index categori mean valu score variabl given category. rank categori following: 1) short term cepstrum 2) long term cepstrum 3) zero cross rate cepstrum 4) ratio low frequenc high frequenc (hf) ratio energi 5) posit highest peak rr cepstrum rr 6) surrog featur 7) demograph featur featur import comput initi 69 features, mean discount total effect categori variables. fact demograph featur import level singl feature, confirm empir experi us categori features. degrad perform rang 2% 4% roc, depend chc. also, believ better estim surrog featur increas durat recordings, improv perform rank categori features. reason justifi section ii. iv. machin learn modul test differ machine-learn algorithms: random forest (rf ) [32] gradient boost (gb) [33]. benchmark, took linear discrimin analysi classifi (lda) (see [23] chapter 4). reason select classifi rf gb, base classifi techniqu classif regress tree (cart), allow us raw featur specif rescal transform featur [23]. robust heterogen type featur wai cart algorithm decid output class. algorithm make local decis compar valu given featur threshold, comparison independ node features. featur vector compos featur differ origin, differ statist properties, us cart techniqu base classifi justified. contrast, linear discrimin analysis, logist regression, neural nets, support vector machin sensit coding/sc features. common characterist rf gb robust collinear input features. contrast rf gb machine-learn algorithms, mention above, input data normal whiten sensit learn algorithm correl data unbalanc ranges. rise ever-increas valu paramet regularis step taken (see discuss [24] [23]). extrem valu paramet poor perform generalisation. addition, numer algorithm prone instabl input vari correl way. case neural network (multilay perceptron) lda, collinear rise extrem valu weight regularis techniqu applied. case radial basi function (neural networks) support vector machin base radial basi functions, collinear give rise need high number units, need model dispers data certain directions. relat collinear effect fact featur inform common, case nearli repetitions. decis tree fairli immun degrad caus effects, simpli algorithm case select node variabl local give best improv gini factor. creat scatter plot input features, detect empir effect present database. a. random forest comment algorithm program author matlab. algorithm differ hyper-parameters, as: 1) number sampl leaf, 2) number featur test node, 3) number tree forest. differ combin paramet explor cross valid train databas test chc, best result coincid recommend breiman [32], sampl leaf, case one, number featur test node, equal squar root total number featur (use base 10 logarithm gave similar results). perform stabilis 600 trees, increas number tree improv perform algorithm. 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 8 b. gradient boost comment algorithm program author matlab take base classifi decis tree algorithm follow descript [33]. free paramet algorithm set cross validation. littl differ valu hyperparamet differ experiments, set follows. cost function mse, sub-sampl train databas fraction 0.75, improv perform comparison sub-sampling. regularis paramet (shrinkag factor) set v = 0.005. size tree select j = 10 number iter m = 1500. v. descript data data collect commun health centr (chcs) barcelona spring 2013, flu season end [34]. chc, sampl collect approxim 250 patients, gave inform consent. patients, record (i.e., ppg measurements) done. particip studi patient routin blood extract chc. explicit exclus criteria, busi moments, sampl studi taken. uniform chc composit chc demograph possibl confound variables. justifi fact that, evalu (see section vii), decid chc unit validation. take chc unit partit training, validation, testing, possibl bias confound factor specif chc mixed. ensur partit valid, section demograph distribut chc uniform. total number patient 1, 170, 340, (29.06%) diabet 830 (70.94%) diabetic. proport diabet non-diabet differ chcs, shown tabl ii, group similar chc i.e., (1,2, 3, 4) outlier higher proport diabetics, i.e., chc 5. regard gender differences, occurr diabet higher men; tabl i. fact subject type ii diabet establish medic record. note that, sample, number case non-diagnos diabet pre-diabet patients. introduc bia rate fals neg certain number sampl wrong label. fact wrongli label diabet patient mean sensit specif test, train perfectli label database, perform better. design databas guarante diagnos diabet truli diabet proport diabet non-diabet repres real situat chc. contrast, number recruit patient high diagnosi expensive, accept number non-diagnos diabetics. uncertainti number wrongli label case rang 49 830 (6% preval gener population). data collect commun health centr patient routin blood extractions, expect rate undiagnos diabet pre-diabet low undiagnos diabet correspond patient blood extract previous visit doctor medic problems. therefore, diabet symptomatolog evident, doctor taken action. bodi mass index diabet non-diabet similar chc shown tabl iv. histogram bmi shown figur 2, show mean valu inter-quantil rang higher case diabet patients. gener weight histogram shown figur 3, show distribut similar, differ caus except outlier case non-diabetics. tabl iii, percentag smokers. global mean 16.18% proport diabet subject smoke lower case non-diabetics. proport broken centr inform lack chcs. distribut smoker (diabet non-diabetic) equal chc point difference. fast distribut glucos level mg/dl shown figur 1, show that, mean histogram diabet subject 25% higher, interestingly, mode (i.e., like value) populations, 90 mg/dl 2. differ mean come fact tail distribut case diabet subject longer. inter-quantil rang (iqr, i.e., valu lower 25% upper 75%), case histogram diabet subjects, doubl compar case non-diabetics. ag distribut diabet popul non-diabet popul similar; shown figur 4, mean inter-quantil rang same. differ mode higher case non-diabet histogram. section, shown signific demograph differ diabet non-diabet group relat fast level glucos chc similar demograph structures. vi. methodolog issu design experi (see, instance, [35]), kei point obtain reliabl statist deal con- found factor control experiment. confound factor common differ natur 2note abscissa scale. 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 9 divis experi (in case chc), 10-fold cross-valid correct, sens reduc variabl caus non-control confounders, mean confid margin accurate. study, aggreg individu regardless chc test set individu mix chc result 10-fold cross-valid better, yield upward bia roc points, i.e., mean roc area 77.3%, standard deviat 3.4%, 7 point better result obtain factor chc (for comparison purposes, tabl v). case, confound factor think uniform chc profession, ag distribut nation origin patient. inform avail comput perform take account differ factors. therefore, instead random partit 10-fold cross- validation, decid chc unit comput mean variability, i.e., rotat train chcs, test remainder. partit databas allow determin rang mean caus specif confound factor test databas present train database. result shown tabl v figur 5 ,6 7. adjust paramet classifi 10-fold cross-valid chc train databas (i.e., valid databas extract train data). note us cross valid determin paramet classifi mix confound factor present test database. partit databas allow determin rang mean specif confound factor test databas present train database. note sampl subjects, alloc sampl train valid databas base subject index, i.e., mix sampl individu differ databases. explain find fact chc similar term differ aspect discuss section v, condit specif chc bias results. believ test differ chc give better (more realistic) estim perform unseen population, better estim variability. vii. result data process explain section iii, test differ classifiers: rf, gb, lda. criterion determin qualiti result receiv oper characterist (roc) area [23], allow assess trade-off sensit specificity. roc area defin lower area curv relat sensit (true posit rate) fals posit rate (true neg rate 1.0-specificity), vari decis threshold classifier. is, given threshold determin sensit specif classifier. 3 result correspond roc area obtain classifi present tabl v, roc figur rf gb algorithm shown figur 6, 5 7. algorithm rf gb yield similar results; i.e., roc area shape roc figur similar, perform chc vari percentag points. note lda classifi gave systemat lower valu classif results. result chc 3 5 lower fact demograph differ chcs. viii. conclus paper, present method screen diagnosi diabet base signal obtain ppg. advantag method fast test, result obtain minutes, price low need ppg sensor comput low-cost smart phone. note procedur consist obtain sampl puls oximet signal minut duration, requir qualifi personnel, process (includ comput results) take minut (includ possibl repetit measure). contrast plasma glucos measur glycat haemoglobin tests, requir extract blood sample, laboratori measurements. measur glycat haemoglobin faster oral glucos toler test (ogtt), cost 13 time higher [36]. issu relat us glycat haemoglobin fact low valu hba1c exclud diabet [37], mean specif method increas test popul risk two-hour ogtt text instead ogtt [37]. contrast, roc area method propos paper 70% (mean chcs), which, depend threshold (see figur 6, 5 7), sensit (true posit rate), 80% specif (1-fals posit rate) 48%. result slightli lower result obtain glycat haemoglobin valu report [38] [39], [40] 4. next, compar sensit specif obtain mean glycat haemoglobin test report mention studi specif method decis threshold set sensit point (note result percentag round down). 3note roc area independ proport sampl class. number sampl non-diabet class, higher diabet class, experi assign label non- diabet patients. result sensit 100%, specif 0% (100% rate fals positives), roc area 50%, precis (posit predict valu class diabetic) 30%. 4note studi differ popul differ continents. 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 10 [39], report level hba1c 7.0% sensit 36% specif 100%. method sensit 36.0% gave specif 84%. [38], report level hba1c 6.1% sensit 65% specif 88%. method sensit 65% gave specif 64%. [40], report level hba1c 6.5% sensit 72% specif 66.5%. method sensit 72% gave specif 57%. comparison perform indic perform depend preval diseas underli population. note specif sensit screen method depend specif techniqu prior probabl test individu disease. sensit specif given test differ test gener popul hospit medic office. case, prior probabl population, probabl bias case disease. [38] study, size studi sampl 1, 972 subjects, nearli twice size sample, 15.4% diabet (in study, preval 35.72% men 23.81% women). lower preval diabet explain fact that, sensitivity, specif hba1c better. however, studi com- parabl sens popul sampl chc citi north india. [39] conduct meta- analysi 34 differ studies, popul consist 8, 984 subjects. case, studi directli compar relat underli population. [40] conduct 315 patients; popul compar present study, number patient number patient present study. result comparable, perform method slightli lower. explain fact target popul studi patient routin blood extract chc expect test presenc diabetes. result prior probabl studi patient diabet lower studi target popul select base risk diabetes. possibl explan low specificity. fact prior probabl report diabet 28%, increas rate fals posi- tives. epidemiology, known perform screen techniqu depend greatli prior probabl target class sensit specif test degrad greatly, target class detect low frequenc occurrence. fact percentag undetect diabet gener population, label diabet case given clini- cal record chcs, report previous diagnos cases. 2014 nation diabet statist report [41], state that, usa 27% popul diabet undiagnosed. proport similar spain, explain fact higher percentag fals posit method. indic perform screen method improv databas accur labelled. variabl screen method infer tabl v, mean roc valu 70% standard deviat 6%. statist come chc, better measur perform median valu 72.9% rang [78.7% 59.5%], 19.2%. believ variabl repres sens that, chc similar respect age, bmi, weight, smoke habit (see section v), observ variabl correspond underli factors, difficult measur standard setting. appendic a. heart rate variabl heart rate variabl (hrv) consid marker reflect sympathet vagal function autonom nervou system. follow summari base [42] [43]. hrv defin variat instantan heart rate rr intervals. measur correspond interv consecut beat characteris time domain frequenc domain. alter hrv relat autonom neuropathi diabet patients, foetal distress, higher risk post-infarct mortality. hrv affect factor ag (diminish age), medication, circadian rhythm, etc. common option measur hrv variat five- minut record short term variabl measur 24 hour record long-term variability. time domain measur squar root mean squar differ success rr intervals, number interv differ success rr interv greater 50ms, proport interv greater 50m total number intervals, measur relat histogram rr interval. frequenc domain measur relat rel energi signal differ bands: low frequenc (vlf), low frequenc (lf), high frequenc (hf). relationship lf hf compon relat chang autonom modul heart period. vlf compon studi compon estim reliabl long record (24 hours), hf lf compon estim record minutes. frequenc compon comput fourier transform time seri creat rr interv absolut valu fourier transform frequenc bin. common wai characteris hrv frequenc domain measur present ratio lf/hf power. b. puls oximet puls oximet record signal contec cms50d+ usb connection. record signal usb connect program record software, run standard pc 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 11 window 7. technic characterist puls oximet shown tabl b. refer [1] d. b. sacks, d. e. bruns, d. e. goldstein, n. k. maclaren, j. m. mc- donald, m. parrott, guidelin recommend laboratori analysi diagnosi manag diabet mellitus, clinic chemistry, vol. 48, no. 3, pp. 436472, 2002. [2] w. consultation, definition, diagnosi classif diabet mellitu complications. part, 1999, vol. 1. [3] m. i. harris, k. m. flegal, c. c. cowie, m. s. eberhardt, d. e. gold- stein, r. r. little, h.-m. wiedmeyer, d. d. byrd-holt, preval diabetes, impair fast glucose, impair glucos toler u.s. adults: nation health nutrit examin survey, 19881994, diabet care, vol. 21, no. 4, pp. 518524, 1998. [4] j. p. boyle, a. a. honeycutt, k. v. narayan, t. j. hoerger, l. s. geiss, h. chen, t. j. thompson, project diabet burden 2050: impact chang demographi diseas preval u.s. diabet care, vol. 24, no. 11, pp. 19361940, 2001. [5] a. g. mainous, r. j. tanner, r. baker, c. e. zayas, c. a. harle, preval prediabet england 2003 2011: population- based, cross-sect study, bmj open, vol. 4, no. 6, p. e005002, 2014. [6] f. soriguer, a. goday, a. bosch-comas, e. bordiu, a. calle-pascual, r. carmena, r. casamitjana, l. castano, c. castell, m. catala, e. del- gado, j. franch, s. gaztambide, j. girbes, r. gomis, g. gutierrez, a. lopez-alba, m. martnez-larrad, e. menendez, i. mora-peces, e. or- tega, g. pascual-manich, g. rojo-martnez, m. serrano-rios, s. valdes, j. vazquez, j. vendrell, preval diabet mellitu impair glucos regul spain: diabet. study, diabetologia, vol. 55, no. 1, pp. 8893, 2012. [7] c. castell, r. tresserras, j. serra, a. goday, g. lloveras, l. salleras, preval diabet catalonia (spain): oral glucos toler test-bas popul study, diabet research clinic practice, vol. 43, no. 1, pp. 3340, 1999. [8] t. lauritzen, s. griffin, k. borch-johnsen, n. wareham, b. wolf- fenbuttel, addit study: propos trial cost-effect intens multifactori intervent morbid mortal peopl type 2 diabet detect screening. intern journal obes & relat metabol disorders, vol. 24, 2000. [9] u. p. d. s. group, u.k. prospect diabet studi 16: overview 6 year therapi type ii diabetes: progress disease, diabetes, vol. 44, no. 11, pp. 12491258, 1995. [online]. available: [10] p. zhang, m. m. engelgau, r. valdez, s. m. benjamin, b. cadwell, k. v. narayan, cost screen pre-diabet adult comparison differ screen strategies, diabet care, vol. 26, no. 9, pp. 25362542, 2003. [11] b. costa, f. barrio, j.-j. cabre, j.-l. pinol, f.-x. cos, c. sole, b. bolibar, c. castell, j. lindstrom, n. barengo et al., shift glucos diagnost criteria new hba1c criteria profound impact preval diabet high-risk spanish population, diabet medicine, vol. 28, no. 10, pp. 12341237, 2011. [12] s. masaoka, a. lev-ran, l. r. hill, g. vakil, e. h. hon, heart rate variabl diabetes: relationship ag durat disease, diabet care, vol. 8, no. 1, pp. 6468, 1985. [13] p. shi, s. hu, y. zhu, preliminari attempt understand compat photoplethysmograph puls rate variabl elec- trocardiogram heart rate variability, journal medic biolog engineering, vol. 28, no. 4, pp. 173180, 2008. [14] a. schafer j. vagedes, accur puls rate variabl estim heart rate variability?: review studi compar photo- plethysmograph technolog electrocardiogram, intern journal cardiology, vol. 166, no. 1, pp. 1529, 2013. [15] w. shin, y. d. cha, g. yoon, ecg/ppg integ signal process ubiquit health monitor system, journal medic systems, vol. 34, no. 5, pp. 891898, 2010. [16] n. harris, r. ireland, j. marques, s. hudson, c. davies, s. lee, r. robinson, s. heller, chang qt interv predict onset hypoglycemia type 1 diabetes? comput cardiolog 2000. ieee, 2000, pp. 375378. [17] v. p. sanon, s. sanon, r. kanakia, h. yu, f. araj, r. oliveros, r. chilton, hypoglycemia cardiologist perspective, clinic cardiology, vol. 37, no. 8, pp. 499504, 2014. [18] b. suys, s. heuten, d. wolf, m. verherstraeten, l. o. beeck, d. matthys, c. vrints, r. rooman, glycemia correct qt interv prolong young type 1 diabet patient relation? diabet care, vol. 29, no. 2, pp. 427429, 2006. [19] j. taubel, u. lorch, g. ferber, j. singh, v. n. batchvarov, i. savelieva, a. j. camm, insulin normal physiolog level prolong qtc interv thorough qt studi perform healthi volunteers, british journal clinic pharmacology, vol. 75, no. 2, pp. 392403, 2013. [20] j. p. singh, m. g. larson, c. j. odonnell, p. f. wilson, h. tsuji, d. m. lloyd-jones, d. levy, associ hyperglycemia reduc heart rate variabl (the framingham heart study), american journal cardiology, vol. 86, no. 3, pp. 309312, 2000. [21] m. schonauer, a. thomas, s. morbach, j. niebauer, u. schonauer, h. thiele, cardiac autonom diabet neuropathy, diabet vascular diseas research, vol. 5, no. 4, pp. 336344, 2008. [22] e. monte-moreno, non-invas estim blood glucos blood pressur photoplethysmograph mean machin learn techniques, artifici intellig medicine, vol. 53, no. 2, pp. 127 138, 2011. [23] t. hastie, r. tibshirani, j. friedman, t. hastie, j. friedman, r. tibshirani, element statist learning. springer, 2009, vol. 2. [24] c. m. bishop, neural network pattern recognition. clarendon press oxford, 1995. [25] d. j. curci w. craelius, recognit individu heart rate pattern cepstral vectors, biolog cybernetics, vol. 77, no. 2, pp. 103109, 1997. [26] d. curci w. craelius, classif heart rate variabl pattern diabet cepstral analysis, 21 2002, patent 6,390,986. [27] a. oppenheim r. schafer, discrete-tim signal processing, ser. pearson custom library. pearson education, limited, 2013. [28] m. g. rahim, b.-h. juang, w. chou, e. buhrke, signal condition- ing techniqu robust speech recognition, signal process letters, ieee, vol. 3, no. 4, pp. 107109, 1996. [29] r. w. hamming, digit filters. courier corporation, 1989. [30] v. j. carey, e. e. walters, g. a. colditz, c. g. solomon, w. c. willet, b. a. rosner, f. e. speizer, j. e. manson, bodi fat distribut risk non-insulin-depend diabet mellitu women nurs health study, american journal epidemiology, vol. 145, no. 7, pp. 614619, 1997. [31] p. deurenberg, j. a. weststrate, j. c. seidell, bodi mass index measur bodi fatness: age-and sex-specif predict formulas, british journal nutrition, vol. 65, no. 02, pp. 105114, 1991. [32] l. breiman, random forests, machin learning, vol. 45, no. 1, pp. 532, 2001. [33] j. h. friedman, stochast gradient boosting, comput statist & data analysis, vol. 38, no. 4, pp. 367378, 2002. [34] c. d.-s. et al., vigilancia la gripe en espana. temporada 2012-2013, accessed: 2015-03- 01. [35] d. c. montgomery, design analysi experiments. john wilei & sons, 2008. [36] f. j. gomez-perez, c. a. aguilar-salinas, p. almeda-valdes, d. cuevas- ramos, i. l. garber, j. a. rull, hba1c diagnosi diabet mellitu develop country. posit article, archiv medic research, vol. 41, no. 4, pp. 302308, 2010. [37] e. kilpatrick, haemoglobin a1c diagnosi monitor diabet mellitus, journal clinic pathology, vol. 61, no. 9, pp. 977982, 2008. [38] p. r. kumar, a. bhansali, m. ravikiran, s. bhansali, p. dutta, j. thakur, n. sachdeva, s. k. bhadada, r. walia, util glycat hemoglobin diagnos type 2 diabet mellitus: community-bas study, journal clinic endocrinolog & metabolism, vol. 95, no. 6, pp. 28322835, 2010. [39] a. l. peters, m. b. davidson, d. l. schriger, v. hasselblad, clinic approach diagnosi diabet mellitus: analysi glycosyl hemoglobin levels, jama, vol. 276, no. 15, pp. 12461252, 1996. [40] w. azim, m. omair, m. a. khan, n. shaheen, s. azim, correl glycat haemoglobin random plasma glucos level screen diabet mellitus, intern journal pathology, vol. 8, no. 2, pp. 5962, 2010. [41] c. diseas control, prevent et al., nation diabet statist report: estim diabet burden unit states, 2014, atlanta, ga: depart health human services, 2014. 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 12 [42] t. f. european societi cardiology, t. f. european societi cardiolog et al., north american societi pace electrophysiology. heart rate variability: standard measurement, physiolog interpret clinic use, circulation, vol. 93, no. 5, pp. 10431065, 1996. [43] c. m. van ravenswaaij-arts, l. a. kollee, j. c. hopman, g. b. stoelinga, h. p. van geijn, heart rate variability, annal intern medicine, vol. 118, no. 6, pp. 436447, 1993. 50 100 150 200 250 300 350 400 mg/dl 0.000 0.005 0.010 0.015 0.020 0.025 0.030 0.035 0.040 fr e q . glucose. nodiab 100 150 200 250 300 350 400 mg/dl glucose. diab fig. 1. histogram glucose. left non-diabet (mean 93.53 mg/dl, iqr 17.3), right diabet (mean 144.88 mg/dl, iqr 6.31) 15 25 35 45 kg/m2 0.00 0.02 0.04 0.06 0.08 0.10 0.12 fr e q . bmi nodiab 15 25 35 45 55 kg/m2 bmi diab fig. 2. histogram bmi. left non-diabet (mean 27.60 kg/m2, iqr 5.8), right diabet (mean 30.36 kg/m2, iqr 6.3) 40 59 78 97 116 135 kg. 0.000 0.005 0.010 0.015 0.020 0.025 0.030 0.035 fr e q . weight nodiab 40 59 78 97 116 135 kg. weight. diab fig. 3. histogram weight. left non-diabet (mean 72.7 kg., iqr 18.0), right diabet (mean 80.1 kg., iqr 19.5) 10 30 50 70 90 year 0.000 0.005 0.010 0.015 0.020 0.025 0.030 0.035 0.040 0.045 fr e q . age. nodiab 30 50 70 90 year age. diab fig. 4. histogram age. left non-diabet (mean 52.54 years, iqr 28), right diabet (mean 66.48 years, iqr 14) 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 roc chc:1 clasifier:gb fals posit rate t ru e p o si tiv e r te 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 roc chc:2 clasifier:gb fals posit rate t ru e p o si tiv e r te 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 roc chc:3 clasifier:gb fals posit rate t ru e p o si tiv e r te 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 roc chc:4 clasifier:gb fals posit rate t ru e p o si tiv e r te fig. 5. roc (fals postiv rate vs. true posit rate) commun health centr number 1, 2 3 4. result gradient boosting. 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 roc chc:1 clasifier:rf fals posit rate t ru e p o si tiv e r te 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 roc chc:2 clasifier:rf fals posit rate t ru e p o si tiv e r te 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 roc chc:3 clasifier:rf fals posit rate t ru e p o si tiv e r te 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 roc chc:4 clasifier:rf fals posit rate t ru e p o si tiv e r te fig. 6. roc (fals postiv rate vs. true posit rate) commun health centr number 1, 2 3 4. result random forest 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 roc chc:5 clasifier:rf fals posit rate t ru e p o si tiv e r te 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 roc chc:5 clasifier:gb fals posit rate t ru e p o si tiv e r te fig. 7. roc commun health center number 5. left: result random forest, right: result gradient boosting. 0018-9294 (c) 2015 ieee. person us permitted, republication/redistribut requir ieee permission. information. articl accept public futur issu journal, fulli edited. content chang prior final publication. citat information: doi 10.1109/tbme.2016.2554661, ieee transact biomed engin 13 gender men women diabet 184 156 non-diabet 331 499 diabetic( % gender) 35.72% 23.81 % tabl distribut gender chc-1 chc-2 chc-3 chc-4 chc-5 diabet subject 23.07 % 24.13 % 30.55 % 30.45% 34.45% tabl ii percentag diabet commun health center smoker total diabet non-diabet percentag 16.18% 11.8% 17.71% tabl iii distribut smoker chc-1 chc-2 chc-3 chc-4 chc-5 diabet 29.3 kg/m2 29.6 kg/m2 30.0 kg/m2 30.3 kg/m2 33.1 kg/m2 non-diabet 26.5 kg/m2 27.8 kg/m2 28.1 kg/m2 28.3 kg/m2 27.6 kg/m2 tabl iv distribut bmi (kg/m2) commun health center chc-1 chc-2 chc-3 chc-4 chc-5 roc rf 78.15 % 71.7 % 59.6 % 71.9% 61.8% roc gb 75.4 % 73.9 % 61.1 % 71.8% 64.6% roc lda 56.3 % 57.2 % 53.2 % 55.2% 53.7 % tabl v roc area commun health center, rf: mean valu 68.6% std 7.27% gb: mean valu 69.3% std 6.2% spo2 measur rang 0% 100%, (the resolut 1%). accuraci 70% 100%: 2% ,below 70% unspecifi pr measur rang 30bpm 250bpm, (the resolut 1bpm) accuraci 2bpm 2% measur perform weak fill condition: spo2 puls rate shown correctli pulse-fil ratio 0.4%. spo2 error 4%, puls rate error 2 bpm 2% sampl rate 60 samples/second tabl vi featur contec cms50d+ puls oximet