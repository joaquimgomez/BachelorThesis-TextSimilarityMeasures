cohes surfac model fractur base two-scal formulation: comput implement aspect s. toro1,2, p.j. sanchez1,2, j.m. podesta1, p.j. blanco3,4, a.e. huespe1,5, r.a. feijoo3,4 1cimec-unl-conicet, guem 3450, cp 3000 santa fe, argentina 2gimni-utn-frsf, lavais 610, cp 3000 santa fe, argentina 3lncc/mcti, av. getulio varga 333, petropolis, rj, cep: 25651-075, brasil 4inct-macc, instituto nacion ciencia e tecnologia em medicina assistida por computacao cientfica, brasil 5centr internacion metod numer en enyinyeria (cimne),campu nord upc, edifici c-1, j. girona 1-3, 08034 barcelona, spain keywords: multi-scal cohes models, comput homogenization, heterogen materi failure, embed finit element (efem). abstract paper describ comput aspect numer implement two-scal cohes surfac methodolog develop analyz fractur heterogen materi complex micro- structures. approach categor semi-concurr model repres vol- um element (rve) concept. variat multi-scal formul methodolog previous present authors. subsequently, formul gener improv aspects: i) cohes surfac introduc scale analysis, model strong discontinu kinemat (new equat describ insert macro-scal strains, micro-scal posterior homogen procedur considered); ii) comput procedur numer implement adapt formulation. point present elsewhere, summar here. instead, main object paper address detail present second point. finit element techniqu model cohes surfac scale analysi (fe2 approach) described: i) finit element embed strong discontinu (efem) macro- scale simulation, ii) continuum-typ finit element high aspect ratios, mimick cohes surfaces, adopt simul failur mechan micro-scale. methodolog valid numer simul quasi-brittl concret fractur prob- lem. propos multi-scal model capabl unveil mechan lead materi degrad phenomenon meso-structur level activ propag cohes sur- face structur scale. 1 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y 1 introduct 1.1 literatur review cohes surfac model (csm) proven us conceptu tool analyz materi fracture. approach consist introduc surfac interfac continuum. rel displacement, displac jump, model interfaces, cohes traction interfac react oppos opening. interfac opened, cohes forc decrease, tend zero, final yield new traction-fre crack continuum. so, gener new traction-fre crack demand energi mechan system. csm appropri nonlinear dissip effect observ small length scales, specif fractur process zone propag crack. model effect requir adequ character traction-displac jump law govern cohes surfac evolution. implicitly, character involv energi demand mechan gener new traction-fre crack solid. so, select traction-displac jump law turn foremost issu model cohes surfaces. csm firstli introduc fractur mechan dugdal [1] barenblatt [2]. comput mechanics, introduc needleman co-work (needleman [3], xu needleman [4], refer cite needleman [5]). them, csm gain wide accept reasons. first, numer implement simpl efficient. but, mainly, csm popular wide rang problem applic provid us solutions. typic exampl csm appli dynam fractur simul shown falk et al. [6], xu needleman [7] pandolfi et al. [8]. ductil fractur analysis, csm util hutchinson evan [9], tvergaard [10], siegmund brock [11], huesp et al. [12], huesp et al. [13]. furthermore, pioneer work hillerborg [14], bazant [15] elic et al. [16], csm model wide appli field quasi-brittl materi model concret fractur problems. accord aim present work, features, assumpt limit clas- sical csm, mainli relat traction-separ law description, summar remarked: i) usually, model quasi-brittl fracture, constitut law relat traction dis- placement jump cohes surfac propos independ continuum constitut relat character bulk materi (except approach propos [17], [18] refer cite therein). kei paramet govern re- spons cohes forces: fractur energi peak stress. practic appli- cations, estim experiments. however, paramet depend phe- nomena occur smaller length scales. typically, composit displai notic differ overal fractur energi chang micro-structur topology. topol- ogi chang happen load process, materi degrad itself. case, experiment determin paramet govern traction-separ law, free controversy. so, altern approach assess overal frac- ture energi consist model materi degrad process small length scales, 2 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y fractur energi compound accur characterized, simultane- ousli crack propag problem structur level. then, specif homogen technique, overal fractur energi estim unifi frame- work analysis. ii) ductil fractur analysi csm wide address literature. how- ever, case, contrarili quasi-brittl fractur approaches, paramet de- termin traction-separ law depend markedli load path. typically, separ work ductil fracture, peak stress, enorm influenc stress triaxial (see tvergaard hutchinson [19]). viabl techniqu deal complex phenomena us multi-scal models, adopt cohes forc interfac determin traction-separ law micro-structur analysis. work follow approach, siegmund brock [11]. however, consid multi-scal techniqu transfer inform be- tween scale flow direction, smaller length scale larger (hierarch model). kind hierarch approach question cohes forc depend strongli macro-scal variabl chang structur load history. class multi-scal procedur model ductil fracture, suitabl mention work xia shih [20] vernerei et al. [21]. cases, fractur process zone macro-scal approach csm, effect induc micro-structur failur process taken account. work xia shih, micro-structur explicitli embed macro-model, while, work vernerei et al., micro-structur degrad mechan model increas kinemat descriptor macro-scal micromorph theori framework. approach result highli motiv techniqu develop model describ paper. determin overal constitut relat micro-structur materi undergo frac- ture, multi-scal procedures, involv meaning theoret challenges. previou work authors, sanchez et al. [22], shown macro-scal materi re- spons lose strong ellipt condition, convent homogen procedur (volum average), evalu us rve, ill-pos problem, gitman et al. [23] nguyen et al. [24]. contrarili happen macro-scal stabl pre-crit regime, multi-scal problem involv strain local demand us gener origin formul base non-convent homogen paradigms. years, problem motiv intens study. author contribut new idea the- oret numer models. cite them, refer follow works: belytschko et al. [25], belytschko song [26], geer et al. [27], bosco et al. [28], nguyen et al. [29], verhoosel et al. [30] oliv et al. [31], kulkarni et al. [32] refer cite therein. 1.2 csm novel rve-bas multi-scal framework blanco co-work [33] present variation consist rve-bas unifi theori establish follow axioms: (i) kinemat admissibility, (ii) mathemat dualiti 3 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y (iii) virtual power principle. coin method multi-scal virtual power (mmvp) identifi theory. mmvp, physic involv length scale link postul so-cal principl multi-scal virtual power (pmvp), gener hill-mandel statement macro-homogen [34, 35]. mmvp, homogen formula stress-lik quantities, establish precis boundari condit impos rve mechan model micro-scal equilibrium problem, unambigu deriv consequ variat formulation, contrast altern approach a-priori assumed. gener framework propos [33] encompass wide spectrum multi-scal mod- el scenarios, rang convent constitutive-inspir multi-scal theori (see [36, 37, 38, 39]) sophist novel approaches, example: multi-scal techniqu link- ing high order macro-scal descript standard (first order) micro-scal kinemat [40], thermo-mechan model (see [41]), multi-scal formul account inertia bodi forc effect (see [42]), etc. mmvp addition underli theori deriv multi-scal model materi failur base csm, traction-separ law character macro- scale cohes interfac obtain homogen micro-scal degrad mechanisms. example, sanchez et al. [22] toro et al. [43], semi-concurr two-scal approach materi failur analysi proposed. failur phenomena micro-scal repres exist strain local bands, model smear crack technique. also, base mmvp concept, toro et al. [44] subsequ gener im- prove methodolog propos [22] [43] introduc cohes surfac scale analysis. new equat transfer inform scale (scale-bridg equations) develop presented. develop two-scal formul de- scribe toro et al. [44], detail finit element implement describ articl shed light follow issues: (i) numer treatment given csm macro micro scales, includ efem finit element techniqu crack path track algorithm, (ii) detail procedur evalu homogen formula macro-scal stress cohes trac- tions, (iii) implement kinemat restrict rve model, (iv) implement equilibrium problem scale analysis. comput tool obtain procedur result effici simul wide rang failur phenomena heterogen materials. subject repres main contribut present work. remain paper structur follows: section 2, brief theoret descript methodolog formul toro et al. [44]. main contribut present paper introduc section 3, detail descript finit element model scales, macro micro, shown. embed strong discontinu finit element techniqu (efem) propos simul cohes surfac macro-scale. furthermore, detail descript fractur model micro-scal present section. numer assess model present section 4. sensit analysi macro-scal respons respect to: i) mesoscop cell size ii) finit element mesh size given specif cell, shown discussed. finally, structur fractur problem model heterogen quasi-brittl material. section paper devot discuss conclusions. 4 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y 2 descript multi-scal mechan formul accord object pursu contribution, brief overview multi-scal mechan formul shown section, provid necessari background describ comput implement remain paper. model formul describ toro et al. [44]. thus, reader address work obtain detail formulation, [33] consult specif aspect mmvp theory. notat work. object interven model identifi follow (see figur 1): rve (micro-scale) macro-scal u(x) e(x) s(x) u (y) e (y) s (y) m m m y x w wm tm bm sm t b s figur 1: notat adopt work macro micro-scal levels. i) domain bodi macro-scal denoted. point domain identifi x. macro-scal fields, , are: displac u(x), strain (x), stress (x), consid macro-scal cohes surfac s, displac jump traction interfac denot t , respectively. ii) point x macro-scal link rve domain denot . point identifi y. micro-scal field distinguish subscript (), understood differ object defin macro-scal previou item, i.e. micro-scal displacements, u, micro-scal strains, , micro-scal stresses, , displace- ment jump micro-scal crack , traction micro-scal cohes crack t, on. micro-scal field depend y x. iii) micro-scal kinemat field fluctuat compon denot tilde: (). iv) kinemat scale present increment form. then, infinitesim in- crement variabl identifi symbol d(). kinemat admiss virtual action denot symbol (). structur load histori chang accord monoton increas pseudo-tim coordin t. then, pseudo-tim adopt paramet indic sequenc event take place mechan problem. 5 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y 2.1 macro-scal model cohes surfac let consid domain bodi displai evolv cohes surfac denot s orthogon unit vector n, shown figur 2-a. surfac s show rel displac interfaces, call displac jump vector, denot , cohes traction t act them. cohes surfac s nucleat macro-scal materi instabl condit detect certain pseudo-tim instant (t = tn ). criterion defin tn present sub-sect 3.1.1. surfac s divid disjoint sets: + . boundari , impos traction te, t, displac ud, d, being: = t d, figur 2-a. consid arbitrarili small domain s . then, divid s disjoint sets: + . follow simo et al. [45], displac increment du macro-scal describ by: du = du+ m d, (1) du repres increment continu displac compon . incre- ment displac jump s d m unit jump function (with compact support) defin follows: x d t e u + - + - s n (a) x (c) xr s wx x [ [ j +- s x [ [ x [ [ 1 (b) 1 n interfac b n t t j j s s w w w w w w wj j j g tg s cohes surfac d -w w+ figur 2: macro-scal model: (a) cohes surfac macro-scal mechan representation; (b) con- tinuou function , heavisid step function h unit jump function m ; (c) regular singular point macro-scale. m := h , (2) h = { 0 x 1 x + , = { 0 x \ 1 x +\ + , (3) h heavisid step function shift s, satisfi (3), arbitrari suffici smooth function, figur 2-b. 6 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y accord equat (1), follow previou work author [44], assum exist gener strain increment d . strain increment deriv appli gener gradient displac field equat (1) (see exampl [45]). oper way, d given follows: d = sxdu du + msxd s x s d d +s(d s n) = du + d + s(d s n), (4) assum d compact support , symbol s repres symmetr tensor product, dirac delta function shift s denot s (s unit length1). remark: term (4) introduc strain singular s. therefore, distinguish between: a) regular points, denot xr (xr \s), call bulk materi strain convention defined, b) singular point denot xs (x s), shown figur 2-c. regular term (4) identifi strain increment dr bulk material: dr = du(du) + d(d) , xr \s. (5) partit strain increment dr terms, du d shown equat (4) (5), evid fact du depend du, d depend d. note dr present kinemat description, defin regular points, depend d compact support function m , (2). (4), identifi singular strain increment quantiti ds s follows: ds = du + d + s(d s n) , xs s. (6) gener strain implicitli repres triad kinemat descriptor {du, d, d}. on, ds implicit representation. balanc momentum equat written variat format follows: (u,) u that: \s r d + s t ds t te u d = 0 ; (u, ) v , (7) u set kinemat admiss descriptor v space kinemat admiss virtual action given follows: u := { (u,) ; u h1() , h1() u|d = ud } , v := { (u, ) ; u h1() , h1() u|d = 0 } . (8) 7 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y 2.1.1 multi-scal evalu stress traction equat (7), stress regular points, xr, traction t singular points, xs , evalu specif non-standard homogen procedur gather inform micro-scale. homogen procedur ration justifi framework mmvp theori ([33] [44]). typifi follows: i) mmrp (multi-scal constitut model regular points): homogen procedur defin overal bulk materi response, , xr; ii) mmsp (multi-scal constitut model singular points): homogen procedur defin overal traction-separ response, t ,at xs . figur 3 sketch big pictur homogen procedur in, identifi mmrp mmsp procedur macro-scal point utilized. macro-scal point rve. increment strain gener increment strain insert macro-scal micro-scale, stress traction obtain micro-scale, appli homogen techniques. process insert strain retriev general- iz stress govern set scale bridg equat defin describ sub-sect 2.3. s x macro-scal w t t x s r n s rve m mmrp strain insert mmsp gener strain insert rve yw w r de figur 3: multi-scal model fracture: (a) mmrp homogen procedur evalu overal materi response, , regular point xr; (b) mmsp homogen procedur evalu overal materi response, t , cohes surface, point xs . 2.2 micro-scal model cohes surfac kinemat descript rve similar util macro-scale. so, failur mechan describ mean cohes surfac nucleat structur load increases. let consid rve domain displai nc cohes surfac nucleat micro- scale load process. i-th cohes surfac denot si, normal vector ni, figur 4-a. cohes surfac si divid disjoint domains, i+ , ni point +. 8 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y micro-scal cohes crack si nucleat materi bifurc condit satisfi given point micro-scale, previous reach critic condit macro- scale crack nucleat pseudo-tim tn . db mdu (b) x [ [ j + s x [ [ x [ [ 1 j j s s w w m (c) +m- m- w w m m m mm m m m m 1 sm m m xm dum n rve (a) y 0 wm+ m -mw y sm wm- j wm+ j bm xm mw + jwm- + j wm m- w figur 4: kinemat micro-scal account materi failure. (a) cohes surfac si; (b) micro-scal displac fluctuat increment field, du displai strong discontinu si; (c) continu function i, heavisid function h unit jump function m . micro-scal strain increment d is: d = i(d) + d, (9) term correspond macro-scal strain increment, d, inject x , insert oper i(). insert oper i() distribut argument rve domain. both, argument, chang accord homogen procedure. oper defin sub-sect 2.3 label ir accord mmr mmsp procedure, respectively. term right hand (9) micro-scal strain fluctuat increment defin as: d = sydu, (10) du micro-scal displac fluctuat increment, descript discuss following. 2.2.1 treatment given micro-scal displac fluctuat increment field similar strong discontinu kinemat adopt macro-scale, describ equat (1), micro-scal displac fluctuat increment, du, written addit terms, figur 4-b: 9 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y du = d u + nc i=1 m d , (11) u continu compon micro-scal displac fluctuation, displac jump fluctuat interfac i-th cohes surfac si m unit jump function. both, m , relat si. (11), assum field du result addit contribut nc cohes surfac nucleat load history. function m defin follows, figur 4-c: m := h , (12) h = { 0 y 1 y i+ , = { 0 y i\ 1 y i+\ + , (13) heavisid step function h smooth function relat i-th cohes crack. case, small domain si (with: si ), + subdomain partit si, shown figur 4-a. accord (11), micro-scal strain fluctuat increment, d, given by: d = dr + nc i=1 si(d s ni) , y , (14) (regular) term right hand is: dr = s yd u + nc i=1 ( m s yd s y s di ) , (15) second (singular) term defin dirac delta function si shift s . 2.3 scale-bridg equat present sub-section, scale bridg equat multi-scal model present [44] summarized. reader address refer descript concept support equations. scale bridg equat establish follow axiom conse- quenc deriv them, detail [33]: h1) kinemat admiss requir connect kinemat macro micro- scales. hypothesi impos follow constraint micro-scal strains: d d = i(d) d . (16) insert oper i, argument micro-scal domain ident (16) imposed, depend homogen procedure, mmrp mmsp (see equat (18), (29) (30) follow paragraphs). 10 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y equat (9), condit (16) enforc null averag micro-scal strain fluc- tuation, d, . kinemat admiss requir convent semi- concurr multi-scal model rve (where , i(d) ident operator). however, gener [44] order develop consist homog- eniz model singular point xs . h2) identity, variat sense, intern virtual power densiti scales. hypothesi principl multi-scal virtual power, accord [33], gen- eral version hill-mandel principle. hypothesi (h2) specifi [44] includ presenc strong discontinu scale analysis. mention above, macro-scal level, multi-scal model distinguish regular points, xr, singular points, xs . differ strain insert procedur defin point (mmrp mmsp). then, hypothes h1 h2 specifi case. s x macro-scal w tb t x s r n t s cohes surfac rve wm nm nucleat cohes surfac (i=1,..., n ) (a) rve wm close crack t nm (b) lj sm lj c (k=1,...,n )cl mmsp (de,de,db)u b mmrp ir (de,de)u b sm set open crac t ( ; j=1,...,n ) n m l op js gm nm gm nm n t>tnt tn figur 5: overview multi-scal model fracture: (a) mmrp homogen procedur us insert oper ir defin box 1; (b) mmsp homogen procedur us insert oper defin box 2. realist assumpt model multi-scal materi failur problems, consid macro-scal pre-bifurc regim given point xr, nucleat nc micro-scal cohes crack in. micro-crack denot si (with = 1, ..., nc). number nc chang load histori new cohes crack sequenti nucleat t < tn . however, bifurc macro-scal detected, t = tn , nc nucleat micro-scal cohes crack , nop crack open ncl close remain inact (nc = ncl + nop). s lj (with j = 1, ..., nop) denot j-th open crack, sl set open crack (sl = nop i=1 ). new surfac nucleat re-open subsequ load history. so, failur mode defin set nop open surfac t = tn , that, chang anymore. order appli scale transit equat mmsp homogen procedure, domain sl precis detect t = tn . algorithm defin sl describ numer implement section. 11 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y take account previou concepts, defin tortuos factor , follows: (xs) = |sl |( nop j=1 s lj n lj ds ) , |sl | = nop j=1 |slj | , (17) |slj | measur cohes surfac s lj . paramet [1,) interpret geometr factor measur tortuos micro-scal crack path failur mechan rve, t = tn . introduc guarante kinemat consist associ crack open scale analysis: open macro-crack s openings, directions, multipl crack simul micro scale level. note = 1 micro-scal crack parallel, larger 1 micro-scal crack follow zig-zag path. sensit analysi macro-scal behavior respect present previou work authors, toro et al. [44]. contribution, rigor kinemat justif includ -factor multi-scal model discussed. tortuos paramet scale term involv macro-scal displac jump interven scale transit procedur (see [44] pure kinemat justif (17)). scale bridg equat govern multi-scal problem summar box 1 2. however, discuss equations, figur 6 sketch, mean blocks, sequenc macro-scal kinematical, constitut variat equilibrium equa- tion govern mechan problem framework present multi-scal approach. block contain larger box identifi macro-scal mechan prob- lem, repres iter strategi (for exampl newton-raphson scheme), solv mechan problem. figur describ inform flow block correspond equat character block. specifically, block represent- ing macro-scal constitut model divid sub-block accord constitut model refer regular (xr) singular (xs) point, mmrp mmsp homogen procedure. rve problem homogen procedur sketch figur 7, follow similar organ figur 6. equat summar box 1 2 relat sub-block macro-scal con- stitut model figur 6. explain items: i) mmrp homogen procedur obtain xr (see box 1). regular macro-scal strain increment, dr, data input multi-scal constitu- tive relat describ box 1. accord equat (5), dr given addit components: du d . block equat (20)(26) box 1, defin micro-scal kinemat function space involv variat formul micro-scal problem. strain increment d, rve, given equat (20)(22) particu- lariz (9). strain increment d result addit terms: macro-scal strain increment dr, insert macro-scal rve 12 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y sdu,d du,d ,d mmrp constitut model mmsp constitut model strain insert (see eq. (21)) = ir(du, d) strain insert (see eq. (33)) = is(du, d, d) rve problem (see fig. 7) boundari condit defin eqs. (23) (25) rve problem (see fig. 7) boundari condit defin eqs. (35) (37) stress homog. (see eq. (27)) = 1|| d traction homog. (see eq. (39)) t = |sl | [nop j=1 s lj t s lj ds ] t macro-scal constitut model macro-scal kinemat du,d (see eqs. (1) (4)) du d d macro-scal equilibrium equat \s r d + s t ds t te u d = 0 ; (u, ) v (see eqs. (7) (8)) macro-scal mechan problem x xr s w t s s figur 6: data flow mechan problem involv scale analysis: macro micro. 13 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y s id(i, dr) d(i, dr,di) continuum constitut model cohes model fenomenolog law fenomenolog law (i.e. box 3) tsi micro-scal constitut model micro-scal kinemat d u,di eqs. (11),(14) (15) dr d d d = + d mmrp, eqs. (20) (21) = ir mmsp, eqs. (32) (33) = micro-scal equilibrium equat r d + nc i=1 si tsi ds = 0 , (u, 1, . . . , nc ) v v = v r (for mmrp eqs. (23), (25) (28)) v = v s (for mmsp eqs. (35), (37) (40)) rve mechan problem rve wm m s figur 7: data flow rve problem homogen procedures: mmrp mmsp. 14 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y oper ir(), plu strain fluctuat increment d. accord definit oper ir(), equat (21), term du d uniformli distribut . however, note d scale tortuos factor . kinemat admiss requir (16), hypothesi h1, particular follows: d d = ir(du, d) d , (18) [44] addit details. then, express (23) block 1 defin space kine- matic admiss displac fluctuat u r . mention above, kinemat descriptor fulli defin displac fluctuat micro-scal are: d u di (i = 1, ..., nc). assum independ descriptors. geometr entiti express (23), i.e. boundari unit normal vector , depict figur 5. integr restrict boundari impos displac fluctua- tion increment field u r , express (23), equival restrict (18). express (24) defin virtual action macro-scale. note mmrp model consid u arbitrari tensor 0 . correspond space virtual displac action micro-scal v r , micro-scal virtual strain action defin express (26). subspac u r v r , kinemat admiss defin altern (more constrained) sub-model mmrp procedure. specif definit virtual action basi postul principl multi- scale virtual power (h2), express follows: u = 1 || (u, u, 1, ..., nc ) d , u ( u, 1, ..., nc ) v r . (19) left hand equat macro-scal intern virtual power densiti right hand averag intern virtual power in. equat (19) emphas de- pendenc micro-scal strain variat with: u, u, 1, ..., nc . depend explicitli shown equat (26). replac (24) (26) (19), principl multi-scal virtual power (h2) impli natur consequ sens associ euler-lagrang equations. deriv consid independ variat u ( u, 1, ..., nc ). consequ present block 2.a 2.b box 1, explain follows: (2.a) equat (27) deriv (19) allow arbitrari variat u hold ( u, 1, ..., nc ) fix zero. equat defin homogen procedur determin macro-scal stress , volumetr averag micro- scale stress field . micro-scal stress determin micro-scal equilibrium problem given express (28). 15 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y (2.b) express (28) deriv (19) introduc arbitrari variat ( u, 1, ..., nc ) hold u fix zero. equat variat equilibrium equat . constitut relat constitu heterogen materi traction- separ law cohes surfac specifi solv micro-scal equilibrium problem (28), so, determin tsi . box 1: multi-scal constitut model regular point (mmrp) given strain history: (tdt)r {du, d}, satisfi : 1- kinematics: d = ir(du, d) + d , y (20) ir(du, d) = du + d (21) d = syd u + nc i=1 ( m s yd y s d + si(d s n ) ) (22) kinemat admiss space increment displac fluctuations, du: u r = { (d u,d 1 , . . . , d nc ) suff. regular, that: d u s d = 0 } (23) virtual kinemat admiss actions: virtual action macro-scale: = 0 , u arbitrari (24) virtual action micro-scale: (u, 1 , . . . , nc ) v r , with: v r u r (25) = ir(u,0) +sy u + nc i=1 ( m s y y s + si( s n ) ) (26) 2- consequ deriv principl multi-scal virtual power 2.a stress homogenization: = 1 || d (27) 2.b micro-scal equilibrium problem: given strain histori (tdt)r {dr}, (d u, d 1 , . . . , d nc ) u r that: r d + nc i=1 si tsi ds = 0 , (u, 1 , . . . , nc ) v r (28) ii) mmsp homogen procedur obtain t xs (see box 2). 16 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y macro-scal strain increment ds , s, data input constitut model box 2. gener strain increment defin equat (6) repres triad {du, d, d}. note displac jump (a vector term) box 2 instead singular tensor term describ right hand equat (6). block equat (32)(38) box 2, defin micro-scal kinemat . follow notat above, micro-scal strain increment identifi d. also, micro-scal strain increment fluctuat denot d, defin equat (34). insert oper is(), defin equat (33), distribut macro-scal strain increment given {du, d, d} . similar previou case, increment macro-scal regular strain, du + d, uniformli distribut . however, d distribut micro-scal strain local domain sl correspond nop open cohes surfaces. therefore, case, gener strain descriptor {du, d, d}, uniformli distribut . again, case, paramet scale term macro-scal displac jump present. correspond (14) (15), equat (34) defin micro-scal strain increment fluctuation. note, expression, micro-scal nucleat cohes surfac contribut d. kinemat admiss requir (16), hypothesi h1, impos equations: d d = is(du, d,0) d (29) sl d d = sl is(0,0, d) ds (30) [44] addit details. kinemat admiss displac fluctuat space u s , correspond virtual action space v s , defin express (35) (37), respectively. constraint (35) defin field d u satisfi (29) . second defin field d satisfi (30) sl . macro-scal admiss virtual action given express (36). case, note macro-scal vector arbitrarili defined, macro-scal regular strain variat r assum zero. specif principl multi-scal virtual power (h2), valid point xs macro- scale, postul follows: t = 1 |sl | (, u, 1, ..., nc ) d , ( u, 1, ..., nc ) v s . (31) equat natur deriv variat principl (31): 17 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y ii.1) obtain allow arbitrari variat hold fix ( u, 1, ..., nc ) zero, result express (39) box 2. express provid homog- eniz rule macro-scal traction t averag micro-scal trac- tion t s lj open cohes crack in. note presenc paramet scale averag traction sl . ii.2) alternatively, impos arbitrari variat ( u, 1, ..., nc ), hold fix zero, micro-scal equilibrium equat (40) derived. equat similar, differ kinemat constraints, (28) box 1. box 2: multi-scal constitut model singular point (mmsp) given strain displac jump histori (tdt)r , (tdt) {du, d, d}; find: t satisfying: 1- kinematics: d = is(du, d , d) + d , y (32) is(du, d , d) = du + d + nop j=1 s lj (d s nlj ) ; y (33) d = syd u + nc i=1 ( m s yd y s d + si(d s n ) ) (34) kinemat admiss space increment displac fluctuations, du: u s = { (d u, d 1 , . . . , d nc ) suff. regular, that: d u s d = 0 nop j=1 s lj d lj s n lj ds = 0 } (35) virtual kinemat admiss actions: virtual action macro-scale: arbitrari , r 0 (36) virtual action micro-scale: ( u, 1 , . . . , nc ) v s , with: v s = u s (37) = is(0,0, ) +sy u + nc i=1 ( m s y s y s + si( s n ) ) (38) 2- consequ deriv principl multi-scal virtual power 2.a traction homogenization: t = |sl | [ nop j=1 s lj t s lj ds ] (39) 2.b micro-scal equilibrium problem: given histori (tdt)r , (tdt) {dr, d}, (d u, d1, . . . , d nc ) u s that: r d + nc i=1 si tsi ds = 0 , (u, 1 , . . . , nc ) v s (40) 18 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y remark: note insert oper i(), equat (20) (32) defin informa- tion transfer macro micro-scale, wai macro-scal kinemat distribut . 3 numer implement numer implement multi-scal model, macro micro-scale, base finit element methodologies. although, scale assum exist cohes surfaces, therefore, model strong discontinu required, differ procedur case. macro-scal model base new finit element techniqu embed strong discontinu (efem) automat crack path detection, recent introduc literatur oliv et al. [46]. work, novel efem techniqu util mono-scal failur analysis. gener multi-scal analysi shown. sub-sect 3.1 brief summari efem techniqu presented. import issu element crack path detection. also, follow oliv et al. [46], task perform crack path field technique, descript postpon sub-sect 3.3. present macro-scal model easili implement altern finit element techniqu deal strong discontinuities, xfem, track strategi evalu crack path. note select conveni finit element technique, primarili decid accord comput cost involv evalu macro-scal integr terms, equat (7). specifically, refer number quadratur point requir differ techniques. alternatively, standard finit element techniqu us stretch element high aspect ratios, place edg convent on mimick cohes surfaces, adopt model micro-scal failure. procedur briefli summar section 3.2. discuss adequ choic rve boundari condit numer implement address section. finit element techniqu adopt model macro-scal adapt handl strong discontinu intersect mesh arbitrari directions. however, consid requir import comput efforts, typic refer evalu crack path track algorithm, prefer approach computation demand solv micro- scale, expens give abil captur accur micro-scal crack path intersect finit element mesh arbitrari directions. 3.1 macro-scal finit element model: efem techniqu finit element model briefli describ sub-sect 3.1.1, correspond macro- scale discret equilibrium equat present sub-sect 3.1.2. 19 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y 3.1.1 finit element strain enrichment: constant strain mode (csm) discontin- uou displac mode (ddm) let consid mix bilinear quadrilater finit element technolog embed strong discontinu report oliv et al. [46]. finit element mesh cover domain h bodi (in r2) e denot domain specif finit element e. structur load process, bilinear quadrilater finit element e switch differ formulations, denot states: 0, 1 2. set element ident state defin specif bodi subdomains, sketch figur 8-b. element state 1 2 defin subdomainshcsm h ddm , respectively. strong discontinu surfac s h cross domain hddm . remain subdomain h 0 = h\(hcsm h ddm ) defin element state 0. finit element formul switch state defin accord follow rule (see figur 8-a): w w w csm ddm predict crack path xr x s xr s n (w) e - j+ (w)e + w e pg2 pg3 pg4 pg1 w e 0 csm (state 1) ddm s e e e h h h h(state 0) (state 2) e macro-scal problem consolid crack path (b) s j+ 1 ne (c) element state pseudo-tim 0 1 2 t tn sd0 (a) e e csm ddm ddm ddm (w) e + ddm (w) e - ddm figur 8: macro-scal finit element technique. a) relat pseudo-tim vs. finit element state particular macro-scal finit element; b) finit element state accord subdomain definitions, hcsm domain finit element base csm (state 1) shown light gray, hddm domain finit element base embed strong discontinuities-ddm (state 2) shown deep gray, h\(hcsm h ddm ) domain element base irreduc formul (state 0) shown white; c) enrich function m e element ddm. initially, element h defin state 0 (h0 = h). state, element model standard quadrilater continu bilinear displacements. standard literatur finit element method, formul call irreducible. quadratur rule gauss points: pg1, ..., pg4, implement evalu integr aris irreduc formulation. macro-scal bifurc condit detect pseudo-time: t = tn , e, element origin state 0 switch state 1 subdomain 20 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y hcsm . bifurc condit element e test central point x e r verifi singular homogen acoust tensor qhom. then, bifurc criterion satisfied, if: det(qhom) = det(nebifc homnebif ) = 0 (41) wherechom homogen constitut tensor given equat (60) below, nebif eigenvector (41) satisfied. second non-trivi eigenvector denot repres initi veloc jump direct possibl singular surfac normal vector nebif . finit element state 1 quadrilaterals, mix interpol displace- ment strains: bilinear interpol increment displac constant interpol increment strain (constant strain mode-csm). so, quadratur rule integr point, central xer figur 8-a, evalu consist integr result variat problem mix formulation. element state local vicin propag crack tip (the frac- ture process zone). object pursu introduc csm strain augment flexibl finit elements, thus, better predict crack path direct zone. subsequent, small, increment loading, pseudo-tim tsd (with tsd > tn ), finit element state 1 switch state 2 subdomain hddm . state 2, strong discontinu mode (discontinu displac mode-ddm accord oliv et al. [46]) embed quadrilater finit element. previou switch state 1 2, posit surfac se(x) normal vector ne determin accord techniqu given sub-sect 3.2 below. place discontinu surfac se correct posit avoid stress lock element failur take place. increment format multi-scal model section 2, nu- meric rve increment implement sub-sect 3.2 (more specif sub-sect 3.2.4), numer integr consist perform quadratur rule modi- fi element switch state 0 1. finit element formul state 0 1 implement follow standard procedures. therefore, detail given, interest reader refer mention refer work. alternatively, finit element state 2 deserv addit descript present following. implement finit element ddm (element state 2) let consid macro-scal finit element e, subdomain: eddm h ddm , embed strong discontinu se unit normal vector ne considered, figur 8-c. discontinu displac increment field due(x) element given follows: due(x) = 4 p=1 n ep (x)du p,e + m e(x)d , (42) 21 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y n ep standard shape function bilinear quadrilater element relat p-th node element e. vector paramet continu displac increment inter- polat associ p-th node denot dup,e, vector element paramet displac jump increment interpolation. vector (e r2) element. unit jump function m e(x) depict figur 8-c defin follows: m e(x) = h e(x) e(x) , (43) h e heavisid unit function shift se, and: e(x) = j+ j=1 n ej (x) , (44) node j = 1, ..., j+ belong (eddm ) +, shown figur 8-c. constant interpol regular strain increment element assumed. strain increment given matrix notat follows: der(x) = b e(xer)[du e] deu [e](xer)d e , x eddm\ e (45) where, element vector [ue] collect displac compon finit element,b [e] convent displacement-strain matrix matrix gradient function e. term (45) evalu central integr point xer. voigt notat cartesian basis, strain compon arrang er = [x1x1 , x2x2 , 2x1x2 ] t (with subscript x1 x2 indic cartesian compon r2). matric (45) defin follows: = ne1 x1 0 ... ne4 x1 0 0 ne1 x2 ... 0 ne4 x2 ne1 x2 ne1 x1 ... ne4 x2 ne4 x1 , [ e] = e x1 0 0 e x2 e x2 e x1 , (46) element vector [due] order as: [due] = [ (du1x1) (du 1 x2 ) ... (du4x1) (du 4 x2 ) ]t , = [ dex1 d e x2 ]t , (47) gener strain increment singular point xe , posit center element eddm coincid x e r, shown figur 8, character kine- matic descriptors: des(x e s) = ( deu, d e , d e ) , (48) descriptor defin (45). agreement (42), virtual action domain e-th finit element, defin as: 22 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y ue = 4 p=1 n ep u p,e + m ee , (49) up, e vector paramet interpol continu displac displac jump virtual actions, respectively. also, agreement (45), virtual regular strain are: er = b e(xer)[ u e] [e](xer)[ e] . (50) remark: element state 2 (eddm h ddm ) intersect cracks. construction, shown figur 8-c, support enrich function e m e iseddm . then, element have state 0 1 (h0 h csm ) follow particularities: outsid influenc zone crack; insert oper definition, equat (20), ident zero; insert oper ir(deu,0) distribut uniformli macro-strain deu rve domain; mmrp procedure, evalu constitut relat e integr points, result ident convent semi-concurr homogen techniqu report literatur (see exampl mieh koch [47]), sens increment macro-strain deu uniformli distribut rve, overal stress e volumetr averag micro-scal stress . 3.1.2 discret equilibrium equat introduc strain virtual action field (express (45) (50) finit element ddm), variat problem (7) perform variat ue, e fix zero, obtain discret version equilibrium equat follows: neleme=1 e\s (be)t f int f ext = 0 , (51) f int f ext global vector intern extern forces, respectively, finit element assembl oper e macro-scal element stress arrang voigt notation. vector f int equat (51) evalu adequ integr rule, accord state finit element. element state 0 requir standard integr rule gauss points, element state 1 2 requir integr point (the integr point place central posit element repres xer figur 8). alternatively, traction equilibrium equat se, se eddm h ddm , consist deriv (7). instead, follow oliv et al. [48], pointwis traction equilibrium equat (skon formul accord denomin coin literature) propos follows: 23 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y t e(xes) = e(xer)n e, e hddm . (52) traction vector t e evalu integr point xe attach cohes surface, figur 9. vector obtain mmsp homogen procedur describ box 2. hand, stress e evalu regular point xer mmrp homogen procedur describ box 1. equat (52) finit element eddm state 2 ( e ddm h ddm ). x s( ) w e xr rve wm mmrp xr e e t(x )s rve wm mmsp m l e e s s ir (de,de)u b (de,de,db)u b e e e e e e e se ddm figur 9: integr point finit element state 2 ddm (eddm hddm ). regular (xer) singular (xes) integr points. note accord figur 9 mmsp procedure, strain local domain sl rve associ point xe , determin nucleat cohes crack s e macro-scale. numer implementation, evalu domain perform switch state 1 state 2, pseudo-time: tsd, tsd > tn , figur 8-a. interv [tn , tsd], local process rve show fast development. so, failur mechan open cohes surfac rve clearli defin tsd tn , domain sl accur determined. stiff matrix finit element ddm stiff matrix element ddm, state 2, deriv equilibrium equa- tion (51) (52), written follows: ke = [ keuu k e u keu k e ] , (53) sub-matrix is: keuu = [b(x e r)] t e(xer) ue |e| , (54) keu = [b(x e r)] t e(xer) e |e| ; (55) keu = t e(xes) ue ne e(xer) ue |e| , (56) ke = t e(xes) e ne e(xer) e |e| , (57) 24 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y symbol |e| denot area finit element. stress deriv express consid stress homogen equat (27) macro-scal regular strain (see equat (45)): e(xer) ue = chomb , (58) e(xer) e = chom[e] , (59) homogen tangent tensor chom given by: chom = 1 || ( c +ca(y) ) d; a(y) = er , r33 . (60) operatora deriv implicit function depend (er) establish micro-scal equilibrium problem (28), box 1. then, linear oper a(y) deter- mine solv linear micro-scal equilibrium problem (in r2). addit detail [22] [43]. finally, traction homogen express (39) box 2 relat mmsp procedur derived, result follow expressions: t e ue = |sl | nop j=1 s lj n lj cd(y)d , (61) t e e = |sl | nop j=1 s lj nlj (c +cc(y))d , (62) defined: d(y) = ue , c(y) = e , (63) comput consid implicit function depend d(der, d e) given equat (40). oper solv micro-scal equilibrium problem. 3.2 micro-scal finit element model finit element model micro-scal implement convent techniqu appeal explicit inclus strong discontinuities. let consid finit element domain rve, denot h , boundari h unit normal vector h , shown figur 10-a. micro-scal displac fluctuat increment field, du, interpol h follows: du(y) = nnod k=1 nk(y)dq k , (64) 25 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y nnod number node micro-scal finit element mesh, nk shape function k-th node qk vector interpol parameters, relat k-th node, displac fluctuations. micro-scal strain increment finit element e is: d e (y) = i(d) +b e (y)[dq e ] d e , (65) insert oper i() defin (21), (33), depend macro-scal point rve associ with, andb e convent strain-displac matrix micro-scal finit element e. term (65) micro-scal strain fluctuat increment d e (y). vector [dq e ] collect interpol paramet finit element displac fluctuat increments. 3.2.1 us two-dimension band-lik domain two-dimension constant strain triangl (cst) elements, displai high aspect ratio distribut form band-lik domains, insert element edg origin finit element mesh, shown figur 10. so-form band bi (superscript identifi band number) associ thick- ness `i, normal vector n mean surfac si, shown figur 10-b. band area |si| (or length unit thickness) defined, |bi| = |si|`i, |bi| volum respect band. geometr distribut cst element form band shown grai figur 10, aspect ratio increas `i 0. displac fluctuat strain field band describ equat (64) (65), respectively. object introduc micro-scal band mesh captur failur mechan induc strain local effects. procedur consid alter- nativ techniqu standard cohes interfac finit elements. distinguish featur present approach assign continuum constitut model materi consti- tute micro-scal bands. strain local forc happen exclus band bi defin regu- lariz strain soften materi response, elastic, non-elast (but strain hardening), materi respons adopt constitu composit (and model fi- nite element origin mesh). strain local band initi micro-scal bifurc condit reached. addit concept associ band bi introduc present finit element model. let defin local orthogon coordin (, ) align band, place line result intersect si plane analysis, shown figur 10-c. let consid displac jump fluctuat increment band, di, defin coordin follows: di() = du( +, ) du(, ) = du+ () du () , (66) 26 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y wm rve h cst element origin fe mesh gm n h m h (a) lm sm z u m 3 (n )+m (c) +(g)m -(g)m u m 2 u m 1 p ct element i-th micro-scal band h m (n )m i- +(g)m b -(g)m (n )+m u m + u m - z lm sm m ib n m (b) m ib figur 10: rve finit element model. (a) cst finit element arrang like band insert edg origin finit element (the band-lik domain depict grey); (b) band bi associ geometr en- titi (thick `i, normal vector n mean surfac si), (c) local coordin (, ) i-th band displac fluctuat vector cst element nodes. coordin + indic posit boundari (+ ) posit boundari ( ) i. surfac (+ ) ( ) limit band depict fig- ure. accord notat figur 10-c, note micro-scal strain fluctuat increment cst element belong bi, given (see addit detail work manzoli et al. [49]): di = di s n+i `i +o (dq2 dq1 |si| ) , (67) di = dq 3 dup , dup displac fluctuat increment interpol point p . point p orthogon project node 3 ( ) i. second term (67) neglect `i |si| band initi strain local process. case, micro-scal strain fluctuat increment d e interpol (65) cst element, natur approach to: d e di(0) n+i `i . (68) constitut relat micro-scal band continuum damag model present box 3 describ materi respons band bi. constitut relat taken oliv [18]. accord equat (69), intern variabl model, q r, evolut equat (72)(73), determin isotrop damage, d, defin degrad origin elast respons rule elast constitut tensor c. initi valu q r q0 r0, respectively. variabl r seen maximum valu strain norm reach load history. 27 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y relat r q given soften modulu h < 0, shown equat (72). paramet character fractur energy, gf, micro-scal materi constituent. remark aspect damag model box 3 regular soften modulu h, paramet `, describ equat (73). posit counterpart effect micro-scal stress, (eff )+, introduc dam- ag criterion (70) object model damag evolut tensil stress con- dition. adopt continuum damag model micro-scal band bi, `i small compar micro-cel size, consid that: a) soften modulu damag constitut relat regular length `i, that, total dissip energi depend length (thi reason introduc length `i definit h, shown equat (73), box 3); b) elast respons ident neighbor bulk material, that, overal rve elast respons independ size `i; then, conclud complet respons rve independ valu adopt `i. identif strain local domain t = tsd. singular correspond acoust tensor verifi cst element bi, time tin (with t n < tn ), band identifi nucleat micro-scal band. consid- er nc nucleat bands, then, complet domain nucleat band denot b, b = nci=1b . addit ingredi introduc rve finit element model refer open strain local domain, denot bl , figur 11. domain defin macro- scale bifurc condit detect t = tn . typically, bl evalu t = tsd (with tsd > tn shown figur 8-a). mention sub-sect 3.1.1, solut equat (41) provid macro-scal eigenvectors, nebif . assum nucleat band bi open t = tsd if: d (nebif ) > 0, d micro-scal strain fluctuat increment evalu cst element band. case, band identifi notat blj . contrarily, nucleat micro-scal band close t = tsd condit satisfied. then, bl defin bl = nop j=1b lj , nop number open micro-crack t = tsd. number nucleat micro-scal band close t = tsd ncl = nc nop. note element b identifi superscript (bi), while, element bl identifi superscript lj, index j denot specif band set. accord notation, geometr entiti associ band blj denot superscript lj, e.g.: n lj , s lj , ` lj . 28 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y box 3: regular tensil damag model micro-scale. elast stress-strain relat = q r c = [1 d(r)] eff c , d(r) = 1 q(r) r . (69) damag criterion g (, r) = ( eff )+ r 0 , (eff )+ = 3 i=1 ( eff )i ei ei . (70) loading/unload complementari condit r 0, g 0, r g = 0 , r|t=0 = r0 = u e . (71) intern variabl evolut law soften q = h(r) r, q 0, q|t=0 = q0 = r0 , (72) h(r) = ` r 2 0 g f exp [ ` r0 g f (r r0) ] . (73) tangent constitut tensor r = 0, c tan = (1 d)c (74) r > 0, c tan = (1 d)c [ q h r r3 ] eff ( eff ) + . (75) materi paramet u : ultim tensil stress, g f : fractur energy. e, : young modulu poisson ratio, defin elast constitut tensor c definit variabl r : strain-lik intern variable, q : stress-lik intern variable, d : scalar damag variable, h : soften modulu (exponenti degradation). eff : effect stress, ( eff )i : i-th princip stress eff , ei : i-th eingenvector eff , ( eff ) + : posit counterpart effect stress, : macaulai brackets, ` : strain local band thickness, 29 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y rve b n lm j x s +qdeb +qdeb (bn (y))sq l (y)m md +qde+b lj lj e e e e mmsp (de,de,db)u b m macro-scal finit element lj m ljb s m ljb wm hw (n )+ +(g)m m (u )m + lj lj lj nm lj - (n )-m lj(u )-m lj (g)m lj open strain local domain m l b =s =s =s ddm figur 11: oper mmsp homogen procedure. macro-scal strain insert micro- scale finit element mesh, h identif macro-scal normal vector ne t = tsd. macro-scal normal vector ne implement efem techniqu evalu t = tsd follows: ne = nop j=1 s lj n lj ds nop j=1 s lj n lj ds (76) consid tortuos paramet defin equat (17), note ne averag vector obtain integr n lj sl scale , ne = 1. evalu ne equat (76) requir vector n lj defin follow rule: n lj nebif > 0 , j = 1, ..., nop , (77) nebif eigenvector macro-scal bifurc problem equat (41). accord numer experience, result present sub-sect 4.2, differ observ so-determin vector ne nebif exce degrees. 3.2.2 implement insert oper forthcom developments, superscript e indic macro-scal finit element re- move insert macro-scal kinemat objects. express (65), oper i() insert macro-scal strain accord proce- dure defin section 2.3. mmrp homogen procedur used, equat (21) indic oper ir() insert uniformli macro-scal strain increment du + d element h . uniform distribut includ cst band element (even correspond nucleat bands). 30 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y alternatively, mmsp procedur used, oper is() insert uniformli macro-scal strain increment, du + d , element h (includ cst element nc bands), addition insert term d strain local domain bl . therefore, maro-scal strain increment insert cst element band blj (see figur 11): is(du, d, d) = du + d + [ d s nlj ` lj ] . (78) 3.2.3 displac fluctuat virtual action field accord equat (23) displac field interpol (64), defin discret space displac fluctuat increment mmrp homogen procedure, u rh h follows: u rh = { du(y) = n nod k=1 nk(y)dq k , h du s hd = 0 } . (79) kinemat constraint (79) ensur zero averag value, h , micro-scal strain fluctuat increment field d, defin finit element e as: d e = b e (y)[dq e ] . (80) discret space virtual displac action v rh is: v rh = { u(y) = n nod k=1 nk(y)q k , h u s hd = 0 } . (81) alternatively, consid mmsp homogen procedure, accord (35) (64), discret space displac fluctuat increments, u sh h , defin follows: u sh = { du(y) = n nod k=1 nk(y)dq k , h du s hd = 0; nop j=1 s lj d lj s n lj ds = 0 } , (82) where, notat previous introduced, consid displac jump fluctuat increment d lj band b lj , defin as: lj = (u + ) lj (u )lj , (u+ ) lj (u ) lj interpol displac fluctuat band lj coordin , shown insert figur 10. 31 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y discret space virtual displac action vsh is: v sh = { u(y) = n nod k=1 nk(y)q k , h u s hd = 0; nop j=1 s lj lj s n lj ds = 0 } , (83) where, concord comment paragraph above, virtual variat displace- ment jump band blj defin = u+ u . second kinemat constraint defin u sh v sh , extend sl , ensur satisfact ident (30) inter- polat micro-scal strain fluctuations. kinemat constraint defin h (79), (82), seen specif kind boundari condit defin rve. follow denomin introduc previou work (see [43]), standard boundari condit (sbc) typic kinemat constraint defin convent semi-concurr multi-scal models. constraint impos sl , express (82), call non-standard boundari con- dition (nsbc). seen boundari condit domain bl . remark specif kinemat constraint given: standard boundari condit (sbc): model strictli satisfi kinemat constraint (79) call minimum kinemat constrain sub-model. however, kine- matic constrain sub-model defined, as: taylor, linear period (see toro et al. [43]). kinemat constraint introduc differ sub-model plai import role adequ captur failur mechan rve lead complet degrad material. failur mechan defin macro-scal bifurc time tsd detected. thus, t < tsd, carefulli analyz chosen sub- model inhibit format expect failur mechanism. impedi develop failur mode spuriou kinemat boundari condit produc delai bifurc detection, possibly, identif altern failur mechanism. issu strongli associ micro-cel size adopt analysis. larger micro-cel size tend decreas effect introduc boundari conditions, analysi present toro et al. [43]. general, smaller micro-cel size util promot correct failur mechan adequ boundari condit postulated. non-standard boundari condit (nsbc): macro-scal crack activ d 6= 0, nsbc introduc model. nsbc present finit element model defin displac fluctuat increment field du(y) constrain vector d lj = d(u + ) lj d(u )lj , local band b lj , satisfi second constraint express (82). particular sub-model trivial satisfi nsbc consist defin d(u+ ) lj = d(u ) lj 0 (i.e. fix zero increment displac fluctuat node 32 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y boundari bl ) give d lj 0 . sub-model gener taylor sub-model extend mmsp approach, chosen solv problem present section 4. note that, fix zero displac fluctuat increment open local bands, non-homogen deform take place bands. fact, kind deform induc macro-scal strain insert oper . numer treatment kinemat constraint space u rh u sh (or alternatively, v rh v sh ) implement introduc kinemat constraint (sbc nsbc) addit homogen linear equat degre freedom (d.o.f.s) model. let [dq], [dq] r2nnod , vector collect complet set interpol paramet displac fluctuat increment field ([dq]t = [ [dq1] t , ..., [dqnnod ] t ] ) finit element model. so, ndof = 2 nnod identifi total number d.o.f. model. direct mathemat treatment allow write sbc nsbc nd homo- geneou linearli independ equat follow (see addit detail point toro et al. [43]): h[dq] = 0 ; h r(nd,ndof ) (84) previou equation, vector [dq] partit vector dimens nd nf = ndof nd : [dq] = [ [dq]f [dq]d ] , [dq]f rnf , [dq]d rnd , (85) [dq]d = l[dq]f , (86) l matrix coeffici defin accord kinemat constraints, discret space, modeled. so, l = lrh identifi coeffici matrix impos sbc constraint seen (79), l = lsh matrix impos both, sbc nsbc, constraint seen (82). rve discret vector [dq]f [dq]d interpret free depend partit total d.o.f.s, respectively. next, identifi finit dimension vector space correspond vector paramet displac fluctuat increments: u rq = { [dq] rndof , and: [dq] = [ [dq]f lrh[dq]f ]} , (87) u sq = { [dq] rndof , and: [dq] = [ [dq]f lsh[dq]f ]} . (88) finit dimension vector space correspond vector paramet virtual ac- tions, defin v rq u rq v sq u sq . 33 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y note that, field du obtain interpol (64) vector [dq] u rq , strictli satisfi du u rh (or alternatively, field du obtain interpol (64) vector [dq] u sq strictli satisfi du u sh ). 3.2.4 micro-scal variat equilibrium problem. variat discret equilibrium equat h mmrp homogen procedur implement follows: [q] u rq , that: h d = [q]tf int = 0 , [q] v rq , (89) vector intern forc f int ([q]) is: f int = nelem e=1 e b e t e ( e ) d . (90) stress e (90) evalu correspond constitut relat associ micro-scal components. also, micro-strain e determin (65) (80). assembl oper intern forc vector (90), includ total number finit element (nelem) h , cst element micro-scal bands. express (89) propos discret implement approxim micro-scal equi- librium (28). numer strategi solv (89) present toro et al. [43]. observ that, consid (89), space u sq v sq instead u rq v rq , variat equilibrium equat numer treatment given mmsp obtained. connect variat equilibrium equat (89), consid space u sq v sq , equilibrium equat (40) micro-cel cohes surfac shown follow identity, hold present micro-scal finit element model cst bands: h d = h\b d+ nc i=1 si t ds = 0 , [q] v sh , (91) where, intermedi ident obtain partit integr disjoint set h\b b, appli diverg theorem integr b. here, recal assum `i 0. furthermore, (91), define: t = (n ) +. therefore, second term middl express (91) interpret virtual intern power cohes traction t act band bi. note variat equilibrium equat (91), aris present finit element model micro-scale, resembl express (40) defin model strong discontinu kinematics. strain local observ i-th band (cst elements), vector i, i, assum small. then: lim `i0 `i o(\b) , (92) 34 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y \b strain zone adjac band b . intern power bi is: bi t ds 0 . (93) but, strain local process start i-th band, rel displac node band longer assum negligible. rel displac band role displac jumps. then: lim `i0 `i (94) intern power bi longer necessarili small. so, kinemat finit element behav like strong discontinu kinematics, band element introduc similar respons convent cohes interfac elements. finit element techniqu comput simul materi failur seen regular procedure, continuum displac interpolations, problem displai strong discontinuities. similar techniqu mono-scal analysi report manzoli et al. [49] oliv et al. [31]. 3.2.5 degener cst element strain local simul rve failure: pro con comput techniqu develop micro-scal analysi remark features: a) contrarili observ respons classic interfac cohes model used, cst band element describ continu damag model ident elast behavior bulk materi featur spuriou stress oscillations. b) approach, coupl impl-ex constitut integr scheme (c.f. oliv et al. [48]), robust. non-standard step numer implement rve finit element model relat mesh generation, sens that, arbitrari mesh ought receiv pre-treat introduc cst band element finit element edg origin mesh. turn, note limit model micro-structur failur mecha- nism technique: i) arbitrari crack path captured, crack path nec- essarili follow element edg predefin finit element mesh, ii) sever numer lock aris captur shear band nonalign cst element taken. defi- cienci alleviated, part, damage-typ model character cst elements. 3.3 track algorithm determin macro-scal crack path problem find geometr posit sh h macro-scale, import issu finit element implementation. mention above, crack path precis determin insert enrich ddm mode element state 2. 35 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y achiev objective, first, defin new field %(x) macro-scal h follows: %(x) = 1 || nc i=1 bi rdb , (95) so, % averag valu cell micro-scal strain-lik intern variabl r defin box 3. r repres maximum strain measur load history, r large, proport 1/`i, band displai strain localization. however, integr (95) necessarili zero `i 0 area band |bi| goe zero. instant macro-scal bifurcation, t = tn , %(x) quickli increases, suf- ficient larg number micro-scal band subject load processes. therefore, macro-scal region materi reach instabl condit character larg valu %. contrarily, % zero region inelast regim achieved. us properti field % predict geometr posit evolv discontinu surfac sh. let take, macro-scal finit element domain h, space function l coincid standard bilinear interpol field h1(h) quadrilater finit element, space piece-wis constant functions, c (h): c (h) := {(x) | (x) = constant e}. (96) geometr posit sh intersect finit element mesh detect solv success problems, describ follow item step 1 2. step involv project discontinu field l . step 1: field (x) l , that: h ( %(x)) dh = 0 ; l . (97) then, (x) seen smooth %. quadratur rule integr (97) follow similar scheme defin sub-sect 3.1. step 2: direct deriv , hc c , direct given vector : hc ( e) = x(xes) (x e s); (98) vector field suffici smooth extens h normal vector sh locat found. finally, so-cal crack-path field l determin smooth hc . evalu accord projection: ( hc ) d h = 0 ; l (99) manifold (x) defin zero level set crack-path field : 36 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y x iff (x) = 0. (100) shown (see oliv et al. [46]) discontinu surfac satisfi sh . therefore, problem determin sh reduc find set given algebra procedur defin equat (97)(100). 4 numer assess recent contribut author (toro et al. [44]), import issu present multi- scale model, sensit macro-scal solut tortuos paramet changes, analyzed. here, addit studi conduct valid implement multi-scal methodology. goal mind, concret fractur problem solv consid hetero- geneiti observ meso-scale. hence, numer simul account two- scale analysis: a) structur scale b) meso-structur scale length order aggreg sizes. interact effect aggreg cement-bas matrix, mainli relat fracture, includ analysis. first, sub-sect 4.1, meso-structur model develop concrete. defin constitu consid meso-scal possibl interactions. sub-sect 4.2, simpl uniaxi macroscop stretch test, assess sensit structur result chang mesoscop cell size finit element size model cell. finally, sub-sect 4.3 simul doubl notch beam bend concret test. result comput multi-scal model valid compar direct numer simul (dns) solutions. 4.1 concret failur model meso-scal meso-scale, main constitu recogn concrete: cementiti matrix, aggreg interfac transit zone matrix/aggreg (itz). itz constitu plai import role degrad mechan composite. failur gener initi itz, consid weakest link concret low moder strengths, posterior propag crack matrix. kind concrete, trans-aggreg fractur observed. then, present model, aggreg assum behav like elast materi degrad all. meso-scal model concret failur develop section follow close approxim report carol et al. [50] unger eckardt [51]. meso-structur model represent ideal two-dimension composit model meso-scal per- form selecting, plane analysis, differ shape size particles. particl repres aggregates, randomli distribut mesoscop squar cell dif- ferent sizes, depend test shown following. aggreg assum 37 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y shape similar irregular convex polygon size determin prede- fine grade curv (83% particl size 3[mm] 4[mm], 17% particl size 4[mm] 5[mm]). total volum fraction aggreg result 20.7%. aggreg distribut intersect rve boundaries. accord finit element procedur describ section 3.2, meso-scal model design shown figur 12. cst element like-band insert itz, edg finit elements, origin mesh, cover matrix domain. cst element character damag model describ box 3. aggreg matrix interfac matrix-aggreg elast matrix interfac matrix-matrix (damag model) interfac matrix-aggreg itz (damag model) aggreg elast aggreg (a) (b) figur 12: mesoscop concret model. materi paramet meso-scal model materi paramet mesoscop model shown tabl 1. data taken unger eckardt [51] elast moduli increas 10%. paramet defin [51], peak stress fractur energi constituents, consid rough estim simul concret beam test sub-sect 4.3 note experimen- tal work (bocca et al. [52]) taken valid numer result sub-sect 4.3, report overal young modulus: e = 27.[gpa] overal fractur energi gf = 100.[n/m]. e [gpa] u [mpa] g f [n/m] elast matrix 20.4 0.18 elast aggreg 40.8 0.18 interfac matrix-matrix 20.4 0.18 2.6 140. itz matrix-aggreg 20.4 0.18 1.3 70. tabl 1: materi properti meso-structur depict figur 12. paramet defin are: young modulus, e, poisson ratio , peak stress u fractur energi g f . 38 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y 4.2 multi-scal model sensit analysi simpl macro-structur test, link complex mesoscop cell model de- fine previou sub-section, analyz sensit multi-scal model respons chang cell size finit element size meso-scal model. analysi address evalu sensit of: i) crack pattern obtain meso-scal level; ii) macro-scal crack orient obtain equat (76); iii) homogen traction-separ law macro-scale. studi strip size 125mm125mm thick 100mm undergo uniaxi stretch- ing, depict figur 13. analys perform strip: - case a) specimen stretch directions: = 0.deg, = 30.deg = 45.deg, respectively, solv mesoscop cell size 25mm25mm, 50mm 50mm 75mm 75mm. case, size finit element similar cells; - case b) specimen stretch direct = 0.deg case a) solv cell size 50mm 50mm, mesh finit element size are: coars (mesh i), medium (mesh ii) fine (mesh iii). cases, kinemat constraint impos micro-cel are: a) minim kinemat constraint displac fluctuat increment cell vertic fix zero sbc; b) taylor sub-model nsbc. note that, specimens, micro-cel model edg parallel hor- izont vertic directions. so, expect failur pattern develop specimen intersect micro-cel edg differ angles, depend stretch direct macro-scale. therefore, analysis, possibl assess effect (if any) induc sbc nsbc captur differ meso-scal failur patterns. case a): sensit analysi chang cell size failur mode captur meso-scal specimens, differ cell sizes, analyz figur 13. figur displai deform configur mesoscop cell end analysis. deep red shown cst finit element open end analysis, defin strain local domain bl . light blue depict cst finit element open pre-crit regime, close post-crit regime. tabl 2 present addit sensit results. angl form macro-scal normal vector ne horizont direct shown there. vector determin equa- tion (76). tortuos parameters, evalu equat (17), present column table. note small dispers obtain differ instances, close coincid result direct ne stretch direction. 39 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y c e ll 5 0 x 5 0 c e ll 7 5 x 7 5 c e ll 2 5 x 2 5 a=0 a=30 a=45 figur 13: sensit analysi chang cell size. mesoscop cell deform configur end analysis, depict failur mode differ specimen cell sizes. 40 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y mesoscop cell princip angl tortuosisti size [mm] stretch angl macro-scal normal paramet [deg] ne [deg] 25x25 0. 5. 0.89 25x25 30. 26. 0.87 25x25 45. 50. 0.86 50x50 0. 4. 0.88 50x50 30. 33. 0.82 50x50 45. 43. 0.84 75x75 0. 0. 0.86 75x75 30. 26. 0.85 75x75 45. 43. 0.86 tabl 2: macro-scal normal angl (ne) tortuos paramet obtain differ meso- scopic cell size specimen stretch angl . figur 14-a displai structur forc (f ) vs. macro-scal displac () curv instances. again, close coincid observ cases. expected, conver- genc observ cell size increased. turn, figur 14-b presents, mesoscop cell 50mm50mm stretch direct 30.deg, normal compon macro-scal stress (nn) vs. macro-scal strain (nn) pre-bifurc regim (t tsd). figure, plot normal compon macro-scal traction (tn) vs. normal compo- nent macro-scal displac jump (n) post-bifurc regim (t tsd). responses, plot figur 14-b, obtain differ homogeniza- tion procedur (mmrp mmsp), import analyz continu t = tsd provid them. import issue, continu respons procedur present multi-scal model result introduc tortuos paramet insert oper i, as, traction homogen formula (39), addit discuss aspect model [44]. analysis, conclud cell 25mm 25mm provid result consid object present concret mesoscop model. furthermore, macro-scal response, includ traction-separ law, evalu normal vector ne tortuos paramet , significantli sensit mesoscop cell size cell larger 25mm 25mm. case b): sensit analysi chang finit element mesh size structur problem case a) micro-cel 50mm 50mm stretch horizont direction, analyz result obtain differ finit element meshes: mesh (i) 4190 finit elements; mesh (ii) 7964 finit element mesh (iii) 17970 finit elements, respectively. figur 15 displai crack pattern observ mesoscop cell end analysis, tortuos paramet angl form normal vector ne horizont direction, obtain case. analysis, conclud evalu tortuos paramet macro-scal normal vector ne sensit finit element mesh size. 41 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y (a) (b) 0 0.02 0.04 0.06 0.08 0.1 0 0.5 1 1.5 2 2.5 3 cell 25x25 cell 50x50 0 0.02 0.04 0.06 0.08 0.1 0 0.5 1 1.5 2 2.5 3 cell 75x75 0 0.02 0.04 0.06 0.08 0.1 0 0.5 1 1.5 2 2.5 3 0 0.02 0.04 0.06 0.08 0.1 0 0.5 1 1.5 2 2.5 3 cell 25x25 cell 50x50 cell 75x75 a= 0 0 0.02 0.04 0.06 0.08 0.1 0 0.5 1 1.5 2 2.5 3 cell 25x25 cell 50x50 cell 75x75 a= 30 0 0.02 0.04 0.06 0.08 0.1 0 0.5 1 1.5 2 2.5 3 d [mm] cell 25x25 cell 50x50 cell 75x75 a= 45 a=0 a=30 a=45 a=0 a=30 a=45 a=0 a=30 a=45 d [mm]d [mm] d [mm] d [mm] d [mm] d f f [n]x 10 4 f [n]x 10 4 f [n]x 10 4 f [n]x 10 4 f [n]x 10 4 f [n]x 10 4 0 0.5 1 1.5 2 2.5 0 0.01 0.02 0 0.5 1 1.5 2 2.5 0 0.02 0.04 0.06 s = f / (l x t h ic k n es s) [ m p ] t=tsd t=tsd t<t (mmrp)sd t>t (mmsp)sd n n e = d/lnn t [mpa]n bn d bn tn f nl l cell 50x50 a= 30 d f d f e figur 14: sensit analysi chang cell sizes. a) load vs. displac plot specimen cell size 25mm 25mm, 50mm 50mm 75mm 75mm; b) macro-scal stress- strain curv (nn vs. nn, subscript indic compon direct ne) pre-bifurc regim macro-scal traction-separ law (tn vs. n) post-bifurc regim captur micro-cel 50mm50mm stretch direction: 30.deg. 42 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y cell 50x50 =0.88 =0.84=0.86 mesh (iii):17970 femesh (ii): 7694 femesh (i): 4190 fe angl n = 1[deg] d f q q q a= 0 (a) e angl n = 4[deg] angl n = 4[deg] e 0 0.02 0.04 0.06 0.08 0.1 0 1 2 3 d [mm] 4190 cell 50x50 element 7694 element 17970 element (b) f [n]x 10 4 figur 15: sensit analysi chang finit element mesh size. solut obtain mesh (i), (ii) (iii), respectively. (a) failur mechan observ end analysis, tortuos paramet angl form normal vector direct (ne) horizont axis; (b) structur forc (f ) vs. macro-scal displac () curves. 43 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y 4.3 point shear concret specimen beam load displai figur 16-a numer simul assum plane stress condition. figure, unit length given millimeters. beam correspond 27 concret specimen report bocca et al. [52] (b = 200.mm c/b = 0.8), which, accord authors, conceiv assess shear effect process cracking. beam model simul multi-scal formul develop work ms model) result compar valid solut obtain differ- ent direct numer simul (dns) model meso-structur particularli regarded. reason solv dn problem assess high sensit dispers numer result detect specif problem chang aggreg dis- tribut zone close notches. p, 5p/6p/6 4 0 1 2 0 320 32080 80 10 ms c elast thick = 100 mm 4 0 b l c matrix, elast aggregate, elast matrix-matrix interface, damag matrix-aggr. interfac (itz), damag hom (c) (a) ms model dn model 25mm 2 5 m m (b) figur 16: point shear concret specimen. (a) geometri multi-scal (ms) finit element model (dimens millimeters), (b) mesoscop cell, (c) (of three) dn model. ms finit element model finit element mesh adopt ms model macro-scal shown figur 44 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y 16-a. multi-scal approach central zone beam, depict blue. remain specimen, depict gray, elast mono-scal region assumed. homogen elast tensor chom multi-scal model taken simul elast respons mono-scal model. meso-scal model cell depict figur 16-b. first, compar discuss dn ms numer solut using, case, micro-cel subject follow type boundari condit (bc): bc type i: a) sbc: minimum kinemat constraint zero displac fluctuat ver- tice cell; b) nsbc: taylor sub-model. additionally, final section, compar numer solut obtain ms models, us micro-cel subject describ boundari condit type i, us follow boundari conditions: bc type ii: a) sbc: periodic; b) nsbc: taylor sub-model. dn finit element model figur 16-c show dn models. dn finit element model built ident approach adopt model meso-scal cell describ sub- section 4.1. so, random distribut aggreg insert central beam preserv volum fraction aggregates. finit element mesh cst element form bands, place edg element origin mesh, considered. mesh dn model us similar size finit elements. discuss result a) morpholog crack pattern figur 17 displai evolut fractur process obtain dn model. deep red shown band form cst finit element open end analysis. defin crack path lead structur collapse. light red depict band open load process final close. complet fractur process describ differ stages. first, larg number parallel small crack (length order aggreg sizes) dispersed. approxim orthogon princip stress direct (depict cross). meso-scal crack nucleat complet central region notch beam (see figur 17-a b). notably, second stage, cracks, close 45 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y notches, coalesc differ direction, form compet macro-scal princip cracks. propag macro-scal crack final lead structur collapse. observ following, present multi-scal model captur accept accuraci complex fractur process. princip stress direct (b) (c) (d) (a) macro-crack coalesc direct princip stress direct figur 17: point shear concret specimen. a-d) sequenc pictur displai crack pattern evolut obtain dn model (band form cst finit element open end analysi depict dark red, band open load process final close depict light red). figur 18-a compar numer structur respons term load p versu vertic displac . plot experiment result taken bocca et al. [52], roughli presented. plot denot ms correspond numer multi-scal solut (bc case i). observed, structur peak load slope peak load estim model comparison experiment results. however, structur energi dissip larger observ experiment result. dn solut provid addit estim ms result accuracy. plot dn solut dispersed, mean numer structur respons sensit respect meso-scal design (aggreg distribution) close notches. numer behavior notch geometri adopt present model. figur 18-b depict sequenc pictur (a-k) correspond evolut cohes 46 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y deform. scale = 9600 deform. scale = 4800 deform. scale = 2400 deform. scale = 2400 deform. scale = 1200 deform. scale = 600 b b c c d e e f f g g l h j k (b) (c) b c d e f g h j l p x 1 0 [n ] 4 vertic displac [mm] (a) -0.12-0.08-0.040 -4 -3 -2 -1 0 point r bifurc pseudo-tim (t point r) ms dns1 dns2 dns3 experiment k t point r sd n figur 18: point shear concret specimen. (a) experimental, ms dn structur load p vs. vertic displac , (b) sequenc pictur show evolut crack macro-structur scale (finit element red belong tohddm (state 2), element green belong domain h csm (state 1)), (c) sequenc pictur displai deform configur cells, term displac fluctuations, point r shown inset figur 18-a (element dark red correspond band load states, element light red correspond band unloading). 47 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y crack macro-scale. finit element red belong tohddm (state 2), element green belong domain hcsm (state 1). pictur k relat pseudo-tim instant shown (ms) structur respons plot figur 18-a. initially, crack start propag notch root (pictur e). however, crack initi superior notch stops, continu propagating. experiment report ([52]) show broken specimen, ratio: c/b = 0.4. there, observ curv crack develop notch root load applic point. present simul c/b = 0.8, crack induc structur degrad straight. figur 18-c show sequenc pictur displai failur evolution, term dis- placement fluctuations, mesoscop cell associ macro-scal point r. macro-scal posit point r mark inset figur 18-a. pictur figur 18-c associ point mark b-l figur 18-a, displai cell fractur pro- cess load history. element dark red correspond band load (opening) states, element light red correspond band unload (or closing). observ pictur c correspond instant tn finit element macro-scal (in r) switch state 0 1. also, shown pictur g, instant strong discontinu (sd) embed macro-scal element (switch state 1 2). expected, sequenc pictur show materi degrad point r start itz element (pictur b). complex pattern crack develop (inset d-f), mo- ment embed strong discontinu macro-scal (point g), crack pattern mesoscop cell defined. (g l), crack pattern remain fix end analysis. figur 19 show macro-scal crack path end analysi normal vector ne crack. deform configur mesoscop cells, depict term displac fluctuat field, correspond differ point macro-crack, shown. b) stress distribut color map figur 20-a compar smooth field princip stress (i iii ) obtain ms model dn models. load level p stress field evalu depict plot p vs. figur 20-b. instant, main crack model reach posit depict insert figure. figur 20-a, homogen stress ms model taken quadratur point place regular domain beam. then, smooth final princip stress evaluated. dn model stress evalu spatial averag stress tensor circular domain radiu 12.5 mm center point coincid nodal posit ms mesh. princip stress averag stress tensor depict figur 20-a. result depict figure, observ ms stress distribut bit noisy, notabl good close agreement stress result provid models. 48 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y figur 19: point shear concret specimen:. crack geometri macro-scal failur mechan mesoscop cell associ differ point crack. deform configur cell depict displac fluctuat scale factor 600. distribut normal vector ne crack path macro-scal shown green arrows. 49 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y s (ms) (dns) princip strese [mpa] s (dns)iii s (ms) iii (a) (b) vertic displac [mm] p x 10 [n]4 load level stress shown figur 20: point shear concret specimen. stress distribut given load level. a) princip stress (i ,iii ) field obtain dn ms models, b) posit main crack dn ms solut instant stress captur figur 20-a. color domain ms dn pictur mean figur 17 18, respectively. 50 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y c) comparison result obtain ms model differ micro-cel boundari condit figur 21, solut obtain ms model depicted. compar solut provid ms model differ type sbc constrain micro-cel kinematics. type bc correspond sbc minim kinemat constrain type ii bc correspond sbc period kinemat constraints. figur 21-a plot structur respons simulations, figur 21-b displai fractur end analysi caus structur collaps case. -0.12-0.08-0.040 p [n]10 4 -4 -3 -2 -1 0 type i: sbc minimum constraint type ii: sbc period constraint ms type i: sbc minimum kinemat constraint ms type ii: sbc period constraint vertic displac [mm] (a) (b) figur 21: point shear concret specimen: comparison result obtain ms model micro-cel type sbc: type (sbc minimum kinemat constraints) type ii (sbc period kinemat constraints). a) structur responses, b) crack end analysi (color domain mean figur 18). 5 conclus main contribut paper focus describ numer implement two- scale semi-concurr model fractur analysis. cohes surfac assum scale analysis. distinct characterist model assum differ homogen procedur overal materi respons materi degrad process: i) initially, stabl respons point macro-scale, homogen proce- dure, denot mmrp, adopted. macro-scal point outsid influenc zone cohes crack, mmrp ident convent homogen techniqu previous report literature. context finit element implementations, techniqu call fe2 (feyel chaboch [53]). contrarily, materi re- spons stabl macro-scal point insid influenc zone cohes surface, 51 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y macro-scal strain insert rve follow kind approach influenc tortuos paramet . thus, case, mmrp consid novel non-standard homogen procedure. bifurc criteria macro-scal response, defin equat (41), detect mmrp homogen procedure. instant, macro-scal csm intro- duced. cohes forces, act interfaces, decreas accord degrad process overal materi behavior. therefore, traction initi instant crack insert peak stress result cohes interfac model introduc macro-scale. semi-concurr characterist model, inform transfer be- tween scale directions. noted, homogen overal stress deter- mine micro-scal analysi perform rve, drive forc insert macro-scal strain. observation, conclud peak stress result cohes model, overal stress bifurc time project surfac normal vec- tor, strongli influenc macro-scal strain instant. conclus paramount import model ductil failure. ii) detect singular acoust tensor macro-scale, csm in- troduced. cohes forc determin homogen procedur denot mmsp. case, displac jump interfaces, , strain neighbor points, r, properli insert micro-scal order perform analysi final homogen overal traction vector. again, evolut cohes forc clearli depend r, therefore, ident conclus pre- sent item (i) obtain evalu post-crit stage materi degrad process. previou work authors, proven result cohes constitut relation, traction vs. displac jump, object respect micro-cel size, condit micro-cel satisfi criteria rve stabl pro- cess analysis. model properti preserv new techniqu propos paper. final import outcom work accord sensit anal- ysi perform study, conclud that: 1) definit standard boundari condit (sbc) affect captur complex failur pattern intersect micro-cel differ angles, shown strip stretch differ angl (case section 4.2); 2) results, term homogen traction-separ law macro-scale, sensit finit element size (case b section 4.2). numer assess model perform simul quasi- brittl fractur problem, consid methodolog adapted, minor changes, 52 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y model ductil failur problem context larg deform setting. matter current research. acknowledg s.toro, p.j. sanchez a.e. huesp acknowledg financi support conicet (grant pip 2013-2015 631) european research council european union sev- enth framework programm (fp/2007-2013) / erc grant agreement n. 320815 (erc advanc grant project advanc tool comput design engin materi comp-des- mat). p.j. blanco r.a. feijoo acknowledg financi support provid brazilian agenc cnpq faperj. refer [1] d. dugdale. yield steel sheet contain slits. j. mech. phys. solids, 8:100108, 1960. [2] g. barenblatt. mathemat theori equilibrium crack brittl fracture. adv. appl. mech., 7:55129, 1962. [3] a. needleman. continuum model void nucleat inclus debonding. j. appl. mech., 54(3):525531, 1987. [4] x.p. xu a. needleman. numer simul fast crack growth brittl solids. j. mech. phys. solids, 42:13971434, 1994. [5] a. needleman. issu cohes surfac modeling. procedia iutam, 10:221246, 2014. [6] m.l. falk, a. needlemann, j.r. rice. critic evalu dynam fractur simul cohes surfaces. j. physiqu iv, page pr543 pr550, 2001. [7] x.p. xu a. needleman. numer simul dynam crack growth interface. int. j. fracture, 74(4):289324, 1995. [8] a. pandolfi, p. krysl, m. ortiz. finit element simul ring expans fragmentation: captur length time scale cohes model fracture. int. j. fracture, 95(1-4):279297, 1999. [9] j.w. hutchinson a.g. evans. mechan materials: top-down approach fracture. acta materialia, 48 (1):125135, 2000. [10] v. tvergaard. crack growth predict cohes zone model ductil fracture. j. mech. phys. solids, 49(9):21912207, 2001. [11] t. siegmund w. brocks. numer studi correl work separ dissip rate ductil fracture. engrg. fractur mech., 67(2):139154, 2000. [12] a.e. huespe, a. needleman, j. oliver, p.j. sanchez. finit thick band method ductil fractur analysis. intern journal plasticity, 25(12):23492365, 2009. [13] a.e. huespe, a. needleman, j. oliver, p.j. sanchez. finit strain, finit band method model ductil fracture. intern journal plasticity, 28(1):5369, 2012. [14] a. hillerborg, m. modeer, p.e. petersson. analysi crack format crack growth concret mean fractur mechan finit elements. cement concret research, 6(6):773781, 1976. 53 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y [15] z.p. bazant. concret fractur models: test practice. engrg. fractur mech., 69(2):165205, 2002. [16] m. elices, g.v. guinea, j. gomez, j. planas. cohes zone model: advantages, limit chal- lenges. engrg. fractur mech., 69(2):137163, 2002. [17] j. oliver, a. e. huespe, m. d. g. pulido, e. chaves. continuum mechan fractur mechanics: strong discontinu approach. engin fractur mechanics, 69:113136, 2002. [18] j. oliver. discret constitut model induc strong discontinu kinemat continuum consti- tutiv equations. int. j. solid struct., 37:72077229, 2000. [19] v. tvergaard j.w. hutchinson. relat crack growth resist fractur process paramet elasto-plast solids. j. mech. phys. solids, 40:13771397, 1992. [20] l. xia c.f shih. ductil crack growth i. numer studi comput cell micrstructur base length scales. j. mech. phys. solids, 43:233259, 1995. [21] franck j vernerey, wing kam liu, brian moran, gregori olson. micromorph model multipl scale failur heterogen materials. journal mechan physic solids, 56(4):13201347, 2008. [22] p.j. sanchez, p.j. blanco, a.e. huespe, r.a. feijoo. failure-ori multi-scal variat formulation: micro-structur nucleat evolut soften bands. comput. meth. app. mech. eng., 257:221 247, 2013. [23] i.m. gitman, h. askes, l.j. sluys. repres volume: exist size determination. engin fractur mechanics, 74:25182534, 2007. [24] v.p. nguyen, o. lloberas-valls, m. stroeven, l.j. sluys. exist repres volum soften quasi-brittl materi - failur zone averag scheme. comput. meth. app. mech. eng., 199:3028 3038, 2010. [25] t. belytschko, s. loehnert, j.h. song. multiscal aggreg discontinuities: method circumv loss materi stability. int. j. numer. meth. engng., 73:869894, 2008. [26] t. belytschko j.h. song. coarse-grain multiscal crack propagation. int. j. num. meth. eng., 81(5): 537563, 2010. [27] m.g.d. geers, v.g. kouznetsova, w.a.m. brekelmans. multi-scal comput homogenization: trend challenges. journal comput appli mathematics, 234:21752182, 2010. [28] e bosco, vg kouznetsova, mgd geers. multi-scal comput homogenizationloc propa- gate discontinu x-fem. ijnme, 102(3-4):496527, 2015. [29] v.p. nguyen, o.lloberas-valls, l.j. slui m. stroeven. homogenization-bas multiscal crack modelling: micro diffus damag macro cracks. comput. meth. app. mech. eng., 200:12201236, 2010. [30] c.v. verhoosel, j.j.c. remmers, m.a. gutierrez, r. borst. comput homogen adhes cohes failur quasi-brittl solids. int. j. numer. meth. engng., 83:11551179, 2010. [31] j. oliver, m. caicedo, e. roubin, a.e. huespe, j.a. hernandez. continuum approach comput multiscal model propag fracture. method appli mechan engineering, 294: 384427, 2015. [32] m.g. kulkarni, p.h. geubelle, k. matous. multi-scal model heterogen adhesives: effect particl decohesion. mechan materials, 41:573583, 2009. [33] p.j. blanco, p.j. sanchez, e.a. souza neto, r.a. feijoo. variat foundat gener unifi theori rve-bas multiscal models. arch. comput. method eng., 2014. doi 10.1007/s11831-014-9137-5. 54 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y [34] r. hill. constitut macro-vari heterogen solid finit strain. proc. r. soc. london, 326, 1972. [35] j. mandel. plasticit classiqu viscoplasticit. cisim lectur notes. springer-verlag, 1971. [36] e.a. souza neto r.a. feijoo. variat foundat multi-scal constitut model solids: small larg strain kinemat formulation. lncc research & develop report 16, 2006. [37] e.a. souza neto r.a. feijoo. equival spatial materi volum averag stress larg strain multi-scal solid constitut models. mechan materials, 40:803811, 2008. [38] d. peric, e.a. souza neto, r.a. feijoo, m. partovi, a.j. carneiro molina. micro-to-macro transi- tion multi-scal analysi non-linear heterogen materials: unifi variat basi finit element implementation. int. j. num. meth. eng., 87:149170, 2011. [39] e.a. souza neto r.a. feijoo. variat foundat larg strain multiscal solid constitut models: kinemat formualtion. m. vaz, e.a. souza neto, p.a. muoz-rojas, editors, advanc comput materi modeling. classic multi-scal techniques, page 341378, weinheim, 2011. [40] p.j. blanco, p.j. sanchez, e.a. souza neto, r.a. feijoo. method multiscal virtual power deriv second-ord mechan model. mechan materials, 2015, submitted. [41] p.j. blanco s.m. giusti. thermomechan multiscal constitut modeling: account microstructur thermal effects. journal elasticity, 115:2746, 2014. [42] e.a. souza neto, p.j. blanco, p.j. sanchez, r.a. feijoo. rve-bas multiscal theori solid micro-scal inertia bodi forc effects. mechan materials, 80:136144, 2015. [43] s. toro, p.j. sanchez, a.e. huespe, s.m. giusti, p.j. blanco, r.a. feijoo. two-scal failur model heterogen materials: numer implement base finit element method. int. j. num. meth. eng., 97(5):313351, 2014. [44] s. toro, p.j. sanchez, p.j. blanco, e.a. souza neto, a.e. huespe, r.a. feijoo. multiscal formul materi failur account cohes crack macro micro scales. int. j. plasticity, 76:75110, 2016. [45] j. simo, j. oliver, f. armero. analysi strong discontinu induc strain-soften rate- independ inelast solids. comput. mech., 12:277296, 1993. [46] j. oliver, i.f. dias, a.e. huespe. crack-path field strain-inject techniqu comput model propag materi failure. comput. meth. app. mech. eng., 274:289348, 2014. [47] c. mieh a. koch. comput micro-to-macro transit discret microstructur undergo small strain. arch. appl. mech., 72:300317, 2002. [48] j. oliver, a.e. huespe, s. blanco, d.l. linero. stabil robust issu numer model materi failur strong discontinu approach. comput. meth. app. mech. eng., 195(52):70937114, 2005. [49] o.l. manzoli, a.l. gamino, e.a. rodrigues, g.k.s. claro. model interfac two-dimension problem solid finit element high aspect ratio. comput & structures, 94:7082, 2012. [50] i. carol, c.m. lopez, o. roa. micromechan analysi quasi-brittl materi fracture-bas interfac elements. int. j. num. meth. eng., 52(1-2):193215, 2001. [51] j. f unger s. eckardt. multiscal model concrete. archiv comput method engineering, 18(3):341393, 2011. 55 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y [52] p. bocca, a. carpinteri, s. valente. size effect mix mode crack propagation: soften snap- analysis. engin fractur mechanics, 35(1):159170, 1990. [53] f. feyel j.l. chaboche. fe2 multiscal approach model elastoviscoplast behaviour long fibr sic/ti composit materials. comput. meth. app. mech. eng., 183:309330, 2000. 56 alfredo typewrit comput mech (2016) 58:549585 doi 10.1007/s00466-016-1306-y 1 introduct 1.1 literatur review 1.2 csm novel rve-bas multi-scal framework 2 descript multi-scal mechan formul 2.1 macro-scal model cohes surfac 2.1.1 multi-scal evalu stress traction 2.2 micro-scal model cohes surfac 2.2.1 treatment given micro-scal displac fluctuat increment field 2.3 scale-bridg equat 3 numer implement 3.1 macro-scal finit element model: efem techniqu 3.1.1 finit element strain enrichment: constant strain mode (csm) discontinu displac mode (ddm) 3.1.2 discret equilibrium equat 3.2 micro-scal finit element model 3.2.1 us two-dimension band-lik domain 3.2.2 implement insert oper 3.2.3 displac fluctuat virtual action field 3.2.4 micro-scal variat equilibrium problem. 3.2.5 degener cst element strain local simul rve failure: pro con 3.3 track algorithm determin macro-scal crack path 4 numer assess 4.1 concret failur model meso-scal 4.2 multi-scal model sensit analysi 4.3 point shear concret specimen 5 conclus