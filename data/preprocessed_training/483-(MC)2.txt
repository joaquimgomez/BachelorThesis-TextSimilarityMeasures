nonam manuscript no. (will insert editor) lagrangian analysi multiscal particul flow particl finit element method eugenio onat miguel angel celigueta salvador latorr guillermo casa riccardo rossi jerzi rojek received: date / accepted: date abstract present lagrangian numer techniqu analysi flow incorpor physic particl differ sizes. numer approach base particl finit element method (pfem) blend concept particle-bas techniqu fem. basi lagrangian formul particul flow procedur model motion small larg particl submerg fluid describ detail. numer techniqu analysi type multiscal particul flow stabil mix velocity-pressur formul pfem presented. exampl applic pfem particul flow problem given. keyword lagrangian analysi multiscal particul flow particl finit element method 1 introduct studi fluid flow contain particl differ size (hereaft call particul flows) relev area engin appli sciences. work concern particul flow contain small larg particles. type flow typic slurri flow origin natur hazard floods, tsunami landslides, process bio-med pharmaceut industries, manufactur industri oil ga industri (i.e. cut transport boreholes), applic [1, 2, 6, 13, 14, 16, 2123, 26, 47, 50, 51, 55, 61, 62]. work model simul free surfac particul quasi-incompress flow contain particl differ size particular class lagrangian fem term particl finit element method (pfem, www.cimne.com/pfem) [4, 5, 8, 11, 1720, 25, 27, 28, 35, 36, 38, 40, 4246]. pfem treat mesh node fluid solid domain particl freeli separ main fluid domain. mesh connect node discret domain govern equat solv stabil fem. lagrangian analysi procedur (such pfem) motion fluid particl track transient solution. hence, convect term vanish momentum equat numer stabil needed. sourc instability, however, remain numer solut lagrangian flows, treatment incompress constraint requir stabil numer method. work us stabil lagrangian formul excel mass preserv features. success formul reli consist deriv residual-bas stabil express mass balanc equat finit calculu (fic) method [2933, 3739]. e. onate, m.a. celigueta, s. latorre, g. casas, r. rossi centr internacion metod numer en enginyeria (cimne) campu nort upc, 08034 barcelona, spain tel.: +34-93-2057016 fax: +34-93-4016517 e-mail: j. rojek institut fundament technolog research polish academi scienc e-mail: 2 eugenio onat et al. lay-out paper following. section present basic equat conserv linear momentum mass quasi-incompress particul fluid lagrangian framework. treatment differ forc term micro, macro larg particl explained. deriv stabil fic form mass balanc equation. then, finit element discret simplici element equal order approxim veloc pressur present relev matric vector discret problem given. detail implicit transient solut lagrangian fem equat particul flow newton-raphson type iter scheme presented. basic step pfem solv free-surfac particul flow problem described. effici accuraci pfem analysi particul flow verifi solv set free surfac confin fluid flow problem incorpor particl small larg size (2d) (3d) dimensions. problem includ studi soil erosion, landslid situations, tsunami flood flows, soil dredg problem particl fill fluid containers, others. excel perform numer method propos analysi particul flow highlighted. 2 model micro, macro larg particl figur 1 show domain contain fluid particl differ sizes. particl term microscopic, macroscop larg term dimensions. microscop macroscop particl assum cylindr (in 2d) spheric (in 3d) shape. particl model rigid object undergo interact forc comput term rel distanc particl (for microscrop particles) physic contact particl neighbor (for macroscop particles), standard discret element method (dem) [2, 16, 34]. fig. 1: microscopic, macroscop larg particl fluid domain work microscop macroscop particl assum spheric submerg fluid (figur 2). fluid-to-particl forc transfer particl appropri drag buoyanc functions. particle-to-fluid forc equal magnitud opposit direct fluid-to-particl on transfer fluid point addit bodi forc vector momentum equat (figur 3). equations, mass balanc equat account percentag particl fluid, similarli standard immers approach particul flow [53, 54, 56]. larg particles, hand, arbitrari shape treat rigid deform bodies. later case, discret standard fem. forc fluid particl viceversa comput fluid-structur interact (fsi) procedur [31, 60]. follow section basic govern equat lagrangian particul fluid com- putat forc microscopic, macroscop larg particles. lagrangian analysi multiscal particul flow particl finit element method 3 (a) (b) fig. 2: (a) particl differ size surround node fem mesh. (b) repres volum node (in shadow darker colour) fig. 3: immers approach treat motion physic particl fluid [61] 3 basic govern equat lagrangian particul fluid [1, 22, 23, 61] conserv linear momentum f dvi dt = ij xj + bi + 1 nf f pf , i, j = 1, , ns v (1) v analysi domain, ns number space dimens (n = 3 3d problems), f densiti fluid, vi bi veloc bodi forc compon ith cartesian axis, respectively, ij fluid cauchi stresses, f pf averag particle-to-fluid interact forc closur relat provid nf fluid volum fraction defin node j nfj = 1 1 vj nj i=1 v ij (2) vj volum repres domain associ fluid node j, v j volum ith particl belong vj nj number particl contain vj . note nfj = 1 repres fluid domain contain particl (figur 2). fluid volum fraction nf eq.(1) continu function interpol nodal valu finit element fashion [22]. summat term repeat indic assum eq.(1) following, specified. remark 1. term dvi dt eq.(1) materi deriv veloc vi. term typic comput lagrangian framework dvi dt = n+1vi nvi t (3a) n+1vi := vi( n+1x, n+1t) , nvi := vi( nx, nt) (3b) nvi( nx, nt) veloc materi point posit nx time t = nt, x = [x1, x2, x3] t coordin vector point fix cartesian system. note convect term, typic eulerian formulations, appear definit materi deriv [3, 9, 60]. 4 eugenio onat et al. constitut equat cauchi stress ij fluid split deviator (sij) pressur (p) compon ij = sij + pij (4) ij kroneck delta. work pressur assum posit tension state. relationship deviator stress strain rate standard form newtonian fluid [9], sij = 2 ij ij = ij 1 3 vij v = ii (5) eq.(5) viscosity, ij v deviator volumetr strain rates, respectively. strain rate ij relat veloc ij = 1 2 ( vi xj + vj xi ) (6) mass conserv equat mass conserv equat particul flow written rv = 0 (7a) rv := d(nff ) dt + nffv (7b) expand materi deriv divid eq.(7a) nf express rv rewritten rv := 1 dp dt + 1 nf dnf dt + v (8) = fc 2 c = p speed sound fluid. remark 2. nf = 1 (i.e. particl contain fluid) standard momentum mass conserv equat fluid recovered. boundari condit boundari condit dirichlet (v) neumann (t) boundari = v t vi v p = 0 v (9) ijnj t p = 0 t i, j = 1, , ns (10) v p t p prescrib veloc prescrib traction v t boundaries, respect nj compon unit normal vector boundari [3, 9, 60]. free surfac neumann boundari condit typic apply. 4 motion microscop macroscop particl mention early, microscop macroscop particl assum rigid sphere (in 3d). motion follow standard law lagrangian particles. ith spheric particl miui = fi , jiwi = ti (11) ui wi veloc rotat vector center graviti particle, mi ji mass rotat inertia particle, respect fi ti vector contain forc torqu act graviti center particl [34]. forc fi act ith particl comput fi = f w + f c + f fp (12) fwi , f c f fp forc particl self-weight, contact interact fluid effects. forc comput follows. lagrangian analysi multiscal particul flow particl finit element method 5 self-weight forc fwi = iig (13) densiti volum ith particle, respect g graviti acceler vector. contact forc fci = ni j=1 fcij (14) ni number contact interfac ith particle. fcij = f ij n + f ij s = f ij n ni + f ij s (15) fijn f ij s normal tangenti forc act ith interfac connect particl j (figur 4). forc comput term rel motion interact particl standard dem [2, 16, 34]. microscop particl tangenti forc fij neglect eq.(15). fluid-to-particl forces: f fp = f d + f b , f b f d are, respectively, buoyanc drag forc ith particle. forc comput as: buoyanc forc fbi = ip (16) drag forc fdi = f d n (+1) f = (re) coeffici depend local reynold number particl [1, 6, 15, 22, 23] fdi = 1 2 faicdvfi vi(vfi vi) (17) eq.(17) vfi vi respect veloc fluid particl center, ai area particl surfac radiu ri (2ri 4r 2 circl sphere, respectively) cd drag coeffici depend particl geometri rugos surfac [22, 23]. forc term f pf r.h.s. momentum equat (eq.(1)) comput particl (in vector form) fpf = ffp vector ffp comput node fluid mesh drag forc fdi f fp j = 1 vj nj i=1 fdi , j = 1, n (18) continuum distribut ffp obtain interpol nodal valu element fem fashion. note forc particl lift effect neglect present analysis. forc account explain [22]. 6 eugenio onat et al. (a) contact microscop particl forc microscop particl act direct line connect radii (b) contact la dem macroscop particl [34] f ij n = knu ij n + cnu ij n f ij s = ksu ij s u ij n ,u ij s rel displac normal tangenti direct contact interfac fig. 4: interact forc microscop (a) macroscop (b) particl 5 motion larg particl mention earlier, larg particl consid rigid deform bodies. case motion follow rule eq.(11) rigid lagrangian particles. contact forc particl surfac adjac interact particl comput friction contact interfac layer particl standard pfem (section 10.2). fluid forc particl comput integr tangenti (viscous) normal (pressure) forc edg fluid element surround particles. larg deform particles, hand, behav deform bodi immers fluid discret standard fem. motion follow stagger fsi scheme, treat deform bodi fluid singl continuum differ materi properties. detail unifi treatment interact fluid deform solid [12, 18, 46]. lagrangian analysi multiscal particul flow particl finit element method 7 6 stabil fic form mass balanc equat model incompress fluid mix finit element method equal order interpol veloc pressur requir introduc stabil formul mass balanc equation. work us stabil form mass balanc equat obtain finit calculu (fic) approach [2933, 3739]. fic stabil mass balanc equat written rv rmi xi = 0 v (19) rmi = ij xj + bi + 1 nf f pf (20) static momentum term stabil paramet comput = ( 8 h2 + 2f )1 (21) h characterist distanc finit element time parameter. deriv eq.(19) homogen quasi-incompress fluid present [45]. stabil paramet comput practic element e h = le = t = ( 8 (le)2 + 2 t )1 (22) t time step transient solut le characterist element length comput le = 2(v e)1/n v e element area (for 3-node triangles) volum (for 4-node tetrahedra). fluid heterogen materi properti valu eq.(22) comput element center. 7 variat equat fluid variat form momentum mass balanc equat obtain standard weight residu approach [9, 60]. result integr express integr part algebra are: momentum equat v wi dvi dt dv + v [ ij2 ij + vp ] dv v wi ( bi + 1 nf f pf ) dv t wit p d = 0 (23) mass balanc equat v q dp dt dv v q ( 1 nf dnf dt + v ) dv + v q xi ( xi (2ij) + p xi + bi ) dv t q [ dvn dt 2 hn (2 vn n + p tn) ] d = 0 (24) deriv eqs.(23) (24) homogen fluid [45]. 8 eugenio onat et al. 8 fem discret discret analysi domain contain np microscop macroscop particl number larg particl finit element n node standard manner lead mesh total number ne element n nodes. work choos simpl 3-node linear triangl (n = 3) 2d problem 4-node tetrahedra (n = 4) 3d problem local linear shape function nei defin node element e [41, 58]. veloc components, weight function pressur interpol mesh term nodal valu manner global linear shape function nj span element share node j (j = 1, n) [41, 58]. finit element interpol fluid domain written matrix form v = nvv , w = nvw , p = npp , q = npq (25) v = v1 v2 ... vn v = vi1 vi2 vi3 , w = w1 w2 ... wn w = wi1 wi2 wi3 , p = p1 p2 ... pn q = q1 q2 ... qn nv = [n1,n2, ,nn ]t , np = [n1, n2, , nn ] (26) nj = njin in ns ns unit matrix. eq.(26) vector v, (w, q) p contain nodal velocities, nodal weight function nodal pressur mesh, respect upperindex denot nodal valu vector scalar magnitude. substitut approxim (25) variat form (23) (24) give algebra equat particul fluid matrix form m0 v + kv + qp fv = 0 (27a) m1 pqt v + (l + mb)p fp = 0 (27b) differ matric vector eqs.(27) shown box 1 2d problems. remark 3. boundari term vector fp incorpor matric eq.(27b). this, however, lead non symmetr set equations. reason chosen comput boundari term iter increment solut scheme. remark 4. matrix mb eq.(27b) allow comput pressur need prescrib valu free surface. elimin error introduc pressur prescrib zero free boundaries, lead consider mass loss [20, 45]. 9 increment solut discret equat eqs.(27) solv time implicit newton-raphson type iter scheme [3, 9, 58, 60]. basic step time interv [n, n+ 1] are: - initi variables: (n+1x1, n+1v1, n+1p1, n+1nif , n+1r1m) {nx, nv, np, nnf , nrm}. - iter loop: k = 1, , niter. iteration. lagrangian analysi multiscal particul flow particl finit element method 9 me0ij = v e nei n e j i2dv , k e ij = v e beti db e jdv , q e ij = v e beti mn e j dv me1ij = v e 1 nei n e j dv , m e bij = et 2 hn nei n e j d leij = v e (tnei )n e j dv , f e vi = v e nei ( b + 1 nf fpf ) dv + et nei t pd fepi = et nei [ dvn dt 2 hn (2 vn n tn) ] d v e ( tnei bn e 1 nf dnf dt ) dv i, j = 1, n. d = 2 2/3 1/3 01/3 2/3 0 0 0 1/2 , bei = nei x1 0 0 nei x2 0 0 nei x2 nei x1 nei = n e i2 = x1 x2 , m = 1 1 0 nei : local shape function node element e [41, 45] box 1. element form matric vector eqs.(27) 2d problem step 1. comput nodal veloc increment v eq.(27a), deduc n+1hivv = n+1rkm v (28a) momentum residu rm iter matrix hv given rm = m0 v + kv + qp fv , hv = 1 t m0 + k + kv (28b) kev = nv e btmtmtbdv (28c) step 2. updat veloc fluid nodes: n+1vk+1 = n+1vk +v (29a) rigid particles: { n+1/2uj = n1/2uj + nuk+1j t uj = 1 mj nfk+1j , j = 1, np (29b) step 3. comput nodal pressur n+1pk+1 eq.(27b) obtain n+1hip n+1pk+1 = 1 t m1 n+1pi + qt n+1vk+1 + n+1f ip n+1pk+1 (30a) hp = 1 t m1 + l + mb (30b) 10 eugenio onat et al. step 4. updat coordin fluid node particl fluid nodes: n+1xk+1i = n+1xki + 1 2 (n+1vk+1i + nvi)t , = 1, n (31a) rigid particles: n+1uk+1i = nuk+1i + n+1/2uk+1i t n+1xk+1i = nxi + n+1uk+1i , = 1, np (31b) step 5. comput fluid volum fraction node n+1nk+1fi eq.(2) step 6. comput forc torqu particles: n+1fk+1i , n+1tk+1i , = 1, np step 7. comput particle-to-fluid nodes: (n+1f pf ) k+1 = (n+1ffpi ) k+1 , = 1, n f fp comput eq.(18) step 8. check converg verifi follow conditions: n+1vk+1 n+1vk evnv n+1pk+1 n+1pk epnp (32) ev ep prescrib error norm nodal veloc nodal pressures, respectively. exampl solv work set ev = ep = 10 3. condit (32) satisfi n n+ 1 proce time step. otherwise, iter counter k k + 1 repeat step 18. remark 5. eqs.(28)(32) n+1() denot valu matrix vector comput nodal unknown time n+ 1. work deriv integr iter matric hv hp residu vector rm comput discret geometri time n (i.e. v e = nv e) nodal forc vector fv fp comput current configur time n + 1. equival updat lagrangian formul [3, 12, 44, 59]. remark 6. tangent bulk stiff matrix kv iter matrix hv eq.(28b) account chang pressur velocity. includ matrix kv hv proven essenti fast convergence, mass preserv overal accuraci iter solut [11, 45]. remark 7. paramet kv (0 < 1) role prevent ill-condit iter matrix hv larg valu speed sound fluid lead domin role term tangent bulk stiff matrix kv. adequ select improv overal accuraci numer solut preserv mass larg time steps. detail deriv eq.(28c) [45]. remark 8. iter matrix hv eq.(28a) approxim exact tangent matrix updat lagrangian formul quasi/fulli incompress fluid [44]. simplifi form hv work yield good result converg achiev nodal veloc pressur 34 iter problem analyzed. remark 9. time step time interv [n, n + 1] chosen t = min ( nlemin |nv|max , tb ) nlemin minimum characterist distanc element mesh, l e comput explain section 6, |nv|max maximum valu modulu veloc node mesh tb critic time step node approach solid boundari [45]. lagrangian analysi multiscal particul flow particl finit element method 11 10 particl finit element method (pfem) 10.1 basi pfem let consid domain v contain fluid solid subdomains. subdomain character set points, term virtual particles. virtual particl contain inform defin geometri materi mechan properti underli subdomain. pfem subdomain model updat lagrangian formul [3, 44, 59]. solut step time step pfem follows: 1. start point time step cloud point c fluid solid domains. instanc nc denot cloud time t = nt (figur 5). 2. identifi boundari defin analysi domain nv , subdomain fluid solid. essenti step boundari (such free surfac fluids) sever distort solution, includ separ re-ent nodes. alpha shape method [10] boundari definition. clearly, accuraci reconstruct boundari depend number point vicin boundari alpha shape parameter. problem solv work alpha shape method implement describ [17, 35]. 3. discret analysi domain nv finit element mesh nm.we us effici mesh gener scheme base enhanc delaunai tessel [17, 35]. 4. solv lagrangian equat motion overal continuum standard fem. comput state variabl (updated) configur nt + t: velocities, pressur viscou stress fluid displacements, stress strain solid. 5. mesh node new posit n+1c n+1 denot time nt + t, term time increment size. 6. step 1 repeat solut time step obtain n+2c. n+1 x , n+1 u , n+1v, n+1a ,n+1 , n+1 , n+1 n m n+1 c n+1 v n+1m n+1 c n+1 v n+1 m n+2 c n v n m n c n v solid node fix boundari node fluid node initi cloud node n c domain n fly sub-domain fix boundari n mesh n m n x , n u , nv, na ,n , n , n . . cloud n+2 c domain n+1 fix boundari n mesh n+1 m cloud n+1 c . fig. 5: sequenc step pfem updat cloud node repres domain contain fluid solid (in darker shadow) time n (t =n t) time n+ 2 (t =n t+ 2t) note kei differ pfem classic fem remesh techniqu identif domain boundari time step. 12 eugenio onat et al. cpu time requir mesh grow linearli number nodes. gener rule, mesh consum 3d problem 15% total cpu time time step [43]. applic pfem fluid solid mechan fluid-structur interact problem [4, 5, 8, 11, 1720, 25, 27, 28, 35, 36, 38, 40, 4246], www.cimne.com/pfem. 10.2 treatment contact condit known veloc boundari pfem prescrib strong form boundari nodes. node belong fix extern boundari move boundari link interact solids. surfac traction appli neumann boundary, usual fem. contact fluid particl fix boundari account adjust time step fluid node penetr solid boundari [45]. contact larg particl (and bodies, general) treat introduc layer contact element interact particles. contact interfac layer automat creat mesh gener step prescrib minimum distanc (hc) interact particles. distanc exce minimum valu (hc) gener element treat fluid elements. element treat contact element relationship tangenti normal forc correspond displac introduc [35, 40, 43] (figur 6). (a) (b) fig. 6: (a) larg particl (in dark shadow) surround finit element mesh. contact interfac shown lighter shadow. (b) contact interfac object treat larg particl object wall algorithm allow model complex friction contact condit interact bodi move water simpl manner. algorithm model friction contact situat rigid elast solid structur mechan applications, soil/rock excav problem [4, 5]. friction contact algorithm describ extend oliv et al. [27, 28] analysi metal cut machin problems. figur 7 show exampl analysi pfem collect larg particl submerg tank contain water slosh motion. 10.3 treatment surfac eros predict bed eros sediment transport open channel flow import task area river environment engineering. bed eros lead instabl river basin slopes. undermin foundat bridg pile favour structur failure. model bed eros lagrangian analysi multiscal particul flow particl finit element method 13 fig. 7: pfem result motion larg particl submerg tank contain water slosh motion relev predict evolut surfac materi drag earth dam overspil situations. bed eros main caus environment damag floods. onat et al. [36] propos extens pfem model bed erosion. eros model base friction work bed surfac origin shear stress fluid. algorithm model eros soil/rock particl fluid bed briefli following: 1. comput point bed surfac tangenti stress induc fluid motion. 2. comput friction work wf origin tangenti stress bed surface. 3. onset eros bed point occur nwf exce critic threshold valu wc. 4. nwf > wc bed node, node detach bed region allow fluid flow. consequence, mass patch bed element surround bed node vanish bed domain transfer adjac fluid node. mass subsequ transport fluid immers macroscop particle. 5. sediment deposit model invers process describ previou step. hence, suspend node adjac bed surfac veloc threshold valu attach bed surface. figur 8 show schemat view bed eros algorithm described. detail algorithm [36]. fig. 8: model bed eros pfem. mass erod domain assign fluid node k 14 eugenio onat et al. 11 nodal algorithm transport microscop macroscop particl finit element mesh fact pfem new mesh regener time step allow microscop macroscop particl coincid fluid nodes. advantag procedur provid accur definit particl time step us fsi problems. algorithm comput posit particl nodal algorithm follows. time step nt: 1. comput converg valu posit fluid node (n+1xi, = 1, , n) particl (n+1xj , j = 1, , np) algorithm section 9. np particl coincid np fluid node (np n) typic differ posit correspond fluid node (figur 9). 2. regener mesh discret fluid domain treat posit np particl fluid node ignor fluid node origin coincid np particl n+1t. 3. interpol veloc fluid node posit np particl surround fluid nodes. algorithm schemat describ figur 9. figur 10 exampl applic nodal algorithm studi motion individu particl rectangular domain fill water. correct end veloc individu particl obtain shown figur 10c. figur 1113 exampl applic nodal algorithm motion macro-particl water containers. exampl applic algorithm shown section. fig. 9: nodal algorithm track motion particl submerg fluid. (a) particl coincid fluid node. (b) updat posit particl adjac nodes. (c) regener fluid mesh consist new particl posit 12 exampl present studi problem involv transport macroscop larg particl fluid flows. problem schemat represent particul flow occur practic problem civil environment engin industri problems. problem studi solv pfem nodal algorithm transport macroscop particl describ previou section. except problem section 12.6 deal lagrangian analysi multiscal particul flow particl finit element method 15 (a) (b) (c) 0 0,02 0,04 0,06 0,08 0,1 0,12 0,14 0,16 0 0,5 1 1,5 2 2,5 v e lo c y ( m /s ) time (s) veloc fall particl pfem simul analyt particl diamet = 0.002 m particl densiti = 3000 kg/m3 fluid densiti = 1000 kg/m3 fluid viscos = 0.001 pa s fig. 10: cylindr particl fall water container. 2d pfem solut nodal algorithm track particl motion. (a) mesh particl certain instant. (b) contour vertic veloc module. (c) evolut vertic veloc particl steadi state solut [6, 15] (a) (b) fig. 11: motion ascend descend particl differ densiti fluid domain. pfem result nodal algorithm track particl motion vertic transport spheric particl cylind standard immers approach transport macroparticl describ section 14 fluid equat solv eulerian flow solver implement krato open-sourc softwar platform cimn [24]. 12.1 eros slope adjac shore sea wave figur 14 show repres exampl progress eros soil mass adjac shore sea wave subsequ fall sea 2d object repres section lorry. object model rigid solid. note erod soil particl accumul sea bottom. example, simpl schematic, evid possibl pfem model fssi problem involv soil erosion, free surfac wave rigid/deform structures. 16 eugenio onat et al. fig. 12: motion macroscop particl water slosh problem tank. pfem result obtain nodal algorithm particl track fig. 13: pfem analysi penetr collect spheric (macroscopic) particl water contain 12.2 landslid fall hous figur 15 show instant 2d simul pfem motion collect macroscop particl slide inclin wall fall water container. pfem particularli suit model simul landslid effect surround- ing structures. figur 16 show schemat 2d simul landslid fall adjac constructions. landslid materi assum behav pure viscoplast materi model non-newtonian viscou incompress fluid [57]. applic pfem model landslid [8, 49]. lagrangian analysi multiscal particul flow particl finit element method 17 (a) (b) (c) (d) fig. 14: fall lorri sea eros underli soil mass action wave fig. 15: slide macroscop particl inclin wall enter contain water (a) (b) fig. 16: 3d pfem simul landslid fall hous 12.3 drag rock water stream figur 17 show drag collect rock model larg rigid particl arbitrari shape action water stream. particl action water forc particl comput integr pressur viscou stress element surround particle. 12.4 suction cohes materi submerg water figur 18 19 exampl detachment, suction transport particl cohes materi submerg water. figur 18 show particl detatch cohes soil bed transport suction tube (model 2d problem). pictur show eros soil mixtur water erod particl fall tube hit soil surfac stop suction pressure. figur 19 show similar 3d problem. suction tube erod surfac soil bed right hand container. mixtur water erod particl transport adjac containers. 18 eugenio onat et al. (a) (b) (c) (d) fig. 17: 3d pfem result drag collect larg rock water stream fig. 18: 2d pfem analysi detach suction cohes materi submerg water. pictur show eros bed materi impact mixtur water erod particl fall tube 12.5 fill water contain particl figur 20 show 3d exampl fill cylindr contain water contain macroscop spheric particles. water allow exit cylind later hole particl enter hole differ height fall graviti progress cylinder. figur differ instant fill process. lagrangian analysi multiscal particul flow particl finit element method 19 (a) (b) (c) (d) fig. 19: 3d pfem simul detachment, suction transport submerg cohes materi recipi fig. 20: fill contain inject water contain macroscop particl holes. water allow exit hole upper right hand cylinder. 3d pfem result instant 12.6 transport spheric particl tube fill water exampl figur 21 model vertic transport 120.000 spheric particl surfac tube fill water subsequ deposit particl free water surfac tube. particl upward tube fluid veloc 1 m/s. averag size particl radiu 2 mm densiti 2300 kg/m3. particl vertic reach fluid domain accumul combin effect weight effect interact forc fluid. figur 21 show instant particl ascend process. accumul particl water free surfac tube clearli seen. figur 22 show interact eigth jet ascend air bubbl 200.000 spheric solid particl fall cylind fill water. 20 eugenio onat et al. fig. 21: transport spheric macroparticl free surfac tube fill water. particl prescrib veloc accumul free surface. result obtain coupl dem-eulerian cfd code [24] (a) (b) (c) (d) fig. 22: interact jet ascend air bubbl layer 200.000 spheric particl fall cylind fill water. numer result obtain coupl dem-eulerian cfd code [24] 12.7 drag larg object small particl tsunami type flow exampl drag cars, barrel debri (model macroscop particles) water stream flow vertic wall. problem repres schemat studi real situat correspond tsunami fukushima (japan) march 2011 (figur 23). figur 24 snapshot pfem solut complex problem. fig. 23: drag car larg small object fukushima tsunami (japan) lagrangian analysi multiscal particul flow particl finit element method 21 (a) (b) fig. 24: drag larg object macroscop particl tsunami type flow pass vertic wall. 3d pfem result 13 conclud remark present lagrangian numer techniqu analysi flow incorpor physic particl differ sizes. numer approach base particl finit element method (pfem) stabil lagrangian mix velocity-pressur formulation. exampl present paper evid possibl pfem analysi practic multiscal particul flow industri environment problems. acknowledg research support advanc grant project safecon european research council. refer 1. anderson t, jackson r. fluid mechan descript fluidiz beds: equat motion. industri & engin chemic fundamentals, 6(4):527539 2. avci b, wrigger p, (2012) dem-fem coupl approach direct numer simul 3d partic- ulat flows. journal appli mechanics, 79(1), 7 page 3. t. belytschko, w.k. liu, b. moran, non linear finit element continua structures, 2d edition, wiley, 2013. 4. carbonel jm, onat e, suarez b (2010) model ground excav particl finit element method. journal engin mechan (asce) 136(4):455463 5. carbonel jm, onat e, suarez b (2013) model tunnel process cut tool wear particl finit element method (pfem). accept comput. mech. (2013) doi:10.1007/s00466-013-0835-x 6. clift r, grace jr, weber (1978) bubbles, drop particles. academ press, new york 7. coussi o (2004) poromechanics. wilei 8. cremonesi m, frangi a, perego u (2011) lagrangian finit element approach simul water- wave induc landslides. comput & structur 89:10861093 9. donea j, huerta (2003) finit element method flow problems. j. wilei 22 eugenio onat et al. 10. edelsbrunn h, muck ep (1999) dimension alpha shapes. acm trans. graphic 13:4372 11. franci a, onat e, carbonel jm (2013) effect tangent bulk stiff matrix analysi free surfac lagrangian flow pfem. research report cimn pi402 12. franci a, onat e, carbonel jm (2014b) unifi updat lagrangian formul fluid-structur inter- action problems. research report cimn pi404 13. gidaspow d (1994) multiphas flow fluidization. continuum kinet theori description, academ press, 467 page 14. heali dp, young db (2005) lagrangian method calcul particl concentr field dilut gas- particl flows. proc. roy. soc., london a: mathematical, physic engin sciences, 461(205a):2197 2225 15. heider a, levespiel o (1989) drag coeffici termin veloc spheric nonspher particles. powder technol. 58:6370 16. hilton j, cleari p (2013) dust model combin cfd discret element formulation. int. j. num. meth. fluids, 72(5):528-549 17. idelsohn sr, onat e, del pin f (2004) particl finit element method: power tool solv incom- pressibl flow free-surfac break waves. int. journal numer method engineering, 61(7):964989 18. idelsohn sr, marti j, limach a, onat e (2008) unifi lagrangian formul elast solid incompress fluids: applic fluid-structur interact problem pfem. comput method appl mech engrg. 197:17621776 19. idelsohn sr, mier-torrecilla m, onat e (2009) multi-fluid flow particl finit element method. comput method appl mech engrg. 198:27502767 20. idelsohn sr, onat e (2010) challeng mass conserv solut free-surfac flow fractional-step method: problem solutions. int. j. numer. meth. biomed. engng. 26:1313-1330 21. jajcev d, siegmann e, radek c, khinast jg (2013) large-scal cfd-dem simul fluidiz granular systems. chemic engin science, 98:298310 22. jackson r (2000), dynam fluidiz particles. cambridg monograph mechanics, cambridg univ. press 23. kafui dk, thornton c, adam mj (2002) discret particle-continuum fluid model gas-solid fluidis beds. chemic engng. science, 57(13):23952410 24. krato (2014) open sourc softwar platform multiphys computations. cimne, barcelona, www.cimne.com/krato 25. lares a, rossi r, onat e, idelsohn sr (2008) valid particl finit element method (pfem) simul free surfac flows. engin comput 25(4):385425 26. liu sh, sun da (2002). simul collaps unsatur soil dem. int. j. num. anal. meth. geomechanics, 26:633646 27. oliv x, cant jc, weyler r, gonzalez c, hernandez j (2007) particl finit element method solid mechan problems. in: onat e, owen r (eds) comput plasticity. springer, berlin, pp 87103 28. oliv x, hartmann s, cant jc, wyler r, hernandez j (2009) contact domain method larg deform friction contact problems. 1: theoret basis. comput method appl mech eng 198:25912606 29. onat e (1998) deriv stabil equat advective-diffus transport fluid flow problems. comput. meth. appl. mech. engng. 151:233267 30. onat e (2000) stabil finit element method incompress viscou flow finit increment calculu formulation. comput method appl mech engrg. 182(12):355370 31. onat e, garca j (2001) finit element method fluid-structur interact surfac wave finit calculu formulation. comput. meth. appl. mech. engrg. 191:635660 32. onat e (2003) multiscal comput analysi mechan finit calculus: introduction. comput. meth. appl. mech. engrg. 192(28-30):30433059 33. onat e (2004) possibl finit calculu comput mechanics. int. j. num. meth. engng. 60(1):255281 34. onat e, rojek j, (2004b) combin discret element finit element method dynam analysi geomechan problems. comput. meth. appl. mech. engrg. 193:30873128 35. onat e, idelsohn sr, del pin f, aubri r (2004c) particl finit element method. overview. int. j. comput. method 1(2):267307 lagrangian analysi multiscal particul flow particl finit element method 23 36. onat e, celigueta ma, idelsohn sr (2006a) model bed eros free surfac flow particl finit element method, acta geotechnia 1(4):237252 37. onat e, vall a, garca j (2006b) fic/fem formul matrix stabil term incompress flow low high reynold numbers. comput mechan 38 (4-5):440455 38. onat e, garca j, idelsohn sr, del pin f (2006c) fic formul finit element analysi incompress- ibl flows. eulerian, al lagrangian approaches. comput. meth. appl. mech. engng. 195(23-24):3001 3037 39. onat e, vall a, garca j (2007) comput turbul flow finit calculus-finit element for- mulation. int. j. numer. meth. engng. 54:609637 40. onat e, idelsohn sr, celigueta ma, rossi r (2008) advanc particl finit element method analysi fluid-multibodi interact bed eros free surfac flows. comput. meth. appl. mech. engng. 197(19-20):17771800 41. onat e (2009), structur analysi finit element method. linear statics. volum 1. basi solids. cimne-spring 42. onat e, rossi r, idelsohn sr, butler k (2010) melt spread polym particl finit element method. int. j. numer method engineering, 81(8):10461072 43. onat e, celigueta ma, idelsohn sr, salazar f, suarez b (2011) possibl particl finit element method fluid-soil-structur interact problems. comput mechanics, 48(3):307318. 44. onat e, carbonel jm (2013) updat lagrangian finit element formul quasi fulli incompress- ibl fluids. research report pi393, cimne. submit comput. mechan 45. onat e, franci a, carbonel jm (2014) lagrangian formul finit element analysi quasi- incompress fluid reduc mass losses. accept public int. j. num. meth. fluid 46. onat e, franci a, carbonel jm (2014b) particl finit element method (pfem) analysi industri form processes. accept public comput. mechan 47. patankar na, joseph dd (2001) lagrangian numer simul particul flows. int. j. multiphas flow, 27:16851706 48. ryzhakov p, onat e, rossi r, idelsohn sr (2012) improv mass conserv simul incompress flows. int. j. numer. meth. engng. 90(12):14351451 49. salazar f, onat e, moran r (2012) modelacion numerica del deslizamiento ladeu en embals mediant el metodo partculo y elemento finito (pfem). rev. int. meth. num. cal. dis. ing., 28(2):112123 50. shami ue, zeghal m (2005) coupl continuumdiscret model satur granular soils. j. engin mechan (asce), 131(4):413-426 51. sommerfeld m, van wachen b, olieman r (eds) (2008) best practic guidelien comput fluid dynam dispers multiphas flows. european research commun flow, turbul combust (ercoftac), imperi colleg london. 52. tang b, li jf, wang ts (2009) improv free surfac simul particl finit element method. int. j. num. method fluids, 60(9):1032-1054 53. van wachen b, oliveira es (2010) immers boundari method interact particles. ercoftac bulletin 82, 1722 march 2010 54. wang x, zhang lt, liu wk (2009) comput issu immers finit element method. j. comp. physics, 228:25352551 55. li x, chu x, sheng dc (2007) satur discret particl model characteristic-bas sph method granular materials. int. j. numer. meth. engng., 72:858882 56. zhang lt, gerstenberg a, wang x, liu wk (2004) immers finit element method, 193:20512067 57. zienkiewicz oc, jain pc, onat e (1978) flow solid form extrusion: aspect numer solutions. int. j. solid struct., 14:1538 58. zienkiewicz oc, taylor rl, zhu jz (2005) finit element method. basis. 6th ed., elsevi 59. zienkiewicz oc, taylor rl (2005) finit element method solid structur mechanics. 6th ed., elsevi 60. zienkiewicz oc, taylor rl, nithiarasu p (2005) finit element method fluid dynamics. 6th ed., elsevi 61. zohdi t (2007) introduct model simul particul flows. siam, comput scienc engin 62. zohdi t, wrigger p (2007) comput strongli coupl multifield interact particle-fluid systems. comput. meth. appl. mech. engng., 196:39273950