































































A geometrical model for the Monte Carlo simulation of the TrueBeam linac


This content has been downloaded from IOPscience. Please scroll down to see the full text.

Download details:

IP Address: 132.252.180.36

This content was downloaded on 18/05/2015 at 18:37

Please note that terms and conditions apply.

A geometrical model for the Monte Carlo simulation of the TrueBeam linac

View the table of contents for this issue, or go to the journal homepage for more

2015 Phys. Med. Biol. 60 N219

(http://iopscience.iop.org/0031-9155/60/11/N219)

Home Search Collections Journals About Contact us My IOPscience

iopscience.iop.org/page/terms
http://iopscience.iop.org/0031-9155/60/11
http://iopscience.iop.org/0031-9155
http://iopscience.iop.org/
http://iopscience.iop.org/search
http://iopscience.iop.org/collections
http://iopscience.iop.org/journals
http://iopscience.iop.org/page/aboutioppublishing
http://iopscience.iop.org/contact
http://iopscience.iop.org/myiopscience


N219

Physics in Medicine & Biology

A geometrical model for the Monte Carlo 
simulation of the TrueBeam linac

M Rodriguez1, J Sempau1, A Fogliata2, L Cozzi2, 
W Sauerwein3 and L Brualla3

1 Institut de Tècniques Energètiques, Universitat Politècnica de Catalunya, Diagonal 
647, E-08028, Barcelona, Spain
2 Radiotherapy and Radiosurgery Department, Humanitas Clinical and Research 
Center, Milan-Rozzano, Italy
3 NCTeam, Strahlenklinik, Universitätsklinikum Essen, Hufelandstraße 55 D-45122 
Essen, Germany

E-mail: lorenzo.brualla@uni-duisburg-essen.de

Received 21 February 2015, revised 13 March 2015
Accepted for publication 17 April 2015
Published 18 May 2015

Abstract
Monte Carlo simulation of linear accelerators (linacs) depends on the accurate 
geometrical description of the linac head. The geometry of the Varian TrueBeam 
linac is not available to researchers. Instead, the company distributes phase-
space files of the flattening-filter-free (FFF) beams tallied at a plane located 
just upstream of the jaws. Yet, Monte Carlo simulations based on third-party 
tallied phase spaces are subject to limitations. In this work, an experimentally 
based geometry developed for the simulation of the FFF beams of the 
Varian TrueBeam linac is presented. The Monte Carlo geometrical model of 
the TrueBeam linac uses information provided by Varian that reveals large 
similarities between the TrueBeam machine and the Clinac 2100 downstream 
of the jaws. Thus, the upper part of the TrueBeam linac was modeled by 
introducing modifications to the Varian Clinac 2100 linac geometry. The most 
important of these modifications is the replacement of the standard flattening 
filters by ad hoc thin filters. These filters were modeled by comparing dose 
measurements and simulations. The experimental dose profiles for the 6 MV 
and 10 MV FFF beams were obtained from the Varian Golden Data Set and 
from in-house measurements performed with a diode detector for radiation 
fields ranging from 3  ×  3 to 40  ×  40 cm2 at depths of maximum dose of 5 
and 10 cm. Indicators of agreement between the experimental data and the 
simulation results obtained with the proposed geometrical model were the 
dose differences, the root-mean-square error and the gamma index. The same  
comparisons were performed for dose profiles obtained from Monte 
Carlo simulations using the phase-space files distributed by Varian for the 

M Rodriguez et al

A geometrical model for the Monte Carlo simulation of the TrueBeam linac

Printed in the UK

N219

PMB

© 2015 Institute of Physics and Engineering in Medicine

2015

60

Phys. Med. Biol.

PHMBA7

0031-9155

10.1088/0031-9155/60/11/N219

Note

11

N219

N229

Physics in Medicine & Biology

HT

Institute of Physics and Engineering in Medicine

0031-9155/15/11N219+11$33.00 © 2015 Institute of Physics and Engineering in Medicine Printed in the UK

Phys. Med. Biol. 60 (2015) N219–N229 doi:10.1088/0031-9155/60/11/N219

mailto:lorenzo.brualla@uni-duisburg-essen.de
http://crossmark.crossref.org/dialog/?doi=10.1088/0031-9155/60/11/N219&domain=pdf&date_stamp=2015-05-18
publisher-id
doi
http://dx.doi.org/10.1088/0031-9155/60/11/N219


N220

TrueBeam linac as the sources of particles. Results of comparisons show a 
good agreement of the dose for the ansatz geometry similar to that obtained 
for the simulations with the TrueBeam phase-space files for all fields and 
depths considered, except for the 40  ×  40 cm2 field where the ansatz geometry 
was able to reproduce the measured dose more accurately. Our approach 
overcomes some of the limitations of using the Varian phase-space files. It 
makes it possible to: (i) adapt the initial beam parameters to match measured 
dose profiles; (ii) reduce the statistical uncertainty to arbitrarily low values; 
and (iii) assess systematic uncertainties (type B) by using different Monte 
Carlo codes. One limitation of using phase-space files that is retained in 
our model is the impossibility of performing accurate absolute dosimetry 
simulations because the geometrical description of the TrueBeam ionization 
chamber remains unknown.

Keywords: Monte Carlo, PENELOPE, linear accelerator, TrueBeam

(Some figures may appear in colour only in the online journal)

1. Introduction

The TrueBeam linac is the most recently marketed linear accelerator by Varian Medical 
Systems (Palo Alto, California, USA). The TrueBeam linac can produce flattening-filter-free 
(FFF) photon beams of 6 and 10 MV. Removing the flattening filter is an effective way to 
boost the dose rate in high-dose treatments with multiple narrow fields such as those used in 
stereotactic ablative radiotherapy.

Since the seminal works of Petti and co-workers Petti et al (1983) and of Udale (1988) 
on Monte Carlo simulation of a linac until more recent times (see Verhaegen and Seuntjens 
(2003), 6] and references therein), researchers have tried to improve the accuracy with which 
Monte Carlo models reproduce experimental dose distributions in water and heterogeneous 
phantoms. It has become clear that this goal requires precise knowledge of the dimensions and 
materials of the linac head assembly components that influence the beam. Usually, these data 
are provided by the manufacturers to Monte Carlo users who agree to keep this information 
undisclosed. However, in the case of the TrueBeam linac, Varian has not made available the 
characteristics of the head components situated above the collimation jaws. Instead, the com-
pany distributes, through its website (www.myvarian.com/montecarlo), phase-space files of 
the FFF beams tallied at a plane located just upstream of the jaws, which can be downloaded 
by TrueBeam users. These phase-space files can be used as sources to transport particles 
through the geometry of the jaws, and other beam modifiers, for subsequently estimating 
the absorbed dose in a patient during computerized tomography or phantom. Those phase-
space files were produced by Varian (Constantin et al 2011) in simulations using the Monte 
Carlo code Geant4 (Agostinelli et al 2003) and are coded in the International Atomic Energy 
Agency (IAEA) phase-space format (Capote et al 2006).

Some authors have validated the Varian distributed phase-space files and they have gener-
ally found a reasonable agreement of the estimated dose with measurements (Constantin et al 
2011, Gete et al 2013, Belosi et al 2014). However, Monte Carlo simulations based on third-
party tallied phase-spaces are subject to several limitations: (i) the initial beam parameters 
cannot be adapted to match dose profiles measured in the user’s linac; (ii) the latent variance 
(Sempau et al 2001) of the phase-space file imposes a limit in the statistical uncertainty of 
the estimated observables; (iii) simulations are subject to type B uncertainties associated with 

M Rodriguez et alPhys. Med. Biol. 60 (2015) N219

http://www.myvarian.com/montecarlo


N221

limitations of the Monte Carlo code used for generating the phase-space files (Faddegon et al 
2009); and (iv) the energy deposited in the ionization chamber cannot be determined because 
this component is located in the upper part of the linac; thus, absolute dosimetry in units of 
Gy/MU cannot be accurately computed by the method of Popescu et al (2005).

In this work we present a Monte Carlo model of the TrueBeam linac, inferred by compar-
ing dose measurements and simulations, which is suitable for the simulation of the 6 and 10 
MV FFF beams. The geometry of the linac in this model includes thin filters for the 6 and 10 
MV beams that are situated approximately in the position occupied by the standard flattening 
filters of a Varian Clinac 2100 linac. We have called this geometry FakeBeam to emphasize 
that it is not the actual geometry of the TrueBeam machine, but an ad hoc one created with 
the purpose of providing Monte Carlo users a way to circumvent some of the aforementioned 
limitations of using the Varian distributed phase-space files.

2. Materials and methods

2.1. FakeBeam geometry

Simply removing the flattening filters of a Clinac 2100 linac is not enough to reproduce the 
dose distributions produced by the TrueBeam FFF beams in a water phantom. The sole elimi-
nation of the flattening filter would allow high-energy electrons escaping from the target to 
produce a considerably higher-than-expected dose at shallow depths. The insertion of a thin 
sheet of a material such as bronze or copper at some place in the beam path can absorb those 
contaminant electrons. However, this simple configuration still fails to reproduce the off-axis 
absorbed dose.

According to the manufacturer (information provided to TrueBeam users under non-dis-
closure agreement), there is a large similarity between the head assembly geometries of the 
Clinac 2100 and the TrueBeam linacs downstream of a plane situated just above the jaws. 
Thus, in the FakeBeam geometry, modifications on the head assembly of the Clinac 2100 
linac were introduced in the part upstream of the jaws. A trial-and-error process was used 
to find the shape of thin filters that, situated approximately at the location of the standard 
flattening filters of the Clinac 2100 machine, reproduce the dose distribution produced by 
the FFF beams of the TrueBeam linac in a water phantom. We call these filters 6-FFF and 
10-FFF filters. The detailed geometry of these filters is shown in figure 1. The material com-
position of the 6-FFF and 10-FFF filters is bronze (70% copper, 30% zinc, ρ  =  8.412 g cm−3) 
and tantalum (ρ  =  16.654 g cm−3), respectively. The selection of these materials was inspired 
by the composition found in other flattening filters from Varian. A minor change was made 
to the original geometry of the Clinac 2100, so that the beryllium window was repositioned 
at the upstream plane of the primary collimator. Consequently, only the target is at vacuum in 
the FakeBeam geometry. The FakeBeam geometry includes the modifications to the primary 
collimator and the secondary collimator (lead shield) proposed by Chibani and Ma for the 
Clinac 2100 (Chibani and Ma 2007).

2.2. Monte Carlo simulations

All the simulations included in this work were performed with the PRIMO code (Rodriguez  
et al 2013), a user-friendly and freely distributed software (www.primoproject.net) specifi-
cally designed for simulating Varian and Elekta linacs and estimating absorbed dose distribu-
tions in water phantoms and computerized tomographies. PRIMO is designed with a layered 
structure having the Monte Carlo general-purpose radiation transport code penelope (Salvat 

M Rodriguez et alPhys. Med. Biol. 60 (2015) N219

http://www.primoproject.net


N222

et al 2011) and the geometry packages penVox and pengeom as the lowermost layers. The 
main program used in PRIMO for steering the penelope radiation transport subroutines is 
penEasy (Sempau et al 2011). The modified geometries of the Clinac 2100 including the 
6-FFE and 10-FFF filters were coded as a hierarchic structure of homogeneous bodies limited 
by quadric surfaces according to the rules of the pengeom package and were incorporated into 
PRIMO as a new linac named FakeBeam.

The penelope absorption energies (EABS) were set to 100 keV for charged particles and 
20 keV for photons everywhere. For bremsstrahlung emission by electrons and positrons 
(Llovet et al 2005), the energy of the emitted photons is sampled from the scaled cross-section 
tables of Seltzer and Berger (1985), and its angular distribution is described by an approxi-
mation to the partial-wave shape functions of Kissel, Quarles, and Pratt (Kissel et al 1983). 
PENELOPE uses a mixed simulation scheme (Berger 1963) for electrons and positrons and 
detailed simulation for photons. The five penelope transport parameters for mixed simulation 
are C1, C2, WCC, WCR, and DSMAX. C1 and C2 are the electron average angular deflection 
and the maximum fractional energy loss allowed in one step, respectively. WCC and WCR are 
the energy cutoffs for inelastic and bremsstrahlung interactions, respectively. DSMAX is the 
maximum allowed step length. In all simulations, the condensed history transport parameters 
were set to C1 = C2 = 0.1, WCC = 100 keV, and WCR = 20 keV for all materials, except for 
the materials composing the target where they were set to C1 = C2 = 0.001, WCC = 1 keV, 
and WCR = 20 keV. We have observed that those parameters are adequate for producing an 
accurate transport in the target (Rodriguez et al 2015). The maximum step length (DSMAX) 
was set to 1/10 the thickness of each material body. The initial electron source for the nominal 
6 MV beam had a Gaussian energy distribution with mean of 5.8 MeV and full width at half 
maximum (FWHM) of 1%. Its spatial distribution was also modeled by a Gaussian function 
centered at the linac central axis with a FWHM of 0.15 cm. For the nominal 10 MV beam, 
the initial electron source was monoenergetic with an energy of 10.8 MeV and spatially dis-
tributed by a Gaussian function with a FWHM of 0.1 cm. These parameters were found to be 
optimal to match the measurements.

Figure 1. Cross-section of the ad hoc 6-FFF (above) and 10-FFF (below) filters. The 
materials are bronze and tantalum, respectively. Cylindrical symmetry applies. All 
dimensions are given in centimeters.

M Rodriguez et alPhys. Med. Biol. 60 (2015) N219



N223

Several variance-reduction techniques were used. The splitting-roulette (Rodriguez  
et al 2012), which is a technique that combines photon splitting and Russian roulette applied 
to photons and electrons, was used in the target. The movable skins technique (Brualla  
et al 2009) was applied in the jaws and the primary collimator. Movable skins is a particular 
implementation of range rejection in which external layers of high atomic number collima-
tion structures are geometrically separated from the internal regions. These layers are called 
‘skins.’ In skins, all particles undergo analogue simulation (i.e. no variance-reduction tech-
nique is applied), whereas in internal regions electrons are terminated by setting arbitrarily 
high energy cutoffs. Additionally, simple splitting was applied to all particles crossing the 
surface of the water phantom. The average standard statistical uncertainty of all bins scoring 
more than 50% of the maximum dose was 0.3% for all simulations of the 10 MV FFF beam 
and ranged between 0.4% and 0.6% for simulations of the 6 MV FFF beam. The 40  ×  40 cm2 
field was used to iteratively tune the model and the rest were used to validate it.

Additionally, simulations using the second generation of the Varian-distributed TrueBeam 
phase-space files as sources of particles were also performed. The phase-space files that belong 
to the second generation are those tallied on a plane, whereas those that belong to the first gen-
eration were tallied on a section of a cylindrical surface and used a substantially lower number 
of primary particles (Constantin et al 2011). The phase-spaces were imported into PRIMO. The 
region downstream of the jaws was simulated as described for the FakeBeam geometry and 
following the Varian recommendations. Splitting in the water phantom was used with a vari-
able splitting factor depending on the field. The factors were selected to be sufficiently large to 
approximate the dose uncertainty to the latent variance of the phase space (Sempau et al 2001). 
The obtained average standard statistical uncertainty of all bins scoring more than 50% of the 
maximum dose was approximately 0.8%. We refer to these simulations as TrueBeam.

2.3. Geometry validation

Validation of the geometry was based on comparisons between Monte Carlo estimated dose 
distributions and two sets of measurements: (i) the Varian Golden Beam Data Set (GBDS), 
which used an IBA (Schwarzenbruck, Germany) CC13 ionization chamber and (ii) in-house 
measurements performed with an IBA PFD3G detector (IBA 2011). Comparisons were made 
for field sizes of 3  ×  3, 6  ×  6, 10  ×  10, 20  ×  20, and 40  ×  40 cm2. Crossline profiles were 
compared at depth of maximum dose dmax at 5.0 cm and 10.0 cm depths. Measurements with 
the diode were used for comparing the depth-dose curves of the 3  × 3 cm2 field and lateral 
dose profiles of the 3  ×  3, 6  ×  6, and 10  ×  10 cm2. The GBDS was used for the rest of the 
depth-dose and crossline dose profile comparisons. The SSD was 100 cm and the phantom 
bin size was selected according to the field size. For the 3  ×  3, 6  ×  6, and 10  ×  10 cm2 fields 
bin size was 0.1  ×  0.4  ×  0.1 cm3, and for larger fields it was 0.2  ×  0.8  ×  0.2 cm3 (crossline  × 
inline  × depth). The larger bin size in the inline direction was chosen to reach a low uncer-
tainty in the simulations with the TrueBeam phase-space files.

The percentage of points passing a gamma analysis (Low et al 1998) with criteria of 1%, 
1 mm (γ1,1), the dose difference relative to the maximum dose (diff%), and the root-mean-
squared error (RMS) of the dose difference were used as figures of merit to determine agree-
ment between the measured and the Monte Carlo estimated dose distributions. The RMS was 
computed only for depth-dose curves at depths greater than 3 mm. Despite the fact that the 
reference data set in the gamma analysis is a 1D array of dose points with arbitrary separa-
tion, PRIMO performs a re-gridding process of the evaluated 3D dose distribution that allows 
application of an arbitrarily small distance-to-agreement criterion. Re-gridding is performed 
using trilinear interpolation. In the same manner, the dose profiles used for evaluating the 

M Rodriguez et alPhys. Med. Biol. 60 (2015) N219



N224

percentage difference were calculated in the Monte Carlo estimated 3D dose distribution by 
trilinear interpolation at the measurement points. To reduce the effect of uncertainties in the 
analysis, estimated depth-dose curves were normalized so that their areas between dmax and 
d50% coincided with the experimental values (Gete et al 2013). Crossline profiles were nor-
malized to 100% at the central axis.

2.4. Sensitivity analysis

We performed a series of simulations with the purpose of assessing the sensitivity of the dose 
profiles produced by the FakeBeam model to the initial beam parameters of the beam. The 

Figure 2. Comparison of measured (dots) and Monte Carlo estimated (steps) depth-
dose curves for the FakeBeam and TrueBeam geometries and the 6-FFF and 10-FFF 
beams. Percentage dose differences are relative to the maximum dose. Statistical 
uncertainties are in the range of 0.3 to 0.8% and are not shown.

M Rodriguez et alPhys. Med. Biol. 60 (2015) N219



N225

Figure 3. Root-mean-square error of the dose difference between measured and Monte 
Carlo estimated depth-dose curves for the FakeBeam and TrueBeam geometries and the 
6 and 10 MV FFF beams.

Figure 4. Comparison of measured (dots) and Monte Carlo estimated (steps) crossline 
profiles at 5.0 cm depth for the FakeBeam and TrueBeam geometries and the 6 and 10 
MV FFF beams. Statistical uncertainties are in the range of 0.3 to 0.8% and are not 
shown.

M Rodriguez et alPhys. Med. Biol. 60 (2015) N219



N226

depth-dose curves and lateral profiles at 5.0 cm of depth obtained with the initial parameters 
described in section 2.2 for a 40  ×  40 cm2 field were used as reference in the gamma analysis. 
For the 6 MV beam we varied the initial energy of electrons from 5.6 MeV to 6.0 MeV in 
steps of 0.1 MeV. The FWHM of the focal spot size was varied from 0 to 0.15 cm in steps of 
0.05 cm. For the 10 MV beam, the initial energy ranged from 10.6 to 11.0 MeV with a step 
of 0.2 MeV and the FWHM of the focal spot size was varied from 0 to 0.1 cm in steps of 0.05 
cm. The FWHM of the initial energy was set to 0 in all cases. Additionally, we performed 
simulations with the initial beam parameters that were used to generate the Varian’s phase-
space files. These parameters are declared in the phase-space file headers and are, for the 6 
MV beam, 5.9 MeV, 0.06 MeV, and 0.078 cm for the initial energy, FWHM of the energy and 
FWHM of the focal spot size, respectively. Likewise, for the 10 MV beam, they were 10.2 
MeV, 0.102 MeV, and 0.096 cm. The obtained average standard statistical uncertainty of the 
dose distributions varied between 0.5% and 1%.

3. Results

Figure 2 shows the comparison between measured and Monte Carlo estimated depth-dose 
curves. For FakeBeam, differences are less than 1% in most of the points for both beams 
and all fields evaluated, except in the high-dose gradient build-up region, near the phantom 
surface, where an over-response of the cylindrical ionization chamber is expected. This over-
response arises from the fact that ionization chambers, even those with a small cavity volume 
such as the CC13 used for measuring the Varian’s GBDS, overestimate the dose in the build-
up region where lack of charged particle equilibrium exists. Depth-dose curves for TrueBeam 
also show a good agreement for both beams with lower differences in the build-up region 
than FakeBeam but slightly larger beyond dmax, which results in relatively lower RMS values 
for FakeBeam as shown in figure 3. Values of γ1,1 obtained were, in all cases, for both the 
FakeBeam and the TrueBeam simulations, greater than 98%.

Comparison of lateral dose profiles shown in figures 4 and 5 reveals a good agreement of 
FakeBeam with the experimental data with differences less than 1% for large fields (20  ×  20 
cm2 and 40  ×  40 cm2) and less than 1.5% for smaller fields, except in the regions of high-dose 
gradient. These differences are similar to those found for TrueBeam for the smaller fields but 
lower for large fields where TrueBeam agreement is poorer, particularly for the 6 MV FFF 
beam.

Values of the combined γ1,1 obtained for the lateral dose profiles at the three depths consid-
ered are shown in figure 6. The agreement is very good for FakeBeam, with at least 96% of the 
points passing the test for all fields and energies. Gamma analysis also reveals the poor agree-
ment obtained with the phase-space files distributed by Varian for TrueBeam for the 40  ×  40 
cm2 field, with 42% and 84% of the points passing the test for the 6 MV and 10 MV beams, 
respectively. These values improved to 88% and 98% when the gamma analysis criteria were 
relaxed to 2%, 2 mm.

Results of the sensitivity analysis show that the dose is quite insensitive to the initial param-
eters of the beam in the range analyzed for both nominal energies. Dose profiles and depth 
dose curves matched the reference data sets with γ1,1(%) results of 98% or better. For the lateral 
dose profiles obtained with the parameters used to generate the Varian’s phase-space files, the 
6 MV beam produced γ1,1 and γ2,2 of 97% and 100%, respectively. In contradistinction, for the 
10 MV beam the γ1,1 and γ2,2 were 53% and 95%, respectively. This larger variation is caused 
by the marked difference between the initial energy of the reference and the analyzed beams, 
which is approximately 0.5–0.7 MeV.

M Rodriguez et alPhys. Med. Biol. 60 (2015) N219



N227

Figure 5. Relative difference between measured and Monte Carlo estimated lateral 
profiles at 5 cm of depth for the FakeBeam (black) and TrueBeam (gray) geometries for 
the 6 (left) and 10 (right) MV FFF beams.

Figure 6. Results of gamma analysis of lateral dose profiles. Bars represent the values 
of the combined γ1,1 for the three depths considered in the analysis. Notice that results 
for the 40  ×  40 cm2 field are shown in a different scale.

M Rodriguez et alPhys. Med. Biol. 60 (2015) N219



N228

4. Summary and conclusions

A geometrical model named FakeBeam for the Monte Carlo simulation of FFF beams pro-
duced by the TrueBeam linac has been developed and validated by comparison of computed 
PDDs and profiles with experimental measurements. The description of the filters developed 
in this work allows those researchers having access to the Varian Clinac 2100 geometry to 
implement FakeBeam in their own Monte Carlo systems. FakeBeam has been incorporated 
into PRIMO as a new linac model, so users can simulate it without any coding effort. PRIMO 
includes the geometries of the Millennium 120 and 120 HD multileaf collimators. Users of the 
PRIMO code can either simulate the FakeBeam geometry or import the Varian’s distributed 
phase-space files for TrueBeam. Our approach overcomes some of the limitations of using 
phase-space files as a source of particles. Now, it is possible to: (i) adapt the initial beam 
parameters to match measured dose profiles; (ii) reduce the statistical uncertainty to arbi-
trary low values; and (iii) assess systematic uncertainties (type B) by using different Monte 
Carlo codes. Our model does not take into account the actual geometry of the ionization 
chamber of the TrueBeam linac. Instead, it uses the ionization chamber of the Varian Clinac 
2100. Because knowledge of the ionization chamber geometry is essential for some methods 
of Monte Carlo absolute dosimetry, our model is limited in this regard. Notwithstanding, 
the FakeBeam geometry could be used in conjunction with the method used by Zavgorodni  
et al (2014) to determine backscattered radiation in the monitor chamber. With this combined 
approach, it is possible to provide dose distributions expressed in Gy MU−1 with an accuracy 
close to 1%.

Acknowledgments

MR, JS, and LB are thankful to the Spanish Ministerio de Economía y Competitividad (proj-
ect FIS2012-38480) and to the Deutsche Forschungsgemeinschaft (project BR 4043/3-1). JS 
is grateful to the Spanish Networking Research Center CIBER-BBN for financial support.

References

Agostinelli S et al 2003 Geant4—a simulation toolkit Nucl. Instrum. Methods A 506 250–303
Belosi M F et al 2014 Monte Carlo simulation of TrueBeam flattening-filter-free beams using Varian 

phase-space files: comparison with experimental data Med. Phys. 41 051707 
Berger  M 1963 Monte Carlo calculation of the penetration and diffusion of fast charged particles 

Methods in Computational Physics ed B Alder  et al (New York: Academic) pp 135–215
Brualla L, Salvat F and Palanco-Zamora R 2009 Efficient Monte Carlo simulation of multileaf collimators 

using geometry-related variance-reduction techniques Phys. Med. Biol. 54 4131–49
Capote R, Jeraj R, Ma C M, Rogers D W O, Sánchez-Doblado F, Sempau J, Seuntjens J and Siebers J V  

2006 Phase-space database for external beam radiotherapy Report INDC(NDS)-0484 (Vienna: 
International Atomic Energy Agency, Nuclear Data Section)

Chetty I J, Rosu M, Kessler M L, Fraass B A, Ten Haken R K, Kong F M S and McShan D L 2006 
Reporting and analyzing statistical uncertainties in Monte Carlo-based treatment planning Int. J. 
Radiat. Oncol. Biol. Phys. 65 1249–59

Chibani O and Ma C 2007 On the discrepancies between Monte Carlo dose calculations and measurements 
for the 18 MV Varian photon beam Med. Phys. 34 1206–16

Constantin M, Perl J, LoSasso T, Salop A, Whittum D, Narula A, Svatos M and Keall P J 2011 Modeling 
the TrueBeam linac using a CAD to Geant4 geometry implementation: dose and IAEA-compliant 
phase space calculations Med. Phys. 38 4018–24

M Rodriguez et alPhys. Med. Biol. 60 (2015) N219

http://dx.doi.org/10.1016/S0168-9002(03)01368-8
http://dx.doi.org/10.1016/S0168-9002(03)01368-8
http://dx.doi.org/10.1016/S0168-9002(03)01368-8
http://dx.doi.org/10.1118/1.4871041
http://dx.doi.org/10.1118/1.4871041
http://dx.doi.org/10.1088/0031-9155/54/13/011
http://dx.doi.org/10.1088/0031-9155/54/13/011
http://dx.doi.org/10.1088/0031-9155/54/13/011
http://dx.doi.org/10.1016/j.ijrobp.2006.03.039
http://dx.doi.org/10.1016/j.ijrobp.2006.03.039
http://dx.doi.org/10.1016/j.ijrobp.2006.03.039
http://dx.doi.org/10.1118/1.2712414
http://dx.doi.org/10.1118/1.2712414
http://dx.doi.org/10.1118/1.2712414
http://dx.doi.org/10.1118/1.3598439
http://dx.doi.org/10.1118/1.3598439
http://dx.doi.org/10.1118/1.3598439


N229

Faddegon B A, Kawrakow I, Kubyshin Y, Perl J, Sempau J and Urban L 2009 The accuracy of EGSnrc, 
Geant4 and PENELOPE Monte Carlo systems for the simulation of electron scatter in external 
beam radiotherapy Phys. Med. Biol. 54 6151–63

Gete  E, Duzenli  C, Milette  M P, Mestrovic  A, Hyde  D, Bergman  A M and Teke  T 2013 A Monte 
Carlo approach to validation of FFF VMAT treatment plans for the TrueBeam linac Med. Phys. 
40 021707 

IBA   2011 Field detectors EFD3G, PFD3G, SFD, RFD3G Technical description (Schwarzenbruck: IBA 
Dosimetry)

Kissel  L, Quarles  C A and Pratt  R H 1983 Shape functions for atomic-field bremsstrahlung from 
electrons of kinetic energy 1–500 keV on selected neutral atoms 1  ⩽  Z  ⩽  92 At. Data Nucl. Data 
Tables 28 381–460

Llovet X, Fernández-Varea J M, Sempau J and Salvat F 2005 Monte Carlo simulation of x-ray emission 
using the general-purpose code PENELOPE Surf. Interface Anal. 37 1054–8

Low  D, Harms  W, Mutic  S and Purdy  J 1998 A technique for the quantitative evaluation of dose 
distributions Med. Phys. 25 656–61

Petti P L, Goodman M S, Gabriel T A and Mohan R 1983 Investigation of buildup dose from electron 
contamination of clinical photon beams Med. Phys. 10 18–24

Popescu I A, Shaw C P, Zavgorodni S F and Beckham W A 2005 Absolute dose calculations for Monte 
Carlo simulations of radiotherapy beams Phys. Med. Biol. 50 3375–92

Rodriguez M, Sempau J and Brualla L 2012 A combined approach of variance-reduction techniques for 
the efficient Monte Carlo simulation of linacs Phys. Med. Biol. 57 3013–24

Rodriguez M, Sempau  J and Brualla L 2013 PRIMO: a graphical environment for the Monte Carlo 
simulation of Varian and Elekta linacs Strahlenther. Onkol. 189 881–6

Rodriguez  M, Sempau  J and Brualla  L 2015 Study of the electron transport parameters used in 
PENELOPE for the Monte Carlo simulation of linac targets Med. Phys. at press (http://dx.doi.
org/10.1118/1.4916686) 

Salvat F, Fernández-Varea J M and Sempau J 2011 PENELOPE—A Code System for Monte Carlo Simulation 
of Electron and Photon Transport (Issy-les-Moulineaux: OECD Nuclear Energy Agency)

Seltzer  S M and Berger  M J 1985 Bremsstrahlung spectra from electron interactions with screened 
atomic nuclei and orbital electrons Nucl. Instrum. Methods B 12 95–134

Sempau J, Badal A and Brualla L 2011 A PENELOPE-based system for the automated Monte Carlo 
simulation of clinacs and voxelized geometries—application to far-from-axis fields Med. Phys.  
38 5887–95

Sempau J, Sánchez-Reyes A, Salvat F, ben Tahar H O, Jiang S B and Fernández-Varea J M 2001 Monte 
Carlo simulation of electrons beams from an accelerator head using PENELOPE Phys. Med. Biol. 
46 1163–86

Udale M 1988 A Monte Carlo investigation of surface doses for broad electron beams Phys. Med. Biol. 
33 939–53

Verhaegen F and Seuntjens J 2003 Monte Carlo modelling of external radiotherapy photon beams Phys. 
Med. Biol. 48 R107–64

Zavgorodni  S, Alhakeem  E and Townson  R 2014 Monitor backscatter factors for the Varian 21EX 
and TrueBeam linear accelerators: measurements and Monte Carlo modelling Phys. Med. Biol.  
59 911–24

M Rodriguez et alPhys. Med. Biol. 60 (2015) N219

http://dx.doi.org/10.1088/0031-9155/54/20/008
http://dx.doi.org/10.1088/0031-9155/54/20/008
http://dx.doi.org/10.1088/0031-9155/54/20/008
http://dx.doi.org/10.1118/1.4773883
http://dx.doi.org/10.1118/1.4773883
http://dx.doi.org/10.1016/0092-640X(83)90001-3
http://dx.doi.org/10.1016/0092-640X(83)90001-3
http://dx.doi.org/10.1016/0092-640X(83)90001-3
http://dx.doi.org/10.1002/sia.2096
http://dx.doi.org/10.1002/sia.2096
http://dx.doi.org/10.1002/sia.2096
http://dx.doi.org/10.1118/1.598248
http://dx.doi.org/10.1118/1.598248
http://dx.doi.org/10.1118/1.598248
http://dx.doi.org/10.1118/1.595287
http://dx.doi.org/10.1118/1.595287
http://dx.doi.org/10.1118/1.595287
http://dx.doi.org/10.1088/0031-9155/50/14/013
http://dx.doi.org/10.1088/0031-9155/50/14/013
http://dx.doi.org/10.1088/0031-9155/50/14/013
http://dx.doi.org/10.1088/0031-9155/57/10/3013
http://dx.doi.org/10.1088/0031-9155/57/10/3013
http://dx.doi.org/10.1088/0031-9155/57/10/3013
http://dx.doi.org/10.1007/s00066-013-0415-1
http://dx.doi.org/10.1007/s00066-013-0415-1
http://dx.doi.org/10.1007/s00066-013-0415-1
http://dx.doi.org/10.1118/1.4916686
http://dx.doi.org/10.1118/1.4916686
http://dx.doi.org/10.1016/0168-583X(85)90707-4
http://dx.doi.org/10.1016/0168-583X(85)90707-4
http://dx.doi.org/10.1016/0168-583X(85)90707-4
http://dx.doi.org/10.1118/1.3643029
http://dx.doi.org/10.1118/1.3643029
http://dx.doi.org/10.1118/1.3643029
http://dx.doi.org/10.1088/0031-9155/46/4/318
http://dx.doi.org/10.1088/0031-9155/46/4/318
http://dx.doi.org/10.1088/0031-9155/46/4/318
http://dx.doi.org/10.1088/0031-9155/33/8/004
http://dx.doi.org/10.1088/0031-9155/33/8/004
http://dx.doi.org/10.1088/0031-9155/33/8/004
http://dx.doi.org/10.1088/0031-9155/48/21/R01
http://dx.doi.org/10.1088/0031-9155/48/21/R01
http://dx.doi.org/10.1088/0031-9155/48/21/R01
http://dx.doi.org/10.1088/0031-9155/59/4/911
http://dx.doi.org/10.1088/0031-9155/59/4/911
http://dx.doi.org/10.1088/0031-9155/59/4/911

