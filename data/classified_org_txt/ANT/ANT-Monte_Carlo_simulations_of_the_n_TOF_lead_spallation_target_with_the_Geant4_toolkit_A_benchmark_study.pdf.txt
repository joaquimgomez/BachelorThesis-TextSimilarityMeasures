


















































Monte carlo simulations of the n_TOF lead spallation target with the Geant4 toolkit: A benchmark study


EPJ Web of Conferences 146, 03030 (2017) DOI: 10.1051/epjconf/201714603030
ND2016

Monte Carlo simulations of the n TOF lead spallation target with
the Geant4 toolkit: A benchmark study

J. Lerendegui-Marco1,a, M.A. Cortés-Giraldo1, C. Guerrero1, J.M. Quesada1, S. Lo Meo2,3, C. Massimi3,4,
M. Barbagallo5, N. Colonna5, D. Mancussi6, F. Mingrone7, M. Sabaté-Gilarte7,1, G. Vannini3,4, V. Vlachoudis7,
O. Aberle7, J. Andrzejewski8, L. Audouin9, M. Bacak6,7,10, J. Balibrea11, F. Bečvář12, E. Berthoumieux6, J. Billowes13,
D. Bosnar14, A. Brown15, M. Caamaño16, F. Calviño17, M. Calviani7, D. Cano-Ott11, R. Cardella7, A. Casanovas17,
F. Cerutti7, Y.H. Chen9, E. Chiaveri1,7,13, G. Cortés17, L. Cosentino18, L.A. Damone5,19, M. Diakaki6, C. Domingo-Pardo20,
R. Dressler21, E. Dupont6, I. Durán16, B. Fernández-Domı́nguez16, A. Ferrari7, P. Ferreira22, P. Finocchiaro18, K. Göbel23,
M.B. Gómez-Hornillos18, A.R. Garcı́a11, A. Gawlik8, S. Gilardoni7, T. Glodariu24, I.F. Gonçalves22, E. González11,
E. Griesmayer10, F. Gunsing6,7, H. Harada25, S. Heinitz21, J. Heyse26, D.G. Jenkins15, E. Jericha10, F. Käppeler27, Y. Kadi7,
A. Kalamara28, P. Kavrigin10, A. Kimura25, N. Kivel21, M. Kokkoris28, M. Krtička12, D. Kurtulgil23, E. Leal-Cidoncha16,
C. Lederer29, H. Leeb10, S.J. Lonsdale29, D. Macina7, J. Marganiec8,30, T. Martı́nez11, A. Masi7, P. Mastinu31,
M. Mastromarco5, E.A. Maugeri21, A. Mazzone5,32, E. Mendoza11, A. Mengoni27, P.M. Milazzo33, A. Musumarra18,34,
A. Negret24, R. Nolte30, A. Oprea24, N. Patronis35, A. Pavlik36, J. Perkowski8, I. Porras37, J. Praena37, D. Radeck30,
T. Rauscher38,39, R. Reifarth23, P.C. Rout40, C. Rubbia7, J.A. Ryan13, A. Saxena40, P. Schillebeeckx26, D. Schumann21,
A.G. Smith13, N.V. Sosnin13, A. Stamatopoulos28, G. Tagliente5, J.L. Tain20, A. Tarifeño-Saldivia13, L. Tassan-Got9,
S. Valenta12, V. Variale5, P. Vaz22, A. Ventura28, R. Vlastou28, A. Wallner41, S. Warren13, P.J. Woods29, T. Wright13,
P. Žugec14,7, and the n TOF Collaboration

1 Universidad de Sevilla, Spain
2 Agenzia nazionale per le nuove tecnologie (ENEA), Bologna, Italy
3 Istituto Nazionale di Fisica Nucleare, Sezione di Bologna, Italy
4 Dipartimento di Fisica e Astronomia, Università di Bologna, Italy
5 Istituto Nazionale di Fisica Nucleare, Sezione di Bari, Italy
6 CEA Saclay, Irfu, Gif-sur-Yvette, France
7 European Organization for Nuclear Research (CERN), Switzerland
8 University of Lodz, Poland
9 Institut de Physique Nucléaire, CNRS-IN2P3, Univ. Paris-Sud, Université Paris-Saclay, 91406 Orsay Cedex, France

10 Technische Universität Wien, Austria
11 Centro de Investigaciones Energeticas Medioambientales y Tecnológicas (CIEMAT), Spain
12 Charles University, Prague, Czech Republic
13 University of Manchester, UK
14 University of Zagreb, Croatia
15 University of York, UK
16 University of Santiago de Compostela, Spain
17 Universitat Politècnica de Catalunya, Spain
18 INFN Laboratori Nazionali del Sud, Catania, Italy
19 Dipartimento di Fisica, Università degli Studi di Bari, Italy
20 Instituto de Fı́sica Corpuscular, Universidad de Valencia, Spain
21 Paul Scherrer Institut (PSI), Villingen, Switzerland
22 Instituto Superior Técnico, Lisbon, Portugal
23 Goethe University Frankfurt, Germany
24 Horia Hulubei National Institute of Physics and Nuclear Engineering, Romania
25 Japan Atomic Energy Agency (JAEA), Tokai-mura, Japan
26 European Commission, Joint Research Centre, Geel, Retieseweg 111, 2440 Geel, Belgium
27 Karlsruhe Institute of Technology, Campus North, IKP, 76021 Karlsruhe, Germany
28 National Technical University of Athens, Greece
29 School of Physics and Astronomy, University of Edinburgh, UK
30 Physikalisch-Technische Bundesanstalt (PTB), Bundesallee 100, 38116 Braunschweig, Germany
31 Istituto Nazionale di Fisica Nucleare, Sezione di Legnaro, Italy
32 Consiglio Nazionale delle Ricerche, Bari, Italy
33 Istituto Nazionale di Fisica Nucleare, Sezione di Trieste, Italy

a e-mail: jlerendegui@us.es

c© The Authors, published by EDP Sciences. This is an Open Access article distributed under the terms of the Creative Commons Attribution License 4.0
(http://creativecommons.org/licenses/by/4.0/).



EPJ Web of Conferences 146, 03030 (2017) DOI: 10.1051/epjconf/201714603030
ND2016

34 Dipartimento di Fisica e Astronomia, Università di Catania, Italy
35 University of Ioannina, Greece
36 University of Vienna, Faculty of Physics, Vienna, Austria
37 University of Granada, Spain
38 Department of Physics, University of Basel, Switzerland
39 Centre for Astrophysics Research, University of Hertfordshire, UK
40 Bhabha Atomic Research Centre (BARC), India
41 Australian National University, Canberra, Australia

Abstract. Monte Carlo (MC) simulations are an essential tool to determine fundamental features of a neutron
beam, such as the neutron flux or the γ -ray background, that sometimes can not be measured or at least not
in every position or energy range. Until recently, the most widely used MC codes in this field had been
MCNPX and FLUKA. However, the Geant4 toolkit has also become a competitive code for the transport of
neutrons after the development of the native Geant4 format for neutron data libraries, G4NDL. In this context,
we present the Geant4 simulations of the neutron spallation target of the n TOF facility at CERN, done with
version 10.1.1 of the toolkit. The first goal was the validation of the intra-nuclear cascade models implemented
in the code using, as benchmark, the characteristics of the neutron beam measured at the first experimental
area (EAR1), especially the neutron flux and energy distribution, and the time distribution of neutrons of equal
kinetic energy, the so-called Resolution Function. The second goal was the development of a Monte Carlo tool
aimed to provide useful calculations for both the analysis and planning of the upcoming measurements at the
new experimental area (EAR2) of the facility.

1. Introduction and motivation
The neutron beam of the n TOF facility is generated
through spallation reactions produced by 20 GeV/c protons
provided by the CERN Proton Synchrotron (PS) on a
40 cm thick lead target. The neutrons produced inside the
lead target are partially moderated and travel towards the
two experimental areas along two different beam lines: a
185 m vacuum pipe oriented in the forward direction to the
experimental area #1 (EAR1) [1], and a 19 m one oriented
vertically towards the experimental area #2 (EAR2) [2].

Monte Carlo (MC) simulations are an essential tool to
determine fundamental features of a neutron beam, such as
the neutron flux or the γ -ray background, that sometimes
can not be measured or at least not in every position or
energy range. Indeed, in the case of time-of-flight facilities,
the energy resolution broadening, known as the Resolution
Function, can not be measured and must be extracted from
MC simulations. Until recently, the most widely used MC
codes had been MCNP [3] and FLUKA [4]. However the
Geant4 toolkit [5,6] has become a competitive code also
in this field, especially after the work of Mendoza et al. [7]
to adapt the evaluated neutron libraries to Geant4 native
format, G4NDL.

2. Geant4 simulations: Geometry,
scoring and physics lists
The main component of the n TOF spallation target
assembly is a 60 cm diameter and 40 cm thick lead core.
Neutrons escaping this lead cylinder pass through several
moderating layers (H20 and borated H2O) expanding the
energy range from GeV to thermal. An illustrative view of
the target-moderator assembly as implemented in Geant4
is presented in Fig. 1, including not only the lead core
and water moderators but all the surrounding materials,
that also play a role in the energy distribution of the
neutron flux, the γ -ray spectrum, the beam profile or the
Resolution Function. A more detailed description of
the target geometry and the exits towards both experimen-
tal areas can be found in Refs. [8,9].

In our simulations the 20 GeV/c proton beam impinges
on the target in the direction shown in Fig. 1 with a polar
angle of 10 degrees with respect to the target central axis,
producing hundreds of neutrons and γ -rays per proton,
emitted in all directions. Secondary particles produced
in the target are followed and tracked up to the scoring
volumes positioned at the entrance of the vacuum beam
pipes where their position, time, angle, energy and particle
type are registered. These scoring volumes shown in Fig. 1,
are the end point of our MC simulation.

Geant4 v10.1.1 provides a wide variety of physics
models that apply in different energy regimes. To perform
these simulations we worked with the officially released
Physics Lists (PL) that include either the Fritiof (FTF)
model or the Quark-Gluon-String (QGS) model above
∼10 GeV; the P after FTF or QGS denotes that the
Geant4 native Precompound model is taken into account
for nuclear de-excitation. Below ∼10 GeV three different
intranuclear de-excitation cascade models are available:
INCLXX [10,11], Bertini (BERT) [12] or Binary Cascade

Figure 1. Left: detailed geometry model of the spallation target
assembly as implemented in Geant4. Right: MC simulation
finishes when particles exiting the target are registered in the
scoring volumes highlighted in a lighter color.

2



EPJ Web of Conferences 146, 03030 (2017) DOI: 10.1051/epjconf/201714603030
ND2016

(BIC) [13]. Neutron induced reactions below 20 MeV are
simulated by means of the G4NeutronHP package, using
the ENDF/B-VII.0 cross section library [11] in our case.
Last, we have also considered the Geant4 built-in special
treatment of the Thermal Scattering of neutrons below
4 eV. This is not a feature included in any official Geant4
physics list. Thus, to make this clearer we denote our
physics lists using HPT, instead of the official notation HP
used for the G4NeutronHP package.

3. Simplified optical transport
to the EARs
The Geant4 simulation ends when the neutrons or photons
entering the scoring volumes (highlighted in white in
Fig. 1) are registered into a text file. We only accepted
particles with incidence angle at the scoring surface
smaller than 4 deg, since the energy distribution within
this angle interval is isotropic for neutron energies below
1 GeV, as has been proven in Refs. [8,9]. Our final
results should describe the neutron beam features at the
experimental areas; however, detailed MC simulations of
the full beamline would be unaffordable concerning CPU
time [9]. To solve this issue we have used a code that
reduces the transport along the beam line to a problem
of beam optics. In brief, a large number of particles is
emitted for each particle stored in the Monte Carlo output
file, conserving the original energy, time and position at the
scorer, but varying the direction isotropically within a cone
aperture calculated according to the angular acceptance
of the first collimator. The position and dimensions of
the collimators are included in this code that determines
whether a particle reaches the EAR or hits one of the
collimators, being thus rejected.

4. EAR1: Benchmarking Geant4
The fast development of the Geant4 [5] simulation toolkit
and the work done by Mendoza et al. [7] to include
evaluated cross section libraries in Geant4 have recently
made it possible to rely on this toolkit for the simulation
of the neutron transport. As a first step we wanted to
benchmark Geant4 for the specific case of spallation
neutrons, trying to reproduce the absolute value and
energy dependence of the experimental neutron flux in
n TOF-EAR1 [14]. The energy dependence of the average
neutron flux per pulse, considering the nominal proton
pulse intensity of 7 · 1012 protons, has been calculated
from the output of the Geant4 simulation after the
geometrical transport to EAR1. The upper panel of Fig. 2
compares all the studied Geant4 Physics Lists (PL) with
the experimental flux measured in n TOF-EAR1 [14].
These results indicate that all the models overestimate
the integrated neutron flux, being QGSP INCLXX HPT
the closest, just 12% above the experiment. Comparing
the different PL’s, the deviations in shape between the
different hadronic models are clear at high energies
(neutron kinectic energy above 10 MeV) and the choice
of model also affects the magnitude of the integral flux
at all energies. If we normalize to the experiment at
1 keV to focus on the shape of the flux, we find a
remarkably good reproduction of the experimental data
from thermal to 10 MeV; above 10 MeV all models

d
ln

(E
)

d
N

N
e

u
tr

o
n

s 
p

e
r 

P
u

ls
e

 

410

510

FTFP BERTINI
QGSP BERTINI
QGSP BIC
FTFP INCL 
QGSP INCL
Experimental Flux

Neutron energy (eV)
1−10 1 10 210 310 410 510 610 710 810 910

R
e
si

d
u
a
ls

 (
%

)

0
20
40
60
80

100
120

d
ln

(E
)

d
N

N
e

u
tr

o
n

s 
p

e
r 

P
u

ls
e

 

410

510
FTFP BERTINI (x0.54)
QGSP BERTINI (x0.57)
QGSP BIC (x0.0.66)
FTFP INCL (x0.81)
QGSP INCL (x0.88)
Experimental Flux

Neutron energy (eV)
1−10 1 10 210 310 410 510 610 710 810 910

R
e

si
d

u
a

ls
 (

%
)

40−

20−

0

20

40

60

Figure 2. Top: average neutron flux per pulse at n TOF-EAR1
obtained with the different Geant4 Physics Lists (PL) compared
to the experimental data (see [14]). Bottom: same comparison
after normalizing the simulated results to the experimental data
in the epithermal region to appreciate the good reproduction of
the shape.

show discrepancies with respect to the measured neutron
spectrum, being FTFP BERT HPT the physics list with
smaller residuals (see Fig. 2, bottom panel). For more
details of this work the reader is referred to Ref. [8].

5. EAR2: Characteristics and prospects
As in every new facility, a series of experimental
campaigns are being carried out in order to determine the
flux, spatial and energy distributions of the neutron beam,
the associated backgrounds, the resolution broadening,
and, in general, its measurement capabilities. However,
not all these characteristics can be accurately measured,
and certainly not in all the spatial positions and energy
ranges of interest. In this context, Monte Carlo simulations
become an essential tool for guiding the measurements,
helping in their analysis, the interpretation of their results
and, more importantly, for planning the upcoming physics
experiments.

After benchmarking the different Geant4 PL with the
experimental flux of EAR1, we extended our work to
extract important results for n TOF-EAR2 that will be
really helpful for feasibility studies, planning and analysis
of the upcoming measurements. Figure 3 shows two
relevant features predicted with these MC simulations.
First, the γ -ray energy spectrum, shown in the top panel
of Fig. 3, where two components are distinguished.
The γ -rays produced via spallation reactions are emitted
promptly with the arrival of the proton beam and arrive

3



EPJ Web of Conferences 146, 03030 (2017) DOI: 10.1051/epjconf/201714603030
ND2016

s)µ Production Time(
3−10 2−10 1−10 1 10 210 310 410

N
e
u
tr

o
n
 e

n
e
rg

y 
(e

V
)

3−10

2−10

1−10
1

10

210

310

410

510

610

710

810

910

1

10

210

310

410

Figure 3. Top: energy distribution of the prompt and delayed
γ -ray components in EAR2, including indications of the most
prominent γ -rays from capture reactions and the annihilation
peak. Bottom: resolution Function of the n TOF-EAR2 neutron
beam expressed in the form of neutron energy vs. production time
(i.e. time of arrival at the scorer).

at EAR2 in less than ∼200 ns. The γ -rays arriving after
∼200 ns (thus delayed) are generated in capture reactions
during the moderation process, up to a maximum delay
of 10 ms. The latter component, which presents some
characteristic peaks (see Fig. 3), becomes a relevant source
of background in capture experiments because it is difficult
to distinguish these photons from the capture γ -rays of
the investigated sample. Last, in the bottom panel of
Fig. 3 we show the spread of the production times for a
given neutron energy, the so-called Resolution Function,
which is related to the spread of the original charged

particle beam, the neutron production mechanism, and the
neutron moderation. These effects introduce a broadening
in the structures or resonances observed in time-of-flight
experiments. A more detailed description of this work can
be found in Ref. [9].

We acknowledge the n TOF Collaboration. The research that led
to these results has received funding from the EC FP7 Programme
under the projects NEUTANDALUS (Grant No. 334315) and
CHANDA (Grant No. 605203), and the Spanish Ministry
of Economy and Competitiveness projects FPA2011-28770-
C3-02, FPA2013-45083-P and FPA2014- 53290-C2-2-P. The
simulations have been performed at the computing cluster FIS-
ATOM, hosted at CICA (Seville, Spain), and of INFN-CNAF,
University of Bologna; we thank the staff of both institutions for
the operational maintenance of the machines.

References

[1] C. Guerrero et al. (The n TOF Collaboration), Eur.
Phys. J. A 49, 27 (2013)

[2] C. Weiss et al., Nucl Instrum. and Meth. A 799,
90–98 (2015)

[3] D.B. Pelowitz, ed., Los Alamos National Laboratory
report, LA-CP-11-00438 (2011)

[4] A. Ferrari et al., CERN-2005-10,INFN/TC 05/11,
SLAC-R-773 (2005)

[5] S. Agostinelli et al., Nucl. Instrum. and Meth. A 506,
250–303 (2003)

[6] J. Allison et al., IEEE Trans. Nucl. Sci. 53, 270–278
(2006)

[7] E. Mendoza et al., IEEE Trans. Nucl. Sci. 61, 2357
(2014)

[8] S. Lo Meo et al., Eur. Phys. J. A 51, 160 (2015)
[9] J. Lerendegui-Marco et al., Eur. Phys. J. A 52, 100

(2016)
[10] A. Boudard et al., Phys. Rev. C 87, 014606 (2013)
[11] D. Mancusi et al., Phys. Rev. C 90, 054602 (2014)
[12] A. Heikkinen et al., Bertini intra-nuclear cascade

implementation in Geant4, in Computing in High
Energy and Nuclear Physics, La Jolla, California,
March 24–28, 2003

[13] G. Folger et al., Eur. Phys. J. A 21, 407–417 (2004)
[14] M. Barbagallo et al., (The n TOF Collaboration),

Eur. Phys. J. A 49, 156 (2013)

4


	1 Introduction and motivation
	2 Geant4 simulations: Geometry, scoring and physics lists
	3 Simplified optical transport to the EARs
	4 EAR1: Benchmarking Geant4
	5 EAR2: Characteristics and prospects
	References

