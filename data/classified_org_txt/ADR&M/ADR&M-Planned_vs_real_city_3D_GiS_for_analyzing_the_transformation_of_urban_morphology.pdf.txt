



















































Planned vs. Real City: 3D GIS for Analyzing the Transformation of Urban Morphology


Huerta, Schade, Granell (Eds): Connecting a Digital Europe through Location and Place. Proceedings of the AGILE'2014 

International Conference on Geographic Information Science, Castellón, June, 3-6, 2014. ISBN: 978-90-816960-4-3  

 

1 Introduction 

Urban processes driven by changing social, economic and 

environmental factors must be rethought [1, 2]. The 

development of the cities of the future does not necessarily 

need to be the sprawling growth of past decades but the 

regeneration of existing urban spaces [3]. Technology can 

help understand these processes and allow policymakers to 

make better decisions [4] with deeper public participation [5] 

for more adaptable, dependable and liveable cities [6]. 

In the consolidated city and in particular its historic centre, 

the complexity of the urban pattern makes the regeneration 

processes (both physical and social) a difficult task; 

nonetheless, these are usually the areas with a more pressing 

need for urban renewal processes [7]. 

Transformation processes in these settings must handle 

information about the morphology of the built environment 

with a sensitivity that considers urban quality, sustainability 

and security, while giving response to the needs of its 

inhabitants [8]. 

In areas undergoing regeneration processes, planners need 

to know with precision both past and present state of the city 

to plan for a better future. With this objective, a strategic tool 

was developed to aid in the decision-making process, using 

the vast pool of urban data stored in cadastral and planning 

databases to (a) accurately quantify the conformity with 

height regulations of today’s built environment and (b) to 

evaluate the outcomes of modifications of height regulations. 

The object of this paper is to explain the methodology 

developed to precisely quantify the complex interactions 

between built reality and urban regulations. 

1.1 Case of study 

The case of study chosen for the development of the 

methodology was the old quarter of the Sant Andreu District 

in Barcelona. 

The buildings in the area of study (Figure 1) are part of the 

centre of the former town of Sant Andreu, from which the 

district takes its name, and the development it underwent in 

the 19th century when it was incorporated to Barcelona. This 

historic development resulted in a complex urban structure 

suitable to use as workbench to test the methodology, with an 

area of 90 hectare containing 2,775 parcels, distributed in 148 

city blocks around its main commercial street, Gran de Sant 

Andreu. 

The area of study was in the process of modifying the 

planning regulations [9] in effect since 1976 in 27 

municipalities of the Barcelona Metropolitan Area. Being a 

plan from 1976, some parameters such as the maximum 

height were not drawn explicitly in the planning regulations, 

and had to be interpreted [10] with the aid of the staff in the 

Urban Studies Bureau of the Urban Planning Department of 

the Barcelona City Council. 

The case of study was chosen because of the interest the city 

planners had in knowing with precision the compliance of the 

buildings in the area with the maximum heights allowed by 

the planning regulations. 

The methodology developed was very valuable to evaluate 

the possible outcomes of modifications of different parameters 

of the regulations, and made possible to assess the current 

built mass of the whole city.  

Planned vs. Real City: 3D GIS for Analyzing the Transformation of 

Urban Morphology 

Pilar Garcia-Almirall 

Universitat Politècnica de 

Catalunya 

Diagonal 646 

Barcelona, Spain 

pilar.garcia-almirall@upc.edu 

Francesc Valls Dalmau 

Universitat Politècnica de 

Catalunya 

Diagonal 646 

Barcelona, Spain 

francesc.valls@upc.edu 

Montserrat Moix Bergada 

Universitat Politècnica de 

Catalunya 

Diagonal 646 

Barcelona, Spain 

montserrat.moix@upc.edu 
 

Abstract 

Cities are constantly evolving: buildings are built and demolished, altering the landscape of our cities; Urban Plans describe what we want 

our cities to be, undergoing revisions as we change our vision of the future of our cities. This paper presents a methodology to model the 

interactions between what the city is and what it wants to become. The old quarter of Sant Andreu in Barcelona (Spain) was used in a pilot 
study for the development of a methodology to automatically quantify and visualize the outcome of regulation changes as a strategic tool for 

the Urban Planning Department of the Barcelona City Council. This paper describes a methodology developed to measure the magnitude of 

the buildings conformity or disconformity to the determinations of the Urban Plan (current and proposed), and to display this information in 
3D, to allow a more natural interpretation of the results. Special care was put into the methodological approach to ensure that it could be 

replicated at neighbourhood or city-wide scales. A methodology for the interpretation of the heights of staircase towers and ventilation 

courtyards from neighbouring entities heights, through the analysis of adjacency relationships in a non-topological Geographic Information 
System is also discussed. 

 

Keywords: 3D GIS, Urban planning, Urban regeneration, Local management, Smart visualization, Topology 



AGILE 2014 – Castellón, June 3-6, 2014 

 

2 Methodology 

2.1 Interpretation of the height of ventilation 
courtyards and staircase towers 

The height of buildings was stored as 2.5D cartography in a 

sub-parcel dataset (being sub-parcels pieces within a parcel 

with a distinct height from neighbouring sub-parcels). Height 

information was stored as an alphanumeric string which 

encoded several pieces of information about the sub-parcel, 

including the number of floors below and above street level. 

For example, a sub-parcel with a “–II+V” attribute had two 

subterranean floors and five floors above street level. 

In the case of ventilation courtyards (VC) and staircase 

towers (ST), sub-parcels did not have a height attribute but a 

code that identified them as such (“P” for VC and “E” for ST). 

However, ST volumes protrude from flat roofs and VC are 

considered by planning regulations as part of the building, and 

consequently both types needed to be assigned a height value. 

Since VC accounted for almost 20% of the area of all sub-

parcels and ST for another 2%, to get accurate results a 

methodology had to be developed to automatically assign 

height values to this types of entities from their spatial 

context, considering that ST are as high as the top floor they 

serve in their parcel and VC have a lightweight roof at the 

level of the lowest floor they serve in their parcel. 

For sub-parcels representing ST, the assigned value was the 

maximum height of all adjacent sub-parcels belonging to the 

same parcel (Figure 2) and for sub-parcels representing VC, 

the assigned value was the lowest height of all adjacent sub-

parcels belonging to the same parcel (Figure 3). 

The calculation of the height to be assigned to ST and VC 

involved two topological relationships: (a) adjacency to other 

polygons but (b) considering only polygons inside the same 

parcel. Since the Geographic Information System (GIS) used 

was non-topological, a methodology had to be implemented in 

Structured Query Language (SQL): 

1) A tool to convert lines to polygons was used to get a 
table with 3 ID fields: line ID, left polygon ID and 

right polygon ID (lines) for all sub-parcels (volumes). 

2) A dictionary of key-value pairs (type_dictionary) was 
made to translate the alphanumeric encoding to a 

numeric value (volumes_height) measuring the number 

of floors above street level (Figure 4, above). 

3) A table with the attributes of the polygons on both 
sides of each line was built (lines_volumes) from the 

tables described previously (Figure 4, below). 

4) This intermediate table had to be reshaped as a list 
using union queries, excluding the polygons not 

pertaining to the parcel the fragment belonged to and 

excluding the sub-parcels that were not ST (figure 5, 

left) or VC (Figure 5, right). 

5) An aggregation query for each type was performed to 
get the corresponding values of the height attribute: the 

highest value of all neighbours for ST and the lowest 

value of all neighbours for VC. 

Figure 1: Area of study in the Sant Andreu District of 

Barcelona 

 

 
 

Figure 2: Correction of staircase towers (red) of two 

neighbouring parcels (sub-parcels in brown and blue hues) 

 

Original state (uncorrected)  Volumes after correction 

 

→ 

 

 

→ 

 

 

Figure 3: Correction of ventilation courtyards (blue) of two 

neighbouring parcels (sub-parcels in brown and blue hues) 

 

Original state (uncorrected)  Volumes after correction 

 

→ 

 

 

→ 

 

 

  



AGILE 2014 – Castellón, June 3-6, 2014 

 

2.2 Overlay operations 

With the sub-parcels volumes corrected and their height 

converted to a numeric value, their heights were compared to 

the height the plan allowed using two Boolean spatial 

operations: (a) a spatial intersection (Figure 6, left), the result 

of which was the fragments of sub-parcel inside zones and (b) 

a spatial difference (Figure 6, right), the result of which was 

the fragments of sub-parcel inside systems (roads and parks). 

With the result of the overlay operations it was possible to 

determine the conformity to the urban plan for each of the 

fragments (Table 1) from their building height (HB) and 

planned height (HP). 

The magnitude of the conformity (measured in area units) 

for each resulting sub-parcel fragment was represented in a 

map, multiplying its area by the corresponding number of 

floors beneath or exceeding the allowed height (Figure 7). 

This map was a very valuable analytical tool, but to visualize 

its information in a more intuitive way a different approach 

had to be developed to make it easier to interpret. 

 

Table 1: Types of fragments from the overlay operations 

 

Fragment Plan entity Condition Operation Symbology 

Underbuilt Zones HB - HP < 0 Intersection Blue hues 

Conformant Zones HB = HP Intersection Grey 

Overbuilt Zones HB - HP > 0 Intersection Pink hues 

Overbuilt Systems HB > 0 Difference Dark green 

Conformant Systems HB = 0 Difference Light green 

 

 

2.3 Aggregation at parcel level 

It is not legally allowed to compensate overbuilt volumes with 

underbuilt ones inside a parcel (Figure 8), and accordingly 

aggregate calculations had to be performed separately for both 

situations to avoid the aggregate operations adding positive 

and negative numbers (which would be mathematically 

correct but not possible according to the regulations). 

Formulae 1 to 5 show the aggregation operations to 

calculate for each parcel: the total built area (1), the maximum 

allowed built area in zones (2), the overbuilt area in zones (3), 

the underbuilt area in zones (4), and the overbuilt area in 

systems (5). 

 

                    ∑             
         

   ( ) 

 

                       ∑                  

          

( ) 

 

              ∑ (                )           

          

( ) 

 

               ∑ |                |           

          

( ) 

 

                         ∑                  

          

( ) 

Figure 4: Queries to build the neighbours attributes table 

 

 
Figure 5: Operations to obtain all neighbouring volumes 

inside the same parcel for every ST (left) and VC (right) 

 

 

Figure 6: Spatial intersection (left) and difference (right) 

 

  
 

Figure 7: Conformity to the urban plan of each fragment 

 

 

volumes type_dictionary

volumes_height volumes_height

lines

volumes_height

lines_volumes

poly_id

parcel_id

hcode

hcode

height

type

poly_id

parcel_id

type

poly_id

parcel_id

type

line_id

poly_id_l

poly_id_r

poly_id

parcel_id

height

line_id

poly_l

parcel_l

type

height_l

type_l

poly_r

parcel_r

height_r

type_r

lines_volumes lines_volumes

type_r = "E"
parcel_l = parcel_r

type_l = "E"
parcel_l = parcel_r

SUBSET

line_id

poly_l

parcel_l

height_l

type_l

poly_r

parcel_r

height_r

type_r

SUBSET

type_r = "P"
hcode_l <> "E"

parcel_l = parcel_r

type_l = "P
hcode_l <> "E"

parcel_l = parcel_r

SUBSET

line_id

poly_l

parcel_l

height_l

type_l

poly_r

parcel_r

height_r

type_r

SUBSET

UNION QUERY UNION QUERY



AGILE 2014 – Castellón, June 3-6, 2014 

 

Using the following notation: 

 HB: Real height of the building, measured in 
number of floors above street level. 

 HP: Maximum height according to the plan, 
measured in number of floors above street level. 

 A: Area of a polygon entity (surface of land 
occupied). 

 Parc: Set of parcels inside the area of study. 

 Subp: Set of sub-parcels. 

 FragZ: Set of fragments from the spatial 
intersection between parcel and planning layers (in 

zones). 

 FragS: Set of fragments from the spatial difference 
between parcel and planning layers (in systems). 

 

 

3 Results 

3.1 Parcel level results 

The aggregated values were displayed in choropleth maps, to 

visualize the magnitudes of overbuilt and underbuilt areas of 

each parcel. These maps were a strategic tool for the City 

Planning Department to visualize and identify the parcels with 

the most outstanding values. 

With the map of overbuilt areas of parcels (Figure 9), 

planners were able to identify the parcels with a higher degree 

of excess volume and to visualize the spatial clustering of 

overbuilt parcels facing certain streets or concentrated in 

specific city blocks. 

The map of underbuilt areas in parcels (Figure 10) allowed 

planners to visualize the places where underbuilt parcels were 

clustered together as candidates to successfully implement 

transformation policies. 

 

 

3.2 A new approach for the representation of  
fragment level results in 3D 

The representation of the results using 2D maps was unable to 

convey the complex volumetric information successfully 

because height data had to be abstracted to be represented in 

plan view as colour scales, hatch densities or labels. 

The use of 3D imagery allowed the authors to represent the 

volumes in a more natural and intuitive way since it matched 

the way we experience our cities. 

Figure 11 shows the criteria to display the overlapping 

information of overbuilt and underbuilt fragments. The third 

dimension allowed the authors to display overlapping 

information without having to resort to 2D representation 

constructs such as transparency or hatching. 

Figure 12 shows the results for the case of study, where the 

viewer is able to visualize and relate two concepts 

simultaneously (real height and planned height) much more 

easily than using 2D maps. 

An axonometric aerial photograph was compared to the 

corresponding result (Figure 13) to highlight the value of the 

methodology developed as an analysis and visualization tool. 

In the 3D synthetic image the differences between built reality 

and planned city are more apparent and easier to interpret. 

Figure 8: Parcel with overbuilt and underbuilt fragments 

 

 
 

Figure 9: Overbuilt aggregated area in parcels 

 

 
 

Figure 10: Underbuilt aggregated area in parcels 

 

 
 

Figure 11: Height interpretation in the 3D model 

 

 

Overbuilt
fragment

Underbuilt
fragment

R
e

a
l

R
e

a
l

A
ll

o
w

e
d

A
ll

o
w

e
dU
n

d
e

rb
u

il
t

O
v

e
rb

u
il

t

Underbuilt fragment Compliant fragment Overbuilt fragment

A
ll

o
w

e
d

R
e

a
l



AGILE 2014 – Castellón, June 3-6, 2014 

 

 

Figure 12: Volumetric analysis of overbuilt (red) and underbuilt (green) fragments in the case of study 

 

 
 

 

Figure 13: Aerial axonometric view and 3D representation of the same area 

 

       
Source: Bing Maps     

  



AGILE 2014 – Castellón, June 3-6, 2014 

 

3.3 Quantification of the outcomes of proposed 
changes in regulations 

In addition to the visualization of the morphological 

differences between the proposed city and the real built 

environment, the methodology allowed planners to precisely 

quantify the outcomes of proposed regulation changes. 

Figure 14 shows an example of a proposed regulation 

change, where two additional floors could be allowed in part 

of a city block. The methodology allowed decision-makers to 

measure the additional built area that would become 

compliant with the new regulation and the number of 

properties that would change its legal status. 

 

 

4 Conclusions 

The presented methodological approach seeks to assist in 

implementing better policies in urban transformation 

processes, with better and easier to understand information, 

making possible to measure and visualize with precision the 

conformity of the built environment to the determinations of 

Urban Plan, and to evaluate the outcome of proposed 

regulation changes. 

The 3D visualization techniques allow the discovery of 

patterns not obvious even for trained professionals and is a 

valuable tool to communicate the results of the analysis. 

To improve the accuracy of the analysis, a methodology to 

study adjacency relations in a non-topological GIS was 

developed using SQL, which allowed assigning height values 

to entities that didn’t have this attribute from their spatial 

context. 

As further investigations, an improvement of the 

methodology is proposed to incorporate information about 

building quality, economic activity and demographic 

information in densification processes to be able to: 

 Determine which parcels are more likely to be 
transformed according to their age, uses, 

habitability, economic value, etc. 

 Estimate the potential number of people affected by 
and/or benefited from regulation changes. 

 Calculate the taxation of the increased value of the 
properties in redevelopment scenarios. 

 Prioritize zones with greater incompliance and/or 
obsolete typologies (such as outdated industries) to 

be included in transformation processes. 

 Explain the possible historic reasons that have 
resulted in the current morphology of the city. 

Furthermore, to improve the accuracy and usefulness of the 

visualization of the results it is proposed: 

 The incorporation of a Digital Elevation Model 
(DEM) in the 3D model. 

 The use of Augmented Reality tools to visualize the 
results on site. 

 

Acknowledgements 

The authors would like to thank the staff in the Urban Studies 

Bureau of the Urban Planning Department of the Barcelona 

City Council for their collaboration. 

Figure 14: Proposed increased allowed height in a city block 

(above) and resulting outcome (below) 

 

Current state  Proposed change 

 

→ 

 

 

→ 

 

 

 

References 

[1] A. Power, “Does demolition or refurbishment of old and 

inefficient homes help to increase our environmental, 

social and economic viability?,” Energy Policy, vol. 36, 

no. 12, p. 4487–4501, 2008. 

[2] The World Bank, World Development Report 2009: 

Reshaping Economic Geography, Washington DC: 

World Bank, 2008. 

[3] A. Nelson, R. Burby, E. Feser, C. Dawkins, E. Malizia 

and R. Quercia, “Urban containment and central-city 

revitalization,” Journal of the American Planning 

Association, vol. 70, no. 4, pp. 411-425, 2004. 

[4] P. Garcia-Almirall y J. Roca Cladera, “A New Setting 

For Reflecting On Urban Matter. Integration Of GIS 

Technology In Advanced Internet,” in 6th Agile 

Conference On Geographic Information Science, Lyon, 

2003. 

[5] T. Yigitcanlar, “Australian Local Governments’ Practice 

and Prospects with Online Planning,” URISA Journal, 

vol. 18, no. 2, pp. 7-17, 2006. 

[6] V. A. Ceccato and F. Snickars, “Adapting GIS 

technology to the needs of local planning,” Environment 

and Planning B: Planning and Design, vol. 27, no. 6, pp. 

923-937, 2006. 

[7] S. Rueda Palenzuela, Modelos e Indicadores para 

ciudades más sostenibles, Barcelona: Departament de 

Medi Ambient de la Generalitat de Catalunya, 1999. 

[8] J. Alguacil, A. Hernández, M. Medina y C. Moreno, La 

Ciudad de los ciudadanos, Madrid: Centro de 

Publicaciones, Ministerio de Fomento, 1997. 

[9] Corporación Metropolitana de Barcelona, Normas 

urbanísticas: plan general metropolitano de ordenación 

urbana de la entidad municipal metropolitana de 

Barcelona, Barcelona: Corporació Metropolitana de 

Barcelona, 1976. 

[10] M. Ribas Piera, Los denominados standards urbanísticos 

y su aplicación al planeamiento, Barcelona: Urbanística 

III, Escola Tècnica Superior d’Arquitectura de 

Barcelona, Universitat Politècnica de Catalunya, 1982. 


