












































Sensitivity of the thermomechanical response of elastic

structures to microstructural changes

Vı́ctor D. Fachinotti∗, Sebastián Toro, Pablo J. Sánchez, Alfredo E. Huespe

Centro de Investigación de Métodos Computacionales(CIMEC), Universidad Nacional
del Litoral (UNL)/ Consejo Nacional de Investigaciones Cient́ıficas y Técnicas

(CONICET), Predio CCT-CONICET Santa Fe, Ruta 168, Paraje El Pozo, 3000, Santa
Fe, Argentina

Abstract

The paper presents a useful technique for analyzing the sensitivity of the

thermomechanical response of a body with variable microstructure. The

technique can be applied to attain a desired macroscopic response by altering

the body microstructure. This problem is a key issue in material design.

The sensitivity analysis relies on an accurate determination of the effec-

tive properties of the heterogeneous material. These effective properties are

determined by computational homogenization. And their sensitivities, with

respect to the parameters defining the microstructure, are then computed.

For an efficient evaluation of the thermomechanical response, we propose

to build response surfaces for the effective material properties. The surfaces

are generated in an offline stage, by solving a series of homogenization prob-

lems at the microscale. In such a way, the fully online multiscale response

analysis reduces to a standard monoscale problem at the macroscale. Thus,

an important reduction in computational time is achieved, which is a crucial

∗Corresponding author
Email address: vfachino@intec.unl.edu.ar (Vı́ctor D. Fachinotti )

Preprint submitted to Elsevier March 5, 2015

NOTICE: this is the author’s version of a work that was accepted for publication in International 
Journal of Solids and Structures. Changes resulting from the publishing process, such as peer 
review, editing, corrections, structural formatting, and other quality control mechanisms may not 
be reflected in this document. Changes may have been made to this work since it was submitted 
for publication. A definitive version was subsequently published in International Journal of Solids 
and Structures, [VOL 69-70, (September 2015)] DOI 10.1016/j.ijsolstr.2015.06.009



advantage for material design.

The capability of the proposed methodology is shown in light of its appli-

cation to the design of a thermally-loaded structure with variable microstruc-

ture. Perceptible improvements in the structural response are achieved.

Keywords: Microstructural material design, Structural optimization,

Sensitivity to microstructural changes, Computational homogenization of

materials, Response surface methodology.

1. Introduction

As stated by Torquato [1], the deep knowledge of the sensitivity of the

response of a material at the macroscopic scale to changes in the structure

of this material at one or more subscales is the holy grail of materials sci-

ence. This is the base of the Materials by Design (MbD) approach [2], which

proposes to design the subscale structure of a material in order to make this

material the best-suited for a specific application. By subscale we refer to a

wide range of length scales, from atomistic or molecular to microscopic and

mesoscopic, whenever the length scale be much smaller than the dimensions

of the structure made of the considered material.

In this work, we focus on the design of a heterogeneous material, typically

a composite, by altering its microstructure at a scale where the material can

be still assumed as continuum. Further, we will deal with “quantitatively

characterized” materials [3], those whose macroscopic or effective physical

properties can be expressed as functions of identified microstructural pa-

rameters: e.g., fiber orientation in fiber-reinforced polymers [4], density and

irregularity factors in materials with isolated inhomogeneities [3, 5], size of

2



particles or beads in coating of dental implants [6, 7].

The dependence of effective properties on microstructural parameters can

be determined experimentally –the most expensive option–, analytically –for

simple microstructures– [3, 5], by using simplified homogenization techniques

like SIMP (solid isotropic material with penalization) [4, 8], or numerically

using Computational Multiscale Modeling (CMM) [6, 7]. The latter is the

most general approach, the one preferred in this work. Using computa-

tional homogenization over a parameterized Representative Volume Element

(RVE), we build a grid of homogenized property vs. microstructural param-

eter, one for each independent tensorial component of the physical proper-

ties involved in steady-state thermomechanical problems: the fourth-order

elasticity tensor and the second-order thermal expansion and thermal con-

ductivity tensors. Since it is offline and easily parallelizable, this procedure

allows a considerable reduction of the computational effort of CMM in the

online stage.

The final goal of this work is the analysis of the sensitivity of a macro-

scopic structure under given thermomechanical loads to changes in the mi-

crostructure of the material. Mathematically, this accounts for the compu-

tation of the derivatives of the macroscopic temperature and displacement

fields with respect to the microstructural parameters.

By accounting for the thermal coupling, this work constitutes a step fur-

ther in sensitivity analysis of purely mechanical multiscale problems [9, 10].

Since we allow microstructure to vary throughout the macroscopic struc-

ture, a huge number of design variables come into play, making the efficient

computational evaluation of sensitivities of uppermost importance. The of-

3



fline definition of material properties as functions of microparameters is an

important contribution in this sense, making the current multiscale model as

expensive as a monoscale one. Further, efficiency is improved by computing

the derivatives of material properties with respect to microparameters in a

closed analytical way.

Finally, we apply sensitivity analysis to determine the effect of chang-

ing the microstructural parameters defining the bi-material used to made a

thermally loaded structure, in seek of a more efficient structure in terms of

stiffness or compliance.

2. The two-scale thermomechanical problem

s

RVE

(microscale)

y

W

W

G

n
m

Body

(macroscale)

q, s

X

m

y2

u

uwall

qwall

q

T

T
wall

¶W

T, Ñ T, u,Ñ uX X
s

¶W

¶W

¶W

m
m

twall

y1
X1X1

X2

l

Figure 1: Two-scale thermomechanical problem.

Let us consider a body Ω ⊂ Rdim, Figure 1, undergoing a steady state

thermomechanical loading process: the heat flux qwall and the temperature

Twall are prescribed on the boundaries ∂Ωq and ∂ΩT , respectively, while the

traction twall and the displacement uwall are prescribed on the boundaries

4



∂Ωσ and ∂Ωu, respectively. Considering these boundary conditions, the sets

of admissible temperature and displacement fields are:

T = {T (X) | T is sufficiently smooth in Ω and T = Twall on ∂ΩT}, (1)

U = {u(X) | u is sufficiently smooth in Ω and u = uwall on ∂Ωu}, (2)

while the spaces of admissible temperature and displacement variations are:

T̂ = {T̂ (X) | T̂ is sufficiently smooth in Ω, and T̂ = 0 on ∂ΩT}, (3)

Û = {û(X) | ûi is sufficiently smooth in Ω, and û = 0 on ∂Ωu}. (4)

Then, the current macroscopic thermomechanical problem can be stated

in the standard variational format as follows: find T ∈ T and u ∈ U satisfy-

ing: ∫
Ω

q(T ) · ∇X T̂ dV −
∫
∂Ωq

qwallT̂ dS = 0, ∀T̂ ∈ T̂ , (5)∫
Ω

σ(u, T ) · ∇sX û dV −
∫
∂Ωσ

twall · û dS = 0, ∀û ∈ Û , (6)

where q is the macroscopic flux vector and σ is the macroscopic Cauchy stress

tensor. Equation (5) represents the steady-state heat balance equation in

absence of internal heat source, while (6) is the momentum balance equation

in absence of body forces and inertial terms.

The problem is completed by the constitutive laws for q and σ at any

point X ∈ Ω, which are determined in this work from the analysis of the

microstructure at this point.

Let the body have a heterogeneous microstructure that, at any point

X ∈ Ω, is described by a Representative Volume Element (RVE), denoted

5



Ωµ, shown in Figure 1. Points in Ωµ are denoted y. From now on, any

quantity (·) described in the domain Ωµ will be referred to as (·)µ.

As stated in the Appendix, the macroscopic q and σ atX ∈ Ω are defined

by the homogenization formulas:

q =
1

|Ωµ|

∫
Ωµ

qµ dv, (7)

σ =
1

|Ωµ|

∫
Ωµ

σµ dv, (8)

where |Ωµ| is the volume of Ωµ.

The constitutive response of the microconstituents found in the domain

Ωµ is assumed to be known. Further, for the purpose of this work, the

behavior of the microconstituents is assumed to be linear. In such a case, qµ

and σµ are respectively defined by the Fourier’s and Hooke’s laws:

qµ = −kµ ∇yTµ, (9)

σµ = Cµ ∇syuµ + dµ
(
Tµ − T 0

)
, (10)

where kµ is the thermal conductivity tensor, Cµ is the elasticity tensor, dµ

is the stress increment per unit temperature, all of them are assumed to be

known properties of the material at y ∈ Ωµ; T 0 is the reference temperature

for zero-thermal stress, assumed to be common to all the microconstituents.

For the sake of clarity, the computation of homogenized fields q and σ is

detailed in the Appendix. As shown there, the linearity of the constitutive

laws (9) and (10) for the microscopic fields qµ and σµ is inherited by the

constitutive laws for the homogenized fields q and σ, given by:

q = −k ∇XT, (11)

σ = C ∇sXu+ d(T − T
0), (12)

6



where we introduce the effective thermal conductivity k, the effective elastic

moduli C, and the effective stress increment per unit temperature d, defined

by equations (AI-22), (AI-27) and (AI-32) in the Appendix, respectively.

3. Finite element model

In order to solve the problem by the Finite Element Method (FEM),

the unknown temperature and displacement fields are approximated for all

X ∈ Ω by:

T (X) = Φi(X)Ti = Φ(X)T , (13)

u(X) = Φi(X)ui = Φ
m(X)U , (14)

where Ti and ui are the temperature and displacement unknowns at the i-th

node of the finite element mesh, and Φi is the shape function associated to this

node; Ti and ui are grouped in the column vectors T and U , respectively,

while the shape functions Φi are grouped either in the row vector Φ for

thermal analysis or in the matrix Φm for mechanical analysis.

Using standard Galerkin FEM, the shape functions Φi also define the basis

functions for the finite-dimensional spaces approximating T̂ and Û . Then,

the weak form of the thermal problem (5), after replacing the macroscopic

Fourier’s law (11), can be written as:

KT = −F , (15)

with

K =

∫
Ω

BTkB dV, (16)

F =

∫
∂Ωq

ΦT qwall dS, (17)

7



where Bij = ∂Φi/∂Xj is the gradient matrix.

In a similar way, the weak form of the mechanical problem (6), after

replacing the constitutive equation (12), can be written as:

KmU + F tm(T ) = −Fm, (18)

where

Km =

∫
Ω

(Bm)
T
,CBm dV, (19)

Fm =

∫
∂Ωσ

(Φm)
T
twall dS, (20)

F tm = −
∫

Ω

(Bm)
T
d
(
T − T 0

)
dV, (21)

(22)

and Bm is the strain-displacement matrix.

4. Sensitivity of the macroscopic thermomechanical response to

microstructural changes

For the sake of generality, let the microstructure varies throughout the

macroscopic domain Ω. Using FEM, Ω is represented by a mesh of finite

elements, giving rise to a finite number of sampling points Xα. Each point

Xα has an associated RVE denoted Ω
(α)
µ .

Let us remind that we deal with “quantitatively characterized materials”

[3], those where the microstructure at any RVE, Ω
(α)
µ , can be described by a

finite (usually reduced) number of microstructural parameters p
(α)
1 , p

(α)
2 , . . . ,

for instance, the fiber orientation in fiber-reinforced polymers [4], the porosity

and the eccentricity in solids with elliptic holes [3], the size and the volume

fraction of particles in dental coating [6], etc.

8



For such materials, every effective property at a pointXα ∈ Ω –computed

by homogenization over the corresponding so-parameterized RVE Ω
(α)
µ as

described in the Appendix– is actually a function of the microstructural

parameters p
(α)
1 , p

(α)
2 , . . . . Considering that the macroscopic response of the

whole body is made of contributions from all the sampling pointsX1,X2, . . .

of the finite element mesh, the macroscopic fields T and u depend of the

microstructural parameters defining the RVEs of all these points, i.e. T =

T (P ) and u = u(P ), with

P =
[
p

(1)
1 , p

(2)
2 , . . . p

(2)
1 , p

(2)
2 , . . .

]
. (23)

The thermomechanical macroscopic response is defined by a given func-

tion R, the so-called objective or cost function in structural optimization

problems [8], which depends of global nodal temperature and displacement

vectors as primal variables, i.e.

R = R(U ,T ), (24)

where U and T satisfy their respective balance equations (15) and (18).

Hence, the balance equations are implicit in the objective function R. That

is, they are not dealt with as constraints in the sensitivity analysis. The

current choice is favored by the linearity of the balance equations (15) and

(18).

The sensitivity of this response to microstructural changes is

dR
dPi

=
∂R
∂Uj

∂Uj
∂Pi

+
∂R
∂Tj

∂Tj
∂Pi

. (25)

The computation of the sensitivity of T and U to microstructural changes

is the goal of Sections 4.1 and 4.2, respectively.

9



4.1. Sensitivity of macroscopic temperature to microstructural changes

Since the effective thermal conductivity tensor k depends on the param-

eterized microstructure according to equation (AI-22), a variation of the

microstructure, represented as δP , induces the following variation in the

conductivity matrix (equation (16)):

δK =

∫
Ω

BT δkB dV. (26)

The variations of (any nonsingular matrix) K and its inverse are related by:

δ
(
K−1

)
= −K−1δKK−1. (27)

Then, the variation of the nodal temperature vector T , solution of the linear

heat balance equation (15), can be expressed as:

δT = δ
(
K−1

)
F = −K−1δKK−1F = −K−1δKT . (28)

Therefore, the sensitivity of the nodal temperatures T to a change in Pi is

∂T

∂Pi
= −K−1si, (29)

where si is the column vector

si =
∂K

∂Pi
T , (30)

and the derivative of K, obtained from equation (26), is

∂K

∂Pi
=

∫
Ω

BT
∂k

∂Pi
B dV. (31)

Let us restrict equation (29) to node Xj:

∂Tj
∂Pi

= −j · si, (32)

10



where j refers to the j-th row of K−1.

It is worth mentioning that ∂Tj/∂Pi is generally non null for any node

Xj 6∈ ∂ΩT , even if Pi describes the microstructure at a point far from the

node Xj. This non-local effect of the change of the microstructure is detri-

mental to the computational cost of sensitivity in thermomechanical prob-

lems, as it will be explained in Section 4.2.1. Let us note that this effect is

disregarded if the thermal expansion is assumed to be homogeneous through-

out the macroscopic body, as done by [8], which is often a too restrictive

hypothesis for engineering applications.

4.1.1. FEM implementation details

If Pi (totally or partially) defines the microstructure at a sampling point

Xα inside a given finite element Ω
e, then, ∂k/∂Pj = 0 when Pj is associated

to any other sampling point. Therefore, only the sampling point Xα ∈ Ωe

contributes to the global matrix ∂K/∂Pi, equation (31), as follows:

∂K

∂Pi
=



[
BT ∂k

∂Pi
B
]
Xα

wα|Ωe| for Pi associated to Xα ∈ Ωe

0 otherwise
, (33)

where wα is the weight associated to the sampling point Xα. Note that there

is no summation over the index α in equation (33).

Then, ∂K/∂Pi is markedly sparse and can be computed based on only

one element, and these properties are inherited by the global vector si given

by equation (30).

4.2. Sensitivity of macroscopic displacement to microstructural changes

Since the macroscopic elasticity tensor C depends on the parameterized

microstructure; and according with equation (19), a variation δP induces

11



the following variation in the stiffness matrix K:

δKm =

∫
Ω

(Bm)
T
δCBm dV. (34)

Further, δP induces changes in the macroscopic property d and in the macro-

scopic temperature field T . Thus, according with equation (21), the vector

F tm has the variation:

δF tm ≡ δF t = −
∫

Ω

(Bm)
T
δd
(
T − T 0

)
dV −

∫
Ω

(Bm)
T
d δT dV. (35)

Then, the variation of the nodal displacement vector U , solution of the linear

equilibrium equation (18), is:

δU = δ
[
(Km)

−1]
F tm + (Km)

−1
δF tm

= − (Km)−1
(
δKm (Km)

−1
F tm − δF tm

)
= − (Km)−1

(
δKmU − δF tm

)
. (36)

Differentiating with respect to Pi, we obtain

∂U

∂Pi
= − (Km)−1 smi , (37)

where smi is the column vector

smi =
∂Km

∂Pi
U −

∂F tm

∂Pi
, (38)

with

∂Km

∂Pi
=

∫
Ω

(Bm)
T ∂C

∂Pi
Bm dV, (39)

∂F tm

∂Pi
=

[
−
∫

Ω

(Bm)
T ∂d

∂Pi

(
T − T 0

)
dV

]
︸ ︷︷ ︸

v1i

+

[
−
∫

Ω

(Bm)
T
d
∂T

∂Pi
dV

]
︸ ︷︷ ︸

v2i

. (40)

12



By restricting equation (37) to the j-th component of the nodal displace-

ment vector U , we obtain:

∂Uj
∂Pi

= −jm · smi , (41)

where jm denotes the j-th row of the inverse of the stiffness matrix Km.

4.2.1. FEM implementation details

Like in Section 4.1.1, if the microstructural parameter Pi is associated to

a sampling point Xα of a given finite element Ω
e, only this sampling point

contributes to the global matrix ∂Km/∂Pi (equation (39)) and the global

vector v1i (first term of the r.h.s. of equation (40)), as follows:

∂Km

∂Pi
=

[
(Bm)

T ∂C

∂Pi
Bm
]
Xα

wα|Ωe|, (42)

v1i = −
[
(Bm)

T ∂d

∂Pi
(T − T 0)

]
Xα

wα|Ωe|. (43)

(no summation over α is implied in both equations).

However, this is not the case for v2i (second term of the r.h.s. of equation

(40)) since its integrand has the factor[
∂T

∂Pi

]
Xα

= −Φ(Xα)K−1si, (44)

which is generally non null for any microstructural parameter Pi and for

any sampling point Xα, even if Pi represents the microstructure at a point

far from Xα, outside the finite element containing the point where the mi-

crostructure is fully or partially characterized by Pi, as discussed after equa-

tion (32). Hence, v2i must be built by assembling the contributions of all the

finite elements of the mesh, and it is not sparse.

13



Further, the non-sparsity of v2i is inherited by the global vector s
m
i , de-

fined in equation (38), increasing the cost of computing the sensitivity –in

time as well as in memory requirements– for realistic thermomechanical prob-

lems where the variation of the temperature with respect to microstructure

changes must be accounted for.

5. Off-line computation of effective tensors and their sensitivities

The materials addressed in the current work are assumed to be adequately

characterized by a few number of parameters p1, p2, . . . , pn. Then, we pro-

pose to use an off-line technique based on the response surface methodology

(RSM) that replaces the online solution of the microscopic problem for the

determination of homogenized properties, hugely reducing the time needed

to compute the objective function (24) chosen to characterize the thermome-

chanical response of the macroscopic body.

Let f be a scalar component of an effective material property, either kij,

Cijkl or dij as defined by equations (AI-22), (AI-27) and (AI-32), respec-

tively. First, we compute f for a n-dimensional grid of predefined points

(p
g
1, p

g
2, . . . , p

g
n). Once the grid for f is built, the values of f for intermediate

points (p1, p2, . . . , pn) can be computed by interpolation based on the grid

points. Also, the sensitivity ∂f/∂pi can be computed by numerical differen-

tiation based on the grid.

A step further, we use the grid for each f to build a response surface

to approximate f , i.e. f ≈ f̃(p1, p2, . . . , pn). Consequently, the sensitivity

∂f/∂pi has also an analytical approximation ∂f̃/∂pi.

Once all the response surfaces f̃(p1, p2, . . . , pn) are available, i.e., all the

14



tensorial components of the effective properties are known functions of the

microparameters, the thermomechanical multiscale problem over the macro-

scopic domain Ω with variable microstructure (characterized at each point by

the corresponding RVE) becomes a standard thermomechanical problem over

Ω where the material properties are given functions of positions, ameanable

to be solved by most finite element codes.

The procedure is illustrated in Figure 2: at a point Xα ∈ Ω, where

the microstructure is characterized by the parameters (p
(α)
1 , p

(α)
2 , . . . p

(α)
n ), the

value of the material property f is determined from the response surface

as f(Xα) ≡ f̃(p
(α)
1 , p

(α)
2 , . . . p

(α)
n ). Consequently, the derivative of f(Xα)

with respect to any p
(α)
i is given in analytical form by ∂f̃/∂p

(α)
i evaluated at

(p
(α)
1 , p

(α)
2 , . . . p

(α)
n ).

Xa

RVE

characterized 

by p , p1  2
(g) (g)

(p
, 
p

1 
 

)
2 

  

(g
)

(g
)

(p
, p

1  

)
2  

 
(g)

(g)

f

(X
a)f

f, f
~

p1

p2

Body

Response surface

Offline stage

~
(a)

( )afº (p , p1  )2   

(a) ( )a
(p , p1  )2   

Online stage

Figure 2: Off-line technique for the computation of the effective properties at a macroscopic

point. The so-built response surfaces are then used for the on-line computation of the body

thermomechanical response.

15



This procedure is deeply detailed for a particular microstructure in Sec-

tion 6.1.

Finally, let us note that some authors [6, 7, 11] used response surfaces

for the objective function directly, whose computation involves the whole

multiscale modeling instead of only the microscale modeling as preferred in

this work. However, in case of designing a body with varying microstructure,

the objective function that characterizes the response of the whole body,

depends on all the microparameters variables from all the sampling points of

the body. Then, the total number of design variables is generally too large,

rendering RSM unaffordable.

6. Application

Let us consider the cantilever plate depicted in Figure 3a, deformed by

keeping its top surface at temperature T top and its bottom surface at tem-

perature T bottom < T top.

h

b

l

y2

H

B

X1

Surface at TAdiabatic
clamped 
surface

Adiabatic
free surface

b) RVE Wm

top

Surface at T bottom

a) Macroscopic domain W

Prescribed periodic 

temperature and displacement

fluctuations

l

X2

y1

Figure 3: Multiscale analysis of a cantilever plate: a) macrocopic domain Ω and boundary

conditions, b) microscopic domain Ωµ (RVE) and boundary conditions.

16



For the sake of simplicity, a two-dimensional analysis is performed by

assimilating the plate to a structure under plane strain conditions. Then,

the macroscopic domain Ω is the rectangle B×H representing a slice of unit

width of the whole plate, parallel to the plane X1-X2. We adopt the same

finite element mesh to represent Ω for thermal and mechanical analysis, made

of Q1 finite elements of size ∆X1 × ∆X2. All the parameters defining the

macroscopic problem are listed in Table 1.

B 3 m

H 0.3 m

∆X1 3.75 cm

∆X2 1.5 cm

T top 50◦C

T bottom 0◦C

Table 1: Parameters for the macroscopic problem.

The microstructure is allowed to change from node to node throughout

Ω. Every node Xα has an associated RVE which is shown in Figure 3b. The

microcell is a square domain Ω
(α)
µ of side l (l� H) consisting of a matrix, of

material Mmatrix, crossed by one vertically centered layer of thickness bα and

one horizontal centered layer of thickness hα, both layers made of material

Mlayer. If the properties of materials Mmatrix and Mlayer are given, then, the

RVE at Xα is completely defined by two microparameters: p
(α)
1 = bα and

p
(α)
2 = hα.

Both materials Mmatrix and Mlayer are assumed to be isotropic and to obey

the Fourier’s heat flow law (9) and the linear thermoelastic relation (10). The

17



mechanical properties at a point y ∈ Ω(α)µ are

Cµijkl =
Eν

(1 + ν)(1− 2ν)
δijδkl +

E

2(1 + ν)
(δikδjl + δilδjk) , (45)

dµij = −
E

1− 2ν
αδij, (46)

where E is the Young’s modulus, ν is the Poisson ratio and α is the lin-

ear thermal expansion coefficient, all of them are known properties of the

material at y (either Mmatrix or Mlayer). In this example, we adopt steel as

Mmatrix and copper as Mlayer, whose properties are listed in Table 2. The

reason for this choice lies in the considerable difference between the thermo-

mechanical properties of such materials, which emphasizes the influence of

microstructural parameters on the macroscopic response.

Property Mmatrix (steel) Mlayer (copper)

Young’s modulus 200. GPa 120. GPa

Poisson ration 0.30 0.34

Linear thermal expansion 1.0× 10−5/◦C 1.7× 10−5/◦C

Thermal conductivity 36.5 W/(m◦C) 384.0 W/(m◦C)

Table 2: Material properties.

6.1. Off-line homogenization technique

The RVEs are represented by finite element meshes with periodic bound-

ary conditions in temperature and displacement fluctuations.

For the accuracy of the solution, it is convenient to make each layer

of Mlayer in the RVE at least one-element thick, which is unfeasible when

the thickness of the layer is too small but positive. In order to circumvent

18



such inconvenience, we use a unique RVE mesh, sufficiently fine, for the

complete set of parameters characterizing the microstructures. We choose

the parameters from a discrete set of b and h. Thus, if we discretize the

current l × l-square RVE domain by a rectangular mesh of Q1 square finite

elements of constant side ∆y = l/(neplnpdiv) (with nepl = 2, 4, . . . and npdiv

is a large enough integer), we adopt b and h varying from 0 to l with a step

of ∆P = nepl∆y. In such a way, we ensure to have nepl elements across the

layer at the worst case (when the thickness of one of the layers is equal to

∆P and the thickness of the other layer is less than l). Table 3 lists all the

parameters adopted here to define the current RVE.

l 1. cm

nepl 2

npdiv 50

∆y 0.01 cm

∆P 0.02 cm

Table 3: Parameters for the microcell problem.

By the way, if the sampling points of Q1 elements are located –as usual–

strictly inside the elements, this approach eliminates the ambiguity when

defining the material at sampling points, since they never lie on a material

interface.

For each point of the grid with coordinates bi = i∆P , hj = j∆P ,

i, j = 0, 1, . . . , npdiv, we build the corresponding RVE with a bi-thick vertical

layer and a hj-thick horizontal layer, both made of material M
layer, and com-

pute the macroscopic material properties k(bi, hj) using equation (AI-22),

19



C(bi, hj) using equation (AI-27) and d(bi, hj) using equation (AI-32). This

produces a grid of (npdiv + 1)2 triads (b, h, f) for each tensorial component,

say f , of the macroscopic tensors k, C and d. Figures 4a, 4b and 4c show

the grids for k11, C1111 and d11 respectively.

The value of f for intermediate values of b and h can be easily computed

by interpolation based on the predetermined grid. The derivatives of f with

respect to b or h can be computed numerically based on the grid points. For

instance, derivatives in the interior points of the grid can be computed using

central differences while derivatives in the boundary points can be computed

by either backward or forward differences. The so-computed derivatives of

k11, C1111 and d11 with respect to b are observed in Figures 5a, 5b and 5c,

respectively.

Using the grid values, the derivatives ∂(·)/∂b and ∂(·)/∂h at intermedi-

ate points of the grid can be computed by interpolation. For instance, let

f and its derivatives be computed by linear interpolation for intermediate

points. In such a case, the interpolated derivative of f is not the derivative

of the interpolated f , which is actually discontinuous. In order to compute

derivatives exactly, we find it convenient to approximate f using an analyt-

ical function f̃(b, h) defined for real values of b and h between 0 and l, that

is to use the response surface methodology (RSM). A simple choice for f̃ is

the polynomial

f̃(b, h) =
N∑
i=0

N∑
j=0

aijb
ihj. (47)

The coefficients aij are computed such that f̃ be the least-squares best ap-

proximant to all the points of the f -grid for different values of N .

20



a) k11 b) C1111 c) d11

e) C1111 for N=2 f ) d11 for N=2
~ ~

h) C1111 for N=4 i) d11 for N=4
~ ~

b

h

b

h

b

h

b

h

b

h

b

h

b

h

b

h

d) k  for N=811
~

g) k  for N=1011

b

h

~

Figure 4: Macroscopic properties as functions of b and h (0 ≤ b, h ≤ l): a) k11 in

[W/(m◦C)] computed using equation (AI-22) C1111 in [Pa] computed using equation

(AI-27); c) d11 in [Pa/
◦C] computed using equation (AI-32); d)-i) approximations to these

properties for different polynomial orders (N = 2, 4, 8 and 10, respectively).

21



a) ¶k /11 ¶b (numerical) b) C1111¶ /¶b (numerical) c) d /11¶ ¶b (numerical)

~ ~
b

h

b

h

b

h

b

h

e) C1111¶ /¶b for N=2 f ) d /11¶ ¶b for N=2

h) C1111¶ /¶b for N=4 i) d /11¶ ¶b for N=4

b

h

b

h

~

b

h

g) ¶k /11 ¶b for N=10

b

h

d) ¶k /11 ¶b for N=6
~

b

h

~ ~

Figure 5: Derivatives of macroscopic properties as functions of b and h (0 ≤ b, h ≤ l): a)

numerical derivative ∂k11/∂b in [W/(m
2◦C)]; b) numerical derivative ∂C1111/∂b in [Pa/m];

c) numerical derivatives ∂d11/∂b in [Pa/(m
◦C)]; d)-i) analytical derivatives ∂(·)/∂b of the

approximants (·) to these properties for different polynomial orders.

Polynomial of different orders are necessary to approximate each material

property –strictly, each component of a tensorial material property– with a

proper accuracy. Table 4 allows to evaluate the quality of the polynomial

approximations to each component of the macroscopic thermomechanical

properties in terms of the maximum relative error |(f − f̃)/f | at all the

points of the corresponding grid. Although such error is acceptably small for

22



lower values of N , we finally adopted the larger values of N listed in Table

4 to ensure further accuracy in the approximation of derivatives, as will be

shown next. Note that those tensorial components not listed in Table 4 are

null.

The approximants to k11, C1111 and d11 for the values of N given in Table

4 are shown in Figures 4d to 4i.

Given the approximant f̃ by equation (47), the derivatives of f̃ are the

polynomials

∂f̃(b, h)

∂b
=

N∑
i=1

N∑
j=0

iaijb
i−1hj, (48)

∂f̃(b, h)

∂h
=

N∑
i=0

N∑
j=1

jaijb
ihj−1. (49)

Figures 5d to 5i show the so-computed ∂k̃11/∂b, ∂C̃1111/∂b and ∂d̃11/∂b for

those values of N in Table 4, and let them be compared to their numerically

computed counterparts in Figures 5a, 5b and 5c. At this point, we assume

that numerical derivatives are qualitatively good. As Figure 5 shows, only

the larger values of N ensure that polynomial derivatives behave qualitatively

close to the numerical ones.

6.2. Sensitivity analysis

A common choice for the response function, widely used in purely me-

chanical problems, is the compliance of the whole structure [8]:

R = UTKU = UTF tm. (50)

The sensitivity of such response to microstructural changes is given by:

∂R
∂Pi

=

(
∂U

∂Pi

)T
F tm +UT

∂F tm

∂Pi
, (51)

23



Property N Maximal relative error N Maximal relative error

k11 4 24.52% 8 1.78%

6 6.82% 10 0.58%

k22 4 24.52% 8 2.06%

6 6.83% 10 1.61%

C1111 1 2.40% 3 0.11%

2 0.25% 4 0.03%

C1122 1 1.93% 3 0.08%

2 0.22% 4 0.03%

C2222 1 2.40% 3 0.11%

2 0.25% 4 0.03%

C3333 1 6.98% 3 0.15%

2 1.16% 4 0.04%

d11 1 2.11% 3 0.04%

2 0.24% 4 0.01%

d22 1 2.11% 3 0.04%

2 0.24% 4 0.01%

Table 4: Maximal relative error for different orders of polynomial approximants to the

tensorial components of the material properties.

with ∂U/∂Pi and ∂F
tm/∂Pi given by equations (37) and (40), respectively.

In order to avoid the expensive computation of the inverse of Km involved

in the computation of ∂U/∂Pi, we recast equation (51) in the form:

∂R
∂Pi

= UT
(

2
∂F tm

∂Pi
−
∂K

∂Pi

)
, (52)

with ∂Km/∂Pi given by equation (39).

24



Let us consider the plate with three different microstructures: b = h = 0

(i.e., fully made of Mmatrix=steel), b = h = l/2 and b = h = l (i.e., fully made

of Mlayer=copper). The corresponding compliance, given by equation (50),

under the thermal loads shown in Figure 3a are listed in Table 5. Figure 6

shows the sensitivity of the compliance of the structure for these cases.

d) for b=h=
T tm

¶(U F )/¶h [N/m] l/2
. .

a)  [N/m] for b=h=0
T tm

¶(U F )/¶b
. .

b) for b=h=0
T tm

 ¶(U F )/¶h [N/m] 
. .

c) for b=h=l/2
T tm

 ¶(U F )/¶b [N/m] 
. .

e) for b=h=l
T tm

 ¶(U F )/¶b [N/m] 
. .

f) for b=h=
T tm

 ¶(U F )/¶h [N/m] l
. .

Figure 6: Sensitivity of the compliance of the plate to microstructural changes, for different

homogeneous microstructures (b = h = 0, b = h = 0.5, b = h = l).

Property b = h = 0 b = h = l/2 b = h = l

vtip 9.80 mm 15.26 mm 17.21 mm

UTF tm 9.709× 104 N 1.839× 105 N 2.171× 105 N

Table 5: Vertical displacement of the free end and compliance of the plate for different

homogeneous microstructures.

Alternatively, the response of the thermally-loaded plate can be char-

acterized by the magnitude of the X2-displacement of the node located at

X1 = L,X2 = 0 (lower right corner), say v
tip:

R(U ,T ) = vtip. (53)

25



Let j be the degree of freedom corresponding to the X2-displacement of such

node. According to the X1-X2 frame adopted in Figure 3a, it holds Uj < 0

for T top > T bottom (as it is in the present case), such that vtip = −Uj. Then,

the sensitivity of such response to microstructural changes is given by:

∂R
∂Pi

= −
∂Uj
∂Pi

= jm · smi , for given j, (54)

where jm is the j-th row of the inverse of the matrix Km. Instead of com-

puting the inverse of Km and then extracting its j-th row, it is considerably

more efficient from the computational point of view to solve the following

linear equation for jm:

Kjm = ej, (55)

where ej is the j-th basis vector of the space Rd, and d is the dimension of

U (i.e., the number of degrees of freedom in the mechanical analysis).

The value of vtip for three different homogeneous microstructures are

listed in Table 5. Figure 7 shows the sensitivity of vtip to microstructural

changes for these three cases.

6.2.1. Increasing the compliance/stiffness

Since the chosen objective function R, given either by equation (50) or

by equation (53), characterizes the compliance of the considered plate, the

compliance of the beam can be increased/decreased by increasing/decreasing

Pi according to the sign of ∂R/∂Pi.

From the finite difference approximation:

∂R
∂Pi
≈
Rnew −R
P newi − Pi

, (56)

26



a)  for b=h=0
tip

¶v /¶b
.

b) h for b=h=0
tip

¶v /¶
.

c)  for b=h=l/2
tip

¶v /¶b
.

d) h for b=h=
tip

¶v /¶ l/2
.

e)  for b=h=l
tip

¶v /¶b
.

f) h for b=h=
tip

¶v /¶ l/2
.

Figure 7: Sensitivity of the vertical displacement of the lower free corner of the plate to

microstructural changes, for different homogeneous microstructures (b = h = 0, b = h =

0.5, b = h = l).

we can update Pi using the expression

P newi = Pi +

(
∂R
∂Pi

)−1
(Rnew −R), (57)

subject to the constraint

0 ≤ P newi ≤ l. (58)

Further, if P new2α−1 = bα and P
new
2α = hα defines the RVE at Xα, two additional

constraints arise:

P new2α−1 = l if P
new
2α = l, and viceversa. (59)

Let us consider for instance the plate with homogeneous microstructure

Pi = b = h = 0.5. Seeking for increasing the compliance of this plate, we

adopt ∆R = Rnew − R positive and large enough such that equation (57)

27



reduces to:

P newi =




0 if ∂R/∂Pi < 0

l/2 if ∂R/∂Pi = 0

l if ∂R/∂Pi > 0

to increase compliance, (60)

subject to the constraint (59).

Results are found to be qualitatively different depending upon the defini-

tion of the response function R. For R = UTF tm, with ∂R/∂b and ∂R/∂h

shown in Figures 6c and 6d, respectively. Equation (60) gives rise to identical

new values of b and h when we start from b = h = 0.5, which are shown in

Figure 8a. The computed solution consists of an upper layer of purely Mlayer

and a lower layer of purely Mmatrix. With such a material distribution, the

plate is 67% more compliant than the plate made of Mlayer (the material with

the lower stiffness), as measured in terms of R = UTF tm.

Considering R = vtip, with ∂R/∂b and ∂R/∂h such as shown in Figures

7c and 7d, respectively, the obtained solution is plotted in Figure 8c (note

that with b = l again). In this case, the solution consists of three layers: a

core of Mmatrix and upper and lower layers of Mlayer, being 33% more compli-

ant than the plate made of Mlayer (the material with the lower stiffness), as

measured in terms of R = vtip.

Analogously, to increase the stiffness (i.e., to decrease the compliance of

the plate), we adopt ∆R = Rnew −R negative and large enough, such that

equation (57) reduces to

P newi =




l if ∂R/∂Pi < 0

l/2 if ∂R/∂Pi = 0

0 if ∂R/∂Pi > 0

to increase stiffness, (61)

28



subject to the constraint (59).

For R = UTF tm, equation (61) gives rise to the solution shown in Figure

8b, consisting of an upper layer of purely Mmatrix and a lower layer of purely

Mlayer. Such a plate is 97% stiffer than the plate made of Mmatrix (the stiffer

material), as measured in terms of UTF tm.

For R = vtip, we obtain the solution shown in Figure 8d: a plate with

a core of Mmatrix and upper and lower layers of Mlayer. Such a plate is 63%

stiffer than the plate made of Mmatrix (the stiffer material), as measured in

terms of vtip.

c) Increased compliance for R=
tip

v
.

d) Increased stiffness for R=
tip

v
.

b) Increased stiffness for R=
T tm

U F
. .

a) Increased compliance for R=
T tm

U F
. .

Figure 8: Distribution of material for increased stiffness (left) and compliance (right) using

sensitivity analysis, starting from b = h = 0.5l. The color-bar depicts 0 ≤ b/l = h/l ≤ 1.

Property
Increased stiffness Increased compliance

R = Ui R = UTF tm R = Ui R = UTF tm

vtip 6.02 mm 9.50 mm 22.96 mm 20.19 mm

UTF tm 7.098× 104 N 4.939× 104 N 2.704× 105 N 3.642× 105 N

Table 6: Displacement of the free end and stiffness for different microstructures.

29



7. Conclusions

In this work, we present a methodology for the sensitivity analysis of

the thermomechanical response of bodies, or structures, with variable mi-

crostructure. Since the material properties depend on the microstructure,

the response of the body at the macroscale has to be analyzed using some

kind of multiscale approach. Then, its evaluation requires the solution of a

microscopic problem at each integration point, which makes the computation

of usual procedures hardly affordable.

We propose to address this challenge for the wide range of “quantitatively

characterized” materials, by performing the microscale analysis in an off-line

stage. To this end, recourse is made to the response surface methodology

in order to define the macroscopic thermal and mechanical properties as

analytical functions of the parameters that define the microstructure. In this

way, also analytical expression of the sensitivities of the macroscopic material

properties to microstructural changes can be obtained.

Note that, given the microstructure distribution throughout the body, the

RSM allows us to predefine all the material properties as known functions

of positions. Then, the determination of the macroscopic response becomes

a standard monoscale problem, which can be solved by most available FEM

codes.

The reduction of the starting fully-online multiscale problem to an monoscale

one implies a huge reduction in computation time. This fact is a crucial con-

tribution of this work since it enables the optimal design of complex struc-

tures made of “quantitatively characterized” materials with spatially variable

microstructure. It is now affordable the multiscale problem solutions at each

30



iteration of the optimization process. Actually, this is the purpose of our

future works.

Acknowlegment

The first author has received funding from the Council for Scientific and

Technical Research of Argentina (CONICET) through the research project

PIP 2012-2014 GI-1105: “Computational Simulation of Multiphysics Prob-

lems. Application to Metal Solidification and Microelectromechanical De-

vices”.

The research leading to these results has also received funding from

the European Research Council under the Seventh Framework Programme

(FP/2007-2013)/ERC Grant Agreement n. 320815 (ERC Advanced Grant

Project “COMP-DES-MAT: Advanced Tools for Computational Design of

Engineering Materials”).

Appendix I: Thermomechanical computational homogenization based

on variational principles

This Appendix describes the main aspects characterizing the homoge-

nization methodology adopted in this work: the variational formulation and

equations governing the scale transition technique. Similar multiscale tech-

niques for mechanical problems have been presented in References [12, 13, 14].

Additional aspects of the methodology can be seen there.

31



A-1. Scale transition technique

Let us consider a material with microstructure which is statistically ho-

mogeneous at the macroscale. Every point X ∈ Ω has associated a given

RVE, which is identified with the domain Ωµ having a piecewise smooth

boundary Γµ and outward normal unit vector nµ, see Figure 1. Hereafter,

(·)µ denotes an object described in Ωµ. The separation scale condition is also

assumed: the characteristic length of the RVE, denoted `µ, is much less than

the corresponding characteristic size, `, of the macro scale domain: `µ � `.

A-1.1. Thermal problem

The thermal response at X ∈ Ω is computed by means of a homogeniza-

tion technique on the associated RVE Ωµ. The temperature field in Ωµ is

defined as the sum of three contributions:

Tµ = T + ∇X T · y + T̃µ, (AI-1)

where T and ∇X T are given inputs defined from the macroscale analysis,

and T̃µ is the fluctuation of the temperature field.

From equation (AI-1), the temperature gradient is:

∇y Tµ = ∇X T + ∇y T̃µ. (AI-2)

Using the Fourier’s law, the heat flux vector qµ at the microscale is

qµ = −kµ∇y Tµ, (AI-3)

where the conductivity tensor kµ = kµ(y) is a given property for each ma-

terial component at the microscopic scale.

32



Consistent formulations for scale transition procedures should satisfy spe-

cific constraints between fields described at the macro and microscopic do-

mains. Accordingly, we postulate two basic admissibility requirements be-

tween both descriptions, considered as fundamental hypotheses of our ap-

proach: (i) the thermal admissibility and (ii) the energetic admissibility. Re-

quirement (i) fixes the minimal consistent boundary conditions for the RVE

problem, while requirement (ii) determines a heat balance equation at the

micro scale, as well as the homogenization formula for the macroscopic heat

flux vector. Both requirements are further discussed below.

A-1.1.1. Thermal admissibility requirement

This requirement imposes the identity between the temperature gradient

at the macroscale and the volumetric average of the temperature gradient at

the microscale:

∇X T =
1

|Ωµ|

∫
Ωµ

∇y Tµ dVµ, (AI-4)

where |Ωµ| is the volume of Ωµ. Considering ∇y Tµ given by equation (AI-2)

and using the Gauss’s theorem, equation (AI-4) yields:∫
Γµ

T̃µnµ dSµ = 0, (AI-5)

which introduces a constraint on the temperature fluctuation field at the

microscale. This constraint is the minimum one to be imposed on T̃µ in

order to define an admissible fluctuation field.

A multiscale model that adopts temperature fluctuation fields satisfy-

ing equation (AI-5) is called minimally constrained thermal multiscale sub-

model. Alternative sub-models using fluctuation fields with additional con-

straints can be postulated. Typical choices are: Taylor sub-model or rule

33



of mixtures (T̃µ is null in Ωµ), linear sub-model (T̃µ is null on Γµ) or peri-

odic sub-model (T̃µ is periodic on sub-boundaries of Γµ with opposite normal

vectors).

The vector space Tµ that collects all admissible functions T̃µ is defined as:

Tµ = {v(y) | v is sufficiently smooth in Ωµ and
∫

Γµ

v(y)nµ dSµ = 0}.

(AI-6)

In this case, Tµ defines also the vector space for the thermally admissible

virtual actions in temperature fluctuations at the microscale.

A-1.1.2. Energetic admissibility requirement

We postulate the following variational sentence:

q · ∇X T̂ =
1

|Ωµ|

∫
Ωµ

qµ · ∇y T̂µ dVµ, (AI-7)

for all ∇X T̂ and ∇y T̂µ related by the constraint (AI-4).

Considering ∇y Tµ as given by equation (AI-2), the fulfillment of the

variational expression (AI-7) necessarily implies two consequences, namely:

1. the homogenization formula for the heat flux vector:

q =
1

|Ωµ|

∫
Ωµ

qµ dVµ; (AI-8)

2. the heat balance equation at the RVE-level, which is enunciated as:

given ∇X T , find T̃µ ∈ Tµ such that:∫
Ωµ

qµ · ∇y
ˆ̃
Tµ dVµ = 0, ∀

ˆ̃
Tµ ∈ Tµ. (AI-9)

34



A-1.2. Mechanical problem

Similar to the thermal field Tµ, equation (AI-1), the displacement field

uµ(y) on Ωµ is defined as the sum of three contributions:

uµ = u+ ε · y + ũµ, (AI-10)

where u and ε are given inputs from the macroscale, and ũµ is the displace-

ment fluctuation field in Ωµ. Then, the linear strain tensor on the microscale,

defined in the conventional form, is

εµ = ∇sy uµ = ε+ ∇
s
y ũµ︸ ︷︷ ︸
ε̃µ

, (AI-11)

ε̃µ being the strain fluctuation tensor.

Let us assume that the mechanical behavior of each microcomponent

obeys a linear thermoelastic law:

σµ = Cµ εµ + dµ(Tµ − T 0), (AI-12)

where Cµ is the tensor of elastic moduli and dµ is the stress increment per

unit of temperature, which are both of them given properties of the micro-

components; T 0 denotes the temperature for zero-thermal stress, assumed to

be common to all the microcomponents.

Considering that Tµ, as given by equation (AI-1), satisfies

Tµ = T +O(`µ/`), (AI-13)

where `µ/` � 1 according to the separation scale condition, we further as-

sume that:

Tµ − T 0 ≈ T − T 0. (AI-14)

35



Therefore, the dependence of σµ on the temperature fluctuation field can be

disregarded in the constitutive law at the microscopic scale, equation (AI-12),

which finally takes the form

σµ = Cµ εµ + dµ(T − T 0). (AI-15)

Thanks to this assumption, the classical thermoelastic constitutive equation

(12) is recovered at the macroscopic scale.

Like in the thermal problem, additional constraints have to be imposed on

the mechanical problem for a correct definition of the scale transition proce-

dure. Analogously, we postulate two mechanical admissibility requirements :

(i) kinematical admissibility and (ii) power admissibility. Requirement (i)

provides consistent boundary conditions for the RVE, while requirement (ii)

provides the variational equilibrium problem on the microscale along with

the corresponding homogenization formula for the macroscopic stress tensor

σ, as discussed in the following paragraphs.

A-1.2.1. Kinematical admissibility requirement

It imposes the equivalence between the strain ε at the macroscale and

the volumetric average of the strain εµ at the microscale:

ε =
1

|Ωµ|

∫
Ωµ

εµ dVµ. (AI-16)

In view of (AI-11), and using the Gauss’s theorem, equation (AI-16) can

be rewritten as: ∫
Γµ

ũµ ⊗s nµ dSµ = 0, (AI-17)

and represents the minimum constraint to be imposed on the field ũµ, in

order to satisfy the kinematical admissibility condition. A multiscale (me-

chanical) model satisfying (AI-17) is a minimally constrained kinematical

36



(mechanical) multiscale sub-model [14]. Alternative submodels with addi-

tional kinematical constraints on the displacement fluctuation field can be

postulated. Typical choices are: Taylor sub-model or rule of mixtures (ũµ is

null in Ωµ), linear sub-model (ũµ is null on Γµ) or periodic sub-model (ũµ is

periodic on boundary parts having opposite normal vectors).

The vector space Uµ that collects all admissible functions ũµ is defined

as:

Uµ =
{
v(y) | v is sufficiently smooth in Ωµ

and

∫
Γµ

v(y)⊗s nµ dSµ = 0
}
. (AI-18)

Note that Uµ coincides with the space of kinematically admissible virtual

actions in microdisplacement fluctuations.

A-1.2.2. Power admissibility requirement

This is the well-known Hill-Mandel principle of macrohomogeneity, which

imposes the following identity:

σ · ε̂ =
1

|Ωµ|

∫
Ωµ

σµ · ε̂µ dVµ, (AI-19)

for all the virtual fields ε̂ and ε̂µ related by the constraint (AI-16). Two

consequences are derived from this identity, namely:

1. the homogenization formula for the stress tensor:

σ =
1

|Ωµ|

∫
Ωµ

σµ dVµ; (AI-20)

2. the mechanical equilibrium problem at the RVE-level, which is enunci-

ated as: given T (X) and ε(X), find ũµ ∈ Uµ such that:∫
Ωµ

σµ · ∇sy ˆ̃uµ dVµ = 0, ˆ̃uµ ∈ Uµ. (AI-21)

37



A-1.3. Effective thermal conductivity tensor

After introducing expressions (AI-2) in (AI-3), and the resulting expres-

sion into (AI-8), we obtain the effective thermal conductivity tensor:

k =
∂q

∂(∇XT )
= k + k̃, (AI-22)

with

k =
1

|Ωµ|

∫
Ωµ

kµ dVµ, (AI-23)

k̃ =

[
1

|Ωµ|

∫
Ωµ

ei ·
(
kµ∇y ∆T̃µj

)
dVµ

]
ei ⊗ ej, (AI-24)

where ei is the i-th vector of the canonical basis in R3, and

∆T̃µj
.
=

∂T̃µ
∂(∇XT )

· ej, (AI-25)

is computed after solving the linear problem∫
Ωµ

kµ∇y ∆T̃µj · ∇y
ˆ̃
Tµ dVµ = −

∫
Ωµ

kµej · ∇y
ˆ̃
Tµ dVµ, ∀

ˆ̃
Tµ ∈ Tµ.

(AI-26)

A-1.3.1. Effective elasticity and thermal stress tensor

By replacing equation (AI-11) in equation (AI-15), and the resulting ex-

pression in (AI-20), the effective elasticity tensor C is:

C =
∂σ

∂ε
= C + C̃, (AI-27)

with

C =
1

|Ωµ|

∫
Ωµ

Cµ dVµ, (AI-28)

C̃ =

[
1

|Ωµ|

∫
Ωµ

(ei ⊗ ej) ·
(
Cµ∇sy ∆ũµkl

)
dVµ

]
ei ⊗ ej ⊗ ek ⊗ el, (AI-29)

38



where

∆ũµkl
.
=
∂ũµ
∂ε
· (ek ⊗ el), (AI-30)

is the solution of the linear problem∫
Ωµ

Cµ∇sy ∆ũµkl · ∇
s
y

ˆ̃uµ dVµ = −
∫

Ωµ

Cµ(ek ⊗ el) · ∇sy ˆ̃uµ dVµ,

∀ ˆ̃uµ ∈ Uµ. (AI-31)

On its turn, introducing the constitutive equation (AI-15) at the mi-

croscale into the homogenization formula (AI-20) for σ and differentiating

with respect to the macroscopic temperature, we obtain the effective stress

tensor increment per unit temperature

d =
∂σ

∂T
= d+ d̃, (AI-32)

with

d =
1

|Ωµ|

∫
Ωµ

dµ dVµ, (AI-33)

d̃ =

∫
Ωµ

Cµ∇sy ∆T ũµ dVµ, (AI-34)

where

∆T ũµ
.
=
∂ũµ
∂T

, (AI-35)

is the solution of the linear equation∫
Ωµ

Cµ∇sy ∆T ũµ · ∇
s
y

ˆ̃uµ dVµ = −
∫

Ωµ

dµ · ∇sy ˆ̃uµ dVµ,

∀ˆ̃uµ ∈ Uµ. (AI-36)

More details about the derivation, from a variational point of view, of the

tangent operators k, C and d, can be found in References [15, 16].

39



A-2. FEM-implementation at the micro scale

The FEM implementation at the microscale is analogous to that pre-

sented for the macroscale in Section 3. The only aspect that deserves special

attention is the technique used for imposing the boundary conditions at the

RVE.

In the application developed in Section 6, particularly during the homog-

enization of the material properties over the RVE (Section 6.1), temperature

and displacement fluctuations were prescribed to be periodic on the boundary

of the RVE. Such boundary conditions were dealt with the static condensa-

tion procedure taken from Toro et al[17].

References

[1] S. Torquato. Optimal design of heterogeneous materials. Annu. Rev.

Mater. Res., 40:101–129, 2010.

[2] D. McDowell and T. Story. New directions in materials design science

and engineering. Report, Workshop Sponsored by the U.S. National Sci-

ence Foundation, Georgia Institute of Technology and Morehouse Col-

lege, Atlanta, GA, USA, 1998.

[3] M. Kachanov and I. Sevostianov. On quantitative characterization of

microstructures and effective properties. Int. J. Solids and Structures,

42:309–336, 2005.

[4] E. Lund and J. Stegmann. On structural optimization of composite shell

structures using a discrete constitutive parametrization. Wind Energy,

8(1):109–124, 2005.

40



[5] I. Tsukrov and M. Kachanov. Effective moduli of an anisotropic material

with elliptical holes of arbitrary orientational distribution. Int. J. Solids

and Structures, 37:5919–5941, 2000.

[6] C. Rungsiyakull, Q. Li, G. Sun, W. Li, and M. V. Swain. Surface

morphology optimization for osseointegration of coated implants. Bio-

materials, 31:7196–7204, 2010.

[7] J. Chen, C. Rungsiyakull, W. Li, Y. Chen, M. Swain, and Q. Li. Multi-

scale design of surface morphological gradient for osseointegration. Jour-

nal of the Mechanical Behavior of Biomedical Materials, 20:387–397,

2013.

[8] M. P. Bendsøe and O. Sigmund. Topology optimization. Theory, meth-

ods, and applications. Springer-Verlag, 2003.

[9] J. Fish and A. Ghouali. Multiscale analytical sensitivity analysis for

composite materials. International Journal for Numerical Methods in

Engineering, 50(6):1501–1520.

[10] M. Kamiński. Design sensitivity analysis for the homogenized elasticity

tensor of a polymer filled with rubber particles. International Journal

of Solids and Structures, 51(3):612–621, 2014.

[11] S. Hou, Q. Li, S. Long, X. Yang, and W. Li. Multiobjective optimiza-

tion of multi-cell sections for the crashworthiness design. International

Journal of Impact Engineering, 35:1355–1367, 2008.

[12] F. Feyel and J. L. Chaboche. FE-2 multiscale approach for modelling the

41



elastoviscoplastic behaviour of long fibre SiC/Ti composite materials.

Comput. Methods Appl. Mech. Engrg., 183(3):309–330, 2000.

[13] C. Miehe and A. Koch. Computational micro-to-macro transitions of

discretized microstructures undergoing small strains. Archive of Appl.

Mech., 72(4):300–317, 2002. ISSN 0939-1533.

[14] E. A. de Souza Neto and R. A. Feijóo. On the equivalence between

spatial and material volume averaging of stress in large strain multi-

scale solid constitutive models. Mechanics of Materials, 40:803–811,

2008.

[15] J.C. Michel, H. Moulinec, and P. Suquet. Effective properties of compos-

ite materials with periodic microstructure: a computational approach.

Comput. Methods Appl. Mech. Engrg., 172:109–143, 1999.

[16] S. M. Giusti, P. J. Blanco, E. A. de Souza Neto, and R. A. Feijóo.

An assessment of the gurson yield criterion by a computational multi-

scale approach. Engineering Computations: International Journal for

Computer-Aided Engineering and Software, 26(3):281–301, 2009.

[17] S. Toro, P. J. Sánchez, A. E. Huespe, S. M. Giusti, P. J. Blanco, and

R. A. Feijóo. A two-scale failure model for heterogeneous materials:

numerical implementation based on the finite element method. Inter-

national Journal for Numerical Methods in Engineering, 97(5):313–351,

2014.

42




