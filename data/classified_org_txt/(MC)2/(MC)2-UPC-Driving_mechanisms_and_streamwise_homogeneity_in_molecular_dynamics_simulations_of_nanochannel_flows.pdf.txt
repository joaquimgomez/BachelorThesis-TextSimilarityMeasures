



















































()


Driving mechanisms and streamwise homogeneity in molecular dynamics simulations

of nanochannel flows

Vicente Bitrián∗ and Javier Principe†
Departament de Mecànica de Fluids, Universitat Politècnica de Catalunya,

Eduard Maristany, 10-14, 08019, Barcelona, Spain.

(Dated: May 31, 2018)

In molecular dynamics simulations, nanochannel flows are usually driven by a constant force, that
aims to represent a pressure difference between inlet and outlet, and periodic boundary conditions are
applied in the streamwise direction resulting in an homogeneous flow. The homogeneity hypothesis
can be eliminated adding reservoirs at the inlet and outlet of the channel which permits to predict
streamwise variation of flow properties. It also opens the door to drive the flow by applying pressure
gradient instead of a constant force. We analyze the impact of these modeling modifications in the
prediction of the flow properties and we show when they make a difference with respect to the
standard approach. It turns out that both assumptions are irrelevant when low pressure differences
are considered, but important differences are observed at high pressure differences. They include
the density and velocity variation along the channel (the mass flow rate is constant) but, more
importantly, the temperature increase and slip length decrease. Because viscous heating is important
at high shear rates, these modeling issues are also linked to the use of thermostating procedures.
Specifically, selecting the region where the thermostat is applied has a critical influence on the
results. Whereas in the traditional homogeneous model the choices are limited to the fluid and/or
the wall, in the inhomogeneous cases the reservoirs are also available, which permits to leave the
region of interest, the channel, unperturbed.

I. INTRODUCTION

The molecular dynamics (MD) configuration most
commonly used to simulate nanochannel flows is shown
in Fig. 1. The fluid particles are bounded by solid parti-
cles that model a wall, periodic boundary conditions are
assumed in the streamwise and spanwise directions and
the flow is driven applying a constant external force. This
driving mechanism has raised long-standing criticism for
it requires a huge force to be applied, which generates an
important amount of heat that, in turn, requires dissipa-
tive mechanisms (thermostating), and only represents an
applied pressure difference when the pressure gradient is
assumed to be constant everywhere [1]. Using this con-
figuration implies assuming that the flow is streamwise
homogeneous, which makes the problem easier by reduc-
ing it to one spatial dimension, the other two (streamwise
and spanwise) being only statistical. On the other hand
developing effects are eliminated from the beginning.

Nevertheless, this configuration has been used for years
to study the flow slip over solid surfaces and it is still
widely used, see e.g. [2, 3]. Molecular dynamics simula-
tions are performed integrating the equations of motion
of individual molecules. Introducing the interactions be-
tween them results in a system whose size is the number
of molecules. Apart from these interactions, the exter-
nal force driving the system is also introduced. As the
system is isolated, the work performed by the external

∗ vicente.bitrian@upc.edu
† javier.principe@upc.edu; Also at Centre Internacional de Mè-

todes Numèrics en Enginyeria, Parc Mediterrani de la Tecnolo-
gia, Esteve Terrades 5, 08860, Castelldefels, Spain.

x

y

—

—

Ly

—

∆yw

| |
Lx

FIG. 1. Traditional molecular dynamics model of an homo-
geneous nanochannel flow. Fluid particles are shown in blue
and solid particles in red and black.

force driving the flow results in an increase of internal
energy. Therefore, the only way to reach a steady state
is through the introduction of a dissipative mechanism.
This term is included assuming that the fluid is “in con-
tact with a thermal bath” or “a reservoir” [4–7] which
extracts energy from the system. There are many possi-
bilities, but the more commonly used in nonequilibrium
MD simulations are the Langevin, Nosé-Hoover, Berend-
sen or DPD thermostats, see e.g. [8] and [9]. In the
context of nanochannels the traditional approach [4] was
to apply a thermostat in the whole channel while assum-
ing the flow to be homogeneous in the streamwise and
spanwise directions by applying periodic boundary con-
ditions, as shown in Fig. 1. Wall particles are fixed but

mailto:vicente.bitrian@upc.edu
mailto:javier.principe@upc.edu


2

their interaction with fluid is kept, which results in fluid-
solid interface friction.

This model was improved including moving wall parti-
cles into the model, i.e. integrating their equations of
motion too [10–15]. In this case, apart from the ex-
ternal force acting over all fluid particles in the stream-
wise direction, wall particles are also constrained to move
around equilibrium positions by applying external forces
to them (typically derived from quadratic potentials).
This permits to apply a thermostat on the wall particles
too. In an effort to minimize its impact, some authors [15]
apply the thermostat to one solid layer only, the one be-
ing further from the fluid, shown in black color in Fig. 1.
In fact, a rigorous derivation of this procedure has been
developed in [16] and [17] and named stochastic bound-
ary conditions, showing that applying a thermostat on
the external border of a solid accounts for the influence
of an infinitely large solid thermal bath around it.

After this improvement, the next natural question is
whether the fluid should be thermostated or not and
there is a consensus in the literature about answering
negatively [7], considering that cooling through the walls
is the only “realistic” [11–13, 15] dissipative mechanism
“mimicking real experiments” [14]. While in the case
of the solid walls the thermal bath has a clear physical
meaning, in the case of the fluid it has not. Besides,
transport properties, viscosity and conductivity, shear
stress and slip over a solid surface measured by the slip
length Ls, were shown to depend on the parameters of
the fluid thermostat [11, 14, 15]. Applying thermostats
to shear flows has also been put into question by [18]
because they remove heat at rates that are higher than
the rate of conduction of heat across the fluid. The im-
plication of this fact is the lack of time to maintain re-
distribution of energy across the system which implies
that the steady states reached depend on the degrees of
freedom the thermostat is coupled to. This effect is spe-
cially severe at high shear rates and the (perhaps over-
pessimistic) conclusion by [18] is that the effort “should
be directed to simulate lower shear rates”.

At this point, two well-established facts collide: the
application of an external force generates an important
amount of heat and the application of a thermostat to
the fluid is unphysical. On top of that, assuming peri-
odic boundary conditions, and therefore streamwise ho-
mogeneity, eliminates an intrinsic heat transfer mecha-
nism present in any (nano)channel, the transfer of heat
by convection, which makes the model definitively unre-
alistic.

Another important heat transfer mechanism is the gen-
eration by shear friction. While in macroscopic flows this
term is usually negligible (except at very low Re numbers,
i.e. creeping flows) at nanoscales this term is very impor-
tant, specially at high shear rates. In that case the flow
cannot be considered isothermal.

To understand the balance of these mechanisms a sim-
ple model can be developed from the macroscopic energy

conservation equation [19]

ρcp
dT

dt
− βT

dp

dt
= −∇ · q + Φ (1)

where cp is the specific heat, ρ the mass density, β the
(possibly temperature-dependent) thermal expansion co-
efficient, p the pressure, q the internal heat flux, and Φ
is the Rayleigh function representing the mechanical dis-
sipation of energy in sheared motion, proportional to the
viscosity and the square of velocity gradients in Newto-
nian fluids. It is worth noting that the second term of the
left-hand side of Eq. (1) is only relevant in compressible
fluids and it is negligible for nearly incompressible ones,
representing a heat sink due to the energy required by di-
latation to occur. It is also relevant that this equation is
equivalent to the one obtained by a statistical treatment
of molecular equations of motion [20], namely

∂E

∂t
+ ∇ · (Eu + q − u · σ) = 0 (2)

where u is the fluid velocity and E = ρ(e+ u2/2 + ψ) is
the total energy per unit volume, that includes the inter-
nal energy e and the external potential ψ whose gradient
is the applied driving force. Only after using kinetic and
potential energy conservation Eq. (1) is obtained, which
does not include the external force (whose work cancels
with potential energy variation). The two terms on the
left hand side of Eq. (1) come from the calculation of
the internal energy variation, which, apart from the en-
ergy variation due to temperature changes, includes the
energy variation by dilatation that vanishes for incom-
pressible flows, as mentioned.

Assuming a one dimensional steady flow that is cooled
(or heated) from the walls at a temperature Tw, and mod-
eling that by a Newton law with convection coefficient h,
which accounts for the heat conduction in the fluid and
the Kapitza resistance of the interface [21], we get from
Eq. (1)

ṁcp
dT

dx
− uAβT

dp

dx
= −Ph(T − Tw) + ΦA (3)

where ṁ is the mass flow rate across a section of the
channel of length L, cross sectional area A and perimeter
P . The terms on the left-hand side represent convection
heat transfer, the first term on the right-hand side cooling
through walls and the second one viscous heating (given
by Φ = µγ2 with µ the shear viscosity and γ the shear
rate). Once again, we emphasize that the second term
on the left-hand side is negligible for incompressible flows
but it turns out to play an important role otherwise, as
it will be shown below.

The solution of Eq. (3) can be obtained assuming the
variables multiplying the temperature in the second term
on the left-hand side to be constant, a restrictive hypoth-
esis that, in any case, permits to understand the impli-
cations of neglecting it or not. Observe that in this case,



3

equation Eq. (3) has a uniform solution

Tu =
Ph

(

Ph− uAβ dp
dx

)Tw +
ΦA

(

Ph− uAβ dp
dx

) . (4)

In general when the flow enters the channel at a tem-
perature Ti, it is cooled (or heated) along the channel,
according to

(T − Tu) = (Ti − Tu) e
−

(P h−uAβ dpdx )L
ṁcp

x
L , (5)

reaching equilibrium asymptotically.
This simple model permits to conclude that only if the

inlet temperature is Tu the flow can be homogeneous.
Otherwise an exponential increase or decrease is to be
expected. Besides, when the pressure gradient and the
shear rate are negligible, i.e. −uAβ dp

dx
≪ Ph and ΦA ≪

Ph, taking the inlet temperature as the wall temperature
results in an isothermal flow (the heat produced by shear
is easily dissipated through the walls).

This simple model also permits to understand how dif-
ferent configurations and flow driving mechanisms im-
pact on the energy balance. In the traditional stream-
wise homogeneous model the terms in the left-hand side
of Eq. (3) vanish and the equilibrium between heat gener-
ation by shear and cooling through walls determines the
fluid temperature. Applying a thermostat can be a way
of representing the dissipative terms neglected (observe
that the pressure gradient is negative and therefore the
second term on the left-hand side of Eq. (3) is dissipa-
tive).

In this article we discuss an alternative configuration
and a driving mechanism similar to others recently pro-
posed [22–25]. In fact, many alternative driving mecha-
nisms to study nanochannel flows have been proposed for
years. The alternative proposed by [1] is the introduction
of a “reflecting particle membrane”, a Maxwell daemon
that precludes (with a given probability) the particles to
cross it in one direction, thus generating a pressure gra-
dient. Whereas the method to drive the flow does not
introduce additional energy into the system (thus not re-
quiring thermostating), the pressure gradient is difficult
to control (which is done through the given probability).
Another approach [26–28] is to fix the pressure in the
external reservoirs by introducing rigid movable plates
normal to the flow, which introduces a time dependent
driving mechanism (the size of the reservoirs changes).
In [29] the channel walls are moved as in the Couette
problem whereas the flow is stopped by a cross sectional
wall.

The methods proposed by [22, 24, 25] and the one we
study here are small variations of the so-called “reservoir
method” first proposed by [30]. The pressure difference
is generated applying a constant force in the reservoirs
(a smoother Gaussian variation in [23, 24]) whereas they
differ on how the temperature or density is controlled.
Some authors introduce reservoirs while driving the flow

with a constant force and a Nosé-Hoover thermostat ap-
plied in the whole domain, including the channel [31].

However, these alternatives have not been widely used,
specially in the study of hydrodynamic slip, one of the
reasons being the important increase in the compu-
tational cost. Abandoning the streamwise periodicity
makes the problem two-dimensional (the spanwise direc-
tion being still statistical). On the other hand, the ad-
vantages of these improved models have not been demon-
strated. The case of an inlet temperature substantially
higher than that of the walls was analyzed in [25] but
considering only thermal effects, the flow assumed to be
hydrodynamically fully developed. On the other hand
when the inlet temperature is similar to that of the walls,
the fluid is heated inside the channel and hydrodynamic
effects appear, e.g. the maximum velocity increases and
the slip length decreases along the channel. We document
these effects in Sect. III after detailed description of the
methods in Sect. II. We summarize the main conclusions
in Sect. IV.

II. SIMULATION METHOD

We construct a nanochannel flow by confining a
monoatomic fluid between two smooth solid walls. Both
the fluid and walls are composed by atoms which interact
through the pairwise Lennard-Jones (LJ) potential,

Vij(rij) =







4ǫij

[

(

σij
rij

)12

−
(

σij
rij

)6
]

, rij < rc

0 , rij ≥ rc
(6)

where rij = |rij | = |ri −rj| is the distance between atoms
i and j whose positions are ri and rj , and ǫij and σij
are the energy and length scales of the potential, respec-
tively. The subscripts i and j indicate the atom types
(hereinafter f stands for fluid atoms and w for wall ones),
and the calculation of the interactions of each particle is
truncated at a cut-off distance rc = 2.5 σ, since we have
verified that the results do not change appreciably by
increasing rc. All the physical units in this work are ex-
pressed in LJ units (that is, in terms of the characteristic
fluid length σ = σff , energy ǫ = ǫff , and atomic mass
m = mf ). For liquid argon these values are σ = 3.4 Å,
ǫ = 1.65 × 10−21 J and m = 6.63 × 10−26 kg respectively.

In all our simulations, the interaction between wall and
fluid atoms is chosen to be as intense as that between
fluid monomers, ǫfw = ǫff , which is considered highly
hydrophilic [32–34], and σfw = σff . Each atom of the
thermal wall is tethered around its equilibrium position
via a quadratic potential,

Vwall (r) = Kw (r − r0)
2
, (7)

where r is the position of the wall atom and r0 its equi-
librium position, and Kw models the stiffness of the
wall [35]. For the current work we have used a value
Kw = 600 ǫ/σ2, which is inside the interval of values



4

commonly used in MD studies, and has been proved to
accomplish the two basic requirements for wall stiffness:
(i) it is not too small, thus preventing the melting of the
wall according to the Lindemann criterion [36], and (ii)
its associated frequency is low enough to allow the correct
integration of the equations of motion of the wall atoms
without reducing the time step [35]. The mass of wall
particles is mw = 10mf in order to reduce the vibration
frequency, and they do not interact with each other.

Taking into account the volume accessible for the fluid,
the average fluid mass density in all our simulations
is ρf = 0.86 mσ−3. With regard to the walls, they
form a face-centered cubic (fcc) lattice of number density
equal to 3.90 σ−3, which implies an equilibrium nearest-
neighbor distance of 0.71 σ. The wall planes in contact
with the fluid are (010) faces, with the [100] orientation
of the fcc lattice aligned with the shear flow direction (x).
The number of fluid, Nf , and wall atoms, Nw, vary from
one studied configuration to another, and are detailed
below.

In order to control the temperature in some region of
the computational domain the dissipative particle dy-
namics (DPD) thermostat is considered. This type of
thermostat is considered to be particularly suitable for
nonequilibrium MD [34, 37] since, among other advan-
tages, it is a profile-unbiased thermostat [38]; that is,
does not need to assume a predetermined streaming ve-
locity profile. This virtue of the DPD thermostat is due
to the fact that it involves relative velocities between
pairs of particles, uij = ui − uj , instead of individual
velocities as in other thermostats commonly used (e.g.
Langevin thermostat). Hence, the equations of motion
in the thermostated region are

mi
dui
dt

= −
∑

j 6=i

∇
ri
Vij(rij) + F

D
i + F

R
i (8)

where two extra terms are added to the force resulting

from the interatomic potential. FDi denotes the dissipa-
tive force on particle i and FRi the corresponding random
force. Both are expressed as a sum of pairwise contribu-
tions,

F
D
i =

∑

j 6=i

F
D
ij = −

∑

j 6=i

Γw2(rij) (r̂ij · uij) r̂ij (9)

F
R
i =

∑

j 6=i

F
R
ij =

∑

j 6=i

√

2kBTΓw(rij)αij r̂ij (10)

where r̂ij = rij/|rij |, T is the target temperature, Γ the
friction coefficient (Γ = 1.0 mτ−1 in our simulations,

where τ =
(

mσ2/ǫ
)1/2

is the characteristic LJ time), αij
a Gaussian white noise variable that fulfills the condition
αij = αji, and w(r) is a weighting function of rij . The
usual choice is

w(rij) =

{

1 − rij/rc , rij < rc
0 , rij ≥ rc

(11)

All the simulations have been carried out using the
LAMMPS package [39]. The equations of motion are in-
tegrated using the velocity Verlet algorithm, with a time
step of ∆t = 0.002τ (τ = 2.16×10−16 s for liquid argon).
In the initial configuration the fluid particles are arranged
in the positions of a fcc lattice, and the equilibration runs
lasted typically 5 × 105 steps. Once the steady state is
reached, a production run of a minimum of 106 steps
(2 × 103 τ) is performed to average the data. The simu-
lation domain is divided in bins of size ∆x = 1.5 σ and
∆y = 0.5 σ to discretize the collected data.

The components of the local stress tensor in each
spatial bin have been computed following the Irving-
Kirkwood method [20], that is,

P(rbin) =
1
Vbin

〈

Nbin
∑

i∈bin

mi [ui(t) − u(rbin, t)] [ui(t) − u(rbin, t)]

〉

+
1

2Vbin

〈

Nbin
∑

i∈bin

N
∑

j 6=i

rij(t)Fij(t)

〉

(12)

where the sum of the kinetic term includes the Nbin par-
ticles which are inside the bin located at rbin at time t,
and the potential term involves the interaction of par-
ticles i inside the bin with all the other atoms j of the
system (in or outside the bin); Fij is the sum of internal
forces exerted on i by j, u(rbin, t) the average velocity in
the bin, and Vbin its volume. With regard to the tem-
perature, only the thermal velocities of the particles, i.e.,
ui(t)−u(rbin, t), are considered in the MD calculation of
T [40].

Previous features are common to all the models simu-
lated in this work. In the rest of this section we describe

the specificities of the various studied models, that dif-
fer essentially in the driving mechanism of the flow, the
thermostated regions, and the geometry of the channel.

A. A simple approach: the streamwise
homogeneous (SH) flow model

The configuration geometry of the SH flow model is
shown in Fig. 1. The channel length in the flow direction,
Lx, varies from 200 to 400 σ depending on the case, its
width (measured as the distance between the wall planes



5

in contact with the fluid) is Ly = 30.0 σ, and its depth
Lz = 10.0 σ. Both the upper and lower walls consist of
four fcc layers separated by a distance 0.50 σ (that is,
the wall thickness is ∆yw = 1.50 σ). Then, the num-
ber of fluid and wall atoms in the simulation cell vary
from Nf = 49980 and Nw = 32000 (for Lx = 200σ) to
Nf = 99960 and Nw = 64000 (for Lx = 400σ). Periodic
boundary conditions are applied in x and z directions.
As specified in Fig. 1, the plane y = 0 cuts the channel
through its center and x = 0 at the entrance.

The flow is generated by applying a constant external
force (per unit mass) fx in x direction on all the fluid
atoms. The interval of forces simulated in this work goes
from fx = 0.010 ǫ/mσ to fx = 0.040 ǫ/mσ. Modeling the
walls as non-rigid allows for the heat generated by friction
to be removed through them. The wall temperature is
fixed to the value Tw = 1.1 ǫ/kB by applying the DPD
thermostat described above only to the wall atoms (and
not to the fluid ones).

B. Abandoning homogeneity: the streamwise
inhomogeneous force driven (SIFD) flow model

In a first step towards a more realistic model, the ho-
mogeneity hypothesis is abandoned and the configura-
tion shown in Fig. 2(a) is studied. We consider a cen-
tral channel of the same dimensions as in the SH model,
Lx × Ly × Lz = 200 − 400 σ × 30 σ × 10 σ, limited by
the same fcc walls of thickness ∆yw = 1.50 σ. This is
the domain of interest, where the fluid properties are ex-
tracted. But now we add two open reservoirs of length
Lres = 50 σ outside it, both on the left and on the right
of the channel, where the fluid can move freely in the
vertical (y) direction. Periodic boundary conditions are
applied in the three directions. Again, we choose the ori-
gin in such a way that y = 0 at the center of the channel
and x = 0 at the entrance (and, then, x coordinates take
negative values at the left reservoir).

We apply a DPD thermostat, Eqs. (8-11), to the fluid
particles, but only when they are located in the reservoirs
outside the domain of interest. In such a way, we fix
the temperature of the fluid at the inlet to be Tin =
1.1 ǫ/kB and we leave the fluid completely free inside the
channel. As in SH model, the walls are also thermostated
to Tw = 1.1 ǫ/kB, and the flow is driven by a constant
external force fx exerted on every fluid atom in the whole
simulated domain.

Unlike the SH flow model, the SIFD model allows for
the evolution of the fluid properties along the channel,
like the local temperature, and therefore incorporates the
heat transfer by convection. The presence of the reser-
voirs also makes it possible to analyze the channel en-
trance effects, like pressure losses. The basic idea behind
a model like this is to explicitly separate the domain of
interest, where the system evolves according its natural
dynamics, without being restricted by artificial forces or
constraints, from the surroundings where constraints are

applied to induce the desired fluid conditions at the en-
trance of the region of interest. This is, precisely, the
great difficulty when periodicity is abandoned in MD:
how to impose the proper boundary conditions to couple
both regions adequately. In fact, this is also the main
challenge to build hybrid models which couple molecular
dynamics with continuum dynamics [41–44].

As mentioned in Sect. I, other works have previously
proposed different boundary conditions for generating in-
homogeneous flows on nanopores and one of the reasons
why the use of this kind of models is not generalized
is that enlarging a system to include a region outside
the domain of interest has a computational cost. In our
case, the number of fluid atoms grows to Nf = 78300
and Nw = 32000 (for Lx = 200 σ) or Nf = 128280 and
Nw = 64000 (for Lx = 400 σ). Nevertheless, it is afford-
able given the tremendous amount of computing power
available in supercomputers and the maturity of the sim-
ulation software.

A simplification of the configuration of this SIFD
model is presented in Fig. 2(b). Again we consider a
channel of length Lx and we add left and right reservoirs
that are extensions of the channel. In these reservoirs
the flow is thermostated (Tin = 1.1 ǫ/kB) and periodic
boundary conditions are applied, but the vertical motion
is constrained by (fictitious) extensions of the channel
walls. This configuration does not account for hydrody-
namic entrance effects but it will be important to under-
stand the relation to the SH model. As in previous mod-
els, wall particles are also thermostated (Tw = 1.1 ǫ/kB),
and the force fx is applied to all the fluid atoms. The
number of simulated particles in this case areNf = 74970
and Nw = 48000 (for Lx = 200 σ) or Nf = 124950 and
Nw = 80000 (for Lx = 400 σ).

There are therefore two types of SIFD models accord-
ing to the type of reservoir: the SIFD model with open
reservoirs (SIFD-OR, Fig. 2(a)) and with closed reser-
voirs (SIFD-CR, Fig. 2(b)).

C. Leaving the channel unperturbed: the
streamwise inhomogeneous pressure driven (SIPD)

flow model

Finally, we have simulated another model in which
body forces no longer exist inside the channel. The con-
figuration is the same shown in Fig. 2(a), but now a pres-
sure gradient is generated between the inlet and outlet
reservoirs by applying a force only on those fluid atoms
located far from the channel. In particular, we apply an
external force of magnitude

fx =
∆p
ρf ∆z

(13)

on all the fluid atoms located inside two regions of width
Lres/3 at the edges of the simulation cell (one at the be-
ginning of the left reservoir and the other at the end of the



6

x

y

—

—

Ly

—

∆yw

| |
Lx

| |
Lres Lres

(a)

x

y

—

—

Ly

—

∆yw

| |
Lx

| |
Lres Lres

(b)

FIG. 2. (a) New configuration suggested in this work for inhomogeneous MD simulations of nanochannel flows. Fluid particles
in the reservoirs (in green) are thermostated and allowed to move freely in the y direction. The properties of the fluid inside
the channel (atoms in blue) varies along the x direction. Solid particles are shown in red. (b) Alternative configuration where
vertical motion is constrained in the left and right reservoirs by extensions of the channel walls.

right one), but not outside them. ∆z = 2Lres/3 is the to-
tal length of both regions where the force is applied, and
∆p is the pressure difference created. The DPD thermo-
stat described above is applied in the reservoirs of length
Lres to fix the temperature to 1.1 ǫ/kB, and also in the
walls. In this configuration the heat generated by the ex-
ternal force is dissipated inplace, as far from the channel
as possible trying to minimize the disturbance caused in
the system.

D. Model summary

With the purpose of clarifying the differences between
simulated flow models, and making the reading of the
rest of the paper easier, we summarize the main figures
that change between models in the following table I. In-
teraction parameters ǫfw, σfw and ǫww as well as fluid
and wall densities and the stiffness coefficient Kw are the
same in all computations (and given at the begining of
this section).

III. RESULTS

A. Homogeneous flow

The fluid properties obtained by atomistic simulations
of periodic homogeneous flows in nanochannels are rather
well understood. In Fig. 3 we show the averaged density,
temperature, velocity, and pressure profiles for the SH
model. As previously mentioned, this model maintains
the wall temperature fixed but it does not thermostat the
fluid, which is widely accepted to be the more realistic
option for homogeneous flows [7, 11–13, 15]. Neverthe-
less, the evacuation of the viscous heat through the walls
does not avoid a significant temperature increase in the
fluid, as we shall see shortly. The constant force applied
to induce the flow in this case has been fx = 0.020 ǫ/mσ,
which despite being a value in the range of those com-
monly used in MD exceeds the gravity force by a factor
of 1.5 × 1011.

The fluid density shows a clear layered structure (with
at least six marked layers separated by a distance ∼ 0.9σ)
in the region near to the atomic walls, where the surface
effects are visible. On the other hand, it is constant and
equals the bulk value in the center of the channel. This



7

Model Lx Ly Lz ∆yw Reservoirs fx applied to DPD thermostat applied to PBC

SH 200/400 30 10 1.5 No all fluid atoms - wall atoms x, z

SIFD-CR 200/400 30 10 1.5 Closed (Lres = 50) all fluid atoms
- wall atoms

- fluid atoms in reservoirs
x, z

SIFD-OR 200/400 30 10 1.5 Open (Lres = 50) all fluid atoms
- wall atoms

- fluid atoms in reservoirs
x, y, z

SIPD 200/400 30 10 1.5 Open (Lres = 50)
fluid atoms in edge

regions of width Lres/3

- wall atoms

- fluid atoms in reservoirs
x, y, z

TABLE I. Summary of MD simulation setups in the different flow models studied in this work: dimensions of the channel Lx,
Ly , Lz and wall thickness ∆yw, type of reservoirs and their size Lres, regions where external force fx and DPD thermostat are
applied, and directions in which periodic boundary conditions (PBC) are imposed. Length dimensions are given in units of σ.

fact suggests that the channel is wide enough to assume
the continuum equations to be valid at this scale [45].
In particular, the streaming velocity can be determined
from the momentum equation

ρux
∂ux
∂x

= −
∂p

∂x
+ µ

∂2ux
∂y2

+ ρfx (14)

where ρ is the fluid mass density, and ux the x compo-
nent of the streaming velocity. Since there is no variation
along the channel, the well-known quadratic profile is re-
covered,

ux (y) =
ρfx
2µ

(

h2

4
− y2 + hLs

)

(15)

where h is the distance between the solid-liquid interfaces
at the top and bottom walls. The position of the solid-
liquid interface (that is, the point of closest approach
where the boundary condition is imposed) is not well de-
fined. To take into account the excluded volume effects,
we locate the interface at a distance of 0.5 σ from the
wall innermost fcc planes [33], and then h = 29.0 σ. The
slip length Ls is defined as the additional length, relative
to the interface, at which the linearly extrapolated fluid
tangential velocity vanishes,

∣

∣

∣

∣

∂ux
∂y

(y = ±h/2)

∣

∣

∣

∣

Ls = us (16)

with us = ux(±h/2) the slip velocity at the interface.
As it can be seen in Fig. 3, the solution in Eq. (15) fits
accurately the velocity profile assuming a value around
µ ∼ 2.4 ǫτσ−3 for the viscosity, which coincides with
that obtained from the simulated shear stress, µ =
Pxy (∂ux/∂y)

−1 = 2.45±0.10ǫτσ−3, and is close to those
obtained with similar models [4]. The simulated flow rate
is then consistent with that obtained from the quadratic
profile

Q =
Lzh

3

12µ
ρfx

(

1 +
6Ls
h

)

(17)

With regard to the temperature, again the homogene-
ity simplifies the energy balance equation,

ρcpux
∂T

∂x
− βTux

∂p

∂x
= µ

(

∂ux
∂y

)2

+ κ
(

∂2T

∂y2

)

, (18)

which reduces to a quartic profile for the temperature
[40],

T (y) =
ρ2f2x
12κµ

[

(

h

2

)4

− y4 +
h3LK

2

]

(19)

with κ the thermal conductivity of the system and LK the
Kapitza length, which is defined equivalently to the slip
length in Eq. (16) but changing ux by T [46]. As it can
be seen in Fig. 3 the temperature profile is satisfactorily
fitted by a quartic function.

B. Streamwise inhomogeneous force-driven flow

Unless stated explicitly, in this subsection we discuss
the results obtained using the SIFD-CR model (that is,
with the outer fixed-temperature reservoirs confined by
the walls, the configuration shown in Fig. 2(b)). We will
show below that the results with the SIFD-OR model
(using the open-reservoirs configuration in Fig. 2(a)) are
qualitatively similar, and will discuss the slight differ-
ences. From Fig. 3, it could seem that the differences
between homogeneous and non-homogeneous models are
not that noticeable (except for the temperature). But we
must take into account that, whereas the homogeneous
profiles remain unaltered along the channel, the fluid
properties in the inhomogeneous model evolve through
x. In Fig. 3, then, we present the fluid profiles in a par-
ticular section (x = 150σ, far enough from the entrance)
only as an example. It is more convenient to analyze the
results along the direction of the flow, as we do in Fig. 4.

One of the main distinctive features of inhomogeneous
models is their compressibility: the fluid density ρ dimin-
ishes significantly along the channel, and this reduction is
more pronounced for higher external forces, as expected.
Note that only the values inside the non-thermostated
channel have physical meaning; those in the reservoirs



8

-10 0 10

y (s)

0

4

8

12

p
 (
e
s

-3
)

1.2

1.4

1.6

1.8

T
 (
e
k

B
-1
) 

-10 0 10

y (s)

0

0.4

0.8

1.2

u
x
 (
s
t

-1
)

1

2

3

4

r
 (

m
s

-3
)

(a) (b)

(c) (d)

FIG. 3. Averaged fluid profiles in the section x = 150 across
the flow direction, obtained with the SH (black solid line)
and the SIFD-CR model (red dashed line), for an applied
force fx = 0.020 ǫ/mσ and Lx = 200 σ: (a) fluid density, (b)
temperature, (c) streaming velocity, and (d) pressure. The
dotted green curves in panels (b) and (c) are the fits of the
homogeneous temperature (Eq. (19)) and velocity (Eq. (15))
profiles, respectively (see text). Vertical dashed lines indicate
the position of the innermost walls layers.

are artificial because of the applied thermostat and the
imposed periodicity. On the contrary, the pressure is al-
most constant in the flow direction (a slight gradient is
observed only for very high forces). The reason of this be-
havior seems to be in the configuration used: since both
reservoirs are limited by walls, viscous forces are high
enough to equilibrate the external force in these regions
(last two terms in Eq. (14)), and thus an appreciable
pressure difference is not created between channel ends.
On the contrary, we will see that a clear pressure gradi-
ent arises when fx is applied in open reservoirs, in which
friction is much less important.

The compressibility of the flow allows the variation of
the velocity along the channel, in such a way that the
mass flow rate is constant. As it is shown in Fig. 4 (c)
and Fig. 5(a), when the fluid enters the non-thermostated
channel its velocity profile starts to develop (in the reser-
voirs, the thermostat restrains the fluid and its velocity
remains approximately constant). Due to the friction, ve-
locity gradually reduces in the regions near the walls, and
therefore the fluid is accelerated at the center of the sec-
tion to maintain the mass flow rate (Fig. 5(a)). As a con-
sequence the slip decreases (and shear rate γ increases)
in the streamwise direction. The shear continues to grow
downstream until the friction force equilibrates the exter-
nal force; downstream this entry region, the flow is fully
developed. Whether a given channel is long enough to

0 100 200 300 400

x (s)

0

2

4

6

8

p
 (
e
s

-3
)

1.4

1.8

2.2

2.6

T
 (
e
k

B
-1
) 

0 100 200 300 400

x (s)

0.5

1

1.5

2

2.5

u
x
 (
s
t

-1
)

0.8

0.9

1

1.1

r
 (

m
s

-3
)

fx=0,020 (homog.)

fx=0,010

fx=0,020

fx=0,030

fx=0,040

(a) (b)

(c) (d)

FIG. 4. Averaged fluid profiles in the plane y = 0 along
the flow direction, obtained with the SH (black line) and the
SIFD-CR model for different applied force values: (a) fluid
density, (b) temperature, (c) streaming velocity, and (d) pres-
sure. Vertical dashed lines indicate the entrance and exit of
the channel.

consider the flow hydrodynamically developed should be
determined when designing the simulation of nanoscale
flows. On the basis of the results of this work, forces
higher than 0.02 ǫ/mσ requires entry lengths longer than
400σ. However, it is common to find considerably shorter
channels in the literature in which entrance effects are
neglected.

Another noticeable impact of the change in the con-
figuration is that the well-established quadratic profile
for the velocity in Eq. (15) may no longer be valid for
non-homogeneous flows, since the first term in momen-
tum equation, Eq. (14), does not vanish. The solution
becomes significantly more complex, but as a first ap-
proximation one can assume that the velocity gradient
∂ux/∂x does not depend on y (this is almost exactly true
in our simulations). In this case, the new solution has the
form

ux (y) = u0 [1 −A cosh (λ0y)] (20)

where

u0 =
fx

∂ux/∂x
, λ2

0
=
ρ∂ux/∂x

µ

and

A−1 = cosh
(

λ0h

2

)

+ Lsλ0sinh
(

λ0h

2

)



9

This solution reduces to Eq. (15) when the velocity gra-
dient is small. Although we have indeed confirmed that
the hyperbolic profile fits better the results than the
quadratic one for high forces, the difference in our simu-
lations is small (it is only noticeable near the boundary;
see the inset in Fig. 5(a)). Nevertheless, it should be
taken into account in future studies or for more intense
driving forces, as an accurate velocity fit can affect the
calculation of the slip length. Consequently, the volumet-
ric flow rate expression in Eq. (17), used regularly in the
literature for obtaining the slip length from experimental
flow rate measures [47], should be also modified to take
into account the non-homegeneity, to be

Q = Lzu0

[

h−
2A
λ0

sinh
(

λ0
h

2

)]

But over all the features of this model for inhomoge-
neous flows, there is one that makes it clearly more real-
istic than the traditional homogeneous models: it incor-
porates the fluid cooling by convection along the channel.
As it occurs in real (nano)channels, the fluid at the en-
trance is colder than at the outlet, and this makes the
temperature to gradually rise due to the viscous heat
generated by friction. The evolution of T in Fig. 4(b) is
qualitatively similar to the simple unidimensional model
drafted in Sect. I, Eqs. (3-5), and tends asymptotically
to a constant value. Again, we have found that, for high
external forces, the length of full thermal development
is longer than the simulated channels. It must be noted
that the asymptotic value to which T tends in the case of
fx = 0.020 ǫ/mσ coincides with the temperature of the
homogeneous model with the same applied force. This
fact leads us to conclude that, while representing con-
vection by a thermostat when assuming an homogeneous
channel is a crude approximation, modeling cooling only
through walls also fails to describe heat transfer, espe-
cially at the entrance, and overestimates the tempera-
ture at the channel. Only in low-shear regime (forces
lower than fx = 0.010 ǫ/mσ in our model) temperature
is approximately uniform and the role of convection less
important, as thermal conduction is effective enough, a
case in which the SH model without fluid thermostating
provides similar results.

It is also interesting to analyze how the temperature
distribution across the channel varies with x. Results
presented in Fig. 5(b) show marked differences between
the profiles as the flow progresses. At the inlet, where
the convective cooling is intense, the thermal jump at
the boundary is very pronounced and heat is transferred
by conduction from the walls to the center of the channel.
Only at sections where convection ceases to play a major
role the temperature profile resembles that obtained in
homogeneous models (see Fig. 3(b)). Understanding this
behavior requires noticing that the convective term in the
energy Eq. (18) does not vanish now. Only to find an
approximate solution, we can assume that specific heat,
density, viscosity and thermal conductivity do not vary
appreciably with y; that the temperature gradient is also

-10 0 10

0.8

1.6

2.4

-10 0 10

y (s)

0

0.4

0.8

1.2

1.6

u
x
 (
s
t

-1
)

x = 25 s

x = 375 s

(a)

-10 0 10

y (s)

1.1

1.2

1.3

1.4

1.5

1.6
T

 (
e
k

B
-1
) 

(b)

FIG. 5. (a) Velocity and (b) temperature profiles across differ-
ent channel sections obtained using the SIFD-CR model with
a force fx = 0.02 ǫ/mσ in a channel of length Lx = 400 σ.
The eight curves correspond to sections from x = 25 σ to
x = 375 σ (from bottom to top, in successive steps of 50 σ).
Inset in (a) shows the velocity profile in x = 75 σ for a force
fx = 0.04 ǫ/mσ in a channel of length Lx = 400 σ (empty cir-
cles), together with the best quadratic (Eq. (15), green curve)
and hyperbolic (Eq. (20), red curve) fits. Dashed curves in (b)
are the fits of temperature profiles with the form in Eq. (21).



10

x (s)
0

0.1

0.2

0.3

g 
(t

-1
)

0 100 200 300 400

x (s)

4

8

12

L
s
 (
s

)
fx=0,020 (homog.)

fx=0,010

fx=0,020

fx=0,030

fx=0,040

FIG. 6. Slip length calculated along the flow direction for
the SH (black dashed curve) and SIFD-CR models with dif-
ferent fx. In the inset, the shear rate distributions along the
channel for different values of fx are shown. The squared
black symbols correspond to simulations in which the fluid is
thermostated (see text).

approximately independent on y, and the pressure gradi-
ent negligible (the last two hypothesis have been checked
to be valid here). Finally, for the sake of simplicity we
take the solution in Eq. (15) for the velocity (since we
have seen that solution in Eq. (20) offers similar results
for the simulations presented in this work). With these
approximations, we get

T (y) = a2y
2 − a4y

4 + a0 (21)

where

a2 =
fx
4µ

ρ2

κ
cp
∂T

∂x

(

h2

4
+ hLs

)

,

a4 =
ρfx
24µ

(

ρ

κ
cp
∂T

∂x
+ 2

ρfx
κ

)

and

a0 =
ρfx
2µ

(

ρ

κ
cp
∂T

∂x
+ 2

ρfx
κ

)

h3

24

(

LK +
h

8

)

−
ρfx
2µ

ρ

κ
cp
∂T

∂x

(

h2

4
+ hLs

)

h

2

(

LK +
h

4

)

where LK is the Kapitza length. In Fig. 5(b) it is shown
that temperature profiles may indeed be very well fitted
by this solution. At the beginning of the channel the
convective term dominates and the profile is eminently
quadratic; on the contrary, near the end where the flow
is almost thermally developed a2 ≈ 0 and the profile is
∝ y4, as in the homogeneous case.

Finally, we have focused on the results obtained for
the flow slip over the solid surface. The study of the slip
observed at nanoscales remains to be of great interest
at present, among other reasons, because of its potential
technological utility for nanoscale flows [45, 48] Although
this phenomenon has been extensively investigated from
experimental, theoretical and computational points of
view [49, 50], there are some issues that are still con-
troversial, like the slip dependence on shear rate. Since
the seminal work of [4], some authors have reported (both
in experimental and simulation studies) a non-bounded
monotonic increase of the slip length with shear rate and
the existence of a critical shear rate at which Ls diverges
[4, 51, 52]. However, other researchers have found that
slip length tends to a finite constant value at high shear
[13, 15]. It is important to emphasize that in all these
works an homogeneous flow is assumed, the first group
applying a thermostat to the fluid and the second only
to the solid [15], see also [3].

In Fig. 6 we can see the slip length for the SIFD flow
model, calculated from definition in Eq. (16) . The slip
length is higher at the inlet, decreases along x and tends
to a constant value . It is worth pointing out that, for
fx = 0.020 ǫ/mσ, the slip length value at high x approx-
imately coincides with that obtained with the homoge-
neous model and the same force. We confirm again, then,
that the study of homogeneous flow can describe the de-
veloped flow, but not its developing behavior. We also
see that shear rate increases along the channel, as it can
be readily understood from the increasing slope of ve-
locity profiles at the boundaries in Fig. 5(a) (see inset).
The fact that slip reduces with growing shear rate could
appear to be in contradiction with those works that, in
the line of [4], conclude that slip grows with shear. How-
ever, those works assume constant temperature. Tem-
perature variation affects the slip, as has already been
highlighted in the literature [3, 53]. In this case, the slip
length decrease along the channel is due to the temper-
ature increase. In order to support this conclusion we
conducted ten extra MD simulations using the SH model
with fx = 0.020 ǫ/mσ, but thermostating also the fluid
at ten different temperatures, each one corresponding to
the one obtained using the SIFD model at a different
section of the channel. The results, shown with squared
symbols in Fig. 6, confirm that temperature is the crucial
factor that makes the slip to decrease along the channel,
even if the shear rate gradually increases. It also ex-
plains the smaller Ls for higher fx. For different values
of the wall-fluid interaction energy (ǫfw) the trend might
be the opposite (the slip length would increase with the
temperature increase) as it is shown in [3] using the SH
model.

C. Open or closed reservoirs?

A few comments on the effects of assuming open reser-
voirs outside the channel (configuration in Fig. 2(a) in-



11

stead of that in Fig. 2(b)) should also be made, since
they can shed some light on the discussion about bound-
ary conditions choice in MD simulations of nanoflows.
The main difference with respect to the closed-reservoirs
case reported so far lies on the pressure gradient created
out of the channel (see Fig. 7(d)). The lack of walls in
the open reservoirs causes much flatter velocity profiles
(in the reservoir) than those in the closed ones, as shown
in Fig. 8, and then, much smaller viscous forces in these
regions. As a result, a positive pressure gradient appears
to compensate the external force (see Eq. (14)). This
pressure difference between channel ends translates in a
pressure drop inside the channel, and in an extra force
on the confined fluid which adds to fx. Its effects are
not minor, since −∂p/∂x is comparable to ρfx. It must
therefore be concluded that simulated systems with the
same force but different boundary conditions may not
be dynamically equivalent, and this must be taken into
account when designing the model to simulate.

As a consequence a higher flow rate is observed when
open reservoirs are considered, as it can be seen from
Fig. 7(a) and Fig. 7(c) (note that, for example at x ≃
150σ, the densities are similar but the velocity is big-
ger when open reservoirs are considered). Evidently, the
hydraulic resistance of closed reservoirs is higher.

It is also worth to note the variation of flow proper-
ties (except temperature, which is fixed by the action
of the thermostat) along the streamwise variation in the
reservoirs with an abrupt change at the channel entrance.
This effect is a direct consequence of the model geome-
try which now contains an inlet, where the velocity grows
sharply and density decreases.

On the other side, although the higher force exerted
on the confined fluid in the open-reservoirs configura-
tion (and the corresponding higher shear rate) could sug-
gest a more intensive heating, the temperature distribu-
tion along the channel is not substantially different (and
shows even a lower T ) from the closed-reservoirs case (see
Fig. 7(b)). The explanation for this behavior could be
found in the second term of the left-hand side of the en-
ergy equation, Eq. (18): a fraction of the heat transferred
to the fluid is devoted to increase the fluid temperature,
but another part goes to diminish the fluid pressure (un-
like what happens with closed reservoirs).

To conclude this subsection we also note that in the
case of closed reservoirs, caution is recommended when
altering the reservoirs height (in y direction), since it can
affect the results in some measure. The reason is that,
for a given channel width Ly, increasing the reservoirs
height results in bigger pressure losses at the entrance
(since the flow contraction is more abrupt), which, in
turn, results in a reduction in the pressure gradient inside
the channel. This influences the fluid properties obtained
because, as discussed by [54], it is this pressure gradient,
and not the pressure difference between reservoirs, which
characterizes the flow (see also [22]). We have checked
that entrance losses increase indeed if reservoirs height is
enlarged, but it affects only slightly the presented results.

0 100 200 300 400

x (s)

3

5

7

9

p
 (
e
s

-3
)

1.4

1.8

2.2

2.6

T
 (
e
k

B
-1
) 

0 100 200 300 400

x (s)

0

1

2

3

u
x
 (
s
t

-1
)

0.8

0.9

1

1.1

r
 (

m
s

-3
)

fx=0,010

fx=0,020

fx=0,030

fx=0,040

(a) (b)

(c) (d)

FIG. 7. Averaged fluid profiles in the plane y = 0 along the
flow direction, obtained with the SIFD model: (a) density, (b)
temperature, (c) streaming velocity, and (d) pressure. Solid
and dashed curves correspond to closed reservoirs (SIFD-CR)
and open reservoirs (SIFD-OR) model, respectively.

D. Streamwise inhomogeneous pressure-driven flow

Finally, we now move to discuss the third and last type
of models studied in this work, which should be, a priori,
the most realistic to simulate nanoflows, since its driving
mechanism is not a fictitious external force that disturbs
significantly the behavior of the fluid inside the channel,
but a pressure gradient (obviously, induced also by a force
but applied in this case far enough from the channel).

Firstly, it has been confirmed that the application of a
force of the magnitude in Eq. (13) in the margin regions of
length Lres/3 (see Fig. 2(a)) translates in a pressure dif-
ference between the ends of the channel which coincides
with the ∆p value imposed in Eq. (13) with satisfactory
accuracy (less than a 10% discrepancy). In Fig. 9(d)
we present the pressure profiles for a channel of length
Lx = 200 σ and four different ∆p values, chosen to cre-
ate the same driving in the confined fluid as the one in
the SIFD-OR model shown in Fig. 7 (that is, the value
of ∆p in the SIPD model is chosen such that ∆p/Lx
in this model equals the average driving ∆p/Lx + ρffx
in the SIFD-OR model for each value of fx shown in
Fig. 7). This choice aims to compare dynamically equiv-
alent flows. Observe that in the SIPD model the induced
pressure gradient is much bigger than in the SIFD one.
As it will be shown throughout this section, the pressure
variation affects the rest of thermodynamic fluid prop-
erties and changes notably the results analyzed so far.



12

-10 0 10

y (s)

0.6

0.8

1

1.2

u
x
 (
s
t

-1
)

FIG. 8. Velocity distribution across the channel in reservoir
region (x = −25 σ) with fx = 0.02 ǫ/mσ. Solid and dashed
curves correspond to closed reservoirs (SIFD-CR) and open
reservoirs (SIFD-OR) model, respectively.

(a) (b)

(c) (d)

1.3

1.6

1.9

T
 (
e
k

B
-1
) 

0 100 200

x (s)

0

4

8

12

p
 (
e
s

-3
)

0 100 200

x (s)

0

1

2

3

u
x
 (
s
t

-1
)

0.8

0.95

1.1

r
 (

m
s

-3
)

Dp=2,0

Dp=4,0

Dp=6,0

Dp=8,0

FIG. 9. Averaged fluid profiles in the plane y = 0 along the
flow direction, obtained with the SIPD model: (a) density,
(b) temperature, (c) streaming velocity, and (d) pressure.

Also note that pressure losses at the channel entrance,
between the point where the external force is no longer
applied and the inlet at x = 0, are barely appreciable.

The induced pressure difference causes a significantly
more pronounced variation of the density along the chan-
nel than in the SIFD models with the same total force

(a) (b)

(c) (d)

-10 0 10

y (s)

6

12

18

p
 (
e
s

-3
)

1.1

1.2

1.3

1.4

1.5

T
 (
e
k

B
-1
) 

-10 0 10

y (s)

0

0.7

1.4

2.1

u
x
 (
s
t

-1
)

0.6

1.2

1.8

2.4

3

r
 (

m
s

-3
)

Dp=6,0

x=25

x=75

x=125

x=175

FIG. 10. Averaged fluid profiles across different sections of a
channel of length Lx = 200 σ, obtained with the SIPD model
and a pressure difference ∆p = 6.0 ǫ/σ3: x = 25 σ (black
curves), x = 75 σ (blue curves), x = 125 σ (red curves), and
x = 175 σ (green curves): (a) density, (b) temperature, (c)
streaming velocity, and (d) pressure. Dashed curves in (b) are
the best fits for temperature profiles with the form in Eq. (21).

(see Fig. 9(a)). In fact this density variation limits the
applicability of this kind of models, since if the pressure
drop is too high, ρ will diminish sufficiently to provoke
a phase change at the exit of the channel. This imposes
a limitation on the maximum ∆p applied in MD simu-
lations, and on the channel length for a given pressure
gradient. This is the reason why we are reporting re-
sults only for Lx = 200 σ : simulations with larger Lx
demand also larger ∆p to induce a certain gradient, and
the phase transition occurs. Also related to density vari-
ation, it should be noted that the profiles in the wall-
normal direction (y) show a more marked structure near
the walls (with more clearly located atomic layers) at
the beginning of the channel, where density is higher, as
is apparent in Fig. 10(a) and Fig. 10(d). On the other
hand, it has been verified that in our simulations fluid
density evolves with pressure in a qualitatively similar
fashion to that reported by [55], who obtained the phase
diagram of a Lennard-Jones fluid at equilibrium by MD
simulations. As it can be seen in Fig. 11(a), for small ∆p
the p-ρ relation approaches the equilibrium equation of
state, while for larger ∆p the pressure is slightly higher
than the one at equilibrium but the functional relation
with the density is similar.

The averaged velocity also shows a faster growth in the
channel when flow is induced by a difference in pressure
(as it can be seen comparing Fig. 9(c) with Fig. 7(c)),
which is consistent with the greater density drop and
the requirement of mass flow rate conservation along the



13

channel. We can also observe that the gradient of ux
progressively increases along x, and it is clearly larger
at the exit; that is, the fluid is more accelerated near
the end than at the beginning of the channel. Besides,
this effect is more pronounced for higher ∆p, in fact it
is hardly noticeable for ∆p = 2.0 ǫ/σ3 but clearly visi-
ble for ∆p = 8.0 ǫ/σ3. One might ask for the physical
cause of this behavior. Since pressure gradient does not
change appreciably along x, we suggest that, again, it is
the intense change of fluid properties in the channel (in
this case, shear viscosity) which explains it. Fig. 11(b)
includes the results for viscosity as a function of x for
different ∆p, extracted from the simulated shear stress
through Pxy = µ (∂ux/∂y). µ lowering along x is in
fact significant, being more marked as pressure gradient
is increased. This tendency is consistent with the results
of [56], who reported both theoretical and MD calcula-
tions for shear viscosity at a wide range of temperatures,
and showed that µ diminishes when ρ decreases (see the
inset in Fig. 11(b)). This behavior indicates that friction
is reduced along the channel, and then explains the in-
crease in the gradient of ux. Precisely at those regions
where ∂ux/∂x grows, the hyperbolic function Eq. (20)
starts to differ from the quadratic function Eq. (15), and
one can confirm that it is more suitable to fit the veloc-
ity profiles, although the discrepancy is still small (as an
example, see the velocity in a point near the end of the
channel for ∆p = 8.0 ǫ/σ3 in Fig. 12).

But certainly the most significant difference observed
in our MD simulations between the SIFD and the SIPD
flow models resides in the temperature distribution along
the channel. If we look at Fig. 9(b), we clearly observe
that in SIPD models T raises to a much lesser extent than
in SIFD models (Fig. 7(b)). The difference is important
enough to conclude that the choice of proper boundary
conditions is a fundamental question in MD simulations
of nanoflows, and must be addressed carefully. In this
work we suggest two causes of this disparity in the evo-
lution of T . In the first place, as we mentioned for the
case of models with an external force and open reservoirs,
the term −βTux

∂p
∂x

in the energy equation, Eq. (18), acts
as an effective cooling mechanism. The internal energy
increase produced by the viscous heat does not directly
result in a temperature increase, as it would occur in an
incompressible flow, due to the energy required by the
pressure loss to occur. As the flow velocity ux increases
along the channel, this contribution becomes higher and
temperature growth becomes progressively slower (for ∆p
larger than 6.0 ǫ/σ3 one can even observe a slight T re-
duction at the end of the channel). The second factor
that contributes to moderate the temperature is shear
viscosity, that, as we have seen, decreases in the flow
direction, then causing a gradual reduction of the fric-
tion. The relative importance of these two causes is not
clear, and deserves further research. What we do know
is that both become much more important in models in
which flow is induced by a pressure gradient, since the
streamwise pressure and viscosity variation increases no-

tably with respect to those driven by a uniform external
force. With regard to the form of temperature distri-
bution across the flow (Fig. 10(b)), we see again that
T profiles meet the functional form derived in Eq. (21).
Compared to those presented in Fig. 5(b) for SIFD flow
models, the quadratic term (we recall that it vanishes for
SH flow models) dominates over the fourth-order term.

IV. CONCLUSIONS

A careful analysis of three different MD models for the
flow in nanochannels has been reported. The traditional
SH (force driven) flow model, which does not account for
the variation of properties along the channel, permits to
predict the density, temperature, pressure and velocity
profiles (and thus slip length) when low forces are ap-
plied. In this case the heat generation by friction is small
and it is easily dissipated by thermal conduction to the
walls, where it is finally dissipated by the thermostat ap-
plied there. Other heat transfer (cooling) mechanisms,
convection and dilatation, are missing as they are incom-
patible with an homogeneous flow. Therefore, at higher
forces an inhomogeneous model must be used to capture
flow developing profiles if the associated computational
cost can be afforded.

When two reservoirs are added at the inlet and the
outlet and the fluid is thermostated there to fix the in-
let temperature, streamwise variation of the flow can be
predicted. The main difficulty here is that the results
depend on the design of the reservoirs. If the reservoirs
are surrounded by (fictitious) extensions of the walls no
pressure gradient is generated because the flow is driven
by an external force that balances the viscous dissipa-
tion, in the same way as it occurs inside the channel. If
open reservoirs are considered, the velocities outside the
channel are almost uniform and a pressure gradient is
generated. In the former case, we have seen that also
the reservoirs size can affect the pressure distribution in-
side the channel, although the influence in the results
presented in this work is minor.

The inclusion of reservoirs outside the domain of in-
terest allows us to analyze the streamwise evolution of
the shape of velocity and temperature profiles in the
wall-normal direction. In particular, the appearance of
a quadratic term in T (y) as a consequence of convection
is discussed. For the higher forces in the range studied
in this work, the flow is not fully (hydrodynamically and
thermally) developed at the end of the channel, despite
the large simulated channel lengths. The usual homoge-
neous simulations ignore this developing behavior, as well
as the stabilization of the slip length along the channel.

The pressure gradient inside the channel has an impor-
tant influence on the results. Even if the pressure profile
were constant across the channel section, a pressure gra-
dient is equivalent to a constant external force only for
incompressible flows. At high pressure differences, heat
generation makes compressibility effects important, the



14

0.4 0.7 1

r

0

4

8

m

0 50 100 150 200

x (s)

0

2

4

6

8

m
 (
e
s

-3
t
)

Dp=2,0

Dp=4,0

Dp=6,0

Dp=8,0

0.6 0.7 0.8 0.9 1 1.1

r (ms-3)

0

4

8

12
p
 (
e
s

-3
)

Dp=2,0

Dp=4,0

Dp=6,0

Dp=8,0

(a)

(b)

FIG. 11. Left panel: Pressure versus fluid density obtained for various pressure differences ∆p. Black squares are extracted
from the phase diagram reported in [55] from MD simulations at a temperature of 1.15 ǫ/KB . Right panel: Viscosity along
the channel for different ∆p. In the inset we compare the evolution of µ with fluid density in these same simulations to the
MD results of [56] for a temperature of 1.23 ǫ/KB .

density cannot be assumed to be constant and the di-
latation work acts as a heat sink. Therefore, the results
obtained using the SIPD model are substantially differ-
ent from those obtained using the SIFD model, specially
regarding temperature distribution. It has been demon-
strated that the temperature growth along the channel is
much smaller than in SIFD models. Both the energy re-
quired by the pressure loss and the streamwise variation
of viscosity are identified as the factors which explain
this behavior. Therefore, at high pressure differences,
the SIPD model should be used, as it is the only one
that permits to correctly predict the pressure gradient
inside the channel. Force-driven models will fail because
of the unphysical heating of the fluid by friction.

In this respect it is worth noting that if a low cost SH
model is to be used, thermostating the fluid to account
for the missing heat transfer mechanisms will produce
better (but still inaccurate) results than those obtained
with the SH model in which only walls are thermostated.
This conclusion is obtained comparing the temperature
distributions in Fig. 7 and Fig. 9: the temperature ob-
tained with the most realistic model (SIPD) do not ex-
ceed 1.3 ǫ/kB whereas the temperatures obtained using
the SH model almost doubles this value. It is therefore
less inaccurate to consider the temperature fixed at its in-
let value (1.1 ǫ/kB). Nevertheless, we remark once again
that the use of homogeneous models will only provide a
first approximation due to their inability to describe the
streamwise variation of flow properties.

[1] Ju Li, Dongyi Liao, and Sidney Yip, “Coupling contin-
uum to molecular-dynamics simulation: Reflecting par-
ticle method and the field estimator,” Phys. Rev. E 57,
7259–7267 (1998).

[2] François Detcheverry and Lydéric Bocquet, “Thermal
fluctuations of hydrodynamic flows in nanochannels,”
Phys. Rev. E 88, 012106 (2013).

[3] Luyao Bao, Nikolai V Priezjev, Haibao Hu, and Kai
Luo, “Effects of viscous heating and wall-fluid interaction
energy on rate-dependent slip behavior of simple fluids,”
Phys. Rev. E 96 (2017).

[4] P. A. Thompson and S. M. Troian, “A general boundary
condition for liquid flow at solid surfaces,” Nature 389,
360–362 (1997).

[5] Nikolai V. Priezjev, “Relationship between induced fluid
structure and boundary slip in nanoscale polymer films,”
Phys. Rev. E 82, 051603 (2010).

[6] Christian Sendner, Dominik Horinek, Lyderic Bocquet,
and Roland R Netz, “Interfacial water at hydrophobic
and hydrophilic surfaces: Slip, viscosity, and diffusion,”
Langmuir 25, 10768–10781 (2009).

[7] Sridhar Kumar Kannam, B. D. Todd, J. S. Hansen, and



15

-10 0 10

y (s)

0

1

2

3
u

x
 (
s
t

-1
)

Dp=8,0

FIG. 12. Open symbols: Velocity profile across section
x = 175 σ obtained with a pressure-driven model with
∆p = 8, 0 ǫ/σ3 and Lx = 200 σ. Solid curves are the best
quadratic (green curve, eq. Eq. (15)) and hyperbolic (red
curve, Eq. (20)) velocity fits.

Peter J. Daivis, “How fast does water flow in carbon nan-
otubes?” J. Chem. Phys. 138, 094701 (2013).

[8] M.P. Allen and D.J. Tildesley,
Computer Simulation of Liquids (Clarendon Press,
Oxford, 1987).

[9] Daan Frenkel and Berend Smit,
Understanding Molecular Simulation:From Algorithms to Applications
(Academic Press, New York, 1996) p. 664.

[10] Y Liem, David Brown, and Julian H R Clarke, “In-
vestigation of the homogenous-shear nonequilibrium-
molecular-dynamics method,” Phys. Rev. A 45, 3706–
3713 (1992).

[11] Rajesh Khare, Juan de Pablo, and Arun Yethiraj,
“Molecular simulation and continuum mechanics study
of simple fluids in non-isothermal planar couette flows,”
J. Chem. Phys. 107, 2589–2596 (1997).

[12] Bo Hung Kim, Ali Beskok, and Tahir Cagin, “Thermal
interactions in nanoscale fluid flow: molecular dynam-
ics simulations with solid–liquid interfaces,” Microfluid
Nanofluid 5, 551–559 (2008).

[13] Ashlie Martini, Hua-Yi Hsu, Neelesh A Patankar, and
Seth Lichter, “Slip at High Shear Rates,” Phys. Rev. Lett.
100, 206001 (2008).

[14] Stefano Bernardi, B D Todd, and Debra J Searles,
“Thermostating highly confined fluids,” J. Chem. Phys.
132, 244706 (2010).

[15] Amir Alizadeh Pahlavan and Jonathan B. Freund, “Ef-
fect of solid properties on slip at a fluid-solid interface,”
Phys. Rev. E 83, 021602 (2011).

[16] L. Kantorovich, “Generalized Langevin equation for

solids. I. Rigorous derivation and main properties,” Phys.
Rev. B 78, 094304 (2008).

[17] L. Kantorovich and N. Rompotis, “Generalized Langevin
equation for solids. II. Stochastic boundary conditions for
nonequilibrium molecular dynamics simulations,” Phys.
Rev. B 78, 094305 (2008).

[18] Paz Padilla and Soren Toxvaerd, “Simulating shear flow,”
J. Chem. Phys. 104, 5956–5963 (1996).

[19] G. K. Batchelor, An Introduction to Fluid Dynamics
(Cambridge University Press, Cambridge, 1967) p. 615.

[20] J. H. Irving and John G. Kirkwood, “The Statistical Me-
chanical Theory of Transport Processes. IV. The Equa-
tions of Hydrodynamics,” J. Chem. Phys. 18, 817–829
(1950).

[21] Jean-Louis Barrat and François Chiaruttini, “Kapitza re-
sistance at the liquid solid interface,” Mol. Phys. 101,
1605–1610 (2002).

[22] William D. Nicholls, Matthew K. Borg, Duncan A.
Lockerby, and Jason M. Reese, “Water transport
through (7,7) carbon nanotubes of different lengths using
molecular dynamics,” Microfluid Nanofluid 12, 257–264
(2012).

[23] Matthew K Borg, Duncan A Lockerby, and Ja-
son M Reese, “A hybrid molecular-continuum simulation
method for incompressible flows in micro/nanofluidic
networks,” .

[24] S. Y. Docherty, W. D. Nicholls, M. K. Borg, D. A.
Lockerby, and J. M. Reese, “Boundary conditions
for molecular dynamics simulations of water transport
through nanotubes,” Proc. Inst. Mech. Eng. Part C J.
Mech. Eng. Sci. 228, 186–195 (2014).

[25] Song Ge, Youwei Gu, and Min Chen, “A molecular
dynamics simulation on the convective heat transfer in
nanochannels,” Mol. Phys. 113, 703–710 (2015).

[26] Cunkui Huang, K. Nandakumar, Phillip Y. K. Choi, and
Larry W. Kostiuk, “Molecular dynamics simulation of a
pressure-driven liquid transport process in a cylindrical
nanopore using two self-adjusting plates,” J. Chem. Phys.
124, 234701 (2006).

[27] Cunkui Huang, Phillip Y K Choi, K Nandakumar, and
Larry W Kostiuk, “Investigation of entrance and exit ef-
fects on liquid transport through a cylindrical nanopore.”
Phys. Chem. Chem. Phys. 10, 186–192 (2008).

[28] Luying Wang, Randall S. Dumont, and James M. Dick-
son, “Nonequilibrium molecular dynamics simulation of
water transport through carbon nanotube membranes at
low pressure.” J. Chem. Phys. 137, 044102 (2012).

[29] ZhongQiang Zhang, HongWu Zhang, and HongFei Ye,
“Pressure-driven flow in parallel-plate nanochannels,”
Appl. Phys. Lett. 95, 154101 (2009).

[30] M Sun and C Ebner, “Molecular-dynamics simulation
of compressible fluid flow in two-dimensional channels,”
Phys. Rev. A 46, 4813–4818 (1992).

[31] Jiaye Su and Hongxia Guo, “Effect of nanochannel di-
mension on the transport of water molecules,” J. Phys.
Chem. B 116, 5925–5932 (2012).

[32] J. L. Barrat and Lydéric Bocquet, “Large slip effect at
a nonwetting fluid-solid interface,” Phys. Rev. Lett. 82,
4671–4674 (1999).

[33] Nikolai V. Priezjev, “Effect of surface roughness on rate-
dependent slip in simple fluids,” J. Chem. Phys. 127,
144708 (2007).

[34] Xin Yong and Lucy T Zhang, “Slip in nanoscale shear
flow: mechanisms of interfacial friction,” Microfluid



16

Nanofluid 14, 299–308 (2013).
[35] Nikolaos Asproulis and Dimitris Drikakis, “Boundary

slip dependency on surface stiffness,” Phys. Rev. E 81,
061503 (2010).

[36] J.P. Hansen and I.R. McDonald,
Theory of Simple Liquids. (Academic, New York,
1976) p. 556.

[37] Thomas Soddemann, Burkhard Dünweg, and Kurt Kre-
mer, “Dissipative particle dynamics: A useful thermostat
for equilibrium and nonequilibrium molecular dynamics
simulations,” Phys. Rev. E 68, 046702 (2003).

[38] Denis J. Evans and Gary P. Morriss, “Shear thickening
and turbulence in simple fluids,” Phys. Rev. Lett. 56,
2172–2175 (1986).

[39] Steve Plimpton, “Fast Parallel Algorithms for Short-
Range Molecular Dynamics,” J. Comput. Phys. 117, 1–
19 (1995).

[40] B D Todd and Denis J Evans, “Temperature profile for
Poiseuille flow,” Phys. Rev. E 55, 2800–2807 (1997).

[41] Nicolas G. Hadjiconstantinou and Anthony T. Pat-
era, “Heterogeneous Atomistic-Continuum Representa-
tions for Dense Fluid Systems,” Int. J. Mod. Phys. C
8, 967–976 (1997).

[42] Thomas Werder, Jens H. Walther, and Petros Koumout-
sakos, “Hybrid atomistic–continuum method for the sim-
ulation of dense fluid flows,” J. Comput. Phys. 205, 373–
390 (2005).

[43] E Weinan, Björn Engquist, X Li, W Ren, and Eric
Vanden-Eijnden, “Heterogeneous multiscale methods: a
review,” Commun Comput Phys 2, 367–450 (2007).

[44] K. M. Mohamed and A. A. Mohamad, “A review of the
development of hybrid atomistic-continuum methods for
dense fluids,” Microfluid Nanofluid 8, 283–302 (2010).

[45] Lyderic Bocquet and Elisabeth Charlaix, “Nanofluidics,
from bulk to interfaces,” Chem. Soc. Rev. 39, 1073–1095
(2010).

[46] Rajesh Khare, Pawel Keblinski, and Arun Yethiraj,

“Molecular dynamics simulations of heat and momentum
transfer at a solid-fluid interface: Relationship between
thermal and velocity slip,” Int. J. Heat Mass Transf. 49,
3401–3407 (2006).

[47] Long Li, Jingwen Mo, and Zhigang Li, “Flow and slip
transition in nanochannels,” Phys. Rev. E 90, 033003
(2014).

[48] Jason K Holt, Hyung Gyu Park, Yingmin Wang,
Michael Stadermann, Alexander Artyukhin, Costas Grig-
oropoulos, Aleksandr Noy, and Olgica Bakajin, “Fast
Mass Transport Through Sub-2-Nanometer Carbon Nan-
otubes,” Science (80-. ). 312, 1034–1037 (2006).

[49] Eric Lauga, Michael Brenner, and Howard Stone,
“Microfluidics: The No-Slip Boundary Condition,” in
Springer Handb. Exp. Fluid Mech., edited by C. T. J.
Foss and A. Yarin (Springer Berlin Heidelberg, Berlin,
Heidelberg, 2007) Chap. 19, pp. 1219–1240.

[50] Chiara Neto, Drew R Evans, Elmar Bonaccurso, Hans-
Jürgen Butt, and Vincent S J Craig, “Boundary slip
in Newtonian liquids: a review of experimental studies,”
Rep Prog Phys 68, 2859–2897 (2005).

[51] Y Zhu and S Granick, “Rate-dependent slip of Newtonian
liquid at smooth surfaces.” Phys. Rev. Lett. 87, 096105
(2001).

[52] Nikolai V. Priezjev, “Rate-dependent slip boundary con-
ditions for simple fluids,” Phys. Rev. E 75, 051605 (2007).

[53] Zhaoli Guo, T S Zhao, and Yong Shi, “Tempera-
ture dependence of the velocity boundary condition for
nanoscale fluid flows,” Phys. Rev. E 72, 036301 (2005).

[54] John A Thomas and Alan J H McGaughey, “Water flow
in carbon nanotubes: Transition to subcontinuum trans-
port,” Phys. Rev. Lett. 102 (2009).

[55] J. J. Nicolas, K. E. Gubbins, W. B. Streett, and
D. J. Tildesley, “Equation of state for the Lennard-Jones
Fluid,” Mol. Phys. 37, 1429–1454 (1979).

[56] K Tankeshwar, K N Pathak, and S Ranganathan, “The
shear viscosity of Lennard-Jones fluids,” J. Phys. C Solid
State Phys. 21, 3607–3617 (2000).


