































































On the numerical modeling of granular material flows via the Particle Finite Element Method (PFEM)


Accepted Manuscript

On the numerical modeling of granular material flows via the Particle Finite
Element Method (PFEM)

C. Dávalos, J. Cante, J.A. Hernández, J. Oliver

PII: S0020-7683(15)00277-2
DOI: http://dx.doi.org/10.1016/j.ijsolstr.2015.06.013
Reference: SAS 8816

To appear in: International Journal of Solids and Structures

Received Date: 15 February 2015
Revised Date: 2 June 2015

Please cite this article as: Dávalos, C., Cante, J., Hernández, J.A., Oliver, J., On the numerical modeling of granular
material flows via the Particle Finite Element Method (PFEM), International Journal of Solids and Structures
(2015), doi: http://dx.doi.org/10.1016/j.ijsolstr.2015.06.013

This is a PDF file of an unedited manuscript that has been accepted for publication. As a service to our customers
we are providing this early version of the manuscript. The manuscript will undergo copyediting, typesetting, and
review of the resulting proof before it is published in its final form. Please note that during the production process
errors may be discovered which could affect the content, and all legal disclaimers that apply to the journal pertain.

NOTICE: this is the author’s version of a work that was accepted for publication in < International Journal 
of Solids and Structures>. Changes resulting from the publishing process, such as peer review, editing, 
corrections, structural formatting, and other quality control mechanisms may not be reflected in this 
document. Changes may have been made to this work since it was submitted for publication. A definitive 
version was subsequently published in International Journal of Solids and Structures, [VOL 71, (October 
2015)] DOI 10.1016/j.ijsolstr.2015.06.013

http://dx.doi.org/10.1016/j.ijsolstr.2015.06.013
http://dx.doi.org/http://dx.doi.org/10.1016/j.ijsolstr.2015.06.013


  

1 

 

 

 

 

 1 

On the numerical modeling of granular material flows via the Particle  Finite Element Method 2 

(PFEM)  3 

C. Dávalos1, J. Cante2,4, J.A. Hernández2,4, J. Oliver3,4 4 
 5 

1 I.I.T. Departamento de Ingeniería Civil y Ambiental 6 

Universidad Autónoma de Ciudad Juárez (UACJ) 7 

Av. del Charro 450 norte, 32310, Ciudad Juárez, México 8 

2 E.T.S. d’Enginyeries Industrial i Aeronáutica de Terrassa 9 

Technical University of Catalonia (UPC) 10 

Campus Terrassa UPC, Mòdul TR5, c/Colom 11, 08222 Terrassa, Spain 11 

3 E.T.S. d’Enginyers de Camins, Canals i Ports de Barcelona, 12 

Technical University of Catalonia (UPC) 13 

Campus Nord UPC, Mòdul C1, C/. Jordi Girona 1-3, 08034, Spain 14 

4CIMNE – Centre Internacional de Metodes Numerics en Enginyeria 15 

C/. Gran Capitan s/n, 08034, Spain 16 

 17 

Corresponding author:  juan.cante@upc.edu 18 

 19 

Abstract  20 

The aim of this work is to describe a numerical framework for reliably and robustly simulating  21 

the different kinematic conditions exhibited by granular materials while spreading ---from a stag-22 

nant condition, when the material is at rest, to a transition to granular flow, and back to a deposit 23 

profile. The gist of the employed modeling approach was already presented by the authors in a 24 

recent work [38], but no proper description of  the underlying numerical techniques was provided 25 

therein.  The present paper focuses precisely on the detailed discussion of such  numerical tech-26 



  

2 

 

 

 

 

niques, as well as on its rigorous validation with the experimental results obtained by Lajeunesse, 1 

et al. in Ref. [1]. 2 

The constitutive model is based on the concepts of large strains plasticity. The yield surface is 3 

defined in terms of the Drucker Prager yield function, endowed with a deviatoric plastic flow and 4 

the elastic part by a hypoelastic model. The plastic flow condition is assumed nearly incompressi-5 

ble, so a pu−  mixed formulation, with a stabilization of the pressure term via the Polynomial 6 

Pressure Projection (PPP), is employed. The numerical scheme takes as starting point the Particle 7 

Finite Element Method (PFEM) in which the spatial domain is continuously redefined by a differ-8 

ent nodal reconnection, generated by a Delaunay triangulation. In contrast to classical  PFEM ap-9 

proximations [2], in which the free boundary is obtained by a geometrical technique (α-shape 10 

method), in this work the boundary is treated as a material surface, and the boundary nodes are 11 

removed or inserted by means of an error function. One of the novelties of this work is the use of 12 

the so-called Impl-Ex hybrid integration technique to enhance the spectral properties of the algo-13 

rithmic tangent moduli and thus reduce the   number of iterations and robustness of the accompany-14 

ing Newton-Raphson solution algorithm (compared with fully implicit schemes respectively). The 15 

new set of numerical tools implemented in the PFEM algorithm – including new discretization 16 

techniques, the use of a projection of the variables between meshes, and the constraint of the free-17 

surface instead using classic α-shape – allows us to eliminate the negative Jacobians present during 18 

large deformation problems,  which is one of the drawbacks in the simulation of granular flows.   19 

Finally, numerical results are compared with the experiments developed in Ref. [1], where  a 20 

granular mass, initially confined in a cylindrical container, is suddenly allowed to spread by the 21 

sudden removal of the container. The study is carried out using different geometries with varying 22 

initial aspect ratios. The excellent agreement between computed and experimental results convinc-23 

ingly demonstrates the reliability of the model to reproduce different kinematic conditions in tran-24 

sient and stationary regimes. 25 



  

3 

 

 

 

 

 1 

Keywords 2 

Granular material; finite elements; Particle finite elements 3 

1. Introduction 4 

Due to the intrinsic interaction of the particles that comprise granular materials, these materials 5 

present complex behaviors that could be related to different states of matter. Their mechanical re-6 

sponse differs from other standard materials: in static conditions, they could be considered and 7 

modeled as solid bulks; under dynamic conditions, the kinematics could be described by the phys-8 

ics of fluids; and subject to an interstitial fluid, their response could be represented as a gas.  These 9 

particularities make granular materials an interesting topic where many proposals have been devel-10 

oped to clarify and understand their behavior and influence in industrial processes and nature [3]. 11 

Generally, they could be classified in two main groups: discrete methods and continuum meth-12 

ods, both of them presenting their own advantages and drawbacks [6]. 13 

Discrete methods born from the natural idealization of the particles interaction controlled by 14 

their contact and defining their motion explicity [7].  These methods are generally considered as the 15 

more suitable way to describe granular materials since they are a conglomeration of discrete parti-16 

cles.  The application of these methods in slow and rapid flows arise from the similitude with the 17 

material applying kinetic theory to obtain constitutive relations that govern the interaction between 18 

particles [8]. 19 

The velocity profiles play a fundamental role for the comprehension of granular flows.  On dis-20 

crete methods, the formulation for the velocity prediction is established in terms of kinematic mod-21 

els.  Generally, this assumption is considered as a drawback of these models since the velocity pro-22 

files are defined as a function of geometric parameters instead of a stress-strain relation. 23 



  

4 

 

 

 

 

The use of the continuum approach to formulate a model for granular materials is not recent.  1 

This assumption has been traditionally used for soils mechanics, generally under static and com-2 

pression conditions, and in recent years, it has been extended for granular flow problems.  In order 3 

to relate a discrete system as a granular domain into a continua, studies such as the one given by 4 

Duran, in Ref. [6], demonstrate that describing the kinematics of the media by differential equa-5 

tions is correct as long as the number of particles involved is large enough.   6 

The Finite Element Method is based on the discretization of the variational principles defined 7 

for the continuum theory.  Extensive studies on variational principles for granular materials can be 8 

found in ([9],[10],[11]).  As any other continuum based model, the balance equations for mass and 9 

momentum are to be complemented by an appropriate constitutive model that represents both the 10 

failure and the flow mechanisms in the material.  Contrary to discrete methods, the description of 11 

velocity fields equations arrives from plasticity theory, assuming that stresses and velocity profiles 12 

are correlated by the proper definition of a flow rule ([12],[13]). 13 

Due to large deformations exhibited by granular flows, the Eulerian description is in principle 14 

more suited for models in stationary regime.  For industrial processes, like silo discharge, we could 15 

find diverse works that employ Eulerian mesh descriptions ([14],[15],[16]); similarly, simulations 16 

of debris flows following this approach can be encountered in [17]. The advangate of the Eulerian 17 

approach is that the stationary description of the granular flow can be carried out with a fixed mesh.  18 

On the other hand, among the main disadvantages, it may be mentioned the difficult to determine 19 

the free surface, and the study of transient phenomena. 20 

By contast, Lagrangian descriptions do allow us to model free surface conditions and the predic-21 

tion of internal stresses and pressures in the material, inherent to the continuum approach.  The 22 

Particle Finite Element Method (PFEM) arises as an evolution of meshless methods applied to fluid 23 

flows.  It is defined in a Lagrangian description, but the drawbacks latent due to the large defor-24 

mation of the mesh are avoided with robust techniques of discretization and remeshing [18].  In the 25 



  

5 

 

 

 

 

field of granular materials, recent works have explored the possibilities of such a technique in the 1 

simulation of bed erosion due to fluid-structure interaction [19]; ground excavations [20]; and dam 2 

structures [21]. 3 

The PFEM technique enables us to study large deformation problems such as granular flows.  4 

This advantage, together those inherit to the standard finite element method – proper description of 5 

internal stresses and pressure – allow us to define an appropriate and robust numerical tool to per-6 

form models of granular flows in industrial processes and in nature. 7 

It would be pretentious to attempt to develop a numerical model able to capture –in a unified 8 

manner– the phenomenological richness exhibited by granular materials.  Rather, the present work 9 

will exclusively focus on the modeling of cohesionless dense granular flows, in specific, it con-10 

cerns with the development of a numerical model suitable for the simulation of granular flows to 11 

predict diverse configurations in static and dynamic conditions as well as their non-equilibrium 12 

dynamic transition.  For representing these phenomena, the model proposed has to be enriched 13 

enough to differentiate both behaviors as well to remain as simple as it gets to be efficient in the 14 

numerical analysis. 15 

The experimental results provided by Lajeunesse, et al in Ref. [1] were conducted to investigate 16 

the spreading dynamics of granular material when it is suddenly released.  The experiment has the 17 

aim of characterizing the slumping and spreading of the granular material from an initial configura-18 

tion of confinement, being the gravitational forces the only perturbation exerted on the material. 19 

The material crumbles initially to spread and to define a final deposit.  The authors Lajeunesse, et 20 

al in Ref. [1] study different geometric and material parameters to identify those that control the 21 

flow dynamics.  22 

The extension of the set of examples given in the in Ref. [1] allow us to validate our numerical 23 

model through a comparison with their experimental results.  This comparison determines the fea-24 

sibility of the model to capture the kinematics of the media on different stages: the material at re-25 



  

6 

 

 

 

 

pose on its container, the spreading of it when removing the cylinder, and its deceleration until the 1 

material stagnation. 2 

The document layout is as follows: section 2 presents the employed continuum constitutive 3 

model and its numerical formulation as well as the numerical implementation.  The model is based 4 

on a Drucker-Prager yield function in the framework of plasticity theory for large deformation 5 

problems.  The section continues with the description of the numerical algorithm used to increase 6 

the efficiency and robustness of the methodology in terms of its spatial discretization and the inte-7 

gration scheme employed.  Section 3 adresses the validation of the constitutive model proposed for 8 

the simulation of dense granular flows. A brief description of the experimental tests used for the 9 

validation is given, followed by the corresponding numerical simulations.  First, a test for calibrat-10 

ing material and numerical properties is selected; then the predictive ability of the model is validat-11 

ed in both stationary and transient scenarios. Finally, in section 0, some concluding remarks are 12 

presented. 13 

2. Numerical formulation of a constitutive model for cohesionless dense granular flows 14 

2.1. Constitutive model for cohesionless dense granular flows 15 

The constitutive model is formulated in the framework of large-plastic – small-elastic deformations 16 

through a hypoelastic model.  The yield function is defined in stress space by a Drucker-Prager 17 

yield function relating linearly the norm of the deviatoric stresses with the hydrostatic pressure 18 

exerted on the material.  The mechanical condition to define a stagnant and fluid zone in the mate-19 

rial is given by the elasto-plastic formulation.  The plastic condition, equipped with a non-20 

associative deviatoric flow rule, allows the material to yield when the stress state reaches the 21 

strength capacity of the material, while the elastic condition permits the material to reach a stagnant 22 

configuration.  This plastic flow condition is considered nearly incompressible so the proposal is 23 

integrated in a −u p mixed formulation using a pressure stabilization, proposed in Ref. [22], to 24 



  

7 

 

 

 

 

solve the presence of the locking phenomenon that may emerge. The characterization of the jam-1 

ming transition between solid and fluid state requires the inclusion of viscous behavior; here it is 2 

proposed a visco-plastic regularization via a Duvaut-Lions type model.  3 

The assumption of modeling discrete media as a continuum has been subject of extensive study. 4 

It has been demonstrated that the differential equations used to define the kinematics of their de-5 

formation are correct as the number of particles increases ([6],[23]). The continuum approach in-6 

terprets the particle interaction as a transmission of energy through the domain by a mathematical 7 

formulation.  Under some considerations, the microscopic relations of the particles are properly 8 

transformed into macroscopic equivalents in terms of the material properties.   9 

The definition of a unique model capable of representing any physical condition for any materi-10 

al is difficult to establish (if not impossible).  Granular materials models are not an exception in this 11 

regard.  In what follows, we present a constitutive model for dense granular flows able to differen-12 

tiate stagnant and flow zones as well as the jamming transition between these conditions.  13 

It is important to narrow the flow conditions and granular materials that the model is intended to 14 

represent. The model is proposed for dense granular materials, aimed at characterizing the static 15 

condition of the materials at rest, as well as for slow granular flows including the jamming transi-16 

tion. The statement of dense granular flows implies small velocities in the material as well as the 17 

assumption for the granular particles to remain in contact while the material spreads or flows [24].  18 

Frictional interaction between particles govern the mechanical properties of dense granular materi-19 

als, which means that the deformations that the material experiences while flowing do not present 20 

significant volumetric variations [25]; this fact allows us to assume that the material is nearly in-21 

compressible.  In this sense, the model is not suitable for industrial processes where granular mate-22 

rials are subject to compaction or to dispersion the particles. 23 

In order to represent a frictional response between particles, the presence of any other material 24 

between the grains is ignored (e.g., interstitial fluid). The isotropy assumption of the model is con-25 



  

8 

 

 

 

 

served maintaining a high homogeneity in size and shape of the granular particles. Even so, this 1 

assumption is achieved when the particle size is considerable small compared to the size of the 2 

domain under consideration. 3 

2.1.1. Kinematics on large deformations plasticity theory 4 

The domain to represent is denoted by dnΩ∈ � , and it is assumed to be formed by a continuous 5 

set of particles enclosed by a boundary Γ .  The body motion is expressed as the mapping of a ma-6 

terial point between the reference configuration, generally stated at 0t = , and the current one.  7 

The vector field tφ  states a unique correspondence between configurations expressed by 8 

( ) ( ), ttx φ X φ X= =  for all oX∈Ω   and 0t > ; and φ  is a smooth mapping function defined 9 

by 0:
dn

t tφ Ω →Ω ⊂� . 10 

The velocity and acceleration fields are defined by the first and second time derivatives of the 11 

motion tφ , given by /t tV φ=∂ ∂  and 
2 2/t tΑ φ=∂ ∂  respectively with their corresponding 12 

spatial counterparts by ( , )tv x   and ( , )ta x . On the other hand, let v∇  be the spatial velocity gra-13 

dient and the spatial rate of deformation tensor 1
2

( )Td v v= ∇ +∇   the symmetric part of v∇ .  14 

According to large plasticity theory, the deformation gradient of φ , denoted by F , is ex-15 

pressed by the local multiplicative decomposition of the tensor, into its plastic and elastic parts: 16 

 e p=F F F  
(1) 

where pF  represents a pure plastic deformation from 0Ω  to a certain stress-free intermediate con-17 

figuration, and eF  a pure elastic loading from such an intermediate configuration to the current 18 

configuration tΩ  [26]. The determinant of the deformation gradient, relates the integrals in the 19 

current and reference configurations, and it is denoted by detJ F= .    20 



  

9 

 

 

 

 

It is established that, for granular material flows, the deformations are permanent when flowing 1 

and that elastic deformations are considerably small than the total deformation. Thus, the numerical 2 

model follows a continuum approach in the framework of large plastic-small elastic deformation 3 

plasticity theory.  For this case, the distinction between the intermediate state and the current con-4 

figuration, for the elastic response, becomes negligible [27].   5 

The tensorial fields defined naturally at the intermediate configuration, specifically strain relat-6 

ed tensors, are transformed directly into spatial tensorial fields. For the Almansi strain tensor, the 7 

additive structure that inherits of classical small strain formulations [28]: 8 

 e p= +e e e  
(2) 

being 
1

1/ 2( )
T

p p p
e 1 F F

− −

= −  and ee the plastic and elastic parts, respectively, of the Almansi 9 

strain tensor. This property is extended for the rate of deformation tensor: 10 

 e p= +d d d  
(3) 

where ed  and pd  are the elastic and plastic parts of rate of deformation tensor, respectively.  This 11 

allows us to simplify the derivation of the ensuing constitutive equations.   12 

2.1.2. Modeling solid-like state - Elastic response  13 

Several granular flow processes involve the presence of flow and stagnant zones.  The size and 14 

localization of the last determine, in many scenarios, the flow behavior.  The stagnant material is 15 

considered as the equilibrium of granular material reached when the system of inter-particle forces 16 

is in equilibrium [29].  Due to the forces acting on them (body forces, excitation), the transmission 17 

of the loads are carried out via these inter-particle contacts or force chains [30].  The behavior of 18 

the material is considered elastic as long as the displacement between particles is slight.  These 19 

displacements could rearrange the contacts but the bulk deformation is recoverable.  20 

The present formulation is via an elasto-plastic model capable of predicting stagnant zones and 21 

flow regions simultaneously in any spatial domain.  The elastic response consists of a phenomeno-22 



  

10 

 

 

 

 

logical, rate independent, model obtained by an ad hoc extension of the infinitesimal theory, which 1 

relies on a hypoelastic characterization of the elastic behavior. We write the elastic response in the 2 

following form: 3 

 :[ ]pvL = −τ c d d  
(4) 

where ( )vL i denotes the Lie objective stress rate, and τ  the Kirchhoff stress tensor. The advantage 4 

of this model lies on the conceptual simplicity of its formulation. We assume that the spatial elas-5 

ticity tensor c  is given by: 6 

 1
3

2 ( )µ κ= − ⊗ + ⊗c I 1 1 1 1
 

(5) 

where I and 1 , with components [ ] / 2abcd ac bd ad bcI δ δ δ δ= +  and 1ab abδ= , are  the fourth and 7 

second order symmetric unit tensors, and, the parameters µ  and κ  denote the shear and bulk elas-8 

tic moduli, respectively.  9 

2.1.3. Yield condition and flow rule 10 

The formulation of the yield condition is in terms of the Kirchhoff stress tensor, derived essentially 11 

from a Drucker-Prager type criterion.  The envelope of the surface is characterized by the following 12 

equation:  13 

 
1 2( ) 0q b p bφ = + − =τ  

(6) 

where 13 trp τ= , and dev :devq τ τ=  are the mean stress and the norm of the deviatoric 14 

stress respectively, and the equation defines a linear pressure dependency in a p q−  plane. The 15 

parameter 2b  refers to the material cohesion, it relates the shear strength under zero hydrostatic; 1b  16 

represents the slope of the Drucker–Prager line, and it is termed the parameter of internal friction. 17 

The plastic rate of deformation tensor pd , derived from decopling the rate of deformation ten-18 

sor in equation (3), is computed using the concept of flow rule carried out from the framework of 19 

incremental plasticity theory 20 



  

11 

 

 

 

 

 p λ=d m�  
(7) 

defined in terms of the plastic flow vector m  associated to the yield surface and a positive scalar 1 

factor λ� , referred to as consistency parameter or plastic multiplier, that must obey the standard 2 

Karush–Kuhn–Tucker loading/unloading conditions.  For the case of rate-independent plasticity 3 

these conditions read:  4 

 0,    ( ) 0,    and    ( ) 0τ τλ φ λφ≥ ≤ =� �  
(8) 

along with the consistency condition ( ) 0τλφ =� �  [26]. Furthermore, each plastic flow vector m is 5 

presumed to be aligned with the gradient of a certain plastic potential function, ϕ , e.g.. 6 

/ϕ=∂ ∂m τ . In this work, we propose a non-associative fully deviatoric plastic potential: 7 

 21
2

( )= devϕ τ τ
 

(9) 

Therefore, the plastic rate of deformation tensor reads  8 

 devpd τλ= �  
(10) 

Since pd  is proportional to a deviatoric tensor, the flow rule asserts plastic incompressibility. 9 

While dilation in dense flows do occur, it is typically on the order of only a few percent and quick-10 

ly reaches a steady value over large deformations [13]; hence, the plastic incompressibility approx-11 

imation should have negligible effect on the velocity field of a dense granular flow. Note that this 12 

approximation affects only the stress state in the static regions – hydrostatic stresses are fully elas-13 

tics.   14 

Using equations (4), (6), (8), and (10), the elasto-plastic part of the proposed model for granular 15 

flows is defined. 16 

Consitutive models for granular materials with a linear dependency between the hydrostatic 17 

pressures and their resistance to shear – as the Mohr-Coulomb or Drucker-Parger – are defined 18 

until certain value corresponding to the vertex of the surface, in this case ap  in Fig. 1.  In order to 19 



  

12 

 

 

 

 

define a valid stress state for loading conditions greater than the vertex, it is necessary to introduce 1 

a proper regularization. 2 

  

q

p

b
1

b
2

q

p

p*

pa

 

Fig. 1. Two-dimensional Drucker-Prager model with a von Mises type yield 
criterion at the vertex. 

In this work, for the tensile regime, the yield surface is regularized using a von Mises type 3 

model, as displayed in the circled area in Fig. 1.  This regularization has proven more robust and 4 

easier to implement than classic “cap” models. The impact of adopting this admittedly objection-5 

able regularization – it presumes that the material can sustain a certain degree of tensile stresses – 6 

is minimal since the percentage of material of the domain in tensile stress state ranges is small as it 7 

will be discussed in further sections. The regularization takes place after a certain pressure level 8 

*
ap p<   and defines a well-posed load state for pressures greater than this pressure reference.  9 

The yield surface for the von Mises regularization is defined similary than equation (6) 10 

 ( )  * *dev qτ τφ = − 
 

(11) 

where * *2 1q b b p= −   is the norm of the deviatoric stress tensor corresponding to the pressure 
*

p .  11 

The implementation is considered as a regularization of the Drucker-Prager yield surface and not a 12 

two-surface model since the examples here treated represent dense granular domains mainly on 13 



  

13 

 

 

 

 

compressive regimes and the amount of material with pressures above the vertex (tensile regime) is 1 

few.  In Ref. [31] are reported the percentage of total volume in a stress state with positive pres-2 

sures presented for two industrial processes where granular material flow showing that, in average, 3 

only 2.805% of the total volume is on this condition. For the spreading of granular materials, which 4 

corresponds to these examples, the average in this stress state is less than 0.90%. Therefore, this 5 

assumption should be understood as a mathematical regularization that will not affect the physics 6 

of the flow problem. 7 

Even though the concavity of the overlapped yield surface, due to the deviatoric non-associative 8 

plastic potential, all the returning maps are well posed in a single value.  The admissibility of the 9 

proposal is reviewed by the energy dissipation of the system or thermodynamic consistency that 10 

should satisfy the following inequality [32] 11 

 : 0pτ d= ≥D  
(12) 

which could be seen as the Drucker’s inequality for large deformation problems.  Substituting 12 

equation (10) into equation (12) 13 

 ( )  dev :dev 0τ τλ= ≥�    D
 

(13) 

and considering the definition of the slip rate, it is ensured that the plastic dissipation as the double 14 

contraction product of the deviatoric stress tensor is a non-negative scalar value. 15 

2.1.4. Visco-plastic and visco-elastic regularization 16 

The richness that exhibits the granular material behavior entails a difficulty to establish a unified 17 

constitutive equation capable to reproduce the solid like state of the material while stagnant, the 18 

flowing condition, and the transition between regimes.  In this work, the elasto-plastic constitutive 19 

model described in the foregoing section is proposed.  Even so, the transition between both regimes 20 

and the regularization of the intermediate flow regime is necessary to improve through the inclu-21 

sion of a viscous behavior.    22 



  

14 

 

 

 

 

The mechanics of granular materials share similarities with classical visco-plastic models, since 1 

the inclusion of a yield surface delimit the material that is in an elastic or stagnant condition and a 2 

general nonlinear dependence on shear rate when flowing. The regularization is defined via a 3 

Duvault-Lions type model, where the new flow rule reduces to 4 

 11 : [ ]
R

vp ep
d c τ τ

τ

−= −
 

(14) 

where Rτ  refers to the relaxation time and 
ep
τ  corresponds to the solution of the elasto-plastic part 5 

of the model given in section 2.1.3.  6 

The strain-stress relationship defined by the hypoelastic model given in equation (4) is modified 7 

by decoupling the rate of deformation tensor into an elastic and a visco-plastic part, and replacing 8 

the visco-plastic definition of the rate of deformation tensor given in equation (14); this relationship 9 

reads 10 

 vp:vL τ d d
 = −  

c

 
(15) 

The second issue addressed in this section, concerning to the visco-elastic regularization, seeks 11 

to reflect the practical null coefficient of elastic restitution present in granular materials.  The mod-12 

eling of the elastic behavior in terms of the hypoelastic model given in previous section does not 13 

contemplate the dissipation of pressure oscillations.  Fig. 2(a) shows the evolution, during the 14 

simulation of the material settlement of a cylinder pile of granular material, of the computed volu-15 

metric pressures measured at the bottom center of the material. The graph displays a barely percep-16 

tible dissipation on the oscillations along time, a fact that is contrary to expectations, since the coef-17 

ficient of elastic restitution in granular material is practically null [33].  As may be inferred, these 18 

physically unrealistic pressure oscillations are due to oscillations in the normal stress in the vertical 19 

direction, see Fig. 2(b).  20 



  

15 

 

 

 

 

The above observation clearly indicates that the model proposed has to be equipped with some 1 

additional means to dissipate these spurious oscillations.  To this end, a visco-elastic regularization, 2 

based on a Kelvin-Voigt model, in terms of the rate of deformation tensor, is proposed. 3 

0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5
-3000

-2500

-2000

-1500

-1000

-500

0

time (sec)

p
re

s
su

re
 (

P
a

)

0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5
-4500

-4000

-3500

-3000

-2500

-2000

-1500

-1000

-500

0

time (sec)

S
y 

(P
a

)

(a)

(b)

 

Fig. 2. Dynamic oscillations presented in (a) pressure, and (b) vertical 
stresses after settlement of the material at the bottom center of a cylinder 
pile. 

The rheological description of the Kelvin-Voigt model consists of the connection in parallel of a 4 

Newtonian damper and a Hookean elastic spring. The constitutive model proposed for dense granu-5 

lar flows is defined in the framework of large deformation plasticity; the term corresponding to the 6 

elastic term was defined in section 2.1.3 as 1
3
trp τ= , and the term associated to the Newtonian 7 

damper is given by establishing the pressure as a function of its density. 8 



  

16 

 

 

 

 

 ( )p p ρ=
 

(16) 

The time derivative of equation (16) is expressed as 1 

 ( )dp
p

d

ρ
ρ

ρ
=� �

 

(17) 

The time derivative of the density, given in equation (17), is computed aided by the definition of 2 

the rate form of the continuity mass equation 3 

 ( ) ( ) ( ), , div , 0t t tx x v xρ ρ+ =�  
 

(18) 

Solving equation (18) for ρ�   and substituting the value into equation (17), the rate form of the 4 

pressure is described in terms of the velocity components. 5 

 ( )
( ) ( ), div ,

dp
p t t

d
x v x

ρ
ρ

ρ
=−�  

 

(19) 

Equation (19) is rewritten in terms of the rate of deformation tensor and a material bulk modu-6 

lus parameter 7 

 ( )  2 trp dρκ=�   
(20) 

where 2κ  is approximated by the two first terms of a Taylor expansion and a compressibility 8 

curve; and for the second term, the equality   tr divd v=  is used, which is easily deduced using the 9 

definition of the rate of deformation tensor.  Since the material is considerable incompressible, it is 10 

correct to assume a constant value for the bulk modulus. 11 

The numerical approximation of the time derivative for the pressures allows us to relate a dissi-12 

pative coefficient η  with the bulk modulus 2κ , ( )2η η κ= , defining the corresponding term of 13 

the Newtonian damper.  The pressure term with the Kelvin-Voigt regularization reads 14 

 
  

1
3

tr trp τ dη= +   
 

(21) 



  

17 

 

 

 

 

Due to the inherent incompressible character of the proposed flow rule, the presence of the lock-1 

ing phenomenon may emerge when solving the weak form of the motion equation when using 2 

standard formulations.  In this work a mixed formulation, stabilized using the Polynomial Pressure 3 

Projection [22] is employed. 4 

Fig. 3(a) shows the comparison of the volumetric pressures at the bottom center of the material 5 

for different values of the dissipation coefficientη . Comparing the corresponding values of a null 6 

value of the coefficient (green line) and 
410η κ−=  (blue line), the last defines a numerical zero, 7 

nullifying any dissipation. It can be readily appreciated how the amplitude of the oscillations di-8 

minishes when increasing values of the dissipative coefficient.  For 
210η κ−=  (black line), the 9 

oscillations are completely eliminated.  10 

In Fig. 3(b), the influence of the dissipative coefficient on the evolution of the vertical stress 11 

component ( yσ ) is examined. As expected, the introduced regularization proves effective in miti-12 

gating also oscillations in this variable. It is worth noting that, in contrast to the situation observed 13 

in the pressure variable, the magnitude of the mean value of yσ  remains approximately constant 14 

for all values of η .   15 



  

18 

 

 

 

 

time (sec)

p
re

s
su

re
 (

P
a

)

time (sec)

S
y 

(P
a

)

(a)

(b)

0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5
-3000

-2500

-2000

-1500

-1000

-500

0

η = 0.00κ
η = 1e

-4
κ

η κ1e
-3

 = 
η κ1e-2 = 

0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45
-4500

-4000

-3500

-3000

-2500

-2000

-1500

-1000

-500

0

η = 0.00κ
η = 1e

-4
κ

η κ1e
-3

 = 
η κ1e-2 = 

 

Fig. 3. Variation on the dynamic oscillations presented in (a) pressure and 
(b) vertical stresses, after settlement of the material at the bottom center of 
the cylinder pile using the viscoelastic regularization. 

 1 

Finally, Box 1 summarizes the constitutive model proposed in this work to describe the behav-2 

ior of a dense granular material. 3 

Elastic response 

  vp
v :[ ]L τ c d d= −  

Yield function and elastic domain in stress space 

  
1 2( ) dev b p bτ τφ = + −  

 { }ˆ ˆ / ( ) 0E τ ττ φ= ≤  
Flow rule 

  11 : [ ]
R

vp ep
d c τ τ

τ

−= −
 



  

19 

 

 

 

 

 epτ  is solution of the following sub-

           
     

:[ ]pvL τ c d d= −  
            

     dev
p ep

d τλ= �  
           

     0, ( ) 0, 0τλ φ λφ≥ ≤ =
� �

 
Visco-elastic regularization 

 
  

1
3

tr trp τ dη= +   
 

  

Box 1. Visco-elasto-visco-plastic model for non-
cohesive dense granular flows. 

2.2. Integration framework  1 

2.2.1. The Particle Finite Element Method, PFEM 2 

The PFEM arose as a proper evolution of the particle methods used to solve large deformation 3 

problems in the field of incompressible fluid flows, on a Lagrangian formulation [34]. One of the 4 

advantages of this methodology, among others, is the capability to define easily the fluid-solid in-5 

teraction.   6 

Even though the method was first proposed for incompressible fluid flows, its extension to other 7 

mechanic fields have been also addressed.  In the field of solid mechanics, different applications 8 

have been studied as plasticity problems [35] or soils excavations [20].  Nowadays, some studies 9 

are found for granular materials as the response of rockfill dams on overtopping conditions [21]; or 10 

industrial explorations where powder materials ([36],[37]) and granular flows [38] are involved, 11 

where it is demonstrated the capability of the method. 12 

The methodology is based on the macroscopic representation of a continuum domain through a 13 

finite number of particles of infinitesimal dimension.  These particles are view as material points 14 

that describe the kinematic and mechanical behavior of a given domain.  The system of equations, 15 

describing the kinematics of these particles, is proposed to be solved in terms of an updated 16 

Lagrangian formulation and the finite element method is used to solve the variational incremental 17 

problem. 18 



  

20 

 

 

 

 

The PFEM is a set of numerical strategies combined for the solution of large deformation prob-1 

lems.  The standard algorithm of the PFEM for the solution of solid mechanics problems contains 2 

the following steps. 3 

1. Definition of the domain(s) nΩ  in the last converged configuration, nt t= , keeping exist-4 

ing spatial discretization nΩ . 5 

2. Transference of variables by a smoothing process – from Gauss points to nodes. 6 

3. Discretization of the given domain(s) in a set of particles of infinitesimal size – elimination 7 

of existing connectivities nΩ . 8 

4. Reconstruction of the mesh through a triangulation of the domain’s convex-hull and the 9 

definition of the boundary applying the α-shape method [39], defining a new spatial dis-10 

cretization �nΩ  11 

5. A contact method to recognize the multibody interaction. 12 

6. Transference of information, interpolating nodal variables into the Gauss points. 13 

7. Solution of the system of equations for 1n nt t t+ = +∆ . 14 

8. Go back to step 1 and repeat the solution process for the next time step. 15 

Concerning the finite element approximation, an updated lagrangian viewpoint has been adopt-16 

ed for describing the motion of the mesh, with a mesh update procedure as described above. This 17 

method imposes a limitation referent to element technology: finite elements are to be three-noded 18 

triangular elements (linear). To avoid the locking problem that may emerge in the response in using 19 

such simple finite elements, a finite element approximation based on a mixed variational formula-20 

tion, with displacements and pressure as basic variables ( pu− ), and continuous linear interpola-21 



  

21 

 

 

 

 

tion for both fields has been implemented [22]. The formulation has been specialized to address 1 

plane strain and axisymmetric problems. 2 

The inherent reconnection procedure of the method reduces significantly the mesh distortion 3 

present on large deformation problems.  However, in its standard format, this algorithm presents 4 

some  issues that are to be properly addressed  in order to perform a more robust analysis and de-5 

fine a smoother response of the solution. The proposed enhancements are the following: 1)  dynam-6 

ic process for the discretization of the domain into particles, by varying the number of them de-7 

pending on the deformation of the body; 2) the transference of internal variables, from a nodal 8 

smoothing through a variable projection; 3) and a boundary recognition process that eliminates the 9 

need for applying the α-shape method. 10 

Due to the insertion and removal of particles during the continuous spatial discretization, the 11 

transference of gauss point variables between meshes is set directly through a mesh projection in-12 

stead of traditionally nodal smoothing.  The projection is carried out by a direct search of the posi-13 

tion of the integration points of the new spatial discretization 1n+Ω , over the former mesh nΩ .   14 

The use of this transference of information criterion concerns more about computational efficiency 15 

rather than the error that may be induced for a smoothing process. 16 

In the classical version of the PFEM, the boundary treatment is given in terms of the α-shape 17 

method proposed in [39].  The main drawbacks of the method are the inconsistency of the mass 18 

conservation, while some elements are eliminated or introduced, and numerical instabilities pro-19 

duced on the residual due to the sudden remotion of the elements at the boundary.  The latter has a 20 

significant impact on a mixed pu−  formulation. These instabilities are present both the momen-21 

tum and incompressibility equations, shown schematically in Fig. 4.  22 



  

22 

 

 

 

 

  

h > he re fατ
gaus s  

u,p

discontinuous τ
gaus s  

discontinuous u,p

(a) (b)

q q

 

Fig. 4. Pressure º exceeding reference size; (b) elimination of boundary ele-
ment. 

It is observed, that for a given point q , the nodal internal forces should satisfy the equilibrium 1 

condition 2 

 ,0,               res res res eq q q
e

F F F= =∑
 

(22) 

where the sudden removal of an element will generate the instability.  It has to be recalled that the 3 

α-shape criterion is given in the whole boundary, which, in case of large variations on the defini-4 

tion of the previous and new boundary, will generate a lack of convergence. Due to the computa-5 

tional capacity nowadays, the advantage of time efficiency that the α-shape method presents has a 6 

minor repercussion against the drawbacks mentioned above.  We propose a constraint boundary to 7 

circumvent these problems.  8 

The constraint of the boundary, in large deformation problems, is susceptible to present material 9 

overlapping.  The problem that arises from this overlapping lies on the reconnection process and 10 

the transference of information between meshes.  The first case arises when regions apart of the 11 

same domain tend to overlap.  In this case, the problem is avoided by  a proper auto contact algo-12 

rithm – which is described below.  The second case is presented when two adjacent boundary 13 

lengths tend to collapse.  This is a geometrical aspect present when the concave angle of both sec-14 



  

23 

 

 

 

 

tions tends to diminish.  Using an insertion/remotion of particles algorithm, this problem is solved 1 

[31]. 2 

The granular/wall friction-contact conditions are imposed using a contact algorithm based on 3 

the so-called Contact Domain Method (CDM) described in Oliver [40] and Hartmann [41] in which 4 

interacting portions of contacting bodies are identified via an interface mesh. The CDM defines the 5 

interface mesh, as a fictitious domain of zero thickness, with the same dimension as the contacting 6 

bodies, and provides a complete, continuous, and non-overlapping pairing of the contact surfaces 7 

and the contacts are solved in terms of Lagrange multipliers. In our proposal, the interface has di-8 

mension h, defined by a tolerance, and the contact conditions, normal and friction forces, are sup-9 

plied via a constitutive model similar than the given for the granular material.   10 

This methodology can be easily incorporated into the framework of PFEM, overcoming some 11 

deficiencies of the node-to-segment pairings, like dependence on the choice of master or slave fac-12 

es and over-constraining of some specific parings. The displacement field on the contact domain is 13 

naturally taken from the interface of the contacting bodies and the definition of the strain measures 14 

is straightforward. The core of the method is to discretize the domain within the contacting bodies 15 

via a constrained Delaunay triangulation, to allow the accurate definition of the gap within the ac-16 

tive contact area. The contact boundary condition is then enforced in the continuum by the use of 17 

Nitsche’s technique. The resulting method was proved to be robust and efficient for a variety of 18 

demanding problems including the auto-contact condition ([31],[38]). 19 

2.2.2. Integration of the constitutive model 20 

In this section, the integration of the numerical model is described.  The numerical solution is com-21 

puted, following the basis of the PFEM, via an incremental algorithm within the framework of an 22 

updated Lagrangian formulation. For the constitutive model, the implicit/explicit (Impl-Ex) integra-23 

tion scheme proposed in [42] is used. 24 



  

24 

 

 

 

 

Given a time interval [ ],T ⊂0 R that describes the motion of the body, the numerical solution is 1 

obtained through a temporal discretization of the time interval in terms of a given time step2 

n n nt t t+ +∆ = −1 1 . In an updated Lagrangian formulation, the motion is described in terms of the 3 

last converged configuration, see Fig. 5, and the incremental solution is described assuming the 4 

knowledge of the converged stress tensor nτ  at the time step nt  – the subindex ( )n•  stands for all 5 

variables established in the intermediate reference configuration, and ( )
n+

•
1
 for those variables in 6 

the current configuration. 7 

ϕo(X,t )n

f
n+1

F
n+1

Ω
ο

Ω n

Ωn+1

X
F

n

x
n

ϕn(x , t )n ∆ n+1

x
n+1

ϕ(X,t )n+1

X ,x
1 1

X ,x2 2

 
Fig. 5. Mapping of a given body Ω  under different configurations.. 

For the temporal discretization, the multiplicative decomposition of the deformation gradient is 8 

used 9 

 n nF F f+= ⋅1  (23) 

As mentioned in previous section, the strain-stress relationship is defined in terms of a 10 

hypoelastic type model given by equation (4).  It is essential to calculate the objective derivative of 11 

the constitutive model in order to ensure the definition of the Kirchhoff stress tensor as frame-12 

invariant. For this purpose, it is used the algorithmic approximation given in Ref. [26]. The integra-13 



  

25 

 

 

 

 

tion is defined in the current configuration nt +1 , defining the Lie derivative as the time variation of 1 

the increment of the Kirchhoff stress tensor. 2 

 
T

v n n n n n
n

L
t

τ τ τ+ + + +
+

 = − ⋅ ⋅ ∆
1 1 1 1

1

1
f f

 

(24) 

It is observed, in the second term of the RHS of equation (24), the description in the current 3 

configuration of the Kirchhoff stress tensor of the converged configuration nt  carried out by the 4 

push-forward operator.   5 

With the aim of obtaining a description of the stress tensor, the flow rule given in equation (10) 6 

is approximated as: 7 

 
 devp n nn

nt
d τ

λ +
++

+

∆
=

∆
1

11

1

  

 

(25) 

where n n nλ λ λ+ +∆ = −1 1 . 8 

The expression for the Kirchhoff stress tensor in the current configuration is obtained by equat-9 

ing the discretized equation (4) and equation (24) and by substituting the expression of the plastic 10 

part of the rate of deformation tensor by the discretized form of the flow rule given in equation 11 

(25). Rearranging terms and multiplying the expression by nt +∆ 1 , the following equality is ob-12 

tained: 13 

 [ ] : devTn n n n n n n ntτ τ d τλ+ + + + + + +− ⋅ ⋅ = ∆ −∆1 1 1 1 1 1 1  f f c  
(26) 

The rate of deformation tensor is described as the push-forward of the covariant time derivative 14 

of the Green-Lagrange strain tensor E [43]. 15 

 T− −= ⋅ ⋅d F E F 1�  (27) 

Equation (27) is described, after some manipulations, in the current configuration by the 16 

Almansi strain tensor.  Its numerical approximation is given by: 17 

 
n n

nt
d e+ +

+

=
∆

1 1

1

1

 

(28) 



  

26 

 

 

 

 

The expression for the Kirchhoff stress tensor in the current configuration is completed by sub-1 

stituting equation (28) into equation (26).  2 

 [ ] : devTn n n n n n nτ τ e τλ+ + + + + += ⋅ ⋅ + −∆1 1 1 1 1 1 f f c  
(29) 

Equation (29) is simplified using the definition of the trial elastic state given by the freezing of 3 

the plastic flow.   4 

 trial :Tn n n n nτ τ e+ + + += ⋅ ⋅ +1 1 1 1f f c  
(30) 

The simplified description of the Kirchhoff stress tensor is obtained by substituting equation 5 

(30) into (29). 6 

 
 

trial : devn n n nτ τ τλ+ + + += −∆1 1 1 1 c  
(31) 

The plastic regime is defined for a loading state where the evaluation of the yield conditions for 7 

the auxiliary state, trialn+τ 1 , exceeds the yield surface expressed by equation (6): 8 

 ( )  trial trialdev n nb p bτ τφ + += + − >1 1 1 2 0  
(32) 

where 9 

 
 

trial trialtrn np τ+ +=1 1
1

3
 

 

(33) 

and  10 

 
  

trial trn n n
n

p p
t

e
η

+ + +
+

= +
∆

1 1 1

1

  

 

(34) 

The deviatoric part of the Kirchhoff stress tensor, defined by equation (31), is rewritten in terms 11 

of the elastic fourth order tensor c . 12 

 [ ]   trial :dev dev devn n n nτ τ τµ λλ+ + + +⊗+= −∆1 1 1 12   1 1  
(35) 

The double contraction of the volumetric part of this tensor with the deviatoric stress is null, re-13 

ducing the above expression into 14 

 
   

trialdev dev devn n n nτ τ τµ λ+ + + += − ∆1 1 1 12    
(36) 



  

27 

 

 

 

 

The expression of the deviatoric stress tensor is given in terms of the trial stress by solving 1 

 dev n+τ 1  from equation (36) 2 

 
  

trialdev devn n
n

τ τ
µ λ

+ +
+∆

=
+

1 1

1

1

1 2
  

 

(37) 

The expression for the slip rate nλ +∆ 1 , of the flow rule, is given for that stress state such that 3 

( )nφ + =τ 1 0   4 

  dev n nb p b+ ++ − =τ 1 1 1 2 0  (38) 

Substituting eq. (37) into (38) 5 

 
 

trialdev n n
n

b p bτ
µ λ

+ +
+∆

+ − =
+

1 1 1 2

1

1
0

1 2
 

 

(39) 

and manipulating equation (39), the expression for nλ +∆ 1  is obtained 6 

 

( )

 
trialdev n n

n
n

b p b

b b p

τ
λ

µ

+ +
+

+

∆ =
+ −

−

1 1 1 2

1

2 1 12

 

 

(40) 

The slip rate nλ +∆ 1  is simplified by substituting the definition of ( )
trial

τφ , given in equation 7 

(32) into (40), yielding: 8 

 ( )
( )

trial

n
nb b p

τ
λ

µ

φ
+

+

∆ =
−

1

2 1 12  

(41) 

Finally, the expression for the Kirchhoff stress tensor reads: 9 

 
  

trialdevn n n npτ τα+ + + += +1 1 1 1 1  
(42) 

where: 10 

 
( ) n n n

n

λ
µ λ

α α+ + +
+

∆
∆

 
= =   + 

1 1 1

1

1

1 2  

(43) 

 11 

Model integration of the Von-Mises regularization  12 

The Drucker-Prager yield surface is well-defined for all those stress states with a hydrostatic pres-13 

sure smaller or equal than ap  – defined by the vertex of the surface, as shown in Fig. 1.  As men-14 



  

28 

 

 

 

 

tioned previously, a von Mises regularization is proposed for those loading states whose hydrostatic 1 

pressure is beyond the apex. A pressure reference p∗  is defined, which is the pressure value where 2 

the regularization starts.  3 

The elasto-plastic condition, for those pressures on the compression regime 4 

 
np p

∗
+ ≤1  

(44) 

where np +1 , could present two loading states 5 

( )

( )

     Elastic regime

     Plastic regime

φ

φ

<

=

τ

τ

0

0   
 

The numerical integration for the regularization, proposed for those stress states with pressures 6 

greater than p∗ , is developed similarly as for the Drucker-Prager model. 7 

The expression for the slip rate λ∆  is obtained defining a stress state on the yield surface of the 8 

von Mises regularization, given by equation (11), such that ( )nφ
∗

+ =τ 1 0 . Substituting equation 9 

(37)  into equation (11) 10 

 
 

trial *dev n q
µ λ

+
∆

− =
+

τ 1
1

0
1 2

 

 

(45) 

and solving for the plastic multiplier, we get: 11 

 
 

trial *

*

dev n q

q
λ

µ

+
∆ =

−τ 1

2

 

  

(46) 

Equation (46) is rewritten substituting the numerator with the definition of the yield surface in 12 

terms of the trial stress tensor. 13 

 ( )trial*

*q
λ

µ

φ
∆ =

τ

2   

(47) 

 14 

Integration of the visco-plastic regularization 15 



  

29 

 

 

 

 

The integration of the model is completed by incorporating the visco-plastic regularization given in 1 

section 2.1.4. The integration of the visco-plastic regularization is obtained by comparing the Lie 2 

derivatives defined for the visco-plastic model, expressed by equation (15), and the algorithmic 3 

approximation given in equation (24).  Rearranging common terms, gives: 4 

 ep:
R R

T
n n n n n n

t t

τ τ
+ + + + +

 ∆ ∆ − = ⋅ ⋅ + +  
τ τ e τ1 1 1 1 11 f f c

 

(48) 

where epnτ +1  corresponds to the solution of the elasto-plastic part of the model given by equation 5 

(42). 6 

Equation (48) is rewritten regrouping terms and substituting the definition of the trial stress ten-7 

sor trialn+τ 1  in order to obtain an expression for n+τ 1  in terms of the visco-plastic regularization  8 

 eptrial R
R R

n n n

t

t t

τ

τ τ
+ + +

∆
= +

+∆ +∆
τ τ τ1 1 1

1

1 1  

(49) 

The following term is defined in order to simplify the expression  9 

 
Rt

η
τ

=
+∆

1

1  

(50) 

The Kirchhoff stress tensor in the visco-plastic formulation is expressed substituting the above 10 

expression into equation (49) 11 

 ( )vp eptrialnn nη η++ += + −τ τ τ11 11  
(51) 

where hereiafter it is taken indistinctly vpn+τ 1  and n+τ 1 .  12 

The algorithm for the implicit integration of the Kirchhoff stress tensor is summarized in Box 2.   13 

Given: ( ){ nϕ Ω , nτ , nt +∆ 1 , ( ):n nϕ+ Ω →u
2

1 � ,κ , µ , b1 , b2 , ap b b= 2 1 , ap
∗ , }η , 

compute trial stresses 

n n+ += +∇u1 1f 1      

( )Tn n n− −+ + += + ⋅e 11 1 1
1

2
f f1  

 

trial :Tn n n n nτ τ e+ + + += ⋅ ⋅ +1 1 1 1f f c  
 

   
trialtr trn n n

n

p
t

τ e
η

+ + +
+

= +
∆

1 1 1

1

1

3
    

 

Define pressure condition, np +1   



  

30 

 

 

 

 

IF n ap p+ ≤1 THEN – Drucker-Prager yield surface  

( )  
trial trialdev n nb p bτ τφ + += + −1 1 1 2  

 

IF ( )trial
n

φ
+

≤τ
1
0THEN  (Elastic regime)  

trial
n n+ +=τ τ1 1  

 

ELSE  (Plastic regime)  

( )

( )

trial

nb b p
λ

µ

φ

+

∆ =
−

τ

2 1 12  

 

END  
ELSE  (von-Mises regularization)  

( )  
trial* *

* *

dev q

q q

τ τ
λ

µ µ

φ
∆ =

−
=

2 2

 

  

 
 

END  
Kirchhoff stress tensor calculation  
  

  
trialdev devn n

µ λ
+ +

∆
=

+
τ τ1 1

1

1 2
  

 

 

 devn n np+ + += +τ τ1 1 1 1   

Visco-plastic regularization  

Rnt
η

τ+
=

+∆ 1

1

1
 

 

( )
eptrial

n n nη η+ + += + −τ τ τ1 1 11  
 

Box 2. Integration algorithm for the visco-plastic formulation of the granular material flow 

model. 

Integration of the constitutive equation – Impl-Ex scheme 1 

For non-linear problems, the implicit integration schemes are widely used since they present a 2 

higher stability compared to explicit schemes.  Their advantage, compared to explicit ones, is the 3 

definition of larger time steps on the solving process with a high degree of accuracy. However, in 4 

our case, near the apex of the Drucker-Prager surface, the algorithmic tangent matrix consistent 5 

with a implicit integration scheme may be ill-conditioned due to the small values of the prevailing 6 

stress state.  In order to increase the robustness of the model, we propose to integrate the constitu-7 

tive model using the hybrid implicit/explicit integration scheme (Impl-Ex) proposed in Ref. [42].  8 

The essence of the method is to solve explicitly for some variables, in the sense that the values at 9 

the beginning of the increment are presumed known, and implicitly for other group of variables. 10 

The distinguishing feature of this integration scheme is that the above mentioned group of explicit 11 



  

31 

 

 

 

 

variables are but extrapolated values of the same quantities computed at previous time steps by 1 

accomplishing a fully implicit integration.  2 

In the problem at hand, and following the guidelines provided by Ref. [42], the only variable 3 

that will be treated explicitly ---that is, that will be obtained by extrapolation from its implicit coun-4 

terparts computed at the previous time step ----  is the plastic multiplier. The rest of variables of the 5 

problems, such as the Kirchoff stress tensor, wil be treated implicitly. Accordingly, we write the 6 

plastic multiplier at the current time step as 7 

 n nn
n n

n n n

t

t t t

λ λ
λ λ

+ +
+

+

∆ ∆∆
≈ → ∆ = ∆

∆ ∆ ∆
1 1

1

1

�

 

(52) 

where n n nt t t+ +∆ = −1 1  and n n nt t t −∆ = − 1 . Substituting in equation (37) the discretized plastic mul-8 

tiplier given by equation (52), the expression for the deviatoric part of the Kirchhoff stress tensor 9 

given in equation (42) becomes 10 

 
  

trialdev devn n
n

τ τ
µ λ

+ +
+∆

=
+

1 1

1

1

1 2
  �

�
 

(53) 

Similarly, the expression of the elastic factor  nα +1  given in equation (43) becomes 11 

 
 n

nµ λ
α +

+∆
=

+
1

1

1

1 2 �
�

 

(54) 

The Impl-Ex scheme is summarized in Box 3.  As it is observed, it is necessary to take into ac-12 

count the computation of the slip rate λ∆ , given in equation (41), to fulfil the algorithm given in 13 

Box 3 for the following time step.  14 

Likewise, the calculation of the tensor nτ +1  given in Box 2 allows us to estimate the error that 15 

implies the integration of the model via the Impl-Ex scheme so that if: 16 

 n n tolτ τ+ +− >1 1�  (55) 

the new time step is modified according to newn nt tβ+ +∆ = ∆1 1 , where β < 1 . 17 

 18 

Given: ( ){ nϕ Ω , nτ , nt∆ , nt +∆ 1 , ( ):n nϕ+ Ω →u
2

1 � ,κ , µ , nλ∆ , }η , compute 



  

32 

 

 

 

 

trial elastic stresses 

n n+ += +∇u1 1f 1      

( )Tn n n− −+ + += + ⋅e 11 1 1
1

2
1 f f

 

 

trial :Tn n n n nτ τ e+ + + += ⋅ ⋅ +1 1 1 1f f c  
 

   
trialtr trn n n

n

p
t

τ e
η

+ + +
+

= +
∆

1 1 1

1

1

3
    

 

Extrapolate plastic multiplier, nλ +∆ 1�  
 

n
n n

n

t

t
λ λ

+
+

∆
∆ = ∆

∆
1

1
�  

 

Update Kirchhoff stress tensor, nτ +1 �  
 

 
trialdevn n n

n

pτ τ
µ λ

+ + +
+

= +
+ ∆

1 1 1

1

1

1 2
  �

�
1  

 

Compute error  

IF n n tolτ τ+ +− >1 1�  THEN  

        newn nt tβ+ +∆ = ∆1 1 , where β < 1  
 

  

Box 3. Explicit algorithm for the Impl-Ex integration scheme. 

Algorithmic tangent constitutive tensor 1 

The non-linear problem is solved using a traditional iterative Newton-Raphson procedure of the 2 

linearized system of equations.  Then, the linearization of the constitutive equation requires the 3 

computation of the algorithmic tangent constitutive tensor.  This tensor is defined following the 4 

standard procedure of computing all derivatives on the material (intermediate reference) configura-5 

tion followed by its expression in the spatial or current configuration, through the push-forward 6 

operator. 7 

The elasto-plastic tangent tensor epc relates the objective derivative of the stress tensor nτ +1 , 8 

with the objective derivative of the strain tensor ne +1 , reading as [44]: 9 

 ( ) ( )ep :v n v nL L+ +=τ e1 1c  
(56) 

The elasto-plastic constitutive tensor for equation (56), deduced by an implicit/explicit (Impl-10 

Ex) integration scheme, is expressed as 11 



  

33 

 

 

 

 

 
[ ] ( )( )

( )  

   
ep dev devˆ ˆtr

                 

n n n n n

np

τ τ eα α

κ

+ + + + +

+

⊗= − + + +

⊗ +−

1 1 1 1 1

1

2

3

2

c a c1

1 1

i

i  

(57) 

where  nα +1 is given by expression (54). 1 

Finally, for the numerical formulation with visco-plastic regularization, the algorithmic tangent 2 

tensor is expressed as 3 

 ( )vp trial epη η= + −1 c c c  
(58) 

where: 4 

 ( )trial n+= + e 1c c a  
(59) 

Full development of the algorithmic tangent tensor is given in Appendix A. 5 

 6 

3. Numerical validation of the model  7 

This section addresses the validation of the constitutive model proposed for the simulation of dense 8 

granular flows.  Any numerical simulation has to be validated through a proper comparison with 9 

analytical or experimental models.  Dense granular flows present a complex behavior that an ana-10 

lytical description is not suitable to capture – effects of bistability, thixotropy, jamming, among 11 

others; for this reason, the natural manner of the validation is through numerical modeling of exper-12 

imental tests.  Two main features give the complexity of choosing reliable experimental tests for 13 

granular materials: the reproducibility of the experiment and the kinematic phenomenon to repre-14 

sent – in this case dense granular flows. 15 

The first concept, reproducibility, is an inherent complexity of granular materials; their mechan-16 

ical response is constrained for the material properties like the degree of voids, the particle shape 17 

and size, and homogeneity of the material that could vary for a same granular media. This feature 18 

forces us to use experimental tests conducted for a large number of samples, where the reported 19 

average data defines properly the material response. The second condition refers to the kinematic 20 

response that is modeled on the experimental tests; it is essential to identify those experimental 21 



  

34 

 

 

 

 

models suitable to represent granular flows where there are recognizable stagnant and flow regions 1 

as well as their jamming transition. 2 

We validate the model through a comparison with the experimental results of the spreading of a 3 

granular mass on a horizontal plane reported in Ref. [1]; the experimental tests capture the kinemat-4 

ics of the media on different stages: the material at repose on its container, the spreading of it when 5 

it is released, and its deceleration until its stagnation.  6 

The numerical simulations are simplified in a two-dimensional axisymmetric model.  This as-7 

sumption is given straightforward from the experimental tests since the authors of Ref. [1] de-8 

scribed a full axisymmetric response on the material spreading. 9 

3.1. Scope and setup of the experimental tests 10 

The experiments carried out by Lajeunesse, et al. [1]  – which are the ones employed in the present 11 

work for validation purposes – have the aim of characterizing the slumping and spreading of the 12 

granular material from an initial configuration of confinement, being the gravitational forces the 13 

only perturbation exerted on the material. One of their objectives was to determine the influence of 14 

the material and several parameters like the massM , the initial aspect ratio a of the granular vol-15 

ume, the substrate roughness, and the bead size on the spreading of a granular mass as well as in its 16 

final disposition.  17 

The experimental setup consists of a cylinder of inner radius iR  resting on a horizontal plane 18 

wide enough to contain the spread of the granular material.  The tube was filled with a mass M  of 19 

glass beads of uniform size and shape ( µ= ±350 50d m ) and an averaged densityρ = 32500kg m .  20 

The filling procedure was standardized to ensure reproducible initial conditions; they poured the 21 

glass beads onto a sieve defining a homogeneous downfall of the material.  The height of the col-22 

umn ih  is defined according to the amount of material, which in turn, defines its initial aspect ratio 23 

=
i i

a H R . The scheme of the experimental setup is shown in Fig. 6. 24 



  

35 

 

 

 

 

The experimental procedure consists in releasing the cylinder pile by the quick removal of the 1 

container via a pulley system.  Once the material is released, it spreads on the horizontal surface 2 

due to gravitational forces until it comes to rest forming a final deposit.  Lajeunesse, et al. [1] de-3 

fines the time necessary to set the granular mass in motion as = 2m iT H g .  The time of removal 4 

for the cylinder rT has to be fast enough to reduce its influence on the flow pattern of the material; 5 

so that to achieve a proper procedure where the removal of the cylinder does not influence on the 6 

spreading rT  has to be small compared to m
T . 7 

The slumping and spreading of the granular pile was captured using a digital camera acquiring 8 

500 images per second. The camera was connected to a computer to capture and digitalize images 9 

at short intervals of time being capable to define the shapes of the bulk as it spreads.  Lajeunesse, et 10 

al. [1] reported that, as the granular mass spreads axisymmetric, the profiles reached by the materi-11 

al provide enough information to fully characterize its three-dimensional shape. 12 

 

Fig. 6. Scheme of the experimental setup [1]. 

Lajeunesse, et al. [1] concluded that the most relevant parameter that characterizes the spread-13 

ing and final deposit of the material is the initial aspect ratio a .  They identified that, depending on 14 

the initial aspect ratio, the spreading of the granular material has two distinct dynamical regimes 15 



  

36 

 

 

 

 

leading to three different deposit morphologies – which will be discussed further in the following 1 

sections.  2 

The procedure for the numerical validation was defining a calibration example to set the materi-3 

al and numerical parameters – for this case the experimental example with smaller initial aspect 4 

ratio was selected in order to dissipate the effects of abrupt changes in potential energy on the nu-5 

merical response. Once the model was calibrated, different experimental examples were selected to 6 

validate its transient and stationary response.   7 

3.2. Model calibration – deposit profile 8 

As mentioned above, the calibration of the parameters of the model is carried out using the experi-9 

mental test corresponding to the smaller initial aspect ratio. This test corresponds to an axisymmet-10 

ric model of a cylinder with initial aspect ratio of .a = 0 56 ; a sketch of the initial geometry is dis-11 

played in Fig. 7. 12 

H = 39.48 mm
i

R = 70.50 mmi

 

Fig. 7. Axisymmetric model for reference example with initial aspect ratio 
.a =0 56 . 

The constitutive model herein proposed for dense granular flows is characterized by four pa-13 

rameters, namely: the internal friction angle, the cohesion, and the visco-plastic and visco-elastic 14 

parameters. The cohesion coefficient is set to a very small positive constant, b Pa
−= 22 10 , to re-15 

flect the fact that the grains employed in the experiments are assumed cohesionless.   Regarding to 16 



  

37 

 

 

 

 

the visco-plastic coefficient Rτ , preliminary numerical tests show that transient behavior is accu-1 

rately replicated with a vanishing negligible coefficient (that is, the visco-plastic regularization in 2 

this test does not play a significant role).  As for the visco-elastic part, the dissipation constant is set 3 

to η κ−= 210  (the value computed in section 2.1.4 to eliminate oscillations in the volumetric pres-4 

sures).  5 

In all the examples, calibration and validation models, calculations have been run with a time-6 

step length  sect −∆ = × 41 10 ; the number of elements for each model are a function of the geome-7 

try of the model, remaining constant the element size .eh mm=1 5 . The modeling of the granular 8 

material/surface interaction was in terms of defining the same value for the internal friction angle 9 

and the wall friction angle; for the interaction with the cylinder’s wall it was defined as frictionless.   10 

One of the key points to perform these numerical simulations was the dynamical discretiation of 11 

the domain through the insertion and remotion of particles.  Fig. 8(a) shows the initial particle dis-12 

cretization of the domain into 1850 nodes defining 3200 elements. As it is observed in Fig. 8(b) 13 

and Fig. 8 (c) certain regions at the boundary – and more precisely at the outter part of the profile – 14 

there exist a conglomeration of particles that defines a finner mesh.  Furthermore, this discretiza-15 

tion allows us to perform a full simulation with a boundary constraint, required to diminish pres-16 

sure instabilities on these regions as explained in the previous section.  17 



  

38 

 

 

 

 

(a)

(b)

(c)

 

Fig. 8. Paricle discretization of the domain at different stages of the material 
spreading: (a) Initial configuration, material constrained, (b) evolution of the 
spreading, (c) final deposit profile. 

The calibration of the remaining parameter, the internal friction parameter b1 , is carried out by 1 

comparing the final deposit profile, obtained for varying values of this parameter, with the corre-2 

sponding experimental result.  Fig. 9 shows this comparison in terms of the normalized deposit 3 

profile for values of b1 ranging from 0.4 to 1.20.  4 

Observe that the material tends to fluidize for lower values of b1 . For   .b =1 0 40 , the “truncated 5 

cone” shape observed experimentally is not present – denoted by the red line in Fig. 9; one has to 6 



  

39 

 

 

 

 

increase the internal friction parameter over 0.65 to reproduce this typical shape.  For the maximum 1 

value used, .b =1 1 20 , the deposit profile shows, as expected, the wider region of material undis-2 

turbed; presenting material crumbling approximately at half the radius of the cylinder. 3 

Maximum resemblance between numerical and experimental profiles is achieved at .b =1 0 75  4 

(the equivalent internal friction angle in a Mohr-Coulomb model is . oφ=23474 , a value that lies 5 

between the values reported by Lajeunesse, et al. [1] for the repose angle and the avalanche angle, 6 

o
rθ ≈21  and 

o
aθ ≈29  respectively).  7 

It should be remarked that the match is almost perfect except at the outer portion of the deposit. 8 

This deviation may be explained by the fact that, at this region, the grains are too loose to be col-9 

lectively represented as a continuum medium.  10 

0 0.5 1 1.5 2 2.5
0

0.1

0.2

0.3

0.4

0.5

0.6

r/Ri

h/
R

i

experimental
b  = 0.40

1

b  = 0.65
1

b  = 0.75
1

b  = 0.85
1

b  = 1.20
1

 

Fig. 9. Final (normalized) deposit profile for varying values of the internal 
friction parameter. Comparison with the experimental result reported by 
Lajeunesse, et al. [1]. 

A striking conclusion of the experimental study conducted by Lajeunesse, et al. [1] is that the 11 

shape of the final deposit is practically independent of the rigid/erodible nature of the rough 12 

ground;  according to Lajeunesse, et al, the final shape should only depend on the initial aspect 13 

ratio  (at least for the range of  values studied in their work).   14 



  

40 

 

 

 

 

To check whether the numerical model is consistent with this observation, in Fig. 10, the final 1 

profiles predicted by the model for varying values of the wall friction parameter at the interface 2 

domain are compared. 3 

It is readily seen that, indeed, the model does capture the experimental behavior in this respect, 4 

since variations of the wall friction parameter does not induce significant changes of the final shape 5 

of the deposit – only a slight deviation concerning the invariance of the final deposit profile is de-6 

tected at .µ= 0 13 . The invariance, with respect the wall friction angle, ceases as this friction tends 7 

to be null, see Fig. 10 for a value .µ= 0 03 .  The deaceleration of the material to its stagnation is 8 

given due to its internal friction coefficient.   9 

r/Ri

h
/R

i

0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2
0

0.1

0.2

0.3

0.4

0.5

0.6
experimental

µ = 0.13
µ = 0.33
µ = 0.50

2.2 2.4 2.6

µ = 0.03

 

Fig. 10. Deposit profiles obtained varying the wall friction coefficient µ  of 
the contact interface. 

3.3. Model validation – deposit profiles 10 

The validation of the numerical model is carried out using two sets of examples. The first set corre-11 

sponds to the comparison of deposit profile for two experimental examples of larger initial aspect 12 

ratios. The second set has the aim of further corroborating the conclusion made in Ref. [1] regard-13 

ing their statement, indicating that the deposit profile is only a function of the initial aspect ratio of 14 

the granular pile, being negligible the influence of the mass pile on the morphology – it will com-15 

pared with the normalized deposit profiles shown in Fig. 15(a).  16 



  

41 

 

 

 

 

The geometries of the axisymmetric models of the first set of examles are shown in Fig. 11.  1 

The first initial aspect ratio .a =0 80  corresponds to the first dynamic regime discussed in Ref. [1] – 2 

a flow front that develops at the bottom of the pile and crumbles through an avalanche, presenting a 3 

cone shape type final deposit morphology. The second initial aspect ratio .a =5 40  belongs to the 4 

second dynamical regime; its final deposit profile corresponds to a Mexican hat shape type as de-5 

scribed in the commented reference. 6 

The validation process consists in comparing both examples using the same internal friction ma-7 

terial obtained earlier by the calibration example .b =1 0 75  – it is emphasized that all material and 8 

numerical parameters are kept the same as well as the model conditions. 9 

R = 70.50 mmi

H = 56.40 mmi

R = 28.0 mmi

H = 151.2 mmi

(a) (b)

 

Fig. 11. Axisymmetric models used for model validation: (a) Regime 1, 
.a =0 80; (b) Regime 2, .a =5 40 . 

  In Fig. 12 the experimental and numerical final profiles, corresponding to the first initial aspect 10 

ratio 0.80a= , are depicted. To better appreciate the evolution of the pile, the initial configuration 11 

is also displayed – blue crosses.  Observe that, except at the outer part – in which as previously 12 

pointed out, the grains becomes too loose as to be modeled as a continuum medium – the deposit 13 

profile predicted by the numerical model runs above, and approximately parallel, to the one ob-14 

served experimentally. On average, discrepancies in height are less than 10%.  15 



  

42 

 

 

 

 

0 0.5 1 1.5 2 2.5
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

r/Ri

h
/R

i

original configuration
PFEM - b  = 0.751

experimental

 

Fig. 12. Validation of the numerical model for a cylinder pile with an initial 
aspect ratio .a =0 80. 

 Fig. 13 contains the profiles corresponding to the initial aspect ratio 5.40a= . Remarkably, in 1 

this case, the deposit profiles of the experimental and numerical models exhibit an excellent 2 

agreement, even at the concave slopes of the free surfaces that defines the Mexican hat shape; the 3 

only deviations are observed, as in the previous cases, at the outer region.   4 

 5 



  

43 

 

 

 

 

0 1 2 3 4 5 6
0

1

2

3

4

5

6

r/Ri

h
/R

i

original configuration

PFEM - b  = 0.751

experimental

 

Fig. 13. Validation of the numerical model for a cylinder pile with an initial 
aspect ratio .a =5 40 . 

Even though the scope in this section is not the study of the transient response of the granular 1 

spreading, for completeness, in Fig. 14, the evolution during the spreading process, of the experi-2 

mentally recorded profiles (left column) along with the predictions furnished by the numerical 3 

model (right column) is compared.  4 

Fig. 14(a) and (b) correspond to initial aspect ratios of 0.56a=  and 0.8a= , respectively 5 

(first dynamical regime of spreading). Computed profiles in these two cases bear close similarity to 6 

those monitored experimentally. In the third case – the one corresponding to the slender column, 7 

see Fig. 14(c) –  the similarity is not so marked:   in the computed results, the upper portion of the 8 

column maintains its initial shape during most of the process,  while in the  profiles reported in Ref. 9 

[1] ,  the column seems to widen as its top surface descends.  A glance at the sequence of images 10 



  

44 

 

 

 

 

shown in the following section, see Fig. 22(a), may aid in disclosing the actual origin of these dis-1 

crepancies. Indeed, observe that, upon removal of the container ( 0.182 sect = ), the outer layer of 2 

particles detach from the bulk mass due to some friction presented during the removal of the cylin-3 

der. Such detachment is an inherently discontinuous phenomenon, and therefore, not amenable to 4 

continuum modeling; hence the discrepancies between observed and computed results. Neverthe-5 

less, it should be noted that the influence of these discrepancies on the predictions of the final pro-6 

file is practically negligible (since it is considered the discrepancy on the outer layer of particles), 7 

for both computed and experimental graphs are practically coincident, as previously seen in Fig. 8 

13. 9 

0.0
-2 -1.5 -1 -0.5 0 0.5 1 1.5 2

0.1

0.2

0.3

0.4

0.5

0.6

r/Ri

h
/R

i

-3 -2 -1 0 1 2

0.2

0.4

0.6

0.8

r/Ri

h
/R

i

0.0

-6 -4 -2 0 2 4
0

2

3

4

5

6

r/Ri

h
/R

i

1

(a)

(b)

(c)

experimental PFEM

 

Fig. 14. Comparison of the evolution of experimental [1] and numerical 
profiles corresponding  to (a) initial aspect ratio .a = 0 56 ; (b) initial aspect 
ratio .a = 0 8 ; and (c) initial aspect ratio .a = 5 4 . 

The second set of examples for the model validation is used to corroborate the statement of 10 

Lajeunesse, et al [1] acording that deposit profiles are only a function of the initial aspect ratio of 11 

the granular pile and not of its mass. In Ref. [1], Lajeunesse, et al. report that, independently of the 12 

mass, a set of cylinders with the same initial aspect ratios but different dimensions will exhibit 13 



  

45 

 

 

 

 

similar normalized deposit profiles.  To check whether the numerical model also captures this be-1 

havior, we launch several analyzes with varying initial dimensions.   Table 1 shows the employed 2 

initial aspect ratios described in Ref. [1], one corresponding for each of the deposit morphologies,  3 

and the dimension of its radius. 4 

Tag a  ( )iR mm  

A1 0.41 40 

A2 0.41 28 

B1 1.95 40 

B2 1.95 28 

C1 6.2 28 

C2 6.2 13 

Table 1. Set of geometries for diverse initial aspect ratios for analysis of the 
deposit profiles. 

In Fig. 15(b), numerical results obtained for each pair of initial aspect ratios (blue and black 5 

cross marks for the first and second geometry respectively) are compared with the corresponding 6 

experimental normalized deposit profiles (continuous red line). 7 

In the first two cases, Figures Fig. 15(b.1) and (b.2), the computed profiles are practically 8 

indistinguishable.  For both cases, the crumbling of the material spreads from the outher regin 9 

through the center of the pile; a difference for the second initial aspect ratio, is that for both the 10 

experimental and numerical profiles, a curvature on the profile is given, instead of a straight slope 11 

present for the smaller value.  This morphology, that is more characteristic of the second dynamical 12 

regime, is given since the initial aspect ratio 1.95a =  is closer to the limit between the first and 13 

second dinamical regime ( 3a ≤ ) than the limit between the first and second deposit morphology (14 

0.74a> ). 15 

In the third case, Fig. 15(b.3), differences are observed at the peak of the Mexican hat profile, 16 

and at the outer regions – as pointed out earlier, discrepancies at the outer regions are due to the 17 



  

46 

 

 

 

 

model’s inability to represent the detachment of grains at the flow front.  However, these deviations 1 

are not very pronounced (less than 7% at the peak). It may be concluded, thus, that numerical 2 

predictions are in accordance with the experimentally observed in Ref. [1] about the independence 3 

of the scaled profiles to the volume of released material.  4 

- 2 - 1. 5 - 1 - 0. 5 0 0. 5 1 1. 5
0

0. 1

0. 2

0. 3

0. 4

0. 5

(b.1 )

experimental
example: A1
example: A2

h/
R

i

r/R
i

(b.2 )

experimental
example: B1
example: B2

0. 6

1. 0

0. 8

0. 4

0. 2

0

0- 2- 3- 4 - 1 1 2 3

h
/R

i

r/Ri

- 6 - 4 - 2 0 2 4
0

0.2

0.4

0.6

0.8

1

(b.3 )
experimental
example: C1
example: C2

h
/R

i

r/R
i

(a .1 )

(a .2)

(a .3)

 

Fig. 15. First column: Deposit profiles normalized to the tube radius for 
three different initial aspect ratios, varying geometries: (a.1) .a =0 41 . Plain 
line: M = 135 g, iR = 40mm. Dotted line: M = 50 g, iR = 28 mm.  Plain 

line with circles: M = 50 g, iR = 28mm.  (a.2) .a =1 95 . Plain line: 
M = 600 g, iR = 40mm. Dotted line: M = 200 g, iR = 28mm.  Plain line 

with circles: M = 50 g, iR = 40mm. (a.3) .a =6 20 . Plain line: M =675g, 

iR = 28 mm. Dotted line: M =75g, iR = 13mm.  Plain line with circles: 

M = 80 g, iR = 13mm [1]. Second column: Comparison of the deposit 
profiles for pairs of initial aspect ratios with different dimensions:  (b.1) 
initial aspect ratio .a = 0 41 , (b.2) initial aspect ratio .a = 1 95 , and (b.3) 
initial aspect ratio .a = 6 2 . 

Lajeunesse, et al. [1] devised an experimental procedure  that permits the visualization of  the 5 

internal structure of the granular material in its final state. In this experiment, a cylinder is filled 6 

with the same glass beads, painted accordingly to differentiate seven alternating layers of red and 7 

white particles. The cylinder pile has an initial aspect ratio .a =1 00  with a radius and height8 

.  R H mm= = 70 5 . After spreading, the granular deposit is symmetrically split into two parts by 9 



  

47 

 

 

 

 

means of a thin glass; then, one of the halves is removed so as to observe the final distribution of 1 

layers, Fig. 16(a). The dotted line indicates the boundary of the stagnant zone (i.e. the region inside 2 

which flow has not taken place).  Lajeunesse, et al. [1] determined that, for this particular initial 3 

aspect ratio ( .a =1 00 ), the stagnant zone is approximately a circular cone with radius equal to the 4 

base radius of the initial cylinder pile.  5 

In order to assess the ability of the proposed numerical model to replicate internal flow patterns, 6 

a simulation of the spreading of the cylinder pile described above is carried out. The final 7 

configuraiton of the pile is shown in Fig. 16(b); to facilitate the comparison with the experiment, 8 

the lines defining the experimentally measured stagnant zone (circular cone of radius .  R mm=70 5 ) 9 

are also plotted in Fig. 16(b).  10 

Inspection of Fig. 16(b) clearly indicates that the spreading of material was localized at the out-11 

er zones, close to the free surface, where particles can move easily compared to those within the 12 

core of the deposit.  The region enclosed by the plotted lines remains practically undisturbed; this 13 

fact is in qualitative agreement with experimental observations, see Fig. 16(a). Another interesting 14 

feature that can be gleaned from Fig. 16(b) (and that it is also consistent with experimental obser-15 

vations given in [1]) is that granular motion occurs in such a way that top layers slide over layers 16 

beneath with no apparent intermix between them. 17 



  

48 

 

 

 

 

0

10

20

30

40

50

z
 (
m

m
)

0 50-50

r (mm)

0

r (mm)

0

10

20

30

40

50

z 
(m

m
)

-75 -50 -25 25 50 75

2R
i

(a)

(b)

 

Fig. 16. Comparison of internal structure of the deposit: (a) Experimental 
response [1], (b) Numerical solution.  

3.4. Transient flow 1 

We focus now on the validation of the model’s performance in the transient regime. The validation 2 

is carried out by comparing the evolution, upon removal of the confining tube, of experimentally 3 

recorded and computed pile profiles. Intuitively, it is reasonable to expect that the speed at which 4 

the tube is lifted affects, to a greater or lesser extent, the velocity at which the granular pile spreads 5 

afterward.  Thus, a proper assessment of the model’s ability to describe the transient response re-6 

quires accurate data of the tube lifting speed.  Unfortunately, information in Ref. [1] concerning 7 

this aspect of the experiment is quite vague and somehow inconsistent.  Indeed, Lajeunesse et al. 8 

[1] limit themselves to point out that the lifting speed is “of the order” of 1.6 /rv m s≈ ;  however, 9 

this speed is not consistent with the time labels accompanying the sequence of snapshots of the 10 

figures mentioned above. 11 



  

49 

 

 

 

 

For instance, in the case of the cylinder with initial aspect ratio 0.56a=  (and initial radius 1 

70.5mmiR = ), the release time corresponding to 1.6 /rv m s=  is, assuming constant speed,  2 

/ 0.024secr i rT aR v= = , while in the sequence of images displayed in Fig. 18(a), this time can 3 

be estimated, by interpolation between the time labels of the second and third snapshots, at  4 

0.179 secrT ≈ . 5 

To shed light on this apparent inconsistency, we have carried out numerical simulations of the 6 

spreading process for lifting speeds rv ranging from 0.1 to 1 m/s. In Fig. 17, we show (for the case 7 

of this initial aspect ratio, 0.56a= ) the plot of the computed position ( )fr t of the foot of the 8 

spreading pile versus time, together with the pertinent experimental data – obtained, in turn, from 9 

Fig. 18(a). The speed 0.220 m/srv =  (green line) corresponds to the speed calculated from the 10 

aforementioned “guessed” release time 0.179 secrT = . 11 

Results displayed in Fig. 17 conform to intuitive expectations:  the faster the tube is removed, 12 

the greater the rate of spread of the collapsing column front (and therefore, the sooner the station-13 

ary state is achieved).  These results also provide a definite clue to resolve the controversy concern-14 

ing the actual lifting speed employed in the experiments by Lajeunesse, et al. [1]: the curve corre-15 

sponding to the “guessed” lifting speed 0.220 m/srv =   is the one that bests fits experimental 16 

values.  By contrast,  the graph with 1.0m/srv =  (the one closer to the estimation suggested by  17 

Lajeunesse, et al. [1], 1.6m/srv = ) overpredicts the average spread rate in almost 100%.  18 



  

50 

 

 

 

 

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7

80

90

100

110

120

130

t (sec)

r 
(m

m
)

f

experimental

v  = 1.00000 m/s
c

v  = 0.50000 m/s
c

v  = 0.22065 m/sc

v  = 0.10000 m/s
c

 

Fig. 17. Position ( )fr t .of the foot of the spreading granular pile for different 

rv . Initial aspect ratio .a=056. 

Pile profiles computed, using the seemingly correct lifting speed 0.220 m/srv = , are com-1 

pared with their corresponding experimental images in Fig. 18. The image sequences show how the 2 

sides of the initial column of granular material crumble through an avalanche while at the center of 3 

bulk, the material does not spread completely, leaving a central undisturbed region and creating a 4 

truncated cone deposit. 5 



  

51 

 

 

 

 

(a) (b)

 

Fig. 18. Comparison of sequences of profiles for an initial aspect ratio 
.a=0 56: (a) experimental [1], (b) PFEM. 

The analysis under varying lifting speed, described above, is repeated for the column of initial 1 

aspect ratio 0.8a= .  Fig. 19 plots the position of the foot of the pile versus time for this case. The 2 

release speed, 0.258 rv m s= , is the speed estimated from the relative location of the tube in the 3 

first and second snapshots in Fig. 20(a).  4 

Similarly, to the situation encountered in the previous case, the curve corresponding to this 5 

“guessed” speed (green line) is the one that best fits experimental values (notably, the curve passes 6 

through four of the five experimentally measured points).  The time to let the mass in motion corre-7 



  

52 

 

 

 

 

sponding to this initial aspect ratio is 0.107secmT = , which presents a higher value than the time 1 

for the cylinder removal r mT T> , doubling the value similar than for the previous example. 2 

0 0.1 0.2 0.3 0.4 0.5

80

90

100

110

120

130

140

150

160

experimental

v  = 1.00000 m/sc
v  = 0.40000 m/s

c

v  = 0.25788 m/s
c

v  = 0.10000 m/sc

r 
(m

m
)

f

t (sec)

 

Fig. 19. Position ( )fr t of the foot of the spreading granular pile for differ-

ent rv . Initial aspect ratio .a=0 80 . 

On the other hand, Fig. 20 provides the comparison of the evolution of computed and experi-3 

mentally recorded pile profiles for this tube lifting speed.  The agreement (both quantitative and 4 

qualitatively) is also remarkable even with the assumption of a constant velocity. 5 



  

53 

 

 

 

 

(a) (b)

 

Fig. 20. Comparison of sequences of profiles for an initial aspect ratio 
.a=0 80: (a) experimental [1], (b) PFEM. 

Lastly, we show in Fig. 21 the evolution of the foot of the pile of initial aspect ratio 8.94a=  1 

versus time for different tube lifting speeds. Using the same procedure as before, we get a lifting 2 

speed of 1.29 /rv m s≈  – indeed, it can be appreciated in Fig. 22(a) that in the second snapshot, 3 

time 0.062 sec. the tube has travelled approximately 32% of the initial height; therefoe, we have  4 

. / . . / . . /r iv a R t m s
−= ⋅ ⋅ = ⋅ ⋅ ⋅ ≈3032 032 894 28 10 0062 129 . As in the previous cases, the curve corre-5 

sponding to this speed (black line) matches closely the experimental points.  It is interesting to note 6 



  

54 

 

 

 

 

that the influence of the release velocity on the spreading velocity in this case is comparatively less 1 

pronounced than in the previously shown graphs for the thicker columns (Fig. 17 and Fig. 19). 2 

0 0.1 0.2 0.3 0.4 0.5

40

60

80

100

120

140

160

180

200

220

experimental

v  = 2.00000 m/s
c

v  = 1.29654 m/s
c

v  = 0.61390 m/s
c

v  = 0.49449 m/s
c

r 
(m

m
)

f

t (sec)

20

 

Fig. 21. Position ( )fr t of the foot of the spreading granular pile for different

rv . Initial aspect ratio. .a=8 94 .  

 Fig. 22 compares the experimental and numerical snapshots for this initial aspect ratio while 3 

spreading.  The second dynamic regime is readily perceptible: the spreading of the material devel-4 

ops a flow front at the bottom of the cylinder pile in a small region, shown in the first three snap-5 

shots; by contrast, the upper part of the column keeps its shape while descending – considered as a 6 

free falling rigid body, so to speak.   7 

The kinematics that represents this dynamic regime explains why, for this geometry or initial 8 

aspect ratio, the curves given in Fig. 21 show a narrow distribution of the position of the foot of the 9 

spreading during the process. Since the material crumble takes place at the bottom of the pile, the 10 

material on the upper levels tend to fall as a rigid body and the confinement that are subject to does 11 

not play a significant role.   12 

Another worthy aspect that deserves notice from these snapshots is the cloud of diffuse granular 13 

points. As earlier explained, this cloud appear because of the abrupt release that takes contact with 14 

the container; in the third frame it is clearly identified loosen particles due to the wall friction.  As 15 



  

55 

 

 

 

 

mentioned earlier, the impact of such cloud of points is negligible in the final configuration of the 1 

deposit.  2 

(a) (b)

 



  

56 

 

 

 

 

Fig. 22. Comparison of sequences of profiles for an initial aspect ratio 
.a=8 94: (a) experimental1 [1], (b) PFEM. 

3.5. Mechanical behavior while spreading 1 

In order to gain further insight into the different flow regimes occurring depending on the initial 2 

aspect ratio of the collapsing column, we examine next the evolution of contour plots of the elastic 3 

factor   1nα +�  defined in equation (54).  4 

The usefulness of these plots lies in that they convey at a glance – without the need to scrutinize 5 

velocity fields or other kinematic variables – qualitative information regarding the state of motion 6 

of the granular material at each time step. Indeed, recall that this variable indicates the phenomeno-7 

logical events that occur at each point of the material. Regions undergoing purely elastic defor-8 

mations (stagnant zones) are characterized by  1=1.0nα +� , whereas zones at which fully plastic 9 

flow is present are associated to values close to  1=0.0nα +� . Finally, regions at which the transition 10 

from fully developed flow to static condition takes place (jamming zones) are identified by values 11 

between these two extremes. 12 

Fig. 23 depicts the evolution of the elastic factor for the three initial aspect ratios used to vali-13 

date the transient regime.  Time is normalized with respect the full time needed to reach their re-14 

spective final deposit profile T ∗ . Fig. 23(a) and Fig. 23(b) corresponds to piles with initial aspect 15 

 

                                                      

 

 

1 The initial aspect ratio given by the authors for Fig. 22(a), = 5.4a , does not correspond to the initial aspect ratio of the se-

quences shown in the figure, = 8.94a .  The reported series of successive profiles correspond to the lower value ( = 5.4a ), which 

are used for the model validation given in Fig. 14(c).  The sequence of images of Fig. 22(a) is used to validate the transient response of 

the model, using the higher value of the initial aspect ratio ( = 8.94a ). 



  

57 

 

 

 

 

ratios 0.56a=  and 0.8a= , respectively. The key qualitative features reported in the experi-1 

mental work by Lajeunesse, et al. [1] can be readily observed in these sequences of plots – the 2 

margins of the pile crumble through an avalanche, and the flow front propagates then outward. In 3 

the first case ( 0.56a= ), Fig. 23(a), it can be easily discern how the free upper surface divides 4 

into an inner, static region (  1=1.0nα +� ) and an outer flowing region (  1=0.0nα +� ). On the other 5 

hand, in the second case, Fig. 23(b), the distribution of this variable reveals that the entire outer 6 

surface starts to flow immediately (no static, outer regions are observed in the second contour plot).    7 

Once the material stops flowing, all zones tend to the static condition (  1=1.0nα +� ), as can be seen 8 

in the last row of plots. 9 

Lastly, in Fig. 23(c), the contour plots corresponding to the third aspect ratio are displayed. The 10 

portrayal of undeformed and flowing regions provided by these plots is reasonably in accord with 11 

the previously outlined experimental observations by Lajeunesse, et al. [1] (second dynamical re-12 

gime). Indeed, the distribution of variable α�  in the second snapshot clearly indicates that the upper 13 

part of the column remains practically unaltered (  1=1.0nα +�  in the, approximately, upper half re-14 

gion) during the initial stages of the collapse, while, simultaneously, a flow front develops at the 15 

base of the column. 16 



  

58 

 

 

 

 

(a) (b) (c)

t = 0

t = T*/4

t = T*/2

t = 3T*/2

t = T*

0.0 1.0

α

 

Fig. 23. Evolution of the elastic factor ( )1nα λ+ ∆�  while spreading a granu-
lar pile for three different initial aspect ratios: (a) .a=0 56 ,  (b) .a=0 80 , 
and (c) .a=8 94 . 

Through the set of numerical examples given above it could be studied the correlation between 1 

the initial aspect ratio and the run-out distance of the spreading of the column of granular material.  2 

Fig. 24(a). shows the experimental and numerical values of the normalized radius of the deposit, 3 

fR , measured for different initial aspect ratios.  From the curve, it is detected a smooth relation 4 



  

59 

 

 

 

 

between these two parameters – as the initial aspect ratio increases the slope of the curve diminish-1 

es slightly.  These results could be extrapolated to different scenarios, as debris phenomena, where 2 

it is necessary to predict this distance. 3 

Lajeunesse, et al., in Ref. [1], established expressions for the measuring of the radius of the de-4 

posit profile for two different dynamic regimes.  The first expression is for those initial aspect rati-5 

os smaller than the limit value of the first deposit morphology .a<074 ; the normalized expression 6 

is given by 7 

 
f

r
i r

R a
a

R
µ

µ

  = + −   

2

2
1

4
2 3

 

(60) 

where tanr rµ θ= .  The second expression, for values larger than this limit reads as 8 

 
.

f

i

R a

R
=

3

0 74  

(61) 

As it is observed, equation (60) and (61) are not necessarly continuos for .a=0 74  as given in 9 

Fig. 24(b). The radii of the deposit profiles are compared with the analytical expression in a Log 10 

base.  It is observed that numerical results show a well agreement with the expression accordingly 11 

to the initial aspect ratio of the pile. 12 



  

60 

 

 

 

 

0 1 2 3 4 5 6 7 8 9
1

2

3

4

5

6

7

8

Initial aspect ratio (a=Hi/Ri)

R
f/

R
i

numerical
experimental

10
-1

10
0

10
1

10
0

10
1

Initial aspect ratio ( a = Hi/Ri)

R
f/
R

i

(a)

(b)

numerical
analytical

 

Fig. 24. (a) Run-out normalized distance of the spreading as a function of 
the initial aspect ratio a. (b) Comparison of numerical normalized radio of 
the deposit profile and analytical expression. 

    1 

4. Concluding remarks 2 

The assumption of modeling cohesionless dense granular flows through a continuum approach has 3 

been proved appropriate as long as the domain under study is larger enough than the particle size as 4 

seen in the sets of examples of the spreading of the granular material. Due to the presence of large 5 

displacements and deformations of the material, it was necessary to define an algorithm, robust 6 

enough, to perform these simulations. The implementation of the Impl-Ex sheme for the numerical 7 

integration of the model increased the robustness compared with a typical implicit integration 8 



  

61 

 

 

 

 

scheme and the continuous particle discretization of the domain allows us to contro the mesh ho-1 

mogeneity necessary and the definition of the boundary through a boundary constraint. 2 

 As mentioned in previous sections, the impact of the definition of a von Mises type model as 3 

regularization for tensile stress states is minimal since the model is for cohesionless dense granular 4 

flows. In the case of the examples corresponding to the spreading of a granular media on a horizon-5 

tal plane, as it was expected, the percentage of material on stress states with positive pressures re-6 

mained at low levels (around 0.4%) and only for the case with the larger initial aspect ratio, .a = 6 27 

, this percentage increased up to 1.735%, see Table 2. 8 

Ex-

ample 

( ) totV p V> ×0 100

 

Sprea

ding 

0.418 

Sprea

ding 

0.402 

Sprea

ding 

1.735 

Table 2.  Percentage of total volume in a stress state with positive pressures of representative examples presented in this 9 

document. 10 

From these examples, it is concluded that the regularization of the apex of the Drucker-Prager 11 

yield surface with an extension of a von Mises model (which, recall, was introduced to increase the 12 

robustness of the integration scheme) does not have a significant impact on the physical consis-13 

tency of numerical predictions due to the small amount of material undergoing tensile stresses. 14 

The experimental test reported in Ref. [1] shown to be a proper manner to calibrate and validate 15 

our numerical model.  It has been shown that the numerical model proposed in this work is able to 16 

capture two fundamental observations reported in the experimental tests in Ref. [1]. First, that the 17 

deposit profile is independent of the mass M, being only a function of the initial aspect ratio a; and 18 

second, that the interaction with the substrat does not affect the behavior of the collapsing pile (it 19 

only affects for very large initial aspect ratios). 20 



  

62 

 

 

 

 

A discrepancy with the tests is that of the velocity for the removal of the cylinder. The authors 1 

in Ref. [1] stated that the removal of the cylinder is given in a period of time smaller than the criti-2 

cal time – measured in terms of the cylinder pile height.  Yet, it was found, via numerical simula-3 

tions, that the removal of the cylinder actually takes longer than this crital time.  It was also ob-4 

served that, although the velocity of removal affects ithe transient response, its influence of the 5 

final shape of the deposit profile is negligible. 6 

Numerical simulations allowed us to understand more in depth the inner mechanisms that are 7 

present during the flow of granular materials. Using the elastic factor α� , it was possible to discern 8 

which regions are in the elastic regime and which undergo plastic deformations (flow zones). 9 

The oscillations given on the pressures and vertical stresses, measured at the bottom of confined 10 

material, presented a barely perceptible dissipation along time.  The visco-elastic regularization, 11 

based on a Kelvin-Voigt model, succeed in dissipating the spurious oscillations due to dynamic 12 

effect. 13 

Acknowledgement 14 

The research leading to these results has received funding from the European Research Council 15 

under the European Union's Seventh Framework Programme (FP/2007-2013) / ERC Grant Agree-16 

ment n. 320815, Advanced Grant Project COMP-DES-MAT. 17 

 18 

Appendix A – Algorithmic tangent constitutive tensor 19 

This section covers the formulation of the algorithmic tensor arising from the linearization of the 20 

constitutive equation.  It is presented following the order in which the constitutive model was de-21 

fined: first, for the elasto-plastic model (implicit and Impl-Ex schemes), and then, the contribution 22 

of the visco-plastic regularization. 23 

The problem to solve is to find epn+1c  that satisfies the Lie derivative of the Kirchhoff stress ten-24 

sor. 25 



  

63 

 

 

 

 

 ep
v v:n nnL L+ ++=τ e1 11c  

(A.1) 

Recalling equation (42), the integration of the Kirchhoff stress tensor is given by the following 1 

expression 2 

 
  

trialdevn n npα+ + += +τ τ1 1 1 1  
(A.2) 

where: 3 

 
( ) :

µ
α α λ

λ
∆

∆
= =

+

1

1 2  

(A.3) 

Substituting the definition of the auxiliary state trialn+τ 1 , given by equation (30), and the pressure 4 

term of equation (21), the equation (A.2) reads: 5 

 ( ) ˆdev dev :n n n npτ τ eα α+ + + += + +1 1 1 11c  (A.4) 

where: 6 

 ˆ Tn n n+ += ⋅ ⋅τ τ1 1n+1f f  
(A.5) 

Equation (A.5) is the description, in the current configuration, of the Kirchhoff stress tensor of 7 

the intermediate reference configuration, carried out by the push-forward operation. 8 

From a computational point of view, the calculation of pn+1  has been proven more convenient 9 

by the following expresion 10 

 ln
n

J
p

J
κ+ =1

 

(A.6) 

The pressure term is provided from a hyperelastic deduction of the pressure for a compressible 11 

material which only depends of the computations in the current configuration while the given in 12 

equation (21) requires the value of τ  from previous intermediate configuration.  13 

In the sections below, the algorithm for an Impl-Ex and full implicit scheme are presented in or-14 

der to gain a complete understanding of both models – the implementation for this work follows the 15 

implicit-explicit method. 16 

 17 



  

64 

 

 

 

 

Impl-Ex integration of the constitutive model 1 

The Impl-Ex integration scheme is based on the full implicit integration of the stress tensor but 2 

combining an explicit extrapolation of the internal variables – the plastic multiplier nλ +∆ 1 , given in 3 

equation (52).  4 

The Lie derivative for the Kirchhoff stress tensor defined in equation (A.1), following the Impl-5 

Ex integration scheme, is computed “freezing” the plastic parameter ( )nα λ +∆ 1 , in equation (A.3), 6 

on the current time step. The derivative of the stress field with respect the Almansi strain tensor is 7 

summarized as: 8 

 ( ) ( ) ( )( )
( ) ( ) ( )

   v v v

v v

ˆdev dev :

                                          ln ln
n n n

n n

L L L

L J J L

α α

κ κ
+ + +

+ +

= +

+ +

τ τ e1 1 1

1 11 1

c

 

(A.7) 

Below is shown the process for computing the derivative for each term given in equation (A.7) 9 

separately.  10 

• 
( ) v ˆdev nL α +τ 1  11 

The pull-back operation is performed over the definition of a deviatoric tensor 12 

 
( ) ( ) ˆ ˆ ˆdev :n n nφ α φ α

− −
∗ + ∗ + +

  = −     
τ τ τ

1 1

1 1 1

1

3
 1 1

 

(A.8) 

Calculating the corresponding operations for the covariant and contravariant tensors, the equa-13 

tion above reads 14 

 
( ) ( ) ˆdev :n n nφ α α

− −
∗ +

 
= − 

  
τ τ C τ C1 11

1

3
 

 

(A.9) 

It is observed that the pull-back operation computed in equation (A.9) describes the deviatoric 15 

part of the Kirchhoff stress tensor nτ  in the intermediate reference configuration nt . 16 

 ( ) ˆdev DEVn nφ α α
−
∗ + =τ τ
1

1    
(A.10) 

Computing the directional derivative with respect ∆u for the equation above 17 



  

65 

 

 

 

 

 
( ) ( ) ( )DEV d : : dn n n

ϕ

α α
ϕ

− −

=

∂
 = − + ∂

τ C τ C C τ C1 1

0

1

3
 

(A.11) 

The derivative for the right Cauchy-Green tensor C  is deduced through the definition of the 1 

spatial velocity gradient l , and the definition of the material Green-Lagrange strain rate tensor, E�2 

[43]. After some manipulation, it is easily deduced that:  3 

 d d=C E2  (A.12) 

The derivative of the inverse of the right Cauchy-Green tensor is computed using the identity 4 

definition of the tensor, − ⋅ =C C I1 ; applying the chain rule and substituting definition given in 5 

equation (A.12), its derivative reads:  6 

 d d d− − − − −=− ⋅ ⋅ =− ⋅ ⋅C C C C C E C1 1 1 1 12  (A.13) 

Finally, equations (A.12) and (A.13) are substituted into equation (A.11) - expressing the deriv-7 

ative of the deviatoric part of the stress tensor in the material configuration. 8 

 
( ) ( ) ( )d DEV : d d :n n nα α

− − − = ⋅ ⋅ − τ C τ C E C E τ C
1 1 1

2

3  

(A.14) 

In order to express equation (A.14) in its spatial description, the pull-forward operation is ap-9 

plied, leading to 10 

 
( )[ ] ( ) ( )[ ]ˆ ˆd DEV : d d :n n n n nφ α α∗ + + + += −τ τ e e τ1 1 1 1

2

3
1 1

 

(A.15) 

After some manipulation, equation (A.15) reads 11 

 
( ) [ ]  v ˆ ˆ ˆdev tr : dn n n nL α α+ + + +⊗= −τ τ τ e1 1 1 1

2

3
 1i

 

(A.16) 

• 
( )( )v :dev nL α +e 1 c  12 

The second term of equation (A.7) is rewritten by applying the definition of the elastic constitu-13 

tive tensor, c  given in equation (5).  After some manipulation, this fourth order tensor is expressed 14 

in terms of the shear and bulk modulus, G and κ  respectively. 15 



  

66 

 

 

 

 

 dev dev volG κ ⊗= + +1 1=c c ci  (A.17) 

where G µ=2 . Substituting the definition given in equation (A.17) into the second term of equa-1 

tion (A.7), the derivative is expressed by: 2 

 ( )( ) ( )devv v:dev :n nL Lα α+ +=e e1 1 c c  
(A.18) 

Applying the derivative for each term of equation (A.18) 3 

 ( )dev dev devv v: : : dn n nL Lα α α+ + += +e e e1 1 1c c c  
(A.19) 

The Lie derivative expressed on the second term of the RHS of equation (A.19) corresponds to 4 

the deviatoric part of the Lie derivative of the elastic constitutive tensor c .  Its derivative is ex-5 

pressed as 6 

 ( )v v:L L= ec a  (A.20) 

where deduction of a  is given in detail in Ref. [44]; the index notation of this fourth order ten-7 

sor is given by 8 

 
 trljjkl il jk ik ij kl ik jln n nnµ δ δ λ δ δ δ+ + ++∆ ∆ ∆ ∆

   =− + − +    
e e e e1 1 114 2  a  

(A.21) 

Substituting definition (A.20) into equation (A.19), the Lie derivative reads 9 

 ( ) ( )( )dev dev devv : : dn n nL α α+ + += +e e e1 1 1c a c  
(A.22) 

• 
( )v ln nL Jκ +1 1  10 

Applying the chain rule, the derivative ( )ln nd J +1 is computed as  11 

 
( ) ( )ln n n

n

d J d J
J

+ +
+

=1 1
1

1

 

(A.23) 

Taking into account the definition of the Lie derivative of the Jacobian determinant, defined as 12 

 ( ) ( )v vn n nL J J L
−

+ + += e
1

1 1 11 :  
(A.24) 

the directional derivative reads  13 

 ( )n n nd J J d+ + += e1 1 11:  (A.25) 



  

67 

 

 

 

 

Substituting equation (A.25) into equation (A.23), we get 1 

 
( ) ( )ln n n n

n

d J d J d
J

+ + +
+

= = e1 1 1
1

1
1:

 

(A.26) 

Defining the derivative for the pressure term as 2 

 ( ) ( )n nd p dκ+ += e1 11:  (A.27) 

Finally, the derivative of the third term in the RHS of equation (A.7) is given by 3 

 ( ) ( )n nd p dκ+ += ⊗ e1 11 1 1 :  (A.28) 

• 
( )vnp L+1 1  4 

The last term is defined directly from the following expression 5 

 ( )  nd d +=− e 121  (A.29) 

Defining the derivative of the last term as 6 

 ( )  n n np d p d+ + +=− e1 1 121  (A.30) 

Taking into account each derivative defined for equation (A.7), the elasto-plastic algorithmic 7 

tangent tensor epc  that satisfies equation (A.1) is defined as 8 

 
[ ] ( )( )

( )  

 
ep dev devˆ ˆtr

                 

n n n

np

αα

κ

+ + +

+

⊗= − + + +

⊗ +−

τ τ e1 1 1

1

2

3

2

1

1 1

c a ci

i  

(A.31) 

 9 

Implicit integration of the constitutive model 10 

The implementation of the algorithmic tangent constitutive tensor in this work is developed with an 11 

Impl-Ex integration scheme; however, in this section the full description for an implicit integration 12 

scheme of the constitutive model is presented. 13 

The implicit scheme is formulated deriving each term of equation (A.4) – the plastic parameter14 

( )n nα λ + +∆ 1 1 , given in equation (A.3) is computed at the same time step. 15 



  

68 

 

 

 

 

 ( ) ( )

( ) ( ) ( )( )

  v v

v

ˆ ˆdev dev

             dev : dev : ln
n n n

n n n

L d L

d L J

α α

α α κ
+ + +

+ + +

= + +

+ +

τ τ τ

e e

1 1 1

1 1 11c c  

(A.32) 

It is observed from equation (A.32) that the only term that remains to be defined is the direc-1 

tional derivative of the plastic parameter ( )n nα λ + +∆ 1 1 . The derivative of this parameter, ( )dα λ∆ , is 2 

deduced using its definition given in equation (A.3).  3 

 

( )
( ) ( )d d dn n

n

µ

µ
α λ ξ λ

λ
+ +

+

∆ ∆
∆

= − =
+

1 1
2

1

2

1 2

 

 

(A.33) 

where  4 

 

( )n

µ

µ
ξ

λ +∆
= −

+
2

1

2

1 2  

(A.34) 

Recalling the definition of the slip rate, given in equation (41) 5 

 ( )
( )

trial
n

n
nb b p

λ
µ

φ
+

+
+

∆ =
−

τ
1

1

2 1 12  

(A.35) 

we observe that it is defined as a function of the yield function, evaluated in the auxiliary state6 

trial
n+τ 1 , and the pressure.  The derivative of the discretized slip rate, expressed in the RHS of equa-7 

tion (A.33), is computed deriving by parts equation (A.35): 8 

 
( )

( )
( )

( )

( )

 

trial
triald d d n

n n

b
p

b b p b b p
λ

µ µ

φ
φ +

+ +

∆ = +
− −

τ
τ

1

1
2

2 1 1
2 1 1

1

2 2

   

 

(A.36) 

The remaining term to be defined is the derivative of the yield surface – since the computation 9 

of the derivative of the pressure is expressed in equation (A.27). 10 

• 
( )

trialdφ τ  11 

The derivative of the yield surface, defined in equation (32), is expressed as 12 

 ( ) ( ) trial trial triald d dev dn nb pφ + += +τ τ 1 1 1      
(A.37) 

The expression for the derivative of the norm of the deviatoric part of the trial stress tensor, first 13 

term of the RHS of equation (A.37), reads 14 



  

69 

 

 

 

 

 
( ) ( )

( )

   

 

  

trial trial trial
trial

trial trial

d dev d dev : dev
dev

                          dev : d dev

n n n

n

n n

+ + +
+

+ +

= +




τ τ τ
τ

τ τ

1 1 1

1

1 1

1

2
     

 

   

 

(A.38) 

Using the definition of the trial stress tensor, equation (30), and aided by the previous calcula-1 

tions defined in equations (A.16) and (A.22), the derivative of the deviatoric part of the trial reads 2 

 
( ) [ ]{

( ) }

  
trial

dev dev

ˆ ˆd dev tr

                                                : d

n n n

n n

+ + +

+ +

⊗= −

+ +

τ τ τ

e e

1 1 1

1 1

2

3
   1

a c

i

 

(A.39) 

Due to the symmetry of the Kirchhoff stress tensor and the definition of the derivative of the 3 

deviatoric part of the stress tensor given in the equation above, the expression in equation (A.39) is 4 

rewritten as 5 

 
( ) [ ]{

( ) }

 

  

 

trial
trial

trial

dev dev

dev
ˆ ˆd dev : tr

dev

                             : d

n
n n n

n

n n

+
+ + +

+

+ +

⊗= −

+ +

τ
τ τ τ

τ

e e

1

1 1 1

1

1 1

2

32

 

   

 

1

a c

i

 

(A.40) 

The notation of equation (A.40) is shortened as  6 

 ( ) triald dev : dn nβ+ +=τ e1 1   
(A.41) 

where: 7 

 
[ ] ( ){ }  

 

trial
dev dev

trial

dev
ˆ ˆ: tr

dev
n

n n n

n

β
+

+ + +
+

⊗= − + +
τ

τ τ e
τ

1

1 1 1

1

2

32

 

 

 

1 a ci

 

(A.42) 

The second term of the RHS of equation (A.36) corresponds to the derivative of the pressure.  8 

As mentioned before, the computation of this derivative was carried out in the previous section and 9 

defined by equation (A.27). 10 

Substituting equation (A.41) and (A.27) into equation (A.37), the derivative of the yield surface 11 

reads 12 

 ( ) ( )triald : d n nb dφ β κ+ += +τ e e1 1 1  1:  
(A.43) 



  

70 

 

 

 

 

The derivative of the discretized slip rate, given in equation (A.36), is completely defined by 1 

equations (A.43) and (A.27).  Substituting those terms and regrouping them, the derivative of the 2 

slip rate reads 3 

 ( ) ( )[ ]d : d nbλ βγ γ γκ +∆ = + + e1 1 1 2 1 1  (A.44) 

where: 4 

 

( )

( )

( )

trial

      and      
n n

b

b b p b b p

τ

µ µ

φ
γ γ

+ +

⋅
= =

− −

1

1 2
2

2 1 1
2 1 1

1

2 2    

(A.45) 

Finally, the description of the derivative of the plastic parameter ( )α λ∆ for a full implicit inte-5 

gration scheme is obtained.  Substituting equation (A.46) into equation (A.33) 6 

 ( )[ ]d : d nbα ξ βγ γ γκ += + + e1 1 1 2 1 1  (A.46) 

 7 

Visco-plastic regularization 8 

The integration of the visco-plastic regularization in the algorithmic tangent tensor is given obtain-9 

ing the directional derivative of equation (51) 10 

 ( )vp eptriald d dnn nη η++ += + −τ τ τ11 11  
(A.47) 

The derivative of the trial stress tensor fulfils the following expression 11 

 trial triald : dn n+ +=τ e1 1c  
(A.48) 

where the elastic algorithmic tangent modulus trialc is defined as 12 

 ( )trial n+= + e 1c c a  
(A.49) 

where the expressions for c  and a  were given previously.  The deduction of equation (A.49) is 13 

given in more detail in Ref. [44]. 14 

The second term was defined in previous section, where the elasto-plastic constitutive tensor is 15 

given by equation (A.31) – for an implicit / explicit integration scheme (Impl-Ex). Finally, the 16 

visco-plastic description of the algorithmic constitutive tensor is stated as follows. 17 



  

71 

 

 

 

 

 ( )vp trial epη η= + −1 c c c  
(A.50) 

 1 

References 2 

[1] E. Lajeunesse, A. Mangeney-Castelnau, and J. P. Vilotte, "Spreading of a granular mass on 3 

a horizontal plane," Physics of Fluids, vol. 16, pp. 2371-2381, 2004. 4 

[2] S. R. Idelsohn, E. Oñate, and F. D. Pin, "The particle finite element method: a powerful 5 

tool to solve incompressible flows with free-surfaces and breaking waves," International Journal 6 

for Numerical Methods in Engineering, vol. 61, pp. 964-989, 2004. 7 

[3] G. B. Crosta, S. Imposimato, and D. Roddeman, "Numerical modeling of 2-D granular step 8 

collapse on erodible and nonerodible surface," Journal of Geophysical Research: Earth Surface, 9 

vol. 114, pp. n/a-n/a, 2009. 10 

[4] P. Y. Lagrée, L. Staron, and S. Popinet, "The granular column collapse as a continuum: 11 

validity of a two-dimensional Navier–Stokes model with a µ(I)-rheology," Journal of Fluid 12 

Mechanics, vol. 686, pp. 378-408, 2011. 13 

[5] C. Mast, P. Arduino, P. Mackenzie-Helnwein, and G. Miller, "Simulating granular column 14 

collapse using the Material Point Method," Acta Geotechnica, vol. 10, pp. 101-116, 2015/02/01 15 

2015. 16 

[6] J. Duran, Sands, Powders, and Grains: An Introduction to the Physics of Granular 17 

Materials (Partially Ordered Systems): Springer, 1999. 18 

[7] P. A. Cundall and O. D. L. Strack, "A discrete numerical model for granular assemblies," 19 

Géotechnique, vol. 29, pp. 47-65, 1979. 20 

[8] M. W. Richman, "The Source of Second Moment in Dilute Granular Flows of Highly 21 

Inelastic Spheres," Journal of Rheology, vol. 33, pp. 1293-1306, 1989. 22 



  

72 

 

 

 

 

[9] S. C. Cowin and M. A. Goodman, "A Variational Principle for Granular Materials," ZAMM 1 

- Journal of Applied Mathematics and Mechanics / Zeitschrift für Angewandte Mathematik und 2 

Mechanik, vol. 56, pp. 281-286, 1976. 3 

[10] H. W. Chandler, "A variational principle for granular materials," International Journal for 4 

Numerical and Analytical Methods in Geomechanics, vol. 12, pp. 371-378, 1988. 5 

[11] K. Krabbenhøft, "A variational principle of elastoplasticity and its application to the 6 

modeling of frictional materials," International Journal of Solids and Structures, vol. 46, pp. 464-7 

479, 2009. 8 

[12] R. M. Nedderman, Statics and Kinematics of Granular Materials: Cambridge University 9 

Press, 2005. 10 

[13] C. Rycroft, K. Kamrin, and M. Bazant, "Assessing continuum postulates in simulations of 11 

granular flow," Journal of the Mechanics and Physics of Solids, vol. 57, pp. 828-839, 2009. 12 

[14] J. Y. Ooi and K. M. She, "Finite element analysis of wall pressure in imperfect silos," 13 

International Journal of Solids and Structures, vol. 34, pp. 2061-2072, 1997. 14 

[15] T. Karlsson, M. Klisinski, and K. Runesson, "Finite element simulation of granular 15 

material flow in plane silos with complicated geometry," Powder Technology, vol. 99, pp. 29-39, 16 

1998. 17 

[16] Y.-H. Wu, J. M. Hill, and A. Yu, "A finite element method for granular flow through a 18 

frictional boundary," Communications in Nonlinear Science and Numerical Simulation, vol. 12, pp. 19 

486-495, 2007. 20 

[17] S. Moriguchi, R. Borja, A. Yashima, and K. Sawada, "Estimating the impact force 21 

generated by granular flow on a rigid obstruction," Acta Geotechnica, vol. 4, pp. 57-71, 2009/03/01 22 

2009. 23 



  

73 

 

 

 

 

[18] S. R. Idelsohn, E. Oñate, and F. Del Pin, "A Lagrangian meshless finite element method 1 

applied to fluid–structure interaction problems," Computers & Structures, vol. 81, pp. 655-671, 2 

2003. 3 

[19] E. Oñate, S. R. Idelsohn, M. A. Celigueta, and R. Rossi, "Advances in the particle finite 4 

element method for the analysis of fluid–multibody interaction and bed erosion in free surface 5 

flows," Computer Methods in Applied Mechanics and Engineering, vol. 197, pp. 1777-1800, 2008. 6 

[20] J. Carbonell, E. Oñate, and B. Suárez, "Modeling of Ground Excavation with the Particle 7 

Finite-Element Method," Journal of Engineering Mechanics, vol. 136, pp. 455-463, 2010/04/01 8 

2009. 9 

[21] A. O. Larese, E.; Ross, R., A Coupled Eulerian-PFEM Model for the Simulation of 10 

overtopping in Rockfill Dams vol. 133. Barcelona, Spain: International Center for Numerical 11 

Methods in Engineering, 2012. 12 

[22] C. R. Dohrmann and P. B. Bochev, "A stabilized finite element method for the Stokes 13 

problem based on polynomial pressure projections," International Journal for Numerical Methods 14 

in Fluids, vol. 46, pp. 183-201, 2004. 15 

[23] M. Harr, "Stress Distribution," in The Civil Engineering Handbook, Second Edition, ed: 16 

CRC Press, 2002. 17 

[24] G. MiDi, "On dense granular flows," The European Physical Journal E, vol. 14, pp. 341-18 

365, 2004/08/01 2004. 19 

[25] J. M. Hill and A. P. S. Selvadurai, "Mathematics and mechanics of granular materials," in 20 

Mathematics and Mechanics of Granular Materials, J. Hill and A. P. S. Selvadurai, Eds., ed: 21 

Springer Netherlands, 2005, pp. 1-9. 22 

[26] J. C. Simo and T. J. R. Hughes, Computational Inelasticity: Springer, 1998. 23 



  

74 

 

 

 

 

[27] J. Hernandez, "Numerical Modeling of Crack Formation in Powder Compaction 1 

Processes," Ph.D., Departament de Resistència de Materials i Estructures a l'Enginyeria, 2 

Universitat Politècnica de Catalunya, Barcelona, Spain, 2009. 3 

[28] S. Huang, Continuum theory of plasticity: Wiley. com, 1995. 4 

[29] M. E. Cates, J. P. Wittmer, J. P. Bouchaud, and P. Claudin, "Jamming and static stress 5 

transmission in granular materials," Chaos: An Interdisciplinary Journal of Nonlinear Science, vol. 6 

9, pp. 511-522, 1999. 7 

[30] Q. Sun, F. Jin, J. Liu, and G. Zhang, "Understanding force chains in dense granular 8 

materials," International Journal of Modern Physics B, vol. 24, pp. 5743-5759, 2010/11/20 2010. 9 

[31] C. Dávalos, "Particle finite element methods for modelling granular material flows," Ph.D., 10 

Departament de Resistència de Materials i Estructures a l'Enginyeria, Universitat Politècnica de 11 

Catalunya, Barcelona, Spain, 2014. 12 

[32] J. Lubliner, Plasticity Theory: Macmillan Publishing, 1990. 13 

[33] H. M. Jaeger, S. R. Nagel, and R. P. Behringer, "Granular solids, liquids, and gases," 14 

Reviews of Modern Physics, vol. 68, pp. 1259-1273, 1996. 15 

[34] S. R. Idelsohn, E. Oñate, and F. D. Pin, "The particle finite element method: a powerful 16 

tool to solve incompressible flows with free-surfaces and breaking waves," International Journal 17 

for Numerical Methods in Engineering, vol. 61, pp. 964-989  1097-0207, 2004. 18 

[35] J. Oliver, J. C. Cante, R. Weyler, C. González, and J. Hernandez, "Particle Finite Element 19 

Methods in Solid Mechanics Problems," in Computational Plasticity. vol. 7, E. Oñate and R. 20 

Owen, Eds., ed: Springer Netherlands, 2007, pp. 87-103. 21 

[36] J. Cante, M. D. Riera, J. Oliver, J. Prado, A. Isturiz, and C. Gonzalez, "Flow regime 22 

analyses during the filling stage in powder metallurgy processes: experimental study and numerical 23 

modelling," Granular Matter, vol. 13, pp. 79-92, 2011/02/01 2011. 24 



  

75 

 

 

 

 

[37] C. González, "El Método PFEM: aplicación a problemas industriales de pulvimetalurgia," 1 

Doctoral, Escola Tècnica Superior d'Enginyers de Camins, Canals i Ports de Barcelona, Universitat 2 

Politècnica de Catalunya. Departament de Resistència de Materials i Estructures a l'Enginyeria, 3 

Barcelona, Spain, 2009. 4 

[38] J. Cante, C. Dávalos, J. A. Hernández, J. Oliver, P. Jonsén, G. Gustafsson, and H. Å. 5 

Häggblad, "PFEM-based modeling of industrial granular flows," Computational Particle 6 

Mechanics, vol. 1, pp. 47-70, 2014/05/01 2014. 7 

[39] H. Edelsbrunner, D. Kirkpatrick, and R. Seidel, "On the shape of a set of points in the 8 

plane," Information Theory, IEEE Transactions on, vol. 29, pp. 551-559, 1983. 9 

[40] J. Oliver, S. Hartmann, J. C. Cante, R. Weyler, and J. A. Hernández, "A contact domain 10 

method for large deformation frictional contact problems. Part 1: Theoretical basis," Computer 11 

Methods in Applied Mechanics and Engineering, vol. 198, pp. 2591-2606, 2009. 12 

[41] S. Hartmann, J. Oliver, R. Weyler, J. C. Cante, and J. A. Hernández, "A contact domain 13 

method for large deformation frictional contact problems. Part 2: Numerical aspects," Computer 14 

Methods in Applied Mechanics and Engineering, vol. 198, pp. 2607-2631, 2009. 15 

[42] J. Oliver, A. E. Huespe, and J. C. Cante, "An implicit/explicit integration scheme to 16 

increase computability of non-linear material and contact/friction problems," Computer Methods in 17 

Applied Mechanics and Engineering, vol. 197, pp. 1865-1889, 2008. 18 

[43] G. A. Holzapfel, Nonlinear Solid Mechanics: A Continuum Approach for Engineering: 19 

John Wiley & Sons, 2000. 20 

[44] J. C. Cante, J. Oliver, and S. Oller, "Simulación numérica de procesos de compactación de 21 

pulvimateriales: aplicación de técnicas de cálculo paralelo," Escola Tècnica Superior d'Enginyers 22 

de Camins, Canals i Ports de Barcelona, Universitat Politècnica de Catalunya, 1995. 23 

 24 

 25 


