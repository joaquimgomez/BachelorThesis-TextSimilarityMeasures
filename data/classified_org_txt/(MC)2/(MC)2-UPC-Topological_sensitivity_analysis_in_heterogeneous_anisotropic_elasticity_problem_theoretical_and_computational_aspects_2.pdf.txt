












































Topological sensitivity analysis in heterogeneous anisotropic elasticity problem.
Theoretical and Computational Aspects.

S.M. Giustia,∗, A. Ferrerb,c, J. Oliverb,d

aNational Technological University, Regional Faculty of Córdoba (UTN/FRC - CONICET), Maestro M. López esq. Cruz Roja Argentina,
X5016ZAA - Córdoba, Argentina.

bCIMNE – Centre Internacional de Metodes Numerics en Enginyeria, Campus Nord UPC, Edifici C-1, c/Jordi Girona 1-3, 08034 Barcelona,
Spain.

cEscola Superior d’Enginyeries Industrial, Aeroespacial i Audiovisual de Terrassa, Campus de Terrassa, Edificio TR45. C. Colom, 11 08222
Terrassa, Spain

dE.T.S. d’Enginyers de Camins, Canals i Ports, Technical University of Catalonia, Campus Nord UPC, Edifici C-1, c/Jordi Girona 1-3, 08034
Barcelona, Spain.

Abstract

The topological sensitivity analysis for the heterogeneous and anisotropic elasticity problem in two-dimensions is
performed in this work. The main result of the paper is an analytical closed-form of the topological derivative for the
total potential energy of the problem. This derivative displays the sensitivity of the cost functional (the energy in this
case) when a small singular perturbation is introduced in an arbitrary point of the domain. In this case, we consider
a small disc with a completely different elastic material. Full mathematical justification for the derived formula, and
derivations of precise estimates for the remainders of the topological asymptotic expansion are provided. Finally,
the influence of the heterogeneity and anisotropy is shown through some numerical examples of structural topology
optimization.

Keywords: topological derivative, structural optimization, topology design, elastic anisotropy

1. Introduction

Topological asymptotic analysis allows obtaining an asymptotic expansion of a given shape functional when a
geometrical domain is singularly perturbed. This perturbation can be materialized by the insertion of holes, inclu-
sions, source-terms or even cracks. The main concept arising from this analysis is the topological derivative [1]. This
derivative measures the sensitivity of the shape functional with respect to the infinitesimal singular domain perturba-
tion and it was rigorously introduced in [2]. Since then, this concept has proven extremely useful in the treatment of
a wide range of problems; see, for instance, [3, 4, 5, 6, 7, 8, 9, 10, 11]. Concerning the theoretical development of the
topological asymptotic analysis, besides the monograph [1], the reader is referred to [12, 13].

In order to introduce these concepts, let us consider an open and bounded domain Ω ⊂ R2, see figure 1, which
is subject to a non-smooth perturbation confined in a small region ωε(x̂) = x̂ + εω of size ε. Here, x̂ is an arbitrary
point of Ω and ω is a fixed domain of R2. Then, we assume that a given shape functional Jε(Ω), associated to the
topologically perturbed domain, admits the following topological asymptotic expansion [1]

Jε(Ω) = J(Ω) + f (ε)T (x̂) + o( f (ε)) , (1)

where J(Ω) is the shape functional associated to the unperturbed domain and f (ε) is a positive function such that
f (ε) → 0 when ε → 0+. The function x̂ 7→ T (x̂) is termed the topological derivative of J at x̂. Therefore, the term
f (ε)T (x̂) represents a first order correction ofJ(Ω) to approximateJε(Ω) in x̂. In this work, the singular perturbation
is characterised by a circular disc, denoted Bε, with boundary ∂Bε and different constitutive properties, see figure 1.

∗Corresponding author
Email addresses: sgiusti@frc.utn.edu.ar (S.M. Giusti), aferrer@cimne.upc.edu (A. Ferrer), oliver@cimne.upc.edu (J.

Oliver)

Preprint submitted to CMAME August 3, 2016



Figure 1: Topological derivative concept.

From (1), we obtain the standard definition of the topological derivative by passing to the limit ε→ 0+:

T (x̂) = lim
ε→0+

Jε(Ω) − J(Ω)
f (ε)

. (2)

Notice that, since we are dealing with singular domain perturbations, the shape functionals Jε(Ω) and J(Ω) are
associated to topologically different domains. Therefore, the above limit is not trivial to be calculated. In particular,
we need to perform an asymptotic analysis of the shape functional Jε(Ω) with respect to the small parameter ε, i.e.
we need information of Jε(Ω) when ε → 0+. As it will be shown later, the shape functional difference (2) depends
on the polarization tensor, which is considered a fundamental concept on the topological derivative topic. This tensor,
also known in the literature as Pólya-Szegö polarization tensor, arises from the asymptotic analysis in singularly
perturbed geometrical domains [14]. This mathematical concept permits to write an asymptotic expansion of the
shape functional Jε(Ω) by means of functions evaluated in the unperturbed domain Ω (without considering Bε). The
polarization tensor is characterized by a matrix – polarization matrix – depending only on the constitutive properties
of the problem and the shape of the singular domain perturbation [15].

The topological derivative, in its closed form, has been fully developed for a wide range of physical phenomena.
Most of them, by considering homogeneous and isotropic constitutive behaviours. In fact, only a few works dealing
with heterogeneous and anisotropic material behavior can be found in the literature, and, in general, the derived
formulas are given in an abstract form (see, for instance, [12]). Closed and analytical forms for this kind of constitutive
behavior have been only developed for heat diffusion problems (see [16, 17, 18, 2]). For anisotropic elasticity, the
existence and properties of the polarization tensor was studied in [19, 20]. However, the polarization tensor is given
again in an abstract form. A technique for the numerical evaluation of the polarization tensor is presented in [21].

In this work, we derive the topological derivative in its closed form for the total potential energy associated to
an anisotropic and heterogeneous elasticity problem. We assume as singular perturbation a small circular inclusion
introduced at an arbitrary point of the domain. The constitutive properties of the small disc are also anisotropic
and completely different from the elasticity properties of the matrix. In addition, we provide a full mathematical
justification of the derived formula, and develop precise estimates for the remainders of the topological asymptotic
expansion.

Bearing this in mind, the heterogeneous anisotropic topological derivative concept, can be applied in advanced
technological research areas such as topology and structural optimization simultaneously combined with topological
material-design. In fact, in multi-scale modeling, for a given microstructure the homogenized constitutive response is,
in general, anisotropic. In addition, since in each macroscopical structural point we have a different microstructure, the
constitutive homogenized response at the macro-scale varies from point to point, i.e., it is heterogeneous. Therefore,
for a correct evaluation of the topological sensitivity in a structural optimization problem, a derivative (the topological
derivative) for an anisotropic and heterogeneous constitutive behaviour is needed .

This paper is organized as follows. Section 2 describes the model associated to an anisotropic and heteroge-
neous elasticity problem. In Section 3, we present the main result of the paper: a closed formula for the topological
derivative. In Section 5, the influence of heterogeneity and anisotropy is shown through some numerical examples for
structural topology optimization. The paper is closed in Section 6 where some concluding remarks are presented.

2



2. Problem Formulation

The topological asymptotic analysis of the total potential energy associated to an anisotropic and heterogeneous
elasticity problem is calculated. Thus, the unperturbed shape functional is defined as:

J(Ω) =
1
2

ˆ
Ω

σ(u) · ∇su +
ˆ

ΓN

t̄ · u , (3)

where the Cauchy stress tensor σ(u) is defined as usual:

σ(ξ) := C∇sξ . (4)

In the above equations, C = C(x) is a symmetric fourth order elasticity tensor, ∇s is used to denote the symmetric
part of the gradient operator ∇ and u is the displacement field, solution of the following variational problem: find the
field u ∈ U, such that ˆ

Ω

σ(u) · ∇sη +
ˆ

ΓN

t̄ · η = 0 ∀η ∈ V . (5)

In the variational problem (5) the setU of admissible functions and the spaceV of admissible variations are given by

U :=
{
φ ∈ H1(Ω;R2) : φ|ΓD = ū

}
and V :=

{
φ ∈ H1(Ω;R2) : φ|ΓD = 0

}
. (6)

In addition, ∂Ω = ΓN ∪ ΓD with ΓN ∩ ΓD = ∅, where ΓN and ΓD are Neumann and Dirichlet boundaries, respectively.
Thus, ū is a Dirichlet data on ΓD and t̄ is a Neumann data on ΓN , both assumed to be smooth enough, see figure 2.

Figure 2: Description of the problem.

On the other hand, for our specific case, we consider a perturbation on the domain given by the nucleation of a
small circular inclusion with constitutive properties given by a constant elastic tensor C?. Therefore, the perturbed
shape functional can be written as:

Jε(Ω) =
1
2

ˆ
Ω

σε(uε) · ∇
suε +

ˆ
ΓN

t̄ · uε , (7)

where the stress tensor associated to he perturbed configuration is defined as:

σε(ξ) := Cε∇sξ. (8)

Here, we consider that the inclusion is made of a completely different material. Then, the elasticity tensor Cε can
be written as follows

Cε :=
{

C in Ω \ Bε
C? in Bε

. (9)

In addition, in (7) the function uε is solution of the following variational problem:

3



Find the field uε ∈ Uε, such thatˆ
Ω

σε(uε) · ∇
sη +

ˆ
ΓN

t̄ · η = 0 ∀η ∈ Vε , (10)

and both the setUε and the spaceVε are defined as

Uε := {φ ∈ U : ~φ� = 0 on ∂Bε} and Vε := {φ ∈ V : ~φ� = 0 on ∂Bε} , (11)

where we use ~(·)� to denotes the jump of function (·) across the boundary ∂Bε. Note that the domain Ω is topologically
perturbed by the introduction of an inclusion Bε(x̂) with complete different elastic constitutive properties (in general
anisotropic).

3. Topological derivative

In this Section we present the main result of the work: an analytical formula for the topological derivative of
the energy shape functional associated to an anisotropic and heterogeneous elastic problem. We begin by choosing
as admissible test function in problems (5) and (10), the function η = uε − u. Then, we obtain as consequence the
following expressions

ˆ
Ω

σ(u) · ∇su =
ˆ

Ω

σ(uε) · ∇
su +
ˆ

ΓN

t̄(uε − u), (12)
ˆ

Ω

σε(uε) · ∇
suε =

ˆ
Ω

σε(uε) · ∇
su −
ˆ

ΓN

t̄(uε − u). (13)

Therefore, the shape functionals (3) and (7) can be written as

J(Ω) =
1
2

ˆ
Ω

σ(uε) · ∇
su +

1
2

ˆ
ΓN

t̄(uε + u), (14)

Jε(Ω) =
1
2

ˆ
Ω

σε(uε) · ∇
su +

1
2

ˆ
ΓN

t̄(uε + u). (15)

By considering the above results, the differences of the shape functionals Jε(Ω) and J(Ω) reads

Jε(Ω) − J(Ω) =
1
2

ˆ
Ω

σε(uε) · ∇
su −

1
2

ˆ
Ω

σ(uε) · ∇
su. (16)

Taking into account the definitions of the perturbed elasticity tensor Cε and perturbed stress tensor, we have that the
difference of the total potential energy is given by an integral concentrated in the inclusion Bε, namely

Jε(Ω) − J(Ω) =
1
2

ˆ
Bε

∆C(C?)−1σε(uε) · ∇su, (17)

with ∆C := C? − C.
Let us assume that the elasticity tensor C(x) is smooth enough such that it admits an expansion in Taylor series

around the point x̂ of the form C(x) = C(x̂) + ∇C(ζ)(x − x̂), where ζ ∈ (x, x̂). Now, in order to analytically solve the
integral (17), we introduce the following ansatz proposed in [22] for the solution associated to the perturbed problem
uε:

uε(x) = u(x) + εw(x/ε) + ũε(x), (18)

where the function w(y) is the solution of the following exterior problem independent of the small parameter ε
div (σε(w)) = 0 in R2

σε(w) = Cε(x̂)∇sw
w → 0 at ∞
~w� = 0 on ∂B1

~σε(w)�n = −Sσ(u)(x̂)n on ∂B1

, (19)

4



where S := I − C?C−1, I denote the fourth-order identity tensor and was used the change of variable x = εy. The
remainder ũε in (18) must satisfy the following equation:

div(σε (̃uε)) = εdiv(∇Cε(ζ)(x − x̂)∇sw) in Ω
ũε = −εw on ΓD

σ(̃uε)n = −εσ(w)n on ΓN
~̃uε� = 0 on ∂Bε

~σε (̃uε)�n = −ε~(∇Cε (ζ) n)
(
∇su(x̂) + ∇sw

)
�n on ∂Bε

, (20)

which has the following estimate ‖̃uε‖H1(Ω;R2) ≤ Cε, with the constant C independent of ε (see Appendix A). The
exterior problem (19) is solved explicitly in Appendix B by using the complex variable method [23, 24]. From (B.17),
the stress tensor σε(w) inside the inclusion Bε can be written as:

σε(w)|Bε(x̂) = Tσ(u)(x̂), (21)

where T := −AS and the fourth order tensor A is shown in (B.18) of Appendix B.
Taking into account (18), the difference of shape functionals (17) reads

Jε(Ω) − J(Ω) =
1
2

ˆ
Bε

∆C(C?)−1(σε(u) + σε(w)) · ∇su + E(ε), (22)

where the term E(ε) is given by

E(ε) =
1
2

ˆ
Bε

∆C(C?)−1σε (̃uε) · ∇su, (23)

which has the following estimate E(ε) = o(ε2) as shown in the Appendix A. Next, by using the interior elliptic
regularity of the function u in Bε, the difference of the shape functionals (22) satisfies the following identity:

Jε(Ω) − J(Ω) =
1
2

ˆ
Bε

∆C(x̂)(C?)−1(σε(u)(x̂) + σε(w)) · ∇su(x̂) + o(ε2), (24)

where the expansion of the tensor C(x) has been used again.
With the use of (21) and the change of variables x = εy the above expression can be analytically solved leading to

Jε(Ω) − J(Ω) = πε
2Pσ(u)(x̂) · ∇su(x̂) + o(ε2), (25)

where P can be recognized as the Pólya-Szegö polarization tensor, given explicitly by

P =
1
2

∆C(x̂)[(C(x̂))−1 + (C?)−1T]. (26)

Finally, using the definition (1) and taking f (ε) = |Bε| = πε2, the topological derivative for the problem under
consideration is given explicitly by

T (x̂) = Pσ(u)(x̂) · ∇su(x̂) ∀x̂ ∈ Ω. (27)

Note that this formula is general, in the sense that measures the sensitivity of the total potential energy when two
materials with completely different constitutive tensors are considered. Also, the polarization tensor P depends only
of the constitutive tensors C(x̂) and C?. This means that once defined C and C? for the point x̂, the tensor P can be
easily obtained by computing the components of A, see Appendix B, and consequently so is T.

Remark 1. From the final expression for the polarization tensor associated to the anisotropic and heterogeneous
elasticity problem (26), we can analyze the limit case when the inclusion becomes a hole by taking the limit when
C? → 0. On the other hand, if we can analyze the sensitivity to the introduction of a rigid inclusion, we need to take
the limit when C? → ∞. It should be noted that both limits exist and they can be easily obtained.

5



Remark 2. If we consider that both materials are isotropic, with constitutive properties E and ν (background mate-
rial), and E? and ν? (inclusion), the polarization tensor (26) can be written for plane stress as a fourth-order isotropic
polarization tensor, as:

P = −
1
2

1
βγ + τ1

[
(1 + β)(τ1 − γ)I +

1
2

(α − β)
γ(γ − 2τ3) + τ1τ2

αγ + τ2
(I ⊗ I)

]
, (28)

where

α =
1 + ν
1 − ν

, β =
3 − ν
1 + ν

, γ =
E?

E
, τ1 =

1 + ν?

1 + ν
, τ2 =

1 − ν?

1 − ν
and τ3 =

ν?(3ν − 4) + 1
ν(3ν − 4) + 1

. (29)

Note that by considering ν? = ν, the parameters τi = 1 (with i = 1..3) and (28) becomes the polarization tensor
for isotropy elasticity widely used in structural topological design [1].

4. Numerical validation

The analytical formula for the topological derivative presented in (27), can be validated by using the computational
framework described in this section. To this end, we define (for a finite value of ε) the function Tε(x̂) as:

Tε(x̂) :=
Jε(Ω) − J(Ω)

f (ε)
. (30)

Clearly, the above definition have the following property,

lim
ε→0

Tε(x̂) = T (x̂) . (31)

A numerical approximation of T (x̂) can be obtained by calculating the functionsJε(Ω) andJ(Ω), for a sequences
of decreasing values of ε and then using (30) to compute the corresponding estimates Tε(x̂) for T (x̂). The values of the
functionJ andJε are computed numerically by means of standard finite element procedure for the elasticity problem.
The domain considered in the verification is a unit square. The perturbed domains are obtained by introducing circular
inclusions of radii

ε ∈ {0.160, 0.080, 0.040, 0.010, 0.005}, (32)

centered at x̂ = (0.5, 0.5), with the origin of the coordinate system positioned at the bottom left corner. The finite
element mesh used to discretise the perturbed domain contains a total number of 3850240 three-nodded elements and
1926401 nodes.

To solve the anisotropic elastic problem, we prescribe the displacement on ΓD to be ū = 0 and traction t̄ = 1 on
ΓN , see fig. 3.

Figure 3: Domain and boundary conditions.

6



The study is conducted for four combinations of elasticity tensors C and C?. The analyzed cases are given by:

Case 1 C =


0.905 0.845 −0.017
0.845 1.405 −0.415
−0.017 −0.415 0.385

 C? =


1.562 0.312 0.0
0.312 1.562 0.0

0.0 0.0 0.625


Case 2 C =


1.099 0.329 0.0
0.329 1.099 0.0

0.0 0.0 0.385

 C? =


1.562 0.312 0.0
0.312 1.562 0.0

0.0 0.0 0.625


Case 3 C =


2.083 0.416 0.0
0.416 4.160 0.0

0.0 0.0 0.833

 C? =


1.099 0.329 0.0
0.329 1.099 0.0

0.0 0.0 0.385


Case 4 C =


2.083 0.416 0.0
0.416 4.160 0.0

0.0 0.0 0.833

 C? =


0.905 0.845 −0.017
0.845 1.405 −0.415
−0.017 −0.415 0.385


The normalized obtained results (Tε/T ) are plotted in fig. 4, where the analytical topological derivative and the

numerical approximations for each value of ε are shown. It can be seen that the numerical topological derivatives
converge to the corresponding analytical value for all cases. This confirms the validity of the proposed formula (27).

0,70

0,75

0,80

0,85

0,90

0,95

1,00

1,05

1,10

0 20 40 60 80 100 120 140 160 180 200

Case 1
Case 2
Case 3
Case 4

Figure 4: Results of numerical verification.

5. Numerical examples

In order to evidence the potential application of the topological derivative concept for anisotropic and heteroge-
neous materials, some numerical examples are shown in this section.

5.1. Numerical algorithm

As usual in the topological optimization scientific community, a minimum compliance objective function, subject
to a certain fraction volume, will be solved. To this ends, the material distribution in Ω will be identified by a
characteristic function χ. Thus, the objective function J(Ω) can be written as a function of χ as: J(Ωχ), where Ωχ
is used to denote the geometrical dependency of the domain on the characteristic function χ. Then, the optimization
problem is:

7



Find the characteristic function χ such that,

min.
χ

J(Ωχ)

s.t. c(χ) =
´

Ω
χ − V = 0 ,

(33)

where J(Ωχ) is the total potential energy of an standard elastic equilibrium problem (5) and V the final intended
volume. Note that the constitutive tensor C could be heterogeneous and anisotropic.

An efficient approach to solve problem (33) is the use of the method proposed in [25]. The procedure relies
on a level-set domain representation [26] and the approximation of the topological optimality conditions by a fixed
point iteration. The topological derivative (27) is used as a feasible descent direction to minimize the cost function
J(Ωχ). This class of algorithm has been successfully used in research areas related to topological optimization such
as: microstructure of materials [27], load bearing structures subjected to point-wise stress constraint [28, 6] and
piezoelectric actuators [3]. For completeness, in the following, some remarks about the algorithm are detailed. For
further details we refer to the work by [6, 25].

• The definition of the domain lies on the level set function ψ. The design variable is no longer the characteristic
function χ. In fact, it is parametrized by the level set ψ as

χ(x) =

 1 ψ(x) < 0,0 ψ(x) > 0. (34)
• In order to satisfy the constraint c(χ) = 0, as in [29, 30], an augmented Lagrangian method is used. Thereby, a

Lagrange multiplier λ appears as a new unknown, and a penalty parameter ρmust be provided. The optimization
problem (33) becomes the following saddle point problem,

max.
λ

min.
ψ

J(Ωψ) + λc(ψ) +
1
2ρc(ψ)

2. (35)

• An extended topological derivative is defined as,

g(x) =

 −T (x) −max(0, λ + ρc(ψ)) ψ(x) < 0,T (x) + max(0, λ + ρc(ψ)) ψ(x) > 0. (36)
• The optimality condition, see [31], is based on seeking ψ(x) parallel to g(x) and unitary. Thus, a slerp interpo-

lation scheme is used, i.e.,

ψn+1 =
1

sin θn
[sin((1 − κn)θn)ψn + sin(κnθn)

gn
||gn||L2

], (37)

where κn ∈ [0, 1] is a line search-like parameter and the converge criterion is based on the value of θn, the angle
between ψn and gn , which is written as

θn = acos
[
〈ψn, gn〉
||ψ||L2 ||gn||L2

]
. (38)

Note that, in this fix point scheme, the topological derivative for anisotropic materials plays the role of the gra-
dient in an steepest descent algorithm. With this algorithm, some numerical examples, both with homogeneous and
heterogenous material distribution, are considered. All them are solved under 2D elastic plane stress assumptions.
Regarding to numerical aspects, a standard FEM is used for solving (5).

5.2. Representative Numerical Simulations
In this first set of case studies, the constitutive behaviour is homogeneous in the design domain. Besides, the

constitutive tensor in the inclusion is defined with the contrast parameter γ as follows: C? = γC with γ = 10−4. The
2x1 domain is discretized with a structured mesh of 5200 P1 triangular elements. The volume fraction is taken as
V = 0.4 and the penalty as ρ = 0.5. All the examples are declared to be converged when θ < 1o and |c(ψ)| < 0.001. In
the figures showing the obtained results, the black and white colors are used to represent the part of the domain with
constitutive tensor C and C?, respectively. Note that, the elasticity of the inclusion is weak enough to mimic a void.

8



Figure 5: Schematic drawing of a traction rod with homogeneous material distribution

5.2.1. Homogeneous material distribution - Traction rod
As shown in Figure 5, regarding to boundary conditions, the domain is fixed at the left side and has a horizontal

unitary force at the middle of the right send. Some representative cases, in terms of the definition of the constitutive
tensor, have been selected (see second column in Figure 6).

Figure 6: Representative optimal homogeneous traction rod topologies: (a) Isotropic (E = 1 and ν = 0.3) as a reference, (b)-(e) Orthotropic, (f)
Anisotropic

In the second column, the constitutive tensor used is shown, which is obtained by a classical homogenization
procedure of the micro-structure displayed on the third column, see [32]. In the fourth one, the final optimal topology
for the structure is also shown.

Notice the strong influence of the selected micro-structure topology and, consequently, of the resulting homoge-
nized constitutive tensor, on the obtained optimal macro-structure topology.

9



5.2.2. Homogeneous material distribution - Cantilever beam

Figure 7: Schematic drawing of a cantilever beam with homogeneus material distribution

Now a standard cantilever beam is solved. All data are as before, except for the direction of the applied force (see
Figure 7).

Figure 8: Representative optimal homogeneous traction rod topologies: (a) Isotropic (E = 1 and ν = 0.3) as a reference, (b)-(e) Orthotropic, (f)
Anisotropic

The isotropic case is used also as a reference. Some unconventional topologies are obtained, specially in the
orthotropic case (micro-structure with horizontal and vertical bars) and full anisotropic case (last row). It can be
observed, that the resulting macro-structure topology, tends to arrange following the principal directions of the micro-
structure topology.

10



5.2.3. Heterogeneous material distribution
In the following set of examples, an heterogeneous distribution of material is used for a classical cantilever beam

optimal design. The contrast parameter is taken γ = 10−4. The 2x1 domain is discretized through a structured mesh
of 6272 P1 elements. The geometry is vertically partitioned in four domains with the same width (1/4). The top
and bottom regions are endowed with a constitutive tensor different from the center one (see Figures 9 and 11). The
intended volume fraction is V = 0.4 and the considered penalty value is ρ = 0.5. Again the iterative solution algorithm
is declared converged when θ < 1o and |c(ψ)| < 0.001.

- Case 1. In this example, the top and bottom regions are endowed with a microstructure topology yielding horizontally-
dominant microscopic stiffness, where the center region, microscopic topology enforces shear-dominant stiffness.

Figure 9: Heterogeneous cantilever beam with regions of different constitutive properties (enforced via microscopic material topology).

The material arrangement and distribution are sketched in Figure 9. The corresponding values for the resulting
homogenized constitutive properties are detailed in Figure 10.

Figure 10: Heterogeneous cantilever beam. Material properties and obtained results (case 1).

It is worth noting that both constitutive tensors are again anisotropic. In addition, note that the optimal topology
with the anisotropic heterogenous material distribution is quite different from the homogeneous isotropic case (first
row of Figure 8) and the homogeneous anisotropic case (last row of Figure 8). Again, it can be observed as the
macroscopic topology tends to mimic the microscopic one in the different considered regions.

- Case 2. Now the top and bottom regions are endowed with a microstructure yielding horizontally-dominant elastic
stiffness, whereas the central region is endowed with a vertically-dominant one.

Figure 11 shows an schematic picture of this case. Details of the resulting homogenized elastic properties are
given in Figure 12.

11



Figure 11: Heterogeneous cantilever beam. Material properties and obtained results (case 2)

Figure 12: Optimal heterogeneous Cantilever beam topology. Constitutive tensor value and its corresponding micro-structure representation are
also detailed.

In Figure 12, the resulting (non trivial) optimal topology obtained for this case is shown.
Regarding numerical aspects, problems of convergence of the involved numerical schemes have not been found.
Besides, no substantial differences, in terms of the involved computational effort, have been found by considering

the isotropic and anisotropic cases.. In all cases less than five minutes of computation are needed with a standard PC
(3.40GHz processor in a 64-bit architecture) in a Matlab c© environment.

6. Concluding remarks

In this work an analytical and closed-form expression for the topological derivative in heterogeneous and anisotropic
elastic problems has been presented. We consider as singular perturbation the introduction of a circular disc, with an
anisotropic constitutive tensor completely different from the background material, in an arbitrary point. From the
asymptotic analysis, it has been proven that the heterogeneous behavior of the material properties does not contribute
to the first order topological derivative. The polarization tensor for this problem is obtained from a very simple (and in-
expensive) matrix evaluation, in terms of the constitutive properties of the unperturbed problem and the inclusion. The
derived formula are general for any kind of anisotropy in two dimensional problems, where orthotropy and isotropy
(of the background material or the inclusion or a combination of both) can be derived as particular cases.

We recall that the development presented in this work for the total potential energy, in particular the solution
of the so-called exterior problem, can be applied for other cost functionals and that the derivation of the associated
topological derivative can be easily done.

With theses results in mind, the presented numerical simulation show that the selected material properties heav-
ily affect the optimal topology in an standard topology optimization problem. Since real applications involve non-
homogenous isotropic material, the obtained closed formula of the topological derivative for heterogeneous anisotropic
materials generalizes the concept of topology optimization for any kind of material properties and distribution.

In addition, a certain influence of the microscopic topology on the optimal macroscopic topology is observed
which, in some cases, becomes very relevant. This suggests a possible approach, based on the use of the anisotropic
topological derivative, to link the microscopic and macroscopic topologies in optimal topological designs. This issue
is left for future research.

12



7. Acknowledgments

The research leading to these results has received funding from the European Research Council under the European
Union’s Seventh Framework Programme (FP/2007-2013) / ERC Grant Agreement n. 320815 (ERC Advanced Grant
Project “Advanced tools for computational design of engineering materials” COMP-DES-MAT). The work of S.M.
Giusti was partially supported by Argentinean Agencies: ANPCyT (National Agency for Scientific and Technical
Promotion), PID-UTN (Research and Development Program of the National Technological University) and CONICET
(National Council for Scientific and Technical Research), under grants N PICT 2014-3372, PID/UTN 2050-2013 and
PIP 2013-631, respectively. The support of all these agencies is gratefully acknowledged.

Appendix A. Estimation of the remainders

In this Section the estimation of the remainders in the topological asymptotic expansion is performed. This
estimations has been used in the derivation of the topological derivative expression (27) presented in Section 3. In
particular, we study the asymptotic behavior of the remainder ũε in (20) and the residue E(ε) defined in (23). Let us
start by introducing the following lemma that ensures the existence of the topological derivative for the problem under
analysis:

Lemma 3. Let u and uε be solutions to (5) and (10), respectively. Then, we have that the estimate ‖uε − u‖H1(Ω;R2) =
O(ε) holds true.

Proof. We start by subtracting the variational problem (5) and (10) to obtain:
ˆ

Ω

σε(uε − u) · ∇
sη =

ˆ
Bε
Sσ(u) · ∇sη . (A.1)

with S = I − C?C−1. Now, by taking η = uε − u as test function in the above equation, we obtain the following
equality: ˆ

Ω

σε(uε − u) · ∇
s(uε − u) =

ˆ
Bε
Sσ(u) · ∇s(uε − u) . (A.2)

From the Cauchy-Schwartz and Poincaré inequality it follows that
ˆ

Ω

σε(uε − u) · ∇
s(uε − u) ≤ C1‖σ(u)‖L2(Bε;R2)‖∇

s(uε − u)‖L2(Bε;R2)

≤ C2ε‖∇
s(uε − u)‖L2(Bε;R2)

≤ C3ε‖∇
s(uε − u)‖H1(Ω;R2)

≤ C4ε‖uε − u‖H1(Ω;R2), (A.3)

where we have used the elliptic regularity of function u. Finally, from the coercivity of the bilinear form of (10),
namely

c‖uε − u‖
2
H1(Ω;R2) ≤

ˆ
Ω

σε(uε − u) · ∇
s(uε − u), (A.4)

we obtain the result with the constant C4/c independent of the small parameter ε.

Lemma 4. Let ũε be solution to (20). Then, the following estimate holds true:

‖̃uε‖H1(Ω;R2) ≤ Cε , (A.5)

with the constant C independent of the small parameter ε.

13



Proof. From the ansatz proposed in (18) for uε and making use of the triangular inequality, we obtain:

|̃uε|H1(Ω;R2) = |uε − u − εw|H1(Ω;R2)
≤ |uε − u|H1(Ω;R2) + ε|w|H1(Ω;R2)
≤ ‖uε − u‖H1(Ω;R2) + ε|w|H1(R2;R2)
≤ C1ε , (A.6)

where we have used the change of variables x = εy, the equivalence between the semi-norm and the norm in H1(Ω;R2)
and the estimate in Lemma 3. Finally, the results comes out from the Poincaré inequality.

Lemma 5. Let ũε and u be solutions to (20) and (5), respectively. Then, we have the following estimate for the
remainder E(ε) in (23):

1
2

ˆ
Bε

∆C(C?)−1σε(̃uε) · ∇su = o(ε2). (A.7)

Proof. From the Cauchy-Schwartz inequality we obtain

E(ε) =
1
2

ˆ
Bε

∆C(C?)−1σε (̃uε) · ∇su

≤ C1‖∇
su‖L2(Bε;R2)‖∇

sũε‖L2(Bε;R2)
≤ εC2‖∇

sũε‖L2(Bε;R2) . (A.8)

Note that from problem (20) that the r.h.s. depends explicitly on the small parameter ε. Therefore, since this problem
is linear and in view of Lemma 4, we can write ũε = εv0. Then, we have

E(ε) ≤ ε2C3‖∇
sv0‖L2(Bε;R2)

≤ ε3C4 . (A.9)

which leads to the result.

Appendix B. Solution of the exterior problem

In this Section we show the analytical solution of the problem presented in (19). In particular, we present the
solution of a generalized version of problem (19), namely,

div (σε(w)) = 0 in R2

σε(w) = Cε(x̂)∇sw
w → 0 at ∞
~w� = 0 on ∂B1

~σε(w)�n = S n on ∂B1

, (B.1)

where S is a symmetric second order tensor.
A general methodology to solve problem (B.1) can be constructed by using the complex variable method for

anisotropic elasticity [23, 24]. Now we briefly present the main steps to solve the above problem. A complete
description of the methodology and its application can be found in above cited books.

First we define a new coordinate system zi = x + µiy for i = 1..2, where µi are complex parameters, roots of the
following equation:

α11µ
4
− 2α13µ

3
+ (2α12 + α33)µ

2
− 2α23µ + α22 = 0 (B.2)

where αi j, with (i, j) = 1..3, are the components of C−1 (in matrix notation). Two cases are possible, depending on the
relations between the elastic constant: (i) the roots are all different: µ1, µ2, µ̄1 and µ̄2; and (ii) the roots are pairwise

14



equal: µ1 = µ2 and µ̄1 = µ̄2. Here, µ̄1 and µ̄2 denotes the complex conjugated of parameters µ1 and µ2. Based on the
previous definitions, a general expression for the stress components can be obtained as:

(σε(w))xx = 2<[µ
2
1Φ
′
1(z1) + µ

2
2Φ
′
2(z2)],

(σε(w))yy = 2<[Φ
′
1(z1) + Φ

′
2(z2)],

(σε(w))xy = −2<[µ1Φ
′
1(z1) + µ2Φ

′
2(z2)], (B.3)

with <[•] denoting the real part of [•] and the prime is used to denote the derivative for the function f (z) respect to
the variable z, i.e. f ′(z) = ∂ f /∂z. Also, the displacement components are written in term of the complex potentials Φ1
and Φ2 as:

(w)x = 2<[p1Φ1(z1) + p2Φ2(z2)] − ωy,
(w)y = 2<[q1Φ1(z1) + q2Φ2(z2)] + ωx, (B.4)

where ω characterize a rotation and the complex numbers pi and qi are:

pi = α11µ
2
i + α12 − α13µi,

qi = α12µi + α22/µi − α23, i = 1, 2 . (B.5)

The complex potentials Φ1 and Φ2 are related to the stress function F(x, y) by means of the relations:

Φ1 =
∂F
∂z1

and Φ2 =
∂F
∂z2

. (B.6)

In order to facilitate the notation, in the sequel we use the following definitions:

σeε := σε(w)|Ω\Bε and σ
i
ε := σε(w)|Bε . (B.7)

Now, by applying the traction boundary condition on ∂Bε, see (B.1)5, and in view of the fact that the stress inside
of the inclusion Bε is constant, see [33, 34], the complex potential for the solution outside Bε, can be written as:

Φ1(z1) =
1

2(µ1 − µ2)
[((σiε)xx + S xx)i − ((σ

i
ε)xy + S xy)(1 − iµ2) − ((σ

i
ε)yy + S yy)µ2]

1
ζ1

Φ2(z2) = −
1

2(µ1 − µ2)
[((σiε)xx + S xx)i − ((σ

i
ε)xy + S xy)(1 − iµ1) − ((σ

i
ε)yy + S yy)µ1]

1
ζ2
. (B.8)

where S i j and (σiε)i j are the components of tensors S and σ
i
ε, respectively, measured in the coordinate system (x, y),

and

ζk =
zk +

√
z2k − 1 − µ

2
k

1 − iµk
with k = 1, 2. (B.9)

Note that expression (B.8) indicates that the stress field outside the inclusion Bε can be explicitly obtained in terms
of the boundary condition on ∂Bε and the stress inside Bε. The components of σeε can be obtained by inserting the
potentials (B.8) in (B.3).

Next, by applying the displacement boundary condition (B.1)4, see ([24], Chapter VI, Section 41), we obtain the
following system of equations, which will define the four unknown: components of the stress σiε and the rotation of
the inclusion ω,

Ks = Fsm, (B.10)

15



where matrices K and F; and vectors s and sm are given by:

K =


−(=[κ] + α?11) −(<[λ] + α

?
12) −(<[κ] + =[λ] + α

?
13) 0

<[κ] −=[λ] <[λ] − =[κ] 1
−(=[γ] + α?13) −(<[ρ] + α

?
23) −(<[γ] + =[ρ] + α

?
33) −1

<[γ] − α?12 −(=[ρ] + α
?
22) <[ρ] − =[γ] − α

?
32 0

 (B.11)

s =


(σiε)xx
(σiε)yy
(σiε)xy
ω

 (B.12)

F =


=[κ] <[λ] =[λ] +<[κ]
−<[κ] =[λ] −<[λ] + =[κ]
=[γ] <[ρ] =[ρ] +<[γ]
−<[γ] =[ρ] −<[ρ] + =[γ]

 (B.13)
sm =


S xx
S yy
S xy

 (B.14)
In the above system of equations,<[•] and =[•] are used to denote the real and imaginary part of [•], respectively.

Also, α?i j, with (i, j) = 1..3, are the components of (C
?)−1 (in matrix notation) and the complex number ρ, λ, γ and κ

are given by:

ρ =
q1µ2 − q2µ1
µ1 − µ2

, γ =
q1 − q2
µ1 − µ2

, κ =
p1 − p2
µ1 − µ2

and λ =
p1µ2 − p2µ1
µ1 − µ2

. (B.15)

Then, in view of the system (B.10) the stress inside of the inclusion can be obtained as:
(σiε)xx
(σiε)yy
(σiε)xy

 = Asm (B.16)
where matrix A is given by the first three rows of K−1F. The components of matrix A are not explicitly given here due
to their complexity.

Finally, by rearranging (B.16), the solution of (B.1) in Bε can be written in tensorial notation as a function of the
boundary condition in ∂Bε:

σε(w)|Bε = AS , (B.17)

where components of the tensor A is related to components of the matrix A by the standard contracted notation (or
Voigt notation) using the following rules for replace the subscript:

11→ 1, 22→ 2 and 12→ 3 (B.18)

In view of the symmetries of σε(w) and S , the tensor A has the follows symmetry properties:

Ai jkl = A jikl and Ai jkl = Ai jlk. (B.19)

References

[1] A. A. Novotny, J. Sokołowski, Topological derivatives in shape optimization, Interaction of Mechanics and Mathematics, Springer-Verlag,
Berlin, Heidelberg, 2013.

[2] J. Sokołowski, A. Żochowski, On the topological derivative in shape optimization, SIAM Journal on Control and Optimization 37 (4) (1999)
1251–1272.

[3] R. Amigo, S. Giusti, A. Novotny, E. Silva, J. Sokolowski, Optimum design of flextensional piezoelectric actuators into two spatial dimensions,
SIAM Journal on Control and Optimization 52 (2) (2016) 760–789.

[4] A. J. Torii, A. A. Novotny, R. B. Santos, Robust compliance topology optimization based on the topological derivative concept, International
Journal for Numerical Methods in Engineering 106 (11) (2016) 889–903.

16



[5] H. Isaraki, K. Kuriyama, S. Harada, T. Yamada, T. Takahashi, T. Matsumoto, A topology optimisation for three-dimensional acoustics with
the level set method and the fast multipole boundary element method, Mechanical Engineering Journal 1 (4) (2014) 1–13.

[6] S. Amstutz, A. A. Novotny, E. A. de Souza Neto, Topological derivative-based topology optimization of structures subject to Drucker-Prager
stress constraints, Computer Methods in Applied Mechanics and Engineering 233–236 (2012) 123–136.

[7] J. R. de Faria, D. Lesnic, Topological derivative for the inverse conductivity problem: A bayesian approach, Journal of Scientific Computing
63 (1) (2015) 256–278.

[8] S. M. Giusti, A. A. Novotny, E. A. de Souza Neto, R. A. Feijóo, Sensitivity of the macroscopic elasticity tensor to topological microstructural
changes, Journal of the Mechanics and Physics of Solids 57 (3) (2009) 555–570.

[9] N. Van Goethem, A. A. Novotny, Crack nucleation sensitivity analysis, Mathematical Methods in the Applied Sciences 33 (16) (2010)
197–1994.

[10] G. Allaire, F. de Gournay, F. Jouve, A. M. Toader, Structural optimization using topological and shape sensitivity via a level set method,
Control and Cybernetics 34 (1) (2005) 59–80.

[11] T. Yamada, K. Izui, S. Nishiwaki, A. Takezawa, A topology optimization method based on the level set method incorporating a fictitious
interface energy, Computer Methods in Applied Mechanics and Engineering 199 (2010) 2876–2891.

[12] G. Cardone, S. Nazarov, J. Sokołowski, Asymptotic analysis, polarization matrices, and topological derivatives for piezoelectric materials
with small voids., SIAM Journal on Control and Optimization 48 (6) (2010) 3925–3961.

[13] J. Sokołowski, A. Żochowski, Optimality conditions for simultaneous topology and shape optimization, SIAM Journal on Control and
Optimization 42 (4) (2003) 1198–1221.

[14] G. Pólya, G. Szegö, Izoperimetric inequalities in mathematical physics, Princeton University Press, Princeton, 1951.
[15] H. Ammari, H. Kang, Polarization and moment tensors with applications to inverse problems and effective medium theory, Applied Mathe-

matical Sciences vol. 162, Springer-Verlag, New York, 2007.
[16] S. M. Giusti, A. A. Novotny, Topological derivative for an anisotropic and heterogeneous heat diffusion problem, Mechanical Research

Communication 46 (2012) 26–33.
[17] S. M. Giusti, L. M. A. Mello, E. C. N. Silva, Piezoresistive device optimization using topological derivative concepts, Structural and Multi-

disciplinary Optimization 50 (2014) 453–464.
[18] S. M. Giusti, A. A. Novotny, J. Sokołowski, Topological derivative for steady-state orthotropic heat diffusion problem, Structural and Multi-

disciplinary Optimization 40 (1) (2010) 53–64.
[19] E. Beretta, E. Bonnetier, E. Francini, A. L. Mazzucato, Small volume asymptotics for anisotropic elastic inclusions, Inverse Problems and

Imaging 6 (1) (2012) 1–23.
[20] S. A. Nazarov, J. Sokołowski, M. Specovius-Neugebauer, Polarization matrices in anisotropic heterogeneous elasticity, Asymptotic Analysis

68 (4) (2010) 189–221.
[21] M. Bonnet, G. Delgado, The topological derivative in anisotropic elasticity, The Quarterly Journal of Mechanics and Applied Mathematics

66 (4) (2013) 557–586.
[22] V. A. Kozlov, V. G. Maz’ya, A. B. Movchan, Asymptotic analysis of fields in multi-structures, Clarendon Press, Oxford, 1999.
[23] S. G. Lekhnitskii, Theory of Elasticity of an Anisotropic Elastic Body, Holden-Day Series in Mathematical Physics, Holden-Day, Inc., San

Francisco, California, 1963.
[24] S. G. Lekhnitskii, S. W. Tsai, T. Cheron, Anisotropic Plates, Gordon and Breach Science Publishers, New York, New York, U.S.A., 1968.
[25] S. Amstutz, H. Andrä, A new algorithm for topology optimization using a level-set method, Journal of Computational Physics 216 (2) (2006)

573–588.
[26] S. Osher, J. A. Sethian, Front propagating with curvature dependent speed: algorithms based on hamilton-jacobi formulations, Journal of

Computational Physics 79 (1) (1988) 12–49.
[27] S. Amstutz, S. M. Giusti, A. A. Novotny, E. A. de Souza Neto, Topological derivative for multi-scale linear elasticity models applied to the

synthesis of microstructures, International Journal for Numerical Methods in Engineering 84 (2010) 733–756.
[28] S. Amstutz, A. A. Novotny, Topological optimization of structures subject to von Mises stress constraints, Structural and Multidisciplinary

Optimization 41 (3) (2010) 407–420.
[29] D. E. Campeão, S. M. Giusti, A. A. Novotny, Topology design of plates consedering different volume control methods, Engineering Compu-

tations 31 (5) (2014) 826–842.
[30] C. G. Lopes, R. B. dos Santos, A. A. Novotny, Topological derivative-based topology optimization of structures subject to multiple load-cases,

Latin American Journal of Solids and Structures 12 (2015) 834–860.
[31] S. Amstutz, Analysis of a level set method for topology optimization, Optimization Methods and Software 26 (4-5) (2011) 555–573.
[32] E. Sanchez-Palencia, Non-homogeneous media and vibration theory, Vol. 127 of Lecture Notes in Physics, Springer-Verlag, Berlin, 1980.
[33] J. D. Eshelby, The determination of the elastic field of an ellipsoidal inclusion, and related problems, Proceedings of the Royal Society:

Section A 241 (1957) 376–396.
[34] J. D. Eshelby, The elastic field outside an ellipsoidal inclusion, and related problems, Proceedings of the Royal Society: Section A 252 (1959)

561–569.

17


