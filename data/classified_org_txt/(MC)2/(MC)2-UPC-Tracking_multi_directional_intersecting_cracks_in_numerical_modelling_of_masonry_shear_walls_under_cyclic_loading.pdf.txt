

























































Meccanica, Volume 53, Issue 7, pp. 1757-1776
DOI: 10.1007/s11012-017-0712-3 - Special Issue on “New Trends in Mechanics of Masonry”

Tracking multi-directional intersecting cracks in numerical
modelling of masonry shear walls under cyclic loading

Savvas Saloustros · Miguel Cervera · Luca Pelà

Received: 16 January 2017
Accepted: 8 June 2017

Abstract In-plane cyclic loading of masonry walls in-
duces a complex failure pattern composed of multiple
diagonal shear cracks, as well as flexural cracks. The
realistic modelling of such induced localized cracking
necessitates the use of costly direct numerical simula-
tions with detailed information on both the properties
and geometry of masonry components. On the contrary,
computationally efficient macro-models using standard
smeared-crack approaches often result in a poor rep-
resentation of fracture in the simulated material, not
properly localized and biased by the finite element
mesh orientation. This work proposes a possible rem-
edy to these drawbacks of macro-models through the
use of a crack-tracking algorithm. The macro-modelling
approach results in an affordable computational cost,
while the tracking algorithm aids the mesh-bias in-
dependent and localized representation of cracking. A
novel methodology is presented that allows the simula-
tion of intersecting and multi-directional cracks using
tracking algorithms. This development extends the use
of localized crack approaches using tracking algorithms

Savvas Saloustros · Miguel Cervera · Luca Pelà

Department of Civil and Environmental Engineering
Universitat Politècnica de Catalunya (UPC-BarcelonaTech)
Jordi Girona 1-3, 08034 Barcelona, Spain.

International Center for Numerical Methods in Engineering
(CIMNE)
Gran Capità, S/N, 08034 Barcelona, Spain.

E-mail: savvas.saloustros@upc.edu
E-mail: miguel.cervera@upc.edu
E-mail: luca.pela@upc.edu

to a wider field of applications exhibiting multiple, ar-
bitrary and interacting cracking. The paper presents
also a novel formulation including into an orthotropic
damage model the description of irreversible deforma-
tions under shear loading. The proposed approach is
calibrated through the comparison with an experimen-
tal test on a masonry shear wall against in-plane cyclic
loading.

Keywords Continuum Damage Mechanics · Crack-
Tracking · Cyclic Shear Loading · Intersecting Cracks ·
Masonry walls

1 Introduction

Damage in masonry appears in the form of localized
cracks. The propagation of these cracks within the
structure determines the development of the collapse
mechanism and consequently the capacity of the struc-
ture under the given loading conditions. This structural
behaviour has been taken into account for the devel-
opment of both classical and advanced analysis tools
for the structural assessment of masonry constructions
[1, 2, 3, 4].

Numerical modelling of masonry structures has un-
dergone important developments in the last decades.
The inventory of numerical methods today includes
simplified techniques such as limit analysis software
[5, 6, 7, 8], equivalent frame methods [9, 10, 11] and
macro-modelling approaches [12, 13, 14] to sophisti-
cated ones as micro-modelling [15, 16] and multi-scale
finite element models [17, 18, 19]. Simplified numeri-
cal methods, like the macro-modelling ones, consider
masonry as a continuum material with average proper-
ties. This simplification allows for the numerical anal-



2 Savvas Saloustros et al.

ysis of large scale structures at an affordable computa-
tional cost with however limited accuracy in the dam-
age representation. Reciprocally, the explicit considera-
tion of the masonry micro-structure in micro-modelling
techniques results in a more realistic representation of
cracking, at the cost of increased computation time and
memory requirements that limits up to date their appli-
cation to small structural elements rather than whole
structures.

An affordable alternative to the simulation of local-
ized cracking in large scale structures was proposed by
Cervera and co-workers [20, 21, 22]. The method bases
on the enhancement of the smeared crack approach with
the use of a crack-tracking algorithm. The outcome of
this approach is the realistic representation of evolv-
ing localized cracks within the analysed structure for a
computational cost comparable to that of the classical
smeared crack approach [23, 24].

Despite the above recent applications on masonry
structures, tracking algorithms have a long history in
the simulation of localized failure in quasi-brittle ma-
terials. They are used for the enhancement of problems
involving the progression of both weak, or smeared (e.g.
[25, 26, 22]) and strong, or discrete, discontinuities (e.g.
[27, 28, 29, 30]). Independently of the chosen approach,
their application aims to circumvent the problem of the
mesh-dependency that the irreducible standard finite
element formulation presents. An additional feature is
the realistic representation of cracking, since the lo-
calization of damage occurs within a narrow band of
the mesh. Notwithstanding the aforementioned advan-
tages, tracking algorithms are commonly designed with
important assumptions regarding the initiation, prop-
agation and completion of the simulated cracks. Such
assumptions have limited the use of these approaches to
the simulation of propagating cracks under monotonic
loading.

This paper presents a methodology to simulate ef-
ficiently the localized cracking in masonry structures
induced by in-plane cyclic loading using a contin-
uum damage mechanics model enhanced with a crack-
tracking algorithm. Cyclic loading of masonry struc-
tures may result in complex damage patterns charac-
terized by multiple and intersecting cracks. To appro-
priately model this, a novel numerical methodology is
proposed, on the basis of the tracking algorithm de-
veloped in previous works [22, 31, 32], that allows the
simulation of intersecting and multi-directional crack-
ing, extending the use of tracking algorithms to a large
field of applications. At the constitutive level, the paper
presents a novel formulation in the context of a contin-
uum damage model for the description of irreversible
deformations under shear loading.

After this introduction, the paper is organized in the
following way. Section 2 presents the used constitutive
damage model. Following that, the novel tracking algo-
rithm is detailed in Section 3. The proposed approach
is calibrated in Section 4 through the simulation of an
experimentally tested masonry wall under cyclic shear
loading. The same section addresses the issue of mesh
objectivity of the tracking algorithm. The paper ends
with the concluding Section 5.

2 Constitutive model

The material non-linearity is represented in the nu-
merical simulations through the use of the constitutive
model presented in [33]. It is a strain-based continuum
damage model with two scalar damage variables for dis-
tinguishing between tensile and compressive damage.
The decomposition of the effective stress tensor into
positive and negative parts, as well as the use of the
two damage variables, results in a unilateral effect un-
der tension-compression cyclic loading. The model can
account for irreversible deformations through a simple
and efficient algorithm, within the context of contin-
uum damage mechanics. The above properties, as well
as the limited number of involved material parameters
and the simple explicit formulation, make it a suitable
model for the seismic analysis of large concrete and ma-
sonry structures [34, 35, 36, 37].

For the sake of completeness, this section presents
the basic ingredients of the aforementioned tension-
compression damage model. The shear behaviour of the
model is carefully considered through the proper defi-
nition of the damage surfaces and the evolution of the
irreversible strains. The modelling of the irreversible
strains is achieved by improving previous formulations
mainly intended for concrete structures in [33, 34, 38].
The section ends with a discussion over the effect of the
proposed alterations to the evolution of the irreversible
deformations under shear loading.

2.1 Constitutive law

The Cauchy stress tensor (of rank two) σ is computed
in the tension-compression damage model through the
constitutive relation

σ = (1− d+) σ̄+ + (1− d−) σ̄− (1)

where d+ and d− are scalar variables denoting the com-
pressive and tensile damage affecting the positive σ̄+



Tracking multi-directional intersecting cracks in numerical modelling of masonry shear walls under cyclic loading 3

and negative parts σ̄− of the effective stress tensor re-
spectively. The latter are calculated through the distin-
guishing stress split according to [38]

σ̄+ =

3∑
j=1

〈σ̄j〉 pj ⊗ pj (2)

σ̄− = σ̄ − σ̄+ (3)

In the above equations, σj is the principal stress cor-
responding to the eigenvector pj of the effective stress
tensor σ̄ and the symbols 〈·〉 are the Macaulay brackets
(〈x〉 = x, if x ≥ 0 ,〈x〉 = 0, if x < 0).

The model uses two scalar variables τ±, the equiva-
lent stresses, to distinguish between loading, unloading
and reloading. The adopted values of τ+ and τ− de-
termine the shape of the d+ and d− damage surfaces.
In this work we have adopted the values proposed in
[19, 39]

τ+ = H [σ̄max]
1

1− a

[√
3J̄2 + aĪ1 + b〈σ̄max〉

] f+
f−

(4)

τ− = H [−σ̄min]
1

1− a

[√
3J̄2 + aĪ1 + κ1b〈σ̄max〉

]
(5)

a =

(
f−b /f

−
)
− 1

2
(
f−b /f

−
)
− 1

(6)

b = (1− a)
f−

f+
− (1 + a) (7)

In the above, f+ and f− denote the tensile and
compressive uniaxial strengths respectively and f−b the
biaxial compressive strength. Ī1 is the first invariant of
the effective stress tensor and J̄2 the second invariant of
the deviatoric effective stress tensor. Finally, σ̄max and
σ̄min stand for the maximum and minimum principal
effective stresses respectively. The use of the Heaviside
step function (H[x] = 1 if x ≥ 0 and H[x] = 0 if x < 0)
activates the τ+ for tensile and shear stress states (1st,
2nd and 4th quadrants in Figure 1), and the τ− for
compressive and shear shear stress states (2nd, 3rd and
4th quadrants in Figure 1).

The κ1 variable controls the shape of the failure
surface in the shear quadrants (i.e. 2nd and 4th quad-
rants in Figure 1). Its value varies between 0 (i.e. the
Drucker-Prager criterion) and 1 (i.e. the criterion pro-
posed in [40]). Note that the use of the Macaulay brack-
ets for σ̄max in equation (5) makes the function τ− inde-
pendent of κ1 for pure compression. This, in addition

to the fact that κ1 does not appear in equation (4),
make the tensile and compressive response in the 1st
and 3rd quadrants of Figure 1 independent of κ1. As
shown by Petracca et al. [39, 41], the different choice in
the definition of the equivalent stresses from those pro-
posed in [35, 38, 40] results in a better control of the
model behaviour under shear monotonic loading. As it
will be shown later, the choice of such surfaces in the
current model results also in the consideration of the
irreversible deformations under shear loading.

< 1
 =

 < 3

< 1
 =

 < 3

<
1
/f+

<
3
/f+

=+

Case - 1: =!(7<!)

Case - 2: =!(7<); 51 = 0:0

Case - 3: =!(7<); 51 = 0:5

Case - 4: =!(7<); 51 = 1:0

Fig. 1: Effect of the τ− function to the shape of the
d− failure surface in the shear quadrants for the plane
stress case.

Following the above, the damage criteria can be ex-
pressed as

Φ±(r±, τ±) = τ± − r± ≤ 0 (8)

where the internal variables r+ and r− represent the
current damage thresholds and the respective expansion
of the d+ and d− damage surfaces. Their initial values
are defined to be equal to the uniaxial tensile strength
r+0 = f

+ and the uniaxial compressive strength r−0 =
f−. After damage is triggered, their values are equal to
the maximum attained values by the equivalent stresses

r±n = max

[
r±0 , max

i∈(0,n)

(
τ±i
)]

(9)

with n representing the number of the current (load
/displacement) increment.



4 Savvas Saloustros et al.

The effect of the irreversible deformations is ac-
counted using the following definition of the effective
stress tensor σ̄

σ̄ = C0 : (�− �i) = C0 : �e (10)

where C0 denotes the (rank four) elastic constitutive
tensor and �i the irreversible part of the second order
total strain tensor � and �e the elastic one. Contrary to
the total strain tensor, which is an external variable of
the model, the irreversible strain tensor is an internal
variable. The following expression is proposed in this
work for the rate of the irreversible strains

�̇i = lim
∆t→∞

(
β

∆t

r−( ˜̄σ)− r−t
r−t+∆t

�et+∆t

)
(11)

or in incremental form as

∆�i = β
r−( ˜̄σ)− r−n

r−n+1
�en+1 (12)

In the above equations, n and n + 1 subscripts refer
to subsequent time steps. The symbol "∆" denotes the
increment of a specific quantity from step n to n+1.
The variables ˜̄σ and r−( ˜̄σ) represent, respectively, the
effective stress and the stress threshold in the absence
of increment of irreversible strains at time step n+ 1

˜̄σ = (σ̄|∆�i=0)n+1 = σ̄n +C0 : ∆�n+1 (13)

r( ˜̄σ) = max
[
r−n , τ

−( ˜̄σ)
]

(14)

Note that the quantity r−( ˜̄σ) − r−n is always non-
negative due to equation (14), an essential thermody-
namic requirement for ensuring non-negative dissipa-
tion. Finally, the material parameter β, with values be-
tween 0 and 1, defines the rate of the irreversible defor-
mation by scaling the current increment of the equiv-
alent stresses, and consequently the stress thresholds,
through the following equation

∆r−n+1 = r
−
n+1 − r

−
n (15a)

= (1− β) (r−( ˜̄σ)− r−n ) (15b)

It is convenient to consider the effect of the irre-
versible strains through the definition of the effective
stresses, since the Cauchy stresses are computed us-
ing the values of the effective stresses σ̄± and the two
damage variables d±. This can be performed through

the update of the effective stresses using equations (10)
and (11) in a similar way to [33]

σ̄n+1 = λ ˜̄σ (16)

λ = 1− β
(

1−
r−n

r−( ˜̄σ)

)
(17)

The computation of the effective stresses at each
increment of the analysis is presented in the flowchart
of Table 1.

(i) Compute ˜̄σ using equation (13).
(ii) Is β > 0 ?

YES: Continue to step (iii)
NO: No evolution of irreversible strains is considered.
Set σ̄n+1 = ˜̄σ and EXIT.

(iii) Calculate τ−(˜̄σ) using equation (5) and r−(˜̄σ) using
equation (14).

(iv) Compute λ using equation (17). Set σ̄n+1 = λ ˜̄σ and
EXIT.

Table 1: Flowchart for the calculation of the effective
stresses.

Following the above, the evolution of the damage
variables are defined, which in this work follow the ex-
ponential relationship proposed in [42].

d± = 1−
r±0
r±

exp

{
2H±d

(
r±0 − r

±

r±0

)}
(18)

Tension and compression evolution laws consider re-
spectively the positive G+f and negative G

−
f fracture en-

ergies, as well as the characteristic finite element width
ldis through the corresponding discrete softening pa-
rameterH±d ensuring mesh-size independent energy dis-
sipation according to the crack-band theory [43]. For
the case of tension this is [44]

H+d =
ldis

l+mat − ldis
(19)

For the case of compressive damage, the discrete
softening parameter H−d is defined as (see Appendix)

H−d =
1

1− β

(
ldis

l−mat − ldis

)
(20)

The above definition is consistent with the crack
band-width approach yielding objective results for dif-
ferent values of β by considering the contributions to



Tracking multi-directional intersecting cracks in numerical modelling of masonry shear walls under cyclic loading 5

-1

-0.8

-0.6

-0.4

-0.2

 0

-6 -5 -4 -3 -2 -1  0

σ
m

in
/f

−

εmin / (E f
−
)

β = 0.00
β = 0.50
β = 0.95

(a)

-1

-0.8

-0.6

-0.4

-0.2

 0

-6 -5 -4 -3 -2 -1  0

σ
m

in
/f

−

εmin / (E f
−
)

β = 0.00
β = 0.50
β = 0.95

(b)

Fig. 2: Effect of the choice of the discrete softening pa-
rameter for compression to the softening behaviour for
different values of β: H−d (a) using equation (20), (b)
using the formulation in [45].

the dissipated energy of the evolution of the irreversible
strains and the compressive damage. In the above, the
material characteristic length l±mat for tension and com-
pression is

l±mat =
2EG±f

(f±)
2

(21)

The use of the discrete softening parameter of equa-
tion (20) results in an objective representation of the
dissipated energy Gf−. This is illustrated in Figure 2
for the case of a cyclic uniaxial compressive loading us-
ing the proposed H−d of equation (20) instead of the
one adopted in [45], which is the negative counterpart
of equation (19). The use of the new softening modulus
(Figure 2a) results in a consistent energy dissipation
according to the input value of Gf− independently of
the choice of β.

The effect of β can now be visualised using equations
(11) and (15) for the two limit cases of β → 0; 1

β = 0 ⇒ ∆r− = r−( ˜̄σ)− r−n (22)
⇒ ∆�in+1 = 0 (23)

β → 1 ⇒ ∆r− = 0 (24)
⇒ ∆d−n+1 = 0 (25)

The first case, with β = 0, recovers the standard con-
tinuum damage mechanics model without any evolu-
tion of irreversible strains. Contrariwise, for β → 1 the
effective stresses are updated such that there is no evo-
lution of the equivalent stress τ− and correspondingly
r−. For this case, there is no compressive damage evolu-
tion and the total incremental strains at this step will
be irreversible. A value of β within 0 and 1, gives a
proportional evolution of both irreversible strains and
compressive damage. The above effect is illustrated in
Figure 2a.

2.2 Irreversible strains under shear loading

As implied by their definition in equation (11), irre-
versible strains �i are influenced by the selection of the
compressive damage criterion and thus of the compres-
sive equivalent stress τ−. This means that the evolution
of the irreversible strains is possible only when the com-
pressive damage is increasing. The effect of this choice is
investigated here locally under pure shear. The assumed
material parameters for this demonstrative example are
presented in Table 2.

For comparison purposes, four cases have been con-
sidered with different definitions of τ−. In the first one,
referred hereafter as Case-1, the τ− is calculated us-
ing only the negative effective stress tensor (J̄2

−
, Ī1
−
,

σ−max, σ
−
min) as

τ− = H
[
−σ̄−min

] 1
1− a

[√
3J̄2
−

+ aĪ1
−

+ b〈σ̄−max〉
]
(26)

The above definition using the negative part of the
effective stress tensor, results in an “open” d− damage
surface in the shear quadrants, as shown in Figure 1
for the plane-stress case. This means that in this local
test, compressive damage under pure shear is triggered
only when the minimum principal stress reaches the
uniaxial compressive strength of the material. For the
other three cases, the equivalent stress of Eq. (5) is used
that is a function of the total effective stress tensor (σ̄)
with κ1=0.0; 0.5; 1.0 for Case-2, Case-3 and Case-4,



6 Savvas Saloustros et al.

f+ f− G
+
f G

−
f E v β

[MPa] [MPa] [J/m2] [J/m2] [MPa] [−] [−]

0.2 5.0 50.0 10000 3500 0.2 0.50

Table 2: Material parameters used in the elemental shear tests.

-2

-1.5

-1

-0.5

 0

 0.5

-3 -2.5 -2 -1.5 -1 -0.5  0  0.5  1

S
h
e
a
r 

st
re

ss
 τ

x
y
 [

M
P

a
]

Shear strain γxy × 1000

Case - 1: τ−(σ- −)

A

C

O ≡ D

E

 B,F = ∅ 
-2

-1.5

-1

-0.5

 0

 0.5

-3 -2.5 -2 -1.5 -1 -0.5  0  0.5  1

S
h
e
a
r 

st
re

ss
 τ

x
y
 [

M
P

a
]

Shear strain γxy × 1000

Case - 2: τ−(σ- ) - κ1 = 0.0

A

C

O ≡ D

E

F

 B = ∅ 

(a) (b)

-0.15

-0.1

-0.05

 0

 0.05

 0.1

 0.15

 0.2

 0.25

 0.3

-3 -2.5 -2 -1.5 -1 -0.5  0  0.5  1

S
h
e
a
r 

st
re

ss
 τ

x
y
 [

M
P

a
]

Shear strain γxy × 1000

Case - 3: τ−(σ- ) - κ1 = 0.5

O

A

B

C

D

E ≡ F
-0.15

-0.1

-0.05

 0

 0.05

 0.1

 0.15

 0.2

 0.25

 0.3

-3 -2.5 -2 -1.5 -1 -0.5  0  0.5  1

S
h
e
a
r 

st
re

ss
 τ

x
y
 [

M
P

a
]

Shear strain γxy × 1000

Case-4: τ−(σ- ) - κ1 = 1.0

O

A ≡ B

C

D

E ≡ F

(c) (d)

Fig. 3: Response under shear reverse loading for different assumptions about the compressive damage criterion.
(a) Case -1 (τ− = τ−(σ̄−)), (b) Case - 2 (τ− = τ−(σ̄) and κ1 = 0.0), (c) Case - 3 (τ− = τ−(σ̄) and κ1 = 0.5), (d)
Case - 4 (τ− = τ−(σ̄) and κ1 = 1.0). Point A: Triggering of tensile damage, Point B: Triggering of the compressive
damage, Point C: Maximum shear deformation for the first stage of the loading, Point D: Irreversible deformation
for τxy = 0, Point E: Activation of the tensile damage, Point F: Activation of the compressive damage.

respectively. The shapes of the four damage surfaces
are presented qualitatively in Figure 1. Each case has
been subjected to a shear deformation composed of two
stages: (a) loading up to a shear strain of γxy = 0.5 ×
10−3 and unloading to zero, (b) loading up to a shear
strain of γxy = −2.5× 10−3.

Figure 3 presents the response under shear for the
four different cases. The letters appearing in the graphs
refer to the following conditions occurring during the

two loading stages: Point “A” triggering of tensile dam-
age, Point “B” triggering of compressive damage, Point
“C’ maximum shear deformation for the first stage of
loading, Point “D” Irreversible deformation for τxy = 0,
Point “E” activation of the tensile damage during the
second stage of loading, Point “F” activation of the com-
pressive damage during the second stage of loading.

The part O-A in all graphs is the same and it repre-
sents the linear behaviour until reaching the d+ damage



Tracking multi-directional intersecting cracks in numerical modelling of masonry shear walls under cyclic loading 7

surface. After this point, the response in the four mod-
els depends on the specific assumption of the negative
equivalent stress τ−, i.e. to the specific shape of the d−

failure surface in the the second and fourth quadrants of
Figure 1. For Case-1 and Case-2, the compressive fail-
ure criterion Φ− is not reached for the given maximum
shear strain of γxy = 0.5 × 10−3. This results in the
increase of the shear capacity during the loading path
A-C (see Figures 3a-b). An additional consequence of
this is that there is no evolution of irreversible strains
since the d− failure surface is not reached (paths C-
D in Figures 3a-b). On the contrary, evolution of ir-
reversible strains occurs for both Case-3 and Case-4,
since there is evolution of the compressive damage d−

within the loading path A-C (Figures 3c-d). In Case-4,
the overlapping of the tensile d+ and compressive d−

failure surfaces results in the triggering of the tensile
and compressive damage at the same time (B ≡ C) and
in the earlier evolution of the irreversible strains. For
this reason, the unloading path (C-D, Figures 3c-d) is
less sharp than the one in Case-3, resulting in larger
irreversible strains.

The damage occurring during the first stage of a
cyclic static loading analysis (O-D path) has an im-
portant effect during the reverse loading at the second
stage. The stiffness during the reverse loading depends
on the d+ and d− values attained during the first stage
of the cyclic loading analysis. Damage increases once
again when the effective stresses τ± overcome again the
attained thresholds r± (Point E for d+ and Point F for
d−). For Case-3 and Case-4, this happens at the same
increment for both τ± (E ≡ F in Figures 3c-d). The
capacity of Case 2 keeps increasing up to the satisfac-
tion of the failure criterion Φ− (Point F, Figure 3b).
However, this does not happen for Case-1, resulting in
an increasing shear capacity.

The above analyses show that the description of the
unilateral effect under shear cyclic loading, and thus
the definition of the unloading stiffness, requires the
careful calibration of the equivalent stresses τ± as well
as the magnitude of the irreversible strains through the
β parameter.

3 A tracking algorithm for intersecting and
multi-directional cracks

The simulation of localized cracks within the macro-
modelling approach is achieved through the use of a lo-
cal crack-tracking algorithm. The aim of the algorithm
is to identify the elements crossed by propagating cracks
at each time/load increment. The crack is then simu-
lated through the use of a nonlinear stress-strain rela-

tionship for the elements within the crack path, while
the ones outside maintain a linear elastic response.

Tracking algorithms are used in different numeri-
cal approaches developed for the simulation of localized
cracks in quasi-brittle materials (see [46]). Despite the
diversity of the applied fields, their function is always
the same, i.e. localization of strains in a limited part of
the structure, where cracks are expected to propagate.
The methodology used here is based on the algorithm
presented in [20, 21, 22, 32]. The local nature of this
crack-tracking technique enables the identification of
the crack trajectories from information already avail-
able at each step of a finite element analysis, i.e. the
stress state of each finite element. In this way, compu-
tational cost, in terms of time and memory resources,
is kept to values comparable to the classical smeared
crack approach (see [32]). This strategy aims to a good
balance between accuracy and efficiency, which is of pri-
mary importance in problems involving multiple and
intersecting cracks, as is the case of cyclic loads in ma-
sonry structures.

This section presents the novel developments mak-
ing possible the simulation of intersecting and multi-
directional cracks using a local crack-tracking algo-
rithm. The new algorithm is a further development of
the one presented in [32], allowing the modelling of arbi-
trary cracking, starting from the boundary or the inte-
rior of the analysed structure and propagating towards
one or two directions. The latter enhancement is fun-
damental to simulate the response of structures expe-
riencing multiple and diverse cracking due to flexural,
tensile or shear stress states.

The following of this section focuses on the details
of the novel algorithm. Firstly, a general introduction
on the tasks of the tracking algorithm is presented. This
is followed by the up to date assumptions regarding the
modelling of crack initiation under monotonic loading.
Modelling of crack propagation and intersection is pre-
sented in section 3.3. Finally, the section closes with the
novel approach to simulate multi-directional cracking.

3.1 Structure of the tracking algorithm

The crack-tracking algorithm presented here is called
at the beginning of each numerical increment before
the calculation of the stress-state and has two tasks:
(a) to identify the origin of new cracks and (b) to rec-
ognize the crack path and the finite elements pertaining
to it. The output of the crack-tracking subroutine is a
flag system used to distinguish elements within a crack-
path from those outside. In this way, the two groups of
elements follow different constitutive behaviour. Here,
the continuum damage model presented in Section 2 is



8 Savvas Saloustros et al.

Fig. 4: Illustration of the crack propagation and use of the maximum curvature criterion for a new internal crack.

used for the elements within a crack, while for the rest
a linear stress-strain relationship is maintained.

3.2 Crack initiation I - Monotonic Loading

New cracks originate from elements that satisfy the fail-
ure condition as defined by Eq. (8). No restrictions are
posed to the location of the crack origins in the used
mesh as presented in [32]. For cracks initiating at corner
or at internal elements, the centroid of the triangular
element is selected as the crack origin. For the case of
a crack starting at an element with one side on the
boundary, the crack origin is located at the midpoint
of the boundary edge. A minimum distance is defined
between existing and new cracks, referred hereafter as
exclusion radius rexcl [22]. If two finite elements satisfy
the failure criterion at the same time/load increment
and the distance between them is less than the exclu-
sion radius, the one with the highest value of the tensile
equivalent stress τ+ (see Eq. (4)) is selected as a crack
origin. The value of the exclusion radius can be defined
according to the structural problem or the fabric of the
material analysed as shown in [22, 23, 32]. Apart from
this functionality, the definition of an exclusion radius
averts the initiation of secondary spurious cracking sur-
rounding the crack-tip [27, 47], a pathology that may
spoil the correct damage localization.

3.3 Crack propagation and Crack intersection

The propagation direction is defined as orthogonal
to the direction of the maximum principal effective
stresses. This direction is calculated for each element at
the crack front (crack tip element) using a stress tensor
constructed from the average values of the stresses at
the nodes of each element. Starting from the crack en-
try point, and using a vector with the aforementioned
direction (Ve in Figure 4), the next potential element of
the crack is identified and the crack entry coordinates
are saved. Figure 4a presents an example with the prop-
agation of an internal crack, while in Figure 4b shows a
detail of the crack propagation and the crack entry co-
ordinates on the wake of a crack tip. If the crack origin
is an element lying on the boundary of the structure,
the crack propagates in a single direction. This is the
case of the flexural cracks at the corner of openings
or at the base of piers. On the contrary, shear cracks
can initiate from the interior of a masonry wall or a
spandrel. To allow this, when the tracking algorithm
recognizes that the crack origin is an element at the in-
terior of the structure, the propagation of the crack is
monitored towards two opposite orientations, as shown
in Figure 4a. In this way, both shear and flexural cracks
can be adequately modelled, as in the masonry frame
wall presented in Figure 5.

In structures experiencing multiple cracking, it is
unavoidable that cracks will meet other cracks during



Tracking multi-directional intersecting cracks in numerical modelling of masonry shear walls under cyclic loading 9

x

y

z

0.2
0.1

0.3
0.4
0.5
0.6
0.7

TENSILE  DAMAGE

0.8

1
0.9

0

GiD
x

y

z 1.2407e-07
0.035
0.07
0.105

Si-STRAINS

0.14
0.175

0.35
0.315
0.28

0.21
0.245

GiD

(a) (b)

Fig. 5: Example of flexural and shear localized cracks in a masonry frame simulated under in-plane horizontal
loading using the crack-tracking algorithm in [32]: (a) Tensile damage contour, and (b) Maximum principal strains
at the end of the analysis.

their propagation. The assumption used in [22, 32] that
a crack is complete when meeting another crack at its
propagation front is reconsidered in this work in order
to provide a realist simulation of intersecting cracks in
cyclic in-plane loading of shear walls. In the proposed
algorithm, a crack continues unimpeded its evolution
following the same procedure as if the crack-tip was not
a part of another crack. The crack direction is identified
as orthogonal to the direction of the maximum principal
effective stresses of each finite element and the next
elements of the crack are sought. An example of such
case is presented in the following section.

In order to avoid sudden changes in the crack di-
rection due to the poor estimation of the stresses aris-
ing from the use of standard finite elements, a correc-
tion of the crack propagation can be opportunely ap-
plied through the use of a maximum curvature criterion
[20, 21, 22]. This criterion compares the crack propa-
gation direction of the crack-tip element Ve with the
average crack direction Vc (Figure 4a). The latter is
obtained as the average sum of the propagation direc-
tions of the elements in the crack path lying within
a distance lower than rneigh from the crack-tip. If the
propagation direction diverges with an angle α larger
than αmax, then the next element of the crack is sought
using the average crack direction Vc instead of Ve. This
correction is illustrated in Figure 4. The value of the
rneigh defines the length of the crack behind the crack
tip that will be considered in the computation of the
vector Vc (see Figure 4a). The maximum curvature an-
gle αmax determines the margins of the allowed crack
rotation. The effect of these numerical parameters, as
well as the criteria for their determination, are detailed
in [22, 32].

(a) (b) (c)

Active crack Inactive crack

Fig. 6: Example of cracking under the shear loading
of a wall: (a) Opening of one crack during the loading
towards the left, (b) closing of the crack when returning
to the initial configuration and (c) opening of a second
crack, diagonal to the first during the reverse loading.

3.4 Crack initiation II - Multi-directional cracks

The criteria for crack initiation, presented in section
3.2, define that new cracks can start from a certain dis-
tance from existing ones, which is determined by the ex-
clusion radius rexcl. This procedure is robust for struc-
tural cases with monotonic loading, where the crack di-
rections do not show sudden changes during the loading
history (see previous works [22, 23, 31, 32]). However,
cyclic loading, such in earthquakes or wind loads, may
inducemulti-directional cracking to the structure, refer-
ring to cracks initiating in the same region of existing
cracks but with a different direction. To illustrate this,
consider the simplified case of a shear wall (Figure 6)
subjected to cyclic shear loading at its top (restrain-
ing the rotation). The top displacement towards the
left produces a shear crack, starting from the middle
of the wall and propagating towards its two ends (Fig-
ure 6a). The reversal of the loading cycle finds the wall
at its initial configuration with the crack closed (Fig-
ure 6b). The loading in the opposite direction results in
the opening of a new crack that propagates diagonally



10 Savvas Saloustros et al.

Fig. 7: Crack propagation in the middle of a shear wall: (a) propagation of a shear crack for the loading towards
the left, (b) deactivation of the crack due to the change in the stress state, (c) initiation and propagation of a
second crack next to the inactive one.

towards the other two corners (Figure 6c). If the first
crack is completely closed, the structural condition be-
fore the opening of the two cracks will very be similar
resulting to the possible origin of the second crack very
close to the origin of the first one.

The accurate simulation of such cases needs a dif-
ferent approach regarding crack initiation from the one
presented in Section 3.2. For the specific case of the
shear wall in Figure 6, this approach must allow the
initiation of the second crack at the finite element that
satisfies the failure criterion after the reversal of the
loading cycle, independently of its distance to the closed
crack.

The modelling of cases involving the initiation of
cracks due to different stress-states at a region of ex-
isting cracks is possible through the categorization of
cracks into “active” and “inactive”. Prior to the defini-
tion of these two categories, two new versors are intro-
duced:

– Crack direction v̂cr: a versor denoting the average
direction of a consolidated crack. The crack direc-
tion of a crack is calculated using the crack entry
coordinates at each element within the total length
of the crack.

– Crack closure direction v̂cl: a versor denoting the
average direction orthogonal to the maximum prin-

cipal effective stress of all the elements within the
crack. This versor shows the average crack propaga-
tion direction of all the elements within a crack at
each time/load increment of the analysis.

These two versors are updated at the end of each
time/load increment for each of the consolidated cracks.
A crack i is defined as “active” if the angle between its
crack direction versor v̂icr and its crack closure direction
versor v̂icl is lower than a predefined limit angle alim.
The crack status is alternatively expressed through the
use of the following function

Hi[|v̂icr·v̂
i
cl|−cos(alim)] =

{
0 Inactive crack
1 Active crack

i = 1, Ncr

(27)

where (·) is the dot product, the subscript i = 1, Ncr is
used to denote the versor values for each crack of the
total existing cracks Ncr and H[•] is the Heaviside step
function.

Following the above, an element will be the crack
origin when all of the following criteria are satisfied:

(i) The failure condition, as defined by the constitutive
model (Eq. 8), is reached.



Tracking multi-directional intersecting cracks in numerical modelling of masonry shear walls under cyclic loading 11

(ii) There is no “active” crack within a distance defined
by the exclusion radius rexcl.

This means that new cracks can initiate at locations
where the current stress-state has resulted in the clos-
ing of the pre-existing cracks. To illustrate this, Figure
7 illustrates how the algorithm models the two shear
cracks at the middle of the wall for the example of Fig-
ure 6. Figure 7a shows the stress-state within the crack
at the moment of the opening of the crack during the
movement towards the left. The two versors of the crack
(v̂cr and v̂cl, shown in one of the two crack-tips of the
crack) coincide, as the crack direction has been defined
according to the crack-propagation direction of each el-
ement within it. The crack is active and can continue
its propagation. Figure 7b presents the stress state for
a step during the reversal of the cycle. The wall is now
deforming towards the right and the existing crack is
closed. This can be seen by the direction of the prin-
cipal effective stresses which have rotated comparing
to when the crack was open. The crack closure (v̂cr)
and crack direction versors (v̂cl) form an angle which is
greater than the limit angle αlim. The existing crack is
therefore identified as inactive, and new cracks are al-
lowed to open. This happens at a later instance, shown
in Figure 7c, when a crack initiates very close to the
existing crack and propagates thereafter.

The use of a limit angle as a way to identify the clo-
sure of existing cracks and the possibility of new ones
to open resembles the concept used to model multiple
cracks at constitutive level in the smeared crack mod-
els by de Borst and Nauta [48]. A similar concept was
used also by Song & Belytschko aiming to model crack
branching for propagating cracks [47] under dynamic
fracture. Likewise, the limit angle introduced in this
work (αlim) is a numerical parameter aiming to deac-
tivate the use of the exclusion radius when the strain
state of the crack has exceeded the margins set by equa-
tion (27) and thus to allow new cracks to emerge close
to existing ones.

4 Numerical simulation of a shear wall under
cyclic loading

4.1 Experimental and numerical set-up

In this section, the proposed numerical model is cal-
ibrated through the comparison with an experimen-
tal case study. The test was performed by Antoine et
al. [49] and considers the in-plane response of a ma-
sonry wall under quasi-static shear loading. The wall
has a width of 1.00 m and a height of 1.35 m, while

its thickness is 0.25 m. The masonry is constructed us-
ing an English bond pattern with unit dimensions of
55 × 120 × 250 mm3 and 10 mm mortar joint thick-
ness. A vertical load of 150 kN was distributed at the
top part of the wall and was maintained constant during
the whole experiment, aiming to represent gravitational
loading acting on the top of the masonry wall during
a seismic event. The seismic action was reproduced by
applying an horizontal displacement at the top of the
wall. Proper boundary conditions were applied to avoid
its top and bottom rotation. Figure 8a shows a sketch of
the experimental set-up adopted during the execution
of the cyclical shear tests.

The experimentally obtained shear load against dis-
placement graph is presented in Figure 8b. The wall
presents the typical behaviour for shear dominating fail-
ure. This is characterised by an overall drop in the ca-
pacity with increasing load cycles and appreciable en-
ergy dissipation throughout the whole loading history,
as represented by the area of the hysteretic cycles of
the load-displacement curve. The quasi-brittle charac-
ter of the shear failure is due to the decrease of strength
produced by the formation of two systems of crossing
diagonal cracks in the wall [49, 50].

In this work, the experiment is reproduced by using
the continuum damage model and the crack-tracking
algorithm presented in Sections 2 and 3. The wall has
been discretized using 3-noded constant-strain triangles
(2836 nodes). The material parameters are presented
in Table 3. The compressive strength, the density and
the Young’s modulus are equal to the values obtained
through experimental tests on stack bond prisms re-
ported in [51, 50]. The rest of the mechanical proper-
ties of the materials, and the parameters of the con-
stitutive model have been chosen in order to calibrate
correctly the shear response of the material, on the basis
on the discussion presented in Section 2.2. To this aim,
a value of κ1 = 0.15 has been chosen which is similar
to the value used in other available studies on masonry
shear walls [19, 39, 41]. Regarding the crack-tracking
parameters, the exclusion radius has been set equal to
rexcl = 0.20 m, which is a value between the length
and the width of the masonry units. The limit angle
used for the activation-deactivation of the cracks un-
der the cyclic loading is αlim = 40◦. This value means
that three additional cracks with an orientation vary-
ing by 40◦ can initiate next to an existing crack. To
visualize this, and considering that the exclusion ra-
dius has been defined equivalent to the units size, the
above value implies that a total of four cracks with
different orientations can initiate from the same unit.
For the investigated case of a shear wall under cyclic
loading, this value seems reasonable as it can allow



12 Savvas Saloustros et al.

(a) (b)

Fig. 8: (a) Experimental set-up and (b) experimentally obtained force against displacement graph of the tested
masonry wall. Pictures adapted from [49].

f+ f− G
+
f G

−
f E ρ v β κ1

[MPa] [MPa] [J/m2] [J/m2] [MPa] [kg/m3] [−] [−] [−]

0.15 6.2 80.0 14000 1490 1750 0.2 0.95 0.15

Table 3: Material parameters for the masonry shear wall.

the formation of diagonal cracking due to shear fail-
ure. The parameters for the maximum curvature crite-
rion are αmax = 25◦, rneigh = 0.60 m. These values of
the parameters showed to be adequate to avoid sudden
changes in the crack direction as reported in previous
works of the authors [22].

The wall has been analysed under plane stress con-
ditions and the simulation has been performed in two
stages. The first one includes the application of the self-
weight and the vertical compressive load at the top of
the wall. In the second stage, a cyclic horizontal dis-
placement is applied at the top of the wall with in-
creasing magnitude, as in the experiment. Vertical dis-
placement at the top is restrained, precluding the rota-
tion of the wall. The numerical solution is performed in
an incremental manner. At each time/load increment,
the nonlinear equations are solved with the use of a
modified Newton-Raphson (using the secant stiffness
matrix). Convergence is achieved when the ratio be-
tween the norm of the iterative residual forces and the
norm of the total external forces is lower than 10−2.
Calculations are performed using an enhanced version
of the finite element software COMET [52], while pre-
and post-processing with GiD [53], both developed in
CIMNE, Barcelona.

4.2 Numerical results

Figure 9 presents the contours of the tensile d+ and
compressive d− damage indices, as well as that of the
maximum principal strains at the end of the analy-
sis. The wall is dominated by diagonal shear cracking,
which is in agreement with the reported experimental
damage pattern [49, 50]. There is evidence of flexural
cracking at the lower and bottom parts of the wall, as
well as at the two sides. Despite the opened cracks dur-
ing the loading history, the main degradation of the
wall is concentrated at the two diagonal cracks that
have opened in the middle of the wall, as shown by
the contour of the maximum principal strains. The use
of the crack-tracking algorithm results in a very clear
representation of the localized cracks, aiding the iden-
tification of the occurring collapse mechanism at the
wall.

Figure 10a presents the damage evolution and Fig-
ure 10b the state of the cracks for the opposite top
displacements of the first cycle. For demonstration pur-
poses, the contour value 1 (red) is used for the active
cracks and -1 (white) for the inactive ones, while the
elements outside of the crack maintain value equal to
0 (orange) (Figure (10b)). It is visible that all cracks
are active for the maximum displacement of the first
cycle with a loading direction towards the right. Two
flexural cracks at the two corners of the wall consist the



Tracking multi-directional intersecting cracks in numerical modelling of masonry shear walls under cyclic loading 13

(a) (b) (c)

Fig. 9: Contours of: (a) the d+ damage index, (b) the maximum principal strains at the end of the analysis, (c)
the d− damage index at the end of the analysis.

(a)

(b)

Fig. 10: (a) Tensile damage contour d+ and (b) crack state during the first loading cycle for the maximum
displacement towards the right (left column) and the maximum displacement towards the left (right column)
(deformed mesh ×100).

first occurring damage. After those, a shear crack ini-
tiated at the middle of the wall (left column of Figure
10). The results with the same top displacement but
opposite direction are presented in the right column of
Figure 10. All the previously opened cracks have now
closed and are correctly identified as inactive. New hor-
izontal cracks appear at the two opposite corners, as
well as a diagonal shear crack at the middle of the wall,
intersecting the existing crack. The proposed approach

is capable to simulate both the correct initiation of new
cracks close to the existing ones, as well as their inter-
section.

Figure 11 presents the damage pattern during the
loading cycle with a maximum displacement at the top
equal to δ = ± 3.0mm. After the initial damage shown
in Figure 10, additional shear cracks have opened, with
the deformation, however, localizing at the initial diag-
onal crack at the middle of the wall (see center column



14 Savvas Saloustros et al.

(a)

(b)

Fig. 11: Contours of tensile d+ damage (left), maximum principal strains (center) and crack state (right) for a top
displacement of 3.0 mm towards the right (a) and left (b), (deformed mesh ×50).

of Figure 11). Some flexural cracks initiate at the two
lateral sides of the wall and propagate horizontally to-
wards the interior. Note that the cracks opened during
an opposite loading direction have been correctly iden-
tified as closed (right column in Figure 11).

-110

-90

-70

-50

-30

-10

 10

 30

 50

 70

 90

 110

-10 -5  0  5  10

F
o

rc
e
 (

k
N

)

Displacement (mm)

Experimental Envelope
Numerical Result

Fig. 12: Force against horizontal displacement graphs
for the masonry shear wall obtained through the nu-
merical analysis.

The response of the simulated wall in terms of hori-
zontal load against horizontal displacement is presented
in Figure 12. The numerical simulation captures the

shear failure of the wall, which is characterized by an
overall softening branch and stiffness degradation af-
ter exceeding the maximum capacity. The first cycles
of the loading are characterized by an almost linear be-
haviour, due to the small amount of damage as shown
in Figure 10. A significant drop in the capacity occurs
after the complete degradation of the diagonal cracks at
the middle of the wall, which occurs during the loading
cycles with the maximum displacement of 3.0 mm, as
in the experiment. After that, the increase of the dis-
placement results in the drop of the stiffness due to the
degradation of the additional shear cracks, yielding the
final damage pattern and strain state of Figure 9.

The used constitutive model is able to represent sat-
isfactorily the cyclic damaging behaviour of the wall.
The slight underestimation of the magnitude of the ex-
perimental envelope of the hysteretic loops is due to
the specific nature of the used damage model, with the
association of the evolution of the irreversible strains
to only that of the compressive damage variable d−.
In fact, as can be seen in Figure 9c, compressive dam-
age d− appears only at the two diagonal cracks at the
middle of the wall, making them the only source of the
irreversible deformations.



Tracking multi-directional intersecting cracks in numerical modelling of masonry shear walls under cyclic loading 15

δmax = 15mm δmax = 30mm δmax = 45mm δmax = 70mm

(a)

(b)

Fig. 13: The used discretization (first column) and the contours of the tensile damage at the end of the various
cycles with increasing maximum displacement δmax: (a) Mesh-A, (b) Mesh-B

4.3 Mesh-dependency study

The tracking algorithm has shown to improve the mesh
objectivity in structural analyses of small [22, 31, 32]
and large scale structures [54] with monotonically prop-
agating cracks. In this section, the shear wall is anal-
ysed with an additional mesh aiming to study the mesh
dependency of the presented approach for the more de-
manding case of cyclic loading. The first column of Fig-
ure 13 shows the different discretization used in the
mesh dependency analyses. The first mesh, denoted
hereafter as Mesh-A, is mesh used for the aforemen-
tioned results with 5470 elements. The second mesh,
Mesh-B, presents a constant structured pattern in the
greatest part of the wall with equilateral triangles mak-
ing angles of 30◦, 90◦ and 150◦ with the horizontal axis
and has a lower number of elements (3704) compared
to Mesh-A.

The different columns of Figure 13 present the dam-
age pattern at the end of the different cycles during
the loading history. Diagonal shear cracking dominates
the main part of the wall in both cases, while flexural
cracks appear at the boundaries. The damage pattern
is very similar for the greatest loading history of the
wall, with some differences occurring in the last cycles,
during which the coarser mesh (Mesh-B) presents some
additional shear cracking.

-110

-90

-70

-50

-30

-10

 10

 30

 50

 70

 90

 110

-10 -5  0  5  10

F
o

rc
e
 (

k
N

)

Displacement (mm)

Mesh A
Mesh B

Fig. 14: Horizontal force against displacement at the
top of the wall for Mesh-A and Mesh-B

Figure 14 illustrates the force against the applied
displacement graphs for the two meshes overlapped.
The two analyses bare important similarities. The pre-
dicted capacity of the wall shows a variation of less than
3% and is attained at the second loading cycle for a
displacement of 3.0 mm. Following that, the structure
presents a softening response with dropping capacity
and energy dissipation due to the further opening of
the cracks. As presented in Figure 13, after the first two



16 Savvas Saloustros et al.

loading cycles most of the cracks have already formed,
and the diagonal cracks at the middle of the wall as well
as the boundary cracks at the top and bottom ends of
the wall have completely opened. Upon this point, the
numerical responses reflect the small differences regard-
ing the positions of the cracks and the appearance of
more cracks at the coarser mesh (Mesh-B), slightly al-
ternating the residual response of the wall.

5 Conclusions

This paper has presented the enhancement of the
macro-modelling finite element method with a crack-
tracking algorithm for the simulation of the behaviour
of masonry structures under in-plane cyclic loading. A
novel methodology has been proposed to simulate inter-
secting and multi-directional cracks that occur in ma-
sonry under cyclic actions with a local crack-tracking
technique. This has been achieved by setting suitable
crack opening/closure criteria in the numerical algo-
rithm. Cracking is represented at a local level using a
continuum damage model with distinct representation
of tensile and compressive damage. The constitutive
model has been formulated to include the description of
the evolution of irreversible deformations in a simplified
way.

The enhanced macro-model has been used to sim-
ulate an experimentally tested shear masonry wall un-
der cyclic quasi-static loading. The tracking algorithm
has shown to be capable to simulate shear and flexu-
ral cracks propagating in multiple directions and inter-
secting among them. The results show that the used
constitutive model can represent correctly the gradual
decrease of the structural capacity during the cyclic
loading process. The proposed approach can therefore
properly account for complex damage typologies when
cracks appear and propagate under shear cyclic condi-
tion.

The paper includes a discussion at constitutive level
regarding the evolution of the irreversible strains under
shear loading. A simple and explicit algorithmic formu-
lation, together with a proper definition of the com-
pressive damage surface, allow to consider the effect of
irreversible strains both under shear and compression
stress states.

Compliance with ethical standards

Conflict of interest The authors declare that they
have no conflict of interest.

Funding This research has received the financial sup-
port from the MINECO (Ministerio de Economia
y Competitividad of the Spanish Government) and
the ERDF (European Regional Development Fund)
through the MULTIMAS project (Multiscale tech-
niques for the experimental and numerical analysis
of the reliability of masonry structures, ref. num.
BIA2015-63882-P).

References

1. S. Huerta, “The Analysis of Masonry Architecture:
A Historical Approach,” Architectural Science Re-
view, vol. 51, no. 4, pp. 297–328, 2008.

2. P. Roca, M. Cervera, G. Gariup, and L. Pelà,
“Structural Analysis of Masonry Historical Con-
structions. Classical and Advanced Approaches,”
Archives of Computational Methods in Engineer-
ing, vol. 17, pp. 299–325, jul 2010.

3. D. Theodossopoulos and B. Sinha, “A review of
analytical methods in the current design pro-
cesses and assessment of performance of masonry
structures,” Construction and Building Materials,
vol. 41, pp. 990–1001, 2013.

4. D. Addessi, S. Marfia, E. Sacco, and J. Toti, “Mod-
eling Approaches for Masonry Structures,” The
Open Civil Engineering Journal, no. 2, pp. 288–300,
2014.

5. A. Orduña and P. B. Lourenço, “Cap Model
for Limit Analysis and Strengthening of Masonry
Structures,” Journal of Structural Engineering,
vol. 129, no. 10, pp. 1367–1375, 2003.

6. P. Block, T. Ciblac, and J. Ochsendorf, “Real-time
limit analysis of vaulted masonry buildings,” Com-
puters & Structures, vol. 84, pp. 1841–1852, nov
2006.

7. M. Gilbert, C. Casapulla, and H. Ahmed, “Limit
analysis of masonry block structures with non-
associative frictional joints using linear program-
ming,” Computers & Structures, vol. 84, pp. 873–
887, may 2006.

8. G. Milani, P. Lourenço, and A. Tralli, “Ho-
mogenised limit analysis of masonry walls, Part I:
Failure surfaces,” Computers & Structures, vol. 84,
pp. 166–180, jan 2006.

9. P. Roca, C. Molins, and A. R. Marí, “Strength Ca-
pacity of Masonry Wall Structures by the Equiv-
alent Frame Method,” Journal of Structural Engi-
neering, vol. 131, no. 10, pp. 1601–1610, 2005.

10. S. Lagomarsino, A. Penna, A. Galasco, and S. Cat-
tari, “TREMURI program: An equivalent frame
model for the nonlinear seismic analysis of ma-



Tracking multi-directional intersecting cracks in numerical modelling of masonry shear walls under cyclic loading 17

sonry buildings,” Engineering Structures, vol. 56,
pp. 1787–1799, 2013.

11. R. Siano, V. Sepe, G. Camata, E. Spacone, P. Roca,
and L. Pelà, “Analysis of the performance in the lin-
ear field of Equivalent-Frame Models for Regular
and Irregular Masonry Walls,” Engineering Struc-
tures, vol. In Press, 2017.

12. Y. Endo, L. Pelà, P. Roca, F. Porto, and C. Mod-
ena, “Comparison of seismic analysis methods ap-
plied to a historical church struck by 2009 L ’ Aquila
earthquake,” Bulletin of Earthquake Engineering,
2015.

13. S. Saloustros, L. Pelà, P. Roca, and J. Portal,
“Numerical analysis of structural damage in the
church of the Poblet monastery,” Engineering Fail-
ure Analysis, vol. 48, pp. 41–61, 2014.

14. L. Pelà, M. Cervera, and P. Roca, “An or-
thotropic damage model for the analysis of masonry
structures,” Construction and Building Materials,
vol. 41, pp. 957–967, 2013.

15. P. B. Lourenço and J. G. Rots, “Multisurface In-
terface Model for Analysis of Masonry Structures,”
Journal of Engineering Mechanics, vol. 123, no. 7,
pp. 660–668, 1997.

16. L. Macorini and B. A. Izzuddin, “A non-linear in-
terface element for 3D mesoscale analysis of brick-
masonry structures,” International Journal for Nu-
merical Methods in Engineering, vol. 85, pp. 1584–
1608, mar 2011.

17. T. J. Massart, R. H. J. Peerlings, and M. G. D.
Geers, “An enhanced multi-scale approach for ma-
sonry wall computations with localization of dam-
age,” International Journal for Numerical Methods
in Engineering, vol. 69, pp. 1022–1059, jan 2007.

18. D. Addessi and E. Sacco, “A multi-scale enriched
model for the analysis of masonry panels,” Inter-
national Journal of Solids and Structures, vol. 49,
no. 6, pp. 865–880, 2012.

19. M. Petracca, L. Pelà, R. Rossi, S. Oller, G. Camata,
and E. Spacone, “Multiscale computational first or-
der homogenization of thick shells for the analysis
of out-of-plane loaded masonry walls,” Computer
Methods in Applied Mechanics and Engineering,
vol. 315, pp. 273–301, 2017.

20. R. Clemente, Análysis estructural de edifi-
cios históricos mediante modelos localizados de
fisuración. Ph.d. thesis, Universitat Politècnica de
Catalunya, 2006.

21. L. Pelà, Continuum Damage Model for Nonlinear
Analysis of Masonry Structures. Ph.d. thesis, Uni-
versitat Politècnica de Catalunya, 2009.

22. M. Cervera, L. Pelà, R. Clemente, and P. Roca,
“A crack-tracking technique for localized damage in

quasi-brittle materials,” Engineering Fracture Me-
chanics, vol. 77, no. 13, pp. 2431–2450, 2010.

23. P. Roca, M. Cervera, L. Pelà, R. Clemente, and
M. Chiumenti, “Continuum FE models for the anal-
ysis of Mallorca Cathedral,” Engineering Struc-
tures, vol. 46, pp. 653–670, 2013.

24. L. Pelà, M. Cervera, S. Oller, and M. Chiu-
menti, “A localized mapped damage model for
orthotropic materials,” Engineering Fracture Me-
chanics, vol. 124-125, pp. 196–216, 2014.

25. M. Cervera and M. Chiumenti, “Smeared crack ap-
proach: back to the original track,” International
Journal for Numerical and Analytical Methods in
Geomechanics, vol. 30, no. 12, pp. 1173–1199, 2006.

26. A. Slobbe, M. Hendriks, and J. Rots, “Smooth-
ing the propagation of smeared cracks,” Engineer-
ing Fracture Mechanics, vol. 132, pp. 147–168, dec
2014.

27. J. Oliver and A. E. Huespe, “Continuum approach
to material failure in strong discontinuity settings,”
Computer Methods in Applied Mechanics and En-
gineering, vol. 193, no. 30-32, pp. 3195–3220, 2004.

28. G. Meschke and P. Dumstorff, “Energy-based mod-
eling of cohesive and cohesionless cracks via X-
FEM,” Computer Methods in Applied Mechanics
and Engineering, vol. 196, no. 21-24, pp. 2338–2357,
2007.

29. D. Dias-Da-Costa, J. Alfaiate, L. J. Sluys, and
E. Júlio, “A comparative study on the modelling of
discontinuous fracture by means of enriched nodal
and element techniques and interface elements,” In-
ternational Journal of Fracture, vol. 161, no. 1,
pp. 97–119, 2010.

30. Y. Zhang, R. Lackner, M. Zeiml, and H. a. Mang,
“Strong discontinuity embedded approach with
standard SOS formulation: Element formulation,
energy-based crack-tracking strategy, and valida-
tions,” Computer Methods in Applied Mechanics
and Engineering, vol. 287, pp. 335–366, 2015.

31. S. Saloustros, L. Pelà, and M. Cervera, “A
crack-tracking technique for localized cohesive-
frictional damage,” Engineering Fracture Mechan-
ics, vol. 150, pp. 96–114, 2015.

32. S. Saloustros, L. Pelà, M. Cervera, and P. Roca,
“Finite element modelling of internal and mul-
tiple localized cracks,” Computational Mechanics,
vol. 59, no. 2, pp. 299–316, 2016.

33. R. Faria and J. Oliver, A Rate Dependent Plastic-
Damage Constitutive Model for Large Scale Com-
putations in Concrete Structures. CIMNE, 1993.

34. M. Cervera, J. Oliver, and R. Faria, “Seismic evalu-
ation of concrete dams via continuum damage mod-
els,” Earthquake Engineering & Structural Dynam-



18 Savvas Saloustros et al.

ics, vol. 24, no. 9, pp. 1225–1245, 1995.
35. R. Faria, J. Oliver, and M. Cervera, “Modeling ma-

terial failure in concrete structures under cyclic ac-
tions,” Journal of Structural Engineering, no. De-
cember, pp. 1997–2005, 2004.

36. P. Roca, M. Cervera, L. Pelà, R. Clemente, and
M. Chiumenti, “Viscoelasticity and Damage Model
for Creep Behavior of Historical Masonry Struc-
tures,” pp. 188–198, 2012.

37. L. Pelà, J. Bourgeois, P. Roca, M. Cervera, and
M. Chiumenti, “Analysis of the Effect of Provi-
sional Ties on the Construction and Current Defor-
mation of Mallorca Cathedral,” International Jour-
nal of Architectural Heritage, vol. in press, no. doi:
10.1080/15583058.2014.996920, 2014.

38. R. Faria, J. Oliver, and M. Cervera, “A strain-based
plastic viscous-damage model for massive concrete
structures,” International Journal of Solids and
Structures, vol. 35, pp. 1533–1558, may 1998.

39. M. Petracca, L. Pelà, R. Rossi, S. Oller, G. Camata,
and E. Spacone, “Regularization of first order com-
putational homogenization for multiscale analysis
of masonry structures,” Computational Mechanics,
vol. 57, pp. 257–276, dec 2016.

40. J. Lubliner, J. Oliver, S. Oller, and E. Oñate, “A
plastic-damage model for concrete,” International
Journal of Solids and Structures, vol. 25, no. 3,
pp. 299–326, 1989.

41. M. Petracca, L. Pelà, R. Rossi, S. Zaghi, G. Ca-
mata, and E. Spacone, “Micro-scale continuous and
discrete numerical models for nonlinear analysis of
masonry shear walls,” Construction and Building
Materials, vol. In Press, 2017.

42. J. Oliver, M. Cervera, S. Oller, and J. Lubliner,
“Isotropic damage models and smeared crack analy-
sis of concrete,” Proc. SCI-C Computer Aided Anal-
ysis and Design of Concrete Structures, no. Febru-
ary, pp. 945–957, 1990.

43. Z. Bazant and B. Oh, “Crack band theory for frac-
ture of concrete,” Materials and Structures, vol. 16,
pp. 155–177, 1983.

44. M. Cervera and M. Chiumenti, “Mesh objective
tensile cracking via a local continuum damage
model and a crack tracking technique,” Computer
Methods in Applied Mechanics and Engineering,
vol. 196, no. 1-3, pp. 304–320, 2006.

45. M. Cervera, “Viscoelasticity and Rate-dependent
Continuum Damage Models, Monography N-79,”
tech. rep., Barcelona, 2003.

46. T. Rabczuk, S. Bordas, and G. Zi, “On three-
dimensional modelling of crack growth using parti-
tion of unity methods,” Computers and Structures,
vol. 88, no. 23-24, pp. 1391–1411, 2010.

47. J.-H. Song and T. Belytschko, “Cracking node
method for dynamic fracture with finite elements,”
International Journal for Numerical Methods in
Engineering, vol. 77, pp. 360–385, jan 2009.

48. R. de Borst and P. Nauta, “Non-orthogonal cracks
in a smeared finite element model,” Engineering
Computations, vol. 2, no. 1, pp. 35–46, 1985.

49. A. Anthoine, G. Magenes, and G. Magonette,
“Shear compression tensting and analysis of brick
masonry walls,” in 10th European Conference on
Earthquake Engineering, (Vienna), pp. 1657–1662,
1994.

50. G. Magenes and G. M. Calvi, “In-plane seismic re-
sponse of brick masonry walls,” 1997.

51. L. Binda, G. Mirabella Roberti, C. Tiraboschi, and
S. Abbaneo, “Measuring Masonry Material Proper-
ties,” U.S.-Italy Workshop on Guidelines for Seis-
mic Evaluation and Rehabilitation of Unreinforced
Masonry Buildings, pp. 326–347, 1994.

52. COMET, “Coupled Mechanical and Thermal anal-
ysis, http://www.cimne.com/comet/,” 2016.

53. GiD, “The personal pre and post-processor,
http://www.gidhome.com/,” 2016.

54. S. Saloustros, L. Pelà, M. Cervera, and P. Roca,
“An enhanced finite element macro-model for the
realistic simulation of localized cracks in masonry
structures: A large-scale application,” International
Journal of Architectural Heritage, vol. In press,
no. doi: 10.1080/15583058.2017.1323245, 2017.

Appendix

The rate of the mechanical dissipation γ of the contin-
uum damage model presented in Section 2 is [33]

γ̇ = −
∂ψ

∂�i
: �̇i −

∂ψ

∂d+
ḋ+ −

∂ψ

∂d−
ḋ− = γ̇i + γ̇d ≥ 0 (28)

where ψ is the Helmholtz free energy and ψ±0 elastic
free energies which have the following form [33]

ψ = (1− d+)ψ+0 + (1− d
−)ψ−0 (29)

ψ+0 =
1

2
σ̄+ : C−10 : σ̄ (30)

ψ−0 =
1

2
σ̄− : C−10 : σ̄ (31)

It is visible from equation (28) that the evolutions
of both damage γ̇d and irreversible strains γ̇i contribute
to the total dissipation energy of the solid, with each
part being



Tracking multi-directional intersecting cracks in numerical modelling of masonry shear walls under cyclic loading 19

γ̇i = −
∂ψ

∂�i
: �̇i ≥ 0 (32)

γ̇d = −
∂ψ

∂d+
ḋ+ −

∂ψ

∂d−
ḋ− ≥ 0 (33)

The total dissipated energy per unit volume gf is
obtained as

gf =

∫ t
0

γ̇i dt+

∫ t
0

γ̇d dt (34)

The discrete softening parameter can be defined
similarly to [44] considering an ideal uniaxial 1D com-
pressive experiment, with a monotonic increment of the
compressive strain (denoted hereafter as �e) from an
initial unstressed state to full degradation. During the
loading, and considering equations (5) and (9) the stress
threshold will be

r− = E �e (35)

In such case the dissipation due to the damage evo-
lution is (see [44])

γd =

∫ t
0

γ̇d dt (36)

=
1

2E

∫ t
r0

(r−)2 d′ dr (37)

=

(
1 +

1

H−d

)
(f−)2

2E
(38)

The contribution of the irreversible strains to the
total dissipated energy can be computed considering

�̇i = β
E�̇

E �e
�e (39a)

= β �̇ (39b)

=
β

(1− β)
�̇e (39c)

and

−
∂ψ

∂�i
= (1− d−) r− (40)

Using the above equations (39c) and (40), the dis-
sipated energy due to the evolution of the irreversible
strains is

γi =

∫ t
r0

(1− d−) r−
β

(1− β)
�̇edt (41)

=

∫ r
r0

(1− d−) r−
β

(1− β)
1

E
dr (42)

=
β

1− β
(f−)2

E

1

2H−d
(43)

By virtue of equations (36) as well as (41) and con-
sidering that the total dissipation should be equal to
Gf−, the updated softening modulus is derived as

H−d =
1

1− β

(
ldis

l−mat − ldis

)
(44)

Note that for the limit case of β = 1, equation (39b)
limits to �̇i = �̇ and consequently �̇e = 0. This results
in ∆r = 0, which means that there is no damage evo-
lution and hence no softening. In that case, energy is
dissipated only due to the evolution of the irreversible
strains, which using equations (32), (35) and (40) will
be

γi = E �e0

∫ t
0

�̇ dt (45a)

= E �e0

∫ e
�0

d� (45b)

= E �e0 [�− �
e
0] (45c)

with �e0 being the elastic strain at the peak strength. Ac-
cording to the above, the dissipation will keep increas-
ing linearly with the increase of the strains, resembling
the behaviour of a perfectly plastic material.


	Introduction
	Constitutive model
	A tracking algorithm for intersecting and multi-directional cracks
	Numerical simulation of a shear wall under cyclic loading
	Conclusions

