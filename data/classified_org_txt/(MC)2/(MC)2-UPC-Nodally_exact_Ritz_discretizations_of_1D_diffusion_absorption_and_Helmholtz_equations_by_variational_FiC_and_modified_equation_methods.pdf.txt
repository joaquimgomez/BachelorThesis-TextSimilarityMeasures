






































Nodally Exact Ritz Discretizations of 1D Diffusion-Absorption and
Helmholtz Equations by Variational FIC and Modified Equation Methods

C. A. Felippa and E. Oñate

May 2004, Revised August 2005

Accepted for publication in Computational Mechanics



TABLE OF CONTENTS

Page
§1. The Finite Calculus 1
§2. Modified Variational Forms 2
§3. The Modified Equation Method 3

§3.1. Backward Error Analysis . . . . . . . . . . . . . 3
§3.2. Applying Modified Equations . . . . . . . . . . . 3
§3.3. A Brief History of Modified Equations . . . . . . . . . 4
§3.4. Free Parameters for Nodal Exactness . . . . . . . . . 5
§3.5. Nodal Exactness: Advantages and Limitations . . . . . . 5

§4. The Diffusion-Absorption-Helmholtz Problem 6
§4.1. The Model Problem . . . . . . . . . . . . . . . 7
§4.2. Exact Solutions . . . . . . . . . . . . . . . . . 7
§4.3. Conventional Ritz . . . . . . . . . . . . . . . 8
§4.4. The FIC Functional . . . . . . . . . . . . . . . 9

§5. The Ritz FIC Equations 9
§5.1. Patch and Modified Equations . . . . . . . . . . . 10
§5.2. Positivity Lower Bound . . . . . . . . . . . . . . 11
§5.3. Diffusive Upper Bound . . . . . . . . . . . . . 11
§5.4. Nodally Exact Matching . . . . . . . . . . . . . . 11
§5.5. Pade Approximants . . . . . . . . . . . . . . . 12
§5.6. Nodal Exactness Verification . . . . . . . . . . . . 13
§5.7. Reduced Integration Element . . . . . . . . . . . . 13
§5.8. Source Terms . . . . . . . . . . . . . . . . . 14
§5.9. Numerical Results . . . . . . . . . . . . . . . 14

§6. Templates 18
§7. Generalization to Variable Coefficients 20

§7.1. The VC Model Problem . . . . . . . . . . . . . . 21
§7.2. Reusing CC Templates . . . . . . . . . . . . . . 22
§7.3. VC-Customized Templates . . . . . . . . . . . . . 22
§7.4. Numerical Results for Variable Coefficients . . . . . . . 22

§8. Conclusions 25

§A. PROCESSING MODIFIED EQUATIONS 25
§A.1. Reduction by Series Identification. . . . . . . . . . . . . . . . . . . . . . 25
§A.2. Reduction by a Theorem of Muir. . . . . . . . . . . . . . . . . . . . . . 26

References . . . . . . . . . . . . . . . . . . . . . . 28



Nodally Exact Ritz Discretizations of 1D Diffusion-Absorption and

Helmholtz Equations by Variational FIC and Modified Equation Methods

Carlos A. Felippa∗ and Eugenio Oñate†

* Department of Aerospace Engineering Sciences
and Center for Aerospace Structures
University of Colorado
Boulder, Colorado 80309-0429, USA

† International Center for Numerical Methods in Engineering (CIMNE)
Edificio C-1, c. Gran Capitán s/n
Universidad Politécnica de Cataluña
08034 Barcelona, Spain

Abstract. This article presents the first application of the Finite Calculus (FIC) in a Ritz-FEM
variational framework. FIC provides a steplength parametrization of mesh dimensions, which is used
to modify the shape functions. This approach is applied to the FEM discretization of the steady-state,
one-dimensional, diffusion-absorption and Helmholtz equations. Parametrized linear shape functions
are directly inserted into a FIC functional. The resulting Ritz-FIC equations are symmetric and carry
a element-level free parameter coming from the function modification process. Both constant- and
variable-coefficient cases are studied. It is shown that the parameter can be used to produce nodally
exact solutions for the constant coefficient case. The optimal value is found by matching the finite-order
modified differential equation (FOMoDE) of the Ritz-FIC equations with the original field equation.
The inclusion of the Ritz-FIC models in the context of templates is examined. This inclusion shows that
there is an infinite number of nodally exact models for the constant coefficient case. The ingredients
of these methods (FIC, Ritz, MoDE and templates) can be extended to multiple dimensions.

Keywords: finite calculus, variational principles, Ritz method, functional modification, stabilization,
finite element, diffusion, absorption, Helmholtz, nodally exact solution, modified differential equation,
templates.

§1. The Finite Calculus

The Finite Calculus (FIC) has been developed over the past five years [23–35] as a general purpose
tool for improving the stability and accuracy of interior discretizations of equations of mathematical
physics and engineering. Consider a problem governed by the residual equation

r(u) = 0, (1)
where u is an array of n primary variables. These in turn are functions of the independent variables x,
which may include time. Generally (1) is an ordinary or partial differential equation, to be solved by
numerical methods.

Introduce n characteristic lengths hi collected in array h, where each hi is paired with the function ui .
These lengths can be viewed as linked, through as yet unspecified means, to mesh or grid dimensions.
Using flux balance arguments [26,27] a modified residual is constructed

r(u) + rh(u, h) = 0. (2)

1



The simplest form of rh is − 12∇r h, where ∇r is the gradient matrix of r with respect to the independent
variables. The discretization process, which is usually Galerkin-based FEM, is applied to (2) instead
of (1). Consistency with the latter requires that rh → 0 as hi → 0.
But the philosophy of FIC, as emphasized in its name, is that in practice the hi remain finite. The key
goal is to pick rh and h so that stability and accuracy characteristics of the solution for a given mesh
are improved. Further analysis of localized phenomena, such as sharp boundary layers, can be carried
out by multiscale devices [6,19,30]. The FIC analysis process is diagramed in Figure 1.

FIC has been primarily used for the solution of fluid
mechanics equations involving flow, advection, dif-
fusion, ocean waves and chemical reactions [23–
35]. For those applications it competes with stabi-
lization schemes such as SUPG, residual free bub-
bles and subgrid scale methods [3,4,9,10,19].

In a study of FIC methods for solid mechanics [36]
it was found that a variational form formally anal-
ogous to the Minimum Potential Energy principle
could be obtained by modifying the displacement,
strain and stress fields in a manner similar to that
done for the residual in the foregoing description,
and adjusting their variations.

Analysis
process

Balance
 analysis

Discretization

Accuracy 
analysis

Weak form

Residual
r(u) = 0

Galerkin or similar
discrete form

Pick steplengths h

Numerical 
solution

Finite
Calculus 

Modified residual
r(u) + r  (u,h) = 0h

Figure 1. The weak-form-based FIC analysis process.

The approach technically falls into the class of variational principles with noncommutative variations
[43], also called modified variational principles in the literature [8]. That finding provided the departure
point for the present study.

§2. Modified Variational Forms

Suppose that (1) is derivable from a functional J [u] in the sense that r(u) = 0 are the Euler-Lagrange
equations of J . The first variation is

δ J [u] = δuT r(u). (3)
Define a modified primary variable field:

ũ
def= u + uh(h), (4)

such that uh → 0 as h → 0. The choice considered
here, suggested by a previous study as noted, is

ũ = u − 1
2
hαT ∇u. (5)

Here h is an overall characteristic length, array α
collects scaling parameters αi , and the factor − 12
is for convenience in matching to the standard FIC
method.

Analysis
process

Discretization

Accuracy 
analysis

Residual
r(u) = 0

Ritz discrete form

Pick steplengths h

Numerical 
solution

Euler-
Lagrange 
equations

Variational principle
δ J[u] = 0

Modified variational
principle

δ J[u,h] = 0

Finite
Calculus 

Figure 2. The variational FIC analysis process.

Substituting (5) into J yields the modified functional

J̃h = J [ũ] = J + Jh, (6)

2



in which the augmentation term Jh vanishes as h → 0. The Euler-Lagrange equation changes to

δ J̃h[u] = δuT
[
r(u) + r̃h(u)

]
. (7)

This has formally the same configuration as (3), and shares with it the property that as h → 0 the
Euler-Lagrange equation reduces to (1). But in general starting with rh(u) of FIC, namely that in
(2), does not reproduce r̃h . To avoid confusion we qualify (7) as the FIC variational residual. The
functional J̃h will be called the FIC-modified functional, or FIC functional for brevity. (The superposed
tildes will be eventually dropped for brevity when there is no danger of confusion.)

The numerical approximation is obtained by working with J̃h in the usual way, assuming that h is
known. The residual may be used to study stability and accuracy properties of the approximation. The
analysis process is diagramed in Figure 2.

§3. The Modified Equation Method

The “Accuracy Analysis” stage of Figure 2 is done by the method of modified equations. Since this
is not a well known technique for differential equations, a summary along with a historical outline is
presented here. An example relevant to the target application problem is worked out in Appendix A.

§3.1. Backward Error Analysis

The conventional way to analyze accuracy of a discrete approximation is through forward error analysis:
the amount by which the discrete solution fails to satisfy the source differential form. To make this
measure practical, it is computed using local estimators such as truncation or residual errors (in FEM,
through recovery from element patches). This technique furnishes a posteriori error indicators, and is
well developed in the literature.

Backward error analysis takes the reverse approach to accuracy. Given the computed solution, it asks:
which problem has the method actually solved? In other words, we seek an ODE or PDE which,
if exactly solved, would reproduce the computed solution. This ODE or PDE is called the modified
differential equation, often abbreviated to MoDE in the sequel. The difference between the modified
equation and the original one provides an estimate of the error. An important practical advantage is
that the modified equation can be generated without actually solving the discrete problem.

This approach is now routinely used for matrix computations after Wilkinson’s definitive work in
the 1960s [47–49] and has become standard part of numerical linear algebra courses. But it is less
known in differential equations. This neglect is unfortunate, since the concept follows common sense.
Application problems involve physical parameters such as mass, damping, stiffness, conductivity,
diffusivity, etc., which are known approximately. Transient loading actions (e.g, earthquakes, winds,
waves) may be subject to high uncertainties. If the modified equation models a “nearby problem” with
parameters within the range of experimental uncertainty, it is as good as the original one. This “defect
correction” can be used as basis for controlling accuracy a priori, before any computations are actually
carried out.

§3.2. Applying Modified Equations

Let rh(u, h, α) = 0 denote a discretization of an ordinary or partial differential equation r(u) = 0. [As
in Sections 1–2, h collects lengths (in space, time or both) related to mesh or grid dimensions whereas
α collects free parameters]. Processing the modified equation involves three steps:

3



Step 1: Patch discretization → DDMoDE. The discrete equations at a typical node (a patch in FEM
terminology) are rendered continuous in the independent variable(s). This produces a difference-
differential form (called delay-differential form when time is the independent variable), abbreviated to
DDMoDE.

Step 2: DDMoDE→ IOMoDE. The difference portion of the DDMoDE is converted to differential
form by Taylor series expansion in the mesh dimensions collected in h. This step produces a modified
differential equation of infinite order, abbreviated to IOMoDE.

Step 3: IOMoDE→FOMoDE. The IOMoDE is reduced to a finite order differential equation, or
FOMoDE. This is done by systematic elimination of higher order derivatives. The process typically
produces an infinite series in the discretization dimensions. This series can be occasionally identified
and summed in closed form. Technically this is (by far) the most difficult step. It generally requires
the use of a computer algebra system (CAS) to be viable.

By comparing the FOMoDE to the
original problem one can learn struc-
tural aspects of the discretization that
go beyond comparison of physical pa-
rameter values. For example: preser-
vation of Hamiltonian flow or of con-
servation laws in the discrete system.
These are impossible or difficult to an-
alyze with the conventional truncation
error measures.

The procedural steps just outlined are
flow-charted in Figure 3. This chart
also shows a parameter matching step
to achieve nodal exactness, which is
discussed in more detail in Section 3.4
below.

Reduce to finite order DE 
by elimination of high 

order derivatives

Parametric
discretization

via FIC

Match by adjusting
free parameters 

(if possible)

Convert to
difference-differential form
(aka delay-differential form)

Pass to infinite
order DE by Taylor
expansion in mesh

dimension(s)

r(u) = 0

r  (u,h,α) = 0h r    (u,h,α) = 0IO

r    (u,h,α) = 0DD

r    (u,h,α) = 0
FO

Discrete Form

Given ODE/PDE

   DDMoDE

   IOMoDE

   FOMoDE

step 1 step 2

step 3

Figure 3. Steps of the modified equation method. Achieving nodal
exactness requires “closing the loop.” As discussed in §3.4, this may

involve additional assumptions.

§3.3. A Brief History of Modified Equations

Modified differential equations as truncated forms of infinite-order ODEs appeared in conjunction
with finite difference discretizations for computational fluid dynamics (CFD). The prescription for
constructing them can be found in Richtmyer and Morton’s textbook [39, p. 331]. Modified forms
were used to interpret numerical dissipation and dispersion in the Lax-Wendroff treatment of shocks,
and to derive corrective operators. Similar ideas were used by Hirt [18] and Roache [40]. A drawback
of this early work is that there is no guarantee that truncation retains the relevant behavior for finite
mesh dimensions, since the discarded portion could be well be dominant in coarse discretizations.

Warming and Hyett [45] were the first to describe the correct procedure for eliminating high order
time derivatives of PDE space-time discretizations on the way to the finite-order modified equation
(FOMoDE). (Space dimensions were treated by Fourier methods.) They attributed the “modified
equation” name to Lomax [22]. The FOMoDE forms were used for studying accuracy and stability of
several CFD operators. In this work the original equation typically models flow effects of conduction
and convection, h includes grid dimensions in space and time, and feedback is used to adjust parameters
in terms of improving stability as well as reducing spurious oscillations (e.g. by artificial viscosity or
upwinding) and dispersion.

4



The first MoDE use to study space FEM discretizations for structural mechanics can be found in [44].
However the derivative elimination and force lumping procedures were faulty, which led to incorrect
conclusions. This was corrected by Park and Flaggs [37,38], who, being aware of the methods of [45]
used modified equations for a systematic study of C0 beam, plate and shell FEM discretizations.

The method has recently attracted attention from the numerical mathematics community since it pro-
vides an effective tool to understand long-time structural behavior of computational dynamic systems,
both deterministic and chaotic. Recommended references are [11–14,41]. Web accessible Maple
scripts for the reduction process from infinite to finite order are presented in [2]. Little of the work to
date has used modified equations for optimal selection of free parameters. One exception is [12].

§3.4. Free Parameters for Nodal Exactness

Suppose that the discretization rh(u, h, α) = 0 contains free parameters collected in α. As discussed
in Sections 1–2, this is always the case for FIC discretizations, whether variationally based or not.
Obviously the free parameters will carry over to the three modified equation forms: rDD(u, h, α) = 0,
rIO(u, h, α) = 0 and rFO(u, h, α) = 0. Assuming that the latter is available, the question is whether
the parameters can be chosen so that

rFO(u, h, αM) ≡ r(u), for any h. (8)
Here subscript M stands for “matching.” If this is possible, the discretization rh(u, h, αM) becomes
nodally exact. That is, it will give the exact answer at the nodes of any discretization which generates
the finite-order modified equation being matched. For FEM discretizations this scheme may be labeled
a nodally exact patch test, since the modified equations are necessarily obtained from an element patch.

The idea is straightforward and attractive but fraught with technical difficulties. In particular:

• Exact matching may be possible only with drastic restrictions on dimensionality, system properties
and discretization. For instance: constant coefficients, no source terms, regular meshes. If an
exact match is impossible, some “measure of fit” (projection, minimization, etc) has to be chosen.

• Solutions may be imaginary, non-unique, inexistent, or very hard to compute.
• The FOMoDE may contain “parasitic terms” not present in the governing equation, which cannot

be cancelled out by choosing parameters. For example: the source is the Laplace equation
uxx + uyy = 0 whereas the FOMoDE holds a parameter-free cross-derivative term uxy . The
emergence of parasitic terms was in fact observed by Park and Flaggs in their studies of C0 plate
and shell elements [37,38]. Such occurrences can be often traced to consistency defects in the
discretization; in that study the presence of parasitic terms flagged element locking.

• Attaining a closed form for the FOMoDE will not be generally possible in more than one space
dimension. Truncation is required. In that case the fit can at most be expected to deliver a better
solution over a fixed mesh.

• Symbolic manipulations may be prohibitive, even with the help of a computer algebra system.
On the positive side, the approach is completely general, and not linked to any discretization method.
The provenance of rh(u, h, α): finite elements, finite differences, boundary elements, etc., is irrelevant.
It is not restricted by problem dimensionality, and does not require knowledge of exact solutions.

For FEM discretizations, the first procedure to achieve nodal exactness was Tong’s adjoint technique
[42]; see also [50, App. 7]. This requires finding exact homogeneous solutions of r(u) = 0, to be
inserted as weight functions in a Petrov-Galerkin discretization. Related schemes are based on localized
enrichment by homogeneous and/or particular solutions, for example [5,6]

5



§3.5. Nodal Exactness: Advantages and Limitations

Features of a nodally exact (NE) discretization are illustrated in Figure 4. This shows the exact solution
to the variable-coefficient boundary-value problem (BVP), later used in Section 7 as test example:

u′′ = −750 x u, u(−1) = 25, u(1) = −4, (.)′′ ≡ d2(.)/dx2. (9)

This is compared with two FEM discretiza-
tions of 6 two-node elements each. That
labeled NELVC comes from a model that
is nodally exact for a coefficient of u that
varies linearly in x over each element. That
labeled FICM1 is nodally exact for constant
coefficients. (These two models are de-
veloped in Sections 5 and 7, respectively,
along with several others.) In both cases the
FEM solution between nodes is interpolated
linearly. Both approximations are plainly
inadequate but for different reasons. The
NELVC piecewise linear interpolation widely
misses the fast variation of the exact solution,
particularly on the oscillatory side.

−1 −0.5 0 0.5 1

0

−30

−20

−10

10

20

30
u

x

Nodally Exact
Element for Linearly 
Varying Coefficient
(NELVC)

Nodally Exact 
Element for
Constant Coefficient
(FICM1)

Exact
Solution

Figure 4. Features of a nodally exact discretization for BVP (9).
Solution has exponential behavior, with a sharp boundary layer,
for x < 0. It becomes oscillatory, with increasing frequency, for

x > 0. Node values of NELVC marked with small circles.

This deficiency can be resolved by either using a better intra-element interpolation (for example, if the
element was derived from shape functions) or local refinement. Advantages for multiscale modeling are
nonetheless clear: an individual element can be extracted and converted into a local BVP using the end
node values, and physical behavior at smaller scale introduced if appropriate. No such postprocessing
is feasible with the nodally-inexact discretization, which is way off in the oscillatory side.

−1 −0.5 0 0.5 1

−30

−20

−10

0

10

20

30

−1 −0.5 0 0.5 1

0

−30

−20

−10

10

20

30
(a) (b)

Exact
Solution

Exact,  FICM1 &
NEVC coincide
within plot tolerance

Nodally Exact 
Element for
Constant Coefficient
(FICM1)

Nodally Exact
Element for Linearly 
Varying Coefficient
(NELVC)

Figure 5. Convergence behavior of discretizations for the BVP (9): (a) 24 elements and (b) 96 elements.

As the mesh is refined, the NELVC solution quickly “locks in” the correct behavior, as pictured in
Figure 5(a) for 24 elements. The other solution remains inadequate on the oscillatory side x > 0
because only 3 elements fit in the shorter wavelengths. Going to 96 elements the two FEM solutions
cannot be distinguished from the exact one at the plotting scale of Figure 5(b). What happens is that
with 12 elements per (shortest) wavelength the approximation power of the FICM1 model is finally
realized, as the coefficient of u(x) is sensibly constant over each element.

6



§4. The Diffusion-Absorption-Helmholtz Problem

Sections 4–7 illustrate the variational FIC discretization and the construction of modified equations
for the steady-state, one-dimensional diffusion-absorption and Helmholtz equations. This problem has
been recently examined by Oñate, Miquel and Hauke [35] from a FIC-Galerkin standpoint. That study
includes advection terms that are not considered here. The governing differential equation that models
a one-dimensional, steady state, diffusion-absorption process is

d

dx

(
k

du

dx

)
− su + Q = 0, in x ∈ [xm, x p] (10)

In this equation u is the state variable, x ∈ [xm, x p] is the problem domain, k ≥ 0 is the diffusion,
s ≥ 0 is the absorption (also called dissipation or destruction parameter) and Q the source term. Using
primes to denote differentiation with respect to x , the foregoing ODE can be abbreviated to

(
k u′

)′ − s u + Q = 0. (11)
With the flux defined as q = k(du/dx) = k u′, the boundary conditions can be stated as

u = û on �u, q = q̂, on �q . (12)

where �u and �q are the Dirichlet and Neumann boundaries, respectively. For the one-dimensional
problem these consist of four combinations taken at the ends of the problem domain. This problem
admits a classical variational formulation. The source functional is

J [u] =
∫ x p

xm

(
1
2
k(u′)2 + 1

2
su2 − Qu

)
dx . (13)

Taking the first variation δ J = 0 over admissible functions u(x) that satisfy the essential BCs yields
the differential equation (10) as Euler-Lagrange equation, and the flux constraints in (12) as natural
boundary conditions.

§4.1. The Model Problem

Following [35] and assuming k �= 0, a model form of (10) is obtained by introducing the dimensionless
coefficient

w = sa
2

k
, (14)

where a = x p − xm is the length of the problem domain. This coefficient characterizes the relative
importance of absorption over diffusion. The problem domain is adjusted to extend from xm = − 12 a
to x p = 12 a for convenience. We assume zero source: Q = 0, and Dirichlet boundary conditions at
both ends: u(− 1

2
a) = um and u( 12 a) = u p. We can now state the model problem as

u′′ − w
a2

u = 0 for x ∈ [− 1
2
a, 1

2
a], u(− 1

2
a) = um, u( 12 a) = u p. (15)

The associated functional is

J [u] =
∫ a

−a
1
2

(
(u′)2 + w

a2
u2

)
dx . (16)

where variation is taken over continuous u(x) that satisfy a priori the Dirichlet BCs.

7



−0.4 −0.2 0.2 0.4

2

4

6

8

10

−0.4 −0.2 0.2 0.4

2

4

6

8

10

−0.4 −0.2 0.2 0.4

−10

−5

5

10

−0.4 −0.2 0.2 0.4

2

4

6

8 w = 0 w = −50

w = 50w = 1000

(a) (b)

(c) (d)

x

x

x

x

u u

u u10

Figure 6. Behavior of the exact solution of the model equation with a = 1, Dirichlet BCs
u(− 12 ) = 8 and u( 12 ) = 3, and four values of w.

§4.2. Exact Solutions

If w > 0 the exact solution of the model BVP (15) can be given in term of hyperbolic functions:

u(x) = sinh
(

1
2

√
w(1 − ξ)

)
um + sinh

(
1
2

√
w(1 + ξ)

)
u p

sinh(
√

w)
, ξ = 2x/a. (17)

This expression becomes 0/0 if w = 0 and suffers from cancellation errors if |w| is very small, say
|w| < 10−8. For that case a Taylor series about w = 0 gives to O(w):

u(x) ≈ 1 − ξ
2

[
1 + w

24
(ξ

2−2ξ−3)
]

um +
1 + ξ

2

[
1 + w

24
(ξ

2+2ξ−3)
]

u p, ξ = 2x/a. (18)

Sample solutions are displayed in Figure 6 for a = 1, um = u(− 12 ) = 8, u p = u( 12 ) = 3, w = 1000,
50, 0 and −50. If w = 0 the solution is a straight line. As w grows, exponential boundary layers
appear at Dirichlet boundaries. This is illustrated in Figures 6(a,b). If w = 1000 the solution is very
small over most of the problem domain except for two sharp boundary layers near x = ± 1

2
a.

If w < 0, (15) becomes the space Helmholtz equation of linear acoustics: u′′ + k2 u = 0 with
wavenumber k2 = −w/a2. Its solution is harmonic:

u(x) = sin
(
κπ(1 − ξ)

)
um + sin

(
κπ(1 + ξ)

)
u p

sin(2κπ)
, ξ = 2x/a, 2π κ =

√
−w. (19)

The scaled wavenumber κ = √−w/(2π) = ka/(2π) represents the number of full-cycle oscillations
over the domain length a. Expression (19) is only valid if 2κ �= 0, 1, 2 . . ., as otherwise the denominator
vanishes. Figure 6(d) plots u(x) for w = −50, in which case κ =

√
50/(2π) = 1.1254 cycles.

8



§4.3. Conventional Ritz

A standard FEM solution is easily constructed by the Ritz variational formulation. Divide the domain
into N e two-node elements of length Le = a/N e = χa. The end nodes are i and j , with coordinates
xi and x j , and node values ui and u j , respectively. Assume the piecewise linear interpolation

u(x) = ui Ni (x) + u j N j (x), (20)

where Ni (x) = (x − xi )/Le, N j = (x j − x)/Le and Le = x j − xi are the well known linear shape
functions. Substitution into (16) gives the element stiffness equations

Seue = 1
Le

[
1 + 1

3
ζ −1 + 1

6
ζ

−1 + 1
6
ζ 1 + 1

3
ζ

] [
ui
u j

]
=

[
0
0

]
, χ = Le/a, ζ = wχ2 = s(Le)2/k. (21)

If w = 0 this element relation gives, upon assembly, the linear response correctly. However if w �= 0,
the use of (21), a scheme that may be labeled “unstabilized Ritz,” displays a known defect: if w is large
the solution oscillates over coarse meshes. This is illustrated in Figure 10(a) for Ne = 8 elements and
w = 1000. Negative u values are physically incorrect if w > 0, which renders the solution useless.
This shortcoming is usually treated by Petrov-Galerkin stabilization schemes with suitably adjusted
weight functions. The end result are unsymmetric equations for what is a self-adjoint problem.

§4.4. The FIC Functional

We stay within the Ritz framework and piecewise-linear shape functions, but change the functional by
the method outlined in Section 2. For this problem, the FIC function modification technique consists
of formally replacing

ũ(x) = u(x) − 1
2
hu′(x), ũ′(x) = u′(x) − 1

2
hu′′(x). (22)

Modified functions ũ(x) and ũ′(x) are inserted into (15). The tildes are then suppressed for brevity.
This scheme yields a modified functional Jh[u], where h is the FIC steplength. That h was derived in
the original FIC by flux balancing arguments [26]. In the present context h may be simply viewed as
a free parameter with dimension of length.

For piecewise linear shape functions u′′(x) vanishes over each element, and the second replacement in
(22) may be skipped. With this simplification the modified functional is

Jh[u] =
∫ a

−a
1
2

(
(u′)2 + w

a2
(
u − 1

2
hu′

)2)
dx . (23)

The Euler-Lagrange equation given by δ Jh[u] = 0 is

(1 + wh
2

4a2
)u′′ − w

a2
u = 0. (24)

From this the FIC variational residual follows as δ Jh = δu
[
(1 + 1

4
wh2/a2)u′′ − (w/a2)u

]
.

The expression (24) shows that a nonzero h injects artificial diffusion if w > 0. Furthermore, the sign
of h makes no difference in the interior of the problem domain. As h → 0 the original ODE (15) is
recovered. But the key idea behind FIC is to keep h finite and directly related to mesh size.

9



§5. The Ritz FIC Equations

The FIC functional (23) is used in conjunction with the piecewise-linear interpolation (20) to construct
stabilized Ritz equations for the model diffusion-absorption problem. The steplength h = he may
change from element to element. For convenience define he = αe Le where αe is a dimensionless
parameter to be determined over each element. The analysis that follows is restricted to constant w
and elements of equal size Le. The same α is used for all elements. This restriction is removed in
Section 7, which studies a variable coefficient variant of the model problem.

With exact element integration (equivalently, a two-point Gauss integration rule), the following Ritz
FIC element equations are obtained:

Se ue =
[

Seii S
e
i j

Sei j S
e
j j

] [
ui
u j

]
= 1

Le

[
1 + ( 1

3
+ 1

2
α + 1

4
α2)ζ 2 −1 + ( 1

6
− 1

4
α2)ζ 2

−1 + ( 1
6

− 1
4
α2)ζ 2 1 + ( 1

3
− 1

2
α + 1

4
α2)ζ 2

] [
ui
u j

]
=

[
0
0

]
,

(25)
in which χ = Le/a and ζ 2 = wχ2 = s(Le)2/k.

§5.1. Patch and Modified Equations

The stiffness equations for a patch of two equal-
size elements comprising nodes i, j, k, as pictured
in Figure 7, are

x = x − x

i j

j

k

L = a χeL = a χe _

x

Figure 7. A patch of two equal length elements.

1

Le


 1 + (

1
3

+ 1
2
α + 1

4
α2)ζ 2 −1 + ( 1

6
− 1

4
α2)ζ 2 0

−1 + ( 1
6

− 1
4
α2)ζ 2 2 + ( 2

3
+ 1

2
α2)ζ 2 −1 + ( 1

6
− 1

4
α2)ζ 2

0 −1 + ( 1
6

− 1
4
α2)ζ 2 1 + ( 1

3
− 1

2
α + 1

4
α2)ζ 2




[
ui
u j
uk

]
=

[
0
0
0

]
. (26)

To investigate choices for α we need modified equation versions of (26). The patch equation for node
j is

Si ui + Sj u j + Sk uk = 0, (27)
in which Si = Sk = [−12 + (2 − 3α2) ζ 2]/(12 Le) and Sj = [24 + (8 + 4α2) ζ 2]/(12Le). Equation
(27) is “continuified” into a difference-differential modified equation (DDMoDE) by formally replacing
u j → u(x), ui → u(x−Le) and uk → u(x+Le) to get

Si u(x−Le) + Sj u(x) + Sk u(x+Le) = 0. (28)
Node values u(x ± Le) are linked to u(x) and its derivatives at x = x j by Taylor series:

u(x−Le) = u j − Leu′j + 12 (Le)2u′′j − . . . , u(x+Le) = u j + Leu′j + 12 (Le)2u′′j + . . . , (29)
Replacing into (28), setting Le = aχ and collecting terms yields the infinite-order modified equation
(IOMoDE):

− 6w
γ a2

u + 1
2!

u′′ + 1
4!

a2χ2u′′′′ + 1
6!

a4χ4u′′′′′′ + ... = 0, (30)

in which γ = 12 + (3α2 − 2)wχ2. Truncating (30) to the second derivative and making Le → 0,
which is the same as making χ → 0, reduces it to the original equation:

u′′ = 12w
γ a2

u = 12w[
12 + (3α2−2)wχ2

]
a2

u
χ=0�⇒ u′′ = w

a2
u. (31)

10



The limit (31) confirms the consistency of the Ritz equations with the original ODE as Le → 0, and
plays an important role in the templates developed in Section 6. It is not useful, however, to find
nodally exact discretizations. For that all derivatives higher than two in (30) must be systematically
eliminated with the techniques outlined in Appendix A. Elimination yields the finite-order modified
equation (FOMoDE):

u′′ = 4
a2χ2

(
arcsinh

χ
√

µ

2

)2
u, with µ = 4

χ2

(
sinh

χ
√

w

2

)2
. (32)

Equations (26), (31) and (32) are used next to study suitable choices for parameter α.

§5.2. Positivity Lower Bound

Suppose ui > 0 and uk > 0 are prescribed in the patch equations (26). Solving for u j from the second
equation gives

u j =
12 + (3α2 − 2)wχ2
24 + (6α2 + 8)wχ2 (ui + uk). (33)

If w ≥ 0, the denominator is positive for any χ ≥ 0 and real α. A non-negative u j is guaranteed if
12 + (3α2 − 2)wχ2 ≥ 0. This is met by taking α2 ≥ α2P , where

α
2
P =

2

3
− 4

wχ2
. (34)

The subscript P stands for “ensuring positivity.” This result gives a useful modeling guideline: if
wχ2 ≤ 6, α may be set to zero, which collapses variational FIC to conventional Ritz, without impairing
positivity. For example, if w = 600, a mesh of 10 or more elements, i.e. χ < 1/10, may have α = 0
while precluding nonphysical oscillations.

Setting α2 = α2P into the element matrix Se of (25) cancels out the off-diagonal terms. The assembled
S is therefore diagonal. The solution for zero source and Dirichlet conditions at both ends is therefore
zero at all interior nodes. This mimics well the boundary layer behavior for very large and positive w;
say w > 10000. For positive but smaller w this solution can be way off, but it shows that (34) may be
viewed as a lower bound on acceptable values of α2, whereas the highly diffusive setting α2D = 2/3
found below is an upper bound. The results of Section 5.9, however, show that these bounds are of
little practical value for moderate values of w > 0. They are also useless for the Helmholtz equation,
in which w is negative.

§5.3. Diffusive Upper Bound

Suppose that the truncated modified equation on the left of (31) is required to reduce to the original
ODE for any χ , and not just χ = 0. The can be obtained by setting α2 = α2D , where

α
2
D =

2

3
. (35)

Computations show that using α2 = α2D overestimates the diffusion for all positive w. Thus it is “safe”
in the sense of providing physically correct solutions. But these can be highly inaccurate for small or
moderate w. The results of Section 5.9 illustrate this point. However this method gives a useful limit:
if w → +∞ on a fixed mesh, α2 → α2D = 2/3 for consistency. Consequently we have the bounds
α2P ≤ α2 ≤ α2D if w > 0. The nodally exact value of α2 found next lies in this interval.

11



w=1000

w=100
w=10

w=1
w=−1

w=ζ  =−11.4746...
w=4ζ   =−45.898...

χ

αΜ2

αΜ2

χ
w0.2

0.4
0.6

0.8
1

20

40

60
80

100

0.4
0.5
0.6

(a)
(b)

0
0

0.2 0.4 0.6 0.8 1

0.2

0.4

0.6

0.8

1

w=−10

cut

cut
2

2

Figure 8. Function α2M (w, χ). (a): 2D plots for fixed w ∈ [1000, ζ 2cut ] with ζ 2cut ≈ −11.4746. If wχ2 = ζ 2cut ,
α2M = 0; if wχ2<ζ 2cut , αM becomes imaginary. (b): 3D plot of α2M versus w ∈ [0, 100] and χ = [0, 1].

§5.4. Nodally Exact Matching

To get a nodally exact solution following the technique outlined in Section 3.4, require that (32) match
the original equation. u′′ = (w/a2) u for any {w, χ}. This gives

α
2
M =

2

3
− 4

wχ2
+ 1

sinh2
(

1
2
χ

√
w

) = 2
3

− 4
ζ 2

+ 1
sinh2(ζ/2)

, (36)

where ζ = χ√w and subscript M stands for matching. Expression (36) is valid for any w > 0. For
w → 0 or χ → 0 cancellations occur. These can be resolved by Taylor series expansion

α
2
M =

1

3
+ wχ

2

60
− w

2χ4

1512
+ w

3χ6

43200
− w

4χ8

1330560
+ . . . (37)

which shows that α2M → 1/3 if χ → 0 or w → 0. Figure 8 illustrates the variation of α2M as function
of w and χ . The latter varies between 0 and 1, attaining 1 only for one element over the domain length
a. For positive w, α2M is always positive but less than α

2
D = 2/3.

Extension to negative w to cover the Helmholtz equation requires some caution. A computational
difficulty is that α2M > 0 if and only if ζ

2 = wχ2 > ζ 2cut , with ζ 2cut = −11.47463503286087328. If
wχ2 < ζ 2cut , α

2
M < 0 and αM is imaginary. The minimum number of elements to get a positive α

2
M

follows from the condition (1/N e) = χ ≤
√

−ζ 2cut/(2πκ) = 0.539125/κ , where κ =
√−w/(2π) is

the number of full cycle oscillations of the exact solution over the length a, cf. (19). Solving for N e

gives
N e ≥ 1.85486 κ, (38)

A more easily remembered rule is N e ≥ 2 κ , or at least two elements per wavelength. So if the solution
cycles 16 times over the domain, use 32 elements or more. If (38) is not verified, however, a nodally
exact solution is still obtainable but may generally require use of complex arithmetic. If the mesh
consists of equal length elements and w is constant, however, complex numbers occur only in the first
and last rows of the coefficient matrix, and disappear altogether on applying Dirichlet BCs.

Another peculiarity associated with the Helmholtz equation is the presence of “Dirichlet resonances.”
If w = −k2π2 for k = 1, 2, . . . then 2πκ = √−w = kπ → sin 2πκ = 0 and the exact solution
(19) blows up. An exact number of cycles k fit over [−a/2, a/2], and Dirichlet BCs with um �= u p
are inconsistent. In practice values of w close to those will generate large amplitude oscillations.
Numerical tests in floating-point arithmetic show, however, that the nodally exact Ritz-FIC solution
has no problem matching those large oscillations even if w is extremely close to a resonant value.

12



§5.5. Pade Approximants

For computer implementation, exponential functions in (36), which may cause numerical accuracy
problems for w > 105, can be avoided by using Padé approximants to α2M . The (2,2), (4,4) and (6,6)
diagonal approximants computed by Mathematica are

α
2
M22 =

1260 + 113wχ2
30(126 + 5wχ2) , α

2
M44 =

3270960 + 339948wχ2 + 4787w2χ4
189(51920 + 2800wχ2 + 39w2χ4) ,

α
2
M66 =

1966225060800 + 218635457040wχ2 + 4430449320w2χ4 + 27010573w3χ6
60(98311253040 + 6016210200wχ2 + 115773966w2χ4 + 671585w3χ6) .

(39)

For χ < 1
4

and w < 10000 these provide at least 1, 2 and 3 digits of accuracy, respectively. For
moderate wχ2 the higher approximants give 10–12 digits of accuracy. As wχ2 → ∞, α2M22, α2M44,
α2M66 and α

2
M88 approach the limits 0.75333333333333, 0.64943698277032, 0.6703190462364 and

0.66590125338669, respectively. Since α2 should not exceed α2D = 2/3 on account of the consistency
condition discussed in Section 5.3, a cutoff may have to be implemented for some approximants.

§5.6. Nodal Exactness Verification

A valuable verification of (36) can be obtained directly by equating u j in (33) to the exact node value
for a BVP posed over the 2-element patch with prescribed node values ui and uk :

uexactj = 12 (ui + uk) sech ζ =
12 + (3α2 − 2) ζ 2
24 + (6α2 + 8) ζ 2 (ui + uk). (40)

Solving for α2 and simplifying gives back (36). This method, however, cannot be used if the exact
solution is not available, as it happens in two and three dimensional problems, whereas the modified
equation method does not rely on such knowledge.

§5.7. Reduced Integration Element

The foregoing Ritz-FIC equations have been constructed with exact element integration, which is
equivalent to using a two-point Gauss rule. If a one-point Gauss reduced integration (RI) rule is used,
the element equations become

Se ue =
[

Seii S
e
i j

Sei j S
e
j j

] [
ui
u j

]
= 1

Le

[
1 + 1

4
(1 + α)2ζ 2 −1 + 1

4
(1 − α2)ζ 2

−1 + 1
4
(1 − α2)ζ 2 1 + 1

4
(1 + α)2ζ 2

] [
ui
u j

]
=

[
0
0

]
, (41)

The two-element patch equations are

1

Le


 1 +

1
4
(1 + α)2ζ 2 −1 + 1

4
(1 − α2)ζ 2 0

−1 + 1
4
(1 − α2)ζ 2 2 + 1

2
(1 + α)2ζ 2 −1 + 1

4
(1 − α2)ζ 2

0 −1 + 1
4
(1 − α2)ζ 2 1 + 1

4
(1 + α)2ζ 2




[
ui
u j
uk

]
=

[
0
0
0

]
. (42)

Both α and α2 now appear in the difference equation and the three modified equation forms. Proceeding
as before one obtains the nodally exact α as

ᾱM =
1 − (τ/ζ )

√
ζ 2 − 4 + 8/τ − 4/τ 2

τ − 1 , ζ = χ
√

w, τ = cosh ζ. (43)

13



0.2
0.4

0.6
0.8

1

χ 20
40

60
80

100

w
−1

−0.75
−0.5

−0.25
0

0.2

χ

αM

(b)(a)
α

-

−20 −10 0 10 20

−2

−1.5

−1

−0.5

0

0.5

1

α    for exactly 
       integrated
       Ritz-FIC
       (FICM2) 

Μ

ζ = w χ 22
2−ζ  = π /4 1 2

2−ζ  = 9π /4 2 2
α    for reduced 
       integrated
       Ritz-FIC
       (FICM1)

Μ
−

2ζ       −11.47~~   cut

Figure 9. Nodally exact ᾱM for reduced-integration Ritz FIC element. (a) ᾱM (,̃χ) plotted for w ≥ 0; (b)
comparing nodally exact αM of exactly and reduced integration for positive and negative values of wχ

2.

The variation of ᾱM(w, χ) is plotted in Figure 9(a). Its Taylor series is

ᾱM = −
1

6
wχ

2 − 13
720

w
2
χ

4 + 127
20160

w
3
χ

6 + . . . (44)

which shows that ᾱM → 0 as w → 0 or χ → 0. The variation of ᾱM(w, χ) for the diffusion-absorption
case w > 0 is plotted in Figure 9(a). It is negative and smooth.

The behavior of ᾱM for the Helmholtz equation is more complicated than that of αM , the positive
square root of (36). Both are plotted as functions of ζ 2 = wχ2 for ζ 2 ∈ [−25, 25] in Figure 9(b).
Whereas αM is real for wχ

2 ≥ ζ 2cut = −11.474635 . . . and varies smoothly, ᾱM is real for all ζ 2 but
jumps at ζ̄ 2k = −k2π2/4 for k = 1, 2, . . .. These are roots of cosh(i |ζ̄k |) = cos |ζ̄k | = 0. These jumps
are harmless, however, since they occur at the set of ‘Dirichlet resonances” discussed in Section 4.2,
where the exact solution (19) blows up. In fact the RI model has the advantage that ᾱM stays real for
any w, whether positive or negative.

Using the exact solution to find ᾱM gives two solutions: 1 ± (τ/ζ )
√

ζ 2 − 4 + 8/τ − 4/τ 2/(τ − 1)
with τ = cosh ζ , which appear as roots of a quadratic. Taking the minus sign reproduces (43), whereas
taking the plus sign gives an ᾱM that “blows up” if wχ

2 → 0, and is therefore less desirable.
§5.8. Source Terms

The MoDE treatment of a smooth source term q(x) in u′′ − (w/a2)u = q(x) can be done by entirely
analogous techniques, but there are representation choices. One is based on expanding q(x) in Taylor
series: q(x) = q(x j )+q ′(x j )(x − x j )/a + . . . at node j , and inserting into the FIC functional to derive
a consistent node force term q j by the usual methods. Then q(x j ), q

′(x j ) . . . appear in the RHS of
the IOMoDE→FOMode elimination system, and the solution series is identified into the FOMoDE.
Alternatively q(x) can be expanded in Fourier series [37,38]. Delta function source terms can be
processed directly.

§5.9. Numerical Results

This section present numerical results obtained with the Ritz-FIC method for the model problem (15).
The problem domain is taken to have unit length (a = 1) extending from xm = − 12 a = − 12 through
x p = 12 a = 12 . The boundary conditions are of Dirichlet type: u(− 12 ) = 8 and u( 12 ) = 3. The domain
is divided into 8 elements of equal size; thus χ = Le/a = 1

8
. Four values of w: 1000, 50, −50 and

14



−0.4 −0.2 0.2 0.4

−2

2

4

6

8
w = 50(b)

−0.4 −0.2 0.2 0.4

−10

−5

5

10
w = −50

(c)

−0.4 −0.2 0.2 0.4

−30

−20

−10

10

20

30

w = −1000(d)

−0.4 −0.2 0.2 0.4

−2

2

4

6

8

10

w = 1000
(a)

10

x

x x

x

u u

u
u

2

2

2

2

2

2

2

Exact
CR:        α = 0
FICD:    α = α  =2/3
FICP:    α = α
FICM2: α = αM

P

D

Figure 10. Ritz-FIC results for 8-element discretization of the diffusion-absorption model problem with: (a)
w = 1000, (b) w = 50, (c) w = −50, (d) w = −1000. Dirichlet BCs u(− 12 ) = 8 and u( 12 ) = 3, for four

choices of α, compared to the exact solution.

−1000, are tested. Results are plotted in Figure 10, and listed to 10 decimal places in Tables 1 through
4. Labels shown in those Tables are template names assigned in Section 6.

Results for w = 1000. The solution exhibits two sharp boundary layers. Over the propagation region,
which extends roughly over the middle six elements of this discretization, u(x) takes small positive
values, of order 10−3 or less. The problem is discretized using four choices of α: α = 0 (conventional
Ritz), α2C = 2/3, α2P = 101/375 = 0.410667 and α2M = 0.490503. Numerical results are shown in
Figure 10(a), and listed in Table 1. As expected the solution for α2M is nodally exact. The results for
α = 0 oscillate giving unacceptable negative values. Results for αD and αP give the correct physical
behavior, and bound the boundary layer behavior on both sides. Although the difference of results
computed for αD and αP with the exact solution are masked in the scale of the plot, discrepancies at
interior points are clear from Table 1.

Results for w = 50. This case pertains to moderate absorption to diffusion ratio (14). The boundary
layers are diffuse and the exact solution resembles a second degree parabola. The problem is again
discretized using four α choices: α = 0, α2C = 2/3, α2P = −334/75 = −4.45333 and α2M = 0.345961.
The numerical results are plotted in Figure 10(b) and listed in Table 2. Again the solution for α2M is
nodally exact. The solutions for α = 0 and α2C = 2/3 bound the exact solution, maintain positivity
and display reasonable accuracy. The results for αP are way off as can be expected from the rationale
for its construction.

Results for w = −50. The solution to this Helmholtz equation goes roughly through one wavelength
over the problem domain. Negatives values of u(x) are physically admissible. The problem is dis-
cretized with four α choices: α = 0, α2C = 2/3, α2P = 434/75 = 5.78667 and α2M = 0.319898. Note

15



Table 1. Ritz-FIC 8-element solutions, w = 1000.

Node Exact α2 = 0 (CR) α2D = 23 (FICD) α2P (FICP) α2M (FICM2)
1 8.0000000000 8.0000000000 8.0000000000 8.0000000000 8.0000000000
2 0.1535996812 −1.0514115126 0.4553713752 0 0.1535996812
3 0.0029491079 0.1381982018 0.0259204876 0 0.0029491079
4 0.0000566306 −0.0182784646 0.0014772218 0 0.0000566306
5 0.0000014948 0.0028186197 0.0001154770 0 0.0000014948
6 0.0000212544 −0.0071239995 0.0005580649 0 0.0000212544
7 0.0011059158 0.0518597445 0.0097204167 0 0.0011059158
8 0.0575998805 −0.3942838932 0.1707642790 0 0.0575998805
9 3.0000000000 3.0000000000 3.0000000000 3.0000000000 3.0000000000

Table 2. Ritz-FIC 8-element solutions, w = 50.
Node Exact α2 = 0 (CR) α2D = 23 (FICD) α2P (FICP) α2M (FICM2)

1 8.0000000000 8.0000000000 8.0000000000 8.0000000000 8.0000000000
2 3.3105043651 3.2068850933 3.4002474704 0 3.3105043651
3 1.3801678534 1.2942058990 1.4569382771 0 1.3801678534
4 0.6001402687 0.5439870932 0.6518621127 0 0.6001402687
5 0.3203030826 0.2823794489 0.3560532239 0 0.3203030826
6 0.3074243641 0.2744060401 0.3384109163 0 0.3074243641
7 0.5507702703 0.5129051224 0.5851521371 0 0.5507702703
8 1.2531588628 1.2120974286 1.2890434650 0 1.2531588628
9 3.0000000000 3.0000000000 3.0000000000 3.0000000000 3.0000000000

Table 3. Ritz-FIC 8-element solutions, w = −50.

Node Exact α2 = 0 (CR) α2D = 23 (FICD) α2P (FICP) α2M (FICM2)
1 8.0000000000 8.0000000000 8.00000000000 8.0000000000 8.0000000000
2 2.1905465154 0.0898920049 3.91683000520 0 2.1905465154
3 −5.2217158313 −7.8823533208 −3.22636343116 0 −5.2217158313
4 −8.8132821321 −10.4059673187 −7.84896043693 0 −8.8132821321
5 −5.9562263170 −5.7365163498 −6.33955710134 0 −5.9562263170
6 1.2589621643 2.8982685015 0.12262521967 0 1.2589621643
7 7.5529760894 9.5296419462 6.48900658781 0 7.5529760894
8 8.3205257619 9.5737052899 7.78585155923 0 8.3205257619
9 3.0000000000 3.0000000000 3.00000000000 3.0000000000 3.0000000000

Table 4. Ritz-FIC 8-element solutions, w = −1000.

Node Exact α2 = 0 (CR) α2D = 23 (FICD) α2P (FICP) α2M (FICM2)
1 8.0000000000 8.0000000000 8.0000000000 8.0000000000 8.0000000000
2 11.5432046602 −4.5551330632 −0.5903534034 0 11.5432046602
3 −23.8970551078 2.6374205639 0.0435651218 0 −23.8970551078
4 21.3673096334 −1.6039299876 −0.0032213812 0 21.3673096334
5 −5.5295477072 1.1081731645 0.0003261977 0 −5.5295477072
6 −13.7521345403 −0.9839426045 −0.0012230626 0 −13.7521345403
7 24.4686939039 1.1895887560 0.0163380309 0 24.4686939039
8 −19.9456285035 −1.7940565712 −0.2213826078 0 −19.9456285035
9 3.0000000000 3.0000000000 3.0000000000 3.0000000000 3.0000000000

16



that α2M is still positive because wχ
2 = −50/64 > −11.4746, and no imaginary numbers appear. The

numerical results are plotted in Figure 10(c) and listed in Table 3. Again the solution for α2M is nodally
exact. The results for α = 0 and α2D = 2/3 bound the exact solution and follow its shape reasonably
well. The solution for αP is worthless.

Results for w = −1000. The rapidly oscillatory response goes roughly through five cycles over the
problem domain, since κ = √−w/(2π) ≈ 5.03. The problem is discretized with α = 0, α2C = 2/3,
α2P = 0.92667 and α2M = −0.261754. Here α2M is negative because wχ2 = −1000/64 = −11.875 <
−11.4746. The numerical results are plotted in Figure 10(d) and listed in Table 4. Although α2M
produces a nodally exact solution, an 8-element piecewise linear interpolation over five wavelengths
is plainly inadequate to capture intra-element oscillations.

−0.4 −0.2 0.2 0.4

−30

−20

−10

10

20

30

−0.4 −0.2 0.2 0.4

−30

−20

−10

10

20

30

−0.4 −0.2 0.2 0.4

−30

−20

−10

10

20

30

−0.4 −0.2 0.2 0.4

−30

−20

−10

10

20

30

8 elements 16 elements

32 elements 64 elements

x

x

x

x

u

u u

u

2

2

2

2

2

Exact
CR:        α = 0
FICD:    α = α  =2/3
FICM2: α = αM

D

Figure 11. Ritz-FIC convergence study for rapidly oscillatory case w = −1000. Boundary conditions:
u(− 12 ) = 8 and u( 12 ) = 3. Shown are results for 8, 16, 32 and 64 elements, and three choices of α: αM , αD

and conventional Ritz α = 0. Results for αP omitted as they are worthless.

The effect of injecting more elements in the later case is illustrated in Figure 11. This shows results
for three choices of α and 8 through 64 elements. A 64-element mesh places about 10 elements per
wavelength, which should be adequate as per well known empirical rules for approximating sinusoidal
waveforms. The beneficial effect of nodal exactness is evident. Results for the other two non-matching
choices of α, notably conventional Ritz, display erratic behavior even for fine discretizations.

Replacing the exactly integrated Ritz-FIC model by the reduced-integrated model with the matching
ᾱM of (43) yields identical results.

17



Continuify Taylor Series
Expansion

Eliminate HOD

Match

Step 1 Step 2

Step 3

Original ODE FOMoDE

Discrete (Patch) Form

DDMoDE

 IOMoDE

u'' −       u =  0 w
a2

Ritz FIC 
Discretization

S  u  + S  u  + S  u   = 0i j ii j k

i

i

j
e

e

u ′′= 2 2

(
arcsinh

χ
√

µ
2

)2
u

µ = −(2S  + S )/(χ  S )i

i

ij

j

4
a  χ

S  u(x−L ) + S   u(x) +
         + S  u(x+L ) = 0 

2

1 1
2! 4!2

2 2−     u +    u''+    a  χ u''''+ ...= 0
µ

 2a

S  + 2 S  cosh(   χ w) = 0
√

Figure 12. Nodally exact condition matching for patch equations (48) with Si = Sk , which
correspond to constant coefficient w and equal length elements Le = aχ .

§6. Templates

The exact- and reduced-integrated FIC-based elements obtained by setting α2 and α as per (36) and (43),
respectively, are nodally exact but lead to completely different finite element matrices. A nodally exact
model for the Helmholtz equation, developed by Harari and Hughes [15–17] produces yet another set of
matrices. This surprising lack of uniqueness raises the question: how many nodally exact elements can
be constructed for the absorption-diffusion-Helmholtz equation with constant coefficients? Templates
provide the correct answer: an infinite number.

Templates [7] are parametrized algebraic forms of FEM matrices that include all possible elements
once a priori constraints, such as symmetry, are enforced. Setting parameters to specific values or
functions produces element instances. The set of such values is called the template signature.

Assuming symmetry, the element coefficient matrix of the model problem can be placed in the template
framework by splitting Se = SeK + SeM , with

SeM = −
wχ2

6Le

[
2+β1+β2+β3 1−β1

1−β1 2+β1+β2−β3
]

, SeK =
1

Le

[
1+β4+β5+β6 −1−β4

−1−β4 1+β4+β5−β6
]

.

(45)
Matrix SeK (stiffness-like) and S

e
M (mass-like) come from the (u

′)2 and u2 terms, respectively, in the
variational formulation. In (45) β1 through β6 are dimensionless parameters to be chosen. If all of
them vanish the conventional Ritz equations (21) with piecewise linear shape functions result. Thus
the βi may be interpreted as specifying the deviation from conventional Ritz. (If unsymmetric matrices
are permitted, as produced for example by Petrov-Galerkin methods, one more parameter would enter
each matrix for a total of eight.)

An obvious simplification is that only the sum SeM +SeK appears in the FEM equations of the diffusion-
absorption and Helmholtz problems, and three parameters become redundant. Consequently one may
either set β4 = β5 = β6 = 0 and leave SK unchanged, or set β1 = β2 = β3 = 0 and leave SM
unchanged. In the ensuing development the first choice is selected. Thus (45) reduces to

SeM = −
wχ2

6Le

[
2+β1+β2+β3 1−β1

1−β1 2+β1+β2−β3
]

, SeK =
1

Le

[
1 −1

−1 1
]

. (46)

18



Table 5. Template Instances for 1D Diffusion-Absorption-Helmholtz with Constant Coefficients

Instance Description Nodally General performance, trouble spots
name exact?

CR Conventional Ritz element (21). No Nonphysical oscillations for w > 0 if
wχ 2 > 6. Erratic behavior for w < 0
(Helmholtz).

FICP Exactly integrated Ritz-FIC element
with α2 = α2P of (34), which guar-
antees positivity if w > 0.

No Zero solution at interior nodes, which
mimics boundary-layer behavior for huge
w > 0. Useless for w < 0 (Helmholtz).

FICD Exactly integrated Ritz-FIC element
with α2 = α2D = 2/3 of (35), a
setting for high artificial diffusion.

No Correct physical behavior for any w > 0,
especially very large values. Performs
poorly for w < 0 (Helmholtz).

FICM1 Reduced integrated Ritz-FIC element
with α set as per (42).

CC-ELE Behavior identical to FICM2 for w ≥ 0.
Higher wavenumber validity range than
FICM2 for w < 0 (Helmholtz).

FICM2 Exactly integrated Ritz-FIC element
with α2 set as per (36).

CC-ELE Behavior identical to FICM1 for w ≥ 0.
Imaginary coefficients if χ̃2 < ζ ∗ ≈
−11.4746.

HHH Harari and Hughes [16] nodally ex-
act element for one-dimensional ex-
terior Helmholtz.

CC-ELE Can be used for w > 0, where performance
is identical to FICM1 and FICM2. For
w < 0 (Helmholtz) SM becomes null at
wavenumbers noted in Table 6.

NECC Template set to match FOMoDE for
varying length elements.

CC-VLE Performance identical to FICM1, FICM2
and HHH if w > 0 and elements are of
equal length. Maintains nodal exactness if
element lengths vary.

CC-ELE: nodally exact for constant coefficients and equal-length elements.
CC-VLE: nodally exact for constant coefficients and variable length elements.

If β2 + 3β1 = 0 and β3 = 0, on taking β1 = 1 − β0 and β2 = 3(β0 − 1), β0 can be extracted as scaling
factor of SeM and only one parameter remains:

SeM = −
wχ2β0

6Le

[
2 1
1 2

]
, SeK =

1

Le

[
1 −1

−1 1
]

. (47)

The general form of the 2-element patch equations is

Si ui + Sj u j + Sk uk = 0. (48)
For constant coefficients and equal-length elements, Si = Sk . The modified equation processing steps
for this particular case is diagramed in Figure 12. The IOMoDE expression displayed there indicates that
consistency with the original equation as the mesh is refined requires that µ = (2Si + Sj )/(χ2Si ) → w
as χ → 0. For the template (46), Si = Sk = 6w(β1 − 1)χ2/(6aχ) and Sj = (6 + 6w(β1 + β2 +
2)χ2)/(3aχ). Hence

µ = 2w(3 + β2)
(6 + w(β1 − 1)χ2

∣∣∣∣
χ→0

= w(1 + 1
3
β2) whence β2|χ→0 = 0. (49)

19



Table 6. Template Signatures for Elements of Table 5.

Instance Templ. Template signature Trouble spots

name form

CR (46) β1 = β2 = β3 = 0. Nonphysical oscillations if wχ 2 > 6.

FICP (46) ζ = χ√w, α2 = 2/3 − 4/ζ 2
β1 = 1 − 6/ζ 2, β2 = 0, β3 = 3α.

β1 → ∞ if ζ 2 = wχ 2 = 6.

FICD (46) β1 = 1, β2 = 0, β3 =
√

6.

FICM1 (46) ζ = χ√w, τ = cosh ζ ,
ᾱ = 1 − (τ/ζ )

√
ζ 2 − 4 + 8/τ − 4/τ 2

τ − 1
β1 = (3ᾱ2 − 1)/2, β2 = 3ᾱ, β3 = 0.

If w < 0, entries jump at
√−wχ =

1
2
πn, n = 1, 2, . . .. See Figures 9

and 13(a).

FICM2 (46) ζ = χ√w, α2 = 23 −
4
ζ

2 + 1sinh2(ζ/2)
β1 = 3α2/2, β2 = 0, β3 = 3α.

If w < 0 and χ
√−w > 3.3874 . . .

diagonal entries of SeM become complex.
See Figures 9 and 13(b).

HHH (47) ζ = χ√w, τ = cosh ζ, β0 = 6(τ − 1)
ζ

2
(τ + 2) If w < 0 and χ

√−w = 2πn, n =
1, 2, . . ., β0 = 0 , which makes SeM =
0. See Figure 13(c).

NECC (46) ζ = χ√w, β1 = ζ
2 − 6 + 6ζ/ sinh ζ

ζ
2 ,

β2 = (6/ζ ) tanh(ζ/2) − 3, β3 = 0.
If w < 0 and χ

√−w = πn, n =
1, 2, . . ., entries of SeM blow up. See
Figure 13(d).

Matching for nodal exactness yields Si + 2Sj cosh ζ = 0 with ζ = χ
√

w. In terms of the parameters
of the template (46), the condition is

6 + w (2 + β1 + β2)χ2 =
(
6 + w (β1 − 1)χ2

)
cosh ζ. (50)

Notice that β3 does not appear in (50) because of equal-element-length cancellations. The foregoing
condition, which may be solved for either β1 or β2, shows that there is an infinite number of nodally
exact finite element models that form a one-parameter family. Four instances of this family are shown
in Tables 5 and 6. These are identified by labels FICM1, FICM2, HHH and NECC. The former two
are the “matched α” FIC elements obtained in Sections 5.7 and 5.4, respectively, whereas HHH was
obtained by Harari and Hughes [16]. A study of the variable-element-length case, omitted to save
space, shows that NECC is the only instance that is nodally exact for such discretizations.

Each nodally exact instance of Tables 6–7 has “trouble spots” when applied to the Helmholtz equation
w < 0, if κχ = χ√−w/(2π) exceeds 1/2. Those spots are displayed in Figure 13.
§7. Generalization to Variable Coefficients

This Section studies the application of the foregoing discretization methods to the variable-coefficient
generalization of (10):

k u′′ − s(x) u + Q = 0, (51)
in which k ≥ 0 is constant but s is now a linear function of x . As previously, the computational
domain is x ∈ [xm, x p] with Dirichlet boundary conditions u(xm) = um and u(x p = u p. Of particular

20



(a) FICM1

S22

S11

κ χ κ χ

κ χ κ χ

S12

0 0.5 1 1.5 2 2.5

−4

−2

0

2

4

0 0.5 1 1.5 2 2.5

−4

−2

0

2

4

0 0.5 1 1.5 2 2.5

−4

−2

0

2

4

0 0.5 1 1.5 2 2.5

−4

−2

0

2

4

S    = S11 22

S12

(b) FICM2

S12

(d) NECC

S12

(c) HHH

S    and  S     become
complex for  κ χ > 0.5387...

11 22

S    = S11 22S    = S11 22

S    S
S    S

11 12

12 22
S   =eM

Notation for all Figures

Figure 13. Trouble spots in coarse, nodally-exact discretizations of the constant-coefficient Helmholtz equation
w < 0. Graphs plot entries of the 2 × 2 matrix SeM for instances (a) FICM1, (b) FICM2, (c) HHH and (d) NECC, as
functions of the scaled wavenumber κχ = √−wχ/(2π). The number of elements per wavelength is N e

λ
= 1/(κχ).

Difficulties start at roughly κχ > 1/2, or N e
λ

< 2. Jumps in (a) occur at Dirichlet resonances and are harmless.

interest is when s changes sign over the computational domain. If so u(x) will exhibit boundary-layer
exponential decay behavior over the portion where s > 0, transitioning to oscillations of varying
frequency wherever s < 0. This is illustrated by the analytical solution curves in Figures 4–5.

The goal is to investigate whether variational FIC methods can handle simultaneously the diffusion-
absorption and Helmholtz type of equations in the same BVP. The restriction to linear variation in x is
imposed to have a closed form solution, in terms of Airy functions, available for comparison. Although
these functions are rarely useful in classical mechanics they find application in laser optics, quantum
mechanics, electromagnetics, and radiative heat transfer.

§7.1. The VC Model Problem

As before we restrict the computational domain to ± 1
2
a, set Q = 0, and redefine w(x) = s(x) a2/k

as a linear function in x explicitly given as w = w0 + ψ (x/a). The model problem is

u′′ − w
a2

u = 0 with w = w0 + ψ
x

a
, for x ∈ [− 1

2
a, 1

2
a], u(− 1

2
a) = um, u( 12 a) = u p. (52)

The associated functional is obtained by simply changing w in (16) to w(x):

J [u] =
∫ a

−a

(
(u′)2 + w0 + ψ

x
a

2a2
u2

)
dx . (53)

where variation is taken over continuous u(x) that satisfy a priori the Dirichlet BCs. The solution of
(52) can be expressed in closed form in terms of the Airy functions Ai(x) and Bi(x), as defined for

21



example in [1, Sec. 10.4], as follows. Assuming that ψ �= 0, compute:
ϒ = 3

√
ψ

2
, ξ = 2x/a, zξ = (w0 + 12ξψ)/ϒ, z p = (w0 + 12ψ)/ϒ, zm = (w0 − 12ψ)/ϒ,

Ap = Ai(z p), Am = Ai(zm), Bp = Bi(z p), Bm = Bi(zm), Aξ = Ai(zξ ), Bξ = Bi(zξ ),
d = Am Bp − Ap Bm, u(x) = [(Bp Aξ − Ap Bξ )/d] um + [(Am Bξ − Bm Aξ )/d] u p.

(54)
(In symbolic work, it is important to square ψ before taking the cubic root.) If ψ = 0 the solution
(54) fails. In that case w = w0 is constant and the exact solution in terms of exponentials given by
(17)–(19) should be used. As an example, Figures 4–5 show the exact solution of (9), a BVP that fits
(52) with w = −3000x/a2, a = 2, u(−1) = 25 and u(1) = −4.
The finite-order modified equation for this ODE requires hypergeometric functions to be expressed in
closed form, and is omitted for brevity.

§7.2. Reusing CC Templates

An expedient approach to FEM discretization of (52)
is to reuse the template instances of Tables 5 and 6. If
the nodal values of w(x) are wi and w j , the average
value wm = (wi + w j )/2 is used to form the element.
See Figure 14. For example, the reduced-integration
Ritz-FIC element FICM1 is again given by (41) except
that α = ᾱM comes from wm . For the HHH and NECC
instances wm is inserted in the formulas of Table 6.

xi
j

w wi m

i

wj

jslope  ψ = w  - w 

L = a χe
L /2 L /2

e e

Figure 14. Variable coefficient variation
over element.

For the Ritz-FIC element FICM2 a slight refinement is to evaluate w(x) = w(ξ) at the Gauss points
ξ = ±1/

√
3, compute αM there, and use those in the two-point Gauss quadrature. In the numerical

experiments, however, the reduced integration FICM1 performed consistently better than FICM2, even
after the foregoing refinement was incorporated.

The reuse strategy was found to generally work well over the exponential-behavior portion of the
computational domain in which w > 0. For oscillatory (Helmholtz) portions in which w < 0,
convergence was erratic unless a very fine mesh was used. These findings are clearly illustrated in the
plots of Figures 4–5. In particular, Figure 5(b) shows that 12 elements per shortest wavelength are
needed to get satisfactory convergence of FICM1 over the oscillatory region.

§7.3. VC-Customized Templates

In an effort to improve convergence over oscillatory regions, the Ritz-FIC steplength parameter α was
allowed to be a function of x : α = α(x), and matching with the modified VC equation attempted.
However, no matching was found.

Gradually it was realized was that a single steplength parameter was insufficient, and the more general
framework of templates introduced in Section 6 was necessary. The developments are lengthy and
only the final results are reported. Three useful template instances customized to the VC case are listed
in Tables 7 and 8. Model NELVC is nodally exact for linearly varying coefficient. (It is not known
whether NELVC is the only nodally exact model for this case). One drawback of NELVC, however,
is that its template parameters are expressed in terms of Airy functions and their x-derivatives. These
may be difficult to evaluate unless appropriate libraries are available. The other two template instances:
MNECC and CUBVC, generally produce better results than those in Tables 5 and 6 for the same mesh,
although they are not nodally exact.

22



Table 7. Template Instances for 1D Diffusion-Absorption-Helmholtz with Variable Coefficients

Instance Description Nodally General performance, trouble spots
name exact?

MNECC Modification of NECC to account
approximately for the variable co-
efficient by matching a truncated
MoDE.

No Reasonably accurate for w > 0 if variation
is not abrupt. Requires fine mesh for
Helmhotz.

CUBVC Similar to NELVC with Airy func-
tions approximated by cubic over
element.

No Excellent for w > 0, even for sharp
coefficient variation. Less accurate for
Helmholtz but better than MNECC.

NELVC Uses Airy functions to match MoDE
exactly.

Yes Nodally exact for any linear coefficient
variation, no matter how abrupt. Also exact
for variable length elements.

Table 8. Template Signatures for Elements of Table 7.

Instance Templ. Template signature Trouble spots

name form

MNECC (46) β1, β2 = same as for NECC, β3 = −3 ψχ(ζ coth ζ − 1)
2wζ 2

. Same as NECC

CUBVC (46) d = 10w(11760 + 1456wχ 2 + 28w2χ4 − χ 6ψ2),
β1 = 7χ2(1960w2 + 36w3χ 2 + 14χ 2ψ2 − wχ4ψ2)/d,
β2 = −7(4200w2χ2 + 100w3χ 4 + 70χ 4ψ2 − 3wχ 6ψ2)/d,
β3 = −3χψ(39200 + 2240wχ 2 + 28w2χ 4 − χ 6ψ2)/d.

Same as NECC

NELVC (46) ϒ = 3√ψ2, zm = (w − 12 χψ)/ϒ, z p = (w + 12 χψ)/ϒ,
Ap = Ai(z p), Am = Ai(zm), Bp = Bi(z p), Bm = Bi(zm),
A′p = Ai ′(z p), A′m = Ai ′(zm), B ′p = Bi ′(z p), B ′m = Bi ′(zm),
d1 = A′m Bm + A′p Bp − Am B ′m − Ap B ′p,
d2 = (A′m−A′p)(Bm−Bp) − (Am−Ap)(B ′m−B ′p),
d3 = A′p Bm − A′m Bp + Ap B ′m − Am B ′p, d = Ap Bm − Am Bp,
β1 = 1−6/ζ 2 + 3 d1χϒ

d ζ 2
, β2 = −3− 3 d2χϒ

d ζ 2
, β3 = −3 d3χϒ

d ζ 2
.

Fails for ψ =
0 if not checked.

§7.4. Numerical Results for Variable Coefficients

The test BVP is (9), i.e. u′′ = −750 x u, a = 2, u(−1) = 25 and u(1) = −4. Consequently
w = −750 x a2 = −3000 x varies from 3000 on the left to −3000 at the right, and ψ = −6000.
Results for meshes with 8 through 64 elements are presented in Figures 15 and 16.

Figure 15 collects results for the four constant-coefficient nodally exact models of Tables 5–6: FICM1,
FICM2, HHH and NECC, plus Conventional Ritz (CR). All models perform reasonably well in the
exponential region x < 0, and capture the boundary layer near x = −1 well as the mesh is refined. In
the oscillatory region x > 0 three models: FICM1, NECC and HHH, start to converge satisfactorily
at 32 elements, and agree well with the exact solution at 64 elements. The other two models: CR and
FICM2, display erratic behavior throughout; in fact convergence was noticeable only on using 256
elements or more.

23



u

x

u

x

u

x

u

x

− 1 − 0.5 0 0.5 1

− 30

− 20

− 10

10

20

30

− 1 − 0.5 0 0.5 1

− 30

− 20

− 10

0

10

20

30

− 1 − 0.5 0 0.5 1

− 30

− 20

− 10

0

10

20

30

− 1 − 0.5 0 0.5 1

− 30

− 20

− 10

0

10

20

30

8 elements 16 elements

32 elements 64 elements

0

FICM1
FICM2
NECC
HHH
CR
Exact

FICM1
FICM2
NECC
HHH
CR
Exact

FICM1
FICM2
NECC
HHH
CR
Exact

FICM1
FICM2
NECC
HHH
CR
Exact

Figure 15. Convergence study of variable coefficient ODE u′′ = −3000 x u with a = 2, Dirichlet boundary
conditions: u(−1) = 25 and u(1) = −4. Results shown for 8, 16, 32 and 64 elements, nodally exact templates of

Tables 6–7 plus CR.

u

x

u

x

u

x

u

x

8 elements 16 elements

32 elements 64 elements

− 1 − 0.5 0 0.5 1

− 30

− 20

− 10

0

10

20

30

− 1 − 0.5 0 0.5 1

− 30

− 20

− 10

0

10

20

30

− 1 − 0.5 0 0.5 1

− 30

− 20

− 10

0

10

20

30

− 1 − 0.5 0 0.5 1

− 30

− 20

− 10

0

10

20

30

NELVC
CUBVC
MNECC
Exact

NELVC
CUBVC
MNECC
Exact

NELVC
CUBVC
MNECC
Exact

NELVC
CUBVC
MNECC
Exact

Figure 16. Convergence study of variable coefficient ODE u′′ = −3000 x u with a = 2, Dirichlet boundary
conditions: u(−1) = 25 and u(1) = −4. Results shown for 8, 16, 32 and 64 elements, and templates of Tables 8–9.

24



Figure 16 collects results for the three VC-customized template instances of Tables 7 and 8: MNECC,
CUBVC and NELVC. Again the exponential side is accurately captured even for the coarsest mesh.
NELVC is of course nodally exact, and its only deficiency is the intra-element variation. The other
two models begin to display nodal convergence at 16 elements, even near x = 1, and can hardly be
distinguished from NELVC at the plot scale for 32 and 64 elements. MNECC performs surprisingly
well considering the simplicity of its template signature, given in Table 8.

§8. Conclusions

This article has presented a synthesis of three techniques: FIC, variational Ritz and modified differential
equations. The major new contributions are:

1. The FIC approach to functional modification. This permits effective stabilization of the diffusion-
absorption problem while staying within the ordinary Ritz framework of finite elements. No
separate choice of trial and weight functions is necessary.

2. The use of the modified equation (MoDE) approach to find a value of the stabilization parameter
that is nodally exact for all values of the absorption-to-diffusion ratio, including negative values
that morph the original ODE into the Helmholtz equation.

One surprise was the discovery that nodally exact discretizations for the constant coefficient case are
not unique, which explains variants in the published literature. With the introduction of templates as
described in Section 6, all such instances can be characterized once and for all. Templates also allowed
the variable coefficient case to be tamed, although uniqueness remains an open question.

The chief attraction of the modified equation approach is that availability of exact solutions of the source
ODE is not required to construct accurate discretizations. This feature is important for application of
the method in two and three dimensions. For the one-dimensional problem discussed here, nodally
exact discretization can be also obtained by patch matching as illustrated in Section 5.6.

The logical extension of the present combination of methods is the study of two and three dimensional
space discretizations by considering regular finite element patches. Since exact solutions for such
problems are rarely available, the modified equation method appears to be a promising choice for
improving nodal solutions over fixed meshes. The Ritz ingredient, however, may have to be dropped
in problems, such as advection, that are not easily formulated in a variational framework

Appendix A. Processing Modified Equations

This Appendix presents two mathematical procedures that find application in the modified equation
method. Technically the most difficult operation in the process of Figure 3 is passing from the infinite
order modified equation (IOMoDE) to a finite order one (FOMoDE). There is no universal method
for doing this reduction because the process involves identification of series. Case by case is the
rule. Nonetheless there are some differential equations of mathematical physics that naturally lead to
Toeplitz matrix forms. If this happens, an array of powerful techniques is available. This is illustrated
by an example that conveys the flavor of the method as well as finding applications in the matching
procedures for nodal exactness of Sections 5–6.

A.1 Reduction by Series Identification

Consider the homogeneous, even-derivative, infinite-order ODE in the dependent variable u(x):

− µ
2a2

u(x)+ 1
2!

u′′(x)+ a
2χ2

4!
u′′′′(x)+ a

4χ4

6!
u′′′′′′(x)+ . . . = 0, a > 0, µ �= 0, 0 < χ ≤ 1. (55)

25



Here µ and χ are dimensionless real parameters whereas a, which is a characteristic problem dimension,
has dimension of length. The reduction to finite order can be obtained by a variant of Warming and
Hyett’s [45] derivative elimination procedure, Differentiate (55) 2(n − 1) times (n = 1, 2, . . .) with
respect to x while discarding all odd derivatives. Truncate to the same level in χ , and set up a linear
system in the even derivatives u′′, u′′′′, . . .. The configuration of the elimination system is illustrated
for n = 4:




1/2! a2χ2/4! a4χ4/6! a6χ6/8!
− 1

2
µa−2 1/2! a2χ2/4! a4χ4/6!
0 − 1

2
µa−2 1/2! a2χ2/4!

0 0 − 1
2
µa−2 1/2!







u′′

u′′′′

u′′′′′′

u′′′′′′′′


 =




1
2
a−2µ u

0
0
0


 . (56)

The coefficient matrix of this system is Toeplitz and Hessemberg but not Hermitian. This can be solved
for u′′ to yield a truncated FOMoDE. Solving (56) and expanding in Taylor series gives

u′′ = 56µ(360 + 60λ + λ
2) u

20160 + 5040λ + 252λ2 + λ3 = µ
(

1 − 1
12

λ + 1
90

λ
2 + . . .

)
u. (57)

where λ = a2χ2µ. Increasing n, the coefficients of the power series in λ are found to be generated
by the recursion c1 = 1, ck+1 = − 12 k2ck/[(k + 1)(2k + 1)], k ≥ 1, which produces the sequence
{1, −1/12, 1/90, −1/560, 1/3150, −1/16632, . . .}. The generating function [46] can be found by
Mathematica’s package RSolve by entering <<DiscreteMath‘RSolve‘; g=GeneratingFunction[
a[k+1]==-k*k/(2*(k+1)*(2*k+1))*a[k],a[1]==1,a[k],k,λ]; Print[g]. The answer may
be verified by Print[Series[g,{ λ,0,8 }]. The result is

4

λ

(
arcsinh

√
λ

2

)2
= 1 − λ

12
+ λ

2

90
− λ

3

560
+ λ

4

3150
− λ

5

16632
+ λ

6

84084
− λ

7

411840
+ . . . (58)

This yields the second-order FOMoDE

u′′ = 4
a2χ2

(
arcsinh

√
λ

2

)2
u = 4

a2χ2

(
arcsinh

χ
√

µ

2

)2
u. (59)

Suppose that the original ODE is that of the model BVP (15): u′′ = (w/a2) u, with constant w. For
nodal exactness, w = (4/χ2)

(
arcsinh( 1

2
χ

√
µ

)2
. If µ is the free parameter, solving for it gives

µ = 4
χ2

(
sinh

χ
√

w

2

)2
= 2

(
cosh(χ

√
w) − 1

)
χ2

. (60)

This is used in Section 5.4 to produce (36). In the foregoing analysis no term of the equations (55) or
(59) is assumed to be small. The procedure for handling a forcing term f (x) follows essentially the
same technique.

Occasionally it is useful to recover higher derivatives in terms of u. This is done by repeated differ-
entiation of the FOMoDE. For this example, if u′′ = C u, then u′′′′ = C u′′ = C2 u, and likewise for
higher derivatives.

26



−1
−0.5

0
0.5

1 −1

−0.5

0

0.5
1

0
0.02
0.04

−1
−0.5

0
0.5

1 −1 −0.5 0 0.5 1
−1

−0.5

0

0.5

1

x
x

y

y

R

Figure 17. Plot of the modulus
√

g2r + g2i of generating function (64) for {µ =
1/2, a = 1, χ = 1/4}, showing the only zero at x ≈ 0.4998, y = 0 and the convergence

radius R.

A.2 Reduction by a Theorem of Muir

The construction of (59) has a heuristic flavor: it relies on recognizing a series. A more direct derivation
that however requires more advanced mathematical tools, is presented here. The method relies on the
following theorem on determinant recurrences [21, p. 704]. Suppose that the smooth generating
function g(z), where z is complex, has the formal Taylor series a0 + a1 z + a2 z2 + . . . at z = 0. The
reciprocal 1/g(z) has the formal expansion

1

g(z)
= 1

a0 + a1z + a2z2 + a3z3 + . . .
= A0 − A1z + A2z2 − A3z3 + . . . , a0 �= 0, (61)

Then the Toeplitz determinants formed with the ai coefficients satisfy

A1 = a−10 | a1 | , A2 = a−20
∣∣∣∣ a1 a2a0 a1

∣∣∣∣ , A3 = a−30
∣∣∣∣∣
a1 a2 a3
a0 a1 a2
0 a0 a1

∣∣∣∣∣ , A4 = a−40
∣∣∣∣∣∣∣
a1 a2 a3 a4
a0 a1 a2 a3
0 a0 a1 a2
0 0 a0 a1

∣∣∣∣∣∣∣ , . . .
(62)

with A0 = 1/a0. Now the determinants that appear in the truncated Toeplitz n × n matrices in the
derivative elimination process, exemplified by (56) for n = 4, have the form

A1 = | 1/2! | , A2 =
∣∣∣∣ 1/2! a2χ2/4!− 1

2
µa−2 1/2!

∣∣∣∣ , A3 =
∣∣∣∣∣∣

1/2! a2χ2/4! a4χ4/6!
− 1

2
µa−2 1/2! a2χ2/4!
0 − 1

2
µa−2 1/2!

∣∣∣∣∣∣ , . . . (63)
The nth truncated-Toeplitz approximation to the FOMoDE (n > 1) is u′′ = Cn u, with Cn = An−1/An .
If the series (61) has radius of convergence R, then Cn → 1/R as n → ∞. From (61) through (63)
one obtains by inspection

a2χ2 g(z) = cosh(aχ√z) − (1 + 1
2
µχ

2
). (64)

The radius of convergence of 1/g(z) is the distance from z = 0 to its closest pole, or what is the same,
to the zero of smallest modulus of g(z). As pictured in Figure 17, the function g(z) with z = x + iy,
has a single zero x = R on the real line y = 0. This is obtained by solving g(R) = 0 or, equivalently,
cosh(aχ

√
R) = 1 + 1

2
µχ2, whence aχ

√
R = arccosh(1 + 1

2
µχ2). See Figure 17 for a geometric

interpretation. For µ > 0 this is equivalent to R = 4a−2χ−2
(
arcsinh( 1

2
χ

√
µ)

)2
, which leads to

the same solution: u′′ = Ru = 4a−2χ−2
(
arcsinh( 1

2
χ

√
µ)

)2
found in (59). This method bypasses

determinant expansions and series identification, but is restricted to Toeplitz-Hessemberg matrices.

27



Acknowledgements

The work of the first author has been partly supported through a fellowship awarded by the Spanish Ministerio
of Educación y Cultura to visit CIMNE during May-June 2002, and partly by the National Science Foundation
under grant High-Fidelity Simulations for Heterogeneous Civil and Mechanical Systems, CMS-0219422. Thanks
are due Professor Hughes for calling attention to the nodally exact solutions in [16,17].

References

1. Abramowitz M, Stegun IA (eds) (1972) Handbook of Mathematical Functions with Formulas, Graphs, and
Mathematical Tables, 9th printing, Dover, NY

2. Ahmed MO, Corless RM (1997) The method of modified equations in Maple. Electronic Proc. 3rd
Int. IMACS Conf. on Applications of Computer Algebra, Maui, Hawaii. PS version accessible at
www.math.unm.edu/ACA/1997/Proceedings/odes/Ahmed paper.ps

3. Brezzi F, Hughes TJR, Marini LD, Russo A, Süli E (1999) A priori error analysis of residual-free bubbles
for advection-diffusion problems. SIAM J. Numer. Anal. 36:1933–1948

4. Brezzi F, Russo A (2000) Stabilization techniques for the finite element method. In Applied and Industrial
Mathematics Venice-2, 1998. Ed. by Spigler R. Kluwer Academic Pubs, Dordrecht, NL, 47–58

5. Farhat C, Harari I, Franca L (2001) The discontinuous enrichment method. Comp. Meth. Appl. Mech. Engrg.
190:6455–6479

6. Farhat C, Harari I, Hetmaniuk U (2003) The discontinuous enrichment method for multiscale analysis.
Comp. Meth. Appl. Mech. Engrg. 192:3195–3209

7. Felippa CA (2004) A template tutorial. Chapter 3 in Computational Mechanics: Theory and Practice.
Ed. by Mathisen KM, Kvamsdal T and Okstad KM. CIMNE, Barcelona, Spain, 29–68

8. Finlayson BM (1972) The Methods of Weighted Residuals and Variational Principles, Academic Press, NY
9. Franca L, Farhat C, Lesoinne M, Russo A (1998) Unusual stabilized finite element methods and residual-

free-bubbles. Int. J. Num. Meth. Fluids. 27:159–168
10. Franca L, Farhat C, Macedo AP, Lesoinne M (1997) Residual-free bubbles for the Helmholtz equation. Int.

J. Num. Meth. Engrg. 40:4003–4009
11. Griffiths D, Sanz-Serna J (1986) On the scope of the method of modified equations. SIAM J. Sci. Statist.

Comput. 7:994–1008
12. Kolesnikov A, Baker AJ (1999) Efficient implementation of high order methods for the advection-diffusion

equation. Proc. 3rd ASME/JSME Joint Fluids Engrg Conf. San Francisco, CA
13. Hairer E (1994) Backward analysis of numerical integrators and symplectic methods. Annals Numer. Math.

1:107–132
14. Hairer E, Lubich C, Wanner G (2002) Geometric Numerical Integration: Structure Preserving Algorithms

for Ordinary Differential Equations. Springer, Berlin
15. Harari I, Hughes TJR (1990) Design and analysis of finite element methods for the Helmholtz equation in

exterior domains. Appl. Mech. Rev. 43:S366–373
16. Harari I, Hughes TJR (1991) Finite element methods for the Helmholtz equation in an exterior domain:

model problems, Comp. Meth. Appl. Mech. Engrg. 87:59–96
17. Harari I, Hughes TJR (1992) Galerkin/least-square finite element methods for the reduced wave equation with

no reflecting boundary conditions in unbounded domains, Comp. Meth. Appl. Mech. Engrg. 98:411–454
18. Hirt CW (1968) Heuristic stability theory for finite difference equations. J. Comp. Physics. 2:339–342
19. Hughes TJR (1995) Multiscale phenomena: Green’s functions, the Dirichlet-to-Neumann formulation, sub-

grid scale models, bubbles and the origins of stabilized methods. Comp. Meth. Appl. Mech. Engrg. 127:387–
401

20. Kloeden PE, Palmer KJ (eds) (1994) Chaotic Numerics. Amer. Math. Soc., Providence, RI
21. Muir T (1960) Theory of Determinants. Dover, NY
22. Lomax H, Kutler P, Fuller FB (1970) The numerical solution of partial differential equations governing

convection. AGARDograph 146-70, NATO Advisory Group for Aerospace Research, Brussels

28



23. Oñate E, Garcı́a J, Idelsohn SR, (1997) Computation of the stabilization parameter for the finite element
solution of advective-diffusive problems. Int. J. Numer. Meth. Fluids. 25:1385–1407

24. Oñate E, Garcı́a J, Idelsohn SR (1998) Computation of the stabilization parameter for the finite element
solution of advective-diffusive problems. In New Advances in Adaptive Computer Methods in Mechanics.
Ed. by Ladevèze P and Oden JT. Elsevier, Amsterdam, NL

25. Oñate E (1998) Derivation of the stabilization equations for advective-diffusive fluid transport and fluid flow
problems. Comp. Meth. Appl. Mech. Engrg., 151:233–267

26. Oñate Manzan M (1999) A general procedure for deriving stabilized space-time finite element methods for
advective-diffusive problems. Int. J. Num. Meth. Engrg. 31:203–207

27. Oñate E, Manzan M (2000) Stabilization techniques for finite element analysis of convection-diffusion fluid
problems. in Comp. Anal. of Heat Transfer. Ed. by Comini G and Sunden B. WIT Press, Southampton, UK

28. Oñate E (2000) A stabilized finite element method for incompressible viscous flows using a finite increment
calculus formulation. Comp. Meth. Appl. Mech. Engrg. 182:355–370

29. Oñate E, Garcı́a J (2001) A finite element method for fluid-structure interaction with surface waves using a
finite calculus formulation. Comp. Meth. Appl. Mech. Engrg. 191:635–660

30. Oñate E (2003) Multiscale computational analysis in mechanics using finite calculus: an introduction. Comp.
Meth. Appl. Mech. Engrg. 192:3043–3059

31. Oñate E, Taylor RL, Zienkiewicz OC, Rojek J (2003) A residual correction method based on finite calculus.
Engrg. Comput. 20:629–658

32. Oñate E, Taylor RL, Zienkiewicz OC, Rojek J (2004) Finite calculus formulation for analysis of incompress-
ible solids using linear triangles and tetrahedra. Int. J. Num. Meth. Engrg. 59:1473–1500

33. Oñate E (2004) Possibilities of finite calculus in computational mechanics. Int. J. Num. Meth. Engrg.
60:255–281

34. Oñate E, Garcı́a J, Idelsohn SR (2004) Ship Hydrodynamics (2004) in Encyclopedia of Computational
Mechanics Vol 2. Ed. by Hughes TJR, de Borst R, Stein E. Wiley, Chichester, 579–610

35. Oñate E, Miquel J, Hauke G (2004) A stabilized finite element method for the one-dimensional advection
diffusion-absorption equation using finite calculus. Comp. Meth. Appl. Mech. Engrg. Submitted

36. Oñate E, Felippa CA (2005) Variational formulation of the finite calculus equations in solid mechanics,
CIMNE Report in preparation

37. Park KC, Flaggs DL (1984) A Fourier analysis of spurious modes and element locking in the finite element
method. Comp. Meth. Appl. Mech. Engrg. 42:37–46

38. Park KC, Flaggs DL (1984) An operational procedure for the symbolic analysis of the finite element method.
Comp. Meth. Appl. Mech. Engrg. 46:65–81

39. Richtmyer RL, Morton, KW (1967) Difference Methods for Initial Value Problems. 2nd ed., Interscience
Pubs (Wiley), NY

40. Roache PJ (1970) Computational Fluid Mechanics. Hermosa Publishers, Albuquerque, NM
41. Stuart AM, Humphries AR (1996) Dynamic Systems and Numerical Analysis. Cambridge Univ. Press,

Cambridge UK
42. Tong P (1969) Exact solution of certain problems by the finite element method. J. AIAA. 7:179–180
43. Vujanovic BD, Jones SE (1989) Variational Methods in Nonconservative Phenomena, Academic Press, NY
44. Waltz JE, Fulton RE, Cyrus NJ (1968) Accuracy and convergence of finite element approximations. Proc.

Second Conf. on Matrix Methods in Structural Mechanics. WPAFB, Ohio, Sep. 1968. In AFFDL TR 68-150,
995–1028

45. Warming RF, Hyett BJ (1974) The modified equation approach to the stability and accuracy analysis of finite
difference methods. J. Comp. Physics. 14:159–179

46. Wilf HS (1991) Generatingfunctionology. Academic Press, NY
47. Wilkinson JH (1961) Error analysis of direct methods of matrix inversion J. ACM. 8:281–330
48. Wilkinson JH (1963) Rounding Errors in Algebraic Processes. Prentice-Hall, Englewood Cliffs, NJ
49. Wilkinson JH (1965) The Algebraic Eigenvalue Problem. Oxford Univ. Press, Oxford, UK
50. Zienkiewicz OC, Taylor RE (1988) The Finite Element Method Vol. I. 4th ed. McGraw-Hill, London, UK

29


