

























































Mixed Aggregated Finite Element Methods for the Unfitted Discretization of the Stokes Problem | SIAM Journal on Scientific Computing | Vol. 40, No. 6 | Society for Industrial and Applied Mathematics


 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

SIAM J. S\mathrm{C}\mathrm{I}. C\mathrm{O}\mathrm{M}\mathrm{P}\mathrm{U}\mathrm{T}. \mathrm{c}\bigcirc 2018 Society for Industrial and Applied Mathematics
Vol. 40, No. 6, pp. B1541--B1576

MIXED AGGREGATED FINITE ELEMENT METHODS FOR THE
UNFITTED DISCRETIZATION OF THE STOKES PROBLEM\ast 

SANTIAGO BADIA\dagger , ALBERTO F. MARTIN\ddagger , \mathrm{A}\mathrm{N}\mathrm{D} FRANCESC VERDUGO\ddagger 

Abstract. In this work, we consider unfitted finite element methods for the numerical approx-
imation of the Stokes problem. It is well-known that these kinds of methods lead to arbitrarily
ill-conditioned systems and poorly approximated fluxes on unfitted interfaces/boundaries. In order
to solve these issues, we consider the recently proposed aggregated finite element method, originally
motivated for coercive problems. However, the well-posedness of the Stokes problem is far more sub-
tle and relies on a discrete inf-sup condition. We consider mixed finite element methods that satisfy
the discrete version of the inf-sup condition for body-fitted meshes and analyze how the discrete
inf-sup is affected when considering the unfitted case. We propose different aggregated mixed finite
element spaces combined with simple stabilization terms, which can include pressure jumps and/or
cell residuals, to fix the potential deficiencies of the aggregated inf-sup. We carry out a complete
numerical analysis, which includes stability, optimal a priori error estimates, and condition number
bounds that are not affected by the small cut cell problem. For the sake of conciseness, we have re-
stricted the analysis to hexahedral meshes and discontinuous pressure spaces. A thorough numerical
experimentation bears out the numerical analysis. The aggregated mixed finite element method is
ultimately applied to two problems with nontrivial geometries.

Key words. embedded boundary, unfitted finite elements, Stokes, inf-sup, conditioning

AMS subject classifications. 65N12, 65N15, 65N30

DOI. 10.1137/18M1185624

1. Introduction. Unfitted finite element (FE) techniques are receiving increas-
ing attention since they are very appealing in many practical situations. Such tech-
niques avoid the generation of body-fitted meshes, which is a serious bottleneck in
large-scale simulations. They are particularly well-suited to multiphase and multi-
physics applications with moving interfaces (e.g., fracture mechanics [1], fluid-structure
interaction [2], and free surface flows [3]) and in applications with varying domains
(e.g., shape or topology optimization [4], additive manufacturing and three-
dimensional (3D) printing [5], and stochastic geometry problems [6]). Unfitted FE
methods have been named in different ways. When designed for capturing interfaces,
they are usually denoted as the extended FE method [7], whereas they are denoted
as embedded or unfitted methods when the motivation is to simulate a problem using
a (usually simple) background mesh (see, e.g., the cutFEM method [8] and the finite
cell method [9, 10, 11]).

Although useful, unfitted FE methods have known drawbacks. They pose prob-
lems to the numerical integration and the imposition of Dirichlet boundary conditions

\ast Submitted to the journal's Computational Methods in Science and Engineering section May 4,
2018; accepted for publication (in revised form) October 31, 2018; published electronically December
18, 2018.

http://www.siam.org/journals/sisc/40-6/M118562.html
Funding: This work was partially funded by the European Union under the ExaQUte project

within the H2020 Framework Programme (grant agreement 800898). The first author received sup-
port from the Catalan Government through the ICREA Acad\`emia Research Program. The third
author received support from the Secretaria d'Universitats i Recerca of the Catalan Government in
the framework of the Beatriu Pin\'os Program (grant 2016 BP 00145).

\dagger Department of Civil and Environmental Engineering. Universitat Polit\`ecnica de Catalunya, Jordi
Girona 1-3, Edifici C1, 08034 Barcelona, Spain (sbadia@cimne.upc.edu).

\ddagger CIMNE Centre Internacional de M\`etodes Num\`erics en Enginyeria, UPC, Esteve Terradas 5,
08860 Castelldefels, Spain (amartin@cimne.upc.edu, fverdugo@cimne.upc.edu).

B1541

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp

http://www.siam.org/journals/sisc/40-6/M118562.html
mailto:sbadia@cimne.upc.edu
mailto:amartin@cimne.upc.edu
mailto:fverdugo@cimne.upc.edu


 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1542 S. BADIA, A. F. MARTIN, AND F. VERDUGO

and lead to ill-conditioned systems [12]. For most of the unfitted FE techniques, the
condition number of the discrete linear system depends not only on the characteristic
element size of the background mesh but also on the ratios for all cut cells of the total
cell volume and the cell volume inside the physical domain, which can be arbitrarily
small, leading to the so-called small cut cell problem. Methods based on fictitious
material [9] require a penalty term that goes to zero with a power of the mesh size for
optimal convergence. Thus, the condition numbers of the resulting linear systems are
asymptotically affected by the small cut cell problem. For further details about the
convergence behavior of fictitious material methods, see [13]. Preconditioned iterative
linear solvers suitable for standard FE methods are not robust for these formulations.
Recently, a robust domain decomposition preconditioner able to deal with cut cells has
been proposed in [14] for first order methods, but these preconditioners still require
some special treatment for the robust direct solution of local-to-subdomain systems.
On the other hand, ill-posed degrees of freedom (DOFs) on cut cells can lead to poorly
approximated fluxes on unfitted boundaries/interfaces, which is especially critical for
interface-coupled problems like fluid-structure interaction.

The authors have recently proposed in [15] an unfitted FE formulation, referred
to as the aggregated finite element method (agFEM), which fixes the small cut cell
problems for elliptic partial differential equations (PDEs). This novel method relies
on the so-called aggregated finite element (agFE) spaces, grounded on cell aggrega-
tion techniques and judiciously chosen linear constraints for conflictive DOFs with
respect to interior ones. This approach can be applied to grad-conforming (globally
continuous) spaces and discontinuous FE spaces of arbitrary order. The agFEM leads
to a well-posed Galerkin formulation of elliptic problems, viz., no stabilization terms
are needed and the method is thus consistent and does not introduce artificial dif-
fusion. Furthermore, the resulting linear systems have condition numbers that scale
only with the element size of the background mesh in the same way as in standard FE
methods for body-fitted meshes. These methods have been implemented in FEMPAR,
a large-scale FE software package [16, 17].

Among other existing approaches, the most salient one is the ghost penalty for-
mulation used in the CutFEM method [8, 18]. The most widely used version of this
method requires computing high order derivatives on facets for high order FEs, which
are not at our disposal in general FE codes and are expensive to compute, certainly
complicating the implementation of the methods and harming code performance.
Other versions of the ghost penalty method that do not require the computation
of high order derivatives but rely on some macroelement mesh structure have been
proposed for some problems (see, e.g., [19] for the Poisson equation and [20, 21] for
the time-dependent convection-diffusion equation on moving domains). For B-spline
approximations, one can consider the so-called extension or extrapolation techniques
(see, e.g., [22, 23, 24]). These works are close to the agFEM [15] in the sense that the
problematic DOFs associated with B-splines with small support inside the physical
domain are eliminated by constraining them as a linear combination of well-posed
DOFs. Such aggregation approaches are not new in discontinuous Galerkin (DG)
methods (see, e.g., [25, 26, 27]), for which the situation is much easier, since no con-
formity must be kept. In fact, some aggregation techniques in DG [25, 26, 27] can be
cast as discontinuous agFEMs.

The use of mixed FE methods on unfitted meshes has been explored in previous
works. The combination of ghost penalty stabilization and inf-sup stable elements
for the unfitted FE approximation of the Stokes problem was originally addressed
in [28] for triangular meshes in two dimensions. The analysis therein relies on the

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1543

continuous inf-sup condition on the interior domain, viz., the union of interior cells
(not intersecting the boundary), in order to prove pressure stability in interior cells,
whereas cut cell pressure stability relies on ghost penalty stabilization. The extension
of this work to interface Stokes problems for the MINI element has been proposed
in [29] (see also [30] for a similar strategy). The analyses in [28, 29, 30] rely on the
assumption that the discrete inf-sup constant is bounded away from zero uniformly
in h. This uniform stability is not trivial, and it has only been proved so far for
triangular/tetrahedral meshes and some mixed FEs (see [31]). As an alternative to
mixed FE methods, globally stabilized residual-based and pressure jump first order
schemes combined with ghost penalty stabilization have been used in [32]. Global
residual-based stabilization has also been used in [23, 24] for B-spline approximations.

In this work, we propose to combine the agFEM approach, which fixes the small
cut cell problem for the numerical approximation of elliptic PDEs, with mixed FE
spaces. Unsurprisingly, the development of mixed agFE spaces that satisfy a discrete
version of the inf-sup condition is not straightforward. The discrete inf-sup condition
requires a perfect balance of the velocity and pressure spaces, whereas the boundary-
cell intersections can be arbitrary, leading to a large set of possible cell aggregates
geometries. We consider hexahedral meshes and arbitrary order mixed FE spaces
with discontinuous pressures and analyze the potential deficiencies of the unfitted
inf-sup in terms of a set of improper aggregates and interfaces that will require ad-
ditional stabilization.1 An abstract stability analysis under some assumptions about
such stabilization allows us to define effective stabilization terms. We propose two
algorithms. The first one combines a standard aggregated tensor-product Lagrangian
FE with interior residual-based and pressure jump face stabilization on improper ag-
gregates and facets, respectively. The second one makes use of an agFE space in
terms of a serendipity-based extension of tensor-product Lagrangian FEs combined
with pressure jump stabilization on improper facets. The resulting schemes can be
used in quadrilateral/hexahedral meshes, the order of approximation can be selected
by the user, the algorithm does not require us to compute (higher than order one)
derivatives on cell boundaries (unlike ghost penalty/cutFEM approaches), and it in-
volves minimal stabilization and consequently artificial diffusion (e.g., only pressure
jump stabilization on a very small subset of facets close to the interface). A complete
numerical analysis shows the uniform stability (that does not rely on the potentially
ill inf-sup condition on the union of interior cells), optimal a priori error estimates,
and condition number bounds with respect to the mesh size and cell boundary inter-
section. Another remarkable feature of our approach is that it exposes a high degree
of message-passing parallelism in the assembly process, and thus it is suitable for
the development of a highly scalable parallel unfitted FE framework on distributed
memory computers, so far still missing in the literature. In fact, a highly scalable par-
allel implementation of agFEM on nonconforming h-adaptive octree meshes, grounded
on p4est for efficient octree handling [33], is under development in FEMPAR [16, 17].
Apart from their ability to control geometry approximation errors by local adaptation
in regions of high geometric variability, octree meshes can be very efficiently gener-
ated, refined and coarsened, partitioned, and 2:1 balanced on hundreds of thousands
of processors [33], the latter being the main reason why we favor this sort of mesh in
our approach.

The outline of this work is as follows. In section 2, we introduce the Stokes
problem and, in section 3, a brief introduction to FE spaces, and some notation fol-

1In any case, these ideas could be extended to tetrahedral meshes and other mixed FE spaces.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1544 S. BADIA, A. F. MARTIN, AND F. VERDUGO

lows. Section 4 is devoted to the definition of agFE spaces and their mathematical
properties. A discrete agFEM for the approximation of the Stokes problem is pro-
posed in section 5, in which the stabilization terms are not defined yet. Section 6
is devoted to a complete numerical analysis of mixed agFEMs. More specifically, in
section 6.1, we perform an abstract stability analysis under some assumptions over the
mixed agFE space and the stabilization terms. Two different algorithms that satisfy
these assumptions are proposed in sections 6.2 and 6.3. A priori error estimates and
condition number bounds that are independent of the cut cell intersection with the
boundary are proved in sections 6.4 and 6.5, respectively. A complete set of numerical
experiments can be found in section 7. To close this work, some conclusions are drawn
in section 8.

2. Problem statement. Let us consider an open and bounded physical domain
\Omega \subset \BbbR d (where d = 2, 3 is the physical space dimension) with Lipschitz boundary
\Gamma , occupied by a viscous fluid. We consider Dirichlet boundary conditions on \Gamma 
for brevity in the exposition; the introduction of Neumann boundary conditions is
straightforward. The Stokes problem, after scaling the pressure with the inverse of
the diffusion coefficient, reads as follows: find the velocity field \bfitu : \Omega \rightarrow \BbbR d and the
pressure field p : \Omega \rightarrow \BbbR such that

 - \Delta \bfitu +\bfnabla p = \bfitf in \Omega , \bfnabla \cdot \bfitu = 0 in \Omega , \bfitu = \bfitg on \Gamma ,(1)

where \bfitf is the body force and \bfitg is the prescribed Dirichlet data, which must satisfy\int 
\Gamma 
\bfitg \cdot \bfitn = 0, where \bfitn stands for the outward normal. In order to uniquely determine

the pressure, we additionally enforce that
\int 
\Omega 
p = 0.

We use standard notation for Sobolev spaces (see [34]). In particular, the L2(\omega )
scalar product will be denoted by (\cdot , \cdot )\omega for some \omega \subset \BbbR d. Making abuse of notation,
we represent the H1(\omega ) duality pairing the same way. L20(\omega ) is the subspace of
functions in L2(\omega ) with zero mean value. For a Sobolev space X, we denote its norm
by \| \cdot \| X . In particular, the L2(\omega ) norm is denoted by \| \cdot \| \omega and the H

1(\omega ) norm
as \| \cdot \| 1,\omega . The seminorm on the Sobolev space W

k,p(\omega ) is denoted by | \cdot | Wk,p(\omega ), or
simply | \cdot | 1,\omega for H1(\omega ). Given a function g \in H

1
2 (\partial \omega ), the subspace of functions in

H1(\omega ) with trace equal to g is represented with H1g (\omega ). Vector-valued Sobolev spaces
are represented with boldface letters.

Let us assume that \bfitf \in \bfitL 2(\Omega ) and \bfitg \in \bfitH 
1
2 (\Gamma ). The weak form of the Stokes

problem (1) reads as follows: find (\bfitu , p) \in \bfitH 1\bfitg (\Omega )\times L20(\Omega ) such that

(\bfnabla \bfitu ,\bfnabla \bfitv )\Omega  - (p,\bfnabla \cdot \bfitv )\Omega  - (q,\bfnabla \cdot \bfitu )\Omega = (\bfitf ,\bfitv )\Omega (2)

for any (\bfitv , q) \in \bfitH 1\bfzero (\Omega ) \times L20(\Omega ). The well-posedness of this linear problem relies on
the fact that the divergence operator on \bfitH 1\bfzero (\Omega ) is surjective in L

2
0(\Omega ). There exists

a constant \beta that depends on \Omega such that (see, e.g., [35])

inf
p\in L20(\Omega )

sup
\bfitv \in \bfitH 1\bfzero (\Omega )

(p,\bfnabla \cdot \bfitv )\Omega 
\| p\| \Omega \| \bfitv \| 1,\Omega 

\geq \beta > 0.(3)

In the following exposition, we consider the numerical approximation of this problem
by using FE methods. In particular, we are interested in the discretization of the
Stokes problem when using unfitted FE methods, i.e., the mesh is not fitted to \Omega .

3. FE spaces. Let us consider an open polyhedral domain \omega and its partition
\scrK h(\omega ) into a set of cells. We may consider the case in which all cells are hexahe-
dra/quadrilaterals (hex mesh) or all cells are tetrahedra/triangles (tet mesh). At any

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1545

cell K \in \scrK h(\omega ), we define the local FE spaces as follows. Using the abstract defini-
tion of Ciarlet, an FE is represented by the triplet \{ K,\scrV ,\Sigma \} , where K is a compact,
connected, Lipschitz subset of \BbbR d, \scrV is a vector space of functions, and \Sigma is a set of
linear functionals that form a basis for the dual space \scrV \prime . The elements of \Sigma are the
so-called DOFs of the FE; we denote the number of DOFs as n\Sigma . The DOFs can
be written as \sigma a for a \in \scrN \Sigma 

.
= \{ 1, . . . , n\Sigma \} . We can also define the basis \{ \phi a\} a\in \scrN \Sigma 

for \scrV such that \sigma a(\phi b) = \delta ab for a, b \in \scrN \Sigma . These functions are the so-called shape
functions of the FE, and there is a one-to-one mapping between shape functions and
DOFs.

In this work, we consider three different concretizations of the vector space \scrV :
(1) the space \scrP q(K) of polynomials of degree less than or equal to q; (2) the space
\scrQ q(K) of polynomials of degree less than or equal to q with respect to each reference
space coordinate; (3) the space \u \scrQ q(K) of polynomials of superlinear degree less than
or equal to q (see [36] for more details). \u \scrQ q(K) on hex meshes leads to the serendipity
FE. For the sake of simplicity, we assume that all cells in the mesh have the same
topology and (for a given field) the same polynomial order.2

In order to build globally continuous FE spaces, we denote by \scrN (K) the set of
n\Sigma Lagrangian nodes of order q of cell K for \scrP q(K) in tets and \scrQ q(K) in hexs. The
set of nodal values, i.e., \sigma a(v)

.
= v(\bfitx a) for a \in \scrN (K), is a basis for the dual space

\scrV \prime . By definition, it holds that \phi a(\bfitx b) = \delta ab, where \bfitx b are the space coordinates of
node b in the corresponding set of nodes. Next, we assume that there is a local-to-
global DOF map such that the resulting global space is \scrC 0 continuous. It leads to the
following \scrC 0(\omega ) global FE spaces: (1) the space \scrP q,h(\omega ) of functions such that its cell
restriction belongs to \scrP q(K) for a tet mesh; (2) the space \scrQ q,h(\omega ) (resp., \u \scrQ q,h(\omega ))
of functions such that its cell restriction belongs to \scrQ q(K) (resp., \u \scrQ q(K)) for a hex
mesh. We note that for discontinuous FE spaces, the definition of DOF is flexible,
since no intercell continuity must be enforced. We will make use of the global space
\scrP  - q,h(\omega ) of piecewise discontinuous functions that belong to \scrP q(K), for an arbitrary
cell topology. The spaces of vector-valued functions with components in these spaces
are represented with boldface letters.

Given a function v, we define the local interpolator for nodal Lagrangian FEs as

\pi IK(v)
.
=

\sum 
a\in \scrN (K)

\sigma a(v)\phi a =
\sum 

a\in \scrN (K)

v(\bfitx a)\phi a, K \in \scrK h(\omega ).(4)

It is easy to check that the interpolation operator is in fact a projection. The global
interpolator \pi Ih(\cdot ) is defined as the sum over the cells of the corresponding local inter-
polators, i.e., \pi Ih(v) =

\sum 
K\in \scrK h(\omega ) \pi 

I
K(v).

4. Aggregated finite element spaces. In this section, we define agFE spaces.
We refer to [15] for more details. First, we introduce some geometrical concepts
related to the use of embedded boundary methods, the cell aggregation algorithm,
and the map between vertices, edges, and faces (VEFs) on cut cells and aggregates.
Next, we use the geometrical aggregation to define agFE spaces on unfitted meshes.
Finally, we provide some trace and inverse inequalities, together with approximability

2The polynomial spaces are defined in the physical space cell, instead of relying on a reference cell
and a map from the reference to the physical space. Both approaches are equivalent for affine maps,
whereas the second one is more appealing due to lower computational cost. The convergence prop-
erties of serendipity FEs are deteriorated if the map is not affine [37]. Fortunately, the equivalence
holds for the Cartesian hex meshes below.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1546 S. BADIA, A. F. MARTIN, AND F. VERDUGO

properties that will be used in the following sections to analyze the stability and to
obtain a priori error estimates. In the following, we assume that hex meshes are being
used. In practice, we are interested in Cartesian hex meshes, where all the cells can
be represented as the scaling of a d-cube. This restriction simplifies implementation
issues, since polynomial bases in the physical space can be obtained as the mapped
reference cell polynomial bases, a fact that does not hold for general (first-order) hex
meshes. However, agFE spaces can readily be obtained for tet meshes using the ideas
below.

4.1. Embedded boundary setup and cell aggregation. As usual for em-
bedded boundary methods, we consider an artificial domain \Omega \mathrm{a}\mathrm{r}\mathrm{t} with a simple shape
that can easily be meshed using a conforming Cartesian grid \scrK \mathrm{a}\mathrm{r}\mathrm{t}h

.
= \scrK h(\Omega \mathrm{a}\mathrm{r}\mathrm{t}) of char-

acteristic size h that includes the physical domain \Omega \subset \Omega \mathrm{a}\mathrm{r}\mathrm{t} (see Figure 1(a)). In the
numerical analysis, no geometrical error will be considered. In our practical imple-
mentation, the domain boundary is implicitly defined as the zero level-set of a given
scalar function \psi \mathrm{l}\mathrm{s}, i.e., \Gamma 

.
= \{ \bfitx \in \BbbR d : \psi \mathrm{l}\mathrm{s}(\bfitx ) = 0\} . It leads to an approximation \Omega h

of \Omega , e.g., using a marching cubes--like algorithm, which also leads to an approximated
boundary \Gamma h. We will omit the subscript for the sake of conciseness in the notation,
unless the distinction is important.

Let us define the quantity \eta K
.
=

| K\cap \Omega | 
| K| and a parameter \eta 0 \in (0, 1]. Cells in \scrK 

\mathrm{a}\mathrm{r}\mathrm{t}
h

can be classified as follows: a cell K \in \scrK \mathrm{a}\mathrm{r}\mathrm{t}h such that \eta K \geq \eta 0 is an interior cell ;
3 if

K \cap \Omega = \emptyset , K is an external cell ; otherwise, K is a cut cell (see Figure 1(b)). The set
of interior (resp., external and cut) cells is represented with \scrK \mathrm{i}\mathrm{n}h and its union \Omega \mathrm{i}\mathrm{n} \subset \Omega 
(resp., (\scrK \mathrm{e}\mathrm{x}\mathrm{t}h ,\Omega \mathrm{e}\mathrm{x}\mathrm{t}) and (\scrK 

\mathrm{c}\mathrm{u}\mathrm{t}
h ,\Omega \mathrm{c}\mathrm{u}\mathrm{t})). Furthermore, we define the set of active cells as

\scrK h
.
= \scrK \mathrm{i}\mathrm{n}h \cup \scrK 

\mathrm{c}\mathrm{u}\mathrm{t}
h and its union \Omega \mathrm{a}\mathrm{c}\mathrm{t}. We assume that the background mesh is quasi-

uniform (see, e.g., [38, p. 107]) to reduce technicalities, and we define a characteristic
mesh size h.

(a) (b)

internal cells

cut cells

external cells

Fig. 1. Embedded boundary setup.

We can also consider a partition of \Omega into nonoverlapping cell aggregates. Each
aggregate is composed of several cut cells and only one interior cell. Besides, the
cells in an aggregate are connected, i.e., an aggregate cannot span multiple disjoint
domains. Such partition can be computed using the strategy described in Algorithm
4.1 below.

3For \eta 0 = 1, interior cells are cells K \subset \Omega . However, we can weaken the definition by taking
lower values of \eta 0, considering also as interior cells the ones that have a large enough portion in the
interior.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1547

Algorithm 4.1 (cell aggregation algorithm).
1. Mark all interior cells as touched and all cut cells as untouched.
2. For each untouched cell, if there is at least one touched cell connected to it

through a facet F such that F \cap \Omega \not = \emptyset , we aggregate the cell to the touched
cell belonging to the aggregate containing the closest interior cell. If more
than one touched cell fulfills this requirement, we choose one arbitrarily, e.g.,
the cell connected via the facet with more area inside the physical domain, or
the one with the smaller global label.

3. Mark as touched all the cells aggregated in step 2.
4. Repeat steps 2 and 3 until all cells are aggregated.

Figure 2 shows an illustration of each step in Algorithm 4.1 for \eta 0 = 1. The black
thin lines represent the boundaries of the aggregates. Note that from step 1 to step 2,
some of the lines between adjacent cells are removed, meaning that the two adjacent
cells have been merged in the same aggregate. The aggregation schemes can be easily
applied to arbitrary spatial dimensions.

touched untouched Aggregates' boundary \partial \Omega 

(a) Step 1. (b) Step 2. (c) Step 3. (d) Step 4.

Fig. 2. Illustration of the cell aggregation scheme defined in Algorithm 4.1 for \eta 0 = 1. We note
that the definition of an aggregate in (5) is such that it only considers the part of the aggregated
cells inside \Omega as this simplifies the notation in the numerical analysis.

In the forthcoming sections, we need an upper bound of the size of the aggregates
generated with Algorithm 4.1 in terms of the cell mesh size h, i.e., the characteristic
size of an aggregate is bounded by \gamma h for some \gamma independent of h and the cut cell
intersection with the boundary. For a given mesh, the constant \gamma can be bounded
using the following result taken from [15, Lemma 2.2].

Lemma 4.2. Assume that from any cut cell K0 \in \scrK \mathrm{a}\mathrm{c}\mathrm{t}h there is a cell path \{ K0,K1,
. . . ,Kn\} that satisfies the following: (1) two consecutive cells share a facet F such
that F \cap \Omega \not = \emptyset ; (2) Kn is an interior cell; and (3) n \leq n\mathrm{m}\mathrm{a}\mathrm{x}, where n\mathrm{m}\mathrm{a}\mathrm{x} is a fixed
integer. Then, the constant \gamma is at most 2n\mathrm{m}\mathrm{a}\mathrm{x} + 1.

The lemma states that the aggregate size is bounded in terms of n\mathrm{m}\mathrm{a}\mathrm{x}, i.e., the
number of cells that need to be traversed via facets for connecting a cut cell with
an interior one. Note that large values of n\mathrm{m}\mathrm{a}\mathrm{x} can only appear when dealing with
underresolved geometrical details. Thus, finer meshes contribute to decrease n\mathrm{m}\mathrm{a}\mathrm{x}
and, in turn, the aggregate size. The numerical results in [15, section 6.3] show that
\gamma tends to \gamma = 2 in two dimensions and \gamma = 3 in three dimensions for some practical
cases. However, for complex geometries, local mesh adaptation could be required to
capture small geometrical details and reduce the aggregate size.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1548 S. BADIA, A. F. MARTIN, AND F. VERDUGO

Algorithm 4.1 leads to another partition \scrT h into aggregates, where an aggregate
is defined in terms of a set of cells as

(5) A
.
= \~A \cap \Omega , \~A .= \{ \cup nAi=0Ki : Ki \in \scrK h\} ,

where (without loss of generality) K0 \in \scrK \mathrm{i}\mathrm{n}h is the owner interior cell, also represented
with \scrO (A). Thus, A \in \scrT h is trimmed by the boundary and \~A is its corresponding
untrimmed aggregate. In the following, trimmed aggregates will just be referred to as
aggregates. By construction of Algorithm 4.1, it holds that (1) nA \geq 0; (2) interior
cells that have no aggregated cut cells (nA = 0) remain the same; (3) there is only
one interior cell per aggregate, i.e., Ki \not \subset \Omega for i > 0; (4) every cut cell belongs to one
and only one aggregate.

For an interior/cut cell K \in \scrK h, we define its owner (interior) cell \scrO (K) as the
owner \scrO (A) of the only aggregate A \in \scrT h that contains the cell, i.e., K \cup A has
nonzero measure in dimension d. Thus, the owner of an interior cell is the cell itself.

We can also construct a map that, given an outer VEF, i.e., a VEF that belongs
to at least one cut cell in \scrK \mathrm{c}\mathrm{u}\mathrm{t}h but does not belong to any interior cell in \scrK 

\mathrm{i}\mathrm{n}
h , provides

its aggregate owner among all the aggregates that contain it (see Figure 3). This map
can be arbitrarily built, e.g., we can consider the smallest aggregate that contains
the VEF. The map between the outer VEF b and the interior cell owner is also
represented with \scrO (b).4

(a) Outer vertex to aggregate
map

(b) Outer face to aggregate
map

Untrimmed
aggregate

Cell
Outer face
Outer vertex

Fig. 3. Map from outer facets and vertex to aggregate owner. The small pointers denote the
aggregate owner. Pointers are not used for vertex and facets belonging to only one aggregate since
the owner is obvious. Aggregates in (a) and (b) are the same, but the aggregate bounds are clearer
in (a).

4.2. Aggregated finite element spaces. Our goal is to define FE spaces using
the cell aggregates introduced above, in order to end up with unfitted FE spaces on
the domain \Omega , with optimal approximability properties not affected by the small cut
cell problem. The goal of this section is to start with a pair of inf-sub stable FE
spaces (i.e., velocity-pressure pairs of FE spaces that satisfy a discrete version of the
inf-sup condition on body-fitted meshes) and to end up with an aggregated version of
this FE pair (which will not be affected by the small cut cell problem). The process of
defining the aggregated version of a given FE space can be introduced systematically
for different types of interpolations. For the sake of simplicity, we present the method
for a generic scalar-valued field. The technique will be eventually applied to the FE

4After the cell aggregation and the VEF owner definition, we have defined a map \scrO (\cdot ) that, given
any outer VEF or cut cell, provides its owner (interior) cell.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1549

(a) \scrV inh (b) \scrV h (c) \scrV 
act
h

\circ nodes in \scrN \mathrm{i}\mathrm{n}h
\bullet nodes in \scrN \mathrm{a}\mathrm{c}\mathrm{t}h
\times nodes in \scrN \mathrm{o}\mathrm{u}\mathrm{t}h

Fig. 4. FE spaces.

space for the pressure field, and to each component of the FE space for the velocity
field (which are a scalar FE spaces).

Let us represent with \scrV h(\omega ) a generic global (continuous or discontinuous) Lag-
rangian FE space, i.e., it can be \scrQ q,h for hex meshes and \scrP q,h for tet meshes, for an
arbitrary order q. We introduce the active FE space associated with the active portion
of the background mesh \scrV \mathrm{a}\mathrm{c}\mathrm{t}h

.
= \scrV h(\scrK \mathrm{a}\mathrm{c}\mathrm{t}h ) and the interior FE space \scrV 

\mathrm{i}\mathrm{n}
h

.
= \scrV h(\scrK \mathrm{i}\mathrm{n}h ).

The active FE space \scrV \mathrm{a}\mathrm{c}\mathrm{t}h (see Figure 4(c)) is the functional space typically used
in unfitted FE methods (see, e.g., [14, 12, 9]). It is well-known that \scrV \mathrm{a}\mathrm{c}\mathrm{t}h leads to
arbitrary ill-conditioned systems when integrating the FE weak form on the physical
domain \Omega only (if no stabilization technique is used to remedy it). It is obvious that
the interior FE space \scrV \mathrm{i}\mathrm{n}h (see Figure 4(a)) is not affected by this problem, but it is
not usable since it is not defined on \Omega .

Herein, we propose an alternative agFE space \scrV h that is defined on \Omega but does
not present the ill-conditioning issues related to \scrV \mathrm{a}\mathrm{c}\mathrm{t}h . To this end, we can define the
set of nodes of \scrV \mathrm{i}\mathrm{n}h and \scrV 

\mathrm{a}\mathrm{c}\mathrm{t}
h as \scrN 

\mathrm{i}\mathrm{n}
h and \scrN 

\mathrm{a}\mathrm{c}\mathrm{t}
h , respectively (see Figure 4). We define

the set of outer nodes as \scrN \mathrm{o}\mathrm{u}\mathrm{t}h
.
= \scrN \mathrm{a}\mathrm{c}\mathrm{t}h \setminus \scrN 

\mathrm{i}\mathrm{n}
h (e.g., the nodes that belong to outer VEFs

in Figure 3). The outer nodes are the ones that can lead to conditioning problems due
to the small cut cell problem (see, e.g., [12]). The space of global shape functions of
\scrV \mathrm{i}\mathrm{n}h and \scrV 

\mathrm{a}\mathrm{c}\mathrm{t}
h can be represented as \{ \phi 

b : b \in \scrN \mathrm{i}\mathrm{n}h \} and \{ \phi 
b : b \in \scrN \mathrm{a}\mathrm{c}\mathrm{t}h \} , respectively.

Any function uh \in \scrV \mathrm{i}\mathrm{n}h can be written as uh =
\sum 

a\in \scrN \mathrm{i}\mathrm{n}
h
uah\phi 

a, and analogously for

functions in \scrV \mathrm{a}\mathrm{c}\mathrm{t}h . The space \scrV h is defined taking as the starting point \scrV 
\mathrm{a}\mathrm{c}\mathrm{t}
h and

adding judiciously defined constraints for the nodes in \scrN \mathrm{o}\mathrm{u}\mathrm{t}h .
In order to define \scrV h, we observe that, in nodal Lagrangian FE spaces, there is

a one-to-one map between DOFs and nodes (points) of the FE mesh. For globally
continuous FE spaces, we can define the owner VEF of an outer node b \in \scrN \mathrm{o}\mathrm{u}\mathrm{t}h ,
denoted as \scrO \mathrm{v}\mathrm{e}\mathrm{f}(b), as the lowest-dimensional VEF that contains the node b. As
a result, the composition of the outer-VEF-to-cell-owner map \scrO (\cdot ) with the outer-
DOF-to-vef-owner map \scrO \mathrm{v}\mathrm{e}\mathrm{f}(\cdot ) leads to an outer-DOF-to-cell-owner map, namely,
\scrO \circ \scrO \mathrm{v}\mathrm{e}\mathrm{f}(\cdot ). Abusing notation, we also denote this map as \scrO (b) for an outer DOF b.
For discontinuous FE spaces, all the DOFs belong to the cell itself, since no continuity
must be enforced. Thus, the DOFs owner and outer-DOFs-to-cell maps are trivial
once defined the cell aggregation. Since no continuity must be enforced among cells,
the definition of DOFs is very flexible.

Given a function vh \in \scrV \mathrm{i}\mathrm{n}h and a cell K \in \scrK 
\mathrm{i}\mathrm{n}
h , we define the unique polynomial

\xi Kh (vh) : \BbbR 
d \rightarrow \BbbR such that its restriction to the cell K coincides with the FE function,

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1550 S. BADIA, A. F. MARTIN, AND F. VERDUGO

i.e., vh(\bfitx ) = \xi 
K
h (vh)(\bfitx ), \bfitx \in K. With these ingredients, we define \scrV h \subset \scrV 

\mathrm{a}\mathrm{c}\mathrm{t}
h as the

subset of functions in \scrV \mathrm{a}\mathrm{c}\mathrm{t}h such that, for any DOF a \in \scrN 
\mathrm{o}\mathrm{u}\mathrm{t}
h ,

vah = \sigma 
a(\xi 

\scrO (a)
h (vh)) =

\sum 
b\in \scrN (\scrO (a))

\sigma a(\xi 
\scrO (a)
h (\phi 

b))\sigma b(vh).(6)

By construction, functions in \scrV h are uniquely determined by the DOFs of \scrV \mathrm{i}\mathrm{n}h . Thus,
we can define the extension operator \scrE h : \scrV \mathrm{i}\mathrm{n}h \rightarrow \scrV h \subset \scrV 

\mathrm{a}\mathrm{c}\mathrm{t}
h such that given uh \in \scrV 

\mathrm{i}\mathrm{n}
h

provides the FE function \scrE h(uh) \in \scrV \mathrm{a}\mathrm{c}\mathrm{t}h with outer nodal values computed as in (6).
See Figure 5 for an illustration of the extension operator \scrE h(\cdot ). Thus, the agFE space
is the range of this operator, i.e., \scrV h

.
= \scrE h(\scrV \mathrm{i}\mathrm{n}h ) \subset \scrV 

\mathrm{a}\mathrm{c}\mathrm{t}
h . If functions in \scrV 

\mathrm{a}\mathrm{c}\mathrm{t}
h are \scrC 

0

continuous, since \scrV h \subset \scrV \mathrm{a}\mathrm{c}\mathrm{t}h , then functions in \scrV h are also \scrC 
0 continuous. We note

that (6) makes sense for continuous and discontinuous spaces, and, e.g., both tensor-
product and serendipity spaces for hex meshes and Lagrangian FEs for tet meshes.
In any case, the definition in (6) is general and can be used for spaces with DOFs
that are not nodal evaluations.

(a) DOFs owners (b) vh \in \scrV inh (c) \scrE (vh) \in \scrV h

Fig. 5. Illustration of the extension operator \scrE h(\cdot ). The red arrows represent the exterior DOF
to interior cell map \scrO (\cdot ). Function vh is equal to 1 at the DOFs associated with the root cell of the
aggregate displayed in (a) and equal to 0 elsewhere. By formula (6), the extended function \scrE h(vh)
is also 1 at the exterior DOFs whose cell owner is the root cell of the aggregate in (a). Note that
not all DOFs in an aggregate need to share the same cell owner.

4.2.1. Nodal Lagrangian aggregated finite element spaces. In particular,
for nodal-based Lagrangian FE spaces (which include tensor-product \scrQ q,h(\scrK h) and
serendipity spaces \u \scrQ q,h(\scrK h) for hex meshes and \scrP q,h(\scrK h) for tet meshes), the previous
expression is reduced to

(7) vh(\bfitx 
a) =

\sum 
b\in \scrN (\scrO (a))

vh(\bfitx 
b)\phi b(\bfitx a).

The computation of the constraint is straightforward and simply involves evaluating
the shape function polynomials of a cell in a set of points that do not belong to the
cell, viz., the nodes of an aggregated cut cell. The definition of DOF ownership is
simple: the VEF or cell that contains the node related to the DOF with minimum
dimension, which is uniquely defined.

4.2.2. Discontinuous aggregated finite element spaces. Let us comment
on discontinuous FE spaces, e.g., \scrP  - q,h(\scrK h) on hex meshes. It is easy to check that for
discontinuous spaces, the agFE space can be analogously defined as

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1551

\scrV h = \{ v : v| A \in \scrP  - q (A) for any A \in \scrT h\} .(8)

The equivalence between the definition based on (6) and the one in (8) is straightfor-
ward. The use of aggregation techniques within DG methods has already been used,
e.g., in [39, 27].

4.2.3. Aggregated finite elements with serendipity extension. Up to
now, we have assumed that the constraints for the extension operator were com-
puted using the same shape functions as the ones of the local FE space in the owner
interior cell (see (6)). Here, we consider a more general case in which these two shape
functions bases (and the corresponding spanned spaces) can differ. In particular, we
are interested in using a tensor-product Lagrangian space at all cells in a hex mesh,
but to compute the constraints through the corresponding serendipity basis (preserv-
ing the order of approximation). As we will see later on, it does not affect accuracy
and has positive properties when considering stable mixed agFE spaces (see section
6.3).

Let us introduce some notation, in order to distinguish between tensor-product
and serendipity FE spaces. For serendipity FEs and hex meshes, i.e., \u \scrQ q(K), we rep-
resent its unisolvent set of nodes with \u \scrN (K), i.e., the corresponding nodal values are
a basis for the dual space, with cardinality \u n\Sigma (see [36, Figure 1]). The corresponding

shape functions and DOFs are represented with \{ \u \phi a\} 
a\in \u \scrN (K) and \{ \u \sigma 

a\} 
a\in \u \scrN (K), respec-

tively. For serendipity spaces, we denote its corresponding nodal interpolator in (4)
as \u \pi IK(v).

We constrain every outer DOF a \in \scrN \mathrm{o}\mathrm{u}\mathrm{t}h of a function vh \in \scrV 
\mathrm{a}\mathrm{c}\mathrm{t}
h as

vah = \sigma 
a(\xi 

\scrO (a)
h \circ \u \pi 

I
\scrO (a)(vh))) =

\sum 
b\in \u \scrN (\scrO (a))

\sigma a(\xi 
\scrO (a)
h (

\u \phi b))\u \sigma b(vh),

or analogously,

(9) vh(\bfitx 
a) =

\sum 
b\in \u \scrN (\scrO (a))

vh(\bfitx 
b)\u \phi b(\bfitx a).

It leads to the new agFE space \u \scrV h and its corresponding extension operator \u \scrE h. We
note that the serendipity extension can be combined with a standard Lagrangian FE
space \scrV \mathrm{a}\mathrm{c}\mathrm{t}h . In fact, this is the case that will be considered in this work.

4.3. Mathematical properties. In the following, we list some FE inequalities
that will be used in the next sections. We use A \lesssim B to say that A < CB for
some positive constant C, and analogously for \gtrsim and \eqsim . We use C to denote such a
constant, which can be different in different appearances. The word constant in this
work always denotes independence with respect to h and the cut cell intersection, i.e.,
it is not affected by the small cut cell problem. The constants can depend on \gamma and
\eta 0. For a cut cell, hK is defined as the one of the whole cell, and thus independent of
the cut.

Let us consider an arbitrary FE space \scrV h. The following inverse inequalities hold
(see, e.g., [38]):

\| \bfnabla uh\| K \lesssim h
 - 1
K \| uh\| K ,(10)

\| \partial \bfitn uh\| \Gamma \cap K \lesssim h
 - 1

2

K \| \bfnabla uh\| K ,(11)

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1552 S. BADIA, A. F. MARTIN, AND F. VERDUGO

for any K \in \scrK h, where \bfitn is the outward normal (in this appearance, with respect to
\Gamma \mathrm{D} \cap K), and \partial \bfitn 

.
= \bfitn \cdot \bfnabla . The inverse inequalities (10)--(11) also hold for untrimmed

aggregates \~A, by simply recalling them for every cell in \~A. Furthermore, we have the
following trace inequalities (see [40]):

\| u\| \partial K \lesssim h
 - 1

2

K \| u\| K + h
1
2

K\| \bfnabla u\| K for any u \in H
1(K),(12)

\| u\| \Gamma \cap K \lesssim h
 - 1

2

K \| u\| \Omega \cap K + h
1
2

K\| \bfnabla u\| \Omega \cap K for any u \in H
1(\Omega \cap K)(13)

for anyK \in \scrK h. The last result can be proved using the ideas in [40, Lemma 3] and [41,
Lemma 3.1] under the assumption that the mesh is fine enough to capture geometrical
details and the curvature of \Gamma is bounded almost everywhere (see [40, 41] for more
details). We note that for FE functions (defined in the whole cut cellK), (13) holds for
both the physical and computational domain and boundary, whereas for continuous
solutions it only makes sense for the physical domain. The extension operators \scrE h(\cdot )
and \u \scrE h(\cdot ) satisfy the following stability bounds. The standard extension operator can
be considered for both tet and hex meshes, whereas the serendipity extension operator
only for hex meshes.

Lemma 4.3. Given a function uh \in \scrV \mathrm{i}\mathrm{n}h , it holds that

\| \scrE h(uh)\| \Omega \mathrm{a}\mathrm{c}\mathrm{t} \lesssim \| uh\| \Omega \mathrm{i}\mathrm{n} , \| 
\u \scrE h(uh)\| \Omega \mathrm{a}\mathrm{c}\mathrm{t} \lesssim \| uh\| \Omega \mathrm{i}\mathrm{n} ,

\| \bfnabla \scrE h(uh)\| \Omega \mathrm{a}\mathrm{c}\mathrm{t} \lesssim \| \bfnabla uh\| \Omega \mathrm{i}\mathrm{n} , \| \bfnabla 
\u \scrE h(uh)\| \Omega \mathrm{a}\mathrm{c}\mathrm{t} \lesssim \| \bfnabla uh\| \Omega \mathrm{i}\mathrm{n} .

Proof. The proof for \scrE h(\cdot ) can be found in [15, Corollary 5.3] for a general agFE
space, which can be either \scrV \mathrm{i}\mathrm{n}h or the discontinuous FE space of its gradients. The
results for \u \scrE h(\cdot ) can be proved analogously.

The combination of the previous lemma and the inverse inequality (10) for un-
trimmed aggregates lead to the following global inverse inequality for functions in the
agFE space:

\| \bfnabla \scrE h(uh)\| \Omega \mathrm{a}\mathrm{c}\mathrm{t} \lesssim h
 - 1\| uh\| \Omega \mathrm{i}\mathrm{n} for any uh \in \scrV 

\mathrm{i}\mathrm{n}
h .(14)

Given the interior FE space \scrV \mathrm{i}\mathrm{n}h , we can define the standard Scott--Zhang inter-
polation using the definition in [42]. Let us define an extended Scott--Zhang inter-
polant as follows: (1) perform the standard interior Scott--Zhang interpolator onto
\scrV \mathrm{i}\mathrm{n}h through the assignment for every interior DOF a \in \scrN 

\mathrm{i}\mathrm{n}
h of an arbitrary VEF/cell

5

\~Ka \subset \Omega \mathrm{i}\mathrm{n} that contains the owner VEF of a, and compute the mean value of the
function on \~Ka, represented with \sigma 

SZ,a
\~Ka

(\cdot ); (2) extend the interior function to \Omega using
the extension operator \scrE h(\cdot ) (or \u \scrE h(\cdot )), leading to a function in \scrV h (or \u \scrV h). Thus, the
extended Scott--Zhang interpolant reads

\pi SZh (u)(\bfitx )
.
=

\sum 
a\in \scrN \mathrm{i}\mathrm{n}

h

\sigma 
SZ,a
\~Ka

(u)\scrE (\phi a(\bfitx )).

The serendipity-extended interpolant, represented with \u \pi SZh (u), is obtained as above,

but using \u \scrE h(\cdot ) instead.

5Even though this choice is arbitrary, we do not permit \~Ka \subset \Omega in to be a vertex, since it would
restrict the applicability of the interpolator to \scrC 0(\Omega ) functions with pointwise sense. We note that
the concept of VEF/cell ownership of a DOF can be extended to nonnodal DOFs (see, e.g., [16]).

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1553

In the next theorem, we prove the approximability properties of the extended
Scott--Zhang interpolant. In the statement of the theorem, we represent with \nu (A)
the union of the owner of the aggregate itself and the owners of all its neighbors, i.e.,
\nu (A)

.
= \{ \scrO (B) : A \cap B \not = \emptyset , B \in \scrT h\} . We note that A \not \subseteq \nu (A) \subset \Omega \mathrm{i}\mathrm{n} in general.

Theorem 4.4. Let us consider an agFE space \scrV h such that \scrP q(A) \subset \scrV h(A) for
A \in \scrT h, q \in \BbbN +. Let us consider a function u \in Wmp (\Omega ), where 1 \leq p \leq \infty , m \leq q+1,
and m \geq d for p = 1 or m > d

p
for p > 1. Given A \in \scrT h and K \in \scrK h such that

K \subseteq A, it holds that

\| u - \pi SZh (u)\| W sp (K) \lesssim h
m - s| u| Wmp (\nu (A))(15)

for 1 \leq s \leq m. The same results apply for the serendipity-extended agFE space \u \scrV h
and its corresponding interpolant \u \pi SZh (\cdot ).

Proof. The standard and serendipity interpolants can be analyzed analogously.
The Scott--Zhang moments \sigma 

SZ,a
\~Ka

(\cdot ) are bounded in Wmp (\Omega ) owing to the trace theo-
rem, i.e., W lp(\Omega ) \subset L1( \~Ka) for \~Ka being a facet or cell (see [42]). On the other hand,
\scrE (\phi a(\bfitx )) \subset Wmp (K) for any cell K \in \scrK h, since it is a combination of shape function
with bounded nodal values (see (6) and Lemma 4.3). Moreover, from the definition of
the extension operator, the nodal values of \pi SZh (\cdot )| A are constrained from the DOFs
of the owner interior cell of A or the DOFs of the owner cell of a neighbor of A.
Thus, we readily obtain that \| \pi SZh (u)\| Wmp (A) \leq C\| u\| Wmp (\nu (A)). Next, we consider
an arbitrary function \pi (u) \in Wmp (\Omega ) such that \pi (u)| K \in \scrP q(\nu (A)) \subset \scrV h(\nu (A)) (note
that the inclusion also holds for the serendipity extension). The fact that \pi SZh (\cdot ) is a
projection onto \scrV h by construction yields \pi (u)| A = \pi SZh (\pi (u))| A. Thus, we have:

\| u - \pi SZh (u)\| Wmp (K) \leq \| u - \pi (u)\| Wmp (K) + \| \pi 
SZ
h (\pi (u) - u)\| Wmp (K)

\lesssim \| u - \pi (u)\| Wmp (K)+\| \pi (u) - u\| Wmp (\nu (A)) \lesssim \| u - \pi (u)\| Wmp (\nu (A)).

Since \nu (A) is an open bounded domain with Lipschitz boundary by definition with a
characteristic size bounded by \gamma h, one can use the Deny--Lions lemma (see, e.g., [35]).
As a result, using the \pi (u) that minimizes the right-hand side, it holds that

\| u - \pi SZh (u)\| Wmp (K) \lesssim | u| Wmp (\nu (A)).

The Sobolev embedding theorem and the trace theorem yield

\| u - \pi SZh (u)\| W sp (K) \leq C(A)| u| Wmp (\nu (A)).(16)

In order to eliminate the dependency of the constant on the size of A, we use stan-
dard homogeneity (or scaling) arguments. We consider the scaling of A to a reference
aggregate with unit diameter, recall (16) in the scaled domain, and use the corre-
sponding change of variables to push back the inequality to the original aggregate
(see, e.g., [38, Lemma 4.3.8] for more details). It proves the lemma.

5. Approximation of the Stokes problem. In this section, we consider the
FE approximation of the Stokes problem (1) using agFE spaces on unfitted meshes.
We focus on inf-sup stable spaces (velocity-pressure pairs of FE spaces that satisfy
a discrete version of the inf-sup condition on body-fitted meshes), which have been
extended with the aggregation strategy of section 4. In this section, the velocity and
pressure spaces are represented with \bfitV h and Mh, respectively. As usual in unfitted

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1554 S. BADIA, A. F. MARTIN, AND F. VERDUGO

FE methods, the Dirichlet boundary conditions cannot be enforced strongly. Instead,
we consider a Nitsche-type weak imposition of the Dirichlet data [43, 44]. It provides a
consistent numerical scheme with optimal converge rates (also for high-order elements)
that is commonly used in the embedded boundary community (see, e.g., [32] for its
application in unfitted discretizations of the Stokes problem). Another important
ingredient in unfitted FE approximations is the integration on cut cells. We refer to
[14] for a detailed exposition of the particular technique used in this paper. With
these ingredients, we define the Stokes operator,

Ah(\bfitu h, ph,\bfitv h, qh)
.
= ah(\bfitu h,\bfitv h) + bh(\bfitv h, ph) - bh(\bfitu h, qh) + jh(\bfitu h, ph,\bfitv h, qh),(17)

where

ah(\bfitu h,\bfitv h)
.
= (\bfnabla \bfitu h,\bfnabla \bfitv h)\Omega  - (\partial \bfitn \bfitu h,\bfitv h)\Gamma  - (\partial \bfitn \bfitv h,\bfitu h)\Gamma + \tau (h\bfitu h,\bfitv h)\Gamma ,(18)

bh(\bfitv h, ph)
.
=  - (\bfnabla \cdot \bfitv h, ph)\Omega + (\bfitn \cdot \bfitv h, ph)\Gamma ,(19)

with \tau a large enough positive constant, for stability purposes. The right-hand side
reads

Lh(\bfitv h, qh)
.
= (\bfitf ,\bfitv h)\Omega + gh(\bfitf ,\bfitv h).

The pressure stabilization term jh and the corresponding potential modification of
the right-hand-side gh to keep consistency will be defined in sections 6.2 and 6.3,
motivated from the numerical analysis. The discrete Stokes problem finally reads as
follows: find (\bfitu h, ph) \in \bfitV h \times Mh such that

Ah(\bfitu h, ph,\bfitv h, qh) = Lh(\bfitv h, ph) \forall (\bfitv h, qh) \in \bfitV h \times Mh.(20)

In the following analysis, we restrict ourselves to hexahedral meshes and dis-
continuous pressures. Similar ideas can be applied to inf-sup stable mixed FEs on
tetrahedral meshes and continuous pressures, but we do not consider these cases for
the sake of conciseness. Thus, using the notation in section 4.2, we will make use of the
following global agFE spaces: the space \scrQ q,h, for q \geq 1, in which the local FE space
is the tensor-product Lagrangian \scrQ q(K) in all cells K \in \scrK h, and the constraints are
defined using the standard expression in (7); the space \u \scrQ q,h, for q \geq 1, in which the
local FE space is the tensor-product Lagrangian \scrQ q(K) in all cells K \in \scrK h, and the
serendipity extension in (9) is used only to compute the constraints; the discontinuous
space \scrP  - q,h, for q \geq 0, defined in (8).

6. Numerical analysis. In this section, we perform the stability analysis of FE
methods for (17). First, in section 6.1, we consider an abstract stability analysis, i.e.,
we prove an inf-sup condition under some assumptions over the mixed agFE space
and the stabilization terms. Two different algorithms that satisfy these assumptions,
and thus are stable, are proposed in sections 6.2 and 6.3. A priori error estimates for
these methods are obtained in section 6.4. Finally, in section 6.5, we prove condition
number bounds that are independent of the cut cell intersection with the boundary,
i.e., the small cut cell problem.

The analysis of the discrete problem obviously relies on the well-posedness of the
continuous problem, i.e., the inf-sup condition in (3). For the sake of conciseness in
notation, we have not distinguished between the actual computational domain \Omega h
and the physical domain \Omega . It is important to distinguish between these two in the
definition of the inf-sup constant, i.e., \beta (\Omega ) versus \beta (\Omega h). In general, \beta (\Omega h) can tend

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1555

to zero as h \rightarrow 0. The lower bound for \beta (\cdot ) relies on a decomposition of the domain
into a finite number of strictly star-shaped domains. \beta (\Omega h) could tend to zero as
h \rightarrow 0 unless one can prove that this number is bounded away from zero for \Omega h.
Fortunately, there are constructions of the computational domain \Omega h for which one
can prove that in fact \beta (\Omega h) is bounded below or, even more, converges to \beta (\Omega ). In
particular, if \Omega h is a polygonal h-approximation of \Omega in the sense of [45, Definition
4.5], it holds that | \beta (\Omega )  - \beta (\Omega h)| \leq c(\Omega )h. In what follows, we simply consider
\beta 
.
= infh<h0 \beta (\Omega h) for h0 a fine enough mesh size to represent the topology of the

geometry at hand.

6.1. An abstract stability analysis. In this section, we analyze the well-
posedness of the discretization of the Stokes problem (17) in an abstract setting, in
which the FE spaces and stabilization terms are not explicitly stated. Instead, we do
the analysis under some assumptions of these ingredients.

We define the following norms:

| | | \bfitu | | | 2h
.
= \| \bfnabla \bfitu \| 2\Omega + \| h

 - 1
2\bfitu \| 

2

\Gamma , | | | \bfitu , p| | | 
2
h
.
= | | | \bfitu | | | 2h + \| p\| 

2
\Omega .(21)

In the following lemma, we prove some stability and continuity properties of the
different terms that compose the Stokes operator in (17).

Lemma 6.1. For a large enough positive constant \tau in (18), it holds for any
\bfitu h, \bfitv h \in \bfitV h

ah(\bfitu h,\bfitu h) \geq \gamma a| | | \bfitu h| | | 
2
h, ah(\bfitu h,\bfitv h) \leq \xi a| | | \bfitu h| | | h| | | \bfitv h| | | h, bh(\bfitv h, qh) \leq \xi b| | | \bfitv h| | | h\| qh\| \Omega 

(22)

for some positive constants \gamma a, \xi a, and \xi b.

Proof. The continuity and stability of ah can be found, e.g., in [15, Theorem
5.7]. The continuity of bh is obtained by using in its two terms the Cauchy--Schwarz
inequality and in the second one the inequalities (13) and (14) (see also [32]).

Let us describe two types of common aggregate topologies. First, we define rect-
angular cuboid aggregates as the ones with such a shape (possibly after adding some
inactive cells); e.g., all the aggregates in Figure 6(a) with the exception of the L-
shaped aggregates on the left. Second, a line aggregate is such that all its cell centers
lie on the same straight line. In Figure 6(a), the L-shaped and square aggregates are
not line aggregates. Let us also define the set of interior aggregate facets

FAB
.
= \partial A \cap \partial B, A, B \in \scrT h, \scrF h

.
= \{ FAB : A, B \in \scrT h\} .

We note that, since A \subset \Omega for any aggregate A \in \scrT h by its definition in (5), FAB
can include a cut facet of a cut cell. Finally, we introduce below the concept of
improper facets and aggregates, which will be the ones that will require some type of
stabilization.

Definition 6.2 (improper aggregate set of \bfitV h). The improper aggregate set
\scrT  - h is defined as the subset of aggregates in \scrT h that do not have a rectangular cuboid
shape (see Figure 6(a)). Its complement is represented with \scrT +h

.
= \scrT h \setminus \scrT  - h .

Definition 6.3 (improper facet set of \bfitV h). The improper facet set \scrF  - h is the
set of facets F \in \scrF h such that at least one the two aggregates AF , BF \in \scrT h that share
the face is not a line aggregate (see Figure 6(a)). Its complement is represented with
\scrF +h

.
= \scrF h \setminus \scrF  - h .

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1556 S. BADIA, A. F. MARTIN, AND F. VERDUGO

(a) Improper aggregates (in blue) in Def. 6.2
and improper facets (in red) in Def. 6.3.

(b) Reduced set of improper facets (in red)
to be stabilized in Algorithm 6.13.

Fig. 6. Illustration of improper aggregates and facets. Using Definition 6.2, we show in (a) the
improper aggregates in blue. The only improper aggregates are the L-shaped ones, since the other
ones have rectangular shapes. The improper facets in Definition 6.2 are the ones in red in (a).
The L-shaped aggregates and the square-shaped aggregates on the corners are not line aggregates;
thus their interior boundary facets are improper. We show in (b) the restricted set of facets to
be stabilized in the definition of Algorithm 6.13 in section 6.3 for the serendipity extension. We
note that the reduced facet stabilization holds only for three dimensions and second-, third-, and
fourth-order FEs with serendipity extension, but we show the idea in two dimensions for simplicity.
Among all the red facets in (a), only the red ones in (b) must be stabilized, because the other ones
are between aggregates that share the same interior cell.

In this section and section 6.2, we make the following assumption on the velocity
FE space. This assumption holds, e.g., considering the velocity agFE space as the
standard extension of second- or higher-order FE spaces in the interior cells.

Assumption 6.4. There exists a q \in \BbbZ +, q \geq 2, such that \bfscrQ q(A) \subset \bfitV h(A) for
any A \in \scrT h.

Let us detail the roadmap that will be followed in the rest of this section in order
to show the stability of (17). First, we need to prove a discrete weak inf-sup condition
for the mixed agFE space \bfitV h \times Mh under Assumption 6.4. In order to do that, we
construct a stable quasi -Fortin interpolant6 in Lemma 6.5, which is used to prove
the first weak inf-sup for the space of aggregate-constant pressures in Lemma 6.6.
Making use of an aggregatewise bubble function (for proper aggregates in \scrT +h only),
we can obtain extra pressure stability with additional assumptions on the mixed agFE
space in Lemma 6.7. The combination of these two lemmas leads to the final weak
inf-sup condition in Theorem 6.8. This result shows the deficiency of the weak inf-sup
condition. In Assumption 6.9, we state the properties that must satisfy the pressure
stabilization to correct such a deficiency. We finally prove an inf-sup condition for Ah
in Theorem 6.10.

Lemma 6.5 (quasi-Fortin interpolant). For any \bfitv \in \bfitH 1\bfzero (\Omega ), there exists a func-
tion \pi 

qF
h (\bfitv ) \in \bfitV h such that

(23)

\int 
F

\bfitv \cdot \bfitn =
\int 
F

\pi 
qF
h (\bfitv ) \cdot \bfitn \forall F \in \scrF 

+
h , | | | \pi 

qF
h (\bfitv )| | | h \leq \xi qF \| \bfitv \| 1,\Omega ,

for a positive constant \xi qF > 0.

6We use the name quasi-Fortin interpolator because it only provides the property of the standard
Fortin interpolator (see, e.g., [35]) on proper facets in \scrF +

h
.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1557

Proof. Facets F \in \scrF +h are between two line aggregates A, B \in \scrT h by definition.
This fact combined with Assumption 6.4 ensures the existence of a quadratic facet
bubble such that

(24)

\int 
F

\bfitphi Fh \cdot \bfitn \gtrsim | F | > 0, \| \bfitphi 
F
h \| \infty \lesssim 1, \bfitphi 

F
h \cdot \bfitn = 0 on \partial AB.

We note that the first inequality is true because A and B are line aggregates, thus
there is at least one full FE facet on their interface, i.e., the one between the interior
cells.

Given a function \bfitv \in \bfitH 1\bfzero (\Omega ), let us consider, e.g., the extended Scott--Zhang
interpolant \pi SZh (\bfitv h) with the optimal approximability properties in Theorem 4.4.
For agFE spaces with serendipity extensions, we would consider \u \pi SZh (\bfitv h) instead.
Using (24), at every proper facet F \in \scrF +h , we can compute \zeta F (\bfitv ) \in \BbbR such that

\zeta F (\bfitv )

\int 
F

\bfitphi Fh \cdot \bfitn =
\int 
F

(\bfitv  - \pi SZh (\bfitv )) \cdot \bfitn 

and define \bfitzeta h(\bfitv ) =
\sum 

F\in \scrF +
h
\bfitphi Fh \zeta F (\bfitv ) \in \bfitV h. Thus, taking \pi 

qF
h (\bfitv )

.
= \pi SZh (\bfitv ) + \bfitzeta h(\bfitv ),

one readily checks the equality in (23). Next, we prove the stability of the quasi-Fortin
interpolant. We can bound \zeta F (\bfitv ), since F \in \scrF +h , as follows. Let us represent with
AF , BF \in \scrT h the two aggregates sharing F and ABF

.
= AF \cup BF . The properties

of the facet bubble in (24), the extended Scott--Zhang approximability properties in
(15), the inverse inequality (13), and the Cauchy--Schwarz inequality yield

\zeta F =

\int 
F
(\bfitv  - \pi SZh (\bfitv )) \cdot \bfitn \int 

F
\bfitphi Fh \cdot \bfitn 

\lesssim 

\int 
F
(\bfitv  - \pi SZh (\bfitv )) \cdot \bfitn 

| F | 
\lesssim 

\| \bfitv  - \pi SZh (\bfitv )\| F
| F | 

1
2

(25)

\lesssim h - 
d - 1
2 \| \bfitv  - \pi SZh (\bfitv )\| \partial AF \lesssim h

 - d - 1
2 (h - 

1
2 \| \bfitv  - \pi h(\bfitv )\| AF + h

1
2 | \bfitv  - \pi h(\bfitv )| 1,AF )

\lesssim h - 
d - 2
2 \| \bfitv \| 1,\nu (AF ).

Using scaling arguments, the results in (24) and (25), and the fact that for any
interior cell K \in \scrK \mathrm{i}\mathrm{n}h , the cardinality of the set \{ A \in \scrT h : K \subseteq \nu (A)\} is bounded
independently of h, we get

| | | \bfitzeta h(\bfitv )| | | 
2
h \leq 

\sum 
F\in \scrF +

h

\| \zeta F\bfitphi Fh \| 
2

1,ABF
\lesssim 

\sum 
F\in \scrF +

h

\zeta 2Fh
d - 2\| \bfitphi Fh \| 

2
L\infty (ABF )

\lesssim 
\sum 

F\in \scrF +
h

\| \bfitv \| 21,\nu (AF ) \lesssim \| \bfitv \| 
2
1,\Omega .

This result, combined with the stability and approximability of the Scott--Zhang pro-
jector and the triangle inequality, leads to the stability of the quasi-Fortin interpolant
in (23):

| | | \pi qFh (\bfitv )| | | h \lesssim | | | \pi 
SZ
h (\bfitv )| | | h + | | | \bfitzeta h(\bfitv )| | | h \lesssim \| \bfitv \| 1,\Omega .

It proves the lemma.

In what follows, we will make use of the jump operator over facets:

[[p]](\bfitx ) = lim
\epsilon \rightarrow 0+

(p(\bfitx + \epsilon \bfitn ) - p(\bfitx  - \epsilon \bfitn )) \forall \bfitx \in F, \forall F \in \scrF h,

where \bfitn is a normal to the facet.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1558 S. BADIA, A. F. MARTIN, AND F. VERDUGO

Lemma 6.6. Let us consider the mixed FE space \bfitV h\times Mh for Mh
.
= \scrP  - 0,h\cap L

2
0(\Omega ).

Then, for any ph \in \scrP  - 0,h \cap L
2
0(\Omega ), there exists a \bfitv h \in \bfitV h such that

1

\beta 0
\| ph\| 

2
\Omega \leq bh(\bfitv h, ph) +

\sum 
F\in \scrF  - 

h

h\| [[p]]\| 2F , | | | \bfitv h| | | h \leq \| ph\| \Omega ,(26)

for a positive constant \beta 0.

Proof. Relying on the continuous inf-sup condition (3), for any ph \in \scrP  - 0,h\cap L
2
0(\Omega )

there exists a \bfitv \in \bfitH 1\bfzero (\Omega ) such that

bh(\bfitv , ph) = - (\bfnabla \cdot \bfitv , ph)\Omega + (\bfitv \cdot \bfitn , ph)\Gamma =  - 
\sum 

F\in \scrF h

(\bfitv \cdot \bfitn , [[ph]])F \geq 
1

\beta 
\| ph\| 

2
\Omega ,

\| \bfitv \| 1,\Omega \lesssim \| ph\| \Omega ,(27)

where we have used integration by parts and added up the contributions from both
cells sharing an interior facet. Using the properties of the quasi-Fortin interpolant in
(23), after some algebraic manipulation, we obtain

b(\pi 
qF
h (\bfitv ), ph)= - 

\Bigl( 
\bfnabla \cdot \pi qFh (\bfitv ), ph

\Bigr) 
\Omega 
+
\Bigl( 
\pi 
qF
h (\bfitv ) \cdot \bfitn , ph

\Bigr) 
\Gamma 
= - 

\sum 
F\in \scrF h

\Bigl( 
\pi 
qF
h (\bfitv ) \cdot \bfitn , [[ph]]

\Bigr) 
F

=  - 
\sum 

F\in \scrF +
h

\Bigl( 
\pi 
qF
h (\bfitv ) \cdot \bfitn , [[ph]]

\Bigr) 
F
 - 

\sum 
F\in \scrF  - 

h

\Bigl( 
\pi 
qF
h (\bfitv ) \cdot \bfitn , [[ph]]

\Bigr) 
F

=  - 
\sum 

F\in \scrF +
h

(\bfitv \cdot \bfitn , [[ph]])F  - 
\sum 

F\in \scrF  - 
h

\Bigl( 
\pi 
qF
h (\bfitv ) \cdot \bfitn , [[ph]]

\Bigr) 
F

=  - 
\sum 

F\in \scrF h

(\bfitv \cdot \bfitn , [[ph]])F +
\sum 

F\in \scrF  - 
h

\Bigl( 
(\bfitv  - \pi qFh (\bfitv )) \cdot \bfitn , [[ph]]

\Bigr) 
F
.(28)

We can bound the last term in (28) using the trace inequality (13), the local Scott--
Zhang interpolant error estimate in Theorem 4.4 for \bfitv \in H1\bfzero (\Omega ), the second bound in
(27), and Young's and Cauchy--Schwarz inequalities as follows:\sum 

F\in \scrF  - 
h

\Bigl( 
(\bfitv  - \pi qFh (\bfitv )) \cdot \bfitn , [[ph]]

\Bigr) 
F
\leq 

\sum 
F\in \scrF  - 

h

\| \bfitv  - \pi qFh (\bfitv )\| F \| [[ph]]\| F

\lesssim 
\sum 

F\in \scrF  - 
h

(h - 
1
2 \| \bfitv  - \pi qFh (\bfitv )\| AF

+ h
1
2 \| \bfitv  - \pi qFh (\bfitv )\| 1,AF )\| [[ph]]\| F

\lesssim 
\sum 

F\in \scrF  - 
h

\| \bfitv \| 1,\nu (AF )h
1
2 \| [[ph]]\| F

\lesssim \alpha \| \bfitv \| 21,\Omega +
1

\alpha 

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F

\lesssim \alpha \| ph\| 
2
\Omega +

1

\alpha 

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F(29)

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1559

for any \alpha > 0. Combining (27), (28), and (29) with \alpha large enough, we readily get

b(\pi 
qF
h (\bfitv ), ph) \geq 

1

\beta 
\| ph\| 

2
\Omega  - C\alpha \| ph\| 

2
\Omega  - 

C

\alpha 

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F

\geq 
1

\beta 0
\| ph\| 

2
\Omega  - 

C

\alpha 

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F

for \beta 0 > 0. It proves the lemma.

Let us define the L2 interpolant for extended discontinuous Lagrangian spaces as
follows. Given ph \in \scrP  - q,h and 0 \leq r < q, we define \pi 

 - ,r
h (ph) \in \scrP 

 - 
q,h as the solution of\bigl( 

\pi 
 - ,r
h (ph), qh

\bigr) 
A
= (ph, qh)A \forall qh \in \scrP 

 - 
r,h.

Lemma 6.7. There exists a \bfitvarphi h(ph) \in \bfitV h that satisfies the following properties:

1

\beta \prime 0

\sum 
A\in \scrT +

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
\leq bh(\bfitvarphi h(ph), ph), | | | \bfitvarphi h(ph)| | | 

2
h \leq 

\sum 
A\in \scrT +

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
.

(30)

Proof. Due to Assumption 6.4, for every proper aggregate A \in \scrT +h (i.e., a rect-
angular cuboid), there is a quadratic bubble \bfitphi h

A \in \bfitV h(A) that vanishes on \partial A \setminus \Gamma 
and satisfies

\bfitphi Ah (\bfitx ) \geq 0,
\int 
A

\bfitphi Ah \gtrsim | A| > 0, \| \bfitphi 
A
h \| \infty \lesssim 1.(31)

For any ph \in Mh, we define

\bfitvarphi h(ph)
.
=

\sum 
A\in \scrT +

h

\phi Ah h
2\bfnabla ph.(32)

Using the definition of the norms in (21), the trace inequality (13), and the inverse
inequality (14), we readily obtain | | | \bfitvarphi h(ph)| | | h \lesssim h

 - 1\| \bfitvarphi h(ph)\| \Omega . Combining this result
with the fact that \| \phi Ah \| \infty ,A \lesssim 1 and (32), we prove the continuity bound in (30):

| | | \bfitvarphi h(ph)| | | 
2
h \lesssim 

\sum 
A\in \scrT +

h

h2\| \bfnabla ph\| 
2
A =

\sum 
A\in \scrT +

h

h2\| \bfnabla (ph  - \pi 
 - ,0
h (ph))\| 

2

A

\lesssim 
\sum 

A\in \scrT +
h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
.

Next, we note that given a proper aggregate A \subset \scrT +h and FE function \bfitv h, using
scaling arguments, the first two properties in (31), and the equivalence of norms in
finite dimension, we have

C - (\bfitv h,\bfitv h)A \leq 
\bigl( 
\phi Ah \bfitv h,\bfitv h

\bigr) 
A
\leq C+ (\bfitv h,\bfitv h)A(33)

for positive constants independent of h and cut cell intersections. Thus, integrating
by parts the first term in (19) and using the definition of \bfitvarphi h(ph) in the statement of

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1560 S. BADIA, A. F. MARTIN, AND F. VERDUGO

Lemma 6.7, the fact that aggregate bubbles vanish on interior facets on the aggregate
boundaries, and the equivalence of norms in (33), we obtain

bh(\bfitvarphi h(ph), ph) =
\sum 

A\in \scrT +
h

(\bfitvarphi h(ph),\bfnabla ph)A =
\sum 

A\in \scrT +
h

h2
\bigl( 
\phi Ah , | \bfnabla ph| 

2
\bigr) 
A
\gtrsim 

\sum 
A\in \scrT +

h

h2\| \bfnabla ph\| 
2
A.

(34)

On the other hand, since (ph  - \pi 
 - ,0
h (ph))| A \in Mh(A) \cap L

2
0(A), it holds from the

Poincar\'e--Wirtinger inequality with a scaling argument

\| ph  - \pi 
 - ,0
h (ph)\| A \lesssim h\| \bfnabla (ph  - \pi 

 - ,0
h (ph))\| A = h\| \bfnabla ph\| A.(35)

Combining (34) and (35), we prove the lemma.

In the next theorem, we combine the inf-sup for the space of aggregate-constant
pressures in Lemma 6.6 and the additional stability in Lemma 6.7 to prove the desired
weak inf-sup condition.

Theorem 6.8. Let us assume that the mixed FE space \bfitV h\times \scrP  - 0,h\cap L
2
0(\Omega ) satisfies

the inf-sup condition (26) in Lemma 6.6. Then, for any ph \in \scrP  - q - 1,h, there exists a
\bfitv h \in \bfitV h such that

1

\beta q
\| ph\| 

2
\Omega \leq bh(\bfitv h, ph) +

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F+

\sum 
A\in \scrT  - 

h

\| ph + \pi 
 - ,0
h (ph)\| 

2

A
, | | | \bfitv h| | | h \leq \| ph\| ,

(36)

for a positive constant \beta q.

Proof. Let us decompose bh(\bfitv h, ph) as follows:

bh(\bfitv h, ph) = bh(\bfitv h, \pi 
 - ,0
h (ph)) + bh(\bfitv h, ph  - \pi 

 - ,0
h (ph)).(37)

Since \bfitV h \times (\scrP  - 0,h \cap L
2
0(\Omega )) is weakly inf-sup stable by the statement of the theorem,

i.e., it satisfies (26), there exists a function \bfitv h such that

1

\beta 0
\| \pi  - ,0h (ph)\| 

2

\Omega 
\leq bh(\bfitv h, \pi 

 - ,0
h (ph)) +

\sum 
F\in \scrF  - 

h

h\| [[\pi  - ,0h (ph)]]\| 
2

F
, | | | \bfitv h| | | h \leq \| \pi 

 - ,0
h (ph)\| \Omega .

(38)

Using the trace inequality (13), the inverse inequality (14), the stability of \bfitv h in
the weak inf-sup condition (38), and Young's and Cauchy--Schwarz inequalities, the
second term in (37) can be bounded as follows:

bh(\bfitv h, \pi 
 - ,0
h (ph) - ph) \lesssim \| \bfitv h\| 1,\Omega \| ph  - \pi 

 - ,0
h (ph)\| \Omega + h

 - 1
2 \| \bfitv h\| \Gamma h

1
2 \| ph  - \pi 

 - ,0
h (ph)\| \Gamma 

\lesssim | | | \bfitv h| | | h\| ph  - \pi 
 - ,0
h (ph)\| \Omega 

\lesssim \alpha \| \pi  - ,0h (ph)\| 
2

\Omega 
+

1

\alpha 
\| ph  - \pi 

 - ,0
h (ph)\| 

2

\Omega 
.(39)

Combining (37), (38), and (39) for \alpha small enough, we get

1

\beta \ast 0
\| \pi  - ,0h (ph)\| 

2

\Omega 
\leq bh(\bfitv h, ph) +

\sum 
F\in \scrF  - 

h

h\| [[\pi  - ,0h (ph)]]\| 
2

F
+ C\| ph  - \pi 

 - ,0
h (ph)\| 

2

\Omega 
,(40)

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1561

where \beta \ast 0 > 0. On the other hand, we have that \bfnabla ph \in \bfscrP 
 - 
q - 2,h and \bfitvarphi h(ph) \in 

\bfscrQ q(A)\cap \bfitH 10(A) \subset \bfitV h for any A \in \scrT 
+
h (see (32)). Thus, combining the first inequality

in (30) from Lemma 6.7 with (40), we obtain, for an arbitrary positive constant \alpha \prime ,

bh(\bfitvarphi h(ph) + \alpha 
\prime \bfitv h, ph) \geq 

1

\beta \prime 0

\sum 
A\in \scrT +

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
+
\alpha \prime 

\beta \ast 0
\| \pi  - ,0h (ph)\| 

2

\Omega 

 - \alpha \prime 
\sum 

F\in \scrF  - 
h

h\| [[\pi  - ,0h (ph)]]\| 
2

F
 - \alpha \prime C\| ph  - \pi 

 - ,0
h (ph)\| 

2

\Omega 

\geq 
1

\beta \prime 0

\sum 
A\in \scrT +

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
+
\alpha \prime 

\beta \ast 0
\| \pi  - ,0h (ph)\| 

2

\Omega 

 - \alpha \prime 
\sum 

F\in \scrF  - 
h

h\| [[\pi  - ,0h (ph)]]\| 
2

F

 - \alpha \prime C
\sum 

A\in \scrT +
h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
 - \alpha \prime C

\sum 
A\in \scrT  - 

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A

\geq 
1 - \alpha \prime C\beta \prime 0

\beta \prime 0

\sum 
A\in \scrT +

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
+
\alpha \prime 

\beta \ast 0
\| \pi  - ,0h (ph)\| 

2

\Omega 

 - \alpha \prime 
\sum 

F\in \scrF  - 
h

h\| [[\pi  - ,0h (ph)]]\| 
2

F
 - \alpha \prime C

\sum 
A\in \scrT  - 

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A

\geq 
1 - \alpha \prime C\beta \prime 0

\beta \prime 0

\sum 
A\in \scrT h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
+
\alpha \prime 

\beta \ast 0
\| \pi  - ,0h (ph)\| 

2

\Omega 

 - \alpha \prime 
\sum 

F\in \scrF  - 
h

h\| [[\pi  - ,0h (ph)]]\| 
2

F

 - 
1 - 2\alpha \prime C\beta \prime 0

\beta \prime 0

\sum 
A\in \scrT  - 

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
.(41)

Next, we note that the local inverse inequality in (10) is true for untrimmed aggregates.
However, since the extension operator is aggregatewise for piecewise discontinuous FE
spaces, it also holds for trimmed aggregates. The trace inequality (12), the inverse
inequality on trimmed aggregates, and the triangle inequality yield\sum 

F\in \scrF  - 
h

h\| [[\pi  - ,0h (ph)]]\| 
2

F
\leq 

\sum 
F\in \scrF  - 

h

h\| [[ph  - \pi 
 - ,0
h (ph)]]\| 

2

F
+

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F

\lesssim 
\sum 
A\in \scrT h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
+

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F .(42)

Invoking (42) in (41) and picking \alpha \prime small enough, we get

bh(\bfitvarphi h(ph) + \alpha 
\prime \bfitv h, ph) \gtrsim \| ph  - \pi 

 - ,0
h (ph)\| 

2

\Omega 
+ \| \pi  - ,0h (ph)\| 

2

\Omega 

 - 
\sum 

F\in \scrF  - 
h

h\| [[ph]]\| 
2
F  - 

\sum 
A\in \scrT  - 

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A

\geq \| ph\| 
2
\Omega  - 

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F  - 

\sum 
A\in \scrT  - 

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1562 S. BADIA, A. F. MARTIN, AND F. VERDUGO

It proves the first inequality in the theorem. Furthermore, using the fact that
\| \pi  - ,0h (ph)\| \Omega \leq \| ph\| \Omega , the stability in (30), and the triangle inequality, we get

| | | \bfitvarphi h(ph) + \alpha 
\prime \bfitv h| | | 

2
h \leq | | | \bfitvarphi h(ph)| | | 

2
h + | | | \alpha 

\prime \bfitv h| | | 
2
h

\lesssim 
\sum 

A\in \scrT +
h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
+ \| \alpha \prime \pi  - ,0h (ph)\| 

2

\Omega 
\leq \| ph\| 

2
\Omega .

It proves the theorem.

Assumption 6.9 (pressure stabilization). For a mixed FE space \bfitV h \times Mh, we
consider jh (pressure stabilization) such that it is positive semidefinite and for any
(\bfitu h, ph), (\bfitv h, qh) \in \bfitV h \times Mh it holds that

1

\gamma j
jh(\bfitu h, ph,\bfitu h, ph) \geq 

\sum 
A\in \scrT  - 

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A
+

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F  - 

\gamma a
2\gamma j

| | | \bfitu h| | | 
2
h,(43)

jh(\bfitu h, ph,\bfitv h, qh) \leq \xi j | | | \bfitu h, ph| | | h| | | \bfitv h, qh| | | h(44)

for some positive constants \gamma j and \xi j .

Theorem 6.10. Let us assume that the mixed FE space \bfitV h \times Mh satisfies the
inf-sup condition (36) and that the pressure stabilization jh satisfies Assumption 6.9.
It holds that

1

\beta d
| | | \bfitu h, ph| | | h \leq sup

(\bfitv h,qh)\in \bfitV h\times Mh

Ah(\bfitu h, ph,\bfitv h, qh)

| | | \bfitv h, qh| | | h
(45)

for a positive constant \beta d.

Proof. First, we take as test function (\bfitu h, ph). Using the first inequality in (22),
we get

Ah(\bfitu h, ph,\bfitu h, ph) = ah(\bfitu h,\bfitu h) + jh(\bfitu h, ph,\bfitu h, ph) \geq \gamma a| | | \bfitu h| | | 
2
h + jh(\bfitu h, ph,\bfitu h, ph).

Next, taking as test function (\bfitv h, 0), where \bfitv h satisfies the weak inf-sup (36) in
Theorem 6.8, we get

Ah(\bfitu h, ph,\bfitv h, 0) = ah(\bfitu h,\bfitv h) + bh(\bfitv h, ph) + jh(\bfitu h, ph,\bfitv h, 0)

\geq 
1

\beta q
\| ph\| 

2
\Omega  - 

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F  - 

\sum 
A\in \scrT  - 

h

\| ph  - \pi 
 - ,0
h ph\| 

2

A

+ ah(\bfitu h,\bfitv h) + jh(\bfitu h, ph,\bfitv h, 0).(46)

On one side, the second inequality in (22) together with Young's and Cauchy--Schwarz
inequalities yields

ah(\bfitu h,\bfitv h) \leq 
\xi 2a
4\alpha 

| | | \bfitu h| | | 
2
h + \alpha | | | \bfitv h| | | 

2
h \leq 

\xi 2a
4\alpha 

| | | \bfitu h| | | 
2
h + \alpha \| ph\| 

2
\Omega 

for an arbitrary constant \alpha . On the other side, using the fact that the pressure
stabilization is positive semidefinite, Cauchy--Schwarz and Young's inequalities, the
continuity in (44), and the stability for \bfitv h in (36), we get

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1563

jh(\bfitu h, ph,\bfitv h, 0) \geq  - 
1

4\alpha 
jh(\bfitu h, ph,\bfitu h, ph) - \alpha jh(\bfitv h, 0,\bfitv h, 0)

\geq  - 
1

4\alpha 
jh(\bfitu h, ph,\bfitu h, ph) - \alpha \xi j | | | \bfitv h| | | 

2
h

\geq  - 
1

4\alpha 
jh(\bfitu h, ph,\bfitu h, ph) - \alpha \xi j\| ph\| 

2
\Omega .(47)

As a result, combining (46)--(47), and taking \alpha small enough, we obtain

Ah(\bfitu h, ph,\bfitv h, 0) \gtrsim \| ph\| 
2
\Omega  - 

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 
2
F  - 

\sum 
A\in \scrT  - 

h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A

 - jh(\bfitu h, ph,\bfitu h, ph) - | | | \bfitu h| | | 
2
h.(48)

By taking (\bfitu h + \alpha 
\prime \bfitv h, ph) as a test function with \alpha 

\prime small enough, using (47), (48),
and the assumption over the pressure stability in (43), we finally get

Ah(\bfitu h, ph,\bfitu h + \alpha 
\prime \bfitv h, ph) \gtrsim | | | \bfitu h| | | 

2
h + \alpha 

\prime C\| ph\| 
2
\Omega + jh(\bfitu h, ph,\bfitu h, ph)

 - \alpha \prime C
\sum 

F\in \scrF  - 
h

h\| [[ph]]\| 
2
F  - \alpha 

\prime C
\sum 

A\in \scrT  - 
h

\| ph  - \pi 
 - ,0
h (ph)\| 

2

A

\gtrsim | | | \bfitu h| | | 
2
h + \| ph\| 

2
\Omega + jh(\bfitu h, ph,\bfitu h, ph).

On the other hand, the stability for \bfitv h in (36) and the triangle inequality yield

| | | \bfitu h + \alpha \prime \bfitv h, ph| | | h \lesssim | | | \bfitu h, ph| | | h + | | | \alpha 
\prime \bfitv h| | | h \lesssim | | | \bfitu h, ph| | | h + \| \alpha 

\prime ph\| \Omega \lesssim | | | \bfitu h, ph| | | h.

It proves the theorem.

6.2. Mixed agFEM and pressure stabilization. We propose below an algo-
rithm that satisfies Assumption 6.9 and thus the stability results in Theorem 6.10.

Algorithm 6.11. We consider a hex mesh, the velocity space \bfitV h
.
= \bfscrQ q,h, and

the pressure space Mh
.
= \scrP  - q - 1,h for an integer q \geq 2. The pressure stabilization term

is taken as

jh(\bfitu h, ph,\bfitv h, qh)
.
=

\sum 
F\in \scrF  - 

h

\tau j1h ([[ph]], [[qh]])F +
\sum 

A\in \scrT  - 
h

\tau j2h
2 ( - \Delta \bfitu h+\bfnabla ph, - \Delta \bfitv h+\bfnabla qh)A,

gh(\bfitf ,\bfitv h)
.
=

\sum 
A\in \scrT  - 

h

h2 (\bfitf , - \Delta \bfitv h +\bfnabla qh)A(49)

for positive algorithmic constants \tau j1 and \tau j2.

The agFE space thus relies on the popular FE space \bfscrQ q,h\times \scrP  - q - 1,h for the interior
cells. The velocity field is extended to cut cells by the standard extension operator
in section 4.2.3, and the discontinuous pressure field is extended by the standard
(discontinuous) one. This choice has been motivated by the proof of the abstract
discrete inf-sup condition.

Theorem 6.12. The method proposed in Algorithm 6.11 has a pressure stabiliza-
tion term that satisfies Assumption 6.9 and thus it satisfies Theorem 6.10. As a result,
the discrete problem (20) is well-posed for \bfitf \in \bfitL 2(\Omega ).

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1564 S. BADIA, A. F. MARTIN, AND F. VERDUGO

Proof. As required in Assumption 6.9, the pressure stabilization is positive semi-
definite. In order to prove that (43) holds, we use the following inequality. Given three

functions v, p in a Hilbert space X and u in a Banach space Y , defining \gamma 
1
2
.
=

\| u\| Y
\| v\| X

,

we have, using Young's inequality for an arbitrary constant \alpha > 1,

2\| p - v\| 2X = \| p - v\| 
2
X + \| p\| 

2
X + \| v\| 

2
X  - 2(p, v)X

\geq \| p - v\| 2X +
\biggl( 
1 - 

1

\alpha 

\biggr) 
\| p\| 2X  - (\alpha  - 1)\| v\| 

2
X

= \| p+ v\| 2X +
\biggl( 
1 - 

1

\alpha 

\biggr) 
\| p\| 2X  - 

\alpha  - 1
\gamma 

\| u\| 2Y .

Taking \alpha = 1 + \gamma > 1, we obtain

2\| p+ v\| 2X \geq \| p+ v\| 
2
X +

1

1 + 1
\gamma 

\| p\| 2X  - \| u\| 
2
Y .

Let us consider X = L2(A), v = h\Delta \bfitu h, p = h\bfnabla ph, Y = \bfitH 1(A), and u = \omega 
1
2\bfitu h, for

A \in \scrT  - h and an arbitrary positive constant \omega . Using the inverse inequality (10), we
have that h\| \Delta \bfitu h\| A \leq C\| \bfitu h\| 1, \~A, thus \gamma \geq C

 - 2\omega . The previous bound leads to\sum 
A\in \scrT  - 

h

h2\|  - \Delta \bfitu h +\bfnabla ph\| 
2
A \geq C

\sum 
A\in \scrT  - 

h

h2\| \bfnabla ph\| 
2
\Omega  - 

\sum 
A\in \scrT  - 

h

\omega \| \bfitu h\| 
2
1, \~A.(50)

The Poincar\'e--Wirtinger inequality with a scaling argument yields

\| ph  - \pi 
 - ,0
h (ph)\| A \lesssim h\| \bfnabla (ph  - \pi 

 - ,0
h (ph)\| \Omega = h\| \bfnabla ph\| \Omega .(51)

Combining (50) and (51), using Lemma 4.3, and adjusting \omega accordingly, we find

jh(\bfitu h, ph,\bfitu h, ph) \geq \gamma j
\sum 

A\in \scrT  - 
h

\| ph  - \pi 
 - ,0
h (ph)\| 

2
A + \gamma j

\sum 
F\in \scrF  - 

h

h\| [[ph]]\| 2F  - 
\gamma a
2\gamma j

\| \bfitu h\| 
2
1,\Omega 

for a positive constant \gamma j . Thus, the stabilization term satisfies Assumption 6.9. Its
continuity in (44) is obtained from the trace inequalities (12)--(13) and the inverse
inequality (14). This result, together with (45), proves the well-posedness of the
discrete operator. Furthermore, for \bfitf \in L20(\Omega ), we can easily prove that gh(\bfitf ,\bfitv h) \leq 
\xi g\| \bfitf \| \Omega | | | \bfitv h| | | h.

6.3. Mixed agFEM with serendipity extension. In this section, we propose
another mixed agFEM, which makes use of the serendipity extension in section 4.2.3.
It relies again on \bfscrQ q,h\times \scrP  - q - 1,h for the interior cells. The velocity field is extended to
cut cells by the serendipity extension operator and the discontinuous pressure field is
extended by the standard (discontinuous) one. This choice has also been motivated
by the proof of the abstract discrete inf-sup condition. The method reads as follows.

Algorithm 6.13. We consider a hex mesh, the velocity space \bfitV h
.
= \u \bfscrQ q,h, and

the pressure space Mh
.
= \scrP  - q - 1,h for an integer 2 \leq q \leq 2d  - 2. The pressure stabi-

lization term is taken as

jh(ph, qh)
.
=

\sum 
F\in \scrF  - 

h

\tau j1h ([[ph]], [[qh]])F(52)

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1565

for a positive algorithmic constant \tau j1, whereas gh(\bfitf ,\bfitv h)
.
= 0. In three dimensions,

if q \leq 2d  - 3, the improper facet set \scrF  - h can be reduced further, by considering only
those facets that also satisfy that their corresponding owner interior cells \scrO (AF ) and
\scrO (BF ) do not share a FE facet, i.e., | KAF \cap KBF | = \emptyset in d  - 1 sense (see Figure
6(b)).

We note that Assumption 6.4 does not hold in this case but stability is proved
using a different strategy. The analysis is almost identical to the one in section 6.1.
We only comment on the two points in which it differs.

Theorem 6.14. The method proposed in Algorithm 6.13 has a pressure stabiliza-
tion term that satisfies Assumption 6.9 and thus it satisfies Theorem 6.10. As a result,
the discrete problem (20) is well-posed for \bfitf \in \bfitH  - 1(\Omega ).

Proof. First, we note that for the serendipity FE up to order 2d - 2, a unisolvent
set of DOFs are nodal values on the cell boundary only and thus zero for bubble
functions (see [36] for more details). Thus, the serendipity extension of the quadratic
bubble function of the owner cell of the aggregate is zero in \Omega \setminus \Omega \mathrm{i}\mathrm{n} for q \leq 2d  - 2.
Therefore, one can define aggregate bubbles that satisfy (31) for all the aggregates;
thus all the lemmas/theorems still apply without the need of cell interior stabilization
or Assumption 6.4.

In three dimensions, since serendipity FEs up to order 2d  - 3 do not include
the DOFs corresponding to the quadratic facet bubbles, the facet bubbles of the
owner interior cells of an aggregate are extended by zero. Thus, if the roots of two
neighboring aggregates are also neighbors, there exists a facet bubble that satisfies
(24). As a result, the subset \scrF  - h can be restricted as stated in the definition of the
algorithm, whereas the previous lemmas/theorems still hold (see Figure 6(b)). On
the other hand,

jh(\bfitu h, ph,\bfitu h, ph) =
\sum 

F\in \scrF  - 
h

\tau j1h\| [[ph]]\| 
2
F .

We can readily check that the stabilization term satisfies (43). The continuity result
in (44) is readily obtained from the trace inequalities (12)--(13). As a result, the
stabilization term satisfies Assumption 6.9. This result, together with (45), proves
the theorem.

6.4. A priori error estimates. At this point, we have already checked that
Algorithms 6.11 and 6.13 are well-posed. Next, we want to prove a priori error esti-
mates for these algorithms. The proof of these results is fairly straightforward, since
the pressure stabilization terms are consistent for pressure fields in H1(\Omega ). As usual,
Galerkin orthogonality, the stability in Theorems 6.12 and 6.14, and the approxima-
bility properties in Theorem 4.4 lead to the desired results.

Let us note that the jump stabilization in (52) (also in (49)) can be modified
by integrating not only on (potentially) cut facets F \in \scrF h but in the corresponding
whole facets. Such modification does provide more stabilization and does not affect
the consistency of the method in the error analysis of Theorem 6.15 below.

Theorem 6.15. Let us consider the discrete solution (\bfitu h, ph) \in \bfitV h \times Mh in
Algorithms 6.11 and 6.13 (for a given order q \geq 1). If the solution (\bfitu , p) of the Stokes
problem (2) belongs to \bfitH \alpha +1(\Omega )\times H\alpha (\Omega ) for \alpha \geq 1, then the following a priori error
estimate holds for k

.
= min(q, \alpha ):

| | | \bfitu  - \bfitu h, p - ph| | | h \lesssim h
k\| \bfitu \| Hk+1(\Omega ) + h

k\| p\| Hk(\Omega ).

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1566 S. BADIA, A. F. MARTIN, AND F. VERDUGO

Proof. First, let us note that the bilinear form Ah in Algorithms 6.11 and 6.13 is
consistent. Since p \in H1(\Omega ), the pressure jump stabilization vanishes. It is obvious
to check that the interior residual-based stabilization vanishes too. Let us consider
the extended Scott--Zhang projector for every component of the velocity \pi SZh (\bfitu ) and
for the pressure \pi SZh (p). The Galerkin orthogonality and the continuity of Ah (which
is a direct consequence of the continuity results in (22)--(44)) yield

Ah(\bfitu h  - \pi SZh (\bfitu ), ph  - \pi 
SZ
h (p),\bfitv h, qh) = Ah(\bfitu  - \pi 

SZ
h (\bfitu ), p - \pi 

SZ
h (p),\bfitv h, qh)

\leq \xi A| | | \bfitu  - \pi SZh (\bfitu ), p - \pi 
SZ
h p| | | h| | | \bfitv h, qh| | | h.

Taking as test function the (\bfitv h, qh) for which the global inf-sup condition in Theorem
6.10 is satisfied and the previous inequality, we readily get

| | | \bfitu h  - \pi SZh (\bfitu ), ph  - \pi 
SZ
h (p)| | | h \leq \beta d

Ah(\bfitu h  - \pi SZh (\bfitu ), ph  - \pi 
SZ
h (p),\bfitv h, qh)

| | | \bfitv h, qh| | | h
\leq \beta d\xi A| | | \bfitu  - \pi SZh (\bfitu ), p - \pi 

SZ
h (p)| | | h.

Finally, the approximability properties of the extended Scott--Zhang projector in The-
orem 4.4 and the trace inequality (13) yield

| | | \bfitu  - \pi SZh (\bfitu ), p - \pi 
SZ
h p| | | 

2
h = \| \bfnabla (\bfitu  - \pi 

SZ
h (\bfitu ))\| 

2

\Omega +\| h
 - 1

2 (\bfitu  - \pi SZh (\bfitu ))\| 
2

\Gamma +\| p - \pi 
SZ
h p\| 

2

\Omega 

\lesssim h2k\| \bfitu \| 2Hk+1(\Omega ) + h
2k\| p\| 2Hk(\Omega ).

It proves the theorem.

6.5. Condition number bounds. It is well-known that extended FE spaces
without aggregation lead to arbitrary ill-conditioned systems, due to the small cut cell
problem, i.e., when the ratio \eta K tends to zero (see [12] for details). Thus, arbitrarily
high condition numbers are expected in practice since the position of the interface
cannot be controlled and the value \eta K can be arbitrarily close to zero. It has motivated
the agFEM in [15]. We prove in the following theorem that the agFEM proposed
herein for the Stokes problem leads to the same condition number bounds as for body-
fitted methods, i.e., they do not depend on the cut cell intersection. We represent
with | \cdot | \ell 2 the Euclidean norm of vectors and matrices.

Theorem 6.16. The condition number of the matrices that arise from Algorithms
6.11 and 6.13, i.e., \kappa (Ah)

.
= | Ah| \ell 2 | A - 1h | \ell 2 , satisfies \kappa (Ah) \leq C\kappa h

 - 2 for a positive
constant C\kappa .

Proof. First, we note that \bfitu h \in \bfitV h can be stated in terms of a global basis of
FE shape functions as

\sum Nu
a=1 Ua\bfitphi 

a
u. We define the Cartesian norm for the vector of

DOF values of \bfitu h as | \bfitu h| \ell 2 . We proceed analogously for the pressure, e.g., ph =\sum Np
a=1 Pa\phi 

a
p \in Mh; we note that the pressure space has dimension Np  - 1 due to the

zero mean restriction, i.e., Mh \subset L20(\Omega ). Let us represent velocity-pressure functions
in \bfitV h\times Mh with bold capital Greek letters. Given \Phi h

.
= (\bfitu h, ph), we define | \Phi h| 2\ell 2

.
=

| \bfitu h| 2\ell 2 + | ph| 
2
\ell 2
. For any velocity component and pressure, we have from the fact

that the eigenvalues of the local mass matrix in every interior cell are bounded (see,

e.g., [46]) that C - mh
d| \bfitu h| 2\ell 2 \leq \| uh\| 

2
\Omega \mathrm{i}\mathrm{n}

\leq C+mhd| \bfitu h| 2\ell 2 . This result, combined with the
stability of the extension operator in Lemma 4.3, yields

C - Mh
d| \bfitu h| 2\ell 2 \leq \| \bfitu h\| 

2
\Omega \leq C

+
Mh

d| \bfitu h| 2\ell 2 .(53)

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1567

We can proceed analogously for the pressure space. Now, we can bound the following
velocity norm using the inverse inequality (14), the trace inequality (12), and the
norm relation in (53), as follows:

| | | \bfitu h| | | 
2
h = \| \bfnabla \bfitu h\| 

2
\Omega + \| h

 - 1
2\bfitu h\| 

2

\Gamma \lesssim h
 - 2\| \bfitu h\| 

2
\Omega \lesssim h

d - 2| \bfitu h| 2\ell 2 .

Thus, we have | | | \Phi h| | | 
2
h \lesssim h

d - 2| \Phi h| 2\ell 2 for any \Phi h \in \bfitV h\times Mh. The Friedrichs inequality
and (53) yield | \bfitu h| 2\ell 2 \leq C(\Omega )h

 - d\| \bfitu h\| 
2
\Omega \lesssim C(\Omega )h

 - d| | | \bfitu h| | | 
2
h. As a result,

C(\Omega ) - 1hd| \bfitu h| 2\ell 2 \lesssim | | | \bfitu h| | | 
2
h \lesssim h

d - 2| \bfitu h| 2\ell 2 .(54)

We can bound the norm of Ah by using its continuity (from the continuity results
in (22) and (44)) and the norm equivalence in (54) for the velocity and the version in
(53) for the pressure as follows:

| Ah| \ell 2 = max
\bfPhi h\in \bfitV h\times Mh

max
\bfPsi h\in \bfitV h\times Mh

Ah(\Phi h,\Psi h)

| \Phi h| \ell 2 | \Psi h| \ell 2
\leq \xi A

| | | \Phi h| | | h| | | \Psi h| | | h
| \Phi h| \ell 2 | \Psi h| \ell 2

\lesssim hd - 2.(55)

Making abuse of notation, we use Ah\Phi h
.
= Ah(\Phi h, \cdot ). Next, we provide a lower

bound for the norm of the operator Ah\Phi h for some \Phi h \in \bfitV h\times Mh. Using the inf-sup
condition in Theorem 6.10 and the norm equivalence in (54), we obtain

| Ah\Phi h| \ell 2 = max
\bfPsi h\in \bfitV h\times Mh

Ah(\Phi h,\Psi h)

| \Psi h| \ell 2

= max
\bfPsi h\in \bfitV h\times Mh

Ah(\Phi h,\Psi h)

| | | \Psi h| | | h
| | | \Psi h| | | h
| \Psi h| \ell 2

\geq \beta d| | | \Phi h| | | h min
\bfPsi h\in \bfitV h\times Mh

| | | \Psi h| | | h
| \Psi h| \ell 2

.(56)

Combining (56) and the lower bound in (54), we get | Ah\Phi h| \ell 2 \gtrsim hd| \Phi h| \ell 2 . Taking
\Phi h = A

 - 1
h \Psi h, we readily obtain | \Psi h| \ell 2 \gtrsim h

d| A - 1h \Psi h| \ell 2 . Thus, | A
 - 1
h | \ell 2 \lesssim h

 - d, which,
together with (55), proves the theorem.

7. Numerical experiments. The main purpose of this section is to evaluate
the performance of the agFE spaces in several different scenarios. We start with a
convergence test (cf. section 7.2), where we numerically validate the a priori error
estimates of section 6.4 and the condition number bounds of section 6.5. Next, we
consider a moving domain test (cf. section 7.3) in order to check the robustness of the
methods with respect to small cuts. Finally, we provide the numerical solution of two
realistic problems (cf. section 7.4) in order to illustrate the ability of the agFEM to
deal with complex geometrical data. The performance of the linear solver step is not
analyzed herein. The implementation of optimal and scalable solvers for the Stokes
problem and its application to agFEM will be considered in future work.

7.1. Setup. In all cases, we solve the Stokes problem (1) using Galerkin approxi-
mations with conforming Lagrangian FE spaces as indicated in section 5. We consider
both agFE spaces and conventional ones in order to evaluate the benefits of using cell
aggregation. For the conventional (unaggregated) case, we use, in all cells K \in \scrK h,
\scrQ 2,h and \scrP  - 1,h spaces for the approximation of velocities and pressures, respectively
(e.g., in three dimensions, hexahedral elements with continuous piecewise triquadratic
shape functions for the velocity, and discontinuous piecewise linear shape functions
for the pressure). For the aggregated case, we consider Algorithm 6.13 with q = 2,
i.e., the space \u \scrQ 2,h for every velocity component (the aggregated version of \scrQ 2,h using
the serendipity extension in section 4.2.3) and the aggregated counterpart of \scrP  - 1,h for

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1568 S. BADIA, A. F. MARTIN, AND F. VERDUGO

the pressure. In order to fulfill inf-sup stability, we use the facet-based stabilization
given in (52) for the aggregated spaces with \tau j1 = 0.01 (the value that minimized
the error for a simple test and a set of possible constants). The results for the usual
(unaggregated) spaces are labeled as standard throughout the numerical examples,
whereas results using cell aggregation are labeled as aggregated.

The algorithms proposed in this work have been implemented using the tools
provided by the object-oriented HPC code FEMPAR [16]. The underlying systems of
linear equations are solved by means of a robust sparse direct solver from the MKL
PARDISO package [47] specially designed for symmetric indefinite matrices (to which
FEMPAR provides appropriate interfaces). The condition number estimates provided
below are computed outside FEMPAR using the MATLAB function condest. Numerical
integration is based on local body-fitted triangulations of cut cells into triangles (in
two dimensions) or tetrahedra (in three dimensions), where standard quadrature rules
can be applied. The local triangulation of a cut cell is obtained by FEMPAR from its
nodal coordinates and the intersection points of cell edges with the unfitted boundary
via the Delaunay method available in the QHULL library [48, 49]. Note that these
submeshes are used only for integration purposes and are completely independent
from one cut cell to another (see [14] for details).

7.2. Convergence test. We consider the Stokes problems defined in the 2D and
3D domains shown in Figure 7. The 2D domain (cf. Figure 7(a)) is a circular cavity
defined as the set difference of the unit square [0, 1]2 and the circle of radius R = 0.3
and center C = (0.5, 0.5). The 3D domain is a complex-shaped cavity defined as the
set difference of the unit cube [0, 1]3 and a 3D body whose shape reminds the one of
a popcorn flake (cf. Figures 7(b) and 7(c)). This ``popcorn-flake"" geometry is often
used in the literature to study the performance of unfitted FE methods (see, e.g., [8]).
The popcorn flake geometry considered here is obtained by taking the one defined in
[8], scaling it by a factor of 0.5 and translating it a value of 0.5 in each direction such
that the body fits in the unit cube [0, 1]3. We consider Dirichlet boundary conditions
on the interior walls of the cavities, whereas Neumann conditions are imposed on the
facets of the unit square and unit cube (see Figure 7). Dirichlet boundary conditions
are imposed using Nitsche's method as discussed in section 5.

Physical domain \Omega Dirichlet boundary \Gamma \mathrm{D} Neumann
boundary \Gamma \mathrm{N}

(a) 2D case. (b) 3D case (outer view). (c) 3D case (internal view).

Fig. 7. Convergence test: View of the problem geometries.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1569

We use the method of manufactured solutions in order to have a problem with
known exact solution, which is used here to compute discretization errors. The (man-
ufactured) exact solution we have considered is

(57) \bfitu 
.
=

\bfitu \ast 

| \bfitu \ast | 
, p

.
= x3y3,

where

\bfitu \ast = ( - y + 0.5, x+ 0.3)t , (x, y) \in \Omega \subset \BbbR 2 in two dimensions,
\bfitu \ast = (y  - 0.5,  - x - z  - 0.3, y  - 0.5)t , (x, y, z) \in \Omega \subset \BbbR 3 in three dimensions.

This solution corresponds to a (divergence-free) velocity field of magnitude 1 that spins
around the point (x, y) = ( - 0.3, 0.5) for the 2D case and around the line (x, y, z) =
( - z  - 0.3, 0.5, z), z \in \BbbR , in three dimensions (see Figure 8). The particular values of
the boundary conditions (both Dirichlet and Neumann) and external loads are defined
such that (57) is the exact solution of the Stokes problem (1).

(a) 2D case. (b) 3D case.

10

Fig. 8. Convergence test: View of the manufactured solution (vectors/streamlines colored by
pressure field).

The numerical approximation is done using a family of uniform Cartesian meshes
obtained by dividing each direction of the unit square and cube into 2m parts, with
m = 3, 4, . . . , 9 in two dimensions and m = 3, 4, 5 in three dimensions. The obtained
results are displayed in Figures 9, 10, and 11.

Figure 9 shows the scaling of the condition number of the underlying linear sys-
tems as the mesh is refined. For the agFE spaces, the condition number scales as
expected in conventional FE methods for body-fitted meshes (i.e., the condition num-
ber is proportional to h - 2), which confirms the theoretical condition number bound
derived in section 6.5. The same behavior is observed in 2D and 3D cases. The lines
for the 3D case in Figure 9(b) have only two points, since we were able to estimate the
condition number only for two of the 3D meshes due to the large amount of memory
demanded by the condest function of MATLAB. The benefit of using cell aggregation
is clearly illustrated in Figure 9. The standard FE spaces without cell aggregation
lead to condition numbers that do not scale proportional to h - 2. Theoretically, the
condition number can be arbitrarily large without cell aggregation depending on how
cells are cut, which leads in practice to an erratic scaling of the condition number
that reaches large values, as shown by the red lines in Figure 9.

On the other hand, Figures 10 and 11 report the convergence of the H1 semi-
norm and L2 norm of the discretization error for the velocity field, and the L2 norm

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1570 S. BADIA, A. F. MARTIN, AND F. VERDUGO

Standard Aggregated

−3.0 −2.5 −2.0 −1.5 −1.0 −0.5
log10 (max(h))

0

5

10

15

20

25

30

35

40
lo

g 1
0

(c
o
n
d
e
s
t

(A
) )

slope -2

(a) 2D case.

−1.2 −1.1 −1.0 −0.9
log10 (max(h))

0

5

10

15

20

25

30

35

40

lo
g 1

0
(c
o
n
d
e
s
t

(A
) )

slope -2

(b) 3D case.

Fig. 9. Convergence test: Scaling of the condition number upon mesh refinement.

Standard Aggregated

1 2 3

log10
(
(DOF)1/d

)
−10

−9

−8

−7

−6

−5

−4

−3

−2

−1

lo
g 1

0

( |
u
h
−
u
| 1,
Ω

|u
| 1,
Ω

)

slope -2

(a) Velocity H1

semi-norm.

1 2 3

log10
(
(DOF)1/d

)
−10

−9

−8

−7

−6

−5

−4

−3

−2

−1

lo
g 1

0

( ‖
u
h
−
u
‖ Ω

‖u
‖ Ω

)

slope -3

(b) Velocity L2

norm.

1 2 3

log10
(
(DOF)1/d

)
−10

−9

−8

−7

−6

−5

−4

−3

−2

−1

lo
g 1

0

( ‖
p h
−

p
‖ Ω

‖p
‖ Ω

)

slope -2

(c) Pressure L2

norm.

Fig. 10. Convergence test: Convergence of the discretization error for the 2D case (d = 2).

of the discretization error for the pressure field for the 2D and 3D cases, respectively.
Since we consider second polynomial order for the velocities and first for the pressures,
the optimal convergence orders are third order of convergence for the velocity error
measured in the L2 norm, second order for the velocity error in the H1 seminorm,

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1571

Standard Aggregated

1.2 1.4 1.6 1.8 2.0

log10
(
(DOF)1/d

)

−6

−5

−4

−3

−2

−1

lo
g 1

0

( |
u
h
−
u
| 1,
Ω

|u
| 1,
Ω

)

slope -2

(a) Velocity H1

semi-norm.

1.2 1.4 1.6 1.8 2.0

log10
(
(DOF)1/d

)

−6

−5

−4

−3

−2

−1

lo
g 1

0

( ‖
u
h
−
u
‖ Ω

‖u
‖ Ω

)

slope -3

(b) Velocity L2

norm.

1.2 1.4 1.6 1.8 2.0

log10
(
(DOF)1/d

)

−6

−5

−4

−3

−2

−1

lo
g 1

0

( ‖
p h
−

p
‖ Ω

‖p
‖ Ω

)

slope -2

(c) Pressure L2

norm.

Fig. 11. Convergence test: Convergence of the discretization error for the 3D case (d = 3).

and second order for the pressure error in the L2 norm. The plots show that the
agFE spaces lead to these optimal FE convergence orders, which in turn confirms
the analysis of section 6.4. Note that the standard (unaggregated) FE spaces lead to
the optimal convergence orders in the 2D case (cf. Figure 10). However, it is clearly
not the case in three dimensions (cf. Figure 11). The underlying linear systems
are so ill-conditioned (reaching condition numbers up to 1035 as previously shown
in Figure 9) that in general one cannot rely on the results computed by the linear
solver using double precision floating point arithmetics. It can also be potentially
caused by Nitsche's method losing stability in those cases in which cut cells are too
thin, provided that the standard method selects the penalty of the Nitsche's method
globally, instead of cellwise definitions that rely on local eigenvalue solvers. We have
encountered some situations where the linear solver was indeed not able to provide an
accurate solution for the reasons commented above; see, e.g., the red line in Figure
11(c). We note that the discretization errors of the standard and aggregated methods
in Figures 10 and 11 are very close (for those cases in which the solver could provide a
meaningful solution for the standard case). In this study, the manufactured solution
is smooth, in particular on the boundaries. However, for flow problems with boundary
layers, even though the same convergence rate is expected, there can potentially be
an offset between the error plot of the standard and aggregate methods due to the
fact that the aggregates increase the characteristic size (also reducing the number of
DOFs) in the vicinity of the boundaries. In any case, h-adaptivity can naturally and
elegantly solve this issue, which will be the object of future research.

7.3. Moving domain experiment. In the second numerical experiment, we
study the robustness of the unfitted FE formulation with respect to the relative
position between the problem geometry and the background mesh. To this end,
we consider two geometries whose definition is parametrized by a scalar value \ell 
(cf. Figure 12). The 2D geometry is a circular cavity, with radius R = 0.225 and

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1572 S. BADIA, A. F. MARTIN, AND F. VERDUGO

(a) 2D case. (b) 3D case (internal view).

Fig. 12. Moving domain experiment: View of the problem geometries.

Standard Aggregated

0.3 0.4 0.5 0.6 0.7
`

0

10

20

30

40

lo
g 1

0
(c
o
n
d
e
s
t

(A
) )

(a) 2D case.

0.3 0.4 0.5 0.6 0.7
`

0

10

20

30

40

lo
g 1

0
(c
o
n
d
e
s
t

(A
) )

(b) 3D case.

Fig. 13. Moving domain experiment: Condition number versus domain position.

whose center is located at an arbitrary point on a diagonal of the unit square (cf.
Figure 12(a)). The 3D domain is again a cavity defined using the popcorn flake
geometry (cf. Figure 12(b)). In this case, we scale down the popcorn flake used in the
convergence test (cf. section 7.2) by a factor of 0.5 and place it at an arbitrary point
of the diagonal of the unit cube. In both cases, the position of the bodies is controlled
by the value of the parameter \ell (i.e., the distance between the center of the body
and a selected vertex of the square/cube). As the value of \ell varies, the objects move
and their relative position with respect to the background mesh changes. In this
process, arbitrary small cut cells can show up, leading to potential ill-conditioning
problems. In this experiment, we consider a background mesh that discretizes the
unit square/cube with 2m elements per direction, where m = 5 for the 2D case and
m = 4 for the 3D case.

Figure 13 shows the condition number estimate of the underlying linear systems
versus \ell . The plot is generated using a sample of 200 different values of \ell . It is
observed that the agFE spaces lead to condition numbers that are nearly independent
of the value of \ell , which shows that the agFEM is very robust regardless of how cells are
cut. The benefit of using aggregation is clearly demonstrated here by observing the

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1573

Inflow

Outflow
75.00.0 53.0 - 1.4

(a) Problem geometry. (b) Velocity (magnitude). (c) Pressure.

Fig. 14. Complex 3D examples: Problem geometry and numerical solution for the Stokes flow
around spherical obstacles (streamlines colored by velocity magnitude and pressure).

results associated to the standard FE spaces. In that case, the condition numbers are
very sensitive to the position of the geometry and reach very high values (condition
number greater than 1035 in the 3D case).

7.4. Complex 3D examples. We conclude the numerical examples with the
simulation of two complex geometries in order to show that the cell aggregation can be
effectively used also in more complex settings. The first complex example is the sim-
ulation of a Stokes flow around a set of randomly spherical obstacles (see Figure 14).
The (fluid) domain is the set difference of the unit cube [0, 1]3 and the spherical
obstacles. We consider homogeneous Dirichlet conditions (no-slip conditions) in the
surfaces of the spherical obstacles using Nitsche's method. The inflow boundary is
the face x = 0 of the unit cube (see Figure 14(a)), where we impose a prescribed
polynomial inflow velocity profile with value:

\bfitu = (10y(y  - 1)z(z  - 1), 0, 0), (x, y, z) \in \Gamma \mathrm{i}\mathrm{n} = \{ 0\} \times [0, 1]2.

The outflow boundary is the face x = 1 of the unit cube, where we impose homoge-
neous Neumann boundary conditions. We impose homogeneous Dirichlet conditions
on the remaining faces of the cube. The problem is simulated using a background
Cartesian mesh defined on the cube with 25 elements per direction. The obtained nu-
merical solution is plotted in Figures 14(b) and 14(c). Note that the approximation of
the velocities clearly conforms to the unfitted surfaces even though the interpolation
is slightly coarsened near these surfaces by the cell aggregation.

The second complex example is a Stokes flow inside a spiral pipe (see Figure 15).
The radius of the tubular cross section of the pipe is 0.1, whereas the radius of the
spiral central axis is 0.875. We impose homogeneous Dirichlet conditions on the walls
of the spiral. The inflow boundary is one of the two terminal cross sections of the
pipe, i.e., the disk of center C = (0, 0.875, 0.86) and radius R = 0.1 (see Figure 15(a)).
On the inflow boundary we impose a parabolic velocity profile with value

\bfitu =

\biggl( 
10 - 10

r2

R2
, 0, 0

\biggr) 
,

where r \in [0, R] is the distance between a point x in the inflow boundary and the
center C. Homogeneous Neumann boundary conditions are considered on the outflow

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1574 S. BADIA, A. F. MARTIN, AND F. VERDUGO

Inflow

Outflow
1001.8 2.8 \cdot 104 - 2.8 \cdot 10 - 5

(a) Problem geometry. (b) Velocity (magnitude). (c) Pressure.

Fig. 15. Complex 3D examples: Problem geometry and numerical solution for the Stokes flow
in a spiral pipe (streamlines colored by velocity magnitude and pressure).

boundary. Like in the previous example, the problem is simulated using a uniform
Cartesian mesh of the unit cube with 25 elements at each direction. The results are
shown in Figures 15(b) and 15(c). Note that even though it is a very challenging
example for the cell-aggregation strategy because the surface to volume ratio is very
high, the computed results reproduce a perfectly laminar velocity field that flows
smoothly through the spiral pipe.

8. Conclusions. In this work, we have developed mixed agFEMs for the approx-
imation of the Stokes problem on unfitted meshes. We have considered the standard
extension operator for the definition of agFE spaces and a new one that relies on the
extension of the serendipity component only (for hex meshes). A cell aggregation
algorithm allows one to start with an FE mesh and create an aggregate partition with
some desired properties. The agFE space is readily computed from a typical FE space
plus simple cellwise constraints.

For the sake of conciseness, we have considered as a starting point mixed FE
methods on body-fitted meshes with discontinuous pressure spaces on hexahedral
meshes, considering both the standard and serendipity extension for the velocity field.
We have performed an abstract stability analysis that relies on a set of assumptions,
in order to prove a weak inf-sup condition for mixed agFE spaces. Such analysis shows
the potential deficiency of the unfitted discrete inf-sup for such spaces. It allows us
to identify a subset of aggregates/facets (close to the boundary), coined improper
aggregates/facets; these subsets depend on the mixed agFE space being used.

Based on the abstract stability analysis, we have defined two different algorithms
that satisfy the required assumption for having stability. The first algorithm relies on
a standard velocity extension plus interior (residual-based) stabilization in improper
aggregates and pressure jump stabilization on improper facets. The second algorithm
relies on the serendipity extension for the velocity field components and pressure jump
stabilization on improper facets. For these algorithms, a complete numerical analysis
proves stability, a priori error estimates, and condition number bounds that are not
affected by the small cut cell problem.

A complete set of numerical experiments bears out the numerical analysis. Finally,
the mixed agFEM is applied to two problems with nontrivial geometries, viz., free flow
in a medium with inclusions and confined flow in a spiral.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

MIXED AGGREGATED FINITE ELEMENT METHODS B1575

Acknowledgments. The authors want to thank the anonymous referees for their
thorough revision of a previous version of this manuscript. Their suggestions and com-
ments have substantially improved the paper. The authors thankfully acknowledge
the computer resources at Marenostrum-IV and the technical support provided by
the Barcelona Supercomputing Center (RES-ActivityID: FI-2018-1-0014).

REFERENCES

[1] N. Sukumar, N. Mo\"es, B. Moran, and T. Belytschko, Extended finite element method
for three-dimensional crack modelling, Internat. J. Numer. Methods Engrg., 48 (2000), pp.
1549--1570.

[2] S. Badia, F. Nobile, and C. Vergara, Fluidstructure partitioned procedures based on Robin
transmission conditions, J. Comput. Phys., 227 (2008), pp. 7027--7051.

[3] H. Sauerland and T.-P. Fries, The extended finite element method for two-phase and free-
surface flows: A systematic study, J. Comput. Phys., 230 (2011), pp. 3369--3390.

[4] E. Burman, D. Elfverson, P. Hansbo, M. Larson, and K. Larsson, Shape optimization
using the cut finite element method, Comput. Methods Appl. Mech. Engrg., 328 (2018), pp.
242--261.

[5] M. Chiumenti, E. Neiva, E. Salsi, M. Cervera, S. Badia, J. Moya, Z. Chen, C. Lee, and
C. Davies, Numerical modelling and experimental validation in selective laser melting, Additive
Manufacturing, 18 (2017), pp. 171--185.

[6] C. Lang, A. Sharma, A. Doostan, and K. Maute, Heaviside enriched extended stochastic
FEM for problems with uncertain material interfaces, Comput. Mech., 56 (2015), pp. 753--767.

[7] T. Belytschko, N. Mos, S. Usui, and C. Parimi, Arbitrary discontinuities in finite elements,
Internat. J. Numer. Methods Engrg., 50 (2001), pp. 993--1013.

[8] E. Burman, S. Claus, P. Hansbo, M. G. Larson, and A. Massing, CutFEM: Discretizing
geometry and partial differential equations, Internat. J. Numer. Methods Engrg., 104 (2015),
pp. 472--501.

[9] D. Schillinger and M. Ruess, The finite cell method: A review in the context of higher-order
structural analysis of CAD and image-based geometric models, Arch. Comput. Methods Engrg.,
22 (2014), pp. 391--455.

[10] J. Parvizian, A. Dster, and E. Rank, Finite cell method: h- and p-extension for embedded
domain problems in solid mechanics, Comput. Mech., 41 (2007), pp. 121--133.

[11] A. D\"uster, J. Parvizian, Z. Yang, and E. Rank, The finite cell method for three-dimensional
problems of solid mechanics, Comput. Methods Appl. Mech. Engrg., 197 (2008), pp. 3768--3782.

[12] F. de Prenter, C. V. Verhoosel, G. J. van Zwieten, and E. H. van Brummelen, Condition
number analysis and preconditioning of the finite cell method, Comput. Methods Appl. Mech.
Engrg., 316 (2017), pp. 297--327.

[13] M. Dauge, A. D\"uster, and E. Rank, Theoretical and numerical investigation of the finite cell
method, J. Sci. Comput., 65 (2015), pp. 1039--1064.

[14] S. Badia and F. Verdugo, Robust and scalable domain decomposition solvers for unfitted finite
element methods, J. Comput. Appl. Math., 344 (2018), pp. 740--759.

[15] S. Badia, F. Verdugo, and A. F. Martin, The aggregated unfitted finite element method for
elliptic problems, Comput. Methods Appl. Mech. Engrg., 336 (2018), pp. 533--553.

[16] S. Badia, A. F. Martn, and J. Principe, FEMPAR: An object-oriented parallel finite element
framework, Arch. Comput. Methods Engrg., 25 (2018), pp. 195--271.

[17] FEMPAR, http://www.fempar.org/.
[18] E. Burman and P. Hansbo, Fictitious domain finite element methods using cut elements: II.

A stabilized Nitsche method, Appl. Numer. Math., 62 (2012), pp. 328--341.
[19] E. Burman, Ghost penalty, C. R. Math., 348 (2010), pp. 1217--1220.
[20] J. Preuss, Higher Order Unfitted Isoparametric Space-Time FEM on Moving Domains,

Master's thesis, University of Gottingen, 2018.
[21] C. Lehrenfeld and M. Olshanskii, An Eulerian Finite Element Method for PDEs in Time-

Dependent Domains, arXiv:1803.01779, 2018.
[22] K. H\"ollig, U. Reif, and J. Wipper, Weighted extended B-spline approximation of Dirichlet

problems, SIAM J. Numer. Anal., 39 (2001), pp. 442--462.
[23] T. R\"uberg and F. Cirak, Subdivision-stabilised immersed b-spline finite elements for moving

boundary flows, Comput. Methods Appl. Mech. Engrg., 209 (2012), pp. 266--283.
[24] T. R\"uberg and F. Cirak, A fixed-grid b-spline finite element technique for fluidstructure

interaction, Internat. J. Numer. Methods Fluids, 74 (2014), pp. 623--660.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp

http://www.fempar.org/
https://arxiv.org/abs/1803.01779


 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

B1576 S. BADIA, A. F. MARTIN, AND F. VERDUGO

[25] C. Helzel, M. Berger, and R. Leveque, A high-resolution rotated grid method for conserva-
tion laws with embedded geometries, SIAM J. Sci. Comput., 26 (2005), pp. 785--809.

[26] A. Johansson and M. G. Larson, A high order discontinuous Galerkin Nitsche method for
elliptic problems with fictitious boundary, Numer. Math., 123 (2013), pp. 607--628.

[27] F. Kummer, Extended discontinuous Galerkin methods for multiphase flows: The spatial dis-
cretization, in Center for Turbulence Research Annual Research Briefs, 2013, pp. 319--333.

[28] E. Burman and P. Hansbo, Fictitious domain methods using cut elements: III. A stabi-
lized Nitsche method for Stokes' problem, ESAIM Math. Model. Numer. Anal., 48 (2014), pp.
859--874.

[29] P. Hansbo, M. G. Larson, and S. Zahedi, A cut finite element method for a \{ Stokes\} interface
problem, Appl. Numer. Math., 85 (2014), pp. 90--114.

[30] L. Cattaneo, L. Formaggia, G. F. Iori, A. Scotti, and P. Zunino, Stabilized extended finite
elements for the approximation of saddle point problems with unfitted interfaces, Calcolo, 52
(2015), pp. 123--152.

[31] J. Guzm\'an and M. Olshanskii, Inf-sup stability of geometrically unfitted Stokes finite elements,
Math. Comp., 87 (2018), pp. 2091--2112.

[32] A. Massing, M. G. Larson, A. Logg, and M. E. Rognes, A stabilized Nitsche fictitious
domain method for the Stokes problem, J. Sci. Comput., 61 (2014), pp. 604--628.

[33] C. Burstedde, L. C. Wilcox, and O. Ghattas, p4est: Scalable algorithms for parallel adap-
tive mesh refinement on forests of octrees, SIAM J. Sci. Comput., 33 (2011), pp. 1103--1133.

[34] H. Brezis, Functional Analysis, Sobolev Spaces and Partial Differential Equations, Springer,
New York, 2010.

[35] A. Ern and J.-L. Guermond, Theory and Practice of Finite Elements, Springer, New York,
2004.

[36] D. N. Arnold and G. Awanou, The serendipity family of finite elements, Found. Comput.
Math., 11 (2011), pp. 337--344.

[37] D. N. Arnold, D. Boffi, and R. S. Falk, Approximation by quadrilateral finite elements,
Math. Comp., 71 (2002), pp. 909--922.

[38] S. C. Brenner and R. Scott, The Mathematical Theory of Finite Element Methods, Springer,
New York, 2010.

[39] A. Johansson and M. G. Larson, A high order discontinuous Galerkin Nitsche method for
elliptic problems with fictitious boundary, Numer. Math., 123 (2013), pp. 607--628.

[40] A. Hansbo and P. Hansbo, An unfitted finite element method, based on Nitsche's method, for
elliptic interface problems, Comput. Methods Appl. Mech. Engrg., 191 (2002), pp. 5537--5552.

[41] H. Wu and Y. Xiao, An Unfitted hp-Interface Penalty Finite Element Method for Elliptic
Interface Problems, arXiv:1007.2893, 2010.

[42] L. R. Scott and S. Zhang, Finite element interpolation of nonsmooth functions satisfying
boundary conditions, Math. Comp., 54 (1990), pp. 483--493.

[43] R. Becker, Mesh adaptation for Dirichlet flow control via Nitsche's method, Commun. Numer.
Methods Engrg., 18 (2002), pp. 669--680.

[44] J. Nitsche, \"Uber ein Variationsprinzip zur L\"osung von Dirichlet-Problemen bei Verwendung
von Teilr\"aumen, die keinen Randbedingungen unterworfen sind, Abh. Math. Semin. Univer.
Hamb., 36 (1971), pp. 9--15.

[45] C. Bernardi, M. Costabel, M. Dauge, and V. Girault, Continuity properties of the inf-sup
constant for the divergence, SIAM J. Math. Anal., 48 (2016), pp. 1250--1271.

[46] H. C. Elman, D. J. Silvester, and A. J. Wathen, Finite Elements and Fast Iterative Solvers:
With Applications in Incompressible Fluid Dynamics, Oxford University Press, New York, 2005.

[47] Intel MKL PARDISO--Parallel Direct Sparse Solver Interface, https://software.intel.com/en-us/
articles/intel-mkl-pardiso.

[48] QHULL, http://www.qhull.org/.
[49] C. B. Barber, D. P. Dobkin, and H. Huhdanpaa, The Quickhull algorithm for convex hulls,

ACM Trans. Math. Software, 22 (1996), pp. 469--483.

D
ow

nl
oa

de
d 

01
/0

8/
19

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp

https://arxiv.org/abs/1007.2893
https://software.intel.com/en-us/articles/intel-mkl-pardiso
https://software.intel.com/en-us/articles/intel-mkl-pardiso
http://www.qhull.org/

	Introduction
	Problem statement
	FE spaces
	Aggregated finite element spaces
	Embedded boundary setup and cell aggregation
	Aggregated finite element spaces
	Nodal Lagrangian aggregated finite element spaces
	Discontinuous aggregated finite element spaces
	Aggregated finite elements with serendipity extension

	Mathematical properties

	Approximation of the Stokes problem
	Numerical analysis
	An abstract stability analysis
	Mixed agFEM and pressure stabilization
	Mixed agFEM with serendipity extension
	A priori error estimates
	Condition number bounds

	Numerical experiments
	Setup
	Convergence test
	Moving domain experiment
	Complex 3D examples

	Conclusions

