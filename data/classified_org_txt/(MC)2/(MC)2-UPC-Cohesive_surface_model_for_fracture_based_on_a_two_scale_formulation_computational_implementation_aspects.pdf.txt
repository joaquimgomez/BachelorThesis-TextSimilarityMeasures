


























































Cohesive surface model for fracture based on a two-scale
formulation: computational implementation aspects

S. Toro1,2, P.J. Sánchez1,2, J.M. Podestá1, P.J. Blanco3,4,
A.E. Huespe1,5, R.A. Feijóo3,4

1CIMEC-UNL-CONICET, Güemes 3450, CP 3000 Santa Fe, Argentina
2GIMNI-UTN-FRSF, Lavaise 610, CP 3000 Santa Fe, Argentina

3LNCC/MCTI, Av. Getúlio Vargas 333, Petrópolis, RJ, CEP: 25651-075, Brasil
4INCT-MACC, Instituto Nacional de Ciência e Tecnologia em Medicina Assistida por Computação

Cientı́fica, Brasil
5Centre Internacional de Metodes Numerics en Enyinyeria (CIMNE),Campus Nord UPC,

Edifici C-1, J. Girona 1-3, 08034 Barcelona, Spain

Keywords: multi-scale cohesive models, computational homogenization, heterogeneous material failure, Embedded

Finite Elements (EFEM).

Abstract

The paper describes the computational aspects and numerical implementation of a two-scale cohesive
surface methodology developed for analyzing fracture in heterogeneous materials with complex micro-
structures. This approach can be categorized as a semi-concurrent model using the Representative Vol-
ume Element (RVE) concept.

A variational multi-scale formulation of the methodology has been previously presented by the
authors. Subsequently, the formulation has been generalized and improved in two aspects: i) cohesive
surfaces have been introduced at both scales of analysis, they are modeled with a strong discontinuity
kinematics (new equations describing the insertion of the macro-scale strains, into the micro-scale and
the posterior homogenization procedure have been considered); ii) the computational procedure and
numerical implementation have been adapted for this formulation. The first point has been presented
elsewhere, and it is summarized here. Instead, the main objective of this paper is to address a rather
detailed presentation of the second point.

Finite element techniques for modeling cohesive surfaces at both scales of analysis (FE2 approach)
are described: i) finite elements with embedded strong discontinuities (EFEM) are used for the macro-
scale simulation, and ii) continuum-type finite elements with high aspect ratios, mimicking cohesive
surfaces, are adopted for simulating the failure mechanisms at the micro-scale.

The methodology is validated through numerical simulation of a quasi-brittle concrete fracture prob-
lem. The proposed multi-scale model is capable of unveiling the mechanisms that lead from the material
degradation phenomenon at the meso-structural level to the activation and propagation of cohesive sur-
faces at the structural scale.

1

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



1 Introduction

1.1 Literature review

Cohesive Surface Models (CSM) have proven to be a useful conceptual tool for analyzing material
fracture. This approach consists in introducing a surface with two interfaces into the continuum. A
relative displacement, or displacement jump, is modeled between both interfaces, while cohesive
tractions on the same interfaces react by opposing to their opening. As the interfaces are opened,
the cohesive forces decrease, tending to zero, which finally yields a new traction-free crack into the
continuum. So, the generation of a new traction-free crack demands energy from the mechanical
system.

CSM are appropriate to describe the nonlinear dissipative effects observed at small length
scales, specifically into the fracture process zone of a propagating crack. The modeling of these
effects requires an adequate characterization of the traction-displacement jump law governing the
cohesive surface evolution. Implicitly, this characterization also involves the amount of energy
demanded to the mechanical system to generate a new traction-free crack into the solid. So, the
selection of the traction-displacement jump law turns out to be the foremost issue for modeling
cohesive surfaces.

CSM have been firstly introduced in fracture mechanics by Dugdale [1] and Barenblatt [2]. In
computational mechanics, they were introduced by Needleman and co-workers (Needleman [3],
Xu and Needleman [4], see also references cited in Needleman [5]). After them, CSM have gained
a wide acceptance for several reasons. First, its numerical implementation is simple and efficient.
But, mainly, CSM has become popular due to the wide range of problems and applications for
which they provide useful solutions. Typical examples of CSM applied to dynamics fracture
simulations are shown in Falk et al. [6], Xu and Needleman [7] and Pandolfi et al. [8]. In ductile
fracture analysis, CSM have been utilized by Hutchinson and Evans [9], Tvergaard [10], Siegmund
and Brocks [11], Huespe et al. [12], Huespe et al. [13]. Furthermore, and from the pioneering
works of Hillerborg [14], Bažant [15] and Elices et al. [16], CSM models have been widely applied
to the field of quasi-brittle materials for modeling concrete fracture problems.

According to the aim of the present work, some features, assumptions and limitations of clas-
sical CSM, mainly those related to the traction-separation law description, are summarized and
remarked:

i) Usually, for modeling quasi-brittle fracture, the constitutive law relating tractions to dis-
placement jumps across the cohesive surface is proposed independently of the continuum
constitutive relation characterizing the bulk material (exceptions to this approach have been
proposed in [17], [18] and references cited therein). Two key parameters govern the re-
sponse of the cohesive forces: the fracture energy and the peak stress. In practical appli-
cations, they are estimated from experiments. However, both parameters depend on phe-
nomena occurring at smaller length scales. Typically, a composite could display noticeable
differences of the overall fracture energy by changing its micro-structure topology. Topol-
ogy changes could happen during the loading process, due to material degradation itself.
In this case, the experimental determination of parameters governing the traction-separation
law, is not free of controversy. So, an alternative approach for assessing the overall frac-
ture energy consists in modeling the material degradation processes at small length scales,

2

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



where the fracture energy of every compound can be accurately characterized, simultane-
ously with the crack propagation problem at the structural level. Then, by using a specific
homogenization technique, the overall fracture energy can be estimated in an unified frame-
work of analysis.

ii) Ductile fracture analysis using CSM has also been widely addressed in the literature. How-
ever, in this case, and contrarily to the quasi-brittle fracture approaches, the parameters de-
termining the traction-separation law depend more markedly on the loading path. Typically,
separation work in ductile fracture, as well as the peak stress, is enormously influenced by
the stress triaxiality (see Tvergaard and Hutchinson [19]). A viable technique to deal with
these complex phenomena is the use of multi-scale models, adopting cohesive forces on the
interfaces and determining the traction-separation law through a micro-structural analysis.
Several works have followed this approach, such as Siegmund and Brocks [11]. However,
most of them consider a multi-scale technique where the transference of information be-
tween scales flows only in one direction, from the smaller length scale to the larger one
(hierarchical model). This kind of hierarchical approach may be questionable when the
cohesive forces depend strongly on macro-scale variables that change during the structural
loading history.

Within the class of multi-scale procedures for modeling ductile fracture, it is suitable to
mention the works of Xia and Shih [20] and Vernerey et al. [21]. In both cases, even when
the fracture process zone at the macro-scale is not approached through CSM, the effects
induced by the micro-structure during the failure process are taken into account. In the work
of Xia and Shih, the micro-structure is explicitly embedded into the macro-model, while,
in the work of Vernerey et al., the micro-structure degradation mechanisms are modeled
by increasing the kinematical descriptors at the macro-scale using the micromorphic theory
framework. Both approaches result highly motivating techniques for developing the model
described in this paper.

Determining the overall constitutive relation of micro-structured materials undergoing frac-
ture, via multi-scale procedures, involves meaningful theoretical challenges. In a previous work
of the authors, see Sánchez et al. [22], it has been shown that once the macro-scale material re-
sponse loses the strong ellipticity condition, the conventional homogenization procedure (volume
average), evaluated with the use of an RVE, becomes an ill-posed problem, see also Gitman et al.
[23] and Nguyen et al. [24]. Contrarily to what happens during the macro-scale stable pre-critical
regime, multi-scale problems involving strain localization demand the use of general and original
formulations based on non-conventional homogenization paradigms. In last years, this problem
has been the motive of intense study. Several authors have contributed with new ideas and the-
oretical or numerical models. To cite only a few of them, we reference the following works:
Belytschko et al. [25], Belytschko and Song [26], Geers et al. [27], Bosco et al. [28], Nguyen et al.
[29], Verhoosel et al. [30] Oliver et al. [31], Kulkarni et al. [32] and references cited therein.

1.2 CSM from a novel RVE-based multi-scale framework

Blanco and co-workers [33] have presented a variationally consistent RVE-based unified theory
established on the following axioms: (i) kinematic admissibility, (ii) mathematical duality and

3

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



(iii) virtual power principle. They have coined the name Method of Multi-scale Virtual Power
(MMVP) for identifying this theory. In the MMVP, the physics between the involved length scales
are linked by postulating the so-called Principle of Multi-scale Virtual Power (PMVP), which is a
generalization of the Hill-Mandel statement of macro-homogeneity [34, 35]. By using the MMVP,
the homogenization formulas for stress-like quantities, the establishment of the precise boundary
conditions imposed to the RVE mechanical model and the micro-scale equilibrium problem, are
unambiguously derived as consequences of the variational formulation, in contrast with alternative
approaches where they are a-priori assumed.

The general framework proposed in [33] encompasses a wide spectrum of multi-scale mod-
eling scenarios, ranging from conventional constitutive-inspired multi-scale theories (see [36, 37,
38, 39]) to more sophisticated and novel approaches, as for example: multi-scale techniques link-
ing high order macro-scale description with standard (first order) micro-scale kinematics [40],
thermo-mechanical models (see [41]), multi-scale formulations accounting for inertia and body
forces effects (see [42]), etc.

The MMVP can additionally be used as the underlying theory to derive multi-scale models
for material failure based on CSM, where the traction-separation law characterizing the macro-
scale cohesive interface is obtained by homogenization of micro-scale degradation mechanisms.
For example, in Sánchez et al. [22] and Toro et al. [43], a semi-concurrent two-scale approach
for material failure analysis has been proposed. The failure phenomena at the micro-scale are
represented by the existence of strain localization bands, modeled with a smeared crack technique.

Also, based on the MMVP concept, Toro et al. [44] have subsequently generalized and im-
proved the methodology proposed in [22] and [43] by introducing cohesive surfaces at both scales
of analysis. New equations for transferring information between scales (scale-bridging equations)
have been developed and presented. As a further development of the two-scale formulation de-
scribed in Toro et al. [44], a detailed finite element implementation is described in this article
to shed light on the following issues: (i) numerical treatment given to CSM at macro and micro
scales, including EFEM finite element technique and crack path tracking algorithm, (ii) detailed
procedure to evaluate the homogenization formulae for the macro-scale stresses and cohesive trac-
tions, (iii) implementation of the kinematical restrictions on the RVE model, (iv) implementation
of the equilibrium problems at both scales of analysis. The computational tool obtained with this
procedure results efficient for simulating a wide range of failure phenomena in heterogeneous
materials. This subject represents the main contribution of the present work.

The remaining of the paper is structured as follows: in Section 2, we give a brief theoretical
description of the methodology formulated in Toro et al. [44]. The main contribution of the present
paper is introduced in Section 3, where a detailed description of the finite element models used
at both scales, macro and micro, is shown. An embedded strong discontinuity finite element
technique (EFEM) is proposed to simulate the cohesive surfaces at the macro-scale. Furthermore,
a detailed description of the fracture model at micro-scale is also presented in the same Section.
The numerical assessment of the model is presented in Section 4. Sensitivity analysis of the
macro-scale response with respect to: i) mesoscopic cell size and ii) finite element mesh size of
a given specific cell, are shown and discussed. Finally, a structural fracture problem is modeled
with an heterogeneous quasi-brittle material. Last Section of the paper is devoted to discuss some
conclusions.

4

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



2 Description of the multi-scale mechanical formulation

According with the objectives pursued in this contribution, a brief overview of the multi-scale
mechanical formulation is shown in this Section, which provides the necessary background for
describing the computational implementation in the remaining part of the paper. The full model
formulation has been described in Toro et al. [44]. Thus, the readers are addressed to that work
for obtaining further details of the formulation, as well as to [33] for consulting specific aspects of
the MMVP theory.

Notation used in this work. Objects intervening in the model are identified as follows (see Figure
1):

RVE
(micro-scale)

Macro-scale

u(x)
e(x)
s(x)

u (y)

e (y)

s (y)

m

m

m

y
x

W

Wm

Tm
bm

Sm

T
b

S

Figure 1: Notation adopted in this work at the macro and micro-scale levels.

i) The domain of the body at the macro-scale is denotedΩ. Points in this domain are identified
with x. Macro-scale fields, in Ω, are: displacements u(x), strains ε(x), stresses σ(x), and
considering the macro-scale cohesive surface S, displacement jump and traction across the
interfaces are denoted β and T , respectively.

ii) Each point x at the macro-scale is linked to an RVE whose domain is denoted Ωµ. Points
in Ωµ are identified with y. Micro-scale fields are distinguished with subscript (·)µ, and are
understood as different objects to those defined at the macro-scale in the previous item, i.e.
micro-scale displacements, uµ, micro-scale strains, εµ, micro-scale stresses, σµ, displace-
ment jumps across micro-scale cracks βµ, tractions across micro-scale cohesive cracks Tµ,
and so on. All micro-scale fields depend on y and x.

iii) Each micro-scale kinematic field has a fluctuating component denoted with a tilde: (̃·)µ.

iv) The kinematics at both scales are presented in incremental form. Then, infinitesimal in-
crement of variables are identified with the symbol d(·). Kinematically admissible virtual
actions are denoted with the symbol (̂·).

The structural loading history changes according to a monotonous increase of the pseudo-time
coordinate t. Then, this pseudo-time is adopted as the parameter indicating the sequence of events
taking place in the mechanical problem.

5

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



2.1 Macro-scale model with cohesive surfaces

Let us consider the domain Ω of a body displaying an evolving cohesive surface denoted S whose
orthogonal unit vector is n, as shown in Figure 2-a. The surface S shows a relative displacement
between both interfaces, also called displacement jump vector, denoted β, and cohesive tractions
T acting on them.

The cohesive surface S is nucleated at the macro-scale when the material instability condition
is detected at a certain pseudo-time instant (t = tN ). The criterion defining tN is presented in
sub-Section 3.1.1.

The surface S divides Ω in two disjoint sets: Ω+ and Ω−. On the boundary Γ of Ω, there are
imposed tractions te, on Γt, and displacements uD, on ΓD, being: Γ = Γt ∪ ΓD, see Figure 2-a.
We also consider an arbitrarily small domain Ωϕ ⊂ Ω and S ⊂ Ωϕ. Then, Ωϕ is also divided by
S in two disjoint sets: Ωϕ+ and Ω

ϕ
−.

Following to Simo et al. [45], the displacement increment du at the macro-scale is described
by:

du = dū+ M dβ, (1)

where dū represents the increments of the continuous displacement components in Ω. The incre-
ment of the displacement jump across S is dβ and M is the unit jump function (with compact
support) defined as follows:

x

D

t e

u

+

-

+

-

S

n

(a)

x

(c)

xR

S

Wx x
[ [

j

+-

S

x
[ [

x
[ [

1

(b)

1

n

Interfaces

b
n

T
T

j j

S

S

W W

W

W

W

W

Wj

j

j

G

tG

S

Cohesive
surface

D

-W W+

Figure 2: Macro-scale model: (a) cohesive surface at the macro-scale and its mechanical representation; (b) Con-
tinuous function ϕ, Heaviside step function H and unit jump function M ; (c) regular and singular points at the
macro-scale.

M := H − ϕ, (2)

H =

{
0 ∀x ∈ Ω−
1 ∀x ∈ Ω+

, ϕ =

{
0 ∀x ∈ Ω−\Ω

ϕ
−

1 ∀x ∈ Ω+\Ω
ϕ
+

, (3)

with H being the Heaviside step function shifted to S, and ϕ satisfies (3), but otherwise it is an
arbitrary sufficiently smooth function, see Figure 2-b.

6

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



According to equation (1), and following a previous work of the authors [44], it is assumed the
existence of a generalized strain increment dε in Ω. This strain increment is derived by applying
a generalized gradient to the displacement field in equation (1) (see for example [45]). Operating
in this way, dε is given as follows:

dε = ∇sxdū︸ ︷︷ ︸
dεū

+ M∇sxdβ −∇
s
xϕ⊗

s dβ︸ ︷︷ ︸
dεβ

+δS(dβ ⊗s n) = dεū + dεβ + δS(dβ ⊗s n), (4)

where it is assumed that dβ has compact support in Ωϕ, the symbol ⊗s represents the symmetric
tensor product, and the Dirac delta function shifted to S is denoted δS (δS has units of length−1).

Remark: the last term in (4) introduces a strain singularity in S. Therefore, it is distinguished
between: a) regular points, denoted xR (xR ∈ Ω\S), from now on called the bulk material and
where strains can be conventionally defined, and b) singular points denoted xS (xS ∈ S), as
shown in Figure 2-c.

The regular terms in (4) are identified with the strain increment dεR in the bulk material:

dεR = dεū(dū) + dεβ(dβ) , ∀ xR ∈ Ω\S. (5)

The partition of the strain increment dεR in two terms, dεū and dεβ as shown in equations (4) and
(5), evidences the fact that dεū only depends on dū, while dεβ only depends on dβ. Note that
dεR in the present kinematical description, even though it is defined in regular points, depends on
dβ due to the compact support of the function M , see (2).

From (4), we also identify the singular strain increment quantity dεS in S as follows:

dεS = dεū + dεβ + δS(dβ ⊗s n) , ∀ xS ∈ S. (6)

This generalized strain is implicitly represented by the triad of kinematical descriptors {dεū, dεβ, dβ}.
From now on, we describe dεS by this implicit representation.

The balance momentum equation in Ω can be written in a variational format as follows: find
(ū,β) ∈ U such that:∫

Ω\S
σ · ε̂R dΩ +

∫
S
T · β̂ dS −

∫
Γt

te · ˆ̄u dΓ = 0 ; ∀ (ˆ̄u, β̂) ∈ V , (7)

where U is the set of kinematically admissible descriptors and V the space of kinematically
admissible virtual actions given as follows:

U :=

{
(ū,β) ; ū ∈H1(Ω) , β ∈H1(Ωϕ) and ū|ΓD = uD

}
,

V :=

{
(ˆ̄u, β̂) ; ˆ̄u ∈H1(Ω) , β̂ ∈H1(Ωϕ) and ˆ̄u|ΓD = 0

}
.

(8)

7

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



2.1.1 Multi-scale evaluation of stresses and tractions

In equation (7), stresses σ at regular points, xR, and tractions T at singular points, xS , are
evaluated using specific non-standard homogenization procedures gathering information from the
micro-scale. These homogenization procedures are rationally justified within the framework of
the MMVP theory ([33] and [44]). Each of them is typified as follows:

i) MMRp (Multi-scale constitutive Model at Regular points): this homogenization procedure
defines the overall bulk material response, σ, at xR;

ii) MMSp (Multi-scale constitutive Model at Singular points): this homogenization procedure
defines the overall traction-separation response, T ,at xS .

Figure 3 sketches the big picture of the homogenization procedure inΩ, identifying the MMRp and
MMSp procedures and the macro-scale points where each of them is utilized. Every macro-scale
point has its own RVE. Incremental strains and generalized incremental strains are inserted from
the macro-scale to the micro-scale, while stresses and tractions are obtained from the micro-scale,
by applying homogenization techniques. The process of inserting strains and retrieving general-
ized stresses is governed by a set of scale bridging equations which are defined and described in
detail in sub-Section 2.3.

s

x

Macro-scale

W

T

T

x

S

R

n

S

RVE

m

MMRp

Strain insertion

MMSp

 Generalized
strain insertion

RVE

my yW W

R deS
de

Figure 3: Multi-scale model for fracture: (a) the MMRp homogenization procedure evaluates the overall material
response, σ, at regular points xR; (b) the MMSp homogenization procedure evaluates the overall material response, T ,
on the cohesive surface, at points xS .

2.2 Micro-scale model with cohesive surfaces

The kinematical description at the RVE is similar to that utilized at the macro-scale. So, the
failure mechanism is described by means of cohesive surfaces which are nucleated as the structural
loading increases.

Let us consider the RVE domain Ωµ displaying nc cohesive surfaces nucleated at the micro-
scale during the loading process. The i-th cohesive surface is denoted Siµ, and its normal vector is
niµ, see Figure 4-a. The cohesive surface Siµ divides Ωµ in two disjoint domains, Ωiµ+ and Ω

i
µ−,

with niµ pointing toward Ωµ+.

8

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



A micro-scale cohesive crack Siµ nucleates when the material bifurcation condition is satisfied
at a given point of the micro-scale, and previously to reaching the critical condition at the macro-
scale for crack nucleation at pseudo-time tNµ .

db

mdu

(b)

x
[ [

j

+

S

x
[ [

x
[ [

1

j j

S

S

W W

m
(c)

+m-

m-

W W

m

m

m

mm

m

m

m

m

1

Sm
i

i

i

i

m

i
m

i

i

i

xm

dum

n

RVE

(a)

y
0

Wm+
m

-mW

y

Sm
i

i

Wm-
j

Wm+
j

bm
i

xm

mW +

jWm- +
j

Wm

m-
W

i
i

i

i

Figure 4: Kinematics at the micro-scale accounting for material failure. (a) cohesive surface Siµ; (b) micro-scale
displacement fluctuation increment field, dũµ displaying a strong discontinuity across Siµ; (c) continuous function ϕiµ,
Heaviside function H iµ and unit jump function M

i
µ.

The micro-scale strain increment dεµ in Ωµ is:

dεµ = I(dε) + dε̃µ, (9)

where the first term corresponds to the macro-scale strain increment, dε, injected from x into
Ωµ, through the insertion operator I(·). The insertion operator I(·) distributes its argument into
the RVE domain. Both, I as well as its argument, changes according with the homogenization
procedure. The operator I is defined in next sub-Section 2.3 where it is labeled IR or IS according
to the MMRs or MMSp procedure, respectively.

The last term on the right hand side of (9) is the micro-scale strain fluctuation increment
defined as:

dε̃µ = ∇sydũµ, (10)

where dũµ is the micro-scale displacement fluctuation increment, whose description is discussed
in the following.

2.2.1 Treatment given to the micro-scale displacement fluctuation increment field

Similar to the strong discontinuity kinematics adopted at the macro-scale, described by equation
(1), the micro-scale displacement fluctuation increment, dũµ, is written as the addition of two
terms, see Figure 4-b:

9

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



dũµ = d ˜̄uµ +

nc∑
i=1

M iµ dβ̃
i
µ , (11)

where ˜̄uµ is the continuous component of the micro-scale displacement fluctuation, β̃iµ is the
displacement jump fluctuation across the interfaces of the i-th cohesive surface Siµ and M iµ is the
unit jump function. Both, β̃iµ and M

i
µ, are related to Siµ. In (11), we assume that the field dũµ

results from the addition of all the contributions of the nc cohesive surfaces which have nucleated
during the loading history. The function M iµ is defined as follows, see Figure 4-c:

M iµ := H
i
µ − ϕ

i
µ , (12)

H iµ =

{
0 ∀y ∈ Ωiµ−
1 ∀y ∈ Ωiµ+

, ϕiµ =

{
0 ∀y ∈ Ωiµ−\Ω

iϕ
µ −

1 ∀y ∈ Ωiµ+\Ω
iϕ
µ +

, (13)

where the Heaviside step function H iµ and the smooth function ϕ
i
µ are also related to the same

i-th cohesive crack. In this case, Ωiϕµ is a small domain around Siµ (with: Siµ ⊂ Ω
iϕ
µ ⊂ Ωµ), while

Ω
iϕ
µ + and Ω

iϕ
µ − are subdomains of Ω

iϕ
µ partitioned by Siµ, as shown in Figure 4-a.

According with (11), the micro-scale strain fluctuation increment, dε̃µ, is given by:

dε̃µ = dε̃µR +

nc∑
i=1

δSiµ(dβ̃
i
µ ⊗

s niµ) , ∀y ∈ Ωµ , (14)

where the first (regular) term on the right hand side is:

dε̃µR = ∇
s
yd ˜̄uµ +

nc∑
i=1

(
M iµ∇

s
ydβ̃

i
µ −∇

s
yϕ

i
µ ⊗

s dβ̃iµ

)
, (15)

and the second (singular) term is defined by the Dirac delta function δSiµ shifted to S
i
µ.

2.3 Scale-bridging equations

In the present sub-Section, the scale bridging equations of the multi-scale model presented in [44]
are summarized. The readers are addressed to that reference to find the full description of the
concepts supporting these equations.

The scale bridging equations are established from the following two axioms and the conse-
quences derived from them, see further details in [33]:

H1) Kinematical admissibility requirements connecting the kinematics at macro and micro-
scales. This hypothesis imposes the following constraints on the micro-scale strains:∫

Ω∗µ

dεµ dΩµ =

∫
Ω∗µ

I(dε) dΩµ . (16)

The insertion operator I, its arguments and the micro-scale domain Ω∗µ where identity (16)
is imposed, depend on the homogenization procedure, MMRp or MMSp (see equations (18),
(29) and (30) in the following paragraphs).

10

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



From equation (9), condition (16) enforces a null average of the micro-scale strain fluc-
tuation, dε̃µ, in Ω∗µ. This kinematical admissibility requirement is conventional in semi-
concurrent multi-scale models using a RVE (where Ω∗µ ≡ Ωµ, and I(dε) is the identity
operator). However, it has been generalized in [44] in order to develop a consistent homog-
enization model for the singular points xS .

H2) Identity, in a variational sense, of internal virtual power densities between both scales. This
hypothesis is the Principle of Multi-scale Virtual Power, according with [33], and is a gen-
eralized version of the Hill-Mandel Principle. Hypothesis (H2) has been specified in [44] to
include the presence of strong discontinuities at both scales of analysis.

As mentioned above, at the macro-scale level, the multi-scale model distinguishes between
regular points, xR, and singular points, xS . Different strain insertion procedures are defined in
those points (MMRp and MMSp). Then, hypotheses H1 and H2 should be specified in each case.

s

x

Macro-scale

W

Tb
T

x

S

R

n

T

S

Cohesive 
surface

RVE

Wm

nm

Nucleated 
cohesive surfaces
(i=1,..., n  )

(a)

i

RVE

Wm

Closing 
cracks

at t

nm

(b)

Lj

Sm
Lj

c

(k=1,...,n   )cl

MMSp

IS (de���,�de��,�db)u b

MMRp

IR (de���,�de��)u b

Sm
i

Set of opening cracs at t

(       ; j=1,...,n    )

N

m
L

op
jS

Gm
nm

Gm nm

N

t>tNt  tN£

Figure 5: Overview of the multi-scale model for fracture: (a) the MMRp homogenization procedure uses the insertion
operator IR which is defined in Box 1; (b) the MMSp homogenization procedure uses the insertion operator IS which
is defined in Box 2.

As a realistic assumption for modeling multi-scale material failure problems, it is considered
that during the macro-scale pre-bifurcation regime at a given point xR, there have been nucleated
nc micro-scale cohesive cracks inΩµ. These micro-cracks are denoted Siµ (with i = 1, ..., nc). The
number nc changes in the loading history because new cohesive cracks may sequentially nucleate
during t < tN .

However, when bifurcation at the macro-scale is detected, at t = tN , from the nc nucleated
micro-scale cohesive cracks in Ωµ, nop cracks are opening and ncl are closing or remain inactive
(nc = ncl + nop). S

Lj
µ (with j = 1, ..., nop) denotes the j-th opening crack, and SLµ is the set of

all the opening cracks (SLµ = ∪
nop
i=1S

i
µ). There are not new surfaces which can nucleate or re-open

during the subsequent loading history. So, the failure mode is defined by the set of the nop opening
surfaces at t = tN , and after that, it does not change anymore.

In order to apply the scale transition equations of the MMSp homogenization procedure, the
domain SLµ has to be precisely detected at t = tN . The algorithm to define SLµ is described in the
numerical implementation Section.

11

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Taking into account the previous concepts, it is defined a tortuosity factor θ, as follows:

θ(xS) =
|SLµ |∥∥∥( nop∑

j=1

∫
S
Lj
µ

n
Lj
µ dSµ

)∥∥∥
, |SLµ | =

nop∑
j=1

|SLjµ | , (17)

where |SLjµ | is the measure of the cohesive surface S
Lj
µ .

The parameter θ ∈ [1,∞) is interpreted as a geometrical factor measuring the tortuosity of
the micro-scale crack path of the failure mechanism at the RVE, at t = tN . It is introduced
to guarantee the kinematical consistency associated with the cracks opening at both scales of
analysis: the opening of the macro-crack S and the openings, in several directions, of the multiple
cracks simulated at the micro scale level. Note that θ = 1 if all the micro-scale cracks are parallel,
and it is larger than 1 if the micro-scale cracks follow a zig-zag path. A sensitivity analysis of the
macro-scale behavior with respect to θ has been presented in a previous work of the authors, see
Toro et al. [44]. In such contribution, a rigorous kinematical justification for including the θ-factor
in the multi-scale model has also been discussed.

The tortuosity parameter θ scales all terms involving the macro-scale displacement jump β
intervening in the scale transition procedure (see [44] for a purely kinematical justification of
(17)).

The scale bridging equations governing the multi-scale problem are summarized in Boxes 1
and 2. However, before discussing these equations, in Figure 6 we sketch, by means of three
blocks, the sequence of macro-scale kinematical, constitutive and variational equilibrium equa-
tions that govern a mechanical problem within the framework of the present multi-scale approach.
These three blocks are contained into a larger box identified as “Macro-scale Mechanical Prob-
lem”, that represents the iterative strategy (for example the Newton-Raphson scheme), for solving
the mechanical problem. This Figure also describes the information flow across the three blocks
and the corresponding equations which characterize each block. Specifically, the block represent-
ing the macro-scale constitutive model is divided in two sub-blocks according if the constitutive
model refers to a regular (xR) or a singular (xS) point, and therefore to the MMRp or MMSp
homogenization procedure. The RVE problems of both homogenization procedures are sketched
in detail in Figure 7, which follows a similar organization used in Figure 6.

The equations summarized in Boxes 1 and 2 are related to the sub-block “Macro-Scale Con-
stitutive Models” in Figure 6. They are explained in the next two items:

i) MMRp homogenization procedure to obtain σ in xR (see Box 1).
The regular macro-scale strain increment, dεR, is the data input of the multi-scale constitu-
tive relation described in Box 1. According to equation (5), dεR is given by the addition of
two components: dεū and dεβ .

The first block of equations (20)–(26) in Box 1, defines the micro-scale kinematics in Ωµ
and the functional spaces involved in the variational formulation of the micro-scale problem.

The strain increment dεµ, at the RVE, is given by equations (20)–(22) and is a particu-
larization of (9). The strain increment dεµ results from the addition of two terms: the
macro-scale strain increment dεR, inserted from the macro-scale into the RVE through the

12

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Ω Sdεū,dεβ dεū,dεβ ,dβ

MMRp Constitutive Model MMSp Constitutive Model

Strain insertion (see eq. (21))

I = IR(dεū, dεβ)
Strain insertion (see eq. (33))

I = IS(dεū, dεβ, dβ)

RVE Problem (see Fig. 7)
Boundary conditions

defined by eqs. (23) and (25)

RVE Problem (see Fig. 7)
Boundary conditions

defined by eqs. (35) and (37)

Stress homog. (see eq. (27))

σ = 1|Ωµ|
∫
Ωµ
σµ dΩµ

Traction homog. (see eq. (39))

T = θ|SLµ |

[∑nop
j=1

∫
S
Lj
µ
T
S
Lj
µ
dSµ

]

σ T

Macro-scale Constitutive Models

Macro-scale kinematics

dū,dβ
(see eqs. (1) and (4))

dεū dεβ dβ

Macro-scale equilibrium equations

∫
Ω\S σ · ε̂R dΩ +

∫
S T · β̂ dS −

∫
Γt
te · ˆ̄u dΓ = 0 ; ∀ (ˆ̄u, β̂) ∈ V

(see eqs. (7) and (8))

Macro-scale Mechanical Problem

x

xR

S

W

T

S

s

Figure 6: Data flow of the mechanical problem involving both scales of analysis: macro and micro.

13

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Ωµ S iµdεµ(I, dε̃µR) dεµ(I, dε̃µR,dβ̃iµ)

Continuum Constitutive Model Cohesive Model

Fenomenological law Fenomenological law (i.e. Box 3)

σµ TSiµ

Micro-scale Constitutive Models

Micro-scale kinematics

d ˜̄uµ,dβ̃iµ
See eqs. (11),(14) and (15)

dε̃µR dβ̃
i
µ

dε̃µ

dεµ = I + dε̃µ
For MMRp, see eqs. (20) and (21) with I = IR
For MMSp, see eqs. (32) and (33) with I = IS

Micro-scale equilibrium equations

∫
Ωµ
σµ · ε̂µR dΩµ +

∑nc
i=1

∫
Siµ
TSiµ · β̂

i
µ dSµ = 0 , ∀ (ˆ̄uµ, β̂1µ, . . . , β̂ncµ ) ∈ Vµ

Vµ = V
R
µ (for MMRp see eqs. (23), (25) and (28))

Vµ = V
S
µ (for MMSp see eqs. (35), (37) and (40))

RVE Mechanical Problem

RVE

Wm m
i

S

Figure 7: Data flow of the RVE problem for both homogenization procedures: MMRp and MMSp.

14

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



operator IR(·), plus the strain fluctuation increments dε̃µ. According with the definition of
the operator IR(·), in equation (21), both terms dεū and dεβ are uniformly distributed into
Ωµ. However, note that dεβ is scaled by the tortuosity factor θ.

The Kinematical admissibility requirement (16), hypothesis H1, is particularized as follows:∫
Ωµ

dεµ dΩµ =

∫
Ωµ

IR(dεū, dεβ) dΩµ , (18)

see [44] for additional details. Then, expression (23) of block 1 defines the space of kine-
matically admissible displacement fluctuations Ũ Rµ . As mentioned above, the kinematical
descriptors fully defining the displacement fluctuations at the micro-scale are: d ˜̄uµ and dβ̃iµ
(i = 1, ..., nc). They are assumed to be independent descriptors. Geometrical entities in
expression (23), i.e. the boundary Γµ of Ωµ and its unit normal vector νµ, are depicted in
Figure 5. The integral restriction on the boundary Γµ imposed to the displacement fluctua-
tion increment fields in Ũ Rµ , as expressed in (23), is equivalent to restriction (18).

Expression (24) defines the virtual actions at the macro-scale. Note that in the MMRp model
we consider that ε̂ū is an arbitrary tensor while β̂ ≡ 0 . The corresponding space of virtual
displacement actions at the micro-scale is V Rµ , and the micro-scale virtual strain actions are
defined in expression (26).

Any subspace of Ũ Rµ and V
R
µ , is also kinematically admissible and defines alternative (more

constrained) sub-models of the MMRp procedure.

The specific definition of the virtual actions is the basis to postulate the Principle of Multi-
scale Virtual Power (H2), which is expressed as follows:

σ · ε̂ū =
1

|Ωµ|

∫
Ωµ

σµ · ε̂µ(ε̂ū, ˆ̄uµ, β̂1µ, ..., β̂
nc
µ ) dΩµ ,

∀ ε̂ū and ∀ ( ˆ̄u, β̂1µ, ..., β̂
nc
µ ) ∈ V

R
µ .

(19)

The left hand side of this equation is the macro-scale internal virtual power density and the
right hand side is the average internal virtual power inΩµ. Equation (19) emphasizes the de-
pendence of the micro-scale strain variations ε̂µ with: ε̂ū, ˆ̄uµ, β̂1µ, ..., β̂

nc
µ . This dependence

is explicitly shown in equations (26).

After replacing (24) and (26) into (19), the Principle of Multi-scale Virtual Power (H2)
implies two natural consequences in the sense of the associated Euler-Lagrange equations.
They are derived by considering independent variations of ε̂ū and ( ˆ̄u, β̂1µ, ..., β̂

nc
µ ). Both

consequences are presented in blocks 2.a and 2.b of Box 1, and are explained as follows:

(2.a) Equation (27) is derived from (19) by allowing arbitrary variations ε̂ū and holding
( ˆ̄u, β̂1µ, ..., β̂

nc
µ ) fixed to zero. This equation defines the homogenization procedure

determining the macro-scale stresses σ, as the volumetric averaging of the micro-
scale stress field σµ. The micro-scale stress σµ is determined from the micro-scale
equilibrium problem given by expression (28).

15

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



(2.b) Expression (28) is derived from (19) by introducing arbitrary variations of ( ˆ̄u, β̂1µ, ..., β̂
nc
µ )

and holding ε̂ū fixed to zero. This equation is the variational equilibrium equation in
Ωµ.

The constitutive relation of every constituent of the heterogeneous material and the traction-
separation law of every cohesive surface in Ωµ must be specified to solve the micro-scale
equilibrium problem (28), and so, to determine σµ and TSiµ .

Box 1: Multi-scale constitutive Model at Regular points (MMRp)
Given the strain history: ε(t−dt)R and {dεū, dεβ}, find σ satisfying :

1- Kinematics:

dεµ = IR(dεū, dεβ) + dε̃µ , ∀y ∈ Ωµ (20)

IR(dεū, dεβ) = dεū + θdεβ (21)

dε̃µ = ∇syd ˜̄uµ +
nc∑
i=1

(
M

i
µ∇

s
ydβ̃

i
µ −∇yϕ

i
µ ⊗

s
dβ̃

i
µ + δSiµ(dβ̃

i
µ ⊗

s
n
i
µ)
)

(22)

Kinematically admissible space of incremental displacement fluctuations, dũµ:

Ũ
R
µ =

{
(d ˜̄uµ,dβ̃

1
µ, . . . , dβ̃

nc
µ ) suff. regular, such that:

∫
Γµ

d ˜̄uµ ⊗s νµ dΓµ = 0
}

(23)

Virtual kinematically admissible actions:

Virtual actions at the macro-scale:

β̂ = 0 , ε̂ū arbitrary (24)

Virtual actions at the micro-scale:

(ˆ̄uµ, β̂
1
µ, . . . , β̂

nc
µ ) ∈ V

R
µ , with: V

R
µ ≡ Ũ

R
µ (25)

ε̂µ = IR(ε̂ū,0) +∇sy ˆ̄uµ +
nc∑
i=1

(
M

i
µ∇

s
yβ̂

i
µ −∇yϕ

i
µ ⊗

s
β̂
i
µ + δSiµ(β̂

i
µ ⊗

s
n
i
µ)
)

(26)

2- Consequences derived from the Principle of Multi-scale Virtual Power

2.a Stress Homogenization:

σ =
1

|Ωµ|

∫
Ωµ

σµ dΩµ (27)

2.b Micro-scale Equilibrium problem:
Given the strain history ε(t−dt)R and {dεR}, find (d ˜̄uµ, dβ̃

1
µ, . . . , dβ̃

nc
µ ) ∈ Ũ

R

µ such that:∫
Ωµ

σµ · ε̂µR dΩµ +
nc∑
i=1

∫
Siµ

TSiµ · β̂
i
µ dSµ = 0 , ∀ (ˆ̄uµ, β̂

1
µ, . . . , β̂

nc
µ ) ∈ V

R
µ (28)

ii) MMSp homogenization procedure to obtain T in xS (see Box 2).

16

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



The macro-scale strain increment dεS , in S, is the data input of the constitutive model in
Box 2. This generalized strain increment is defined in equation (6) and can be represented
by the triad {dεū, dεβ, dβ}. Note that the displacement jump β (a vector term) is used in
Box 2 instead of the singular tensor term described in the right hand side of equation (6).

The first block of equations (32)–(38) in Box 2, defines the micro-scale kinematics in Ωµ.
Following the same notation as above, the micro-scale strain increment is identified as dεµ.
Also, the micro-scale strain increment fluctuation is denoted dε̃µ, and is defined in equation
(34).

The insertion operator IS(·), defined in equation (33), distributes the macro-scale strain
increments given by {dεū, dεβ, dβ} into Ωµ. Similar to the previous case, the increment of
the macro-scale regular strain, dεū + θdεβ, is uniformly distributed in Ωµ. However, θdβ
is only distributed into the micro-scale strain localization domain SLµ corresponding to the
nop opening cohesive surfaces. Therefore, in this case, the generalized strain descriptors
{dεū, dεβ, dβ}, are not uniformly distributed into Ωµ. Again, in this case, the parameter θ
scales all the terms where the macro-scale displacement jump β is present.

In correspondence with (14) and (15), equation (34) defines the micro-scale strain increment
fluctuation. Note, in this expression, that all the micro-scale nucleated cohesive surfaces
contribute to dε̃µ.

The Kinematical admissibility requirement (16), hypothesis H1, is imposed through two
equations: ∫

Ωµ

dεµ dΩµ =

∫
Ωµ

IS(dεū, dεβ,0) dΩµ (29)∫
SLµ
dεµ dΩµ =

∫
SLµ
IS(0,0, dβ) dSµ (30)

see [44] for additional details. The kinematically admissible displacement fluctuation space
Ũ Sµ in Ωµ, and the corresponding virtual action space V

S
µ , are defined in expressions (35)

and (37), respectively. The first constraint in (35) defines fields d ˜̄u satisfying (29) on Ωµ.
The second one defines fields dβ̃ satisfying (30) on SLµ .
The macro-scale admissible virtual actions are given in expression (36). In this case, note
that the macro-scale vector β̂ can be arbitrarily defined, while the macro-scale regular strain
variation ε̂R is assumed to be zero.

A specific Principle of Multi-scale Virtual Power (H2), valid for points xS at the macro-
scale, is postulated as follows:

T · β̂ =
1

|SLµ |

∫
Ωµ

σµ · ε̂µ(β̂, ˆ̄uµ, β̂1µ, ..., β̂
nc
µ ) dΩµ ,

∀ β̂ and ∀ ( ˆ̄uµ, β̂1µ, ..., β̂
nc
µ ) ∈ V

S
µ .

(31)

Two equations are naturally derived from the Variational Principle (31):

17

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



ii.1) The first one is obtained by allowing arbitrary variations in β̂ and holding fixed ( ˆ̄uµ, β̂1µ, ..., β̂
nc
µ )

to zero, resulting the expression (39) in Box 2. This expression provides the homog-
enization rule for the macro-scale traction T as the averaging of the micro-scale trac-
tions T

S
Lj
µ

in all the opening cohesive cracks inΩµ. Note the presence of the parameter

θ scaling the average traction in SLµ .

ii.2) Alternatively, by imposing arbitrary variation of ( ˆ̄uµ, β̂1µ, ..., β̂
nc
µ ), and holding fixed β̂

to zero, the micro-scale equilibrium equation (40) is derived. This equation is similar,
though with different kinematical constraints, to (28) in Box 1.

Box 2: Multi-scale constitutive Model at Singular points (MMSp)
Given the strain and displacement jump histories ε(t−dt)R , β

(t−dt) and {dεū, dεβ, dβ};
find: T satisfying:
1- Kinematics:

dεµ = IS(dεū, dεβ , dβ) + dε̃µ , ∀y ∈ Ωµ (32)

IS(dεū, dεβ , dβ) = dεū + θdεβ +
nop∑
j=1

δ
S
Lj
µ

(θdβ ⊗s nLjµ ) ; ∀ y ∈ Ωµ (33)

dε̃µ = ∇syd ˜̄uµ +
nc∑
i=1

(
M

i
µ∇

s
ydβ̃

i
µ −∇yϕ

i
µ ⊗

s
dβ̃

i
µ + δSiµ(dβ̃

i
µ ⊗

s
n
i
µ)
)

(34)

Kinematically admissible space of incremental displacement fluctuations, dũµ:

Ũ
S
µ =

{
(d ˜̄uµ, dβ̃

1
µ, . . . , dβ̃

nc
µ ) suff. regular, such that:∫

Γµ

d ˜̄uµ ⊗s νµ dΓµ = 0 and
nop∑
j=1

∫
S
Lj
µ

dβ̃
Lj
µ ⊗s n

Lj
µ dSµ = 0

}
(35)

Virtual kinematically admissible actions:
Virtual actions at the macro-scale:

β̂ arbitrary , ε̂R ≡ 0 (36)
Virtual actions at the micro-scale:

( ˆ̄uµ,β̂
1
µ, . . . , β̂

nc
µ ) ∈ V

S
µ , with: V

S
µ = Ũ

S
µ (37)

ε̂µ = IS(0,0, β̂) +∇sy ˆ̄uµ +
nc∑
i=1

(
M

i
µ∇

s
yβ̂

i
µ −∇

s
yϕ

i
µ ⊗

s
β̂
i
µ + δSiµ(β̂

i
µ ⊗

s
n
i
µ)
)

(38)

2- Consequences derived from the Principle of Multi-scale Virtual Power

2.a Traction Homogenization:

T =
θ

|SLµ |

[ nop∑
j=1

∫
S
Lj
µ

T
S
Lj
µ

dSµ
]

(39)

2.b Micro-scale Equilibrium problem:

Given the histories ε(t−dt)R ,β
(t−dt) and {dεR, dβ}, find (d ˜̄uµ, dβ̃1µ, . . . , dβ̃

nc
µ ) ∈ Ũ

S

µ such that:∫
Ωµ

σµ · ε̂µR dΩµ +
nc∑
i=1

∫
Siµ

TSiµ · β̂
i
µ dSµ = 0 , ∀ (ˆ̄uµ, β̂

1
µ, . . . , β̂

nc
µ ) ∈ V

S
µ (40)

18

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Remark: note that both insertion operators I(·), in equations (20) and (32) define the informa-
tion which is transferred from the macro to micro-scale, and the way in which the macro-scale
kinematics is distributed in Ωµ.

3 Numerical implementation

The numerical implementation of the multi-scale model, at the macro and micro-scale, are based
on finite element methodologies. Although, in both scales it is assumed the existence of cohesive
surfaces, and therefore, the modeling of strong discontinuities is required, different procedures are
used in each case.

The macro-scale model is based on a new finite element technique with embedded strong
discontinuities (EFEM) and automatic crack path detection, recently introduced in the literature
by Oliver et al. [46]. In that work, the novel EFEM technique has been utilized for mono-scale
failure analysis. Its generalization to multi-scale analysis is here shown. In sub-Section 3.1 a brief
summary of the EFEM technique is presented. An important issue for using this element is the
crack path detection. Also, following to Oliver et al. [46], this task is performed by using the
“crack path field” technique, whose description is postponed until sub-Section 3.3.

The present macro-scale model could easily be implemented using alternative finite element
techniques dealing with strong discontinuities, such as XFEM, or tracking strategy for evaluating
the crack path. It is noted that selection of the most convenient finite element technique, must be
primarily decided according with the computational cost involved for evaluating the macro-scale
integral terms, in equation (7). Specifically, we are referring to the number of quadrature points
required by different techniques.

Alternatively, a standard finite element technique which uses stretched elements with very
high aspect ratios, placed between all the edges of the conventional ones and mimicking cohesive
surfaces, is adopted for modeling the micro-scale failure. This procedure is briefly summarized
in Section 3.2. A discussion about the adequate choice of the RVE boundary conditions and their
numerical implementation is also addressed in the same Section.

The finite element technique adopted for modeling the macro-scale is well adapted to handle
strong discontinuities intersecting the mesh in arbitrary directions. However, considering that it
requires important computational efforts, typically we refer to the evaluation of the crack path
tracking algorithm, we prefer an approach computationally less demanding for solving the micro-
scale, at the expense of giving up the ability to capture accurately the micro-scale crack path when
it intersects the finite element mesh in arbitrary directions.

3.1 Macro-scale finite element model: EFEM technique

The finite element model is briefly described in sub-Section 3.1.1, while the corresponding macro-
scale discrete equilibrium equations are presented in sub-Section 3.1.2.

19

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



3.1.1 Finite element with strain enrichment: Constant Strain Mode (CSM) and Discontin-
uous Displacement Mode (DDM)

Let us consider the mixed bilinear quadrilateral finite element technology with embedded strong
discontinuities reported in Oliver et al. [46]. A finite element mesh covers the domain Ωh of the
body (in R2) and Ωe denotes the domain of a specific finite element e.

During the structural loading process, the bilinear quadrilateral finite element e can switch
between three different formulations, denoted as states: 0, 1 and 2. The sets of elements with
identical state define specific body subdomains, such as sketched in Figure 8-b. Elements in states
1 and 2 define the subdomainsΩhCSM andΩ

h
DDM , respectively. A strong discontinuity surface S

h

crosses the domain ΩhDDM . The remaining subdomain Ω
h
0 = Ω

h\(ΩhCSM ∪ Ω
h
DDM ) is defined

by elements in state 0.
Finite element formulations and the switching from one state to other are defined according

with the following rules (see Figure 8-a):

W

W

W

CSM

DDM

Predicted
crack path xR

x
S

xR

S
n

(W�����)
e -

j+

(W�����)e
+

�W���
e

�W���e

PG2

PG3

PG4

PG1

�W���
e
0

  CSM
(State 1)

DDM

S

e

e

e

h

h

h

h(State 0)

(State 2)

e

Macro-scale problem

Consolidated
crack path

(b)

S

Me
j+

1

ne

(c)

Element state

Pseudo-time
0

1

2

t tN SD0

(a)

e

e

CSM

DDM

DDM

DDM

(W�����)
e +
DDM

(W�����)
e -
DDM

Figure 8: Macro-scale finite element technique. a) Relation between the pseudo-time vs. finite element state for
a particular macro-scale finite element; b) finite element states according with subdomain definitions, ΩhCSM is the
domain with finite elements based on CSM (state 1) shown in light gray, ΩhDDM is the domain with finite elements
based on embedded strong discontinuities-DDM (state 2) shown in deep gray, Ωh\(ΩhCSM ∪ Ω

h
DDM ) is the domain

of elements based on an irreducible formulation (state 0) shown in white; c) enrichment function M e in elements with
DDM.

• Initially, all elements in Ωh are defined in state 0 (Ωh0 = Ω
h). In this state, elements are

modeled as standard quadrilaterals with continuous bilinear displacements. In the standard
literature on the finite element method, this formulation is called irreducible. A quadrature
rule using four Gauss points: PG1, ..., PG4, is implemented to evaluate the integrals arising
from this irreducible formulation.

• Once the macro-scale bifurcation condition is detected at the pseudo-time: t = tN , in Ωe,
the element originally in state 0 switches to state 1 and becomes part of the subdomain

20

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



ΩhCSM . The bifurcation condition in element e is tested at the central point x
e
R verifying

the singularity of the homogenized acoustic tensor Qhom. Then, the bifurcation criterion is
satisfied, if:

det(Qhom) = det(nebifC
homnebif ) = 0 (41)

whereChom is the homogenized constitutive tensor given by equation (60) below, and nebif
is one of the eigenvectors such that (41) is satisfied. The second non-trivial eigenvector is
denoted γ and represents the initial velocity jump direction across the possible singularity
surface whose normal vector is nebif .

Finite elements in state 1 are also quadrilaterals, but with mixed interpolation of displace-
ments and strains: bilinear interpolation for the incremental displacements and constant
interpolation for the incremental strains (Constant Strain Mode-CSM). So, a quadrature rule
with only one integration point, the central one xeR in Figure 8-a, is enough to evaluate
consistently the integrals resulting from the variational problem of this mixed formulation.

Elements in this state are localized in the vicinity of the propagating crack tip (the frac-
ture process zone). The objective pursued by introducing a CSM for strains is to augment
the flexibility of the finite elements, and thus, to get a better prediction of the crack path
direction in that zone.

• After a subsequent, but small, increment of loading, at the pseudo-time tSD (with tSD >
tN ), finite elements in state 1 switch to state 2 and become part of subdomain ΩhDDM . In
state 2, a strong discontinuity mode (Discontinuous Displacement Mode-DDM according
to Oliver et al. [46]) is embedded into the quadrilateral finite element.

Previous to switching from states 1 to 2, the position of the surface Se(x) with normal
vector ne must be determined according to the technique given in sub-Section 3.2 below.
Placing the discontinuity surface Se in the correct position avoids stress locking in elements
where failure is taking place.

Due to the incremental format of the multi-scale model in Section 2, and because of the nu-
merical RVE incremental implementation of sub-Section 3.2 below (more specifically sub-Section
3.2.4), the numerical integration is consistently performed even when the quadrature rule is modi-
fied during the element switching from state 0 to 1.

The finite element formulations for states 0 and 1 have been implemented following very
standard procedures. Therefore, no further details are given, and the interested reader is referred to
the above mentioned reference work. Alternatively, finite elements in state 2 deserve an additional
description which is presented in the following.

Implementation of the finite element with DDM (element in state 2)

Let us consider the macro-scale finite element e, with subdomain: ΩeDDM ∈ Ω
h
DDM , where an

embedded strong discontinuity Se with unit normal vector ne is considered, see Figure 8-c. The
discontinuous displacement increment field due(x) in the element is given as follows:

due(x) =
4∑
p=1

N ep (x)dū
p,e + M e(x)dβe , (42)

21

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



where N ep is the standard shape function of the bilinear quadrilateral element related to the p-th
node of element e. The vector of parameters for the continuous displacement increment inter-
polation and associated with the same p-th node is denoted dūp,e, while dβe is the vector of
element parameters for the displacement jump increment interpolation. There is only one vector
dβe (βe ∈ R2) per element.

The unit jump function M e(x) is depicted in Figure 8-c and is defined as follows:

M e(x) = H e(x)− ϕe(x) , (43)

where H e is the Heaviside unit function shifted to Se, and:

ϕe(x) =

j+∑
j=1

N ej (x) , (44)

where the nodes j = 1, ..., j+ belong to (ΩeDDM )
+, as shown Figure 8-c.

A constant interpolation of regular strain increments per element is assumed. These strain
increments are given in matrix notation as follows:

dεeR(x) = B
e(xeR)[dū

e]︸ ︷︷ ︸
dεeū

− [∇ϕe](xeR)dβ
e︸ ︷︷ ︸

dεe
β

, ∀ x ∈ ΩeDDM\S
e (45)

where, the element vector [ūe] collects all the displacements components for the finite element,Be

and [∇ϕe] are the conventional displacement-strain matrix and the matrix gradient of the function
ϕe. Both terms in (45) are evaluated at the central integration point xeR. Using Voigt notation
and a cartesian basis, the strain components are arranged as εeR = [εx1x1 , εx2x2 , 2εx1x2 ]

T (with
subscripts x1 and x2 indicating the cartesian component in R2). The matrices in (45) are defined
as follows:

Be =




∂Ne1
∂x1

0 ...
∂Ne4
∂x1

0

0
∂Ne1
∂x2

... 0
∂Ne4
∂x2

∂Ne1
∂x2

∂Ne1
∂x1

...
∂Ne4
∂x2

∂Ne4
∂x1


 , [∇ϕ

e] =




∂ϕe

∂x1
0

0
∂ϕe

∂x2

∂ϕe

∂x2
∂ϕe

∂x1


 , (46)

while the element vectors [dūe] and dβe are ordered as:

[dūe] =
[
(dū1x1) (dū

1
x2

) ... (dū4x1) (dū
4
x2

)
]T
, dβe =

[
dβex1 dβ

e
x2

]T
, (47)

The generalized strain increment in the singular point xeS , positioned in the center of the
element ΩeDDM and coincident with x

e
R, as shown in Figure 8, is characterized through the kine-

matical descriptors:
dεeS(x

e
S) =

(
dεeū, dε

e
β, dβ

e
)
, (48)

where the first two descriptors are defined in (45).
In agreement with (42), the virtual actions in the domain of the e-th finite element, can be

defined as:

22

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



ûe =
4∑
p=1

N ep ˆ̄u
p,e + M eβ̂e , (49)

where ˆ̄up,e and β̂e are the vector of parameters for the interpolation of continuous displacement
and displacement jump virtual actions, respectively. Also, in agreement with (45), the virtual
regular strains are:

ε̂eR = B
e(xeR)[ ˆ̄u

e]− [∇ϕe](xeR)[β̂
e] . (50)

Remark: only elements in state 2 (ΩeDDM ⊂ Ω
h
DDM ) are intersected by cracks. By construction,

as shown in Figure 8-c, the support of enrichment functions ϕe and M e isΩeDDM . Then, elements
having states 0 or 1 (Ωh0 ∪Ω

h
CSM ) have the following particularities:

• they are outside the influence zone of any crack;

• in the insertion operator definition, equation (20), dεeβ is identically zero;

• the insertion operator IR(dεeū,0) distributes uniformly the macro-strain dεeū into the RVE
domain;

• the MMRp procedure, which evaluates the constitutive relation σe at all integration points,
results identical to the conventional semi-concurrent homogenization techniques reported
in the literature (see for example Miehe and Koch [47]), in the sense that the increment
of macro-strain dεeū is uniformly distributed into the RVE, and the overall stress σ

e is the
volumetric average in Ωµ of the micro-scale stresses σµ.

3.1.2 Discrete equilibrium equations

Introducing the strains and virtual action fields (expressions (45) and (50) for finite elements with
DDM), into the variational problem (7) and performing variations of ˆ̄ue, with β̂e fixed to zero, we
obtain the discrete version of the equilibrium equation as follows:

Λneleme=1

∫
Ωe\Se

(Be)Tσe dΩe︸ ︷︷ ︸
F int

−F ext = 0 , (51)

where F int and F ext are the global vectors of internal and external forces, respectively, Λ is
the finite element assembling operator and σe is the macro-scale element stress arranged using
Voigt notation. The vector F int in equation (51) is evaluated with an adequate integration rule,
according with the state of each finite element. Elements in state 0 require a standard integrations
rule with four Gauss points, while elements in states 1 and 2 require only one integration point
(the integration point is placed at the central position of the element and is represented by xeR in
Figure 8).

Alternatively, the traction equilibrium equation across Se, with Se ⊂ ΩeDDM ⊂ Ω
h
DDM ,

is not consistently derived from (7). Instead, and following to Oliver et al. [48], a pointwise
traction equilibrium equation (SKON formulation according with the denomination coined in the
literature) is proposed as follows:

23

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



T e(xeS) = σ
e(xeR)n

e, ∀e ∈ ΩhDDM . (52)

The traction vector T e is evaluated at the integration point xeS attached to the cohesive surface,
see Figure 9. This vector is obtained by using the MMSp homogenization procedure described
in Box 2. On the other hand, the stress σe is evaluated at the regular point xeR using the MMRp
homogenization procedure described in Box 1. There is only one equation (52) per each finite
element ΩeDDM in state 2 (Ω

e
DDM ⊂ Ω

h
DDM ).

x

s�(  )

W
e

xR

RVE

Wm

MMRp

xR
e

e

T�(x )S
RVE

Wm

MMSp

m
L

e e

S

S

IR (de���,�de��)u b IS
(de���,�de��,�db�)u b

e e

e e e e e

Se

DDM

Figure 9: Integration points of a finite element in state 2 with DDM (ΩeDDM ∈ ΩhDDM ). Regular (xeR) and singular
(xeS) integration points.

Note that according with Figure 9 and the MMSP procedure, the strain localization domain SLµ
in the RVE associated with point xeS , must be determined before nucleating the cohesive crack S

e

at the macro-scale. In the numerical implementation, the evaluation of this domain is performed
just before switching from state 1 to state 2, at pseudo-time: tSD, with tSD > tN , see Figure 8-a.
During the interval [tN , tSD], the localization process at the RVE shows a fast development. So,
the failure mechanism and the opening cohesive surfaces at the RVE are more clearly defined at
tSD than at tN , and the domain SLµ can be thus more accurately determined.

Stiffness matrix of finite elements with DDM

The stiffness matrix of elements with DDM, in state 2, is derived from the equilibrium equa-
tions (51) and (52), and can be written as follows:

Ke =

[
Keūū K

e
ūβ

Keβū K
e
ββ

]
, (53)

where each sub-matrix is:

Keūū = [B(x
e
R)]

T ∂σ
e(xeR)

∂ūe
|Ωe| , (54)

Keūβ = −[B(x
e
R)]

T ∂σ
e(xeR)

∂βe
|Ωe| ; (55)

Keβū =
∂T e(xeS)

∂ūe
− ne

∂σe(xeR)

∂ūe
|Ωe| , (56)

Keββ =
∂T e(xeS)

∂βe
− ne

∂σe(xeR)

∂βe
|Ωe| , (57)

24

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



where the symbol |Ωe| denotes the area of the finite element. The stress derivatives in these
expressions are found by considering the stress homogenization equation (27) and the macro-scale
regular strain (see equation (45)):

∂σe(xeR)

∂ūe
= ChomBe , (58)

∂σe(xeR)

∂βe
= −θChom[∇ϕe] , (59)

where the homogenized tangent tensor Chom is given by:

Chom =
1

|Ωµ|

∫
Ωµ

(
Cµ +CµA(y)

)
dΩµ; A(y) =

∂ε̃µ
∂εeR

, A ∈ R3×3 . (60)

The operatorA is derived from the implicit functional dependence ε̃µ(εeR) established through the
micro-scale equilibrium problems (28), see Box 1. Then, the linear operator A(y) can be deter-
mined by solving three linear micro-scale equilibrium problems (in R2). See additional details in
[22] and [43].

Finally, the traction homogenization expression (39) in Box 2 related to the MMSp procedure
can be derived, resulting in the following expressions:

∂T e

∂ūe
=

θ

|SLµ |

nop∑
j=1

∫
S
Lj
µ

n
Lj
µ CµD(y)dSµ , (61)

∂T e

∂βe
=

θ

|SLµ |

nop∑
j=1

∫
S
Lj
µ

−nLjµ (Cµ +CµC(y))dSµ , (62)

where we have defined:

D(y) =
∂β̃µ
∂ūe

, C(y) =
∂β̃µ
∂βe

, (63)

which can be computed by considering the implicit functional dependence dβ̃µ(dεeR, dβ
e) given

by equation (40). Both operators can be found by solving two micro-scale equilibrium problem.

3.2 Micro-scale finite element model

The finite element model at the micro-scale is implemented using a conventional technique without
appealing to the explicit inclusion of strong discontinuities. Let us consider the finite element
domain of the RVE, denoted Ωhµ , with boundary Γ

h
µ and unit normal vector ν

h
µ , as shown in

Figure 10-a. The micro-scale displacement fluctuation increment field, dũµ, is interpolated in Ωhµ
as follows:

dũµ(y) =

nnod∑
k=1

Nµk(y)dq̃
k
µ , (64)

25

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



where nnod is the number of nodes of the micro-scale finite element mesh, Nµk the shape function
of the k-th node and q̃kµ the vector of interpolation parameters, related to the same k-th node, for
the displacement fluctuations.

The micro-scale strain increment in the finite element eµ is:

dε
eµ
µ (y) = I(dε) +B

eµ
µ (y)[dq̃

eµ
µ ]︸ ︷︷ ︸

dε̃
eµ
µ

, (65)

where the insertion operator I(·) is defined in (21), or (33), depending on the macro-scale point to
which the RVE is associated with, andB

eµ
µ is the conventional strain-displacement matrix for the

micro-scale finite element eµ. The last term in (65) is the micro-scale strain fluctuation increment
dε̃

eµ
µ (y). The vector [dq̃

eµ
µ ] collects all the interpolation parameters of the finite element for the

displacements fluctuation increments.

3.2.1 Use of two-dimensional thin band-like domains

Two-dimensional Constant Strain Triangles (CST) elements, displaying high aspect ratios and
distributed forming thin band-like domains, are inserted between all the element edges of the
original finite element mesh, such as shown in Figure 10.

Each so-formed thin band Biµ (superscript i identifies the band number) has associated a thick-
ness `iµ, a normal vector n

i
µ and a mean surface Siµ, as shown in Figure 10-b. A band area |Siµ| (or

length per unit of thickness) can be defined, such that |Biµ| = |Siµ|`iµ, where |Biµ| is the volume of
the respective band. The geometrical distribution of CST elements forming the bands are shown
in gray in the Figure 10, and their aspect ratio increases with `iµ → 0.

The displacement fluctuation and strain fields into the bands are described by equations (64)
and (65), respectively.

The objective of introducing these micro-scale bands into the mesh is to capture the failure
mechanisms induced by strain localization effects. This procedure can be considered as an alter-
native technique to more standard cohesive interface finite elements. A distinguishing feature in
the present approach is that we can assign continuum constitutive models to the material consti-
tuting the thin micro-scale bands.

Strain localization is forced to happens exclusively into the bands Biµ by defining there a regu-
larized strain softening material response, while elastic, or non-elastic (but with strain hardening),
material responses are adopted for all the constituents of the composite (and modeled with the fi-
nite elements of the original mesh). Strain localization into the bands initiates after the micro-scale
bifurcation condition is reached.

An additional concept associated with the band Biµ is introduced in the present finite element
model. Let us define a local orthogonal coordinate system (η, ζ) aligned with the band, η is placed
along the line resulting from the intersection of Siµ with the plane of analysis, as shown in Figure
10-c. Let us also consider the displacement jump fluctuation increment across the band, dβ̃iµ,
defined along the coordinate η as follows:

dβ̃iµ(η) = dũµ(ζ
+, η)− dũµ(ζ−, η) = dũ+µ (η)− dũ

−
µ (η) , (66)

26

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Wm

RVE

h

CST elements

Original FE mesh

Gm

n

h

m
h

(a)

lm
i

Sm
i

z
 u  m

3 (n )+m
i

(c)

+(G�)m
i

-(G�)m
i

 u  m
2

 u  m
1

P

CTS element
of the i-th 
micro-scale band 

h

m
i

(n )m
i-

+(G�)m
i

B -(G�)m i

(n )+m
i  u m

+

 u m
-

z

lm
i

Sm
i

m
iB

n m
i

(b)

m
iB

Figure 10: RVE finite element model. (a) CST finite elements arranged like thin bands are inserted at edges of
original finite elements (the band-like domains are depicted in grey); (b) band Biµ and its associated geometrical en-
tities (thickness `iµ, normal vector n

i
µ and mean surface Siµ), (c) local coordinate system (η, ζ) of the i-th band and

displacement fluctuation vectors in the CST element nodes.

where the coordinate ζ+ indicates the position on the boundary (Γ+µ )
i and ζ− the position on the

boundary (Γ−µ )
i. The surfaces (Γ+µ )

i and (Γ−µ )
i limit the band and are depicted in the same Fig-

ure. According with the notation in Figure 10-c, it is noted that the micro-scale strain fluctuation
increment in the CST element belonging to Biµ, is given by (see additional details in the work of
Manzoli et al. [49]):

dε̃iµ =
dβ̃i∗µ ⊗s n+iµ

`iµ
+O

(‖dq̃2µ − dq̃1µ‖
|Siµ|

)
, (67)

where dβ̃i∗µ = dq̃
3
µ−dũPµ , being dũPµ the displacement fluctuation increment interpolated at point

P . The point P is the orthogonal projection of node 3 onto (Γ−µ )
i. The second term in (67) can be

neglected when `iµ � |Siµ| and the band initiates the strain localization process. In this case, the
micro-scale strain fluctuation increment dε̃

eµ
µ interpolated by (65) into the CST element, naturally

approaches to:

dε̃
eµ
µ ≈

dβ̃iµ(0)⊗s n+iµ
`iµ

. (68)

Constitutive relation for the micro-scale bands

The continuum damage model presented in Box 3 describes the material response of the bands
Biµ. This constitutive relation has been taken from Oliver [18].

According with equation (69), the internal variables of the model, qµ and rµ, as well as their
evolution equations (72)–(73), determine the isotropic damage, dµ, which defines the degradation
of the original elastic response ruled by the elastic constitutive tensor Cµ. Initial values of qµ and
rµ are qµ0 and rµ0, respectively. The variable rµ can be seen as the maximum value of a strain
norm reached during the loading history.

27

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



The relation between ṙµ and q̇µ is given by the softening modulus Hµ < 0, as shown in
equation (72). This parameter is characterized from the fracture energy, Gfµ, of the micro-scale
material constituent. The remarkable aspect of the damage model in Box 3 is the regularization of
the softening modulus Hµ, with the parameter `µ, as described by equation (73).

The positive counterpart of the effective micro-scale stress, (σeffµ )+, is introduced in the dam-
age criterion (70) with the objective of modeling damage evolution only under tensile stress con-
dition.

By adopting this continuum damage model for the micro-scale bands Biµ, `iµ small compared
to the micro-cell size, and considering that:

a) the softening modulus of the damage constitutive relation is regularized with the length `iµ,
so that, the total dissipated energy does not depend of this length (this is the reason for
introducing the length `iµ into the definition of Hµ, as shown in equation (73), Box 3);

b) its elastic response is identical to that of the neighbor bulk material, so that, the overall RVE
elastic response is independent of the size `iµ;

then, it can be concluded that the complete response of the RVE is independent of the value
adopted for `iµ.

Identification of the strain localization domain at t = tSD.

Once the singularity of the corresponding acoustic tensor has been verified in the CST element
Biµ, at time tiµN (with t

i
µN < tN ), the band is identified as a nucleated micro-scale band. Consid-

ering that there are nc nucleated bands, then, the complete domain of nucleated bands is denoted
Bµ, being Bµ = ∪nci=1B

i
µ.

An additional ingredient introduced in the RVE finite element model refers to the opening
strain localization domain, denoted BLµ , see Figure 11. This domain is defined after the macro-
scale bifurcation condition has been detected at t = tN . Typically, BLµ is evaluated at t = tSD
(with tSD > tN as shown in Figure 8-a). As mentioned in sub-Section 3.1.1, the solution of
equation (41) provides two macro-scale eigenvectors, nebif and γ. It is assumed that a nucleated
band Biµ is opening at t = tSD if: dε̃µ · (nebif ⊗ γ) > 0, where dε̃µ is the micro-scale strain
fluctuation increment evaluated in the CST element of the band. In this case, the band is identified
with the notation BLjµ . Contrarily, a nucleated micro-scale band is closing at t = tSD if that
condition is not satisfied.

Then, BLµ is defined by BLµ = ∪
nop
j=1B

Lj
µ , where nop is the number of opening micro-cracks

at t = tSD. The number of nucleated micro-scale bands which are closing at t = tSD is ncl =
nc − nop.

Note that every element in Bµ is identified with the superscript “i” (Biµ), while, elements in
BLµ are identified with the superscript “Lj”, where the index “j” denotes one specific band of the
set. According with this notation, all the geometrical entities associated with the band BLjµ are
denoted with superscript “Lj”, e.g.: n

Lj
µ , S

Lj
µ , `

Lj
µ .

28

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Box 3: Regularized tensile damage model at the micro-scale.
Elastic stress-strain relation

σµ =
qµ
rµ
Cµ εµ = [1− dµ(rµ)]

σeffµ︷ ︸︸ ︷
Cµ εµ , dµ(rµ) = 1−

qµ(rµ)

rµ
. (69)

Damage criterion

G (εµ, rµ) =
√(
σ
eff
µ

)+ · εµ − rµ ≤ 0 , (σeffµ )+ = 3∑
i=1

〈
(σ
eff
µ )i

〉
ei ⊗ ei . (70)

Loading/Unloading complementary conditions

ṙµ ≥ 0, G ≤ 0, ṙµ G = 0 , rµ|t=0 = rµ0 =
σuµ√
Eµ

. (71)

Internal variable evolution laws with softening
q̇µ = Hµ(rµ) ṙµ, qµ ≥ 0, qµ|t=0 = qµ0 = rµ0 , (72)

Hµ(rµ) = −
`µ r

2
µ0

G
f
µ

exp

[
−
`µ rµ0

G
f
µ

(rµ − rµ0)
]
. (73)

Tangent constitutive tensor

if ṙµ = 0, C
tan
µ = (1− dµ)Cµ (74)

if ṙµ > 0, C
tan
µ = (1− dµ)Cµ −

[
qµ −Hµ rµ

r3µ

]
σ
eff
µ ⊗ (σ

eff
µ )

+
. (75)

Material parameters
σ
u
µ : Ultimate tensile stress, G

f
µ : Fracture energy.

Eµ, νµ : Young’s modulus and Poisson ratio, defining the elastic constitutive tensor Cµ

Definitions of variables

rµ : strain-like internal variable, qµ : stress-like internal variable,

dµ : scalar damage variable, Hµ : softening modulus (exponential degradation).

σ
eff
µ : effective stress, (σ

eff
µ )i : i-th principal stress of σ

eff
µ ,

ei : i-th eingenvector of σ
eff
µ , (σ

eff
µ )

+
: positive counterpart of effective stress,

〈·〉 : Macaulay brackets, `µ : strain localization band thickness,

29

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



RVE

b

n

lm
j

x 
S

de +q�debū

de +q�debū

(��b�Ä��n (y))sq

l  (y)m

md
de +q�de��+bū

Lj

Lj

e

e

e

e

MMSp

IS (de���,�de��,�db)u b

m

 Macro-scale 
finite element

Lj

m
LjB

S

m
LjB

Wm
hW

(n )+

+(G�)m

m (u )m
+

Lj

Lj

Lj nm
Lj

-

(n )-m
Lj(u )-m

Lj

(G�)m
Lj

Opening strain 
localization
domain m

L
B

I  =S

I  =S

I  =S

DDM

Figure 11: Operator IS used in the MMSp homogenization procedure. Macro-scale strain insertion into the micro-
scale finite element mesh, Ωhµ

Identification of the macro-scale normal vector ne at t = tSD.

The macro-scale normal vector ne used in the implementation of the EFEM technique is also
evaluated at t = tSD as follows:

ne =

∑nop
j=1

∫
S
Lj
µ
n
Lj
µ dSµ

‖
∑nop

j=1

∫
S
Lj
µ
n
Lj
µ dSµ‖

(76)

Considering the tortuosity parameter defined in equation (17), it is noted that ne is the average
vector obtained by integrating n

Lj
µ along SLµ and scaled by θ, such that ‖ne‖ = 1. The evaluation

of ne with equation (76) requires that all vectors n
Lj
µ are defined following the rule:

n
Lj
µ · nebif > 0 , ∀ j = 1, ..., nop , (77)

where nebif is one of the eigenvector of the macro-scale bifurcation problem in equation (41).
According with our numerical experience, see the results presented in next sub-Section 4.2, the

difference observed between the so-determined vector ne and nebif does not exceed a few degrees.

3.2.2 Implementation of the insertion operator

In the forthcoming developments, the superscript “e” indicating macro-scale finite element is re-
moved from the inserted macro-scale kinematical objects.

In expression (65), the operator I(·) inserts the macro-scale strain according with the proce-
dure defined in Section 2.3. When the MMRp homogenization procedure is used, equation (21)
indicates that the operator IR(·) inserts uniformly the macro-scale strain increment dεū + θdεβ
in all elements of Ωhµ . This uniform distribution includes all the CST band elements (even those
corresponding to not nucleated bands).

30

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Alternatively, when the MMSp procedure is used, the operator IS(·) also inserts uniformly the
macro-scale strain increment, dεū + θdεβ , in all elements of Ωhµ (including all the CST elements
of the nc bands), but additionally it inserts the term θdβ only in the strain localization domain BLµ .
Therefore, the maro-scale strain increment inserted into a CST element in the band BLjµ is (see
Figure 11):

IS(dεū, dεβ, dβ) = dεū + θdεβ +
[
θdβ ⊗s nLjµ

`
Lj
µ

]
. (78)

3.2.3 Displacement fluctuations and virtual action fields

According with equation (23) and the displacement field interpolation (64), we define the discrete
space of displacement fluctuation increments for the MMRp homogenization procedure, Ũ Rhµ in
Ωhµ as follows:

Ũ Rhµ =
{
dũµ(y) =

n
nod∑
k=1

Nk(y)dq̃
k
µ , such that

∫
Γhµ

dũµ ⊗s νhµdΓµ = 0
}
. (79)

The kinematical constraint in (79) ensures a zero average value, in Ωhµ , of the micro-scale strain
fluctuation increment field dε̃µ, which is defined in every finite element eµ as:

dε̃
eµ
µ = B

eµ
µ (y)[dq̃

eµ
µ ] . (80)

The discrete space of virtual displacement actions V Rhµ is:

V Rhµ =
{
ûµ(y) =

n
nod∑
k=1

Nk(y)q̂
k
µ , such that

∫
Γhµ

ûµ ⊗s νhµdΓµ = 0
}
. (81)

Alternatively, by considering the MMSp homogenization procedure, and according with (35)
and (64), the discrete space of displacement fluctuation increments, Ũ Shµ in Ω

h
µ , is defined as

follows:

Ũ Shµ =
{
dũµ(y) =

n
nod∑
k=1

Nk(y)dq̃
k
µ , such that

∫
Γhµ

dũµ ⊗s νhµdΓµ = 0;

and
nop∑
j=1

∫
S
Lj
µ

dβ̃
Lj
µ ⊗s n

Lj
µ dSµ = 0

}
, (82)

where, using the notation previously introduced, it has been considered the displacement jump
fluctuation increment dβ̃

Lj
µ across the band B

Lj
µ , defined as: β̃

Lj
µ = (ũ

+
µ )

Lj − (ũ−µ )Lj , with
(ũ+µ )

Lj and (ũ−µ )
Lj being the interpolated displacement fluctuations at each side of the band Lj

along the coordinate η, such as shown in the insert of Figure 10.

31

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



The discrete space of virtual displacement actions VShµ is:

V Shµ =
{
ûµ(y) =

n
nod∑
k=1

Nk(y)q̂
k
µ , such that

∫
Γhµ

ûµ ⊗s νhµdΓµ = 0;

and
nop∑
j=1

∫
S
Lj
µ

β̂
Lj
µ ⊗s n

Lj
µ dSµ = 0

}
, (83)

where, in concordance with the comment of the paragraph above, virtual variations of displace-
ment jump across the band BLjµ are defined as β̂iµ = û+µ − û−µ . The second kinematical constraint
defining Ũ Shµ and V

Sh
µ , extended along SLµ , ensures the satisfaction of identity (30) for the inter-

polated micro-scale strain fluctuations.
The kinematical constraints defined along Γ hµ in (79), and the first one in (82), can be seen as

a specific kind of boundary condition defined on the RVE. Following the denomination introduced
in our previous work (see [43]), we call it the Standard Boundary Conditions (SBC) and is the
typical kinematical constraint defined in conventional semi-concurrent multi-scale models. The
last constraint imposed along SLµ , in expression (82), is called the Non-Standard Boundary Con-
ditions (NSBC). It can be seen as a boundary condition on the domain BLµ . Some remarks about
these specific kinematics constraints are given:

Standard Boundary Conditions (SBC): The model which strictly satisfies the kinematical
constraint in (79) is called minimum kinematically constrained sub-model. However, kine-
matically more constrained sub-models can be defined, such as: Taylor, Linear or Periodic
(see Toro et al. [43]).

The kinematical constraints introduced by different sub-models play a very important role
for adequately capturing the failure mechanism of the RVE leading to complete degradation
of the material. The failure mechanism is defined when the macro-scale bifurcation time
tSD is detected. Thus, for t < tSD, it should be carefully analyzed if the chosen sub-
model inhibits the formation of an expected failure mechanism. The impediment to develop
a failure mode due to spurious kinematical boundary conditions could produce a delay of
bifurcation detection, and possibly, the identification of an alternative failure mechanism.
This issue is strongly associated with the micro-cell size adopted for the analysis. Larger
micro-cell sizes tend to decrease the effects introduced by boundary conditions, see the
analysis presented in Toro et al. [43]. In general, smaller micro-cell sizes could be utilized
for promoting correct failure mechanism if adequate boundary conditions are postulated.

Non-Standard Boundary Conditions (NSBC): once the macro-scale crack is activated and
dβ 6= 0, the NSBC must be introduced in the model. The NSBC in the present finite element
model are defined on the displacement fluctuation increment field dũµ(y) by constraining
the vector dβ̃

Lj
µ = d(ũ

+
µ )

Lj − d(ũ−µ )Lj , along the localization band B
Lj
µ , to satisfy the

second constraint in expression (82).

A particular sub-model which trivially satisfies the NSBC consists in defining d(ũ+µ )
Lj =

d(ũ−µ )
Lj ≡ 0 (i.e. fixing to zero the increment of displacement fluctuations of all nodes

32

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



on the boundary of BLµ ) and giving dβ̃
Lj
µ ≡ 0 . This sub-model is a generalization of the

Taylor sub-model extended to the MMSp approach, and is chosen for solving the problems
presented in next Section 4. Note that, even fixing to zero the displacement fluctuations
increments into the opening localization bands, a non-homogeneous deformation takes place
within such bands. In fact, this kind of deformation is induced by the macro-scale strains
inserted by the operator IS .

Numerical treatment of the kinematical constraints

The spaces Ũ Rhµ and Ũ
Sh
µ (or alternatively, Ṽ

Rh
µ and Ṽ

Sh
µ ) are implemented by introducing

the kinematical constraints (SBC and NSBC) as additional homogeneous linear equations between
the degrees of freedoms (d.o.f.’s) of the model.

Let us call [dq̃µ], with [dq̃µ] ∈ R2×nnod , the vector collecting the complete set of interpolation
parameters for the displacements fluctuation increment field ([dq̃µ]T =

[
[dq̃1µ]

T , ..., [dq̃nnodµ ]
T
]
) of

the finite element model. So, ndof = 2× nnod identifies the total number of d.o.f.’s of the model.
A direct mathematical treatment allows to write the SBC and NSBC as a system of nd homo-

geneous linearly independent equations as follows (see additional details of this point in Toro et al.
[43]):

H[dq̃µ] = 0 ; H ∈ R(nd,ndof ) (84)

From the previous equation, the vector [dq̃µ] can be partitioned into two vectors of dimension nd
and nf = ndof − nd :

[dq̃µ] =

[
[dq̃µ]f
[dq̃µ]d

]
, [dq̃µ]f ∈ Rnf , [dq̃µ]d ∈ Rnd , (85)

where
[dq̃µ]d = L[dq̃µ]f , (86)

being L a matrix of coefficients which are defined according with the kinematical constraints, or
discrete space, to be modeled. So, L = LRh identifies the coefficient matrix imposing the SBC
constraint seen in (79), while L = LSh the matrix imposing both, SBC and NSBC, constraints
seen in (82).

The RVE discrete vectors [dq̃µ]f and [dq̃µ]d are interpreted as the free and dependent partitions
of the total d.o.f.’s, respectively.

Next, we identify the finite dimensional vector spaces corresponding to the vector parameters
of displacement fluctuation increments:

Ũ Rqµ =

{
[dq̃µ] ∈ Rndof , and: [dq̃µ] =

[
[dq̃µ]f

LRh[dq̃µ]f

]}
, (87)

and

Ũ Sqµ =

{
[dq̃µ] ∈ Rndof , and: [dq̃µ] =

[
[dq̃µ]f

LSh[dq̃µ]f

]}
. (88)

While the finite dimensional vector spaces corresponding to the vector parameters of virtual ac-
tions, are defined as Ṽ Rqµ ≡ Ũ

Rq
µ and Ṽ

Sq
µ ≡ Ũ

Sq
µ .

33

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Note that, fields dũµ obtained from the interpolation (64) with vectors [dq̃µ] ∈ Ũ
Rq
µ , strictly

satisfy that dũµ ∈ Ũ Rhµ (or alternatively, fields dũµ obtained from the interpolation (64) with
vectors [dq̃µ] ∈ Ũ

Sq
µ strictly satisfy that dũµ ∈ Ũ Shµ ).

3.2.4 Micro-scale variational equilibrium problem.

The variational discrete equilibrium equation in Ωhµ for the MMRp homogenization procedure is
implemented as follows: find [q̃µ] ∈ Ũ

Rq
µ , such that:∫

Ωhµ

σµ · ε̂µ dΩ = [q̂µ]TF intµ = 0 , ∀ [q̂µ] ∈ V
Rq
µ , (89)

where the vector of internal forces F intµ ([q̃µ]) is:

F intµ = Λ
nelemµ
eµ=1

∫
Ω
eµ
µ

B
eµ
µ
T
σ
eµ
µ (ε

eµ
µ ) dΩµ . (90)

The stressesσ
eµ
µ in (90) are evaluated with the corresponding constitutive relations associated with

every micro-scale components. Also, the micro-strains ε
eµ
µ are determined by (65) and (80). The

assembling operation of the internal force vector (90), includes the total number of finite elements
(nelemµ) in Ωhµ , even the CST elements of the micro-scale bands.

Expression (89) is the proposed discrete implementation to approximate the micro-scale equi-
librium (28). A numerical strategy for solving (89) has been presented in in Toro et al. [43].

Observe that, by considering in (89), the spaces Ũ Sqµ and V
Sq
µ instead of Ũ

Rq
µ and V

Rq
µ , the

variational equilibrium equation and the numerical treatment given to the MMSp is obtained.
The connection between the variational equilibrium equation (89), considering the spaces Ũ Sqµ

and V Sqµ , and the equilibrium equation (40) for a micro-cell with cohesive surfaces is shown
through the following identity, which holds for the present micro-scale finite element model using
the CST bands:∫

Ωhµ

σµ · ε̂µ dΩ =
∫
Ωhµ\Bµ

σµ · ε̂µ dΩ+
nc∑
i=1

∫
Siµ
T iµ · β̂

i
µ dS = 0 , ∀[q̂µ] ∈ V

Sh
µ , (91)

where, the intermediate identity is obtained by partitioning the integral into two disjoint sets
Ωhµ\Bµ and Bµ, and applying the divergence theorem to the integral in Bµ. Here, it is recalled
that we are assuming `iµ → 0.

Furthermore, in (91), we define: T iµ = σµ(n
i
µ)

+. Therefore, the second term in the middle
expression of (91) can be interpreted as the virtual internal power due to cohesive tractions T iµ
acting on the band Biµ.

Note that the variational equilibrium equation (91), arising from the present finite element
model at the micro-scale, resembles the expression (40) which has been defined for a model with
a strong discontinuity kinematics.

If strain localization is not observed in the i-th band (CST elements), the vectors βiµ, as well
as β̃iµ, can be assumed very small. Then:

lim
`iµ→0

βiµ
`iµ
≈ O(εµΩµ\Bµ) , (92)

34

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



where εµΩµ\Bµ is the strain in the zone adjacent to the band B
i
µ. And the internal power in Biµ is:∫

Biµ
T iµ · β

i
µ dS ≈ 0 . (93)

But, once the strain localization process starts in the i-th band, the relative displacement between
nodes across the bands can no longer be assumed negligible. The relative displacements across
the band take the role of displacement jumps. Then:

lim
`iµ→0

βiµ
`iµ
→∞ (94)

and the internal power in Biµ is no longer necessarily small. So, the kinematics of this finite
element behaves like a strong discontinuity kinematics, and the band elements introduce a similar
response to conventional cohesive interface elements.

This finite element technique for computational simulation of material failure can be seen as
a regularization procedure, using continuum displacement interpolations, of problems displaying
strong discontinuities. A similar technique for mono-scale analysis has been reported in Manzoli
et al. [49] and Oliver et al. [31].

3.2.5 Degenerated CST elements with strain localization for simulating the RVE failure:
pros and cons

The computational technique developed for the micro-scale analysis has two remarkable features:

a) Contrarily to the observed response when classical interface cohesive models are used, CST
band elements described with continuous damage model and identical elastic behavior to
that of the bulk material do not feature spurious stress oscillations.

b) This approach, coupled with an Impl-Ex constitutive integration scheme (c.f. Oliver et al.
[48]), is very robust. The only non-standard step in the numerical implementation of the
RVE finite element model is related to the mesh generation, in the sense that, arbitrary
meshes ought to receive a pre-treatment to introduce CST band elements between finite
element edges of the original mesh.

In turn, it can be noted two serious limitation for modeling micro-structural failure mecha-
nisms with this technique: i) arbitrary crack paths cannot be captured, the crack path must nec-
essarily follow the element edges of the predefined finite element mesh, and ii) severe numerical
locking arises for capturing shear bands when non–aligned CST elements are taken. The last defi-
ciency can be alleviated, in part, by using damage-type models to characterize the CST elements.

3.3 A tracking algorithm for determining the macro-scale crack path

The problem of finding the geometrical position of Sh ⊂ Ωh at the macro-scale, is an important
issue of the finite element implementation. As mentioned above, the crack path must be precisely
determined before inserting the enriching DDM mode for elements in state 2.

35

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



To achieve this objective, first, it is defined a new field %(x) at the macro-scale Ωh as follows:

%(x) =
1

|Ωµ|

nc∑
i=1

∫
Biµ
rµdBµ , (95)

So, % is the average value in the cell of the micro-scale strain-like internal variable rµ defined in
Box 3. Since rµ represents a maximum strain measure during the loading history, rµ becomes very
large, proportional to 1/`iµ, in those bands displaying strain localization. However, the integral in
(95) is not necessarily zero when `iµ → 0 and the area of the band |Biµ| goes to zero.

At the instant of macro-scale bifurcation, at t = tN , %(x) quickly increases, because a suf-
ficient large number of micro-scale bands are subjected to a loading processes. Therefore, the
macro-scale regions where the material is reaching the instability condition are characterized by
large values of %. Contrarily, % is zero in regions where the inelastic regime has not yet been
achieved. We use this property of the field % to predict the geometrical position of the evolving
discontinuity surface Sh.

Let us take, at the macro-scale finite element domain Ωh, the space of functions L coinciding
with the standard bilinear interpolation field H1(Ωh) of the quadrilateral finite element, and the
space of piece-wise constant functions, C (Ωh):

C (Ωh) := {ψ(x) | ψ(x) = constant in Ωe}. (96)

The geometrical position of Sh intersecting the finite element mesh can be detected by solving
two successive problems, described in the following items as steps 1 and 2. Every step involves
the projection of discontinuous fields onto L .

Step 1: Find the field χ(x) ∈ L , such that:∫
Ωh
χ̂ (χ− %(x)) dΩh = 0 ; ∀ χ̂ ∈ L . (97)

Then, χ(x) can be seen as a smoothing of %. The quadrature rule to integrate (97) follows
the similar scheme defined in sub-Section 3.1.

Step 2: Find the directional derivative of χ, ξhc ∈ C , along the direction given by the vector
ω:

ξhc (Ω
e) = ∇xχ(xeS) · ω(x

e
S); (98)

where the vector field ω is a sufficiently smooth extension to Ωh of the normal vector to Sh
whose location has to be found.

Finally, the so-called crack-path field κ ∈ L is determined as the smoothing of ξhc . It is
evaluated according to the projection:∫

Ω
κ̂ (κ− ξhc ) dΩ

h = 0 ; ∀ κ̂ ∈ L (99)

The manifold Π(x) is defined as the zero level set of the crack-path field κ:

36

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



x ∈ Π iff κ(x) = 0. (100)

It can be shown (see Oliver et al. [46]) that the discontinuity surface satisfies Sh ⊂ Π . Therefore,
the problem of determining Sh is reduced to finding the set Π given by the algebraic procedure
defined in equations (97)–(100).

4 Numerical assessment

In a recent contribution by the authors (Toro et al. [44]), some important issues of the present multi-
scale model, such as the sensitivity of macro-scale solutions to tortuosity parameter changes, have
been analyzed. Here, additional studies are conducted to further validate the implementation of
the multi-scale methodology.

With this goal in mind, concrete fracture problems are solved by considering the hetero-
geneities observed at the meso-scale. Hence, the numerical simulations take into account two-
scales of analysis: a) the structural scale and b) the meso-structural scale at lengths of the order of
the aggregate sizes. The interaction effects between aggregates and cement-based matrix, mainly
those related to fracture, are included in the analysis.

First, in sub-Section 4.1, we describe the meso-structure model developed for concrete. We
define the constituents considered at the meso-scale and their possible interactions. In sub-Section
4.2, through a simple uniaxial macroscopic stretching test, we assess the sensitivity of structural
results to changes of the mesoscopic cell sizes and finite element sizes modeling the cell. Finally,
in sub-Section 4.3 we simulate a double notch beam bending concrete test. Results are computed
with several multi-scale models and are validated by comparing with Direct Numerical Simulation
(DNS) solutions.

4.1 Concrete failure modeling at the meso-scale

At the meso-scale, three main constituents can be recognized in concrete: cementitious matrix,
aggregates and the Interface Transition Zone matrix/aggregate (ITZ). The ITZ constituent plays
an important role in the degradation mechanism of this composite. Failure generally initiates at the
ITZ, which can be considered as the weakest link for concrete of low to moderate strengths, with
the posterior propagation of cracks across the matrix. In this kind of concrete, trans-aggregate
fracture is almost never observed. Then, in the present model, the aggregates are assumed to
behave like an elastic material with no degradation at all.

The meso-scale model for concrete failure developed in this Section follows very closely the
approximations reported in Carol et al. [50] and Unger and Eckardt [51].

Meso-structure model

Representation of an idealized two-dimensional composite model at the meso-scale is per-
formed by selecting, in the plane of analysis, different shape and size particles. The particles
represent the aggregates, and they are randomly distributed into a mesoscopic square cell of dif-
ferent sizes, depending on the tests shown in the following. These aggregates are assumed to

37

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



have shapes similar to irregular convex polygons and sizes which are determined from a prede-
fined grading curve (83% of particles with sizes between 3[mm] to 4[mm], and 17% of particles
with sizes between 4[mm] to 5[mm]). The total volume fraction of aggregates results 20.7%.
Aggregates distribution is such that they do not intersect the RVE boundaries.

According with the finite element procedure described in Section 3.2, the meso-scale model is
designed as shown in Figure 12. CST elements like-bands are inserted along the ITZ, as well as
along all the edges of the finite elements, in the original mesh, covering the matrix domain. All
these CST elements are characterized with the damage model described in Box 3.

Aggregates

Matrix

Interfaces 

matrix-aggregate

Elastic
matrix

Interface matrix-matrix
(damage model)

Interface
matrix-aggregated
ITZ (damage model)

Aggregates

Elastic
aggregate

(a) (b)

Figure 12: Mesoscopic concrete model.

Material parameters of the meso-scale model

Material parameters of the mesoscopic model are shown in Table 1. These data have been
taken from Unger and Eckardt [51] with all the elastic moduli increased 10%. The parameters
defined in [51], such as peak stresses and fracture energies of constituents, are considered a very
rough estimation for simulating the concrete beam test in sub-Section 4.3 Note that the experimen-
tal work (Bocca et al. [52]) taken for validating the numerical results in sub-Section 4.3, reports
an overall Young’s modulus: E = 27.[GPa] and an overall fracture energy Gf = 100.[N/m].

Eµ [GPa] νµ σ
u
µ [MPa] G

f
µ [N/m]

Elastic Matrix 20.4 0.18 — —
Elastic Aggregate 40.8 0.18 – –
Interface Matrix-Matrix 20.4 0.18 2.6 140.
ITZ Matrix-Aggregate 20.4 0.18 1.3 70.

Table 1: Material properties for the meso-structure depicted in Figure 12. Parameters defined are:
Young’s modulus, Eµ, Poisson ratio νµ, peak stress σuµ and fracture energy G

f
µ.

38

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



4.2 Multi-scale model sensitivity analysis

By using a simple macro-structural test, linked to complex mesoscopic cell models such as de-
fined in the previous sub-Section, we analyze the sensitivity of the multi-scale model response to
changes of cell size and finite element size of the meso-scale model. The analysis is addressed to
evaluate the sensitivity of:

i) the crack pattern obtained at the meso-scale level;

ii) the macro-scale crack orientation obtained with equation (76);

iii) the homogenized traction-separation law at the macro-scale.

We study a strip of size 125mm×125mm and thickness 100mm undergoing uniaxial stretch-
ing, such as depicted in Figure 13. Two analyses are performed with this strip:

- Case a) three specimens stretched in the directions: α = 0.deg, α = 30.deg and α =
45.deg, respectively, are solved with three mesoscopic cell sizes of 25mm×25mm, 50mm×
50mm and 75mm × 75mm. In this case, the size of the finite elements are similar in the
three cells;

- Case b) the specimen stretched in the directions α = 0.deg of the case a) is solved with the
cell size 50mm× 50mm, using three meshes which finite element sizes are: coarse (Mesh
I), medium (Mesh II) and fine (Mesh III).

In all cases, the kinematical constraints imposed on the micro-cells are: a) minimal kinematical
constraints and displacement fluctuation increments of the four cell vertices fixed to zero for the
SBC; b) a Taylor sub-model for the NSBC.

Note that, in all specimens, the micro-cells are modeled with their edges parallel to the hor-
izontal and vertical directions. So, the expected failure pattern developed in the three specimens
intersects the micro-cell edges at different angles, depending on the stretching direction at the
macro-scale. Therefore, from this analysis, it is also possible to assess the effect (if any) induced
by the SBC and NSBC for capturing different meso-scale failure patterns.

Case a): sensitivity analysis to changes of cell sizes

The failure modes captured at the meso-scale in the three specimens, using different cell sizes,
are analyzed in Figure 13. The Figure displays the deformed configurations of the mesoscopic
cells at the end of analysis. In deep red are shown the CST finite elements which are opening
at the end of analysis, defining the strain localization domain BLµ . In light blue are depicted the
CST finite elements which have been opening during the pre-critical regime, but are closing at the
post-critical regime.

Table 2 presents additional sensitivity results. The angles forming the macro-scale normal
vector ne with the horizontal direction are shown there. These vectors are determined with equa-
tion (76). The tortuosity parameters, evaluated with equation (17), are also presented in the last
column of the Table. Note the small dispersion of θ obtained in different instances, as well as the
close coincidence between the resulting direction of ne and the stretching direction.

39

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



C
e

ll 
5

0
x
5

0
C

e
ll 

7
5

x
7

5
C

e
ll 

2
5

x
2

5

a=0º

a=30º a=45º

Figure 13: Sensitivity analysis to changes of the cell size. Mesoscopic cell deformed configurations at the end of
analysis, depicting the failure modes for different specimens and cell sizes.

40

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Mesoscopic cell Principal Angle of the Tortuosisty
size [mm] stretching angle macro-scale normal parameter

α [deg] ne [deg] θ

25x25 0. 5. 0.89
25x25 30. 26. 0.87
25x25 45. 50. 0.86
50x50 0. 4. 0.88
50x50 30. 33. 0.82
50x50 45. 43. 0.84
75x75 0. 0. 0.86
75x75 30. 26. 0.85
75x75 45. 43. 0.86

Table 2: Macro-scale normal angle (ne) and tortuosity parameter obtained with different meso-
scopic cell sizes for the three specimens stretched at angles α.

Figure 14-a displays the structural force (F ) vs. macro-scale displacement (δ) curves for all
instances. Again, a close coincidence can be observed in all these cases. As expected, a conver-
gence is observed as the cell size is increased. In turn, Figure 14-b presents, for the mesoscopic
cell 50mm×50mm and stretching direction 30.deg, the normal components of macro-scale stress
(σnn) vs. macro-scale strain (εnn) during the pre-bifurcation regime (t ≤ tSD). In the same Figure,
it is also plotted the normal components of the macro-scale traction (Tn) vs. the normal compo-
nents of the macro-scale displacement jump (βn) during the post-bifurcation regime (t ≥ tSD).
Because both responses, see the two plots in Figure 14-b, are obtained with different homogeniza-
tion procedures (MMRp and MMSp), it is important to analyze the continuity at t = tSD provided
by them. This a very important issue, the continuity of responses with both procedures of the
present multi-scale model is a result of introducing the tortuosity parameter θ into the insertion
operators I, as well as, in the traction homogenization formula (39), see additional discussion
about this aspect of the model in [44].

From this analysis, it can be concluded that the cell with 25mm × 25mm provides results
which are considered as objective for the present concrete mesoscopic model. Furthermore, the
macro-scale response, including the traction-separation law, the evaluation of the normal vector
ne and the tortuosity parameter θ, are not significantly sensitive to the mesoscopic cell size for
cells larger than 25mm× 25mm.

Case b): sensitivity analysis to changes of finite element mesh sizes

Using the same structural problem of case a) and a micro-cell of 50mm× 50mm stretched in
the horizontal direction, we analyze the results obtained with three different finite element meshes:
mesh (I) with 4190 finite elements; mesh (II) with 7964 finite elements and mesh (III) with 17970
finite elements, respectively. Figure 15 displays the crack pattern observed on each mesoscopic
cell at the end of analysis, as well as the tortuosity parameters and angle forming the normal vector
ne with the horizontal direction, obtained in each case.

From this analysis, it can be concluded that the evaluations of the tortuosity parameter and the
macro-scale normal vector ne are not sensitive to the finite element mesh size.

41

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



(a)

(b)

0 0.02 0.04 0.06 0.08 0.1
0

0.5

1

1.5

2

2.5

3

Cell 25x25 Cell 50x50

0 0.02 0.04 0.06 0.08 0.1
0

0.5

1

1.5

2

2.5

3

Cell 75x75

0 0.02 0.04 0.06 0.08 0.1
0

0.5

1

1.5

2

2.5

3

0 0.02 0.04 0.06 0.08 0.1
0

0.5

1

1.5

2

2.5

3

Cell 25x25
Cell 50x50
Cell 75x75

a= 0º 

0 0.02 0.04 0.06 0.08 0.1
0

0.5

1

1.5

2

2.5

3

Cell 25x25
Cell 50x50
Cell 75x75

a= 30º 

0 0.02 0.04 0.06 0.08 0.1
0

0.5

1

1.5

2

2.5

3

d [mm]

Cell 25x25
Cell 50x50
Cell 75x75

a= 45º 

a=0º
a=30º
a=45º

a=0º
a=30º
a=45º

a=0º
a=30º
a=45º

d [mm]d [mm]

d [mm] d [mm] d [mm]

d

F

F [N]x 10 4 F [N]x 10 4 F [N]x 10 4

F [N]x 10 4 F [N]x 10 4 F [N]x 10 4

 0

 0.5

 1

 1.5

 2

 2.5

 0  0.01  0.02
 0

 0.5

 1

 1.5

 2

 2.5

 0  0.02  0.04  0.06

s
  
=

F
/
(L

x
T

h
ic

k
n
es

s)
 [
M

P
a
]

t=tSD

t=tSD

t<t   (MMRp)SD t>t    (MMSp)SD

n
n

e  = d/Lnn

T  [MPa]n

bn

d

bn

Tn
F

nL

L
Cell 50x50

a= 30º 

d
F

a

d F

a

e

Figure 14: Sensitivity analysis to changes of cell sizes. a) Load vs. displacement plots for the three specimens using
three cell sizes of 25mm × 25mm, 50mm × 50mm and 75mm × 75mm; b) Macro-scale stress- strain curve (σnn
vs. εnn, subscript indicates components in the direction of ne) during the pre-bifurcation regime and macro-scale
traction-separation law (Tn vs. βn) during the post-bifurcation regime captured with the micro-cell of 50mm×50mm
and stretching direction: 30.deg.

42

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Cell 50x50

=0.88 =0.84=0.86

Mesh (III):17970 FEMesh (II): 7694 FEMesh (I): 4190 FE 

Angle of n  = 1[deg]

d

F

q q q

a= 0º 

(a)

e Angle of n  = 4[deg] Angle of n  = 4[deg]e e

0 0.02 0.04 0.06 0.08 0.1
0

1

2

3

d [mm]

4190
Cell 50x50

elements
7694 elements

17970 elements

(b)

F [N]x 10 4

Figure 15: Sensitivity analysis to changes of the finite element mesh size. Solutions obtained with meshes (I), (II)
and (III), respectively. (a) Failure mechanism observed at the end of analysis, tortuosity parameters and angle forming
the normal vector direction (ne) with the horizontal axis; (b) Structural force (F ) vs. macro-scale displacement (δ)
curves.

43

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



4.3 Four point shear concrete specimen

The beam with the loading system displayed in Figure 16-a is numerically simulated assuming
plane stress condition. In the Figure, units of length are given in millimeters.

This beam corresponds to one of the 27 concrete specimens reported by Bocca et al. [52]
(b = 200.mm and c/b = 0.8), which, according with these authors, have been conceived to assess
the shear effects on the process of cracking.

The beam is here modeled and simulated using the multi-scale formulation developed in this
work MS model) and results are compared and validated with solutions obtained using three differ-
ent Direct Numerical Simulation (DNS) models where the meso-structure is particularly regarded.
The reason of solving three DNS problems is to assess the high sensitivity and dispersion of the
numerical results that we have detected in this specific problem due to changes of aggregate dis-
tribution in the zones close to the notches.

P, δ 

5P/6P/6

4
0

1
2

0

320 32080 80 

10 

MS C      Elastic

Thickness = 100 mm

4
0

b

l
c

Matrix,
Elastic

Aggregate,
Elastic

Matrix-matrix 
interface,
Damage

Matrix-aggr. 
interface (ITZ),
Damage

hom

(c)

(a)

MS model

DNS model

25mm

2
5
 m

m

(b)

Figure 16: Four point shear concrete specimen. (a) Geometry and multi-scale (MS) finite element model (dimension
in millimeters), (b) mesoscopic cell, and (c) one (of the three) DNS model.

MS finite element model

The finite element mesh adopted for the MS model at the macro-scale is shown in Figure

44

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



16-a. A multi-scale approach is only used in the central zone of the beam, depicted in blue. In
the remaining part of the specimen, depicted in gray, an elastic mono-scale region is assumed.
The homogenized elastic tensor Chom of the multi-scale model is taken for simulating the elastic
response of the mono-scale model. The meso-scale is modeled with the cell depicted in Figure
16-b.

First, we compare and discuss the DNS and MS numerical solutions by using, in the last case,
a micro-cell subjected to the following type of boundary conditions (BC):

BC’s type I:

a) SBC: minimum kinematical constraints with zero displacement fluctuations at the four ver-
tices of the cell;

b) NSBC: Taylor sub-model.

Additionally, in the final part of this Section, we compare the numerical solutions obtained with
two MS models, one uses micro-cells subjected to the above described boundary conditions of
type I, and the other uses the following boundary conditions:

BC’s type II:

a) SBC: periodic;

b) NSBC: Taylor sub-model.

DNS finite element models

Figure 16-c shows one of the three DNS models. The three DNS finite element models are
built using an identical approach to that adopted for modeling the meso-scale cell described in sub-
Section 4.1. So, a random distribution of aggregates is inserted into the central part of the beam
preserving the same volume fraction of aggregates. Finite element meshes with CST elements
forming thin bands, which are placed between the edges of elements in the original mesh, are
considered. The three meshes of the DNS models use similar size of finite elements.

Discussion of results

a) Morphology of the crack patterns

Figure 17 displays the evolution of the fracture process obtained with one of the three DNS
model. In deep red are shown the bands formed by the CST finite elements which are opening
at the end of analysis. They define the crack paths leading to the structural collapse. In light red
are depicted the bands which have been opening during part of the loading process but finally
close. The complete fracture process can be described through two different stages. First, a large
number of parallel small cracks (lengths of the order of aggregate sizes) are dispersed. They
are approximately orthogonal to the principal stress directions (depicted with a cross). These
meso-scale cracks are nucleated in almost the complete central region between both notches of
the beam (see Figures 17-a and b). Notably, in a second stage, some of these cracks, close to the

45

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



notches, coalesce in a different direction, forming two competing macro-scale principal cracks.
The propagation of one of these macro-scale cracks finally leads to the structural collapse.

As it is observed in the following, the present multi-scale model captures with acceptable
accuracy this rather complex fracture process.

Principal
stress
direction

(b)

(c)

(d)

(a)

Macro-crack
coalescence
direction

Principal
stress
direction

Figure 17: Four point shear concrete specimen. a-d) Sequence of pictures displaying the crack pattern evolution
obtained with a DNS model (bands formed by CST finite elements opening at the end of analysis are depicted in dark
red, bands which have been opening during part of the loading process but finally close are depicted in light red).

Figure 18-a compares several numerical structural responses in terms of the load P versus
vertical displacement δ. The plot of experimental results has been taken from Bocca et al. [52],
where it has been very roughly presented. The plot denoted MS corresponds to the numerical
multi-scale solution (BC’s case I). As can be observed, the structural peak load and the slope
after the peak load are well estimated by the model in comparison with the experimental results.
However, the structural energy dissipation is larger than that observed in the experimental result.
Three DNS solutions provide an additional estimation of the MS result accuracy. The plots of
the DNS solutions are rather dispersed, meaning that the numerical structural response is very
sensitive with respect to the meso-scale design (aggregate distribution) close to the notches. This
numerical behavior could be due to the notch geometry adopted in the present model.

Figure 18-b depicts a sequence of picture (A-K) corresponding to the evolution of the cohesive

46

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



A

Deform. Scale = 9600 Deform. Scale = 4800

Deform. Scale = 2400 Deform. Scale = 2400

Deform. Scale = 1200 Deform. Scale = 600

B

B

C

C

D E

E

F

F

G

G to L

H I

J K

(b) (c)

A

B

C D E F

G

H

I

J

L

P
 x

 1
0

  
[N

]
4

Vertical displacement δ [mm]

(a)

-0.12-0.08-0.040

-4

-3

-2

-1

0

Point R

Bifurcation pseudo-time
(t    of Point R)

MS
DNS1
DNS2
DNS3
Experimental

K

t      at 
Point R
SD

N

Figure 18: Four point shear concrete specimen. (a) Experimental, MS and DNS structural loads P vs. vertical
displacements δ, (b) sequence of pictures showing the evolution of two cracks at the macro-structural scale (finite
elements in red belongs toΩhDDM (state 2), and elements in green belongs to the domainΩ

h
CSM (state 1)), (c) sequence

of pictures displaying the deformed configuration of the cells, in terms of displacement fluctuations, of the point R
shown in the inset of Figure 18-a (Elements in dark red correspond to bands which are in loading states, elements in
light red correspond to bands which are unloading).

47

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



cracks at the macro-scale. Finite elements in red belongs toΩhDDM (state 2), and elements in green
belongs to the domain ΩhCSM (state 1). Every picture A to K is related to the pseudo-time instant
shown in the (MS) structural response plot of Figure 18-a. Initially, two cracks start to propagate
at both notch roots (picture E). However, the crack initiated in the superior notch stops, while the
other continues propagating.

The experimental report ([52]) shows one of the broken specimen, with the ratio: c/b =
0.4. From there, it can be observed a curved crack developing from the notch root to the load
application point. In the present simulation with c/b = 0.8, the crack inducing the structural
degradation is almost straight.

Figure 18-c shows a sequence of pictures displaying the failure evolution, in terms of dis-
placement fluctuations, of the mesoscopic cell associated with the macro-scale point R. The
macro-scale position of point R is marked in the inset of Figure 18-a. Every picture in Figure
18-c is associated with the points marked B-L in Figure 18-a, and display the cell fracture pro-
cess during the loading history. Elements in dark red correspond to bands which are in loading
(opening) states, and elements in light red correspond to bands which are unloading (or closing).
Observe the picture C corresponding to the instant tN when the finite element at the macro-scale
(in R) switches from state 0 to 1. Also, it is shown the picture G, at the instant when the strong
discontinuity (SD) is embedded into the same macro-scale element (switch from state 1 to 2). As
it is expected, the sequence of pictures shows that material degradation at point R starts in the
ITZ elements (picture B). A complex pattern of cracks is developed (inset D-F), and at the mo-
ment of embedding the strong discontinuity at the macro-scale (point G), the crack pattern at the
mesoscopic cell is well defined. After that (G to L), the crack pattern remains fixed until the end
of analysis.

Figure 19 shows the macro-scale crack path at the end of the analysis and the normal vectors
ne along the crack. Several deformed configurations of the mesoscopic cells, depicted in terms
of the displacement fluctuation field, corresponding to different points along the macro-crack, are
also shown.

b) Stress distribution

The color maps in Figure 20-a compares the smoothed fields of principal stresses (σI and
σIII ) obtained with the MS model and one of the DNS models. The load level P at which these
stress fields have been evaluated are depicted in the plot P vs. δ in Figure 20-b. At that instant,
the main cracks in both models have reached the positions also depicted in the inserts of the same
Figure.

In Figure 20-a, the homogenized stresses of the MS model have been taken from the quadrature
points placed on the regular domain of the beam. Then, they have been smoothed and finally the
principal stresses have been evaluated.

The DNS model stresses have been evaluated as a spatial averaging of the stress tensor into
circular domains of radius 12.5 mm centered in points coinciding with the nodal positions of the
MS mesh. The principal stresses of these averaged stress tensors are depicted in Figure 20-a.

From the results depicted in that Figure, it can be observed that even when the MS stress
distribution is a bit more noisy, it is notably good the close agreement between the stress results
provided by both models.

48

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



Figure 19: Four point shear concrete specimen:. Crack geometry at the macro-scale and failure mechanisms in several
mesoscopic cells associated with different points along the crack. Deformed configurations of the cells are depicted
using displacement fluctuations and a scale factor of 600. Distribution of normal vector ne along the crack path at the
macro-scale is shown in green arrows.

49

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



s  (MS) Is  (DNS) 
I

Principal streses [MPa]

s  (DNS)III s  (MS) III

(a)
(b)

Vertical displacement δ [mm]

P x 10  [N]4

Load level
at which stresses
are shown

Figure 20: Four point shear concrete specimen. Stress distribution at a given load level. a) Principal stress (σI ,σIII )
fields obtained with DNS and MS models, b) position of the main crack of the DNS and MS solutions at the instant of
stress capturing in Figure 20-a. Colored domains in the MS and DNS pictures have the same meaning as in Figures 17
and 18, respectively.

50

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



c) Comparison of results obtained with MS models using different micro-cell boundary conditions

In Figure 21, the solutions obtained with two MS models are depicted. We have compared the
solutions provided by the MS model with two different types of SBC constraining the micro-cell
kinematics. The type I BC’s correspond to SBC with minimal kinematical constrains and the type
II BC’s correspond to SBC with periodic kinematical constraints.

Figure 21-a plots the structural response of both simulations, while Figure 21-b display the
fracture at the end of analysis causing the structural collapse each case.

-0.12-0.08-0.040

 P [N]×10
4

-4

-3

-2

-1

0

Type I: SBC with minimum constraint

Type II: SBC with periodic constraints

MS Type I: SBC with 
Minimum kinematical constraints

MS Type II: SBC with 

periodic constraints

Vertical displacement δ [mm]

(a) (b)

Figure 21: Four point shear concrete specimen: Comparison of results obtained with the MS model using micro-cells
with two types of SBC: type I (SBC with minimum kinematical constraints) and type II (SBC with periodic kinematical
constraints). a) structural responses, b) cracks at the end of analysis (colored domains have the same meaning as in
Figures 18).

5 Conclusion

The main contribution of the paper focuses on describing the numerical implementation of a two-
scale semi-concurrent model for fracture analysis. Cohesive surfaces are assumed at both scales
of analysis.

The distinctive characteristic of this model is that it assumes two different homogenization
procedures to describe the overall material response during the material degradation process:

i) Initially, during the stable response of a point in the macro-scale, a homogenization proce-
dure, denoted MMRp, is adopted. For a macro-scale point which is outside the influence
zone of a cohesive crack, the MMRp is identical to conventional homogenization techniques
previously reported in the literature. In the context of finite element implementations, the
technique has been called FE2 (Feyel and Chaboche [53]). Contrarily, if the material re-
sponse is stable but the macro-scale point is inside the influence zone of a cohesive surface,

51

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



the macro-scale strain insertion into the RVE does not follow this kind of approach due to
the influence of the tortuosity parameter θ. Thus, in this case, the MMRp can be considered
as a novel and non-standard homogenization procedure.

The bifurcation criteria of the macro-scale response, defined in equation (41), is detected
using the MMRp homogenization procedure. In that instant, a macro-scale CSM is intro-
duced. The cohesive forces, acting between both interfaces, decrease according with the
degradation process of the overall material behavior. Therefore, the traction at the initial
instant of the crack insertion is the peak stress of the resulting cohesive interface model
introduced at the macro-scale.

Due to the semi-concurrent characteristic of the model, the information is transferred be-
tween scales in both directions. As can be noted, the homogenized overall stress is deter-
mined with a micro-scale analysis performed in one RVE, whose driving force is the inserted
macro-scale strain.

From this observation, we conclude that the peak stress of the resulting cohesive model,
which is the overall stress at the bifurcation time projected onto the surface normal vec-
tor, is strongly influenced by the macro-scale strains at that instant. This conclusion is of
paramount importance when modeling ductile failure.

ii) After detecting the singularity of the acoustic tensor at the macro-scale, a CSM is in-
troduced. The cohesive forces are determined with a homogenization procedure denoted
MMSp. In this case, the displacement jump across the interfaces, β, as well as the strains
of the neighbor points, εR, are properly inserted into the micro-scale in order to perform
the analysis and finally to homogenize the overall traction vector. Again, the evolution of
the cohesive force clearly depends on εR, and therefore, an identical conclusion to that pre-
sented in item (i) is obtained for evaluating the post-critical stage of the material degradation
process.

In previous works of the authors, it has been proven that the resulting cohesive constitutive
relation, traction vs. displacement jump, is objective with respect to the micro-cell size, with
the condition that the micro-cell satisfies the criteria of being a RVE during the stable pro-
cess of the analysis. This model property has been preserved in the new technique proposed
in this paper.

A final but not less important outcome of this work is that according with the sensitivity anal-
ysis performed in this study, we conclude that:

1) the definition of the standard boundary conditions (SBC) has not affected the capturing of
complex failure patterns intersecting the micro-cell at different angles, such as shown in the
strips stretched at different angles (case a of Section 4.2);

2) results, in terms of the homogenized traction-separation law at the macro-scale, have not
been sensitive to the finite element size (case b of Section 4.2).

Even when the numerical assessment of the model has been performed by simulating a quasi-
brittle fracture problem, it is considered that this methodology can be adapted, with minor changes,

52

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



for modeling ductile failure problems in the context of a large deformation setting. This is matter
of current research.

Acknowledgments

S.Toro, P.J. Sánchez and A.E. Huespe acknowledge the financial support from CONICET (grant
PIP 2013-2015 631) and from the European Research Council under the European Unions Sev-
enth Framework Programme (FP/2007-2013) / ERC Grant Agreement N. 320815 (ERC Advanced
Grant Project Advanced tools for computational design of engineering materials COMP-DES-
MAT). P.J. Blanco and R.A. Feijóo acknowledge the financial support provided by the Brazilian
agencies CNPq and FAPERJ.

References
[1] D. Dugdale. Yielding of steel sheets containing slits. J. Mech. Phys. Solids, 8:100–108, 1960.

[2] G. Barenblatt. The mathematical theory of equilibrium of cracks in brittle fracture. Adv. Appl. Mech., 7:55–129,
1962.

[3] A. Needleman. A continuum model for void nucleation by inclusion debonding. J. of Appl. Mech., 54(3):525–531,
1987.

[4] X.P. Xu and A. Needleman. Numerical simulations of fast crack growth in brittle solids. J. of the Mech. Phys.
Solids, 42:13971434, 1994.

[5] A. Needleman. Some issues in cohesive surface modeling. Procedia IUTAM, 10:221–246, 2014.

[6] M.L. Falk, A. Needlemann, and J.R. Rice. A critical evaluation of dynamic fracture simulation using cohesive
surfaces. J. de Physique IV, pages Pr–5–43 to Pr–5–50, 2001.

[7] X.P. Xu and A. Needleman. Numerical simulations of dynamic crack growth along an interface. Int. J. Fracture,
74(4):289–324, 1995.

[8] A. Pandolfi, P. Krysl, and M. Ortiz. Finite element simulation of ring expansion and fragmentation: the capturing
of length and time scales through cohesive models of fracture. Int. J. Fracture, 95(1-4):279–297, 1999.

[9] J.W. Hutchinson and A.G. Evans. Mechanics of materials: top-down approaches to fracture. Acta Materialia, 48
(1):125–135, 2000.

[10] V. Tvergaard. Crack growth predictions by cohesive zone model for ductile fracture. J. of the Mech. Phys. Solids,
49(9):2191–2207, 2001.

[11] T. Siegmund and W. Brocks. A numerical study on the correlation between the work of separation and the
dissipation rate in ductile fracture. Engrg. Fracture Mech., 67(2):139–154, 2000.

[12] A.E. Huespe, A. Needleman, J. Oliver, and P.J. Sánchez. A finite thickness band method for ductile fracture
analysis. International Journal of Plasticity, 25(12):2349–2365, 2009.

[13] A.E. Huespe, A. Needleman, J. Oliver, and P.J. Sánchez. A finite strain, finite band method for modeling ductile
fracture. International Journal of Plasticity, 28(1):53–69, 2012.

[14] A. Hillerborg, M. Modéer, and P.E. Petersson. Analysis of crack formation and crack growth in concrete by means
of fracture mechanics and finite elements. Cement and concrete research, 6(6):773–781, 1976.

53

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



[15] Z.P. Bažant. Concrete fracture models: testing and practice. Engrg. Fracture Mech., 69(2):165–205, 2002.

[16] M. Elices, G.V. Guinea, J. Gomez, and J. Planas. The cohesive zone model: advantages, limitations and chal-
lenges. Engrg. Fracture Mech., 69(2):137–163, 2002.

[17] J. Oliver, A. E. Huespe, M. D. G. Pulido, and E. Chaves. From continuum mechanics to fracture mechanics: the
strong discontinuity approach. Engineering Fracture Mechanics, 69:113–136, 2002.

[18] J. Oliver. On the discrete constitutive models induced by strong discontinuity kinematics and continuum consti-
tutive equations. Int. J. Solids Struct., 37:7207–7229, 2000.

[19] V. Tvergaard and J.W. Hutchinson. The relation between crack growth resistance and fracture process parameters
in elasto-plastic solids. J. of the Mech. Phys. Solids, 40:1377–1397, 1992.

[20] L. Xia and C.F Shih. Ductile crack growth I. A numerical study using computational cells with micrstructurally
based length scales. J. Mech. Phys. Solids, 43:233–259, 1995.

[21] Franck J Vernerey, Wing Kam Liu, Brian Moran, and Gregory Olson. A micromorphic model for the multiple
scale failure of heterogeneous materials. Journal of the Mechanics and Physics of Solids, 56(4):1320–1347, 2008.

[22] P.J. Sánchez, P.J. Blanco, A.E. Huespe, and R.A. Feijóo. Failure-oriented multi-scale variational formulation:
micro-structures with nucleation and evolution of softening bands. Comput. Meth. App. Mech. Eng., 257:221–
247, 2013.

[23] I.M. Gitman, H. Askes, and L.J. Sluys. Representative volume: Existence and size determination. Engineering
Fracture Mechanics, 74:2518–2534, 2007.

[24] V.P. Nguyen, O. Lloberas-Valls, M. Stroeven, and L.J. Sluys. On the existence of representative volumes for
softening quasi-brittle materials - a failure zone averaging scheme. Comput. Meth. App. Mech. Eng., 199:3028–
3038, 2010.

[25] T. Belytschko, S. Loehnert, and J.H. Song. Multiscale aggregating discontinuities: A method for circumventing
loss of material stability. Int. J. Numer. Meth. Engng., 73:869–894, 2008.

[26] T. Belytschko and J.H. Song. Coarse-graining of multiscale crack propagation. Int. J. Num. Meth. Eng., 81(5):
537–563, 2010.

[27] M.G.D. Geers, V.G. Kouznetsova, and W.A.M. Brekelmans. Multi-scale computational homogenization: Trends
and challenges. Journal of Computational and Applied Mathematics, 234:2175–2182, 2010.

[28] E Bosco, VG Kouznetsova, and MGD Geers. Multi-scale computational homogenization–localization for propa-
gating discontinuities using x-fem. ijnme, 102(3-4):496–527, 2015.

[29] V.P. Nguyen, O.Lloberas-Valls, and L.J. Sluys M. Stroeven. Homogenization-based multiscale crack modelling:
from micro diffusive damage to macro cracks. Comput. Meth. App. Mech. Eng., 200:1220–1236, 2010.

[30] C.V. Verhoosel, J.J.C. Remmers, M.A. Gutiérrez, and R. de Borst. Computational homogenization for adhesive
and cohesive failure in quasi-brittle solids. Int. J. Numer. Meth. Engng., 83:1155–1179, 2010.

[31] J. Oliver, M. Caicedo, E. Roubin, A.E. Huespe, and J.A. Hernández. Continuum approach to computational
multiscale modeling of propagating fracture. Computer Methods in Applied Mechanics and Engineering, 294:
384–427, 2015.

[32] M.G. Kulkarni, P.H. Geubelle, and K. Matous. Multi-scale modeling of heterogeneous adhesives: Effect of
particle decohesion. Mechanics of Materials, 41:573–583, 2009.

[33] P.J. Blanco, P.J. Sánchez, E.A. de Souza Neto, and R.A. Feijóo. Variational foundations and generalized unified
theory of RVE-based multiscale models. Arch. Comput. Methods Eng., 2014. DOI 10.1007/s11831-014-9137-5.

54

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



[34] R. Hill. On constitutive macro-variables for heterogeneous solids at finite strain. Proc. R. Soc. London, 326, 1972.

[35] J. Mandel. Plasticit Classique at Viscoplasticit. CISIM Lecture Notes. Springer-Verlag, 1971.

[36] E.A. de Souza Neto and R.A. Feijóo. Variational foundation on multi-scale constitutive models of solids: small
and large strain kinematical formulation. LNCC Research & Development Report No 16, 2006.

[37] E.A. de Souza Neto and R.A. Feijóo. On the equivalence between spatial and material volume averaging of stress
in large strain multi-scale solid constitutive models. Mechanics of Materials, 40:803–811, 2008.

[38] D. Perić, E.A. de Souza Neto, R.A. Feijóo, M. Partovi, and A.J. Carneiro Molina. On micro-to-macro transi-
tions for multi-scale analysis of non-linear heterogeneous materials: unified variational basis and finite element
implementation. Int. J. Num. Meth. Eng., 87:149–170, 2011.

[39] E.A. de Souza Neto and R.A. Feijóo. Variational foundations of large strain multiscale solid constitutive models:
Kinematical formualtion. In M. Vaz, E.A. de Souza Neto, and P.A. Muoz-Rojas, editors, Advanced Computational
Materials Modeling. From Classical to Multi-Scale Techniques, pages 341–378, Weinheim, 2011.

[40] P.J. Blanco, P.J. Sánchez, E.A. de Souza Neto, and R.A. Feijóo. The method of multiscale virtual power for the
derivation of a second-order mechanical model. Mechanics of Materials, 2015, submitted.

[41] P.J. Blanco and S.M. Giusti. Thermomechanical multiscale constitutive modeling: accounting for microstructural
thermal effects. Journal of Elasticity, 115:27–46, 2014.

[42] E.A. de Souza Neto, P.J. Blanco, P.J. Sánchez, and R.A. Feijóo. An rve-based multiscale theory of solids with
micro-scale inertia and body force effects. Mechanics of Materials, 80:136–144, 2015.

[43] S. Toro, P.J. Sánchez, A.E. Huespe, S.M. Giusti, P.J. Blanco, and R.A. Feijóo. A two-scale failure model for
heterogeneous materials: numerical implementation based on the finite element method. Int. J. Num. Meth. Eng.,
97(5):313–351, 2014.

[44] S. Toro, P.J. Sánchez, P.J. Blanco, E.A. de Souza Neto, A.E. Huespe, and R.A. Feijóo. Multiscale formulation
for material failure accounting for cohesive cracks at the macro and micro scales. Int. J. of Plasticity, 76:75–110,
2016.

[45] J. Simo, J. Oliver, and F. Armero. An analysis of strong discontinuities induced by strain-softening in rate-
independent inelastic solids. Comput. Mech., 12:277–296, 1993.

[46] J. Oliver, I.F. Dias, and A.E. Huespe. Crack-path field and strain-injection techniques in computational modeling
of propagating material failure. Comput. Meth. App. Mech. Eng., 274:289–348, 2014.

[47] C. Miehe and A. Koch. Computational micro-to-macro transition of discretized microstructures undergoing small
strain. Arch. Appl. Mech., 72:300–317, 2002.

[48] J. Oliver, A.E. Huespe, S. Blanco, and D.L. Linero. Stability and robustness issues in numerical modeling of
material failure with the strong discontinuity approach. Comput. Meth. App. Mech. Eng., 195(52):7093–7114,
2005.

[49] O.L. Manzoli, A.L. Gamino, E.A. Rodrigues, and G.K.S. Claro. Modeling of interfaces in two-dimensional
problems using solid finite elements with high aspect ratio. Computers & Structures, 94:70–82, 2012.

[50] I. Carol, C.M. López, and O. Roa. Micromechanical analysis of quasi-brittle materials using fracture-based
interface elements. Int. J. Num. Meth. Eng., 52(1-2):193–215, 2001.

[51] J. F Unger and S. Eckardt. Multiscale modeling of concrete. Archives of Computational Methods in Engineering,
18(3):341–393, 2011.

55

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y



[52] P. Bocca, A. Carpinteri, and S. Valente. Size effects in the mixed mode crack propagation: softening and snap-
back analysis. Engineering Fracture Mechanics, 35(1):159–170, 1990.

[53] F. Feyel and J.L. Chaboche. FE2 multiscale approach for modelling the elastoviscoplastic behaviour of long fibre
SiC/Ti composite materials. Comput. Meth. App. Mech. Eng., 183:309–330, 2000.

56

Alfredo
Typewriter
Comput Mech (2016) 58:549–585DOI 10.1007/s00466-016-1306-y


	1 Introduction
	1.1 Literature review
	1.2 CSM from a novel RVE-based multi-scale framework

	2 Description of the multi-scale mechanical formulation
	2.1 Macro-scale model with cohesive surfaces
	2.1.1 Multi-scale evaluation of stresses and tractions

	2.2 Micro-scale model with cohesive surfaces
	2.2.1 Treatment given to the micro-scale displacement fluctuation increment field

	2.3 Scale-bridging equations

	3 Numerical implementation
	3.1 Macro-scale finite element model: EFEM technique
	3.1.1 Finite element with strain enrichment: Constant Strain Mode (CSM) and Discontinuous Displacement Mode (DDM)
	3.1.2 Discrete equilibrium equations

	3.2 Micro-scale finite element model
	3.2.1 Use of two-dimensional thin band-like domains
	3.2.2 Implementation of the insertion operator
	3.2.3 Displacement fluctuations and virtual action fields
	3.2.4 Micro-scale variational equilibrium problem.
	3.2.5 Degenerated CST elements with strain localization for simulating the RVE failure: pros and cons

	3.3 A tracking algorithm for determining the macro-scale crack path

	4 Numerical assessment
	4.1 Concrete failure modeling at the meso-scale
	4.2 Multi-scale model sensitivity analysis
	4.3 Four point shear concrete specimen

	5 Conclusion



