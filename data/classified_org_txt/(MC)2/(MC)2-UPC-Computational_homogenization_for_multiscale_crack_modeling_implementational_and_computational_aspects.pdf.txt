

























































cohesive.eps


INTERNATIONAL JOURNAL FOR NUMERICAL METHODS IN ENGINEERING
Int. J. Numer. Meth. Engng 2000; 00:1–6 Prepared using nmeauth.cls [Version: 2002/09/18 v2.02]

Computational homogenization for multiscale crack modelling.
Implementational and computational aspects.

Vinh Phu Nguyen 1∗, Oriol Lloberas-Valls 1, Martijn Stroeven 1, Lambertus
Johannes Sluys 1

1Delft University of Technology, Faculty of Civil Engineering and Geosciences, P.O. Box 5048, 2600 GA
Delft, The Netherlands

SUMMARY

A computational homogenization procedure for cohesive and adhesive crack modelling of materials
with a heterogeneous microstructure has been recently presented in Comput. Methods Appl. Mech.
Engrg. 2010; DOI:10.1016/j.cma.2010.10.013. The macroscopic material properties of the cohesive
cracks are obtained from the inelastic deformation manifested in a localization band (modelled with
a continuum damage theory) at the microscopic scale. The macroscopic behavior of the adhesive
crack is derived from the response of a microscale sample representing the microstructure inside the
adhesive crack. In this manuscript, we extend the theory presented in Comput. Methods Appl. Mech.
Engrg. 2010; DOI:10.1016/j.cma.2010.10.013 with implementation details, solutions for cyclic loading,
crack propagation, numerical analysis of the convergence characteristics of the multiscale method and
treatment of macroscopic snapback in a multiscale simulation. Numerical examples including crack
growth simulations with extended finite elements are given to demonstrate the performance of the
method. Copyright c© 2000 John Wiley & Sons, Ltd.

key words: representative volume element (RVE), quasi-brittle materials, softening, multiscale,

computational homogenization, cohesive law, fracture, XFEM, interface elements

1. INTRODUCTION

Homogenization of heterogeneous materials has been the subject of intensive research over the
past decades. A particular homogenization method, computational homogenization (CH) [1],
has been utilized to predict mechanical behavior of materials having complex microstructures,
see [2, 3, 4, 5] among others. Not only mechanical problems describing linear and nonlinear
deformations but also thermal problems [6, 7] and multi-physics (thermo-mechanical) problems
[8] have recently been addressed by this method. Other applications encompass thin structures
[9, 10, 11, 12, 13]. A unified variational basis of CH theory for bulk materials has been recently
presented in [14]. When implemented in a finite element (FE) framework, the method is known
as an FE2 [15] scheme or, more generally, a multilevel finite element method [16].

∗Correspondence to: v.p.nguyen@tudelf.nl Delft University of Technology, Faculty of Civil Engineering and
Geosciences, P.O. Box 5048, 2600 GA Delft, The Netherlands

Received February 23, 2011
Copyright c© 2000 John Wiley & Sons, Ltd. Revised February 23, 2011



2 V.P. NGUYEN ET AL.

Before [17], studies on homogenization have focussed mainly on determining the effective
properties of the macroscopic bulk materials. In [17], the authors developed a computational
homogenization scheme for a material layer possessing a heterogeneous microstructure. The
behavior of the macroscale material layer (the macro-layer follows an initially elastic cohesive
law) is coming from microscale FE computations in which the microstructure is explicitly
discretized. Following studies include [18, 19, 20, 21]. According to [22], a review of recent
developments of CH methods, homogenization for material layers is qualified as homogenization
towards (initially elastic) cohesive laws.

Although computational homogenization has been used with great success in predicting
behaviour of many nonlinear heterogeneous materials, when it is used for softening materials
the method seems to be of limited use. One major reason is that the homogenized response
is not objective with respect to the size of the micro-sample (known as representative volume
element (RVE)) used to define the microscale boundary value problem (BVP)- the larger the
micro-samples the more brittle the macroscopic response is. In other words, the RVE does not
exist when using standard computational homogenization techniques on softening materials,
as stated in [23]. The second reason, not less important, is the sensitivity of the macroscale
response with respect to the macroscale discretization due to softening (the macroscopic BVP
is ill-posed) [24]. In [24] this problem is solved by a coupled-volume technique in which
regularization is preserved in the micro-sample which is coupled in size to the macroscale
element. To overcome this second drawback, in [25, 26] a macroscale localization band of fixed
width is inserted upon microscale localization. The latest development of this method can be
found in [27]. A somewhat similar method, the multiscale aggregating discontinuity (MAD)
method, has been presented in [28, 29] in which a crack is introduced at the macroscale when
material stability is lost, the crack direction and its opening are all derived from the microscale
information. Those methods work well for materials with a periodic microstructure (because
the RVE is well defined as a unit cell), particularly for masonry in [25, 26] and for fiber
reinforced composite in [28, 29]. If the methods are about to be utilized for materials with a
random microstructure, sensitivity of the method with respect to the size of the micro-sample
should be checked. Recently, a multiscale method for impact modelling of viscoelastic solids
having a random microstructure that contains a field of evolving microcracks has been given
in [30].

In [31], a new CH scheme for crack modelling which is objective with respect to the micro-
sample size has been presented. The method does not suffer from the two aforementioned
drawbacks of standard CH methods. It is however restricted to discrete cracking at the
microscale. This means that the behavior of a macroscopic cohesive crack is derived from
an opening micro-crack. In [32], the authors presented a similar method which is suitable for
many quasi-brittle softening materials such as soil and concrete which show damage to be
smeared over a zone at the microscale. In this method, the behavior of a macroscopic cohesive
crack is coming from the inelastic deformation of a microscale localization band (modelled,
for instance, with a continuum damage theory). The method is implemented in a FE2 setting
in the sense that the constitutive behavior of a material point on the macro-crack is defined
during the computation (e.g., on the fly) from a microscopic sample. The objectivity of this
method with respect to the micro-sample size has been demonstrated in [32] and the existence
of an RVE for softening materials has been positively confirmed in [33]. The present manuscript
is a continuation of [32].

The new contribution of this paper is three-fold. We first present some implementation

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 3

details including a new way to compute the macroscopic tangent. We then discuss the extension
of the method to the loading/unloading case and present a simple way to handle macroscopic
snapback in a multiscale computation. Finally some numerical examples including crack
propagation simulations and convergence characteristics study of the proposed multiscale
scheme are given to assess the performance of the method. Possibilities to enhance the
computational speed are also discussed.

Methods implemented in the FE2 setting are usually classified as multiscale methods with
weak coupling between macro- and micro-models. Multiscale modelling of failure of materials
with strong coupling between macro- and micro-models has been reported in [34, 35, 36, 37].
For a detailed classification of existing multiscale methods, the reader is referred to [29].
Another multiscale method with strong macro-micro coupling has been given in [38] for elasto-
plastic multiphase materials and in [24] for quasi-brittle softening materials. These methods
are adequate for moderate jumps between the scales and when the principle of separation of
scales between the macroscopic and microscopic length scales does not hold.

The remainder of the paper is structured as follows. In the next section, the finite element
models utilized at the macroscale and microscale are discussed together with constitutive
laws. Section 3 presents the computational homogenization schemes for adhesive and cohesive
cracks. Section 4 describes some implementational and computational aspects of the proposed
multiscale crack modelling framework. In the final section, numerical examples are given to
demonstrate the performance of the method.

2. MACROSCALE AND MICROSCALE MODELS

In this manuscript, two notations are adopted namely tensor notation and matrix/engineering
notation. In matrix notation, the same symbols as for tensors are used to denote the matrices
but the connective symbols (used to express the operators) are skipped e.g., the stress-strain
relation is written as σ = D : ǫ in tensor notation and is equivalently (using Voigt notation)
written as σ = Dǫ in matrix notation. Both macroscale and microscale FE formulations adopt
the small-strain kinematics assumption.

2.1. Macroscale model

Let us consider a two dimensional solid ΩM shown in Fig.(1) with its boundary denoted by ΓM.
Prescribed tractions t̄ are imposed on the Neumann boundary ΓtM ⊆ ΓM whereas prescribed
displacements are imposed on the Dirichlet boundary ΓuM ⊆ ΓM. The discontinuity surface ΓdM
is composed of cohesive cracks Γcoh and adhesive cracks Γadh

†. It is emphasized that although
the material is heterogeneous, the macroscale solid is modelled as being homogeneous with
effective properties coming from a heterogeneous microscale model.

The discrete equation for quasi-static equilibrium reads

f
ext
M = f

int
M ≡ fbulkM + f cohM (1)

†In literature, adhesive cracks are also referred to as adhesive layers, thin material layers or predefined interfaces.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



4 V.P. NGUYEN ET AL.

t̄

ΓtM

ΓuM

ΩM

Γcoh

Γadh
tM

Figure 1. A two dimensional heterogeneous solid containing a cohesive crack and a heterogeneous
adhesive crack. Note that Γcoh represents only the portion of the cohesive crack where tM is non-zero.

where f extM is the external force vector, f
int
M is the internal force vector that consists of the bulk

force vector fbulkM and the cohesive force vector f
coh
M . They are given by

f
ext
M =

∫

ΩM

N
T
bdΩ +

∫

Γt
M

N
T
t̄dΓ (2)

f
bulk
M =

∫

ΩM

B
T
σMdΩ (3)

f
coh
M =

∫

Γd
M

N
T
tMdΓ (4)

where σM is the macroscale Cauchy stress tensor, b is the body force vector and tM is the
cohesive traction across the crack ΓdM. In this manuscript, subscripts �M and �m are used to
indicate if a quantity belongs to the macroscale or microscale, respectively. Some macroscale
quantities like b which do not appear at the microscale are written without the subscript
M. The strain-displacement matrix B and the shape function matrix N, which depend on a
specific finite element, are specified without subscript.
For cohesive cracks, a special version of the extended finite element method (XFEM) [39, 40],

the phantom node method [41, 42, 43] has been used. Only Heaviside enrichment is used, the
cracks thus grow element-wise. For adhesive cracks, we stick to the simpler option of using
zero-thickness interface elements (also known as cohesive zone elements or simply cohesive
elements) of which details can be found in [44, 45, 46, 47].

2.1.1. Constitutive model The bulk in the vicinity of a cohesive crack is assumed to be linear
elastic with effective properties determined in a pre-processing step (before the multiscale
simulation starts). That is

σM = D0 : ǫM (5)

where ǫM is the macroscale strain tensor and D0 is the fourth order tensor containing the

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 5

effective elastic moduli, which is computed by conventional homogenization theory, we refer
to Section 3.1.2 for the procedure.

The behavior of the adherents joined by the adhesive crack is independent of the
microstructure of the adhesive crack. It can be modelled with any constitutive laws. However
for the sake of this paper, the adherents are assumed to be linear elastic.

The behavior of the macroscale cohesive and adhesive cracks is coming from the microscale
models. Thus the macroscale cohesive law is generally given by

tM = Φ([[u]]M,σm) (6)

where [[u]]M is the displacement jump across the macro-crack and σm is the microscale stress
tensor. Note that for a cohesive crack, the cohesive law (tM, [[u]]M) is initially rigid while for
an adhesive crack, (tM, [[u]]M) is initially elastic. These are referred to as extrinsic and intrinsic
cohesive models according to [48].

2.1.2. Macroscale cohesive tangent The equilibrium equation (1) is solved in an incrementally
iterative manner for the macroscale nodal displacements uM. At Newton-Raphson iteration
i for a given load step, one has to solve the linear system Ki−1M ∆u

i
M = f

int,i−1
M − f extM .

Contributions to the macroscale tangent stiffness matrix KM include the bulk stiffness and
cohesive stiffness matrices. The formula of the former is standard and hence not reported here.
The latter is given by

K
coh
M =

∫

Γd
M

N
T
TMNdΓ (7)

with TM, the macroscale cohesive tangent, defined as

TM =
∂Φ

∂[[u]]M
(8)

2.2. Microscale model

w

h

Γm

Ωm

Figure 2. Microscale model: random heterogeneous material undergoing localized
damage. The contour plot shows the damage field (white color for undamaged

material and black color for completely damaged material).

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



6 V.P. NGUYEN ET AL.

The microscale model, shown in Fig.(2), is a w × h rectangular domain Ωm with external
boundary Γm where the heterogeneities are explicitly resolved. Geometry of the micro-model
(w, h and morphology of the microstructural constituents) depends on whether the macroscale
crack to which this micro-model is associated is cohesive or adhesive, see Fig.(1). Let us
denote the characteristic length of the micro-constituents as d (e.g., the mean diameter of the
inclusions in a matrix/inclusion material) then the dimension of the microscale model must
be large enough i.e., w, h ≫ d in order for the homogenized quantities to become independent
of the microstructural randomness. When this condition is fulfilled, our proposed CH scheme
is objective with respect to the micro-sample size.

2.2.1. Constitutive model Damage of the microstructural constituents is modelled by a simple
isotropic damage model. The stress-strain relation is given by [49]

σm = (1− ω)Dem : ǫm (9)

where ω is the scalar damage variable (0 ≤ ω ≤ 1) and the fourth order tensor Dem contains
the elastic moduli. The microscale strain tensor is denoted by ǫm. Damage is governed by the
following exponential law [50]

ω = 1−
κ

κI
[1− α+ α exp−β(κ−κI)], κ ≥ κI (10)

where α (residual stress), β (softening slope) and κI (damage threshold) denote the inelastic
parameters. In the above, the history variable κ evolves according to the Kuhn-Tucker
conditions

f ≤ 0, κ̇ ≥ 0, κ̇f = 0 (11)

for the loading function f = ǭeq−κ where ǭeq is the so-called non-local equivalent strain. This
loading function is evaluated at integration points.

2.2.2. FE model at the microscale To regularize the local damage model given above, we
utilize the implicit gradient enhanced formulation presented in [51] in which the non-local
equivalent strain ǭeq is computed from the local equivalent strain ǫeq according to

ǭeq − c∇2ǭeq = ǫeq (12)

For tensile failure studied in this work, ǫeq follows the Mazars definition [50] and c is a positive
valued parameter of the dimension length squared. Equation (12) is solved with the boundary
condition ∇ǭeq · n = 0 on Γm where n is the outward unit normal at the boundary Γm. A
discussion on potential consequences of this boundary condition to the non-local interactions
between microstructural phases is given in [33]. Note that the multiscale framework presented
in this work is not restricted to the gradient enhanced regularization type given in Eq.(12).
Other regularization methods such as the integral type non-local theory [52] or the viscous
regularization approach [53] can be equally utilized as well.

The FE equations read [51]

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 7

∫

Ωm

B
T
uσmdΩ = f

ext
m ([[u]]M) (13a)

∫

Ωm

N
T
ǫ NǫǭeqdΩ +

∫

Ωm

B
T
ǫ cBǫǭeqdΩ =

∫

Ωm

N
T
ǫ ǫeqdΩ (13b)

where Bu is the standard strain-displacement matrix, Nǫ is a row vector containing the shape
functions used to discretize ǭeq and Bǫ = ∇Nǫ. It is emphasized that the RHS of Eq.(13a) is
different from the formulation given in [51]. In the proposed multiscale scheme, since the micro
model is coupled to an integration point on the macro-crack, it is loaded by the displacement
jump of this integration point. Thus, the microscopic external force vector depends on the
macroscopic displacement jump. Note that at the microscale, the inertia force and the body
force can be neglected as suggested in [54].
Equation (13) can be written in a general format as

f
int
m (um) = f

ext
m ([[u]]M) (14)

with um is the microscale nodal unknowns vector. Note that um contains both nodal
displacements and nodal non-local equivalent strain degrees of freedom (dofs) ǭeq. Note that
the bold symbol ǭeq indicates the nodal values of the corresponding non-local equivalent strain
field ǭeq.

3. MACRO-MICRO COUPLING

3.1. Macro-micro coupling for cohesive cracks

The problem that we are solving is that given a displacement jump [[u]]M of an integration point
on the macro-crack, find the corresponding traction tM. Borrowing ideas from conventional
CH theory for the bulk of the solid, this is achieved by transforming [[u]]M to a microscale
model which is associated to this integration point‡, the microscale BVP is then solved. The
macro-traction tM is defined as a function of the microscale stresses. Figure (3) shows the
multiscale cohesive crack modelling framework using computational homogenization.
The difficulty lies in how to define such a link which yields an objective macroscopic response

with respect to the size of the micro-sample in the sense that when the micro-sample is large
enough to be independent of the microstructural randomness, larger samples will lead to the
same response. It has been shown in [33, 32] that by extracting the microscale response in the
loading damaged domain (rather than in the entire microscale domain as done in conventional
homogenization theory), the homogenized response becomes independent of the micro-model
size as long as the micro-sample is sufficiently large so that the homogenized properties are
independent of the microstructural randomness. This is achieved by the recently emerged
failure zone averaging technique [33] which is briefly described in what follows.

‡To reduce the implementation complexity and computer resources, in this work, it has been assumed that the
RVEs for all integration points on a macro-crack are identical.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



8 V.P. NGUYEN ET AL.

t̄ t̄

ΓtMΓ
t
M

ΓuM Γ
u
M

Ωm

Ωd

ΩM
ΩM

solve

micro BVP

n

x1m

x2m

[[u]]M
[[u]]M

tM, TM

macro cohesive crack

micro localization band

micro unloading damage band

Figure 3. Schematic representation of the multiscale cohesive crack scheme.

Let us first denote Ωd as the microscale region containing Gauss points which are damaged
and loading. Mathematically Ωd is defined as

Ωd = {x ∈ Ωm | ω(x) > 0, f(x) = 0} (15)
where f is the loading function, see Section 2.2.1. The active damaged domain is computed as
the accumulated tributed area of all Gauss points that are damaged and loading.
The homogenized strain 〈ǫ〉dam is then defined as the volume average of its microscale

counterpart over Ωd

〈ǫ〉dam =
1

|Ωd|

∫

Ωd

ǫmdΩ (16)

where |·| denotes the measure of the domain. This domain integral is computed using the same
numerical quadrature rule that is used to integrate the microscale stiffness matrices.
We define the displacement of this active damaged domain Ωd as the projection of 〈ǫ〉dam

on the macro-crack plane

udam = 〈ǫ〉dam · (ln), l =
|Ωd|
h

(17)

where l is the averaged width of the localization band Ωd and n is the outward unit normal
vector of the crack. Note that this expression was obtained for the case in which the localization

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 9

band cuts the micro sample at two points, one on the lower edge and the other on the upper
edge, see Fig. (3). This is, however, a valid assumption considering mode I failure studied in
this work.
It has been shown in [32] that the (tM,udam) curves are objective with respect to the size

of the micro-model exhibiting one dominant localization band. This is the case for materials
having a random complex microstructure in tensile and shear loadings. Therefore, if [[u]]M is
defined to be equal to udam, we obtain an objective macroscale cohesive law (tM, [[u]]M). The
final homogenization relation is given by

uR = [w − l]C0 · tM + [[u]]M + ůdam (18)
where C0 is the projection of the compliance tensor D

−1
0 on the macro-crack plane and uR is

the displacement of the right edge of the RVE. In the above, ůdam is udam evaluated at the
moment that microscale softening occurs which is defined as the moment that first negative
eigenvalues of TM are detected, see [32] for the derivation details. Note that the first term on
the RHS of the above equation is the linear part of the total microscale displacement. It should
be mentioned that Eq. (18) resembles Equation (19) in [31] in the limiting case of l going to
zero (which is indeed the case in [31] as discrete micro cracking is assumed).
For macroscale load step n and macroscale Newton-Raphson iteration i, at a Gauss point

gp with [[u]]M, the system of equations at the microscale is thus given by

f
int
m (um) = f

ext
m ([[u]]M)

uR(um) = [w − l]C0 · tM + [[u]]M + ůdam
(19)

which is solved for the microscale nodal unknowns um and the macro-traction tM. This system
of equations is solved iteratively by first imposing an initial displacement on the micro-model,
then the microscale equilibrium equation Eq.(19)1 is solved, next Eq.(19)2 is checked. If it is
not satisfied, a new value of the initial displacement is calculated and the process is repeated
until both equations of Eq.(19) are satisfied. More details on the process can be found in [32].
Box (1) shows the pseudocode of the multiscale crack framework. Note that during step (A) in
Box (1) the microscale BVP must be solved p > 1 times. This is a crucial difference between
the proposed method and the standard FE2 method.
The macro-traction tM and macroscale cohesive tangent matrix TM are derived in [32] and

are given by, respectively

tM =
1

h

nb∑

I=1

f
int
m,I (20a)

TM =
1

h
M

T
K

∗,R
m M (20b)

where nb is the number of nodes on the right edge of the micro-sample where the boundary
conditions (BCs) are applied (details on BCs of the micro-model are given in Section 3.3) and
the [2nb × 2] matrix M is given by

M =

[
1 0 1 0 · · · 1 0
0 1 0 1 · · · 0 1

]T

(21)

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



10 V.P. NGUYEN ET AL.

Box 1 Flowchart of the multiscale crack framework implemented in a FE2 setting.

1. For a macroscale load step n and Newton-Raphson iteration i do

(a) Loop over elements to compute f cohM
(1)

i. Loop over integration points on the crack segment

• Get the macro-jump [[u]]M
• Compute tM and TM with microscale computations

A. Solve the micro-problem given in Eq.(19) (2)

B. Compute the macro-traction tM via Eq.(20a)
C. Compute the macro-tangent TM via Eq.(20b)

• Compute f cohM using tM
• Compute KcohM using TM

ii. End loop over integration points

(b) End loop over elements

2. Proceed to the next iteration
3. Upon convergence of load step n, commit the state of all micro-models.

(1) Computation of the bulk contribution fbulkM is done as in standard FEM.
(2) With state (nodal unknowns and internal variables) being reset to its previous converged
values.

The [2nb × 2nb] matrix K∗,Rm is the microscale stiffness matrix associated to the right edge
displacement dofs. Details on how to compute this matrix and thus TM are given in Section
4.2. Note that TM is generally not symmetric because the microscale stiffness matrix is non-
symmetric due to the adopted damage constitutive law.

3.1.1. Crack initiation/propagation criterion Following [31] the initiation/propagation
criterion and the growth direction for the macroscale cohesive crack is purely macroscopic
i.e., the macro-crack propagates based on the macroscale stress field. However note that
microstructural effects have a contribution to the macro-crack initiation/propagation because
the macroscale stress field is computed from the effective properties, see Eq.(5). We utilize
the maximum principal stress criterion as the crack initiation/propagation indicator and the
non-local stresses, computed as a weighted average of stresses, at the crack tip to determine
the crack direction as proposed in [40]. Note that in [28, 27, 29] the macro-crack direction has
been computed using information from the micro-model. In our opinion, this only makes sense
when the microscopic length scale is of the same magnitude as the macroscopic length scale.

Remark 3.1. The works in [25, 26] have used a failure criterion based on microscopic
information for the macroscopic crack initiation/propagation. In our scheme, since only the
macroscopic crack and not the macroscopic bulk is coupled to an RVE, we could not use
such a microscopic failure criterion. For quasi-brittle heterogeneous materials, the utilization
of the elastic macroscopic stresses as the driving force for crack initiation suffers from two
disadvantages (i) the pre-failure hardening stage cannot be captured and (ii) the predicted
peak is overshoot. Extension of the current multiscale scheme is reported in [55] in which

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 11

macro-crack initiation is based on a microscopic localization criterion. We refer to Remark
3.3 for a discussion on when the macroscopic stresses can be reasonably adopted to drive crack
initiation/propagation.

L

B

R

T

1 2

34

Figure 4. Boundary conditions imposed on a micro model to compute the effective elasticity constants.

3.1.2. Effective elasticity constants The effective elastic moduli tensor D0 can be determined
using either analytical or computational homogenization theory. While the former is applicable
to micro-samples with simple morphology such as circular or elliptical inclusions, the latter
can be used for any kind of microstructure and therefore is chosen in this work. Details can be
found in [5], here for sake of completeness, key equations are given. The BCs of the micro-model
consist of periodic boundary conditions Eq.(22), see Fig.(4), and prescribed displacements
Eq.(23)

uT = uB + u4 − u1
uR = uL + u2 − u1

(22)

with prescribed displacements for the corner nodes q = 1, 2, 4 defined as

uq = ǫM · xq,m = DTq ǫM, Dq =
1

2





2x1m 0
0 2x2m
x2m x

1
m





q

(23)

where we have switched to matrix-vector notation in the second equality. In the above, xq,m
denotes the nodal coordinates of node q with respect to the microscopic coordinate system
x1m − x2m, cf. Fig. (3).
The effective elastic tangent moduli D0 is given by

D0 =
1

|Ωm|
DK̄qqD

T, D = [D1 D2 D4] (24)

where the 6× 6 matrix K̄qq is obtained via a condensation of the microscale stiffness matrix.
Details can be found in [5].
In summary, to computeD0, we impose a strain vector [ǭ, 0, 0] to three corner nodes 1, 2 and 4

of the micro-mesh. The microscale BVP (for the effective elastic properties, the microscale BVP
is simply a linear elasticity problem) is then solved with periodic BCs. The converged linear

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



12 V.P. NGUYEN ET AL.

system of equations is condensed out to obtain K̄qq and equation (24) is used to compute D0.
Note that D0 is symmetric due to the fact that the microscopic stiffness matrix is symmetric.

Remark 3.2. It is worth noting that, for materials with a random heterogeneous
microstructure, the dimension of the micro-model used to compute the elastic effective
properties may differ from the dimension of the micro-model used to determine the macroscale
cohesive law.

3.1.3. Tensile strength of the homogenized material Evaluation of the maximum stress
criterion requires the tensile strength of the homogenized material. In the homogenization
multiscale scheme, this value is defined as the ultimate load of the micro-model σultm subjected
to a horizontal tensile loading. In other words, in a pre-processing step, one micro-model is
loaded in tension along the horizontal direction (BCs are described in Section 3.3) and its
ultimate load is computed as

σultm =
1

h

nb∑

I=1

f
int
m,I(τ) (25)

τ denotes the instance at which the peak is attained.

3.1.4. Micro model activation Unlike the conventional homogenization approach for the bulk
material and for an adhesive crack in which a micro-model is linked to a macroscale integration
point ab initio, in the multiscale cohesive crack scheme presented in this work, a micro-model
is brought into the scene when a new crack segment is initiated. Since the behavior of that new
crack segment comes only from the softening regime of the micro-model, this micro-model must
be loaded from an undeformed state to its peak. To this end, the micro-model is loaded, under
load control, from zero up to f̄ = γσultm h

§ together with homogeneous BCs and periodic BCs
as described in Section 3.3 with γ = 1− ǫ, where ǫ is a small positive number, is introduced to
ensure convergence of this activation step. Furthermore, nodes on the right edge of the micro-
model are forced to undergo the same displacement as shown in Fig.(5). After being activated,
the micro-model is loaded in displacement control, thus the force f̄ and the aforementioned
constraint are removed. This implies that the crack initiation/propagation criterion now reads
σIM ≥ γσultm where σIM denotes the maximum macroscale principal stress.
The coupling between the macro-model and the micro-model is summarized in Fig.(6). Note

that the pre-failure nonlinear (hardening) part of the micro-model, indicated in Fig.(6) by the
darker region, is not captured by the macro-model. Therefore, an assumption was made that
this hardening part is negligible. As can also be seen, the homogenized cohesive law is not
strictly initially rigid but has a small hardening portion.

Remark 3.3. When the assumption on the negligibility of the microscopic hardening part does
not hold, modifications to the proposed scheme should be made. One option is to compute the
macroscale bulk constitutive model on the fly as well. After crack nucleation, the macroscale
bulk integration points are no longer coupled to the micro-models but follow a linear elastic

§This is achieved by dividing f̄ into a number of sub-steps to ensure convergence.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 13

1

2

3

4

5

f̄

Ωm

Figure 5. Force control to activate the micro-model upon cohesive crack insertion. A force is applied
on node 1 whereas other nodes on the right edge are forced to have the same displacement as node 1.

um

fm

neglected

σM = D0 : ǫM

tM = Φ([[u]]M,σm)

σultm
γσultm

Figure 6. Coupling between macro- and micro-models for cohesive crack modelling.

law with effective properties evaluated at the crack nucleation moment. This option shares
similarity with the method given in [27]. However this is beyond the scope of this manuscript
and is presented in [55].

3.1.5. Principle of scale separation This section discusses the issue of the principle of scale
separation in the cohesive crack multiscale model. Let us recall that there are two quantities
that are averaged in the proposed model- the bulk material surrounding the crack and the
crack itself. The principle of scale separation applies for the bulk homogenization requires
that the dimension of the micro-sample (for bulk homogenization) must be much smaller than
the macroscopic lengthscale so that the macroscale fields (stress or strain) are uniform over
the micro-sample. For the crack homogenization, in order to satisfy the principle of scale
separation, the micro-sample should be small enough compared to the macroscale fracture
process zone (FPZ) so that the averaged quantities (e.g., tM or [[u]]M) are constant over it.
Since the FPZ is not know a priori, this condition is currently checked only a posteriori. One
potential solution is that for cohesive integration points in the FPZ, if the principle of scale
separation does not hold, micro-models with smaller dimension are used. This kind of RVE-size
adaptivity is a topic of future research.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



14 V.P. NGUYEN ET AL.

3.2. Macro-micro coupling for adhesive cracks

t̄ t̄

ΓtMΓ
t
M

ΓuM Γ
u
M

Ωm

Ω1MΩ1M
Ω2M

Ω2M

solve

micro BVP
n

x1m

x2m

[[u]]M [[u]]M

tM, TM

tadh

w ≤ tadh

zero-thickness interface elements

micro localization band

Figure 7. Schematic representation of the multiscale adhesive crack scheme.

Figure (7) presents the scheme of the multiscale framework for an adhesive crack of thickness
tadh that joints two adherents Ω

1
M and Ω

2
M. The behavior of the adhesive crack is determined

by means of a micro-model that represents the microstructure inside the crack. The case in
which the micro-model width w is equal to tadh is referred to as case I whereas the case in
which w < tadh is denoted as case II, following the convention adopted in [31].

3.2.1. Case I When the micro-model width w equals tadh, one has uR = [[u]]M. The multiscale
scheme is thus trivial. The macro-jump is directly imposed on the right edge of the RVE,
the microscale BVP is solved. The macro-traction and the macroscale cohesive tangent are
computed via Eqs.(20a) and (20b). This scheme was first presented in [17] for small strain
problems and later in [18] for finite deformations and shares similarity with the one given in
[21].

3.2.2. Case II The homogenization relation for an adhesive crack in case that the micro-
model width is smaller than the adhesive crack thickness i.e., w < tadh has been first derived
in [31] for microscale discrete cracking and then in [32] for microscale localized damage. The
final equation is the same and is given by

uR = (w − tadh)C0 · tM + [[u]]M (26)

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 15

which provides the homogenization relation between microscale information and the macroscale
cohesive law (tM, [[u]]M). Comparing this expression with Eq.(18) (for cohesive cracks) shows
that Eq.(26) can be obtained from Eq.(18) with l = tadh (the compliance is now scaled with
tadh) and ůdam = 0 (since the adhesive crack is present in the macro-model at the onset of the
simulation).
The system of equations needs to be solved at the microscale is thus given by

f
int
m (um) = f

ext
m ([[u]]M)

uR(um) = (w − tadh)C0tM + [[u]]M
(27)

that consists of the microscale equilibrium Eq.(14) and the homogenization relation Eq.(26).
This system of equations is solved using an iterative scheme that is similar to the one for
cohesive cracking, the reader is referred to [32] for details. However it is emphasized that the
above system of equations is different from the one for the cohesive crack, Eq.(19), in the sense
that while the latter filters out the microscopic linear response so that the macro-jump equates
the microscale inelastic displacements, the former adjusts the microscopic linear displacements
so that the case II solution matches the case I solution.
It is emphasized that since the homogenization relation given in Eq.(26) is only applicable

to the softening regime, Eq.(27) only ensures that its solution in the softening regime coincides
the solution obtained with the case I algorithm (for the same considered problem). The linear
regime is solved using the case I algorithm but with uR = (w/tadh)[[u]]M

¶. The transition from
the linear regime to the softening regime is detected by the appearance of negative eigenvalues
of the macro cohesive tangent TM [25].
The flowchart for the multiscale adhesive crack schemes is almost identical to the one for

cohesive cracks, cf. Box (1). The only differences lies in step (A)- solving Eq.(14) for the case
I scheme and solving Eq.(27) for the case II scheme. A discussion on the trade-offs of using
the case I or case II scheme for a given problem has been given in [32].

Remark 3.4. Although the homogenization equation (26) resembles the equation that was
derived in [31], we briefly presented the scheme for adhesive crack multiscale modelling due
to the following reasons. The case I scheme is exactly the same and given here merely for
completeness. For the case II scheme, [31] considered microscopic discrete cracking while we
are studying microscopic diffusive damage. Furthermore, note that our iterative scheme used
to solve Eq.(27) is different from the solution technique adopted in [31].

3.3. Boundary conditions of the microscale model

Boundary conditions of the boundary nodes of a micro-mesh are given by

periodic BCs : uT = uB + u2 − u1
fixed BCs : uL = 0
prescribed BCs : uR = g([[u]]M)

(28)

¶This guarantees that the linear responses obtained by case I and case II algoritms are identical, see [32] for
explaination.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



16 V.P. NGUYEN ET AL.

independent nodes

dependent nodes

top

bottom

interior

pulled

cons

1

T

B

L R

2

Figure 8. Illustration of various node groups in a simple micro-mesh.

see Fig.(8) for notations. In the above, u indicates the microscale displacement dofs, g([[u]]M) =
[[u]]M for the case I adhesive crack model. For cohesive scheme and the case II adhesive scheme,
the reader is referred to [32] for details. Note that these notations will be used in the sequel.
This kind of BCs is first given in [17] and referred to as hybrid BCs/semi-periodic BCs in [18].

4. ALGORITHMIC ASPECTS

In this section, various implementation details are presented. Note that the basic
implementation of a multilevel FEM can be found elsewhere for instance in [5]. The efficient
solution of the microscale nonlinear problem with periodic BCs is discussed first. The extraction
of the macroscale cohesive tangent matrix TM from the microscale stiffness using the probing
method is then presented. The advantage of this method is that it avoids the inversion of a large,
sparse matrix and its explicit partition into sub-matrices. Treatment of arbitrary macro-crack
orientation i.e., the crack coordinate system is not aligned with the global coordinate system,
is also given. To the best of the authors’ knowledge, works on homogenization have focused
mainly on monotonic loading. Here we present a discussion on computational homogenization
for loading/unloading cases. Finally, resolving the snapback at the macroscopic scale with the
dissipation-based arc-length control [56] is presented.

4.1. Solution of micro problem

In what follows, the master-slave method, used to solve the microscopic linear system with
periodic constraints, is presented in details. It is emphasized that in [18] the same topic has
been given. However, we present a somewhat different implementation and this section will
be needed in subsequent presentation. In this section, the subscript m (indicating microscale
quantities) is omitted for sake of clarity.
Let us first write the periodic BCs given in Section 3.3 in the following format

δud = Cδui (29)

where C is the dependency matrix; subscripts d and i denote dependent and independent

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 17

degrees of freedom, respectively, see Fig.(8).
The full microscale nodal unknowns vector can be written in terms of the independent nodal

values as

δu =

[
δui
δud

]

=

[
I

C

]

δui ≡ Tδui (30)

with I being the [3ni× 3ni]‖ unit matrix (ni is the number of independent nodes) and T being
the so-called transformation matrix which is a rectangular matrix.
The microscale linearized system is rearranged as

[
Kii Kid
Kdi Kdd

] [
δui
δud

]

=

[
ri
rd

]

(31)

with r being the residual vector.
By substituting Eq.(30) into the above and pre-multiplying both sides with TT we obtain

[
I CT

]
[

Kii Kid
Kdi Kdd

] [
I

C

]

δui =
[
I CT

]
[

ri
rd

]

(32)

which yields the sought-for reduced system

K
∗δui = r

∗ (33)

with K∗, a [3ni × 3ni] matrix and r∗, a [3ni × 1] vector, being given by

K
∗ = TTKT

r
∗ = TTr

(34)

Usually Eq.(33) is solved for the independent displacement increments and then the dependent
displacement increments are computed via Eq.(29) (e.g., [5, 18]). Here, we prefer solution
methods that do not alter the dimension of the stiffness matrix. This has several advantages.
First, there is no need to keep track of which dof corresponds to which unknown in the
linear solver. Second, there is no need to store a new, constrained matrix (K∗) if the linear
system is solved with an iterative solver. In this case we just keep the original matrix, and
apply the matrix T in each matrix-vector multiplication. A third advantage is that in parallel
computations each processor can setup and apply constraints without having to modify the
communication data structures in the linear solver. Precisely, the following system is solved
instead of Eq.(33)

[
TTKmT 0

0 I

]

︸ ︷︷ ︸

K̄m

[
δui
δud

]

=

[
r∗

δud

]

(35)

In words, the matrix K∗ has been augmented with the trivial equation Iδud = δud so that
K̄m is of the same dimension as Km.

‖This unit matrix is for 2D. Note that for the gradient enhanced damage model used at the microscale, there
are three dofs per node.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



18 V.P. NGUYEN ET AL.

Remark 4.1. The motivation for premultiplying Eq. (31) with TT in order to obtain Eq. (32)
is as follows. Matrix T essentially encodes the relationship between the independent dofs and
all dofs, including the dependent dofs. This means that matrix TTKT can be viewed as the
projection of matrix K on a vector space spanned by the independent dofs. In other words, the
full system of equations is projected on the vector space spanned by the independent dofs and
is then solved for the resulting, smaller system of equations.

4.2. Probing method to compute the macroscale cohesive tangent

Equation (35) can be written in the following format at the converged state of the microscale
BVP





K̄aam K̄
ab
m 0

K̄bam K̄
bb
m 0

0 0 I









δuam
δubm
δud



 =





0

δfb
δud



 (36)

with b denoting dofs associated to nodes on the right edge and a are the dofs of the remaining
nodes excluding top nodes, see Fig.(8). The above allows the following condensation

K
∗,bb
m δu

b
m = δfb (37)

with

K
∗,bb
m = K̄

bb
m − K̄bam (K̄aam )−1K̄abm (38)

This [3nb × 3nb] matrix can be filtered to get K∗,Rm , a [2nb × 2nb] matrix which involves only
displacement dofs of the nodes b, as following

K
∗,R
m = A

T
K

∗,bb
m A (39)

where A is a [3nb × 2nb] boolean matrix. Note that if the FE formulation adopted at the
microscopic scale involves only displacement dofs (e.g., in a non-local integral damage model)
the above step is skipped.

Substituting Eq.(38) into Eq.(20b) yields

TM =
1

h
M

T
A

T[K̄bbm − K̄bam (K̄aam )−1K̄abm ]AM (40)

For materials with complex multi-phase microstructures, the microscale stiffness matrix Km
could be a very large, sparse matrix of which inversion and partition operations are obviously
inefficient. In order to avoid them, we use the so-called probing technique that is a very simple
technique to construct a matrix, here TM, from a series of matrix-vector products. This matrix
is built in a columnwise manner. The first column of TM is computed by multiplying the RHS
of Eq.(40) with e1 = [1 0]

T

T
1
M =

1

h
M

T
A

T[K̄bbm f − K̄bam (K̄aam )−1K̄abm f ], f = AMe1 (41)

In order to compute K̄bbm f and K̄
ab
m f , it suffices to do the following matrix-vector multiplication

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 19

[
K̄aam K̄

ab
m

K̄bam K̄
bb
m

] [
0

f

]

=

[
K̄abm f

K̄bbm f

]

≡
[

g

h

]

(42)

The first column of TM is then given by

T
1
M =

1

h
M

T
A

T[h− K̄bam (K̄aam )−1g] (43)

To compute (K̄aam )
−1g, it suffices to solve the following linear system

[
K̄aam K̄

ab
m

K̄bam K̄
bb
m

] [
u

0

]

=

[
g

0

]

(44)

Finally, to compute K̄bam (K̄
aa
m )

−1g = K̄bam u, the following matrix-vector multiplication is used

[
K̄aam K̄

ab
m

K̄bam K̄
bb
m

] [
u

0

]

=

[
K̄aam u

K̄bam u

]

≡
[

m

l

]

(45)

To summarize, the first column of the consistent tangent moduli is given by

T
1
M =

1

h
M

T
A

T(h− l) (46)

which consists of the solution of a linear system Eq.(44) and two matrix-vector multiplications.
In the same manner, the second column of TM is computed with e2 = [0 1]

T. As
demonstrated, the procedure we follow does not directly need matrix inversion. Furthermore,
all the calculation involves only the total RVE matrix. No explicit sub-matrix is needed. For
ease of implementation, the procedure is given in Box 2.

Remark 4.2. It is emphasized that in [57] authors have proposed a perturbation method to
compute the macroscopic tangent in a multilevel finite element setting as an alternative to the
standard condensation procedure. Their reasoning was to avoid the large computer memory
required to store the microscopic sub-matrices. We have presented an implementation in which
the standard condensation is utilized that does not need to allocate any new sub-matrix.

4.3. Handling arbitrary macro-crack direction

The discussion so far applies to the case in which the angle (n, x1m) is zero. If this is not the
case as shown in Fig.(9a), there are two options. As the first option, the geometry of the
micro-model is rotated in order to align it with the macro-crack, see Fig.(9b). According to
the second option (adopted in this work), that is applicable to materials with a microstructure
having an isotropic geometry (e.g., random microstructure as the target material in this work),
the position of the micro-model is fixed, Fig.(9c), and we proceed as follows. The global macro-
jump vector is transformed to the local coordinate system associated to a point on the crack
surface by

[[u]]ns = Q[[u]]M (47)

This local jump vector is then used as boundary condition imposed on the RVE’s boundaries.
The first component of [[u]]ns is used as boundary condition along the x

1
m direction and the

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



20 V.P. NGUYEN ET AL.

Box 2 Computation of the macroscale cohesive tangent with the probing method

1. Assembling the micro stiffness Km
2. Constructing the modified matrix K̄m using Eq.(35)

(1)

3. Initialize 3n× 1 vectors d = 0 and f1 = 0, n is the total number of micro nodes
4. For i = 1, 2, do

(a) Compute f = Mei
(b) Set d[b] = f
(c) Compute rhs = K̄md, then g = rhs[a], h = rhs[b]
(d) Solve the linear system K̄mu = f1 with f1[a] = g

(2)

(e) Compute rhs = K̄mu, then m = rhs[a], l = rhs[b]
(f) Compute column i as TiM =

1
h
MT(h− l)

5. End for

(1) This is not needed when using an iterative solver.
(2) With homogeneous boundary conditions u[b] = 0.

ΩM

Ωm x
1
m

x2m

n

(a) (b) (c)

Figure 9. Arbitrary macro crack orientation (a), rotated RVE geometry (b) and (c)-fixed RVE geometry
(applicable to microstructure having isotropic geometry).

second one along the x2m direction. After solving the RVE problem, one obtains the macro-
traction and tangent in the local coordinate system, tns and Tns, using Eq.(20a) and Eq.(20b),
respectively, and they are transformed back into the global coordinate system as follows

tM = Qtns, TM = QTnsQ (48)

with Q being the orthogonal transformation matrix, see [58].
It should be emphasized that the option using rotated micro-model geometry, see Fig. (9b),

must be used for materials having a microstructure with a preferential direction (e.g., masonry).

Remark 4.3. Note that option described in Fig. (9b) is general i.e., can be applied to any
materials whereas option given in Fig. (9c) saves computational efforts for materials with
isotropic geometry. It is emphasized that the proposed approach, see Fig. (9c), would not work
for non-proportional loadings. For example, an initial loading causes damage in the micro-

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 21

sample, then unloading occurs, and the load direction is changed, subsequently causing the
micro-sample to be further damaged. Because of the first damaging phase the micro-sample
becomes anisotropic thus violating the assumption on the isotropy of the micro-sample upon
which the proposed approach has been developed i.e., the proposed algorithm would be invalid.

20

2
05

50
√
2

20
√
2

20
√
2

70
√
2

450

E 25000 N/mm2

ν 0.2

κI 3e-05

α 0.999

β 5000

c 3.5 mm2=

=

=

=

=

=

Figure 10. Inclined material layer having a periodic voided microstructure. Unit of length is mm.

As an example to illustrate the idea, let us consider the problem shown in Fig.(10) which
consists of two homogeneous elastic adherents joined together by a voided damageable adhesive
layer. The sample is fixed in vertical direction at the bottom edge and in the horizontal direction
on the left and right edges. These BCs ensure that a homogeneous state of deformation is
obtained for all integration points on the adhesive crack. The simulation is performed under
a plane stress condition by means of a uniform vertical displacement being imposed on the
top edge. Finite element meshes of the Direct Numerical Simulation (DNS) model and the
multiscale model (case I model since w = tadh = 20 mm) are given in Fig.(11). In this
paper, the four-node linear interface element with Newton-Cotes integration (2 integration
points) rule is adopted to model the adhesive crack. Figure (12) gives the comparison of the
load-displacement curves of the DNS and multiscale models. The multiscale solution properly
follows the DNS solution. We attribute the small discrepancy between those two solutions to
the mismatch of geometries at the boundaries of the adhesive layer used in DNS and multiscale
simulations, see Fig. (13). Damage patterns in the DNS and in the RVEs are shown in Fig.
(14).

4.4. Loading/unloading treatment

4.4.1. Adhesive crack-case I Let us first consider Case I (micro sample width w equals tadh).
Since uR = [[u]]M, unloading is handled naturally i.e., macroscale unloading follows microscale
unloading. Therefore, no further work is needed.

4.4.2. Adhesive crack-case II/cohesive crack For Case II, we have uR 6= [[u]]M and for cohesive
cracks, the failure zone averaging scheme fails when unloading occurs (because the active
damaged domain Ωd is empty). For these reasons, loading/unloading is treated with a history
variable being the maximum opening displacement ever reached [[u]]maxM . Assuming secant

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



22 V.P. NGUYEN ET AL.

DNS mesh FE2 meshes

Figure 11. Inclined material layer: DNS mesh and multiscale meshes.
The thick line denotes the interface elements.

 0

 5

 10

 15

 20

 25

 30

 35

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9

lo
a
d
 [
N

]

displacement [mm] (x10-2)

DNS
FE2

Figure 12. Inclined material layer: comparison of load-displacement
curves between DNS and multiscale (case I).

DNS

Multiscale

Figure 13. Inclined material layer: Geometry mismatch in DNS and multiscale (case I) models.

unloading, the macro traction is then defined as

tM =
tmaxM
[[u]]maxM

[[u]]M (49)

since tmaxM cannot be computed from [[u]]
max
M analytically due to the lack of a phenomenological

cohesive law, it is computed from the micro-model corresponding to the state right before
unloading occurs. Note that during macro unloading, the micro-model is not loaded and thus

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 23

Figure 14. Damage pattern in the DNS (left) and in RVEs associated to interface elements (right).

no micro-BVP is needed to be solved.

ū

100

2
0
0

20× 20

40× 20

40× 40

Figure 15. A simple problem (all units in mm) with a vertical material layer having thickness
of 40 mm. The layer is made of a periodic voided microstructure. Three RVEs (voids with

a radius of 5) shown in the right are investigated.

As an example for handling loading/unloading in a multiscale simulation, we consider a
simple test given in Fig.(15) which consists of two adherents joined by an adhesive layer of 40
mm thickness. When the prescribed displacement ū equals 0.4 mm, the sample is unloaded and
then reloaded until final failure of the sample. A plane stress condition is assumed. Material
properties of the micro-model can be found in Fig.(10) except the softening slope β = 3000.
The load-displacement curves shown in Fig.(16) verify, for both case I (micro-models 40×40

and 40 × 20) and case II (micro-model 20 × 20) schemes, the objectivity of the macroscale
response with respect to the adopted micro-model for loading/unloading excitations.

4.5. Macroscale snapback with dissipation-based arc-length control

Tracing equilibrium paths with snap through and snapback points has been traditionally
undertaken by means of path-following methods (also known as arc-length methods), see for
instance [59, 60]. A very elegant method, the dissipation-based arc-length method, has been
recently introduced in [56, 61] to trace complex equilibrium paths, see [43] for application

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



24 V.P. NGUYEN ET AL.

 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8

lo
a
d
 [
N

]

displacement [mm] (x10-2)

20x20
40x20
40x40

Figure 16. Multiscale cohesive law with unloading behavior.

examples. In this section, we present a preliminary study on resolving macroscopic snapback in
a multiscale setting. Note that for the particular material model we are using at the microscale,
no microscale snapback has occurred. If this is about to happen, a solution has been reported
in [62]. To the best of our knowledge, no multiscale simulation which involves both macroscopic
and microscopic snapback has been reported in literature.
According to the dissipation-based arc-length method [56, 61], the macroscale system of

equations is given by

f
int
M (uM) = λf̄

φ(λ,uM) = 0
(50)

where f̄ is a unit force vector, λ is the so-called load factor and φ is a constraint equation that,
for a given load step, defines λ in such a manner that a predefined amount of energy ∆τ is
released. Details can be found in [56, 61]. Contrary to other arc-length methods, φ is defined
in terms of global quanties and hence there is no need to keep tracks of areas where localized
nonlinearity is taking place. Usually, ∆τ is set to fall within the following bound

∆τmin ≤ ∆τ ≤ ∆τmax (51)

for example, the expression ∆τmax = δleGIc is often used [61] in a PUM method where a
crack is only extended over a single element after a converged step. In a FE2 setting, ∆τ must
be chosen smaller because all micro-models must converge. Since a universal rule for ∆τ that
ensures convergence of the macro-model and all micro-models is missing when the macro-model
does not converge, the corresponding macroscale load step is resolved with a smaller ∆τ .

Figure (17) describes the considered problem that shows macroscopic snapback behavior.
The macro-mesh is simply composed of two four-node quadrilateral (Q4) elements with one
interface element in between of which behavior is coming from two micro-samples, the 40× 20
mm2 one for the case I scheme and the 20× 20 mm2 one for the case II scheme. A plane stress
condition is assumed. The macroscale load-displacement curves obtained with two different
values of ∆τmin are given in Fig. (18).

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 25

100
5
0

1
5
045

o

20×20

40×20

E 25000

ν 0.2
E 25000 N/mm2

ν 0.2

κI 3e-05

α 0.999

β 5000

c 3.5 mm2=

=

=

=

=

=
=

=

Figure 17. A simple test with macro-snapback. The voids have a radius of 5. Unit of length is mm.

 0

 5

 10

 15

 20

 25

 30

 35

 40

 45

 50

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9

lo
a
d
 [
N

]

displacement [mm] (x10-2)

(a) ∆τmin = 0.02 Nmm, case I

 0

 5

 10

 15

 20

 25

 30

 35

 40

 45

 50

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9

lo
a
d
 [
N

]

displacement [mm] (x10-2)

(b) ∆τmin = 1e− 04 Nmm, case I

 0

 5

 10

 15

 20

 25

 30

 35

 40

 45

 50

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9

lo
a
d
 [
N

]

displacement [mm] (x10-2)

20x20
40x20

(c) ∆τmin = 1e− 04 Nmm, case II

Figure 18. Handling macroscopic snapback with a dissipation-based arc-length
control in the multiscale adhesive crack scheme.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



26 V.P. NGUYEN ET AL.

ū2
0
0

10010 10

20× 20

Figure 19. A simple problem with one cohesive crack that shows macroscopic
snapback. All units are in mm.

 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8

lo
a
d
 [
N

]

displacement [mm] (x 10-2)

Figure 20. Handling macroscopic snapback with a dissipation-based arc-length
control in the multiscale cohesive crack scheme.

For cohesive cracks, let us consider the problem depicted in Fig.(19). Material parameters
for the micro-model are given in Fig.(17) except β = 6000. A plane stress condition is assumed.
The load-displacement curve is given in Fig.(20). A value ∆τmin = 1e− 03 Nmm was used.
We have shown that the dissipation-based arc-length control presented in [56] can be

seamlessly adopted in the proposed multiscale crack modelling framework. It should be
mentioned that secant unloading is the critical assumption for allowing the arc-length control
to work.

5. NUMERICAL EXAMPLES

In this section, four numerical examples are given to demonstrate the performance of the
proposed multiscale method. In the first example, a simple macro-sample in uni-axial tension
is analyzed. The microstructure is, however, a complex random multi-phase material. The aim
of this example is to verify the objectivity of the method with respect to the micro-model size.
The convergence property of the presented method is investigated in the second example. The
wedge splitting test is analyzed in the third example in which a comparison against a DNS is
given. Finally, failure of a single edge notched beam (SEN) which involves the propagation of a

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 27

curved crack is given in the final example. Finite element meshes used in this section have been
generated using Gmsh [63] except the concrete micro-samples in the first and fourth example
that have been created using SPACE [64].

5.1. RVE’s existence test

15 x 15 mm2 20 x 20 mm2 

300

1
0
0

1010
15× 15 20× 20

Figure 21. Geometry, finite element discretization of the macro-model (left) and micro-samples (right)
for the RVE’s existence test. All units are in mm.

Matrix Aggregate ITZ

E [N/mm2] 25000 30000 20000
ν [-] 0.2 0.2 0.2
κI [-] 5e-06 0.5 3e-06
α [-] 0.999 0.999 0.999
β [-] 1500 1500 1500
c mm2 0.2 0.2 0.2

Table I. Material parameters of different phases of the random heterogeneous material.

In order to verify the objectivity of the multiscale solution with respect to the micro-model
size, the problem as shown in Fig.(21) is devised. Upon satisfaction of the failure criterion,
σIM ≥ 0.97σultm , a vertical crack is initiated in the middle element (we allowed only one crack
in this example). The behavior of this crack is coming from FE computations realized on two
micro-samples made of a three-phase material∗∗ (aggregate, matrix and interfacial transition
zone (ITZ)) of which material parameters can be found in Table (I). These samples correspond
to a 45% volume fraction of aggregates (of which radius varies from 2.5 mm to 5.0 mm). The
width of the ITZ is 0.25 mm. The microscale FE meshes consist of 10 052 and 18 208 three-
node triangle elements (T3 elements) for the 15 × 15 mm2 and the 20 × 20 mm2 sample,
respectively. A plane strain condition is assumed for the micro-models. The effective elastic
moduli D0 computed using the computational homogenization approach described in Section
3.1.2 are

∗∗This is the microstructure of concrete at mesoscale.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



28 V.P. NGUYEN ET AL.

D
15
0 =





29903.0 7485.55 −1.15865
7485.55 29905.9 0.919313
−1.15865 0.919313 11213.6



 ,D200 =





29804.3 7456.68 0.135379
7456.68 29812.1 0.0845691
0.135379 0.0845691 11173.7



 (52)

for micro-sample 15× 15 mm2 and 20× 20 mm2, respectively.
The objectivity of the macroscale solution with respect to the micro-model size can be judged

from Fig.(22) which shows the macroscale load-displacement curves obtained with two micro-
samples. It is emphasized that micro-samples smaller than 15×15 mm2 would yield a different
macroscale solution since these micro-samples are not large enough [33]. The homogenized
cohesive laws are also given in this figure. Note that since the crack was inserted slightly
before the ultimate load of the micro-model, the homogenized cohesive laws are not initially
rigid as conventional cohesive laws.

 0

 2

 4

 6

 8

 10

 12

 14

 16

 0  0.1  0.2  0.3  0.4  0.5

lo
a
d
 [
N

]

displacement [mm] (x 10-2)

15x15
20x20

 0

 0.02

 0.04

 0.06

 0.08

 0.1

 0.12

 0.14

 0.16

 0  0.1  0.2  0.3  0.4  0.5

tr
a
ct

io
n
 [
N

]

opening [mm] (x 10-2)

15x15
20x20

Figure 22. RVE’s existence test: objective macroscopic load-displacement diagrams obtained with
various microstructures (left) and homogenized traction-opening laws (right).

Remark 5.1. The number of load increments required to solve the macroscopic BVP from the
moment of crack nucleation until final failure is denoted as n. Each macroscale load increment
is done with an averaged number of m Newton-Raphson iterations. For one macroscale Newton-
Raphson iteration one has to solve 2p micro-BVPs (in this example there is only one crack
segment with 2 integration points). Therefore, the total number of micro-BVPs is n×m× 2p.
Considering that n = 60, m = 4 and p = 2, then for this simple example one has to solve 480
micro-BVPs of dimension 30 156 dofs (for the 15 × 15 mm2 sample). Needless to say, any
advanced techniques that is capable of reducing the computational cost of the proposed multiscale
scheme is necessary. One promising avenue is model order reduction methods applied to the
microscale damage model. Basic ideas have been set in [7, 65].

5.2. Convergence properties of the multiscale scheme

This example aims at giving some hints for the convergence properties of three multiscale
schemes presented before: adhesive crack scheme (case I and case II) and cohesive crack
scheme. The use of a consistent tangent matrix at the microscale yields an optimal quadratic
convergence rate for the microscale problem and hence convergence properties of the microscale

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 29

problem are standard and not reported. Rather, we focus on the convergence performance of
the Newton-Raphson iterative method at the macroscale and on the one of the iterative scheme
used to solve Eqs.(19) and (27).

For adhesive cracks, let us reconsider the problem given in Fig.(15), section 4.4. Material
properties of the micro-model can be found in Fig.(10). The sample is loaded under
displacement control with a constant step ∆u = 0.0001 mm. For the case I scheme (micro-
model is 40 × 20 mm2), the load-displacement diagram and the number of Newton-Raphson
(NR) iterations required for each macroscale load increment is given in Fig.(23). A quadratic
convergence rate can be observed from Table (II). Note that load step 31 is a difficult one since
the slope is almost vertical. That explains why 6 NR iterations were required for this step.

 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 0  0.1  0.2  0.3  0.4  0.5  0.6

lo
a

d
 [

N
]

displacement [mm] (x10-2)

40x20

31

 0

 1

 2

 3

 4

 5

 6

 7

 0  8  16  24  32  40

N
u
m

b
e
r 

o
f 
ite

ra
tio

n
s 

p
e
r 

st
e
p

Load step number

Figure 23. Adhesive scheme-case I: Load-displacement curve and the Newton-
Raphson iterations per macroscale load step.

The residual r is the standard scaled residual between the current iteration i and the first
iteration, which reads

r =

∣
∣
∣
∣f extM − f intM

∣
∣
∣
∣
i∣

∣
∣
∣f extM − f intM

∣
∣
∣
∣
1

(53)

where ||·|| is the L2 norm.

Step no. Iteration no. Residual r

31 1 4.6334e-02
2 2.4752e-02
3 2.5577e-02
4 3.5018e-03
5 1.1404e-04
6 1.3562e-07

36 1 3.3328e-02
2 1.7055e-04
3 4.3285e-09

Table II. Adhesive scheme-case I: performance of the macroscale Newton-Raphson method.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



30 V.P. NGUYEN ET AL.

We now turn our attention to the adhesive crack-case II scheme. In this case, the 20 × 20
mm2 micro-model is used. Figure (24) shows the load-displacement diagram and the number
of NR iterations required for each macroscale load increment. We attribute the need of a large
number of NR iterations (19) for macroscale load step 31 to two facts. The first one is the
almost vertical slope of the load-displacement curve at that point. The second is that step 31
is the transition step from a hardening regime to a softening regime. Let us recall that we use
two different schemes for the hardening and the softening parts, Section 3.2.2. By using a less
steep softening slope β = 3000 (so far β = 5000 was used), Figure (25) obviously shows that
the maximum number of NR iterations is just 4.

The bottom part of Fig.(24) gives the number of micro-BVPs that are solved for every
macroscale NR iterations. As can be seen, far from the peak, the micro-BVP is solved only
one time per macroscale NR iteration which is similar to standard FE2 methods.

 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 0  0.1  0.2  0.3  0.4  0.5  0.6

lo
a
d
 [
N

]

displacement [mm] (x10-2)

20x20

31

 0

 4

 8

 12

 16

 20

 0  8  16  24  32  40

N
u
m

b
e
r 

o
f 
ite

ra
tio

n
s 

p
e
r 

st
e
p

Load step number

 0

 1

 2

 3

 4

 0  31  62  93  124  155

N
u
m

b
e
r 

o
f 
m

ic
ro

 B
V

P

Macro Newton-Raphson iteration

Figure 24. Adhesive scheme-case II: load-displacement curve (top left), Newton-
Raphson iterations per macroscale step (top right) and number of micro-BVPs

for every macroscale Newton-Raphson iterations (bottom).

For the cohesive crack homogenization scheme, the problem given in Fig.(19) is considered
again. Material properties of the micro-model can be found in Fig.(10) except β = 1000 to have
a smooth macroscale equilibrium path. Figure (26) shows the load-displacement diagram and
the number of NR iterations required for each macroscale load increment. Three NR iterations
are needed for macroscale steps round the peak. The reduction in residuals for two macroscale
load increments around the peak is tabulated in Table (III). The bottom part of Fig.(26) gives
the number of micro-BVPs that are solved for every macroscale NR iterations. Far from the

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 31

 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 0  0.1  0.2  0.3  0.4  0.5  0.6

lo
a
d
 [
N

]

displacement [mm] (x10-2)

20x20

 0

 1

 2

 3

 4

 5

 0  10  20  30  40  50

N
u
m

b
e
r 

o
f 
ite

ra
tio

n
s 

p
e
r 

st
e
p

Load step number

Figure 25. Adhesive scheme-case II, smooth response with β = 3000: load-displacement curve, Newton-
Raphson iterations per macroscale step.

 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 100

 0  0.5  1  1.5  2  2.5

lo
a
d
 [
N

]

displacement [mm] (x 10-2)

20x20

 0

 1

 2

 3

 4

 0  22  44  66  88  110

N
u
m

b
e
r 

o
f 
ite

ra
tio

n
s 

p
e
r 

st
e
p

Load step number

 0

 1

 2

 3

 0  83  166  249  332  415

N
u
m

b
e
r 

o
f 
m

ic
ro

 B
V

P

Macro Newton-Raphson iteration

Figure 26. Cohesive crack scheme: load-displacement curve (top left), Newton-
Raphson iterations per macroscale step (top right) and number of micro-BVPs

for every macroscale Newton-Raphson iterations (bottom).

peak, the micro-BVP is solved only one time per macroscale NR iteration which is similar to
standard FE2 methods.

5.3. Wedge splitting test

The wedge splitting test, given in Fig.(27), is studied in this example. The sample is made
of a matrix-fiber material (with a weak transition zone, ITZ, to model matrix-fiber interface
debonding). In order to reduce the computational cost, the microstructure is only explicitly

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



32 V.P. NGUYEN ET AL.

Step no. Iteration no. Residual r

17 1 1.0189e-02
2 6.9791e-04
3 2.5718e-06

18 1 5.8094e-03
2 1.2804e-04
3 3.3568e-08

Table III. Cohesive crack scheme: performance of the macroscale Newton-Raphson method.

50

2
0
0

7
0

7
0

30 70

effective properties

5

5

10 samples

fiber with radius of 0.85 and ITZ’s thickness 0.08

Figure 27. Wedge splitting test: geometry (units in mm) and boundary conditions.

resolved in the region in front of the notch where the crack is expected to develop and grow.
The rest (shaded region) is modelled as homogeneously linear elastic with effective properties
(the Young’s modulus is 12647.66 N/mm2 and the Poisson’s ratio is 0.2). Material in the red
region follows the isotropic non-local damage model described in Section 2.2.1 with material
parameters being given in Tab.(IV). The analysis is performed under a plane stress state with
displacement control. This example is specially designed in order to make a comparison of
the proposed multiscale model with a DNS. A simple microstructure is taken and a single
localization band is promoted.
The FE discretization of the DNS model, shown in Fig.(28), consists of 25 368 three-node

triangle elements and 12 778 nodes (36 366 dofs). Finite element meshes of the macro-model
and micro-model in a multiscale simulation are given in Fig.(29). When σIM ≥ 0.999σultm , the
macro-crack initiates/propagates. In this example, due to symmetry, the crack direction at the
macroscale is forced to be horizontal.
Evolution of damage in the DNS and evolution of the macro-crack in the FE2 model is

shown in Figs.(30-31). An observation was made from Fig.(30) that the macro-crack in the
multiscale model runs slightly behind the localization band in the DNS. We attribute this to
two facts namely (i) the macroscopic load increments are larger for the FE2 simulation than
for the DNS and (ii) the difference in the failure criterion- in DNS, a strain-based damage

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 33

Matrix Fiber ITZ

E [N/mm2] 25000 30000 20000
ν [-] 0.2 0.2 0.2
κI [-] 5e-05 0.5 3e-05
α [-] 0.999 0.999 0.999
β [-] 100 100 100
c mm2 0.005 0.005 0.005

Table IV. Material parameters of different phases of the fiber-reinforced composite.

initiation criterion was used and in FE2 a stress-based crack initiation criterion was adopted.
It can be observed from Fig.(32) that boundary effects are still not properly handled in the
multiscale model. A remedy is to apply periodic BCs only for interior RVEs (e.g., RVEs far
from the boundaries) and better tailored BCs for boundary RVEs.

elements not allowed to be damaged

Figure 28. Wedge splitting test: FE mesh of the DNS model (25 368 three-node triangle elements).
Elements of the matrix phase in the upper part (red color) are not allowed to be damaged.

Comparison of the load-displacement curves of the DNS and multiscale model (denoted by
FE2) is depicted in Fig.(33). The peak load obtained with the DNS is 48.70 N while the peak
load obtained with the multiscale model is 48.36 N. The curve associated to the multiscale
model is not smooth due to two facts (i) the macroscopic load increment steps are large (to
reduce the computation time) and (ii) the mesh of the macro-model is quite coarse (keep in
mind that in our PUM implementation, the crack grows element-wise). It is emphasized that
in order to make a fair comparison between the DNS and the FE2, we have, in the DNS,
prevented damage from starting in the corners, see Fig.(28).

Concerning the computational cost, the DNS time was 14 hours while the FE2 time was
only 4 hours i.e., 3 times faster.

5.4. Single edge notched beam

As an example of a curved propagating crack analysis in the presented multiscale cohesive
crack framework, let us consider the single edge notched beam given in Fig.(34). This problem
has been studied experimentally in [66] and numerically in a monoscale setting by, for instance,

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



34 V.P. NGUYEN ET AL.

A

Figure 29. Wedge splitting test: FE meshes of the multiscale model. Macro-mesh consists of 1426
three-node triangle elements whereas micro-mesh composed of 4092 T3 elements. A crack is initiated
at point A and grows horizontally to the right edge. In the RVE, elements of the matrix phase in the
right part (red color) are not allowed to be damaged. Since the macro-crack direction is horizontal

whereas the micro localization band is vertical, the algorithm given in Section 4.3 is used.

2525

Figure 30. Wedge splitting test: damage pattern in the DNS model (top) and crack path with damaging
RVEs in the FE2 model at the peak.

[40] and in a multiscale setting by [29, 31]. In [31], the authors have studied the influence of the
microstructure on the macroscale ultimate load. The post-peak response have not therefore
been reported. Here, we focus on the issue of robustness of the proposed multiscale scheme.
The aim is to show that a complete multiscale analysis for curved crack propagation can be
achieved. No comparison against a DNS is therefore performed.
The beam is made of a concrete material. The behavior of the macro-crack, that is initiated

from the lower-right part of the notch and propagates in a curved trajectory toward to the
right of the lower-right support, is coming from microscale FE computations performed on a
10× 10 mm2 micro-model shown in Fig.(35b). The FE discretization is given in Fig.(35). The
load platens are modelled as steel. A plane stress condition is assumed for the micro-model.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 35

Figure 31. Wedge splitting test: damage pattern in the DNS model (top) at the moment the localization
band approaches the right edge of the specimen and crack path with damaging RVEs in the FE2 model.

Left most RVE Right most RVE

Figure 32. Boundary effects: periodic boundary conditions are not suitable for boundary RVEs.

Material parameters for the constituents of the three-phase microstructure can be found in
Table (I) except c = 0.1 mm2. When the maximum macroscale principal stress exceeds 99%
σultm , the crack initiates or propagates in a direction determined using the non-local stress field
at the crack tip, Section 3.1.1. To deal with a curved crack as in this example in which the
crack direction is not aligned to the micro-sample the algorithm given in Section 4.3 is used.

The analysis is performed using the dissipation-based arc-length method [56] together with
the sub-stepping scheme proposed in [67]. The sub-stepping technique allows the use of
relatively large macroscale load increments which dramatically reduces the computational cost
of FE2 computations. The basic idea of this scheme when applied to the multiscale cohesive
crack model is whenever the solution for the micro-BVP, Eq.(191), could not be obtained (the
corresponding macroscale load increment is big), the displacement being imposed on the RVE
is divided into sub-steps. It is emphasized resolving one diverged micro-model with sub-steps
is much cheaper than resolving the macro-model with a smaller macro load increment.

The deformed shape of the SEN beam is given in Fig.(36) in which the curved crack path as

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



36 V.P. NGUYEN ET AL.

 0

 10

 20

 30

 40

 50

 0  0.1  0.2  0.3  0.4  0.5

lo
a
d
 [
N

]

displacement [mm] (x 10-2)

DNS
FE2

Figure 33. Wedge splitting test: comparison of load-displacement curves between the DNS and the
multiscale cohesive crack scheme.

�
�
�
�����

1
0
0

440

20

20

20

2
0

20

5

P/11 10P/11

A B

Figure 34. Single edge notched beam (SEN): geometry (all units are in mm), boundary conditions.
The depth of the beam is 100 mm. The crack mouth sliding displacement (CMSD) is defined as the

difference in vertical displacement of points A and B.

experimentally observed is captured well. The response of the SEN beam, measured in terms
of the load P versus the CMSD, is given in Fig.(37).

6. CONCLUSIONS

In this manuscript, details concerning implementational and computational aspects of a
multiscale cohesive/adhesive crack modelling framework using computational homogenization
have been presented. The behavior of the macroscale cracks is derived from finite
element computations realized on microscale samples in which the underlying heterogeneous
microstructure that undergoes localized damage is explicitly taken into account. Various

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 37

10

1
0

(a) Macro-model

(b) Micro-model

Figure 35. The SEN beam: FE meshes of the macro-model (1219 Q4
elements) and micro-model (5280 T3 elements).

Figure 36. The SEN beam: deformed configuration of the beam (magnified by a factor of 500) and
snapshots of damaging micro-models.

 0

 0.2

 0.4

 0.6

 0.8

 1

 1.2

 1.4

 1.6

 1.8

 0  0.0005  0.001  0.0015  0.002  0.0025  0.003

F
o
rc

e
 P

 [
kN

]

CMSD [mm]

 0

 0.02

 0.04

 0.06

 0.08

 0.1

 0.12

 0.14

 0  0.001  0.002  0.003  0.004  0.005

tr
a
ct

io
n
 [
N

]

opening [mm]

Figure 37. The SEN beam: load P against CMSD (left) and a typical homogenized cohesive law (right).

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



38 V.P. NGUYEN ET AL.

issues including loading/unloading, macroscopic snapback, arbitrary crack orientation and
convergence characteristics of the multiscale scheme were addressed. Efficient implementation
of the master-slave method used to solve nonlinear equations with constraints has been
discussed. A probing method was given to compute the macroscale tangent matrix from the
microscale stiffness matrix without inversion and partition operations. The given numerical
examples show that the method can be used for failure analysis of solids with random
heterogeneous microstructures undergoing localized damage. It can also be utilized for better
designing materials by adjusting the underlying microstructural constituents’ shape and
properties.
Just like any computational homogenization method, the proposed method is

computationally demanding thus limits its applicability. Besides the conventional use of parallel
computers, model reduction techniques applied for the microscale damage models would
dramatically reduce the computational cost of computational homogenization based multiscale
simulations. Model adaptivity, in which microscale computations are made only for integration
points in the fracture process zone whilst others points follow an analytical cohesive law, is
also capable of enhancing the speed of the proposed method.

ACKNOWLEDGEMENTS

The financial support from the Delft Center for Computational Science and Engineering (DCSE)
is gratefully acknowledged. The first author thankfully appreciate the discussion with Dr. Erik Jan
Lingen at Habenara, The Netherlands.

REFERENCES

[1] P. M. Suquet. Local and global aspects in the mathematical theory of plasticity. In A. Sawczuk
and G. Bianchi, editors, Plasticity today: modelling, methods and applications, pages 279–310,
London, 1985. Elsevier.

[2] R.J.M. Smit, W.A.M. Brekelmans, and H.E.H. Meijer. Prediction of the mechanical behavior of
nonlinear heterogeneous systems by multi-level finite element modeling. Computer Methods in
Applied Mechanics and Engineering, 55:181–192, 1998.

[3] S. Ghosh, K. Lee, and S. Moorthy. Two scale analysis of heterogeneous elastic-plastic materials
with asymptotic homogenization and Voronoi cell finite element model. Computer Methods in
Applied Mechanics and Engineering, 132:63–116, 1996.

[4] C. Miehe, J. Schröder, and J. Schotte. Computational homogenization analysis in finite plasticity
simulation of texture development in polycrystalline materials. Computer Methods in Applied
Mechanics and Engineering, 171(3-4):387–418, 1999.

[5] V. Kouznetsova, W. A. M. Brekelmans, and F. P. T. Baaijens. An approach to micro-macro
modeling of heterogeneous materials. Computational Mechanics, 27(1):37–48, 2001.

[6] I. Özdemir, W.A.M. Brekelmans, and M.G.D. Geers. Computational homogenization for heat
conduction in heterogeneous solids. International Journal of Numerical Methods in Engineering,
73:185–204, 2008.

[7] E. Monteiro, J. Yvonnet, and Q.C. He. Computational homogenization for nonlinear conduction
in heterogeneous materials using model reduction. Computational Materials Science, 42(4):704–
712, 2008.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 39

[8] I. Özdemir, W.A.M. Brekelmans, and M.G.D. Geers. FE2 computational homogenization for the
thermo-mechanical analysis of heterogeneous solids. Computer Methods in Applied Mechanics
and Engineering, 198(3-4):602–613, 2008.

[9] B.C.N. Mercatoris, Ph. Bouillard, and T.J. Massart. Multi-scale detection of failure in planar
masonry thin shells using computational homogenisation. Engineering Fracture Mechanics,
76(4):479–499, 2009.

[10] E. W. C. Coenen, V. G. Kouznetsova, and M. G. D. Geers. Computational homogenization for
heterogeneous thin sheets. International Journal for Numerical Methods in Engineering, 83(8-
9):1180–1205, 2010.

[11] B.C.N. Mercatoris and T.J. Massart. A coupled two-scale computational scheme for the failure
of periodic quasi-brittle thin planar shells and its application to masonry. International Journal
for Numerical Methods in Engineering, 85(9):1177–1206, 2011.

[12] C. Oskay. Two-level multiscale enrichment methodology for modeling of heterogeneous plates.
International Journal for Numerical Methods in Engineering, 80:1143–1170, 2009.

[13] C. Oskay and G. Pal. A multiscale failure model for analysis of thin heterogeneous plates.
International Journal of Damage Mechanics, 19:575–610, 2010.

[14] D. Perić, E.A. de Souza Neto, R.A. Feijóo, M. Partovi, and A.J.C. Molina. On micro-to-macro
transitions for multi-scale analysis of non-linear heterogeneous materials: unified variational basis
and finite element implementation. International Journal for Numerical Methods in Engineering,
2010. In Press.

[15] F. Feyel. Multiscale FE2 elastoviscoplastic analysis of composite structures. Computational
Materials Science, 16(1-4):344–354, 1999.

[16] F. Feyel. A multilevel finite element method (FE2) to describe the response of highly non-linear
structures using generalized continua. Computer Methods in Applied Mechanics and Engineering,
192:3233–3244, 2003.

[17] K. Matouš, M. G. Kulkarni, and P. H. Geubelle. Multiscale cohesive failure modeling of
heterogeneous adhesives. Journal of the Mechanics and Physics of Solids, 56(4):1511–1533, 2008.

[18] C.B. Hirschberger, S. Ricker, P. Steinmann, and N. Sukumar. Computational multiscale modelling
of heterogeneous material layers. Engineering Fracture Mechanics, 76(6):793–812, 2009.

[19] M. G. Kulkarni, P. H. Geubelle, and K. Matouš. Multi-scale modeling of heterogeneous adhesives:
Effect of particle decohesion. Mechanics of Materials, 41(5):573–583, 2009.

[20] M.V. Cid Alfaro, A.S.J. Suiker, C.V. Verhoosel, and R. de Borst. Numerical homogenization
of cracking processes in thin fibre-epoxy layers. European Journal of Mechanics - A/Solids,
29(2):119–131, 2010.

[21] M. G. Kulkarni, K. Matouš, and P. H. Geubelle. Coupled multi-scale cohesive modeling of
failure in heterogeneous adhesives. International Journal for Numerical Methods in Engineering,
84(8):916–946, 2010.

[22] M.G.D. Geers, V.G. Kouznetsova, and W.A.M. Brekelmans. Multi-scale computational
homogenization: Trends and challenges. Journal of Computational and Applied Mathematics,
234(7):2175–2182, 2010.

[23] I.M. Gitman, H. Askes, and L.J. Sluys. Representative volume: Existence and size determination.
Engineering Fracture Mechanics, 74(16):2518–2534, 2007.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



40 V.P. NGUYEN ET AL.

[24] I.M. Gitman, H. Askes, and L.J. Sluys. Coupled-volume multi-scale modelling of quasi-brittle
material. European Journal of Mechanics - A/Solids, 27(3):302–327, 2007.

[25] T. J. Massart, R. H. J. Peerlings, and M. G. D. Geers. An enhanced multi-scale approach for
masonry wall computations with localization of damage. International Journal for Numerical
Methods in Engineering, 69(5):1022–1059, 2007.

[26] T.J. Massart, R.H.J. Peerlings, and M.G.D. Geers. Structural damage analysis of masonry walls
using computational homogenization. International Journal of Damage Mechanics, 16(2):199–
226, 2007.

[27] T.J. Massart and B.C.N. Mercatoris. Assessment of periodic homogenisation-based multiscale
computational schemes for quasi-brittle structural failure. International Journal for Multiscale
Computational Engineering, 7(2):153–170, 2009.

[28] T. Belytschko, S. Loehnert, and J.H. Song. Multiscale aggregating discontinuities: A method
for circumventing loss of material stability. International Journal for Numerical Methods in
Engineering, 73(6):869–894, 2008.

[29] T. Belytschko and J.H. Song. Coarse-graining of multiscale crack propagation. International
Journal for Numerical Methods in Engineering, 81(5):537–563, 2010.

[30] F.V. Souza and D.H. Allen. Multiscale modeling of impact on heterogeneous viscoelastic solids
containing evolving microcracks. International Journal for Numerical Methods in Engineering,
82(4):464–504, 2010.

[31] C.V. Verhoosel, J.J.C. Remmers, M.A. Gutiérrez, and R. de Borst. Computational
homogenisation for adhesive and cohesive failure in quasi-brittle solids. International Journal
for Numerical Methods in Engineering, 83(8-9):1155–1179, 2010.

[32] V.P. Nguyen, O. Lloberas-Valls, M. Stroeven, and L.J. Sluys. Homogenization-based multiscale
crack modelling: from micro-diffusive damage to macro-cracks. Computer Methods in Applied
Mechanics and Engineering, 200(9-12):1220–1236, 2011.

[33] V.P. Nguyen, O. Lloberas Valls, M. Stroeven, and L.J. Sluys. On the existence of representative
volumes for softening quasi-brittle materials-A failure zone averaging scheme. Computer Methods
in Applied Mechanics and Engineering, 199(45-48):3028–3038, 2010.

[34] P.A. Guidault, O. Allix, L. Champaney, and J.P. Navarro. A two-scale approach with
homogenization for the computation of cracked structures. Computers & Structures, 85(17-
18):1360–1371, 2007.

[35] T. Hettich, A. Hund, and E. Ramm. Modeling of failure in composites by X-FEM and level
sets within a multiscale framework. Computer Methods in Applied Mechanics and Engineering,
197(5):414–424, 2008.

[36] S. Eckardt and C. Könke. Adaptive damage simulation of concrete using heterogeneous multiscale
models. Journal of Algorithms & Computational Technology, 2:275–297, 2008.

[37] O. Lloberas-Valls, D. J. Rixen, A. Simone, and L. J. Sluys. Multiscale domain decomposition
analysis of quasi-brittle heterogeneous materials. International Journal for Numerical Methods
in Engineering, 2010. (Submitted, October 19, 2010).

[38] A. Ibrahimbegović and D. Markovič. Strong coupling methods in multi-phase and multi-
scale modeling of inelastic behavior of heterogeneous structures. Computer Methods in Applied
Mechanics and Engineering, 192(28-30):3089–3107, 2003.

[39] N. Moës, J. Dolbow, and T. Belytschko. A finite element method for crack growth without
remeshing. International Journal for Numerical Methods in Engineering, 46(1):131–150, 1999.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



COMPUTATIONAL HOMOGENIZATION FOR CRACKS IN QUASI-BRITTLE MATERIALS 41

[40] G. N. Wells and L. J. Sluys. A new method for modelling cohesive cracks using finite elements.
International Journal for Numerical Methods in Engineering, 50(12):2667–2682, 2001.

[41] J. Mergheim, E. Kuhl, and P. Steinmann. A finite element method for cohesive crack modelling.
PAMM, 4(1):350–351, 2004.

[42] J.H. Song, P.M.A. Areias, and T. Belytschko. A method for dynamic crack and shear band
propagation with phantom nodes. International Journal for Numerical Methods in Engineering,
67(6):868–893, 2006.

[43] F. van der Meer and L. Sluys. A phantom node formulation with mixed mode cohesive law for
splitting in laminates. International Journal of Fracture, 158(2):107–124, 2009.

[44] X.P. Xu and A. Needleman. Numerical simulations of fast crack growth in brittle solids. Journal
of the Mechanics and Physics of Solids, 42(9):1434, 1397, 1994.

[45] M. Ortiz and A. Pandolfi. Finite-deformation irreversible cohesive elements for three-dimensional
crack-propagation analysis. International Journal for Numerical Methods in Engineering,
44(9):1267–1282, 1999.

[46] J. C. J. Schellekens and R. de Borst. On the numerical integration of interface elements.
International Journal for Numerical Methods in Engineering, 36(1):43–66, 1993.

[47] G. Beer. An isoparametric joint/interface element for finite element analysis. International
Journal for Numerical Methods in Engineering, 21(4):585–600, 1985.

[48] D. V. Kubair and P. H. Geubelle. Comparative analysis of extrinsic and intrinsic cohesive models
of dynamic fracture. International Journal of Solids and Structures, 40(15):3853–3868, 2003.

[49] J. Lemaitre. A course on damage mechanics. Springer-Verlag, 1996.

[50] J. Mazars and G.Pijaudier-Cabot. Continuum damage theory - application to concrete. Journal
of Engineering Mechanics Division ASCE, 115:345–365, 1989.

[51] R. H. J. Peerlings, R. de Borst, W. A. M. Brekelmans, and J. H. P. de Vree. Gradient enhanced
damage for quasi-brittle materials. International Journal for Numerical Methods in Engineering,
39:3391–3403, 1996.

[52] G.Pijaudier-Cabot and Z.P.Bažant. Nonlocal damage theory. ASME Journal of Applied
Mechanics, 113:1512–1533, 1987.

[53] J. Simo and J. Ju. Strain- and stress-based continuum damage models-I. formulation.
International Journal of Solids and Structures, 23(7):821–840, 1987.

[54] C. Miehe. Computational micro-to-macro transitions for discretized micro-structures of
heterogeneous materials at finite strains based on the minimization of averaged incremental
energy. Computer Methods in Applied Mechanics and Engineering, 192(5-6):559–591, January
2003.

[55] V. P. Nguyen, M. Stroeven, and L. J. Sluys. A continuous-discontinuous multiscale method for
modelling cohesive cracks in random heterogeneous quasi-brittle materials. Computer Methods
in Applied Mechanics and Engineering, 2011. Submitted.

[56] M.A. Gutiérrez. Energy release control for numerical simulations of failure in quasi-brittle solids.
Communications in Numerical Methods in Engineering, 20(1):19–29, 2004.

[57] I. Temizer and P. Wriggers. On the computation of the macroscopic tangent for multiscale
volumetric homogenization problems. Computer Methods in Applied Mechanics and Engineering,
198:495–510, 2008.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls



42 V.P. NGUYEN ET AL.

[58] K.J. Bathe. Finite Element Procedures. Prentice Hall, 1996.

[59] R. de Borst. Computation of post-bifurcation and post-failure behavior of strain-softening solids.
Computers and Structures, 25(2):211–224, 1987.

[60] M. G. D. Geers. Enhanced solution control for physically and geometrically non-linear problems.
part II-comparative performance analysis. International Journal for Numerical Methods in
Engineering, 46(2):205–230, 1999.

[61] C. V. Verhoosel, J. J. C. Remmers, and M. A. Gutiérrez. A dissipation-based arc-length method
for robust simulation of brittle and ductile failure. International Journal for Numerical Methods
in Engineering, 77(9):1290–1321, 2009.

[62] T.J. Massart, R.H.J. Peerlings, and M.G.D. Geers. A dissipation-based control method for the
multi-scale modelling of quasi-brittle materials. Comptes Rendus Mécanique, 333(7):521–527,
2005.

[63] C. Geuzaine and J.-F. Remacle. Gmsh, a three-dimensional mesh generator with built-in pre-
and post-processing facilities. International Journal for Numerical Methods in Engineering,
79(11):1309–1331, 2009.

[64] M. Stroeven and P. Stroeven. SPACE system for simulation of aggregated matter application to
cement hydration. Cement and Concrete Research, 29(8):1299–1304, 1999.

[65] P. Kerfriden, P. Gosselet, S. Adhikari, and S. Bordas. Bridging proper orthogonal decomposition
methods and augmented Newton-Krylov algorithms: an adaptive model order reduction for highly
nonlinear mechanical problems. Computer Methods in Applied Mechanics and Engineering, 200(5-
8):850–866, 2010.

[66] E. Schlangen. Experimental and numerical analysis of fracture processes in concrete. PhD thesis,
Delft University of Technology, 1993.

[67] D.D. Somer, E.A. de Souza Neto, W.G. Dettmer, and D. Perić. A sub-stepping scheme for
multi-scale analysis of solids. Computer Methods in Applied Mechanics and Engineering, 198(9-
12):1006–1016, 2009.

Copyright c© 2000 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Engng 2000; 00:1–6
Prepared using nmeauth.cls

View publication statsView publication stats

https://www.researchgate.net/publication/230547967

	INTRODUCTION
	MACROSCALE AND MICROSCALE MODELS
	Macroscale model
	Constitutive model
	Macroscale cohesive tangent

	Microscale model
	Constitutive model
	FE model at the microscale


	MACRO-MICRO COUPLING
	Macro-micro coupling for cohesive cracks
	Crack initiation/propagation criterion
	Effective elasticity constants
	Tensile strength of the homogenized material
	Micro model activation
	Principle of scale separation

	Macro-micro coupling for adhesive cracks
	Case I
	Case II

	Boundary conditions of the microscale model

	ALGORITHMIC ASPECTS
	Solution of micro problem
	Probing method to compute the macroscale cohesive tangent
	Handling arbitrary macro-crack direction
	Loading/unloading treatment
	Adhesive crack-case I
	Adhesive crack-case II/cohesive crack

	Macroscale snapback with dissipation-based arc-length control

	NUMERICAL EXAMPLES
	RVE's existence test
	Convergence properties of the multiscale scheme
	Wedge splitting test
	Single edge notched beam

	CONCLUSIONS

