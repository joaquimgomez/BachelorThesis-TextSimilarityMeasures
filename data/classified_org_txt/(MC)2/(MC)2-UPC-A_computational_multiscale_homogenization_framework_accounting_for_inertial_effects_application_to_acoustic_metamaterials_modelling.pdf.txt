







































































A computational multiscale homogenization framework accounting for inertial effects: Application to acoustic metamaterials modelling


Accepted Manuscript

A computational multiscale homogenization framework accounting for
inertial effects: Application to acoustic metamaterials modelling

D. Roca, O. Lloberas-Valls, J. Cante, J. Oliver

PII: S0045-7825(17)30698-9
DOI: https://doi.org/10.1016/j.cma.2017.10.025
Reference: CMA 11653

To appear in: Comput. Methods Appl. Mech. Engrg.

Received date : 4 May 2017
Revised date : 22 September 2017
Accepted date : 26 October 2017

Please cite this article as: D. Roca, O. Lloberas-Valls, J. Cante, J. Oliver, A computational
multiscale homogenization framework accounting for inertial effects: Application to acoustic
metamaterials modelling, Comput. Methods Appl. Mech. Engrg. (2017),
https://doi.org/10.1016/j.cma.2017.10.025

This is a PDF file of an unedited manuscript that has been accepted for publication. As a service to
our customers we are providing this early version of the manuscript. The manuscript will undergo
copyediting, typesetting, and review of the resulting proof before it is published in its final form.
Please note that during the production process errors may be discovered which could affect the
content, and all legal disclaimers that apply to the journal pertain.

https://doi.org/10.1016/j.cma.2017.10.025


A computational multiscale homogenization framework accounting for inertial
effects: application to acoustic metamaterials modelling

D. Rocaa,b, O. Lloberas-Vallsa,c, J. Cantea,b, J. Olivera,c,∗

a Centre Internacional de Mètodes Numèrics en Enginyeria (CIMNE)
Campus Nord UPC, Mòdul C-1 101, c/ Jordi Girona 1-3, 08034 Barcelona, Spain

b Escola Superior d’Enginyeries Industrial, Aeroespacial i Audiovisual de Terrassa (ESEIAAT)
Technical University of Catalonia (Barcelona Tech), Campus Terrassa UPC, c/ Colom 11, 08222 Terrassa, Spain

c E.T.S d’Enginyers de Camins, Canals i Ports de Barcelona (ETSECCPB)
Technical University of Catalonia (Barcelona Tech), Campus Nord UPC, Mòdul C-1, c/ Jordi Girona 1-3, 08034 Barcelona, Spain

Abstract

A framework, based on an extended Hill-Mandel principle accounting for inertial effects (Multiscale Virtual Work
principle), is developed for application to acoustic problems in the context of metamaterials modelling. The classical
restrictions in the mean values of the micro-displacement fluctuations and their gradients are then accounted for in a
saddle-point formulation of that variational principle in terms of Lagrange functionals. A physical interpretation of
the involved Lagrange multipliers can then be readily obtained.

The framework is specifically tailored for modelling the phenomena involved in Locally Resonant Acoustic Meta-
materials (LRAM). In this view, several additional hypotheses based on scale separation are used to split the fully
coupled micro-macro set of equations into a quasi-static and an inertial system. These are then solved by considering
a projection of the microscale equations into their natural modes, which allows for a low-cost computational treatment
of the multiscale problem. On this basis, the issue of numerically capturing the local resonance phenomena in a FE2

context is addressed. Objectivity of the obtained results in terms of the macroscopic Finite Element (FE) discretiza-
tion is checked as well as accuracy of the homogenization procedure by comparing with direct numerical simulations
(DNS). The appearance of local resonance band-gaps is then modelled for a homogeneous 2D problem and its exten-
sion to multi-layered macroscopic material is presented as an initial attempt towards acoustic metamaterial design for
tailored band-gap attenuation.

Keywords: Multiscale modelling, Computational homogenization, Inertial problems, Acoustic metamaterials, Local
resonance phenomena

1. Motivation

The field of computational multiscale modelling has experienced a significant development in the last decades
and its progressively penetrating many different application fields within simulation-based techniques. Hierarchical
multiscale techniques, based on homogenization theory, have specially captured the attention of the computational
mechanics community given their ability to account for microstructural physical phenomena and their impact at a
macroscopic scale. Moreover, homogenization-based multiscale simulations are regarded significantly inexpensive
from a computational viewpoint compared to (single scale) direct numerical simulations (DNS) or concurrent mul-
tiscale techniques [19, 1] in which micro and macro levels are simultaneously processed in the computations. This
feature is obviously more evident when the separation between lower and upper scales increases.

Our focus is centered in computational homogenization techniques in which the constitutive information driving
the macroscopic analysis is computed from consecutive interactions between the macro and microscale. In other

∗Corresponding author
Email address: oliver@cimne.upc.edu (J. Oliver)

Preprint submitted to Elsevier November 10, 2017



words, there is no explicit (or closed-form) macroscopic constitutive behaviour, but it is obtained through successive
computations performed over a Representative Volume Element (RVE) of the microstructure. Such macro/micro inter-
actions are generally referred to as downscaling and upscaling, indicating the sense of the information flow. Examples
of these kind of techniques are found in Feyel and Chaboche [7], Kouznetsova et al. [15] in which homogenization
of non-linear behaviour of complex microstructures is considered. Different types of boundary conditions Miehe and
Koch [21], Mesarovic and Padbidri [20] can be chosen for the downscaling, which impact the solution field at the
boundary of the RVE. In the last years, a remarkable progress has been accomplished when applying these type of
techniques to a wide range of quasi-static applications including complex material behaviour such as softening and lo-
calization phenomena Verhoosel et al. [30], Nguyen et al. [23, 22], Oliver et al. [25], multiphysics phenomena Özdemir
et al. [26], large deformations [16] and specific structural elements such as beams and plates [4].

Computational homogenization techniques including inertial effects constitute the main subject of the current
contribution. The objective is to present a physically sound formulation for the two-scale problem and highlight
one of its main emerging applications, i.e. multiscale computational analysis and design of materials with unusual
properties when submitted to dynamic excitations. Several homogenization approaches which include inertial effects
have been proposed so far, e.g. [14, 27, 29], but their formulation in a rigorous variational form has only recently been
stated in [5, 2], where a general multiscale framework is presented, which is grounded on kinematic admissibility,
duality (relating force and stress-like quantities) and a generalized Hill-Mandel principle postulated in terms of a
variational statement named the Multiscale Virtual Power Principle (MVPP).

In the present contribution, attention is focused on the application of the aforementioned MVPP in acoustics. This
allowing some simplifications with respect to the general framework. In order to facilitate the corresponding simpli-
fying hypotheses it turns out to be convenient the modification of the MVPP as a saddle-point variational problem
incorporating Lagrange multipliers associated to the kinematic restrictions. This enables deriving the correspond-
ing Euler Lagrange equations as well as the identification of the Lagrange multipliers representing the macroscopic
D’Alembert forces (body forces minus inertial forces) and the overall stresses. Such a formulation is particularly
useful for the multiscale design approach, since the targeted macroscopic behaviour can now be easily linked to the
microstructural design variables. After defining this multiscale setting, the second part of this contribution is specif-
ically tailored to modelling acoustic problems. More specifically, for the study of sound cancelling and attenuating
acoustic metamaterials based on local resonance phenomena. For instance, the formulation as a saddle-point prob-
lem including Lagrange multipliers enables to identify the limits of the frequency band-gaps in terms of the resonant
effects of a partially or fully restricted RVE and their impact at the macroscopic level. To the authors knowledge, a
precedental dual formulation written in terms of Lagrange multipliers has appeared in [3], where macroscale forces
and stresses are identified as the Lagrange multipliers linked to microscale fields but applied to the Navier-Stokes
equations. The saddle-point problem formulation employing Lagrange multipliers obtained in this contribution from
fundamental micro-macro balance principles, allows for a clear interpretation of the connections between scales in a
dynamic context.

In the current contribution, the microstructural augmented system of equations emanating from the Lagrange
multipliers-based approach (including the microscopic displacements as well as the Lagrange multipliers as un-
knowns) is then extended, for acoustic problems, from minimal kinematic constraints to periodic boundary condi-
tions. In contrast with other approaches [29, 18], the resolution of the microstructural system with micro-macro
constraints is split here into the superposition of a quasi-static and an inertial solution (on the resulting Finite Ele-
ments RVE system of equations rather than on different material phases). This split is grounded on the superposition
principle for linear systems and the following assumptions for the acoustic material: (i) macroscopic strains produce,
by themselves, no inertial microscopic response (quasi-static system) and (ii) macroscopic displacements produce,
by themselves (independently of the strains), negligible microscopic reactive stresses against the inertial response
(inertial system). The aforementioned identification of the Lagrange multipliers plays a fundamental role in the justi-
fication of these assumptions. In addition, the quasi-static system provides directly the homogenised stresses as one of
the Lagrange multipliers and the homogenized constitutive tensor appearing in classical quasi-static homogenization
theory, whereas the inertial system, returns the macroscopic inertial forces as the other Lagrange multiplier (when
body forces are neglected). In order to reduce the computational cost of the micro-macro coupled inertial system, a
specific Reduced Order Modelling technique (ROM) is suggested, i.e. a modal analysis approach where microscopic
displacements are projected onto the space spanned by the most dominant resonating modes. Both quasi-static and
reduced inertial systems provide closed form expressions for the effective macroscopic stress and inertial forces that

2



l lµ � l

Macro-scale Micro-scale

Ω

Ωµ

x

y

RVE
Unit cell RVE

Figure 1: Typical multiscale problem configuration. The characteristic size of the microscale, lµ, must satisfy lµ � l in order to preserve the
separation of scales.

lead to the full homogenized problem when considered in the macroscale linear momentum balance equations.
Particularizing the micro and macroscale displacement fields for wave-like solution in infinite and homogeneous

media, the macroscopic linear momentum balance equation, with effective properties, turns into a dispersion relation,
i.e. for a given frequency and propagating wave direction, the wave numbers and associated propagation modes can
be obtained at the macrostructure. The effect of locally resonating modes for given frequencies is captured at the
macroscopic dispersion curves in terms of a band gap region in which the wave is attenuated when the excitation
frequency lies in the obtained band-gap.

A specific feature of the proposed framework is that a Craig-Bampton reduction technique is not required at the
RVE level as in [29] and, therefore, assumptions on specific material phases are not necessary, conferring to the
proposed approach a more general character. In fact, the Craig-Bampton technique used in [29] to obtain the relevant
dynamics considers a fully fixed matrix at the boundary and the resonant modes account only for the dynamics of the
dense inclusions. In the present approach, the split into quasistatic and dynamic solutions mentioned above is referred
to the augmented system of equations and not to the particular material phases, allowing a more general description of
the internal dynamics, since all present microstructural phases participate in the resonant behaviour. This assumption
is proven to capture sufficiently well the local resonance phenomena compared to Direct Numerical Simulations and
objectivity of the homogenized response is found for different macroscopic meshes.

As for acoustic problems modelling, the microstructural topology is considered structured in regular cells in the
present contribution, this strongly motivating the use of periodic boundary conditions, which allows working with
generally simpler RVEs or unit cells. Up to date, most of contributions in computational homogenization of acoustic
metamaterials focus on the design of microstructures periodically repeated at the macro level representing macro-
scopic homogeneous layers (cf. [29, 18, 9, 10, 28]). From an industrial point of view, it is even more interesting to
conceive the macrostructure as an heterogeneous body, e.g. composed by layers with different underlying resonant
microstructures. This allows to program the metamaterial assembly to attenuate a wider spectrum of frequencies char-
acterizing a certain noise or sound. To the authors knowledge, a computational framework for the multidimensional
study of multi-layered acoustic metamaterials with underlying resonating microstructures has not yet been devised
and opens the possibility of tackling an enormous range of applications in which a wider frequency band is obtained
and, therefore, a more complex acoustic signal can be attenuated. The applications for the design of such metamateri-
als are countless, for instance, one could devise an acoustic metamaterial for a given target noise source or frequency
spectra to be attenuated.

In order to demonstrate the capabilities of the proposed formulation in the computational modelling and design
of LRAM, a number of 2D representative simulations (both at the micro and macro scales) have been carried out in
this work: first, dispersion analyses have been performed in an ideal (infinite and homogeneous) medium; second, a
more realistic FE analysis has been taken to the design of an acoustic panel consisting on a finite-size layer of LRAM
where the attenuation properties are studied. Finally, the potential for material acoustic design aspects is displayed by

3



modelling a two-layer macroscopic LRAM.

2. Generalized energetic equivalence-based homogenization framework

2.1. Multi-scale problem set-up

Let’s consider a macroscopic solid body occupying a domain Ω ⊂ Rm with smooth boundary ∂Ω (for the sake of
simplicity, in the present work, we will assume m = 2, but the formulation is general and valid also for m = 3). Spatial
coordinates in the macroscale will be referred by x and the set of generalized displacement fields will be defined as

u(x, t) : Ω × [0,T ]→ Rm. (1)

The displacement gradient tensor J is defined as

J(x, t) = u(x, t) ⊗ ∇x ≡ ∇xu(x, t) (2)
J(x, t) = ε(x, t) + Ω̂(x, t) (3)

where

ε(x, t) = ∇Sxu(x, t) =
1
2

(u(x, t) ⊗ ∇x + ∇x ⊗ u(x, t)). (4)

Ω̂(x, t) = ∇skewx u(x, t) =
1
2

(u(x, t) ⊗ ∇x − ∇x ⊗ u(x, t)). (5)

with ε and Ω̂ being, respectively, the (symmetric) infinitesimal strain tensor and the (skew-symmetric) infinitesimal
rotation tensor [24].

At each point x one can associate a representative volume element (RVE) of the microscale and, sometimes, it
is also possible to identify a periodically repetitive structure known as unit cell (cf. Fig. 1). In order to distinguish
those variables associated to the microscale from their macroscopic counterparts, the subscript µ will be used when
referring to the former. Following this rule, the RVE will be denoted by Ωµ ⊂ Rm, with a smooth boundary ∂Ωµ and its
spatial coordinates referred by y. Also, for the sake of readability, angle brackets 〈•〉Ωµ/〈•〉Γµ will be used throughout
the paper as an operator for the RVE volume average integral of the field (•), so that

〈•〉Ωµ ≡
1∣∣∣Ωµ

∣∣∣

∫

Ωµ

(•)dΩ; 〈•〉Γµ ≡
1∣∣∣Ωµ

∣∣∣

∫

Γµ

(•)dΓ (6)

where Γµ ⊂ ∂Ωµ.
A kinematic connection between both scales will be established by considering the first order expansion of the

kinematic variables associated to point x in the macroscale, so

uµ(y, t) = u(x, t) + J(x, t) · (y − y0) + ũµ(y, t), (7)
∇yuµ(y, t) = J(x, t) + ∇yũµ(y, t), (8)

where u and J are the local values of the displacement field and their gradient at the macroscopic level, y0 are the
coordinates of the centroid of the RVE and ũµ is the micro-fluctuation field. In this context, we impose the fluctuation
field and its symmetric gradient to satisfy, for any time t ∈ [0,T ],

〈ũµ(y, t)〉Ωµ = 0, or 〈uµ(y, t)〉Ωµ = u(x, t); (9)
〈∇Sy ũµ(y, t)〉Ωµ = 0, or 〈∇Syuµ(y, t)〉Ωµ = ε(x, t). (10)

In equations (9) and (10) the fact that y0 is the centroid of the RVE domain and, therefore, 〈y − y0〉Ωµ = 0, has
been considered. Equations (9) and (10) are often referred to in the literature as minimal kinematic restrictions [2].

4



Remark 1. It is important to note that the time scale is the same for both the macro and the micro scales, so by
fixing a kinematic connection in the displacement fields, we also establish a relation between rate (velocity) fields.
In particular, this means that restrictions (9) and (10) are satisfied also for the rate fields and their corresponding
symmetric gradients.

2.2. Fundamental hypothesis
The homogenization framework proposed here is a generalization to inertial cases of the classical Hill-Mandel

principle for quasi-static problems. The model will be derived from the work of Blanco et al. [2], in which a general
multiscale framework is presented based on three main hypotheses: (a) kinematic admissibility between scales, (b)
mathematical duality of the macroscopic force/stress quantities with the corresponding kinematic variables, and (c)
the so-called Multiscale Virtual Power Principle, which is used to derive the equilibrium equations from variational
arguments. Also in [27], a generalization to inertial cases of the Hill-Mandel principle is proposed.

The model proposed here is grounded on the application at the macroscale of the classical postulates of continuum
mechanics, i.e. linear and angular momentum balance laws:

∇x · σ(x, t) + f(x, t) = 0, (11)
σ(x, t) = σT(x, t), ∀x ∈ Ω, ∀t ∈ [0,T ]. (12)

where σ is the macroscopic stress and f is the D’Alembert force density.
For the sake of simplicity, we will remain in the present work in the context of infinitessimal strains and elastic

behaviour (linear elasticity), and in the framework of Cauchy’s continua, only accounting for body forces and surface
tractions as external actions on the continuum medium [24].

Equation (11) and (12) are complemented by the D’Alembert force density definition and the Cauchy’s stress
theorem applied to the boundary of Ω:

f(x, t) = b(x, t) − ṗ(x, t), (13)
σ(x, t) · n(x) = t(x, t), ∀x ∈ ∂Ω (14)

where b and p are the body force and the linear momentum densities, respectively, while n and t are the outward unit
normal and traction vectors at the corresponding boundary, respectively. Note that we use the dot accent ˙(•) to refer
to time derivatives and the superscript (•)T stands for tensor transposition.

Now, in the context of linear elasticity, for the microscale, we assume

σµ(y, t) = Cµ(y) : ∇Syuµ(y, t), (15)

where Cµ(y) is the constitutive elastic tensor associated to the microscale material phases. Furthermore, given the
density field in the microscale ρµ(y), we will define the linear momentum density at the microscale as

pµ(y, t) = ρµ(y)u̇µ(y, t), (16)

so the microscopic D’Alembert force density becomes

fµ(y, t) = bµ(y, t) − ṗµ(y, t) = bµ(y, t) − ρµ(y)üµ(y, t), (17)

where ρµüµ is the microscopic inertial force.

Remark 2. Notice that the macroscopic counterparts of equations (15) and (17) are not specifically postulated since
they will be obtained as a result of the homogenization procedure.

2.3. Hill-Mandel principle
The Multiscale Virtual Power Principle in [2] postulates an energetic equivalence between scales and can be

regarded as a generalization of the classical Hill-Mandel principle for quasi-static problems. It is formulated as

5



GIVEN

f(u(x, t)), σ(u(x, t)), x ∈ Ω, t ∈ [0,T ] (18)

and

fµ(uµ(y, t)), σµ(uµ(y, t)), y ∈ Ωµ, t ∈ [0,T ] (19)

THEN

σ : ∇Sx u̇ − f · u̇ = 〈σµ : ∇Sy u̇µ − fµ · u̇µ〉Ωµ , (20)

∀u̇ and ∀u̇µ ∈Uµ, whereUµ is the space of kinematically admissible displacement-rate fields, u̇µ in the microscale

Uµ := {u̇µ = u̇ + ∇xu̇ · (y − y0) + ˙̃uµ | ˙̃uµ ∈U0µ}, (21)

which, in turn, is defined in terms of the spaceU0µ of admissible micro-fluctuation displacement-rate fields, ˙̃uµ, as

U0µ := { ˙̃uµ : Ωµ × [0,T ]→ Rm | 〈 ˙̃uµ〉Ωµ = 0; 〈∇Sy ˙̃uµ〉Ωµ = 0}. (22)

Remark 3. Notice that, in equations (20) to (22), perturbations u̇ are not subjected to any restriction, so this allows
us to choose, for a given spatial point x∗, independent local values of u̇(x, t)|x=x∗ and ∇Sx u̇(x, t)|x=x∗ . Then, following
the procedure in [2], one can obtain expressions for the homogenized values for the local macroscopic D’Alembert
force density and stress:

f = 〈fµ〉Ωµ ; (23)
σ = 〈σµ − fµ ⊗S (y − y0)〉Ωµ . (24)

From now on, the symbol ⊗S will be used to express

a ⊗S b = 1
2

(a ⊗ b + b ⊗ a). (25)

Insertion of results (23) and (24) into equation (20), returns the variational problem to be solved in the RVE.
Denoting ˙̃uµ as δuµ, it reads

FIND

uµ(y, t) : Ωµ × [0,T ]→ Rm, uµ ∈Uµ
FULFILLING

〈ṗµ · δuµ + σµ : ∇Syδuµ − bµ · δuµ〉Ωµ = 0, ∀δuµ ∈U0µ. (26)

where the microscopic counterpart of equation (13) has been considered.

Remark 4. Equation (26) is a constrained variational principle that is restricted to solutions inUµ (cf. equation (21)),
i.e. fulfilling



〈uµ(y, t) − u(x, t)〉Ωµ = 0,
〈∇Syuµ(y, t) − ε(x, t)〉Ωµ = 0.

(27)

6



2.4. Lagrange functional-based homogenization

While the variational problem in equation (26) can be solved, given the geometrical and material distribution of the
RVE along with values for the macroscopic displacement and strain [2], it will prove more convenient to reformulate
it as a saddle-point problem using Lagrange multipliers. In this way, one can work with unconstrained perturbation
fields and obtain the reactions to the constraints (27) directly through the Lagrange multipliers identification. A
similar approach has already been adopted, for instance, in the work of Blanco et al. [3], in the context of the so-called
Multiscale Virtual Power Principle for homogenization of the Navier-Stokes equations.

To do so, let’s first consider the variational statement (26) as the optimality condition for a constrained minimiza-
tion problem in the RVE, that is

δΠµ(uµ; δuµ) = 〈ṗµ · δuµ + σµ : ∇Syδuµ − bµ · δuµ〉Ωµ = 0, (28)

with restrictions uµ ∈Uµ and δuµ ∈U0µ.
Disregard the explicit expression of functional Πµ(uµ), we can obtain the extended Lagrangian functional by

adding constraints (9) and (10) through their corresponding Lagrange multipliers, β and λ, respectively. This yields
the following saddle-point problem in terms of unconstrained displacement fields as

FIND

uµ(y, t) : Ωµ × [0,T ]→ Rm,
β(t) : [0,T ]→ Rm,
λ(t) : [0,T ]→ Sym2(Rm),

FULFILLING

{uµ,β, λ} = arg min
uµ

max
β,λ
{Πµ(uµ) − β · 〈uµ − u〉Ωµ − λ : 〈∇Syuµ − ε〉Ωµ }. (29)

The optimality conditions for the saddle-point problem (29) result in the following variational system of equations:

〈(ṗµ − bµ − β) · δu + (σµ − λ) : ∇Syδuµ〉Ωµ = 0, ∀δuµ; (30)
〈uµ − u〉Ωµ · δβ = 0, ∀δβ; (31)
〈∇Syuµ − ε〉Ωµ : δλ = 0, ∀δλ. (32)

Note that, in contrast to the restricted variational equation (26), in expressions (30) to (32), the variables (including
the perturbation fields δuµ, δβ and δλ) are totally unconstrained. In this regard, one can take advantage of this situation,
appropriately choosing δuµ so that, in particular,

a) for δuµ = a,∀a spatially constant vector, one gets, from equation (30),

β = 〈ṗµ − bµ〉Ωµ = −〈fµ〉Ωµ ; (33)

b) for δuµ = A · (y − y0),∀A spatially constant symmetric second-order tensor, then

λ = 〈σµ + (ṗµ − bµ) ⊗S (y − y0)〉Ωµ = 〈σµ − fµ ⊗S (y − y0)〉Ωµ . (34)

Comparing the results with expressions (23) and (24), prior to fully solving the system of equations (30) to (32),
one can identify the Lagrange multipliers β and λ as the local macroscopic homogenized D’Alembert force density
and stress, respectively, thus

β(x, t) = −f(x, t) = −〈fµ〉Ωµ (35)
λ(x, t) = σ(x, t) = 〈σµ − fµ ⊗S (y − y0)〉Ωµ (36)

7



Classical variational problem formulation Saddle-point problem formulation

〈σµ : ∇Syδuµ − fµ · δuµ〉Ωµ = 0, ∀δuµ ∈ U0µ

f = 〈fµ〉Ωµ
σ = 〈σµ − fµ ⊗S (y − y0)〉Ωµ

〈(σµ − λ) : ∇Syδuµ − (fµ + β) · δuµ〉Ωµ = 0, ∀δuµ
〈uµ〉Ωµ = u
〈∇Sµuµ〉Ωµ = ε

Hill-Mandel principle
σ : Ûε − f · Ûu = 〈σµ : ∇Sy Ûuµ − fµ · Ûuµ〉Ωµ

β = −〈fµ〉Ωµ
λ = 〈σµ − fµ ⊗S (y − y0)〉Ωµ

Unknown fields: uµ, β, λ

Perturbation restrictions: None

Unknown field: uµ

Perturbation restrictions: δuµ ∈ U0µ
Variational statement (unconstrained):Variational statement (constrained):

Results:Results:

Figure 2: Summary and key concepts of the two equivalent homogenization procedures based on the Hill-Mandel principle of energetic equivalence
between scales: using the classical variational formulation and the saddle-point problem formulation.

In Fig. 2 a sketch of the key ideas involving the proposed homogenization procedure is presented. In addition,
Fig. 3 shows a graphical representation of the actions and reactions involved in the RVE problem.

3. Application to acoustic problems

The formulation presented so far, takes into account the minimal kinematic restrictions for the micro-displacement
and strain fields (see expressions (9) and (10)) and is general for all kind of inertial problems as far as the energetic
equivalence principle (and thus the separation of scales) holds. From now on, we will focus on problems in the
field of acoustics, for which some additional hypotheses may be suitably employed in order to simplify both the
analysis and the interpretation of the results. It should be noted that, in the context of acoustic problems, one may
already find other homogenization schemes available in the literature. For instance, in the work of Sridhar et al.
[29], an extension of the Hill-Mandel principle to inertial cases is used along with substructuring techniques (namely
the Craigh Bampton Mode Synthesis) to derive a multiscale model for locally resonant acoustic metamaterials. The
proposed homogenization framework, although eventually leading to similar results, offers a clear approach that allows
us to simplify the model in the context of acoustic problems by simply employing physical hypotheses that do not
require us to rely on substructuring techniques. In addition, from now on, body forces in equations in Sec. 2 will be
neglected, which is considered a reasonable assumption for the tackled acoustic problems. That is

f = b − ṗ ≈ −ṗ (37)
fµ = bµ − ṗµ ≈ −ṗµ (38)

3.1. Introduction of periodic boundary conditions
When dealing with periodic materials or structures (such as, for instance, in several problems involving acoustic

metamaterials), it is sometimes convenient to impose additional sets of conditions which may offer a more accurate

8



x
u(x, t)
ε(x, t)

f(x, t) = −β(x, t)
σ(x, t) = λ(x, t)

λ · nµ

β

uµ ∈ Uµ
Ωµ

Ω

Figure 3: Schematic representation of the RVE problem. The macroscopic displacement and strain at a given point are inputs in the associated RVE
system. The macroscopic stress and D’Alembert force density are related to microscopic traction forces σ · nµ and constant body force f reactions,
respectively.

representation of the kinematic coupling between scales.
In this particular framework, it proves suitable to consider periodic boundary conditions for the micro-fluctuation

field ũµ on the RVE boundary.
For the sake of simplicity, let’s consider the common case of a squared (or rectangular) RVE1 (see Fig. 4). In order

to introduce periodic boundary conditions, one can consider the boundary lines Γ(−) = Γ(−)1 ∪Γ
(−)
2 and Γ

(+) = Γ
(+)
1 ∪Γ

(+)
2 ,

such that ∂Ωµ = Γ(−) ∪ Γ(+). Let’s define the jump function of (•) as

J•K(y, t) = (•)(y + `(y), t) − (•)(y, t), ∀y ∈ Γ(−), (39)

where

`(y) =



`1, for y ∈ Γ(−)1
`2, for y ∈ Γ(−)2

(40)

with `i being the periodicity vector associated to each boundary region Γ
(−)
i (cf. Fig. 4). It should be noted, from the

definition of `, that JyK = `(y), ∀y ∈ Γ(−). In this framework, periodic boundary conditions can be formulated (see
equation (7)) as

JũµK = 0, or JuµK = J · JyK = J · `, ∀y ∈ Γ(−). (41)

It is worth noting that, by construction, the periodic boundary conditions in equation (41) fulfil the following
equation:

〈ũµ ⊗S nµ〉∂Ωµ = 0 → 〈uµ ⊗S nµ〉∂Ωµ = ∇Sxu ≡ ε→ 〈∇Syuµ〉Ωµ = ∇Sxu ≡ ε. (42)

where the divergence theorem has been applied in equation (42). Therefore, periodic boundary conditions, auto-
matically impose the requested minimal kinematic restriction (10), and the later does not need to be imposed any
more.

Then, periodic conditions modify the space of admissible micro-fluctuation fieldsU0µ toU0∗µ , where

U0∗µ := {ũµ : Ωµ × [0,T ]→ Rm | 〈ũµ〉Ωµ = 0; JũµK = 0} ⊂U0µ. (43)

1More general RVE shapes can be considered by a generalization of the proposed scheme.

9



Γ
(−)
1

Γ
(−)
2

`2

`1

Γ
(+)
1

Γ
(+)
2

Rigid body
displacement

Homogeneous
gradient displacement

Micro-fluctuation
displacement field

uµ u J · (y − y0) ũµ

Periodic
boundary
conditions

Γ(−) = Γ
(−)
1 ∪ Γ

(−)
2 Γ

(+) = Γ
(+)
1 ∪ Γ

(+)
2

Figure 4: Micro-displacement field components and representation of the periodic boundaries in a typical 2D square unit cell. Periodic boundary
conditions can be applied in the micro-fluctuation field in order to better represent the kinematic connection in some specific problems.

Note that expressions (23) and (24), derived as consequences from the generalized Hill-Mandel principle, are still
valid in this context, as the micro-fluctuation fields chosen to obtain them, ˙̃uµ = 0, still satisfy ˙̃uµ ∈U0∗µ . In addition,
the periodic boundary conditions in the saddle-point problem (29) can then be accounted simply by removing λ in
those equations and considering a new field of Lagrange multipliers γ(y) enforcing restriction (41) point-wise at the
boundary Γ(−). The saddle-point problem (29) can then be rephrased as

FIND

uµ(y, t) : Ωµ × [0,T ]→ Rm,
β(t) : [0,T ]→ Rm,
γ(y, t) : Γ(−) × [0,T ]→ Rm,

FULFULLING

{uµ,β,γ} = arg min
uµ

max
β,γ
{Πµ(uµ) − β · 〈uµ − u〉Ωµ − 〈γ · (JuµK − J · `)〉Γ(−) }, (44)

where the constraint in equation (41) has been considered, with the optimality conditions yielding

〈(ṗµ − β) · δuµ + σµ : ∇Syδuµ〉Ωµ − 〈γ · JδuµK〉Γ(−) = 0, ∀δuµ; (45)
〈uµ − u〉Ωµ · δβ = 0, ∀δβ; (46)
〈(JuµK − J · `) · δγ〉Γ(−) = 0, ∀δγ. (47)

Remark 5. Interestingly, one should note that the identification of β as the effective macro-inertia still holds in this
case, as one can take δuµ = a constant, so that JδuµK = 0 and ∇Syδuµ = 0 in equation (45), and still get the expression

10



(33). As for the macro-stress, it can be related with γ by considering, again, δuµ = A · (y−y0) (with A being a constant
symmetric second-order tensor) in (45) so it finally yields

〈γ ⊗S `〉Γ(−) = 〈σµ + ṗµ ⊗S (y − y0)〉Ωµ = σ (48)

where JδuµK = A · JyK = A · ` (see equation (41)) has been considered.

Remark 6. Note that, in contrast to λ, which turned out to be constant over the RVE, thus only incorporating 3 new
degrees of freedom in the extended Lagrange multipliers system, γ(y) has a point-wise variation in the boundary Γ(−),
which translates into a large set of degrees of freedom when the system is spatially discretized. Hence, it is better, in
practice, the strong-form imposition of periodic boundary conditions on uµ in the system of equations (45) to (47), so
the semi-restricted saddle-point problem reads

FIND

uµ(y, t) : Ωµ × [0,T ]→ Rm, with uµ | JuµK = J · `,
β(t) : [0,T ]→ Rm,

FULFULLING

{uµ,β} = arg min
uµ

max
β
{Πµ(uµ) − β · 〈uµ − u〉Ωµ }. (49)

3.2. Multi-scale problem resolution

In what follows, the analysis will be focused on problems that, at a macroscopic level, have the following setup:

∇x · σ = ṗ,
s.t. u(x, 0) = u0(x), u̇(x, 0) = v0(x),

u(x, t) = ū(x, t), ∀x ∈ Γu
σ(x, t) · n(x) = t̄(x, t), ∀x ∈ Γσ.

(50)

where the macroscopic body forces have been neglected, b ≈ 0, and Γu and Γσ denote the boundary regions of Ω
(such that Γu ∪ Γσ = ∂Ω) where displacements and tractions are prescribed, respectively.

The resolution scheme starts with the analysis of the RVE, where a Galerkin-based spatial finite element dis-
cretization has been considered, with the resulting discretized augmented system in matrix form given by



Mµ 0 0
0 0 0
0 0 0







¨̂uµ
β̈
λ̈


 +



Kµ −NTµ −BTµ
−Nµ 0 0
−Bµ 0 0






ûµ
β
λ


 = −



0
u
ε


 , (51)

where ûµ stands for the vector of the micro-displacement field nodal values, Mµ and Kµ are the standard mass and
stiffness matrices, respectively, while Nµ and Bµ are additional matrices, the derivation and definitions of which are
detailed in Appendix A.

3.2.1. Right-hand side decomposition
To proceed with the derivation, given that the RVE system is linear, we will split it into two subsystems, each of

them accounting for some part of the right-hand side of equation (51):



Mµ 0 0
0 0 0
0 0 0







¨̂u(1)µ
β̈(1)

λ̈(1)


 +



Kµ −NTµ −BTµ
−Nµ 0 0
−Bµ 0 0






û(1)µ
β(1)

λ(1)


 = −



0
0
ε


 , (52)

11



x

Ûp = ∇x · σ

u(x, t)
ε(x, t)

σ = Ceff : ∇Sxu Ûp = R · Üu + QÜq∗µ

Quasi-static component Inertial component

Üuε

Ω∗2µ q∗µ + Üq∗µ = −QT Üu

Modal projection of the RVE problem

Hypothesis: Üuµ ≈ 0, β ≈ 0 Hypothesis: λ ≈ 0


Mµ 0 0
0 0 0
0 0 0



Ü̂uµ
Üβ
Üλ

 +

Kµ −NTµ −BTµ
−Nµ 0 0
−Bµ 0 0



ûµ
β
λ

 = −

0
u
ε



Figure 5: Global homogenization scheme applied to acoustic problems. Macroscopic displacement and strain are actions in the RVE system. The
macro-stress is obtained as a reaction of the quasi-static component of the RVE system, while the macro-inertial force, which accounts for local
micro-resonating modes, comes from the inertial component of the RVE system.

12



and


Mµ 0 0
0 0 0
0 0 0







¨̂u(2)µ
β̈(2)

λ̈(2)


 +



Kµ −NTµ −BTµ
−Nµ 0 0
−Bµ 0 0






û(2)µ
β(2)

λ(2)


 = −



0
u
0


 , (53)

so that the sum of the systems (52) and (53) returns the original system (51).

Remark 7. The hypotheses that will be assumed here, while acceptable in a wide range of acoustic problems, will
simplify the resolution approach at the cost of establishing a certain limiting frequency up to which the model is
valid. It should be noted, however, that for most acoustic applications, the frequency region of interest raises up to 20
kHz, which is the typical upper bound of the human hearing range, so that higher frequencies may be considered not
relevant in those contexts. This includes also, for instance, the low-frequency range at which locally resonant acoustic
metamaterials typically operate, which is given by the separation of scales condition that, in this context, translates
into that macroscopic wavelengths λ must satisfy λ � lµ [29]. This makes the proposed approach well-suited for the
study and characterization of local resonance phenomena2.

3.2.2. Quasi-static solution
Focusing on the subsystem (52), the hypothesis that will be assumed here is that the macroscopic strain acceler-

ations for the tackled acoustic (elastic wave propagation) problems is small enough to consider that the RVE system
behaves quasi-statically [24], that is, its inertial response is negligible (ü(1)µ ≈ 0). This hypothesis is supported by
the separation of scales assumption, according to which λ � lµ and, therefore, macroscopic strains time evolution
ε(x, t) can be considered slow enough to not induce, by themselves, relevant microscopic acceleration ü(1)µ (y, t). This,
according to equation (33), allows us to anticipate

ü(1)µ ≈ 0 → β(1) = 〈ρµü(1)µ 〉Ωµ ≈ 0, (54)

making us able to take out the second row and column from the system (52), yielding the classical quasi-static system
of equations3

[
Kµ −BTµ
−Bµ 0

] [
û(1)µ
λ(1)

]
= −

[
0
ε

]
, (55)

which can be solved for λ(1) giving

λ(1) = σ(1) = Ceffmin : ε. (56)

where Ceffmin is the classical elastic effective (homogenized) and quasi-static constitutive tensor.

Remark 8. For the case of applying periodic boundary conditions, as mentioned in Sec. 3.1, the variable λ(1) is
withdrawn from equation (55) and periodic boundary conditions are directly applied on û(1)µ , leading to

K∗µû
∗(1)
µ = −STε. (57)

σ(1) = Ceffper : ε. (58)

Details on the resolution of the systems (55) and (57) and the computation of Ceffmin and C
eff
per can be found in

Appendix B.2.

2In addition, in the considered acoustic homogenization settings, the microscopic cells will exhibit at least two symmetry axes and the inertial
component of the macroscopic stresses, 〈ρµüµ(y, t) ⊗S (y − y0)〉Ωµ , is exactly equal to zero. Therefore, this term will be neglected in what follows.

3Where, under the hypothesis of infinitesimal microfluctuation field, ũ(1)µ ≈ 0, and for the considered case u = 0, the remaining condition, in equation
(52), Nµû

(1)
µ = 〈u(1)µ 〉Ωµ = 〈u + ε · (y − y0) + ũ(1)µ 〉Ωµ = 〈ũ(1)µ 〉Ωµ ≈ 0 is automatically fulfilled.

13



3.2.3. Inertial solution
As for the subsystem (53), since only small displacements u appear on the right-hand side as driving actions, the

following assumption is made4

λ(2) ≈ 0. (59)

Similarly to the previous case, this hypothesis allows us to remove the third row and column from the system (53),
which results in what is called here the inertial system of equations5

[
Mµ 0
0 0

] [
¨̂u(2)µ
β̈(2)

]
+

[
Kµ −NTµ
−Nµ 0

] [
û(2)µ
β(2)

]
= −

[
0
u

]
(60)

The variable β(2) can be condensed out in equation (60) giving rise to the system

M∗µ ¨̂u
∗
µ + K

∗
µû
∗
µ = −DTü, (61)

where û∗µ stands for the vector of nodal values of a fluctuation-like field, D can be regarded as a density-like matrix
coupling the micro and macro accelerations, while M∗µ and K

∗
µ are, respectively, the mass and stiffness matrices that

one obtains after condensing the restrictions in system (60). Details on the derivations of these terms are given in
Appendix B.3. From now on, we will refer to system (61) as the restricted inertial system. It should be noted
that expressions obtained in this case apply disregard periodic boundary conditions are considered or not (the only
difference is in how the matrices involved are defined, which is explained in more detail in Appendix B.3).

As for the resulting macroscopic inertial force, it reads

β(2) = R · ü + D ¨̂u∗µ, (62)

where R is the effective average density tensor that, as explained in Appendix B.3, for some specific cases, R = ρ̄I,
and R · ü = ρ̄ü with ρ̄ being the RVE average density,

ρ̄ = 〈ρµ〉Ωµ . (63)

Remark 9. Note that, according to equation (62), we can identify a component in the homogenized inertial force
that accounts for its own macroscopic acceleration, R · ü, and an additional inertial term, D ¨̂u∗µ (coupled micro-macro
inertial forces), that arises from the density-like matrix, D, and the micro-fluctuation acceleration field, ¨̂u∗µ, stemming
from the solution to the RVE equation (61). We anticipate that local resonance phenomena result from the mutual
cancellation of both these terms, giving rise to unusual dynamic properties, such as the frequency band-gaps, that will
be tackled in Sec. 4.

3.3. Modal analysis

3.3.1. Micro-inertial problem projection onto the restricted system modes
The hypotheses made in the resolution of the global RVE system have allowed us to isolate the inertial contribution

of the micro-fluctuation field that is transferred to the macroscale in equation (61). Now, in order to allow for a
better interpretation of the dynamic role that ¨̂u∗µ plays in the macroscale, it will be useful to consider the generalized
eigenvalue problem of the restricted system K∗µ −M∗µ defined as

4Since, under the assumption that the microfluctuation gradient is infinitesimal, ∇Sy ũ(2)µ ≈ 0, then, for ε = 0, ε(2)µ = ε + ∇Sy ũ(2)µ ≈ 0, and σ(2)µ = Cµ :
ε

(2)
µ ≈ 0. Thus λ(2) ≈ 〈σ(2)µ 〉Ωµ ≈ 0.

5Where, the additional condition, in equation (53), Bµû
(2)
µ = 〈ε(2)µ 〉Ωµ ≈ 0, is automatically fulfilled from the assumption of infinitesimal microfluc-

tuation gradient.

14



FIND

Φ
∗
µ = [φ̂

∗(1)
µ ... φ̂

∗(N)
µ ] (64)

Λ
∗

= [λ∗(1) ... λ∗(N)]T (65)

FULFILLING

(K∗µ − λ∗(k)M∗µ)φ̂∗(k)µ = 0, φ̂∗(k)Tµ M∗µφ̂∗(k)µ = 1 (66)

where the second equation (66) simply indicates that the eigenmodes are mass-normalized.
For the specific case of a dynamic system, each eigenvalue λ∗(k) can be identified as the squared natural frequency

ω
∗(k)2
µ (λ

∗(k) = ω∗(k)2µ ), with φ̂
∗(k)
µ being the k-th natural vibration mode, fulfilling

Φ
∗T
µ M

∗
µΦ
∗
µ = I and Φ

∗T
µ K

∗
µΦ
∗
µ = Ω

∗2
µ , (67)

Ω
∗
µ = diag[ω

∗(1)
µ ... ω

∗(N)
µ ], (68)

where Ω∗µ is a diagonal matrix containing the natural frequencies, ω
∗(k)
µ , of the restricted system.

Now, the solution û∗µ can be projected onto the space spanned by the eigenmodes Φ
∗
µ as

û∗µ =
∑

k

φ̂∗(k)µ q
∗(k)
µ = Φ

∗
µq
∗
µ, (69)

where q∗µ is the column vector of modal amplitudes, q
∗(k)
µ , for the restricted system. Note that this decomposition does

not imply any additional simplifications as long as we consider k ranging from 1 to the total number of degrees of
freedom of the system (61).

Additionally, equation (61) can be also projected onto the whole set of its mass-normalized natural vibration
modes, yielding

Φ
∗T
µ M

∗
µΦ
∗
µq̈
∗
µ +Φ

∗T
µ K

∗
µΦ
∗
µq
∗
µ = −Φ∗Tµ DTü, (70)

which, taking into account equation (67), results

Ω
∗2
µ q
∗
µ + q̈

∗
µ = −QTü, (71)

with Q being the from now on called coupling matrix

Q = DΦ∗µ. (72)

Note also that, by introducing expression (69) into equation (62), we obtain

β(2) = R · ü + Qq̈∗µ. (73)

The system of equations (71) turns out to be uncoupled for every degree of freedom q(k)µ , which facilitates the
physical and mathematical interpretation of the solution.

Precedent settings in which the RVE problem is projected onto the natural modes of the RVE can be found, in
the context of Bloch-Floquet theory, in [13]. However, the specific issue in the present approach is that it allows
discrimination of the projection relevant modes on the basis of the information provided by the coupling matrix in
equation (72), similarly to what is done in [29].

15



3.3.2. Micro-inertial problem projection onto the unrestricted system modes
By considering the generalized eigenvalue problem, but now in terms of the unrestricted system Kµ −Mµ in the

first equation (60), i.e.

Mµ ¨̂uµ + Kµûµ = 0, (74)

one may find also the natural frequencies and the mass-normalized vibration modes matrices, in this case reading Ωµ
and Φµ, respectively.

Again, the solution field û(2)µ to problem (60) can be alternatively projected onto the space spanned by the unre-
stricted system eigenmodes, Φµ, as

û(2)µ = Φµqµ, (75)

so
[
I 0
0 0

] [
q̈µ
β̈(2)

]
+

[
Ω2µ −ΦTµNTµ
−NµΦµ 0

] [
qµ
β(2)

]
= −

[
0
u

]
. (76)

This alternative system projection will be useful to tackle the dynamic effects of the RVE system.

3.3.3. Micro-inertial system reduction
Let’s now focus on the optimization of the computational cost of the problem. For these purposes, we will use a

procedure that could be inserted into the so called Reduced Order Model (ROM) techniques. The goal is to solve the
problem in an optimal low-dimension sub-space spanned by the most relevant modes [8].

Remark 10. Note that the system (71) has, in principle, as much degrees of freedom as û(2)µ in the original system.
However, as the coupling matrix Q in equation (73) reveals, not all the natural vibration modes will have the same
effect on the macroscale. In particular, the relative importance of each mode k can be assessed by its corresponding
column, Q(k), in the coupling matrix Q, allowing us to determine the set of relevant modes as those whose associated
column, Q(k), is not negligible. The setting proposed here automatically yields a reduced order model of the microscale
RVE problem, i.e. based on the projection of the FE problem in equation (60) on the space spanned by the relevant
resonant RVE modes. As it will be seen in Sec. 4, the number of required modes (RVE degrees of freedom) is
enormously reduced in comparison to the original FE element problem, this leading to a substantial reduction of the
multiscale analysis computational cost.

Since the modal amplitudes q∗µ in the system (71) are uncoupled, a first reduction can be performed retaining only
the relevant modes and amplitudes (φ̂∗(k)µ , q

∗(k)
µ ) in both the system (71) and their corresponding columns in Q.

Additionally, as pointed out in Remark 7, in the particular context of acoustic problems, one could perform this
reduction considering also that the macroscopic frequency range of interest is restricted to a certain set below a
limiting frequency ωlim. This makes all the relevant modes associated to higher natural frequencies not interesting in
this framework allowing us to remove also their corresponding degrees of freedom from the system. In this regard,
this approach is, for instance, especially well-suited for the analysis of locally resonant acoustic metamaterials, as it
will be seen in the examples in Sec. 4, where this computational cost reduction strategy will be applied. .

3.4. Homogenized macroscale problem
3.4.1. General model

With the hypotheses considered for the RVE system resolution (see Sec. 3.2.2 and 3.2.3), including the micro-
inertial system modal projection, we obtain, as effective macroscopic inertial force and stress,

ṗ(x, t) = β(1)(x, t) + β(2)(x, t) ≈ β(2)(x, t) = R · ü(x, t) + Qq̈∗µ(x, t), (77)
σ(x, t) = λ(1)(x, t) + λ(2)(x, t) ≈ λ(1)(x, t) = Ceff : ∇Sxu(x, t). (78)

where equations (54) and (59) have been considered.

16



Introducing the previous expressions into the macroscale equation (50) yields the general homogenized equivalent
problem

Macroscopic problem:

∇x · (Ceff : ∇Sxu) = (ṗ ≈ β(2)) = R · ü + Qq̈∗µ, (79)
Microscopic problem:

q̈∗µ +Ω
∗2
µ q
∗
µ = −QTü. (80)

Equations (79) and (80) constitute a coupled system of equations which allows for solving the macroscopic and
microscopic unknowns u and q∗µ, respectively.

3.4.2. A model for the ideal wave propagation problem
Note that the formulation presented so far is general within the hypotheses assumed for the RVE system resolution.

In the particular framework of acoustic problems, we will consider wave-like solutions of the kind

u(x, t) = U(κ · x − ωt), (82)

where U is the amplitude function, ω is the angular frequency (time frequency). In equation (82), κ = κnκ is the
wavevector, where nκ gives the propagation direction and κ the corresponding wavenumber (spatial frequency), which
is in turn related with the wavelength according to κ = 2π/λ. The simplest representation of a plane wave of constant
frequency ω and propagation direction nκ travelling along a macroscopic infinite structure comes from expressing u
as an harmonic function, typically formulated in the complex numbers space as

u(x, t) = Uei(κnκ ·x−ωt), (83)

with

ü(x, t) = −ω2Uei(κnκ ·x−ωt), (84)
∇Sxu(x, t) = iκnκ ⊗S Uei(κnκ ·x−ωt). (85)

where, for the sake of simplicity, the amplitude vector U ∈ Rm has been assumed constant.

Remark 11. It has to be emphasized that the type of waves in equations (83) to (85) can only be the solution of
ideal wave propagation problems, typically: waves propagating in an infinite and homogeneous medium with the
propagating wave not being affected by boundary conditions (reflected waves, etc.). This is what we term here as
ideal wave propagation problem.

In this context, we look for solutions of the microscale problem with modal amplitudes vectors q∗µ behaving as
harmonic oscillators with the excitation macroscopic frequency ω, thus satisfying

q̈∗µ(t, ω) = −ω2q∗µ(t, ω), (86)

whose general solution is q∗µ = Q
∗
µe
−iωt.

By replacing expression (86) into equation (80), allows us to solve the unknowns q∗µ in the RVE as

q∗µ(t, ω) = (ω
2I −Ω∗2µ )−1QTü(x, t), (87)

which can be transferred to the macroscale (by replacing equation (87) in equation (79)), yielding

∇x · (Ceff : ∇Sxu) = (ṗ ≈ β(2)) = Reff(ω) · ü, (88)
Reff(ω) = R + R̃(ω); R̃(ω) = Q(Ω∗2µ /ω

2 − I)−1QT. (89)

17



Box 1 Algorithm for the resolution of the multiscale homogenized acoustic problem
Data:

- Frequency range of interest: [ω0, ωlim]

- Unit cell finite element discretization results:
Mass matrix: Mµ → eq. (A.20)
Stiffness matrix: Kµ → eq. (A.21)
Restrictions matrices: Nµ → eq. (A.22)

Bµ → eq. (A.23)
Additional matrices: I → eq. (B.25)

Y → eq. (B.26)
Determine the homogenized mechanical and inertial properties (homogenization):

- Apply periodic boundary conditions?

→ No
- Compute matrix: T = I
- Compute effective constitutive tensor:

Ceffmin → eq. (B.12)
→ Yes

- Compute matrices: P → eq. (B.3)
Lε → eq. (B.4)
Lθ → eq. (B.5)
T = P

- Compute effective constitutive tensor:
Ceffper → eq. (B.22)

- Compute matrices for the inertial problem:

Restricted mass matrix: M∗µ → eq. (B.38)
Restricted stiffness matrix: K∗µ → eq. (B.37)
Average density tensor: R → eq. (B.34)
Density-like matrix: D → eq. (B.35)

- Modal analysis of the restricted RVE system:

(K∗µ − ω∗2µ M∗µ)φ̂∗µ = 0 → Ω∗2µ , Φ∗µ

- Retain only relevant modes and frequencies:

ω∗(k)µ , φ̂
∗(k)
µ |

∣∣∣
∣∣∣Dφ̂∗(k)µ

∣∣∣
∣∣∣ > δtol and ω∗(k)µ < ωlim (81)

- Compute coupling matrix: Q = DΦ∗µ

Solve the coupled macro-micro acoustic problem (FE discretization of eq. (79) and (80)):
[
Muu Muq
Mqu Kqq

] [
¨̂u
¨̂q

]
+

[
Kuu 0

0 Kqq

] [
û
q̂

]
=

[
f̂
0

]

18



where R is the effective average density tensor defined in Appendix B.3 and Reff assumes the role of an effective,
frequency dependent pseudo-density tensor.

Note also that expression (88) has the format of a wave equation for which equation (83) is expected to be a
solution. In fact, replacing solutions of such kind into equation (88), one obtains the so called dispersion relation:

D(ω, κ)Û =
[
nTκ C

effnκ −
(
ω

κ

)2
Reff(ω)

]
Û = 0. (90)

Equation (90) provides, for a given pair (ω, nκ), the corresponding wavenumber κ and amplitude unit vector Û, as
a result of a standard eigenvalues and eigenvectors problem. It is worth noting that precedent and somehow alternative
settings can be found for fast computation of dispersion properties of materials, in the context of Bloch-Floquet theory,
in [6, 12, 17]. However, in this work, the goal is not a detailed comparison of different methods but to establish and
assess a variational based hierarchical homogenization procedure suitable for computational modelling of real 2D and
3D acoustic problems.

Note that, in general, we cannot guarantee that Reff(ω) is positive definite for any frequency ω. In particular:

a) For excitation frequencies ω equal to a natural frequency of the unrestricted system (74), ω = ω(n)µ , one may
consider q̈µ = −ω2qµ in equation (76) and solve for β(2) yielding

∑

k

(Nµφ̂
(k)
µ )(Nµφ̂

(k)
µ )

T

ω
(k)2
µ − ω2

β(2) = Uei(κnκ ·x−ωt). (91)

Now, multiplying both sides of equation (91) by ω(n)2µ − ω2 and taking the limit for ω→ ω(n)µ it yields

(Nµφ̂(n)µ )(Nµφ̂
(n)
µ )

Tβ(2) = 0. (92)

As long as φ̂(n)µ < kerNµ, equation (92) yields β(2) = 0 disregard the value of U. Recalling that, in this considered
ideal case, the macroscopic inertial force is given by (see equation (88))

β(2) = Reff · ü = −ω2Reff(ω) · Uei(κnκ ·x−ωt) = 0, (93)

∀U, it yields

Reff = 0. (94)

This means that, at excitation frequencies, ω, equal to some natural frequencies of the unrestricted system, ω(n)µ ,
the matrix Reff becomes null and, therefore, the macroscopic problem (79) becomes quasi-static. In addition,
by replacing this condition into equation (90), it yields κ = 0 and then λ = 2π/κ → ∞.

b) For excitation frequencies ω approaching to a natural frequency of the restricted system (61), ω → ω∗(n)µ ,
equation (89) expressed in index notation reveals

Reffi j (ω) = Ri j +
∑

k

QikQ jk


ω
∗(k)
µ

ω




2

− 1
, (95)

Now, with regard to matrix D in equation (90), we consider the following possible situations:

b1) ω→ ω∗(n)µ from the left (ω . ω∗(n)µ ),

Reffi j → +∞ → matrix D is positive-definite,
→ κ ∈ R with κ → ∞

(96)

19



Table 1: Material and geometrical properties for the LRAM unit cell designs.

Parameter Units Nylon Steel

Material ID - 1 2
Density kg m−3 1100 7800
Young’s modulus GPa 2 180
Poisson’s ratio - 0.40 0.33

Dim. Units Config. A Config. B Config. C

lµ mm 5.000 5.000 5.000
r mm 1.250 0.500 1.250
R mm 1.875 1.000 1.750
b mm 0.100 0.100 0.100

b2) ω→ ω∗(n)µ from the right (ω & ω∗(n)µ ),

Reffi j → −∞ → matrix D is negative-definite,
→ κ ∈ C with Im(κ)→ ∞

Re(κ) = 0

(97)

This means that, at excitation frequencies, ω, equal to some natural frequencies of the restricted system, ω∗(n)µ ,
some components of the pseudo-density tensor, Reff, pass from −∞ to +∞ and the wavenumber κ passes from
real-valued to imaginary-valued.

Remark 12. It should be noted that in case b2) (or, in general, for any purely imaginary κ), the complex character of
the wavenumber κ makes equation (83) to become

u(x, t) = A(x)e−iωt; A(x) = Ue−|κ|nκ ·x, (98)

where A(x) implies an amplitude decay in the propagation direction (the wave amplitude decreases as the wave
advances).

As a consequence of the previous considerations, one could identify frequency intervals bounded by natural fre-
quencies of the restricted and unrestricted problems, [ω∗µ, ωµ], where the effective pseudo-density matrix, R

eff, be-
comes unbounded and negative-definite (at the beginning of the interval) and it subsequently evolves to Reff = 0 (at
the end of the interval), while the wavenumber κ remains imaginary-valued.

In addition, [ω∗µ, ωµ] defines a band of incidental frequencies where the macroscopic wave gets progressively
attenuated, due to local resonance phenomena, as it advances in the infinite medium according to equation (98). This
corresponds to the so-called frequency band-gaps [11].

The specific determination of the band-gap positions in the frequency domain can only be analytically obtained for
the considered ideal problem (infinite and homogeneous media). Otherwise, one should resort to numerical solutions
(see Sec. 4 for examples illustrating such behaviour).

4. Examples

In the following, the algorithm sketch in Box 1 is applied to the resolution of a number of 2D multiscale homoge-
nized acoustic problems.

20



lµ

b

r

R

1

2

e1

e2

Figure 6: Unit cell configuration parameters. The numbers correspond to each material ID in Tab. 1.

ω
(1)
µ = 9.83 kHz ω

(2)
µ = 10.49 kHz ω

(3)
µ = 28.67 kHz ω

(4)
µ = 30.31 kHz ω

(5)
µ = 47.64 kHz

ω
∗(1)
µ = 5.32 kHz ω

∗(2)
µ = 11.12 kHz ω

∗(3)
µ = 15.66 kHz ω

∗(4)
µ = 65.14 kHz ω

∗(5)
µ = 78.52 kHz

Restricted system

Unrestricted system

Q(1) =
[
−39.39

0

]
Q(2) =

[
0
0

]
Q(3) =

[
0

41.99

]
Q(4) =

[
23.37

0

]
Q(5) =

[
0

−18.68

]

Figure 7: First 5 vibration modes and the associated natural frequencies of the unit cell configuration A for the unrestricted system (top) and the
restricted system (bottom). The corresponding columns Q(k) of the coupling matrix Q are also shown (units of kg1/2m−3/2).

21



Table 2: Effective properties for the LRAM unit cell designs.

Param. Units Config. A Config. B Config. C

Ceff11 GPa 0.948 2.532 1.125

R11 kg m
−3 2149 1208 2211

Q(1)1 kg
1/2m−3/2 -39.39 17.42 -39.58

ω
∗(1)
µ kHz 5.32 17.48 6.89

ω
(1)
µ kHz 9.83 19.82 12.39

4.1. Unit cell effects for the ideal problem
We will consider here an infinite and homogeneous domain in the macroscale so that the assumptions considered

for the developments in Sec. 3.4.2 can be applied. The goal would be to compare the effects of the cell design into
the acoustic macroscopic properties. The macroscopic problem equation (79) can be solved analytically, in this case,
while the microscopic equation (80) will be solved numerically with FE discretization.

Even though the results that will be obtained in this example may not represent the actual material behaviour,
it is interesting for academic purposes as it provides a controlled environment for easily understand the phenomena
involved in the unusual properties of acoustic metamaterials.

In order to achieve the typical properties of acoustic metamaterials, the unit cell design must be such that it
guarantees the existence of relevant resonating modes in the frequency range of interest (up to 20 kHz). This is
accomplished, for instance, with the so called locally resonant acoustic metamaterials (LRAM), as local resonance
phenomena occur in conditions that meet the considered assumptions.

For a practical LRAM design, one needs, at least, the following elements as parts of the unit cell:

a) A rigid component that supports the structure. This element assumes the role of a matrix in this configuration,
supporting the resonating elements and attaching them together. The relative stiffness of these elements is what
guarantees the separation of scales λ � lµ.

b) A dense component that acts as resonating element. The key aspect for a practical LRAM design is to al-
low these elements to have natural vibration frequencies in the desired frequency range. They typically are
surrounded by highly flexible materials (or void regions) in order to promote the appearance of low natural
frequencies. Frequency band-gap sizes and locations are related to the shape and density of these elements.

In order to display these facts, three different geometric configurations have been considered. Fig. 6 depicts the
geometrical parameters and material distribution for the considered reference unit cell. The values for the geometrical
and material properties considered in the examples are listed in Tab. 1.

The meshes used consist of 2D linear triangular elements with around 2000 degrees of freedom in each case. The
global homogenization scheme of Sec. 3 has been applied considering periodic boundary conditions and prescribing
the micro-fluctuation field at some point in the RVE boundary in order to prevent rigid body motions. Therefore, in
one corner of the unit cell, the micro-fluctuation displacement has been prescribed6 (this has already been done in
other similar works such as [29])7. The mass and stiffness matrices have been computed considering, respectively,
3 and 1 Gaussian quadrature points for their integration over the element. A modal analysis has been performed
with Matlab considering both the fully unrestricted system Kµ − Mµ and the restricted system K∗µ − M∗µ. For the
unit cell configuration A, Fig. 7 shows the first 5 vibration modes and the associated natural frequencies for both the
unrestricted and restricted systems. The results show that the first and third vibration modes, which are the only ones
(in the frequency range of interest) that exhibit some non-negligible8 components in their corresponding columns of

6Periodic boundary conditions extend this restriction to the other three corners.
7Numerical experimentation show that adding this type of restriction slightly improves the homogenized results (specific reasons for this are currently
investigated). However, it can be proven that these restrictions add symmetric corresponding reactions at the squared RVE that cancel with each
other in the summation and, therefore, do not change the physical interpretation of the Lagrange multiplier β.

8The considered value of δtol in equation (81) has been δtol = 10−8

22



the coupling matrix Q (see Remark 10), appear to be good candidates as resonating modes. Focusing on longitudinal
waves (with wave amplitudes in the propagation direction), which are the interesting ones in the context of acoustic
problems, only the first mode becomes relevant. Therefore, one would expect the model to capture its effects on the
macroscale. Tab. 2 gives the specific effective properties (for the horizontal component) that have been obtained from
the analysis of each unit cell configuration.

A frequency analysis of the macroscopic problem has then been performed over a frequency range from 0 to
25 kHz (a total number of 500 evenly spaced frequency test points have been considered) aiming at studying the
propagation characteristics in the horizontal direction (nκ = e1). Note that with the hypotheses assumed, the effective
constitutive tensor, Ceff in equation (88), is considered constant in this frequency range.

In Fig. 8, the resulting macroscopic acoustic properties, namely the first component of the density tensors, Reff11 ,
R11, and R̃11 (see equation (89)), and the normalized wavenumber κlµ/2π obtained from the dispersion relation (90),
are shown. It can be checked that the phenomena anticipated in equations (96) and (97) at the frequency band interval
(band-gap) [ω∗(1)µ , ω

(1)
µ ] show up there.

4.2. Validation of the proposed homogenization model

In order to validate the homogenization model for acoustic problems proposed in Sec. 3 (see also Fig. 5), let’s
now consider a more realistic macroscopic problem, similar9 to the one proposed in [29], consisting of a small-width
homogeneous macroscopic layer. Fig. 9 schematically represents the macroscopic problem setup. In the thickness
(horizontal) direction, 10 stacked type A unit cells are considered to define the macro-structure. In the vertical direc-
tion, the layer is considered infinite-sized and the corresponding boundary conditions will be applied. For the sake
of simplicity, and to properly capturing the local resonance phenomenon, we will focus the study on simulating a
horizontal plane wave propagating through the finite macroscopic domain of analysis Ω in the thickness direction (see
Fig. 9).

An harmonic wave at a given frequencyω on the horizontal direction is prescribed at the macroscopic left boundary
of the layer as ū = U0 sin(ωt)e1 (see Fig. 9). In order to represent the vertical infinite dimension of Ω, periodic
macroscopic displacement conditions are imposed at the upper and lower boundaries of Ω, Γ(+) and Γ(−), respectively.
As for the unit cell, the boundary conditions are the same than in the previous example.

The right macroscopic boundary of Ω will be left free, aiming at analysing how the displacement amplitude is
affected by the presence of frequency band-gaps. The validation of the proposed homogenization scheme will be
done by comparing the results of a Direct Numerical Simulation (DNS) analysis, using a monoscale FEM mesh
consisting of linear triangular elements (the same as considered for the RVE calculations), with the ones obtained
with the homogenization model with different macrocopic FEM meshes consisting of linear quadrilateral elements
with 4 Gaussian integration points.

A frequency analysis has been performed over a range of evenly spaced 500 excitation frequencies ω from 0 to
25 kHz, from which the amplitudes ratio between the horizontal displacements of the upper-right corner (point B in
Fig. 9) and the input harmonic excitation has been obtained (point A in Fig. 9). The results are shown in Fig. 10. It
is interesting to see that the obtained frequency band-gap is very similar to the one predicted in the ideal problem in
the previous example. In addition, the other peaks shown up in the curve correspond to resonating frequencies of the
homogenized macroscopic medium.

In Fig. 11, the profiles of the horizontal displacements amplitudes for the steady state response along the upper
boundary Γ(+) are shown, for some selected frequencies, and compared for both the DNS and the multiscale model.
We clearly observe the attenuating effect on the wave amplitude only for frequencies inside the band-gap (see, for
instance, the profile for ω = 7.21 kHz in Fig. 11).

It should be noted that the results from the homogenization differ from those of the DNS upon increasing the
frequency of the analysis (see Fig. 10). This is expected since the simplifying hypotheses assumed hold more strongly
the closer one gets to the quasi-static case (ω = 0) and the effects of higher-frequency resonating modes (which are
neglected here) become more relevant. In addition, upon increasing the macroscopic frequency we approach the
separation of scales limit, causing the whole multiscale theory to fail. However, the results show excellent agreement

9It differs from the one in the referenced work in the 2D character of the homogenized macroscopic model considered here in contrast of the 1D
model considered there.

23



0 5 10 15 20 25
-5000

-2500

0

2500

5000

0 5 10 15 20 25
0

0.025

0.050

0.075

0.100

0 5 10 15 20 25
-5000

-2500

0

2500

5000

0 5 10 15 20 25
0

0.025

0.050

0.075

0.100

0 5 10 15 20 25
-5000

-2500

0

2500

5000

0 5 10 15 20 25
0

0.025

0.050

0.075

0.100

Frequency (kHz) Frequency (kHz)

Density (kg m−3) Wavenumber (κlµ/2π)

Unit cell A

Unit cell B

Unit cell C

R11 R̃11 Reff11 Im(κ) Re(κ)

Resonating frequencies (restricted system)
Resonating frequencies (unrestricted system)

Predicted frequency
band-gap

Figure 8: First component of the effective pseudo-density tensor (left column) and corresponding normalized wavenumber (right column) for each
unit cell configuration. The frequency band-gap is defined by the resonating frequencies for the restricted and unrestricted RVE systems in every
configuration. See, for instance, for unit cell A, ω∗(1)µ = 5.32 kHz and ω

(1)
µ = 9.32 kHz in Fig. 7. Notice the sign change of R

eff
11 (from +∞ to −∞)

at the beginning of the bands and Reff11 = 0 at their end, as well as the imaginary character of the wavenumber (responsible for the attenuation of
the macroscopic amplitude) at the bands for all cases. Since the number of tested frequencies is 500, the lines in the plots actually represent all the
frequency test points studied.

24



Γu : ū = U0 sin(ωt)e1

Γ(+)

Γ(−)

l = 50 mm

DNS

Γ(+)

Γ(−)

Homogenized model

Ω

BA

BA

lµ = 5 mm

...
...

e1

e2

Figure 9: Macro-scale problem setup. A harmonic horizontal displacement is prescribed on the left boundary of both the DNS (up) and the
homogenized model (down). Periodic boundary conditions are applied on the upper and lower boundaries to simulate infinite material extension
in the vertical direction. The mesh used for the DNS model is composed of 18400 triangular elements while for the homogenized model, meshes
with 10, 40 and 250 (as in the figure) quadrilateral elements have been used.

25



0 5 10 15 20 25
10−10

10−5

100

105

DNS
Homog. (10 el.)
Homog. (40 el.)
Homog. (250 el.)

Frequency (kHz)

U
(B
)

1
/U
(A
)

1

Region of interest

Figure 10: Amplitudes ratio of the horizontal component of the displacement at point B. Comparison of the DNS and the homogenized model results
for different number of elements. Amplitude ratios smaller than 1 imply effective wave attenuation whereas those larger than 1 imply effective
wave amplification. Since 500 test points have been considered in the range [0, 25] kHz, the lines in the plot represent the actual frequencies tested.

0 10 20 30 40 50

-1

0

1

Position x1 (mm)

U
1
| x∈
Γ
(+
)/

U
(A

)
1

DNS
Homog. ω = 4.21 kHz

ω = 7.21 kHz

ω = 10.22 kHz

Figure 11: Amplitudes ratio of the horizontal component of the displacement of the top boundary points along the horizontal direction. Comparison
of the DNS and the homogenized model results for different input frequencies.

in the frequency range of interest, where the hypotheses assumed hold more strongly. This proves the correctness of
the proposed homogenization scheme for this case.

4.3. First approach to LRAM design

In section 4.1 we have been able to see that minor changes in the RVE topology can lead to different results
and, in this particular case, different band-gap location and sizes. This fact alone opens a wide range of possibilities
towards topology optimization designs aiming, for instance, to control the size and location of the frequency band-
gaps (here alternatively termed acoustic attenuation bands). Let’s consider that we aim at designing an artificial
material (metamaterial) with optimal attenuation properties, for instance, in the human hearing range. Materials with
homogeneous macro-structures (see Sec. 4.2) show a limited number of band-gaps not covering the full interval of
interest, so the following question arises: by stacking homogeneous layers (every one attenuating a certain range of
frequencies), can one design a multi-layered material whose attenuation band spans the full range of interest?

Fig. 12 shows the attenuation curves corresponding to two different bi-layered materials, obtained both from a
DNS and homogenization analysis equal to those performed for the example in Sec. 4.2. Also the predicted band-gaps

26



0 5 10 15 20 25
10−10

10−5

100

105

DNS
Homog.

0 5 10 15 20 25
10−10

10−5

100

105

DNS
Homog.

Frequency (kHz)

U
(B
)

1
/U
(A
)

1

Frequency (kHz)

U
(B
)

1
/U
(A
)

1

a) b)

A B A C

25 mm 25 mm 25 mm 25 mm

A B A

C

Figure 12: Amplitudes ratio of the horizontal component of the displacement at point B for two multi-layer configurations: (a) two layers of
25 mm each with unit cell configurations A and B with their predicted band-gap regions (shaded areas) separated; and (b) two layers of 2.5 cm
each with unit cell configurations A and C with their predicted band-gap regions (shaded areas) overlapped. The DNS results are compared with
those obtained from the homogenized model. Amplitude ratios smaller than 1 imply effective wave attenuation whereas those larger than 1 imply
effective wave amplification.

27



corresponding to every unit cell are depicted in the same figure. Once again, when comparing with the DNS solu-
tion, we realize the good performance of the proposed multiscale homogenization scheme also for non-homogeneous
problems.

In the first case (a), the predicted band-gaps for each unit cell lie in two separated regions of the frequency domain,
and in the macroscale we observe an additional low-level attenuation that lies in between the two band-gap regions.
In the second case (b), where the ideally predicted band-gaps overlap, the non-homogenenous solution shows an
attenuation band that spans the two ideal band-gap regions with relevant attenuation levels. In this sense one could
say that design (b) improves design (a) for the purposes of getting a continuous wider attenuation band for the multi-
layer material.

This is a mere exemplification that there is room for the computational design of acoustic metamaterials, in this
case with multi-layered configurations, when a reliable homogenization scheme, as the one proposed in this work, is
available. Additional research on this subject is currently ongoing.

5. Conclusions

Along this work, a hierarchical multiscale homogenization approach accounting for inertial effects in acoustic
problems has been presented with the following features:

a) Consideration of the standard Cauchy’s continua at the macro scale assuming classical conservation of linear
and angular momentum and the Multiscale Virtual Power Principle in [2].

b) The resulting mechanical problem is then mathematically stated as an unrestricted saddle-point problem by
incorporating Lagrange multipliers as new dual unknowns. Then, they can be analytically identified by an
appropriate choice of the perturbation fields and explained in a physical manner in terms of macroscopic stresses
and D’Alembert force density terms.

c) The resulting formulation is finally specified for acoustic problems, and some assumptions (decomposition into
the sum of a quasi-static and inertial systems) allow identifying the simple coupling terms between the micro
and macroscale equations. In addition, a computational cost reduction strategy, based on projection onto the
restricted and unrestricted natural modes of the microstructure, is used.

d) In this context, a simple, physically meaningful and efficient homogenization scheme accounting for inertial ef-
fects is proposed. This scheme can then be applied to computational homogenization of acoustic metamaterials.

The multiscale formulation presented in this contribution is illustrated with a number of representative simula-
tions for both an homogeneous macrostructure and an heterogeneous macroscopic body with a layered structure. In
both cases a microstructure with a particular natural frequency is associated to each homogeneous portion of the
macrostructure. The framework represents a starting point for the coupling of topology optimization tools in order
to design specific microstructures rendering the desired macroscopic frequency cancelling and attenuating properties.
The latter part is left for a future contribution in which a complete computational material design tool is outlined based
on the proposed homogenization procedure and goal oriented macroscopic cost functions.

As shown in the presented results, our framework has proven to successfully capture the unusual macroscopic
behaviour of acoustic metamaterials caused by local resonance phenomena at a significantly low computational cost.
A first academic example has validated the expected frequency band gap which is theoretically bounded (in terms of
the wave number) between the microscopic eigenfrequencies obtained for the constrained and unconstrained cases.
The expected behaviour of the effective pseudo-density, i.e. nullifying at resonating frequencies of the unrestricted
system and tending to infinite for the restricted system, is also observed in the reported validation test.

The multilayer metamaterial study reported in the second example suggests that there is room for the design of
complex acoustic metamaterials capable of attenuating a specific target frequency spectrum, e.g. human voice, en-
vironmental noise or engine vibrations. In this view, the combination of sufficient layers with different microscopic
topologies are envisaged to cover the desired spectrum of frequencies to be attenuated. Further research is, how-
ever, required to complement these preliminary results and open the possibility to study more complex constitutive
behaviours at the microscale, e.g. viscoelastic effects and other dissipative phenomena, in order to provide a wider
attenuating frequency range and more effective attenuation mechanisms.

28



Acknowledgements

The research leading to these results has received funding from the European Research Council under the European
Union’s Seventh Framework Programme (FP/2007-2013) / ERC Grant Agreement n. 320815 (ERC Advanced Grant
Project “Advanced tools for computational design of engineering materials” COMP-DES-MAT). Oriol Lloberas-Valls
gratefully acknowledges the funding received from the Spanish Ministry of Economy and Competitiveness through
the National Research Plan 2014: MAT2014-60919-R.

Appendix

Appendix A. Finite Element discretization

In order to solve the RVE problem, a Galerkin-based discretization is considered in the spatial domain, so that the
microscale domain Ωµ is split in Ne elements, Ω

(e)
µ ⊂ Ωµ, for e = 1, 2 ... Ne. In each Ω(e)µ , the solution fields and their

variations are interpolated by

uµ(y, t) = N(e)µ (y)û
(e)
µ (t) or uµ(y, t) =

∑

a

Naµ(y)û
a
µ(t), (A.1)

üµ(y, t) = N(e)µ (y) ¨̂u
(e)
µ (t) or üµ(y, t) =

∑

a

Naµ(y) ¨̂u
a
µ(t), (A.2)

δuµ(y) = N(e)µ (y)δû
(e)
µ or δuµ(y) =

∑

a

Naµ(y)δû
a
µ, (A.3)

where the superscript a denotes the discrete nodes where the solution fields are interpolated, with the interpolation
values being uaµ and δu

a
µ, and N

a
µ(y) are the associated shape functions. In compact form, û

(e)
µ and δû

(e)
µ dispose uaµ

and δuaµ, respectively, in column vector fashion, while N
(e)
µ dispose N

a
µ(y) in row vector fashion. According to these

definitions, the symmetric gradient of the displacement fields is obtained by

∇Syuµ(y, t) = B(e)µ (y)û(e)µ (t) or ∇Syuµ(y, t) =
∑

a

Baµ(y)û
a
µ(t), (A.4)

∇Syδuµ(y) = B(e)µ (y)δû(e)µ or ∇Syδuµ(y) =
∑

a

Baµ(y)δû
a
µ, (A.5)

where Baµ(y) are defined, according to Voigt’s notation, as

Baµ(y) =



∂Naµ/∂y1 0

0 ∂Naµ/∂y2
∂Naµ/∂y2 ∂N

a
µ/∂y1


 , (A.6)

and B(e)µ corresponds to the arrangement of these terms in matrix form. The discretized form of the variational state-
ments (30) to (32), can be written, for each element, as

∑

a

∑

b

〈δûbµ · (ρ(e)µ NbµNaµ ¨̂uaµ + BbTµ C(e)µ Baµûaµ−

− Nbµβ − BbTµ λ)〉Ω(e)µ = 0, ∀δû
b
µ,

(A.7)

∑

a

〈Naµ ûaµ〉Ω(e)µ = 〈u〉Ω(e)µ , (A.8)
∑

a

〈Baµûaµ〉Ω(e)µ = 〈ε〉Ω(e)µ . (A.9)

29



or, in matrix form,

〈ρ(e)µ N(e)Tµ N(e)µ 〉Ω(e)µ ¨̂u
(e)
µ + 〈B(e)Tµ C(e)µ B(e)µ 〉Ω(e)µ û

(e)
µ −

− 〈N(e)Tµ 〉Ω(e)µ β − 〈B
(e)T
µ 〉Ω(e)µ λ = 0,

(A.10)

〈N(e)µ 〉Ω(e)µ û
(e)
µ = 〈u〉Ω(e)µ , (A.11)

〈B(e)µ 〉Ω(e)µ û
(e)
µ = 〈ε〉Ω(e)µ . (A.12)

where, assuming each element is composed of a single material phase, then ρ(e)µ is the corresponding density and C
(e)
µ

the constitutive tensor. Considering plane strain behaviour, C(e)µ can be expressed, using Voigt’s notation, as

C(e)µ =
E(e)

(1 + ν(e))(1 − 2ν(e))



1 − ν(e) ν(e) 0
ν(e) 1 − ν(e) 0
0 0 (1 − 2ν(e))/2


 , (A.13)

with E(e) being the element’s associated material Young’s modulus and ν(e) its Poisson’s ratio.
The system of equations (A.10) to (A.12) can be compactly written as



M(e)µ 0 0

0 0 0
0 0 0







¨̂u(e)µ
β̈
λ̈


 +




K(e)µ −N(e)Tµ −B(e)Tµ
−N(e)µ 0 0
−B(e)µ 0 0






û(e)µ
β
λ


 = −




0
〈u〉

Ω
(e)
µ

〈ε〉
Ω

(e)
µ



, (A.14)

with M(e)µ = 〈ρ(e)µ N(e)Tµ N(e)µ 〉Ω(e)µ , (A.15)
K(e)µ = 〈B(e)Tµ C(e)µ B(e)µ 〉Ω(e)µ , (A.16)
N(e)µ = 〈N(e)µ 〉Ω(e)µ , (A.17)
B(e)µ = 〈B(e)µ 〉Ω(e)µ . (A.18)

After a standard matrix assembly process, the global system results


Mµ 0 0
0 0 0
0 0 0







¨̂uµ
β̈
λ̈


 +



Kµ −NTµ −BTµ
−Nµ 0 0
−Bµ 0 0






ûµ
β
λ


 = −



0
u
ε


 , (A.19)

with Mµ = A
e

M(e)µ , (A.20)

Kµ = A
e

K(e)µ , (A.21)

Nµ = A
e

N(e)µ , (A.22)

Bµ = A
e

B(e)µ , (A.23)

where the big A symbol has been used to denote the matrix assembly operation.

30



Appendix B. RVE system resolution

Appendix B.1. Application of periodic boundary conditions

For 2D cases J in equation (41) can be written as

J = ε + Ω̂; ε =
[
ε11 ε12
ε12 ε22

]
; Ω̂ =

[
0 θ
−θ 0

]
(B.1)

where θ(x, t) is the infinitesimal in-plane rotation angle.
In order to apply the periodic boundary conditions, the second equation in expression (41) will be discretized,

yielding

ûµ =
[
P Lε Lθ

]


û∗µ
ε
θ


 , or




û(i)µ
û(−)µ
û(+)µ




=



I 0 0 0
0 I 0 0
0 I Lε Lθ







û(i)µ
û(−)µ
ε
θ



, (B.2)

where, using 2D Voigt’s notation,

P =



I 0
0 I
0 I


 , (B.3)

Lε =




...
`1(ŷ( j)) 0 `2(ŷ( j))/2

0 `2(ŷ( j)) `1(ŷ( j))/2
...



, ∀ŷ( j) ∈ Γ(−), (B.4)

Lθ =




...
−`2(ŷ( j))
`1(ŷ( j))

...



, ∀ŷ( j) ∈ Γ(−), (B.5)

where the superscripts (i), (−) and (+) refer to internal nodes and nodes lying on the boundary regions Γ(−) and Γ(+),
respectively.

Appendix B.2. Resolution of the quasi-static system

Appendix B.2.1. Quasi-static system with minimal kinematic conditions
According to expression (55), the quasi-static system considering the minimal kinematic restrictions reads

[
Kµ −BTµ
−Bµ 0

] [
û(1)µ
λ(1)

]
= −

[
0
ε

]
. (B.6)

It should be noted that the system (B.6) is defined except for a rigid body motion, uRB, which belongs to both the
kernels of Kµ and Bµ, that is

KµuRB = 0, (B.7)
BµuRB = 0. (B.8)

This means that, while no closed solution exists for û(1)µ , the solution for λ(1) is defined disregard the value of uRB.

31



Then, by prescribing arbitrarily 3 DOFs in û(1)µ , the system (B.6) becomes
[
Kffµ −Bf Tµ
−Bfµ 0

] [
ûf(1)µ
λ(1)

]
= −

[
0
ε

]
, (B.9)

which is now non-singular. Using the Schur complement of Kffµ the system can be condensed so

BfµK
ff −1
µ B

f T
µ λ

(1)
= ε, (B.10)

and, eventually, λ(1) becomes

λ(1) = (BfµK
ff −1
µ B

f T
µ )
−1ε. (B.11)

From expression (B.11), one can identify the quasi-static effective constitutive tensor as

Ceffmin = (B
f
µK

ff −1
µ B

f T
µ )
−1. (B.12)

Appendix B.2.2. Quasi-static system with periodic boundary conditions
Discretization of the optimality conditions of the problem (49), constrained by the periodic boundary conditions,

yields

Kµû(1)µ = r̂
(1), or



Kiiµ K

i−
µ K

i+
µ

K−iµ K
−−
µ K

−+
µ

K+iµ K
+−
µ K

++
µ







û(i)µ
û(−)µ
û(+)µ




=




0
−γ̂(1)
γ̂(1)


 (B.13)

where the superscripts (i), (−) and (+) refer, again, to internal nodes and nodes lying on the boundary regions Γ(−) and
Γ(+), respectively. In equation (B.13), γ̂(1) is the vector of the nodal Lagrange multipliers acting as boundary reactions
to imposing the periodic boundary conditions.

Notice that û(1)µ in equation (B.13) is defined except for a rigid body motion (involving an in-plane translation and
rotation). Now, applying the periodic boundary conditions (see equation (B.2)) into the system (B.13), yields



PT
LTε
LT
θ


Kµ

[
P Lε Lθ

]


û∗(1)µ
ε
θ


 =



PT
LTε
LT
θ







0
−γ̂(1)
γ̂(1)


 =




0
LTε γ̂

(1)

LT
θ
γ̂(1)


 . (B.14)

Now, since Lθθ is a rigid body rotation field, thus belonging to the kernel of Kµ, then KµLθ = 0, LTθKµ = 0 and
equation (B.14) can be rewritten as

[
PT
LTε

]
Kµ

[
P Lε

] [û∗(1)µ
ε

]
=

[
0

LTε γ̂
(1)

]
, (B.15)

LTθ γ̂
(1)

= 0, (B.16)

Equation (B.16) simply states the equilibrium of moments associated to the reactions γ̂(1).
Additionally, since LTε γ̂ = σ

(1) is the discrete counterpart of equation (48), we find
[
K∗µ S

T

S C

] [
û∗(1)µ
ε

]
=

[
0
σ(1)

]
, (B.17)

32



with

K∗µ = P
TKµP, (B.18)

C = LTεKµLε, (B.19)
S = LTεKµP (B.20)

Note that, in systems (B.15) and (B.17), the homogenized stress, σ(1), appears as a reaction to the action ε. In
equation (B.17), the solution field û∗(1)µ is now defined except for a rigid body translation (recall that the rotation, θ,
has been removed from the original system (B.14) and does not appear in the equation). Hence, now only 2 DOFs in
û∗(1)µ need to be arbitrarily prescribed in order to avoid the singularity of the system matrix. Under these conditions,
for a given ε, the system (B.17) can be solved for σ(1), yielding

σ(1) = (C − Sf K∗ff −1µ Sf T) : ε = Ceffper : ε, (B.21)

where Ceffper is the quasi-static effective constitutive tensor accounting periodic boundary conditions, reading

Ceffper = C − Sf K∗ff −1µ Sf T. (B.22)

Appendix B.3. Resolution of the inertial system
Recalling equation (60), the inertial RVE system reads

[
Mµ 0
0 0

] [
¨̂u(2)µ
β̈(2)

]
+

[
Kµ −NTµ
−Nµ 0

] [
û(2)µ
β(2)

]
= −

[
0
u

]
. (B.23)

In order to deal with the system (B.23), it will be useful to explicitly consider the rigid body motion of the micro-
displacement field, û(2)µ , so

û(2)µ =
[
I Y T

]



c
θ

û∗(2)µ


 (B.24)

with

I =




...
1 0
0 1
...



, (B.25)

Y =




...

−(ŷ( j)2 − y
(0)
2 )

ŷ( j)1 − y
(0)
1

...




, (B.26)

T =



I, for minimal kinematic conditions

P, for periodic boundary conditions
(B.27)

where c is a rigid body translation, θ is an infinitesimal in-plane rotation angle and û∗(2)µ is the remaining component
of the solution field that in this case assumes the role of a micro-fluctuation like field. Note that, since the driving
action in this case is such that ε = 0, periodic boundary conditions can be accounted in this resolution scheme simply
by setting T = P instead of T = I, which would be the case when accounting for minimal kinematic restrictions.

33



Now, introducing expression (B.24) into the system (B.23) and pre-multiplying the first equation by [I Y T]T,
one finds




ITMµI ITMµY ITMµT 0
YTMµI YTMµY YTMµT 0
TTMµI TTMµY TTMµT 0

0 0 0 0







c̈
θ̈

¨̂u∗(2)µ
β̈(2)




+




0 0 0 −I
0 0 0 0
0 0 TTKµT −TTNTµ
−I 0 −NµT 0







c
θ

û∗(2)µ
β(2)




= −




0
0
0
u



. (B.28)

Note that since both I and Y are rigid body modes, then Kµ[I Y] = 0, which has already been considered in equation
(B.28). Furthermore, from the construction of the matrix Nµ, it should also be easy to verify that NµI = I and, since
y0 is the centroid of the RVE, NµY = 0.

From the second equation in system (B.28), we obtain

θ̈ = −(YTMµY)−1YTMµ(c̈ − ¨̂u∗(2)µ ), (B.29)

which can be substituted into the system yielding



ITM̂µI ITM̂µT 0
TTM̂µI TTM̂µT 0

0 0 0







c̈
¨̂u∗(2)µ
β̈(2)


 +




0 0 −I
0 TTKµT −TTNTµ
−I −NµT 0







c
û∗(2)µ
β(2)


 = −



0
0
u


, (B.30)

where

M̂µ = Mµ(I − Y(YTMµY)−1YTMµ). (B.31)

Now, from the last equation in system (B.30), we obtain

c = u − NµTû∗(2)µ . (B.32)

Introducing expression (B.32) into the second equation in system (B.30) yields

β(2) = R · ü + D ¨̂u∗(2)µ (B.33)

where

R = ITM̂µI, (B.34)
D = ITM̂µ(I − INµ)T. (B.35)

Finally, by introducing expressions (B.32) and (B.33) into the second equation in system (B.28), one finds

M∗µ ¨̂u
∗(2)
µ + K

∗
µû
∗(2)
µ = −DTü, (B.36)

where

K∗µ = T
TKµT, (B.37)

M∗µ = T
T(I − INµ)TM̂µ(I − INµ)T. (B.38)

Remark 13. It should be pointed out here, from the construction of the matrices Mµ, I and Y, that

ITMµI ≡
[
〈ρµ〉Ωµ 0

0 〈ρµ〉Ωµ

]
, (B.39)

ITMµY ≡
[
−〈ρµ(y2 − y(0)2 )〉Ωµ
〈ρµ(y1 − y(0)1 )〉Ωµ

]
=



〈ρµ〉Ωµy(0)2 − 〈ρµy2〉Ωµ
〈ρµy1〉Ωµ − 〈ρµ〉Ωµy(0)1


 . (B.40)

34



From equation (B.40), we see that in cases where the geometric center of the RVE, y0, coincides with its center of
mass yG, i.e.

y0 = yG =
〈ρµy〉Ωµ
〈ρµ〉Ωµ

, (B.41)

the matrix ITMµY automatically vanishes, yielding

R = ITMµI = 〈ρµ〉ΩµI, (B.42)
D = ITMµ(I − INµ)T. (B.43)

References

[1] T. Belytschko, S. Loehnert, and J. H. Song. Multiscale aggregating discontinuities: A method for circumventing loss of material stability.
International Journal for Numerical Methods in Engineering, 73(6):869–894, 2008.

[2] P. J. Blanco, P. J. Sanchez, E. A. de Souza Neto, and R. A. Feijoo. Variational foundations and generalized unified theory of rve-based
multiscale models. Archives of Computational Methods in Engineering, 23(2):191–253, 2016.

[3] P.J. Blanco, A. Clausse, and R.A. Feijóo. Homogenization of the navier-stokes equations by means of the multi-scale virtual power principle.
Computer Methods in Applied Mechanics and Engineering, 315:760 – 779, 2017.

[4] P. Cartraud and T. Messager. Computational homogenization of periodic beam-like structures. International Journal of Solids and Structures,
43(3–4):686–696, 2006.

[5] E.A. de Souza Neto, P.J. Blanco, P.J. Sanchez, and R.A. Feijoo. An rve-based multiscale theory of solids with micro-scale inertia and body
force effects. Mechanics of Materials, 80, Part A:136 – 144, 2015.

[6] David C Dobson. An efficient method for band structure calculations in 2d photonic crystals. Journal of Computataional Physics, 149:
363–376, 1999.

[7] F. Feyel and J. L. Chaboche. FE2 multiscale approach for modelling the elastoviscoplastic behaviour of long fibre SiC/Ti composite materials.
Computer Methods in Applied Mechanics and Engineering, 183(3-4):309–330, 2000.

[8] J.A. Hernandez, J. Oliver, A.E. Huespe, M.A. Caicedo, and J.C. Cante. High-performance model reduction techniques in computational
multiscale homogenization. Computer Methods in Applied Mechanics and Engineering, 276:149 – 189, 2014.

[9] M. I. Hussein, G. M. Hulbert, and R. A. Scott. Dispersive elastodynamics of 1d banded materials and structures: analysis. Journal of Sound
and Vibration, 289(4-5):779 – 806, 2006.

[10] M. I. Hussein, G. M. Hulbert, and R. A. Scott. Dispersive elastodynamics of 1d banded materials and structures: Design. Journal of Sound
and Vibration, 307(3-5):865 – 893, 2007.

[11] M. I. Hussein, M. J. Leamy, and M. Ruzzene. Dynamics of phononic materials and structures: Historical origins, recent progress, and future
outlook. Applied Mechanics Reviews, 66(4):040802, 2014.

[12] Mahmoud I Hussein. Reduced bloch mode expansion for periodic media band structure calculations. Proceedings of the Royal Society of
London A: Mathematical, Physical and Engineering Sciences, 465:2825–2848, 2009.

[13] Mahmoud I Hussein and Gregory M Hulbert. Mode-enriched dispersion models of periodic materials within a multiscale mixed finite element
framework. Finite Elements in Analysis and Design, 42:602–612, 2006.

[14] A. Karamnejad, V. P. Nguyen, and L. J. Sluys. A multi-scale rate dependent crack model for quasi-brittle heterogeneous materials. Engineer-
ing Fracture Mechanics, 104:96 – 113, 2013.

[15] V. Kouznetsova, W. A. M. Brekelmans, and F. P. T. Baaijens. An approach to micro-macro modeling of heterogeneous materials. Computa-
tional Mechanics, 27(1):37–48, 2001.

[16] V. Kouznetsova, M. G. D. Geers, and W. A. M. Brekelmans. Multi-scale constitutive modelling of heterogeneous materials with a gradient-
enhanced computational homogenization scheme. International Journal for Numerical Methods in Engineering, 54(8):1235–1260, 2002.

[17] Dimitri Krattiger and Mahmoud I Hussein. Bloch mode synthesis: Ultrafast methodology for elastic band-structure calculations. Physical
Review E, 90:063306, 2014.

[18] A. Krushynska, M. Miniaci, V. G. Kouznetsova, and M G. D. Geers. Multilayered inclusions in locally resonant metamaterials: Two-
dimensional versus three-dimensional modeling. Journal of Vibration and Acoustics, 139(2):024501, 2017.

[19] O. Lloberas-Valls, D. J. Rixen, A. Simone, and L. J. Sluys. Multiscale domain decomposition analysis of quasi-brittle heterogeneous materials.
International Journal for Numerical Methods in Engineering, 89(11):1337–1366, 2012.

[20] S. Mesarovic and J. Padbidri. Minimal kinematic boundary conditions for simulations of disordered microstructures. Philosophical Magazine,
85(1):65, 2005.

[21] C. Miehe and A. Koch. Computational micro-to-macro transitions of discretized microstructures undergoing small strains. Archive of Applied
Mechanics, 72(4):300–317, 2002.

[22] V. P. Nguyen, O. Lloberas-Valls, M. Stroeven, and L. J. Sluys. Homogenization-based multiscale crack modelling: from micro-diffusive
damage to macro cracks. Computer Methods in Applied Mechanics and Engineering, 200(9-12):1220–1236, 2010.

[23] V. P. Nguyen, O. Lloberas-Valls, M. Stroeven, and L. J. Sluys. On the existence of representative volumes for softening quasi-brittle materials-
a failure zone averaging scheme. Computer Methods in Applied Mechanics and Engineering, 199(45-48):3028–3038, 2010.

[24] J. Oliver and C. Agelet. Continuum Mechanics for Engineers. Theory and Problems. Edicions UPC, Barcelona, 2017. doi: 10.13140/RG.2.
2.25821.20961.

35



[25] J. Oliver, M. Caicedo, E. Roubin, A. E. Huespe, and J. A. Hernández. Continuum approach to computational multiscale modeling of
propagating fracture. Computer Methods in Applied Mechanics and Engineering, 294:384 – 427, 2015.

[26] I. Özdemir, W. A. M. Brekelmans, and M. G. D. Geers. Computational homogenization for heat conduction in heterogeneous solids. Inter-
national Journal for Numerical Methods in Engineering, 73(2):185–204, 2008.

[27] K. Pham, V.G. Kouznetsova, and M.G.D. Geers. Transient computational homogenization for heterogeneous materials under dynamic exci-
tation. Journal of the Mechanics and Physics of Solids, 61(11):2125 – 2146, 2013.

[28] O. Sigmund and J. S. Jensen. Systematic design of phononic band–gap materials and structures by topology optimization. Philosophical
Transactions of the Royal Society of London A: Mathematical, Physical and Engineering Sciences, 361(1806):1001–1019, 2003.

[29] A. Sridhar, V. G. Kouznetsova, and M. G. D. Geers. Homogenization of locally resonant acoustic metamaterials towards an emergent enriched
continuum. Computational Mechanics, 57(3):423–435, 2016.

[30] C. V. Verhoosel, J. J. C. Remmers, and M. A. Gutiérrez. A partition of unity-based multiscale approach for modelling fracture in piezoelectric
ceramics. International Journal for Numerical Methods in Engineering, 82(8):966–994, 2010.

36



HIGHLIGHTS

• Variational homogenization framework accounting for inertial effects.
• Resolution via Lagrange functionals with analytical identification of Lagrange 

multipliers.
• Application to computational modelling of locally resonant metamaterials.
• Specific coupled analysis for acoustic problems: linear decomposition of the 

solution.
• Model order reduction based on projection on the dominant microscale natural 

modes.


