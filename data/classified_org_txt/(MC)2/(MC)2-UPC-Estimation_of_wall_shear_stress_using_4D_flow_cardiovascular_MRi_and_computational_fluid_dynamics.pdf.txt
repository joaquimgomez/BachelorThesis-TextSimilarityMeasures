


























































 
 

 

UPCommons 
Portal del coneixement obert de la UPC 

http://upcommons.upc.edu/e-prints 

 
 

Versió electrònica d’un article publicat a Journal of mechanics in 
medicine and biology, 0, 1750046 (2016), 16 p. DOI: 
http://dx.doi.org/10.1142/S0219519417500464  

© World Scientific Publishing Company  

http://www.worldscientific.com/worldscinet/jmmb 

 

 

 

Electronic version of an article published as Journal of mechanics in 
medicine and biology, 0, 1750046 (2016), 16 pages. DOI: 
http://dx.doi.org/10.1142/S0219519417500464  

© World Scientific Publishing Company  

http://www.worldscientific.com/worldscinet/jmmb 

 

http://upcommonsdev.upc.edu/
http://upcommonsdev.upc.edu/
http://upcommons.upc.edu/e-prints
http://www.worldscientific.com/worldscinet/jmmb
http://www.worldscientific.com/worldscinet/jmmb


Estimation of Wall Shear Stress using 4D flow

Cardiovascular MRI and Computational Fluid Dynamics

E.Soudaha, J.Casacubertab, PJ.Gamez-Monterob, JS.P éreza,M.Rodŕıguez-Cancioa,
G.Raushb, CH.Lic, F.Carrerasc, R.Castillab.

aCentre Internacional de Mètodes Numèrics en Enginyeria (CIMNE), Universitat Politècnica de Catalunya,

Edificio C1, Campus Norte, Jordi Girona 1-3, Barcelona 08034, Spain
bE.T.S. d’Enginyeries Industrial i Aeronàutica de Terrassa, Universitat Politècnica de Catalunya,

C/Colom, 11, Terrassa 08222, Spain
cUnidad de Imagen Cardiaca, Servicio de Cardioloǵıa, Hospital de la Santa Creu i Sant Pau

Sant Antoni Maria Claret 167, Barcelona 08025, Spain

Abstract

In the last years, wall shear stress has arisen as a new diagnostic indicator in patients
with arterial disease. There is substantial evidence that the wall shear stress plays a sig-
nificant role, together with hemodynamic indicators, in initiation and progression of the
vascular diseases. Estimation of wall shear stress values, therefore, may be of clinical sig-
nificance and the methods employed for its measurement are crucial for clinical community.
Recently, four-dimensional flow cardiovascular magnetic resonance has been widely used in
a number of applications for visualization and quantification of blood flow, and although
the sensitivity to blood flow measurement has increased, it is not yet able to provide an ac-
curate three-dimensional wall shear stress distribution. The aim of this work is to evaluate
the aortic blood flow features and the associated wall shear stress by the combination of
4D flow cardiovascular magnetic resonance and computational fluid dynamics technique. In
particular in this work, we used the 4D flow cardiovascular magnetic resonance to obtain the
spatial domain and the boundary conditions needed to estimate the wall shear stress within
the entire thoracic aorta using computational fluid dynamics. Similar wall shear stress dis-
tributions were found for cases simulated. A sensitivity analysis was done to check the
accuracy of the method. 4D flow cardiovascular magnetic resonance begins to be a reliable
tool to estimate the wall shear stress within the entire thoracic aorta using computational
fluid dynamics. The combination of both techniques may provide the ideal tool to help
tackle these and other problems related to wall shear estimation.

Keywords: Phase-contrast MRI, velocity mapping, blood flow patterns, wall shear stress,
computational fluid dynamics

1 Introduction

The endothelium is the first-line defense against atherogenesis. A key stimulus to maintain
the protective status of the endothelial lining at the inner vessel wall is the wall shear
stress (WSS). WSS is the tangential force that blood flow exerts on the endothelium. To

1



quantify WSS, three dimensional blood flow patterns need to be measured in vivo, which
has been a challenge in medical imaging for many years(17)(22)(13)(24)(12). Although
recent preclinical data of 3D ultrasound studies for general flow visualizations in the left
ventricle are promising, at present Magnetic Resonance Imaging (MRI) is the only non-
invasive imaging modality that can measure 3D blood velocity in 3D in a standardized
fashion. Although MR imaging resolution and acquisition speed has increased over the past
decades, assessment of WSS is still challenging in complex flow geometries. The cardiac
magnetic resonance imaging allows visualization of spatial distribution of velocity in a two-
dimensional plane (2D). This technique is valuable non-invasively tool for evaluation of
the cardiovascular flow patterns owing to its unique possibility to simultaneously acquire
sectional imaging without restriction, anatomy and blood flow velocities with a single scan.
The majority of the commercial systems offer the bi-dimensional phase-contrast sequence to
quantify blood velocity and derivative cardiac flow. These sequences are reliable and precise
methods to calculate stroke volume for pulmonary/systemic flow ratios estimation (Qp:Qs)
and to calculate volume regurgitation in valvular insufficiencies (6)(27). At present, 4D flow
cardiovascular magnetic resonance imaging (4D CMRI) sequences are being processed to
allow obtaining information of the 4D flow as well as the software to visualize and quantify 4D
images. There are several research groups working on these techniques, allowing visualization
of the blood flow patterns in any segment of the cardiovascular system (9)(10)(11)(23).
Nevertheless, the visualization of these images entails an important manual work, becoming
a very time-consuming task and then turning out to be not useful in the current clinical
practice. Therefore, it is important to improve the methods of automatic representation
of the 4D flows, and to do so it is crucial to have a powerful visualization tool able to
analyze the DICOM information from the medical image. In that sense, the International
Centre for Numerical Methods in Engineering (CIMNE) has developed a home-made ad-
hoc software (Aorta4D) oriented to make progress in this field of work (3)(1)(5)(27)(20).
Aorta4D will afford analysis and spatially visualization of the registered 3-directional blood
flow velocities, and perform a 3D semi-automatic segmentation based on the 4D flow CMRI
data. The purpose of this study is to demonstrate that 4D flow CMRI technique is a reliable
tool to provide the boundary conditions for the Computational Fluid Dynamics(CFD) in
order to estimate the WSS within the entire thoracic aorta in a short computation time. Our
image-based CFD methodology exploits the morphological MRI for geometry modelling and
4D flow CMRI for setting the boundary conditions for the fluid dynamics modelling. The
aim is to evaluate visualization of well-defined aortic blood flow features and the associated
wall shear stress by the combination of both techniques.

2 Material and Methods

2.1 Medical Image processing

Measurements were carried out using a 3 T MR system (Magnetom TRIO; Siemens, Erlan-
gen, Germany) time-resolved, 3-dimensional MR velocity mapping based on an RF-spoiled,
gradient-echo sequence with interleaved 3-directional velocity encoding (predefined fixed ve-
locity sensitivity = 150 cm/s for all measurements). Data were acquired in a sagittal-oblique,
3-dimensional volume that included the entire thoracic aorta and the proximal parts of the
supra aortic branches. Each 3-dimensional volume was carefully planned and adapted to
the individual anatomy (spatial resolution, 1.78 × 1.78 × 2 mm). In the in vivo situation,
measurements may be compromised by the active cyclic motion of the heart (cardiac con-
traction and dilation) and the passive motion of the heart due to respiration. These motion
components may lead to image artifacts and uncertainties about the exact measurement site
in the aorta. Only if the breathing state was within a predefined window data was accepted
for the geometrical reconstruction. To resolve the temporal evolution of vascular geometry
and blood flow, measurements were synchronized with the cardiac cycle. The velocity data

2



was recorder in intervals of Temporal Resolution (TeR) throughout the cardiac starting after
the R-wave of the ECG. The initial delay after R-wave detection was required for execution
of the navigator pulse and processing of the navigator signal. Two-fold acquisition (k-space
segmentation factor = 2) of reference and 3-directional velocity sensitive scans for each cine
time frame resulted in a temporal resolution of 8 repetition time = 45 to 49 milliseconds. To
minimize breathing artifacts and image blurring, respiration control was performed based
on combined adaptive k-space reordering and navigator gating. Further imaging parameters
were as follows: rectangular field of view = 400x(267-300) mm2, flip angle = 15 degrees,
time to echo = 3.5 to 3.7 milliseconds, repetition time = 5.6 to 6.1 milliseconds, and band-
width = 480 to 650 Hz per pixel. Velocity measurements a voluntary healthy, male subject
underwent MR examinations; written informed consent was obtained from the subject.

2.1.1 Segmentation based on 4D CMRI data

In order to explain how the computational domain was obtained a brief description of the
segmentation process is explained. Firstly, we select the time step where velocities are
higher (t=0.27 s). For that time step, we have four different set of images (Vx, Vy, Vz and
Magnitude), and for each pixel of those images the following equations are evaluated:

A(vx,y,z) = Xmax − σ(Mx) (1)
B(vx,y,z) = σ(vx, vx, vx) (2)

C(vx,y,z) = max(σ(Tvx), σ(Tvy), σ(Tvz)) (3)

D(vx,y,z) = 1/S(vx,y,z) (4)

Equation 1 is used to remove air from the images. Xmax is the maximum value of the
vx component in all the vector pixels in the image. Mx is the collection containing all the
vx components of radius 1 voxel neighborhood of vx,y,z. Basically, Ec.1 tries to give higher
values to points where the signal-to-noise ratio is higher, i.e., non air pixels. Equation 2 tries
to gives higher values to pixels in which the vector direction is stronger in one horizontal
or vertical direction, since blood in aorta travels vertically (ascending an descending aorta)
or horizontally (aortic arch). In Ec.2, vx, vy, vz are the velocity component values for each
pixelvx,y,z. Equation 3 makes uses of the fact that blood pumped out from the heart has
strong changes of velocity at the highest and lowest peak over time. Ec.3 gives the higher
pixel values to pixels where that change occurs. Tmag is the collection of magnitude values
of a voxel vx,y,z over time. Tvx, Tvz and Tvy means the velocity vector components over
time. Equation 4 tries to penalize voxels where the behavior of velocity is irregular. Blood
in the aorta has smooth behavior of gaining and loosing speed from diastole to systole and
then back. S(vx,y,z)is a measure of the smoothness of the value changes of a given pixel over
time. Each function is encapsulated as ITK filter(30). Therefore, the segmentation pipeline
process is:

• Eliminate air class using a mask obtained from the Ec.1. Another practical solution
may be using an associated magnitude image and apply a threshold to eliminate lower
intensities values.

• Apply Ec2, Ec3, Ec4 (a scalar value is assigned to each pixel).
• Define a threshold in which most aorta pixels lies.
• Binarize the image where (p=1 → if ∈ aorta, p=0 → otherwise)
• Apply morphological filters binary erosion and dilation. This will remove small voxels

that can be separated from the aorta.

• The aorta remains as the largest connected component. Select the largest connected
component.

3



Figure 1: Segmentation workflow

• Smooth the resulting image from step 6 and binarize again to achieve a binary mask.

The only requirement is to set interactively the threshold parameters of the aorta. Once
the aorta is segmented, a center line must be defined for visualization and quantification
purposes. The skeletonizing process is described in (15). The centerline will allow identifying
the inlet and outlet surface to define the boundary conditions needed for the CFD. The
segmentation is then used as a mask for the velocity image and is superimposed on a slice
of the scalar data. Figure 2 shows respectively the longitudinal cross section of the Aorta, a
surface mesh obtained and streamlines inside the aorta. Once we have finished, we use this
mask as initial conditions for the other time steps. For an expert user, total time for the
segmentation process is less than 5 minutes.

2.1.2 Aorta Meshing

The surface of the aorta segmented is irregular and rough as a consequence of the complexity
of the segmentation process. If it were directly meshed, these flaws might lead to misleading
conclusions regarding the wall shear stress. Therefore, a Laplacian smoother was applied to
the initial aorta segmented, with the aim of smoothing the main irregularities (see figure 2
(center)). The mesh used for the simulations was based on hexahedral cells and was divided
into three main parts: an internal uniform core with cells whose size were 0.938 mm x 0.938
mm x 0.969 mm, layers of cells at the aorta wall whose volumes were eight times lower than
the central core, and an intermediate region of cells separating the previous regions (see
figure 3). In particular, two layers of cells have been added (first layer, 40% thicker than
the 6-level cells and second layer 50% thicker than the first layer). The distance between
the wall and the first node is of the order of micrometers (10−6 m).

4



Figure 2: Aorta longitudinal cross section (left), black line in the Aorta longitudinal cross section (left)
shows the voxels chosen during the segmentation process, while the white line shows the smoothing
approach based on the voxelization process. The two images on the center of the figure show the 3D
surface mesh obtained during the smoothing process. A Velocity streamlines(right) obtained using

directly the volume mesh at the peak systole.

Figure 3: Detail of the cell refinement at the walls of the aorta with the magnitude of the distance between the
wall and the nodes. Cellevel represents the number of the cell generated close to the wall. y+ is the wall

coordinate (distance y to the wall).

A very accurate discretization of the arterial wall is needed because one of the objectives
of the work is to compute WSS by combining CFD and 4D CMRI data. To achieve this
purpose, three computational mesh were created (see figure 5) with different wall refinement.
The mesh was highly refined at the walls of the aorta in order to be able to solve the
boundary layer correctly (the distances for the first nodes of the original mesh were the
order of millimeters, and for the last mesh was the order of micrometers)(2). All the pre-
processing was performed using OpenFOAM software package(18).

2.1.3 Computational Fluid Dynamics

The use of CFD techniques in simulating blood patterns and modelling cardiovascular sys-
tems has become widespread within bioengineering and medical research in the past few
decades. However, the increasing reliance on CFD for hemodynamic simulations requires a
close look at the various assumptions required by the modelling activity, and in particular,
to assess the sensitivity to assumptions regarding boundary conditions (25)(29). Nowa-
days, thanks the new advances in 4D flow CMR imaging, we can obtain highly resolved

5



blood flow patterns in anatomically realistic models. Consequently, these realistic blood
flow patterns can be used as boundary conditions of the CFD models. Therefore, coupling
medical imaging and CFD allows to calculate new hemodynamics indicators, as WSS. An
important aspect to compute the distribution of the WSS is the anatomical domain. Local
arterial geometry components as curvature and smoothness will highly influence the WSS
results(24). Computationally, WSS can be defined in terms of the surface traction vector t
whose components are given as:

ti = (−p ∗ δij + τij) ∗ nj (5)
p denoting the pressure, τij are the components of the viscous stress tensor and nj are the
components of the normal n to the surface. The WSS is then defined, on each point on the
surface, as

tw = |tw| = |t− (t ∗ n) ∗ n| (6)
that is, the magnitude of the traction vectors component in a plane tangential to the surface.

In order to perform a realistic simulation, it is recommended to prescribe outflow bound-
ary conditions based on in vivo accurate measurements. Depending on its location and
type, the inlet velocity profile seems to influence both bulk flow and wall shear stress
distribution(24). For all case studied in this work, instead of using standard boundary
conditions based on lumped models (25)(29), we have fixed the flow rate waveform at the
supra-aortic vessels based on the 4D flow CMRI data. The inlet flow profile was measured
with 4D CMRI and prescribed in the ascending aorta. The velocity profile at the outlet,
simulations were performed without direct constraints on the shape of the outlet velocity
profiles, but prescribing zero normal gradient for all flow variables with the exception of pres-
sure. Velocity contours in the descending aorta were found to be in very good agreement
with 4D CMRI measurements, with prediction of flow reversal on the inner side in the de-
scending aorta (5). The average peak Reynolds number was higher in the ascending (≈4500)
and descending aorta (≈4200) than in the aortic arch (≈3400). The supercritical Reynolds
number, indicating flow instabilities, is significantly correlated with body weight, aortic
diameter and cardiac output. While the findings might suggest the presence of flow instabil-
ities in the healthy aorta at rest, this does not involve fully turbulent flow(28). In this study,
we focus on the WSS distribution at the systolic peak, therefore it is not necessary consider
elastic wall. Arterial walls were assumed to rigid, and no-slip condition was imposed. The
CFD code used to solve the WSS was the open source code OpenFoam(18). The OpenFoam
library solves differential partial equations with the Finite Volume Method. The solver used
in the present work is for steady-state flow with the SIMPLE (Semi-Implicit Method for
Pressure Linked Equations) algorithm for solving the velocity-pressure coupling(19).

2.1.4 Hypotheses and boundary conditions

The main hypotheses assumed for the aorta simulation are incompressible and laminar flow,
Newtonian fluid, rigid wall and uniform inlet velocity profile. Right and left coronaries and
intercostal arteries are not included in this study. As one of the main goals of the study was to
determine wall shear stress that blood causes in order to prevent medical diseases, the most
critical conditions were simulated for the thoracic aorta. As a consequence, the simulations
were carried out at the peak systolic time (t=0.27 s). At this time step, blood velocities
pulsing through the aorta are high and subsequently the wall shear will be higher. Realistic
boundary conditions were applied to the computational model, thanks to the information
provided by the 4D flow CMR images. Since the pressure in each outlet is different and
difficult to obtain from the 4D CMRI data, we use the velocities and flow rates at each
boundary conditions. The uniform inlet velocity profile was applied parallel to the inlet
faces normal vector, and its module was computed considering the flow rate and the surface

6



of the inlet face. On the other hand, at the supra-aortic vessels, outlet flow rates were
imposed, since the direction of the outlet velocities are not relevant. At the outlet of the
descending aorta, null pressure was applied and taken as the reference value. The outlet
flow rates used at the supra-aortic branches were the following:

• Brachiocephalic artery: 27.13 ml/s
• Left common carotid artery: 10.15 ml/s
• Left subclavian artery: 18.00 ml/s
For the computation of the inlet velocity vector, the following steps were followed. By

considering the real measures obtained from the 4D CMRI, the inlet volumetric flow rate for
that aorta was 259.14 ml/s. As the velocity boundary condition needs to be a vector and a
standard model was considered, its direction was set parallel to the normal vector of the inlet
patch.The area vector of patch inlet was computed

∣∣A∣∣ = 4.31163 × 10−4m2. The module
of the main inlet velocity was computed considering the inlet area and the volumetric flow
rate is: Umean = kc∆Qinlet/

∣∣A∣∣. Where kc is a constant that needs to be included because
the inlet patch is not completely bidimensional: kc=flux required/flux of a 3D inlet. This
constant was necessary because when the simulation was carried out with an inlet velocity
according to Umean without kc, the inlet flow rate computed after the simulation was higher
than expected. It was concluded that this was because of the fact that the inlet patch was
not completely two-dimensional. Constant kc then expresses the relation between the flow
rate that was erroneously obtained and the required volumetric flow rate (259.14 ml/s). The
area vector of patch inlet was normalized. A comparison between the outlet flow rates at
the outlets can be observed in Table 1.

Artery 4D CMRI data Estimated

Brachiocephalic 10.47 % 13.73 %
Left common carotid 3.92 % 4.20 %

Left subclavian 6.85 % 6.56 %
Descending Aorta 72.86 % 75.51 %

In order to limit the study, the intercostal arteries and left and right coronaries arteries are
left out (aprox. 6% of the total flow (16)). It can provide and approximate idea of the error
committed.

3 Results

Based on WSS indicators, it has been demonstrated that WSS play an important role in the
development and progression of vessel wall pathologies (4). As it is explained in section 3,
wall shear computation is based on the velocity gradient close to the wall. For that reason,
firstly we have compared the 4D flow CMRI velocities against the CFD velocities obtained.
The assumptions taken during the CFD simulation were: flat inlet velocity profile, outlet
velocity profiles as boundary conditions and laminar Newtonian flow; and WSS computation
will be perform only for the peak systolic instant time, therefore we assume rigid and static
aorta walls. Next figure 4 shows the velocity profile obtained using the OpenFOAM software
against the 4D flow CMRI velocity distribution at different sections along the entire aorta.
Evaluating quantitatively the results, we can observe that the CFD results are capable to
capture the vorticity and the flow distribution along of the aorta. However, we can also
notice some differences in the ascending aorta due to the assumption of flat inlet velocity
profile, as also is reported on (14). For this analysis we do not consider the eccentricity of
the aortic valve(7).

7



Figure 4: Velocity distribution (CFD versus 4D flow CMRI) through different cross-sectional planes along the
aorta (ascending aorta (planes 1-4), aortic arch (planes(5-6), descending aorta(planes 7-10)).

Following table shows the differences between the flow4DCMR and flowCFD for the dif-
ferent cross-sectional planes at the ascending and descending aorta. We observe the flow
differences provoked by coronaries arteries in the ascending aorta and by the intercostal
arteries in the descending aorta. Another source of error could be the segmentation process.

Cross-sectional Plane flow4DCMR flowCFD Error

Ascending Aorta Plane 1 259.14 ml/s 259.14 ml/s 0%
Ascending Aorta Plane 2 248.7 ml/s 259.14 ml/s 4.1%
Ascending Aorta Plane 3 248.5 ml/s 259.14 ml/s 4.1%
Ascending Aorta Plane 4 248.2 ml/s 259.14 ml/s 4.2%
Descending Aorta Plane 7 196 ml/s 195.67 ml/s 0.16%
Descending Aorta Plane 8 193.30 ml/s 195.67 ml/s 1.21%
Descending Aorta Plane 9 191.47 ml/s 195.67 ml/s 2.14%
Descending Aorta Plane 10 190.95 ml/s 195.67 ml/s 2.41%

Once mass conservation is satisfied, we obtain the WSS (WSSCFD). To check the ac-
curacy of the WSSCFD, a sensitivity analysis was carried out to assure grid independence:
three meshes were created, with a number of cells ranging from 104 to 1.5 X106 (figure 5).

• 4D CMR Model: 4D flow CMR data. Original 4D flow CMRI data. Voxels size: 1.78
× 1.78 × 2 mm.

8



• Mesh Model 1: computational mesh using same spatial discretization as 4D CMR
Model.

• Mesh Model 2: Refined of Mesh Model 1 ((? )).
• Mesh Model 3: Refined of Mesh Model 2 (see figure 3)((? )).

4DCMR Model Mesh Model 1

Mesh Model 2 Mesh Model 3

Figure 5: Different computational meshes used to compute the wall shear stress

Next, we have computed the WSS (WSS4DCMR) based on the 4D flow CMR data. To
compute the WSS4DCMR, firstly we have calculate the ∆velocity and the ∆distance map
function for the aorta binary mask image as a convolution with the derivative of gaussian
kernel, after that, the WSS4DCMR is calculated as the directional derivative of the velocity in
the direction of the normal to the vessel wall µ∆δV/δn. Where µ is the viscosity of the blood.

Figure 6 shows wall shear stress distribution for each case (4D CMR Model, Mesh Model
1, Mesh Model 2 and Mesh Model 3). In order to compare the results, WSS4DCMR and
WSSCFD are normalising with their corresponding peak value. The main reason to normal-
ize the WSSCFD is due to artificially high WSS at the vessel boundaries, furthermore in the
MRI velocity data (due to image resolution) this end effects are not present. The grid sensi-
tivity study on the aorta model under steady flow conditions (peak systole), demonstrated
that there are differences in the maximum WSS scalars. Therefore, it must be noted in this
context that the boundary layer plays an important role in the WSS values. Computational
time was (Model 1: 64 sec, Model 2: 101 sec and Model 3: 3534 sec). artificially high WSS
at then vessel boundaries

9



4DCMR Model Mesh Model 1

Mesh Model 2 Mesh Model 3

Figure 6: Wall shear stress for the different computational meshes

Due to the lack of 4D flow CMR resolution, for the 4D CMR model, WSS4DCMR at the
supra-aortic arteries cannot be estimated. To compute the WSS4DCMR, we based on the
directional derivative of the velocity in the direction of the normal to the vessel wall, at
least a minimum number of voxels are needed. If we need to estimate WSS4DCMR in small
arteries, 4D flow CMR resolution should be increased. For the CFD computation, maximum
velocities are reached at the supra-aortic arteries provoking WSSCFD peak values. We have
not removed those peak WSSCFD in the outlet arteries because of we are interested to
WSS patterns in the ascending and descending aorta. For the cases analysis, we observe
that WSS follows the same pattern, and there are two aortic areas when the WSS values
are higher, one in the ascending aorta (close to the aortic valve) and other in the internal
part of the descending aorta just behind the aortic arch. We can see these aortic areas in
other works as (5). When we increase the computational mesh resolution, we notice that
the WSS areas and the peak values begin to improve. After that, we have interpolated
the 4D velocity CMR data into the Mesh Model 3 (high resolution) with the objective to
compare the WSS4DCMR−>MeshModel3 against WSSCFD−>MeshModel3 and the WSS4DCMR.

10



In order to do this, we use a B-Spline approximation in order to evaluate at any point
the 4D velocity CMR over the Mesh Model 3 taking into account null velocity over the
wall. Afterward, we compute the WSS based on the directional derivative of the velocity
(WSS4DCMR−>MeshModel3), figure 7. We notice that the WSS areas for the three cases
are similar but the peak values are different for each model. The main differences between
WSS4DCMR and WSS4DCMR−>MeshModel3 are related with the mesh or spatial resolution.
The fact that use a velocity B-Spline approximation over Mesh Model 3 makes a more
realistic velocities close to the wall and subsequently the WSS. The differences between the
WSS4DCMR−>MeshModel3 and WSSCFD−>MeshModel3 are related with the flow distribution
inside the aorta, as we have explained previously, in Mesh Model 3 we are not taking into
account the coronary arteries and the intercostal arteries, and the effects provoked by these
arteries. Due to the fact we are using a cubic B-Spline interpolation function to interpolate
the velocity, the WSS4DCMR−>MeshModel3 obtained are smoother. In view of the foregoing
that results, the interpolation of 4D flow CMR data over a high resolution mesh can be
another option to estimate properly the wall shear stress values.

Figure 7: WSS4DCMR−>MeshModel3 estimated using 4D velocity CMR data into the Mesh Model 3.

4 Discussion

This study has investigated the WSS in a 4D CMRI based subject specific human aorta,
using both CFD and 4D flow CMRI models. The methodology proposed can be considered
a starting point to compute physiological WSS starting from blood flow measures acquired
by 4DMRI in an effective and efficient manner. In fact, 4D flow CMR technique is able to
provide us a 3D domain and velocity distribution for any cross-sectional plane of the domain
through non-invasive measurements. With the aim to demonstrate that the methodology
proposed is possible, wall shear stress distribution was computed for different computational
meshes from a healthy patient-specific human aorta. The different computational meshes
resolution show differences between the numerical results. However, wall shear distribution
along the aorta follows same pattern for the different computational meshes and the areas
with low and high WSS may be differentiated. To correctly evaluate the WSS values, a
high resolution mesh is in fact necessary with a reasonable computational time. We notice
that for the 4D flow CMRI model the image resolution is not enough compared to the CFD
analysis. The CFD analysis show similar results compared to the literature (5)(21). Also
it is important to remark that, as we are able to compute the flow profile at the outlets of

11



our domain, we do not need to use a multiscale modelling to estimate the boundary con-
ditions of the CFD problem. In (5) the authors notice that there were large differences for
the instantaneous WSS between the elastic and rigid wall models. This methodology also
avoids to perform CFD Fluid Structure Interaction(FSI) analysis, eluding the difficulties
related to setting the patient-specific mechanical properties of the arterial wall. In order
to avoid a CFD-FSI problems, the computational mesh and flow measures at the inlet and
outlets can be obtained using the 4D flow CMR data for each time step, and for each one
we perform a steady-state CFD analysis. Thanks to that, other hemodynamic parameters
as the time-averaged WSS (TAWSS), the oscillating shear index (OSI) and the relative resi-
dence time (RRT) can be estimated taking the displacement of the aorta into consideration.
Where OSI describes the cyclic departure of the WSS vector from its predominant the axial
alignment (8), the TAWSS is used to evaluate the total WSS on the wall throughout a
cardiac cycle, and it is calculated by integrating each nodal WSS vector magnitude at the
wall over the cardiac cycle (14), and the RRT is inversely proportional to the magnitude of
the time-averaged WSS vector and it indicates the average amount of time that a particle
(molecule) spends at the endothelium. These hemodynamic parameters are emerging as new
diagnostic indicators for cardiovascular diseases, such as, atherosclerosis localization (20) or
abdominal aortic aneurysm rupture risk prediction (26). In a future study, based on these
preliminary results, these hemodynamic parameters will be explored. In this work, we only
focus on the computation of the WSS at peak systole.

The main limitation of this study might be represented by the fact that it was carried
out considering only one image-based healthy aorta and at the peak systole, but the strat-
egy used to compute the WSS using the 4D flow CMRI data shows promising results. There
might be small errors in the segmentation process compared to the real geometry because
of the limited 4D flow CMRI resolution during the diastolic phase due to the low velocities
at the aorta during this period. This aspect could affect the WSS, but, as the simulations
are based on at peak velocity time, and as the main goal is to investigate the differences
between the resolution of the models (computational mesh) taking into account the same
geometry, a good estimate of WSS can be obtained. It is worth also to take into account
that in this study the outflow conditions were all exposed to the same waveform shape at
the inlet section of the ascending aorta, and modelling blood as a Newtonian fluid. In our
opinion, this does not entail a loss of generality in our study, which aims at investigating a
single aspect, i.e., the methodology used to compute faster the WSS distributions combining
4D flow CMRI data and CFD. Due to the lack of 4D flow CMRI resolution, the induced
effects of the intercostal arteries and coronaries arteries cannot be captured in our study.

Bibliography

[1] Blum R.D. Numerical simulations of aortic blood flow with a bicuspid aortic valve.
Technical report, Emory University, 2010.

[2] Casacuberta J, OpenFOAM Guide for Beginners. www.http://the-foam-
house5.webnode.es/

[3] Cootes T.F. and Taylor C.J. Statistical models of appearance for medical image analysis
and computer vision, Proc. SPIE Medical Imaging, p236-248, Vol. 4322, 2001.

[4] Hiratzka LF, Bakris GL, Beckman JA, et al. 2010 ACCF/AHA/AATS/ACR/ASA/S-
CA/SCAI/SIR/STS/SVM guidelines for the diagnosis and management of patients
with thoracic aortic disease. Catheter Cardiovasc Interv. 1;76(2):E43-86, 2010.

[5] Lantz J., Renner J. and Karlsson M. Wall shear stress in a subject specific human
aorta. influence of fluid-structure interaction. Internal Journal of Applied Mechanics,
(3), 4, 759-778, 2011.

12



[6] Lotz J. Flow measurements in cardiac MRI. Radiologe. Apr;47(4):333-41, 2007.

[7] Kari FA, Kocher N, Beyersdorf F, Tscheuschler A, Meffert P, Rylski B, Siepe M, Russe
MF, Hope MD.Four-dimensional magnetic resonance imaging-derived ascending aortic
flow eccentricity and flow compression are linked to aneurysm morphology. Interact
Cardiovasc Thorac Surg. 20(5):582-8. 2015.

[8] Ku DN, Giddens DP, Zarins CK and Glagov S, Pulsatile flow and atherosclerosis in
the human carotid bifurcation. Positive correlation between plaque location and low
oscillating shear stress, Arteriosclerosis. 5:293-302, 1985.

[9] Markl M, Harloff A, Bley T.A et al. Time-Resolved 3D MR Velocity Mapping at 3T:
Improved Navigator-Gated Assessment of Vascular Anatomy and Blood Flow. Journal
of Magnetic Resonance Imaging Art: 06-0195. 25:000000, 2007.

[10] Markl M, Draney MT, Hope MD, et al. Time-resolved 3-dimensional velocity map-
ping in the thoracic aorta: visualization of 3-directional blood flow patterns in healthy
volunteers and patients. J Comput Assist Tomogr 28:459468, 2004.

[11] Markl M, Kilner PJ, Ebbers T. Comprehensive 4D velocity mapping of the heart and
great vessels by cardiovascular magnetic resonance. J Cardiovasc Magn Reson. 14;13:7,
2011.

[12] Markl M, Frydrychowicz A, Kozerke S, Hope M, Wieben O. 4D flow MRI. J Magn
Reson Imaging 36: pp. 1015-36, 2012.

[13] Markl M, Wallis W, Harloff A. Reproducibility of flow and wall shear stress analysis
using flow-sensitive four-dimensional MRI. J Magn Reson Imaging 33: pp. 988-94, 2011.

[14] Morbiducci U, Ponzini R, Rizzo G, Cadioli M et al. In Vivo Quantification of He-
lical Blood Flow in Human Aorta Flow in Human Aorta by Time-Resolved Three-
Dimensional Cine Phase Contrast Magnetic Resonance Imaging. Annals of Biomedical
Engineering March 2009, Volume 37, Issue 3, pp 516-531

[15] Tran S. and Shih L.Efficient 3D binary image skeletonization. Computer Engineering,
University of Houston. Clear Lake (UHCL). IEEE Computational Systems Bioinfor-
matics ConferenceIEEE Computer Society. p-364-372, 2005.

[16] Olufsen MS, Peskin CS, Won Yong Kim, Pedersen EM, Nadim A, Larsen J. Numerical
Simulation and Experimental Validation of Blood Flow in Arteries with Structured-
Tree Outflow Conditions. Annals of Biomedical Engineering. Volume 28, Issue 11, pp
1281-1299, 2000.

[17] Ooij P van, Potters WV, Guedon A, Schneiders JJ, et al. Wall shear stress estimated
with phase contrast MRI in an in vitro and in vivo intracranial aneurysm. Journal of
Magnetic Resonance imaging pp. 876-884, 2013.

[18] OpenCFD Ltd., OpenFoam. The open source CFD toolbox (2012).

[19] Patankar, S.V. and Spalding, D.B., Numerical Prediction of Three-dimensional Flows
(Imperial College of Science and technology Mechanical Engineering Department,
1972).

[20] Petersson S. Fast and Accurate 4D Flow MRI for Cardiovascular Blood Flow Assess-
ment. Thesis Dissertations No. 1380. Linköping University Medical. ISBN 978-91-7519-
506-3, 2103.

13



[21] Petersson S, Dyverfeldt P and Ebbers T. Assessment of the Accuracy of MRI Wall
Shear Stress Estimation Using Numerical Simulations. Journal of Magnetic Resonance
Imaging 36:128138. 2012.

[22] Potters WV,Marquering A, VanBavel E., Nederveen AJ. Measuring Wall Shear Stress
Using Velocity-Encoded MRI. Current Cardiovascular Imaging Reports. 7:9257, 2014.

[23] den Reijer PM, Sallee D 3rd, van der Velden P, et al. Hemodynamic predictors of
aortic dilatation in bicuspid aortic valve by velocity-encoded cardiovascular magnetic
resonance. J Cardiovasc Magn Reson. 13;12:4, 2014

[24] Renner J. Towards subject specific aortic wall shear stress. Technical report, Linköping
University 2011.

[25] Soudah E, Rossi E, Idelsohn E, Oñate E. A Reduced Order Model based on Coupled
1D/3D Finite Element Simulations for an Efficient Analysis of Hemodynamics Prob-
lems. Journal of Computational Mechanics. 54:10131022. 2014.

[26] Soudah E, EYK Ng, Loong TH., Bordone M., et al. CFD Modelling of Abdominal Aortic
Aneurysm on Hemodynamic Loads using a Realistic Geometry with CT. Computational
and Mathematical Methods in Medicine, Volume 13, Article ID 472564, 9 p, 2013.

[27] Srichai MB, Lim RP, Wong S, Lee VS. Cardiovascular applications of phase-contrast
MRI. AJR Am J Roentgenol. 192(3):662-75, 2009.

[28] Stalder A.F., Frydrychowicz A., Russe M.F, Korvink, J.G., Hennig J., Li K. and Markl
M. Assessment of flow instabilities in the healthy aorta using flow-sensitive MRI. Jour-
nal of Magnetic Resonance Imaging, 2011.

[29] Vignon-Clementel IE, Figueroa AC, Jansen KE, Taylor CA. Outflow boundary con-
ditions for three-dimensional finite element modelling of blood flow and pressure in
arteries. Comput Methods Appl Mech Eng 195(2932):37763796, 2006.

[30] Yoo T.S. , Ackerman M. J. ,Lorensen W. E. , Schroeder W., et al. Engineering and
Algorithm Design for an Image Processing API: A Technical Report on ITK - The
Insight Toolkit. In Proc. of Medicine Meets Virtual Reality, J. Westwood, ed., IOS
Press Amsterdam pp 586-592, 2002.

14


	Introduction
	Material and Methods
	Medical Image processing
	Segmentation based on 4D CMRI data
	Aorta Meshing 
	Computational Fluid Dynamics
	Hypotheses and boundary conditions


	Results
	Discussion
	Bibliography
	caratula WSP.pdf
	UPCommons
	Portal del coneixement obert de la UPC
	http://upcommons.upc.edu/e-prints
	Versió electrònica d’un article publicat a Journal of mechanics in medicine and biology, 0, 1750046 (2016), 16 p. DOI: http://dx.doi.org/10.1142/S0219519417500464
	© World Scientific Publishing Company
	http://www.worldscientific.com/worldscinet/jmmb
	Electronic version of an article published as Journal of mechanics in medicine and biology, 0, 1750046 (2016), 16 pages. DOI: http://dx.doi.org/10.1142/S0219519417500464
	© World Scientific Publishing Company
	http://www.worldscientific.com/worldscinet/jmmb


