












































Microsoft Word - Paper-tracer-v3.doc


Material Flow Visualization in Friction Stir Welding 
 via Particle Tracing 

 
Narges Dialami, Michele Chiumenti, Miguel Cervera 

 

International Center for Numerical Methods in Engineering (CIMNE), 
Technical University of Catalonia, Module C1, North Campus 

C/ Gran Capitán s/n 08034 Barcelona, Spain. 
 

Corresponding author: Narges Dialami Tel.(+34) 93 401 6529 / Fax.(+34) 93 401 
6517 

E-mail addresses: narges@cimne.upc.edu (N. Dialami),  
michele@cimne.upc.edu  (M. Chiumenti), mcervera@cimne.upc.edu (M. Cervera) 

 
Abstract 
This work deals with the modeling of the material flow in Friction Stir Welding 

(FSW) processes using particle tracing method. For the computation of particle 
trajectories, three accurate and computationally efficient integration methods are 
implemented within a FE model for FSW process: the Backward Euler with Sub-
stepping (BES), the 4-th order Runge-Kutta (RK4) and the Back and Forth Error 
Compensation and Correction (BFECC) methods.  Firstly, their performance is 
compared by solving the Zalesak’s disk benchmark. Later, the developed methodology 
is applied to some FSW problems providing a quantitative 2D and 3D view of the 
material transport in the process area. The material flow pattern is compared with the 
experimental evidence. 

 
Keywords: Friction Stir Welding, Material flow, Particle tracing, BES, BFECC, RK4 
 

1. Introduction 
 

Friction Stir Welding is a solid-state joining technique lately found by Thomas et. 
Al. [1]. A schematic representation of the FSW process is illustrated in Figure 1. A 
shouldered pin rotating at constant rotational speed is inserted into the line between the 
two plates to be welded. Once the insertion is completed, the pin is moved along the 
welding line at constant rotating and advancing speeds to form the joint. The joining is 
achieved via the generated heat and the material mixing/stirring process.  

The heat is induced both by the friction between the tool shoulder and the work-
pieces and by the plastic dissipation in the process area. On one hand, the shoulder is 
essential to generate heat through the friction process and to prevent the expulsion of the 
material during the movement of the pin-tool. On the other hand, the pin deforms the 
material around it generating heat by plastic dissipation.  The quality of the final joint, 
as well as the final microstructure of the material, depends on both mechanisms: the 
shoulder must generate heat enough to allow for the material to flow around the tool and 
to obtain a deep heat affected zone (HAZ). Insufficient heat is usually due to 
insufficient normal pressure or an incorrect shoulder diameter. Consequently, the 
material is not softened enough for it to flow properly and voids are formed. Moreover, 
the pin-tool shape as well as the welding parameters (such as the advancing and rotating 
speed) can significantly affect the material flow pattern modifying the mechanical 
properties of the joint [2]. In the FSW process, the plastic deformation concentrates 
nearby the pin. The extent of the stir-zone plays a critical role for the quality of the 

marta garcia-sanchez
Texto escrito a máquina
The final publication is available at Springer via http://dx.doi.org/10.1007/s12289-013-1157-4

marta garcia-sanchez
Texto escrito a máquina

marta garcia-sanchez
Texto escrito a máquina

marta garcia-sanchez
Texto escrito a máquina



joint-strength. To achieve a high quality and defect-free weld, it is necessary to produce 
a deep penetrating stir-zone around the pin.  

 
Figure 1: Schematic description of the different tools in a FSW process 

 
The visualization of the material flow is very useful to understand the size of the stir-

zone and its penetration within the thickness of the welding plate. However, following 
the position of the material during the welding process is not an easy task, neither 
experimentally or numerically. 

Experimentally, the motion of the material in the stir-zone is usually tracked using 
the so-called Marker Insert Technique (MIT). The markers, made from a different 
material to the plate, are inserted into the welding line and their final positions (after the 
welding process) are detected by means of a metallographic study or X-ray radiography. 
Different contrast materials are used as markers: Al-alloys [3, 4, 5], steel balls [6], 
copper foils [7, 8], plasticine and brass rods [9].  

Another possibility to visualize the material mixing consists of welding two 
dissimilar materials. This technique enables an easy visualization of the material 
redistribution at the joint interface. The two materials can be different magnesium alloys 
[10], aluminum or copper alloys [11], [12].  

The material located close to the pin-tool undergoes a vertical movement induced by 
the threaded pin shape while rotating from the advancing to the retreating side of the pin 
tool. Experimentally, it is very difficult to track the material flow within the thickness of 
the stir-zone.  

The alternative is the development of numerical techniques able to simulate the FSW 
process in all its complexity together with an ad-hoc material tracing technology. This 
paper is a step forward in this direction, within the field of FSW simulation where a 
fully thermo-mechanical Finite Element model has been developed within the Arbitrary-
Lagrangian-Eulerian kinematic framework (a detailed description of this work can be 
found in [13, 14]). The purpose of the current work is to get a better understanding of 
the material behavior due to the stirring process. The trajectories of the stirred material 
are computed and visualized using different particle tracing techniques. This 
methodology, widely used in image processing or in fluid dynamics analysis, is a 
suitable and robust tool to study the FSW problem allowing for a clear visualization of 
the material movement at the stir-zone leading to a better understanding of the welding 
process itself. 



A brief description resuming the main aspects of the simulation technology used for 
the numerical analysis of the FSW process is presented in Section 2. Section 3 describes 
different time integration schemes allowing for the particle tracing analysis: the 
Backward Euler with Sub-stepping (BES), 4-th order Runge-Kutta (RK4) and the Back 
and Forth Error Compensation and Correction (BFECC) method. In the last Section the 
different techniques for the material tracing are compared and then used for 2D and 3D 
FSW simulations.   

 
2. FSW simulation technology 
 
In this section the main characteristics of the FSW model are briefly explained. In 

the FSW process the pin rotates at a constant angular velocity and, at the same time, it 
moves forward at constant advancing speed. The work-piece (i.e. the sheet plate to be 
welded) is clamped to the back-plate. Consequently, the simulation analysis defines 
pure rotation (around a fix rotation axis) for the pin while the advancing speed (in the 
opposite direction) is assigned to both the work-piece and the back-place. This given, 
the main idea to simulate the FSW process consists of dividing the original geometry 
into three different zones which are: the pin, the work-piece (excluding the process-zone 
close to the pin) and the stir-zone (process/welding zone) also referred to as Heat 
Affected Zone (HAZ). In each domain, the most suitable kinematic framework is 
considered. The work-piece is modeled in the Eulerian framework assuming an in-flow 
velocity, which corresponds to the advancing speed of the pin-tool. The pin is assumed 
to be rigid: its rotation is described in Lagrangian framework.  Finally, the Arbitrary-
Lagrangian-Eulerian (ALE) kinematic framework is used to study the stir-zone. The 
main reason for this split is, on one hand, that the large deformations (material stirring) 
in the process zone cannot be easily handled with a classical updated Lagrangian 
scheme, since it leads to excessive mesh distortions. To overcome the degradation of the 
results, the Lagrangian framework should be complemented by a continuous re-meshing 
strategy. On the other hand, a purely Eulerian scheme is also difficult to apply due to the 
change in the boundary conditions induced by the rotation of the pin. Therefore, the 
choice of ALE kinematic framework is very convenient because re-meshing is not 
necessary and moving boundaries can be easily taken into account. In fact, the mesh 
representing the work-piece is kept fix (Eulerian description), while the mesh of the pin 
and the stir-zone is rigidly rotated according to the angular velocity defined for the FSW 
process. As a consequence, the pin (rigid) is described in Lagrangian framework (the 
mesh strictly follows the body movement) while, in the stir-zone, the actual velocity 
field and the imposed mesh movement are different (ALE hypothesis). 

Note that the ALE framework is very general, including both Lagrangian and 
Eulerian settings as particular cases. In the following, the governing equations of the 
thermo-mechanical problem used to solve the FSW problem will be presented in this 
format (more details in [13,14]). 

From the constitutive point of view, the main hypotheses adopted for the numerical 
simulation of the FSW process are:  
 Both the stress tensor,σ , and the strain rate tensor, ε , admit a similar split into 
volumetric and deviatoric parts: 

s1σ  p  (2.1) 

eIε   vole
3

1
  (2.2) 



where p  and s  are the pressure and the stress deviator, respectively. Similarly, vole  and 

e  are the volumetric and deviatoric parts of the strain rate tensor, respectively.  
 The deviatoric part of total strain rate tensor, e  is computed as the symmetric 
gradient of the velocity field as:   vεe s  dev . This means that the volumetric 
deformation, 0 vvole , including thermal deformation, is negligible. Therefore, 
the material rate flow is assumed to be incompressible. 
 Due to the high viscosity of the material and, consequently, the very low values of 
Reynolds number in the FSW analysis, the inertia term of the balance of momentum 
equation can be neglected. Therefore, the mechanical problem is solved within the 
hypothesis of quasi-static analysis. 

This given, the governing equations in ALE format (balance of momentum, mass 
conservation and balance of energy) which describe the thermo-mechanical problem 
are:  

 













 






qvv

v

0bs

mechmesho

o

DT
t

T
c

p

 

0




 (2.3) 

where o , b  and c  are the density, the body forces per unit of mass and the specific 
heat, respectively. mechD is the dissipation rate per unit of volume due to the plastic 

work. The heat flux, q, is defined according to the isotropic Fourier’s law as: 
Tk   q  (2.4) 

where k is the thermal conductivity and T is the temperature field. 
The mesh velocity is denoted by meshv . Observe that the convective term 

  Tc mesho  vv  vanishes in the Lagrangian framework ( meshvv  ) and reduces to 
Tco v  in the Eulerian zone ( 0v mesh ). 

The boundary conditions to complete the coupled problem (2.3) are generally 
defined for the mechanical analysis in term of prescribed in-flow velocity, at one end of 
the work-piece, and rotational velocity assigned to the pin-tool. Both velocities are the 
most representative parameter to be studied in the FSW analysis. Referring to the 
thermal problem, neither Dirichlet nor Neumann boundary conditions are usually 
applied. Instead, the thermal analysis is completed defining the heat flow dissipated 
through the boundaries by heat convection (Newton’s law) and heat radiation processes: 

 
 440 envrad

envconvconv

TTq

TThq





  
(2.5) 

where convh is the heat transfer coefficient by convection, 0  is the Stefan–Boltzmann 
constant and   is the emissivity factor. Finally, envT  is the surrounding environment 
temperature. 

In FSW, the heat necessary for the welding process is generated both by the plastic 
dissipation due to the material stirring in the process zone and by the friction process at 
the contact interface between the shouldered pin-tool and the work-piece surface.  

On one hand, the mechanical dissipation is computed as:  
es  :mechD    (2.6) 

where %90  is the fraction of the total plastic energy which is converted into heat. 
Observe that the constitutive model chosen is rigid-visco-plastic: the elastic 



deformations are negligible if compared with the total amount of plastic strains 
developed in the stir-zone.  The constitutive relationship between the (deviatoric) stress 
tensor and the (plastic) strain rate is defined in the following general format as: 

es eff2  (2.7) 
where the effective viscosity,  Teff , e , is determined according to the rigid-visco-
plastic constitutive law chosen (i.e. Norton–Hoff  or Sheppard–Wright models).   

Besides, the heat flux produced by the frictional contact between pin and the work-
piece is expressed by the Norton’s friction model as: 

   
   












1

1

 

 
q

T
SZ

TT
SZSZ

frict

q

T
pin

TT
pinpin

frict

Taq

Taq

vvt

vvt




 (2.8) 

where the amount of heat absorbed by the pin-tool, pin , and by the work-piece, SZ , 

(at the stir-zone) depends on the thermal diffusivity, 
c

k

o
  , of the two materials in 

contact as: 
















SZpin

SZ
SZ

SZpin

pin
pin










 (2.9) 

The tangential component of the traction vector at the contact interface, Tt , is 
defined using the Norton’s friction law as: 

  T
q

TT Ta uv  t  (2.10) 

where  Ta is the (temperature dependent) material consistency,  0≤q≤1  is the strain 

rate sensitivity and 
T

T
T

v

v
u




  is the tangential unit vector, defined in terms of the 

relative tangential velocity at the contact interface, Tv . 
The weak form of the FSW problem (2.3) defined over the integration domain Ω  

and its boundary   reads as: 

   
  

    

























 







 




 





TWdVTTkdVTT
t

T
c

pdVp

WdVpdV

thermesho

mech
s







vv

v

vvvs

0

:

 

(2.11) 

where the mechanical and the thermal work of the external forces is defined as: 

 

    





















dSTqqdVTDW

dVW

radconvmechther

omech







vb

 (2.12) 

The test functions of the velocity, pressure and temperature fields are v , p  and 
,T  respectively. 



The discrete FE counterpart of the weak form (2.11) is solved using (stable) mixed v-
p-T finite elements with linear interpolations for all the nodal variables.  To overcome 
the limitations on the choice of the interpolation spaces imposed by the Ladyzhenskaya–
Babuška–Brezzi (LBB) inf-sup condition [23], the proposed formulation is stabilized 
using Orthogonal Sub-Grid Scale method (OSS). More details related to the mixed 
finite element technology to deal with the incompressibility constraint in both linear and 
non-linear problems can be found in [24, 25, 26]. 

Finally, the coupled thermo-mechanical problem is solved by means of staggered 
time-marching scheme where two sub-problems (thermal and mechanical) are solved 
sequentially, within the framework of the classical fractional step methods [21,22].  

 
3. Particle tracing 
 
Particle tracing is a method used to simulate the motion of particles (tracers), 

following their positions at each time-step of the analysis. The method can be naturally 
applied to the study of the material flow around the pin in FSW process. 

 Let us assume that the velocity field,  tjv , is known at each node, j, of the finite 
element mesh representing the domain at any time, t , of the analysis.  The position of a 
generic tracer at the same instant of time,  tX , can be computed by solving the 
following differential equation at each time-step of the analysis:  

     tt
Dt

tD
,XV

X
  (3.1) 

Integrating: 

    
t

tttt
0

0 d,XVXX  (3.2) 

where 0X  is the initial position of the particle (see Figure 1).   tt ,XV  is the velocity 
of the tracer at its current position. This velocity can be computed in two steps: firstly, it 
is necessary to know in which element (of the FE discretization of the plate) the tracer is 
contained (a spatial search algorithm1 is required) and, secondly, its velocity is 
interpolated from the values of the velocity field at the nodes of this element and the 
corresponding interpolation (shape) functions,   tN j X , as: 

       



n

j

j
j tNttt

1

 , XvXV  (3.3) 

The solution of the ordinary differential equation (ODE) (3.1) returns the sequence 
of positions,  ntX  for all the tracers according to the time-marching scheme of the 
analysis. The post-process of this solution defines the trajectories of all the tracers 
originally placed in the stir-zone.  

A large number of time integration schemes have been developed up to date to solve 
equation (3.1). These methods range from the simple first order Backward Euler (BE) 
scheme to higher order Runge-Kutta schemes. In this work, the following integration 
schemes are compared for the particle tracing in the FSW process: BE with Sub-
stepping (BES), the 4-th order Runge-Kutta (RK4) and the Back and Forth Error 
Compensation and Correction method (BFECC).  

                                                            

1
 In the present work, the bins algorithm is used. 



BE with Sub-stepping  
 
This method is a refinement of the classical BE scheme. Let us assume that the 

velocity field is known at time nt and 1nt . Using the BE scheme, the position of a 

generic tracer  11   nn tXX  is computed as: 

  
  











 


ttt

tt

nnnn

t

t
nnn

n

n

  

d 

11

11

1

VXXVX

XVXX
 (3.4) 

where the size of the time-step interval is nn ttt  1 .  
If a sub-stepping technique is added, then the method transforms into:  













 




k

t
t

t

i

k

i

ii
nnn




1

11 VXX
 (3.5) 

where t  is split into k sub-steps. The velocity field, in 1v , corresponding to the generic 
sub-step i  is obtained as: 

   




















1
1

11

    

 1

nn
nn

n
t

ntnt
i
n

ttt
tt

tt
t



 vvv
  (3.6) 

The velocity of the tracer, in 1V ,  is computed in two steps: firstly,  its position 









 




k

i

i
n

i
n tt

1
1 XX  is updated according to the results obtained in the previous sub-

steps; secondly, the velocity of the tracer is interpolated from the velocity field 
computed at the mesh nodes of the work-piece (see Figure 2). 

 
 

 
 
 
 
 

Figure 2: Position of the tracer at each sub-step 
 
Remark: The BES method is first order accurate  tO  , even if a large number of 

sub-steps is considered. 
 
3.1. BFECC method 
 
The BFECC method is a well-known technique mostly used for weather forecast. It 

was first proposed in [15] with the aim of reducing mass loss in level set methods (see 
[16], [17]). 

Denoting with  A  the first order up-winding integration operator defined by 
equation (3.2), BFECC consists of a prediction/correction procedure: the initial position 

of the tracer,  nn tXX  , is advected forward to  nn A XX 1ˆ , and then backward to 



 1ˆˆ  nRn A XX , being  RA  the backward advection operator. The difference between 
nX̂  and the initial position defines the error, e , of the time integration scheme: 

 nn XX ˆ
2
1

e   (3.7) 

This error is used later to correct the staring position, e nn XX , for the next 

advection step, achieving the final solution,  nn A XX 1 .  
The steps of the BFECC method can be written as follows (see Figure 3): 

 
 

 
 
























nn

nnn

n
R

n

nn

A

A

A

XX

XXX

XX

XX

1

1

1

2ˆ3

ˆˆ

ˆ 

 (3.8) 

Remark 1: The BFECC method is 3-rd order accurate, meaning that the error per step 
is  4tO  , while the total accumulated error is  3tO   

Remark 2: Operator  XA  involves the computation of the velocity field of the tracer 
in its current position, so that it is necessary to interpolate it from the nodal values of the 
FE mesh at each step of the algorithm. 

 
Figure 3: The steps of the BFECC method for a rotational velocity field 

 
3.2. RK4 method 
 
A very powerful class of integration methods belongs to the Runge-Kutta multi-step 

family. Using the 4-th order Runge-Kutta method, the approximation of the 
function   11   nnt XX , is determined by the present value   nnt XX   plus the weighted 
average of four incremental displacements computed as the product of the size of the 
interval, t , and an estimated velocity,   tt ,XV , defined by the right-hand side of the 
differential equation (3.1). More specifically: 

     ttnn   1 ,XVX  is the incremental displacement based on the velocity at the 
beginning of the interval, using nX , (Euler's method) ; 



     t
t

tnn 





   

22

1 12 ,XXVX  is the incremental displacement based on the 

velocity at the midpoint of the interval, using  1
2

1
XX n ; 

   t
t

tk nn 





   

22

1
2

3 ,XVX  is again the incremental displacement based on 

the velocity at the midpoint, but now using  2
2

1
XX n ; 

     tttk nn   34 ,XVX  is the incremental displacement based on the 
velocity at the end of the interval, using  3XX n . 

The four increments chosen are weighted according to the classical Simpson's 
integration rule and the result is:  

        43211 22
6

1
XXXX  nn XX  (3.9) 

Remark 1: The RK4 method is a 4-th order method, meaning that the error per step is 
 5tO  , while the total accumulated error is  4tO  . 
Remark 2: The RK4 method achieves exact integration of a circular trajectory; this is 

the most common material path in FSW. 
 
 
 



 
4. Numerical simulations  
 
The examples of this section are chosen in order to demonstrate:  
 The performance of the integration techniques described in the previous section, 

in application to the particle trajectories simulation.  
 The suitability of the proposed method for the visualization of material flow 

around the threaded pin comparing a 2D case with experimental data and extending the 
work to a 3D case. 

 
4.1.  Particle tracing for Zalesak’s Disk 
 
This example deals with the two-dimensional problem of a rigid body rotation and  

aims at comparing the particle tracing method using different time schemes such as 
RK4, BFECC, BES and BE. The two-dimensional Zalesak’s Problem [19] can be 
described as follows. The integration domain is a circular area with center at  50,50  
and radius of 50. Within this area the velocity is prescribed as a rotational field with 
constant angular velocity. A cutout circular disk centered at  75,50  with radius 15 is 
defined as a set of particles immersed in the prescribed velocity field. The slot being cut 
out has a width of 5 and length of 25. The rotational velocity field is prescribed as 

     





 





 50

314
,50

314
, xyvu . Every point of the cutout circle is transported by 

the local velocity field where the rotation takes place.  
The time step and rotational speed are chosen such that 628 time steps complete one 

revolution of the disk. 
The FE mesh used to define the velocity field of the integration domain as well as the 

set of particle forming the disk is shown in Figure 4. The whole model is discretized 
with a mesh of approximately 18000 triangular elements, 10000 points and 700 
particles. In the first trial, the problem is solved with n = 314 time steps and 2t .  

The results of different integration methods (RK4, BFECC and BES for 10 sub-
steps) are shown after first revolution in Figure 5, together with the original position. It 
can be clearly seen that after the first revolution, the cutout disk returns to the original 
position with an imperceptible error for all three integration methods. Nevertheless, the 
difference becomes more visible after several revolutions. Figure 6 shows the disk 
position after completing 10 revolutions. The resulting error using RK4 and BFECC 
methods is still negligible. However, RK4 shows a slightly better result. The resulting 
error using BE and BES is considerable. The BE results to be unacceptable (huge 
computational error) as the particles expand and stick to the domain boundary. 

In the second trial, the problem is computed with a larger time step, performing 10 
revolutions. The number of time steps is n = 628, using the time interval 10t . The 
results are illustrated in Figure 7. The results are ranked, according to computational 
error, as RK4, BFECC, BES and BE. Note that with a larger time step, RK4 maintains 
an adequate accuracy of the results, while BFECC becomes inaccurate for the large time 
steps. The BE methods fail for this value of time step. 



 
Figure 4: Background mesh 

 

 
a) RK4 

 
b) BFECC 

 
c) BES 

Figure 5: First revolution of the cutout disk 
 



 
a) RK4 

 
b) BFECC 

 
c) BES 

 
d) BE 

Figure 6: 10 revolutions of the cutout disk with time-step= 2 s 
 

 
a) RK4 

 
b) BFECC 

 
c) BES  

d) BE 
Figure 7: 10 revolutions of the cutout disk with time-step= 10 s 

 



4.2. FSW simulation 
 
The objectives of this section are, on one side, to validate the work comparing the 

numerical results with the experimental data, and, on the other side, to study the 
material mixing during the FSW process.   

The modeling and simulations are based on the experimental work by Reynolds et al. 
[20].  The friction stir welds investigated in this work consist of welded plates 1.8 mm 
thick. A tool consisting of a threaded pin with 9.9 mm of diameter and a shoulder with 
25.4 mm of diameter was used. In the experiment, the markers used were thin sheets of 
5454 Al. They were inserted in AA2195-T8 Al plates at various depths on both the 
advancing and retreating sides of the weld. Process parameters were: welding speed Vs 
= 5.0833 mm/s and rotational speed Vr = 500 rpm. After welding was completed, the 
work-piece was thinned by mechanical milling in steps, and after each step, the work-
piece was polished revealing the position of the 5454 Al marker material. After 
processing of welded cross-sections, an interface between the two sides of the weld was 
apparent. The marker positions were digitized and combined into three-dimensional 
maps indicating the flow. 

 
4.2.1. FSW 2D simulation 
 
In order to show the ability of the proposed procedure for the visualization of 

material flow around the pin, a 2D-case of the simplified FSW simulation is considered. 
The model is a transversal cut of the pin, with 10 mm of diameter, perpendicular to the 
rotation axis. The cut represents the mid-section of the real threaded pin. The contact 
condition between the pin and the work-piece is considered to be full stick. Process 
parameters are the same as in the experiment: welding speed Vs = 5.0833 mm/s and 
rotational speed Vr = 500 rpm. A Sheppard-Wright constitutive model is used. The 
model and the parameters are summarized in the Table 1. 

A set of 5500 particles in a shape of a 2×60 mm rectangle at their initial position is 
located right in front of the pin. The whole model is discretized with a mesh of 4986 
triangular elements. The problem is solved using the u/p mixed formulation stabilized 
by the OSS stabilization method [13, 14]. RK4 time integration method is applied for 
the solution of the particle tracing problem. 

Figure 8 shows the final position of the particles compared with the experimental 
results at the mid-section of the pin taken from Reynolds [20] (AS and RS stand for 
advancing side and retreating side, respectively). The flow pattern is visualized after 4 s, 
the time that the particles spend to cross the pin. The pin rotation produces heat by 
viscoplastic deformation in the work-piece, decreasing the flow stress of the material. 
Consequently, the material in the weld zone flows. The material is moved to a final 
position behind its original position; only small amount of material on the advancing 
side is shifted to a final position in front of its original position.  

The results show that the numerical particle tracing reveals characteristic patterns of 
material flow in FSW. The non-symmetric flow pattern about the weld center-line is 
correctly predicted. The flow patterns on the advancing and retreating sides are 
different. On the advancing side, a flow pattern with a sawing shape is obtained, which 
correlates well with the experimental data.  

The center-line of the particles is coincident with the weld center-line. The alignment 
of the particle center-line is more obvious when various sets of particles are located at 
the initial position (Figure 9). From the colored particle simulation, it can be noted that: 
(a) the joint is created straightly at the center line, (b) no material mixing is observed 



using a circular pin, and, (c) the material moves from the retreating side to the 
advancing side, leaving a discontinuous line at the advancing side. The particle 
discontinuity is located at a line parallel to the weld line.  

 



































RT

Q
Z

A

Z n

eff exp
3

2
  ;

6

sinh
1

1

1

e
e





  

  Material constant 5.2E-08 (m2/N) 
A  Material constant 2.24E+12 
n  Material constant 4.54 
R   Universal gas constant 8.314 (J/K mol) 
Q  Activation energy 177876 (J/mol) 

Table 1: Sheppard-Wright constitutive model (AA2195-T8). 
 

 
Figure 8: Material flow visualization, current model (left) experiment (right) 

 

 
Figure 9: material mixing visualization 

 

4.3. FSW 3D simulation with a threaded pin 
 
Although the 2D simulation agrees well with the experimental results, it does not 

capture the fully detailed characteristics of the FSW process. To achieve this, a detailed 
3D simulation, including the complete tool geometry with shoulder and pin, and pin 
features such as threads, is considered. 



Therefore, the objectives of this simulation are to investigate: (a) the effect of non-
axisymmetric pins, particularly, threaded ones, on the material flow behavior, and (b) 
the effect of the shoulder on the material flow pattern.  

To this end, a set of structured material particles in the shape of a rectangular parallel 
pipe (Figure 1) is traced within the flow. The particles are shown in various colors in 
order to visualize whether material mixing takes place or not. It also facilitates the 
visualization of the material particles in different layers in the thickness direction.  

The FSW model includes a plate with length, width and thickness of 120 mm, 80 
mm and 10 mm, respectively, and a threaded pin shown in Figure 10a. The maximum 
pin diameter and its length are 10 mm and 9 mm, respectively. The pin has rectangular 
threads with 1.5 mm pitch. Full stick contact conditions between the pin and the work-
piece and between the shoulder and the work-piece are considered. The applied inflow 
velocity is 5.0833 mm/s. The rotational velocity is 500 rpm. It is prescribed as a 
constant tangential velocity over the pin volume. The initial and environmental 
temperatures are 25ºC. 

The work-piece material is AA2195-T8 with the constitutive model and material 
properties summarized in Table 1. The pin is made of steel with thermo rigid material 
properties [13, 14].  

The geometry is discretized with a mesh consisting of approximately 80000 linear 
tetrahedral elements and 82000 nodal points plus 80000 material particles (Figure 11). 
The mesh density is enhanced around the pin to capture accurately the temperature 
gradient and strain rate concentration occurring in that zone. Figure 10b shows a 
magnified view of the mesh discretization on the pin. The problem is solved using the 
u/p mixed formulation stabilized by the OSS stabilization method [13, 14]. RK4 time 
integration method is applied for particle tracing. 

Figure 12 shows the position of the particles in a millimetric grid background at three 
(top, middle and bottom) levels of the pin. They are compared to the experimental 
results taken from Reynolds [20]. The results show that the numerical particle tracing 
reveals characteristic patterns of the material flow in FSW very accurately. 
Qualitatively, the flow pattern correlates remarkably well with the experimental data. 
The non-symmetric flow pattern is correctly predicted. The 3D nature of the flow is 
demonstrated and simulated with enhanced precision.  

Some snapshots of the evolution of the particles movement around the pin at 
different times are illustrated in Figure 13. Material points initially located in straight 
lines pass along the tool. Since the shoulder rotates with higher linear velocity than the 
pin (the radius of the tool shoulder is larger than the radius of the pin), additional 
friction heat is generated at the top surface. The higher temperature near the top surface 
makes the material soften to a higher extent. The softened material, together with the 
advancing inflow, is transported along with the rotating pin from the retreating side to 
the advancing side. A small amount of the material moves even backwards on the 
advancing side of the tool center where the flow pattern breaks up. This can be 
explained by the fact that on the advancing side, the rotational and the advancing 
velocity fields of the flow have opposite directions while they have the same direction 
on the retreating side. Therefore, material particles on the advancing side spend a longer 
time rotating with the pin than on the retreating side.  

It can be observed that the radius of curvature of the material flow patterns increases 
as the material layer is closer to the top surface. The movement of the particles is 
centrifugal along the thickness direction as they pass through the conical region 
surrounding the rotating pin tool. This is justified by the full stick contact condition 
between pin shoulder and work-piece. Because of this, the velocity field mimics the 



conical shape. Figure 14 illustrates two vertical cuts across the thickness with velocity 
contour lines. The larger is the pin diameter, the greater is the velocity and displacement 
of the material in the weld region. 

Figure 13 shows that the extent of mixing of the particles of different colors is minor. 
This indicates that very limited material mixing occurs. The flow pattern shows that the 
material mixing happens only at the top of the weld, where the material transport is 
directly affected by the rotating tool shoulder. Moreover, the interface between the 
advancing and retreating sides behind the pin is not necessarily maintained at the 
centerline. For instance, wherever the influence of the rotating shoulder is significant, 
several particles cross the center-line and material mixing occurs. 

During the FSW process, several particles undergo more than one full revolution 
around the rotating pin. Because of the threaded shape of the tool, a considerable 
amount of material is shifted from the retreating side to the advancing side causing 
stirring in the thickness direction. In addition, the forging action combined with the 
stirring action of the welding tool at the top surface produces a secondary, down-and-up 
motion of material under the tool. The material in direct contact with the pin is driven 
downwards due to a combined action of the pin thread and rotation of the pin. Since the 
material flow in the FSW is a constant volume process, the flow path is constrained. 
Thus, the material transported to the bottom zone is obliged to move upwards at a 
certain distance from the pin surface after filling out the potential cavity at the bottom. 
This way the constant volume constraint is enforced. Figure 15 shows a schematic 
illustration of the flow of plasticized material adjacent to the threaded pin during FSW. 

The z-displacement (vertical) contour field at time 6 s (Figure 16) shows the particles 
movement in the thickness direction. Due to the high rotational velocity applied to the 
pin, the values of z-displacement are small in comparison with the displacements in the 
other directions. The particles located at the bottom of the pin move upwards, 
contrariwise to the majority, moving downwards. Figure 17 illustrates the z-
displacement evolution of two points located at the bottom and mid-height of the pin. 
Their initial coordinates are (0.0159, -0.0041, -0.0034) and (0.0135, -0.0101, -0.0093), 
respectively.  Note that the particle located at the bottom of the pin moves upwards, 
following the pin movement. However, the particle in the mid-height moves downwards 
and, after several revolutions, remains at its new location.  

These results reveal the 3D nature of the material flow, in close agreement with the 
experimental evidence. They prove that numerical particle tracing is a robust tool useful 
to gain insight into FSW processes. 

 
 
Figure 10: a) Schematic description of the pin geometry; b) Mesh discretization on the pin 



 
Figure 11: Mesh discretization 

 

 
Figure 12: Material pattern at middle, top and bottom level (left to right) 

 

a)t=0 s b)t=1 s 



c)t=2 s d)t=3 s 

c)t=4 s c)t=5 s 
Figure 13: Snapshots of particles movement around the threaded pin 

 
Figure 14: Velocity contour lines on the thickness taken from two vertical cuts 

 

Figure 15: Schematic illustration of the flow of plasticized material adjacent to the 
threaded pin during FSW using a right-hand threaded pin tool rotating anti-clockwise. 

 



 
Figure 16: Z-displacement contour field 

 
Figure 17: Z-displacement of 2 particles located at bottom and mid-height of the pin 
 

5. Conclusion  
 
In this work, a numerical procedure for the visualization of material flow during the 

FSW process is presented. A particle tracing technique is applied to track particle 
trajectories. This is done at the post process level, once the velocity field is obtained. 
Several integration methods including RK4, BFECC and BES methods are introduced 
for the problem of interest and compared. Applied to the well-known Zalesak’s disk 
test, it is found that, for large time steps, RK4 is rather accurate while all the other 
methods fail.  

The proposed method is validated comparing the results of a 2D FSW model to 
experimental data. The 2D simulation shows that the material flow is not symmetric 
about the joint line. The flow patterns on the advancing and retreating sides are 
different. The joint is created straightly at the center line and no material mixing is 
observed. These results are found to be in agreement with experimental data. 

The particle tracing method is also applied to a 3D simulation including the complete 
tool geometry and threaded pin. The 3D simulation shows some distinctive 3D features 
of the flow. For instance, the material flow around the pin has a centrifugal shape across 
the thickness. The material stirred on the advancing side performs more than one 



revolution around the tool. The up and down movement of the material in the thickness 
direction is observed.  

In both 2D and 3D simulations, agreement with experimental evidence is remarkably 
good, showing that particle tracing is a useful tool to gain insight of the FSW process.  

 
Acknowledgment  
 
This work was supported by the European Research Council under the Advanced 

Grant: ERC-2009-AdG ‘‘Real Time Computational Mechanics Techniques for Multi-
Fluid Problems ’’. The authors are also thankful for the financial support of the Spanish 
Ministerio de Educación y Ciencia (PROFIT programme) within the project CIT-
020400–2007-82. 

 
References 
 
[1] W.M. Thomas, E.D. Nicholas, J.C. Needham, M.G. Murch, P. Temple-Smith and 

C.J. Dawes. Friction -stir butt welding. GB Patent No. 9125978.8, International Patent 
No. PCT/GB92/02203, 1991.  

[2] R.S. Mishra and Z.Y. Ma, Friction stir welding and processing,  Materials 
Science and Engineering R 50 (2005) 1-78. 

[3] B. London, M. Mahoney, B. Bingel, R. Calabrese, D. Waldron, Experimental 
methods for determining material flow in friction stir welds, The third International 
symposium on Friction Stir Welding, Kobe, Japan, 27-28 September, 2001.  

[4] A.P Reynolds, Flow visualization and simulation in FSW, Scripta Materialia, 58 
(2008), 338-342.  

[5] T. U. Seidel and A.P. Reynolds, Visualization of the material flow in AA2195 
Friction Stir Welds using a marker insert technique, Metallurgical and Materials 
Transaction A32 (2001) 2879-2884.  

[6] K. Colligan, Material Flow Behaviour during Friction Stir Welding of 
Aluminium, Welding Journal 78 (1999) 229-237. 

[7] M. Guerra, C. Schmids, J.C. McClure, L.E. Murr and A.C. Nunes, Flow patterns 
during friction stir welding", Material Characterization 49 (2003) 95-101. 

[8] T. Dickerson, H.R. Shercliff, H. Schmidt, A weld marker technique for flow 
visualization in friction stir welding, 4th International Symposium on Friction Stir 
Welding, Park City, Utah, USA, 14-16 May 2003. 

[9] T. Kallgren, L.-Z. Jin, R Sandstrom, Material Flow during Friction Stir Welding 
of Copper 7th international Friction Stir Welding symposium, Awaji island, Japan, 20-
22 May 2008.  

[10] R. Johanson, P. Threadgill, Friction Stir Welding of Magnesium alloys, 
Magnesium Technology 2003, TMS, 2003. 

[11] J. Ouyang, E. Yarrapareddy, R. Kovacevic, Microstructural evolution in the 
friction stir welded 6061 aluminum alloy (T6-temper condition) to copper, Journal of 
Materials Processing Technology, 172 (2006) 110-122. 

[12] A. Abdollah-Zadeh, T. Saeid, B. Sazgari, Microstructural and mechanical 
properties of friction stir welded aluminum/copper lap joints, Journal of alloys and 
Compounds, 460 (2008) 535-538.  

[13] M. Chiumenti, M. Cervera, C. Agelet de Saracibar and N. Dialami, Numerical 
Modeling of Friction Stir Welding Processes, Computer Methods in Applied Mechanics 
and Engineering 254 (2013) 353-369. DOI: http://dx.doi.org/10.1016/j.cma.2012.09.013  



[14] N. Dialami, M. Chiumenti, M. Cervera and C. Agelet de Saracibar, Computers 
and structures 117, (2013) 48-57. http://dx.doi.org/10.1016/j.compstruc.2012.12.006 

[15] T. Dupont and Y.-J. Liu. Back and forth error compensation and correction 
methods for removing errors induced by uneven gradients of the level set function. J. 
Comput. Phys., 183 (2002) 83-116. 

[16] S. Osher and R. Fedkiw. Level Set Methods and Dynamic Implicit Surfaces. 
Springer-Verlag, New York, NY, 2002.  

[17] S. Osher and J. Sethian. Fronts propagating with curvature-dependent 
speed:Algorithms based on Hamilton-Jacobi formulations. J. Comput. Phys., 79 
(1988)12-49. 

[18] J. Donea and A. Huerta, Finite element method for flow problems. J. wiley 
edition, 2003. 

[19] S. T. Zalesak, Fully multidimensional flux-corrected transport, J. Comput. 
Phys., 31 (1979) 335-362.  

[20] A.P. Reynolds, Visualisation of material flow in autogenous friction stir welds, 
Science and technology of welding & joining. 5(2) (2000) 120-124.  

[21] C. Agelet de Saracibar, M. Cervera, M. Chiumenti, On the formulation of 
coupled thermoplastic problems with phase-change, Int. J. Plasticity 15 (1999) 1–34. 

[22]  M. Cervera, C. Agelet de Saracibar, M. Chiumenti, Thermo-mechanical 
analysis of industrial solidification processes, Int. J. Numer. Methods Engrg. 46 (1999) 
1575–1591 

[23] F. Brezzi, M. Fortin, Mixed and Hybrid Finite Element Methods, Springer, New 
York, 1991.  

[24] C. Agelet de Saracibar, M. Chiumenti, Q. Valverde, M. Cervera, On the 
orthogonal subgrid scale pressure stabilization of finite deformation J2 plasticity, 
Comput. Methods Appl. Mech. Engrg. 195 (2006) 1224–1251. 

[25] M. Cervera, M. Chiumenti, Q. Valverde, C. Agelet de Saracibar, Mixed 
linear/linear simplicial elements for incompressible elasticity and plasticity, Comput. 
Methods Appl. Mech. Engrg. 192 (2003) 5249–5263. 

[26] M. Chiumenti, Q. Valverde, C. Agelet de Saracibar, M. Cervera, A stabilized 
formulation for incompressible plasticity using linear triangles and tetrahedra, Int. J. 
Plasticity 20 (2004) 1487–1504. 

 




