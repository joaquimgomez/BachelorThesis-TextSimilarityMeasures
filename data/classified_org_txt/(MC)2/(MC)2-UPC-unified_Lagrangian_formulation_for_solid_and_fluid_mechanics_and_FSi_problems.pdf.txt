












































Unified Lagrangian formulation for solid and fluid
mechanics and FSI problems

∗Alessandro Franci1,2, Eugenio Oñate1,2, Josep Maria Carbonell1,2
1 International Center for Numerical Methods in Engineering (CIMNE)

Building C1, Campus North, UPC, Calle Gran Capitan s/n, 08034 Barcelona,
Spain

2 Universitat Politècnica de Catalunya (UPC), 08034 Barcelona, Spain

∗falessandro@cimne.upc.edu

Abstract

We present a Lagrangian monolithic strategy for solving fluid-structure interac-

tion (FSI) problems. The formulation is called Unified because fluids and solids

are solved using the same solution scheme and unknown variables. The method

is based on a mixed velocity-pressure formulation. Each time step increment is

solved via an iterative partitioned two-step procedure. The Particle Finite Ele-

ment Method (PFEM) is used for solving the fluid parts of the domain, while for

the solid ones the Finite Element Method (FEM) is employed. Both velocity

and pressure fields are interpolated using linear shape functions. For quasi-

incompressible materials, the solution scheme is stabilized via the Finite Calcu-

lus (FIC) method. The stabilized elements for quasi-incompressible hypoelastic

solids and Newtonian fluids are called VPS/S-element and VPS/F-element, re-

spectively. Other two non-stabilized elements are derived for hypoelastic solids.

One is based on a Velocity formulation (V-element) and the other on a mixed

Velocity-Pressure scheme (VP-element). The algorithms for coupling the solid

elements with the VPS/F fluid element are explained in detail. The Unified

formulation is validated by solving benchmark FSI problems and by comparing

the numerical solution to the ones published in the literature.

Keywords: Unified formulation, FSI, PFEM, Lagrangian formulation,

quasi-incompressible materials

Preprint submitted to Elsevier October 2, 2015



2



1. Introduction

The aim of this work is to derive a finite element formulation capable of

solving the mechanics of a general continuum through a unique set of equations

and unkown variables. The term ’general continuum’ refers to a domain that

may include compressible or quasi-incompressible solids and free surface fluids

interacting together. For this reason, the formulation is termed Unified .

There are many reasons for undertaking the above objective. First of all,

the Unified formulation allows us to solve fluids and solids by implementing and

using a single solver. Furthermore, the unified solution scheme makes simpler

the coupling for solving fluid-structure interaction (FSI) problems. This is be-

cause solids and fluids are analyzed as regions of the same continuum that differ

only in the specific values of the material parameters. As a consequence, it is

not required neither changing the variables, neither implementing the transfer

of transmission conditions through the interface, as for other FSI algorithm.

Additionally, the Unified formulation leads to a monolithic solution scheme for

FSI problems. This gives the further advantages that the coupling is ensured

strongly and an iteration loop is not required, differently from staggered pro-

cedures. Finally, the use of the same set of unknowns for the fluid and the

solid domains improves the conditioning of the FSI solver, because the solution

system does not include variables of different units of measure.

This formulation represents an extension of the coupling strategy for FSI

problems presented by Idelsohn et al. [1]. The proposed Unified scheme allows us

to couple a Velocity-Pressure Stabilized formulation for Fluids (VPS/F-element)

with three different types of hypoelastic elements, namely the V, the VP and

the VPS/S elements, corresponding to a Velocity, a Velocity-Pressure and a

Velocity-Pressure Stabilized formulation, respectively. The governing equations

are solved using an updated Lagrangian (UL) description. Each time step in-

crement is solved via a two-step Gauss-Seidel partitioned iterative procedure.

First, the momentum equations are solved for the velocity increments. Then,

for the mixed elements, the continuity equation is solved for the pressure in the

3



updated configuration using the velocities computed at the first step.

The same linear interpolation is used for the velocity and the pressure fields.

It is well known that, for incompressible (or quasi-incompressible) problems,

this combination does not fulfill the inf − sup condition [2] and a stabilization

method is required. In this work the Finite Calculus (FIC) stabilization pro-

cedure [3, 4, 5, 6, 7, 8] is used. The FIC approach in mechanics is based on

expressing the equations of balance of mass and momentum in a space-time

domain of finite size. In addition to the standard terms of infinitesimal theory,

the FIC form of the balance equations contains derivatives of the classical dif-

ferential equations in mechanics multiplied by characteristic distances in space

and time. In this work, the FIC stabilization procedure derived and validated in

[9] for quasi-incompressible Newtonian fluids, has been used. In particular, the

VPS/F-element has been implemented following precisely the scheme presented

in [9].

Even though hypoelastic models are not free of drawbacks, above all when

the elastic strains are large [10], hypoelasticity has been chosen for modeling

the constitutive behavior of the solid elements presented in this work. This is

because, thanks to its several analogies with the quasi-incompressible Newto-

nian model, hypoelasticity is the most adequate model for understanding the

Unified formulation. However, the formulation does not preclude the use of

other constitutive models, such as hyperelasticity, and neither the extension to

hypoelasto-plasticity [11].

Introducing just small modifications, the same stabilization procedure is

used also by the VPS/S-element for the analysis of quasi-incompressible hypoe-

lastic solids. For solids far from the incompressible behavior, other two types

of hypoelastic elements are presented, namely the V and the VP elements. The

latter is based on the same scheme of the VPS/S-element, but the standard

non-stabilized form is used for the continuity equation. Instead, the V-element

is based on a pure velocity formulation. In this case, the stresses are computed

using the velocity only and the continuity equation is not solved.

The V-element has the advantage that it has a reduced computational cost

4



with respect to the mixed elements because of the smaller number of degrees

of freedom. Nevertheless, the VP-element guarantees a more accurate pres-

sure field because the pressure is an unknown of the problem and it is not

obtained from the velocity field after time integration and interpolation, as is

should be done for the V-element. Furthermore, contrary to the V-element, the

VP-element does not exhibit kinematic locking when materials with small com-

pressibility are analyzed (however for incompressible or quasi incompressible

materials the VPS-element must be used) [11].

The solid parts of the domain are solved using the Finite Element Method

(FEM) [12], while for the VPS/F fluid element the Particle Finite Element

Method (PFEM) [13] is used. The PFEM is a Lagrangian strategy that treats

the mesh nodes of the domain as particles which can freely move and even

separate from the rest of the fluid domain representing, for instance, the effect

of water drops. A mesh connects the nodes discretizing the domain where the

governing equations are solved using the FEM. The domain is continuously

remeshed using a procedure that efficiently combines the Delaunay tesselation

and the Alpha Shape Method [14]. These features make the PFEM the ideal

numerical procedure to model and simulate free surface flows. In the last years,

many scientific publications have shown the efficiency of the PFEM for solving

free surface flow problems, [15, 16, 17]. The PFEM can be also used for other

problems such as those involving thermal convection-diffusion [18, 19, 20], multi-

fluids [21, 22], granular materials [23], bed erosion [24], FSI [25, 26], excavation

[27] or industrial forming processes [28].

In the problems analyzed in this work, the solid undergoes large displace-

ments but it does not suffer from extremely large distortions. In these cases,

the remeshing of the solid is not necessary. In solids, in order to recover the

elemental informations as the stresses or the plastic deformations, the remesh-

ing must be associated to a transferring procedure from the elements of the old

mesh to the ones of the new mesh. This operation represents an additional com-

putational cost (that increases further the cost of the overall remeshing step)

and it may introduce interpolation errors in the scheme. For this reason, it is

5



preferable to avoid the remeshing whenever it is not necessary. However, if the

solid domains suffer from large distortions, the PFEM should be used also for

the solid in order to avoid the distortion of the Lagrangian mesh (as done in

[29]).

The FSI problem is solved with a monolithic scheme. This means that flu-

ids and solids are solved within the same linear system of algebraic equations.

Thanks to the many analogies in the analysis of fluids and solids, the imple-

mentation work for coupling the mechanics of fluids and solids is reduced to a

proper assembly of the global linear system and to the geometric detection of

the fluid-solid interface.

This text is organized as follows. In the next section, the governing equations

of a general continuum are introduced. Then the constitutive laws used in

this work for fluids and solids, namely the hypoelastic and quasi-incompressible

Newtonian models, are presented. Section 4 is devoted to the linearization of the

linear momentum equations. In the following section the continuity equation is

discretized. In Section 6 the FIC-stabilized form of the continuity equation is

given, first for Newtonian fluids and then for quasi-incompressible hypoelastic

solids. The solution scheme of the Unified formulation for solving FSI problems

is described for a generic time step in Section 7. The different expressions for

the VPS/F-element for fluids and the V, VP, VPS/S elements for solids are

detailed. The way to assemble the global linear system and to detect the fluid-

solid interface is then explained. In Section 9 some numerical examples are

given in order to validate the Unified formulation for FSI problems. Finally, the

conclusions of this work are given.

2. Governing equations

The governing equations for a general continuum (either a fluid or a solid) are

the linear momentum equations, with the corresponding boundary conditions,

and the continuity equation. These equations are coupled with the constitutive

relationships described in Section 3. In this work, the governing equations will

6



be written in the Updated Lagrangian (UL) formulation [30].

In order to avoid ambiguities, the variables and the matrices referred to fluids

will be indentified by subindex ’f ’, and those refered to solids by subindex ’s ’.

When both materials are involved, the subindex will be ’s,f ’.

For a general continuum, the local form of the linear momentum equations

using the UL description reads [9]

ρ(X, t)v̇(X, t)−
∂σ(X, t)

∂x
− b(X, t) = 0 in Ω× (0, T ) (1)

where ρ is the density of the material, v̇ is the time derivative of the velocities, σ

is the Cauchy stress tensor and b is the body force vector. The variables within

the brackets are the independent variables. In particular, X are the Lagrangian

or material coordinates vector, x the Eulerian or spatial coordinates vector and

t is the time. For simplicity, the independent variables will be not specified in

the following.

The linear momentum equations are completed by the standard conditions

at the Dirichlet (Γv) and Neumann (Γt) boundaries

vi − v
p
i = 0 on Γv (2)

σijnj − t
p
i = 0 on Γt (3)

where v
p
i and t

p
i , i = 1, ..., ns are the prescribed velocities and the prescribed

tractions, respectively.

The continuity equation is written in the form [31]

1

κf,s
ṗ = dv (4)

where κf,s is the bulk modulus for either the fluid or the solid, ṗ is the time

derivative of the pressure (defined positive in tension) and dv is the volumetric

strain rate which is defined as

dv = dii (5)

where d is the spatial strain rate tensor computed as a function of the velocities

as

dij =
1

2

(
∂vi
∂xj

+
∂vj
∂xi

)
(6)

7



In the following, summation of terms for repeated indices is assumed, unless

otherwise specified.

Note that, depending on the values of the material bulk modulus, the con-

tinuity equation in the form of Eq.(4) can be used for (standard) compressible,

quasi-incompressible and fully incompressible materials, indifferently. For ex-

ample, κ = ∞ yields dv = 0 and canonical form of the continuity equation for

incompressible materials is recovered.

For a general time interval [n t , n+1 t ] Eq.(4) is discretized as

1

κf,s

∆p

∆t
=

1

κf,s

n+1p− np
∆t

= n+1d
v

(7)

3. Constitutive laws

In this work, a hypoelastic constitutive law is used for solids, while for fluids

the quasi-incompressible Newtonian model is considered. In the Unified formu-

lation the constitutive relations for both fluids and solids are expressed in the

following form

σ5 = c5σ : d (8)

where σ5 is the Cauchy stress rate tensor, c5σ is the fourth-order tangent

moduli tensor and d is the deformation rate tensor.

In this section, the tangent moduli for the rate of the Cauchy stress c5σ

is given and the computation of the stresses is explained for both hypoelastic

solids and Newtonian fluids.

3.1. Hypoelasticity

A hypoelastic body is defined by a direct relation between the rate of stress

and the rate of strain [32]. In this work a Jaumann measure is used. It is

well known that this model can lead to non-physical stress oscillations in simple

shear problems with large deformations [33]. In these cases, a different hypoe-

lastic measure should be used, as for example the Green-Naghdi one [34], [35].

However, for the rest of problems, including the ones selected in this work, the

8



Jaumann model can be freely used without experiencing the described short-

comings.

Considering a isotropic body and using a Jaumann measure of stress, the

Cauchy stress rate tensor is computed as [36]

σ5 = cσJ : d (9)

where the Jaumann fourth-order tangent moduli cσJ is

cσJijkl = κsδijδkl+µs

(
δikδjl + δilδkj −

2

3
δijδkl

)
, cσJ = κsI⊗I+ 2µsI′ (10)

for a 2D problem, cσJ =



κs +

4
3
µs κs − 23µs 0

κs − 23µs κs +
4
3
µs 0

0 0 µs




where κs is the solid bulk modulus computed from the Lamé parameters, λs

and µs, as

κs = λs +
2

3
µs, (11)

I is the second-order identity tensor and I′ is a fouth-order tensor computed as

I′ = I−
1

3
I ⊗ I (12)

where I is the fouth-order symmetric identity tensor computed as Iijkl =
1
2

(δikδjl + δilδkj).

The material time derivative of the Cauchy stress rate is computed from the

Jaumann measure of the Cauchy stress rate tensor as

σ̇ = σ5J + Ω (13)

where Ω is a tensor that accounts for the rotations defined as

Ω = W · σ + σ ·W T (14)

where W is the spin tensor

Wij =
1

2

(
∂vi
∂xj
−
∂vj
∂xi

)
(15)

In this work, tensor Ω is computed at the end of each time step.

9



Discretizing in time Eq.(13) for the time step interval [n t , n+1 t ] and expand-

ing the Cauchy stress rate, yields

n+1σ − nσ
∆t

= cσJ : n+1d+ nΩ (16)

In Eq.(16), nΩ can be viewed as a correction of the Cauchy stress tensor nσ.

For this reason, the two tensors can be joined as

nσ̂ = nσ + nΩ∆t (17)

Replacing Eq.(17) in (16), yields

n+1σ − nσ̂
∆t

= cσJ : n+1d (18)

Note that, with the aim of reducing the non linearity of the problem, in

Eq.(16) tensor Ω is computed explicitely. Nevertheless, this is allowed only if

the solid undergoes small rotations during a time step increment. Otherwise, Ω

should be computed implicitly and updated at each non linear iteration. How-

ever, note that in FSI problems the time step increment cannot be excessively

large in order to avoid drawbacks as the excessive distortion of the fluid dis-

cretization or the penetration of fluid parts into the solid domain or through

the rigid walls. For these reasons, generally the rotations of the solid within a

time step are limited and the approximation of Eq.(16) can be accepted.

Substituting in Eq.(18) the expression for cσJ using Eq.(10), yields

n+1σ − nσ̂
∆t

= κs (I ⊗ I) : n+1d+ 2µsI′ : n+1d (19)

The first and the second terms of the right hand side of Eq.(19) represent the

increments in time of the pressure and the deviatoric part of the Cauchy stress

tensor, respectively. Thus, for hypoelastic solids the time variation of the pres-

sure can be computed in the same form as Eq.(7).

Thus, from Eqs.(19) and (7) one may compute the updated stresses using

the velocities only or both the pressure and the velocities, as follows

n+1σ = nσ̂ + ∆t (κsI ⊗ I + 2µsI′) : n+1d (20)

10



n+1σ = nσ̂ + ∆pI + 2∆tµsI
′ : n+1d (21)

Eqs.(20) and (21) will be used for computing the Cauchy stress tensor in the

Velocity (V) and mixed Velocity-Pressure (VP) formulations, respectively.

3.2. Quasi-incompressible Newtonian fluids

The standard form of the constitutive relation for a Newtonian fluid reads

σ = σ′ + pI = 2µfd
′ + pI (22)

where µf is the fluid viscosity.

For a time interval [n, n+ 1] Eq.(22) reads

n+1σ = 2µf
n+1d′ + n+1pI (23)

Quasi-incompressible fluids have a compressibility that is small enough to

neglect the variations of density on time. However, unlike fully incompress-

ible materials, they are not totally divergence-free and the volumetric strain

rate is related to time change of the pressure via Eq.(7). Hence, for quasi-

incompressible Newtonian fluids the pressure at n+1t can be computed as

n+1p = np+ ∆tκf
n+1dv (24)

Subsituting Eq.(24) into (23) yields

n+1σ = (2µfI
′ + ∆tκfI ⊗ I) : n+1d+ npI (25)

where I′ is the fourth-order tensor defined in Eq.(12).

For convenience, Eq.(25) is rewritten as

∆σ = n+1σ − nσ = cσNF : d (26)

where the following substitutions have been done

nσ = npI (27)

cσNF = 2µfI
′ + ∆tκfI ⊗ I (28)

11



The aim of the Unified formulation is to reduce the differences in the anal-

ysis of fluids and solids. For this reason, the quasi-incompressible Newtonian

constitutive law is written for the stress rate, similarly as for the hypoelastic

model for solids. For Newtonian fluids, the rate of Cauchy stress can be simply

computed with the material time derivative. Hence

σ5 = σ̇ =
∆σ

∆t
=
cσNF
∆t

: d = c
5σ
NF : d (29)

where the tangent moduli tensor for the rate of the Cauchy stress c
5σ
NF is

c
5σ
NF =

2µf
∆t

I′ + κfI ⊗ I (30)

Note that Eq.(29) has the same structure as Eq.(8).

For a 2D problem, c
5σ
NF =



κf +

4
3∆t

µf κf − 23∆tµf 0

κf − 23∆tµf κf +
4

3∆t
µf 0

0 0
µf
∆t




4. Linearization of the momentum equations

In the UL description used in this work, the governing equations are inte-

grated over the unknown configuration Ω (the so-called updated configuration)

and the space derivatives are computed with respect to the spatial coordinates.

From Eq.(1), integrating over Ω and after standard transformations, the

Galerkin approximation of the Principle of Virtual Power for a node I is obtained

as [36] ∫
Ω

NIρdΩ v̇i︸ ︷︷ ︸
f
dyn
Ii

+

∫
Ω

∂NI
∂xj

σijdΩ︸ ︷︷ ︸
f intIi

=

∫
Ω

NIbidΩ +

∫
Γt

NIt
p
i dΓ︸ ︷︷ ︸

fextIi

(31)

where NI is the linear shape function for node I and f
dyn, f int and fext are

the dynamic, internal and external force vectors, respectively, expressed in the

UL framework.

12



For this work we use linear 3-noded triangles (for 2D problems) and 4-noded

tetrahedra (for 3D problems) to interpolate the velocity and pressure variables,

as appropriate.

For convenience, the linearization of the internal forces f int is performed

in the known configuration Ω0, as for a total Lagrangian (TL) description.

This is because in the UL form also the spatial derivative and the integration

domain depend on the deformation, and hence on the time, and this complicates

the linearization. For this reason, the UL linearized form will be obtained

later by applying a push-forward transformations on the TL form. Instead,

the linearization of the dynamics forces fdyn will be performed directly in the

updated configuration.

4.1. Internal components of the tangent matrix

Applying a standard pull back tranformation to f int from the unknown

domain Ω to the known one Ω0 [36], the internal forces for a TL description

TLf int read

TLf intIi =

∫
Ω0

∂NI
∂Xj

PijdΩ0 (32)

where P is the first Piola-Kirchhoff stress tensor. All the variables with vec-

tors subscript (·)0 refer to the last known configuration. For the sake of clarity,

the terms referred to the TL description are denoted with the left upper index

TL(·). Unless otherwise specified, the variables belong to the UL description.

In the proposed Unified formulation, the constitutive relations for both fluids

and solids are expressed in rate form. Hence it is more convenient to perform the

linearization of the material derivative of the internal forces and then integrate

for the time step increment ∆t. The material time derivative of Eq.(32) is

TLḟ intIi =

∫
Ω0

∂NI
∂Xj

ṖijdΩ0 (33)

The first Piola-Kirchhoff stress tensor P is not typically used because it is not

symmetric and its rate is a non-objective measure. For these reasons, in the TL

framework it is more convenient to work with the second Piola-Kirchhoff stress

13



tensor S and its rate. These stress rate measures are related each other via the

following relation

Ṗij = ṠirF
T
rj + SirḞ

T
rj (34)

where F is the deformation gradient tensor defined as

Fij =
∂xi
∂Xj

(35)

Substituting Eq.(34) into (33), and analyzing an infinitesimal increment yields

TLδḟ intIi =

∫
Ω0

∂NI
∂Xj

FirδṠjrdΩ0︸ ︷︷ ︸
TLδḟmIi

+

∫
Ω0

∂NI
∂Xj

SirδḞ
T
rjdΩ0︸ ︷︷ ︸

TLδḟ
g
Ii

(36)

In Eq.(36) the increment of the material time derivative of the internal forces

has been split into the material and the geometric parts, TLδḟm and TLδḟg,

respectively. The former accounts for the material response through the rate of

the second Piola-Kirchhoff stress tensor. The second term is the initial stress

term that contains the information of the updated stress field.

4.1.1. Material tangent matrix

The rate of the second Piola-Kirchhoff stress tensor S is related to the de-

formation rate through the tangent constitutive tensor as

Ṡij = CijklĖkl (37)

where C is a fourth-order tensor and Ė is the rate of the Green-Lagrange strain

tensor.

Substituting Eq.(37) into the term TLδḟm of Eq.(36), yields

TLδḟmIi =

∫
Ω0

∂NI
∂Xj

FirCjrklδĖkldΩ0 (38)

The rate of the Green-Lagrange strain tensor can be expressed in terms of

the nodal velocities as

Ėkl =
∂NJ
∂Xl

Fskv̄Js (39)

In Eq.(39) and in the following, (̄·) denotes a nodal value (e.g. v̄Js is the s-

component of the velocity of node J ).

14



Substituting Eq.(39) in (38), yields

TLδḟmIi =

∫
Ω0

∂NI
∂Xj

FirCjrkl
∂NJ
∂Xl

FskdΩ0 δv̄Js (40)

In order to obtain the increment of the internal forces, the material time

derivative of the internal forces increment is integrated over a time step incre-

ment ∆t as

TLδfm = TLδḟm∆t (41)

From Eqs.(40) and (41), yields

TLδfmIi =

∫
Ω0

∂NI
∂Xj

Fir∆tCjrkl
∂NJ
∂Xl

FskdΩ0 δv̄Js (42)

The material tangent matrix for the UL framework is obtained by applying

a push-forward transformation on each term of Eq.(42) and integrating over the

updated domain Ω. The following relations hold

dΩ0 =
dΩ

J
(43)

∂NI
∂Xj

=
∂NI
∂xk

Fkj (44)

C
5σ
ijkl = F

−1
mi F

−1
nj F

−1
ok F

−1
pl c

5σ
mnopJ (45)

where c5σ is the tangent moduli for the rate of the Cauchy stress σ5.

Substituting Eqs.(43-45) into (42) and using the minor symmetries, yields

δfmIr =

∫
Ω

∂NI
∂xk

δri∆t c
5σ
kijl

∂NJ
∂xl

δsjdΩ δv̄Js (46)

Therefore, the expressions of the material tangent matrix for the velocity

increments in UL framework in the indicial and Voigt notation read, respectively

KmIJrs =

∫
Ω

∂NI
∂xk

δri∆t c
5σ
kijl

∂NJ
∂xl

δsjdΩ , K
m
IJ =

∫
Ωe
BTI ∆t

[
c5σ

]
BJdΩ (47)

For the node I of a 2D element, matrix B is

BI =



∂NI
∂x

0
∂NI
∂y

0
∂NI
∂y

∂NI
∂x



T

(48)

15



4.1.2. Geometric tangent matrix

The geometric tangent matrix in the UL framework is derived using the same

procedure as for the material component.

From Eq.(36)

TLδḟ
g
Ii =

∫
Ω0

∂NI
∂Xj

SirδḞ
T
rjdΩ0 (49)

where the rate of the deformation gradient Ḟ is defined as

Ḟij =
∂NJ
∂Xi

v̄Jj (50)

Substituting Eq.(50) into Eq.(49), the geometric components of the internal

power in the TL description can be written as

TLδḟ
g
Ii =

∫
Ω0

∂NI
∂Xj

Sir
∂NJ
∂Xr

dΩ0 δv̄Jj (51)

Integrating Eq.(51) in time for a time step increment ∆t yields

TLδf
g
Ii =

∫
Ω0

∂NI
∂Xj

∆tSir
∂NJ
∂Xr

dΩ δv̄Jj (52)

In order to recover the UL form, the Piola identity has to be recalled, i .e.

S = F−1σF−TJ (53)

Substituting Eqs.(43), (44) and (53) into (52) and using the symmetries, yields

δf
g
Ir =

∫
Ω

∂NI
∂xj

∆tσjk
∂NJ
∂xk

dΩδrsδv̄Js (54)

The geometric part of the tangent matrix for the increments of velocity is ob-

tained from Eq.(54) as

K
g
IJrs =

∫
Ω

∂NI
∂xj

∆tσjk
∂NJ
∂xk

dΩδrs , K
g
IJ = I

∫
Ω

βTI ∆tσβJdΩ (55)

where for 2D problems βI =

[
∂NI
∂x

∂NI
∂y

]T
.

4.2. Dynamic component of the tangent matrix

In this work, the implicit Newmark’s integration rule has been adopted. In

particular, the Newmark’s parameters chosen are β = 1
4

and γ = 1
2

[36]. Ac-

16



cording to this unconditionally stable scheme, the accelerations v̇ and the dis-

placements u are computed, respectively, as

n+1v̇ =
2

∆t

(
n+1v − nv

)
− nv̇ (56)

n+1u = nu+
∆t

2

(
n+1v + nv

)
(57)

Replacing Eq.(56) into the dynamic term f
dyn
Ii of Eq.(31), and differentiating

with respect to velocity increments, the dynamic component of the tangent

matrix (also known as the mass matrix) is obtained as

K
ρ
IJij = δij

∫
Ω

NI
2ρ

∆t
NJdΩ , K

ρ
IJ = I

∫
Ω

NI
2ρ

∆t
NJdΩ (58)

4.3. Incremental solution scheme

The linear momentum equations are solved iteratively for the velocity incre-

ments. For each iteration i the following linear system is solved

Ki∆v̄ = Ri (59)

with

Ki = Km(n+1x̄i, c5σ) +Kg(n+1x̄i,σi) +Kρ(n+1x̄i) (60)

whereKmIJ ,K
g
IJ andK

ρ
IJ are respectively given in Eq.(47), Eq.(55) and Eq.(58),

and

RiIi =

∫
Ω

NIρNJdΩ ¯̇v
i
Ji +

∫
Ω

∂NI
∂xj

σiijdΩ−
∫

Ω

NI
n+1bidΩ−

∫
Γt

NI
n+1t

p
i dΓ (61)

The fourth-order constitutive tangent moduli tensor c5σ of matrix Km

(Eq.(47)) is c
5σ
NF (Eq.(30)) for a Newtonian fluid while for a hypoelastic solid is

cσJ (Eq.(10)).

In the analysis of quasi-incompressible Newtonian fluids, the volumetric part

of the material component of the tangent matrix Km can compromise the con-

ditioning of the linear system [37, 38, 39]. In order to prevent the numerical

instabilities originated by the ill-conditioning of the tangent matrix, the actual

bulk modulus of the fluid κf is replaced by a reduced pseudo bulk modulus κp,

17



defined as a κp = θκf . The pseudo bulk modulus is predicted a priori using

the strategy described in [40]. In the mentioned publication it has been shown

that using the pseudo bulk modulus in the tangent matrix of the linear momen-

tum equations (in the continuity equation the actual bulk modulus is used) is

extremely helpful for improving the conditioning of the problem and it does not

alter the numerical results.

For Newtonian fluids the stress tensor σ is computed via Eq.(25). For hy-

poelastic solids, if a velocity formulation is used the stresses are computed via

Eq.(20). In the context of a mixed velocity-pressure formulation, the Cauchy

stress tensor σ is computed with Eq.(21).

5. Discretized form of the mass balance equation

For the solid VP-element the continuity equation is solved in the standard

non-stabilized form of Eq.(4). The Galerkin approximation of Eq.(4) for the

same linear shape functions N used for the velocity is∫
Ω

NI
1

κs
NJdΩ ˙̄pJ −

∫
Ω

NI
∂NJ
∂xi

dΩv̄iJ = 0 (62)

Regarding the time integration, a first order scheme has been adopted for

the pressure. Thus, for a time interval [n t , n+1 t ] of duration ∆t the first and

the second variations in time of the pressure are computed as

n+1ṗ =
n+1p− np

∆t
(63)

n+1p̈ =
n+1p− np

∆t2
−

nṗ

∆t
(64)

Introducing Eq.(63) in (62), the discretized form of the continuity equation

solved for the pressure is

1

∆t
M1

n+1p̄ =
1

∆t
M1

np̄+QT n+1v̄ (65)

where the matrices introduced in Eq.(65) are defined in Box 1.

18



M1IJ =

∫
Ωe
NI

1

κs
NJdΩ , QIJ =

∫
Ωe

BTI mNJdΩ with m = [1, 1, 0]
T

Box 1. Matrices and vectors of the continuity equation (Eq.(65)) for the

VP-element.

6. Stabilized FIC form of the mass balance equation

In order to deal with quasi and fully incompressible materials the numerical

scheme needs to be stabilized. This is because the interpolation orders of the

velocity and pressure fields do not fullfil the so-called LBB inf − sup condition

[2]. The required stabilization is introduced for both the VPS/F and the VPS/S

elements via the Finite Calculus (FIC) technique presented in [9]. In the men-

tioned work, a FIC stabilized finite element formulation for quasi-incompressible

Newtonian fluids is derived and validated for several free surface flow problems,

highlighting its excellent mass preservation features. The derivation of the sta-

bilization technique lies outside the objectives of this work and the details can

be found in [9]. Basically, the linear momentum equations do not change and

are counted, with both the second order FIC form in space and the first or-

der FIC form in time of the quasi-incompressible mass balance equation [7, 8],

for deriving the stabilized form of the mass balance equation in a consistent

manner.

For the VPS/F-element the same FIC form of the mass balance equation

derived in [9] can be used because both refer to Newtonian fluids. Hence, for

the VPS/F-element, the FIC-stabilized form of the mass balance equation, after

FEM discretization, reads∫
Ω

1

κf
NTN

Dp̄

Dt
dΩ +

∫
Ω

τfρ

κf
NTN

D2p̄

Dt2
dΩ−

∫
Ω

NTmTBv̄dΩ +

+

∫
Ω

τf (∇∇∇N)T∇∇∇Np̄dΩ +
∫

Γt

2τf
hn

NTNp̄dΓ− fp = 0 (66)

19



where for triangular elements

∇∇∇NT =



∇∇∇N1
∇∇∇N2
∇∇∇N3


with ∇∇∇ =



∂

∂x

∂

∂y


 and N = [N1,N2,N3]T (67)

and τ is the stabilization parameter given by

τf =

(
8µf
h2

+
2ρ

δ

)−1
(68)

where h and δ are characteristic distances in space and time, respectively. In

practice, h and δ have the same order of magnitude of the element size and the

time step increment, respectively. Details of the derivation of Eq.(66) can be

found in [9].

In order to use the same form of Eq.(66) [9] for quasi-incompressible hypoe-

lastic solids as for the VPS/F-element, the fluid parameters (the viscosity µf

and the bulk modulus κf ) are replaced by the equivalent parameters for the

solid. The similarity between the constitutive expression for Newtonian fluids

and hypoelastic solids is evident comparing expression used for computing the

Cauchy stress tensor increment for both cases.

For quasi-incompressible Newtonian fluids Eq.(26) holds and, for clarity pur-

poses, here is rewritten as

∆σf = 2µfI
′ : d+ ∆tκfI ⊗ I : d (69)

From Eqs.(19), the increment of the Cauchy stress for hypoelastic solids is

∆σs = 2∆tµsI
′ : d+ ∆tκsI ⊗ I : d (70)

Eqs.(69) and (70) show the duality between quasi-incompressible Newtonian

and hypoelastic constitutive laws. In the former the deviatoric and the volu-

metric parts of the Cauchy stress tensor are controled by the dynamic viscosity

µf and the bulk modulus κf , respectively. The equivalent roles in hypoelastic

solids are taken by the second Lamè parameter scaled by the time increment

(∆tµs) and the bulk modulus κs.

20



Thanks to this equivalence, the FIC-based stabilized mass continuity equa-

tion for the VPS/S hypoelastic element can be written (after FEM discretiza-

tion) as∫
Ω

1

κs
NTN

Dp̄

Dt
dΩ +

∫
Ω

τsρ

κs
NTN

D2p̄

Dt2
dΩ−

∫
Ω

NTmTBv̄dΩ +

+

∫
Ω

τs(∇∇∇N)T∇∇∇Np̄dΩ +
∫

Γt

2τs
hn

NTNp̄dΓ− fp = 0 (71)

where τs is the stabilization parameter given by

τs =

(
8∆tµs
h2

+
2ρ

δ

)−1
(72)

We highlight again the analogy between the discretized (stabilized) FIC-form

of the mass balance equation for fluids (Eq.(66)) and solids (Eq.71).

Eqs.(66) and (71) can be written in an unified matrix form for both fluids

and solids as

M1(f,s) ˙̄p+ M2(f,s) ¨̄p−QT v̄ + (L(f,s) + Mb(f,s))p̄− fp(f,s) = 0 (73)

The matrices and vectors in Eq.(73) for Newtonian fluids (VPS/F-element)

and hypoelastic solids (VPS/S-element) are given in Box 2 and 3, respectively.

M1fIJ =

∫
Ω

1

κf
NINJdΩ , M2fIJ =

∫
Ω

τf
ρ

κf
NINJdΩ

MbfIJ =

∫
Γt

2τf
hn

NINJdΓ , LfIJ =

∫
Ω

τf (∇∇∇TNI)∇∇∇NJdΩ

fpfI =

∫
Γt

τfNI

[
ρ
Dvn
Dt
−

2

hn
(2µfdn − tn)

]
dΓ−

∫
Ωe
τf∇∇∇TNIbdΩ

Box 2. Matrices and vectors of Eq.(73) for the VPS/F-element.

Introducing the time integration of the pressure (Eqs.(63) and (64)) into

Eq.(73) and solving the stabilized continuity equation for the nodal pressures,

yields

Hf,sp̄
i+1 = Fp(f,s)(v̄, p̄) (74)

where

Hf,s =

(
1

∆t
M1(f,s) +

1

∆t2
M2(f,s) + Lf,s + Mb(f,s)

)
(75)

21



M1sIJ =

∫
Ω

1

κs
NINJdΩ , M2sIJ =

∫
Ω

τs
ρ

κs
NINJdΩ

MbsIJ =

∫
Γt

2τs
hn

NINJdΓ , LsIJ =

∫
Ω

τs(∇∇∇TNI)∇∇∇NJdΩ

fpsI =

∫
Γt

τsNI

[
ρ
Dvn
Dt
−

2

hn
(2∆tµsdn − tn)

]
dΓ−

∫
Ωe
τs∇∇∇TNIbdΩ

Box 3. Matrices and vectors of Eq.(73) for the VPS/S-element.

and

Fp(f,s) =
M1(f,s)

∆t
np̄+

M2(f,s)

∆t2
(
np̄+ n¯̇p∆t

)
+ QT v̄ + fp(f,s) (76)

7. Solution scheme

Each time step is solved using a two-step Gauss-Seidel iterative procedure.

First the linear momentum equations are solved for the velocity increments

according to Eq.(59). Then the continuity equation is solved for the pressure

in the updated configuration. For the VPS/F-element the stabilized form of

Eq.(74) is solved using the matrices of Box 1. For quasi-incompressible solids,

the VPS/S-element is used, hence the continuity equation is solved using the

stabilized form of Eq.(74) and the matrices given in Box 2. Instead, for solids

far from the incompressible limit, both the V and the VP elements can be

used. With the VP-element, the non-stabilized form of the continuity equation

(Eq.(65)) is solved. On the contrary, if the V-element is used the continuity

equation is not computed. In Table 1, the essential features of each one of the

elements presented in this work are summarized.

Concerning the degrees of freedom, each node of the mesh is characterized

by a single set of kinematic variables. This means that the degrees of freedom

for the solid and fluid velocities coincide also at the interface nodes. On the

contrary, in order to guarantee the correct boundary conditions for the stresses,

each interface node has a degree of freedom for the pressure of the fluid and

another one for the pressure of the solid. This requires solving twice the con-

tinuity equation at the fluid-solid interface: once for the VPS/F-element and

22



Element

V VP VPS/S VPS/F

Constitutive Hypoelastic Hypoelastic Hypoelastic Newtonian

law solid solid solid fluid

Momentum
Eq.(59) Eq.(59) Eq.(59) Eq.(59)equations

c5σ cσJ , Eq.(10) cσJ , Eq.(10) cσJ , Eq.(10) c
5σ
NF , Eq.(30)

σ Eq.(20) Eq.(21) Eq.(21) Eq.(23)

Continuity
-

Eq.(65) Eq.(74) Eq.(74)

equation Box 1 Box 3 Box 2

Table 1: Essential features of the V, VP, VPS/S and VPS/F elements.

once for the VP or the VPS/S solid elements.

For the sake of clarity, the coupling algorithms for the V-element and the

mixed elements (the VP and VPS/S elements) are presented separately.

For a generic time interval [n t , n+1 t ], Algorithm 1 describes all the steps

required for solving the FSI problem using the VPS/F-element for fluids and

the V-element for solids.

23



For each iteration i :

1. Compute the nodal velocity increments ∆v̄s,f :

Kis,f∆v̄s,f = R
i
s,f (v̄

i
s,f , p̄

i
f )

where for fluids Kif = K
m(x̄i, c

5σ
NF ) +K

g(x̄i,σif ) +K
ρ(x̄i)

and for solids Kis = K
m(x̄i, cσJ) +Kg(x̄i,σis) +K

ρ(x̄i)

2. Update the nodal velocities: n+1v̄i+1s,f =
n+1v̄is,f + ∆v̄s,f

3. Update the nodal coordinates: n+1x̄i+1s,f =
n+1x̄is,f + ūs,f (∆v̄s,f )

4. Compute the fluid nodal pressures p̄i+1f : Hf p̄
i+1
f = Fpf (v̄

i+1
f , p̄

i
f )

where Hf =
(

1
∆t

M1f +
1

∆t2
M2f + Lf + Mbf

)
and Fpf =

M1f
∆t

np̄f +
M2f
∆t2

(
np̄f +

n¯̇pf∆t
)

+ QT v̄i+1f + fpf

5. Compute the updated stress measures

for fluids: σi+1f = 2µd
′
f (v̄

i+1
f ) + p

i+1
f I

for solids: σi+1s =
nσ̂s + ∆t σ

5,i+1
s with σ

5,i+1
s = c

σJ : ds
(
v̄i+1s

)
6. Check the convergence:

‖∆v̄i+1f,s ‖
‖nv̄s,f‖

≤ ev
‖p̄i+1f − p̄

i
f‖

‖np̄f‖
≤ ep

If condition 6 is not fulfilled, return to 1 with i ← i+ 1.

At the end of each time step, for solid elements compute

n+1σ̂s =
n+1σs + ∆tΩs (

n+1v̄s,
n+1σs)

Algorithm 1: Iterative solution scheme for FSI problem solved with the

V-element for solids and the VPS/F-element for fluids.

Algorithm 2 shows the procedure for solving the FSI problem using the VP-

element or the VPS/S-element for the solid and the VPS/F-element for the

fluid.

In Algorithms 1 and 2, ev and ep are prescribed error norms for the nodal

velocities and the nodal pressures, respectively. In the examples solved in this

work, ev = ep = 10
−4 has been fixed. The number of non linear iterations

depends on the problem and the time step increment. For the problems solved

in this publication, the average number of required iterations is around 5 for

both schemes.

24



As explained before, the nodes at a fluid-solid interface have two different

pressure degrees of freedom. As a consequence, the mass balance equations are

solved separately for the fluid and the solid. In particular, the mass balance

equation is solved twice at the interface nodes. All this increases the computa-

tional cost of the analysis with respect to the coupling with the V-element de-

scribed in Algorithm 1. On the other hand, this scheme is more general because

it allows us to solve FSI problems where incompressible solids are involved.

25



For each iteration i :

1. Compute the nodal velocity increments ∆v̄s,f :

Kis,f∆v̄s,f = R
i
s,f (v̄

i
s,f , p̄

i
s,f )

where for fluids: Kif = K
m(x̄i, c

5σ
NF ) +K

g(x̄i,σif ) +K
ρ(x̄i)

and for solids: Kis = K
m(x̄i, cσJ) +Kg(x̄i,σis) +K

ρ(x̄i)

2. Update the nodal velocities: n+1v̄i+1s,f =
n+1v̄is,f + ∆v̄s,f

3. Update the nodal coordinates: n+1x̄i+1s,f =
n+1x̄is,f + ūs,f (∆v̄s,f )

4. Compute the fluid nodal pressures p̄i+1f : Hf p̄
i+1
f = Fpf (v̄

i+1
f , p̄

i
f )

where: Hf =
(

1
∆t

M1f +
1

∆t2
M2f + Lf + Mbf

)
and Fpf =

M1f
∆t

np̄f +
M2f
∆t2

(
np̄f +

n¯̇pf∆t
)

+ QT v̄i+1f + fpf

5. Compute the solid nodal pressures p̄i+1s : Hsp̄
i+1
s = Fps(v̄

i+1
s , p̄

i
s)

For the VP-element: Hs =
1

∆t
M1s

and Fps = Q
T n+1v̄i+1s +

M1s
∆t

np̄s

For the VPS/S-element: Hs =
(

1
∆t

M1s +
1

∆t2
M2s + Ls + Mbs

)
and Fps =

M1s
∆t

np̄s +
M2s
∆t2

(
np̄s +

n¯̇ps∆t
)

+ QT v̄i+1s + fps

6. Compute the updated stress measures

for fluids: σi+1f = 2µd
′
f (v̄

i+1
f ) + p

i+1
f I

for solids: σi+1s =
nσ̂s + p̄

i+1
s I + 2µ∆t

[
I′ : ds

(
v̄i+1s

)]
7. Check the convergence:

‖∆v̄i+1f,s ‖
‖nv̄s,f‖

≤ ev
‖p̄i+1f,s − p̄

i
f,s‖

‖n ¯pf,s‖
≤ ep

If condition 7 is not fulfilled, return to 1 with i ← i+ 1.

At the end of each time step, for the solid elements

n+1σ̂s =
n+1σs + ∆tΩs (

n+1v̄s,
n+1σs)

Algorithm 2: Iterative solution scheme for FSI problem solved with the VP

or the VPS/S element for solids and the VPS/F-element for fluids.

26



8. Assembly of the global linear system and interface detection

The assembly of the global linear system is performed by looping over all

the nodes of the mesh. Each node provides the contributions of the elements

that share the node and each element is computed according to the specific

constitutive law and the solution scheme chosen. So, when an interface node

is analyzed, it is necessary to sum the contributions of both materials in the

global linear system. Because the fluid and the solid pressures are two different

degrees of freedom, the fluid elements assemble only the contributions for the

fluid pressure, while the solid elements do that for the solid pressure.

In order to ensure the coupling, the fluid and the solid meshes must have in

common the nodes along the interface. In other words, there must be a node to

node conformity. This is guaranteed by exploiting the capability of the PFEM

for detecting the boundaries [41]. The fluid detects the solid interface nodes in

the same way it recognizes its rigid contours. In fact, the solid keeps the same

discretization for all the duration of the analysis, but its boundary nodes are

involved in the fluid remeshing process. This is performed via a robust algorithm

[42] that combines efficiently the Alpha Shape method [14] and the Delaunay

triangulation. According to this strategy, if the separation of the fluid contour

from the solid domain is small enough so that that the Alpha Shape criteria

are fulfilled, a fluid element connecting the fluid domain to the solid domain is

generated. Otherwise the two domains keep apart from each other.

In Figure 1 a graphic representation of this technique.

9. Numerical examples

We present several examples for validating the Unified formulation. Three

FSI problems are presented and other numerical results are compared to the

numerical solutions. A comparison between the three solid elements (V, the VP

and the VPS/S elements) derived in this work is also given for all the problems

presented. In all the numerical examples, the effect of the air has not been

taken into account and the VPS/F-element has been used for the fluid part of

27



(a) Cloud of points (b) Delaunay triangulation (c) Alpha Shape Method

(d) Cloud of points (e) Delaunay triangulation (f) Alpha Shape Method

Figure 1: Detection of an interface with the PFEM [43].

the domain. The numerical examples involve large displacements of the solid

structures and free surface flows. These features increase the complexity of the

problems.

9.1. Falling of a cylinder in a viscous fluid

The problem is a two-dimensional (2D) abstraction of the displacement of a

circular solid cylinder between two parallel walls. The cylinder moves prepen-

dicularly to its axis due to the gravity force increasing the falling velocity until

an asymptotic value.

The distance from the rigid walls and the axis of the cylinder is l = 0.02m.

The radius of the circle is a = 0.0025m. The geometry of the problem and the

material data are given in Figure 2 and Table 2.

28



2l

g

2a

C           A

B

Figure 2: Falling of a cylinder in a vis-

cous fluid. Initial geometry.

Geometric data

l 0.02 m

a 0.0025 m

g 9.81 m/s2

Fluid data

Density 1.0·103 kg/m3

Viscosity 0.1 Pa · s

Solid data

Density 1.2·103 kg/m3

Young modulus 107GPa

Poisson ratio 0.35, 0.4999

Table 2: Falling of a cylinder in a vis-

cous fluid. Problem data.

The solid cylinder has been modeled as a quasi-rigid body with an hypoe-

lastic model and a high value for the Young modulus. The VP formulation has

been used for the solid.

This numerical example was already studied in other publications [44, 45, 46].

For the fluid viscosity 0.1Pa · s and slip conditions on the walls, the cited works

give the velocity of fall of the cylinder reaching an asymptotic value of around

Umax = 0.037m/s.

In this work, the problem has been solved for both stick and slip conditions

on the vertical walls of the container, while the fluid-solid interface has been

modeled with no-slip conditions, in all the studied problems.

In Figure 3 the velocity field obtained considering slip boundary conditions

is given for three time instants.

In Figure 4, the results for the stick case for the same time instants of Figure

3 are given.

The resulting pressure field for the slip and stick cases is illustrated in Figure

5.

29



(a) t = 0.375s (b) t = 0.675s (c) t = 1.000s

Figure 3: Falling of a cylinder in a viscous fluid. 2D simulation of the slip case.

Snapshots of the cylinder motion with velocity contours at different instants.

The pictures show that the perturbation over the fluid pressure field caused

by the motion of the cylinder is almost imperceptible and there are not signifi-

cant differences between the slip and stick cases.

In the graph of Figure 6 the time evolution of the vertical velocity of the cylin-

der obtained with the finest mesh of 3-noded triangles (average size=0.0004m)

is given for both the slip and stick cases.

The terminal velocities of the cylinder obtained for the slip and the stick

cases are 0.0377m/s (giving a difference of around 1,8% with respect to the

reference works) and 0.0336m/s, respectively.

For this example the transmission conditions between the solid and the fluid

domain have been monitored. The curves of Figure 7 represent the time evo-

lution of the Neumann conditions in the X-direction (horizontal) at the points

A,B,C located at the boundary of the cylinder and depicted in Figure 2. Specif-

ically, the value plotted in the curves is the mean value of the X-component of

vector σn (σxxnx + τxyny) computed for the fluid and the solid elements at the

points A,B,C of Figure 2. The graph shows that the transmission condition is

guaranteed during all the analysis thanks to the monolithic solution of the FSI

problem.

The problem has been solved also for a quasi-incompressible solid using the

30



(a) t = 0.375s (b) t = 0.675s (c) t = 1.000s

Figure 4: Falling of a cylinder in a viscous fluid. 2D simulation of the stick case.

Snapshots of the cylinder motion with velocity contours at different instants.

VPS/S-element. For this analysis, a Poisson ratio of 0.4999 and the same Young

modulus of the previous case have been considered. The simulation has been

run considering stick conditions on the walls and using a mean mesh size of

0.007m, as for the problem plotted in Figure 4. In Figure 8 the velocity and the

pressure fields for the solid and the fluid computed at t = 1s are given.

In the graph of Figure 9 the time evolution of the vertical velocity obtained

with the VPS/S-element for ν = 0.4999 is compared to the solution obtained

with the VP-element for ν = 0.35 and the same average mesh size and boundary

conditions.

Figure 9 shows that the solutions are almost the same and the vicinity to

the incompressible limit does not affect the quality of the results.

31



(a) slip conditions, t = 1s (b) stick conditions, t = 1s

Figure 5: Falling of a cylinder in a viscous fluid. Pressure field obtained for the slip

and stick cases.

Sheet2

Page 1

0 0.2 0.4 0.6 0.8 1 1.2

-0.04

-0.035

-0.03

-0.025

-0.02

-0.015

-0.01

-0.005

0

slip conditions
stick conditions

Time [s]

Y
-V

e
lo

c
it
y
 [

m
/s

]

Figure 6: Falling of a cylinder in a viscous fluid. Time evolution of the vertical

velocity of the cylinder. Results for the slip and stick cases.

32



Sheet2

Page 1

0 0.25 0.5 0.75 1 1.25 1.5

-800

-600

-400

-200

0

200

400

600

800

 _point A fluid
 _point A solid
 _point B fluid
 _point B solid
 _point C fluid
 _point C solid

Time [s]

N
o
rm

a
l t

e
n
s
io

n
 (

σ
·n

) 
o
n
 N

e
u
m

a
n
n
 b

o
u
n
d
a
ry

 [
P

a
]

Time [s]

Figure 7: Falling of a cylinder in a viscous fluid. Time evolution of the X-component

of σxxnx + σxyny computed at the points A,B,C of Figure 2.

(a) Velocity field (b) Fluid pressure (c) Stress in the cylinder

Figure 8: Falling of a cylinder in a viscous fluid. Quasi-incompressible solid (ν =

0.4999). Velocity and the pressure fields and solid Cauchy stress (YY-component) at

t = 1s for stick conditions on the walls and a mean mesh size of 0.007m.

33



Sheet1

Page 1

0 0.2 0.4 0.6 0.8 1

-0.035

-0.03

-0.025

-0.02

-0.015

-0.01

-0.005

0

VPS element
VP element

Time [s]

Y
-V

e
l 
[m

/s
]

Figure 9: Falling of a cylinder in a viscous fluid. Solutions obtained with two different

elements for the solid: the VP-element (ν = 0.35) and the VPS/S-element (ν =

0.4999).

34



9.2. Filling of an elastic container with a viscous fluid

This example has been inspired from a similar problem presented in [47]. A

volume of a viscous fluid drops from a rigid container over a thin and highly

deformable elastic membrane. The impact of the fluid mass causes an initial

huge stretching of the structure and its subsequent oscillations. Two horizontal

rigid walls are placed at the top of the elastic container in order to avoid the

leackage of the fluid. The problem was solved in 2D for two different values of

the fluid viscosity, namely 50 and 100 Pa · s. For the structure, both the V

and VP elements presented in this work have been used. The purpose was to

compare the formulations and to show that both solid elements can be used for

the modeling of standard elastic solids in FSI problems. The initial geometry

of the problem is given in Figure 3 and the material data are given in Table 3.

Figure 10: Filling of an elastic container

with a viscous fluid. Initial geometry.

Geometry data

h 2.5 m

H 3.75 m

R 2.25 m

b 1.3 m

B 4.8714 m

s 0.2 m

Fluid data

Viscosity 50, 100 Pa · s
Density 1000 kg/m3

Solid data

Young modulus 2.1 107GPa

Poisson ratio 0.3

Density 20 kg/m3

Table 3: Filling of an elastic con-

tainer with a viscous fluid. Problem

data.

The solid and the fluid domains have been discretized with a mesh composed

by 9363 3-noded triangles.

35



In the graph of Figure 11 the results for the less viscous case (µ=50 Pa·s)

obtained using the V and the VP elements for the solid are given. The compar-

ison is performed for the vertical displacement of the lowest point of the elastic

structure.
Sheet2

Page 1

0 1 2 3 4 5 6 7 8 9 10

-1.2

-1

-0.8

-0.6

-0.4

-0.2

0

0.2

0.4

0.6

0.8

Mixed formulation
Velocity formulation

Time [seconds]

Y
 d

is
p
la

c
e
m

e
n
t 

[m
]

Amin

Amax

Figure 11: Filling of an elastic container with a viscous fluid (µ = 50Pa · s). Vertical

displacement of the bottom of the container obtained using the V and the VP elements

for the solid domain.

The curves are almost coincident and only after 4.5s of simulation some

slight differences appear.

In Table 4 the maximum and the minimum vertical displacements of the

elastic structure obtained with the V and the VP elements are shown. Amin

and Amax refer to the minimum and maximum points of the curves of Figure

11. The numerical results obtained with the two solid elements are very close.

Point
V-element VP-element

time instant vertical disp. time instant vertical disp.

Amin 1.045 s -0.951 m 1.045 s -0.961 m

Amax 2.695 s 0.586 m 2.695 s 0.606 m

Table 4: Filling of an elastic container with a viscous fluid (µ = 50Pa · s). Maximum

and minimum vertical displacements for the V and the VP elements.

36



For the same problem, some representative snapshots are collected in Figure

12. Over the solid domain the pressure contours are depicted and over the fluid

one the mesh is plotted. The numerical results correspond to the simulation

using the VP-element for the solid.

(a) t = 0.920s (b) t = 1.045s (c) t = 1.545s

(d) t = 2.670s (e) t = 3.170s (f) t = 7.320s

Figure 12: Filling of an elastic container with a viscous fluid (µ = 50Pa·s). Snapshots

of the numerical simulation at different instants. Pressure contours are depicted over

the solid domain.

In Figure 13 snapshots of the numerical simulation for the most viscous case

(µ=100 Pa·s) are given for the same time instants of Figure 12. The numerical

results correspond again to the solution obtained using the VP-element for the

solid domain.

The results obtained with the V and VP elements for the solid are compared

37



(a) t = 0.920s (b) t = 1.045s (c) t = 1.545s

(d) t = 2.670s (e) t = 3.170s (f) t = 7.320s

Figure 13: Filling of an elastic container with a viscous fluid (µ = 100Pa · s).

Snapshots at different instants of the 2D simulation. Pressure contours depicted over

the solid domain.

for the most viscous case analyzing the time evolution of the vertical displace-

ment at the bottom of the container. In Figure 14 the solutions obtained using

both elements are plotted.

Once again, the differences between the results of the two formulations for

the solid are very small. This is a further evidence of the validity and flexibility

of the Unified formulation, that allows us to choose for the solid either a velocity

or a mixed formulation.

The maximum and the minimum vertical displacements of the structure

obtained by the V and the VP elements are collected in Table 5. Bmin and

38



Sheet2

Page 1

0 1 2 3 4 5 6 7 8 9 10

-1.2

-1

-0.8

-0.6

-0.4

-0.2

0

0.2

0.4

0.6

Mixed formulation
Velocity formulation

Time [seconds]

Y
 d

is
p
la

c
e
m

e
n
t 

[m
]

Bmin

Bmax

Figure 14: Filling of an elastic container with a viscous fluid (µ = 100Pa·s). Vertical

displacement of the bottom of the elastic container obtained using the V and the VP

elements for the solid domain.

Bmax correspond to the points marked in the graph of Figure 14.

Point
V-element VP-element

time instant vertical disp. time instant vertical disp.

Bmin 1.070 s -0.950 m 1.070 s -0.960 m

Bmax 2.620 s 0.384 m 2.570 s 0.347 m

Table 5: Filling of an elastic container with a viscous fluid (µ = 100Pa ·s). Maximum

and minimum vertical displacements for the V and the VP elements.

Comparing the results of Tables 4 and 5, one may note that the lowest

position of the structure is almost the same for both problems, although in

the most viscous case it is reached slightly later. For the maximum upward

displacement, the differences between the two problems are bigger. In fact, the

maximum upward displacement of the container is significally larger for the less

viscous fluid and the highest position is reached later. This is so because the

less viscous fluid splashes more and moves away from the bottom of the elastic

container, reducing the weight acting on the container walls.

39



9.3. Collapse of a water column on a deformable membrane

The problem illustrated in Figure 15 was introduced by Walhorn et al . [48].

__________________________________________________

____________________________________________________________________________________         _________________________________________________________________________________

 ___

____________________________________________________________________________________

______________________

L

2L 2L

2L

D

H

Solid properties: 
Young modulus: 10  Pa 
Poisson ratio: 0   
Density: 2500 kg/m 

Geometry data: 
L: 0.146 m
H: 0.080 m
D: 0.012 m 

Width (3D): 0.07 m
Fluid properties: 
Bulk modulus: 2.5 10  Pa          2D mesh 
          Viscosity: 10   Pa s
Density 1000 kg/m 

 
 

(3-noded triangles) 
Solid elems.: 140 

Fluid elems.: 4108 
3D mesh 

(4-noded tetrahedra) 
Solid elems.: 17889 

Fluid elems.: 266127

6

3

3

9

-3

Figure 15: Collapse of a water column on a deformable membrane. Initial geometry

and problem data.

The water column collapses by instantaneously removing the vertical wall.

This originates the flow of water within the tank, the formation of a jet after

the water stream hits the ground, and the subsequent sloshing of the fluid as

it impacts a highly deformable elastic membrane. The membrane bends and

starts oscillating under the effect of its inertial forces and the impact with the

water stream.

In Figure 16 some representative snapshots of the 2D simulation are given.

The VP-element for the solid was used for the analysis.

40



(a) t = 0.238s (b) t = 0.350s

(c) t = 0.526s (d) t = 0.670s

(e) t = 1.500s (f) t = 2.000s

Figure 16: Collapse of a water column on a deformable membrane. Snapshots of the

2D simulation at different instants. The VP-element is used for the solid.

41



The results obtained with the present formulation using the V-element and

the VP-element for the solid have been compared to the ones computed in

[49, 1, 43]. In the graph of Figure 17 the time evolution of the horizontal

deflection of the left top corner is illustrated.

Walhorn et al. (2005)
Idelsohn et al. (2008)
Cremonesi et al. (2010)
VP-element
V-element

Figure 17: Collapse of a water column on a deformable membrane. Horizontal

deflection of the left top corner on time. Numerical results obtained with the V and

VP elements for the solid. Comparison with numerical results obtained in [48, 1, 43].

The diagram shows that for the first part of the analysis the proposed for-

mulation agrees well with the results reported in the literature. After around

0.5s of simulation, the numerical results of each formulation start to disagree.

However, for all cases the membrane oscillates two times around its vertical

position before the time instant t = 1s.

The first part of the simulation is easier to analyze than the second one

because the phenomena to model are less aleatory and the fluid splashes do not

affect the results, as it occurs after 0.5s. Furthermore, the differences between

the numerical simulations accumulate throughout the analysis. In other words,

a slight difference in the first part of the simulation may produce a huge variation

of the results for the rest of the analysis. In fact, the inital deformation of the

elastic structure affects highly the results: a smaller bending of the membrane

42



induces an impact of the water stream at an higher height of the containing wall

and with a bigger tangential component of the impact velocity. Consequently,

the fluid stream impacts with the right side of the elastic membrane later and

with reduced inertial forces.

The same example has been solved also in 3D. A width of 0.07m for the

prismatic tank been considered for the z-direction. In order to maintain the

plane strain state of the 2D problem, in the 3D analysis the nodal displacements

of the elastic membrane in the z-direction have been constrained. The mesh data

of the 3D problem are given in Figure 15. In this analysis the V-element has

been used for the solid.

In Figure 18 the numerical results of the 3D simulation are given.

43



(a) t = 0.25s (b) t = 0.39s

(c) t = 0.66s (d) t = 1.00s

Figure 18: Collapse of a water column on a deformable membrane. Snapshots of the

3D simulation of different instants. The V-element is used for the solid.

44



For the same time instants of Figure 18, in Figure 19 the velocity contours

are plotted over the cutting plane built at z = 0.035m.

(a) t = 0.25s (b) t = 0.39s

(c) t = 0.66s (d) t = 1.00s

Figure 19: Collapse of a water column on a deformable membrane. Velocity contours

plotted over the plane located at z = 0.035m of the 3D domain. The V-element is

used for the solid.

45



No numerical or experimental results have been found in the literature for the

described 3D abstraction of the 2D benchmark problem presented in [48]. For

this reason, 3D results have been compared only to the analogous 2D problem

solved with the proposed formulation. Figure 20 shows the time evolution of the

2D and 3D results for the horizontal deflection of the left top corner obtained

with the V-element for the solid. Sheet1

Page 1

0 0.25 0.5 0.75 1

-0.03

-0.02

-0.01

0

0.01

0.02

0.03

0.04

0.05

3  -D V element
2  -D V element

Time [s]

T
o
p
 X

-d
is

p
la

c
e
m

e
n
t 

[m
]

Figure 20: Collapse of a water column on a deformable membrane. Horizontal

deflection of the left top corner on time. Comparison between 2D and 3D analyses for

the V-element.

Figure 20 shows that the 3D results agree well with those of the 2D analysis

for the first part of the simulation. After around 0.5s the two graphs start to

diverge. In particular, in the 3D analysis the water stream hits the right side

of the membrane later and with a reduced impact force with respect to the 2D

problem. This is due to the 3D effects. In fact, if the plane strain hypotesis is

not satisfied exactly, the fluid can expand also in the z-direction reducing its

impact velocity against the structure. Clearly, the mesh refinement can reduce

these effects and, consequently, also the differences between the 3D and the 2D

simulations.

46



10. Concluding remarks

In this work, a Unified formulation for fluid and solid mechanics and FSI

problems has been presented.

For incompressible materials the mixed velocity-pressure formulation is sta-

bilized using the FIC-FEM procedure derived in [9] for Newtonian fluids and

applied in this work also for quasi-incompressible hypoelastic solids.

For the solid parts of the domain, three different hypoelastic elements have

been presented, namely the V, the VP and the VPS/S elements respectively

based on a velocity, mixed velocity-pressure and mixed velocity-pressure stabi-

lized formulation.

The Unified formulation, through an efficient combination of the PFEM

for the fluid, and the FEM for the solid, allows us to solve FSI problems in a

monolithic way ensuring automatically a strong coupling. Furthermore, the risk

of ill-conditioning in the global linear system of algebraic equations is reduced

using the same unknown variables for the fluid and the solid and solving the

global problem through a partitioned scheme.

The efficiency of the method has been tested by solving FSI benchmark

problems involving free surface viscous flows and large displacements for the

structure. Good agreement between the results obtained with the present for-

mulation and published results has been found in all cases for all the solid

elements derived in this work.

Acknowledgements

This work was partially supported by the SAFECON Advanced Grant project

and the FLOODSAFE Proof of Concept project of the European Research

Council.

47



References

[1] S. R. Idelsohn, J. Marti, A. Limache, E. Oñate, Unified lagrangian for-

mulation for elastic solids and incompressible fluids: Applications to fluid-

structure interaction problems via the pfem, Computer Methods In Applied

Mechanics And Engineering 197 (2008) 1762–1776.

[2] F. Brezzi, On the existence, uniqueness and approximation of saddle-point

problems arising from lagrange multipliers, Revue française d’automatique,

informatique, recherche opérationnelle. Série rouge. Analyse numérique

8(R-2) (1974) 129–151.

[3] F. Felippa, E. Oñate, Nodally exact ritz discretizations of 1d diffusion-

absorption and helmholtz equations by variational fic and modified equa-

tion methods, Computational Mechanics 39 (2007) 91–111.

[4] E. Oñate, Derivation of stabilized equations for advective-diffusive trans-

port and fluid flow problems, Computer methods in applied mechanics and

engineering 151 (1998) 233–267.

[5] E. Oñate, A. Valls, J. Garćıa, Fic/fem formulation with matrix stabilizing

terms for incompressible flows at low and high reynold’s numbers., Com-

putational mechanics 38 (4-5) (2006) 440–455.

[6] E. Oñate, J. Garćıa, S. R. Idelsohn, F. D. Pin, Fic formulations for finite

element analysis of incompressible flows. eulerian, ale and lagrangian ap-

proaches., Computer methods in applied mechanics and engineering 195

(23-24) (2006) 3001–3037.

[7] E. Oñate, P. Nadukandi, S. R. Idelsohn, J. Garćıa, C. Felippa, A family of

residual-based stabilized finite element methods for stokes flows, Interna-

tional Journal for Numerical Methods in Fluids 65(1-3) (2011) 106–134.

[8] E. Oñate, S. R. Idelsohn, C. Felippa, Consistent pressure laplacian sta-

bilization for incompressible continua via higher-order finite calculus, In-

48



ternational Journal of Numerical Methods in Engineering 87(1:5) (2011)

171–195.

[9] E. Oñate, A. Franci, J. M. Carbonell, Lagrangian formulation for finite

element analysis of quasi-incompressible fluids with reduced mass losses,

International Journal for Numerical Methods in Fluids 74 (10) (2014) 699–

731.

[10] W. Prager, Introduction to Mechanics of Continua, Ginn and Company,

Boston, 1961.

[11] A. Franci, Doctoral thesis: Unified Lagrangian formulation for fluid and

solid mechanics, fluid-structure interaction and coupled thermal problems

using the PFEM, 2015.

[12] O. C. Zienkiewicz, R. L. Taylor, The Finite Element Method. Its Basis and

Fundamentals. (6th Ed.), Elsevier Butterworth-Heinemann, Oxford, 2005.

[13] S. R. Idelsohn, E. Oñate, F. D. Pin, The particle finite element method:

a powerful tool to solve incompressible flows with free-surfaces and break-

ing waves, International Journal for Numerical Methods in Engineering 61

(2004) 964–989.

[14] H. Edelsbrunner, E. Mucke, Three dimensional alpha shapes, ACM Trans

Graphics 13 (1999) 43–72.

[15] A. Larese, R. Rossi, E. Oñate, S. R. Idelsohn, Validation of the particle

finite element method (pfem) for simulation of free surface flows, Inter-

national Journal for Computer-Aided Engineering and Software 25 (2008)

385–425.

[16] M. Cremonesi, L. Ferrara, A. Frangi, U. Perego, A lagrangian finite el-

ement approach for the simulation of water-waves induced by landslides,

Computer and Structures 89 (2011) 1086–1093.

49



[17] B. Tang, J. F. Li, T. S. Wang, Some improvements on free surface sim-

ulation by the particle finite element method, International Journal for

Numerical Methods in Fluids 60 (9) (2009) 1032–1054.

[18] R. Aubry, S. R. Idelsohn, E. Oñate, Particle finite element method in fluid-

mechanics including thermal convection-diffusion, Computers and Struc-

tures 83 (2005) 1459–1475.

[19] E. Oñate, R. Rossi, S. R. Idelsohn, K. Butler, Melting and spread of poly-

mers in fire with the particle finite element method., International Journal

of Numerical Methods in Engineering 81 (8) (2010) 1046–1072.

[20] E. Oñate, A. Franci, J. M. Carbonell, A particle finite element method

(pfem) for coupled thermal analysis of quasi and fully incompressible flows

and fluid-structure interaction problems, Numerical Simulations of Coupled

Problems in Engineering. S. R. Idelsohn (Ed.) 33 (2014) 129–156.

[21] S. R. Idelsohn, J. Marti, P. Becker, E. Oñate, Analysis of multifluid flows

with large time steps using the particle finite element method, International

Journal for Numerical Methods in Engineering 75 (9) (2014) 621–644.

[22] T. S. Dang, G. Meschke, An ale-pfem method for the numerical simuation

of two-phase mixture flow, Computer Methods in Applied Mechanics and

Engineering 278 (2014) 599–620.

[23] X. Zhang, K. Krabbenhoft, D. Sheng, Particle finite element analysis of the

granular column collapse problem, Granular Matter 16 (2014) 609–619.

[24] E. Oñate, S. R. Idelsohn, M. A. Celigueta, R. Rossi, Advances in the parti-

cle finite element method for the analysis of fluid–multibody interaction and

bed erosion in free surface flows, Computer methods in applied mechanics

and engineering 197 (19-20) (2008) 1777–1800.

[25] E. Oñate, M. A. Celigueta, S. R. Idelsohn, F. Salazar, B. Suarez, Possibili-

ties of the particle finite element method for fluid–soil–structure interaction

problems, Computation mechanics 48 (2011) 307–318.

50



[26] M. Zhu, M. H. Scott, Modeling fluid-structure interaction by the particle

finite element method in opensees, Computers and Structures 132 (2014)

12–21.

[27] J. M. Carbonell, E. Oñate, B. Suarez, Modeling of ground excavation with

the particle finite-element method, Journal of Engineering Mechanics 136

(2010) 455–463.

[28] E. Oñate, A. Franci, J. M. Carbonell, A particle finite element method

for analysis of industrial forming processes, Computational Mechanics 54

(2014) 85–107.

[29] J. M. Carbonell, E. Oñate, B. Suarez, Modelling of tunnelling processes and

cutting tool wear with the particle finite element method (pfem), Compu-

tational Mechanics 52 (3) (2013) 607–629.

[30] E. Oñate, J. M. Carbonell, Updated lagrangian finite element formulation

for quasi and fully incompressible fluids, Computational Mechanics 54 (6).

[31] P. Becker, S. R. Idelsohn, E. Oñate, A unified monolithic approach for

multi-fluid flows and fluid–structure interaction using the particle finite

element method with fixed mesh, Computational Mechanics 61 (2015) 1–

14.

[32] C. Truesdell, Hypo-elasticity, Journal of Rational Mechanics and Analysis

4,1.

[33] J. Nagtegaal, J. D. Jong, Some computational aspects of elastic-plastic

large strain analysis, Numerical Methods in Engineering 17 (1) (1981) 15–

41.

[34] A. Green, P. Naghdi, A general theory of an elastic-plastic continuum,

Archive for Rational Mechanics and Analysis 18 (1965) 251–281.

[35] G. Johnson, D. Bammann, A discussion of the stress rate in finite defor-

mation problems, International Journal of Solids and Structures 20 (1984)

725–737.

51



[36] T. Belytschko, W. K. Liu, B. Moran, K. I. Elkhodadry, Nonlinear Finite

Elements For Continua And Structures. Second Edition., John Wiley &

Sons, New York, 2014.

[37] P. Ryzhakov, E. Oñate, S. R. Idelsohn, Improving mass conservation in sim-

ulation of incompressible flows, International Journal of Numerical Meth-

ods in Engineering 90 (2012) 1435–1451.

[38] P. Ryzhakov, R. Rossi, S. R. Idelsohn, E. Oñate, A monolithic lagrangian

approach for fluid-structure interaction problems, Computational Mechan-

ics 46 (2010) 883–899.

[39] P. Ryzhakov, J. Cotela, R. Rossi, E. Oñate, A two-step monolithic method

for the efficient simulation of incompressible flows, International Journal

for Numerical Methods in Fluids 74 (12) (2014) 919–934.

[40] A. Franci, E. Oñate, J. M. Carbonell, On the effect of the bulk tan-

gent matrix in partitioned solution schemes for nearly incompressible flu-

ids, International Journal for Numerical Methods in Engineering DOI:

10.1002/nme.4839.

[41] E. Oñate, S. R. Idelsohn, F. D. Pin, R. Aubry, The particle finite element

method. an overview, International Journal for Computational Methods 1

(2004) 267–307.

[42] S. R. Idelsohn, N. Calvo, E. Oñate, Polyhedrization of an arbitrary point

set, Computer Methods in Applied Mechanics and Engineering 92 (22–24)

(2003) 2649–2668.

[43] M. Cremonesi, Doctoral thesis: A Lagrangian Finite Element Method for

the Interaction Between Flexible Structures and Free Surfaces Fluid Flows,

2010.

[44] A. J. Gil, A. Arranz, J. Bonet, O. Hassan, The immersed structural po-

tential method for haemodynamic applications, Journal of Computational

Physics 229 (2010) 8613–8641.

52



[45] C. Hesch, A. J. Gil, A. Arranz, J. Bonet, On continuum immersed strategies

for fluid–structure interaction, Computer Methods in Applied Mechanics

and Engineering 247 (2012) 51–64.

[46] X. Wang, W. K. Liu, Extended immersed boundary method using fem

and rkpm, Computer Methods in Applied Mechanics and Engineering 193

(2004) 1305–1321.

[47] M. Cremonesi, A. Frangi, U. Perego, A lagrangian finite element approach

for the analysis of fluid–structure interaction problems, International Jour-

nal of Numerical Methods in Engineering 84 (2010) 610–630.

[48] E. Walhorn, A. Kolke, B. Hubner, D. Dinkler, Fluid-structure coupling

within a monolithic model involving free surface flows, Computer & Struc-

tures Methods in Applied Mechanics and Engineering 83 (25-26) (2005)

2100–2111.

[49] B. Hubner, E. Walhorn, D. Dinkler, A monolithic approach to fluid-

structure interaction using space-time finite elements, Computer Methods

in Applied Mechanics and Engineering 193 (2004) 2087–2104.

53


