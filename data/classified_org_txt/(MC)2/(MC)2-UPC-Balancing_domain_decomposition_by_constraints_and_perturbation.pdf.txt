

























































Balancing Domain Decomposition by Constraints and Perturbation | SIAM Journal on Numerical Analysis | Vol. 54, NO. 6 | Society for Industrial and Applied Mathematics


 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

SIAM J. NUMER. ANAL. c© 2016 Society for Industrial and Applied Mathematics
Vol. 54, No. 6, pp. 3436–3464

BALANCING DOMAIN DECOMPOSITION BY CONSTRAINTS
AND PERTURBATION∗

SANTIAGO BADIA† AND HIEU NGUYEN‡

Abstract. In this paper, we formulate and analyze a perturbed formulation of the balancing
domain decomposition by constraints (BDDC) method. We prove that the perturbed BDDC has the
same polylogarithmic bound for the condition number as the standard formulation. Two types of
properly scaled zero-order perturbations are considered: one uses a mass matrix, and the other uses
a Robin-type boundary condition, i.e, a mass matrix on the interface. With perturbation, the well-
posedness of the local Neumann problems and the global coarse problem is automatically guaranteed,
and coarse degrees of freedom can be defined only for convergence purposes but not well-posedness.
This allows a much simpler implementation as no complicated corner selection algorithm is needed.
Minimal coarse spaces using only face or edge constraints can also be considered. They are very useful
in extreme scale calculations where the coarse problem is usually the bottleneck that can jeopardize
scalability. The perturbation also adds extra robustness as the perturbed formulation works even
when the constraints fail to eliminate a small number of subdomain rigid body modes from the
standard BDDC space. This is extremely important when solving problems on unstructured meshes
partitioned by automatic graph partitioners since arbitrary disconnected subdomains are possible.
Numerical results are provided to support the theoretical findings.

Key words. BDDC, preconditioner, coarse space, parallel solver, scalability

AMS subject classifications. 65N55, 65N22, 65F08

DOI. 10.1137/15M1045648

1. Introduction. The development of highly scalable linear solvers for the solu-
tion of large scale linear systems arising from the finite element (FE) discretization of
second-order elliptic problems on distributed-memory machines is of great importance
in many applications. In this work, we consider nonoverlapping domain decomposi-
tion (DD) methods [49], which take advantage of the partition of the FE mesh into
submeshes to define effective preconditioners that can exploit large levels of concur-
rency. In particular, we focus on a variant of the balancing DD by constraints (BDDC)
method. The BDDC method was first introduced in 2003 by Dohrmann [18]. It can
be regarded as an improved version of the balancing domain decomposition (BDD)
method by Mandel [43]. It also has a very close connection with the dual primal
finite element tearing and interconnecting (FETI-DP) method [25, 24]. In fact, the
eigenvalues of the preconditioned systems in the two approaches are almost identical
[44, 41, 15]. The BDDC method is particularly well suited for extreme scale simula-
tions, since it allows for a very aggressive coarsening, the computations at different
levels can be computed in parallel, the subdomain problems can be solved inexactly

∗Received by the editors October 27, 2015; accepted for publication (in revised form) October 19,
2016; published electronically November 29, 2016.

http://www.siam.org/journals/sinum/54-6/M104564.html
Funding: The work of the authors was funded by the European Research Council under the FP7

Program Ideas through the Starting Grant 258443, COMFUS: Computational Methods for Fusion
Technology, and the FP7 NUMEXAS project under grant agreement 611636. The work of the first
author was supported by the Catalan Government through the ICREA Acadèmia Research Program.
†Universitat Politècnica de Catalunya, 08034 Barcelona, Spain, and CIMNE – Centre Interna-

cional de Mètodes Numèrics en Enginyeria, Parc Mediterrani de la Tecnologia, UPC, 08860 Castellde-
fels, Spain (sbadia@cimne.upc.edu).
‡Institute of Research and Development, Duy Tan University, 3 Quang Trung, Danang, Vietnam,

and CIMNE – Centre Internacional de Mètodes Numèrics en Enginyeria, Parc Mediterrani de la
Tecnologia, UPC, 08860 Castelldefels, Spain (nguyentrunghieu14@dtu.edu.vn).

3436

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp

http://www.siam.org/journals/sinum/54-6/M104564.html
mailto:sbadia@cimne.upc.edu
mailto:nguyentrunghieu14@dtu.edu.vn


 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3437

[19, 42] by, e.g., one AMG cycle, and it can straightforwardly be extended to multiple
levels [50, 45]. All of these properties have been carefully exploited in the series of
papers [6, 7, 8, 9], where an extremely scalable implementation of these algorithms
has been proposed, leading to excellent weak scalability on nearly half a million cores
in its multilevel version (see also [29, 30] for weak scalability at extreme scales of the
FETI-DP method).

The BDDC method is based on a classification of nodes on the subdomain inter-
face into corners, and members of edges and faces, based on geometrical arguments
that can be used for any input mesh [49]. It is formulated on the partially subassem-
bled FE space in which continuity among subdomains is only weakly enforced on
some quantities, e.g., the value on subdomain corners and mean values on subdomain
edges and subdomain faces. In two dimensions, enforcing continuity on corners only
is enough to have a weakly scalable method; i.e., the number of iterations depends
only on the local problem size but not on the number of processors being used or the
global problem size. In three dimensions, continuity of mean values on edges and/or
faces must also be enforced to have fast convergence [25, 38].

The role of the corner constraints in the BDDC method is not only to attain
scalability. They must also ensure that the partially subassembled local problems and
the global coarse problem are well-posed. For structured meshes and regular parti-
tions, algorithms to find such constraints are simple, but it would become much more
complicated when considering unstructured meshes of complex three-dimensional ge-
ometries and partitions resulting from parallel mesh partitioners, e.g., ParMETIS
[27] or PT-Scotch [16]. In order to have well-posedness, different corner selection al-
gorithms have been considered [18, 40, 37, 48]. The idea behind these algorithms is
to introduce enough corner constraints such that the partially subassembled problems
are provably well-posed even with corner constraints only.

The reason why edge and/or face constraints are not usually considered for the
same purpose is twofold. First, it is harder to check how edge or face constraints fix
rigid-body modes in elasticity problems. Second, if corner constraints are sufficient to
have well-posedness, the partially subassembled systems, which are indefinite when
edge and/or face constraints are used, can be reduced to positive definite systems
by eliminating variables associated with corners [18]. Consequently, we can use more
efficient and more robust sparse methods which only work for positive definite systems.
An alternative allowing the use of positive definite sparse solvers and avoiding corner
constraints is to consider a change of basis that explicitly enforces edge and face
constraints [41, 37]. However, this approach is not straightforward to implement and
notably changes the sparsity pattern of the partially subassembled matrices.

The corner selection algorithms also have their own drawbacks. Based on our
experience, the implementation of this type of algorithm is an involved and time-
consuming task which depends on the physical problem to be solved and also the
type of FE formulation being used. For example, the implementation of the corner
selection algorithm from [48] in the scientific software FEMPAR [4] has more than
1,500 lines of code. Furthermore, the situation becomes far more complicated when
subdomains are disconnected, or connected only by corners or edges.1 As far as
we know, these situations have not been fully considered when formulating the corner
selection algorithms [40, 18, 48], thus leading to the breakdown of the BDDC method.
It is certainly possible to deal with disconnected subdomains, but it will increase the

1As an example, one can think about elasticity in three dimensions with two subdomains sharing,
e.g., one edge. The rigid body modes for the pair of subdomains are nontrivial.

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3438 SANTIAGO BADIA AND HIEU NGUYEN

complexity of the implementation of the BDDC method; for the solution of the same
problem in the BNN preconditioner, see [5]. Unfortunately, ParMETIS [27] and PT-
Scotch [16] parallel mesh partitioners cannot guarantee connected subdomains, and
we are not aware of any parallel mesh partitioner that can do it. The situation is
even more dramatic when using adaptive mesh refinement and space-filling curves for
efficient load balancing, e.g., exploiting Morton order [1].

In the authors’ opinion, finding corner constraints to guarantee the well-posedness
is one of the main issues that reduces the simplicity of the BDDC method. In this
work, we consider a different and simpler approach based on a perturbed formula-
tion of the method. Instead of using corner constraints to guarantee well-posedness,
we consider perturbed partially subassembled systems which are automatically well-
posed, regardless of the choice of the constraints. Two types of perturbations are
considered—a zero-order term, i.e., a mass matrix, and the use of Robin-type bound-
ary conditions, i.e., a perturbation by interface mass matrix. Certainly, we still need
to have a number of constraints to achieve scalability, but these can be simply chosen
based on geometrical properties.

Perturbation has been used to make local problems well-posed in other nonover-
lapping methods [17, 22]. However, in these previous works, the methods are either
without a coarse space or with a geometrical coarse space. Therefore, using pertur-
bation does not affect the coarse space and the convergence analysis of the methods.
This does not hold for the BDDC methods where the coarse space depends on the
formulation of the local problems. In fact, one can check that the scaling coefficients
in [17, 22] are completely different from the ones proposed in this work which are
required for scalability purposes.

We show that the perturbed BDDC method has the same polylogarithmic bound
for the condition number and thus is scalable. In addition, when the chosen constraints
are not enough and the BDDC space contains a small subspace of rigid body modes,
we prove that most of the eigenvalues of the preconditioned system, except for a few
large isolated ones, are bounded by the usual bounds of the standard BDDC method.
In other words, the perturbed BDDC method is still scalable even though the number
of iterations will be higher compared to the case when all rigid body modes are fixed.

Further, with the perturbed formulation, the well-posedness is guaranteed and
sparse direct methods for positive definite systems can be used without the need of
corner selection mechanisms, corner constraints enforcement, or a change of basis
when there are only edge or face constraints.

Another very important benefit of using the perturbed formulation is the fact that
we can reduce the size of the coarse problem, allowing even more aggressive coars-
ening strategies than the ones that can be used with the standard BDDC method.
For three-dimensional problems, corners (including those introduced by the corner
selection algorithms) do not significantly contribute to the convergence. With the
perturbed BDDC method we can consider much smaller coarse problems only in-
volving faces and/or edges. This point is particularly important when dealing with
unstructured meshes and partitions generated by mesh partitioners due to the pro-
liferation of corners. Since the coarse problem is the bottleneck that can destroy
scalability, these strategies are better suited for large scale simulations.

The rest of the paper is organized as follows. In section 1, we introduce the
model problems and the interface problem in nonoverlapping methods. In section 2,
the formulation of the perturbed BDDC preconditioner is presented. Different types
of perturbation are discussed in section 3. The proposed preconditioner is analyzed in
section 4. In section 5, numerical experiments are provided to verify the theoretical

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3439

findings. We end by drawing some conclusions in section 6.
1.1. Model problems. Let Ω be a bounded domain with a polygonal boundary

in Rn, n = 2, 3. We consider two model problems.
Poisson’s equation. For simplicity of exposition, we consider Poisson’s equation

with homogeneous Dirichlet conditions. Its weak formulation reads as follows: find
u(x) ∈ H10 (Ω) such that

(1.1) a(u, v) = 〈F, v〉 ∀v(x) ∈ H10 (Ω),

where

a(u, v) =
∫

Ω
∇u · ∇v dx, 〈F, v〉 =

∫
Ω
f(x) v(x)dx.

The case with a general boundary condition only involves a modification of the right-
hand side, and our theoretical results still apply. In fact, we consider nonhomogeneous
boundary conditions in the numerical experiment section.

Linear elasticity. Let ∂Ω = ∂ΩD∩∂ΩN , and assume that ∂ΩD is clamped with the
homogeneous Dirichlet boundary condition, and ∂ΩN is subjected to a surface force g,
i.e., a natural boundary condition. There is also a body force f . Let H10 (Ω, ∂ΩD)

n =
{v ∈ H1(Ω)n : v|∂ΩD = 0}. We consider the problem of finding u ∈ H10 (Ω, ∂ΩD)

n

such that

(1.2) a(u,v) = 〈F ,v〉 ∀v ∈H10 (Ω, ∂ΩD)
n,

where

a(u,v) =
∫

Ω
2µ �(u) : �(v) dx+

∫
Ω
λdiv u div v dx,

�(u) : �(v) =
3∑

i,j=1
�ij(u)�ij(v), �ij(u) =

1
2

(
∂ui
∂xj

+
∂uj
∂xi

)
,

〈F ,v〉 =
∫

Ω
fT v dx+

∫
∂ΩN

gT vds.

The presentation in this work covers both the Poisson and linear elasticity prob-
lems. In general, proofs are given for the Poisson problem, and some comments are
provided about how to extend it to linear elasticity when needed.

Let Th be a shape-regular triangulation of size h of Ω and Vh ⊂ H10 (Ω) be the
corresponding P1 space, i.e., the space of continuous piecewise linear functions on Th
that vanish on ∂Ω. Then the discrete problem for (1.1) is to find uh ∈ Vh such that

(1.3) a(uh, v) = 〈F, v〉 ∀v ∈ Vh.

Let us also consider a partition of Ω into subdomains Ω = ∪Jj=1Ωj with the inter-
subdomain interface Γ = ∪Jj=1∂Ωj\∂Ω. We denote by H the subdomain characteristic
size. We further assume that the subdomain partition is obtained by aggregation of
elements in Th.

We represent by Vh(Γ) the interface space of piecewise discrete harmonic func-
tions which are discrete harmonic on each subdomain. The global Schur complement
operator Sh : Vh(Γ)→ Vh(Γ)′, where Vh(Γ)′ is the dual space of Vh(Γ), can be defined
by

(1.4)
〈
Shv1, v2

〉
= a(v1, v2) ∀v1, v2 ∈ Vh(Γ).

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3440 SANTIAGO BADIA AND HIEU NGUYEN

Here 〈·, ·〉 denotes the canonical duality pairing, i.e, 〈γ, v〉 = γ(v).
Using static condensation, namely the process of eliminating component functions

in Vh that vanish on Γ to reduce (1.3) to a problem posed on the interface space Vh(Γ)
(see [14, section 7.5]), we have

(1.5) Shūh = fh, ūh ∈ Vh(Γ), fh = F |Vh(Γ).

Our goal is to formulate an efficient preconditioner for Sh.
2. Preconditioner formulation.
2.1. Constraints. The constraints in BDDC usually rely on a topological clas-

sification of the nodes on the interface as subdomain corners, nodes of subdomain
edges or subdomain faces. In this subsection, we will give concrete definitions of these
geometrical objects.

We denote by Γh the discretization of Γ associated with Th. Let N (p) be the set of
indices of subdomains that share node p ∈ Γh, i.e., N (p) = {j : p ∈ Γ

j
h = Γh ∩ ∂Ωj}.

Then the nodes in Γh can be classified into objects, where each object G is a maximal
subset of nodes with the same set of indices, i.e., N (p) = N (q) for any p, q ∈ G. We
denote | · | the cardinality of a set and N (G) the set of subdomain indices associated
with G, i.e., N (G) := N (p), p ∈ G . Then, in three-dimensional space, G is classified
as a face if |N (G)| = 2 and |G| > 1, an edge if |N (G)| > 2 and |G| > 1, and a corner
if |G| = 1. In two-dimensional problems, G is classified as an edge if |N (G)| = 2 and
|G| > 1 and a corner if |G| = 1. A similar classification was introduced in [37, 32, 48].

A constraint in BDDC can be the value at a subdomain corner or an average
value on a subdomain edge or a subdomain face. As we will see in the following
subsection, the constraints are no longer responsible for the well-posedness of the
local Neumann problems and the global coarse problem in the proposed perturbed
formulation. Therefore, they can be chosen based only on their potential to improve
the convergence of the method. For simplicity, in this work we propose choosing C,
the set of constraints, by deciding the types of constraints we want to use. In other
words, C contains all the corner constraints, or all the edge constraints, or all the
face constraints, or combinations of these options; we do not consider only corner
constraints in three dimensions as this choice is known to be noncompetitive [24, 25].

2.2. Perturbed BDDC preconditioner. Considering ã(·, ·) a perturbed bi-
linear form of a(·, ·), we assume that ã(·, ·) satisfies the following assumptions.

Assumption 2.1. There exist two constants CL and CU which are independent of
the size of the domain (D), the size of the subdomains (H), and the number of the
subdomains (J) such that

(2.1) CL a(v, v) ≤ ã(v, v) ≤ CU a(v, v) ∀v ∈ H10 (Ω).

Assumption 2.2. The bilinear form ã(·, ·) can be written as

ã(u, v) =
J∑

j=1
ãj(uj , vj) ∀u, v ∈ H10 (Ω), uj = u|Ωj , vj = v|Ωj ,

where each ãj(·, ·) is a positive definite bilinear form on H10 (Ω)|Ωj .
Assumption 2.3. The local perturbed bilinear form ãj(·, ·) introduced in Assump-

tion 2.2 satisfies

(2.2) C` aj(vj , vj) ≤ ãj(vj , vj) ∀vj ∈ H10 (Ω)|Ωj ,

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3441

where aj(u, v) =
∫

Ωj
∇u ·∇v dx and C`> 0 does not depend on the size of the domain

(D), the size of the subdomains (H), or the number of the subdomains (J).
In the next step, we will present the perturbed formulation for the BDDC method.

We adopt notation similar to that in [14, section 7.8].
Let Ṽh(Γ) be the space of piecewise discrete harmonic functions with respect to

(w.r.t.) the bilinear form ã(·, ·). We define the perturbed global Schur complement
operator S̃h : Ṽh(Γ)→ Ṽh(Γ)′ as follows:

(2.3)
〈
S̃hv1, v2

〉
= ã(v1, v2) ∀v1, v2 ∈ Ṽh(Γ).

Let Vj := Vh|Ωj and Vh(Ωj) be the subspace of Vj whose members vanish on
∂Ωj . Also let H̃j = Ṽh(Γ)|Ωj be the space of local ãj(·, ·)-discrete harmonic functions.
Then, it follows that H̃j ⊂ Vj and H̃j = {vj ∈ Vj : ãj(uj , vj) = 0 ∀uj ∈ Vh(Ωj)}.

Now we can introduce the perturbed BDDC space associated with ã(·, ·):

H̃c = {ṽ ∈ L2(Ω) : ṽj = ṽ|Ωj ∈ H̃j , ṽ has continuous values for constraints in C}.

(2.4)

Clearly, Ṽh(Γ) ⊂ H̃c.
The symmetric positive definite operator S̃c : H̃c → H̃′c is then defined by

(2.5) 〈S̃cu, v〉 =
J∑

j=1
ãj(uj , vj) ∀u, v ∈ H̃c, uj = u|Ωj , vj = v|Ωj .

We note that 〈S̃cu, v〉 = 〈S̃hu, v〉 for u, v ∈ Ṽh(Γ) ⊂ H̃c.
Let Ẽj : H̃j → L2(Ω) be the trivial extension (by zero) operator. We can define

H̃◦j := {v ∈ H̃j : Ẽjv ∈ H̃c}, the space of local ãj(·, ·)-discrete harmonic functions
whose interface constraints in C equal zero. Each H̃◦j is then equipped with the
symmetric positive definite operator S̃j : H̃◦j → (H̃

◦
j )
′ defined by

(2.6) 〈S̃ju, v〉 = ãj(u, v) ∀u, v ∈ H̃◦j .

Now we define the coarse space of the perturbed BDDC preconditioner,

(2.7) H̃0 = {v ∈ H̃c : ãj(uj , vj) = 0 ∀uj ∈ H̃◦j , vj = v|Ωj , 1 ≤ j ≤ J},

and the symmetric positive definite operator S̃0 : H̃0 → H̃′0 as follows:

(2.8) 〈S̃0u, v〉 = 〈S̃cu, v〉 ∀u, v ∈ H̃0.

Obviously, the space H̃c can be written as

(2.9) H̃c = H̃0 ⊕S̃c H̃
◦, where H̃◦|Ωj = H̃

◦
j .

Remark 2.4. The member functions of H̃0 satisfy a constrained minimization
property; namely, for any v0 ∈ H̃0 we have

ãj(v0, v0) = min
vj∈Vj , vj=v0 “at” C|Γj

h

ãj(vj , vj).

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3442 SANTIAGO BADIA AND HIEU NGUYEN

Now in order to connect the spaces H̃0 and H̃◦j to Ṽh(Γ), we define the averaging
operator P̃Γ : H̃c → Ṽh(Γ) as follows:

(2.10) (P̃Γv)(p) =
1

|N (p)|
∑

j∈N (p)

vj(p) ∀v ∈ H̃c, vj = v|Ωj , p ∈ Γh.

As we want to formulate a preconditioner for Sh, not S̃h, we need a connection
from Ṽh(Γ) to Vh(Γ). Let QΓ : Ṽh(Γ)→ Vh(Γ) be the operator defined by

(2.11) (QΓṽ)(p) = ṽ(p) ∀ ṽ ∈ Ṽh(Γ), p ∈ Γh.

The operator QΓ in (2.11) is well defined because functions in Vh(Γ) and Ṽh(Γ) are
completely determined by their nodal values on the interface. Here, we emphasize
that even though ṽ and QΓṽ are identical on the interface Γh, they can be different.
More specifically, ṽ is the harmonic extension of ṽ|Γh w.r.t. the bilinear form ã(·, ·),
while QΓṽ is the harmonic extension of ṽ|Γh w.r.t. the bilinear form a(·, ·).

Finally, we are in a position to present our perturbed BDDC preconditioner
B̃BDDC : V ′h(Γ)→ Vh(Γ) for Sh. It is defined as follows:

B̃BDDC = (QΓP̃ΓẼ0)S̃−10 (QΓP̃ΓẼ0)
t +

N∑
j=1

(QΓP̃ΓẼj)S̃−1j (QΓP̃ΓẼj)
t(2.12)

=
J∑

j=0
PjS̃

−1
j (Pj)

t, where Pj = QΓP̃ΓẼj .

Here, we use Ẽ0 to denote the natural injection of H̃0 into H̃c.
Remark 2.5. We note that the perturbed BDDC preconditioner is formulated

with perturbed operators in all of the local subdomain solves as well as the global
coarse solve. For perturbed bilinear forms satisfying Assumptions 2.1 and 2.2, the
invertibility of these operators is guaranteed regardless of the choice of the constraints.

Remark 2.6. We emphasize that B̃BDDC is not the standard BDDC preconditioner
formulated for the perturbed problem (the PDE associated with the perturbed bilinear
form). It is a hybrid preconditioner for the original Schur operator Sh and not the
Schur operator of the perturbed problem. Reducing the problem to the interface
requires solving local Dirichlet problems in the original form, whereas forming the
perturbed preconditioner requires solving local Neumann problems and a global coarse
problem in the perturbed form.

3. Choices of perturbed bilinear form. In this section, we present two prac-
tical choices for the perturbed bilinear form ã(·, ·) and its subdomain components.

3.1. Perturbation with full mass matrix. The bilinear forms ã(·, ·) and
ãj(·, ·) are chosen as follows.

ã(u, v) =
J∑

j=1
ãj(u, v), ãj(u, v) = aj(u, v) +

1
D2

∫
Ωj
uv dx,(3.1)

where D is the size (diameter) of Ω. We emphasize that the scaling factor used here,
i.e., 1/D2, is different from the scaling factor 1/H2 used in [21].

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3443

Lemma 3.1. The bilinear forms ã(·, ·) and ãj(·, ·) defined in (3.1) satisfy Assump-
tion 2.1 with CL = 1 and CU = 1 + CΩ, Assumption 2.2, and Assumption 2.3 with
C` = 1. Here, the constant CΩ depends only on the shape of Ω but not on its size.

Proof. The first inequalities in Assumptions 2.1, 2.2, and 2.3 are straightforward.
The second inequality in Assumption 2.1 follows from a Friedrichs inequality and a
scaling argument. Here, CΩ is the constant in a Friedrichs inequality, and it depends
only on the shape of Ω but not on its size (see, e.g, [49, Corollary A.15]). In case Ω
is convex, according to [12], after the scaling argument, CΩ = 1/π.

3.2. Robin perturbation. The bilinear form ã(·, ·) is defined by

ã(u, v) =
J∑

j=1
ãj(u, v), ãj(u, v) = aj(u, v) +

Hn−1j
Dn

∫
Γj
uv ds,(3.2)

where D is the size of the domain Ω, Hj is the size of the subdomain Ωj , and n is
the dimension of the physical space Ω. We call this a Robin perturbation since the
local Neumann problems, in this case, can be posed with Robin boundary condition
(Hn−1j /D

n)u + ∂u/∂nj = 0 on ∂Ωj\∂Ω, where nj is the outward normal vector of
∂Ωj .

Lemma 3.2. The bilinear forms ã(·, ·) and ãj(·, ·) defined as in (3.2) satisfy As-
sumption 2.1 with CL = 1 and CU = 1 + ĈΩ, Assumption 2.2, and Assumption 2.3
with C` = 1. Here, the constant ĈΩ does not depend on the size of the domain or the
size of the subdomains.

Proof. We only need to focus on the second inequality in Assumption 2.1, as other
inequalities are trivial.

For subdomain Ωj , applying Lemma A.17 in [49] with L = 1, f1(v) = ‖v‖L2(∂Ω),
and using the trace theorem, for any v ∈ H10 (Ω), we find that

‖v‖2L2(∂Ωj) ≤ C1|v|
2
H1/2(∂Ωj) + C2‖v‖

2
L2(Ωj) ≤ C1|v|

2
H1(Ωj) + C2‖v‖

2
L2(Ωj).

By a scaling argument and the fact that the partition is quasi-uniform, there exist
constants Ĉ1, Ĉ2 (which depend only on the shape of Ω̂j) so that

‖v‖2L2(∂Ωj) ≤ Ĉ1 H |v|
2
H1(Ωj) + Ĉ2 H

−1‖v‖2L2(Ωj).

Summing these inequalities over all subdomains, we have

2‖v‖2L2(Γ) ≤ Ĉ1 max H |v|
2
H1(Ω) + Ĉ2 max H

−1‖v‖2L2(Ω).

Since v ∈ H10 (Ω), we can bound the second term on the right using a Friedrichs
inequality. With the appropriate scaling, we find

2‖v‖2L2(Γ) ≤ Ĉ1 max H |v|
2
H1(Ω) + Ĉ2 max D

2H−1|v|2H1(Ω).

As H < D, it follows that ‖v‖2
L2(Γ) ≤ ĈΩ

Dn

Hn−1
|v|2

H1(Ω), where ĈΩ does not depend
on D or H.

Remark 3.3. In our presentation, the diffusion coefficient, for simplicity of expo-
sition, is assumed to be 1. However, the perturbed BDDC method can be extended to
the case where the coefficient is constant in each subdomain and varies greatly from

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3444 SANTIAGO BADIA AND HIEU NGUYEN

one subdomain to another. For this case, the perturbed bilinear forms in (3.1) and
(3.2) are replaced by

ã(u, v) =
J∑

j=1
ãj(u, v), ãj(u, v) = αj

∫
Ωj
∇u · ∇v dx+

αj
D2

∫
Ωj
uv dx,

and

ã(u, v) =
J∑

j=1
ãj(u, v), ãj(u, v) = αj

∫
Ωj
∇u · ∇v dx+

αj H
n−1
j

Dn

∫
Γj
uv ds,

respectively. Here αj denotes the (constant) diffusion coefficient associated with the
subdomain Ωj .

In the case where the coefficient jumps do not align with subdomain interface, the
perturbed formulation can also be extended to physics-based BDDC [10], our recently
developed BDDC method especially targeting heterogeneous problems.

Remark 3.4. For linear elasticity, similar perturbed bilinear forms can be used:

ã(u,v) = a(u,v) +
2µ
D2

∫
Ω

uT v dx,

ã(u,v) = a(u,v) +
2µHn−1

Dn

∫
Γ

uT v ds.

Results similar to Lemmas 3.1 and 3.2 can also be obtained since the proof of these
lemmas can be extended to vector-space cases with help from Korn’s first inequality:

‖v‖H1(Ω) ≤ C (�(v), �(v))L2(Ω)
(
≤ C

1
2µ

a(v,v)
)
.

Remark 3.5. If the aspect ratio of the physical domain is of order 1, the domain
diameter D can be obtained from the mass matrix M by pre- and post-multiplying
it with the vector of ones and raising the result to 1/n, i.e., D = (1tM1)

1
n . No

geometrical information is needed. A similar statement also holds for the diameters
of subdomains obtained from a good mesh partitioner, e.g., METIS [26].

4. Convergence analysis. In this section, we analyze the convergence of the
perturbed BDDC preconditioner in solving (1.5). First, we present a tool to connect
functions in the standard and the perturbed BDDC spaces.

Lemma 4.1 (energy minimizing properties). If v ∈ Vh(Γ) and ṽ ∈ Ṽh(Γ) satisfy
v = QΓṽ, then the following inequalities hold:

a(v, v) ≤ a(ṽ, ṽ),(4.1)
ã(ṽ, ṽ) ≤ ã(v, v).(4.2)

Proof. Since v = QΓṽ, v and ṽ are identical on Γ. Consequently, vj = v|Ωj and
ṽj = ṽ|Ωj are identical on ∂Ωj . Using the energy minimizing property of harmonic
functions, we have aj(vj , vj) ≤ aj(ṽj , ṽj) and ãj(ṽj , ṽj) ≤ ãj(vj , vj). As v and ṽ are
both continuous functions, we can add these inequalities for all j = 1, . . . , J to obtain
(4.1) and (4.2).

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3445

We continue with some notation. Let θV , θE , and θF be the characteristic finite
element functions of a subdomain corner V, a subdomain edge E , and a subdomain
face F , respectively. They are essentially the discrete harmonic functions that vanish
at every nodal point of ∂Ωj except at V, those of E , and those of F where they equal
1.

We use the notation f . g to denote that f ≤ C g, where C does not depend on
the size of the domain (D), the size of the subdomains (H), the number of subdomains
(J), or particularly the constants CL, CU, and C`. We want to explicitly derive the
change of condition number coming from the perturbation.

The following lemma is quoted from [21, Lemma 4.5] (see also [38, Lemma 2] and
[49, Lemma 4.24]).

Lemma 4.2. Assume Ωj is the union of a finite number of shape-regular (trian-
gular or tetrahedral) elements. Let F be a subdomain face of Ωj, and let Ih denote
the interpolation operator onto the finite element space Vh. Then, for all u ∈ Vj

(4.3) ‖Ih(θFu)‖2
H

1/2
00 (F)

. [1 + ln(Hj/hj)]2
(
|u|2

H1/2(F) +
1
Hj
‖u‖2L2(F)

)
,

where H1/200 (F)-norm is defined as the H
1/2(∂Ωj)-norm of the function extended by

zero onto ∂Ωj\F (cf. [49, section A.2]).

We note that the assumption on the shape of Ωj is a technical requirement only for
analysis. Attempts to relax this assumption have been successful only in two dimen-
sions (see [35]). However, BDDC and FETI-DP, whose analysis relies on Lemma 4.2,
work well in practice for more general partitions, e.g., those generated by graph par-
titioners (see [24, 33, 34, 48, 7]).

We are now ready to state one of our main results.

Theorem 4.3. The smallest eigenvalue of the preconditioned system B̃BDDCSh
satisfies the following lower bound:

λmin(B̃BDDCSh) ≥ C−1U =: λm.

Proof. This proof is modeled after the proof of [14, Lemma 7.8.11]. The main
difference is the use of Assumption 2.1 and the energy minimizing property (4.2) to
connect the perturbed formulation with the original system.

Equation (2.11) implies that for any v ∈ Vh(Γ), there exists a unique ṽ ∈ Ṽh(Γ)
such that v = QΓṽ. Due to (2.9) and the fact that Ṽh(Γ) ⊂ H̃c, we can write
ṽ = ṽ0 + ṽ◦, where ṽ0 ∈ H̃0 and ṽ◦ ∈ H̃◦ . Then we have

(4.4) ṽ = P̃Γ(ṽ0 + ṽ◦) = P̃Γ
(
Ẽ0ṽ0 +

J∑
j=1

Ẽj ṽj

)
= (P̃ΓẼ0)ṽ0 +

J∑
j=1

(P̃ΓẼj)ṽj ,

where ṽj = ṽ◦|Ωj ∈ H̃◦j . Consequently,

(4.5) v = QΓṽ = QΓP̃ΓẼ0ṽ0 +
J∑

j=1
QΓP̃ΓẼj ṽj =

J∑
j=0

Pj ṽj .

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3446 SANTIAGO BADIA AND HIEU NGUYEN

From (4.4), (2.6), (2.8), (2.5), and (2.9), we obtain
J∑

j=0

〈
S̃j ṽj , ṽj

〉
=
〈
S̃0ṽ0, ṽ0

〉
+

J∑
j=1

ãj(ṽj , ṽj) =
〈
S̃cṽ0, ṽ0

〉
+
〈
S̃cṽ
◦, ṽ◦

〉
(4.6)

=
〈
S̃c(ṽ0 + ṽ◦), (ṽ0 + ṽ◦)

〉
=
〈
S̃cṽ, ṽ

〉
=
〈
S̃hṽ, ṽ

〉
= ã(ṽ, ṽ).

Using the energy minimizing property (4.2) and Assumption 2.1, we have

ã(ṽ, ṽ) ≤ ã(v, v) ≤ CU a(v, v) = CU
〈
Shv, v

〉
.(4.7)

From (4.5), (4.6), and (4.7), it follows that

CU
〈
Shv, v

〉
≥ ã(ṽ, ṽ) =

J∑
j=0

〈
S̃j ṽj , ṽj

〉
≥ min

v=
∑

J

j=0
Pj ṽj

ṽ0∈H̃0, ṽj∈H̃
◦
j

, (1≤j≤J)

J∑
j=0

〈
S̃j ṽj , ṽj

〉
.

The estimate for λmin(B̃BDDCSh) then follows directly from the abstract additive
Schwarz framework [14, 7.1.22].

Let Hc and PΓ be defined similarly to H̃c and P̃Γ, with ã(·, ·) being replaced by
a(·, ·) in all the steps leading to (2.4) and (2.10), respectively. We emphasize that the
functions in Hc satisfy the same constraints in C as the functions in H̃c.

The following assumption introduces our simplified and combined definition of ac-
ceptable edge path [38] and acceptable face path [39] for the case of a constant diffusion
coefficient. It is needed in the analysis of options in which not all geometrical objects
are included in C to define constraints. For the case where the coefficient varies from
one subdomain to another, the original definitions of acceptable paths are required
(cf. [38, 39, 49]).

Assumption 4.4. For two subdomains Ωa,Ωb that share an edge but not a face or a
corner but not an edge, either this shared object, which we call G, is included in the set
of constraints C, or there exists a sequence of subdomains {Ωa = Ωj1 ,Ωj2 , . . . ,Ωjk =
Ωb} satisfying the following properties:
(i) they all share the common object G;
(ii) for j = 1, . . . , k − 1, subdomains Ωjm and Ωjm+1 must share, apart from G, an

object in C of type T; here type T is either an edge or a face and is predefined.
Lemma 4.5. Let w ∈ Hc and u = w − PΓw. If Assumption 4.4 is true, then the

following estimate holds:

|uj |2H1(Ωj) . [1 + ln(H/h)]
2
∑

k∈Nj

|wk|2H1(Ωk),(4.8)

where uj = u|Ωj , wk = w|Ωk , and Nj = {k : ∂Ωk ∩ ∂Ωj 6= ∅}. Consequently,

J∑
j=1

aj(uj , uj) . [1 + ln(H/h)]2
J∑

j=1
aj(wj , wj)(4.9)

or, equivalently,

|P∆w|S . [1 + ln(H/h)]2 |w|S ,(4.10)

where P∆ := I − PΓ and |w|S :=
〈
Scw,w

〉
=
∑J

j=1 aj(wj , wj).

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3447

The estimates (4.8), (4.9), and (4.10) are typical in the analysis of FETI-DP [24],
a method closely related to BDDC. For their proofs, we refer the reader to [38, Lemma
10], [39, Lemma 7], and [49, Lemma 6.36]. Here, we only want to emphasize that with
our choice of constraints C, Assumption 4.4 holds.

Remark 4.6. Lemma 4.5 also holds for linear elasticity; however, the requirements
of the constraints are different. In three dimensions, we need at least six constraints
in order to control the rigid-body modes of a subdomain. For example, if we use
only face constraints, then constraints on first-order moments can be added to fully
control the rigid-body modes. For more information about nonoverlapping methods
for elasticity, we refer the reader to [36] and [37].

Theorem 4.7. The largest eigenvalue of the preconditioned system B̃BDDCSh sat-
isfies the following upper bound:

λmax(B̃BDDCSh) .
CU

CL min{C`, CL}
[1 + ln(H/h)]2 =: λM.

Proof. For this proof, we follow the main steps of the proof of [14, Lemma 7.8.11]
with significant changes to adapt to the perturbed formulation.

For any v ∈ Vh(Γ), we consider an arbitrary decomposition

v = QΓP̃ΓẼ0ṽ0 +
J∑

j=1
QΓP̃ΓẼj ṽj =

J∑
j=0

Pj ṽj ,

where ṽ0 ∈ H̃0, ṽj ∈ H̃◦j , 1 ≤ j ≤ J . According to the abstract additive Schwarz
framework [14, 7.1.21], Theorem 4.7 will follow if we can show that

(4.11)
〈
Shv, v

〉
.

CU
CL min{C`, CL}

[1 + ln(H/h)]2
N∑

j=0

〈
S̃j ṽj , ṽj

〉
.

First, we need to make a connection between the perturbed formulation and the
standard one. Let H0, H◦j , PΓ : Hc → Vh(Γ) and Ej : Hj → L

2(Ω), where 1 ≤ j ≤ J ,
be defined similarly to H̃0, H̃◦j , P̃Γ, and Ẽj but w.r.t. a(·, ·) instead of ã(·, ·) (they
are essentially the spaces and operators defined in the standard formulation of BDDC
[13, 14]). Since the functions in H0, H◦j , H̃0, and H̃

◦
j are completely defined by

their values on Γj = Γ ∩ ∂Ωj , there uniquely exist v0 ∈ H0 and vj ∈ H◦j such that
v0|Γj = ṽ0|Γj , vj |Γj = ṽj |Γj . Therefore, their averaged extensions are the same; i.e.,

(4.12) PΓEjvj = QΓP̃ΓẼj ṽj = Pj ṽj , j = 0, . . . , J.

Consequently, v = PΓE0v0 +
∑J

j=1 PΓEjvj . Now let

(4.13) ṽ = P̃ΓẼ0ṽ0 +
J∑

j=1
P̃ΓẼj ṽj =:

J∑
j=0

P̃j ṽj ;

then ṽ ∈ Ṽh(Γ) and v = QΓṽ. This implies that v and ṽ are identical on the interface
Γ. Using the energy-minimizing property (4.1) and Assumption 2.1, we have

(4.14) a(v, v) ≤ a(ṽ, ṽ) ≤ C−1L ã(ṽ, ṽ).

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3448 SANTIAGO BADIA AND HIEU NGUYEN

From (1.4), (2.3), and (4.14), it follows that

(4.15)
〈
Shv, v

〉
= a(v, v) ≤ C−1L ã(ṽ, ṽ) = C

−1
L

〈
S̃hṽ, ṽ

〉
.

On the other hand, from (4.13), we find that

〈
S̃hṽ, ṽ

〉
=
〈
S̃h

J∑
j=0

P̃j ṽj ,

J∑
j=0

P̃j ṽj

〉
(4.16)

≤ 2
(〈

S̃hP̃0ṽ0, P̃0ṽ0

〉
+
〈
S̃h

J∑
j=1

P̃j ṽj ,

J∑
j=1

P̃j ṽj

〉)

.
J∑

j=0

〈
S̃hP̃j ṽj , P̃j ṽj

〉
,

where we have used the fact that the support of P̃j ṽj lies only on a bounded number
of subdomains. Since Pj ṽj = QΓP̃j ṽj , we have that Pj ṽj ∈ Vh(Γ) is identical with
P̃j ṽj ∈ Ṽh(Γ) on Γ. Using the minimizing property (4.2), it follows that〈

S̃hP̃j ṽj , P̃j ṽj
〉

= ã(P̃j ṽj , P̃j ṽj) ≤ ã(Pj ṽj , Pj ṽj)(4.17)
= ã(PΓEjvj , PΓEjvj) ≤ CU a(PΓEjvj , PΓEjvj),

where in the last line we have used (4.12) and Assumption 2.1.
In the next step, we will relate a(PΓEjvj , PΓEjvj) to aj(vj , vj). Using the triangle

inequality and Lemma 4.5 for w = Ejvj and u = Ejvj − PΓEjvj , we obtain

a(PΓEjvj , PΓEjvj) =
J∑

k=1
ak(PΓEjvj , PΓEjvj)

≤
J∑

k=1

(
ak(Ejvj , Ejvj) + ak(Ejvj − PΓEjvj , Ejvj − PΓEjvj)

)
.

J∑
k=1

ak(Ejvj , Ejvj) + [1 + ln(H/h)]2
J∑

k=1
ak(Ejvj , Ejvj).(4.18)

For j = 0, we have

a(PΓE0v0, PΓE0v0) .
J∑

k=1
ak(v0, v0) + [1 + ln(H/h)]2

J∑
k=1

ak(v0, v0)(4.19)

. [1 + ln(H/h)]2
J∑

k=1
ak(v0, v0).

For j = 1, . . . , J , (4.18) implies that

a(PΓEjvj , PΓEjvj) . aj(vj , vj) + [1 + ln(H/h)]2aj(vj , vj)(4.20)
. [1 + ln(H/h)]2aj(vj , vj).

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3449

Using (4.19), (4.20), Assumption 2.1 (for j = 0), and Assumption 2.3 (for j =
1, . . . , J), we find that

a(PΓEjvj , PΓEjvj) . [1 + ln(H/h)]2 aj(ṽj , ṽj)(4.21)

≤
1

min{C`, CL}
[1 + ln(H/h)]2 ãj(ṽj , ṽj)

=
1

min{C`, CL}
[1 + ln(H/h)]2

〈
S̃j ṽj , ṽj

〉
.

Here we have a slight abuse of notation with a0(·, ·) =
∑J

k=1 ak(·, ·) and ã0(·, ·) =∑J
k=1 ãk(·, ·).
Inequality (4.11) then follows from (4.15), (4.16), (4.17), and (4.21).
Combining Theorems 4.3 and 4.7, we obtain the following main result.
Theorem 4.8. There exists a positive constant C, independent of h, H, J , CU,

CL, and C`, such that

κ(B̃BDDCSh) =
λmax(B̃BDDCSh)
λmin(B̃BDDCSh)

≤ C
(CU)2

CL min{C`, CL}

(
1 + ln

H

h

)2
.

We have claimed that the well-posedness of the perturbed BDDC does not depend
on the choice of constraints or the type of partition utilized. However, as Theorems
4.7 and 4.8 rely on the validity of Lemma 4.5, the choice of constraints still plays an
important role in achieving a good rate of convergence. The essential condition in the
proof of Lemma 4.5 is that for any object G, it is either in the set of constraints C or
there is an acceptable path connecting a list of subdomains associated with G. In the
next step, we will study what will happen if that condition does not hold.

Lemma 4.9. Assume that there are not enough constraints in C for (4.8) to hold
with subdomain index j, for some 1 ≤ j ≤ J . Then, with the perturbed bilinear forms
suggested in section 3, we still have the following, weaker, estimate:

|uj |2H1(Ωj) . [1 + ln(H/h)]
2 (D/H)m

∑
k∈Nj

ãk(wk, wk),(4.22)

where m = n, the dimension of the physical space, if the Robin perturbation is used;
otherwise, m = 2.

Proof. From the definition of PΓ in (2.10), we can write that

(4.23) u(x) =
∑

k∈N (x)

1
|N (x)|

(wj(x)− wk(x)) ∀x ∈ Γ ∩ ∂Ωj ,

where N (x) = {k : x ∈ Γk = Γ ∩ ∂Ωk}.
We cut uj using θV , θE , and θF and write it as a sum of terms which are only

nonzero on individual subdomain corners, edges, and faces, respectively, i.e.,

(4.24) uj =
∑
V⊂∂Ωj

θVuj +
∑
E⊂∂Ωj

Ih(θEuj) +
∑
F⊂∂Ωj

Ih(θFuj).

For simplicity, we only present the estimate for the face terms. Let F be the face

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3450 SANTIAGO BADIA AND HIEU NGUYEN

shared between subdomains Ωj and Ωk. From (4.23) and Lemma 4.2, we find that

‖Ih(θFuj)‖2
H

1/2
00 (F)

=
∥∥∥∥Ih(θF 12 (wj − wk))

∥∥∥∥2
H

1/2
00 (F )

. [1 + ln(Hj/hj)]2
(
|wj |2H1/2(F) +

1
Hj
‖wj‖2L2(F) + |wk|

2
H1/2(F) +

1
Hk
‖wk‖2L2(F)

)
.

Similar estimates for the edge and vertex terms can be obtained from the proof of
[38, Lemma 10] or [49, Lemma 6.36] with some modification. Summing all of the
estimates for individual objects, it follows that

(4.25) |uj |2H1(Ωj) . [1 + ln(H/h)]
2
∑

k∈Nj

(
|wk|2H1/2(Γk) +

1
H
‖wk‖2L2(Γk)

)
.

Since wk is a harmonic function w.r.t. ak(·, ·), we have |wk|H1/2(Γk) = ak(wk, wk).
In addition, when the perturbation with the full mass matrix is used, we note that
H‖wk‖2L2(Γk) ≤ ‖wk‖

2
L2(Ωk). Consequently, (4.25) and (3.1) imply that

|uj |2H1(Ωj) . [1 + ln(H/h)]
2
∑

k∈Nj

(
ak(wk, wk) +

1
H2
‖wk‖2L2(Ωk)

)
≤ [1 + ln(H/h)]2 (D/H)2

∑
k∈Nj

ãk(wk, wk).(4.26)

In case Robin perturbation is used, from (4.25) and (3.2), we have

|uj |2H1(Ωj) ≤ [1 + ln(H/h)]
2 (D/H)n

∑
k∈Nj

ãk(wk, wk).(4.27)

Combining (4.26) and (4.27), we obtain (4.22).
Theorem 4.10. If the perturbed bilinear forms introduced in section 3 are used,

even in the extreme case where there is no constraint in C, we still have

λmax(B̃BDDCSh) .
CU

CL min{C`, CL}
(D/H)m [1 + ln(H/h)]2 =: λ̂M,(4.28)

κ(B̃BDDCSh) ≤ C (D/H)m
(

1 + ln
H

h

)2
,(4.29)

where C does not depend on the mesh sizes, the size of the domain and subdomains,
or the number of subdomains.

Proof. The proof is a combination of Theorem 4.3, which does not depend on the
choice of C, and a modified version of the proof of Theorem 4.7 where Lemma 4.9 is
used instead of Lemma 4.5.

Remark 4.11. Theorem 4.10 gives a bound for the condition number of the pre-
conditioned system in the case when no constraint is used. We can see that the bound
increases as the number of subdomains increases. Even though the perturbed precon-
ditioner without constraints is well-posed, it is not a scalable one, like any one-level
DD method.

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3451

For the rest of this section, we will study a more practical case where the set
of constraints C fails to eliminate a small number of piecewise constant functions or
rigid-body modes from the BDDC space. In other words, we consider kerSc 6= ∅
and dim(kerSc) � dim(Vh(Γ)), where Sc : Hc → H′c is the counterpart of S̃c in the
standard formulation of the BDDC method, namely

(4.30) 〈Scu, v〉 =
J∑

i=1
aj(uj , vj) ∀u, v ∈ Hc, uj = u|Ωj , vj = v|Ωj .

Theorem 4.12. Assume that kerSc 6= ∅; then the spectrum of the preconditioned
system, counting multiplicities, can be decomposed as

(4.31) σ(B̃BDDCSh) = S1 ∪ S2,

where |S1| ≤ dim(ker(Sc)), S1 ⊂ [λm, λ̂M ], and S2 ⊂ [λm, λM ]. Here, the constants
λm, λM, and λ̂M are defined in Theorems 4.3, 4.7, and 4.10, respectively.

Proof. For the sake of brevity, we will use B̃ and S to refer to B̃BDDC and Sh,
respectively. We define V0 = PΓ ker(Sc). Then Vh(Γ) can be decomposed as

(4.32) Vh(Γ) = V0 ⊕S V ⊥0 , i.e., 〈Sv0, v
⊥
0 〉 = 0, ∀v0 ∈ V0, v

⊥
0 ∈ V

⊥
0 .

Define ((·, ·)) := 〈B̃−1·, ·〉, an inner product on Vh(Γ). Clearly, B̃S is SPD w.r.t. ((·, ·)).
In addition, for any v0 ∈ V0 and v⊥0 ∈ V ⊥0 ,

(4.33) ((B̃Sv⊥0 , v0)) = ((B̃Sv0, v
⊥
0 )) = 〈Sv0, v

⊥
0 〉 = 0.

Let B1 = {φ1, . . . , φn1} and B2 = {φn1+1, . . . , φn1+n2} be some bases of V0 and V ⊥0 ;
then B = {φ1, . . . , φn1+n2} is a basis of Vh(Γ). Let A be the matrix representation of
B̃S w.r.t. the basis B. From (4.33), we have

(4.34) ((BSφj , φi)) = ((BSφi, φj)) = 0 for n1 + 1 ≤ j ≤ n1 + n2, 1 ≤ i ≤ n1.

As the jth column of A is the coefficient in the representation of B̃Sφj w.r.t. B,
(4.34) implies that A is a block diagonal matrix and A = diag(A1,A2), where A1

and A2 are the matrix representations of B̃S|V0 and B̃S|V ⊥0 w.r.t. the bases B1 and
B2, respectively. This leads to σ(A) = σ(A1) ∪ σ(A2). Consequently,

σ(B̃S) = σ(B̃S|V0) ∪ σ(B̃S|V ⊥0 ).

Since dim(V0) ≤ dim(ker(Sc)), it follows that

|σ(B̃S|V0)| ≤ dim(ker(Sc)).

As Theorems 4.3 and 4.10, where the lower bound and a weak upper bound of σ(B̃S)
are obtained, hold regardless of the choice of C, the proof is finished if we can show
that

(4.35) λmax(B̃S|V ⊥0 ) ≤ λM.

Since B̃S is symmetric positive definite w.r.t. ((·, ·)), it follows that

(4.36) λmax(B̃S|V ⊥0 ) = maxv∈V ⊥0 , v 6=0
((B̃Sv, v))

((v, v))
= max

v∈V ⊥0 , v 6=0

〈Sv, v〉
〈B̃−1v, v〉

.

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3452 SANTIAGO BADIA AND HIEU NGUYEN

Since V ⊥0 does not contain the piecewise constant functions in the case of Poisson’s
equation or any of the subdomain rigid-body modes in the case of linear elasticity,
the results in Lemma 4.5 and Theorem 4.7 hold, and we have the estimate (4.35) for
the largest eigenvalue of B̃S|V ⊥0 .

Remark 4.13. When the constraints in C fail to eliminate a small number of con-
stant functions or rigid-body modes, i.e., ker(Sc) 6= ∅ and dim(ker(Sc))� dim(Vh(Γ)),
Theorem 4.12 indicates that most of the eigenvalues of the preconditioned system can
still be bounded by the usual bounds in the standard BDDC methods. Some of the
remaining eigenvalues might be larger than the usual upper bound. However, they
are isolated (the number of them is bounded from above by dim(ker(Sc))). As large
isolated eigenvalues can only delay the convergence of the CG method by a few iter-
ations (cf. [2]), the perturbed BDDC method is still scalable. Obviously, the number
of iterations will be higher than in the case in which all the piecewise constant func-
tions or all the rigid-body modes are eliminated from the BDDC space by additional
constraints, since one considers a smaller coarse space.

5. Numerical experiments. In this section, we will study several numerical
experiments to verify the robustness as well as the efficiency of the perturbed BDDC
method.

The perturbed formulation is built on top of the BDDC preconditioner in the
scientific computing software package FEMPAR (FE Multiphysics massively PARal-
lel) [4], a parallel hybrid MPI+OpenMP, object-oriented framework for the massively
parallel FE simulation of multiscale multiphysics problems governed by PDEs [6, 7].
All our experiments were run on MareNostrum III at BSC (Barcelona) and HLRN-III
at RRZN (Hannover).

In our experiments, both the standard and the perturbed BDDC preconditioners
with different options of constraints are used to solve the linear system associated with
(1.5) by the CG method. The number of CG iterations and the time (in seconds) to
reduce the residual by at least a factor of 1e-6 will be reported. Here, time includes
both the set-up time and the iterative solver time.

In presenting the data, C, E, and F legends indicate that corner, edge, and face
constraints are used, respectively. The suffix 0 expresses that the standard BDDC
formulation (no perturbation) is used. The suffix CD emphasizes that the corner
selection algorithm in [48] and the standard BDDC formulation are used. If the legend
is without a suffix, then it represents a result with perturbed BDDC formulation and
no corner selection algorithm is involved.

In addition, we present only results for Robin perturbation. Perturbation with a
full mass matrix yields almost identical results (see [11]).

5.1. Poisson’s equation in a cube. In this experiment, we compare the per-
formance of the perturbed and standard BDDC methods for a Poisson equation dis-
cretized by structured meshes. We consider the problem described in (1.1), where Ω
is the unit cube [0, 1]× [0, 1]× [0, 1]. The right-hand side function f is chosen so that
u = x+ y + z is the analytical solution.

We use uniform structured hexahedral meshes which are partitioned into k× k×
k, k = 3, . . . , 11, subdomains of exactly the same shape by regular partitions. In
order to study the weak scalability of the methods, when k increases (the size of the
subdomains, H, decreases), we use smaller mesh size, h, to keep H/h constant, i.e., a
constant local problem size.

Figure 1 shows the weak scalability in CG iteration (the left column), and in time

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3453

 8

 10

 12

 14

 16

 18

 0  200  400  600  800  1000  1200  1400  1600  1800

N
u
m

b
e
r 

o
f 
P

C
G

 i
te

ra
ti
o
n
s

#cores

Weak scaling (H/h=10)

CEF

CEF0

CE

CE0

CF

CF0

E

EF

F
 0

 0.05

 0.1

 0.15

 0.2

 0.25

 0.3

 0.35

 0  200  400  600  800  1000  1200  1400  1600  1800

T
o
ta

l 
W

a
ll
 c

lo
c
k
 t
im

e
 (

s
e
c
s
.)

#cores

Weak scaling (H/h=10)

CEF

CEF0

CE

CE0

CF

CF0

E

EF

F

 8

 10

 12

 14

 16

 18

 20

 22

 0  200  400  600  800  1000  1200  1400  1600  1800

N
u
m

b
e
r 

o
f 
P

C
G

 i
te

ra
ti
o
n
s

#cores

Weak scaling (H/h=20)

CEF

CEF0

CE

CE0

CF

CF0

E

EF

F
 0.5

 0.55

 0.6

 0.65

 0.7

 0.75

 0.8

 0.85

 0.9

 0  200  400  600  800  1000  1200  1400  1600  1800

T
o
ta

l 
W

a
ll
 c

lo
c
k
 t
im

e
 (

s
e
c
s
.)

#cores

Weak scaling (H/h=20)

CEF

CEF0

CE

CE0

CF

CF0

E

EF

F

 8

 10

 12

 14

 16

 18

 20

 22

 24

 0  200  400  600  800  1000  1200  1400  1600  1800

N
u
m

b
e
r 

o
f 
P

C
G

 i
te

ra
ti
o
n
s

#cores

Weak scaling (H/h=30)

CEF

CEF0

CE

CE0

CF

CF0

E

EF

F
 2.8

 3

 3.2

 3.4

 3.6

 3.8

 4

 4.2

 4.4

 4.6

 0  200  400  600  800  1000  1200  1400  1600  1800

T
o
ta

l 
W

a
ll
 c

lo
c
k
 t
im

e
 (

s
e
c
s
.)

#cores

Weak scaling (H/h=30)

CEF

CEF0

CE

CE0

CF

CF0

E

EF

F

 0

 1000

 2000

 3000

 4000

 5000

 6000

 7000

 8000

 0  200  400  600  800  1000  1200  1400

N
u
m

b
e
r 

o
f 
D

O
F

s

#cores

Size of coarse space

CEF

CEF0

CE

CE0

CF

CF0

E

EF

F

Fig. 1. Poisson’s equation in a cube.

(the right column). Three different test cases, namely H/h = 10, 20, 30, are reported.
The figure also presents (in the last row) the sizes of the coarse spaces, which depends
only on the partition.

From Figure 1, we can conclude that the perturbed BDDC method, for all the

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3454 SANTIAGO BADIA AND HIEU NGUYEN

proposed choices of constraints, is weakly scalable; namely, the numbers of iterations
are almost constant when the number of subdomains increases. The performance of
the perturbed BDDC method in both iteration number and time is also very close to
that of the standard BDDC method. In this experiment, compared to the standard
method, the perturbed BDDC method only requires at most one extra iteration to
reduce the residual to the same relative tolerance of 1e-6.

On the different choices of constraints, we can reconfirm that corner constraints
do not contribute much to the convergence of the methods as EF, E, F have the same
number of iterations as CEF, CE, CF, and have almost the same number of iterations
as CEF0, CE0, CF0, respectively. The choices without corner constraints (which
need perturbation to be well-posed) always outperform the corresponding choices
with corner constraints in terms of time whether perturbation is used or not. In
terms of iteration number, the choices with larger coarse spaces (cf. the last rows of
Figure 1) generally require fewer iterations, except among the ones with E and F.
Obviously, the performance in time depends not only on the choices of constraints
but also on the ratio H/h.

In order to understand the time performance, it is important to note that the
BDDC method has fine tasks (solving local Neumann problems, computing the contri-
bution to the coarse matrix, computing the fine corrections, etc.), which are performed
in parallel on each processor, and a coarse task (computing the coarse correction),
which is centralized in one processor. Roughly speaking, the fine tasks become more
expensive (in both computation and communication) when the size of local problem
(also the ratio H/h) increases, and the cost of coarse task rises when the size of the
coarse space becomes larger. In the advanced implementation of BDDC methods in
FEMPAR (cf. [7]), these two types of tasks run in parallel and are overlapped in run
time. As long as the run time of the coarse task can be completely overlapped by the
run time of the fine tasks, perfect weak scalability is attained.

For H/h = 10, the local problems are small and the coarse tasks are clearly
dominant. The options with large coarse spaces require more time even though they
use fewer iterations (the overlapping is not effective). In those situations, in order
to make the overlapping approach effective, a multilevel BDDC method would be
required [9]. For H/h = 30, the local problems are reasonably large, and the fine
tasks dictate the time performance. The performance in terms of time resembles
the performance in iteration number in this test case. The options with large coarse
spaces arrive to the solution in shorter time. For H/h = 20, at first, the fine tasks
are dominant. However, as the number of subdomains increases, the size of the
coarse space increases. We can see that the coarse task becomes more and more
significant and eventually dominant for the options with larger coarse spaces, namely
CEF, CEF0, CE, and CE0. We will come back to this in the experiment for linear
elasticity.

5.2. Poisson’s equation in backward facing step domain. In this exper-
iment, we compare the performance of the perturbed BDDC with standard BDDC
for a Poisson equation discretized by unstructured meshes. We consider the problem
described in (1.1), where Ω is the backward facing step domain depicted in Figure 2.
Solutions for this type of problem are required in numerical simulations of (turbulent)
incompressible flows using the pressure segregation techniques [23, 3].

For this problem, a homogeneous Dirichlet boundary condition is set on the whole
boundary of Ω except for the leftmost face, where the unknown is constrained to be
1. We also set the force term f = cos(4πx) cos(4πy) cos(4πz).

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3455

Fig. 2. Three-dimensional backward facing step domain with unstructured tetrahedral mesh and
its partition into 64 subdomains using METIS.

 10

 12

 14

 16

 18

 20

 22

 24

 26

32 64 128 256 512 1024

N
u
m

b
e
r 

o
f 
P

C
G

 i
te

ra
ti
o
n
s

#cores

Weak scaling (local problem size = 145K)

CEF

CEF0

E

EF

F
 0.4

 0.6

 0.8

 1

 1.2

 1.4

 1.6

 1.8

32 64 128 256 512 1024

T
o
ta

l 
w

a
ll
 c

lo
c
k
 t
im

e
 (

s
e
c
s
.)

#cores

Weak scaling (local problem size = 145K)

CEF

CEF0

E

EF

F

4000

 8000 

12000

16000

20000

64 128 256 512 1024

N
u
m

b
e
r 

o
f 
c
o
a
rs

e
 D

O
F

s

#cores

Size of coarse space

CEF

CEF0

E

EF

F

Fig. 3. Poisson’s equation with backward facing step domain.

For this experiment, starting from four unstructured tetrahedral meshes with
roughly 20K, 40K, 80K, and 160K elements, we use uniform refinements and METIS
[26] to create a set of meshes with 32, 64, 128, 256, 512, and 1024 subdomains. The
number of nodes in each subdomain is kept roughly around 145K.

In Figure 3, we plot the numbers of iterations, elapsed time, and number of coarse
degrees of freedom (DOFs) over the number of subdomains (#cores). As results are
close for different options of constraints, for better visibility, we show only the ones
for CEF0, CEF, EF, E, and F.

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3456 SANTIAGO BADIA AND HIEU NGUYEN

From Figure 3, we can see that even though the iteration count for each option
is bounded when the number of subdomains increases, all of them vary more than in
the experiment in subsection 5.1, where structured meshes and regular partitions are
used. However, as all of the partitions are created by METIS [26], we can control only
the local problem size—not the shape and size of the subdomains or the ratio H/h.
Taking this into account, we can safely say that each of the considered options of the
constraints yields a scalable BDDC variant. In addition, the performance of perturbed
BDDC (with CEF) is very close to that of the standard BDDC (with CEF0) in both
iterations count and time. All options without corners (EF, E, and F), which are only
available for the perturbed BDDC, work and have favorable performance in time.

5.3. Elasticity of a long beam. In this experiment, we compare the perfor-
mance of the perturbed and standard BDDC methods for the linear elasticity prob-
lem in (1.2) with the Lamé parameters λ = 0.1 and µ = 1.0 and the body force
f = [0.0 -0.005 0.0]T .

Let Ω be the long beam [0, 2] × [0, 0.5] × [0, 0.5]. We use the natural boundary
condition on the whole boundary of Ω except on one side (the plane x = 0), where
the homogeneous Dirichlet boundary condition is imposed. We also use uniform
structured hexahedral meshes which are partitioned into 4k × k × k, k = 2, . . . , 11,
subdomains. Figure 4 shows the displacement of the beam (the solution).

Fig. 4. Linear elasticity—long beam: The displacement of the beam under the body force (right).

For this test problem, simply choosing the constraints associated with geometrical
objects as discussed in subsection 2.1 is not enough to make the standard BDDC
method work. We need to use a corner selection algorithm or switch to the perturbed
formulation. Among the possible options, we carry out the experiment for CEF,
CEF_CD, EF, and E.

Figure 5 shows the weak scaling in terms of iteration number (left column) and
time (right column), and the size of the coarse space (last row) for three different test
cases with H/h = 10, 20, 30.

The result for this problem is a reconfirmation of what we have found earlier for
the Poisson equation. From Figure 5, it is clear that all studied options of constraints
succeed in making the BDDC methods scalable. The numbers of iterations are almost
constant when the number of subdomains increases. The options with larger coarse
spaces require fewer iterations to converge. However, the time performance depends
on the size of local problems. For small local problems (H/h = 10), the coarse task
is dominant, and options with smaller coarse spaces perform better. For large local
problems (H/h = 30), the fine tasks dictate the result, and options with larger coarse

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3457

 16

 18

 20

 22

 24

 26

 28

 30

 32

 0  1000  2000  3000  4000  5000  6000  7000

N
u
m

b
e
r 

o
f 
P

C
G

 i
te

ra
ti
o
n
s

#cores

Weak scaling (H/h=10)

CEF

CEF_CD

EF

E

 0

 5

 10

 15

 20

 25

 0  1000  2000  3000  4000  5000  6000

T
o
ta

l 
w

a
ll
 c

lo
c
k
 t
im

e
 (

s
e
c
s
.)

#cores

Weak scaling (H/h=10)

CEF

CEF_CD

EF

E

 20

 22

 24

 26

 28

 30

 32

 34

 36

 38

 0  1000  2000  3000  4000  5000  6000  7000

N
u
m

b
e
r 

o
f 
P

C
G

 i
te

ra
ti
o
n
s

#cores

Weak scaling (H/h=20)

CEF

CEF_CD

EF

E

 0

 5

 10

 15

 20

 25

 30

 0  1000  2000  3000  4000  5000  6000

T
o
ta

l 
w

a
ll
 c

lo
c
k
 t
im

e
 (

s
e
c
s
.)

#cores

Weak scaling (H/h=20)

CEF

CEF_CD

EF

E

 25

 30

 35

 40

 45

 0  1000  2000  3000  4000  5000  6000  7000

N
u

m
b

e
r 

o
f 

P
C

G
 i
te

ra
ti
o

n
s

#cores

Weak scaling (H/h=30)

CEF

CEF_CD

EF

E

 40

 45

 50

 55

 60

 65

 0  1000  2000  3000  4000  5000  6000

T
o

ta
l 
w

a
ll
 c

lo
c
k
 t

im
e

 (
s
e

c
s
.)

#cores

Weak scaling (H/h=30)

CEF

CEF_CD

EF

E

 0

 20000

 40000

 60000

 80000

 100000

 120000

 0  1000  2000  3000  4000  5000  6000

N
u
m

b
e
r 

o
f 
c
o
a
rs

e
 D

O
F

s

#cores

 Size of coarse space

CEF

CEF_CD

EF

E

Fig. 5. Linear elasticity—long beam: Robin perturbation.

spaces converge to the solution in less time. For medium-size problems (H/h = 20),
the fine tasks are dominant for a small number of subdomains but eventually are
overtaken by the coarse task when the number of subdomains increases.

In conclusion, if time-to-solution is the ultimate goal, then it might not be optimal

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3458 SANTIAGO BADIA AND HIEU NGUYEN

to choose the constraints so that the number of iterations required is minimal. The
choices of constraints should be based on the size of local problems and the number
of subdomains used. Particularly, if one is interested in solving very large problems
with many processors, then the options with minimal coarse spaces, such as E or F,
are likely the winners. We emphasize that these two options are only available for the
perturbed BDDC method.

5.4. Poisson’s equation with heterogeneous coefficient. In this experi-
ment, we verify our claim in Remark 3.3 that the perturbed BDDC can be extended
to the case in which the diffusion coefficient is constant in each subdomain and varies
greatly from one subdomain to another.

We consider the problem described in (1.1), where Ω is the unit square [0, 1]×[0, 1].
The right-hand side function is f = 1. We consider structured triangular meshes and
their regular partitions into k × k, k = 5, 10, 15, subdomains. The ratio H/h is kept
constant at 10. The diffusion coefficient is defined by

log10(αj) = ρ ∗mod(j, 5)/4,

where j is the subdomain index, numbering first in the x-direction and then in the
y-direction. Figure 6 shows the coefficient and partition for the case k = 10 and ρ = 6.
Basically, we have alternating channels with different values of the coefficient.

Fig. 6. Partition and coefficient distribution in the heterogeneous coefficient experiment.

In Table 1, iteration numbers for the options CE0, CE, and E are shown when
ρ takes values in {2, 4, 6}. We can see that for all options, the number of iterations
is almost constant when the number of subdomains or ρ increases. In addition, the
performance of the perturbed BDDC method (CE) is almost the same as that of the
standard BDDC method (CE0).

Table 1
Iteration numbers required in the Poisson equation with heterogeneous coefficient.

k → 5 10 15

ρ CE0 CE E CE0 CE E CE0 CE E

2 11 11 14 11 12 15 11 12 16
4 11 12 15 12 12 16 12 12 16
6 12 12 16 12 12 17 12 12 17

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3459

5.5. Poisson’s equation with insufficient constraints. In this experiment,
we would like to verify Theorem 4.12 and Remark 4.13. We study the weak scalability
of the perturbed BDDC method when there are not enough constraints to exclude all
of the piecewise constant functions from the BDDC space. We repeat the experiment
in subsection 5.1 but with some floating subdomains, where no constraint is imposed.

 2

 4

 6

 8

 10

 12

 14

 16

 18

 20

 0  200  400  600  800  1000  1200  1400

N
u
m

b
e
r 

o
f 
P

C
G

 i
te

ra
ti
o
n
s

#cores

Weak scaling (H/h=10)

CEF: 0 floating subdomain

CEF: 1 floating subdomain

CEF: 2 floating subdomains

CEF: 3 floating subdomains
 4

 6

 8

 10

 12

 14

 16

 18

 20

 22

 0  200  400  600  800  1000  1200  1400

N
u
m

b
e
r 

o
f 
P

C
G

 i
te

ra
ti
o
n
s

#cores

Weak scaling (H/h=10)

CE: 0 floating subdomain

CE: 1 floating subdomain

CE: 2 floating subdomains

CE: 3 floating subdomains

Fig. 7. Poisson’s equation: Some floating subdomains with no constraint.

Figure 7 shows the iteration numbers required for the two options CEF and
CE when different sets of subdomains fail to have any constraint. For comparison,
original iteration numbers with all the constraints associated with these two options
being enforced are also shown. We can see that even though the iteration numbers
are higher than the original ones, they are almost constant when the number of
subdomains increases. In other words, scalability is maintained even when we do not
impose enough constraints to eliminate all of the piecewise constant functions from
the BDDC space. This is predicted in Theorem 4.12 and Remark 4.13.

5.6. Elasticity of a long beam with disconnected subdomains. In this
experiment, we study whether the perturbed BDDC method can maintain scalability
when there are disconnected subdomains in the partition. We work with the same
linear elasticity problem of the long beam described in the previous subsection. How-
ever, we consider a different partition of Ω into 8k×2k×2k, k = 1, . . . , 6, subdomains
where half of them consist of four disconnected parts. Figure 8 shows the partition
when k = 1 on the left and a close-up of one disconnected subdomain on the right.
For this experiment, the size of the local problem is the same as in the test case with
H/h = 20 and regular partition. However, due to the special partition, the size of
some of the subdomains are larger, and the ratio in this test case is H/h = 30.

For this experiment, even the corner detecting algorithm in [48] cannot make the
standard BDDC method work. On the other hand, the perturbed BDDC method not
only works but is also scalable (see Figure 9). This is even better than predicted in
Theorem 4.12 as in this case the number of rigid-body modes which are not eliminated
from the BDDC space is proportional to the number of subdomains. However, the
numbers of iterations increase compared to the test case H/h = 30 with regular
partition. When only few subdomains are disconnected, the increase in the number
of iterations is less significant.

5.7. Elasticity of a cross link. In the last experiment, we work with a more
realistic problem, where Ω is a mechanical object shown in Figure 10. With three un-
structured tetrahedral meshes, using uniform refinements and METIS [26], we create
5 meshes with 32, 89, 256, 711, and 2048 subdomains. For each mesh, the number of

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3460 SANTIAGO BADIA AND HIEU NGUYEN

Fig. 8. Linear elasticity—long beam: A partition with disconnected subdomains (left) and the
close-up of one of its disconnected subdomains (right).

 40

 45

 50

 55

 60

 0  1000  2000  3000  4000  5000  6000  7000

N
u

m
b

e
r 

o
f 

P
C

G
 i
te

ra
ti
o

n
s

#cores

Disconnected subdomains: Weak scaling (H/h=20) 

CEF

EF

E
 0

 50

 100

 150

 200

 250

 300

 350

 400

 450

 0  1000  2000  3000  4000  5000  6000  7000

T
o

ta
l 
w

a
ll
 c

lo
c
k
 t

im
e

 (
s
e

c
s
.)

#cores

Disconnected subdomains: Weak scaling (H/h=20)

CEF

EF

E

Fig. 9. Linear elasticity—long beam: Disconnected subdomains.

nodes in each subdomain is kept roughly the same at around 44K. The largest mesh
has more than 25M elements and 4M nodes. Out of the 2048 subdomains of this
mesh, one is disconnected.

Fig. 10. Linear elasticity—cross link: A mechanical object with a mesh and a partitioning.

In Figure 11, we plot the results for the choices of constraints associated with
CEF_CD, CEF, EF, E, and F. The standard BDDC with corner detection algorithm
[48] fails to handle the largest mesh where there is a disconnected subdomain. All
perturbed formulations (CEF, EF, E, and F) converge. Taking into account the fact
that only the local problem size is fixed and not the ratio H/h, all options except F

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3461

have the numbers of iterations bounded independently of the number of subdomains.
In other words, they are scalable. As expected, the method with only face constraints
(F) is not weakly scalable. This is due to the fact that with face constraints only, not
all rigid-body modes are fixed.

In terms of time, the options with smaller coarse spaces, namely EF, E, and F,
have better performance. The advantage in time of these options becomes more and
more significant when the number of subdomains increases. For the largest mesh,
even though the option with only face constraints requires many more iterations, it
is still the fastest option.

 0

 10

 20

 30

 40

 50

 60

32 89 256 711 2048

N
u
m

b
e
r 

o
f 
P

C
G

 i
te

ra
ti
o
n
s

#cores

Weak scaling (rtol=1e-6)

CEF_CD

CEF

E

EF

F 1

2

3

5

10

20

40

32 89 256 711 2048

T
o
ta

l 
w

a
ll
 c

lo
c
k
 t
im

e
 (

s
e
c
s
.)

#cores

Weak scaling (rtol=1.0e-06)

CEF_CD

CEF

E

EF

F

 0

 20000

 40000

 60000

 80000

 100000

32 89 256 711 2048

N
u
m

b
e
r 

o
f 
c
o
a
rs

e
 D

O
F

s

#cores

Size of coarse space

CEF_CD

CEF

E

EF

F

Fig. 11. Linear elasticity—cross link: Weak scaling test.

6. Concluding remarks. In this work, we have formulated and analyzed a per-
turbed BDDC method. The method is proved to be algorithmically weakly scalable.
It is also verified by numerical experiments to be as scalable and efficient as the stan-
dard method for the same set of coarse constraints. Moreover, it does not rely on the
constraints to guarantee the well-posedness and offers more freedom in choosing them.
Notably, the implementation with just face and/or edge constraints does not require
a change of basis for using sparse direct solvers for definite systems, and corner con-
straints and corner selection algorithms are not needed. These choices lead to small
coarse spaces that are ideal for extreme scale computation. But the main advantage
of the method is that the perturbed formulation brings extra robustness as it works
even when the constraints fail to eliminate a small number of rigid-body modes from
the BDDC space, or even when the partition has disconnected subdomains. This
point is of great importance when dealing with unstructured meshes and automatic
partitioners.

Even though our presentation is for problems with constant coefficients in each
subdomain, our work can be extended to problems with truly heterogeneous coeffi-

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3462 SANTIAGO BADIA AND HIEU NGUYEN

cients. It is known that for these problems, more complicated strategies are needed
to define the constraints; e.g., the perturbed formulation could also be combined with
other approaches, such as deluxe scaling [20], adaptive coarse spaces [46, 31, 28, 47],
and especially physics-based BDDC [10], to deal with heterogeneity of the coefficients.

The perturbation approach presented herein is a simple way to relax the roles of
corner constraints. Based on our analysis, any selection of constraints known to result
in a fast algorithm for the original problem would also result in a fast algorithm for the
perturbed problem. Thus, strategies for choosing constraints such as those in [36, 37]
could also be used in future work. On the other hand, the proof of Theorem 4.12
provides a way to rigorously analyze convergence properties of preconditioners with
local defects. Even though we have developed this theory for the case where constraints
do not fix all the rigid-body modes, it could also be applied to the analysis of fault-
tolerant (resilient) preconditioners. This topic is critical for the forthcoming exascale
supercomputers. These ideas will be further elaborated elsewhere.

Acknowledgments. We would like to thank the editor and the anonymous ref-
erees, whose suggestions helped improve the paper significantly. Finally, the authors
thankfully acknowledge the computer resources, technical expertise, and assistance
provided by the Red Española de Supercomputación and the North-German Super-
computing Alliance (HLRN).

REFERENCES

[1] S. Aluru and F. E. Sevilgen, Parallel domain decomposition and load balancing using space-
filling curves, in Proceedings of the 4th International Conference on High-Performance
Computing, IEEE, Washington, DC, 1997, pp. 230–235.

[2] O. Axelsson and G. Lindskog, On the rate of convergence of the preconditioned conju-
gate gradient method, Numer. Math., 48 (1986), pp. 499–523, https://doi.org/10.1007/
BF01389448.

[3] S. Badia and R. Codina, Algebraic pressure segregation methods for the incompressible
Navier-Stokes equations, Arch. Comput. Methods Engrg., 15 (2008), pp. 343–369, https:
//doi.org/10.1007/s11831-008-9020-3.

[4] S. Badia, A. F. Martín, and J. Principe, FEMPAR: Finite Element Multiphysics Massively
PArallel, https://web.cimne.upc.edu/groups/comfus/fempar.html.

[5] S. Badia, A. F. Martín, and J. Principe, Enhanced balancing Neumann-Neumann precondi-
tioning in computational fluid and solid mechanics, Internat. J. Numer. Methods Engrg.,
96 (2013), pp. 203–230, https://doi.org/10.1002/nme.4541.

[6] S. Badia, A. F. Martín, and J. Principe, Implementation and scalability analysis of balancing
domain decomposition methods, Arch. Comput. Methods Engrg., 20 (2013), pp. 239–262,
https://doi.org/10.1007/s11831-013-9086-4.

[7] S. Badia, A. F. Martín, and J. Principe, A highly scalable parallel implementation of bal-
ancing domain decomposition by constraints, SIAM J. Sci. Comput., 36 (2014), pp. C190–
C218, https://doi.org/10.1137/130931989.

[8] S. Badia, A. F. Martín, and J. Principe, On the scalability of inexact balancing domain
decomposition by constraints with overlapped coarse/fine corrections, Parallel Comput., 50
(2015), pp. 1–24, https://doi.org/10.1016/j.parco.2015.09.004.

[9] S. Badia, A. F. Martín, and J. Principe, Multilevel balancing domain decomposition at
extreme scales, SIAM J. Sci. Comput., 38 (2016), pp. C22–C52, https://doi.org/10.1137/
15M1013511.

[10] S. Badia and H. Nguyen, Physics-Based Balancing Domain Decomposition by Constraints
for Heterogeneous Problems, HAL:hal-01337968 [math.NA], 2016.

[11] S. Badia and H. Nguyen, Relaxing the Roles of Corners in BDDC by Perturbed Formulation,
HAL:hal-01337852 [math.NA], 2016.

[12] M. Bebendorf, A note on the Poincaré inequality for convex domains, Z. Anal. Anwendungen,
22 (2003), pp. 751–756, https://doi.org/10.4171/ZAA/1170.

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp

https://doi.org/10.1007/BF01389448
https://doi.org/10.1007/BF01389448
https://doi.org/10.1007/s11831-008-9020-3
https://doi.org/10.1007/s11831-008-9020-3
https://web.cimne.upc.edu/groups/comfus/fempar.html
https://doi.org/10.1002/nme.4541
https://doi.org/10.1007/s11831-013-9086-4
https://doi.org/10.1137/130931989
https://doi.org/10.1016/j.parco.2015.09.004
https://doi.org/10.1137/15M1013511
https://doi.org/10.1137/15M1013511
https://hal.archives-ouvertes.fr/hal-01337968
https://hal.archives-ouvertes.fr/hal-01337852
https://doi.org/10.4171/ZAA/1170


 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

BALANCING DOMAIN DECOMPOSITION BY PERTURBATION 3463

[13] S. C. Brenner, A functional analytic framework for BDDC and FETI-DP, in Domain De-
composition Methods in Science and Engineering XVII, U. Langer, M. Discacciati, D. E.
Keyes, O. B. Widlund, and W. Zulehner, eds., Lect. Notes Comput. Sci. Eng. 60, Springer,
Berlin, 2008, pp. 239–246, https://doi.org/10.1007/978-3-540-75199-1_27.

[14] S. C. Brenner and L. R. Scott, The Mathematical Theory of Finite Element Methods,
3rd ed., Texts Appl. Math. 15, Springer, New York, 2008, https://doi.org/10.1007/
978-0-387-75934-0.

[15] S. C. Brenner and L.-Y. Sung, BDDC and FETI-DP without matrices or vectors, Comput.
Methods Appl. Mech. Engrg., 196 (2007), pp. 1429–1435, https://doi.org/10.1016/j.cma.
2006.03.012.

[16] C. Chevalier and F. Pellegrini, PT-SCOTCH: A tool for efficient parallel graph ordering,
Parallel Comput., 34 (2008), pp. 318–331, https://doi.org/10.1016/j.parco.2007.12.001.

[17] Y.-H. De Roeck and P. Le Tallec, Analysis and test of a local domain-decomposition precon-
ditioner, in Proceedings of the 4th International Symposium on Domain Decomposition
Methods for Partial Differential Equations (Moscow, 1990), SIAM, Philadelphia, 1991,
pp. 112–128.

[18] C. R. Dohrmann, A preconditioner for substructuring based on constrained energy min-
imization, SIAM J. Sci. Comput., 25 (2003), pp. 246–258, http://doi.org/10.1137/
S1064827502412887.

[19] C. R. Dohrmann, An approximate BDDC preconditioner, Numer. Linear Algebra Appl., 14
(2007), pp. 149–168, https://doi.org/10.1002/nla.514.

[20] C. R. Dohrmann and O. B. Widlund, A BDDC algorithm with deluxe scaling for three-
dimensional H(curl) problems, Comm. Pure Appl. Math., 69 (2016), pp. 745–770, https:
//doi.org/10.1002/cpa.21574.

[21] M. Dryja, B. F. Smith, and O. B. Widlund, Schwarz analysis of iterative substructuring
algorithms for elliptic problems in three dimensions, SIAM J. Numer. Anal., 31 (1994),
pp. 1662–1694, https://doi.org/10.1137/0731086.

[22] M. Dryja and O. B. Widlund, Schwarz methods of Neumann-Neumann type for three-
dimensional elliptic finite element problems, Comm. Pure Appl. Math., 48 (1995), pp. 121–
155, https://doi.org/10.1002/cpa.3160480203.

[23] H. C. Elman, D. J. Silvester, and A. J. Wathen, Finite Elements and Fast Iterative
Solvers: With Applications in Incompressible Fluid Dynamics, 2nd ed., Numer. Math.
Sci. Comput., Oxford University Press, Oxford, UK, 2014, https://doi.org/10.1093/acprof:
oso/9780199678792.001.0001.

[24] C. Farhat, M. Lesoinne, P. Le Tallec, K. Pierson, and D. Rixen, FETI-DP: A dual-primal
unified FETI method—part I: A faster alternative to the two-level FETI method, Internat.
J. Numer. Methods Engrg., 50 (2001), pp. 1523–1544, https://doi.org/10.1002/nme.76.

[25] C. Farhat, M. Lesoinne, and K. Pierson, A scalable dual-primal domain decomposition
method, Numer. Linear Algebra Appl., 7 (2000), pp. 687–714, https://doi.org/10.1002/
1099-1506(200010/12)7:7/8<687::AID-NLA219>3.0.CO;2-S.

[26] G. Karypis and V. Kumar, A fast and high quality multilevel scheme for partitioning ir-
regular graphs, SIAM J. Sci. Comput., 20 (1998), pp. 359–392, https://doi.org/10.1137/
S1064827595287997.

[27] G. Karypis, K. Schloegel, and V. Kumar, ParMETIS: Parallel Graph Partitioning and
Sparse Matrix Ordering Library, Tech. report, Department of Computer Science and En-
gineering, University of Minnesota, Minneapolis, MN, 1997.

[28] H. H. Kim and E. T. Chung, A BDDC algorithm with enriched coarse spaces for two-
dimensional elliptic problems with oscillatory and high contrast coefficients, Multiscale
Model. Simul., 13 (2015), pp. 571–593, https://doi.org/10.1137/140970598.

[29] A. Klawonn, M. Lanser, and O. Rheinbach, Toward extremely scalable nonlinear domain
decomposition methods for elliptic partial differential equations, SIAM J. Sci. Comput., 37
(2015), pp. C667–C696, https://doi.org/10.1137/140997907.

[30] A. Klawonn, M. Lanser, and O. Rheinbach, FE2TI: Computational scale bridging for dual-
phase steels, in Parallel Computing: On the Road to Exascale, G. R. Joubert, H. Leather,
M. Parsons, F. Petersfe, and M. Sawyer, eds., Adv. Parallel Comput. 27, IOS Press, Ams-
terdam, 2016, pp. 797–806, https://doi.org/10.3233/978-1-61499-621-7-797.

[31] A. Klawonn, P. Radtke, and O. Rheinbach, FETI-DP methods with an adaptive coarse
space, SIAM J. Numer. Anal., 53 (2015), pp. 297–320, https://doi.org/10.1137/130939675.

[32] A. Klawonn and O. Rheinbach, A parallel implementation of dual-primal FETI methods for
three-dimensional linear elasticity using a transformation of basis, SIAM J. Sci. Comput.,
28 (2006), pp. 1886–1906, https://doi.org/10.1137/050624364.

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp

https://doi.org/10.1007/978-3-540-75199-1_27
https://doi.org/10.1007/978-0-387-75934-0
https://doi.org/10.1007/978-0-387-75934-0
https://doi.org/10.1016/j.cma.2006.03.012
https://doi.org/10.1016/j.cma.2006.03.012
https://doi.org/10.1016/j.parco.2007.12.001
http://doi.org/10.1137/S1064827502412887
http://doi.org/10.1137/S1064827502412887
https://doi.org/10.1002/nla.514
https://doi.org/10.1002/cpa.21574
https://doi.org/10.1002/cpa.21574
https://doi.org/10.1137/0731086
https://doi.org/10.1002/cpa.3160480203
https://doi.org/10.1093/acprof:oso/9780199678792.001.0001
https://doi.org/10.1093/acprof:oso/9780199678792.001.0001
https://doi.org/10.1002/nme.76
https://doi.org/10.1002/1099-1506(200010/12)7:7/8<687::AID-NLA219>3.0.CO;2-S
https://doi.org/10.1002/1099-1506(200010/12)7:7/8<687::AID-NLA219>3.0.CO;2-S
https://doi.org/10.1137/S1064827595287997
https://doi.org/10.1137/S1064827595287997
https://doi.org/10.1137/140970598
https://doi.org/10.1137/140997907
https://doi.org/10.3233/978-1-61499-621-7-797
https://doi.org/10.1137/130939675
https://doi.org/10.1137/050624364


 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Copyright © by SIAM. Unauthorized reproduction of this article is prohibited. 

3464 SANTIAGO BADIA AND HIEU NGUYEN

[33] A. Klawonn and O. Rheinbach, Inexact FETI-DP methods, Internat. J. Numer. Methods
Engrg., 69 (2007), pp. 284–307, https://doi.org/10.1002/nme.1758.

[34] A. Klawonn and O. Rheinbach, Robust FETI-DP methods for heterogeneous three dimen-
sional elasticity problems, Comput. Methods Appl. Mech. Engrg., 196 (2007), pp. 1400–
1414, https://doi.org/10.1016/j.cma.2006.03.023.

[35] A. Klawonn, O. Rheinbach, and O. B. Widlund, An analysis of a FETI–DP algorithm
on irregular subdomains in the plane, SIAM J. Numer. Anal., 46 (2008), pp. 2484–2504,
https://doi.org/10.1137/070688675.

[36] A. Klawonn and O. B. Widlund, Selecting constraints in dual-primal FETI methods for
elasticity in three dimensions, in Domain Decomposition Methods in Science and En-
gineering, Lect. Notes Comput. Sci. Eng. 40, Springer, Berlin, 2005, pp. 67–81, https:
//doi.org/10.1007/3-540-26825-1_5.

[37] A. Klawonn and O. B. Widlund, Dual-primal FETI methods for linear elasticity, Comm.
Pure Appl. Math., 59 (2006), pp. 1523–1572, https://doi.org/10.1002/cpa.20156.

[38] A. Klawonn, O. B. Widlund, and M. Dryja, Dual-primal FETI methods for three-
dimensional elliptic problems with heterogeneous coefficients, SIAM J. Numer. Anal., 40
(2002), pp. 159–179, https://doi.org/10.1137/S0036142901388081.

[39] A. Klawonn, O. B. Widlund, and M. Dryja, Dual-primal FETI methods with face con-
straints, in Recent Developments in Domain Decomposition Methods (Zürich, 2001), Lect.
Notes Comput. Sci. Eng. 23, Springer, Berlin, 2002, pp. 27–40, https://doi.org/10.1007/
978-3-642-56118-4_2.

[40] M. Lesoinne, A FETI-DP corner selection algorithm for three-dimensional problems, in Do-
main Decomposition Methods in Science and Engineering XIV, I. Herrera, D. E. Keyes,
O. B. Widlund, and R. Yates, eds., National Autonomous University of Mexico (UNAM),
Mexico City, Mexico, 2003, pp. 217–224.

[41] J. Li and O. B. Widlund, FETI-DP, BDDC, and block Cholesky methods, Internat. J. Numer.
Methods Engrg., 66 (2006), pp. 250–271, https://doi.org/10.1002/nme.1553.

[42] J. Li and O. B. Widlund, On the use of inexact subdomain solvers for BDDC algorithms,
Comput. Methods Appl. Mech. Engrg., 196 (2007), pp. 1415–1428, https://doi.org/10.
1016/j.cma.2006.03.011.

[43] J. Mandel, Balancing domain decomposition, Comm. Numer. Methods Engrg., 9 (1993),
pp. 233–241, https://doi.org/10.1002/cnm.1640090307.

[44] J. Mandel, C. R. Dohrmann, and R. Tezaur, An algebraic theory for primal and dual
substructuring methods by constraints, Appl. Numer. Math., 54 (2005), pp. 167–193, https:
//doi.org/10.1016/j.apnum.2004.09.022.

[45] J. Mandel, B. Sousedík, and C. Dohrmann, Multispace and multilevel BDDC, Computing,
83 (2008), pp. 55–85, https://doi.org/10.1007/s00607-008-0014-7.

[46] J. Mandel and B. Sousedík, Adaptive selection of face coarse degrees of freedom in the BDDC
and the FETI-DP iterative substructuring methods, Comput. Methods Appl. Mech. Engrg.,
196 (2007), pp. 1389–1399, https://doi.org/10.1016/j.cma.2006.03.010.

[47] C. Pechstein and C. R. Dohrmann, A Unified Framework for Adaptive BDDC, Tech. report
RICAM-Report 2016-20, Johann Radon Institute for Computational and Applied Mathe-
matics (RICAM), Austrian Academy of Sciences, Linz, Austria, 2016.

[48] J. Šístek, M. Čertíková, P. Burda, and J. Novotný, Face-based selection of corners in 3D
substructuring, Math. Comput. Simul., 82 (2012), pp. 1799–1811, https://doi.org/10.1016/
j.matcom.2011.06.007.

[49] A. Toselli and O. Widlund, Domain Decomposition Methods—Algorithms and Theory,
Springer Ser. Comput. Math. 34, Springer-Verlag, Berlin, 2005.

[50] X. Tu, Three-level BDDC in three dimensions, SIAM J. Sci. Comput., 29 (2007), pp. 1759–
1780, https://doi.org/10.1137/050629902.

D
ow

nl
oa

de
d 

01
/1

6/
17

 t
o 

5.
19

6.
89

.2
25

. R
ed

is
tr

ib
ut

io
n 

su
bj

ec
t 

to
 S

IA
M

 l
ic

en
se

 o
r 

co
py

ri
gh

t;
 s

ee
 h

tt
p:

//
w

w
w

.s
ia

m
.o

rg
/j

ou
rn

al
s/

oj
sa

.p
hp

https://doi.org/10.1002/nme.1758
https://doi.org/10.1016/j.cma.2006.03.023
https://doi.org/10.1137/070688675
https://doi.org/10.1007/3-540-26825-1_5
https://doi.org/10.1007/3-540-26825-1_5
https://doi.org/10.1002/cpa.20156
https://doi.org/10.1137/S0036142901388081
https://doi.org/10.1007/978-3-642-56118-4_2
https://doi.org/10.1007/978-3-642-56118-4_2
https://doi.org/10.1002/nme.1553
https://doi.org/10.1016/j.cma.2006.03.011
https://doi.org/10.1016/j.cma.2006.03.011
https://doi.org/10.1002/cnm.1640090307
https://doi.org/10.1016/j.apnum.2004.09.022
https://doi.org/10.1016/j.apnum.2004.09.022
https://doi.org/10.1007/s00607-008-0014-7
https://doi.org/10.1016/j.cma.2006.03.010
https://doi.org/10.1016/j.matcom.2011.06.007
https://doi.org/10.1016/j.matcom.2011.06.007
https://doi.org/10.1137/050629902

	Introduction
	Model problems

	Preconditioner formulation
	Constraints
	Perturbed BDDC preconditioner

	Choices of perturbed bilinear form
	Perturbation with full mass matrix
	Robin perturbation

	Convergence analysis
	Numerical experiments
	Poisson's equation in a cube
	Poisson's equation in backward facing step domain
	Elasticity of a long beam
	Poisson's equation with heterogeneous coefficient
	Poisson's equation with insufficient constraints
	Elasticity of a long beam with disconnected subdomains
	Elasticity of a cross link

	Concluding remarks
	References

