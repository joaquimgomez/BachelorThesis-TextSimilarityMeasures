



















































()


INTERNATIONAL JOURNAL FOR NUMERICAL METHODS IN FLUIDS
Int. J. Numer. Meth. Fluids 2015; 00:1–21
Published online in Wiley InterScience (www.interscience.wiley.com). DOI: 10.1002/fld

Residual-based stabilization of the finite element
approximation to the acoustic perturbation equations for low

Mach number aeroacoustics

Oriol Guasch1∗, Patŕıcia Sánchez-Mart́ın1, Arnau Pont2, Joan Baiges2, Ramon
Codina2

1GTM - Grup de recerca en Tecnologies Mèdia, La Salle, Universitat Ramon Llull, C/ Quatre Camins
2, 08022 Barcelona, Catalonia
2Universitat Politècnica de Catalunya, C/ Jordi Girona 1-3, Edifici C1, 08034 Barcelona, Catalonia

SUMMARY

The acoustic perturbation equations (APE) are suitable to predict aerodynamic noise in the
presence of a non-uniform mean flow. As for any hybrid computational aeroacoustics approach,
a first computational fluid dynamics simulation is carried out from which the mean flow
characteristics and acoustic sources are obtained. In a second step, the APE are solved to
get the acoustic pressure and particle velocity fields. However, resorting to the finite element
method (FEM) for that purpose is not straightforward. Whereas mixed finite elements satisfying
an appropriate inf-sup compatibility condition can be built in the case of no mean flow, i.e.,
for the standard wave equation in mixed form, these are difficult to implement and their good
performance is yet to be checked for more complex wave operators. As a consequence, strong
simplifying assumptions are usually considered when solving the APE with FEM. It is possible
to avoid them by resorting to stabilized formulations. In this work, a residual-based stabilized
FEM is presented for the APE at low Mach numbers, which allows one to deal with the APE
convective and reaction terms in its full extent. The key of the approach resides in the design of
the matrix of stabilization parameters. The performance of the formulation and the contributions
of the different terms in the equations are tested for an acoustic pulse propagating in sheared
solenoidal mean flow, and for the aeolian tone generated by flow past a two-dimensional cylinder.
Copyright c© 2015 John Wiley & Sons, Ltd.

Received . . .

KEY WORDS: Acoustics; Aeroacoustics; Stabilized FEM; VMS: Variational Multiscale; Finite
element; Subsonic

1. INTRODUCTION

In this work, a stabilized finite element method (FEM) is proposed to solve the acoustic
perturbation equations (APE). These equations can account for aerodynamic sound
propagation in areas with non-uniform mean flow. In particular, we will herein focus on
the low Mach number APE in [1], which are derived after source filtering the linearized
Euler equations (LEE) to get rid of the vorticity and entropy modes, while leaving the
acoustic ones.
The APE constitute a particular case of the so called hybrid methods in computational

aeroacoustics (CAA). These separate the computation of aerodynamic sound into two steps.

∗Correspondence to: 1oguasch@salleurl.edu, www.salle.url.edu/~oguasch

Copyright c© 2015 John Wiley & Sons, Ltd.

Prepared using fldauth.cls [Version: 2010/05/13 v2.00]

www.salle.url.edu/~oguasch


2 O. GUASCH, P. SÁNCHEZ-MARTÍN, A. PONT, J. BAIGES AND R. CODINA

In the first one, a computational fluid dynamics (CFD) simulation is carried out to obtain
the acoustic source terms from the aerodynamic velocity and pressure fields. In the second
one, the source terms are input into an acoustic wave operator. The latter can directly be,
for example, the standard linear wave equation in irreducible or mixed form, their convective
counterparts, or more complex operators like the ones involved in the LEE.
The best known hybrid approaches are those in the category of acoustic analogies, being

Lighthill’s the most celebrated one [2]. Lighthill’s analogy states the problem of aerodynamic
sound radiation into a quiescent medium as that of noise radiated by a distribution of
quadrupoles in free space. For low Mach number flows, Lighthill approximates the source of
sound by the double divergence of the Reynolds tensor, which is built from the products of
the components of the aerodynamic velocity vector. Other analogies place their emphasis
on the role of vorticity in the generation of sound [3, 4, 5]. Besides, it should be remarked
that the influence of rigid bodies within the flow on noise radiation was considered since
the birth of acoustic analogies (see [6]) and later generalized to flexible bodies in [7].
As long as one aims to compute aerodynamic sound propagation in non-quiescent flow

areas, convective and refraction effects have to be extracted from the acoustic source term
and included in the wave operator (see e.g., [8]). This led to the development of more
sophisticated analogies (see e.g., [9, 10]) and to alternatives such as the linearized Euler
equations (LEE) [11], or resorting to perturbation equations [1, 12]. As mentioned above,
in this work we will attempt at solving a low Mach number formulation of the APE in [1]
using FEM. Refraction effects will be neglected for simplicity.
The computation of aerodynamic sound in the second step of a hybrid CAA approach is

often performed by resorting to integral formulations, though FEM is also common if the
acoustic waves are to be computed at distances not too far from the source region. Most
aeroacoustic FEM works to date have dealt with Lighthill’s acoustic analogy, [13, 14, 15, 16],
yet convection effects have also been taken into account. In [17] the convective Helmholtz
equation flow was considered, while a mixed convection wave equation with uniform mean
flow was considered in [18] as a simplification of the second variant of the APE in [1].
The numerical difficulties associated to the FEM solution of the various wave operators

involved in CAA are of a very different nature. Whereas for the standard linear wave
equation for the acoustic pressure most efforts are placed on the time discretization schemes,
given that the spatial discretization presents no serious difficulties (the Laplacian is a well-
behaved operator), this is not the case for its Fourier transform, the Helmholtz equation. The
latter may become non-positive definite for large wavenumbers and the standard Galerkin
FEM approach fails to solve it. A large amount of stabilization strategies have been devised
to prevent the pollution error associated to the Helmholtz equation [19]. With regard to
mixed formulations like the APE, which involve both, the acoustic pressure and the acoustic
particle velocity, the situation becomes more intricate. In the case of no convection the
APE simply reduces to the wave equation in mixed form. The variational formulation of
the latter has to satisfy a compatibility inf-sup condition for the problem to be well posed,
which is not inherited by the standard Galerkin FEM approach to it. It therefore becomes
necessary to work with finite elements having different interpolations for the acoustic
pressure and velocity fields to avoid the appearance of spurious oscillations in the numerical
solution [20, 21, 22]. An alternative to circumvent the discrete inf-sup condition and consider
the same interpolation fields for the acoustic pressure and velocity is that of resorting to
stabilization strategies, such as the residual based multiscale methods [23, 24, 25]. These
were applied to the mixed wave equation in [26]. It was proved in [27] that the solution to
the problem is then bounded by the data in an energy norm that involves all additional
stabilization terms.
The situation worsens when one considers the presence of a mean flow. As far as the

authors know, it has not been checked yet whether the tailored finite elements for the mixed
wave equation could perform well in the presence of convection. Even if this was the case,
their implementation is not an easy task. Stabilized FEM offer a way out to these problems.

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



STABILIZED FEM FOR THE ACOUSTIC PERTURBATION EQUATIONS 3

A first simplification to the APE is that of assuming a uniform mean flow so that they reduce
to the convective mixed wave equation. As previously commented, this occurrence was
addressed in [18], where a stabilizing flux term (as in the discontinuous Galerkin method)
and a penalization term were incorporated in the formulation. However, in the case of a
non-uniform mean flow, not only the convective terms in the APE become more complex,
but one also has to deal with a reaction term. With regard to the former, analogous non-
uniform convective terms appear in the linearized modified Boussinesq equation for shallow
waters. The Galerkin FEM approach to it exhibits high frequency oscillations [28, 29]
that can be overcome by resorting to stabilization strategies [30, 31]. The same type
of instabilities are found when setting the wave equation in mixed form in an arbitrary
Lagrangian-Eulerian (ALE) frame of reference, to deal with wave propagation in moving
domains [32]. Stabilization strategies have been also applied to the LEE. In particular, the
discontinuous Galerkin and the stream upwind Petrov-Galerkin (SUPG) approaches were
tested in [33] to suppress the artificial growth of the Kelvin-Helmholtz instabilities in the
LEE (these instabilities are limited in real flows by non-linear effects). Furthermore, the
algebraic subgrid scale (ASGS) method in [17] was used to stabilize the standard Galerkin
FEM approach to the LEE in [34].
The contributions of this work are as follows. First, a residual-based stabilized FEM

is developed to solve a simplified version of the second variant of the APE equations
(see [1, 18]), that includes the effects of non-uniform convection and of the reaction term
due to the mean velocity gradient. As far as the authors know neither these effects had
been taken into account in previous FEM approaches to the APE, nor residual-based FEM
methods have been applied to them. Besides, the implemented stabilization strategy relies on
splitting the problem unknowns into large scales that can be resolved by the computational
mesh, and small scales whose effects onto the large scales have to be modelled. Its main
advantage is that equal degree of interpolation can be used for the acoustic pressure and
particle velocity fields. Yet, the key for the good performance of the method depends upon
the design of a proper matrix of stabilization parameters, which constitutes the second
main goal of the work. This is achieved through a Fourier analysis of the subscale equation
following the lines in [26, 31, 32]. Finally, the importance of the various terms in the analyzed
APE system is highlighted by means of some numerical examples. The latter reveal that
neglecting some of the terms to simplify the equations may result in significant deviations
in the wavefronts of the predicted aerodynamic sound.
The paper is organized as follows. In section 2, we disclose the APE equations, set them

in matrix form and work out their variational formulation. In section 3, we proceed to
discretization. The residual-based stabilized FEM approach is presented and the derivation
of the matrix of stabilization parameters is exposed in detail. The fully discretized numerical
scheme in time and space close the section. Two numerical examples are finally given in
section 4. These consist of two benchmark tests dealing with the wavefront propagation in
a solenoidal sheared mean flow and with the generation of an aeolian tone by flow past a
two-dimensional cylinder.

2. PROBLEM STATEMENT

2.1. An acoustic perturbation equation for low Mach numbers

Our starting point will be the acoustic perturbation equations (53)-(55) derived in [1], in
the particular case of only considering vortex sound for low Mach numbers and neglecting

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



4 O. GUASCH, P. SÁNCHEZ-MARTÍN, A. PONT, J. BAIGES AND R. CODINA

the linear coupling between acoustic and vorticity modes. These equations read

∂tρ
′+∇·(ρ′ū+ρ̄ua)=0, (1a)

∂tu
a+∇(ū·ua)+∇

(

pa

ρ̄

)

=0, (1b)

∂tp
a−c̄2∂tρ

′=−∂tp
h, (1c)

and are obtained from manipulation of the linearized Euler equations for the enthalpy
and velocity fields (the reader is referred to [1] for details). ∂t stands for the first order time
derivative and c̄ denotes the speed of sound. The above equations are based on the following
decompositions for the compressible velocity u, pressure p and density ρ,

u=ū+u′ with u′:=uh+ua, (2a)

p=p̄+p′ with p′:=ph+pa, (2b)

ρ=ρ̄+ρ′ with ρ′:=ρh+ρa. (2c)

In (1)-(2) an overbar indicates a time averaged mean quantity i.e., g(x):=

limT→∞(1/T )
∫ t0+T

t0
g(x,t)dt, with t0 standing for the initial time of the averaging process

and T for its total duration. The mean values are independent of t0 once the initial transients
of a simulation/measurement have been surpassed. Likewise, a prime g(x,t)′ denotes a
perturbation from the mean value. The velocity fluctuation u′ in (2a) becomes split into
two components, a hydrodynamic solenoidal perturbation uh and an irrotational acoustic
perturbation ua. Similarly, the pressure and density fluctuations p′ and ρ′ in (2b)-(2c)
consist of two terms, a hydrodynamic component ph and ρh responsible for the production
of pseudo-sound, and an acoustic component pa and ρa that will propagate as acoustic waves
outwards the source region.
Equation (1) can be further simplified assuming that neither the time averaged sound

speed nor the time averaged density have a spatial dependence, i.e., c̄ ≡ c0 and ρ̄ ≡ ρ0.
Moreover and given that we are dealing with low Mach flows, we can resort to an
incompressible computational fluid dynamics (CFD) simulation to compute the mean
hydrodynamic velocity ū and the hydrodynamic pressure ph. In such situation we get ∇·ū=0
and assuming p′=c20ρ

′, equation (1) simplifies to

1

ρ0c
2
0

∂tp
a+

1

ρ0c
2
0

ū·∇pa+∇·ua=−
1

ρ0c
2
0

∂tp
h−

1

ρ0c
2
0

ū·∇ph, (3a)

ρ0∂tu
a+ρ0 ū·∇u

a+∇pa+ρ0 u
a·∇ū=0. (3b)

Equation (3) constitutes the simplification proposed in [18] for the APE variant 2 in [1]. It
only involves the acoustic pressure and acoustic particle velocity as the problem unknowns.
In the present work we will extend the analysis in [18] by considering non uniform mean
velocity flows. Notice that the reaction term ρ0 u

a·∇ū does not vanish in such cases.

2.2. Differential matrix problem and variational formulation

It is possible to rewrite equations (3a) and (3b) in matrix form for convenience as

µ∂tU+Ai∂iU+SU=F , (4)

where the summation convention over repeated indexes is assumed hereinafter. The index
i will run from 1 to the number of spatial dimensions with ∂i standing for the first order

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



STABILIZED FEM FOR THE ACOUSTIC PERTURBATION EQUATIONS 5

spatial derivatives. The following vector and matrix identifications have been made

U=







pa

ua1
ua2
ua3






, F=







Q
f1
f2
f3






, µ=







µp 0 0 0
0 µu 0 0
0 0 µu 0
0 0 0 µu






, A1=







µpū1 1 0 0
1 µuū1 0 0
0 0 µuū1 0
0 0 0 µuū1






,

A2=







µpū2 0 1 0
0 µuū2 0 0
1 0 µuū2 0
0 0 0 µuū2






, A3=







µpū3 0 0 1
0 µuū3 0 0
0 0 µuū3 0
1 0 0 µuū3






,

S=







0 0 0 0
0 µu∂1ū1 µu∂2ū1 µu∂3ū1
0 µu∂1ū2 µu∂2ū2 µu∂3ū2
0 µu∂1ū3 µu∂2ū3 µu∂3ū3






. (5)

The parameters µp≡(ρ0c
2
0)

−1 and µu≡ρ0 satisfying c0=(µpµu)
−1/2 in (5) have been

introduced to ease the notation and ūi, i=1,2,3, designate the components of the time
averaged mean velocity vector. Note also that, for completeness, we have included the
possibility of an external force acting on the momentum equation by means of the
components fi.
Problem (4) is to be solved in a computational domain Ω whose boundary ∂Ω can be

considered to be made from the union of two disjoint sets: Γp where we will prescribe the
acoustic pressure and Γu where the normal component of the acoustic particle velocity is to
be imposed. For simplicity, we shall take homogeneous Dirichlet conditions on them in the
forthcoming expressions, i.e., pa=0 on Γp, t>0 and u

a·n=0 on Γu, t>0, with n standing for
the outward normal of the domain’s boundary. Equation (4) needs also to be suplemmented
with initial conditions pa(x,0)=pa0(x) and u

a(x,0)=ua0(x) in Ω.
Additionally, let us introduce the functional spaces Vp(Ω)={q∈H

1(Ω)|ū·∇q∈L2(Ω), q=
0 on Γp} and Vu(Ω)={v∈L

2(Ω)|∇·v∈L2(Ω),ū·∇v∈L2(Ω),v·n=0 on Γu} and use (f,g) to
denote the integral of the product of two arbitrary functions f and g, i.e., (f,g):=

∫

Ω
fgdΩ.

Analogously, for vector valued functions we will have (f ,g):=
∫

Ω
f⊤gdΩ. Next, consider a

test function q for the acoustic pressure and v for the acoustic velocity. The weak form
of (4) is found multiplying it by a vector test function V ≡[q,v]⊤ and integrating over the
computational domain Ω. Defining the spaces L(Ω)≡L2(Ω)×L2(Ω) and V(Ω)≡Vp(Ω)×Vu(Ω),
the problem becomes that of finding U≡[pa,ua]⊤∈C1([0,T ],L(Ω))∩C0([0,T ],V(Ω)) such that

(µ∂tU ,V )+(Ai∂iU ,V )+(SU ,V )=(F ,V ) ∀ V ∈V(Ω). (6)

3. NUMERICAL APPROXIMATION

3.1. Residual-based stabilized finite element method

The standard discretized conforming Galerkin FEM approach to solve problem (6) aims
at finding a finite element solution Uh∈C

1([0,T ],Lh(Ω)⊂L(Ω))∩C
0([0,T ],Vh(Ω)⊂V(Ω)) such

that

(µ∂tUh,Vh)+(Ai∂iUh,Vh)+(SUh,Vh)=(F ,Vh) ∀ Vh∈Vh(Ω). (7)

Here, Lh(Ω), Vh(Ω) represent finite dimensional spaces built from a finite element partition
{Ωe} of Ω. The index e ranges from 1 to the total number of elements nel in the
computational mesh. However, the Galerkin FEM formulation (7) is known to suffer from
numerical instabilities which can be overcome by resorting to a variational multiscale
stabilization approach. The latter basically consists in splitting the exact solution U into a
large component Uh that can be captured by the finite element computational mesh, plus

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



6 O. GUASCH, P. SÁNCHEZ-MARTÍN, A. PONT, J. BAIGES AND R. CODINA

a small component U ′, which cannot be resolved by the mesh. U ′ is usually referred to as
the subscale. The effects of the subscales onto the large scales have to be modeled. The
procedure to do so give rise to different stabilization methods.
Substituting U=Uh+U

′ into (6) results in two equations. The first one governs the
dynamics of the large scales and is given by

(µ∂tUh,Vh)+(µ∂tU
′,Vh)+(Ai∂iUh,Vh)+(Ai∂iU

′,Vh)+(SUh,Vh)+(SU
′,Vh)=(F ,Vh). (8)

To better appreciate the influence of the subscales in the large scale equation we can integrate
the convective term by parts presuming the subscales to be local and vanish at the inter-
element boundaries. This is not a strong assumption given that no exact values can be
found for the subscales; only their mean effects onto the large scales can be computed.
Furthermore, we will assume the subscales to be quasi-static, i.e., ∂tU

′≈0. This hypothesis
has proven valuable in previous stabilization works involving wave propagation phenomena,
see e.g. [17, 26, 31, 14, 32]. On the other hand, the implementation of time evolving
dynamic subscales has been considered, for example, in coupled problems involving the
incompressible Navier-Stoles equations [35, 36, 37]. Yet for simplicity dynamic subscales will
not be taken into account in this first work on stabilized FEM for the acoustic perturbation
equations, that being left for future developments. All this leads to the following expression
for equation (8),

(µ∂tUh,Vh)+(Ai∂iUh,Vh)+(SUh,Vh)

−(U ′,A⊤i ∂iVh)−(U
′,[∂iA

⊤

i ]Vh)+(U
′,S⊤Vh)=(F ,Vh). (9)

Notice that the first line in (9) contains the terms of the standard Galerkin approach in (7),
whereas the second line discloses the subscale stabilization terms. The term (U ′,[∂iA

⊤

i ]Vh)
in the second line plays the role of an additional reaction weighted by the subscales; yet as
seen from (5) this term automatically vanishes because we are considering solenoidal mean
flows.
On the other hand, the second equation driving the dynamics of U ′ has the expression

(µ∂tUh,V
′)+(Ai∂iUh,V

′)+(Ai∂iU
′,V ′)+(SUh,V

′)+(SU ′,V ′)=(F ,V ′), (10)

which corresponds to the L2-projection of µ∂tUh+Ai∂iUh+Ai∂iU
′+SUh+SU

′=F onto the
space of subscales. If we use P to denote this projection, (10) can be rewritten as

P(Ai∂iU
′+SU ′)=P [F−(µ∂tUh+Ai∂iUh+SUh)]=:Rh, (11)

where the residual Rh of the finite element approximation onto the subscale space has been
introduced. The goal of the residual-based stabilization approaches is to find an approximate
solution to (11), which yields an expression for U ′ that could be substituted in (9) resulting
in enhanced stabilization properties.
A standard option consists in taking the subscales proportional to the residual i.e., U ′=

τRh, which in our case, is analogous to saying that P(Ai∂iU
′+SU ′)≈τ−1U ′, see [26, 31, 32].

Here, τ stands for a symmetric, positive-definite matrix of stabilization parameters that has
to be determined. Once this has been done, U ′=τRh can be substituted into the large scale
equation (9) that becomes

(µ∂tUh,Vh)+(Ai∂iUh,Vh)+(SUh,Vh)

+(τP [F−(µ∂tUh+Ai∂iUh+SUh)],−Ai∂iVh+S
⊤
Vh)=(F ,Vh). (12)

Note that we have used the fact that the convective matrices Ai are symmetric in the above
expression. It is also to be remarked that the matrix of stabilization parameters τ is to be
computed elementwise. With regard to the projection operator P different options exist. In
the more classical ASGS (Algebraic Subgrid Scale) formulation, the projection is taken as

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



STABILIZED FEM FOR THE ACOUSTIC PERTURBATION EQUATIONS 7

the identity matrix over the space of finite element residuals, i.e., P=I. Alternatively, in the
OSS (Orthogonal Subgrid Scale) method the subscales are assumed to be orthogonal to the
finite element space and consequently, P=I−Πh, with Πh standing for the L

2-projection
onto the former [25, 35].

3.2. Dimensional rescaling considerations

To complete the stabilized formulation in (12), the crucial step of finding an appropriate
expression for the stabilizationmatrix τ remains to be done. However, before addressing such
an issue some considerations are to be made concerning the scalar products in the variational
formulations (5) and (12). The r.h.s (right hand side) of these equations involves products
of the type U⊤F=paQ+ua1f1+u

a
2f2+u

a
3f3 (see (5)). If we use [·] to denote a dimensional

group, it becomes necessary that [paQ]=[uai fi]. From the dimensions of the terms in the
r.h.s of (3) it can readily be checked that [paQ]=[uai fi]=MLT

−3, with M , L and T standing
for dimensions of mass, length and time respectively. Yet, when deriving an appropriate
expression for τ in the next subsection we will have to deal with products like F⊤F or
U⊤U , which are not dimensionally well defined. For instance, F⊤F=Q2+f21+f

2
2+f

2
3 but

[Q2] 6=[f2i ]. Similarly, U
⊤U=pa2+ua1

2+ua2
2+ua3

2 but again [pa2] 6=[uai
2]. Consequently, and as

quoted in [26, 31], it becomes necessary to rescale the original differential equations for these
products to make sense.
This is tantamount to introducing the weighting matrix M (see [26]),

M=







mp 0 0 0
0 mu 0 0
0 0 mu 0
0 0 0 mu






, mp:=

√

µu/µp=ρ0c0, mu:=
√

µp/µu=
1

ρ0c0
, (13)

to define the weighted scalar product F⊤MF≡|F |2
M

which can be shown to be
dimensionally correct given that [mpQ

2]=[muf
2
i ]=ML

−2T−3. Analogously, the inverse of
M can be used to correctly define the product U⊤M−1U≡|U |2

M−1
. That is so because

[m−1p p
a2]=[m−1

u
uai

2]=MT−3. Therefore, M and M−1 are the appropriate weighthing

matrices to define products between any two force vectors F⊤1 MF2 and unknowns
U⊤1 M

−1U2. We can also define an M -weighted product between two arbitrary matrices
B1 and B2 as B

⊤
1 MB2. The squared M -pointwise norm of a matrix B will be given by

|B|2
M

=sup{X⊤B⊤MBX}, ∀ X;|X|M−1=1. For regular enough force vector functions it is
also possible to introduce the following vector function M -weighted scalar products,

(U ,F )=

∫

Ω

U⊤FdΩ, (F1,F2)M :=

∫

Ω

F⊤1 MF2dΩ, (U1,U2)M−1 :=

∫

Ω

U⊤1 M
−1U2dΩ, (14)

whose induced norms are designated by ‖·‖, ‖·‖M and ‖·‖M−1 .

3.3. The matrix τ of stabilization parameters

A fruitful way to derive an expression for the matrix of stabilization parameters τ is
from the spatial Fourier transform of the subscale equation (11). To that purpose we
shall assume that the mean flow velocity and its derivatives are smoothly varying in
the size of a typical mesh element, Ωe, so that the matrices Ai and Scan be assumed
constant within Ωe. We can thus define the Fourier transform of an arbitrary function
f within Ωe as f̂ (k):=

∫

Ωe
f(x)exp[−i(k·x)/h]dΩe (see e.g., [25]). Hereafter, a hat symbol

will stand for Fourier transformed quantities and ki will denote the i-th component of
the wavenumber adimensionalized by the characteristic mesh size h. Identifying the linear
operator L :=Ai∂i+S, we can express equation (11) in the wavenumber domain as,

L̂ (k)Û ′=−i
1

h
kjAjÛ

′+SÛ ′=R̂h, (15)

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



8 O. GUASCH, P. SÁNCHEZ-MARTÍN, A. PONT, J. BAIGES AND R. CODINA

with squared M -norm

Û ′⊤L̂ (k)⊤ML̂ (k)Û ′=Û ′⊤
(

1

h2
klkjA

⊤

l MAj+2
i

h
kl[AlMS]A+S

⊤MS
)

Û ′=R̂⊤h MR̂h.

(16)

Here, [AlMS]A stands for the skew-symmetric part of A
⊤

l MS. The induced norm for the
residual (see (14)) fulfills

‖R̂h‖
2
M

=

∫

|R̂h|
2
M

dk=

∫

|L̂ (k)Û ′|2
M

dk≤

∫

|L̂ (k)|2
M

|Û ′|2
M−1

dk

=|L̂ (k0)|2
M

∫

|Û ′|2
M−1

dk=|L̂ (k0)|2
M

‖Û ′‖2
M−1

=ρ(L̂ (k0)⊤ML̂ (k0))‖Û ′‖2
M−1

≤
[

ρ
(

1

h2
k0l k

0
jA

⊤

l MAj

)

+ρ
(

2
i

h
k0l [AlMS]A

)

+ρ(S⊤MS)
]

‖Û ′‖2
M−1

, (17)

where the existence of a value of k0 that fulfils the equality in the second line is guaranteed by
the mean value theorem. In the third line we use the fact that the squaredM -pointwise norm
of the operator L (k0) is given by its corresponding spectral radius ρ(L̂ (k0)⊤ML̂ (k0)).
Herein, we understand ρ(B) to denote the spectral radius of an arbitrary matrix B
arising from the solution of the generalized eigenvalue problem BU=λM−1U , λ being
an eigenvalue. Finally, in the fourth line we use the fact that the spectral radius of the
sum of two matrices is bounded by the summation of the matrices’ individual spectral
radii. All spectral radii in that line will be shown to be real (note that [AlMS]A is totally
skew-symmetric and therefore has imaginary eigenvalues).
On the other hand, from the Fourier transform of the approximation for the subscales

U ′=τRh, we can get the bound

‖R̂h‖
2
M

≤|τ−1|2
M

‖Û ′‖2
M−1

. (18)

The combination of (17) and (18) provides one way to find an expression for the stabilization
matrix given that

ρ(τ−1Mτ−1)≤ρ
(

1

h2
k0l k

0
jA

⊤

l MAj

)

+ρ
(

2
i

h
k0l [AlMS]A

)

+ρ(S⊤MS). (19)

Bounds for the spectral radii in (19) are provided in Appendix A. From (19) and (A.14) it
follows

ρ(τ−1Mτ−1)≤
1

h2

(

C1+C2M

)2

+
1

h

C3
c0

|∇ū|F+
C4
c2
0

|∇ū|2F . (20)

Taking into account that |∇ū|∼O(ū/L)<<ū/h, with L standing for a characteristic lenght
of the domain, and redefining the constants in the expressions hereafter where appropriate,
we can check that the bound on the M -norm of the stabilization matrix behaves as

ρ(τ−1Mτ−1)<<
1

h2
[C1+C2O(M)+C3O(M

2)]. (21)

Note that the discarded term involving M2 in (A.8)-(A.9) would have given place to a
term ∼O(M3) in (21).
In order to get a simple expression for the stabilization matrix we may take it to be

diagonal, τ=diag(τp,τu,τu). Given that the scaling matrix M in (13) is also diagonal, it
follows that

Spec
M−1

(τ−1Mτ−1)=

{

(

mp
τp

)2

,

(

mu
τu

)2

,

(

mu
τu

)2
}

. (22)

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



STABILIZED FEM FOR THE ACOUSTIC PERTURBATION EQUATIONS 9

From (20) and the subsequent observation (21), it becomes clear that what we need from the
stabilization parameter is to provide a term depending on the mesh size like in the standard
mixed wave equation with no convection [26], a term to control the flow local mean velocity
ū, and a term that controls the mean velocity derivatives through |∇ū|2F . To get a rather
simple expression for the parameter fulfilling these requisites, our proposal is to equal every
eigenvalue of τ−1Mτ−1 in (22) to a term of the type [h−2(C1+C2ū/c0)

2+(C3|∇ū|F /c0)
2].

Direct generalization to the three dimensional case results in

τ=







τp 0 0 0
0 τu 0 0
0 0 τu 0
0 0 0 τu






with,

τp=
ρ0c

2
0h

[

(c0C1+C2|ū|)2+(C3h|∇ū|F )2
]1/2

,

τu=
h

ρ0

[

(c0C1+C2|ū|)2+(C3h|∇ū|F )2
]1/2

, (23)

where use has been made of the expressions for mp and mu in (13).
The matrix τ of stabilization parameters (23) has to be inserted into (12) to get the final

stabilized variational formulation proposed in this article. It only remains to find the values
of the constants C1, C2 and C3. This will be done by means of the numerical experiments
in Section 4.1. As regards the constants, it should be pointed out that there is a certain
tolerance for them, in the sense that one does not necessarily need to get their optimal
values as long as they are able to provide enough stabilization. For a given mesh size h, the
error may be larger or smaller depending on the particular values of the constants, but the
slope of the convergence curves will remain unchanged for a wide range of values, which is
what matters in fact.
Finally, note that in the case of no mean flow, ū=0, the stabilization parameters for the

standard wave equation in mixed form are recovered,

τp=Ch
√

µu/µp τu=Ch
√

µp/µu, (24)

with C standing for a constant (see [26]). Likewise, if there was no reaction term, S=0, the
factors |∇ū|2F would have not appeared in (23), and we would have recovered analogous
stabilization parameters to those found for the standard wave equation in mixed form in an
ALE framework [32], or for the equations of wave propagation in shallow waters [31].

3.4. Fully discrete problem

In the above developments, the time variable has been left continuous. To proceed to
the time discretization we have equally split the time interval [0 T ] into N steps 0<
t1<t2<...<tn<...<tN≡T with ∆t:=tn+1−tn denoting the time step size. Hereafter, gn will
stand for the evaluation of a time dependent function g(t) at tn=n∆t. Given that we
aim at computing the aeroacoustic field only at a few wavelengths form the acoustic
source region, a second order backward differentiation formula (BDF2) will prove accurate
enough for the time discretization of (12). Was it necessary to compute the acoustic field
at several tenth or hundred wavelengths from the source, a less dissipative numerical
scheme like the Crank-Nicholson or a higher-order one would prove better. Identifying
δtg

n+1:=(1/2∆t)(3gn+1−4gn+gn−1) allows one to write the time discrete version of (12)
as

(µδtU
n+1
h ,Vh)+(Ai∂iU

n+1
h ,Vh)+(SU

n+1
h ,Vh)

+(τP [F n+1−(δtU
n+1
h +Ai∂iU

n+1
h +SU

n+1
h )],−Ai∂iVh+S

⊤
Vh)=(F

n+1,Vh). (25)

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



10 O. GUASCH, P. SÁNCHEZ-MARTÍN, A. PONT, J. BAIGES AND R. CODINA

Figure 1. (a) Shear mean velocity profile and (b) resulting vector field for Cases 3 and 4.

If we choose the OSS approach for the stabilized spatial discretization it will follow that
P(δtUh)=0. This is so because Uh belongs to the finite element space and we are projecting
Uh onto the subscale space, which is precisely orthogonal to the latter space (remember
that P=I−Πh). The expanded fully discrete problem in time and space that results from
accounting for (5) in (25) and that has been implemented for the numerical examples in the
forthcoming section reads

1

ρ0c
2
0

(δtp
an+1

h ,qh)+
1

ρ0c
2
0

(ū·∇pa
n+1

h ,qh)+(∇·u
an+1

h ,qh)

+(τpP
[

Qn+1−
1

ρ0c
2
0

ū·∇pa
n+1

h −∇·u
an+1

h

]

,−
1

ρ0c
2
0

ū·∇qh−∇·vh)=(Q
n+1,qh), (26a)

ρ0(δtu
an+1

h ,vh)+ρ0(ū·∇u
an+1

h ,vh)+(∇p
an+1

h ,vh)+ρ0(u
an+1

h ·∇ū,vh)

+(τuP
[

−ρ0ū·∇u
an+1

h −∇p
an+1

h −ρ0u
an+1

h ·∇ū
]

,−ρ0ū·∇vh−∇qh+ρ0vh·∇ū)=0. (26b)

Finally, note that in order to get the final finite element matrix algebraic system we
simply need to substitute ph=

∑np
a=1N

a
pP

a, and uh=(
∑nu

b=1N
b
uU

b
x,
∑nu

b=1N
b
uU

b
y ,
∑nu

b=1N
b
uU

b
z )

⊤,
and their analogous for the test functions qh and vh in (26). In the preceding expressions
np and nu respectively stand for the total number of pressure and velocity nodes in the
domain. P a denote the unknown nodal pressure values and U bx, U

b
y , U

b
z the unknown nodal

velocity component values. Nap are the pressure shape functions and N
b
u the velocity shape

functions, which are taken equal in the forthcoming section on numerical examples.

4. NUMERICAL EXAMPLES

4.1. Wave propagation in solenoidal convective and shear mean flows

The purpose of this example is twofold. On the one hand it will allow one to check the
influence of the various terms appearing in the acoustic perturbation equations (3). On the
other hand, it will help determining the values of the constants C1, C2 and C3 appearing in
the stabilization parameters of (23). Throughout section 4, the units of all quantities will
be those of the SI system and will be not explicitly written.

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



STABILIZED FEM FOR THE ACOUSTIC PERTURBATION EQUATIONS 11

The example consists of a squared computational domain having dimensions Ω=
[−100,100]×[−100,100]. A time varying monopole source of strength,

Q=exp

[

−ln(2)
x2+y2

9

]

cos(ωt), (27)

has been placed at the origin (0,0) and generates acoustic waves of angular frequency ω=175.
The propagation of the acoustic waves will be analyzed for different solenoidal mean velocity
profiles ū in the domain. That will reveal the importance of the distinct APE terms in (3).
The cases that have been considered are:

• Case A.1: No mean flow, i.e., ū=0. In this case the APE reduce to the standard wave
equation in mixed form.

• Case A.2: A constant mean flow with ū=(70,0). The APE now reduce to the convective
wave equation in mixed form for uniform mean flows.

• Case A.3: A solenoidal shear mean flow with the profile plotted in Fig. 1a resulting
from equation (28) below. This corresponds to the convective wave equation in mixed
form for the case of a non-uniform mean flow. The reaction term ρ0 u

a·∇ū in (3b) is
not taken into account in the simulation.

• Case A.4: The shear mean flow of Case 3 but now considering the full APE in (3) with
all non-uniform convective and reaction terms included. This was the benchmark case
proposed in [1] to test several APE formulations.

To perform all the simulations for the cases above, the computational domain has been
discretized with an unstructured mesh of 87 616 triangular elements. This has resulted in
approximately nine elements per wavelength. Spurious reflections at the boundaries have
been avoided by means of a simple perfectly matched layer (PML) according to the model
in [38]. Two additional absorption terms αp and α∗u have been respectively added to the
equations (3a) and (3b). α is the attenuation coefficient and α∗:=(µu/µp)α. The attenuation
factor is set to zero within the computational domain Ω, while it has been set to α=0.0004
in the absorptive PML surrounding Ω. The width of the PML is 50. With regard to the
values of the physical parameters in (3), we have considered an air density of ρ0=1.14 and
a sound speed of c0=350. The shear mean velocity for Cases A.3 and A.4 is defined by (see
Fig. 1a),

ū(x,y)=(Ūtanh(2y/δ),0), (28)

where Ū is the maximal velocity with value Ū=70 (Mach number M=0.2) and δ=50 denotes
the shear-layer thickness. The resulting mean velocity vector field is plotted in Fig. 1b.
In what concerns time evolution, an incremental step of ∆t=7×10−4 has been chosen to
discretize the interval [0,0.5]. Finally, the values C1=100, C2=500 and C3=100000

2 have
been taken for the constants in the stabilization parameter (see below for a justification
on that choice). It is to be noted that the stabilization parameter dictates the critical time
step, △tcr=ρ0τu=(ρ0c

2
0)

−1τp of the simulation [39]. This has local values because it depends
on the characteristic mesh size, h, as well as on the mean velocity field u and its gradient
∇u, see (23). If we take the minimum value of △tcr over the computational domain, this
results in a CFL number of CCFL=△t/△tcr≃614. Instead, if we take an averaged value for
△tcr over the domain we get CCFL≃74. This reflects nothing but the well-known fact that
when using implicit methods one can use time step sizes significantly larger than the critical
time step.
The resulting acoustic pressure fields for Cases A.1-A.4 have been plotted in Fig. 2 at the

time instant t=0.5. As observed in Fig. 2a, the wavefronts simply consist of concentric circles
propagating outwards for Case A.1, because there is no mean velocity in the domain. We
thus recover the expected radiation pattern of a monopole source. When a uniform mean
flow is imposed moving from left to right in Case A.2 (Fig. 2b), the front waves travelling

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



12 O. GUASCH, P. SÁNCHEZ-MARTÍN, A. PONT, J. BAIGES AND R. CODINA

(a) (b)

(c) (d)

Figure 2. Acoustic pressure contours at time t=0.5. (a) Case A.1: No mean flow. (b) Case A.2:
Uniform mean flow. (c) Case A.3: Shear flow with reaction term excluded. (d) Case A.4: Shear

flow with reaction term included.

0 20 40 60 80 100
�400

�200

0

200

400

600

x=y [m]

p
 [
P

a
]

0 20 40 60 80 100
�400

�200

0

200

400

600

x [m]

p
 [
P

a
]

0 20 40 60 80 100
�400

�200

0

200

400

600

y [m]

p
 [
P

a
]

(a) (b) (c)

Figure 3. Pressure cuts at t=0.5 corresponding to Fig. 2. Case A.3 (dashed red), Case A.4:
(continuous blue). (a) x- axis. (b) y-axis. (c) x=y.

upstream get stretched and the wavelength diminishes, whereas the opposite effect takes
place for waves propagating downstream. Cases A.3 and A.4 serve to show the importance
of taking into account the reaction term in the APE. It is apparent from Figs. 2c and d that
if one was to simulate sound propagation in a shear flow, the use of a convective mixed wave
equation with non-uniform velocity (Case A.3) would lead to substantial differences when
compared to the predictions made by the full APE (Case A.4). These discrepancies might
be better appreciated by plotting the acoustic pressure along the positive x-axis, positive

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



STABILIZED FEM FOR THE ACOUSTIC PERTURBATION EQUATIONS 13

y-axis and along a diagonal cut x=y in the second quadrant of the subfigures Figs. 2c, d
(see respectively Figs. 3a, b and c where the dashed red line stands for Case A.3 and the
blue continuous line for Case A.4).
A plot showing the differences in wave propagation for Cases A.1-A.4 is that of Fig. 4. In

that figure we see the time evolution of the acoustic pressure tracked at an arbitrary point A
with coordinates xA=(49.6,−34.1). The differences in amplitudes and phases between cases
become again very visible. The zero pressure initial time steps correspond to the time it
takes for the first wavefront to travel from the origin, where the source is placed, to A.
Further, it is worthwhile noticing that the APE equations offer not only the possibility to

compute the acoustic pressure but also the acoustic particle velocity. In Fig. 5 we show the
x and y components of the velocity field at time t=0.5, corresponding to the case A.4. As
observed, the values of the velocity components are in clear agreement with the wavefront
propagation directions in Fig. 2d.
On the other hand, as mentioned above, the second goal of this section is to determine

the values of the constants C1, C2 and C3 in the stabilization parameters of (23). The
simulations just reported have been carried out following the numerical strategy in section
3.4, but the values for that constants were yet to be presented. Let us remark that for Case
A.1, C1 is the only constant playing a role given that ū=0. For Cases A.2 and A.3, C1
and C2 get involved but not C3 because the reaction term is not contemplated. Finally, all
constants are to be considered in Case A.4.
To find suitable values for the constants, we have compared the results of the stabilized

FEM simulations with those from a reference solution computed with a very fine mesh
of 420 585 elements. For such a fine mesh the contribution of the stabilization terms has
been checked to be almost negligible. To proceed we have chosen to compute the relative
L2-error between the computed acoustic pressure pa and that from the reference solution

pr. This is given by ε=‖pa−pr‖2/‖p
r‖2 with ‖p

a−pr‖2=
[

∫

Ωε
(pa−pr)2dΩε

]1/2

. The error is

computed in the subdomain Ωε⊂Ω so as not to contact the boundaries of Ω and avoid any
possible pollution that could stem from the performance of the PML. It is to be noted that
we could also have included the relative error for the acoustic velocity in the process, or
a weighted combination of relative errors for both, the acoustic velocity and the acoustic
pressure. However, given that usually in acoustic problems the latter is the main variable
of interest, we have focused on the acoustic pressure.
The value of the C1 constant was already established in [26], where it appeared in a slightly

different form. Given that for ū=0 the results from [26] are to be recovered, we have fixed
C1=100 to that purpose. The constant C2 has been selected focusing on Case A.3. For the

0 0.1 0.2 0.3 0.4 0.5
−200

−100

0

100

200

t [s]

p
 [
P

a
]

Figure 4. Comparison of the evolution of the pressure at point (49.6,−34.1) for Case A.1 (dashed
green), Case A.2 (dotted black), Case A.3 (dot-dashed red) and Case A.4 (continuous blue).

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



14 O. GUASCH, P. SÁNCHEZ-MARTÍN, A. PONT, J. BAIGES AND R. CODINA

(a) (b)

Figure 5. Acoustic velocity contours at time t=0.5 for Case A.4. (a) x-component (b) y-
component.

terms in the denominator of (23) to have similar influence, C2 should not surpass a value
of 2 000. Having a look at the relative error plot in Fig. 6a we observe that an appropriate
value for C2 is C2=500. Once fixed C1=100 and C2=500, we have resorted to Case A.4 to
adjust the constant C3. This constant should not exceed 150 000

2, and as observed from
Fig. 6b, the relative error get stabilized for C3≈100 000

2. As in most stabilized numerical
methods, once tuned, the constants C1=100, C2=500 and C3=100 000

2 are expected to have
a rather general character and therefore to apply to many other numerical examples. This
is so because the values of the constants do not significantly alter the convergence rate of
the solutions when refining the computational mesh (see e.g., [26, 32] among others). The
situation can be thought as being quite analogously to what happens when one changes one
computational mesh for another. The overall error of the solution will be different in both
meshes, yet the rate of convergence to the reference solution when refining them will be
kept unaltered.
To conclude this example, we show the acoustic pressure for the stabilized FEM and

reference solutions for the diagonal x=y of the domain in Fig. 7. As observed, almost no

0 500 1000 1500 2000

0.075

0.08

0.085

0.09

0.095

0.1

C2

E
r

0 0.5 1 1.5 2 2.5

x 10
10

0.075

0.08

0.085

0.09

0.095

0.1

C3

E
r

(a) (b)

Figure 6. Relative error of the stabilized FEM formulation dependence on the values of the
constants in the stabilization matrix. (a) Case 3: relative error dependence on C2. (b) Case 4:

relative error dependence on C3.

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



STABILIZED FEM FOR THE ACOUSTIC PERTURBATION EQUATIONS 15

0 20 40 60 80
−400

−200

0

200

400

600

x=y [m]

p
 [

P
a

]

0 20 40 60 80
−400

−200

0

200

400

600

x=y [m]

p
 [

P
a

]

(a) (b)

Figure 7. Reference acoustic pressure (blue line) versus stabilized FEM acoustic pressure (red
dashed line) for the domain diagonal taking C1=100, C2=500 and C3=100000

2 . (a) Case A.3. (b)
Case A.4.

differences can be appreciated. Yet, had we considered no stabilization at all, the Galerkin
FEM solution would have simply blown up in finite time, as appreciated in Fig. 8 for the
pressure evolution at point xA=(49.6,−34.1) of the domain.

4.2. Aeolian tone generated by a single cylinder

As a final numerical test, we will apply the stabilized FEM approach to the APE, to a more
complex situation. This consists in the classical problem of aeolian tone generation by flow
past a cylinder. From a physical point of view, the aeroacoustic problem of aeolian tones is
well-known and described in literature, see e.g., [40, 41] among many others. The problem
consists of a flow impinging on a cylinder. For a certain range of Reynolds numbers, a wake
of shedding vortices develops past the cylinder inducing lift fluctuating forces on it. That
results in the emission of acoustic waves, which exhibit a dipolar radiation pattern at the
acoustic far field. For low Mach numbers, the problem can be solved by first performing
an incompressible CFD simulation to extract the acoustic source terms and the mean flow,
which can then be inserted into the APE (3) to resolve the acoustic field. Our interest
in this example is that of showing again the role played by the convection and reaction

0 0.2 0.4 0.6 0.8 1
−300

−200

−100

0

100

200

300

t [s]

p
[P

a
]

Figure 8. Comparison of the evolution of the pressure at point (49.6,−34.1) for the non-stabilized
Galerkin FEM solution (dashed red line) and the stabilized FEM solution (continuous blue line).

The Galerkin FEM solution blows up.

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



16 O. GUASCH, P. SÁNCHEZ-MARTÍN, A. PONT, J. BAIGES AND R. CODINA

(a) (b) (c)

Figure 9. Acoustic pressure contours at time t=0.15. (a) Case C.1. (b) Case C.2. (c) Case C.3.

−10 −5 0 5 10

−50

0

50

x [m]

p
[P

a
]

−10 −5 0 5 10

−50

0

50

y [m]

p
 [
P

a
]

−10 −5 0 5 10

−50

0

50

x=y [m]

p
 [
P

a
]

(a) (b) (c)

Figure 10. Pressure cuts at t=0.15 corresponding to Fig. 9. Case C.1 (continuous blue), Case C.2
(dashed red line), Case C.3 (dashed-dot green line). (a) x- axis. (b) y- axis. (c) x=y.

terms of the APE in the generated aeroacoustic pressure. Consequently, no results will
be presented concerning the CFD simulation (they are rather standard and can be found
elsewhere e.g., [17, 14]).
In a nutshell and as regards the CFD computation, a two-dimensional cylinder with

diameter D=0.1 has been embedded in a squared computational domain of dimensions
ΩCFD=[−6,6]×[−6,6]with an impinging flow velocity, in Cartesian coordinates, of u0=(50,0)
(Mach number M≈0.14 for a sound speed of c0=350). The Reynolds number of the problem
is Re=ρ0|u0|D/µ=1 000, where µ denotes the air viscosity. The domain ΩCFD has been
meshed with 295 141 linear finite elements. The incompressible Navier-Stokes equations
have been solved for a time range of 0.15, using the second order BDF2 time marching
scheme with a time step of 9×10−5. The solution has resulted in the generation of a Von
Kármán vortex street, with vortices shed at a frequency of 120.

0.1 0.11 0.12 0.13 0.14 0.15
�50

0

50

t [s]

p
[P

a
]

0.1 0.11 0.12 0.13 0.14 0.15
�50

0

50

t [s]

p
 [
P

a
]

0.1 0.11 0.12 0.13 0.14 0.15
�50

0

50

t [s]

p
 [
P

a
]

(a) (b) (c)

Figure 11. Comparison of the evolution of the pressure for Case C.1 (continuous blue), Case C.2
(dashed red line) and Case C.3 (dashed-dot green line). (a) x1=(−0.2,5.8). (b) x2=(3.1,0). (c)

x3=(9,0).

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



STABILIZED FEM FOR THE ACOUSTIC PERTURBATION EQUATIONS 17

The APE have been resolved in a larger computational domain Ωac=[−12,12]×[−12,12],
ΩCFD⊂Ωac, using an unstructured mesh of 421 804 linear elements. The CFD and acoustic
meshes coincide in the domain ΩCFD. The values for the constants in the stabilization
parameters found in section 4.1 have been used for the simulations. Similarly to what has
been done in that subsection, the following three situations have been considered to establish
the influence of the various terms in the APE,

• Case C.1: No mean flow; the APE simplifies to the wave equation in mixed form. The
sources terms are obtained from the CFD computation.

• Case C.2: The APE using the mean flow and source terms from the CFD computation
but neglecting the reaction term. Namely, only non-uniform convection effects are
considered.

• Case C.3: The full APE taking into account non-uniform convection and reaction
terms.

In Fig. 9 we show the acoustic pressure contour levels at the far field for each case. As
observed from Fig. 9a, a clear dipole radiation pattern emerges with waves propagating
perpendicular to the incident inlet velocity, in Case C.1. However, when convection is taken
into account (Case C.2) the wavefronts propagate upstream (see Fig. 9b) as expected [17],
the effect being more pronounced if one includes reaction (Case C.3, Fig. 9c).
The differences in phase and amplitude among Cases C.1-C.3 can be also very clearly

appreciated if we plot one-dimensional cuts of the domain in the x, y and diagonal x=y
directions (see Fig. 10a, b and c). Again, this is also made apparent when plotting the
time evolution of the acoustic pressure at three arbitrary points located at x1=(−0.2,5.8),
x2=(3.1,0) and x3=(9,0), see Figs. 11a, b and c.

5. CONCLUSIONS

The FEM solution of wave operators in mixed form requires using tailored finite elements
that satisfy the discrete version of the continuous problem inf-sup condition. However, these
finite elements are difficult to implement and though valid for the wave equation in mixed
form, it has not been tested if they could work well for more complex operators, like the
ones in the acoustic perturbation equations for low Mach numbers.
In this work, we have suggested to circumvent that problem by resorting to a stabilizing

variational multiscale FEM formulation for the APE. The APE acoustic pressure and
acoustic particle velocity get split into large scales, which can be resolved by the
computational mesh and small scales whose influence onto the former has to be modelled.
A residual-based model has been chosen for that purpose, the key for its good performance
being the design of the matrix of stabilization parameters. The latter has been achieved
by setting the small scales equations in the wavenumber domain and using appropriate
inequality bounds for its norm as well as for the APE residual. The accomplishment of the
proposed strategy has been checked by means of some numerical examples involving wave
propagating in solenoidal non-uniform mean flows, involving convection and shear.

ACKNOWLEDGMENTS

This work is supported by EU-FET grant EUNISON 308874. The third author would like
also to acknowledge the Generalitat de Catalunya (SUR/ECO) for the predoctoral FI Grant
no. 2015 FI-B 00227. The fifth author acknowledges the support received from the Catalan
Government through the ICREA Acadèmia Research Program.

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



18 O. GUASCH, P. SÁNCHEZ-MARTÍN, A. PONT, J. BAIGES AND R. CODINA

APPENDIX A: BOUNDS ON THE ACOUSTIC PERTURBATION OPERATOR
SPECTRAL RADIUS

In this appendix bounds will be given for the spectral radii of the three terms in the r.h.s
of (19). Without loss of generality, results will be derived for the two dimensional case, their
extension to the three dimensional one being straightforward.
Taking into account the definitions of Ai in (5) and of the scaling matrix M in (13), the

matrix in the first term of (19) reads

1

h2
k0i k

0
jA

⊤

i MAj=
1

h2
×





mu|k
0|2+βp|k

0·ū|2 αk01(k
0·ū) αk02(k

0·ū)
αk01(k

0·ū) mp(k
0
1)

2+βu|k
0·ū|2 k01k

0
2mp

αk02(k
0·ū) k01k

0
2mp mp(k

0
2)

2+βu|k
0·ū|2



 (A.1)

with

α≡(mpµp+muµu), βp≡mpµ
2
p, βu≡muµ

2
u
. (A.2)

The spectrum of k0i k
0
jA

⊤

i MAj can be analytically worked out and is given by

Spec
M−1

(k0i k
0
jA

⊤

i MAj)=

{(

k0·ū

c0
+|k0|

)2

,

(

k0·ū

c0

)2

,

(

k0·ū

c0
−|k0|

)2}

. (A.3)

The spectral radius of
(

1

h2
k0l k

0
jA

⊤

l MAj

)

corresponds to the maximum eigenvalue

ρ
(

1

h2
k0l k

0
jA

⊤

l MAj

)

=
1

h2

(

k0·ū

c0
+|k0|

)2

≡
1

h2

(

C2|ū|

c0
+C1

)2

=
1

h2

(

C1+C2M

)2

, (A.4)

where M=|ū|/c0 stands for the flow local Mach number (do not confuse the scalar Mach
number M with the weighthing matrix M). Since k0 is an unknown dimensionless number,
we have taken k0·ū=|k0||ū|cosθ≡C2|ū| and |k

0|≡C1 in the r.h.s of (A.4), C1 and C2 being
dimensionless constants that have to be determined from numerical experiments.
Next, considering the expressions for Ai and S in (5) and for M in (13), we get for the

matrix in the second term of (19)

2
i

h
k0l [AlMS]A=

i

h
×





0 muµuk
0·∂1ū muµuk

0·∂2ū
−muµuk

0·∂1ū 0 −βuk
0·ū(∂1ū2−∂2ū1)

−muµuk
0·∂2ū βuk

0·ū(∂1ū2−∂2ū1) 0



. (A.5)

The spectrum of this matrix is given by

Spec
M−1

(2
i

h
k0l [AlMS]A)=

{

1

h

[

(c2+b2)+mud
2

]1/2

,0,−
1

h

[

(c2+b2)+mud
2

]1/2
}

, (A.6)

with

c2+b2=
1

c2
0

[

(k0·∂1ū)
2+(k0·∂2ū)

2

]

≤
1

c2
0

|k0|2|∇ū|2F ,

m2
u
d2=m2

u
βu(k

0·ū)2(∂1ū2−∂2ū1)
2≤

1

c4
0

|k0|2|ū|2(∂1ū2−∂2ū1)
2≤

1

c2
0

|k0|2M2|∇ū|2F , (A.7)

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



STABILIZED FEM FOR THE ACOUSTIC PERTURBATION EQUATIONS 19

|B|F denoting the Frobenius norm of an arbitrary matrix B. It follows that

c2+b2+m2
u
d2≤

1

c2
0

|k0|2|∇ū|2F (1+M
2)≤

2

c2
0

|k0|2|∇ū|2F , (A.8)

where we have considered that we are dealing with low Mach number flows and consequently
M<<1. The above results allow one to bound the spectral radius of 2 i

h
k0l [AlMS]A by

ρ
(

2
i

h
k0l [AlMS]A

)

≤
1

h

C3
c0

|∇ū|F , (A.9)

C3 denoting a dimensionless real constant.
Finally, the matrix in the third term of (19) reads

S⊤MS=





0 0 0
0 βu|∂1ū|

2 βu∂1ū·∂2ū
0 βu∂1ū·∂2ū βu|∂2ū|

2



, (A.10)

with spectrum

Spec
M−1

(S⊤MS)=

{

mu
2

[

(e+f)+
√

(e−f)2+4g2,0,
mu
2

[

(e+f)−
√

(e−f)2+4g2

}

, (A.11)

where

(e+f)=βu

[

(∂1ū)
2+(∂2ū)

2

]

≤βu|∇ū|
2
F ,

(e−f)2=β2
u

[

|∂1ū|
2−|∂2ū|

2

]2

≤β2
u
|∇ū|4F ,

4g2=4β2
u
(∂1ū·∂2ū)

2≤4β2
u
|∂1ū|

2|∂2ū|
2≤4β2

u
|∇ū|4F . (A.12)

Therefore, the spectral radius of S⊤MS can be bounded as

ρ(S⊤MS)≤C4muβu|∇ū|
2
F=

C4
c2
0

|∇ū|2F , (A.13)

with C4 denoting a large enough dimensionless real constant to be found again from
numerical experiments.
From (A.4), (A.9) and (A.13) we get

ρ
(

1

h2
k0l k

0
jA

⊤

l MAj

)

+ρ
(

2
i

h
k0l [AlMS]A

)

+ρ(S⊤MS)

≤
1

h2

(

C1+C2M

)2

+
1

h

C3
c0

|∇ū|F+
C4
c2
0

|∇ū|2F . (A.14)

REFERENCES

1. Ewert R, Schröder W. Acoustic perturbation equations based on flow decomposition via source
filtering. J. Comput. Phys. 2003; 188(2):365–398.

2. Lighthill MJ. On sound generated aerodynamically I. general theory. Proc. R. Soc. Lond. A 1952;
211(1107):564–587.

3. Powell A. Theory of vortex sound. J. Acoust. Soc. Am. 1964; 36(1):177–195.
4. Howe M. The generation of sound by aerodynamic sources in an inhomogeneous steady flow. J.

Fluid Mech. 1975; 67(03):597–610.
5. Möhring W. On vortex sound at low Mach number. J. Fluid Mech. 1978; 85(04):685–691.
6. Curle N. The influence of solid boundaries upon aerodynamic sound. Proc. R. Soc. Lond. A 1955;

231(1187):505–514.

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



20 O. GUASCH, P. SÁNCHEZ-MARTÍN, A. PONT, J. BAIGES AND R. CODINA

7. Williams JF, Hawkings DL. Sound generation by turbulence and surfaces in arbitrary motion. Phil.
Trans. Roy. Soc. A 1969; 264(1151):321–342.

8. Bailly C, Bogey C, Gloerfelt X. Some useful hybrid approaches for predicting aerodynamic noise.
C. R. Mec. 2005; 333(9):666–675.

9. Lilley G. On the noise radiated from a turbulent high speed jet, in Computational Aeroacoustics,
J.C. Hardin and M.Y. Hussaini (Eds.). Springer Verlag, 1993.

10. Goldstein M. A generalized acoustic analogy. J. Fluid Mech. 2003; 488:315–333.
11. Bailly C, Bogey C. Contributions of computational aeroacoustics to jet noise research and prediction.

Int. J. Comput. Fluid Dyn. 2004; 18(6):481–491.
12. Slimon SA, Soteriou MC, Davis DW. Development of computational aeroacoustics equations for

subsonic flows using a mach number expansion approach. J. Comput. Phys. 2000; 159(2):377–406.
13. Oberai AA, Roknaldin F, R Hughes TJ. Computation of trailing-edge noise due to turbulent flow

over an airfoil. AIAA J. 2002; 40(11):2206–2216.
14. Guasch O, Codina R. Computational aeroacoustics of viscous low speed flows using subgrid scale

finite element methods. J. Comput. Acoust. 2009; 17(3):309–330.
15. Kaltenbacher M, Escobar M, Becker S, Ali I. Numerical simulation of flow-induced noise using

LES/SAS and lighthill’s acoustic analogy. Int. J. Numer. Meth. Fluids 2010; 63(9):1103–1122.
16. Baiges J, Codina R. A variational multiscale method with subscales on the element boundaries for

the Helmholtz equation. Int. J. Numer. Meth. Engrg. 2013; 93(6):664–684.
17. Guasch O, Codina R. An algebraic subgrid scale finite element method for the convected helmholtz

equation in two dimensions with applications in aeroacoustics. Comput. Methods Appl. Mech. Engrg.
2007; 196(45–48):4672–4689.

18. Hueppe A, Kaltenbacher M. Spectral finite elements for computational aeroacoustics using acoustic
perturbation equations. J. Comput. Acoust. 2012; 20(02):1240 005.

19. Harari I. A survey of finite element methods for time-harmonic acoustics. Comput. Methods Appl.
Mech. Engrg. 2006; 195(13):1594–1607.

20. Bécache E, Joly P, Tsogka C. An analysis of new mixed finite elements for the approximation of
wave propagation problems. SIAM J. Numer. Anal. 2000; 37(4):1053–1084.

21. Bécache E, Joly P, Tsogka C. Fictitious domains, mixed finite elements and perfectly matched layers
for 2-D elastic wave propagation. J. Comput. Acoust. 2001; 9(3):1175–1201.

22. Bécache E, Joly P, Tsogka C. A new family of mixed finite elements for the linear elastodynamic
problem. SIAM J. Numer. Anal. 2002; 39(6):2109–2132.

23. Hughes T. Multiscale phenomena: Green’s function, the dirichlet-to-neumann formulation, subgrid
scale models, bubbles and the origins of stabilized formulations. Comput. Methods Appl. Mech.
Engrg. 1995; 127:387–401.

24. Hughes T, Feijóo G, Mazzei L, Quincy J. The variational multiscale method, a paradigm for
computational mechanics. Comput. Methods Appl. Mech. Engrg. 1998; 166:3–24.

25. Codina R. Stabilized finite element approximation of transient incompressible flows using orthogonal
subscales. Comput. Methods Appl. Mech. Engrg. 2002; 191:4295–4321.

26. Codina R. Finite element approximation of the hyperbolic wave equation in mixed form. Comput.
Methods Appl. Mech. Engrg. 2008; 197(13–16):1305–1322.

27. Badia S, Codina R, Espinoza H. Stability, convergence and accuracy of stabilized finite elements
methods for the wave equation in mixed form. SIAM J. Numer. Anal. 2014; 52:1729–1752.

28. Langtangen HP, Pedersen G. Computational models for weakly dispersive nonlinear water waves.
Comput. Methods Appl. Mech. Engrg. 1998; 160 (3-4):337–358.

29. Walkley M, Brezins,M. A finite element method for the two-dimensional extended Boussinesq
equations. Int. J. Numer. Meth. Fluids 2002; 39(10):865–885.

30. Hauke G. A symmetric formulation for computing transient shallow water flows. Comput. Methods
Appl. Mech. Engrg. 1998; 163 (1-4):111–122.

31. Codina R, González-Ondina J, Dı́az-Hernández G, Principe J. Finite element approximation of the
modified boussinesq equations using a stabilized formulation. Int. J. Numer. Meth. Fluids 2008;
57(9):1249–1268.

32. Guasch O, Arnela M, Codina R, Espinoza H. A stabilized finite element method for the mixed
wave equation in an ALE framework with application to diphthong production. Acta Acust. 2016;
102(1):94–106.

33. Rao, PP, Morris, P. A stabilized finite element method for the mixed wave equation in an ALE
framework with application to diphthong production. AIAA journal 2006; 44(7):1643–1652.

34. Iob, A, Arina, R, Schipani, C. Frequency-domain linearized Euler model for turbomachinery noise
radiation through engine exhaust. AIAA journal 2010; 48(4):848–858.

35. Codina R, Principe J, Guasch O, Badia S. Time dependent subscsales in the stabilized finite
element approximation of incompressible flow problems. Comput. Methods Appl. Mech. Engrg. 2007;
196(21–24):2413–2430.

36. Codina R, Principe J. Dynamic subscales in the finite element approximation of thermally coupled
incompressible flows. Int. J. Numer. Meth. Fluids 2007; 54:707–730.

37. Ávila M, Codina R, Principe J. Large eddy simulation of low mach number flows using a dynamical
and nonlinear finite element subgrid scale model. Comput. Fluids 2008; 57(9):1249–1268.

38. Takemoto H, Mokhtari P, Kitamura T. Acoustic analysis of the vocal tract during vowel production
by finite-difference time-domain method. J. Acoust. Soc. Am. 2010; 128(6):3724–3738.

39. Codina R, Zienkiewicz O. CBS versus GLS stabilization of the incompressible Navier-Stokes
equations and the role of the time step as stabilization parameter. Commun. Numer. Meth. Engrg.
2002; 18:99–112.

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld



STABILIZED FEM FOR THE ACOUSTIC PERTURBATION EQUATIONS 21

40. Howe MS. Acoustics of fluid-structure interactions. Cambridge university press, 1998.
41. Drazin P. Introduction to Hydrodynamic Stability. Cambridge Texts in Applied Mathematics,

Cambridge University Press, 2002.

Copyright c© 2015 John Wiley & Sons, Ltd. Int. J. Numer. Meth. Fluids (2015)
Prepared using fldauth.cls DOI: 10.1002/fld


	1 Introduction
	2 Problem statement
	2.1 An acoustic perturbation equation for low Mach numbers
	2.2 Differential matrix problem and variational formulation

	3 Numerical approximation
	3.1 Residual-based stabilized finite element method
	3.2 Dimensional rescaling considerations
	3.3 The matrix  of stabilization parameters
	3.4 Fully discrete problem

	4 Numerical examples
	4.1 Wave propagation in solenoidal convective and shear mean flows
	4.2 Aeolian tone generated by a single cylinder

	5 Conclusions
	Appendix A: Bounds on the acoustic perturbation operator spectral radius

