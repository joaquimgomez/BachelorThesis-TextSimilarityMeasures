






























































SIMP-ALL: A generalized SIMP method based on the topological derivative concept


Received: 15 March 2019 Revised: 21 May 2019 Accepted: 4 June 2019

DOI: 10.1002/nme.6140

R E S E A R C H A R T I C L E

SIMP-ALL: A generalized SIMP method based on the
topological derivative concept

A. Ferrer1,2

1Centre de Mathématiques Appliquées,
École Polytechnique, Université
Paris-Saclay, Palaiseau, France
2Centre Internacional de Mètodes
Numèrics en Enginyeria (CIMNE),
Campus Nord UPC, Barcelona, Spain

Correspondence
A. Ferrer, Centre de Mathématiques
Appliquées, École Polytechnique,
Université Paris-Saclay, 91128 Palaiseau,
France; or Centre Internacional de
Mètodes Numèrics en Enginyeria
(CIMNE), Campus Nord UPC, Edifici C-1,
c/Jordi Girona 1-3, 08034 Barcelona, Spain.
Email: aferrer@cimne.upc.edu

Funding information
European Union's Horizon 2020 research
and innovation programme, Grant/Award
Number: 712949; Agency for Business
Competitiveness of the Government of
Catalonia

Summary

Topology optimization has emerged in the last years as a promising research field
with a wide range of applications. One of the most successful approaches, the
SIMP method, is based on regularizing the problem and proposing a penaliza-
tion interpolation function. In this work, we propose an alternative interpolation
function, the SIMP-ALL method that is based on the topological derivative con-
cept. First, we show the strong relation in plane linear elasticity between the
Hashin-Shtrikman (H-S) bounds and the topological derivative, providing a
new interpretation of the last one. Then, we show that the SIMP-ALL interpo-
lation remains always in between the H-S bounds regardless the materials to
be interpolated. This result allows us to interpret intermediate values as real
microstructures. Finally, we verify numerically this result and we show the con-
venience of the proposed SIMP-ALL interpolation for obtaining auto-penalized
optimal design in a wider range of cases. A MATLAB code of the SIMP-ALL
interpolation function is also provided.

KEYWORDS

Hashin-Shtrikman bounds, SIMP, topological derivative, topology optimization

1 INTRODUCTION

In the recent years, topology optimization has become a research field by itself, not only because it arouses interest on
the scientific community but also because it provides successful solutions to industrial problems.1 Traditionally, topology
optimization seeks to design light-weight structural components without losing stiffness capabilities. In the last years, it
addresses other fields of applications with equally success. For that propose, several approaches have emerged in the last
decades.

Initially, topology optimization has been successfully addressed through regularization techniques. The SIMP method
represents probably the most celebrated strategy. The characteristic function, usually used to describe the weak (white)
and stiff (black) subdomains, is regularized allowing intermediate values, or in other words, allowing the presence of gray
areas. Frequently, this regularized representation of the characteristic is commonly named density function. Usually, the
challenge is to characterize the material properties of the intermediate values of the density function (gray areas). This
characterization is commonly described by an interpolation function. As referred in the work of Bendsøe and Sigmund,2
the SIMP method proposes a polynomial interpolation function that, in some cases, lies inside the Hashin-Shtrikman
(H-S) bounds. This could lead to gray areas that sometimes cannot be interpreted as microstructures. Additionally,
depending on the nature of the materials, the SIMP method could propose a weak interpolation penalization, and
consequently, large gray areas could appear.

This is an open access article under the terms of the Creative Commons Attribution License, which permits use, distribution, and reproduction in any medium, provided the
original work is properly cited.
© 2019 The Authors. International Journal for Numerical Methods in Engineering Published by John Wiley & Sons, Ltd.

Int J Numer Methods Eng. 2019;120:361–381. wileyonlinelibrary.com/journal/nme 361

https://doi.org/10.1002/nme.6140
https://orcid.org/0000-0003-1011-0230


362 FERRER

In this sense, novel projection methods have enabled promising black and white topologies.3 However, even not gray
areas appear when using projection method, the final topology could be significantly suboptimal since it is influenced by
the material properties provided by the corresponding interpolation. To circumvent this limitation and in order to fulfill
the H-S bounds, other interpolation functions have been also proposed. Some examples can be found in the works of
Stolpe and Svanberg4 and Dzierżanowski.5

Alternatively, due to the concept of shape derivative, shape optimization has also established as a reference strategy
to solve topology optimization problems. Usually, the domain is described through a level-set function that, in turn, is
advected using the shape derivate expression of the objective function. In this case, the shape derivative plays the role of
the velocity field in the Hamilton-Jacobi equation.6 Although the algorithm requires considering initial holes, which can
be increased and merged, resulting in new topologies during the iterations, the optimal shape presents no intermediate
values and is clearly defined in the boundary.

Likewise, topological derivative addresses topology optimization with the intention of not considering intermediate
values. The concept is based on studying the sensitivity of a functional when a circular (or ellipsoidal) inclusion of a
weak material is inserted in a stiff material (or vice-versa). Through an asymptotic expansion and after solving an exterior
problem, the obtained topological derivative closed formula certainly measures the adequacy or not of inserting in a
certain point a weak/stiff inclusion. This valued concept is frequently exploited by level-set algorithms. The pioneer work
of Amstutz and Andrä7 is a clear example. Other approaches can be found in the works of Allaire et al8 and Yamada et al.9

Additionally, we can find in the literature the discrete and evolutionary algorithms, like BESO,10 as a competitive alter-
native to solve the problem. Although high efficiency is not clear for large problems, significant progress is achieved due to
the increase of the available computational power. In the last years, other numerical techniques for decreasing the compu-
tational cost of topology optimization problems have been developed, like adaptive mesh refinement11 and polytree-based
adaptive polygonal finite element method.12

Although, at first sight, all the described approaches may seem very different, some connections have been observed
in the work of Amstutz13 for the case of the topological derivative and the SIMP method approach, especially when the
Poisson ratio of the stiff material is around 1∕3. The present work follows and generalizes the results of that work. The
first main result of the present work is to connect the topological derivative with the H-S bounds. This result allows us
to have a new physical interpretation of the topological derivative concept. Then, based on the topological derivative, we
propose the SIMP-ALL interpolation. Apart of being free of heuristic parameters, we show, as the second main result of
this work, that it always remains in between the H-S bounds regardless the stiff and weak materials properties we want
to interpolate. This result provides us a physical interpretation in terms of microstructures when using the SIMP-ALL
interpolation. Note that proposing an interpolation strategy is convenient when the characteristic functions appears inside
the differential operator. When this is not the case, no interpolation is needed, see for example, the work of Sá et al.14

To validate the results, different cases are presented to compare SIMP-ALL with the SIMP interpolation functions and
their relation with the H-S bounds. Finally, some numerical examples are computed to see the influence and convenience
of the interpolation function on the optimal topologies. Additionally, a MATLAB code of the SIMP-ALL interpolation is
provided.

This work is organized as follows. Section 2 presents the bimaterial topology optimization problem. Section 3 introduces
the concept of the topological derivative and presents the topological derivative for isotropic materials in terms of the shear
and bulk modulus. H-S bounds are briefly presented in Section 4 and connected with the topological derivative. The special
kind of rational functions used in this work is defined in Section 5, and the SIMP-ALL interpolation function is presented
in Section 6. Section 7 includes a comparison between SIMP and SIMP-ALL in relation with the H-S bounds. Additionally,
some numerical examples are computed to observe the influence of the interpolation functions in the optimal topologies.
The present work concludes in Section 8.

2 TOPOLOGY OPTIMIZATION FORMULATION

2.1 The exact topology optimization problem
Let Ω be a fixed domain split into Ω1 and Ω0 with enough regularity, fulfilling Ω1 ∪ Ω0 = Ω and Ω1 ∩ Ω0 = ∅. Let the
boundary of Ω be defined as Γ ∶= 𝜕Ω and split into ΓD and ΓN and let the spaces  , , and  be defined as

 ∶= {𝜙 ∈ H1(Ω) ∶ 𝜙|ΓD = u0} , ∶= {𝜙 ∈ H1(Ω) ∶ 𝜙|ΓD = 0} , and  ∶= L∞(Ω, {0, 1}). (1)



FERRER 363

Then, let us define the characteristic function 𝜒 ∈  and the fourth-order tensor C(𝜒) as

𝜒(x) =

{
0 x ∈ Ω0
1 x ∈ Ω1

and C(𝜒) = (1 − 𝜒)C0 + 𝜒C1. (2)

The constitutive tensors C0 and C1 in plane stress linear elasticity are defined as

C1 = 2𝜇1I + (𝜅1 − 𝜇1)I ⊗ I and C0 = 2𝜇0I + (𝜅0 − 𝜇0)I ⊗ I, (3)

where I and I represents the fourth- and second-order identity tensors and𝜅1, 𝜇1 and𝜅0, 𝜇0 are the bulk and shear modulus
of the material in Ω1 and in Ω0, respectively. Introducing the bilinear and linear form of the linear elasticity problem as

a(𝜒,u, v) = ∫Ω∇
su ∶ C(𝜒) ∶ ∇su and l(v) = ∫ΓN

t · v, (4)

the exact topology optimization problem can be then defined as follows: find 𝜒 ∈  and u ∈  such that
min.
𝜒,u

J(𝜒,u) = l(u)
s.t. ∫Ω𝜒 ≤ V

a(𝜒,u, v) = l(v) ∀v ∈  ,
(5)

where, in this case, the cost J(𝜒,u) stands for the compliance function.

2.2 The relaxed topology optimization problem
The difficulties of solving the exact problem are usually circumvented by proposing a relaxed version of it, this is by
replacing the characteristic function with a density-like function 𝜌(x) ∈ [0, 1], which, in contrast with the characteristic
function, can take intermediate values. Thus, the exact topology optimization problem can be rewritten as the following
regularized topology optimization problem: find 𝜌 ∈  = L∞(Ω, [0, 1]) and u ∈  such that

min.
𝜌,u

J(𝜌,u) = l(u)
s.t. ∫Ω𝜌 ≤ V

a(𝜌,u, v) = l(v) ∀v ∈  ,
(6)

where the bilinear and linear form are now defined as

a(𝜌,u, v) = ∫Ω∇
su ∶ C(𝜌) ∶ ∇su and l(v) = ∫ΓN

t · v. (7)

In this case, the constitutive tensor takes the following form:

C(𝜌) = 2𝜇(𝜌)I + (𝜅(𝜌) − 𝜇(𝜌))I ⊗ I, (8)

where 𝜇(𝜌) ∈ C∞([0, 1], [𝜇0, 𝜇1]) and 𝜅(𝜌) ∈ C
∞([0, 1], [𝜅0, 𝜅1]) are interpolation functions that must be proposed.

Computation of the compliance gradient. Let the compliance function l(u) be defined as in (7) and let u ∈  be
the solution of the elasticity problem defined in (6), then the gradient of the compliance takes the following form:

g(𝜌) = −∇su ∶ C′(𝜌) ∶ ∇su, (9)

where C′(𝜌) is the derivative of the constitutive tensor defined in (8). To see this result, let us define the implicit function
F(𝜌) as

F(𝜌) = a(𝜌,u(𝜌), v) − l(v) = 0 ∀v ∈  , (10)



364 FERRER

and let us compute its differential. From ellipticity arguments,15 we can state that ∀ v ∈  and ∀𝜌 ∈  that provides a
coercive constitutive tensor, there exists a unique u ∈  that solves a(𝜌,u(𝜌), v) = l(v). Thus, defining a density variation
�̃� ∈ , we can state that F(𝜌 + �̃�) = F(𝜌) = 0, and consequently,

F(𝜌 + �̃�) − F(𝜌) = a(𝜌 + �̃�,u(𝜌 + �̃�), v) − a(𝜌,u(𝜌), v)
= a(𝜌 + �̃�,u(𝜌 + �̃�), v) − a(𝜌 + �̃�,u(𝜌), v) + a(𝜌 + �̃�,u(𝜌), v) − a(𝜌,u(𝜌), v)
= a(𝜌 + �̃�,u(𝜌) + Du(𝜌)�̃�, v) − a(𝜌 + �̃�,u(𝜌), v) + D𝜌a(𝜌,u(𝜌), v)�̃� + o(||�̃�||2)
= a(𝜌 + �̃�,Du(𝜌)�̃�, v) + D𝜌a(𝜌,u(𝜌), v)�̃� + o(||�̃�||2)
= a(𝜌,Du(𝜌)�̃�, v) + D𝜌a(𝜌,u(𝜌), v)�̃� + o(||�̃�||2) = 0,

(11)

where D𝜌a(𝜌,u(𝜌), v) is the Fréchet derivative with respect to the first argument of the bilinear form a(𝜌,u, v) and Du(𝜌)
is the Fréchet derivative of u at 𝜌. Then, the differential of the compliance can be computed as

l(u(𝜌 + �̃�)) − l(u(𝜌)) = a(𝜌,u(𝜌),D𝜌u(𝜌)�̃�) + o(||�̃�||2) = a(𝜌,D𝜌u(𝜌)�̃�,u(𝜌)) + o(||�̃�||2)
= −D𝜌a(𝜌,u(𝜌), v)�̃� + o(||�̃�||2) = −[a(𝜌 + �̃�,u(𝜌), v) − a(𝜌,u(𝜌), v)] + o(||�̃�||2)
= −∫Ω∇

su ∶ (C(𝜌 + �̃�) −C(𝜌)) ∶ ∇su + o(||�̃�||2)
= −∫Ω∇

su ∶ (C′(𝜌)�̃�) ∶ ∇su + o(||�̃�||2) = Dl(𝜌)�̃� + o(||�̃�||2),
(12)

where we have used the symmetric behavior of the bilinear form and the result of (11). Note that, for neglecting
higher-order terms, we have supposed that the reminder o(||�̃�||2) is small enough. The proof ends relating the gradient
g(𝜌) of the compliance with its Fréchet derivative Dl(u) by the Riesz representation theorem, ie, Dl(𝜌)�̃� = ∫Ωg�̃�.

3 TOPOLOGICAL DERIVATIVE

On a given domain (unperturbed) Ω ⊂ R2, let us insert in a certain point x̂ a small circular inclusion B𝜀 of radius 𝜀 > 0.
We call the new (perturbed) domain Ω𝜀 (see in Figure 1).

Definition 1. Let J(Ω) and J𝜀(Ω) be the value of a function in the unperturbed and perturbed domain. For a certain
positive function f(𝜀) such that f(𝜀) → 0 when 𝜀 → 0, typically, f(𝜀) = 𝜋𝜀2, we define the topological derivative of J(Ω)
as the following limit:

gT(x̂) = lim
𝜀→0+

J𝜀(Ω) − J(Ω)
𝑓 (𝜀)

. (13)

Remark 1. Note that to make expression (13) well defined, we need to ask that function J𝜀(Ω) admits the following
asymptotic expansion:

J𝜀(Ω) − J(Ω) = 𝑓 (𝜀)gT(x̂) + o( 𝑓 (𝜀)). (14)

Definition 2. For a given Young's modulus and Poisson's ratio of the matrix Ω𝜀⧵B𝜀 and the inclusion B𝜀, represented
by Em, 𝜈m and Ei, 𝜈i respectively, we define the fourth-order polarization tensor P as

P = p1I + p2I ⊗ I, (15)

FIGURE 1 Topological derivative concept



FERRER 365

where the parameters p1 and p2 take the following values:

p1 =
1

𝛽𝛾 + 𝜏1
(1 + 𝛽)(𝜏1 − 𝛾) and p2 =

1
2
(𝛼 − 𝛽)
𝛽𝛾 + 𝜏1

[𝛾(𝛾 − 2𝜏3) + 𝜏1𝜏2]
𝛼𝛾 + 𝜏2

, (16)

and the coefficients 𝛼, 𝛽, 𝛾 , 𝜏1, 𝜏2, and 𝜏3 are of the form

𝛼 =
1 + 𝜈m
1 − 𝜈m

, 𝛽 =
3 − 𝜈m
1 + 𝜈m

, 𝛾 =
Ei
Em

, (17)

𝜏1 =
1 + 𝜈i
1 + 𝜈m

, 𝜏2 =
1 − 𝜈i
1 − 𝜈m

, and 𝜏3 =
𝜈i(3𝜈m − 4) + 1
𝜈m(3𝜈m − 4) + 1

. (18)

Proposition 1. Let u ∈  be the solution of the elasticity problem defined in (6), let the compliance l(u) be defined as in
(7), and let the polarization tensor P be expressed as in Definition 1, then the topological derivative at the point x̂, defined
as in Definition 1, is as follows:

gT(x̂) = 𝜎(x̂) ∶ P ∶ ∇su(x̂), (19)
where ∇s is the symmetric gradient operator and 𝜎 = Cm ∶ ∇su the stresses with Cm the constitutive tensor of the matrix
domain.

Proof. This result is not trivial and is obtained after proposing an asymptotic expansion of the solution of the topolog-
ically perturbed problem and after analytically solving an associated exterior problem. See the work of Novotny and
Sokołowski16 for full details. For the same result but for any value of the Poisson ratio, see the work of Giusti et al.17

For an easier comparison with the H-S bounds, we seek to rewrite the topological derivative only in terms of the shear
and bulk modulus.

Topological derivative in terms of the shear and bulk modulus. Let us define the parameters 𝜂𝜇m =
𝜅m𝜇m

2𝜇m+𝜅m
and

𝜂𝜅m = 𝜇m in terms of the shear and bulk modulus of the matrix 𝜇m, km and the insertion 𝜇i, 𝜅 i and let us define the shear
and bulk polarization parameters q𝜇 and q𝜅 as

q𝜇 = q(𝜇m, 𝜇I , 𝜂𝜇m), q𝜅 = q(𝜅m, 𝜅I , 𝜂𝜅m) with q(t1, t2, t3) =
(t1 + t3)

t1(t2 + t3)
. (20)

Then, the topological derivative in x̂ can be written only in terms of the shear and bulk modulus (of the matrix and
inclusion) as follows:

gT(x̂) = −∇su(x̂) ∶ dC ∶ ∇su(x̂) with dC = 2d𝜇I + [d𝜅 − d𝜇]I ⊗ I, (21)

where the parameters d𝜇 and d𝜅 are

d𝜇 = 𝜇m(𝜇I − 𝜇m)q𝜇 and d𝜅 = 𝜅m(𝜅I − 𝜅m)q𝜅. (22)

To obtain this expression, let the shear and bulk polarization coefficients q𝜇 and q𝜅 be computed first as

q𝜇 =
p𝜇

(𝜇m − 𝜇I)
and q𝜅 =

p𝜅
(𝜅m − 𝜅I)

with p𝜇 = p1 and p𝜅 = 2p1 + p2. (23)

Inserting the lame parameters relations for plane stress E = 4𝜅𝜇
𝜅+𝜇

, and 𝜈 = 𝜅−𝜇
𝜅+𝜇

into the coefficients defined in (17) and
(18) and replacing them in (16), we can write the shear and bulk polarization coefficients as follows:

q𝜇 =

(
𝜇m +

𝜅m𝜇m
2𝜇m+𝜅m

)
𝜇m

(
𝜇I +

𝜅m𝜇m
2𝜇m+𝜅m

) and q𝜅 = (𝜅m + 𝜇m)
𝜅m(𝜅I + 𝜇m)

, (24)



366 FERRER

which are precisely q(𝜇m, 𝜇I , 𝜂𝜇m) and q(𝜅m, 𝜅I , 𝜂𝜅m ). Then, replacing relation (23) in (15), we can directly rewrite the
polarization tensor as P = p𝜇I+

1
2
(p𝜅 − p𝜇)I ⊗ I. The proof ends by replacing this last relation and the constitutive tensor

of the matrix Cm = 2𝜇mI + (𝜅m − 𝜇m)I ⊗ I in the topological derivative expression (19).

Remark 2. We can clearly identify two different cases.

(i) Stiffer inclusion insertion: We define this case by saying that, in a point x̂ ∈ Ω0 with parameters𝜇m = 𝜇0, 𝜅m =
𝜅0, we add an inclusion with parameters 𝜇I = 𝜇1 and 𝜅I = 𝜅1. Then, the topological derivative gT0 in this scenario
takes in the point x̂ the following form:

gT0 (x̂) = −∇
su(x̂) ∶ dC0 ∶ ∇su(x̂), (25)

with
dC0 = 2𝜇0(𝜇1 − 𝜇0)q𝜇0I +

[
𝜅0(𝜅1 − 𝜅0)q𝜅0 − 𝜇0(𝜇1 − 𝜇0)q𝜇0

]
I ⊗ I, (26)

where q𝜇0 = q(𝜇0, 𝜇1, 𝜂𝜇0), q𝜅0 = q(𝜅0, 𝜅1, 𝜂𝜅0 ), 𝜂𝜇0 =
𝜅0𝜇0

2𝜇0+𝜅0
, and 𝜂𝜅0 = 𝜇0 are all positive values.

(ii) Weaker inclusion insertion: Similarly, we define the opposite case by identifying in a point x̂ ∈ Ω1 the matrix
parameters as𝜇m = 𝜇1, 𝜅m = 𝜅1 and the parameters of the inclusion as𝜇I = 𝜇0 and 𝜅I = 𝜅0. Then, the topological
derivative gT1 takes in the point x̂ the following form:

gT1 (x̂) = −∇
su(x̂) ∶ dC1 ∶ ∇su(x̂), (27)

with
dC1 = 2𝜇1(𝜇0 − 𝜇1)q𝜇1I +

[
𝜅1(𝜅0 − 𝜅1)q𝜅1 − 𝜇1(𝜇0 − 𝜇1)q𝜇1

]
I ⊗ I, (28)

where q𝜇1 = q(𝜇1, 𝜇0, 𝜂𝜇1), q𝜅1 = q(𝜅1, 𝜅0, 𝜂𝜅1 ), 𝜂𝜇1 =
𝜅1𝜇1

2𝜇1+𝜅1
and 𝜂𝜅1 = 𝜇1 are also positive values.

Remark 3. Following the seminal work of Amstutz,13 one could think on proposing an interpolation scheme such that
the gradient in Ω1 and Ω0 coincides precisely with the topological derivative. We distinguish again both scenarios.

(i) Stiffer inclusion insertion: Take �̃� = 𝜋𝜀2 in B(x̂, 𝜀) and zero otherwise, where B(x̂, 𝜀) represents a small circular
ball of center x̂ and radius 𝜀. This means that, when replacing a small circular domain of the matrix by a small
circular inclusion, we add a small amount of density. Then, if we want that Taylor's expansion (12) matches with
the asymptotic expansion (14), we must define an interpolation such that, when x̃ ∈ Ω0 (𝜌 = 0),

g(0) = gT0(x̂) =⇒ C
′(0) = dC0 =⇒

{
𝜇′(0) = 𝜇0(𝜇1 − 𝜇0)q𝜇0
𝜅′(0) = 𝜅0(𝜅1 − 𝜅0)q𝜅0,

(29)

(ii) Weaker inclusion insertion: In this case, we take �̃� = −𝜋𝜀2 in B(x̂, 𝜀) and zero otherwise. This means that,
when replacing a small circular domain of the matrix by a small circular inclusion, we subtract a small amount of
density. Similarly, to match both expansions, we should define an interpolation such that, when x̃ ∈ Ω1 (𝜌 = 1),

−g(1) = gT1(x̂) =⇒ C
′(1) = −dC1 =⇒

{
𝜇′(1) = 𝜇1(𝜇1 − 𝜇0)q𝜇1
𝜅′(1) = 𝜅1(𝜅1 − 𝜅0)q𝜅1.

(30)

4 CONNECTION BETWEEN THE TOPOLOGICAL DERIVATIVE AND
HASHIN-SHTRIKMAN BOUNDS

H-S bounds. Let us suppose that a composite material with shear and bulk constitutive properties 𝜇H and 𝜅H is com-
posed by two-phase materials with a fraction volume 𝜌 ∈ [0, 1]. Let us assume that the shear and bulk modulus of both
constituents of the composite are 𝜇0 and 𝜅0 and 𝜇1 and 𝜅1 and satisfies 𝜅1 > 𝜅0. Then, the shear and bulk modulus of the



FERRER 367

composite material 𝜇H and 𝜅H have an upper and lower bound regardless the arrangement of both phases. In addition,
those bounds, commonly called isotropic H-S bounds, can be written, in the case of the shear modulus, as

𝜇LB(𝜌) = 𝜇0(1 − 𝜌) + 𝜇1𝜌 −
(1 − 𝜌)𝜌(𝜇1 − 𝜇0)2

𝜇0𝜌 + 𝜇1(1 − 𝜌) +
𝜅0𝜇0

2𝜇0+𝜅0

𝜇UB(𝜌) = 𝜇0(1 − 𝜌) + 𝜇1𝜌 −
(1 − 𝜌)𝜌(𝜇1 − 𝜇0)2

𝜇0𝜌 + 𝜇1(1 − 𝜌) +
𝜅1𝜇1

2𝜇1+𝜅1

(31)

and similarly in the bulk modulus case as

𝜅LB(𝜌) = 𝜅0(1 − 𝜌) + 𝜅1𝜌 −
(1 − 𝜌)𝜌(𝜅1 − 𝜅0)2

𝜅0𝜌 + 𝜅1(1 − 𝜌) + 𝜇0

𝜅UB(𝜌) = 𝜅0(1 − 𝜌) + 𝜅1𝜌 −
(1 − 𝜌)𝜌(𝜅1 − 𝜅0)2

𝜅0𝜌 + 𝜅1(1 − 𝜌) + 𝜇1
.

(32)

Those bounds were developed in the work of Hashin and Shtrikman.18 See also reference books by Bendsøe and
Sigmund19 and Allaire.20

Remark 4. Note that all bounds can be expressed in the following general form (generalized H-S bounds):

𝑓HS(𝜌) = 𝑓0(1 − 𝜌) + 𝑓1𝜌 −
(1 − 𝜌)𝜌(𝑓1 − 𝑓0)2

𝑓0𝜌 + 𝑓1(1 − 𝜌) + 𝜂
, (33)

where the shear and bulk H-S bounds are recovered by choosing the values described in the following table.

Remark 5. Note that the derivative of the H-S bounds in both components can be rewritten as follows:

{
𝜇′LB(0) = 𝜇0(𝜇1 − 𝜇0)q𝜇0
𝜇′UB(1) = 𝜇1(𝜇1 − 𝜇0)q𝜇1

and

{
𝜅′LB(0) = 𝜅0(𝜅1 − 𝜅0)q𝜅0
𝜅′UB(1) = 𝜅1(𝜅1 − 𝜅0)q𝜅1.

(35)

In fact, this way of rewriting the H-S bounds derivative can be obtained after simple calculations. From
Equation (33), the generalized H-S bound can be rewritten as

𝑓HS(𝜌) =
𝑓0dHS0 (1 − 𝜌) + 𝑓1d

HS
1 𝜌

dHS0 (1 − 𝜌) + d
HS
1 𝜌

with dHS0 =
(𝑓1 − 𝑓0)2

𝑓0 + 𝜂
, dHS1 =

(𝑓1 − 𝑓0)2

𝑓1 + 𝜂
, (36)

and consequently, the derivative of the generalized H-S bounds is expressed as

𝑓 ′HS(𝜌) =
dHS0 d

HS
1 (𝑓1 − 𝑓0)[

dHS0 (1 − 𝜌) + d
HS
1 𝜌

]2 . (37)



368 FERRER

Thus, its value in the components is just

𝑓 ′HS(0) =
dHS1
dHS0

(𝑓1 − 𝑓0) =
𝑓0 + 𝜂
𝑓1 + 𝜂

(𝑓1 − 𝑓0)

𝑓 ′HS(1) =
dHS0
dHS1

(𝑓1 − 𝑓0) =
𝑓1 + 𝜂
𝑓0 + 𝜂

(𝑓1 − 𝑓0).
(38)

Inserting (34) into (37) and using definition of q in (20), the derivative of the H-S bounds for the shear modulus in Ω0
(𝜌 = 0) and in Ω1 (𝜌 = 1) are

𝜇′LB(0) =
(𝜇0 + 𝜂𝜇0)(𝜇1 − 𝜇0)

𝜇1 + 𝜂𝜇0
= −𝜇0(𝜇0 − 𝜇1)q(𝜇0, 𝜇1, 𝜂𝜇0) = 𝜇0(𝜇1 − 𝜇0)q𝜇0

𝜇′LB(1) =
(𝜇1 + 𝜂𝜇0)(𝜇1 − 𝜇0)

𝜇0 + 𝜂𝜇0
= 𝜇1(𝜇1 − 𝜇0)q(𝜇1, 𝜇0, 𝜂𝜇0)

𝜇′UB(0) =
(𝜇0 + 𝜂𝜇1)(𝜇1 − 𝜇0)

𝜇1 + 𝜂𝜇1
= −𝜇0(𝜇0 − 𝜇1)q(𝜇0, 𝜇1, 𝜂𝜇1)

𝜇′UB(1) =
(𝜇1 + 𝜂𝜇1)(𝜇1 − 𝜇0)

𝜇0 + 𝜂𝜇1
= 𝜇1(𝜇1 − 𝜇0)q(𝜇1, 𝜇0, 𝜂𝜇1) = 𝜇1(𝜇1 − 𝜇0)q𝜇1.

(39)

Similarly, the derivative of the H-S bounds for the bulk modulus in Ω0 (𝜌 = 0) and in Ω1 (𝜌 = 1) can be written as

𝜅′LB(0) =
(𝜅0 + 𝜂𝜅0)(𝜅1 − 𝜅0)

𝜅1 + 𝜂𝜅0
= −𝜅0(𝜅0 − 𝜅1)q(𝜅0, 𝜅1, 𝜂𝜅0) = 𝜅0(𝜅1 − 𝜅0)q𝜅0

𝜅′LB(1) =
(𝜅1 + 𝜂𝜅0)(𝜅1 − 𝜅0)

𝜅0 + 𝜂𝜅0
= 𝜅1(𝜅1 − 𝜅0)q(𝜅1, 𝜅0, 𝜂𝜅0)

𝜅′UB(0) =
(𝜅0 + 𝜂𝜅1)(𝜅1 − 𝜅0)

𝜅1 + 𝜂𝜅1
= −𝜅0(𝜅0 − 𝜅1)q(𝜅0, 𝜅1, 𝜂𝜅1)

𝜅′UB(1) =
(𝜅1 + 𝜂𝜅1)(𝜅1 − 𝜅0)

𝜅0 + 𝜂𝜅1
= 𝜅1(𝜅1 − 𝜅0)q(𝜅1, 𝜅0, 𝜂𝜅1) = 𝜅1(𝜅1 − 𝜅0)q𝜅1.

(40)

Topological derivative as H-S bounds derivative. This is one of the two main results of this work. Let us define
two material components with shear and bulk material properties 𝜇0, 𝜅0 and 𝜇1, 𝜅1, respectively, and let us propose an
interpolation function for modeling its mixture by means of its fraction volume 𝜌 = [0, 1] such that close to Ω0 coincides
with the H-S lower bound and close to Ω1 with the H-S upper bound. Then, the gradient of the compliance coincides with
the topological derivative in Ω0 and Ω1.

To see this result, from Equation (9), we can write the gradient of the compliance (when using the isotropic lower and
upper bound as interpolation function) as follows:

gLB(0) = −∇su ∶ C′LB(0) ∶ ∇
su with CLB(𝜌) = 2𝜇LB(𝜌)I + [𝜅LB(𝜌) − 𝜇LB(𝜌)]I ⊗ I

gUB(1) = −∇su ∶ C′UB(1) ∶ ∇
su with CUB(𝜌) = 2𝜇UB(𝜌)I + [𝜅UB(𝜌) − 𝜇UB(𝜌)]I ⊗ I.

(41)

Then, we can identify coefficients in (39) and (40) with precisely the ones established by the topological derivative in (29)
and (30), and thus, {

C
′
LB(0) = dC0 when x̃ ∈ Ω0

C
′
UB(1) = dC1 when x̃ ∈ Ω1.

(42)

Finally, using (42) in Equations (25), (27), and (9), we obtain

{
gLB(0) = gT0(x̃) when x̃ ∈ Ω0
gUB(1) = gT1(x̃) when x̃ ∈ Ω1.

(43)



FERRER 369

Remark 6. This result confirms that the material in the neighborhood of the infinitesimal inclusion inserted in the
perturbed domain used to compute the topological derivative can be understood as an homogenized microstructure
with circular inclusions (H-S bounds microstructures) with a fraction volume value equivalent to the infinitesimal
inclusion volume. This is to say that, in order to study a change on the compliance, the topological derivative concepts
proposes in fact to insert H-S microstructures.

5 RATIONAL FUNCTIONS

Definition 3. Let us introduce the following particular family of rational functions:

 =
{
𝑓 ∈ C∞([0, 1], [𝑓0, 𝑓1]) | 𝑓 (𝜌) = A𝜌2 + B𝜌 + CD𝜌 + 1

}
, (44)

where A, B, C, and D ≠ −1 are scalar parameters to be determined by fixing the value and its derivative in the extremes,
ie,

𝑓 (0) = 𝑓0, 𝑓 ′(0) =
.
𝑓 0, 𝑓 (1) = 𝑓1, and 𝑓

′(1) =
.
𝑓 1. (45)

Remark 7. Note that function 𝑓 ∈  is equivalent to the following expression:

𝑓 (𝜌) =
d01(1 − 𝜌)𝜌 + 𝑓0d0(1 − 𝜌) + 𝑓1d1𝜌

d0(1 − 𝜌) + d1𝜌
with

⎧⎪⎨⎪⎩
d01 =

.
𝑓 1

.
𝑓 0 − (𝑓1 − 𝑓0)2

d0 =
.
𝑓 1 − (𝑓1 − 𝑓0)

d1 = (𝑓1 − 𝑓0) −
.
𝑓 0.

(46)

This result is easily obtained by computing the derivative of the rational function as

𝑓 ′(𝜌) =
AD𝜌2 + 2A𝜌 + (B − CD)

(D𝜌 + 1)2
(47)

and imposing conditions (45). Then, we can solve the system of four equations to find the value of the parameters A, B,
C, and D. This is

A =
−

.
𝑓 1

.
𝑓 0 + (𝑓1 − 𝑓0)2

.
𝑓 1 + (𝑓1 − 𝑓0)

, B =
2𝑓0(𝑓1 − 𝑓0) +

.
𝑓 1

.
𝑓 0 − 𝑓1

.
𝑓 0 −

.
𝑓 1𝑓0

.
𝑓 1 + (𝑓1 − 𝑓0)

, C = 𝑓0, and D =
2(𝑓1 − 𝑓0) − (

.
𝑓 1 +

.
𝑓 0)

.
𝑓 1 + (𝑓1 − 𝑓0)

. (48)

Remark 8. Note that, with the definitions above, the following property holds: d01 = (f1 − f0)(d0 − d1) − d0d1.

Remark 9. The generalized H-S bounds and therefore the upper and lower bounds of the shear and bulk modulus are
rational functions. This can be easily seen by imposing

d01 = 0, d0 = dHS0 =
(𝑓1 − 𝑓0)2

𝑓0 + 𝜂
, and d1 = dHS1 =

(𝑓1 − 𝑓0)2

𝑓1 + 𝜂
(49)

in the general rational Equation (46) and obtaining

𝑓HS(𝜌) =
𝑓0dHS0 (1 − 𝜌) + 𝑓1d

HS
1 𝜌

dHS0 (1 − 𝜌) + d
HS
1 𝜌

, (50)

which is precisely the generalized H-S equation (33).



370 FERRER

6 SIMP-ALL METHOD

The idea of the SIMP-ALL method is precisely to propose an interpolation such that the gradient of the compliance
coincides with the topological derivative in both Ω0 and Ω1. As already shown in Equation (43), in the case of isotropic
materials, this is equivalent to impose the derivative of the H-S lower bound in Ω0 and the derivative of the H-S upper
bound in Ω1 for the shear and bulk modulus interpolations.

Definition 4. The SIMP-ALL function fSA(𝜌) is defined as a rational functionwith the H-S bound derivatives (lower
in 𝜌 = 0 and upper in 𝜌 = 1) as derivative parameters

.
𝑓0 and

.
𝑓1. This is

.
𝑓0 = 𝑓 ′HS(0) =

𝑓0 + 𝜂0
𝑓1 + 𝜂0

(𝑓1 − 𝑓0) and
.
𝑓1 = 𝑓 ′HS(1) =

𝑓1 + 𝜂1
𝑓0 + 𝜂1

(𝑓1 − 𝑓0). (51)

Remark 10. Note that the shear and bulk SIMP-ALL interpolation function 𝜇SA(𝜌) and 𝜅SA(𝜌) can be rewritten in the
following compact form:

𝜇SA(𝜌) =
(𝜇1 − 𝜇0)(𝜂𝜇0 − 𝜂𝜇1)(1 − 𝜌)𝜌 + 𝜇0(𝜇1 + 𝜂𝜇0 )(1 − 𝜌) + 𝜇1(𝜇0 + 𝜂𝜇1)𝜌

(𝜇1 + 𝜂𝜇0)(1 − 𝜌) + (𝜇0 + 𝜂𝜇1)𝜌

𝜅SA(𝜌) =
(𝜅1 − 𝜅0)(𝜂𝜅0 − 𝜂𝜅1)(1 − 𝜌)𝜌 + 𝜅0(𝜅1 + 𝜂𝜅0)(1 − 𝜌) + 𝜅1(𝜅0 + 𝜂𝜅1 )𝜌

(𝜅1 + 𝜂𝜅0)(1 − 𝜌) + (𝜅0 + 𝜂𝜅1)𝜌
,

(52)

where 𝜂𝜇0 =
𝜅0𝜇0

2𝜇0+𝜅0
, 𝜂𝜇1 =

𝜅1𝜇1
2𝜇1+𝜅1

, 𝜂𝜅0 = 𝜇0, and 𝜂𝜅1 = 𝜇1 were previously defined in (34).

These expressions can be easily obtained by computing the rational function parameters d01, d0, and d1 defined in
Equation (46). In the case of the SIMP-ALL interpolation, they can be written as

dSA01 =
.
𝑓 1

.
𝑓 0 − (𝑓1 − 𝑓0)

2 = (𝑓1 − 𝑓0)2
(
𝑓0 + 𝜂0
𝑓1 + 𝜂0

𝑓1 + 𝜂1
𝑓0 + 𝜂1

− 1
)

=
(𝑓1 − 𝑓0)3(𝜂0 − 𝜂1)
(𝑓0 + 𝜂1)(𝑓1 + 𝜂0)

dSA0 =
.
𝑓 1 − (𝑓1 − 𝑓0) = (𝑓1 − 𝑓0)

(
𝑓1 + 𝜂1
𝑓0 + 𝜂1

− 1
)

=
(𝑓1 − 𝑓0)2

𝑓0 + 𝜂1

dSA1 = (𝑓1 − 𝑓0) −
.
𝑓 0 = (𝑓1 − 𝑓0)

(
1 −

𝑓0 + 𝜂0
𝑓1 + 𝜂0

)
=

(𝑓1 − 𝑓0)2

𝑓1 + 𝜂0
.

(53)

These parameters let us build the SIMP-ALL general interpolation function f SA(𝜌) as

𝑓SA(𝜌) =
dSA01 (1 − 𝜌)𝜌 + 𝑓0d

SA
0 (1 − 𝜌) + 𝑓1d

SA
1 𝜌

dSA0 (1 − 𝜌) + d
SA
1 𝜌

=
(𝑓1 − 𝑓0)(𝜂0 − 𝜂1)(1 − 𝜌)𝜌 + 𝑓0(𝑓1 + 𝜂0)(1 − 𝜌) + 𝑓1(𝑓0 + 𝜂1)𝜌

(𝑓1 + 𝜂0)(1 − 𝜌) + (𝑓0 + 𝜂1)𝜌
,

(54)

where the last expression is obtained multiplying the upper and lower parts of the fraction by (𝑓0+𝜂1)(𝑓1+𝜂0)
(𝑓1−𝑓0)2

. Finally, we
have to take the corresponding f0, f1, 𝜂0, and 𝜂1 parameters values for the case of the shear and bulk modulus.

Difference of two rational functions. Let 𝑓A ∈  and 𝑓B ∈  be two rational functions such that 𝑓 ′B(0) ≤ 𝑓 ′A(0),
𝑓 ′A(1) ≤ 𝑓 ′B(1), fA(0) = fB(0), and fA(1) = fB(1) for all 𝜌 ∈ [0, 1]. Then,

𝑓A(𝜌) ≥ 𝑓B(𝜌) ∀𝜌 ∈ [0, 1]. (55)



FERRER 371

To obtain this result, we will show in four steps that the difference of fA and fB is positive ∀𝜌 ∈ [0, 1].

(i) Computing the difference function. Let us compute the function fC as the difference of the two rational functions
fA and fB. This is

𝑓C(𝜌) = 𝑓A(𝜌) − 𝑓B(𝜌) =
nC(𝜌)
dC(𝜌)

, (56)

where the numerator nC(𝜌) is written as

nC(𝜌) = nA(𝜌)dB(𝜌) − nB(𝜌)dA(𝜌) with

{
nA(𝜌) = dA01(1 − 𝜌)𝜌 + 𝑓0d

A
0 (1 − 𝜌) + 𝑓1d

A
1 𝜌

nB(𝜌) = dB01(1 − 𝜌)𝜌 + 𝑓0d
B
0 (1 − 𝜌) + 𝑓1d

B
1𝜌

(57)

and the denominator dC(𝜌) as

dC(𝜌) = dA(𝜌)dB(𝜌) with

{
dA(𝜌) = dA0 (1 − 𝜌) + d

A
1 𝜌

dB(𝜌) = dB0 (1 − 𝜌) + d
B
1𝜌.

(58)

(ii) Computing the difference function numerator. For sake of compactness, we write the numerator in matrix
form as

nC(𝜌) =
[
(1 − 𝜌)𝜌 (1 − 𝜌) 𝜌

] ⎛⎜⎜⎝
⎡⎢⎢⎣

dA01
𝑓0dA0
𝑓1dA1

⎤⎥⎥⎦
[

dB0 d
B
1
]
−
⎡⎢⎢⎣

dB01
𝑓0dB0
𝑓1dB1

⎤⎥⎥⎦
[

dA0 d
A
1
]⎞⎟⎟⎠
[
(1 − 𝜌)

𝜌

]
=

=
[
(1 − 𝜌)𝜌 (1 − 𝜌) 𝜌

] ⎡⎢⎢⎢⎣
dA01d

B
0 − d

B
01d

A
0 d

A
01d

B
0 − d

B
01d

A
0

𝑓0dA0 d
B
0 − 𝑓0d

B
0 d

A
0 𝑓0d

A
0 d

B
1 − 𝑓0d

B
0 d

A
1

𝑓1dA1 d
B
0 − 𝑓1d

B
1 d

A
0 𝑓1d

A
01d

B
0 − 𝑓1d

B
01d

A
0

⎤⎥⎥⎥⎦
[
(1 − 𝜌)

𝜌

]
=

=
[
(1 − 𝜌)𝜌 (1 − 𝜌) 𝜌

] [N11 N12
0 N22

N31 0

][
(1 − 𝜌)

𝜌

]
=

= (1 − 𝜌)2𝜌N11 + (1 − 𝜌)𝜌2N12 + (1 − 𝜌)𝜌N22 + 𝜌(1 − 𝜌)N31 =

= (1 − 𝜌)𝜌
[
(1 − 𝜌)N11 + 𝜌N12 + N22 + N31

]
= (1 − 𝜌)𝜌

[
(1 − 𝜌)(N11 + N22 + N31) + 𝜌(N12 + N22 + N31)

]
= (1 − 𝜌)𝜌

[
(1 − 𝜌)c0 + 𝜌c1

]
,

(59)

where c0 = N11 + N22 + N31 and c1 = N12 + N22 + N31. Note that, from Remark 8, N11, N12, N22, and N31 can be
written as

N11 =
[
(𝑓1 − 𝑓0)

(
dA0 − d

A
1
)
− dA0 d

A
1
]

dB0 −
[
(𝑓1 − 𝑓0)

(
dB0 − d

B
1
)
− dB0 d

B
1
]

dA0 =

= −(𝑓1 − 𝑓0)
(

dB0 d
A
1 − d

B
1 d

A
0
)
+
(

dB1 − d
A
1
)

dA0 d
B
0

N12 =
[
(𝑓1 − 𝑓0)

(
dA0 − d

A
1
)
− dA0 d

A
1
]

dB1 −
[
(𝑓1 − 𝑓0)

(
dB0 − d

B
1
)
− dB0 d

B
1
]

dA1 =

= −(𝑓1 − 𝑓0)
(

dB0 d
A
1 − d

B
1 d

A
0
)
+
(

dB0 − d
A
0
)

dA1 d
B
1

N22 = −𝑓0
(

dB0 d
A
1 − d

B
1 d

A
0
)

N31 = −𝑓1
(

dB0 d
A
1 − d

B
1 d

A
0
)
.

(60)

and the sum of N22 and N31 as N22 + N31 = (𝑓1 − 𝑓0)(dB0 d
A
1 − d

B
1 d

A
0 ). Thus, we can write coefficients c0 and c1 in a

simplified form as
c0 =

(
dB1 − d

A
1
)

dA0 d
B
0 ,

c1 =
(

dB0 − d
A
0
)

dA1 d
B
1 .

(61)



372 FERRER

(iii) Computing the difference function denominator. From Equation (58), this is simply

dC(𝜌) =
[
dA0 (1 − 𝜌) + d

A
1 𝜌
] [

dB0 (1 − 𝜌) + d
B
1𝜌
]
. (62)

(iv) Positiveness of the difference for all possible scenarios. The idea is now to analyze if the numerator and the
denominator of the difference have always the same sign in all possible cases. First, note that, since 𝑓A ∈  and
𝑓B ∈ , their image should not be unbounded (should be between [f0, f1]). Thus, from (62), we see that the following
two scenarios are only possible:

d0, d1 > 0 or d0, d1 < 0. (63)

Then, the assumptions of 𝑓 ′B(0) ≤ 𝑓 ′A(0) and 𝑓 ′A(1) ≤ 𝑓 ′B(1) entail the following inequalities:

𝑓 ′B(0) − 𝑓
′
A(0) =

[
(𝑓1 − 𝑓0) − dB1

]
−
[
(𝑓1 − 𝑓0) − dA1

]
= dA1 − d

B
1 ≤ 0 =⇒ dB1 ≥ dA1

𝑓 ′A(1) − 𝑓
′
B(0) =

[
(𝑓1 − 𝑓0) + dA0

]
−
[
(𝑓1 − 𝑓0) + dB0

]
= dA0 − d

B
0 ≤ 0 =⇒ dB0 ≥ dA0 .

(64)

In view of (64), we summarize all the possible scenarios in the following table.

In the table, Cases 1, 2, and 3 are the only possible cases that makes fA and fB satisfy condition (63), and consequently,
the rest of cases are not included. Thus, we can guarantee positiveness of function fC reasoning as follows:

Case 1:

{
c1, c0 > 0 =⇒ nC(𝜌) > 0
dA(𝜌) > 0, dB(𝜌) > 0 =⇒ dC(𝜌) > 0

=⇒ 𝑓C(𝜌) > 0 ∀𝜌 ∈ [0, 1]

Case 2:

{
c1, c0 < 0 =⇒ nC(𝜌) < 0
dA(𝜌) < 0, dB(𝜌) > 0 =⇒ dC(𝜌) < 0

=⇒ 𝑓C(𝜌) > 0 ∀𝜌 ∈ [0, 1]

Case 3:

{
c1, c0 > 0 =⇒ nC(𝜌) > 0
dA(𝜌) > 0, dB(𝜌) < 0 =⇒ dC(𝜌) > 0

=⇒ 𝑓C(𝜌) > 0 ∀𝜌 ∈ [0, 1].

(66)

Remark 11. Based on the results shown above, although it may be obvious, we could show that the H-S upper bound
is above the H-S lower bound. Indeed,

𝑓 ′UB(0) − 𝑓
′
LB(0) =

𝑓0 + 𝜂1
𝑓1 + 𝜂1

(𝑓1 − 𝑓0) −
𝑓0 + 𝜂0
𝑓1 + 𝜂0

(𝑓1 − 𝑓0) =
(𝑓1 − 𝑓0)2(𝜂1 − 𝜂0)
(𝑓1 + 𝜂0)(𝑓1 + 𝜂0)

≥ 0 (67)

𝑓 ′LB(1) − 𝑓
′
UB(1) =

𝑓1 + 𝜂0
𝑓0 + 𝜂0

(𝑓1 − 𝑓0) −
𝑓1 + 𝜂1
𝑓0 + 𝜂1

(𝑓1 − 𝑓0) =
(𝑓1 − 𝑓0)2(𝜂1 − 𝜂0)
(𝑓0 + 𝜂0)(𝑓0 + 𝜂0)

≥ 0, (68)

where we have used f1, f0 ≥ 0 for coercivity reasons and 𝜂1 ≥ 0, 𝜂0 ≥ 0 is fulfilled by definition from table (34)
for both the shear and the bulk modulus. Thus, as expected, the H-S bound for both the shear and bulk modulus is
always above the H-S lower bound. This is

𝜇UB(𝜌) ≥ 𝜇LB(𝜌) and 𝜅UB(𝜌) ≥ 𝜅LB(𝜌) ∀𝜌 ∈ [0, 1]. (69)



FERRER 373

SIMP-ALL in between H-S bounds. At this point, we can show that the SIMP-ALL interpolation for the bulk and
shear modulus rest always between the H-S bounds, this is

𝜇UB(𝜌) ≥ 𝜇SA(𝜌) ≥ 𝜇LB(𝜌) and 𝜅UB(𝜌) ≥ 𝜅SA(𝜌) ≥ 𝜅LB(𝜌) ∀𝜌 ∈ [0, 1]. (70)

This result is certainly the second main contribution of this work. To show it, we only have to verify the conditions stated
before Equation (55). In fact, the H-S upper bound and the SIMP-ALL interpolation function fulfills by construction

𝑓 ′UB(0) − 𝑓
′
SA(0) = 𝑓

′
UB(0) − 𝑓

′
LB(0) ≥ 0 and 𝑓 ′SA(1) − 𝑓 ′UB(1) = 0. (71)

Condition 𝑓 ′UB(0) − 𝑓
′
LB(0) ≥ 0 has been already shown in (67). We can proceed similarly for the H-S lower bound. By

construction,

𝑓 ′SA(0) − 𝑓
′
LB(0) = 0 and 𝑓

′
SA(1) − 𝑓

′
UB(1) = 𝑓

′
LB(1) − 𝑓

′
UB(1) ≥ 0, (72)

and condition 𝑓 ′SA(1) − 𝑓
′
UB(1) = 𝑓

′
LB(1) − 𝑓

′
UB(1) ≥ 0 has been also already proven in (67).

7 COMPARISON BETWEEN SIMP AND SIMP-ALL

The celebrated SIMP interpolation function19 proposes basically to combine the property of both materials as follows:

C(𝜌) = (1 − 𝜌p)C0 + 𝜌pC1, (73)

where p is the penalization parameter, frequently taken as p = 3.

7.1 Interpolation function comparison
We seek in this section to compare both interpolations in the following two different situations.

(a) Material-void interpolation
In regularized topology optimization, the material of the domain (base material) is usually interpolated with a void
material, modeled with an extremely weak material. As discussed in the work of Bendsøe and Sigmund,2 standard
SIMP proposes an isotropic interpolation, which its corresponding intermediate values (gray) cannot be interpreted
in some situations as a composite material composed by the base material and the void material (the interpola-
tion function remains outside the H-S bounds). To circumvent this limitation, an adaptive value of the penalization
parameter (in terms of the Poisson ratio value of the base material 𝜈1) is proposed in the aforementioned work2 for
two-dimensional plane stress cases by changing the penalization parameter as follows:

p ≥ p∗(𝜈1) = max
(

2
1 − 𝜈1

,
4

1 + 𝜈1

)
. (74)

With this adaptation of the penalization parameter, the SIMP method remains in between the H-S bounds when
𝜇0 → 0 and 𝜅0 → 0. In the following, we will call this interpolation choice as adaptive SIMP. For comparing SIMP,
SIMP-ALL, and adaptive SIMP, in this work, we have proposed a sequence of composite materials composed by an
isotropic base material with properties (E1 = 1, 𝜈1 ∈ {1∕3, 0,−0.5,−0.75,−0.9}) and a void material with properties
(E0 = 10−3, 𝜈0 = 1∕3). Note that the value of 𝜈0 when E0 → 0 has no relevance.
The SIMP, adaptive SIMP, and SIMP-ALL interpolation function have been depicted in Figure 2 in relation with
the shear and bulk H-S bounds. In view of the results, when the Poisson ratio is 𝜈 = 1∕3, the three interpolations
behave similarly. In fact, SIMP adaptive and SIMP coincides since p∗(1∕3) = 3. Additionally, both the SIMP and the



374 FERRER

0 0.5 1
Density

0

0.1

0.2

0.3

0.4
Shear modulus

0 0.5 1
Density

0

0.2

0.4

0.6

0.8
Bulk modulus

0 0.5 1
Density

0

2

4

6
Shear modulus

0 0.5 1
Density

0

0.5

1

1.5

2

2.5
Shear modulus

0 0.5 1
Density

0

0.2

0.4

0.6

0.8

1
Shear modulus

0 0.5 1
Density

0

0.1

0.2

0.3
Bulk modulus

0 0.5 1
Density

0

0.1

0.2

0.3
Bulk modulus

0 0.5 1
Density

0

0.1

0.2

0.3

0.4
Bulk modulus

0 0.5 1
Density

0

0.1

0.2

0.3

0.4

0.5
Shear modulus

0 0.5 1
0

0.2

0.4

0.6
Bulk modulus

Density

FIGURE 2 Shear and bulk interpolation function comparison when interpolating void material (E0 = 10−3, 𝜈0 = 1∕3) with a sequence of
stiff materials (E1 = 1 and 𝜈1 decreasing). In contrast with SIMP, SIMP adaptive, and SIMP-ALL interpolations remain in between H-S bounds

SIMP-ALL interpolation function take the H-S bounds derivative values in the extreme values (the lower bound in
𝜌 = 0 and the upper bound in 𝜌 = 1). The former coincidence is proved in the work of Bendsøe and Sigmund19 while
the latter is obtained by construction. In this case, both interpolation remain in between the H-S bounds. However,
as soon as 𝜈1 decreases, SIMP, SIMP adaptive, and SIMP-ALL start differing. In fact, SIMP-ALL and SIMP adaptive
interpolation function, in contrast with SIMP, remain in between H-S bounds as expected. Additionally, note that
as soon as 𝜈1 decreases, eg, 𝜈1 = −0.9, p∗ = 40 (Case (E)), the adaptive SIMP interpolation, in comparison with
the SIMP-ALL interpolation, increases extremely markedly resulting in possible limitations when solving topology
optimization problems.

(b) Bimaterial interpolation
For a more general case, when the weak material is not necessary much less stiff than the base material, the topology
optimization problem is in fact a bimaterial optimization problem. The aim is to decide in which part of Ω is appro-
priate to use one material or the other, or in case of “grays,” a combination of both. Two different cases have been
presented. The first one (Case (A)) seeks to model an Steel-Aluminum composite. In this sense, the material proper-
ties have been taken as E0 = 1∕3, 𝜈0 = 0.35, E1 = 1, and 𝜈1 = 0.3. The second example (Case (B)) intends to model
an extreme case where one material has larger bulk modulus value and the other material has larger shear modulus
value. To this aim, the material properties considered are E0 = 0.9, 𝜈0 = −0.9, E1 = 1, and 𝜈1 = 0.3.



FERRER 375

0 0.5 1
Density

0.2

0.4

0.6

0.8
Bulk modulus

0 0.5 1
Density

0.2

0.4

0.6

0.8
Bulk modulus

0 0.5 1
Density

0

1

2

3

4

5
Shear modulus

0 0.5 1
Density

0.1

0.2

0.3

0.4
Shear modulus

FIGURE 3 Interpolation function comparison when interpolating two real materials. SIMP adaptive interpolation is not even defined. In
contrast with SIMP, SIMP-ALL remains in between H-S bounds despite both bounds are really close

In the bimaterial problem, the value of the penalization parameter p for the SIMP interpolation function is unclear.
In the following, we take a penalization parameter of value p = 3. The SIMP adaptive method is even not defined. The
corresponding H-S bounds, SIMP, and SIMP-ALL method have been depicted in Figure 3. As expected, in both cases
(A and B), SIMP function falls outside H-S bounds. However, although the space between H-S bounds is significantly
narrow, the SIMP-ALL interpolation function comes to lie inside them, as stated in Equation (70). Thus, the use of
SIMP-ALL interpolation seems as convenient as the SIMP interpolation for 𝜈1 ≃ 1∕3 and more convenient (from the
physical point of view) for different values of 𝜈1 and when solving bimaterial problems.

7.2 Numerical examples comparison
In order to see the numerical effects of using different kind of interpolation functions, a cantilever beam example has
been solved for the sequence of Cases described in Figure 2. The size of the domain is 2× 1 with the left side clamped. A
distributed vertical force of unit value is applied in a 0.2 centered part of the right side. The domain is equipped with a
structured triangular mesh of 20 000 elements from a Cartesian grid by splitting each cell into four triangles. The density
function is approximated with P1 Lagrangian finite element functions21 and the following filter is applied to the density
function:

𝜌k =

∑
i∈Sk

∫ΩNiN𝑗𝜌𝑗∑
i∈Sk

∫ΩNi
, (75)

where 𝜌k is the density value in element k and Sk is the set of nodes of element k, see the work of Amstutz et al22 for
further details. This filter is defined in a discrete sense, in terms of the shape functions. Other filters depending on the
distance are also possible.

We consider the compliance as the cost function and the volume (volume target of the stiff material V = 0.5) as a
constraint of the topology optimization problem. Additionally, we consider the MMA algorithm,23 widely used in the
community, to solve the problem with a stopping criteria tolerance of 10−4 and a maximum number of iterations of nmax =
5000. The design variable is initialized with stiff material overall the domain (𝜌 = 1).

As depicted in Figure 4, we observe similar optimal topologies regardless the interpolation used when the Poisson
ratio of the stiff material is closed to 𝜈1 = 1∕3. Additionally, the number of iterations and the finite-element solver eval-
uation are also similar. The examples are computed in MATLAB© with a standard PC (3.40 GHz processor in a 64-bit
architecture). However, some differences appear when 𝜈1 becomes smaller. The optimal topologies when using the SIMP
interpolation require large number of iterations and finite-element solver evaluations to converge and gray areas appear.
This is probably due to a small penalization value appeared in that cases (see Figure 2). In the case of SIMP adaptive,
in which the penalization value is rather large, although it seems to be almost free of numerical instabilities, nonstan-
dard topologies appear. Likewise, a significant computational effort in terms of iterations is required to converge. In
contrast, the SIMP-ALL interpolation behaves as adequately in terms of optimal topology and computational effort as



376 FERRER

FIGURE 4 Cantilever beam example for a sequence of different material-void interpolations using different interpolation functions. For
standard isotropic materials (𝜈1 = 1∕3), all interpolations behave similarly. As 𝜈1 becomes more negative, gray areas appear when using SIMP
and a larger number of convergence iterations are needed. Adaptive SIMP is presents no large gray areas but a noncompetitive cost function
and a larger number of convergence iterations appear. SIMP-ALL interpolation presents no gray areas, the number of iterations remains
small, and the objective function achieves considerable smaller values. In comparison with SIMP, the SIMP-ALL method evidences an
auto-penalizing effect in a wider range of cases [Colour figure can be viewed at wileyonlinelibrary.com]

when considering standard Poisson ratio values, typically 𝜈 = 1∕3. In Case (C), the SIMP method did not converge.
Note that, comparing cost values between interpolation could be fuzzy, since in gray areas, each interpolation proposes
different stiffness values. In some cases, SIMP interpolation may propose values stiffer than physically possible (out of
H-S bounds). To have a stiffness comparison with physical sense, the cost of the optimal topologies obtained by the
three interpolations have been evaluated using the SIMP-ALL interpolation (JSA). The value of the cost (compliance)
shown in Figure 4 is normalized with the value of the cost in the initial guess. Admittedly, using the SIMP-ALL inter-
polation, a decrease in the cost in Case (E) of 35% is obtained when comparing with the SIMP interpolation and of
30% when comparing with the SIMP adaptive interpolation. This result shows the convenience of using the SIMP-ALL
interpolation when extreme isotropic materials (see, for example, the work of Greaves et al24) or bimaterial problems
are considered.

Finally, the gray areas appearing in the SIMP method is probably because intermediate values with this interpolation
are competitive, as seen in Figure 2. Large stiffness values (more than physically possible) are provided for intermediate
values. In this case, SIMP behaves not as an auto-penalizing interpolation function. In contrast, SIMP-ALL seems to
be auto-penalizing in all the cases. This is not thoroughly surprising since, as shown in Equation (43), the topological
derivative (used in the SIMP-ALL interpolation) proposes in fact to insert H-S microstructures near the extreme values.
Thus, the possibility of adding a certain amount of density (or inserting certain stiffer inclusions) is not competitive
since they provide small stiffness increment. Intuitively, microstructure made of weak material with a small number of
circular inclusion transmits barely the load, making it, in general, not attractive from the optimization point of view. This
may explain why the proposed SIMP-ALL interpolation, in contrast with SIMP, evidences in the results of Figure 4 an
auto-penalizing behavior for all the studied cases.

http://wileyonlinelibrary.com


FERRER 377

8 CONCLUSIONS

The main contributions of this work can be summarized in the following four points.
First, we have showed in Equation (43) that the topological derivative of the compliance is precisely the linear approx-

imation of the H-S bound (lower bound for the weak and upper bound for stiff material). In other words, using the
topological derivative for the compliance is equivalent to inserting H-S bound microstructures (circular inclusions). This
result strongly relates both concepts and allow us to give a new interpretation of the topological derivative.

Second, we have proposed the SIMP-ALL method, a new interpolation function for the shear and bulk modulus. It
is defined as a rational function and build so that its derivative coincides with the H-S lower bound derivative in the
weak material and the H-S upper bound derivative in the stiff material, making the gradient coincide, as shown in (43),
with the topological derivative in the stiff and the weak material. The key point of the SIMP-ALL interpolation is that in
Equation (70), we have shown that it stays always in between the H-S bound regardless the materials to be interpolated,
allowing us to interpret its intermediate values always as real microstructures.

Third, we have compared the SIMP-ALL with the SIMP and SIMP adaptive interpolation function. We have observed
similar behavior when 𝜈1 is closed to 1∕3 and quite different behavior as it becomes smaller. In contrast with SIMP, the
SIMP-ALL interpolation has shown to stay in between the H-S bounds, numerically verifying the result of Equation (70),
not only in the case of weak-stiff material but also in the more challenging case of interpolating two general isotropic
materials.

Finally, concerning numerical examples, we observed also similar behavior of the optimal topologies around 𝜈 = 1∕3.
However, as it becomes smaller, the SIMP-ALL method has shown to obtain up to 20% stiffer topologies, free of gray areas
and smaller computational cost. In comparison with SIMP, this result shows that the SIMP-ALL method is auto-penalizing
in a wider range of cases.

From the author's point of view, rather than an alternative, the SIMP-ALL interpolation method can be under-
stood as a generalization of the SIMP method, adequate for all kind of interpolation materials, with physical meaning,
free of heuristic parameters, and with no extra computational effort. In this sense, SIMP-ALL interpolation bridge
also the gap between the topological derivative community and the SIMP community, allowing the first to use reg-
ularized algorithms and the second to use the topological derivative concept. A MATLAB implementation of the
SIMP-ALL interpolation is available at https://github.com/FerrerFerreAlex/SimpALL and has been also provided in the
Appendix.

ACKNOWLEDGEMENTS

The research leading to these results has received funding from the European Union's Horizon 2020 research and inno-
vation programme under the Marie Skłodowska-Curie grant agreement no. 712949 (TECNIOspring PLUS) and from the
Agency for Business Competitiveness of the Government of Catalonia. We thank Dr Samuel Amstutz for assistance with
developing the methodology, for helping on deeply understand the topic and for the comments that greatly improved the
manuscript.

ORCID

A. Ferrer https://orcid.org/0000-0003-1011-0230

REFERENCES
1. Pedersen CBW, Allinger P. Industrial implementation and applications of topology optimization and future needs. In: Bendsøe MP,

Olhoff N, Sigmund O, eds. IUTAM Symposium on Topological Design Optimization of Structures, Machines and Materials. Dordrecht, The
Netherlands: Springer; 2006:229-238.

2. Bendsøe MP, Sigmund O. Material interpolation schemes in topology optimization. Arch Appl Mech. 1999;69(9):635-654. https://doi.org/
10.1007/s004190050248

3. Wang F, Lazarov BS, Sigmund O. On projection methods, convergence and robust formulations in topology optimization. Struct Multidiscip
Optim. 2011;43(6):767-784. https://doi.org/10.1007/s00158-010-0602-y

4. Stolpe M, Svanberg K. An alternative interpolation scheme for minimum compliance topology optimization. Struct Multidiscip Optim.
2001;22:116-124.

https://github.com/FerrerFerreAlex/SimpALL
https://orcid.org/0000-0003-1011-0230
https://orcid.org/0000-0003-1011-0230
https://doi.org/10.1007/s004190050248
https://doi.org/10.1007/s004190050248
https://doi.org/10.1007/s00158-010-0602-y


378 FERRER

5. Dzierżanowski G. On the comparison of material interpolation schemes and optimal composite properties in plane shape optimization.
Struct Multidiscip Optim. 2012;46:693-710.

6. Allaire G, Jouve F, Toader A-M. Structural optimization using sensitivity analysis and a level-set method. J Comput Phys.
2004;194(1):363-393. http://www.sciencedirect.com/science/article/pii/S002199910300487X

7. Amstutz S, Andrä H. A new algorithm for topology optimization using a level-set method. J Comput Phys. 2006;216(2):573-588. http://
www.sciencedirect.com/science/article/pii/S0021999105005656

8. Allaire G, De Gournay F, Jouve F, Toader AM. Structural optimization using topological and shape sensitivity via a level set method.
Control Cybern. 2005;34(1):59.

9. Yamada T, Izui K, Nishiwaki S, Takezawa A. A topology optimization method based on the level set method incorporating a fictitious
interface energy. Comput Methods Appl Mech Eng. 2010;199(45-48):2876-2891.

10. Huang X, Xie YM. A new look at ESO and BESO optimization methods. Struct Multidiscip Optim. 2008;35(1):89-92.
11. Baiges J, Martínez-Frutos J, Herrero-Pérez D, Otero F, Ferrer A. Large-scale stochastic topology optimization using adaptive mesh

refinement and coarsening through a two-level parallelization scheme. Comput Methods Appl Mech Eng. 2019;343:186-206.
12. Nguyen-Xuan H. A polytree-based adaptive polygonal finite element method for topology optimization. Int J Numer Methods Eng.

2017;110(10):972-1000.
13. Amstutz S. Connections between topological sensitivity analysis and material interpolation schemes in topology optimization. Struct

Multidiscip Optim. 2011;43(6):755-765.
14. Sá LFN, Amigo RCR, Novotny AA, Silva ECN. Topological derivatives applied to fluid flow channel design optimization problems. Struct

Multidiscip Optim. 2016;54(2):249264.
15. Brezis H. Functional Analysis, Sobolev Spaces and Partial Differential Equations. New York, NY: Springer Science; 2010.
16. Novotny AA, Sokołowski J. Topological Derivatives in Shape Optimization. Berlin, Germany: Springer-Verlag; 2013. Interaction of Mechanics

and Mathematics Series.
17. Giusti SM, Ferrer A, Oliver J. Topological sensitivity analysis in heterogeneous anisotropic elasticity problem. Theoretical and computa-

tional aspects. Comput Methods Appl Mech Eng. 2016;311:134-150.
18. Hashin Z, Shtrikman S. A variational approach to the theory of the elastic behaviour of multiphase materials. J Mech Phys Solids.

1963;11(2):127-140.
19. Bendsøe MP, Sigmund O. Topology optimization: Theory Methods and Applications. Berlin, Germany: Springer-Verlag; 2003.
20. Allaire G. Shape Optimization by the Homogenization Method. New York, NY: Springer-Verlag; 2002. Applied Mathematical Sciences;

vol. 146.
21. Ern A, Guermond J-L. Theory and Practice of Finite Elements. Vol. 159. New York, NY: Springer Science Business Media; 2013.
22. Amstutz S, Dapogny C, Ferrer A. A consistent relaxation of optimal design problems for coupling shape and topological derivatives.

Numerische Mathematik. 2018;140(1):35-94. https://doi.org/10.1007/s00211-018-0964-4
23. Svanberg K. The method of moving asymptotes—a new method for structural optimization. Int J Numer Methods Eng. 1987;24(2):359-373.
24. Greaves GN, Greer AL, Lakes RS, Rouxel T. Poisson's ratio and modern materials. Nature Materials. 2011;10(11):823.

How to cite this article: Ferrer A. SIMP-ALL: A generalized SIMP method based on the topological derivative
concept. Int J Numer Methods Eng. 2019;120:361–381. https://doi.org/10.1002/nme.6140

APPENDIX

SIMP-ALL MATLAB CODE

In this Appendix, we provide a simplified MATLAB code to facilitate the use of the SIMP-ALL interpolation to the reader.
The code is also available at https://github.com/FerrerFerreAlex/SimpALL. The SIMP_all_interpolation.m function is
devised to be used when starting the topology optimization code. The time of computing the interpolation function is
negligible making it as usable as the well-established interpolation functions. The constitutive interpolated tensor and
its derivative are provided since these are usually used when computing the compliance function and the gradient of
the compliance. To obtain the interpolation function, we first compute the shear and bulk modulus and the additional
𝜂 parameters. Then, the coefficients and the rational function are computed. Finally, we differentiate with respect to the
density variable to obtain the derivative.

http://www.sciencedirect.com/science/article/pii/S002199910300487X
http://www.sciencedirect.com/science/article/pii/S0021999105005656
http://www.sciencedirect.com/science/article/pii/S0021999105005656
https://doi.org/10.1007/s00211-018-0964-4
https://doi.org/10.1002/nme.6140
https://github.com/FerrerFerreAlex/SimpALL


FERRER 379

11 % dC ( rho ) : Derivative of the isotropic material constitutive tensor respect

12 % to the density function rho .

13 %

14 % Remark 1: No conditions are required to E1 , E0 , nu1 , nu0 ( except E>0 and

15 % −1<nu < 0.5) , so we could have referred to the strong and weak material as

16 % material A and B . However , we prefer to name them strong and weak to

17 % follow topology optimization naming .

18 %

19 % Remark 2: This version of the SIMP−ALL interpolation function is intended

20 % for 2D plane stress problems .

21 %

22 % Remark 3: SIMP−ALL interpolation evidenced to fulfill the Hashin −Shtrikman

23 % ( HS) bounds for all possible combination of the material properties .

24 % Thus , when the density function takes intermediate values , the resulting

25 % constitutive tensor can be interpreted as an homogenized constitutive

26 % tensor of a micro − structure made of the strong and weak material with a

27 % relative fraction volume of the intermediate density value .

28 %

29 % Remark 4: SIMP−ALL interpolation is free of penalization and heuristic

30 % parameters .

31 %

32 % Remark 5: The interpolation is built on the one hand such that the

33 % constitutive tensor coincides with C0 ( constitutive tensor with E0 , nu0

34 % material properties ) in rho =0 and with C1 ( respectively E1 , nu1 ) in rho =1

35 % and on the other hand such that the constitutive tensor derivative in

36 % rho =0 and rho =1 coincides with the topological derivative of the

37 % compliance dC0 and dC1 , i . e .,

38 % C (0) = C0 , C (1) = C1 ,

39 % dC (0) = dC0 , dC (1) = dC1 .

40 %

41 % Remark 6: We opt for providing dC since when using the compliance

42 % ( integral f ∗u = integral e ( u ) :C( rho ) : e ( u ) ) in a topology optimization

43 % problem , its gradient is directly obtained as − e ( u ) : dC ( rho ) : e ( u ) .

44 %

45 % Shear and bulk modulus

46 mu = @( E , nu ) E /(2 ∗(1+ nu ));

47 kappa = @( E , nu ) E /(2 ∗(1 − nu ));

48 %

49 mu0 = mu( E0 , nu0 );

50 mu1 = mu( E1 , nu1 );

51 %

52 kappa0 = kappa ( E0 , nu0 );

53 kappa1 = kappa ( E1 , nu1 );

54 %

55 % Auxiliar material property

56 eta mu = @( mu, kappa )( kappa ∗mu)/(2 ∗mu+kappa );

57 eta kappa = @( mu, kappa ) mu;

58 %

59 eta mu0 = eta mu ( mu0, kappa0 );

60 eta mu1 = eta mu ( mu1, kappa1 );

1 f u n c t i o n [C , dC ] = s i m p a l l i n t e r p o l a t i o n ( E1 , E0 , nu1 , nu0 )

2 % SIMP−ALL i n t e r p o l a t i o n f u n c t i o n by Alex Fer re r , March 2019 .

3 %

4 % E0 , nu0 : Young modulus and Poisson r a t i o o f the i s o t r o p i c weak m a t e r i a l

5 % E1 , nu1 : Young modulus and Poisson r a t i o o f the i s o t r o p i c s t r o n g m a t e r i a l

6 %

7 % C( rho ) : I s o t r o p i c c o n s t i t u t i v e t e n s o r i n t e r p o l a t e d from the i s o t r o p i c

8 % m a t e r i a l p r o p e r t i e s o f the s t r o n g ( E1 , nu1 ) and the weak m a t e r i a l ( E0 , nu0 )

9 % through the ” d e n s i t y f u n c t i o n ” rho .

10 %

61 %

62 e ta kappa0 = eta kappa ( mu0 , kappa0 ) ;

63 e ta kappa1 = eta kappa ( mu1 , kappa1 ) ;

64 %

65 % I s o t r o p i c f o u r t h o rde r t e n s o r i n Voigt n o t a t i o n



380 FERRER

66 I1 = eye ( 3 ) ; I1 ( 3 , 3 ) = 1 / 2 ;

67 I2 = [ 1 1 0 ; 1 1 0 ; 0 0 0 ] ;

68 Aiso = @( alpha , beta ) a lpha ∗ I1 + beta ∗ I2 ;

69 %

70 % C o e fi c i e n t s ( n= numerator , d = denominator ) o f the r a t i o n a l f u n c t i o n

71 n01 = @( f0 , f1 , eta0 , e ta1 ) −( f 1 − f 0 ) ∗( e ta1 − eta0 ) ;

72 n0 = @( f0 , f1 , e ta0 ) f 0 ∗( f 1 + eta0 ) ;

73 n1 = @( f0 , f1 , e ta1 ) f 1 ∗( f 0 + eta1 ) ;

74 d0 = @( f1 , e ta0 ) ( f 1 + e ta0 ) ;

75 d1 = @( f0 , e ta1 ) ( f 0 + e ta1 ) ;

76 %

77 n01 mu = n01 ( mu0 , mu1 , eta mu0 , eta mu1 ) ;

78 n01 kappa = n01 ( kappa0 , kappa1 , eta kappa0 , e ta kappa1 ) ;

79 %

80 n0 mu = n0 ( mu0 , mu1 , eta mu0 ) ;

81 n0 kappa = n0 ( kappa0 , kappa1 , e ta kappa0 ) ;

82 %

83 n1 mu = n1 ( mu0 , mu1 , eta mu1 ) ;

84 n1 kappa = n1 ( kappa0 , kappa1 , e ta kappa1 ) ;

85 %

86 d0 mu = d0 ( mu1 , eta mu0 ) ;

87 d0 kappa = d0 ( kappa1 , e ta kappa0 ) ;

88 %

89 d1 mu = d1 ( mu0 , eta mu1 ) ;

90 d1 kappa = d1 ( kappa0 , e ta kappa1 ) ;

91 %

92 % Dens i ty f u n c t i o n ( symbol ic in o rde r f o r f u r t h e r d i ff e r e n t i a t i o n )

93 rho = sym ( ’ rho ’ , ’ p o s i t i v e ’ ) ;

94 %

95 % SIMP−ALL as a r a t i o n a l f u n c t i o n

96 f = @( n01 , n0 , n1 , d0 , d1 , rho ) . . .

97 ( n01 ∗(1 − rho ) ∗( rho ) + n0 ∗(1 − rho ) + n1 ∗ rho ) / ( d0 ∗(1 − rho )+ d1 ∗ rho ) ;

98 %

99 mu = f ( n01 mu , n0 mu , n1 mu , d0 mu , d1 mu , rho ) ;

100 kappa = f ( n01 kappa , n0 kappa , n1 kappa , d0 kappa , d1 kappa , rho ) ;

101 %

102 % I s o t r o p i c c o n s t i t u t i v e t e n s o r .

103 Csym = s i m p l i f y ( Aiso (2 ∗mu , kappa − mu ) ) ;

104 %

105 % Shear and bulk modulus d e r i v a t i v e s

106 dmu = d i ff (mu ) ;

107 dkappa = d i ff ( kappa ) ;

108 %

109 % I s o t r o p i c c o n s t i t u t i v e t e n s o r d e r i v a t i v e

110 dCsym = Aiso (2 ∗dmu , dkappa −dmu) ;

111 %

112 % In orde r to ob ta in a handle f u n c t i o n i n s t e a d o f a symbol ic e x p r e s s i o n and

113 % to d i r e c t l y e v a l u a t e the c o n s t i t u t i v e t e n s o r ( and d e r i v a t i v e ) f o r any

114 % v e c t o r o f d e n s i t i e s , we make use o f matlabFunction ( ) .

115 n s t r e = 3 ; % Number o f s t r e s s components i n Voigt n o t a t i o n i n p lane s t r e s s

116 dC = c e l l ( n s t r e , n s t r e ) ;

117 f o r i =1: n s t r e

118 f o r j =1: n s t r e

119 i f Csym ( i , j )==0

120 C{ i , j } = @( rho ) z e r o s ( s i z e ( rho ) ) ;

121 dC { i , j } = @( rho ) z e r o s ( s i z e ( rho ) ) ;

122 e l s e

123 C{ i , j } = matlabFunction ( Csym ( i , j ) ) ;

124 dC { i , j } = matlabFunction ( dCsym ( i , j ) ) ;

125 end

126 end

127 end

128 end



FERRER 381

In the following, we present an example for using the interpolation function in a common finite element context.

1 f u n c t i o n U s e e x a m p l e o f s i m p a l l i n t e r p o l a t i o n

2 % Use example o f the SIMP−ALL i n t e r p o l a t i o n f u n c t i o n f o r computing the

3 %compl iance and i t s g rad i en t , by Alex Fer re r , May 2018 .

4 %

5 % From a given m a t e r i a l i s o t r o p i c p r o p e r t i e s v a l u e s

6 E1 = 1 ;

7 E0 = 0 . 0 1 ;

8 nu1 = 1 / 3 ;

9 nu0 = 1 / 3 ;

10 % Bui ld the SIMP−ALL i n t e r p o l a t i o n o f the c o n s t i t u t i v e t e n s o r as

11 [C , dC ] = s i m p a l l i n t e r p o l a t i o n ( E1 , E0 , nu1 , nu0 ) ;

12 %

13 %In the con tex t o f a FE problem , f o r a g iven number o f gauss p o i n t s ngaus

14 % and number o f e lements nelem o f f o r example

15 nelem = 1000 ;

16 ngaus = 4 ;

17 %

18 % and f o r a g iven a d e n s i t y v a l u e s 0 <= rho <= 1 o f dimension

19 % dim ( rho ) = ngaus x nelem o f f o r example

20 rho = rand ( ngaus , nelem ) ;

21 %

22 % and f o r a g iven s t r a i n t e n s o r v a l u e s i n Voigt n o t a t i o n ( n s t r e = 3)

23 % ob ta ined from t h e s o l u t i o n o f a fi n i t e element problem KU=F o f f o r example

24 n s t r e s = 3 ;

25 s t r a i n = rand ( n s t r e s , ngaus , nelem ) ;

26 %

27 %Although i t would be cheaper with F ∗U, d e fi n i n g dV ( weight ∗ Jacobian )

28 dV = rand ( ngaus , nelem ) ;

29 %the compl iance can be computed as

30 c = 0 ;

31 f o r i s t r e s = 1 : n s t r e s

32 f o r j s t r e s = 1 : n s t r e s

33 s t r = squeeze ( s t r a i n ( j s t r e s , : , : ) ) ;

34 aux = s t r . ∗C{ i s t r e s , j s t r e s } ( rho ) . ∗ s t r . ∗dV ;

35 c = c + sum ( aux ( : ) ) ;

36 end

37 end

38 %

39 % and the g r a d i e n t o f the compl iance as

40 g = z e r o s ( ngaus , nelem ) ;

41 f o r i s t r e s = 1 : n s t r e s

42 f o r j s t r e s = 1 : n s t r e s

43 s t r = squeeze ( s t r a i n ( j s t r e s , : , : ) ) ;

44 g = g − s t r . ∗dC { i s t r e s , j s t r e s } ( rho ) . ∗ s t r ;

45 end

46 end

47 end


	SIMP-ALL: A generalized SIMP method based on the topological derivative concept
	Abstract
	INTRODUCTION
	TOPOLOGY OPTIMIZATION FORMULATION
	The exact topology optimization problem
	The relaxed topology optimization problem

	TOPOLOGICAL DERIVATIVE
	CONNECTION BETWEEN THE TOPOLOGICAL DERIVATIVE AND HASHIN-SHTRIKMAN BOUNDS
	RATIONAL FUNCTIONS
	SIMP-ALL METHOD
	COMPARISON BETWEEN SIMP AND SIMP-ALL
	Interpolation function comparison
	Numerical examples comparison

	CONCLUSIONS
	REFERENCES


