








































Stress-accurate Mixed FEM for soil failure under shallow

foundations involving strain localization in plasticity

Lorenzo Benedetti, Miguel Cervera, Michele Chiumenti
International Center for Numerical Methods in Engineering (CIMNE),

Technical University of Catalonia (UPC), Edificio C1, Campus Norte,

Jordi Girona 1-3, 08034 Barcelona, Spain

Corresponding author: lbenedetti@cimne.upc.edu

Abstract

The development of slip lines, due to strain localization, is a common cause for
failure of soil in many circumstances investigated in geotechnical engineering. Through
the use of numerical methods -like finite elements- many practitioners are able to take
into account complex geometrical and physical conditions in their analyses. However,
when dealing with shear bands, standard finite elements display lack of precision, mesh
dependency and locking. This paper introduces a (stabilized) mixed finite element
formulation with continuous linear strain and displacement interpolations. Von Mises
and Drucker-Prager local plasticity models with strain softening are considered as
constitutive law. This innovative formulation succeeds in overcoming the limitations
of the standard formulation and provides accurate results within the vicinity of the
shear bands, specifically without suffering from mesh dependency. Finally, 2D and
3D numerical examples demonstrate the accuracy and robustness in the computation
of localization bands, without the introduction of additional tracking techniques as
usually required by other methods.

Contents

1 Introduction 3

2 ε− u mixed finite elements 5
2.1 Strong form . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
2.2 Weak form . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
2.3 Discrete Galerkin formulation . . . . . . . . . . . . . . . . . . . . . . . . . . 6
2.4 Variational Multiscale Stabilization . . . . . . . . . . . . . . . . . . . . . . . 7

2.4.1 ASGS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
2.4.2 OSGS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9

3 Implementation details 10
3.1 ASGS implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
3.2 OSS implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

4 Drucker-Prager Plasticity Model 12
4.1 Definition of the space of admissible stresses . . . . . . . . . . . . . . . . . . 12
4.2 Return mapping algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
4.3 Constitutive Elasto-Plastic Tangent operator . . . . . . . . . . . . . . . . . 15
4.4 Apex return mapping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
4.5 Apex Consistent Elasto-Plastic Tangent operator . . . . . . . . . . . . . . . 17
4.6 Softening behaviour . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
4.7 Plastic dissipation rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

1



5 Numerical Examples 18
5.1 Prandtl’s punch problem with J2 plasticity . . . . . . . . . . . . . . . . . . 19
5.2 Prandtl’s punch problem with Drucker Prager plasticity . . . . . . . . . . . 22
5.3 Rigid footing on a 3D cube . . . . . . . . . . . . . . . . . . . . . . . . . . . 27

6 Conclusion 27

7 Acknowledgments 29

Appendix A Differentiation of the plastic strain tensor εp 29

References 31

2



1 Introduction

The stability analysis of a slope, both in the small scale of a road embankment and in
the larger one of a mountain slope, is a very frequent example of geotechnical engineering.
The prevention of failure shear bands is a fundamental requirement to ensure the safety
of a volume of soil. In the geotechnical practice, standard design procedures require
the computation of a safety factor. This is usually done by comparing the value of the
acting forces to the value of the resisting ones through simplified methods. The first
recorded case of stability analysis was performed by S. Hultin and K. Pettersson in 1916
(documented only in 1955), for the Stigberg Quay in Gothenburg (Sweden), where the
slip surface was taken to be circular and the sliding mass was divided into slices. In the
same period, the first major result was the Bishop method, proposed by Prof. A. Bishop
as an extension of the “Swedish Slip Circle Method” [1]. Although these methods are very
useful as preliminary evaluation tool, the validity of the approach is strongly limited when
simplified assumptions on soil mechanical constitutive law, geometry and slip lines shape
are required a priori. The introduction of the Finite Elements Method represented a sound
alternative to tackle detailed problems of geotechnical nature, thanks to their potential
versatility and vast application. FEM makes possible the study of materials failure and
its complex coupling with environmental actions such as seepage flow.

In the last three decades, the scientific community invested a considerable effort seeking
a consistent description of failure modes through the use of numerical methods. A slip
line is a physical discontinuity created by a localization of strains, as it is depicted in
part b of Figure 1 reported from Cervera et al. [2]. From a mathematical stand point,
the numerical discontinuity in the field variables can be treated in various ways. In the
approach adopted in this work the strain localization is assumed to occur in a band of
finite width where the displacements are continuous and the strains are discontinuous but
bounded [3]. Actually, this is a regularization of the discontinuity over a finite length, as
it is possible to see in part a of Figure 1.

It is well known that this kind of “smeared” approach poses some challenges. The
standard irreducible formulation of FEM is known to be heavily affected by spurious mesh
dependence when softening behavior occurs and, consequently, slip lines evolution is biased
by the orientation of the mesh [4]. Moreover, in the case of isochoric behavior, unbounded
pressure oscillations arise and the consequent locking of the stresses pollutes the numerical
solution. Both problems can be shown not to be related to the mathematical statement
of the continuous problem but instead to its discrete (FEM) counterpart [5, 6].

Mixed formulations in terms of both the pressure and the flow velocity are classical in
the numerical solution of Darcy’s equation [7, 8, 9, 10, 11, 12], where the focus is placed
in achieving enhanced accuracy in the velocity. The mathematical structure of Darcy’s
and Cauchy’s problems is analogous, with the pressure and velocity fields in the first one
corresponding to the displacement and stress fields in the second one. Therefore, similar
mixed methods can be applied to both problems.

In the last decade, the use of mixed finite elements for the description of failure me-
chanics has proved to be extremely useful. Initially, a stabilized displacement-pressure
(u/p) formulation was introduced to address the problem of incompressibility in elasto-
plasticity [13]. Later, it was shown that a continuum isotropic damage constitutive law can
be fitted in such formulation [14]. Recently, Badia and Codina [7], for the Stokes-Darcy
problem, and then Cervera et al. [15], for the linear and nonlinear mechanical problem,
discussed the local convergence properties of mixed formulations. From these, it follows
that the reliability in the prediction of strain concentration bands depends directly on
the capability of the method to converge to a meaningful solution. In nearly singular
situations, such as when a slip line forms, the u/p formulation presents satisfactory global
convergence in the interpolated variables, but it lacks of local convergence in the stress

3



Figure 1: Localized failure: strong (right) and smeared (left) discontinuities

field, although a large number of tests showed a well behaved solution in many cases [16].
In order to achieve local convergence of stresses, and, in turn, objectivity of results with

respect of the mesh alignment, a stabilized mixed strain-displacement (ε/u) formulation
was developed by Cervera et al. [17, 18] and applied to problems involving softening
isotropic damage materials. In these references, it is shown that the enhancement of
accuracy attained by the use of mixed strain-displacement (ε/u) formulation overcomes
the spurious mesh-bias dependency observed when using the standard irreducible FEM
formulation.

In this work, the strain-displacement mixed formulation is extended for the purpose of
solving problem involving compressible and incompressible plasticity. The effectiveness of
the formulation, outperforming both the standard irreducible and the mixed displacement-
pressure (u/p) approaches, is demonstrated in examples involving failure and strain con-
centration bands.

The paper is organized as follows. First, the mixed finite element method is derived
and the mathematical basis are presented. Then, the Drucker-Prager constitutive model is
introduced as a pressure-dependent generalization of the incompressible Von Mises model.
Finally, numerical examples are reported in order to demonstrate the robustness and the
accuracy of the proposed mixed finite elements.

4



2 ε− u mixed finite elements

2.1 Strong form

Consider a body occupying the space domain Ω, its boundary being ∂Ω. The field of total
strain has be compatible with the displacement field, so that

−ε+∇su = 0 (1)

where u is the field of displacements and ε is the field of infinitesimal strains. The
equilibrium of the body in a (quasi-)static mechanical problem is described by the following
equation:

∇ · σ + f = 0 (2)

where σ is the Cauchy stress tensor and f are the external forces applied to the body.
The symbol ∇ · (·) refers to the divergence operator whereas ∇s(·) is used to denote the
symmetric gradient. In small strain plasticity the strain tensor is decomposed additively
as

ε = εe + εp (3)

with εe the elastic strain tensor and εp the plastic strain tensor. The constitutive equation
can be written as

σ = C : εe = C : (ε− εp) (4)

where C is the fourth order elastic constitutive tensor. Now, substituting (4) in (2), the
problem reads

−ε+∇su = 0

∇ · [C : (ε− εp)] + f = 0
(5)

In order to obtain a symmetric system, the first equation is pre-multiplied by the elastic
constitutive tensor C:

−C : ε+ C : ∇su = 0

∇ · [C : (ε− εp)] + f = 0
(6)

Hence, (6) is the final system of partial differential equations in strong form in terms of the
total strains ε and displacements u for the mechanical problem involving plasticity. The
mixed problem is solved for both unknown fields [u, ε] introducing appropriate boundary
conditions and evolution laws for the plastic strain field [19]. For the sake of shortness
and recalling (4), it can be written:

−C : ε+ C : ∇su = 0

∇ · σ + f = 0
(7)

2.2 Weak form

The weak form of the set of equations presented in (6) is:

−
∫
Ω
γ : C : ε+

∫
Ω
γ : C : ∇su = 0 ∀γ ∈ G

∫
Ω
v : (∇ · σ) +

∫
Ω
v : f = 0 ∀v ∈ V

(8)

5



The functional space V represents the set of test functions v for the displacement field
u, whereas G is the set of test function tensors for the strain ε. Integrating by parts the
second equation, it can be written:

−
∫
Ω
γ : C : ε+

∫
Ω
γ : C : ∇su = 0 ∀γ ∈ G

∫
Ω
∇sv : σ = F (v) ∀v ∈ V

(9)

where the boundary terms accounting for stresses on the boundary and body forces f are
collected in the term

F (v) =

∫
∂Ω

v : (σ · n̂) +
∫
Ω
v : f (10)

in which n̂ represents the outward normal vector with respect to the boundary ∂Ω. From
the mathematical requirements of the problem in (9), V will be in the space of square
integrable functions v which are at least square integrable and have square integrable first
derivative, whereas G will belong to the set of square integrable symmetric tensors γ.

2.3 Discrete Galerkin formulation

The discretized version of the continuous weak form is obtained considering a finite set
of interpolating functions for both the solution and the test function. For this reason the
discrete functional spaces are a subset of their continuous version:

Gh ⊂ G ⊆ L2(Ω)dim×dim and Vh ⊂ V ⊆ H1(Ω)dim (11)

where dim is the number of the dimensions of the domain of the problem. Now, the strain
tensor ε and the displacement field u are approximated as

ε → εh =
npts∑
i=1

γ
(i)
h ε

(i)
h γh ∈ Gh

u → uh =
npts∑
i=1

v
(i)
h u

(i)
h vh ∈ Vh

(12)

The system of equations (9), in its discrete form, reads

−
∫
Ω
γh : C : εh +

∫
Ω
γh : C : ∇

suh = 0 ∀γh ∈ Gh

∫
Ω
∇svh : σ = F (vh) ∀vh ∈ Vh

(13)

In the following, we will introduce equal interpolation finite element spaces for displace-
ments and strains. Particularly interesting will be the case of linear and bilinear interpo-
lations, i.e. P1P1 and Q1Q1 elements. However, it is well known that the stability of a
discrete mixed formulation depends from the choice of the finite element spaces Gh and Vh
as stated by the Inf-Sup condition [20]. Using equal order of interpolation does not satisfy
the previous condition; consequently, a Variational Multiscale Stabilization procedure is
now introduced.

6



2.4 Variational Multiscale Stabilization

The Variational Multiscale Stabilization was developed in first instance by Hughes et al.
[21] and then generalized by Codina [22]. This technique modifies appropriately the vari-
ational form of the problem in order to provide the required numerical stability. The
corresponding modified Inf-Sup condition is milder than the original one and it holds for
most common equal order finite element spaces [23].

The stabilization procedure supposes that the solution of variables (ε, u) is given by
a resolvable scale (εh,uh), calculated on the FEM mesh, and an irresolvable one (ε̃, ũ),
called subscale solution:

ε = εh + ε̃
u = uh + ũ

(14)

The subscale variables and their test functions pertain to their respective functional spaces
G̃ for the strain subscale and Ṽ for the displacement subscale. This initial hypothesis
allows us to consider extended solution spaces given by G ≈ Gh⊕ G̃ and V ≈ Vh⊕ Ṽ. The
subscale part (ε̃, ũ) can be thought as a high frequency solution that cannot be captured
with the coarse FEM mesh.

The plastic strains εp are computed by the return mapping algorithm, given the stress
tensor σ = C : (ε− εp) as input data. Since the total strain field ε has both coarse and
subscale contribution, then also the plastic strain tensor εp could present a corresponding
subscale part. However, since the subscale contribution is assumed to be small, the plastic
strain will be approximated as:

εp = εp (σ) ≈ εp (σh) (15)

with
σh = C : [εh − εp (σh)] (16)

Within this enhanced functional setting, the set of equations can be written as:

−
∫
Ω
γh : C : (εh + ε̃) +

∫
Ω
γh : C : ∇

s (uh + ũ) = 0 ∀γh ∈ Gh

∫
Ω
∇svh : [C : (εh + ε̃− εp)] = F (vh) ∀vh ∈ Vh

−
∫
Ω
γ̃ : C : (εh + ε̃) +

∫
Ω
γ̃ : C : ∇s (uh + ũ) = 0 ∀γ̃ ∈ G̃

∫
Ω
ṽ : (∇ · [C : (εh + ε̃− εp)]) +

∫
Ω
ṽ : f = 0 ∀ṽ ∈ Ṽ

(17)

Rewriting the second group of equations, tested against the subscale test functions, and
assuming that the subscale (ε̃, ũ) vanishes on the boundary, it follows

−
∫
Ω
γ̃ : C : ε̃+

∫
Ω
γ̃ : C : ∇sũ =

∫
Ω
γ̃ : C : [εh −∇suh] γ̃ ∈ G̃

∫
Ω
∇sṽ : C : ε̃ = −

∫
Ω
ṽ : [∇ · σh + f ] ṽ ∈ Ṽ

(18)

The last system of equations shows that the solution of the subscale variables depends on
the residuals of the strong form of the equations upon substitution of the FEM solution.
Defining R1,h and R2,h as the residuals of the equations defined as:

R1,h = −C : εh + C : ∇suh

R2,h = ∇ · σh + f
(19)

7



equations (18) represent the projection of the residuals on the subscale grid. They can be
rewritten as:

P̃1 (−C : ε̃+ C : ∇sũ) = P̃1 (C : εh − C : ∇suh) = −P̃1 (R1,h)

P̃2 (∇sṽ : C : ε̃) = −P̃2 (∇ · σh + f) = −P̃2 (R2,h)
(20)

Following the work of Codina [22], it is possible to approximate the subscale variables
within each element as:

ε̃ = τεC−1 : P̃1 (R1,h)

ũ = τu P̃2 (R2,h)

(21)

where τu and τε are the stabilization parameters that, for this problem, will be computed
as:

τu = cu
hL0
µ

and τε = cε
h

L0
(22)

In the last expression, cu and cε are arbitrary positive numbers; µ is a mechanical param-
eter of the problem, usually chosen as twice the shear modulus of the material G; h is
the representative size of the finite element mesh and L0 is a characteristic length of the
problem. To complete the stabilization method, an appropriate projection operator has
to be selected in order to be able to compute the subscale variables.

2.4.1 ASGS

In the Algebraic Subgrid Scale Stabilization method [7], the projection operator is taken
as the identity, that is:

P̃ = I ⇒
ε̃ = τε (−εh +∇suh)

ũ = τu (∇ · σh + f)
(23)

Back-substituting in the system of equations tested against the finite element functions
and rearranging:

− (1− τε)
∫
Ω
γh : C : εh + (1− τε)

∫
Ω
γh : C : ∇

suh

+τu

∫
Ω
γh : C : ∇

s (∇ · σh + f) = 0 ∀γh ∈ Gh

∫
Ω
∇svh : [C : ((1− τε) εh + τε∇suh − εp)] = F (vh) ∀vh ∈ Vh

(24)

Now, integrating again by parts in the first equation and taking γh = 0 on ∂Ω, the final
system of equations reads:

− (1− τε)
∫
Ω
γh : C : (εh −∇

suh)

−τu
∫
Ω
[∇ · (C : γh)] · [∇ · σh + f ] = 0 ∀γh ∈ Gh

∫
Ω
∇svh : C : [(1− τε) εh + τε∇suh − εp] = F (vh) ∀vh ∈ Vh

(25)

The first term in the first equation represents a projection (smoothing) of the strain
field obtained by differentiation of the discrete displacement field. The second additional

8



term is given by the displacement subscale that, in turn, depends on the residual of the
strong form of the equilibrium equation. The second equation is related to the balance of
momentum. Defining the stabilized total strain field as:

εstab = (1− τε) εh + τε∇suh (26)

the system of equations (25) reads:

− (1− τε)
∫
Ω
γh : C : (εh −∇

suh)

−τu
∫
Ω
[∇ · (C : γh)] · [∇ · σh + f ] = 0 ∀γh ∈ Gh

∫
Ω
∇svh : C : (εstab − εp) = F (vh) ∀vh ∈ Vh

(27)

2.4.2 OSGS

In the Orthogonal Subgrid Scale Stabilization [7], the projection operator selected to solve
the unresolvable scale variables is the orthogonal projector

P̃⊥h (X) = I (X)− Ph (X) (28)

where Ph represents the projection over the finite element mesh. It represents the L
2

projection of X, or least square fitting, on the finite element space [13]. It is performed
taking advantage of the orthogonality condition∫

Ω
(XΠ −X) : ηh = 0 ∀ηh ∈ Vh or Gh (29)

where XΠ is the projected value of X on the mesh nodes. Substituting in (21), the
subscale variables ũ and ε̃ can be approximated as:

ε̃ = τεC−1 : [R1,h − Ph (R1,h)]

ũ = τu [R2,h − Ph (R2,h)]
(30)

with the residuals R1,h,R2,h defined in (19). First of all, as Ph (εh) = εh, the strain
subscale is given by

ε̃ = τε [(−εh +∇suh)− Ph (−εh +∇suh)] = τε [∇suh − Ph (∇suh)] (31)

Now, comparing the equations (13) and (29), the following substitution is done:∫
Ω
γh : C : Ph (∇

suh) =

∫
Ω
γh : C : εh (32)

For the displacement subscale, assuming that Ph (f) = f , it can be written:

ũ = τu [∇ · σh − Ph (∇ · σh)] (33)

Back-substituting in the set of equations of the problem, it reads:

− (1− τε)
∫
Ω
γh : C : (εh −∇

suh)+

+τu

∫
Ω
γh : C : ∇

s [∇ · σh − Ph (∇ · σh)] = 0 ∀γh ∈ Gh

∫
Ω
∇svh : C : [(1− τε) εh + τε∇suh − εp] = F (vh) ∀vh ∈ Vh

(34)

9



Integrating by parts the second equation and rearranging, the final set of equations is:

− (1− τε)
∫
Ω
γh : C : (εh −∇

suh)+

−τu
∫
Ω
[∇ · (C : γh)] · [∇ · σh − Ph (∇ · σh)] = 0 ∀γh ∈ Gh

∫
Ω
∇svh : C : (εstab − εp) = F (vh) ∀vh ∈ Vh

(35)

The set of equations with OSGS stabilization resembles the one for the ASGS, except for
the second term in the first equation. In order to compute the projection of stresses at
each time step, we can recall expression (29), and write∫

Ω
(Πσ −∇ · σh) : ηh = 0 ∀ηh ∈ Gh (36)

and, with the additional projection equation, it reads:

− (1− τε)
∫
Ω
γh : C : (εh −∇

suh)

−τu
∫
Ω
[∇ · (C : γh)] · [∇ · σh −Πσ] = 0 ∀γh ∈ Gh

∫
Ω
∇svh : C : [εstab − εp] = F (vh) ∀vh ∈ Vh

∫
Ω
(Πσ −∇ · σh) : ηh = 0 ∀ηh ∈ Gh

(37)

The OSGS scheme is less diffusive than the ASGS scheme [24]. However, this comes at
the price of solving an additional equation: in the implementation details it is shown how
this problem can be circumvented.

3 Implementation details

In the presented formulation, the presence of the non-linear plastic strains εp = εp (σ)
requires an iterative procedure to deal with the nonlinearity of the system. Iterative
solution schemes, such as Picard or Newton-Raphson methods, need to be introduced.
Constitutive laws involving plasticity are usually written in terms of rate equations and,
consequently, the matrices involved in the resulting algebraic set of equations are tangent.
Hence, the use of the Newton-Raphson scheme will be considered in the following.

Consider the nonlinear multidimensional-multivariable problem

F (X) = 0 (38)

where X = [ε,u]
T
is the unknown vector. Such problem can be solved starting from a

Taylor approximation around the solution point at iteration i+1 in a particular time step
n+ 1:

F i+1n+1 ≈ F
i
n+1 + J

i
n+1 δX

i+1 (39)

where the Jacobian matrix J is defined as

J =
∂F

∂X
(40)

10



Assuming that F i+1n+1 = 0, an iterative correction is computed as

δXi+1 = −
[
J in+1

]−1
F in+1 (41)

and the solution vector is updated as

Xi+1 = Xi + δXi+1 (42)

The Jacobian matrix can be found by differentiating the set of equation with respect to
the unknowns variables X = [ε,u]

T
at iteration i. The advantage of such method is a

quadratic convergence rate in the iteration at each time step.

3.1 ASGS implementation

In the case of the ASGS scheme, differentiating the system of equations at iteration i of
time step n+ 1, the Jacobian matrix presents the mathematical structure:

J in+1 =

[
M τ Gτ
Dτ Kτ

]i
n+1

(43)

where M is a mass-like projection matrix, G is a gradient matrix, D is a divergence
matrix and K is the stiffness matrix. The subscript τ refers to the fact that those matrices
incorporate stabilization terms. Differentiating (25), within the hypothesis introduced in
equation (15) that the plastic strain depends only on εh, the previous matrices read:

M τ = − (1− τε)
∫
Ω
Nε

TCNε − τu
∫
Ω
CBBT Cn+1ep (44)

Gτ = (1− τε)
∫
Ω
Nε

TCB (45)

Dτ =

∫
Ω
BT

[
Cn+1ep − τεC

]
Nu (46)

Kτ = τε

∫
Ω
BTCB (47)

where Nε and Nu are the matrices of shape functions of the respective strain and displace-
ment fields and B is the matrix of the gradient of those shape functions. The resulting
algebraic system of equations is, in general, not symmetric. Note that disregarding the
terms due to plasticity, the system matrix is symmetric and it coincides with the one pre-
sented in Cervera et al. [17, 18]. Details on the differentiation of the plastic strain tensor
εp with respect to the problem unknown εh are given in the Appendix A.

3.2 OSS implementation

The OSS implementation is identical to the ASGS implementation, except for the ad-
ditional projection of the nodal stresses. The projection equation gives some additional
terms in the Jacobian matrix when differentiating (37):

−


 M τ Gτ DTΠDτ Kτ 0

DΠ 0 MΠ


i
n+1


 δεhδuh

δΠh


i+1
n+1

=


 R1,hR2,h

R3,h


i
n+1

(48)

where (δεh, δuh, δΠh) are the iterative corrections for (εh,uh,Πh) in the Newton-Raphson
scheme. The added projection matrices are computed as:

MΠ = −
∫
Ω
Nε

TNε (49)

11



DΠ =

∫
Ω
BTNε (50)

Alternatively to this procedure, a staggered scheme can be devised. First, the projection
of the stresses Πh is computed at the beginning of the time step. Then, Πh is used for the
solution of (εh,uh). With this substitution, the matrix depicted in (48) can be formally
condensed [13] and it becomes:

−
[
M τ −DTΠM

−1
Π DΠ Gτ

Dτ Kτ

]i
n+1

[
δεh
δuh

]i+1
n+1

=

[
R1,h
R2,h

]i
n+1

(51)

This scheme is preferred with respect to the monolithic one due to the reduced computation
time required.

4 Drucker-Prager Plasticity Model

The Drucker-Prager model is a pressure dependent plasticity model frequently used in
geomechanics. It has a singular point in correspondence of the maximum allowed mean
stress. In the following sections, this particular model is introduced and details on the
return mapping are given.

4.1 Definition of the space of admissible stresses

The Drucker-Prager plasticity model may be constructed as a linear combination of a J2
Von Mises plasticity model and a Pure Pressure plasticity model. The Von Mises yield
criterion states that a material reaches the elastic limit when the equivalent octaedral
stress is equal to a known uniaxial maximum admissible threshold:

f (σ, q) =
√

3J2(σ)− rd (q) = 0 (52)

where q is a stress-like hardening/softening variable. The value rd (q) represents a limit in
the admissible stress with respect to the second invariant of the deviatoric tensor J2(σ).
The Pure Pressure yield criterion relates the hydrostatic pressure with a maximum ad-
missible threshold:

f (σ, q) =
1

3
I1(σ)− rp (q) = p− rp (q) = 0 (53)

where the value rp (q) represents a limit in the admissible pressure. In the Drucker-Prager
model, the angle of friction ϕ is introduced to relate the admissible deviatoric stresses to
the pressure as:

f (σ, q) =
[√

3J2(σ)− rd (q)
]
+ a

[
1

3
I1(σ)− rp (q)

]
tan(ϕ) = 0 (54)

Plotting this yielding sufrace on the (p, J2) plane, the result is a line with a slope equal
to tan(ϕ) (Figure 2). In the principal stress Haig-Westergaard space, the Drucker-Prager
yield surface appears as a symmetric cone with the axis coinciding with the hydrostatic
pressure and a circular trace on the octahedral plane (Figure 3). The parameter a = ±1
controls the sign of the pressure part and the orientation of the admissible plane of stresses.
This means that the material may fail due to high tension states (a = 1) or due to high
compression states (a = −1). The point (pmin, 0) in Figure 2 represents the vertex of the
cone, the minimum allowed mean stress state. In geotechnical engineering, the value of
a = 1 is usually assumed. Taking advantage of some trigonometric identities, it is possible
to rewrite the surface of failure explicitly as:

f (σ, q) = ρ
(√

3J2(σ)− rd (q)
)
+ a (1− ρ)

(
1

3
I1(σ)− rp (q)

)
= 0 (55)

12



p

√
3J2

pmin

ϕ

Figure 2: Drucker-Prager elastic domain in the (p, J2) plane

Figure 3: Drucker-Prager elastic domain in the principal stress Haig-Westergaard space

where ρ = 1/(1 + tan(ϕ)). In this work, the pressure threshold is taken as rp = 0 to allow
a direct comparison between J2 incompressible plasticity and Drucker-Prager plasticity.
On the other side, the deviatoric stress threshold reads:

rd (q) = σy − q(ξ) (56)

where q(ξ) is the hardening/softening function and ξ is an internal strain-like parameter.
The function q(ξ) controls the value of the intersection between the yielding surface and
the deviatoric axis in Figure 2. In the linear softening case, the function rd (ξ) is:

rd (ξ) =

{
σy

(
1− HS

σy
ξ
)

for 0 ≤ ξ ≤ σy
HS

0 for
σy
HS

≤ ξ ≤ ∞
(57)

whereas, in the case of exponential softening, rd (ξ) assumes the form:

rd (ξ) = σy exp

(
−2HS
σy

ξ

)
for 0 ≤ ξ ≤ ∞ (58)

13



Rewriting the invariants J2(σ) =
1
2
∥devσ∥ and I1(σ) = 13 trσ, the failure criteria takes

the form:

f (σ, q) = ρ

(√
3

2
∥devσ∥ − (σy − q (ξ))

)
+ a (1− ρ)

1

3
trσ = 0 (59)

4.2 Return mapping algorithm

Assuming associative plasticity and the existence of a plastic potential that coincides with
the definition of the admissible stress surface f (σ, q), the evolution equations for the
plastic variables read:

ε̇p = γ̇
∂f (σ, q)

∂σ

ξ̇ = γ̇
∂f (σ, q)

∂q

(60)

where γ̇ is the plastic multiplier or plastic consistency parameter. Substituting the defini-
tion of the failure surface and differentiating:

ε̇p = γ̇ ∂σf (σ, q) = γ̇

[
ρ

√
3

2

devσ

∥devσ∥
+

a (1− ρ)
3

1

]

ξ̇ = γ̇ ∂qf (σ, q) = γ̇ρ

(61)

Additionally, the Karush-Kuhn-Tucker and consistency conditions hold:

γ ≥ 0, f (σ, q) ≤ 0, γf (σ, q) = 0 (62)

if f (σ, q) = 0 ⇒ γ̇ ≥ 0, ḟ (σ, q) ≤ 0 and γ̇ḟ (σ, q) = 0 (63)
Given the last set of conditions, γ̇ is computed as [19]:

γ̇ =
⟨∂σf : C : ε̇⟩

∂f

∂σ
: C :

∂f

∂σ
+

∂f

∂q

dq

dξ

∂f

∂q

(64)

The time derivative of the evolution equations of the plastic variables can be approxi-
mated introducing a Backward-Euler scheme with time steps of length ∆t, considering
the [tn, tn+1] span. Then, the discrete-in-time version of (61) reads:

ε̇p ≈
ε
(n+1)
p − ε

(n)
p

∆t
=

γ(n+1) − γ(n)

∆t

[
ρ

√
3

2

devσ(n+1)∥∥devσ(n+1)∥∥ + a (1− ρ)3 1
]

ξ̇ ≈
ξ(n+1) − ξ(n)

∆t
= ρ

γ(n+1) − γ(n)

∆t

(65)

The trial state is defined at step n+ 1 with the plasticity variables frozen at step n:

ε
(n+1)
p,trial = ε

(n)
p

ξ
(n+1)
trial = ξ

(n)

(66)

Therefore, the trial stresses are:

σ
(n+1)
trial = C :

(
ε(n+1) − ε(n)p

)
q
(n+1)
trial = q

(n)

(67)

14



Plasticity occurs if f
(n+1)
trial ≥ 0. The trial yielding function is:

f
(n+1)
trial = ρ

(√
3

2

∥∥∥devσ(n+1)trial ∥∥∥− (σdy − q(n+1)trial )
)

+ a (1− ρ)
(
1

3
trσ

(n+1)
trial

)
(68)

The change of plastic multiplier ∆γ(n+1) = γ(n+1) − γ(n) is computed with the discrete
counterpart of (64) as:

∆γ(n+1) =

⟨
f
(n+1)
trial

⟩
(1− ρ)2K + 3Gρ2 + ρ2 dq

dξ

(n+1)
(69)

where K is the bulk modulus and G is the shear modulus of the material. Notice that
q
(
ξ(n+1)

)
implicitly depends on the value of ∆γ(n+1) as shown in (65).

4.3 Constitutive Elasto-Plastic Tangent operator

The constitutive elasto-plastic tangent fourth order tensor can be written as a function of
γ̇. Defining:

D =
∂f

∂σ
: C :

∂f

∂σ
+

∂f

∂q

dq

dξ

∂f

∂q
(70)

On one hand, the constitutive elastoplastic tensor in continuous form is [25]:

Cep = C−

(
C : ∂f

∂σ

)
⊗
(
C : ∂f

∂σ

)
D

(71)

On the other hand, considering the discrete Backward Euler time integration, the algo-
rithmic consistent constitutive elasto-plastic tensor can be computed as:

C(n+1)ep =
dσ(n+1)

dε(n+1)
(72)

Carrying out the differentiation, it yields:

C(n+1)ep = C

−

[
ρ2G

√
3
2
n
(n+1)
d,trial + a (1− ρ)K1

]
⊗
[
ρ2G

√
3
2
n
(n+1)
d,trial + a (1− ρ)K1

]
D (n+1)

−∆γ(n+1)(2G)2ρ
√

3

2

[(
I− 1

3
1⊗ 1

)
− n(n+1)d,trial ⊗ n

(n+1)
d,trial

]
∥∥∥devσ(n+1)trial ∥∥∥

(73)
where D (n+1) is the discrete counterpart of (70):

D (n+1) =
[
(1− ρ)2K + ρ23G

]
− ρ3

dq
(
ξ(n) + ρ∆γ(n+1)

)
dξ

(74)

and n
(n+1)
d,trial is the unit vector in the deviatoric stress direction:

n
(n+1)
d,trial =

devσ
(n+1)
trial∥∥∥devσ(n+1)trial ∥∥∥ (75)

15



p

√
3J2

pmin

Eσ

σtrial

σ̂trial
√
3J2 > 0

@
√
3J2

Zone 1
Zone 2

Figure 4: Drucker-Prager domain in the (J2, p) plane with return mapping zones

4.4 Apex return mapping

The Drucker-Prager model presents a singular point in the yielding surface: the apex of
the cone. For the return mapping in those cases when this point is involved, an “ad-hoc”
procedure is necessary. In the literature, deBorst [26] and Perić and de Souza Neto [27]
proposed some general methods to tackle this problem. In this case, a particular return
mapping algorithm is devised in order to have a scalar condition on the components of
Cauchy stress tensor.

Consider the yielding surface function in equation (59). The minimum value of the
admissible pressure defines the apex of the cone in Figure 4 and its value is:

pmin =
ρ (σy − q)
a (1− ρ)

(76)

The part located outside the admissible stress space can be divided in two zones by consid-
ering the orthogonal line to the yielding surface passing through the apex (Figure 4). The
standard return mapping, described in the previous section, is used in the cases where the
trial stress state falls in the “Zone 1” domain. When the trial stress is in the complemen-
tary “Zone 2” of the cone, the differentiation of the yielding surface cannot be performed
since the normal vector to the yielding surface does not have a unique definition. However,
a family of sub-differentials of the yielding surface exists and the return mapping can be
performed, for example, by considering the principal components pressure p and deviatoric
stress devσ to satisfy some particular conditions.

In order to find the condition to discriminate the two situations, consider the return
mapping for the deviatoric components, i.e. along the vertical axis of Figure 4. Once the
variation of the plastic multiplier is known, the deviatoric components of the stress tensor
are updated with the new plastic strains as:∥∥∥devσ(n+1)∥∥∥ = ∥∥∥devσ(n+1)trial ∥∥∥−∆γ(n+1)ρ

√
3

2
2G (77)

As the norms are positive definite, it follows that:

∆γ(n+1) ≤

∥∥∥devσ(n+1)trial ∥∥∥
ρ
√

3
2
2G

(78)

If this condition is verified, then the return mapping is made through the standard pro-
cedure described in the previous section. Otherwise, the return mapping will be made to
the apex of the Drucker-Prager cone.

16



The stress at the apex point is:

f(σ, q) = 0 and p = pmin ⇒ ∥devσ∥ = 0 (79)

Calling ntrial = napex the unit vector that points from σtrial to the vertex of the cone
(pmin, 0), the plastic flow is:

ε̇p = γ̇napex (80)

and in discrete form
ε(n+1)p = ε

(n)
p +∆γ

(n+1)n(n+1)apex (81)

The trial stress is
σ
(n+1)
trial = devσ

(n+1)
trial + p

(n+1)
trial 1 (82)

and the stress after the return mapping reads:

σ(n+1) = pmin1 (83)

Therefore:

ε(n+1)p = ε
(n)
p +

[
a
p
(n+1)
trial − pmin

3K
1+

devσ
(n+1)
trial

2G

]
= ε(n)p +∆ε

(n+1)
p (84)

Notice that the value of pmin depends on the value of the isotropic hardening q = q(ξ).
Consequently, an iterative procedure is necessary in order to evaluate correctly the plastic
multiplier.

4.5 Apex Consistent Elasto-Plastic Tangent operator

In the case of return mapping to the apex, the consistent constitutive tensor is the null
fourth tensor. This means that once the stress state arrives at the vertex of the cone, it
will remain at the apex unless unloading or neutral loading occurs.

4.6 Softening behaviour

In a softening process, the energy dissipated by inelastic behaviour is linked with the
fracture energy Gf [28], defined by unit surface. When using a plastic model defined in
terms of stress and strain, the dissipated plastic energy Wp is defined by unit volume. In
the discrete FE setting, these two definitions are related through a characteristic length
lch, connected to the mesh resolution:

Wp =
Gf
lch

(85)

In the plastic model, the rate of plastic work is computed as:

Ẇp = σ : ε̇p = σ̄ ˙̄εp = α r (ξ) ξ̇ (86)

where σ̄ is the equivalent Drucker-Prager stress:

σ̄ = ρ

√
3

2
∥devσ∥+ (1− ρ) a

1

3
trσ tan (ϕ) = ρ (σy − q) = r (ξ) (87)

and ˙̄εp is the rate of equivalent plastic strain:

˙̄εp = ∥ε̇p∥ = γ̇

[
ρ

√
3

2
+ a (1− ρ)

]
(88)

17



and, finally, α is a scaling factor depending on the friction angle,

α =

√
3

2
+

1− ρ
ρ

(89)

In both the linear and exponential softening cases, where r (ξ) is defined respectively
by (57) and (58), the total plastic work is calculated then as:

Wp =

∫ t=∞
t=0

Ẇp dt =

∫ ξ=∞
ξ=0

α r (ξ) ξ̇ = α
σy

2

2HS
(90)

and this represent the area underlying the r − ξ curve. Now, comparing expressions (85)
and (90), the parameter HS can be computed as:

HS = α
σy

2

2Gf
lch = H̄Slch (91)

The parameter H̄S depends only on material properties, whereas lch depends on the res-
olution of the discretization. As pointed out by Cervera et al. [18], the size of the strain
concentration band depends on the finite element technology. For instance, irreducible
finite elements provide a concentration band within a single element span, due to the
discontinuous strain field. On the contrary, in the ε−u mixed FE formulation, with inter-
elemental continuous strain, the slip line spans two elements. The characteristic length
lch is taken accordingly.

4.7 Plastic dissipation rate

The condition of positive rate of dissipation

Ẇp = σ : ε̇p ≥ 0 ∀ε̇ (92)

has to hold in both classical and apex return mappings in order to have a thermodynam-
ically consistent model. In the first case, since 0 ≤ ρ ≤ 1 and the initial stress threshold
σy > 0, it holds:

Ẇp = ρσyγ̇ ≥ 0 ∀ε̇ (93)

In the return of the apex case, a continuous expression is not available, but, using (83)
and (84) the incremental dissipation takes the form:

∆Ẇ (n+1)p =
1

3K

[
p
(n+1)
min 1 : p

(n+1)
min 1

]
≥ 0 (94)

which is positive by construction.

5 Numerical Examples

The objective of the following numerical examples is to highlight the benefits of a stress-
accurate finite element method, such as the proposed ε/u mixed FEM, in order to capture
softening behavior and failure due to the formation of strain localization lines. In all the
examples, the convergence tolerance used for the iterative Newton-Raphson procedure is
10−5. Computations have been realized using an enhanced version of COMET-Coupled
mechanical and thermal analysis [29], developed by the authors at the International Center
of Numerical Methods in Engineering (CIMNE) in Barcelona, Spain. The geometrical
models have been created using GiD, a pre and post-processing software, also developed
by CIMNE.

18



5.1 Prandtl’s punch problem with J2 plasticity

In this first example, the relative performance of the displacement-pressure formulation
u/p and the strain-displacement formulation ε/u in the 2D Prandtl’s punch test is assessed.
Incompressible J2 plasticity (ϕ = 0◦) is assumed. The problem consists of a foundation
loading a semi-infinite soil domain. A portion of 10 by 5 meters of soil is modeled, with a
2 meters wide loading zone. Due to symmetry conditions, only one half of the domain has
been meshed. The geometry of the problem is shown in Figure 5. The load is given by an
imposed vertical displacement of 0.2 meters in the downward direction. Young’s modulus
is 10 MPa and Poisson’s ratio is 0.4. The maximum tensile strength is 10 kPa, whereas a
fracture energy of 200 J/m2 is considered for the strain softening case. All cases are run
with 400 time steps and an unstructured mesh of 4340 triangular P1-P1 elements (typical
size of h = 0.25).

l

l/5

Figure 5: Geometry for Prandtl’s punch problem

In Figures 7(a) and 7(b), the norm of displacement field obtained with both formula-
tions at the end of the loading is shown. The results computed with the two formulations
are very similar. This is due to the fact that both formulations have the same order of
convergence rate in the displacement field. The equivalent plastic strain is presented in
Figures 7(d) and 7(e). It can be seen that, even if the displacements do not present sub-
stantial difference, the plastic strain field differs for the two formulations, not in the path of
the slip line but rather in the quality of the description of the shear band. In fact, the ε/u
solution presents a continuous distribution of strains whereas the u/p formulation yields
a element-wise constant but inter-element discontinuous field. Principal strain vectors are
shown in Figures 7(g) and 7(h). Here, the largest differences between the solution of the
two formulations can be observed. In the u/p formulation, the strain tensor is computed
summing the volumetric part of the deformation, computed starting from the pressure
field, and the deviatoric one, given by differentiation of the displacement field. Clearly,
the latter one is mesh dependent across the slip line and this fact biases the orientation of
the principal axes of strain. Although the overall behaviour is correct and the solution is
the expected one, some sharp changes in the direction of vectors are observed locally in the
u/p solution. Contrariwise, in the ε/u solution strain is a continuous variable throughout
the domain. This was noted already for the irreducible formulation against the mixed
one by Cervera et al. [18]. This discrepancy explains the slightly difference in post peak
behaviours of the u/p and ε/u formulations presented in the reaction-displacement plot in
Figure 6.

For the sake of comparison, Figures 8(a) and 8(c) show displacement and plastic strain

19



contours for the same problem, obtained using standard irreducible formulation. The
solution is strongly mesh dependent. This is due to two factors. On one hand, the mean
stress (the pressure) is completely locked because of the isochoric nature of the plastic
flow. On the other hand, the deviatoric part of the strain field fails to converge to the
correct, mesh independent, solution of the problem.

-30

-25

-20

-15

-10

-5

 0
-0.2-0.15-0.1-0.05 0

V
e

rt
ic

a
l R

e
a

ct
io

n
 [

kN
]

Vertical Displacement [m]

Strain-Displacement formulation
Pressure-Displacement formulation

Figure 6: Prandtl’s punch problem with J2 plasticity: vertical reaction force vs. imposed
vertical displacement of the foundation

20



(a) (b)

(d) (e)

(g) (h)

Figure 7: Results for Prandtl’s punch problem: u/p (left column) and ε/u (right column).
Contours of: total displacements (first row), equivalent plastic strain (second row), vectors
of principal strains (third row).

21



(a) (c)

Figure 8: Results for Prandtl’s punch problem in the case of Standard Irreducible finite
element formulation

5.2 Prandtl’s punch problem with Drucker Prager plasticity

With the geometry and the mechanical properties of the previous example, the Prandtl’s
punch problem is now analyzed considering the Drucker-Prager plasticity model. The
dimensions of the meshed domain have been doubled in order to allow the complete for-
mation of the slip lines and, therefore, to avoid interaction with the boundaries. Again,
due to symmetry, the modeled domain is half of the total, 10 by 10 meters with a 1 meter
wide footing. The footing applies a downward imposed displacement of 0.2 meters. The
mesh is a structured quadrilateral grid with one hundred Q1Q1 elements per side (typical
size of h = 0.1). The solution is computed for the cases of ϕ = 0, 15, 30 degrees of internal
friction angle. The ε/u formulation is used in all three cases.

In Figure 9, the comparison in the displacement field shows considerable differences
in the volume of domain subjected to the effect of the footing. As the angle of friction
increases, the affected zone becomes larger, both in the horizontal and vertical directions.
In the J2 case, the failure mechanism follows Prandtl’s theoretical result for incompressible
soils, in which a triangular elastic domain of material, with 45 degrees slip lines, creates a
single fan-shaped part sliding along a circular localization zone. Instead, when the angle
of friction increases, the shape of the triangular elastic portion under the footing changes
and additional fans sliding along the slip line are created. In the equivalent plastic strain
plots (Figure 10), the change in the failure mechanism can be clearly appreciated. The
ratio of deviatoric and volumetric strain is bigger for higher angles of friction (Figures 11
and 12). Figure 13 shows the resulting reaction force under the footing plotted against the
vertical displacement for each one of the considered friction angle. The graph confirms that
materials with larger internal friction angle have higher yielding stresses when pressure
increases.

22



(a) ϕ = 0◦

(c) ϕ = 15◦

(d) ϕ = 30◦

Figure 9: Prandtl’s punch problem with Drucker-Prager plasticity: displacement contour
maps for 0, 15 and 30 degrees of internal friction angle

23



(a) ϕ = 0◦

(c) ϕ = 15◦

(d) ϕ = 30◦

Figure 10: Prandtl’s punch problem with Drucker-Prager plasticity: equivalent plastic
strain for 0, 15 and 30 degrees of internal friction angle

24



(a) ϕ = 0◦

(c) ϕ = 15◦

(d) ϕ = 30◦

Figure 11: Prandtl’s punch problem with Drucker-Prager plasticity: J2 strain for 0, 15
and 30 degrees of internal friction angle

25



(a) ϕ = 0◦

(c) ϕ = 15◦

(d) ϕ = 30◦

Figure 12: Prandtl’s punch problem with Drucker-Prager plasticity: volumetric strain for
0, 15 and 30 degrees of internal friction angle

26



-100

-90

-80

-70

-60

-50

-40

-30

-20

-10

 0
-0.2-0.15-0.1-0.05 0

V
e

rt
ic

a
l R

e
a

ct
io

n
 [

kN
]

Vertical Displacement [m]

Angle of friction = 0
Angle of friction = 15
Angle of friction = 30

Figure 13: Vertical reaction force vs. vertical displacement for the Prandtl’s punch problem
with Drucker-Prager plasticity

5.3 Rigid footing on a 3D cube

The final example is a 3D cube of soil with side l = 2m with an imposed vertical dis-
placement δ = l/10 = 0.2m in a footprint of l/2 × l/2 = 1 × 1m2 (Figure 14(a)). The
properties of the material are the same as in the previous examples: Young’s modulus of
10 MPa, Poisson ratio of 0.4, yielding stress 10 kPa and a fracture energy of 200 J/m2.
The plasticity model is Von Mises (ϕ = 0). The vertical displacement of 0.2 is applied
in 100 time steps. The cube is supported on the three faces that are not adjacent to the
footing. The mesh is a structured hexahedral grid with 20 elements per side (h = 0.1).
This example was solved with the u/p formulation and P1P1 tetrahedral elements in [13].

The computed results show how the cube deforms under the imposed displacement
of the rigid foundation (Figure 14(b)): a tetrahedral wedge detaches from the corner of
the cube sliding in diagonal along the slip line. Failure is symmetric as expected by the
geometry of the problem. Figure 14(c) depicts the computed displacement field, showing
an almost rigid motion of the wedge once the failure mechanism is fully developed. Figure
15 confirms that, at the end of the loading process, the reaction force is less than one
tenth of the peak value. Figure 14(e) shows the localization of the plastic strains. From
the latter two plots it is possible to see that both displacement and plastic strain are
continuous across the slip line. The resulting shear band width is, at most, two elements
wide. Finally in Figure 15, the vertical reaction force is plotted against the imposed
vertical displacement, showing the full development of the resulting softening branch.

6 Conclusion

A mixed strain-displacement finite element formulation has been developed and applied
to model the failure due to plastic strain localization of different geotechnical examples.

27



l/2

l

(a) (b)

(c) (e)

Figure 14: Results for a rigid footing on a 3D cube: (a) geometry of the problem, (b) final
deformed mesh, (c) contours of total displacements, (d) equivalent plastic strain

28



-60

-50

-40

-30

-20

-10

 0
-0.2-0.15-0.1-0.05 0

V
e

rt
ic

a
l r

e
a

ct
io

n
 [

kN
]

Vertical displacement [m]

Strain-Displacement formulation

Figure 15: Rigid footing on a 3D cube: vertical reaction vs. imposed displacement

The problem of computation of slip lines has been addressed in pressure dependent as
well as incompressible plasticity. The enhanced accuracy in the strain field that this for-
mulation provides, compared to the previously used displacement/pressure formulation,
allows a more detailed description of the failure mechanism, peak load and post-peak
behaviour. Various examples of 2D and 3D geotechnical problems were solved using tri-
angular, quadrilateral and hexahedral meshes, showing no mesh dependency, theoretical
consistency and remarkable robustness.

7 Acknowledgments

Financial support from the EC 7th Framework Programme under the MuMoLaDe project
- Multi-scale Modelling of Landslides and Debris Flows - within the framework of Marie
Curie ITN (Initial Training Networks) and the Spanish Ministry of Economy and Com-
petitivity under the EACY project - Enhanced accuracy computational and experimental
framework for strain localization and failure mechanisms- within the ”Excellency” Pro-
gram for Knowledge Generation is gratefully acknowledged.

Appendix A Differentiation of the plastic strain tensor εp

In previous sections, when the linearization of the discrete weak problem was performed,

the derivative of the plastic strain tensor was introduced. The plastic strain ε
(n+1)
p depends

directly on the trial stress via the return mapping.
Consider the derivative with respect to the nodal strains εh. Using the chain rule, it

reads:
∂ε

(n+1)
p

∂εh
=

∂ε
(n+1)
p

∂σ
(n+1)
trial

∂σ
(n+1)
trial

∂εh
(95)

29



The first term on the right hand side represents the variation of the plastic strain with
respect to the trial stress at the actual time step. From the discrete evolution equations
presented in (65), the plastic strain tensor is updated as:

ε(n+1)p = ε
(n)
p +∆γ

(n+1) ∂σf
(
σ(n+1), q(n+1)

)
(96)

where ∂σf = n
(n+1) is the normal to the yield surface. It was shown in equation (61)

that, for Drucker-Prager plasticity model, the vector n(n+1) is

n(n+1) = ∂σf (σ, q) = ρ

√
3

2

devσ

∥devσ∥
+

a (1− ρ)
3

1 (97)

Being ε
(n)
p a constant value, the derivative of ε

(n+1)
p with respect to the trial stresses is:

∂ε
(n+1)
p

∂σ
(n+1)
trial

=
∂∆γ(n+1)

∂σ
(n+1)
trial

⊗ n(n+1) +∆γ(n+1)
∂n(n+1)

∂σ
(n+1)
trial

(98)

Recall that the tangent consistent elasto-plastic tensor is defined as:

C(n+1)ep =
∂σ(n+1)

∂ε(n+1)
= C− C

∂∆γ(n+1)

∂ε(n+1)
⊗ n(n+1) −∆γ(n+1)C

∂n(n+1)

∂ε(n+1)
(99)

Comparing (98) and (99), it is possible to write:

∂ε
(n+1)
p

∂σ
(n+1)
trial

= C−1
[
C− C(n+1)ep

]
C−1 (100)

The second term on the right hand side of (95) is the derivative of σ
(n+1)
trial with respect to

ε(n+1):

σ
(n+1)
trial = C :

(
ε(n+1) − ε(n)p

)
⇒

∂σ
(n+1)
trial

∂ε(n+1)
= C (101)

Finally, the derivative expressed in (95) can be computed as:

∂ε
(n+1)
p

∂εh
=

∂ε
(n+1)
p

∂σ
(n+1)
trial

∂σ
(n+1)
trial

∂εh
= C−1

[
C− C(n+1)ep

]
(102)

which provides the algebraic system matrices in (44), (45), (46) and (47).

30



References

[1] J. Krahn. The 2001 R . M . Hardy Lecture: The limits of limit. Canadian Geotechnical
Journal, pages 643–660, 2003.

[2] M. Cervera, M. Chiumenti, and D. Di Capua. Benchmarking on bifurcation and
localization in J2 plasticity for plane stress and plane strain conditions. Computer
Methods in Applied Mechanics and Engineering, 241-244:206–224, October 2012.

[3] Y. R. Rashid. Ultimate strength analysis of prestressed concrete pressure vessels.
Nuclear Engineering and Design, 7(4):334–344, 1968.

[4] A. Needleman. Material rate dependence and mesh sensitivity in localization prob-
lems. Computer Methods in Applied Mechanics and Engineering, 67(1):69 – 85, 1988.

[5] M. Ortiz, Y. Leroy, and A. Needleman. A finite element method for localized failure
analysis. Computer Methods in Applied Mechanics and Engineering, 61(2):189–214,
1987.

[6] D. Bigoni and T. Hueckel. Uniqueness and localization-I. associative and non-
associative elastoplasticity. International Journal of Solids and Structures, 28(2):
197 – 213, 1991.

[7] S. Badia and R. Codina. Unified stabilized finite element formulations for the Stokes
and the Darcy problems. SIAM Journal on Numerical Analysis, 47(3):1971–2000,
2009.

[8] S. Badia and R. Codina. Stabilized continuous and discontinuous Galerkin techniques
for Darcy flow. Computer Methods in Applied Mechanics and Engineering, 199:1654–
1667, 2010.

[9] A. Masud and T. J. R. Hughes. A stabilized mixed finite element method for darcy
flow. Computer Methods in Applied Mechanics and Engineering, 191(39):4341–4370,
2002.

[10] K. A. Mardal, X.-C. Tai, and R. Winther. A robust finite element method for darcy–
stokes flow. SIAM Journal on Numerical Analysis, 40(5):1605–1631, 2002.

[11] K. B. Nakshatrala, D. Z. Turner, K. D. Hjelmstad, and A. Masud. A stabilized
mixed finite element method for darcy flow based on a multiscale decomposition of
the solution. Computer Methods in Applied Mechanics and Engineering, 195(33):
4036–4049, 2006.

[12] M. R. Correa and A. F. D. Loula. Unconditionally stable mixed finite element methods
for darcy flow. Computer Methods in Applied Mechanics and Engineering, 197(1718):
1525 – 1540, 2008. ISSN 0045-7825.

[13] M. Cervera, M. Chiumenti, Q. Valverde, and C. Agelet de Saracibar. Mixed lin-
ear/linear simplicial elements for incompressible elasticity and plasticity. Computer
Methods in Applied Mechanics and Engineering, 192(49-50):5249–5263, 12 2003.

[14] M. Cervera, M. Chiumenti, and C. Agelet de Saracibar. Shear band localization via
local J2 continuum damage mechanics. Computer Methods in Applied Mechanics and
Engineering, 193(9-11):849–880, March 2004.

[15] M. Cervera, M. Chiumenti, and R. Codina. Mesh objective modeling of cracks using
continuous linear strain and displacement interpolations. International Journal for
Numerical Methods in Engineering, (February):962–987, 2011.

31



[16] M. Cervera and M. Chiumenti. Size effect and localization in J2 plasticity. Interna-
tional Journal of Solids and Structures, 46(17):3301–3312, August 2009.

[17] M. Cervera, M. Chiumenti, and R. Codina. Mixed stabilized finite element methods
in nonlinear solid mechanics. Part I: Formulation. Computer Methods in Applied
Mechanics and Engineering, 199(37-40):2559–2570, August 2010.

[18] M. Cervera, M. Chiumenti, and R. Codina. Mixed stabilized finite element methods in
nonlinear solid mechanics. Part II: Strain localization. Computer Methods in Applied
Mechanics and Engineering, 199(37-40):2571–2589, August 2010.

[19] J. C. Simo and T. J. R. Hughes. Computational Inelasticity. Interdisciplinary applied
mathematics: Mechanics and materials. Springer New York, 1998.

[20] D. Boffi, F. Brezzi, and M. Fortin. Mixed Finite Element Methods and Applications.
Springer, 2013 edition, 7 2013. ISBN 9783642365188.

[21] T. J. R. Hughes, G. R. Feijóo, L. Mazzei, and J. B. Quincy. The variational multi-
scale methoda paradigm for computational mechanics. Computer Methods in Applied
Mechanics and Engineering, 7825(98), 1998.

[22] R. Codina. Stabilization of incompressibility and convection through orthogonal sub-
scales in finite element methods. Computer Methods in Applied Mechanics and En-
gineering, 190:1579–1599, 2000.

[23] R. Codina and J. Blasco. A finite element formulation for the stokes problem allowing
equal velocity-pressure interpolation. Computer Methods in Applied Mechanics and
Engineering, 143(34):373 – 391, 1997.

[24] R. Codina. Analysis of a stabilized finite element approximation of the oseen equations
using orthogonal subscales. Applied Numerical Mathematics, 58(3):264 – 283, 2008.

[25] J. C. Simo and R. L. Taylor. Consistent tangent operators for rate-independent
elastoplasticity. Computer Methods in Applied Mechanics and Engineering, 48(1):101
– 118, 1985.

[26] R. deBorst. Integration of plasticity equations for singular yield functions. Computers
& Structures, 26(5):823 – 829, 1987. ISSN 0045-7949.

[27] D. Perić and E. A. de Souza Neto. A new computational model for tresca plasticity
at finite strains with an optimal parametrization in the principal space. Computer
Methods in Applied Mechanics and Engineering, 171(34):463 – 489, 1999. ISSN 0045-
7825.

[28] S. Pietruszczak and Z. Mróz. Finite element analysis of deformation of strain-softening
materials. International Journal for Numerical Methods in Engineering, 17(3):327–
334, 1981.

[29] M. Cervera, C. Agelet de Saracibar, and M. Chiumenti. COMET: Coupled Mechanical
and Thermal analysis. Data Input Manual, Version 5.0, Technical Report IT-308.
2002. URL http://www.cimne.com/comet/.

32


