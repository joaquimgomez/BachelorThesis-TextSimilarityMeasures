














































Microsoft Word - paper_2_phase_V05.doc


 
 

 

UPCommons 
Portal del coneixement obert de la UPC 

http://upcommons.upc.edu/e-prints 

 
 

Aquesta és una còpia de la versió author’s final draft d'un article 
publicat a la revista Computational particle mechanics. 

La publicació final està disponible a Springer a través de 
http://dx.doi.org/10.1007/s40571-018-0204-9 

This is a copy of the author 's final draft version of an article 
published in the journal Computational particle mechanics. 

The final publication is available at Springer via 
http://dx.doi.org/10.1007/s40571-018-0204-9 

 
Article publicat / Published article: 

 
Flores, R.M. [et al.] (2018) An implicit unsteady hydraulic solver for 
suspended cuttings transport in managed pressure wells. 
Computational particle mechanics . Doi:10.1007/s40571-018-0204-9 

http://upcommonsdev.upc.edu/
http://upcommonsdev.upc.edu/
http://upcommons.upc.edu/e-prints
http://dx.doi.org/10.1007/s40571-018-0204-9
http://dx.doi.org/10.1007/s40571-018-0204-9


 

1 

An Implicit Unsteady Hydraulic Solver for 

Suspended Cuttings Transport in Managed Pressure 

Wells 

R. Flores1*, E. Ortega2, A. Ilin3, D. Simpkins4 and E. Oñate1 

*Corresponding author: rflores@cimne.upc.edu, (+34) 93 401 6038 
1International Center for Numerical Methods in Engineering (CIMNE), C/ Gran Capitán s/n, 
08034 Barcelona, Spain 
2Serra Hunter professor at Escola Superior d’Enginyeries Industrial, Aeroespacial y 
Audiovisual de Terrassa, Universitat Politècnica de Catalunya (ESEIAAT-UPC), C/ Colom 
11, 08222 Terrassa, Spain 
3Weatherford International, 11909 FM 529 Road, Houston, Texas 77041, USA 
4formerly Weatherford International, Houston, Texas, USA 

 

Abstract. We present a simulation tool for transient events in complex hydraulic networks. The code includes 

modelling of the transport of suspended cuttings in near-vertical wells. An unstructured finite volume 

formulation with implicit time integration has been chosen. The unconditional stability of the integrator makes 

the method suitable for the simulation of transient events over a wide range of characteristic time scales. It 

handles both very fast transients (e.g. fluid hammer events) as well as the long-term evolution of the well (e.g. 

hole cleaning operations). The software has been developed to address the need of the oil industry for a robust 

and efficient predictive tool allowing effective well control in managed pressure drilling operations. The physical 

modelling follows the standard practices accepted by the industry (e.g. mud rheology computations). The 

mathematical foundation of the algorithm is described followed by validation cases that illustrate its capabilities 

and accuracy. Finally, a practical industrial application example is provided to demonstrate the real-world 

performance of the software. 

Keywords: unsteady, hydraulics, oil well, cuttings transport. 

1 Introduction 

The Managed Pressure Drilling (MPD) technique enables precise control of the annular 

pressure allowing drilling wells that may otherwise not be practical [1,2,3]. Conventional 

drilling operations, where the mud outlet is at ambient pressure, rely on hydrostatic pressure 

(regulated by changing the mud density) for well control. In case of narrow margins between 

pore pressure and formation fracture threshold, conventional drilling can become unfeasible. 

By maintaining a tighter pressure control (e.g. using choke valves and back-pressure pumps at 

the surface) MPD can overcome these limitations (see Fig. 1). 



 

2 

mud & 
cuttings

drillstring

casing

Cased section

formation
clean 
mud

Uncased section

mud pump

mud tank

back-pressure 
pump choke valve

c
a

s
e

d
 s

e
g

m
e

n
t

surface
back-pressure

casing point

formation 
fracture

hydrostatic 
head

friction
losses

pressure

d
e
p

th

annular mud 
pressure

pore 
pressure

 

Fig. 1 Simplified schematic of MPD well (left) and Annulus pressure vs. depth diagram (right) 

However, to ensure continued safety, an accurate well control strategy with a very short 

reaction time is needed. This calls for predictive tools capable of computing the response of 

the well to control inputs (e.g. valve operations or back-pressure pump settings) in near real-

time. Moreover, the timescales of the relevant phenomena span many orders of magnitude; 

from fluid hammer events (10-2 s) to hole cleaning activities (hours or days). In all cases the 

analysis software should be able to provide a solution within the timeframe of a few seconds 

if safe operation is to be maintained. 

Under request from Weatherford International PLC, the International Center for Numerical 

Methods in Engineering (CIMNE) has developed an unsteady solver for hydraulic networks 

including modelling of suspended cuttings transport. Weatherford specifically demanded the 

capability to solve both short and long transients in less than ten seconds using commodity 

desktop hardware. This would allow future incorporation of the technology in automatic well 

control systems [4]. 

A common choice for solving water hammer problems is the method of characteristics [5,6]. 

However, this explicit technique is best suited for uniformly spaced grids, becomes 

increasingly complex when the speed of sound in the fluid is not constant and is very 

inefficient at computing the long-term response of the hydraulic network. On the other hand, 



 

3 

implicit methods, usually based on finite-difference schemes, have been proposed. These 

allow for larger time steps, thus improving the behaviour when computing slow transients 

[7,8]. Unfortunately, the computational cost per time step of implicit methods tends to be 

high, making them inefficient when applied to fluid hammer simulations [9]. Thus, the choice 

of method (implicit/explicit) usually depends on the time scale of interest (long/short, 

respectively). 

In this paper we present an efficient implicit method suitable for simulation of short and long 

transients, as well as steady-state simulation. This greatly simplifies the analysis tasks, as a 

single tool can be applied in all situations. The algorithm is derived from the scheme proposed 

in [10] for the analysis of fully-incompressible and fully-compressible single-phase flows. 

The original method has been adapted for slightly compressible fluids (such as drilling muds) 

and expanded to deal with two-phase flows (mud with suspended cuttings). The details of the 

numerical scheme are presented, followed by validation cases demonstrating the accuracy and 

efficiency of the solver. Finally, the most important conclusions are drawn. 

2 Governing Equations 

Considering Weatherford’s operational requirements and the information available from well 

instrumentation, the following assumptions ware made in the development of mathematical 

model: 

 1D flow inside a rigid pipe. 

 The compressibility of the drilling mud is small. 

 The well bore is near-vertical and the velocities in the surface network are high 

enough for the cuttings to remain suspended. 

 The rock cuttings are incompressible and behave as a dispersed phase, where the 

interactions between the cuttings can be neglected. 

 The motion of the suspended cuttings is dominated by viscosity, so the cuttings slip 

velocity can be computed directly from the local flow conditions. The cuttings 

velocity is approximately parallel to the pipe axis. Also, the frictional force between 

cuttings and pipe wall are of minor importance compared with the viscous stresses. 



 

4 

 The temperature field on the well is known at every instant. The effects of temperature 

on fluid behaviour must be considered, but the temperature itself is part of the input 

data. 

 The well geometry and motion (e.g. drill string displacement) is defined externally and 

is not affected by the flow field. 

The basic equations of 1D fluid flow, see for example [11], have been simplified according to 

these assumptions. The basic ideas of the scheme [10] have then been applied to the modified 

equations in order to obtain an efficient numerical model. The changes to the basic equations 

are summarized next. 

2.1 Single-phase conservation statements 

The 1D mass balance equation in conservative form for a pipe segment is 

 
 

0
V

t x

 
 

 
 , (1) 

where  denotes the fluid density, V its velocity, x is the streamwise coordinate and t stands 

for time. The conservative form of the momentum balance is given by: 

 
   2 w

x

VV fp
g

t x x A




 
    

  
 , (2) 

where p is the fluid pressure, fw denotes the wall friction force per unit length, A is the pipe 

cross-section and gx is the streamwise component of gravity. The left-hand side (LHS) of (2) 

can be simplified using the continuity equation (1): 

 
     

2VV V V V V
V V V V

t x t x t x t x

 
  

           
                       

 , (3) 

thus yielding the non-conservative form of the momentum balance 

 w x
fV V p

V g
t x x A

 
   

        
 . (4) 

When the flow velocity is small compared with the speed of sound c, something which is 

clearly the case in oil wells where V1 m/s, the continuity equation (1) can be further 

simplified because the density gradients are negligibly small. We can use the speed of sound 

to write the density fluctuations in term of pressure gradient, which can in turn be estimated 

from (4) 



 

5 

 
2

2
2 2

;
V p p V V V V

V V V M
x c x x x x c x x

 
  

      
  

      
   , (5) 

where the Mach number /M V c  has been introduced and 2

s

p
c







. As the Mach number 

is very small, the density gradient term in the continuity equation can be safely neglected: 

 
V

V
x x




 


 
 , (6) 

yielding the acoustic approximation 

 0
V

t x




 
 

 
 . (7) 

In general, whenever the Mach number is small the density gradient terms in the equations 

can be dropped. 

The convective term 
V

V
x





 on the LHS of (4) is non-linear and complicates the numerical 

solution of the equations. The key feature of the algorithm developed in [10] is replacing the 

static pressure p with the stagnation pressure p0 

 20
1

2
p p q p V     , (8) 

where the dynamic pressure q is introduced. Introducing the stagnation pressure in 

momentum balance equation (4) and recalling that the density gradient can be ignored by 

virtue of the small Mach number: 

 0 w x
p fV

g
t x A

 


   
 

 . (9) 

It is a common practice in hydraulic analysis to ignore the convective term in order to 

simplify the solution scheme. Equation (9) achieves the same effect while remaining exact 

(within the frame of small compressibility) as the effect of the convective term is contained 

inside the dynamic part (q) of the stagnation pressure. 

2.2 Conservation statements for two-phase flow 

The method [10] is computationally efficient, but is unfortunately restricted to single-phase 

flows. Here, the technique is extended to the case of biphasic flow (drilling mud with 

suspended rock cuttings) simplifying the equations with the model assumptions stated at the 

beginning of section 2. In the following the subscripts m, s and mix shall refer, respectively, to 



 

6 

the drilling mud, suspended cuttings and the overall mixture. The mass conservation balance 

for each of the phases is 

      ,k k k k k kA A V k m s
t x
  

 
  

 
 , (10) 

where k denotes the net mass source (per unit length) of phase k. The subscript k can be 

either m (mud) or s (suspended cuttings). Ak is the fraction of the cross section occupied by 

phase k, which can be written in terms of its volume fraction (Xk) as k kA AX . 

In principle, one momentum balance per phase is required to determine the velocity field. 

However, in practice, the drag forces experienced by the suspended cuttings cannot be 

computed accurately. This is due mainly to two issues. First, the cuttings show a wide 

variation of sizes and shapes, so some representative geometry must be used which gives, at 

most, a rough approximation of the real drag force. Second, even if all the particles were 

identical, precise drag correlations are not available for fluids with complex rheology (which 

is precisely the case of drilling muds). We could further add that for field applications simple 

models which can be calibrated easily are required, so the particle drag correlations will be 

approximate at best. With this in mind a simpler and more efficient approach was chosen. As 

we assumed that the motion of the suspended particles is dominated by viscosity, the particle 

slip velocity slip s mV V V   can be computed assuming the buoyancy, gravitational and drag 

forces acting on it are in equilibrium 

 0 0s s x s
p

g D
x

 
 

    
 , (11) 

where s is the particle volume and Ds is the drag force it experiences (which is a function of 

its slip velocity). Note that, for convenience, we have assumed 0
p p

x x

 


 
 when computing the 

buoyancy force. This approximation is valid as long as the variations of cross-section along 

the duct are smooth. Furthermore, given the approximate nature of the drag estimation, a high 

level of accuracy is not needed for the pressure gradient. Remark that (11) is an algebraic 

equation for computing the cuttings slip velocity, which is much easier to solve than the 

respective momentum balance statement (which is a partial differential equation). 

Another equation is needed to complete determine the motion of the system, this could be the 

momentum balance for the mud, but instead the momentum balance for the overall mixture 



 

7 

has been chosen. The equation is simpler because, when considering the mixture, the forces 

between the mud and cuttings are internal and do not enter the balance: 

 mix o mixmix mix x
V p f

g
t x A

 
 

   
 

 , (12) 

where the average mixture density is mix m m s sX X    . The equivalent mixture wall force 

includes the viscous forces and the momentum defect created by the external cuttings sources, 

if any: 

  mix w w s s extf l V V     . (13) 

In (13) w is the wall viscous stress, lw denotes the pipe perimeter and Vext is the velocity of the 

cuttings when they are introduced in the flow. When the cuttings are fed with low velocity 

(Vs>Vext) they create a drag force on the mixture, because the mixture slows down as it 

transfer momentum to the external cuttings in order to equalize speeds. For realistic cuttings 

feed rates this term is small and can be safely ignored. Note that an approximation has been 

made in (12), because the total pressure p0 is computed with dynamic pressure of the mud 

2
0

1

2
m mp p V  , while the exact equation would require the dynamic pressure of the mixture. 

In practice, the error introduced by this approximation is smaller than the uncertainties in the 

evaluation of the friction forces (given the complex rheology of the mud) so it is not a serious 

limitation. A further simplification can be made by realizing that if the motion of the particles 

is dominated by viscous forces, the accelerations of the mud and particles must be similar. 

This stands to reason because, if the accelerations were significantly different, the particle slip 

velocities would become large, clogging the well in a very short time. Therefore it is 

acceptable to assume mix m
V V

t t

 


 
 and use the equation to compute directly the mud velocity: 

 
1m o w

x
mix

V p f
g

t x A
  

     
 . (14) 

2.3 Physical modelling 

In order to fully determine the solution  0, , , , ,m s m s mX X V V p   the mass and momentum 

conservation equations (10) and (14) must be supplemented with additional correlations 

describing the physical response of the system. These include the mud equation of state, and 

correlations for the wall friction stresses as well as the cuttings drag force. The models 



 

8 

adopted are explained briefly in the next subsections, check the references provided for a 

complete description.  

2.3.1 Equation of state 

Following standard practice in the oil industry, polynomial expressions are used to compute 

the mud density: 

  2 21 1 1 2 2 2m a b p c p T a b p c p        , (15) 

where T denotes temperature and the coefficients ai, bi and ci are material-dependent. The 

speed of sound can be easily computed from (15) 

  1 1 2 22
1

2 2m b c p T b c p
c p


    


 . (16) 

Note that, for simplicity, it is possible to use p0 instead of p when computing the density: 

  
2 2

2
( , ) ( , ) ( , ) 1 ( , ) 1

2 2
m

m o m o m m

V M
p T p T p p p T p T

p c


   

   
             

 . (17) 

Given that the Mach number is very small, we conclude from (17) that ( , ) ( , )m o mp T p T  . 

2.3.2 Wall viscous stress 

Following the standard practice in the oil industry the friction losses are computed using the 

procedure outlined in the API RP 13D standard [13] using the Herschel-Bulkley (HB) non-

Newtonian fluid model [14]: 

 ny k      , (18) 

where y is the yield stress, k the consistency factor, n the flow index and   denotes the shear 

rate. The HB model is preferred because it includes, as special cases, Newtonian, Bingham 

plastic and power-law fluids. To compute the wall friction stress the wall shear rate is first 

determined with 

 8w
hyd

GV

d
   . (19) 

In the expression above 
4

hyd
w

A
d

l
  is the hydraulic diameter of the duct and the combined 

geometry shear-rate correction factor G is 



 

9 

 
 
 
3 1

1
4 2

n
G

n

 


    
      

  , (20) 

with =0 for the drill pipe and =1 for the annular space. A reference wall shear stress is 

then given by 

 
4

3

n
ref n
w y wk


  


    

  , (21) 

from which the generalized Reynolds number is computed: 

 
2

Re 8 mG ref
w

V


  . (22) 

The standard [13] gives a semi-empirical correlation for the Fanning friction factor Cf as a 

function of ReG. Using the friction coefficient, the wall shear stress can be finally determined: 

 2
1

2
w m fV C   . (23) 

2.3.3 Cuttings drag force 

In order to compute the cuttings slip velocity from relation (11) a correlation for the particle 

drag force is needed. Following the results of [12] a linear dependency was assumed 

 
0

0

term slip

slip

s sV V

s s slipV
term

D D
D D V

V






   , (24) 

where Vterm is the terminal velocity (in vertical fall) of the particle immersed in the drilling 

mud. The particle drag at terminal velocity equals the particle weight minus the buoyant force 

  
term

s s s mV
D g     . (25) 

The terminal settling velocity is computed using the Walker and Mayes correlation [15,16]. 

The method assumes a circular disc of diameter ds and thickness hs in flat fall. An empirical 

correlation for the shear stress at terminal velocity is provided. Following the standard 

practice in the oil industry, field units are used: 

   2
lbf

7,9
100ft

term s s mh  
    
 

 , (26) 

where the particle size is measured in inches and the densities in lbm/gal. Using the HB fluid 

model the shear rate at terminal velocity is computed 



 

10 

  
1

1s
n

term y
term

k

 
 

 
  
 

  , (27) 

which in turn yields the apparent viscosity at terminal shear rate: 

  479 cptermterm
term








 . (28) 

Finally, the terminal velocity is 

 
ft

0,0203
s

s term
term term

m

d
V





   
 


 . (29) 

The particle drag at zero slip velocity is often computed with the expression for the gel 

strength of a spherical particle 

 2
0slips s yV

D d 

  , (30) 

however, this expression sometimes yields results incompatible with the Walker and Mayes 

model (i.e. it predicts 
0term slips sV V

D D


 ). To address this issue the drag at rest has been 

computed using: 

 
0slip term

y
s sV V

term

D D



  . (31) 

Using equations (11) and (24) together, the slip velocity of the particles is determined: 

 0
0

0
slip

term slip

term
slip s s x s V

s sV V

V p
V g D

D D x
 




   
       

 . (32) 

Note that whenever the magnitude of the particle drag is smaller than 
0slips V

D


the slip velocity 

should be set to zero instead of the value predicted by (32). 

3 Numerical Model 

The algorithm builds on the advantages of Ref. [10], extending the method to include the 

effect of the suspended cuttings. The solution scheme is staggered, alternating between 

velocity correction and pressure/concentration correction steps. The spatial discretization is 

also staggered, using a combination of finite differences for the velocity correction steps and 

unstructured finite volumes for the computation of pressures and concentrations. The next 

subsections describe the details of the formulation. 



 

11 

3.1 Problem discretization 

3.1.1 Spatial discretization 

The spatial discretization scheme is staggered, with the pressures and concentrations 

evaluated at the nodes of the grid (xi) and the velocities computed at the midpoints (xi+1/2) as 

shown in Fig. 2.  

xi‐1 xi+1xixi‐1/2 xi+1/2

i

Vi‐1/2
pi‐1
Xi‐1

Vi+1/2

Li‐1/2 Li+1/2

pi
Xi

pi+1
Xi+1

i‐1 i+1

 

Fig. 2 Staggered spatial discretization 

The mud velocity equation (14) is solved using a second-order centered finite difference 

scheme while the mass conservation equations (10) are solved using a cell-centered finite 

volume scheme (second-order space accurate too). The cell interfaces are located at the 

midpoints of neighbouring nodes (where the velocities are computed). The volume of cell i is 

given by: 

 1/2 1/2 1/2 1/2
2

i i i i
i

L A L A      . (33) 

Note that the pipe cross-sections are defined at the midpoints (i.e. each pipe segment has a 

constant area, with section changes taking place at the nodes).  

3.1.2 Temporal discretization 

Due to the complex mud rheology and the nonlinearity of the cuttings slip velocity correlation 

achieving a converged solution with an implicit integrator can be difficult. To increase the 

robustness of the solution procedure the backward Euler time integrator is used to advance the 

equations in time [17]. For the application at hand stability and simplicity were deemed more 

important than accuracy, so first-order time accuracy was considered an acceptable trade-off. 

Thus, given a system of ODE’s 

  1
d

, ,..., 1,...,
d

j
j n

x
t x x j n

t
   ; (34) 



 

12 

the unknowns are advanced in time solving the algebraic system 

  1, ,..., 1,...,
t t t
j j t t t t

j n

x x
t t x x j n

t



     


 , (35) 

where t  denotes the time step size. To keep the notation as simple as possible, we will 

assume that all variables are evaluated at the end of the time increment unless explicitly 

indicated. Values at the start of the time step will be denoted with the superscript 0. Thus, Eq. 

(35) becomes: 

  
0

1, ,..., 1,...,
j j

j n

x x
t x x j n

t



 


 , (36) 

3.2 Velocity computation 

3.2.1 Mud (mixture) velocity update 

The discrete form of the mixture momentum balance equation (12) is 

  
 

     
0

1/2
11/2 1/2 1/2

m m i
mix o i o i mix mix xi i i

V V
L p p p L g

t
    


   


 , (37) 

where the mixture pressure drop is given by: 

  mix mix mw mw s s ext
L L

p f l V V
A A

        . (38) 

In case localized pressure drops (minor losses) exist, (38) can be augmented with 

minor lossp K q , where Kloss is the dimensionless loss factor.  This factor can be a function of 

time (e.g. to simulate valve closures). Equation (37) is nonlinear, as pmix is a function of the 

velocity, and must be solved iteratively (note that here pressures and concentrations are fixed, 

they are updated in a later stage of the algorithm). Starting with an approximate value of the 

mud velocity 1/2
j

m iV 
 , where j is the iteration counter, we seek an improved solution 

 1 1/2 1/2 1/2
j j j

m i m i iV V V

       , (39) 

such that 

 
 

 

   

0
1/2 1/2 1/2

1/2

1 1/2
1/2

j j
m i m i m i

mix i

j
j mix

o i o i mix mix x i
mix i

V V V
L

t

p
p p p L g

V






  


 


 



 

     

 



  

 . (40) 

The velocity correction for step j is obtained from 



 

13 

 1/2 1/2 1/2 1/2-
j j j

i i i iK V b e    =  , (41) 

with 

  

1/2 1/2

1/2

0

1/2 1/2 0 0 1

1/2

1/2

1/2

,

,

.

j

j mix mix
i i

m i

mix m
i i mix x i i

i

j

j mix m
i mix

i

L p
K L

t V

V
b L g p p

t

L V
e p

t








 



  





 
     

 
     

 
   

 


  




  (42) 

Using (38) the linearization factor in (42) can be written as: 

 1/2 1/2
1/2

j
j mix s mw mw

i i
m i

l
K L

t A A V

  
 



 
     


 , (43) 

where it has been assumed that the cuttings slip velocity does not depend on mud velocity. 

The velocity update step (39) is repeated until convergence is achieved. 

3.2.2 Cuttings velocity update 

The cuttings slip velocity is obtained solving the algebraic equation (25). If the model for 

particle drag described in (24)-(32) is used, the equation becomes: 

  0 0 1 00
1/2

term
s sV Vi i V

s s x s s mV
i term

D Dp p
g D V V

L V
 

 




 
    

 

     . (44) 

Equation (44) is linear and straightforward to solve once V  has been computed. 

3.3 Concentration and pressure computation 

3.3.1 Mass balance discretization 

Using the nomenclature from Fig. 2, the rate of change of the mass of a certain species 

contained inside cell i is: 

        1/2 1/2
d

d
k p k k ki i ii
X F F L

t
 

 
     , (45) 

where k denotes a phase (cuttings or mud) and F is the flux at the cell interfaces: 

  1/2
1/2

i
k k k k i

F V X A


  . (46) 

Applying the backward Euler rule to (45) yields 



 

14 

        0 0 1/2 1/2i k k k k k k ki i iiX X F F Lt    


   


 . (47) 

Once again, the equation is nonlinear and must be solved iteratively. To streamline the 

notation we shall drop the iteration counter and use the tilde to denote only the initial guess. 

Thus, we will write the improved density and concentration estimates as 

 ;k k k k k kX X X        . (48) 

Inserting (48) into (47) and discarding high order terms gives 

 
 

     

0 0

1/2 1/2

i
k k k k k k k k i

k k k k k ii i

X X X X
t

F F F F L

    

  
 


   


   

  

 
 , (49) 

which can be rearranged as: 

 
     

       

1/2 1/2

0 0

1/2 1/2

i
k k k k k ki ii

i
k k k k k k kii i i

X X F F
t

F F L X X
t

    

  

 

 


   




   




  
 . (50) 

Note that there are only 2 unknowns per node in (50) because 

 0 ;s m sX X      . (51) 

The mud density correction can be replaced by the pressure variation through: 

 0
2m
m

p

c


 


 , (52) 

yielding the update equations for the suspended cuttings fraction and pressure: 

 
     

       

1/2 1/2

0

1/2 1/2

i
s s s si i i

i
s s ext s s sii i i

X F F
t

F F Lm X X
t

   



 

 


  




   


  
 , (53) 

 
   

     

0
2 1/2 1/2

0 0

1/2 1/2

i
m m s m mi i

m i

i
m m m m m mi i i

p
X X F F

t c

F F X X
t


   

 

 

 

 
      


  



 


  
 . (54) 



 

15 

3.3.2 Flux linearization 

In order to compute the updated variables from (53) and (54) the flux increments must be 

linearized. This will be achieved in two steps, starting with the velocity linearization and 

following with the complete fluxes. 

The change in mud velocity due to pressure and cuttings concentration variations can be 

estimated from Eq. (37): 

      11/2 1/2
1/2

mix mix
m o i o i x mixi i

m i

L p
V p p Lg

t V


    



 
      


 . (55) 

Experience shows that the last term in the RHS of (55) is extremely important. Neglecting it 

leads to very poor pressure estimations and lack of convergence. The change in mixture 

density at the midpoint can be written as: 

 

 
   

   

   

1
1/2

1

1

1
1/2

2

2

2 2

2

m m s s m m s si i
mix i

m m s s m m s si i

s m s m
s s

i i

s m
s si i

i

X X X X

X X X X

X X

X X

     


       

   
 

 
 











  
 

  


           
       

 . (56) 

Note that, due to the low compressibility of the mud, we assume m m m mX X   . 

Combining (55) and (56) yields the linearized velocity correction: 

 

 

         

1/2
1/2

1 1 1
1/22

mix mix
m i

m i

x
o i o i s m s s m si i i i

i

L p
V

t V

Lg
p p X X




       




  


 
    

           



 . (57) 

The cuttings velocity linearization is obtained adding to (57) the linearized slip velocity 

computed from (44): 

 

     0 0 11/2 1/2
1/2

0term

s term
s m i ii i

i s sV V V

V
V V p p

L D D


     


 

  


 

 . (58) 

The linearized fluxes are obtained from (46), together with the assumption that, due to the low 

Mach number, density variations are negligible compared with changes in velocity: 



 

16 

  1/2
1/2

i
k k k k k k

i
F A X V V X   


   

   . (59) 

In particular, the mud flux variation is 

 

         

         

1/2

1/2 1/2 1/21/2 1/2

1/2 1/2 11/2
1/2

2

i
m m m m m mi i ii i

m
m m m s si i i ii

i

F A X V V X

V
A X V X X

   

   


   

  


    
  

      
  

 




 ; (60) 

and the change is cuttings flux is 

 

         

         

1/2

1/2 1/2 1/21/2 1/2

1/2 1/2 11/2
1/2

2

i
s s s s s si i ii i

s
s s s s si i i ii

i

F A X V V X

V
A X V X X

   

   


   

  


    
  

      
  

 




 , (61) 

with the variations in mud and cuttings velocities given by (57) and (58). 

3.4 Solution procedure 

The global solution is obtained following these steps: 

1. Initialize all variables with the appropriate initial conditions (or a guess of the solution 

in the case of time marching to steady-state). 

2. Solve for updated velocity with the iterative scheme (41). 

3. Update cuttings velocities with (44). 

4. Update pressure and cuttings concentration solving the linear system of equations (53)

-(54). 

5. Go back to step 2 until convergence is achieved. 

6. Continue to next time step (update boundary conditions and time increment) and 

proceed to step 2. 

3.5 Convective stabilization 

The equations do not contain any diffusion for the transport of cuttings (it is a purely 

convective phenomenon) so the solution is subject to instabilities (odd-even decoupling). In 

fact, given that the discretization is second-order space-accurate, Godunov’s theorem [18] 

states that any linear scheme will be subject to spurious oscillations near discontinuities. A 

simple workaround is to revert to first order space accuracy for the cuttings transport. This 



 

17 

can be easily achieved by altering the interfacial fluxes of cuttings appearing on the RHS of 

(53). The second-order centered discretization of the flux is: 

          11/2 1/2 1/22
center

s
s s s s s s si ii i i

F AV X AV X X



  

    
    . (62) 

This can be replaced by the first-order upwind approximation to improve stability 

      
1/2 1/2

upwind

s s s s ii i
F AV X

 
   , (63) 

where it has been assumed that the cuttings move from node i to node i+1. In case of reversed 

flow the cuttings concentration would be evaluated at node i+1 (the value at the upstream 

node must always be chosen). The upwind approximation increases the numerical diffusivity 

of the cuttings, but this is not considered a limitation. In real cases there is a random 

distribution of cuttings sizes and shapes, so their slip velocities are not uniform. Therefore, 

the cuttings transport velocity is variable, causing a streamwise smoothing of the cuttings 

concentration. The extra diffusion created by the upwind approximation has a qualitatively 

similar effect, which is not detrimental for the quality of the solution. 

3.6 Moving drillstring 

For surge/swab simulation (i.e. computing the effect of vertical displacements of the 

drillstring) the nodes of the grids can be set in motion to reflect the changes in well geometry. 

The basic equations can be easily modified to account for the drillstring velocity. 

3.6.1 Velocity update with moving drillstring 

The equations retain the same form as in section 3.2 except that the frictional losses are 

computed using the equivalent mud velocity given by: 

 

    for drillpipe

 for annulus
2

         otherwise

m DP

eq DP
m m

m

V V

V
V V

V




 



 , (64) 

where VDP denotes the drillpipe longitudinal velocity. 

3.6.2 Mass balance with moving drillstring 

Using an arbitrary Lagrangian-Eulerian (ALE) framework [19], the discrete mass 

conservation statement (47) becomes 



 

18 

        0 0 0
1/2 1/2

1 ALE ALE
p p p p p p p ii i i
X X F F L

t
  

 
    


 , (65) 

where the fluxes have been modified to account for the interface velocity: 

    
1/2 1/2

ALE
p p p g pi i

F V V X A
 

     . (66) 

The grid velocity (Vg) at the interface can be interpolated from the nodal velocities: 

  
   

1

1/2 2
g gi i

g i

V V
V 




  . (67) 

4 Application Examples 

To illustrate the performance of the method this section presents four benchmark cases for 

which reference solutions are available, followed by a real-world application example. 

4.1 Quasi-steady mud transport test 

To validate the mud rheology model the long-term pressure drop along a horizontal pipe 

segment has been compared with the results from the API RP 13D standard [13]. The relevant 

problem data are: 

 Pipe length: L = 100 m 

 Pipe diameter: D = 20 cm 

 Mud density: = 1900 kg/m3 

 Speed of sound: c = 1100 m/s 

 Fann viscometer readings: 3 = 7, 6 = 8, 300 = 38, 600 = 63 

The characteristic wave propagation time for sound waves along the pipe is / 0,1ct L c s  . 

For time scales long compared to tc dynamic effects are expected to be negligible and a quasi-

steady solution is obtained. The pressure drop across the pipe segment has been ramped 

linearly from 0 to 5 bar over a period of 1000 s and the results of the numerical model 

compared with the steady-state predictions from [13]. Fig. 3 shows the excellent agreement of 

the numerical model. 



 

19 

0

0.1

0.2

0.3

0.4

0.5

1 2 3 4 5 6 7 8 9

D
ri
v
in
g
 P
re
ss
u
re
 (
M
P
a
)

Velocity (m/s)

API RP 13D

Transient solver

 

Fig. 3 Quasi-steady pressure drop 

4.2 Surge/Swab test 

To validate the ALE formulation the case of slow drillstring motion has been analysed. Using 

an analysis time large compared with the residence time of pressure waves the dynamic 

effects are negligible and an incompressible steady solution can be used as reference. A 3000 

ft (900 m) well with two drillstring sections as depicted in Fig. 4 is studied. 

A

1000 ft

2 ft 1 ft 3 ft

1000 ft 1000 ft

CB

x

 

Fig. 4 Moving drillstring test case geometry 

The drillpipe is lowered at 1 ft/s (0,3 m/s) during one minute and then raised back to its 

original position. The hole diameter is 3 ft (90 cm) and the drillpipe diameter varies from 2 ft 

in section A to 1 ft in section B. The pipe is closed, so mud flows only in the annulus. 

Assuming full incompressibility the annular flow velocities can be easily estimated: 

 
2 2

2 2 2 2

2 1
0,8 ; 0,125

3 2 3 1
A DP B DP

ft ft
V V V V

s s
   

 
 . (68) 



 

20 

The output from the simulation, shown in Fig. 5 at 10 s steps, matches closely the expected 

results. 

‐1

‐0.8

‐0.6

‐0.4

‐0.2

0

0.2

0.4

0.6

0.8

1

0 20 40 60 80 100 120 140 160

F
lo
w
 v
e
lo
ci
ty
 (
ft
/s
)

Time (s)

Section A

Section B

 

Fig. 5 Outlet flow velocity during surge/swab test case 

4.3 Steady-state cuttings transport in vertical annulus test 

To validate the solid transport capability, the predictions of the numerical model have been 

checked against the detailed experimental results from [20]. The transport capabilities of 

different combinations of drilling muds and cuttings sizes were measured over a range of mud 

velocities inside a vertical annulus, representative of the conditions found in real wells. The 

results are expressed in terms of the effective cuttings transport ratio /s mR V V ; to improve 

hole cleaning large values of R (i.e. close to 1) are desirable. 

The Walker and Mayes method described in section 2.2.3 uses two parameters to describe the 

cuttings geometry (disk equivalent diameter and thickness). The diameter is taken as the 

hydraulic diameter of the cuttings, but the equivalent thickness must be calibrated using 

experimental data, usually by direct measurement of the terminal settling velocity. As this 

information was not available, the model was calibrated by directly matching the transport 

ratio from [20] for a single value of the mud velocity. The behaviour of the model was then 

evaluated varying the mud velocity over a wide range. Interestingly, the disk equivalent 

thickness was found to depend very weakly on the actual particle size. This is advantageous, 

as it reduces the need for recalibration of the model when the cuttings characteristics are 

changed. On the other hand, it was observed that it might be advisable to recalibrate the disk 



 

21 

thickness when muds with vastly different rheological properties are tested under very small 

anular velocities, i.e. below 30 ft/min (0,15 m/s). 

Fig. 6 compares the experimental vs. numerical results for three different cuttings sizes. 

Please refer to [20] for the complete description of the experimental conditions. The 

agreement is quite satisfactory over the complete range of velocities (the scatter of the raw 

experimental measurements is larger than the difference between the two data sets). 

35

40

45

50

55

60

65

70

75

80

85

90

50 75 100 125 150 175 200 225

Tr
a
n
sp
o
rt
 r
a
ti
o
 (
%
)

Annular velocity (ft/min)

Experimental (small cuttings)

Numerical (small cuttings)

Experimental (medium cuttings)

Numerical (medium cuttings)

Experimental (large cuttings)

Numerical (large cuttings)

 

Fig. 6 Effect of cuttings size on transport ratio 

(8”x4” annulus, mud#1, 12 ppg mud, 100 rpm drillpipe rotation) 

The effects of mud density (Fig. 7) and mud rheology (Fig. 8) were also studied, yielding 

satisfactory results (deviations always smaller than the spread of experimental data).  



 

22 

30

40

50

60

70

80

90

100

25 50 75 100 125 150 175 200 225

Tr
a
n
sp
o
rt
 r
a
ti
o
 (
%
)

Annular velocity (ft/min)

Experimental (12ppg mud)

Numerical (12ppg mud)

Experimental (15ppg mud)

Numerical (15ppg mud)

 

Fig. 7 Effect of mud density on transport ratio 

(8”x4” annulus, mud#1, medium cuttings, h=0.45”, no drillpipe rotation) 

30

40

50

60

70

80

90

100

25 50 75 100 125 150 175 200 225

Tr
a
n
sp
o
rt
 r
a
ti
o
 (
%
)

Annular velocity (ft/min)

Experimental (mud#1)

Numerical (mud#1)

Experimental (mud#2)

Numerical (mud#2)

 

Fig. 8 Effect of mud rheology on transport ratio 

(8”x4” annulus, 12 ppg mud, medium cuttings, h=0.45”, no drillpipe rotation) 

4.4 Fast pressure transient (water hammer) with viscous effects test 

The fast-transient (wave tracking) capability has been validated against the experimental 

study presented in [21]. The setup involves a pipe segment with a constant head water tank on 

the upstream end and a motorized valve at the outlet (Fig. 9). Starting from steady-state 



 

23 

conditions, the valve is closed following a predefined law while the pressure at several points 

along the duct is monitored. 

Href

0,33 m

31,67 m

motorized valve

constant-level tank

sump

16 mpressure 
measurement

 

Fig. 9 Experimental setup for water hammer test 

Fig. 10 shows a good agreement between the experimental and numerical results for the 

pressure at the midpoint of the duct. Some small differences must be expected because 

reference [21] gives the valve closure law in tabulated form. This has been simulated in the 

code using a minor loss at the pipe outlet. The loss factor is computed at each instant from the 

valve position table. However, the pressure surge is extremely sensitive to the interpolation 

algorithm used, causing minor discrepancies. 

 

Fig. 10 Pressure evolution at pipe midpoint 

4.5 Real-world application example 

To illustrate the real-world performance of the algorithm (mostly from the point of view of 

CPU time, as reliable experimental data from real wells is not freely available) a typical 

simulation for a 39 400 ft-deep (12 km) pressure managed well is presented. A sudden 



 

24 

actuation of the choke valve while the rig is working in steady conditions is simulated. The 

computation starts with a time-marching to stationary conditions followed with the fluid 

hammer event. 

The geometry is taken directly from the well logs, and includes a total of 273 cells for the 

drillpipe, annulus and underbit (the drillstring is partially raised, with the bit positioned at a 

depth of 6 km). Given that the code has no problem dealing with non-uniform grids (as 

opposed to programs based on the method of characteristics and explicit finite volume 

solvers) the cell sizes match exactly the log intervals. Thus, there is no smoothing of the 

geometry due to transfer of data to a uniform mesh. 

The time-marching to steady conditions takes 0,078 seconds in a Core i5-4200U @1.6GHz 

CPU (note that this is a low-power low-performance processor). The physical time simulated 

is 13 minutes, thus the computation runs 10 000 times faster than real time. This is possible 

due to the adaptive time stepping scheme used, which dynamically adjust the time increment 

to obtain the best compromise between iterative convergence and step size. For our solver it 

was found that the optimum performance is obtained when approximately 7 global iteration 

loops are performed for every time step. 

Once steady conditions have been reached (that we define as the point where the relative 

velocity and pressure changes fall below 10-6) a pressure increase of 85 psi (0,59 MPa) lasting 

1 s is prescribed at the outlet. The simulation runs 200 additional steps with a time increment 

of 40 ms to track the wave propagation along the well. This analysis requires 0,14 seconds in 

the same CPU indicated above. 



 

25 

‐0.2

‐0.1

0.0

0.1

0.2

0.3

0.4

0.5

0.6

0 1 2 3 4 5 6 7 8 9 10 11 12

P
re
ss
u
re
 c
h
a
n
g
e
 (
M
P
a
)

Depth (km)

t=1s

t=2s

t=3s

t=4s

t=5s

t=6s

t=7s

t=8s

 

Fig. 11 Pressure surge propagation along annulus and underbit 

The evolution of the pressure inside the annulus and underbit at one second intervals is shown 

in Fig. 11 (the pressure inside the drillstring was also computed, including jetting losses at the 

bit, but this data has been removed from the plot for the sake of clarity). Note the anomalous 

propagation at a depth of 2 km. This is due to the transition from the first to the second casing 

segment which causes a partial reflection together with an increase in pressure below the area 

restriction. 

5 Conclusions 

An unsteady hydraulic network solver for pressure management and cuttings transport in 

near-vertical oil wells has been presented. Due to an efficient implicit time integrator the code 

provides a unified framework to simulate long-term evolution of the well (e.g. hole cleaning 

operations) as well as fast transients (e.g. fluid hammer events during emergency well 

control). The method accounts for complex drilling mud rheology by means of the industry-

standard Herschel-Bulkley model and compressibility effects. By using a formulation based 

on the stagnation (total) pressure the effect of the convective derivative of the velocity is 

included implicitly, yielding a simple set of equations that can be solved efficiently. The 

ability of the method to accurately model several benchmark cases, both steady and transient, 

has been demonstrated. Finally, a practical application example for a real oil well has been 

presented, showing the excellent performance of the software. The evolution of the well over 



 

26 

time scales ranging from seconds to hours can be computed in a fraction of a second. This 

provides a valuable predictive tool to ensure safe drilling operations. 

Equivalence between field and SI units 

The text includes some field units widely used in the petroleum industry. We list here the 

equivalence with SI units. 

Table 1 Equivalence between petroleum field units and SI. 

Magnitude Symbol Section Field unit SI equivalence 

Particle size ds, hs  2.3.3 in 0,0254 m 

Density  2.3.3 lbm/gal (ppg) 119,8264 kg/m3 

Friction stress  2.3.3 lbf/100 ft2 0,4788026 Pa 

Dynamic viscosity  2.3.3 cP 0,001 Pa s 

Velocity V 2.3.3, 4.2 ft/s 0,3048 m/s 

Fann viscometer reading  4.1 º (degree) 1º 

Length L, d 4.2, 4.5 ft 0,3048 m 

Velocity V 4.3 ft/min 0,00508 m/s 

Acknowledgements 

This research was partially funded by Weatherford International. 

Conflict of interest statement 

On behalf of all authors, the corresponding author states that there is no conflict of interest. 

References 

[1] Malloy KP et al. (2009) Managed-pressure drilling: what it is and what it is not. IADC/SPE Managed 

Pressure Drilling and Underbalanced Operations Conference and Exhibition. San Antonio TX, USA 

[2] Elliot D et al. (2011) Managed pressure drilling erases the lines. Schlumberger Oilfield Review 23(1): 14-23 

[3] van Riet EJ, Reitsma D (2003) Development and testing of a fully automated system to accurately control 

downhole pressure during drilling operations. SPE/IADC Middle East Drilling Technology Conference & 

Exhibition. Abu Dhabi, UAE 

[4] Guo C et al (2010) Managed pressure drilling micro flux technology allows safer drilling in highly sour 

reservoirs. International Oil and Gas Conference and Exhibition in China. Beijing, China 

[5] Streeter VL, Wylie EB (1998) Fluid mechanics (International 9th revised Ed.). McGraw-Hill Higher 

Education, New York 

[6] Lohrasbi AR, Attarnejad R (2008) Water hammer analysis by characteristic method. American Journal of 

Engineering and Applied Sciences 1(4): 287-294 



 

27 

[7] Amein M, Chu HL (1975) Implicit  numerical  modeling  of  unsteady  flows. Journal of the Hydraulics 

Division - ASCE 101(6): 717-731 

[8] Wylie EB, Streeter VL (1970) Network system transient calculations by implicit method. 45th Annual 

Meeting of the Society of Petroleum Engineers of AIME. Houston TX, USA 

[9] Ghidaoui M et al. (2005) A review of water hammer theory and practice. Applied Mechanics Reviews - 

ASME 58: 49-76 

[10] Greyvenstein GP (2002) An implicit method for the analysis of transient flows in pipe networks. 

International Journal of Numerical Methods in Engineering 53: 1127-1143 

[11] Anderson JD (1995) Computational fluid dynamics: the basics with applications. McGraw-Hill, New York 

[12] Celigueta MA et al (2016) A FEM-DEM technique for studying the motion of particles in non-Newtonian 

fluids. Application to the transport of drill cuttings in wellbores. Computational Particle Mechanics 3(2): 263-

276 

[13] (2010) Rheology and hydraulics of oil-well fluids - API recommended practice 13D (6th Ed.). American 

Petroleum Institute, Washington-DC 

[14] Herschel WH, Bulkley R (1926) Konsistenzmessungen von Gummi-Benzollösungen, Kolloid Zeitschrift 

39: 291–300 

[15] Walker RE, Mayes TM (1975) Design of muds for carrying capacity. Journal of Petroleum Technology 259: 

893-900 

[16] Bourgoyne AT, Millheim KK, Chenevert ME, Young FS (1986) Applied Drilling Engineering. SPE 

Textbook Series, Richardson-TX, pp 173-183 

[17] Lomax H, Pulliam TH, Zingg DW (2003) Fundamentals of computational fluid dynamics. Springer, Berlin 

[18] Godunov SK (1954) Different methods for shock waves. PhD thesis, Moscow State University. 

[19] Stein E, de Borst R, Hughes TJR (Eds.) (2004) Encyclopedia of Computational Mechanics. Wiley, 

Hoboken-NJ, Vol. 1: Chapter 14 

[20] Sifferman TR, Mayers GM, Haden EL, Wahl HA (1974) Drill-cutting transport in full-scale vertical annuli. 

Journal of petroleum technology, 26(11): 1295-1302 

[21] Araya W, Chaudhry M (2001) Unsteady friction in rough pipes. Journal of Hydraulic Engineering 127(7): 

607-618 

 


	caratula Springercluster.pdf
	UPCommons
	Portal del coneixement obert de la UPC
	http://upcommons.upc.edu/e-prints
	Aquesta és una còpia de la versió author’s final draft d'un article publicat a la revista Computational particle mechanics.
	La publicació final està disponible a Springer a través de http://dx.doi.org/10.1007/s40571-018-0204-9
	This is a copy of the author 's final draft version of an article published in the journal Computational particle mechanics.
	The final publication is available at Springer via http://dx.doi.org/10.1007/s40571-018-0204-9
	Article publicat / Published article:


