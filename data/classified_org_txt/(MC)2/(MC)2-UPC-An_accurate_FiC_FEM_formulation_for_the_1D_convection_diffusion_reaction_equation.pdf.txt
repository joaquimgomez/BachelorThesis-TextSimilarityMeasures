









































































An accurate FIC-FEM formulation for the 1D convection-diffusion-reaction equation


Accepted Manuscript

An accurate FIC-FEM formulation for the 1D
convection-diffusion-reaction equation

E. Oñate, J. Miquel, P. Nadukandi

PII: S0045-7825(15)00316-3
DOI: http://dx.doi.org/10.1016/j.cma.2015.09.022
Reference: CMA 10717

To appear in: Comput. Methods Appl. Mech. Engrg.

Received date: 2 April 2015
Revised date: 23 September 2015
Accepted date: 26 September 2015

Please cite this article as: E. Oñate, J. Miquel, P. Nadukandi, An accurate FIC-FEM
formulation for the 1D convection-diffusion-reaction equation, Comput. Methods Appl. Mech.
Engrg. (2015), http://dx.doi.org/10.1016/j.cma.2015.09.022

This is a PDF file of an unedited manuscript that has been accepted for publication. As a
service to our customers we are providing this early version of the manuscript. The manuscript
will undergo copyediting, typesetting, and review of the resulting proof before it is published in
its final form. Please note that during the production process errors may be discovered which
could affect the content, and all legal disclaimers that apply to the journal pertain.

http://dx.doi.org/10.1016/j.cma.2015.09.022
marta garcia-sanchez
Texto escrito a máquina

marta garcia-sanchez
Texto escrito a máquina
NOTICE: this is the author’s version of a work that was accepted for publication in < Computer methods in applied mechanics and engineering>. Changes resulting from the publishing process, such as peer review, editing, corrections, structural formatting, and other quality control mechanisms may not be reflected in this document. Changes may have been made to this work since it was submitted for publication. A definitive version was subsequently published in Computer methods in applied mechanics and engineering, [(October 2015)] DOI 10.1016/j.cma.2015.09.022



AN ACCURATE FIC-FEM FORMULATION FOR THE 1D
CONVECTION-DIFFUSION-REACTION EQUATION

E. Oñate1,2, J. Miquel1,2 and P. Nadukandi1
1 Centre Internacional de Mètodes Numèrics en Enginyeria (CIMNE)
2 Universitat Politècnica de Catalunya
Campus Norte UPC, 08034 Barcelona, Spain

Abstract. In this paper we present an accurate stabilized FIC-FEM formulation for the 1D
advection-diffusion-reaction equation in the exponential and propagation regimes using two stabi-
lization parameters. Both the steady-state and transient solutions are considered.
The stabilized formulation is based on the standard Galerkin FEM solution of the governing differ-
ential equations derived via the Finite Increment Calculus (FIC) method. The steady-state problem
is considered first. The optimal value of the two stabilization parameters ensuring an exact (nodal)
FEM solution using uniform meshes of linear 2-noded elements is obtained. In the absence of the
absorption term the formulation simplifies to the standard one-parameter Petrov-Galerkin method
for the advection-diffusion problem. For the diffusion-reaction case one stabilization parameter
is just needed and the diffusion-type stabilization term is identical to that obtained by Felippa
and Oñate [16] using a variational FIC approach. A procedure for computing the stabilization
parameters for the transient problem is proposed. The accuracy of the new FIC-FEM formula-
tion is demonstrated in the solution of steady-state and transient 1D advection-diffusion-radiation
problems for a the range of physical parameters and boundary conditions. Finally we outline the
procedure to extend the 1D FIC-FEM formulation to multidimensions.

Key words: Finite element method, stabilized formulation, convection-diffusion-reaction, finite
increment calculus, finite calculus, FIC, one dimensional problem

1 INTRODUCTION

Considerable effort has been spent in recent years for deriving finite element methods (FEM) for
the solution of the advection-diffusion-reaction equation. The physical behaviour of this equation
is varied in terms of the values of the diffusion coefficient. In the propagation regime, originated
by large values of the productive term versus the diffusion one (the Helmholtz equation), solutions
are exponentially modulated sinusoidal functions. Typical problems found here in the numerical
solution are those of phase, amplitude and pollution errors. In the exponential regime, solutions are
of the form of real exponential functions where absorptive (dissipative) or productive source terms
are possible. Numerical schemes here find difficulties to approximate the sharp gradients appearing
in the neighborhood of boundary and internal layers in two (2D) and three (3D) dimensions due
to high Peclet and/or Damköhler numbers.

It is well known that the numerical solution of this problem by the Bubnov–Galerkin FEM
is prone to exhibit global, Gibbs and dispersive oscillations. The solution of the stationary prob-
lem by the above method exhibits spurious global oscillations for the convection-dominated case.
The local Gibbs oscillations are exhibited along the characteristic layers for the 2D/3D convection-
dominated case. For the reaction-dominated cases Gibbs oscillations may be found near the Dirich-
let boundaries and in the regions where the distributed source term is nonregular. The solution
of the transient problem may exhibit dispersive oscillations when the initial solution and/or the
distributed source term are nonregular.

1



In the context of variational formulations and weighted residual methods, control over the
global instability has been achieved via the streamline-upwind Petrov–Galerkin (SUPG) [6, 27],
Taylor–Galerkin [13], characteristic Galerkin [15, 37], Galerkin least squares (GLS) [29], bubble
functions [1, 3, 4], variational multiscale (VMS) [30], characteristic-based split (CBS) [67] and finite
increment calculus (also known as finite calculus) (FIC) based methods [42, 44, 45, 53, 54, 57]. A
thorough comparison of some of these methods can be found in [9]. Oñate and Manzan [44, 45]
showed that many of the above stabilized methods can be recovered using the FIC equations via an
appropriate definition of the stabilization parameters. Nevertheless nonregular solutions continue
to exhibit the Gibbs and dispersive oscillations.

Several shock-capturing nonlinear Petrov–Galerkin methods were proposed to control the Gibbs
oscillations observed across characteristic internal/boundary layers for the convection-diffusion
problem [8, 11, 16, 22, 34, 35, 38, 53]. A thorough review, comparison and state of the art of
these and several other shock-capturing methods for the convection-diffusion equations was done
in [33]. Reactive terms were not considered in the design of these methods and hence they fail to
control the localized oscillations in the presence of these terms. Exceptions to this are the consistent
approximate upwind (CAU) method [22], the methods presented in [7] and those that take the CAU
method as the starting point [16]. Nevertheless, the expressions for the stabilization parameters
therein were never optimized for reactive instability and often the solutions are over-diffusive in
these cases.

In the quest to gain reactive stability several methods were built upon the existing frameworks
of methods that control global oscillations. Following the framework of the SUPG method linear
Petrov–Galerkin methods were proposed for the convection–diffusion–reaction problem, viz. the
DRD [65] and (SU+C)PG [31] methods. Based on the GLS method, linear stabilized methods were
proposed, viz. the GGLS method [18] for the diffusion–reaction problem and the GLSGLS method
[23] for the convection-diffusion-production problem. Within the framework of stabilization via
bubbles the USFEM method [19] for the diffusion–reaction problem, the improved USFEM method
[20] and the link cutting bubbles procedure [5] for the convection–diffusion–reaction problem were
proposed. Based on the VMS method linear stabilized methods were proposed for the convection–
diffusion–reaction problem, viz. the ASGS method [10], the methods presented in [24, 25] and
the SGS-GSGS method [26]. Using the FIC equations a nonlinear method based on a single
stabilization parameter was proposed for the convection–diffusion–absorption problem in 1D [54]
and higher dimensions [57]. Nodally exact Ritz discretizations of the 1D diffusion-reaction equation
by variational FIC and modified equation methods using a single stabilization parameter were
presented in [17].

In [39] we presented the design of a FIC-based nonlinear high-resolution Petrov–Galerkin
(HRPG) method for the 1D convection–diffusion–reaction problem. The method is capable of
reproducing high-resolution numerical solutions for both the stationary (efficient control of global
and Gibbs oscillations and transient regimes (efficient control of dispersive oscillations. In [40] we
presented the statement of the problem and the HRPG method in higher-dimensions.

Generally the homogeneous steady convection–diffusion–reaction problem in 1D has two funda-
mental solutions. Likewise, the characteristic equation associated with linear stabilized methods
which result in compact stencils are quadratic and hence have two solutions. Thus in principle using
two stabilization parameters (independent of the boundary conditions) linear stabilized methods
which result in compact stencils can be designed to be nodally exact in 1D. Following this line
several “two-parameter methods” were designed to be nodally exact for the stationary problem in
1D [5, 23, 26].

Control over the dispersive oscillations for the transient convection-diffusion problem via lin-
ear Petrov–Galerkin methods were discussed in [32] and using space-time finite elements in [66].
As for the linear methods, optimizing the expressions of the stabilization parameters to attain
monotonicity will lead to solutions that are at most first-order accurate.

In this paper we present an accurate FIC-FEM formulation for the 1D advection-diffusion-
reaction equation in the exponential and propagation regimes using two stabilization parameters.

2



Both the steady-state and transient solution are considered. The numerical procedure can be
considered as an alternative to the two-parameter stabilized methods proposed in previous works.
Some of the advantages of the formulation here proposed are its simplicity and that it can be
naturally extended to multidimensional problems.

The stabilized formulation we present is based on the standard Galerkin FEM solution of the
modified governing differential equations derived via the FIC method [42, 44, 45, 47, 49, 50].

The steady-state problem is considered first. The Galerkin FIC-FEM formulation introduces a
residual-based term into the discretized equations in space which is governed by two stabilization
parameters. The optimal value of these parameters ensuring an exact (nodal) FEM solution using
uniform meshes of linear 2-noded elements is obtained. In the absence of the absorption term the
formulation simplifies to the standard one-parameter Petrov-Galerkin approach for the advection-
diffusion problem. For the diffusion-reaction case one stabilization parameter is just needed and
the diffusion-type stabilization term is identical to that obtained by Felippa and Oñate [17] using a
variational FIC approach. A procedure for computing the stabilization parameters for the transient
problem is proposed. The merit of the new FIC-FEM formulation is that it yields stabilized and
accurate numerical solutions for the steady-state and transient 1D advection-diffusion-radiation
equation for all the range of physical parameters and boundary conditions.

The lay-out of the paper is the following. In the next section we formulate the FIC form of
the equations governing steady-state 1D convection-diffusion-reaction problem. The finite element
discretization using the linear 2-noded element is presented. Then the optimal stabilization pa-
rameters yielding nodally exact solutions for the sourceless case using a regular mesh of linear
elements are obtained. The expression of the optimal stabilization parameters for a constant and
a linear source function is presented. The accuracy of the new FIC-FEM formulation for steady-
state problems is verified in the solution of a number of 1D advection-diffusion-reaction problems in
the exponential and propagation regimes using uniform and irregular meshes of 2-noded elements.
Exact nodal solutions are obtained in all cases when regular meshes are used, as expected. The
accuracy obtained for non-regular meshes is also remarkable.

In the last part of the paper the FIC-FEM formulation is extended to transient 1D advection-
diffusion-reaction problems. The key ingredients of the stabilized transient formulation are given
and some examples of its accuracy are presented.

2 THE STEADY STATE PROBLEM

2.1 Governing equations

The governing equations for the steady-state convection-diffusion-reaction problem in a 1D
domain of length l are

Transport balance

rs = 0 in Ω := [0, l] (1a)

with

rs := ρcu
dφ

dx
− d
dx

(
k
dφ

dx

)
+ sφ−Q (1b)

The index s in rs distinguishes the governing differential equation over the domain Ω for the
steady-state case from the transient one studied in Section 8.

Boundary conditions

φ− φp = 0 on Γφ (2)

3



rΓ = 0 on Γq (3a)

with

rΓ =
(
−ρcuφ+ kdφ

dx

)
n+ qp = 0 (3b)

In Eqs.(1)–(3) φ is the transported variable (for instance, the temperature in a heat transfer
problem), u is the velocity, ρ, c and k are the density, the specific flux parameter and the conductiv-
ity of the material, respectively, s is the reaction parameter (s > 0 is the absorption or dissipation
parameter and s < 0 is the production parameter). In the following, and unless otherwise specified,
we will assume that the problem parameters (u, ρ, c, k, s) are constant over the analysis domain.

In Eqs.(2) and (3) φp and qp are the prescribed values of the transported variable and the
outgoing flux at the Dirichlet and Neumann boundaries Γφ and Γq, respectively, with Γφ∪Γq = Γ,
Γ being the total boundary of the domain and n defines the sign of the normal direction at the
boundary edges. For simplicity, we will assume in this work Γφ and Γq to be placed at x = 0 and
x = l, respectively. Hence, n = +1 at x = l.

Eqs.(1)–(3) solve the following particular problems:

(i) Advection-diffusion (s = 0)

(ii) Helmholtz (u = 0, s < 0)

(iii) Advection-reaction (k = 0)

(iv) Diffusion-reaction (u = 0)

The different equations can be found in many practical applications such as fluid and heat
transport, acoustics, chemical reactions, bio-medical and bio-engineering problems and finances,
among others.

The exact solution of Eqs.(1)–(3) for the sourceless case (Q = 0) can be written as (Appendix
A)

φ = Ae
x
d

(γ+λ) +Be−
x
d

(γ−λ) (4)

where A and B are coefficients that depend of the boundary conditions, λ and γ are non dimensional
parameters defined below and d is an arbitrary distance.

In the following we will take distance d equal to the element length le in a uniform mesh of
linear 2-noded elements. Hence, we can define λ as

λ = (γ2 + w)1/2 (5)

where

γ =
ρcule

2k
and w =

s(le)2

k
(6)

are, respectively, the element Peclet number and a non-dimensional parameter that expresses the
relative value of the reaction and diffusion effects.

The exponential and (exponentially modulated) propagating regimes are determined by

γ2 + w ≥ 0 exponential solution
γ2 + w < 0 propagation solution

For the advection-reaction case, k = 0 and then only the upstream boundary condition is
necessary. If u > 0, the exact steady-state solution is

φ(x) = φpe−
s
ρcu (7)

4



2.2 Finite Increment Calculus (FIC) expressions

The governing equations (1)–(3a) are modified following the FIC approach in space [42, 44, 45,
53, 54, 57] as

Transport balance

rs −
1
2
h
drs
dx

= 0 in Ω (8)

Boundary conditions

φ− φp = 0 on Γφ (9)

rΓ +
1
2
hrs = 0 on Γq (10)

where h is a characteristic distance that can have a positive or negative value and rs and rΓ are
defined in Eqs.(1b) and (3b), respectively.

Eqs.(8) and (10) are obtained by expressing the balance of fluxes in an arbitrary segment of
finite length h (termed the characteristic length) within the problem domain and at the Neumann
boundary, respectively. The variations of the transported variable within the balance segment are
approximated by Taylor series expansions retaining one order higher terms than in the infinitesimal
theory [42]. The underlined terms in Eqs.(8) and (10) emanate from these series expansions and
they are essential to derive stabilized numerical schemes.

Note that rs 6= 0 and rΓ 6= 0 in the FIC balance equations (8) and (10). However, as the
characteristic length h tends to zero the FIC differential equations gradually recover the standard
infinitesimal form, giving in the limit (for h = 0) rs = 0 in Ω and rΓ = 0 on Γq.

Similarly as in all stabilized methods, the stability and accuracy of the numerical solution
depends on the values of the stabilization parameter, i.e. of the characteristic length h. At
the discrete level h can be interpreted as a distance related to the (macroscopic) domain within
which the space derivatives are computed. At the discretization level it is usual to express h as a
proportion of a typical grid dimension (i.e. the element length for 1D FEM problems) [42].

The FIC governing equations lead to stabilized numerical schemes using whatever numeri-
cal method. It is interesting that many of the stabilized FEM can be recovered using the FIC
formulation. The FIC-FEM method has been successfully applied to the finite element solution
problems of convection-diffusion [42, 44, 45, 53], diffusion-absorption and Helmholtz [17], advection-
diffusion-absorption [54, 57], incompressible fluid flow [55, 56, 58, 60, 62], fluid-structure-interaction
[47, 51, 59], particulate flows and standard and incompressible solid mechanics [49, 52, 61]. Appli-
cations of the FIC stabilization approach to meshless problems solved using the finite point method
are reported in [46, 48].

Eqs.(8) and (10) hold for any definition of the characteristic distance h. Let us now choose two
specific forms of h, as

hu = αul
e (11)

hg = 2αg
k

rs
φ′ (12)

where the prime superindex denotes the space derivative, and αu and αg are stabilization parame-
ters. In this work we will frequently refer to αu and αg as the streamline (or SUPG) and isotropic
diffusion parameters, respectively. Indeed, this distinction is more meaningful in multidimensional
problems [55].

5



The choice of hu and hg in Eqs.(11) and (12) leads to a simple form of the stabilization terms,
as it will be shown later. The characteristic length vector h is defined as the sum of hu and hg, i.e.

h = hu + hg = αul
e + 2αg

k

rs
φ′ (13)

Substituting Eqs.(11) and (12) into (13) and this into (8) gives the FIC governing equations as

rs −
1
2

[
αul

e + 2αg
kφ′

rs

]
drs
dx

= 0 (14)

3 WEIGHTED RESIDUAL FORM

The weighted residual form is written using the definition of rΓ of Eq.(3b) and n = 1 at x = l
as ∫ l

0

W

(
rs −

h

2
drs
dx

)
dx+

[
W

(
−ρcuφ+ kdφ

dx
+ qP +

h

2
rs

)]
l

= 0 (15)

where W are appropriate space weighting functions such that W = 0 on Γφ (i.e. at x = 0).
Integrating by parts the term involving h in the first integral leads to

∫ l

0

Wrsdx+
∫ l

0

h

2
dW

dx
rsdx+

[
W

(
−ρcuφ+ kdφ

dx
+ qP

)]
l

= 0 (16)

Note that the boundary term involving rs has vanished in Eq.(16) due to the integration by
parts. Also in the derivation of Eq.(16) we have neglected the space derivative of h.

Substituting the expression of rs of Eq.(1b) into (16) and integrating by parts the convective
and diffusive terms in the first integral leads to

∫ l

0

(
−ρcdW

dx
uφ+

dW

dx
k
dφ

dx
+Wsφ−WQ

)
dx+

∫ l

0

h

2
dW

dx
rsdx+ [Wq

p]l = 0 (17)

Let us substitute the expression of h of Eq.(13) into the second integral of Eq.(17). Using the
expression of rs of Eq.(1b) and the definition of Eqs.(11) and (12), Eq.(17) can be written, after
grouping terms, as

∫ l

0

(
−dW
dx

ρcūφ+
dW

dx
k̄
dφ

dx
+Wsφ− W̄Q

)
dx−

−
∫ l

0

dW

dx

hu
2

d

dx

(
k
dφ

dx

)
dx+ [Wqp]l = 0 (18)

where
W̄ = W + αu

le

2
dW

dx
(19a)

ū =
(

1− αusl
e

2ρcu

)
u (19b)

and

k̄ =
(
k + αu

ρcule

2
+ αgk

)
= k + ku + kg (19c)

In Eq.(19c) ku and kg are (positive) stabilization diffusion parameters given by

ku = αu
ρcule

2
= αuγk , kg = αgk (20)

6



Eq.(19c) can be rewritten as
k̄ = k(1 + θ) (21)

with
θ = αuγ + αg (22)

being the generalized stabilization parameter, computed from the contribution of the streamline
and isotropic diffusion parameters αu and αg.

The term θk in Eq.(21) is the so-called artificial (or stabilizing) diffusion that is introduced
using different arguments in many stabilized FEM [6, 14, 27, 28, 69].

Remark 1. The velocity ū in Eq.(19b) can be rewritten as

ū =
(

1− αu
w

4γ

)
u =

(
1− αu

2
σ
)
u (23)

where σ = w
2γ

= sl
e

ρcu
is the Damköhler number.

The pseudo-Peclet number is defined as

γ̄ =
ρcūle

2k
=
(

1− αu
2
σ
)
γ (24)

The challenge now is to find the values of the two stabilization parameters αu and αg (or those
of the related parameters θ and γ̄) that lead to a stable and accurate numerical solution. In this
work, we will find an optimal expression of these parameters that yields exact nodal solutions
for uniform meshes of linear 2-noded elements. The optimal stabilization parameters also give
accurate results for irregular meshes, as shown in the examples presented in the paper.

4 FINITE ELEMENT DISCRETIZATION

The transported variable φ is interpolated in terms of nodal values in a mesh of C0 contin-
uous elements in the standard manner [68]. For each element with n nodes, the finite element
interpolation is written as

φ(x) ' φ̂(x) =
n∑

i=1

Ni(x)φi (25)

where Ni(x) is the space shape function of node i and φi is the nodal value of the approximate
function φ̂ at the ith node.

Substituting the approximation (25) into the stabilized weak form (17) and choosing a Galerkin
weighting (Wi = Ni) [68] leads to the following system of discretized equations

[
K−C + S

]
φφφφφφφφφφφφφφ = f (26)

where vector φφφφφφφφφφφφφφ = [φ1, φ2, · · · , φN ]T lists the values of the approximated transported variable at
the N nodes in the mesh, K is the diffusion matrix, C is the convection matrix, S is the radiation
matrix and f is the nodal external flux vector. These matrices and vector f are assembled from
the element contributions given by

Keij =
∫

le

[
dNi
dx

k̄
dNj
dx
− dNi

dx

hu
2

d

dx

(
k
dNj
dx

)]
dx (27a)

Ceij =
∫

le

dNi
dx

ρcūNjdx , S
e
ij =

∫

le
sNiNjdx (27b)

fei =
∫

le

[
Ni + αu

le

2
dNi
dx

]
Qdx (27c)

7



Note that the second term in the expression of Keij in Eq.(27a) vanishes for linear 2-noded
elements.

The prescribed outgoing flux (qp) is directly added (with a negative sign) to the component of
vector f for the node laying on the Neumann boundary, as usual.

4.1 Element matrices for the linear 2-noded element

The element matrices in Eq.(26) take the following form for the linear 2-noded element

Ke =
k̄

le

[
1 −1
−1 1

]
, Ce =

ρcū

2

[
−1 −1
1 1

]
, Se =

sle

6

[
2 1
1 2

]
(28a)

The form of vector fe for 2-noded elements depends on the particular expression of the source
term. For a constant source Q(x) = Q0,

fe =
Q0l

e

2

{
1− αu
1 + αu

}
(28b)

where
αeu =

1
le

∫

le
αudx (28c)

Remark 2. A constant value of αu over the mesh leads to the vanishing of the stabilization term
in the assembled external flux vector f of Eq.(28b) for the interior nodes in a mesh of equal
length elements.

5 OPTIMAL STABILIZATION PARAMETERS FOR THE SOURCELESS CASE
(Q = 0)

5.1 Finite element stencil for the sourceless case

As previously mentioned, the goal is to find the expression of the stabilization parameters αu
and αg that yield nodally exact solutions for all regimes of the physical parameters in Eqs.(1)–(3).
Indeed, this is possible for the linear 2-noded element as it will be shown below.

Let us consider a steady-state problem with Q = 0, uniform material properties and Dirichlet
boundary conditions with φ fixed to values 0 and φp at x = 0 and x = l, respectively. The problem
is solved with a mesh of linear 2-noded elements of equal length le.

The FE equation stencil for three consecutive nodes i− 1, i, i+ 1 is

ρcū

2
(−φi−1 + φi+1) +

k̄

le
(−φi−1 + 2φi − φi+1) +

sle

6
(φi−1 + 4φi + φi+1) = 0 (29)

Eq.(29) can be rewritten after dividing by k
le

as

γ̄(−φi + φi+1) + (1 + θ)(−φi−1 + 2φi − φi+1) +
w

6
(φi−1 + 4φi + φi+1) = 0 (30)

or
−
(
γ̄ + 1 + θ − w

6

)
φi−1 + 2

(
1 + θ +

w

3

)
φi −

(
−γ̄ + 1 + θ − w

6

)
φi+1 = 0 (31)

where γ̄ was defined in Eq.(24).

8



5.2 Optimal stabilization parameters

The exact solution of Eq.(1) for Q = 0 and uniform properties satisfies the following equation
in differences over a grid of equally - spaced segments of length le (Appendix A)

−eγ φ̂i−1 + 2 coshλφ̂i − e−γ φ̂i+1 = 0 (32)

with λ and γ as defined in Eqs.(5) and (6).
In Eq.(32), (̂·) denotes the exact nodal values of the transported variable.
For convenience, we will obtain first the optimal value of the parameters θ and γ̄ that yield

exact nodal finite element results, and subsequently that of the related stabilization parameters
αu and αg.

Assuming nodal exactness of the numerical solution and comparing the coefficients in Eqs.(31)
and (32), we deduce the following two equalites

γ̄ + 1 + θ − w
6

2(1 + θ + w
3

)
=

eγ

2 coshλ
(33)

−γ̄ + 1 + θ − w
6

2(1 + θ + w
3

)
=

e−γ

2 coshλ
(34)

Solution of Eqs.(33) and (34) for θ and γ̄ gives

θ =
w

6

(
coshλ+ 2 cosh γ
coshλ− cosh γ

)
− 1 (35)

γ̄ =
(

w sinh γ
2(coshλ− cosh γ)

)
(36)

The relationship between θ and γ̄ is

θ = γ̄ coth γ +
w

6
− 1 (37)

Let us obtain now the expression of the two stabilization parameters αu and αg.
From Eq.(36) and the definition of γ̄ (Eq.(24)) and the expression of ū of Eq.(23) we deduce

αu(γ,w) =
4γ
w
− 2 sinh γ

coshλ− cosh γ (38)

It can be readily found

lim
γ→0

αu(γ,w) = αu(w) = 0 (39a)

lim
w→0

αu(γ,w) = αu(γ) = coth γ −
1
γ

(39b)

Expression (39b) is the optimal stabilization parameter for the 1D convection-diffusion case
problem solved with the SUPG method and 2-noded elements [14, 69]. Note that αu(γ) → 0 for
γ → 0 and αu(γ)→ 1 for γ →∞.

From the definition of θ (Eq.(22)) and using Eqs.(35) and (38) we obtain

αg(γ,w) =
w
6

(coshλ+ 2 cosh γ) + 2γ sinh γ
coshλ− cosh γ −

4γ2

w
− 1 (40)

9



From Eq.(40) we can find
lim
w→0

αg(γ,w) = αg(γ) = 0 (41)

lim
γ→0

αg(γ,w) = αg(w) =
w

4 sinh2(
√
w

2
)

+
w

6
− 1 (42)

Expression (42) is the optimal stabilization parameter for the 1D diffusion-reaction problem
solved with the FIC-FEM approach using 2-noded elements. This expression was obtained by
Oñate et al. [54].

The reaction stabilization parameter αg of Eq.(42) can be expressed as

αg(w) =

[
1

4 sinh2(
√
w

2
)

+
1
6
− 1
w

]
w = ᾱg(w)w (43)

with
ᾱg(w) =

1

4 sinh2(
√
w

2
)

+
1
6
− 1
w

(44)

It can be shown that

lim
w→0

ᾱg(w) =
1
12

and lim
w→∞

ᾱg(w) =
1
6

(45)

The expression of ᾱg of Eq.(43) is identical (with a factor of 4) to that derived by Felippa and
Oñate [17] for the diffusion-reaction problem using a variational FIC formulation.

It is interesting to obtain the limits of θ and γ̄ for w = 0 and γ = 0. After small algebra and
taking into account Eq.(22) we obtain

lim
w→0

γ̄ = γ , lim
γ→0

γ̄ = 0 (46a)

lim
w→0

θ = γ coth γ − 1 , lim
γ→0

θ =
w

4 sinh2
(√

w
2

)
− 1

+
w

6
− 1 = αg(w) (46b)

Remark 3. The expressions for θ, γ̄, αu and αg in Eqs.(35)–(40) hold naturally for γ2 + w ≥ 0
(λ is a real number and the solution is exponential). For γ2 + w < 0 (λ is an imaginary
number and the solution is an exponentially modulated propagation of φ) the expressions
for the stabilization parameters are readily obtained by changing coshλ and sinhλ for cos |λ|
and sin |λ|, respectively in Eqs.(35)–(40).

Remark 4. It can be verified that αg is greater or equal to zero for all values of γ and w. This
guarantees that the stabilization diffusion kg is positive (see Eq.(20)).

Remark 5. The expression of αu satisfies the condition sgn(αu) = sgn(γ), where sgn(·) is the
sign function. This ensures that αuγ ≥ 0 and guarantees that the stabilization diffusion ku is
positive (Eq.(20)). As kg is also positive (Remark 4) the stabilization parameter θ is always
positive (Eq.(22)).

Remark 6. Substituting Eq.(38) into (24) it is deduced that sgn(γ̄) = sgn(γ). Consequently,
γ̄ coth γ ≥ |γ̄| and, therefore, the generalized stabilized parameter θ satisfies the general
conditions for stability of the convection-diffusion-radiation problem (Appendix C), i.e.

θ >
w

6
+ |γ̄| − 1 (47)

The proof of Eq.(47) is straightforward using the expression of θ of Eq.(37).

10



Remark 7. The expressions of αu and αg can be written in more compact form in terms of the
Damköhler number σ as

αu =
2
σ

(
1− σ tanh γ

ξ − 1

)
(48a)

αg = γ
[
σ

3

(
ξ + 2
ξ − 1

)
− αu

]
(48b)

with ξ = coshλ
cosh γ

.

6 EXTENSION TO THE SOURCE CASE (Q 6= 0)
6.1 General expressions

The exact solution of Eq.(1) for Q 6= 0 satisfies the following equation in differences in a grid
of equally-spaced segments of length le (Appendix B)

−eγ φ̂i−1 + 2 coshλφ̂i − e−γ φ̂i+1 = −eγφpi−1 + 2 coshλφ
p
i − e−γφ

p
i+1 (49)

where φpi−1, φ
p
i and φ

p
i+1 are the values of the particular solution φ

p(x) of the differential equations
(1) computed at three consecutive nodes i− 1, i and i+ 1, respectively.

The FE stencil in a mesh of equal length 2-noded elements accounting for the external flux
term can be written as

−(γ̄ + 1 + θ − w
6

)φi−1 + 2(1 + θ +
w

3
)φi − (−γ̄ + 1 + θ −

w

6
)φi+1 =

(le)2

k
(1 + αi)fi (50)

where fi is the external flux at node i, neglecting the stabilization terms (i.e. making αu = 0 in
the expression of fe of Eq.(27c)) and αi is a nodal stabilization parameter that results from the
assembly of the stabilization terms in vector fe.

The value of αi can be obtained by equalling the r.h.s. of Eqs.(49) and (50) after dividing by
the coefficient multiplying φi and φ̂i in each of the two equations. This gives

(le)2(1 + αi)fi
2k(1 + θ + w

3
)

=
−eγφpi−1 + 2 coshλφ

p
i − e−γφ

p
i+1

2 coshλ
(51)

From Eq.(51) we find

αi = −1 +
k(1 + θ + w

3
)(−eγφpi−1 + 2 coshλφ

p
i − e−γφ

p
i+1)

(le)2fi coshλ
(52)

In the following lines we compute the optimal value of αi for different external source terms
Q(x) in a uniform mesh of 2-noded elements.

6.2 Constant external flux: Q(x) = Q0

The particular solution of Eq.(1a) is

φp(x) =
Q0
s

(53)

On the other hand, the value of the nodal flux is deduced from Eq.(27b) as

fi = Q0l
e (54)

Substituting Eqs.(53) and (54) into (52) gives after small algebra

αi = −1 +
2(coshλ− cosh γ)

w coshλ
(1 + θ +

w

3
) (55)

11



Substituting the expression of θ of Eq.(35) into (55) yields

αi = 0 (56)

Hence, nodally exact solutions will be obtained for a constant source and a mesh of equal length
2-noded elements neglecting the effect of the stabilization term (i.e. αu = 0) in the expression of
fe of Eq.(28b).

This result is consistent with the fact that the contribution of the stabilization term in the
nodal flux vector vanishes for the interior nodes in the assembled expression of f for this case, as
explained in Remark 2.

6.3 Linear source term: Q(x) = ax+ b

The particular solution of Eq.(4) is

φp(x) =
a

s
x−

(
u

s2
a− b

s

)
(57)

The nodal flux term is deduced from Eq.(27b) as

fi = b+
a

2
(1 + 2xi − le) (58)

Substituting Eqs.(57) and (58) into (52) gives the optimal value of αi as

αi = −1 +
k(1 + θ + w

3
)

(le)2
(
b+ a

2
(1 + 2xi − le)

)
le coshλ

×

×
[
2(coshλ− cosh γ)

(
b

s
− u
s2
a

)
+ (−eγxi−1 + 2 coshλxi − e−γxi+1)

a

s

] (59)

Noting that xi−1 = xi − le and xi+1 = xi + le yields

αi = −1 +
1 + θ + w

3(
b+ a

2
(1 + 2xi − le)

)
coshλ

[(
2(b+ axi)

w
− 4γal

e

w2

)
(coshλ− cosh γ) + 2al

e

w
sinh γ

]

(60)
Hence, nodally exact solutions will be obtained for a linear source term and a regular mesh

of linear 2-noded elements using the optimal stabilization parameters obtained in Section 5 and
inserting the value of αi of Eq.(60) into Eq.(50) with θ given by Eq.(35).

Similar expressions for the optimal value of αi can be found for other external source terms
Q(x) following the same procedure.

7 CONVECTION-RADIATION PROBLEM

The governing equations for the convection-radiation problem are

r := ρcu
dφ

dx
+ sφ−Q = 0 (61)

with
φ− φp = 0 on Γφ (62a)

−ρcuφn+ qp = 0 on Γq (62b)
The FE stencil for the sourceless case is deduced from Eq.(31) substituting the expression of γ̄ of

Eq.(24) and then after multiplying by k and subsequently making k = 0. The resulting expression
is

−
[(

1− αu
2
σ + αu

) ρcul
2

+ 〈αgk〉 −
sl2

6

]
φi−1 + 2

[
αu
ρcul

2
+ 〈αgk〉 −

sl2

3

]
φi −

[
−
(

1− αu
2
σ − αu

) ρcul
2

+ 〈αgk〉 −
sl2

6

]
φi+1 = 0 (63)

12



where 〈αgk〉 denotes the new stabilization parameter for the case of zero diffusion.
The analytical solution of Eq.(61) is

φ = Ae−
s
ρcu

x = Ae−
σ
le
x (64)

From Eq.(64) we deduce for a uniform mesh of 2-noded element with xi−1 = xi − le and
xi+1 = xi + le

φi = Ae
− σ
le
xi , φi+1 = e

−σφi , φi−1 = e
σφi (65)

From the relationships in Eq.(65) we can infer that the exact solution of the convection-reaction
problem satisfies the following generic stencil

−c1e−σφ̂i−1 + (c1 + c2)φ̂i − c2eσφ̂i+1 = 0 (66)

Comparing the stencils in Eq.(63) and (66) we get

B1
c1e−σ

=
B2

c1 + c2
=

B3
c2eσ

(67)

where

B1 =
[(

1− αu
2
σ + αu

) ρcul
2

+ 〈αgk〉 −
sl2

6

]
φi−1

B2 = 2
[
αu
ρcul

2
+ 〈αgk〉 −

sl2

3

]
φi

B3 =
[
−
(

1− αu
2
σ − αu

) ρcul
2

+ 〈αgk〉 −
sl2

6

]
φi+1

(68)

From Eq.(67) we can obtain a system of two equations to solve for αu and 〈αgk〉. After some
algebra we get

αu =
2
σ

[
1− (c1 − c2e

2σσ

(c1 + c2)eσ − (c1 + c2e2σ)

]

2〈αgk〉
ρcul

=
σ

3

[
2(c1 + c2e2σ) + (c1 + c2)eσ

(c1 + c2)eσ − (c1 + c2e2σ
]
− αu

(69)

As the choice of c1 and c2 is arbitrary we can get infinite solutions for the stabilization param-
eters given the characteristic solution of the convection-reaction problem. This is no surprise as it
is an under-determined problem. Consider the choice c1 6= 0 and c2 = 0. We get

αu =
2
σ

[
1− σ

sgn(u)σ − 1

]
, 〈αgk〉 =

s(le)2

6
+
ρcule

2

[
σ

sgn(u)σ − 1 − αu
]

(70)

Expressions (70) yield the exact nodal solution for the sourceless convection-radiation problem
using a mesh of equal length linear 2-noded elements. These expressions also lead to accurate
nodal results for a constant source.

For k = 0 the following expression is obtained from of Eqs.(22) and (70)

θk = αuγk + 〈αgk〉 =
ρcul

2
(71)

which is the standard result of the SUPG scheme [6, 13, 69].

13



8 STABILIZED 1D TRANSIENT SOLUTION

8.1 Discretized form of the stabilized transient problem

The governing equation for the transient convection-diffusion-reaction problem is

rt = 0 in Ω := [0, l] (72a)

with

rt := ρc
(
∂φ

∂t
+ u

∂φ

∂x

)
− ∂
∂x

(
k
∂φ

∂x

)
+ sφ−Q (72b)

where φ(x, t) is a function of the space coordinate x and the time t.
The boundary conditions are identical to Eqs.(2)–(3) simply changing k d

dx
by k ∂

∂x
in Eq.(3b).

The definition of the problem is completed with the initial condition

φ(x, t0) = φ0(x) (73)

where φ0(x) is the value of the transported variable at time t = t0.
The FIC form of the governing equations in the domain Ω and at the boundary Γq is written

as
rt −

1
2
h
∂rt
∂x

= 0 in Ω := [0, l] (74)

rΓ +
1
2
hrt = 0 on Γq (75)

where rΓ is given in Eq.(3b).
The characteristic distance h is now defined as

h = αul
e

︸︷︷︸
hu

+ 2αgk
sgn(rt)
|rs|

φ′

︸ ︷︷ ︸
hg

(76)

Note that Eq.(76) is an extension of Eq.(14).
The weighted residual form in space is derived following the procedure described in Section 3,

as ∫ l

0

W

(
rt −

h

2
∂rt
∂x

)
dx+

[
W

(
rΓ +

1
2
hrt

)]
l

= 0 (77)

where W are space weighting functions that vanish on Γφ.
Integrating by parts the integral in Eq.(77) gives

∫ l

0

Wrtdx+
∫ l

0

h

2
∂W

∂x
rtdx+ [WrΓ]l = 0 (78)

Substituting the expression of rt of Eq.(72b) and integrating by parts the convective and diffu-
sive terms gives, after substituting the expression of h of Eq.(76),

∫ l

0

[
ρcW̄

∂φ

∂t
− ∂W

∂x
ρcūφ+

(
k + ku + kg

|rt|
|rs|

)
∂W

∂x

∂φ

∂x
+Wsφ− W̄Q

]
dx−

−
∫ l

0

dW

dx

hu
2

∂

∂x

(
k
∂φ

∂x

)
dx+ [Wqp]l = 0 (79)

where W̄ , ū, ku and kg are defined in Eqs.(19a), (19b) and (20), respectively.
Note that Eq.(79) coincides with (18) for the steady-state (i.e. when rt ≡ rs)

14



Let us choose a linear finite element interpolation over 2-noded elements as

φ(x, t) ' φ̂(x, t) =
2∑

i=1

Ni(x)φi(t) (80)

where Ni(x) are the standard linear functions defined in the space domain and φi(t) is the nodal
value of the approximate function φ̂(x, t) at time t.

Substituting the approximation (80) into Eq.(79) and choosing a Galerkin weighting, gives the
following system of discretized equations in space

Mφ̇φφφφφφφφφφφφφ+ (K−C + S)φφφφφφφφφφφφφφ = f (81)

where φ̇φφφφφφφφφφφφφ = ∂
∂t
φφφφφφφφφφφφφφ and φφφφφφφφφφφφφφ is the vector of nodal variables (Eq.(26)). The element expression of the

matrices and vectors in Eq.(81) is

Me = ρc
(
le

6

[
2 1
1 2

]
+
αul

e

2

[
−1 −1
1 1

])
(82)

Ke =
1
le

(
k + ku + kg

∫

le

|r̂t|
|r̂s|

dx

)[
1 −1
−1 1

]
(83)

and Ce, Se and fe are given by Eqs.(27a), (27b) and (27c), respectively. Also we have assumed
that k, ku and kg are constant within an element and the last two are given by Eq.(20).

In Eq.(83), r̂t = rt(φ̂) and r̂s = rs(φ̂) are the transient and steady-state discrete residuals,
respectively.

We note that the term involving αu in Eq.(81) vanishes after assembly for regular meshes of
equal length elements (except at the boundaries).

Matrix Ke is non linear as it involves the integral of the ratio of the modulus of the transient
and steady-state discrete residuals. This term can be computed explicitly as shown in Appendix
D. As a consequence of this non-linearity, the system of assembled equations (81) has to be solved
iteratively within each time step.

8.2 Transient solution scheme

We discretize in time the system of equations (81) using a Generalized Trapezoidal rule [13, 68]
and a simple Picard iteration scheme as

(
1
δ∆t

M + iK−C + S)i+1φφφφφφφφφφφφφφn+δ = ifn+δ + 1
δ∆t

Mφφφφφφφφφφφφφφn (84)

where δ is a non dimensional time parameter such that 0.5 < δ ≤ 1 for the integration scheme to
be stable [13, 68, 69] and i(·) denotes values for the ith iteration.

The solution i+1φφφφφφφφφφφφφφn+1 for the ith iteration can be found in terms of i+1φφφφφφφφφφφφφφn+δ and φφφφφφφφφφφφφφn as

i+1φφφφφφφφφφφφφφ
n+1 =

1
δ
i+1φφφφφφφφφφφφφφ

n+δ +
(

1− 1
δ

)
φφφφφφφφφφφφφφ
n (85)

The iterations proceed until convergence of the solution for φφφφφφφφφφφφφφn+1 measured in the L2 norm
is achieved. In the transient problems solved in this work convergence within each time step was
typically achieved in 2–3 iterations pure advection cases and 6–8 iterations for convection-diffusion-
reaction cases.

8.3 Computation of the stabilization parameters

The optimal value of the stabilization parameters αu and αg giving nodally exact solutions
is quite difficult in the transient case due to the multiple forms that the solution can take as it

15



evolves in time. We present a procedure for computing a quasi-optimal value of αu and αg that
has proved to yield accurate results for solutions involving the pure advection of a discontinuous
function, as well as for transient convection-diffusion-reaction problems evolving towards a steady
state solution.

The transient equation (72b) can be written in the following form

ρcu
∂φ

∂x
− ∂
∂x

(
k
∂φ

∂x

)
+ s̄φ−Q = 0 (86)

where

s̄ = s+ st with st = ρc
φ̇

φ
(87)

Eq.(86) defines a pseudo-stationary problem where a non linear reaction term st has been
introduced.

The non linear reaction term st can be approximated as

st =
ρc

δ∆t
f(κ) (88)

with

f(κ) ≥ 0 and κ = φ
n+δ − φn
φn+δ

(89)

From Eq.(87) we can define an equivalent Damköhler number σ̄ as

σ̄ =
s̄le

ρcu
= σ + σt with σt =

1
δC

f(κ) (90)

where σ is the standard Damköhler number and C = u∆t
le

is the element Courant number.
Function f(κ) should be designed so that f(κ) = 0 (and σt = 0) for a steady-state problem

(or in zones where φ̇ = 0), and f(κ) = 2 (and σt = 2δC ) for cases when φ(x, t) suddenly changes
from φn = 0 to a finite value φn+δ = φc at a node. The later situation happens, for instance,
in the propagation of a step function defined by φ0(x) = φc in a subdomain of Ω and φ0(x) = 0
elsewhere.

Taking these considerations into account, the following definition for f(κ) has been chosen

f(κ) = 2 tanh

(
β

∣∣φn+δ − φn
∣∣e
∞∣∣φn+δ + φn
∣∣e
∞

)
(91)

where |a|e∞ denotes the maximum value of a within an element and β is a (relatively large) positive
number that controls the slope of the function tanh(·) that ranges from zero to one. Very good
results were obtained in the transient problems solved in this work using Eq.(91) with β = 300. In
this case, the optimal choice of β in terms of the nature of the transient solution is a matter that
deserves further research.

The stabilization parameters αu and αg for the transient convection-diffusion-radiation problem
are then estimated as follows

1. The parameter αu is computed using Eq.(48a) using the value of σ̄ of Eq.(90) as

αu =
2
σ̄

(
1− σ̄ tanh γ

ξ − 1

)
(92)

2. The parameter αg is computed in terms of γ and σ using Eq.(48b) with the value of αu given
by Eq.(92),i.e.

αg = γ
[
σ

3

(
ξ + 2
ξ − 1

)
− αu

]
(93)

16



−10

0

10

20

0

20

40

60
0

0.2

0.4

0.6

0.8

1

omega

alfa
u

gamma
−10

0

10

20

0

20

40

60
0

0.05

0.1

0.15

0.2

omega

alfa
g
/w

gamma

Figure 1: Distribution of αu and
αg
w

with γ and ω

In this manner the effect of the transient term is directly taken into account in the expression
of αu via σt and, indirectly, in the expression of αg via αu.

Remark 8. A cut-off value is set up for the denominator in Eq.(91) so that
∣∣φn+δ + φn

∣∣e
∞ = �

when
∣∣φn+δ + φn

∣∣e
∞ < � where � is a small number. In our computations we have taken

� = 10−5.

8.4 Particularization for the transient convection-radiation case

Following the procedure explained in the previous section and Eqs.(70), we propose the following
expressions for computing the stabilization parameters αu and 〈αgk〉 for the convection-radiation
problem (k = 0)

αu =
2
σ̄

(
1− σ̄

esgn(u)σ̄ − 1

)
(94)

〈αgk〉 =
s(le)2

6
+
ρcule

2

[
σ

esgn(u)σ − 1
− αu

]
(95)

with σ̄ given by Eq.(90).

8.5 Particularization for the pure convection problem

Numerical algorithms for the time integration of the pure convective transport of a function
typically suffer from phase and amplitude errors. For discontinuous functions additional insta-
bilities in the form of numerical wiggles are prone to occur at the vicinity of the interface. The
introduction of a stabilization diffusion eliminates the oscillation but can smear the solution near
the interface. The derivation of numerical methods that provide stable and accurate solutions is a
challenge and several efforts have been reported in the past years [39, 40].

The stabilization parameters αu and 〈αgk〉 for this problem are obtained by making s = 0 in
Eqs.(94) and (95). This gives

αu =
2
σt

(
1− σt

esgn(u)σt − 1

)
and 〈αgk〉 =

ρcule

2
(1− αu) (96)

Let us compute the expression of αu and 〈αgk〉 for some representative cases.

17



a) Steady-state problem, or φ̇ = 0 locally, (σt = 0)

lim
σt→0

αu = 1 and 〈αgk〉 = 0 (97)

b) Sudden jump of φ(x, t) at a node
(
σt = 2δC

)

b.1) δ = 0.5 (mid–point rule), C = 1

σt = 4 , αu = 0.4627 and 〈αgk〉 = 0.2686 ρcule

b.2) δ = 0.5, C = 0.5

σt = 8 , αu ' 0.125 and 〈αgk〉 = 0.4375 ρcule

b.3) δ = 0.5, C = 0.1

σt = 20 , αu = 0.05 and 〈αgk〉 = 0.475 ρcule

Remark 9. Note that the stabilization parameters evolve from the standard SUPG values (αu =
1 and 〈αgk〉 = 0) to the progressive vanishing of the streamline parameter (αu → 0) and
〈αgk〉 → 0.5ρcule in the vicinity of a jump for low Courant numbers.

Remark 10. Excellent results have been obtained for all the problems solved in this work using
0.1 < C ≤ 0.8.

8.6 Explicit forward-Euler scheme

The time discretization of Eq.(84) using an explicit Forward-Euler scheme (δ = 1) gives

1
∆t

Mφφφφφφφφφφφφφφn+1 + [K−C + S− 1
∆t

M]φφφφφφφφφφφφφφn − fn = 0 (98)

A simple stencil can be found for a mesh of equal length 1D linear elements using a diagonal
form of Me as
ρcle

∆t
φn+1i −

(
γ̄+1+θ− w

6

)
φni−1 +2

(
1+θ+

w

3
− ρcl

e

2∆t

)
φni −

(
− γ̄+1+θ− w

6

)
φni+1−fni = 0 (99)

from which φn+1i can be explicitly found.
The values of θ and γ̄ in Eq.(99) are computed from Eqs.(22) and (24) respectively with αu

and αg obtained as explained in the previous sections.
The stability requirements for the explicit solution require that [14, 69]

∆t ≤ 2
gemax

(100)

where gemax is the largest eigenvalue of matrix H
e for all the elements in the mesh with

He = Ke −Ce + Se (101)

9 EXAMPLES

9.1 Steady-state examples solved with equal length 2-noded elements

The nodal exactness of the steady-state FIC-FEM formulation is shown for a series of convection-
diffusion-radiation problems solved on a coarse uniform mesh of eight 2-noded elements of unit
length (le = 1) in a 1D domain Ω := [0, 8]. The Dirichlet boundary conditions are φ(0) = 8 and
φ(8) = 3, except for the convection-diffusion-production case where φ(0) = φ(8) = 0 has been
taken. Many of these problems were solved in [17, 54] using the same mesh.

Figures 2–5 show the FEM results superimposed on the exact analytical solution for the fol-
lowing problems.

18



(a) γ = 0, ω = 2 (b) γ = 0, ω = 25

(c) γ = 1, ω = 5 (d) γ = 1, ω = 20

(e) γ = 2, ω = 2 (f) γ = 10, ω = 4

Figure 2: 1D convection-diffusion-absorption problem (Q = 0). Exact and FIC-FEM results for a
uniform mesh of eight 2-noded elements. (a) γ = 0, ω = 2; (b) γ = 0, ω = 25; (c) γ = 1, ω = 5;
(d) γ = 1, ω = 20; (e) γ = 2, ω = 2; (f) γ = 10, ω = 4;

Sourceless case (Q = 0)

Convection-diffusion-absorption

• γ = 0 , ω = 2 (Figure 2a)

19



(a) γ = 1, ω = −20

Figure 3: 1D convection-diffusion-production problem (γ = 1, ω = −20, Q = 0). Exact and
FIC-FEM results for a uniform mesh of eight 2-noded elements.

(a) γ = 0, ω = −5 (b) γ = 0, ω = −100

Figure 4: 1D Helmholtz problem (Q = 0). Exact and FIC-FEM results for a uniform mesh of eight
2-noded elements. (a) γ = 0, ω = −5; (b) γ = 0, ω = −100

• γ = 0 , ω = 25 (Figure 2b)

• γ = 1 , ω = 5 (Figure 2c)

• γ = 1 , ω = 20 (Figure 2d)

• γ = 1 , ω = 120 (Figure 2e)

• γ = 2 , ω = 2 (Figure 2f)

Convection-diffusion-production

• γ = 1 , ω = −20 (Figure 3)
Helmholtz problem

• γ = 0 , ω = −5 (Figure 4a)

• γ = 0 , ω = −100 (Figure 4b)

20



(a) γ = 2, ω = 2, Q = 1 (b) γ = 2, ω = −5, Q = 1

Figure 5: 1D convection-diffusion-production problems. Constant source (Q = 1). Exact and
FIC-FEM results for a uniform mesh of eight 2-noded elements. (a) γ = 2, ω = 2; (b) γ = 2,
ω = −5

Constant source

• γ = 2 , ω = 2 , Q = 1 (Figure 5a)

• γ = 2 , ω = −5 , Q = 1 (Figure 5b)

The FIC-FEM solution yields exact nodal solutions for all the problems solved, as expected.

9.2 Steady-state convection-diffusion-absorption examples solved with elements of
different length

The accuracy of the steady-state FIC-FEM formulation for a non-uniform mesh of eight 2-
noded linear element has been studied for different problem parameters. The analysis domain [0,8]
is discretized into eight elements. The nodal coordinates are shown in Table 1 where the exact
and FIC-FEM nodal solutions are given. The numerical and exact results are plotted in Figure
6. The accuracy of the FIC-FEM formulation is remarkable in all cases given the coarseness of
the mesh chosen for the simulations. Note the relatively small error of the nodal results in zones
where the solution attains very small values (Table 1c) which shows the capability of the FIC-FEM
formulation to accurately reproduce the different scales in the solution.

The same non-uniform mesh has been used for solving two problems of diffusion-production
(Helmholtz) (u = 0, k = 1, s = −1) and convective-diffusion-production (u = 1, k = 1, s = −2).
The FIC-FEM and exact solutions are plotted in Figures 7 and 8. The nodal numerical and exact
nodal values for each of the two solutions are listed in Table 2. The accuracy of the FIC-FEM
formulation again is remarkable given the oscillatory character of the solutions with values of φ
oscillating from positive to negative in both cases.

Thus, for the Helmholtz problem (Table 2) errors are within 8% for values of |φi| > 1 and
increase to ∼ 74% for node 2 where the exact solution approaches to zero.

The same situation occurs for the convective-diffusion-production problem (Table 3) where
errors are small (< 10%) for the higher values of the solution and acceptable for smaller values.

We highlight the coarseness of the mesh used for the purpose of testing the FIC-FEM formula-
tion in a simple irregular mesh situation. Indeed more accurate results can be obtained by simply
refining the mesh.

21



(a) u = 4, k = 1, s = 2 (b) u = 20, k = 1, s = 1

(c) u = 1, k = 1, s = 20

Figure 6: 1D convection-diffusion-absorption problem (Q = 0). Exact and FIC-FEM results for
an irregular mesh of eight 2-noded elements. (a) u = 4, k = 1, s = 2; (b) u = 20, k = 1, s = 1; (c)
u = 1, k = 1, s = 20

9.3 Performance on layer adapted meshes

This example illustrates the performance of the proposed FIC–FEM on layer-adapted meshes.
We use a Shishkin mesh [63], which is piecewise equidistant and consequently much simpler than
several types of layer-adapted meshes in the literature. Given a positive integer N , where N is
divisible by four, we divide the interval [0, L] into three subintervals

[0, τ1L], [τ1L, (1− τ2)L], and [(1− τ2)L,L] (102)

Uniform meshes are used on each subinterval with 1 + (N/4) nodes in each of [0, τ1L] and [(1 −
τ2)L,L], and 1 + (N/2) nodes in [τ1L, (1 − τ2)L]. The mesh-transition parameters τ1 and τ2 are
defined as

τ1 = min
{

1
4
,

2
|µ1|

lnN
}
, τ2 = min

{
1
4
,

2
|µ2|

lnN
}

(103)

µ1 =
uL

2k
−
√(

uL

2k

)2
+
sL2

k
, µ2 =

uL

2k
+

√(
uL

2k

)2
+
sL2

k
(104)

The layer-strength parameters µ1 and µ2 appear in the fundamental solutions, viz. exp(µ1x/L)
and exp(µ2x/L) of Eq. (4). Set i0 = N/4. The transition points of the Shishkin mesh XNs are

22



(a) u = 4, k = 1, s = 2
Node Coordinate Exact FIC-FEM % error

1 0 8,0000 8,0000 0

2 0,8 5,5837 5,2336 6,27

3 2 3,2559 3,0523 6,25

4 3,2 1,8985 1,8954 0,16

5 4 1,3251 1,2831 3,16

6 5 0,8454 0,7920 6,31

7 6,2 0,4939 0,4789 3,03

8 7,2 0,3936 0,3932 0,10

9 8,0 3,0000 3,0000 0

(b) u = 20, k = 1, s = 1

Node Coordinate Exact FIC-FEM % error

1 0 8,0000 8,0000 0

2 0,8 7,6871 7,6126 0,97

3 2 7,2405 7,1704 0,97

4 3,2 6,8199 6,8199 0

5 4 6,5531 6,5212 0,48

6 5 6,2343 6,1739 0,97

7 6,2 5,8721 5,8435 0,48

8 7,2 5,5864 5,5864 0

9 8,0 3,0000 3,0000 0

(c) u = 1, k = 1, s = 20

Node Coordinate Exact FIC-FEM % error

1 0 8,0000 8,0000 0

2 0,8 0,3261 0,2670 18,12

3 2 0,2684 E-02 0,2197 E-02 18,14

4 3,2 0,2209 E-04 0,2140 E -04 3,12

5 4 0,9065 E-06 0,7333 E-06 19,10

6 5 0,9342 E-06 0,8419 E-06 9,88

7 6,2 0,3702 E-03 0,3092 E-03 16,47

8 7,2 0,5495 E-01 0,4997 E-01 9,06

9 8,0 3,0000 3,0000 0

Table 1: 1D convection-diffusion-production problems (Q = 0). Exact and FIC-FEM nodal results
for an irregular mesh of eight 2-noded elements (results are plotted in Figure 6)

xi0 = τ1L and xN−i0 = (1− τ2)L.
XNs : 0 = x0 < x1 < . . . < xi0 < . . . < xN−i0 < . . . < xN = L (105)

We use the double mesh method [12] to compute the experimental rates of convergence. To
compute the double mesh error we need each node of the coarse mesh XNs to coincide with a
unique node in the fine mesh X2Ns . Usually this will not be the case for Shishkin meshes as the
mesh partition has a nonlinear dependence on N . In order to compute the double mesh error, we
compute not only φN (solution computed using XNs ), but also another approximate solution φ̃

N

computed on a modified Shishkin mesh X̃Ns [64]. The modified Shishkin mesh X̃
N
s is constructed

using the slightly altered mesh-transition parameters

τ̃1 = min
{

1
4
,

2
|µ1|

ln
N

2

}
, τ̃2 = min

{
1
4
,

2
|µ2|

ln
N

2

}
(106)

23



Figure 7: 1D Helmholtz problem (u = 0, k = 1, s = −1, Q = 0). Exact and FIC-FEM results for
an irregular mesh of eight 2-noded element

(a) u = 0, k = 1, s = −1
Node Coordinate Exact FIC-FEM % error

1 0 8,0000 8,0000 0

2 0,8 8,5829 9,0211 4,98

3 2 0,4979 ,8652 73,77

4 3,2 -8,2320 -8,3941 1,97

5 4 -8,4144 -8,6356 2,63

6 5 -1,7666 1,7829 0,92

7 6,2 7,6226 8,2224 7,87

8 7,2 8,2072 8,5626 4,33

9 8,0 3,0000 3,0000 0

Table 2: 1D problem (u = 0, k = 1, s = −1, Q = 0). Exact and FIC-FEM results for an irregular
mesh of eight 2-noded element (results are plotted in Figure 7)

(a) u = 1, k = 1, s = −2
Node Coordinate Exact FIC-FEM % error

1 0 8,0000 8,0000 0

2 0,8 1,2217 1,6667 36,42

3 2 -23,7333 -27,7740 17,03

4 3,2 -2,6157 -3,8480 47,11

5 4 54,3764 52,5686 3,32

6 5 78,0550 80,7289 3,43

7 6,2 -134,8567 -147,3987 9,3

8 7,2 -278,3221 -279,2699 0,34

9 8,0 3,0000 3,0000 0

Table 3: 1D convection-diffusion-production problem (u = 1, k = 1, s = −2, Q = 0). Exact
and FIC-FEM nodal results for an irregular mesh of eight 2-noded elements (results are plotted in
Figure 8)

24



Figure 8: 1D convection-diffusion-production problem (u = 1, k = 1, s = −2, Q = 0). Exact and
FIC-FEM results for an irregular mesh of eight 2-noded element

Then for i = 0, 1, . . . , N , the ith node of the mesh XNs coincides with the (2i)th node of the
mesh X̃2Ns . We set L = 8, u = 5, s = 20, f = 0 and the boundary conditions φ

N
0 = φ̃

N
0 = 8 and

φNN = φ̃
N
N = 3. We generate a sequence of Shishkin meshes using N = 2

m,m = {7, 8, . . . , 12} and
solve the problem for a sequence of diffusion coefficients k = 0.25n, n = {1, 2, . . . , 10}. For each N
and k, we compute the double mesh error ẼNk as

ẼNk = max
0≤i≤N

|φNi − φ̃2N2i | (107)

For the stabilized FIC–FEM we assume a convergence of order N−r for some r (a natural
expectation from a stabilized method) and compute the convergence rate r for each fixed k from

RNk =
ln ẼNk − ln Ẽ2Nk

ln 2
(108)

Table 4 shows that the proposed FIC–FEM has an estimated k-uniform convergence of order
N−2. It suggests that the stabilized FIC–FEM may satisfy the following error estimate for Shishkin
meshes.

max
0≤i≤N

|φ(xi)− φNi | ≤ CN−2 (109)

It is well known [21] that the Galerkin–FEM with linear finite elements statisfies the following
error estimate for Shishkin meshes.

max
0≤i≤N

|φ(xi)− φNi | ≤ C(N−1 lnN)2 (110)

To verify the above error estimate we compute the convergence rate for each fixed k from

RNk =
ln ẼNk − ln Ẽ2Nk

ln
(

2 lnN
ln 2N

) = ln Ẽ
N
k − ln Ẽ2Nk

ln
(

2m
m+1

) , for N = 2m and m = 7, 8, . . . , 12. (111)

Table 5 shows as expected that the Galerkin–FEM with linear finite elements has an estimated
k-uniform convergence of order (N−1 lnN)2.

In Figure 9, we choose k = 0.25 and illustrate the FIC–FEM solution computed on a Shishkin
mesh with N = 25 nodes. The Shishkin mesh transition points xi0 = 2 and xN−i0 = 7.704 are also
shown.

25



k N = 128 256 512 1024 2048 4096

2.5000e-1 1.9612e-5 4.8248e-6 1.1606e-6 2.7720e-7 6.5999e-8 1.5678e-8
2.0232 2.0556 2.0658 2.0704 2.0737

6.2500e-2 1.3838e-5 3.6689e-6 9.2874e-7 2.3119e-7 5.7273e-8 1.4170e-8
1.9153 1.982 2.0062 2.0131 2.015

1.5625e-2 1.3193e-5 3.2052e-6 8.3014e-7 2.1045e-7 5.2765e-8 1.3176e-8
2.0412 1.949 1.9799 1.9958 2.0016

3.9063e-3 1.3211e-5 3.0802e-6 7.9945e-7 2.0349e-7 5.1313e-8 1.2872e-8
2.1006 1.946 1.974 1.9876 1.9951

9.7656e-4 1.3215e-5 3.0488e-6 7.9176e-7 2.0164e-7 5.0868e-8 1.2774e-8
2.1158 1.9451 1.9733 1.9869 1.9936

2.4414e-4 1.3216e-5 3.0410e-6 7.8984e-7 2.0118e-7 5.0758e-8 1.2747e-8
2.1196 1.9449 1.9731 1.9867 1.9934

6.1035e-5 1.3216e-5 3.0390e-6 7.8936e-7 2.0106e-7 5.0730e-8 1.2741e-8
2.1206 1.9449 1.9731 1.9867 1.9934

1.5259e-5 1.3216e-5 3.0385e-6 7.8924e-7 2.0103e-7 5.0723e-8 1.2739e-8
2.1208 1.9448 1.973 1.9867 1.9934

3.8147e-6 1.3216e-5 3.0384e-6 7.8921e-7 2.0102e-7 5.0722e-8 1.2739e-8
2.1209 1.9448 1.973 1.9867 1.9934

9.5367e-7 1.3216e-5 3.0384e-6 7.8920e-7 2.0102e-7 5.0721e-8 1.2739e-8
2.1209 1.9448 1.973 1.9867 1.9934

Table 4: Errors ẼNk and convergence rates R
N
k = (ln Ẽ

N
k − ln Ẽ2Nk )/ ln 2 for the FIC–FEM method

generated using L = 8, u = 5, s = 20, f = 0, k = 0.25n, n = {1, 2, . . . , 10}, N = 2m,m =
{7, 8, . . . , 12} and boundary conditions φN0 = φ̃N0 = 8 and φNN = φ̃NN = 3.

26



k N = 128 256 512 1024 2048 4096

2.5000e-1 5.5786e-3 1.8129e-3 5.7243e-4 1.7653e-4 5.3399e-5 1.5887e-5
2.0085 2.0036 2.0014 2 2

6.2500e-2 6.1182e-3 1.9873e-3 6.2741e-4 1.9347e-4 5.8524e-5 1.7412e-5
2.0094 2.0039 2.0015 2.0001 2

1.5625e-2 6.3215e-3 2.0530e-3 6.4810e-4 1.9985e-4 6.0453e-5 1.7985e-5
2.0097 2.004 2.0015 2.0001 2.0001

3.9063e-3 6.3793e-3 2.0716e-3 6.5398e-4 2.0166e-4 6.1001e-5 1.8148e-5
2.0098 2.004 2.0015 2.0001 2.0001

9.7656e-4 6.3942e-3 2.0764e-3 6.5550e-4 2.0213e-4 6.1142e-5 1.8191e-5
2.0098 2.004 2.0015 2.0001 2.0001

2.4414e-4 6.3980e-3 2.0777e-3 6.5588e-4 2.0225e-4 6.1178e-5 1.8201e-5
2.0098 2.004 2.0015 2.0001 2.0001

6.1035e-5 6.3989e-3 2.0780e-3 6.5598e-4 2.0228e-4 6.1187e-5 1.8204e-5
2.0098 2.004 2.0015 2.0001 2.0001

1.5259e-5 6.3992e-3 2.0780e-3 6.5600e-4 2.0229e-4 6.1189e-5 1.8205e-5
2.0098 2.004 2.0015 2.0001 2.0001

3.8147e-6 6.3992e-3 2.0781e-3 6.5601e-4 2.0229e-4 6.1190e-5 1.8205e-5
2.0098 2.004 2.0015 2.0001 2.0001

9.5367e-7 6.3992e-3 2.0781e-3 6.5601e-4 2.0229e-4 6.1190e-5 1.8205e-5
2.0098 2.004 2.0015 2.0001 2.0001

Table 5: Errors ẼNk and convergence rates R
N
k = (ln Ẽ

N
k − ln Ẽ2Nk )/ ln( 2 lnNln 2N ) for the Galerkin–

FEM method generated using L = 8, u = 5, s = 20, f = 0, k = 0.25n, n = {1, 2, . . . , 10}, N =
2m,m = {7, 8, . . . , 12} and boundary conditions φN0 = φ̃N0 = 8 and φNN = φ̃NN = 3.

27



0 2 7.704 8
−0.5

0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

5.5

6

6.5

7

7.5

8

8.5

x

Φ
FIC−FEM solution on a Shishkin mesh

 

 

FIC−FEM
Exact Solution

Figure 9: The FIC–FEM solution computed on a Shishkin mesh using L = 8, u = 5, s = 20, f =
0, k = 0.25, N = 25 and boundary conditions φN0 = 8 and φ

N
N = 3. The mesh transition points

xi0 = 2 and xN−i0 = 7.704 are also shown.

9.4 Transient convection-diffusion-absorption problem solved with equal length ele-
ments

The analysis domain x ∈ [0, 8] is discretised into eight 2-node elements of equal length. The
convection, diffusion and reaction coefficients are chosen as u = 8, k = 2 and s = 2. The density
ρ and the specific flux c are chosen such that ρc = 1. The problem data yields the dimensionless
numbers γ = 2 and ω = 1. The Dirichlet boundary conditions φ(x = 0) = 3 and φ(x = 8) = 8
are employed. The initial solution is chosen to have a linear profile. The transient solution
was obtained iteratively as explained in Section 8.2 using the implicit midpoint rule as the time
integrator (δ = 0.5) and considering a time step of ∆t = 0.0625s. This corresponds to a CFL
number C = 0.5. Figure 10 shows the solutions obtained by the Galerkin-FEM (Fig. 10a), the
SUPG method (Fig. 10b) and two variants of the FIC-FEM method (Figs. 10c and 10d). In
the first version of the FIC-FEM method the stabilization parameters were taken as those derived
for the steady-state problem. In the second version of the FIC-FEM method the stabilization
parameters obtained by including a dispersion control model (i.e. a pseudo Damköler number
σt) is considered. An exponential layer gradually develops at the right boundary which triggers
a global instability in the Galerkin FEM. This global instability is successfully controlled by the
SUPG (well-known result) and the FIC-FEM method without a dispersion control model. As there
is no significant dispersive phenomenon occurring in this problem, the FIC-FEM method with a
dispersion control model yields a similar solution.

9.5 Transient pure convective transport problem solved with equal length elements

The pure convective transport problem is studied here, i.e. the coefficients k = s = f = 0 and
u = 1. The 1D domain is taken as x ∈ [0, 1] and the Dirichlet boundary condition φ(x = 0) = 0 is
employed. The initial solution is a double rectangular pulse with simple discontinuities.

φ(x, t = 0) =
{

1 ∀ x ∈ [0.1, 0.2] ∪ [0.3, 0.4]
0 else

(112)

The amplitude spectrum of this initial solution is rich in high wave numbers. It is a challenging

28



(a)

0 1 2 3 4 5 6 7 8
0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

5.5

6

6.5

7

7.5

8

x

Φ

 

 

Galerkin−FEM
Exact

(b)

0 1 2 3 4 5 6 7 8
0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

5.5

6

6.5

7

7.5

8

x

Φ

 

 

SUPG
Exact

(c)

0 1 2 3 4 5 6 7 8
0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

5.5

6

6.5

7

7.5

8

x

Φ

 

 

FIC−FEM, σ
t
 = 0

Exact

(d)

0 1 2 3 4 5 6 7 8
0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

5.5

6

6.5

7

7.5

8

x

Φ

 

 

FIC−FEM, σ
t
 ≠ 0

Exact

Figure 10: Transient 1D convection-diffusion-reaction problem with Q = 0. Exact solution is
compared with the Gakerkin, SUPG and FIC-FEM solutions for a uniform mesh of eight 2-noded
elements. The solutions are plotted at time 0.125s, 0.25s, 0.5s, 1s and 2s.

problem to validate the control of dispersive oscillations and temporal accuracy. The domain is
discretized with 200 2-node elements. Two time steps ∆t = 0.001s and ∆t = 0025 were considered,
which corresponds to CFL numbers C = 0.2 and C = 0.5, respectively. The linearisation was
done using a fixed-point method and a tolerance of 10−4 for the relative error in the Euclidean
vector norm was used. For the pure convection problem, the FIC-FEM method without the
dispersion control model (letting σt = 0) reduces to the SUPG method. It is well-known that the
SUPG method is not immune to dispersive errors [39, 40]. Appreciable control over the dispersive
oscillations is obtained (see Figure 11) with the FIC–FEM method with σt 6= 0 and given by Eq.
(90).

10 CONCLUDING REMARKS

We have presented a stabilized FIC-FEM formulation for 1D advection-diffusion-reaction prob-
lems involving two stabilization parameters. The expression of these parameters ensuring an accu-
rate (and many times exact) nodal solution has been obtained for the steady-state and transient
cases for a range of physical parameters using linear 2-noded elements. The resulting stabilized
formulation will be useful for the accurate solution of many practical problems in engineering and
applied sciences involving the 1D advection-diffusion-reaction equation.

The solution of multidimensional convection-diffusion-reaction problems can develop exponen-

29



(a) ∆t = 0.001s

0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1
−0.1

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

1.1

Space

Φ

FIC, Time = 0s, 0.1, 0.5s; SUPG Initialization

(b) ∆t = 0.0025s

0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 0.95 1
−0.1

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

1.1

Space

Φ

FIC, Time = 0s, 0.1, 0.5s; SUPG Initialization

(c) ∆t = 0.001s

0
0.1

0.2
0.3

0.4
0.5

0.6
0.7

0.8
0.9

1

0
0.05

0.1
0.15

0.2
0.25

0.3
0.35

0.4
0.45

0.5

−0.2

0

0.2

0.4

0.6

0.8

1

1.2

Time

FIC, Time = 0−0.5 s; SUPG Initialization

Space

Φ

(d) ∆t = 0.0025s

0
0.1

0.2
0.3

0.4
0.5

0.6
0.7

0.8
0.9

1

0
0.05

0.1
0.15

0.2
0.25

0.3
0.35

0.4
0.45

0.5

−0.2

0

0.2

0.4

0.6

0.8

1

1.2

Time

FIC, Time = 0−0.5 s; SUPG Initialization

Space

Φ

Figure 11: Transient 1D pure convective transport problem. The FIC-FEM solutions for a uniform
mesh of 200 2-node elements and using the implicit midpoint rule (δ = 0.5) are shown. Two different
time steps, viz. ∆t = 0.001s and ∆t = 0.0025s were considered.

tial and parabolic layers. Exponential layers are typically found in the convection-dominant cases
and near the boundary or close to regions where the source term is nonregular. Parabolic layers are
found in the reaction-dominant cases near the boundary or close to the regions where the source
term is nonregular and in convection-dominated cases along the characteristics of the solution. The
characteristic internal boundary layers are typical of multidimensional problems. For this reason a
direct extension of the stabilization procedure derived for 1D problems would not efficiently resolve
these layers and the introduction of additional shock-capturing diffusion terms would be necessary
in these cases [14, 40, 69]. This topic will be the subject of research of the authors in a subsequent
work.

30



11 ACKNOWLEDGEMENTS

The authors acknowledge the support for this research received from projects HFLUIDS of the
Ministerio de Ciencia (Spain) and SAFECON, MODMAPS and COMP-DES-MAT of the European
Research Council.

References

[1] Baiocchi C, Brezzi F, Franca LP. Virtual bubbles and the GaLS. Computer Methods in
Applied Mechanics and Engineering 1993; 105:125–141.

[2] Boris JP, Book DL. Flux-corrected transport. I. SHASTA, A fluid transport algorithm that
works. Journal of Computational Physics 1973; 11:38–69.

[3] Brezzi F, Bristeau MO, Franca LP, Mallet M, Rogé G. A relationship between stabilized
finite element methods and the Galerkin method with bubble functions. Computer Methods
in Applied Mechanics and Engineering 1992; 96:117–129.

[4] Brezzi F, Russo A. Choosing bubbles for advection-diffusion problems. Mathematical Models
and Methods in Applied Sciences 1994; 4:571–587.

[5] Brezzi F, Hauke G, Marini LD, Sangalli G. Link-cutting bubbles for the stabilization of
convection–diffusion–reaction problems. Mathematical Models and Methods in Applied Sci-
ences 2003; 13(3):445–461.

[6] Brooks AN, Hughes TJR. Streamline Upwind/Petrov–Galerkin formulations for the convec-
tive dominated flows with particular emphasis on the incompressible Navier-Stokes equations.
Computer Methods in Applied Mechanics and Engineering 1982; 32:199–259.

[7] Burman E, Ern A. Nonlinear diffusion and discrete maximum principle for stabilized Galerkin
approximations of the convection–diffusion–reaction equation,” Computer Methods in Ap-
plied Mechanics and Engineering 2002, 191, 3833-3855.

[8] Codina R. A discontinuity-capturing crosswind-dissipation for the finite element solution of
the convection-diffusion equation,” Computer Methods in Applied Mechanics and Engineering
1993, 110, 325-342.

[9] Codina R. Comparison of some finite element methods for solving the diffusion-convection-
reaction equation, Computer Methods in Applied Mechanics and Engineering 1998, 156, 185-
210.

[10] Codina R. On stabilized finite element methods for linear systems of convection–diffusion–
reaction equations, Computer Methods in Applied Mechanics and Engineering 2000a, 190,
2681-2706.

[11] de Sampaio PAB, Coutinho ALGA. A natural derivation of discontinuity capturing operator
for convection-diffusion problems, Computer Methods in Applied Mechanics and Engineering
2001, 190, 6291-6308.

[12] Doolan EP, Miller JJH, Schilders WHA. Uniform numerical methods for problems with initial
and boundary layers. Dublin, Boole Press, 1980. Print.

[13] Donea J. A Taylor-Galerkin method for convective transport problems, International Journal
for Numerical Methods in Engineering 1984, 20, 101-119.

[14] J. Donea, A. Huerta, Finite element method for flow problems. J. Wiley & Sons, 2003.

31



[15] Douglas J, Russell TF. Numerical methods for convection-dominated diffusion problems
based on combining the method of characteristics with the finite element or finite differ-
ence procedures, SIAM Journal of Numerical Analysis 1982, 19, 871-885

[16] Dutra do Carmo EG, Alvarez GB. A new upwind function in stabilized finite element for-
mulations, using linear and quadratic elements for the scalar convection-diffusion problems,
Computer Methods in Applied Mechanics and Engineering 2004, 193, 2383-2402.

[17] Felippa C, Oñate E. Nodally exact Ritz discretizations of the 1D diffusion-absorption and
Helmholtz equations by variational FIC and modified equation methods, Computational Me-
chanics 2007, 39, No.2, 91-111.

[18] Franca LP, Dutra do Carmo EG. The Galerkin gradient least-squares method, Computer
Methods in Applied Mechanics and Engineering 1989, 74, 41-54.

[19] Franca LP, Farhat C. Bubble functions prompt unusual stabilized finite element methods,
Computer Methods in Applied Mechanics and Engineering 1995, 123, 299-308.

[20] Franca LP, Valentin F. On an improved unusual stabilized finite element method for the
advective-reactive-diffusive equation, Computer Methods in Applied Mechanics and Engi-
neering 2001, 190, 1785-1800.

[21] Franz S, Hans-Görg R. The capriciousness of numerical methods for singular perturbations.
SIAM Review (2011), 53(1):157–173.

[22] Galeão AC, Dutra do Carmo EG. A consistent approximate upwind Petrov–Galerkin method
for the convection-dominated problems. Computer Methods in Applied Mechanics and Engi-
neering 1988, 68, 83-95.

[23] Harari I, Hughes TJR. Stabilized finite element methods for steady advection-diffusion with
production, Computer Methods in Applied Mechanics and Engineering 1994, 115, 165-191.

[24] Hauke G, Garćıa-Olivares A. Variational subgrid scale formulations for the advection-
diffusion–reaction equation, Computer Methods in Applied Mechanics and Engineering 2001,
190, 6847-6865.

[25] Hauke G. A simple subgrid scale stabilized method for the advection-diffusion–reaction equa-
tion, Computer Methods in Applied Mechanics and Engineering 2002, 191, 2925-2947.

[26] Hauke G, Sangalli G, Doweidar MH. Combining adjoint stabilized methods for the advection-
diffusion–reaction problem, Mathematical Models and Methods in Applied Sciences 2007, 17,
No. 2, 305-326.

[27] Hughes TJR, Brooks AN. A theoretical framework for Petrov–Galerkin methods, with dis-
continuous weighting functions: application to the streamline upwind procedure, in Gallagher
RH, Norrie DM, Oden JT, Zienkiewicz OC (eds.), Finite Elements in Fluids 1982, IV,Wiley,
Chichester.

[28] Hughes TJR, Mallet M. A new finite element formulations for computational fluid dynamics:
III. The generalized streamline operator for multidimensional advective-diffusive systems.
Comput Methods Appl. Mech. Engrg. 1986a, 58, 305–328.

[29] Hughes TJR, Franca LP, Hulbert GM. A new finite element formulation for computational
fluid dynamics: VIII. The Galerkin/least-squares method for advective-diffusive equations,
Computer Methods in Applied Mechanics and Engineering 1989, 73, 173-189.

32



[30] Hughes TJR, Feijoo GR, Mazzei L, Quincy JB. The variational multiscale method: a
paradigm for computational mechanics, Computer Methods in Applied Mechanics and Engi-
neering 1998, 166, 3-24.

[31] Idelsohn SR, Nigro N, Storti M, Buscaglia G. A Petrov–Galerkin formulation for advective-
reaction-diffusion problems, Computer Methods in Applied Mechanics and Engineering 1996,
136, 27-46.

[32] Idelsohn SR, Heinrich JC, Oñate E. Petrov–Galerkin methods for the transient advective-
diffusive equation with sharp gradients, International Journal for Numerical Methods in
Engineering 1996, 39, 1455-1473.

[33] John V, Knobloch P. On spurious oscillations at layers diminishing (SOLD) methods for
convection-diffusion equations: Part I - A review, Computer Methods in Applied Mechanics
and Engineering 2007, 196, 2197–2215.

[34] Johnson C, Szepessy A, Hansbo P. On the convergence of shock-capturing streamline diffusion
finite element methods for hyperbolic conservation laws, Mathematics of Computation 1990,
54, 107-129.

[35] Knobloch P. Improvements of the Mizukami-Hughes method for convection-diffusion equa-
tions, Computer Methods in Applied Mechanics and Engineering 2006, 196, 579-594.

[36] Labra C, Rojek J, Oñate E, Zárate F. Advances in discrete element modelling of underground
excavations. Acta Geotechnica 2008: 3(4):317–322.

[37] Löhner R, Morgan K, Zienkiewicz OC. The solution of non-linear hyperbolic equation systems
by the finite element method, International Journal for Numerical Methods in Fluids 1984,
4, 1043-1063.

[38] Mizukami A, Hughes TJR. A Petrov–Galerkin finite element method for convection-
dominated flows: An accurate upwinding technique for satisfying the maximum principle,
Computer Methods in Applied Mechanics and Engineering 1985, 50, 181-193.

[39] Nadukandi P, Oñate E, Garćıa Espinosa J. A high-resolution Petrov-Galerkin method for
the 1D convection-diffusion-reaction problem, Computer Methods in Applied Mechanics and
Engineering 2010, 199, 525-546.

[40] Nadukandi P, Oñate E, Garćıa Espinosa J. A high-resolution Petrov-Galerkin method for
the convection-diffusion-reaction problem. Part II. A multidimensional extension, Computer
Methods in Applied Mechanics and Engineering 2012, 213-216, 327-352.

[41] Oñate E, Idelsohn SR, Zienkiewicz OC, TaylorRL, Sacco C. A stabilized finite point method
for analysis of fluid mechancis problems. Computer Methods in Applied Mechanics and En-
gineering 1996, 139, 315–346.

[42] Oñate E. Derivation of stabilized equations for numerical solution of advective-diffusive trans-
port and fluid flow problems, Computer Methods in Applied Mechanics and Engineering 1998,
151, 233-265.

[43] Oñate E, Idelsohn SR. A mesh-free finite point method for advective-diffusive transport and
fluid flow problems. Comput. Mech. 1998, 23, 283–292.

[44] Oñate E, Manzan M. A general procedure for deriving stabilized space-time finite element
methods for advective-diffusive problems. Int. J. Num. Meth. Fluids 1999, 31, 203–221.

33



[45] Oñate E, Manzan M. Stabilization techniques for finite element analysis of convection-
diffusion problems, in Sundén B, Comini G. (eds.), Computational Analysis of Convection
Heat Transfer 2000, 71-117, WIT Press, Southampton (UK), 2000.

[46] Oñate E, Sacco C, Idelsohn SR. A finite point method for incompressible flow problems.
Computing and Visualization in Science 2000, 2, 67–75.

[47] Oñate E, Garćıa J. A finite element method for fluid-structure interaction with surface waves
using a finite calculus formulation. Computer Methods in Applied Mechanics and Engineering
2001, 191, 635–660.

[48] Oñate E, Perazzo F, Miquel J. A finite point method for elasticity problems. Computers and
Structures 2001, 79, 2151–2163.

[49] Oñate E, Taylor RL, Zienkiewicz OC, Rojek J. A residual correction method based on finite
calculus. Engineering Computations 2003, 20(5/6), 629–658.

[50] Oñate E. Possibilities of finite calculus in computational mechanics. International Journal
for Numerical Methods in Engineering 2004, 60(1), 255–281.

[51] Oñate E, Idelsohn SR, Del Pin F, Aubry R. The particle finite element method. An overview.
International Journal of Computational Methods 2004, 1(2), 267–307.

[52] Oñate E, Rojek J, Taylor RL Zienkiewicz OC. Finite calculus formulation for incompressible
solids using linear triangles and tetrahedra. International Journal for Numerical Methods in
Engineering 2004, 59, 1473–1500.

[53] Oñate E, Zarate F, Idelsohn SR. Finite element formulation for the convective-diffusive prob-
lems with sharp gradients using finite calculus, Computer Methods in Applied Mechanics and
Engineering 2006, 195, 1793-1825.

[54] Oñate E, Miquel J, Hauke G. Stabilized formulation for the advection-diffusion-absorption
equation using finite calculus and linear finite elements, Computer Methods in Applied Me-
chanics and Engineering 2006, 195, 3926-3946.

[55] Oñate E, Valls A, Garćıa J. FIC/FEM formulation with matrix stabilizing terms for incom-
pressible flows at low and high Reynolds numbers. Computational Mechanics 2006, 38(4-5),
440–455.

[56] Oñate E, Garćıa J, Idelsohn SR, Del Pin F. FIC formulations for finite element analysis
of incompressible flows. Eulerian, ALE and Lagrangian approaches. Computer Methods in
Applied Mechanics and Engineering 2006, 195(23-24), 3001–3037.

[57] Oñate E, Miquel J, Zarate F. Stabilized solution of the multidimensional advection-diffusion-
absorption equation using linear finite elements, Computers and Fluids 2007, 36, 92–112.

[58] Oñate E, Valls A, Garćıa J. Modeling incompressible flows at low and high Reynolds numbers
via a finite calculus-finite element approach. Journal of Computational Physics 2007, 224,
332–351.

[59] Oñate E, Idelsohn SR, Celigueta MA, Rossi R. Advances in the particle finite element method
for the analysis of fluid-multibody interaction and bed erosion in free surface flows. Comput.
Methods Appl. Mech. Engrg. 2008, 197(19-20), 1777-1800.

[60] Oñate E, Nadukandi P, Idelsohn S, Garćıa J, Felippa C. A family of residual-based stabilized
finite element methods for Stokes flows. Int. J. Num. Meth. in Fluids 2011, 65 (1-3), 106–134.

34



[61] Oñate E, Idelsohn SR, Felippa C. Consistent pressure Laplacian stabilization for incompress-
ible continua via higher order finite calculus. International Journal for Numerical Methods
in Engineering 2011, 87 (1-5), 171-195.

[62] Oñate E, Nadukandi P, Idelsohn S. P1/P0+ elements for incompressible flows with discon-
tinuous material properties. Computer Methods in Applied Mechanics and Engineering 2014,
271, 185–209

[63] Shishkin GI, Grid approximation of singularly perturbed parabolic equations with internal
layers. Russian Journal of Numerical Analysis and Mathematical Modelling 1988, 3(5):393–
408.

[64] Sun G, Stynes M. An almost fourth order uniformly convergent difference scheme for a
semilinear singularly perturbed reaction-diffusion problem. Numerische Mathematik (1995),
70(4):487-500

[65] Tezduyar TE, Park YJ. Discontinuity-capturing finite element formulations for nonlinear
convection–diffusion–reaction equations. Computer Methods in Applied Mechanics and En-
gineering 1986; 59:307–325.

[66] Yu CC, Heinrich JC. Petrov–Galerkin methods for the time-dependent convective transport
equations, International Journal for Numerical Methods in Engineering 1986, 23, 883-901.

[67] Zienkiewicz OC, Codina R. A general algorithm for compressible and incompressible flows.
Part I: the split, characteristic based scheme, International Journal for Numerical Methods
in Fluids 1995, 20, 869-885.

[68] Zienkiewicz OC, Taylor RL, Zhu JZ. The finite element method. The basis. 6th Ed., Elsevier,
2005

[69] Zienkiewicz OC, Taylor RL, Nithiarasu P. The finite element method for fluid dynamics. 6th
Ed., Elsevier, 2005.

APPENDIX A

Appendix A Exact solution. Sourceless case (Q = 0)

Let us write the steady state form of the 1D convection-diffusion-reaction equation as

kφ′′ − uφ′ − sφ = 0 (A.1)

where a prime denotes differentiation with respect to the space coordinate x.
Eq.(A.1) can be written in non-dimensional form as

φ′′ − 2γ
d
φ′ − w

d2
φ = 0 (A.2)

In Eq.(A.2), d is an arbitrary distance such that d = ∆x = xi+1 − xi = xi − xi−1 in a grid of
equally-spaced segments.

The non-dimensional parameter γ and w are therefore expressed as

γ =
ud

2k
, w =

sd2

k
(A.3)

Note that d = le for a mesh of 1D 2-noded linear elements.
The characteristic equations associated to the differential equation (A.2) is

r2 − 2γ
d
r − w

d2
= 0 (A.4)

35



From (A.4) we obtain

r =
1
d

(γ ± λ) with λ = (γ2 + w)1/2 (A.5)

The general solution of Eq.(A.2) is therefore

φ = Ae
x
d

(γ+λ) +Be−
x
d

(γ−λ) (A.6)

where A and B are constants that depend on the boundary conditions of the problem.
For x = xi we have

φ̂i = φ(x = xi) = Ae
xi
d

(γ+λ) +Be
−xi
d

(γ−λ) (A.7)

where φ̂i denotes the exact value of the transported variable at node i.
Similarly for x = xi+1 = xi + d and x = xi−1 = xi − d we obtain

φ̂i+1 = φ(x = xi+1) = Ae
xi
d

(γ+λ)e(γ+λ) +Be
−xi
d

(γ−λ)e(γ−λ) (A.8)

φ̂i−1 = φ(x = xi−1) = Ae
xi
d

(γ+λ)e−(γ+λ) +Be
−xi
d

(γ−λ)e−(γ−λ) (A.9)

From Eqs.(A.7) and (A.8) we obtain

Ae
xi
de

(γ+λ) = − φ̂ie
(γ−λ) − φ̂i+1
2eγ sinhλ

(A.10)

Be
xi
de

(γ−λ) = − φ̂i+1 − φ̂ie
(γ+λ)

2eγ sinhλ
(A.11)

Substituting Eqs.(A.10) and (A.11) into (A.9) gives

−(2eγ sinλ)φ̂i−1 = φ̂i
(
e(γ−λ)e−(γ+λ) − e(γ+λ)e−(γ−λ)

)
+ φ̂i+1

(
e−(γ−λ) − e−(γ+λ)

)
=

= φ̂i(e
−2λ − e2λ) + φ̂i+1e−γ(eλ − e−λ) = −2φ̂i sinh(2λ) + 2φ̂i+1e−λ sinhλ

(A.12)

Simplifying terms and taking into account that sinh(2λ) = 2 sinhλ coshλ we finally obtain

eγ φ̂i−1 − (2 coshλ)φ̂i + e−γ φ̂i+1 = 0 (A.13)

which is the sought expression relating the exact numerical solution at three consecutive discrete
points.

Expression (A.13) holds naturally for γ2 + w ≥ 0 (λ is a real number. For γ2 + w < 0 (λ is a
imaginary number), a similar expression is obtained simply changing coshλ by cos |λ|.

It is important to note that Eq.(A.13) holds for any value of the arbitrary distance d. In the
paper we have taken d = le for convenience, where le is the element length in a uniform mesh
of 2-noded elements. This allows us to interpret γ as the element Peclet number and w as the
non-dimensional radiation parameter for the element (Eqs.(6)).

APPENDIX B Exact solution with source term (Q 6= 0)

φ̂i = Ae
(γ+λ)

xi
d +Be(γ−λ)

xi
d + φpi (B.1)

φ̂i+1 = Ae
(γ+λ)

xi
d e(γ+λ) +Be(γ−λ)

xi
d e(γ−λ) + φpi+1 (B.2)

φ̂i−1 = Ae
(γ+λ)

xi
d e−(γ+λ) +Be(γ−λ)

xi
d e−(γ−λ) + φpi−1 (B.3)

36



From (B.1) and (B.2)

Ae(γ+λ)
xi
d = −

φ̂ie
(γ−λ) − φ̂i+1 − φpi e(γ−λ) + φ

p
i+1

2eγ sinhλ
(B.4)

Be(γ−λ)
xi
d = −

φ̂i+1 − φ̂ie(γ+λ) − φpi+1 + φ
p
i e

(γ+λ)

2eγ sinhλ
(B.5)

Substituting Eqs.(B.4) and (B.5) into (B.3) gives

−(2eγ sinhλ)φ̂i−1 =
(
φ̂ie

(γ−λ) − φ̂i+1 − φpi e(γ−λ) + φ
p
i+1

)
e−(γ+λ) +

(
φ̂i+1 − φ̂ie(γ+λ) − φpi+1 + φ

p
i e

(γ+λ)
)
e−(γ−λ) − φpi−1(2eγ sinhλ) (B.6)

After small algebra we obtain

eγ φ̂i−1 − (2 coshλ)φ̂i + e−γ φ̂i+1 = eγφpi−1 − 2 coshλφ
p
i + e

−γφpi+1 (B.7)

APPENDIX C Stability conditions

The characteristic equation associated to the stencil of Eq.(31) is

−(γ̄ + 1 + θ − w
6

)− 2(1 + θ + w
3

)ρ+ (−γ̄ + 1 + θ − w
6

)ρ2 = 0 (C.1)

with φi = ρφi−1 and φi+1 = ρ2φi−1.
The general stability conditions are

ρ1ρ2 =
γ̄ + 1 + θ − w

6

−γ̄ + 1 + θ − w
6

> 0 (C.2)

ρ1 + ρ2 =
2(1 + θ + w

3
)

−γ̄ + 1 + θ − w
6

> 0 (C.3)

where ρ1 and ρ2 are the roots of the characteristic equation (C.1).
Condition (C.2) is equivalent to

a.1)
γ̄ + 1 + θ − w

6
> 0 → θ > w

6
− γ̄ − 1 (C.4)

and
−γ̄ + 1 + θ − w

6
> 0 → θ > w

6
+ γ̄ − 1 (C.5)

Hence
θs >

w

6
+ |γ̄| − 1 (C.6)

or

a.2)
γ̄ + 1 + θ − w

6
< 0 → θ < w

6
− γ̄ − 1 (C.7)

and
−γ̄ + 1 + θ − w

6
< 0 → θ < w

6
+ γ̄ − 1 (C.8)

Hence
θs <

w

6
− γ̄ − 1 (C.9)

In Eqs.(C.6) and (C.9) θs is the stability value for θ.

37



On the other hand, condition (C.3) implies

b.1)
1 + θ +

w

3
> 0 → θ > −w

3
− 1 (C.10)

and
−γ̄ + 1 + θ − w

6
> 0 → θ > w

6
+ γ̄ − 1 (C.11)

Hence
θs >

w

6
+ γ̄ − 1 (C.12)

or

b.2)
1 + θ +

w

3
< 0 → θ < −w

3
− 1 (C.13)

and
−γ̄ + 1 + θ − w

6
< 0 → θ < w

6
+ γ̄ − 1 (C.14)

Hence
θs <

w

3
− 1 (C.15)

Observation of Eqs.(C.6), (C.9), (C.12) and (C.15), and disregarding conditions (C.9) and
(C.15), yields the general stability condition for all values of the velocity u, as

θs >
w

6
+ |γ̄| − 1 (C.16)

APPENDIX D Computation of
∫

le
|R|dx

In Eq.(83) we need to compute the integral
∫ x2
x1

|R|dx where |R| =
∣∣∣ r̂tr̂s
∣∣∣ and xi (with i = 1, 2)

is the coordinate of node i of an element.
Let us assume a linear variation for R within the element as

R(x) = ax+ b (D.1)

We define

R1 = R(x1) = ax1 + b (D.2)
R2 = R(x2) = ax2 + b (D.3)

From Eqs.(D.2) and (D.3) we deduce a = R2−R1
x2−x1 .

We introduce the following change of variable

R(x) = ξ = ax+ b , dξ = adx (D.4)

Using Eq.(D.4) we find
∫ x2
x1

|R|dx = 1
a

∫ ξ2
ξ1

|ξ|dξ = 1
a

∫ R2
R1

|ξ|dξ (D.5)

The following conditions holds for a linear variation of a function f
∫
|f |df = 1

2
f |f | (D.6)

38



Eq.(D.6) can be proved by noting that

d

df
(f |f |) = 2|f | (D.7)

Combining Eqs.(D.5), (D.6) and (D.7) gives
∫ x2
x1

|R|dx = l
e

2

(
R2|R2| −R1|R1|

R2 −R1

)
(D.8)

where le = x2 − x1.
It can also be proved that

lim
R1→R2

le

2

(
R2|R2| −R1|R1|

R2 −R1

)
= le|R1| = le|R2| (D.9)

Eqs.(D.8) and (D.9) can be used for the analytical computation of the integral involving the
discrete residuals in Eq.(83).

39




