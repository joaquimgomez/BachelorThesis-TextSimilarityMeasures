











































Variational MultiScale based dissipation models for the

estimation of Atmospheric Seeing

Joan Baiges∗,1,2 and Ramon Codina2,1

1 Centre Internacional de Mètodes Numèrics a l’Enginyeria (CIMNE),

Edifici C1, Campus Nord UPC C/ Gran Capità S/N 08034 Barcelona, Spain
2 Universitat Politècnica de Catalunya, Jordi Girona 1-3, Edifici C1, 08034 Barcelona, Spain

*jbaiges@cimne.upc.edu, Telf: +0034 934016206

September 9, 2014

Abstract

In this work we present a numerical model for the estimation of atmospheric seeing
in observation sites. The particularity of the method is that it is based on a Variational
MultiScale turbulence model, its main feature being that the numerical mechanisms which
are used to deal with stability issues (convection and the inf-sup condition for incompressible
flows) do also take care of the modeling of turbulence. Based on this turbulence model, we
develop the expressions for the viscous and thermal dissipations, �num and χnum, which
are later used for evaluating the constant of structure of the refraction index C2n following
the classical model developed by Tatarski. Numerical examples show the behavior of the
proposed numerical scheme when applied to turbulent flow practical cases, which include a
convective boundary layer, the flow inside a transfer optics room, and a telescope enclosure.

Contents

1 Introduction 2

2 Incompressible Navier-Stokes equations 4
2.1 Problem statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
2.2 Finite element approximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
2.3 Turbulent viscous dissipation for the OSS Navier-Stokes equations . . . . . . . 7
2.4 Discretization in time . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
2.5 Fractional step splitting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9

3 Heat transfer equation 10
3.1 Problem statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
3.2 Finite element approximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
3.3 Turbulent thermal dissipation for the OSS heat transfer equation . . . . . . . . 11
3.4 Discretization in time . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

4 Atmospheric seeing parameters 12

1



5 Numerical examples 14
5.1 Convective boundary layer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
5.2 Transfer optics and Coudé room . . . . . . . . . . . . . . . . . . . . . . . . . . 18
5.3 Flow around a telescope enclosure . . . . . . . . . . . . . . . . . . . . . . . . . 20

6 Conclusions 23

1 Introduction

In the observation of the universe by using ground based telescope facilities, the effect of
atmospheric turbulence in the quality of the obtained data is of great importance. Especially
when the diameter of the telescope is large, the optical distortion due to turbulent effects can
become significant enough to prevent the observation device to reach its maximum theoretical
resolution. This is the reason why extensive efforts have been done in several directions:

� The development of adaptive optics mechanisms which allow to correct the phase distor-
tion effects. This is achieved by dividing the main mirror of the telescope into smaller
mirrors and allowing these sub-mirrors to move independently, which allows to obtain
a corrected image. This approach has been successfully applied to the new generation
telescopes, but the number of mirrors the main mirror needs to be composed of and the
speed at which these mirrors need to change their configuration directly depend on the
atmospheric turbulence intensity.

� The selection of observation sites which provide optimal atmospheric conditions. Very
specific locations around the world have turned out to be optimal observation sites.
Amongst them, the Canary Islands in Spain, Hawaii in the USA or the Atacama desert
in Chile concentrate some of the largest telescopes in the world thanks to their pristine
seeing conditions.

� The design of telescope facilities which minimize the amount of turbulence of the aero-
dynamic flow around them. Minimizing the small eddy oscillations in the air flow around
the telescope mirrors results in less optical distortion, which means that the corrections
to be done by the adaptive mechanism are lesser, which in turn results in better acquired
images. This is especially true in the case of solar telescopes, where the large tempera-
ture gradients at the ground surface due to radiation effects have a critical impact in the
condition of collected data.

It is clear that being able to evaluate the suitability of an observation site or a telescope facility
design prior to the telescope construction is key for getting the best possible performance out
of the telescope. Also, it is convenient to be able to quantify the characteristics of the adaptive
optics mechanism to be installed in the telescope beforehand. Due to this, several efforts have
been devoted recently to the quantification of atmospheric seeing parameters through numerical
simulation.

One of the first numerical models for the quantification of the temperature structure func-
tion was presented in [20]. In [29, 30] an atmospheric Meso-Nh numerical model was used to
compute atmospheric seeing in an observation site in Cerro Paranal, Chile. Soon after, the
same methodology was applied to the simulation of another observation site at the Roque de
Los Muchachos, Canary Islands, Spain [31]. In [7, 8, 6] a Large Eddy Simulation (LES) model
run on a weather forecast simulation software was used to characterize near-surface optical tur-
bulence under different climatic conditions in observation sites. A seeing model which makes

2



use of the turbulent kinetic energy provided by a planetary boundary layer simulation software
was used to compute seeing in Mauna Kea, Hawaii in [10, 9]. In [22] a weather forecasting
model was used together with the statistical parametrization of the refraction index structure
constant C2n presented in [35] in order to forecast the seeing conditions in the Roque de Los
Muchachos, Canary Islands, Spain. A numerical weather prediction tool was used in [1] to
compute various turbulence parameters which allow to characterise C2n in the islands of Maui
and the Big Island, Hawaii, and a similar methodology was presented in [21].

All of these methodologies have in common the use of numerical weather prediction tools
for the simulation of seeing conditions, where the expression for C2n is derived from different
mesoscale turbulence models. In [13] we presented a strategy for the computation of atmospheric
seeing parameters, which, to our knowledge, is the first computational method capable of
simulating seeing conditions at a local level; that is, by using a finite element computational fluid
dynamics simulation with a resolution ranging from decimeters to few meters instead of using
mesoscale simulation tools with a coarse resolution. The proposed model for the computation
of the refraction index structure function C2n is based on a Large Eddy Simulation of the
incompressible flow and temperature fields, and has been successfully applied to the design
phase of the Advance Technology Solar Telescope (ATST) [28] and the European Solar Telescope
(EST) [3, 5].

In this work we present a model for the numerical simulation of the C2n function which is
computed from a variational multiscale (VMS) [26] based turbulence model. For finite element
analysis, the basic idea of VMS is to split the unknowns into their finite-element part and a
subgrid scale component, the subscale. The approximation adopted for the subscale defines the
numerical model. The interesting feature about VMS is that it is capable of providing, at the
same time, a numerical stabilization mechanism for the studied equations (in this case, the
incompressible Navier-Stokes equations) and a turbulence model which takes into account the
under-resolved scales (those which cannot be captured by the finite element mesh). This has
been studied in several works [27, 18, 14, 15, 23] with successful results. The advantage of using
this kind of approach is that there is no interference between the numerical stabilization and
the turbulence models because both issues are taken care of by the numerical subgrid scales.

The method used in the present work is the Orthogonal Subgrid Scale VMS method (OSS).
Its particularity is that it models the numerical subscales in a rich manner: the subscales are
considered to be transient in time, non-linear, and orthogonal to the finite element space. A
theoretical analysis of the orthogonal-subscales VMS turbulence model is presented in [24],
and an extensive campaign of numerical experiments is presented in [19]. The conclusions of
these experiments are that VMS turbulence models can provide an accurate representation of
turbulent phenomena at a competitive computational cost, with the particular feature that the
turbulence model arises from numerical reasoning only. In this work we use the kinetic energy
and thermal turbulent dissipations which arise from the OSS turbulence model in order to
quantify the refraction index structure function.

The paper is organized as follows. The finite element approximation of the incompressible
Navier-Stokes equations is presented in Section 2, where the variational multiscale method
and the kinetic energy turbulent dissipation are also presented for this model problem. In
Section 3, the finite element approximation of the heat transfer equation is presented, together
with the OSS formulation and the thermal energy turbulent dissipation expressions for the
temperature problem. In Section 4 the numerical model for the computation of seeing quantities
arising from the OSS dissipations is presented. This allows us to compute the refraction index
structure function as well as optical magnitudes of interest such as the Fried parameter and the
Greenwood frequency. Numerical examples illustrate the performance of the proposed numerical

3



method in Section 5. Finally, some conclusions close the paper in Section 6.

2 Incompressible Navier-Stokes equations

2.1 Problem statement

In this section we summarize the Orthogonal Subgrid-Scale (OSS) approach applied to the
incompressible Navier-Stokes equations described in [11]. Let us consider the transient in-
compressible Navier-Stokes equations, which consist of finding u : Ω × (0, T ) −→ R3 and
p : Ω× (0, T ) −→ R such that:

∂tu− 2ν∇ · ∇su + u · ∇u +∇p = f in Ω, (1)
∇ · u = 0 in Ω, (2)

u = ū on ΓD, (3)

−pn + νn · ∇u = 0 on ΓN . (4)

for t > 0, where ∂tu is the local time derivative of the velocity field and ∇su = 12((∇u)
T

+∇u).
Ω ⊂ R3 is a bounded domain, ν is the viscosity, and f the given source term. ΓD is the
Dirichlet boundary, where velocity boundary conditions are applied. In the case of the numerical
simulation of aerodynamics of telescopes, it corresponds to the inflow boundary and the ground
and telescope surfaces. ΓN is the Neumann boundary, where conditions on the value of the
tractions are applied. In aerodynamics of telescopes simulations, it corresponds to the outflow
boundary. Appropriate initial conditions have to be appended to this problem. In the numerical
examples section, the source term f is due to the Boussinesq buoyancy forces, which appear
due to temperature gradients and are of the form:

f = αg(θ − θ0),

where α is the thermal expansion coefficient, g is the gravity acceleration vector, θ0 is a reference
temperature and θ the temperature of the fluid.

2.2 Finite element approximation

Let us now consider the finite element approximation of equations (1)-(4). We define V =
H1(Ω)d, and V0 = {v ∈ V | v = 0 on ΓD}. Let also Q = L2(Ω) and D′(0, T ;Q) be the
distributions in time with values in Q. The variational problem consists of finding [u, p] ∈
L2(0, T ;V )×D′(0, T ;Q) such that:

(v, ∂tu) + 〈v,u · ∇u〉+ 2ν (∇sv,∇su)− (p,∇ · v) = 〈v,f〉 ∀v ∈ V0, (5)
(q,∇ · u) = 0 ∀q ∈ Q, (6)

with

u = ū on ΓD.

Here, (·, ·) stands for the L2(Ω) inner product and 〈·, ·〉 for the integral of the product of two
functions, not necessarily in L2(Ω). Let us also define

B ([v, q], [a;u, p]) := 〈v,a · ∇u〉+ 2ν (∇sv,∇su)− (p,∇ · v) + (q,∇ · u) ,

4



where a represents the convective velocity. When the Galerkin finite element approximation
is used, it is well known that the semilinear form B suffers from stability issues due to the
convective nature of the flow, but also requires a compatibility between the velocity and pressure
approximation spaces due to the classical LBB inf-sup condition.

Many stabilization methods have been developed to deal with these issues in the past
decades. Amongst them, one of the stabilization approaches which has received more interest
in recent years is the variational multiscale (VMS) method. The most interesting feature of
VMS is that the stabilization terms are not derived from purely numerical reasons, but are
motivated from a physical point of view. This physical approach comes from the introduction
of a decomposition of a general solution of the problem of interest into its finite element part
and the part of the solution which cannot be captured by the finite element mesh. In order to
introduce the subscale concept in the weak form (5), let us consider the finite element partition
Th := {K} defined over domain Ω, h denoting the element size. To simplify the exposition, we
consider Th quasi-uniform. From this partition we construct the finite element spaces Vh ⊂ V,
Qh ⊂ Q. We will seek for approximate solutions uh ∈ C1(0, T ;Vh) and ph ∈ C0(0, T ;Qh).

The variational multiscale method is derived by introducing the subscales space for the
velocity field Ṽ such that:

V = Vh ⊕ Ṽ .

This implies that the velocity solution field and the velocity test functions can also be decom-
posed into the finite element part and the fine scale part:

u = uh + ũ,

v = vh + ṽ.

The same decomposition can be applied to the pressure field by introducing the pressure sub-
scales space Q̃, as described in [12]:

Q = Qh ⊕ Q̃,
p = ph + p̃,

q = qh + q̃.

Also, we consider the subscales to vanish on the element boundaries, although their contri-
bution in the element faces can also be taken into account, as described in [17]. Introducing this
splitting in equation (5), and after integrating by parts some of terms, the discrete variational
problem we obtain is to find [uh, ph] ∈ Vh ×Qh, for each t ∈ [0, T ] and ũ ∈ Ṽ , p̃ ∈ Q̃ for each
t ∈ [0, T ], such that:

(vh, ∂tuh) +B ([vh, qh], [u;uh, ph])

+
∑
K

〈vh, ∂tũ〉K +
∑
K

〈−ν∆vh − u · ∇vh −∇qh, ũ〉K −
∑
K

〈∇ · vh, p̃〉K = 〈vh,f〉 , (7)∑
K

〈ṽ, ∂tuh − ν∆uh + u · ∇uh +∇ph〉K

+
∑
K

〈ṽ, ∂tũ− ν∆ũ + u · ∇ũ +∇p̃〉K = 〈ṽ,f〉 , (8)∑
K

〈q̃,∇ · uh〉K +
∑
K

〈q̃,∇ · ũ〉K = 0, (9)

5



for all test functions vh, qh, ṽ, q̃, and where 〈·, ·〉K stands for the integral of the product of
two functions in K. Note that, for incompressible flows, 2∇ · ∇su = ∆u. Equation (8) is the
subscales equation, which will be used to provide a closure for the expressions of the velocity
and pressure subscales, ũ and p̃. Following the steps in [18] we first consider the equation
for the velocity subscales, omitting the contribution of the pressure subscales. This allows us
to formulate a simpler method, and it implicitly assumes that the velocity subscales are due
to the residual of the momentum equations, instead of being driven by the incompressibility
constraint. The second term in equation (8) can be modeled as follows:

∑
K

〈ṽ,−ν∆ũ + u · ∇ũ〉K ' τ
−1
K 〈ṽ, ũ〉K , τ

−1
K =

(
c1
ν

h2
+ c2
|u|
h

)
, (10)

where c1 and c2 are algorithmic constants. The approximation of the subscales operator as a
scalar term times the product 〈ṽ, ũ〉 can be justified by means of a Fourier analysis of the
problem for the subscales [12]. Replacing this expression in the equation for the subscales we
obtain:∑

K

〈ṽ, ∂tuh − ν∆uh + u · ∇uh +∇ph〉K +
∑
K

〈ṽ, ∂tũ〉K +
∑
K

τ−1K 〈ṽ, ũ〉K = 〈ṽ,f〉 . (11)

Equation (11) yields an expression for the subscales in the element interiors in terms of the
finite element component, as long as Ṽ is approximated by a space of discontinuous functions:

∂tũ + τ
−1
K ũ = PṼ (f − (∂tuh − ν∆uh + u · ∇uh +∇ph)) , (12)

where P
Ṽ

denotes the projection onto the subscales space. Equation (12 ) implicitly defines a
ũ as a function of uh, ph and t:

ũ = φũ(uh, ph, t). (13)

There are several possible choices for the space of subscales, which yield different projec-
tion operators P

Ṽ
. A typical choice is P

Ṽ
= I, which results in the Algebraic Subgrid-Scale

formulation (ASGS). The formulation we favor in our VMS model is to take the subscale space
to be orthogonal to the finite element space:

Ṽ = V ⊥h ∩ V,

and as a consequence:

P
Ṽ

= I − Ph,

where Ph is the L
2(Ω) projection onto the finite element space. This formulation is called

the Orthogonal Subgrid Scale (OSS) formulation. It usually results in sharper, less diffusive
solutions than the ASGS method.

This provides the required expression for the subscales in terms of the finite element un-
knowns. Note that equation (12) involves the time derivative of the velocity subscales. As a
consequence, the subscales will need to be tracked in time and a time discretization scheme for
them will be required. Note also that the velocity in all the convective terms is u = uh + ũ,
leading to a non-linear expression for the velocity subscales.

The pressure subscales can be modeled as:

p̃ = φp̃(uh) := τpτ
−1
K PQ̃ (∇ · uh) , τp = c3h

2, (14)

6



following a procedure similar to the one described for the velocity subscales in equation (10).
Again, Q̃ is taken to be orthogonal to Q:

Q̃ = Q⊥h ∩Q.

Note that both equation (12) and (14) need to be solved at the numerical integration points,
since the subscales are needed there to compute (numerically) the integrals appearing in (7).

This final formulation of the incompressible Navier-Stokes equations can be proven to be
stable for a proper choice of the stabilization constants c1 and c2. Equally important, the
motivation for the stabilizing terms has arised from taking into account the contribution of the
part of the solution which cannot be captured by the finite element mesh. This is the reason
why many authors [27, 18, 14, 15, 23] have decided to use these numerical subscales not only
as a stabilizing mechanism, but also as a model for the physics undergoing below the spatial
and temporal resolution of the finite element mesh. In the case of the Navier-Stokes equations
this corresponds to the modeling of turbulence.

2.3 Turbulent viscous dissipation for the OSS Navier-Stokes equations

Let us now focus on the numerical dissipation (and also turbulent, if we attend to the physical
meaning of the subscales) of the scheme. We define the kinetic energy per unit volume inside
the computational domain as:

W :=
1

2
ρ|u|2.

The balance of kinetic energy for the continuous problem can be obtained by taking the test
function v equal to the velocity u, the test function q equal to the pressure p, and multiplying
(5) and (6) by the density ρ. After some manipulations we arrive to:

∂

∂t

ˆ
Ω
W +

ˆ
∂Ω

n · uW = 〈u, ρf〉 − 2µ (∇su,∇su) , (15)

where µ is the dynamic viscosity. Equation (15) is saying that the variation of kinetic energy
in the computational volume ∂

∂t

´
Ω
W is due to the flux of kinetic energy through the domain

boundaries
´
∂Ω

n · uW , the increment of kinetic energy due to body forces 〈u, ρf〉 (external
power) and the decrement of kinetic energy due to the viscous dissipation � = µ (∇u,∇u). The
discrete counterpart of (15) is obtained by taking vh = uh, qh = ph in (7):

∂

∂t

ˆ
Ω
Wh +

ˆ
∂Ω

n · (uh + ũ)Wh = 〈uh, ρf〉 − 2µ (∇suh,∇suh)−
∑
K

〈ρuh, ∂tũ〉K

+
∑
K

〈µ∆uh + ρ(uh + ũ) · ∇uh + ρ∇ph, ũ〉K +
∑
K

〈ρ∇ · uh, p̃〉K , (16)

with:

Wh :=
1

2
ρ|uh|2.

The terms involving the subscales in the right-hand side of equation (16) constitute the viscous
numerical dissipation:

Dnum :=
∑
K

ˆ
K
�num

7



�num := ρuh · ∂tũ− (µ∆uh + ρ(uh + ũ) · ∇uh + ρ∇ph) · ũ− ρ∇ · uhp̃. (17)

On the other hand, we have the dissipation due to the finite element part of the solution:

Dh =

ˆ
Ω
�h,

�h : = 2µ|∇su|2.

�num appears due to the contribution of the stabilization terms and, at the same time, it is
taking into account the dissipation due to the subscales. In order to show this, let us study a
simplified problem where we neglect the contribution of the pressure subscales p̃. Let us also
neglect the contribution of µ∆uh (which is reasonable if highly turbulent flows are considered,
or exact if a linear interpolation space is chosen for uh). Furthermore, we take into account
that, if Ṽ ⊂ V ⊥h ∩ V, then: ∑

K

〈ρuh, ∂tũ〉K = 0.

Let us also define the kinetic energy of ũ:

W̃ :=
1

2
ρ|ũ|2

the dissipation of ũ:

D̃ =
∑
K

ˆ
K
�̃, �̃ = τ−1K |ũ|

2,

and the external power on uh and ũ:

Ph := 〈uh, ρf〉 , P̃ := 〈ũ, ρf〉 .

Let us multiply (8) by ρ and take ṽ = ũ. In this case from (8) and (16) we have:

∂

∂t

ˆ
Ω
Wh +

ˆ
∂Ω

n · uWh +Dh +Dnum = Ph, (18)

∂

∂t

ˆ
Ω
W̃ + D̃ −Dnum = P̃. (19)

It can be seen from equations (18)-(19) that �num is in charge for the transfer of energy from
the large (finite element) scales to the subgrid scales. Due to this, �num can be understood as
the dissipation caused by the turbulent effects of the flow (see [19, 24]).

Another interesting observation can be done if we plug the equation for the subscales (12)
into the expression for �num (17) (again taking into account the orthogonality of the subscales
and neglecting p̃ and µ∆uh):

Dnum = ρ
∑
K

τK
〈
P
Ṽ

(u · ∇uh +∇ph) , PṼ (u · ∇uh +∇ph)
〉
K

+ρ
∑
K

τK
〈
P
Ṽ

(u · ∇uh +∇ph) , ∂tũ
〉
K
. (20)

The first term in the right-hand side of (20) is always positive. The second term only appears
if dynamic subgrid scales are considered. It is shown in [16] that it can be locally (in space
and time) negative, although the average in time of �num is proved to be positive. Locally

8



negative values of �num represent a transfer of energy from the small scales to the large scales,
a phenomenon known as backscatter, which is observed in physical turbulent flows. After
the decomposition of the unknowns into the contributions of the finite element scales and
the subgrid scales, taking into account the temporal derivatives of the subscales allows the
OSS method to model backscatter. Let us stress that this backscatter model arises from the
numerical decomposition of the unknown and not from a physical modeling of the phenomena.
See the numerical examples section where dissipation values and their average are shown for a
convective boundary layer case. Another numerical example can be found in [16].

Finally, the total pointwise dissipation which accounts for the numerical and large scale
dissipation:

� = �h + �num, (21)

is going to be used for the computation of quality of seeing estimators.

2.4 Discretization in time

For the discretization in time, we rely on a finite difference time discretization. We consider a
uniform partition of [0, T ] of size δt. We denote a time dependent function f approximated at
tn = nδt as fn and δtf

n the approximation to ∂tf at t
n. Introducing this notation, the time

discrete problem is: find [uh, ph] ∈ Vh × Qh, for each t ∈ [0, T ] and ũ ∈ Ṽ , p̃ ∈ Q̃ for each
t ∈ [0, T ], such that:

(vh, δtu
n+1
h ) +B

(
[vh, qh], [u

n+1;un+1h , p
n+1
h ]

)
+
∑
K

〈
vh, δtũ

n+1
〉
K

+
∑
K

〈
−ν∆vh − un+1 · ∇vh −∇qh, ũn+1

〉
K
−
∑
K

〈
∇ · vh, p̃n+1

〉
K

=
〈
vh,f

n+1
〉
. (22)

In order to approximate δtu
n+1
h , a second order backward differences scheme is used:

δtu
n+1
h =

3
2
un+1h − 2u

n
h +

1
2
un−1h

δt
.

On the other hand, a first order backward Euler scheme is used to integrate the subscales in
time:

δtũ
n+1 =

ũn+1 − ũn

δt
.

This is sufficient for the approximation of the subscales, since:

ũ = O (τK(f − (∂tuh − ν∆uh + u · ∇uh +∇ph)) ,

and τK = O(δt).

2.5 Fractional step splitting

In order to minimize the computational time inverted in solving (22), we rely on a fractional step
splitting technique. This decomposes the solution of the monolithic system into the solution of
several simpler problems: a convection-diffusion equation for the velocity unknown, a pressure-
poisson equation and a projection step. We start by noting that, for the choice Ṽ = V ⊥h ∩ V :∑

K

〈
vh, δtũ

n+1
〉
K

= 0.

9



We introduce an intermediate velocity ûh, for which we consider:

ûnh = u
n
h,

ûn−1h = u
n−1
h ,

and the intermediate velocity and pressure subscales ˆ̃un+1and ˆ̃pn+1. The steps of the fractional
step method are:

1. Convection-diffusion equation. We solve for the intermediate quantities ûn+1h ,
ˆ̃un+1and

ˆ̃pn+1:

(vh, δtû
n+1
h ) +B

(
[vh, 0], [û

n+1; ûn+1h , p
n
h]
)

+
∑
K

〈
−ν∆vh − ûn+1 · ∇vh, ˆ̃un+1

〉
K
−
∑
K

〈
∇ · vh, ˆ̃pn+1

〉
K

=
〈
vh,f

n+1
〉
,

where ˆ̃un+1 is the solution of:

ˆ̃un+1 = φũ
(
ûn+1h , p

n
h, t

n+1
)

as defined in (13) and ˆ̃pn+1 is the solution of:

ˆ̃pn+1 = φp̃(û
n+1
h ),

as defined in (14).

2. Pressure Poisson equation. We solve for pn+1h and ũ
n+1:

(qh,∇ · ûn+1h )−
∑
K

〈
∇qh, ũn+1

〉
K

= −
2δt

3
(∇(pn+1h − p

n
h),∇qh),

where ũn+1 is the solution of:

ũn+1 = φũ
(
ûn+1h , p

n+1
h , t

)
, (23)

as defined in (13). For the temporal integration of (23), we consider ũn = ˆ̃un. In this way
only the intermediate subscale velocity needs to be tracked in time.

3. Projection step: We solve for un+1h :

3

2δt
(vh,u

n+1
h − û

n+1
h ) + (vh, (∇p

n+1
h −∇p

n
h) = 0.

3 Heat transfer equation

3.1 Problem statement

In this section we summarize the finite element approximation of the heat transfer equation
using the OSS approach. Let us consider the transient heat transfer equation, which consists
of finding θ : Ω× (0, T ) −→ R3 such that:

∂tθ + u · ∇θ − κ∆θ = q in Ω,
θ = θ̄ on ΓDθ,

n · ∇θ = 0 on ΓNθ, (24)

where θ is the temperature field, κ is the thermal diffusivity and q is now the heat source term.
Initial conditions have to be appended to this problem.

10



3.2 Finite element approximation

Let us define Ψ = H1(Ω), and the finite element space defined through the finite element
partition Ψh ⊂ Ψ. The Galerkin finite element approximation of equation (24) consists of
finding θh ∈ C1(0, T ; Ψh) such that:

(ψh, ∂tθh) + (ψh,u · ∇θh) + κ (∇ψh,∇θh) = 〈ψh, q〉 ∀ψh ∈ Ψh, (25)

with the corresponding initial and boundary conditions. Similarly to the Navier-Stokes prob-
lem, the finite element approximation (25) suffers from instability problems caused by the
convective term. Stabilization is required, and again physically based numerical stabilization
can be obtained by using the VMS method. Following a process analogous to the one pre-
sented in Section 2, the subscales can be modeled as a function of the finite element part of
the temperature solution field, θh:

∂tθ̃ + τ
−1
θK θ̃ = PΨ̃ (q − (∂tθh − κ∆θh + u · ∇θh)) , (26)

with

τθK =

(
cθ1

κ

h2
+ cθ2

|u|
h

)−1
.

cθ1 and cθ2 are algorithmic constants, which in practice coincide with c1 and c2 in equation
(10). Again, several choices are possible for the space of subgrid scales. As in the Navier-Stokes
equations, we advocate for the use of Orthogonal Subgrid Scales, that is, we choose the space
for temperature subscales Ψ̃ to be:

Ψ̃ = Ψ⊥h ∩Ψ.

The stabilized finite element heat transfer problem is obtained by introducing the scale
splitting in equation (25) and replacing the subscales by its approximation (26):

(ψh, ∂tθh) + (ψh,u · ∇θh) + κ (∇ψh,∇θh)

+
∑
K

〈
ψh, ∂tθ̃

〉
K

+
∑
K

〈
−κ∆ψh − u · ∇ψh, θ̃

〉
K

= (ψh, q) ∀ψh ∈ Ψh. (27)

3.3 Turbulent thermal dissipation for the OSS heat transfer equation

As done for the Navier-Stokes equations, we now deal with the numerical-turbulent dissipation
of the OSS scheme for the heat transfer equation. We start by defining the thermal energy per
unit volume in the computational domain Ω as:

H =
1

2
ρcpθ

2,

where cp is the heat capacity and ρ the density of the fluid. The continuous thermal energy
balance equation can be obtained by taking ψ = θ in equation (25), and multiplying the
equation by ρcp. After some manipulations, and taking into account the incompressibility of
u, we obtain:

∂

∂t

ˆ
Ω
H +

ˆ
∂Ω

n · uH = 〈θ, ρcpq〉 − ρcpκ (∇θ,∇θ) . (28)

In this case, the variation of thermal energy ∂
∂t

´
Ω
H in the computational domain is due to

the convective flux of thermal energy through the domain boundary
´
∂Ω

n ·uH, the increment
of thermal energy caused by the heat source 〈θ, ρcpq〉 and the decrement of thermal energy

11



caused by the thermal dissipation χ = ρcpκ (∇θ,∇θ). The discrete counterpart of equation
(28) is obtained by taking ψh = θh in equation (27):

∂

∂t

ˆ
Ω
Hh +

ˆ
∂Ω

n · uHh = 〈θh, ρcpq〉 − ρcpκ (∇θh,∇θh)

−
∑
K

〈
ρcpθh, ∂tθ̃

〉
K

+
∑
K

〈
ρcpκ∆θh + ρcpu · ∇θh, θ̃

〉
K
, (29)

with:

Hh =
1

2
ρcpθ

2
h.

The two last terms in the right-hand side of equation (29) are called the thermal numerical
dissipation:

Enum =
∑

K

ˆ
K
χnum (30)

χnum = ρcpθh∂tθ̃ − (ρcpκ∆θh + ρcpu · ∇θh) θ̃. (31)

χnum appears due to the contribution of the stabilization terms and, as �num in the Navier-
Stokes equations, is modeling the contribution to the dissipation due to the subscales. As a
consequence, it can be considered as a model for the turbulent effects of the flow. Note that,
contrary to other models, the turbulent Prandtl number which relates turbulent viscosity and
turbulent thermal diffusivity is not required in this variational multiscale based turbulence
model for the heat transfer equation. The total thermal dissipation is now modeled as:

χ = χh + χnum (32)

with:
χh = ρcpκ|∇θh|2.

3.4 Discretization in time

The associated time discrete problem is: find θh ∈ Ψh for each t ∈ [0, T ] such that:(
ψh, δtθ

n+1
h

)
+
(
ψh,u

n+1 · ∇θn+1h
)

+ κ
(
∇ψh,∇θn+1h

)
+
∑
K

〈
ψh, δtθ̃

n+1
〉
K

+
∑
K

〈
−κ∆ψh − un+1 · ∇ψh, θ̃n+1

〉
K

= (ψh, q) ∀ψh ∈ Ψh. (33)

A second order backward difference scheme is used to approximate δtθ
n+1
h and a first order

backward Euler scheme is used to approximate the subscales derivative with respect to time,
δtθ̃

n+1.

4 Atmospheric seeing parameters

In this section we describe the parameters which quantify the atmospheric seeing of a facility
or observation site. We also relate them to the numerical approximations described in Sections
2 and 3. We focus especially on the relation with the turbulent dissipations �num and χnum
which appear in the stabilized discrete finite element equations due to the energy transfer to
the non-resolved scales of the Kolmogorov cascade.

12



The final optical parameters we aim to simulate numerically are the Fried parameter r0 and
the Greenwood frequency fG. The Fried parameter is essential in adaptive optics. In the case of
telescopes it allows to determine the number of segments into which a segmented mirror has to
be split, or the distance between actuators for a continuous deformable mirror, by prescribing
an admissible RMS distortion of a wavefront [2]. But the design of their actuators is also based
on the so called Greenwood frequency, which is an indication of how fast the atmosphere is
changing and defines the bandwidth of the servo control for an adaptive optics system (see [33]
for more details). However, both parameters are a function of the integral along the optical
path of light beams of the structure constant Cn of the refractive index of a medium, n(x, t).
See [13] for a detailed description of the relationship between r0, fG and Cn.

This structure function can be related to the structure function of the temperature, the
humidity and their joint structure parameter (see [32]). However, we will consider the humidity
effects negligible. Thus, if we write the temperature dependence of n as n = n(θ), we have

Cn =
dn

dθ
Cθ,

where Cθ is the structure function of the temperature. Assuming pressure equilibrium it is
found that [34]

Cn =
79× 10−6

θ
2

pCθ, (34)

where p is assumed to be measured in millibars and θ is the absolute temperature. Here and
below, θ, p and u denote the solution of the continuous problems defined in equations (4) and
(24) and the overbars denote mean quantities in the observation period.

In view of (34), the problem is to compute Cθ. Once again in the inertial range of the
Kolmogorov spectrum and assuming the temperature to be a passive quantity, it can be shown
that (see [33])

C2θ = a
2χ̄m�̄

−1/3
m , (35)

where a is an empirical value called Obukhov-Corrsin constant (see [25, 36] for extensions and
a discussion about Obukhov-Corrsin constants and on the validity of this approximation). In
(35), χ̄m denotes the mean molecular thermal diffusive dissipation and �̄m the mean molecular
dissipation of kinetic energy of the flow. These parameters are given by

χ̄m := ρcpκ|∇θ|2, �̄m := 2µ|∇su|2. (36)

The problem is now closed: using (36) in (35) and the result back in (34) we have an expression
to compute Cn in terms of the flow variables u, p, θ at each point.

Some questions remain open when we want to numerically apply the previous approxima-
tions for C2n and C

2
θ . The first issue is that, instead of working with u, p, and θ, we are going to

be working with uh, ph, and θh, and a model for the velocity and temperature under-resolved
scales ũ and θ̃ given by equations (12) and (26). The first point to consider is the relation
between the averaged quantities ū, p̄, and θ̄, and their finite element approximations. To this
end we will recall that filtered unknowns in LES models need to maintain the mean of the
original variables. Due to the close relationship of the presented VMS turbulence model to LES
filtering, we will assume this to be true also for the finite element variables uh, ph, and θh. This
means that we will consider

ū ≈ ūh, p̄ ≈ p̄h, θ̄ ≈ θ̄h. (37)

13



The second point is how to compute the average kinetic and thermal energy dissipations
�̄m and χ̄m. In order to do this we will make use of the definitions in equations (21) and (32),
and we will compute the averaged dissipations as

�̄ = �̄h + �̄num, χ̄ = χ̄h + χ̄num. (38)

We assume that �̄ ≈ �̄m, χ̄ ≈ χ̄m, that is, the model accounts properly for the molecular
dissipation. This is proved in particular in [24] in a simplified setting. That the mean dissipation
approximates the molecular dissipation is the general assumption of LES models.

Using approximations (37) and (38) in (35) and inserting the result in (34) it is found that:

Cn = 79× 10−6θ̄−2h p̄h aχ̄
1/2�̄−1/6. (39)

Equation (39) is the expression we were looking for. It allows us to compute the structure
function of the refractive index in terms of the flow variables resulting from a VMS numerical
simulation.

5 Numerical examples

5.1 Convective boundary layer

The first numerical example consists of a convective boundary layer. This example was first
presented in [8] where a method for the estimation of atmospheric seeing using the Dutch
Atmospheric LES method (DALES) is presented. We use it here to compare the optical pa-
rameters obtained by using the VMS based dissipation model against the ones obtained using
the Smagorinsky based dissipation model presented in [13], and a dissipation model based on
the WALE subgrid scale model . The simulation domain is a parallelepiped whose base is a
square with a 10 km side and a height of 2 km. Air flow is caused by the presence of a heat flux
through the inferior base (0.1 K m s−1) and an horizontal body acceleration term ( 9.4325·10−5

m s−2). Boundary conditions are periodic in the lateral boundaries and no fluid is allowed to
trespass the superior and inferior boundaries of the domain. Also a wall law boundary condition
[4] is used in the inferior boundary, which causes the presence of the boundary layer for this
example. Initial conditions are given by a vertical temperature gradient set to 3 K km−1 and
air at rest. The numerical simulation is run for 10000 seconds, with a time step of 1 second.
The finite element mesh is a uniform structured tetrahedra mesh totaling 1.8 million elements.
The mesh resolution is 150 m horizontally and 150 m vertically.

Fig. 1 shows the averaged temperature and velocity profiles along the vertical dimension.
In the temperature profile the expected increase in mean temperature due to the heat flux in
the inferior boundary is observed. At a greater height, the temperature values get closer to
the initial condition temperature profile. Regarding the horizontal velocity profile, a boundary
layer behavior is recovered with a large velocity gradient close to the floor. Moreover, a slight
decrease in the average velocity is observed in the region where the temperature joins the
initial constant vertical gradient (1000 m height). Fig. 2 shows a snapshot of the velocity and
temperature fields at the end of the simulation. The velocity snapshot allows to see how hot air
in the ground tends to be convected up due to the Boussinesq forces. The temperature field,
on the other hand, is smooth, large temperature gradients appear only in the ground where
the heat flux causes bubbles of hot air to appear. Finally Fig. 3 shows a plot of the dissipation
values for the kinetic energy balance at the end of the simulation obtained using the OSS
Variational Multiscale Method. The top plot corresponds to dissipation values computed at

14



numerical integration points and its extrapolation to the nodes of each element. Elements with
a partially white area correspond to elements where the dissipation at some of the numerical
integration points is negative (or the dissipation extrapolated to the nodes of the element is
negative). In the bottom plot the nodally averaged (through a lumped L2 projection) is shown.
The nodally averaged dissipation values are positive everywhere. This is in agreement with
the expected behavior for the modeling of backscatter, where dissipation values can be locally
negative (accounting for the transmission of energy from the small scales to the large scales),
but need to be positive when averaged in space and time.

Fig. 4 shows a comparison of the C2n fields obtained by using the OSS based model for the
computation of the viscous and thermal dissipations and the structure constants, the Smagorin-
sky and the WALE models. It can be observed that the three models yield qualitatively similar
results: the magnitude of the structure constant C2n is large close to the ground, where large
temperature gradients exist due to the thermal heat flux. After the first few meters, the C2n
value starts to diminish with height (as the cyan regions denote), although the C2n coefficient
magnitude is larger in those regions where there is a hot air bubble moving up (vertical yellow
patches close to the ground). In the mid-height region of Fig. 4 (corresponding to a height of
1000 m) the hot bubbles disappear due to the effect of the dominant horizontal flow. In this
region, an increase of the C2n values is observed. At a height of 1500 m, the C

2
n values diminish

again. Due to the non-trespassing boundary condition, an spurious increase of the C2n values
is observed in the top wall. This increase appears due to the fact that large gradients of the
velocity are obtained in this top non-trespassing boundary condition, and would not be there
in a real open-flow boundary condition (which we cannot reproduce at the numerical level).
It must also be noted that the C2n field is smoother for the Smagorinsky and WALE models
than for the OSS model. This is probably caused by the fact that the Smagorinsky and WALE
models for the dissipations are based on the gradients of the recovered fields, while the dissi-
pations for the OSS model are based on the component of the residual orthogonal to the finite
element space, which is undoubtedly less smooth. Finally, Fig. 5 shows a comparison of the
horizontally averaged C2n values at the end of the simulation, including the results of [8] using
the DALES model. It is clear that the presented results and the results in [8] are qualitatively
similar. However, the increase in the C2n at mid-height occurs at a lower height in the results
from [8]. The largest differences are obtained in the region close to the ground. This can be
caused by the fact that the C2n parameter is very sensitive to small variations in the temperature
gradients. The bottom region presents the largest temperature gradients, and small deviations
in the computed temperature gradients can cause large variations in the obtained C2n values.
In spite of this, the results presented here are in good agreement with the results in [8], since,
in most of the height (except for the bottom region very close to the ground), they lay within
one standard deviation of the mean of the distribution of results statistically collected in [8].

This results allow to state that the C2n values obtained through the Orthogonal Subgrid
Scale model show a distribution which is qualitatively the same as the one obtained through
physically based LES models (Smagorinsky, WALE and the DALES model in [8]). Since the C2n
values depend on the turbulent dissipation of the model, it means that the viscous and thermal
turbulent dissipations obtained in the OSS method are qualitatively the same as the ones in the
physically based LES models. This is remarkable, because the expressions for these dissipations
were motivated exclusively by numerical arguments in the case of OSS, which contrasts with
the physically based arguments used to derive the LES turbulent dissipations.

15



Figure 1: Temperature (left) and horizontal velocity (right) averaged profiles

Figure 2: Temperature in ºK (top) and Velocity (bottom) snapshots at the end of the simulation

16



Figure 3: Dissipation values for the kinetic energy balance: numerical integration points (top)
and nodally averaged (bottom) values.

Figure 4: C2n snapshots at the end of the simulation. From top to bottom: Variational Multiscale,
Smagorinsky, WALE model.

17



10
−18

10
−16

10
−14

10
−12

0

200

400

600

800

1000

1200

Cn2

H
e

ig
h

t 
(m

)

Cn2 vs Height

 

 
Cn2 Smagorinsky

Cn2 VMS

Cn2 WALE

Cn2 Cheinet−Siebesma

Cn2 Cheinet−Siebesma σ

Figure 5: Averaged (horizontally) C2n values at the end of the simulation. Comparison with
the results in [8]. The green dotted lines represent the values which lie within one standard
deviation in the statistical data collected in [8].

5.2 Transfer optics and Coudé room

The second example corresponds to a transfer optics chamber and Coudé room. The geometry
and boundary conditions for this case were provided by the Astrophysical Institute of the
Canary Islands during the design phase of the European Solar Telescope (EST). Fig. 6 shows the
geometry and boundary conditions of the case. The spheres in the plot represent concentrated
heat loads, which consist of 300 mm� and provide a heat source of 2W (7.0738 W/m2). The
thermal control system consists of air plenums blowing air at ambient temperature (20 ◦C),
vertical velocity equal to 1 m/s, in the vertical direction from the top of the chamber (plenum
area = 22.1 m2). Return air plenums are placed at the lower part of the chamber (plenum area
= 314.16 m2). The objective of this case is to analyze the seeing degradation in the transfer
optics chamber.

Velocity boundary conditions in the lateral walls and the heating spheres correspond to
a wall-law condition. Inflow velocity is set to 1 m/s, and outflow velocity is left free. The
numerical simulation is run for 100 seconds, after which the flow is considered to be completely
developed. The time step is set to 0.2 seconds. The finite element mesh is composed of 3.4
million tetrahedra, with a local refinement in the regions close to the heating spheres (element
size equal to 0.03 m) and larger elements in in the regions far from them (element size equal
to 0.3 m) .

Fig. 7 shows a velocity and temperature snapshot after the flow has been completely de-
veloped. The velocity is larger in the central region, where most of the injected air flow is
circulating. The heating spheres oppose to the flow, which causes some boundary layers to
appear. This will have a negative effect in the resulting seeing conditions. Regarding the tem-
perature, the largest temperatures and temperature gradients are found on the surface of the
heating spheres, and hot air jets are found following the path of the vertical air inflow.

Fig. 8 shows a comparison of the C2n values in the transfer optics room, obtained by using

18



Figure 6: Geometry of the transfer optics and Coudé room (distances in mm)

Figure 7: Velocity (left) and temperature in ºC (right) snapshots at the transfer optics and
Coudé room.

19



the OSS, the Smagorinsky and the WALE models. It is clear that these models provide very
similar results in this case, the C2n field being less smooth for the OSS case.

5.3 Flow around a telescope enclosure

In the last example we simulate the atmospheric seeing around a telescope enclosure. In par-
ticular, this corresponds to one of the tentative designs of the European - Extremely Large
Telescope (E-ELT) enclosure. Fig. 9 shows the geometry of the enclosure. The objective of this
simulation was to evaluate the effect of a frontal wind shield in the atmospheric seeing. The
enclosure has 4 meter sized windows which facilitate the natural ventilation of the building.
The enclosure diameter is 85 m, with a maximum height of 79 m. The external domain for the
simulation is a 600 × 600 × 1500 m3 box. The finite element mesh is composed of 3.3 million
tetrahedra, with element sizes ranging from 1 m (close to the telescope) to 20 m (in the open
flow region).

A wall-law velocity boundary condition [4] is set on the ground and building surfaces, while
a non-trespassing boundary condition is set on the lateral walls of the bounding box. The inflow
velocity is set to 1 m/s. Regarding temperature boundary conditions, we impose the following
expression for temperature as a function of height:

θ = 12− 0.7 ln
(
z + 0.01

0.02

)
where the height z is expressed in meters and the resulting temperature is expressed in ◦C.
The initial temperature profile is depicted in Fig. 10.

Fig. 11 shows the velocity and temperature fields at a cut along the stream-wise direction
after the flow has been fully developed. Turbulent vortexes appear behind the telescope, the
largest velocity gradients occurring on the surface of the telescope. The maximum absolute
value velocity appears after the flow has been detached from the telescope enclosure, and
a low-speed recirculation zone can be observed leeward from the telescope. Regarding the
temperature field, the maximum temperature and temperature gradients are again found on
the surface of the telescope. The interior of the telescope shows larger temperatures when
compared to the exterior domain, despite the large ventilation windows put in place in order
to minimize temperature gradients. Intermediate temperature values are also found in the
recirculation area behind the telescope.

Fig. 12 shows a comparison of the C2n profiles obtained by using the OSS, Smagorinsky and
WALE dissipation models. As in the previous cases, maximum values for the C2n parameter are
found in the regions where the velocity and temperature gradients are larger, which coincide
with the terrain ground, the telescope enclosure surface and the area where the detachment of
the flow occurs. The low speed recirculation zone behind the telescope also shows large values
for the C2n parameter, which is due to the large temperature gradients. If we compare the results
of the various models, results are again qualitatively equivalent, the results being smoother for
the Smagorinsky and WALE models.

Let us say again that this agreement is remarkable if we take into account that the expres-
sions for the calculation of dissipations were motivated by physical arguments in the case of the
LES models and, on the contrary, by numerical arguments in the case of the OSS variational
multiscale method.

20



Figure 8: C2n snapshots for the Coudé room. Variational Multiscale (top left), Smagorinsky (top
right) and WALE (bottom) models.

21



Figure 9: External geometry for the E-ELT enclosure. Front, top and perspective views.

4 5 6 7 8 9 10 11 12
0

100

200

300

400

500

600

T (ÂºC)

H
e

ig
h

t 
(m

)

Figure 10: Temperature inflow boundary condition as a function of height

22



Figure 11: Velocity and temperature fields for the flow around a telescope enclosure

6 Conclusions

In this work we have presented a numerical model for the estimation of atmospheric seeing in
observation sites. The main feature of the proposed model is that it is based on the numerical
dissipations which arise from a particular version of the Variational Multiscale Method, the
Orthogonal Subgrid Scale method. The advantage of using this kind of models relies on the
fact that, by decomposing the fields of interest into coarse and fine scales, they are able to deal
simultaneously with the sources of numerical instabilities and the modeling of turbulent effects.
In the present work we have summarized the properties of our variational multiscale method,
which is based on modeling the numerical subscales in an as complete as possible manner:
the subscales are considered to be transient in time, non-linear, and orthogonal to the finite
element space. This leads not only to the resolution of numerical stability issues (advection and
the use of arbitrary interpolations for velocity and pressure), but also to a rich representation
of turbulent phenomena. Based on this turbulence model, we have developed the expressions
for the viscous and thermal dissipations, �num and χnum, which have been used for evaluating
the constant of structure of the refraction index C2n following the classical model developed by
Tatarski.

In the numerical examples section we have tested the performance of the method in three
practical cases, namely a convective boundary layer, the flow inside a transfer optics room,
and the flow around a telescope enclosure. In all three cases we have compared our model with
the results obtained by using a Smagorinsky and WALE models for evaluating the viscous and
thermal dissipations, and, in the convective boundary layer case, with the results presented in
[8]. The numerical examples show that the method is capable of doing an accurate estimation
of the C2n coefficients. This fact does not only provide us with a new numerical tool for the

23



Figure 12: C2n field for the flow around a telescope enclosure. From top to bottom: Variational
Multiscale, Smagorinsky and WALE models.

24



evaluation of the atmospheric seeing but it also adds arguments in favor of the viability of
implicit LES methods which rely on the numerical stabilization mechanisms for the modeling
of turbulence.

ACKNOWLEDGEMENTS

This work was partially supported by the European Research Council under the SOLARNET re-
search network FP7 - 312495, and partially supported by the Ministerio de Economı́a y Competitividad
of the Spanish Government under the Plan Nacional de Investigación 2012: AYA2012-33490. Joan Baiges
gratefully acknowledges the support received from the MICINN of the Spanish Government through a
“Juan de la Cierva” Postdoctoral grant. Ramon Codina gratefully acknowledges the support received
from the Catalan Government through the ICREA Acadèmia Research Program.

References

[1] R.J. Alliss and B.D. Felton. Validation of optical turbulence simulations from a numerical weather
prediction model in support of adaptive optics design. In Advanced Maui Optical and Space Surveil-
lance Technologies Conference, volume 1, page 54, 2009.

[2] J.M. Beckers. Adaptive optics for astronomy: Principles, Perfomance and Applications. Annual
Reviews in Astronomy and Astrophysics, 1993.

[3] FCM Bettonvil, R Codina, RH Hammerschlag, APL Jägers, JNM Kommers, SJ Van Leverink,
G Sliepen, and S Visser. The enclosure for the European Solar Telescope (EST). In SPIE As-
tronomical Telescopes and Instrumentation: Observational Frontiers of Astronomy for the New
Decade, pages 773333–773333. International Society for Optics and Photonics, 2010.

[4] Peter Bradshaw and George P Huang. The law of the wall in turbulent flow. Proceedings of the
Royal Society of London. Series A: Mathematical and Physical Sciences, 451(1941):165–188, 1995.

[5] L Cavaller, M Collados, and J Castro. Performance simulations for the conceptual design of the
European Solar Telescope (EST). In Proc. of SPIE Vol, volume 8336, pages 83360G–1, 2011.

[6] S. Cheinet, A. Beljaars, K. Weiss-Wrana, and Y. Hurtaud. The use of weather forecasts to charac-
terise near-surface optical turbulence. Boundary-Layer Meteorology, 138:453–473, 2011.

[7] S. Cheinet and A. P. Siebesma. The impact of boundary layer turbulence on optical propagation.
In Optics in Atmospheric Propagation and Adaptive Systems X. Proc. of SPIE Vol. 6747, pages
1–12, 2007.

[8] S. Cheinet and A. P. Siebesma. Variability of local structure parameters in the convective boundary
layer. J. Atmos. Sci., 66:1002–1017, 2009.

[9] T. Cherubini and S. Businger. An operational perspective for modeling optical turbulence, in Seeing
Clearly: The impact of Atmospheric Turbulence on the Propagation of Extraterrestrial Radiation,
T. Cherubini and S. Businger (Eds.). VBW Publishing, 2010.

[10] T. Cherubini, S. Businger, and R. Lyman. Modeling optical turbulence and seeing over Mauna
Kea: Verification and algorithm refinement. J. Appl. Meteor. Climatol., 47:3033–3043, 2008.

[11] R. Codina. A stabilized finite element method for generalized stationary incompressible flows.
Computer Methods in Applied Mechanics and Engineering, 190:2681–2706, 2001.

[12] R. Codina. Stabilized finite element approximation of transient incompressible flows using orthog-
onal subscales. Computer Methods in Applied Mechanics and Engineering, 191:4295–4321, 2002.

[13] R. Codina, J. Baiges, D. Pérez-Sánchez, and M. Collados. A numerical strategy to compute optical
parameters in turbulent flow: Application to telescopes. Computers & Fluids, 39(1):87 – 98, 2010.

25



[14] R. Codina and J. Principe. Dynamic subscales in the finite element approximation of thermally
coupled incompressible flows. International Journal for Numerical Methods in Fluids, 54:707–730,
2007.

[15] R. Codina, J. Principe, and M. Ávila. Finite element approximation of turbulent thermally coupled
incompressible flows with numerical sub-grid scale modelling. International Journal of Numerical
Methods for Heat & Fluid Flow, 20(5):492–516, 2010.

[16] R. Codina, J. Principe, and S. Badia. Dissipative structure and long term behavior of a finite
element approximation of incompressible flows with numerical subgrid scale modeling. In Multiscale
Methods in Computational Mechanics, pages 75–93. Springer, 2011.

[17] R. Codina, J. Principe, and J. Baiges. Subscales on the element boundaries in the variational two-
scale finite element method. Computer Methods in Applied Mechanics and Engineering, 198:838–
852, 2009.

[18] R. Codina, J. Principe, O. Guasch, and S. Badia. Time dependent subscales in the stabilized finite
element approximation of incompressible flow problems. Computer Methods in Applied Mechanics
and Engineering, 196:2413–2430, 2007.

[19] O. Colomés, S. Badia, R. Codina, and J. Principe. Assessment of variational multiscale models for
the large eddy simulation of turbulent incompressible flows. Submitted.

[20] A.F. de Baas and M. Sarazin. The temperature structure fuction for a complex terrain. Eighth
Symposium on turbulent shear flows., pages 1–6, Munich September 9-11, 1991.

[21] R. Frehlich, R. Sharman, F. Vandenberghe, W. Yu, Y. Liu, J. Knievel, and G. Jumper. Estimates of
Cn2 from Numerical Weather Prediction Model Output and Comparison with Thermosonde Data.
Journal of Applied Meteorology and Climatology, 49(8):1742–1755, 2010.

[22] C Giordano, J Vernin, H Vázquez Ramió, C Muñoz-Tuñón, AM Varela, and H Trinquet. Atmo-
spheric and seeing forecast: Wrf model validation with in situ measurements at orm. Monthly
Notices of the Royal Astronomical Society, 430(4):3102–3111, 2013.

[23] V. Gravemeier. The variational mulstiscale method for laminar and turbulent flow. Archives of
Computational Mechanics–State of the Art Reviews, 13:249–324, 2006.

[24] O. Guasch and R. Codina. Statistical behavior of the orthogonal subgrid scale stabilization terms in
the finite element large eddy simulation of turbulent flows. Computer Methods in Applied Mechanics
and Engineering, 261:154–166, 2013.

[25] R.J. Hill. Structure functions and spectra of scalar quantities in the inertial-convective and viscous-
convective ranges of turbulence. Journal of the atmospheric sciences, 46:2245–2251, 1989.

[26] T.J.R. Hughes, G.R. Feijóo, L. Mazzei, and J.B. Quincy. The variational multiscale method–a
paradigm for computational mechanics. Computer Methods in Applied Mechanics and Engineering,
166:3–24, 1998.

[27] T.J.R. Hughes, L. Mazzei, and K.E. Jansen. Large eddy simulation and the variational multiscale
method. Computing and Visualization in Science, 3:47–59, 2000.

[28] S.L. Keil, T.R. Rimmele, and J. Wagner. Advanced technology solar telescope. Earth, Moon, and
Planets, 104(1-4):77–82, 2009.

[29] E. Masciadri, J. Vernin, and P. Bougeault. 3D mapping of optical turbulence using an atmospheric
numerical model. Part I. Astron. Astrophys. Suppl. Ser., 137:185–202, 1999.

[30] E. Masciadri, J. Vernin, and P. Bougeault. 3D mapping of optical turbulence using an atmospheric
numerical model. Part II. Astron. Astrophys. Suppl. Ser., 137:203–216, 1999.

[31] E. Masciadri, J. Vernin, and P. Bougeault. 3D numerical simulations of optical turbulence at the
Roque de Los Muchachos Observatory using the atmospherical model Meso-Nh. Astronomy &
Astrophysics, 365:699–708, 2001.

26



[32] L.J. Peltier and J.C. Wyngaard. Structure function parameters in the convective boundary layer
from large eddy simulation. Journal of the atmospheric sciences, 52:3641–3660, 1995.

[33] F. Roddier. Adaptive optics in astronomy. Cambridge University Press, 2004.

[34] V.I. Tatarski. Wave propagation in a turbulent medium. Dover Publications, INC, 1961.

[35] H. Trinquet and J. Vernin. A statistical model to forecast the profile of the index structure constant.
Environ Fluid Mech, 7:397–407, 2007.

[36] L.P. Wang, S. Chen, and J.G. Brasseur. Examination of the hypothesis in the Kolmogorov refined
turbulence theory through high resolution simulations. Part 2. Passive scalar fields. Journal of
Fluid Mechanics, 400:163–197, 1999.

27


