
































Mixed Stabilized Finite Element Methods in Nonlinear Solid
Mechanics. Part III: Compressible and incompressible plasticity

M. Cervera, M. Chiumenti, L. Benedetti and R. Codina
International Center for Numerical Methods in Engineering (CIMNE)

Technical University of Catalonia (UPC)
Edi�cio C1, Campus Norte, Jordi Girona 1-3, 08034 Barcelona, Spain.

Keywords: mixed �nite elements, stabilization, plasticity, strain softening, strain localization, mesh
dependence.

Abstract

This paper presents the application of a stabilized mixed strain/displacement �nite element
formulation for the solution of nonlinear solid mechanics problems involving compressible and
incompressible plasticity. The variational multiscale stabilization introduced allows the use
of equal order interpolations in a consistent way. Such formulation presents two advantages
when compared to the standard, displacement based, irreducible formulation: (a) it provides
enhanced rate of convergence for the strain (and stress) �eld and (b) it is able to deal with
incompressible situations. The �rst advantage also applies to the comparison with the mixed
pressure/displacement formulation. The paper investigates the e¤ect of the improved strain
and stress �elds in problems involving strain softening and localization leading to failure, using
low order �nite elements with continuous strain and displacement �elds (P1P1 triangles or
tetrahedra and Q1Q1 quadrilaterals, hexahedra, and triangular prisms) in conjunction with an
associative frictional Drucker-Prager plastic model. The performance of the strain/displacement
formulation under compressible and nearly incompressible deformation patterns is assessed and
compared to a previously proposed pressure/displacement formulation. Benchmark numerical
examples show the capacity of the mixed formulation to predict correctly failure mechanisms
with localized patterns of strain, virtually free from any dependence of the mesh directional
bias. No auxiliary crack tracking technique is necessary.

1



1 Introduction

In previous works [1, 2], the authors have formulated stable mixed stress/displacement and strain/
displacement �nite elements with equal order interpolation for the solution of nonlinear problems
in solid mechanics. The proposed formulation uses the sub-grid scale approach to circumvent the
restrictiveness of the inf-sup compatibility conditions on the choice of the interpolation spaces. The
objective of such formulation is to achieve a discrete scheme with enhanced stress accuracy. This
means that the mixed formulation displays a global rate of convergence on stresses higher than the
corresponding irreducible formulation. Such improvement of the convergence estimates also applies
at local level. And this characteristic proves to be crucial in strain localization problems involving
softening materials.

Strain localization inevitably occurs in softening materials subjected to monotonic straining.
Once the peak stress is reached, and upon continuing straining, the stress decreases and strains
concentrate inside a narrow band of material while the material outside the band unloads elastically.
As the localization progresses, the width of the localization band diminishes and, unless there is
a microstructural limitation, it tends to zero. The particular components of the strain tensor
that localize during this process depend on the speci�c constitutive behavior of the material. In
Rankine-type materials, only normal elongations localize, eventually forming tensile cracks; if the
nonlinear behavior is incompressible, shear strains concentrate, leading to slip surfaces.

Quasi-singular strain or stress states occur at the vicinity of the propagating cracks or slip lines.
For linear elements and even in elastic behavior, it is well known that the standard irreducible for-
mulation fails to provide guarantee of local convergence of stress values in such situations, such as
the tip of a notch or a propagating crack. And this lack of local convergence leads to the spurious
mesh bias dependence often displayed by standard �nite elements when using local softening consti-
tutive models. Contrariwise, the proposed mixed formulations do provide the necessary guarantee
of convergence for local stress convergence. This characteristic proves to be su¢ cient to avoid mesh
bias dependence of the numerically computed failure mechanisms and responses.

In references [2] and [3], the mixed strain/displacement formulation was applied in conjunction
with an isotropic Rankine damage model, formulated in secant form, to model problems of tensile
cracking propagation and failure. It was observed there that: (a) the resulting discrete FE model is
well posed and stable, (b) the formulation is convergent and, on mesh re�nement, it approaches the
original continuum problem, and (c) the results obtained are not spuriously dependent of the �nite
element mesh used; they depend only on the actual material model (damage criterion in this case)
adopted. This represented a signi�cant advancement in the solution of such problems, particularly
considering two noteworthy features of the approach. On one hand, it is of general application, in
2D and 3D problems, to structured and unstructured meshes and to simplicial or non simplicial
elements. On the other hand, no "ad hoc" auxiliary crack tracking technique is necessary. However,
the application of the proposed formulation to problems involving local softening plasticity models
remained open.

In previous works, the authors have applied stabilized mixed displacement-pressure methods
([4, 5, 6, 7, 8] and [9]) to the solution of J2 elasto-plastic problems with simplicial elements. In
J2 dependent problems, the plastic �ow is isochoric and the main challenge for the discrete for-
mulation is the incompressibility constraint. Unless this is properly dealt with, spurious pressure
oscillations appear and the discrete solution is totally polluted. A stabilized mixed formulation

2



provides a discrete problem which is fully stable, even for problems involving localization of shear
strains and the formation of slip lines. The results obtained, both in terms of collapse mechanism
and global load-de�ection response, compare very favorably with those obtained with the stan-
dard irreducible formulation, which almost inevitably shows an unacceptable mesh dependence.
Nevertheless, regarding the computation of the deviatoric stresses, the stabilized mixed pressure-
displacement formulation has the same convergence behavior than the irreducible formulation. This
is because, in both formulations, the discrete deviatoric strains are computed by direct di¤eren-
tiation of the discrete displacement �eld. This means that the corresponding convergence rate is
necessarily one order less than that of the displacements. When using linear interpolation for the
displacements and in quasi-singular situations, this may prove to be insu¢ cient. The remedy is to
use an independent interpolation, linear at least, not only for the volumetric part of the strain (or
stress) tensor, but for all of its components.

Therefore, the objectives of this paper are �ve: (1) to extend the stabilized mixed strain/displ-
acement formulation to plasticity problems, (2) to investigate the e¤ect of the improved strain and
stress �elds in problems involving strain softening and localization leading to failure, (3) to assess the
performance of the formulation under nearly incompressible deformation patterns, (4) to compare
the performance of the proposed formulation with the previously proposed pressure/displacement
formulation and (5) to show that the formulation is applicable in 2D and 3D, to structured or
unstructured meshes of triangles, quadrilaterals, tetrahedra, hexahedra or prisms. Both pressure
sensitive and incompressible plasticity models are contemplated. To achieve this, the Drucker-
Prager plasticity model is selected as target model, as it may incorporate pressure sensitivity
through the friction angle of the material, as well as reduce to a pure cohesional behavior when
null friction is assumed.

Inelastic plastic �ow is a directional phenomenon. In the stress space, assuming associative
plasticity, it occurs in the direction normal to the yield surface; in non-associative plasticity, the
directionality of the �ow is established from a plastic potential, di¤erent from the yield criterion.
In any case, plasticity does not occur isotropically. This is an additional objective of this work: to
investigate the performance of the proposed mixed formulation in strain localization situations sub-
stantially di¤erent to those studied in previous works. Satisfactory performance under directional
inelastic behavior, without spurious stress locking and without the need of auxiliary discontinuity
tracking procedures, would reopen the path to the use of orthogonal and anisotropic constitutive
models than cannot be used today in practical applications.

The outline of the paper is as follows. In Section 2, the stabilized mixed strain/displacement
formulation for the solution of nonlinear solid mechanics problems is applied in conjunction with a
small strain plasticity model. The continuum problem and the corresponding discrete formulation
are introduced. Following the ideas in [1] and [2], stabilization of the latter is achieved by considering
a residual-based subscale approach. Both algebraic and orthogonal subgrid scales are considered.
Section 3 describes the implementation details for both stabilization procedures. Section 4 describes
the Drucker-Prager plasticity model. Details on the return mapping, consistent tangent constitutive
tensor and the consideration of the singular case of the apex of the yield surface are discussed.
Section 5 presents selected numerical examples involving unstructured and structured low order
�nite elements meshes (triangles in 2D and triangular prisms in 3D) with continuous linear strain
and displacement �elds to assess the generality and robustness of the proposed formulation.

3



2 Stabilized mixed strain/displacement formulation for plasticity

2.1 Mixed "=u formulation for plasticity

The strong form of the continuous quasi-static solid mechanics problem can be stated as: given the
prescribed body forces f , �nd the displacement �eld u and the stress �eld � such that:

�C�1 : � +rsu = 0 in 
 (1a)
r � � + f = 0 in 
 (1b)

where 
 is the open and bounded domain of Rdim occupied by the solid in a space of dim di-
mensions. The symbol rs(�) is used to denote the symmetric gradient, whereas r � (�) refers to
the divergence operator. Eq. (1a) enforces both the geometric equation for linear kinematics and
the non-linear constitutive relationship � = C : ", with C = C (�) being the (secant) nonlinear
constitutive tensor; Eq. (1b) is the balance of momentum Cauchy equation.

Equations (1a)-(1b) are subjected to appropriate Dirichlet and Neumann boundary conditions.
In the following, we will assume these in the form of prescribed displacements u = 0 on @
u, and
prescribed tractions t on @
t, respectively, being @
u and @
t a partition of @
.

This mixed formulation in terms of the stress and displacement �elds, �=u, is classical and it
has been used many times in the context of linear elasticity, where the constitutive tensor C = Co
is constant. However, this is not the most convenient format for the nonlinear problem. The reason
for this is that most of the algorithms used for nonlinear constitutive equations in solid mechanics
have been derived for the irreducible formulation. Thus, these procedures are usually strain driven,
and they have a format in which the stress � is computed in terms of the strain ", with " =rsu
for linear kinematics.

Because of this, the strong form of the continuum problem can be alternatively stated as: �nd
the displacement �eld u and the strain �eld ", for given prescribed body forces f ; such that:

�C : "+C :rsu = 0 in 
 (2a)
r � [C : "] + f = 0 in 
 (2b)

In small strain plasticity, the strain tensor " is decomposed additively as

" = "e + "p (3)

with "e the elastic strain tensor and "p the plastic strain tensor. The plasticity model is de�ned
by appropriate evolution laws for the plastic strain. The constitutive equation is usually stated as

� = Co : "e = Co: ("� "p) (4)

The problem is closed once the expression of "p is provided. In practice, an evolution law _"p = _"p(�)
is formulated, the dot standing for the time derivative.

Using this constitutive equation, rather the secant one, the strong form of the plasticity problem
may be written as

�Co : "+Co :rsu = 0 in 
 (5a)
r � [Co: ("� "p)] + f = 0 in 
 (5b)

4



Let V and G be the appropriate functional spaces where u and " are sought, respectively. Mul-
tiplying by appropriate test functions and integrating by parts the second equation, the associated
weak form of the mixed problem can be stated as:

� (;Co : ") + (;Co : r
su) = 0 8 (6a)

(rsv;Co: ("� "p)) = (v; f) +
�
v;t
�
@
t

8v (6b)

where v 2 V and  2 G are the variations of the displacements and strain �elds, respectively, with
V � H1(
)dim , this being the space of square integrable vector functions v which are at least square
integrable and have square integrable �rst derivative, and G � L2(
)dim�dimsym , this being the space
of square integrable symmetric tensors . The inclusions V � H1(
)dim and G � L2(
)dim�dimsym
are required because functions in V must vanish on @
u and because more regularity might be
needed for the evolution law _"p = _"p(�) to make sense. Parenthesis (�; �) denotes the inner product
in L2 (
) ; and (v;�t)@
t denotes the integral of the product of v and �t over @
t.

Let us consider a �nite element partition of the domain 
 from which we can construct �nite
element spaces Vh � V and Gh � G in the usual manner. A generic element size of this partition will
be denoted by h, and this subscript will be used to refer to �nite element functions. The discrete
Galerkin �nite element counterpart problem is de�ned as:

� (h;Co : "h) + (h;Co : r
suh) = 0 8h (7a)

(rsvh;Co : ("h � "p)) = F (vh) 8vh (7b)

where uh ; vh 2 Vh and "h ; h 2 Gh are the discrete displacement and strain �elds and their
variations, and F (vh) = (vh; f) +

�
vh; t

�
@
t

: It is understood that "p is now computed in terms of
the �nite element unknowns.

Remark The strong form (5a)-(5b), as well as the corresponding discrete weak form (7a)-(7b), are
not symmetric, because of the functional dependence of the plastic strain on the primary variables
of the problem. This can be remedied in two ways.

The constitutive equation (4) can be equivalently expressed, for example, as

� =

�
Co �

(Co: "p)
 (Co: "p)
" : Co : "p

�
: " = C : " (8)

where the (secant) nonlinear constitutive tensor C is symmetric by construction. The form (8)
can be �tted directly in the strong form (2a)-(2b) to provide the corresponding symmetric discrete
weak form:

� (h;C : "h) + (h;C :r
suh) = 0 8h (9a)

(rsvh;C : "h) = F (vh) 8vh (9b)

This form is identical to the discrete form obtained in references [1] and [2].
The second alternative is as follows. The constitutive equation (4) may be expressed in rate

form as
_� = Cep : _" (10)

5



where Cep is the (tangent) elasto-plastic constitutive tensor, symmetric for associative plasticity
(see Subsection 4.3).

Making use of this, and stating all the governing equations in rate form, the strong form of the
problem can be written as

�Cep : _"+Cep:rs _u = 0 in 
 (11a)
r � [Cep : _"] + _f = 0 in 
 (11b)

This form is symmetric and leads to the symmetric discrete weak form:

�
�
h;Cep: _"h

�
+
�
h;Cep:r

s _uh
�
= 0 8h (12a)�

rsvh;Cep: _"h
�
= _F (vh) 8vh (12b)

where _F (vh) is the counterpart of F (vh) when loads are expressed in rate form.

2.2 Variational Multiscale Stabilization

The inf-sup condition [10] establishes that the stability of the discrete formulation depends on
the appropriate choice of the �nite element spaces Vh and Gh. Even for linear elasticity, stan-
dard Galerkin mixed elements with continuous equal order P1P1 (linear/linear) and Q1Q1 (bi-
linear/bilinear) interpolation for both �elds do not satisfy the condition and, therefore, are not
stable. For the "=u (or the �=u) problem, lack of stability manifests as spurious oscillations in
the displacement �eld that pollute the solution. A satisfactory way of circumventing the inf-sup
condition is to modify the discrete variational form, introducing numerical stabilization techniques
that can provide the necessary stability without a¤ecting the consistent formulation of the discrete
problem nor degrading its convergence rate. Such techniques can be sustained from the so-call
Variational Multiscale Stabilization (VMS).

VMS was developed in �rst instance by [11] and then generalized in [12]. This technique
modi�es appropriately the variational form of the problem in order to provide the required numerical
stability. The corresponding modi�ed inf-sup condition is milder than the original one and it holds
for most common equal order �nite element spaces [13].

The multiscale procedure decomposes the solution (";u) into a resolvable �nite element scale
("h;uh) and an unresolvable subscale (~"; ~u), so that:

" = "h + ~" (13a)

u = uh + ~u (13b)

This extends the solution spaces for the displacements and the strains to V ' Vh�eV and G ' Gh� eG,
where eV and eG are the functional spaces for the subscale variables (~"; ~u) and their test functions
(~; ~v). It can also be assumed that ~" and ~ vanish on the boundary @
:

The plastic strain "p is non-linearly dependent on the stress �eld, this in turn being dependent
on the strain �eld through the constitutive equation. Since the strain �eld " includes a subscale
contribution, then also the plastic strain tensor "p could present a corresponding subscale part.
However, since the subscale contribution is assumed to be small with respect the resolvable scale,
the plastic strain will be approximated as:

"p = "p (�) � "p (�h) (14)

6



This implies that the constitutive model is evaluated only with the resolvable part of the strain:

�h = Co : ["h � "p (�h)] (15)

It would be possible however to account for the e¤ect of the subscales in this expression, at the
expense of increasing the non-linearity of the problem.

Considering the scale splitting, the discrete problem corresponding to Eqs. (6a)-(6b) is now:

� (h;Co : ["h + e"]) + (h;Co : rs(uh + eu)) = 0 8h (16a)
(rsvh;Co : ["h + e"� "p]) = F (vh) 8vh (16b)

� (e;Co : ["h + e"]) + (e;Co : rs(uh + eu)) = 0 8e (16c)
� (rsev;r �Co : ["h + e"� "p]) + (ev; f) = 0 8ev (16d)

where due to linear independence, each of the equations in (6a) and (6b) unfolds into two equations,
one related to each scale considered.

Rewriting the third and fourth equations, tested against the subscale test functions, and as-
suming that the subscale (~"; ~u) vanishes on the boundary, it follows that

� (e; Co : e")h + (e;Co : rseu)h = � �e; r1;h�h 8e (17a)
(rsev;r �Co : e")h = � �ev; r2;h�h 8ev (17b)

where subscript h refers now to the fact the integrals are evaluated element-wise and where the
residuals of the �rst and second equations, in the �nite element scale, are:

r1;h = Co : (rsuh � "h) (18a)
r2;h = r � �h+f (18b)

where the de�nition of the stress in expression (15) has been used.
This last system of equations shows that the solution of the subscale variables depends on

the residuals upon substitution of the resolvable FE solution in the strong form of the problem.
Therefore, following the work of [14], the residual based subscales strain can be localized within
each �nite element and expressed as

e" = � "C�1o : P (r1;h) = � " P (rsuh � "h) (19a)
~u = �u P (r2;h) = �u P (r � �h + f) (19b)

where P (�) represents an appropriate projection operator onto the space of subscales and � ", �u
are computed as

� " = c"
h

L

�

�o
and �u = cu

hL

�
(20)

where c" and cu are positive constants, � is a mechanical parameter of the problem, usually chosen as
the ratio between the norms of the deviatoric stress and total strain tensors, � = kdev �k = kdev "k ;
�o being its initial elastic value. For nonlinear constitutive models, this ratio is non-constant and
it varies along the deformation process. Dimension h is the size of the �nite element and L is
a characteristic length of the problem. The expression given by (20) has been chosen according

7



to the optimal convergence results obtained for equal interpolation in [14], since in the following
we precisely assume equal continuous interpolation for displacements and strains. For the sake of
clarity, h will be assumed constant for all elements, even if in practice expressions (20) are evaluated
element-wise.

To complete the stabilization method, an appropriate projection operator has to be selected in
order to be able to compute the subscale variables.

2.2.1 ASGS

In the Algebraic Subgrid Scale Stabilization [12], the projection operator is taken as the identity
when applied to �nite element residuals, that is, P (r) = r, and, therefore, the subscales read:

e" = � " (rsuh � "h) (21a)
~u = �u (r � �h + f) (21b)

Introducing these strain and displacement subscales in Eqs. (16a) and (16c), integrating by parts
the last term in the �rst equation and recalling that the subscales vanish on the boundary, the
mixed discrete system of equations can be written as

� (1� � ") (h;Co : ["h �r
suh])h + �u (r � (Co : h) ;r � �h + f)h = 0 8h (22a)

(rsvh;Co : ["stab � "p])h = F (vh) 8vh (22b)

where
"stab = (1� � ") "h + � "rsuh (23)

2.2.2 OSGS

In the Orthogonal Subgrid Scale Stabilization [12], the projection operator is the orthogonal pro-
jector, P (r) = P?h (r) = r � Ph (r), where Ph represents the projection on the appropriate �nite
element space. It is performed taking advantage of the orthogonality condition

(�h;�r � r) = 0 8�h (24)

where �r is the projected value of r on the �nite element space and �h belongs either to Vh or Gh.
According to this, the subscale variables ~u and ~" are approximated as:

e" = � " (rsuh � Ph (rsuh)) (25a)
~u = �u (r � �h � Ph (r � �h)) (25b)

where it has been assumed that Ph (f) = f .
Back-substituting in the set of equations of the problem, the problem to be solved is

� (h;Co : "h)� � "(h;Co : [r
suh � Ph(rsuh)])h+

(h;Co : r
suh)� �u(r �Co : h;r � �h � Ph(r � �h))h = 0 8h (26a)

(rsvh;Co : ["h � "p]) + � "(rsvh;Co : [rsuh � Ph(rsuh)])h = F (vh) 8vh (26b)

8



2.2.3 Modi�ed OSGS

The formulation given by (26a)-(26b) has a numerical performance very similar to the ASGS method
given by (21a)-(21b). However, when localization occurs the formulation that has been found most
robust, and that has been used in the numerical examples, is the modi�cation of (26a)-(26b)
described next.

First, it may be assumed that
Ph(rsuh) � "h (27)

which essentially means that the strain subscale is assumed to be given by the ASGS formulation
rather than by the OSGS one. This avoids the need to compute the projection Ph(rsuh), but it is
not crucial at all, neither for stability nor for accuracy.

The second modi�cation is the important one. If dev(a) and 1
3
tr(a)1, with 1 the second order

identity tensor, are respectively the deviatoric and volumetric components of a tensor a, and P?h =
I � Ph is the projection orthogonal to the appropriate �nite element space, the last term in (26a)
may be written as

(r �Co : h;r � �h � Ph(r � �h))h

=
�
P?h (r � dev(Co : h)) +

1

3
P?h (rtr(Co : h)); P

?
h (r � dev(�h)) +

1

3
P?h (rtr(�h))

�
h
(28)

For any function f smooth enough, P?h (f) = f � Ph(f) goes to zero as h! 0 at the optimal rate
allowed by the �nite element interpolation. Therefore, any term in this last expression may be
deleted without upsetting the accuracy of the formulation (see [15] for the analysis of the Oseen
problem and a discussion about this point).

The critical point is that we have observed that in cases in which there are strong gradients of the
solution the cross-products deviatoric-volumetric terms in (28) cause a numerical misbehavior, that
manifests in the plasticity problem as a (small) volumetric locking. A similar situation was found
in [16] for the viscoelastic �ow problem in the presence of high stress gradients. Note that when the
solution is smooth, formulation (26a)-(26b) yields accurate and stable numerical approximations.
Moreover, the deviatoric-deviatoric product in (28) leads to a positive-de�nite term and in principle
should enhance stability, but we have found no instability problems when it is omitted.

In view of these observations, only the volumetric-volumetric term is kept in (28), i.e.,

(r �Co : h;r � �h � Ph(r � �h))h �
1

9
(rtr(Co : h);rtr(�h)� Ph(rtr(�h)))h (29)

This, together with (27), leads to the modi�ed OSGS formulation:

� (1� � ") (h;Co : ["h �r
suh]) + �u

1

9
(rtr(Co : h);rtr(�h)� Ph(rtr(�h))) = 0 8h (30a)

(rsvh;Co : ["stab � "p])h = F (vh) 8vh (30b)

with "stab given by (23). As mentioned above, this is the numerical formulation used in the
numerical examples.

9



3 Implementation and computational aspects

In the presented mixed formulation, the presence of the non-linear plastic strains requires an iter-
ative procedure to deal with the nonlinearity of the problem. Iterative solution schemes, such as
Picard or Newton-Raphson methods, need to be introduced. Constitutive laws involving plastic-
ity are usually written in terms of rate equations and, consequently, the matrices involved in the
resulting algebraic set of equations are tangent to the strain-stress path. Hence, the use of the
Newton-Raphson scheme will be considered in the following. The advantage of such method is a
quadratic convergence rate in the iteration at each time step. Its use requires the computation of
the Jacobian matrix of the system of equation at each iteration of every time step.

3.1 ASGS

In the case of the ASGS scheme, di¤erentiating the system of equations (22a)-(22b) at iteration i
of time step n+ 1, the Jacobian matrix presents the structure:

J (i;n+1) =

�
M � G�
D� K�

�(i;n+1)
(31)

whereM is a projection mass-like matrix,G is a gradient matrix,D is a divergence matrix andK is
the sti¤ness matrix. The subscript � refers to the fact that those matrices incorporates stabilization
terms. Di¤erentiating Eqs. (22a)-(22b), with the hypothesis introduced in Eqs. (14)-(15) that the
plastic strain depends only on "h, and after some manipulation, the previous matrices read:

M � = � (1� � ")
Z


N"

TCoN" � �u
Z


CoBB

T Cep (32)

G� = (1� � ")
Z


N"

TCoB (33)

D� =

Z


BT [Cep � � " Co] Nu (34)

K� = � "

Z


BTCoB (35)

where N" and Nu are the matrices of shape functions of the respective strain and displacement
�elds and B is the matrix of the gradient of those shape functions. The resulting algebraic system
of equations is, in general, not symmetric. Note that disregarding the terms due to plasticity,
the system matrix is symmetric and it coincides with the one presented in [1], [2]. In the general
elasto-plastic case, matrix Cep is tangent to the stress-strain path. In Subsection 4.3 we introduce
it and describe how to compute it so that it is tangent to the time-discrete stress-strain path.

3.2 Modi�ed OSGS

The modi�ed OSGS implementation is identical to the ASGS implementation, except for the ad-
ditional projection of the gradient of the trace of the nodal stresses and the second term in (32),
which in this case only contains the volumetric components of Co and B.

10



Concerning the additional equation due to the projection, it has the structure

M��+D�� = 0 (36)

where � are the nodal values of the projected variable (gradient of the trace of the stress) and �
of the stresses, and where

M� = �
Z


Nu

TNu

The Jacobian in (31) has to be completed with the last row corresponding to (36) and the columns
accounting for the e¤ect of � in the �rst equation. Alternatively to this procedure, a staggered
scheme can be devised. First, the projection of the stresses �(0;n+1) is computed at the beginning
of the time step. Then, the approximation �(i;n+1) � �(0;n+1) is used for the solution of ("h;uh).
This scheme is preferred with respect to the monolithic one due to the reduced computation time
required, almost identical to that of the ASGS scheme.

4 Pressure dependent plasticity. The Drucker-Prager model

4.1 Yield criterion

The Drucker-Prager plasticity model may be constructed as a linear combination of a pure isochoric
plasticity model and a pure pressure plasticity model, in the form:

f (�; q) =

"r
3

2
kdev �k � rd (q)

#
+ a tan�

�
1

3
tr � � rp (q)

�
= 0 (37)

where the angle of friction � is introduced to relate the admissible deviatoric stresses to the pressure.
Here, rd = rd (q) and rp = rp (q) are the admissible stresses of the deviatoric and volumetric parts of
the model, respectively, and q is a stress-like internal variable that controls the hardening/softening
of the model. In this work, the pressure threshold is taken as rp = 0 to allow a direct comparison
between J2 incompressible plasticity and Drucker-Prager plasticity.

In the principal stress Haigh-Westergaard space, the Drucker-Prager yield surface appears as a
symmetric cone with the axis coinciding with the hydrostatic pressure and a circular trace on the
octahedral plane (see Figure 1). The parameter a = �1 controls the sign of the pressure part and
the orientation of the cone. For a = 1; the cone is open in the triaxial compression end, while for
a = �1, it is open for triaxial tension.

The deviatoric stress threshold is expressed as:

rd (q) = �y � q(�) (38)

where � is an internal strain-like parameter and q(�) is the hardening/softening function:

q (�) =

�
H � for 0 � � � �y

H
0 for �y

H
� � � 1 (39)

for linear softening, whereas, in the case of exponential softening, it takes the form:

q (�) = �y

�
1� exp

�
�2H
�y

�

��
for 0 � � � 1 (40)

11



Figure 1: Yield surface for Drucker-Prager plasticity model in the stress space (a = 1)

where �y is the initial deviatoric threshold and H is the softening parameter.
Making � = 1=(1 + tan�), the yield surface may be rewritten as:

f (�; q) = �

 r
3

2
kdev �k � (�y � q(�))

!
+ a (1� �)

1

3
tr � = 0 (41)

In the following, linear isotropic elasticity is assumed, with the elastic constitutive tensor given
by:

Co= K 1
 1+2G
�
I�

1

3
1
 1

�
(42)

where K is the bulk modulus, G is the shear modulus and 1 and I are the second and fourth order
identity tensors, respectively.

4.2 Return mapping algorithm

Assuming associative plasticity and the existence of a plastic potential that coincides with the
de�nition of the admissible stress surface f (�; q), the evolution equations for the plastic variables
read:

_"p = _ @�f (�; q)
_� = _ @qf (�; q)

(43)

where _ is the plastic multiplier or plastic consistency parameter.
Additionally, given the Karush-Kuhn-Tucker and consistency conditions:

 � 0; f (�; q) � 0; f (�; q) = 0 (44)

if f (�; q) = 0 ) _ � 0; _f (�; q) � 0 and _ _f (�; q) = 0 (45)

12



Substituting the de�nition of the failure surface and di¤erentiating, the plastic multiplier _ is
computed as [17]:

_ =
1

D
@�f : Co : _" (46)

with

D =

�
@�f : Co : @�f + @qf

dq

d�
@qf

�
(47)

The time derivative of the evolution equations of the plastic variables can be approximated in-
troducing a Backward-Euler scheme with time steps of length �t. Let us consider the time span
[tn; tn+1]; with tn+1 = tn + �t; where variables are known at step (n) and must be computed at
step (n+ 1). Then, the discrete-in-time version of (43) reads:

_"p �
"
(n+1)
p �"

(n)
p

�t
=

(n+1)�(n)
�t

�
�
q

3
2
dev �(n+1)

kdev �(n+1)k +
a(1��)
3

1

�
_� � �

(n+1)��(n)
�t

= �
(n+1)�(n)

�t

(48)

The trial state is de�ned at step n + 1 with the plasticity variables "p and � frozen at step n.
Therefore, the trial stresses are:

�
(n+1)
trial = Co:

�
"(n+1) � "(n)p

�
q
(n+1)
trial = q

(n)
(49)

The trial yielding function is:

f
(n+1)
trial = �

 r
3

2

dev �(n+1)trial � ��y � q(n+1)trial �
!
+ a (1� �)

�
1

3
tr �

(n+1)
trial

�
(50)

Plasticity occurs if f
(n+1)
trial � 0. The update of the stress is then

�(n+1) = �
(n+1)
trial ��

(n+1) Co : @�f (51)

which can be particularized for the Drucker-Prager criterion as:

�(n+1) = �
(n+1)
trial ��

(n+1)

2
4a (1� �)K1+ 2G�r3

2

dev �
(n+1)
trialdev �(n+1)trial 

3
5 (52)

The change of plastic multiplier �(n+1) = (n+1)�(n) is computed with the discrete counterpart
of (46) as:

�(n+1) =
f
(n+1)
trial

(1� �)2K + 3G�2 + �2 dq
d�

���(n+1) (53)

13



4.3 Constitutive Elasto-Plastic Tangent operator

On one hand, the constitutive elasto-plastic tensor in continuous form is [17]:

Cep = Co� Cp = Co �
1

D
(Co : @�f)
 (Co : @�f) (54)

On the other hand, considering the discrete Backward Euler time integration, the algorithmic
consistent constitutive elasto-plastic tensor [18] can be computed as:

C(n+1)ep =
��(n+1)

�"(n+1)
(55)

Carrying out the di¤erentiation, it yields:

C
(n+1)
ep = Co

� 1
D(n+1)

h
�2G

q
3
2
n
(n+1)
d;trial + a (1� �)K 1

i


h
�2G

q
3
2
n
(n+1)
d;trial + a (1� �)K 1

i
� �(n+1)(2G)2�

q
3
2

1dev �(n+1)trial 
h�
I� 1

3
1
 1

�
� n(n+1)d;trial 
 n

(n+1)
d;trial

i
(56)

where D(n+1) is the discrete counterpart of (47):

D(n+1) =
h
(1� �)2K + �23G

i
� �3

dq
�
�(n) + ��(n+1)

�
d�

(57)

and n
(n+1)
d;trial is the unit vector in the trial deviatoric stress direction:

n
(n+1)
d;trial =

dev �
(n+1)
trialdev �(n+1)trial  (58)

4.4 Apex return mapping

The apex of the Drucker-Prager cone is a singular point in the yield surface. This means that the
cases when the return mapping is to the apex, rather than to the regular lateral surface of the cone,
have to be identi�ed and an �ad-hoc�procedure is necessary [19, 20, 21]. In the standard return
mapping algorithm, Eq. (52), considering the deviatoric part and taking norms, it is:

dev �(n+1) = dev �(n+1)trial ��(n+1)�2G
r
3

2
(59)

which requires that:

�(n+1) �

dev �(n+1)trial 
�2G

q
3
2

(60)

14



If this condition is veri�ed, then the return mapping is made through the standard procedure
described previously. Otherwise, the return mapping will be made to the apex of the Drucker-
Prager cone.

The stress at the apex point is:

�apex = pmin 1 = a
�

(1� �)
(�y � q) 1 (61)

And, given that
�apex = �

(n+1)
trial �Co: �"

(n+1)
p (62)

the discrete increment of plastic strain is:

�"(n+1)p = C
�1
o :
�
�
(n+1)
trial � �apex

�
(63a)

=
a

3K

�
p
(n+1)
trial � pmin

�
1+

1

2G
dev �

(n+1)
trial (63b)

Notice that the value of pmin depends on the value of the isotropic hardening q = q(�). Consequently,
an iterative procedure is necessary in order to evaluate correctly the plastic multiplier.

Once the stress state arrives at the vertex of the cone, it will remain at the apex unless unloading
or neutral loading occurs. This means that once the apex is reached, the consistent constitutive
tensor is the null fourth order tensor.

4.5 Softening behavior

Physically, the energy dissipated during the formation of a slip surface is linked with the fracture
energy Gf , de�ned by unit surface. When using a plastic model de�ned in terms of stress and
strain to represent the behavior of the (regularized) slip surface, the dissipated plastic energy Wp
is de�ned by unit volume. In the discrete FE setting, these two de�nitions are related through a
characteristic length lch, connected to the mesh resolution:

Wp =
Gf
lch

(64)

In the plastic model, the rate of plastic work is computed as:

_Wp = � : _"p = �� _�"p (65)

where �� is the equivalent Drucker-Prager stress:

�� = � (�y � q (�)) (66)

and _�"p is the rate of equivalent plastic strain:

_�"p =

r
2

3
k _"pk =

"
�+ a

r
2

3
(1� �)

#
_� =

�

�
_� (67)

15



where � � 1 depends only on the friction angle. In both the linear and exponential softening cases,
where q (�) is de�ned by (39) and (40), respectively, the total plastic work is integrated to be:

Wp =

Z 1
0

_Wp dt =

Z 1
0
�� _�"p dt = �

�y
2

2H
(68)

From expressions (64) and (68), the parameter H can be computed as:

H = �
�y
2

2Gf
lch = �H lch (69)

The parameter �H depends only on material properties, whereas lch depends on the resolution of
the discretization. As pointed out in Part II of this work [2], the size of the strain concentration
band depends on the �nite element technology. For instance, irreducible �nite elements provide
a concentration band within a single element span, due to the discontinuous strain �eld. On the
contrary, in the "=u mixed FE formulation, with inter-elemental continuous strain, the slip line
spans two elements. In this work, we will assume a locally computed lch = 2h; where h is the
representative size of the �nite element, computed as h2e = 2Ae for triangular elements, h

2
e = Ae

for quadrilateral elements and analogously in 3D.

4.6 Orientation of the shear band discontinuities

Several authors [22, 23, 24, 25, 26, 27, 28] have found analytical and geometrical solutions for the
orientation of the discontinuity bands resulting from elasto-plastic models using di¤erent strategies.
All of them seek their solutions after the so-called localization condition, which implies the loss of
material ellipticity of the constitutive relation and is shown to be a necessary condition for the
appearance of weak discontinuities and localized failure to take place.

In this work, a di¤erent approach is adopted to �nd analytical expressions for the orientation
of localization bands for the Drucker-Prager model, both under plane strain and plane stress con-
ditions. This procedure, proposed in reference [29] and exploited in reference [30], produces more
realistic results than those used beforehand. It makes use of the stress boundedness and decohesion
conditions, which, combined, can be shown to be necessary conditions for the shear band to form,
and more constrictive than the localization condition. In fact, they can be shown to be necessary
conditions for the occurrence of bifurcation and localization of the strain �eld, with bounded stresses
and decohesion in the limit case along a localization band (or a regularized strong discontinuity).
This is why the term strong discontinuity condition was used in reference [28] for it. However, it
applies to localization bands (limited by weak discontinuities) and strong discontinuities alike.

The physical interpretation of this condition is simple: all of the di¤erence in the strain �eld
between the interior and the exterior points of the localization band, that is, the strain "jump",
must be inelastic (plastic in this case). For a given plastic �ow tensor, the condition may be used
to determine the orientation of the discontinuity.

A remarkable di¤erence between this approach and those other mentioned (based on the acoustic
tensor) is that the orientation of the discontinuity does not depend on the elastic properties. It
depends only on the plastic yield surface adopted and the stress state of interest.

In the next Section it is shown that this strategy predicts analytically orientations for the shear
bands that are almost in perfect agreement with the ones computed numerically using the proposed
stabilized mixed "=u formulation.

16



5 Numerical examples

The formulation presented in the preceding sections is illustrated below in a number of benchmark
problems. Performance of the proposed stabilized mixed formulations is tested considering both 2D
and 3D examples to demonstrate the generality of the formulation and its independence from the
type of �nite elements utilized. In 2D, plane-strain 3-noded linear triangular unstructured meshes
are used. In 3D, structured meshes of regular triangular prisms are employed. The examples involve
both compressible and incompressible plasticity using the Drucker-Prager model with exponential
softening. Results obtained for the incompressible cases are compared with those obtained with the
previously developed stabilized mixed pressure/displacement formulation ([4, 5, 6, 7, 8] and [9]).

The following material properties are assumed: Young�s modulus E = 10 MPa, Poisson�s ratio
� = 0:3, deviatoric stress threshold �y = 10 KPa and fracture energy Gf = 400 J/m

2. For the
Drucker-Prager model a = 1; the cone is open in the triaxial compression end.

Values c" = 0:01 and cu = 1:0 and L = 1 m are taken for the evaluation of the stabilization
parameters. It is noted that the values adopted for the stabilization parameters do not a¤ect the
convergence rate of the formulation, which with the expression given by (20) is optimal for equal
order interpolation [14]. For the mixed "=u formulation, modi�ed OSGS stabilization retaining
only the volumetric-volumetric term is used. Using the other stabilization methods discussed in
the paper produces similar results.

The Newton-Raphson method is used to solve the non-linear system of equations arising from
the spatial and temporal discretization of the weak form of the stabilized problem. In all cases 200
equal time steps are performed to complete the analyses. Convergence of a step is attained when
the ratio between the norms of the iterative residual forces and the incremental total forces is lower
than 10�5. Calculations are performed with an enhanced version of the �nite element program
COMET [31, 32], developed by the authors at the International Center for Numerical Methods in
Engineering (CIMNE). Pre and post-processing is done with GiD, also developed at CIMNE [33].

5.1 Singly perforated strip

The �rst example is a plane-strain singly perforated strip subjected to axial imposed straining.
Because of the double symmetry of the domain and boundary conditions, only one quarter of the
domain (the top right quarter) needs to be discretized. Figure 2a depicts the original geometry of
the problem; dimensions are 20 � 40 m � m (width � height) and the radius of the perforation
is r = 1 m. Thickness is 1 m. A uniform upward vertical displacement is imposed at the top
boundary.

The computational domain is divided into an unstructured uniform mesh of 7,202 linear triangles
(3,721 nodes) with an average mesh size of h = 0:25 m, not shown. The pre-processor used tends
to introduce patches of equilateral triangles with predominant directions at �30o, +30o and +90o
with the horizontal axis.

First, the incompressible case, with friction angle � = 0o is investigated.
Figure 3 shows the results obtained using the stabilized mixed u=p formulation, once the shear

bands are fully developed and the collapse mechanism can be appreciated ((half)-imposed vertical
upward displacement � = 0.20 m). The failure mechanism is correctly predicted, with X-shaped
shear bands forming at 45o. No mesh-bias dependency is observed. The resolution of the shear

17



(a) (b) (c)

Figure 2: Geometries for the singly perforated strip: (a) undeformed, (b) deformed (x 5) � = 0o,
(c) deformed (x 5) � = 45o

bands is optimal for the mesh used, as shown by the displacement and equivalent plastic strain plots.
Discontinuity of the displacement tangential to the slip line and localization of the deviatoric strain
occurs across one single element. The isochoric nature of the deformation pattern is demonstrated
by the absence of volumetric plastic strains. No indication of overshoots or undershoots of any
magnitude is observed at either side of the discontinuity lines. Control on the pressure is completely
attained, and no spurious oscillations are observed anywhere in the domain.

Figure 4 shows the results obtained using the proposed stabilized mixed "=u formulation, also for
a (half)-imposed vertical displacement � = 0.20 m. Results are very similar to those obtained with
the u=p formulation. The failure mechanism is correctly predicted and no mesh-bias dependency
is observed. The resolution of the shear bands is also optimal for the mesh used. Now localization
of the deviatoric strain occurs across two elements, because of inter-element strain continuity.
Volumetric plastic strains are negligible. No spurious oscillation of any variable is observed. The
deformed shape of the strip (with an ampli�cation factor of 5) is shown in Figure 2.

Figure 5a compares (half)-load vs (half)-imposed vertical displacement curves (recall 1 m thick-
ness is assumed) obtained with the two stabilized mixed formulations: u=p and "=u. Both mixed
formulations capture adequately the peak load and the softening branch of the curve, but the re-
sponse obtained with the newly proposed formulation is less dissipative. The reason for this is that
this formulation is locally more accurate and it reduces the stress locking induced by the isochoric
deformation behavior inside the shear bands.

The total dissipated energy required to create a perfectly straight shear band branch at 45o,
similar to those shown in Figures 3 and 4, but without any boundary e¤ect, is Wdis = Gf � A =
400 � 9

p
2 � 1 = 5091 J. The work spent by the external forces in the "=u formulation (area under

the curve in Figure 5a) is W
"=u
dis = 5210 J (2.33 % di¤erence with respect the idealized solution),

while the work spent by the u=p formulation is W
u=p
dis = 6723 J (32.02 % di¤erence). The accuracy

of the proposed formulation is remarkable.

18



(a) (b) (c) (d)

Figure 3: Results for singly perforated strip using the mixed u=p formulation; incompressible case
� = 0o. Contours for: (a) vertical displacement, (b) equivalent plastic strain, (c) volumetric plastic
strain and (d) deviatoric plastic strain

Figure 5a also shows the (half)-load vs (half)-imposed vertical displacement curves obtained
with the two stabilized mixed formulations, u=p and "=u; on a re�ned unstructured uniform mesh
of 20,255 linear triangles (10,342 nodes) with an average mesh size of h = 0:15 m. These show that
the solution obtained with "=u formulation is independent of the mesh size and bias. Contrarily,

(a) (b) (c) (d)

Figure 4: Results for singly perforated strip with the mixed "=u formulation; incompressible case
� = 0o. Contours for: (a) vertical displacement, (b) equivalent plastic strain, (c) volumetric plastic
strain and (d) deviatoric plastic strain

19



 0

 20

 40

 60

 80

 100

 120

 0  0.05  0.1  0.15  0.2

V
e

rt
ic

a
l r

e
a

ct
io

n
 [

kN
]

Vertical displacement [m]

U/Pressure formulation [h=0.25]
U/Epsilon formulation [h=0.25]

U/Pressure formulation [h=0.15]
U/Epsilon formulation [h=0.15]

(a)

 0

 20

 40

 60

 80

 100

 0  0.05  0.1  0.15  0.2

V
er

tic
al

 r
ea

ct
io

n 
[k

N
]

Vertical displacement [m]

Angle of friction = 0
Angle of friction = 15
Angle of friction = 30
Angle of friction = 45

(b)

Figure 5: Results for singly perforated strip. (a) Comparison between the mixed u=p and "=u
formulations for the incompresible case. E¤ect of mesh re�nement. (b) Comparison for the "=u
formulation for di¤erent friction angles.

20



the u=p formulation converges to an over-dissipative solution. This is due to the stress-locking
induced by the poor kinematics of the elements used under localized shear. The problem is much
alleviated in the "=u formulation (see reference [2]).

Next, compressible cases, with increasing friction angles � = 15o; 30o; 45o are investigated.
Figure 5b shows (half)-load vs (half)-imposed vertical displacement curves obtained with the

"=u formulation for these cases. The limit load reduces as the friction angle increases, due to the
orientation of the cone (a = 1). Even if the dissipated energy per unit area remains constant, and
equal for the fracture energy of the material, the total dissipated energy decreases as the friction
angle increases, because the length of the shear band diminishes.

Table 1 shows the comparison between the analytical localization angles computed for uniaxial
tension in plane strain conditions and the ones obtained numerically. The analytical values are
obtained with the procedure presented in references [29] and [30]. The remarkable agreement
between the analytical and the numerical values validates both the analytical and the numerical
approaches.

(a) (b) (c) (d)
Figure 6: Results for singly perforated strip with the mixed "=u formulation; compressible case
� = 45o. Contours for: (a) vertical displacement, (b) equivalent plastic strain, (c) volumetric
plastic strain and (d) deviatoric plastic strain

Plane strain Analytical [29], [30] Numerical
� = 0o �loc = 45:00

o �loc = 44:32
o

� = 15o �loc = 40:53
o �loc = 39:30

o

� = 30o �loc = 35:07
o �loc = 33:90

o

� = 45o �loc = 26:12
o �loc = 26:90

o

Table 1: Results for singly perforated strip with the mixed "=u formulation. Comparison be-
tween the analytical localization angles for uniaxial tension in plane strain conditions and the ones
obtained numerically

21



Figure 6 shows the results obtained using the proposed stabilized mixed "=u formulation, friction
angle � = 45o; and a (half)-imposed vertical displacement � = 0.20 m. The failure mechanism is
correctly predicted, with shear band now forming an angle of 26:90o with the horizontal axis (being
26:11o the analytical value), completely independent of the mesh-bias. The resolution of the shear
bands is also optimal for the mesh used. Volumetric plastic strains are of the same order than the
deviatoric plastic strains. The deformed shape (x 5) of the strip is shown in Figure 2c.

5.2 Circular rigid inclusion

The second example is a plane-strain circular rigid inclusion subjected to an imposed vertical
downward imposed displacement. Perfect stick conditions are assumed between the inclusion and
the surrounding medium; thus, the vertical displacement is imposed directly to the interface. Figure
7a depicts the original geometry of the problem; dimensions are 20 � 20 m � m (width � height)
and the radius of the inclusion is r = 1 m. Thickness is 1 m.

This example is interesting because the symmetric collapse mechanism consists of two almost
circular curved shear bands that intersect each other. Therefore, it is an adequate test to assess
the ability of the di¤erent formulations to deal with such a complex situation in a given mesh.

Because of the symmetry of the domain and boundary conditions with respect the central
vertical axis, only one half of the domain (the right half) needs to be discretized. The computational
domain is divided into an unstructured non-uniform mesh of 13,750 linear triangles (7,006 nodes)
with smaller elements near the circular inclusion, not shown.

The incompressible case, with friction angle � = 0o is investigated.
Figure 8 shows the results obtained using the stabilized mixed u=p formulation, once the col-

lapse mechanism and the shear bands are fully developed. The failure mechanism, which can be
appreciated in Figure 8a, displaying the contour �lls for the norm of the displacements, and Figure
8b, displaying the contour �lls for the norm of the equivalent plastic strain, is correctly predicted.
Because of the formulation used, discontinuity of the displacements across the slip lines and local-
ization of the plastic strain occurs across one single element. The attained resolution is optimal

(a) (b)

Figure 7: Original and deformed (x 5) geometries for circular rigid inclusion

22



(a) (b)

(c) (d)

Figure 8: Results for circular rigid inclusion using the mixed u=p formulation. Incompressible
plasticity, � = 0o. Contours for: (a) displacement, (b) equivalent plastic strain, (c) pressure and
(d) principal strain vectors

for the mesh used. Figure 8c shows pressure contours. Not only there is no evidence of pressure
oscillations, but the pressure �eld is completely undisturbed by the presence of the shear bands.
An almost perfectly skew-symmetric pressure distribution is attained. Finally, Figure 8d shows the
principal strain vectors at failure. Strain localization is clear, and the direction of the computed
vectors is a¤ected by the mesh alignment, although this is not evident because the mesh is unstruc-
tured. The deformed shape of the problem (with a displacement ampli�cation facto·r of 5) is shown
in Figure 7.

Figure 9 shows the corresponding results obtained using the proposed stabilized mixed "=u
formulation. As in the previous example, results are qualitatively very similar to those obtained with
the u=p formulation. The failure mechanism is obviously the same and no mesh-bias dependency is

23



(a) (b)

(c) (d)

Figure 9: Results for circular rigid inclusion using the mixed "=u formulation. Incompressible
plasticity, � = 0o. Contours for: (a) displacement, (b) equivalent plastic strain, (c) pressure and
(d) principal strain vectors

observed. Contour plots for the displacement and the pressure �elds, Figures 9a and 9c are almost
identical to those in 8a and 8c, because in both formulations these �elds are linearly interpolated.
A clear di¤erence can be observed in the contour plot of the plastic strain, Figure 9b, which can be
considered as the smoothing of the piece-wise discontinuous �eld of Figure 8c. The inter-element
continuity of the plastic strain is clear in the picture. Figure 9d shows the principal strain vectors
at failure. In this case, the direction of the computed vectors is much less a¤ected by the mesh
alignment than in Figure 8d.

Figure 10 compares (half)-load vs imposed vertical displacement curves obtained with the two
stabilized mixed formulations: u=p and "=u. As in the previous example, both mixed formulations
capture well the limit load and the general softening trend of the curve, but the response obtained

24



-70

-60

-50

-40

-30

-20

-10

 0
-0.2-0.15-0.1-0.05 0

V
er

tic
al

 re
ac

tio
n 

[k
N

]

Vertical displacement [m]

U/Pressure formulation
U/Epsilon formulation

Figure 10: Force vs. displacement plot for circular rigid inclusion. Comparison between the u=p
and the "=u formulations

(a) (b) (c) (d)

Figure 11: Deformed (x 5) geometries for singly perforated thin-walled cylinder for di¤erent friction
angles: (a) 0o, (b) 15o, (c) 30o, (d) 45o

with the newly proposed formulation is more accurate and less dissipative.

25



5.3 Simply perforated thin-walled cylinder

The last example is a simply perforated thin-walled cylinder subjected to axial imposed straining.
Dimensions of the cylinder are: height 30 m, outer radius 6 m, inner radius 5.8 m, thickness 0.2
m. The perforation is a square indentation of trace 0.4 � 0.4 m2. Because of the double symmetry
of the domain and boundary conditions, only one quarter of the cylinder is discretized. A uniform
upward vertical displacement is imposed at the top boundary. Because the cylinder is thin-walled
and there is no restriction to deformation in the radial and hoop directions, the normal stresses
in the radial and hoop directions are null, so that the cylinder is subjected to a state of uniaxial
vertical stress. Therefore, the angles of the localized shear bands can be analytically obtained under
plane stress conditions.

The computational domain is divided into a structured uniform mesh of 3,749 triangular prisms
(7,750 nodes) with a mesh size of h = 0:2 m, half the size of the indentation and equal to the
thickness of the cylinder.

Incompressible and compressible cases, with increasing friction angles � = 0o; 15o; 30o; 45o are
investigated using the stabilized mixed "=u formulation. The deformed shapes obtained are shown
in Figure 11 (ampli�cation factor 5). The failure mechanisms are correctly predicted in all cases,
withX-shaped helicoidal shear bands forming at di¤erent orientations, independently of the marked
alignment of the structured mesh, and without the use of any auxiliary tracking technique. It can
be observed that, as in the �rst example, the angle that the shear band forms with the horizontal
plane decreases as the angle of friction of the material increases.

Table 2 shows the comparison between the analytical localization angles computed for uniaxial
tension in plane stress conditions and the ones obtained numerically. The analytical values are
obtained with the procedure presented in references [29] and [30]. Note that the localization angles
are di¤erent in plane stress situations than under plane strain conditions. As in the �rst example,
the agreement between the analytical and the numerical values is remarkable, and validates both
the analytical and the numerical approaches.

This example provides a case to illustrate not only the quantitative, but the qualitative di¤erence
between the u=p and "=u formulation. Figure 12 shows the results obtained for the incompressible
case (� = 0o), with the "=u formulation. As can be noted, the computed failure mechanism is
correct, as all plots, vertical displacement, equivalent plastic strain, pressure and principal strain
vectors, corroborate. Figure 13 shows the results obtained with the u=p formulation. It can be
appreciated that the solution obtained with this formulation is not realistic. Figure 13c shows that
in this case the obtained plastic strain localizes in a layered pattern which is discontinuous from one

Plane stress Analytical [29], [30] Numerical
� = 0o �loc = 35:26

o �loc = 34:04
o

� = 15o �loc = 31:55
o �loc = 31:20

o

� = 30o �loc = 26:92
o �loc = 26:07

o

� = 45o �loc = 19:47
o �loc = 20:44

o

Table 2: Results for simply perforated thin-walled cylinder with the mixed "=u formulation. Com-
parison between the analytical localization angles for uniaxial tension in plane stress conditions
and the ones obtained numerically

26



(a) (b) (c) (d)
Figure 12: Results for simply perforated thin-walled cylinder with the mixed "=u formulation.
Contours for: (a) vertical displacement, (b) equivalent plastic strain, (c) pressure and (d) principal
strain vectors

(a) (b) (c) (d)
Figure 13: Results for simply perforated thin-walled cylinder with the mixed u=p formulation.
Contours for: (a) vertical displacement, (b) equivalent plastic strain, (c) pressure and (d) principal
strain vectors

27



 0

 2000

 4000

 6000

 8000

 10000

 12000

 14000

 16000

 18000

 0  0.05  0.1  0.15  0.2  0.25  0.3  0.35  0.4  0.45  0.5

V
er

tic
al

 re
ac

tio
n 

[k
N

]

Vertical displacement [m]

U/Epsilon formulation
U/Pressure formulation

Figure 14: Force vs. displacement plot for simply perforated thin-walled cylinder. Comparison
between the u=p and the "=u formulations

horizontal layer of elements to the ones above or below. This spurious type of stepped localization
is possible with the u=p discrete formulation, where the deviatoric strains are discontinuous, but
cannot occur with the "=u discrete formulation, where all strains are continuous. Note that the
solution of the u=p discrete formulation cannot be improved by restoring to mesh re�ment.

Figure 14 compares (half)-load vs (half)-imposed vertical displacement curves obtained with
the two stabilized mixed formulations: u=p and "=u. Here, the incorrect prediction of the failure
mechanism when using the mixed u=p formulation shows in the over prediction of the dissipated
energy spent during the failure process.

6 Conclusions

This paper presents the application of a stabilized mixed strain/displacement �nite element formula-
tion for the solution nonlinear solid mechanics problems involving compressible and incompressible
plasticity. Such formulation presents two advantages when compared to the standard, displacement
based, irreducible formulation: (a) it provides enhanced strain (and stress) rate of convergence and
(b) it is able to deal with incompressible situations. The �rst advantage applies also to the mixed
pressure/displacement formulation.

The variational multiscale stabilization introduced allows the use of equal order interpolations in
a consistent way. Consequently, low order �nite elements with continuous strain and displacement
�elds are used in conjunction with an associative frictional Drucker-Prager plastic model to model
strain localization and failure. The derived model yields a general and robust scheme, suitable for

28



engineering applications. Its application translates in the achievement of the goals:

1. the resulting discrete FE model is well posed and stable,

2. the formulation is able to tackle compressible and incompressible inelastic behavior, without
indications of pressure oscillations in the latter case,

3. the formulation is able to tackle directional inelastic behavior, and

4. the results are convergent and not spuriously dependent of the �nite element mesh used.

Benchmark numerical examples (using triangles in 2D and triangular prisms in 3D) show
the substantial advantage of the mixed formulation over the irreducible and the mixed pres-
sure/displacement one to predict correct failure mechanisms with localized patterns of strain, vir-
tually free from any dependence of the mesh directional bias.

The proposed formulation has two salient features. On one side, it is of general application,
in 2D and 3D problem, to structured and unstructured meshes and to simplicial or non simplicial
elements. On the other side, no "ad hoc" auxiliary crack tracking technique is necessary.

Acknowledgments

Financial support from the EC 7th Framework Programme under the MuMoLaDe project - Multi-
scale Modelling of Landslides and Debris Flows - within the framework of Marie Curie ITN (Initial
Training Networks, ref. 289911) and the Spanish Ministry of Economy and Competitiveness under
the EACY project - Enhanced accuracy computational and experimental framework for strain lo-
calization and failure mechanisms- within the "Excellency" Programme for Knowledge Generation,
ref. MAT2013-48624-C2-1-P, is gratefully acknowledged.

References

[1] Cervera, M., Chiumenti, M. and Codina, R. (2010). Mixed stabilized �nite element methods
in nonlinear solid mechanics. Part I: Formulation, Comp. Meth. in Appl. Mech. and Eng., 199,
2559-2570.

[2] Cervera, M., Chiumenti, M. and Codina, R. (2010). Mixed stabilized �nite element methods
in nonlinear solid mechanics. Part II: Strain localization, Comp. Meth. in Appl. Mech. and
Eng., 199, 2571-2589.

[3] Cervera, M., Chiumenti, M. and Codina, R. (2011). Mesh objective modelling of cracks using
continuous linear strain and displacement interpolations, Int. J. for Numerical Methods in
Eng., 87, 962-987.

[4] Cervera, M., Chiumenti, M., Valverde, Q. and Agelet de Saracibar, C. (2003). Mixed Lin-
ear/linear Simplicial Elements for Incompressible Elasticity and Plasticity. Comp. Meth. in
Appl. Mech. and Eng., 192, 5249-5263.

29



[5] Cervera, M., Chiumenti, M. and Agelet de Saracibar, C. (2004). Softening, localization and
stabilization: capture of discontinuous solutions in J2 plasticity. Int. J. for Num. and Anal.
Meth. in Geomechanics, 28, 373-393.

[6] Cervera, M., Chiumenti, M. and Agelet de Saracibar, C. (2004). Shear band localization via
local J2 continuum damage mechanics. Comp. Meth. in Appl. Mech. and Eng., 193, 849-880.

[7] Chiumenti, M., Valverde, Q., Agelet de Saracibar, C. and Cervera, M., (2004). A stabilized for-
mulation for incompressible plasticity using linear triangles and tetrahedra, Int. J. of Plasticity,
20, 1487-1504.

[8] Agelet de Saracibar C., Chiumenti M., Valverde Q., and Cervera M. (2006). On the Orthogonal
Subgrid Scale Pressure stabilization of Small and Finite deformation J2 Plasticity, Computer
Methods in Applied Mechanics and Engineering, 195, 1224-1251.

[9] Cervera, M. and Chiumenti, M. (2009). Size e¤ect and localization in J2 plasticity, International
Journal of Solids and Structures 46, 3301-3312.

[10] Brezzi, F. and Fortin, M. (1991) Mixed and Hybrid Finite Element Methods, Spinger.

[11] Hughes, T.J.R., Feijoó, G.R., Mazzei. L., Quincy, J.B. (1998) . The variational multiscale
method-a paradigm for computational mechanics, Comp. Meth. in Appl. Mech. and Eng. 166,
3-28.

[12] Codina, R. (2000) . Stabilization of incompressibility and convection through orthogonal sub-
scales in �nite element methods, Comp. Meth. in Appl. Mech. and Eng. 190, 1579-1599.

[13] Codina, R. and Blasco, J. (1997) . A �nite element method for the Stokes problem allowing
equal velocity-pressure interpolations, Comp. Meth. in Appl. Mech. and Eng. 143, 373-391.

[14] Badia, S. and Codina, R. (2009) . Uni�ed stabilized �nite element formulations for the Stokes
and the Darcy problems, SIAM Journal on Numerical Analysis 17, 309-330.

[15] Codina, R. (2008). Analysis of a stabilized �nite element approximation of the Oseen equations
using orthogonal subscales, Applied Numerical Mathematics, 58, 264-283.

[16] Castillo, E. and Codina, R. (2014). Variational multi-scale stabilized formulations for the
stationary three-�eld incompressible viscoelastic �ow problem, Comp. Meth. in Appl. Mech.
and Eng., 279, 579�605.

[17] Simo, J.C. and Hughes, T.J.R. (1998). Computacional Inelasticity. Interdisciplinary Applied
Mathematics. Vol. 7. Springer.

[18] Simo, J. C. and Taylor, R. L. (1985). Consistent tangent operators for rate-independent elasto-
plasticity, Comp. Meth. in Appl. Mech. and Eng. 48, 101-118.

[19] deBorst, R. (1987). Integration of plasticity equations for singular yield functions, Computers
& Structures 26, 823 - 829.

30



[20] Cris�eld, M. (1997). Non-linear Finite Element Analysis of Solids and Structures. II: Advanced
topics. Wiley.

[21] Peric, D. and de Souza Neto, E. A. (1999). A new computational model for Tresca plasticity
at �nite strains with an optimal parametrization in the principal space, Comp. Meth. in Appl.
Mech. and Eng. 171, 463 - 489.

[22] Ottosen, N. and Runesson, K. (1991). Properties of discontinuous bifurcation solutions in
elasto-plasticity. Int. J. Solids and Structures 27(4), 401-421.

[23] Runesson, K., Ottosen, N.S., and Peric, D. (1991). Discontinuous bifurcations of elastic-plastic
solutions at phase stress and plane strain. Int. J. of Plasticity 7, 99-121.

[24] Steinmann, P. and Willam, K. (1994). Finite element analysis of elastoplastic discontinuities.
Journal of Engineering Mechanics 120, 2428-2442.

[25] Iordache, M. M. (1996). Failure analysis of classical and micropolar elastoplastic materials.
report CU/SR-96/2. Department of Civil, Enviromental and Archetectural Engineering, Uni-
versity of Colorado.

[26] Iordache, M.M. and Willam, K. (1998). Localized failure analysis in elastoplastic Cosserat
continua. Comp. Meth. Appl. Mech. Engrg. 151, 559-586.

[27] Oliver, J., Cervera, M. and Manzoli, O. (1998). On the use of strain-softening models for the
simulation of strong discontinuities in solids. Material instabilities in solids, 107-123, Wiley.

[28] Oliver, J., Cervera, M. and Manzoli, O. (1999). Strong discontinuities and continuum plasticity
models: the strong discontinuity approach. Int. J. of Plasticity, 15, 319-351.

[29] Cervera, M., Chiumenti, M., Di Capua, D. (2012). Benchmarking on bifurcation and localiza-
tion in J2 plasticity for plane stress and plane strain conditions. Computer Methods in Applied
Mechanics and Engineering, 241-244, 206-224.

[30] Wu, J.Y. and Cervera, M. (2014). Thermodynamically consistent plastic-damage framework
for localized failure: material model and strain localization analysis. Submitted to Int. J. of
Plasticity.

[31] Cervera, M., Agelet de Saracibar, C. and Chiumenti, M. (2002). COMET: COupled MEchani-
cal and Thermal analysis. Data Input Manual, Version 5.0, Technical report IT-308. Available
from: <http://www.cimne.upc.es>.

[32] COMET: Coupled Mechanical and Thermal analysis (2013).
<http://www.cimne.com/comet/>.

[33] GiD: The Personal Pre and Post Processor (2009). <http://www.gidhome.com>.

31


