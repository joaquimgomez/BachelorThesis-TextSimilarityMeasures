

























































lodi.eps


Homogenization-based multiscale crack modelling: from micro diffusive damage to

macro cracks

Vinh Phu Nguyen 1,∗, Oriol Lloberas-Valls2,∗, Martijn Stroeven3,∗, Lambertus Johannes Sluys4,∗

Delft University of Technology, Faculty of Civil Engineering and Geosciences, P.O. Box 5048, 2600 GA Delft, The Netherlands

Abstract

The existence of a representative volume element (RVE) for a class of quasi-brittle materials having a random het-
erogeneous microstructure in tensile, shear and mixed mode loading is demonstrated by deriving traction-separation
relations, which are objective with respect to RVE size. A computational homogenization based multiscale crack
modelling framework, implemented in an FE2 setting, for quasi-brittle solids with complex random microstructure is
presented. The objectivity of the macroscopic response to the micro sample size is shown by numerical simulations.
Therefore, a homogenization scheme, which is objective with respect to macroscopic discretization and microscopic
sample size, is devised. Numerical examples including a comparison with direct numerical simulation are given to
demonstrate the performance of the proposed method.

Keywords: representative volume element (RVE), quasi-brittle materials, softening, multiscale, homogenization,
cohesive law, fracture

1. Introduction

The majority of natural and engineering materials are materials in which deformation and failure processes take
place at multiple scales and are therefore called multiscale materials (by multiscale we mean multiple length scales).
At the macroscopic level of observation, it is reasonable to consider materials as homogeneous, traditionally modelled
by phenomenological constitutive laws. At lower observation levels (meso and/or micro) heterogeneities appear which
are very troublesome to be taken into account in phenomenological constitutive models. There are three approaches
by which heterogeneous materials can be modelled. The first approach is known as either direct numerical simulation
(DNS) or brute-force fullscale simulation, in which the heterogeneities from the fine scale are explicitly modelled in
the coarse scale model. Although this guarantees accuracy, the computational effort is impractical (at least for current
computer technology) which limits the applicability of the DNS approach. The second approach is based on the
homogenization concept and has emerged as a valuable tool to model heterogeneous materials in an efficient way. The
third approach, known as the concurrent multiscale method, somehow resemble domain decomposition methods. For
a detailed taxonomy of multiscale methods, refer to [1].

∗Corresponding author
1
V.P.Nguyen@tudelft.nl

2
O.LloberasValls@tudelft.nl

3
M.Stroeven@tudelft.nl

4
L.J.Sluys@tudelft.nl

Preprint submitted to Elsevier March 20, 2012

V
O
M
L


Homogenization-based multiscale modelling techniques can either be numerical homogenization [2] or computational
homogenization [3], see [4] for a detailed discussion. In numerical homogenization schemes, a macroscopic canonical
constitutive model e.g., a visco-plasticity model, is assumed with parameters determined by fitting the data produced
by finite element (or any other numerical method) computations of a microscopic sample where all the microstructure
is explicitly modelled. In the literature, those numerical homogenization techniques are known as unit cell methods.
Due to the assumption of the form of the macroscopic constitutive law, the methods become less appropriate for highly
nonlinear problems.

According to computational homogenization techniques, to every macroscopic material point there is an associated
microscopic sample (with all relevant heterogeneities) which provides the macroscopic constitutive behavior. When
implemented in a finite element (FE) framework, the method is known as an FE2 [5] scheme. Although the method
is computationally expensive, it has been proved to be a valuable and flexible (due to the lack of an assumption
on the macroscopic constitutive model) tool for analyzing a wide range of heterogeneous materials with complex
microstructures with highly nonlinear behavior see, among others, [6, 7, 8] and [9] for a recent review. An open source
program for homogenization problems has recently been made available [10].

A concept of crucial importance in homogenization methods is the representative volume element (RVE). There is
not a single and exact definition of the RVE for an arbitrary heterogeneous material. That might explain the existence
of various definitions of the RVE, see [11] for a recent review. In this contribution, we consider a microscopic sample
to be an RVE when (i) an increase in its size does not lead to considerable differences in the homogenized properties,
(ii) the micro sample size is large enough so that the homogenized properties are independent of the microstructural
randomness and (iii) the RVE size should be small enough so that the separation-of-scales principle holds. An implicit
assumption usually made in FE2 modelling is the existence of an RVE. This is a correct assumption in linear and
hardening regimes [11]. However, this is no longer the case in softening regimes when a standard homogenization
method is used [11].

In the past two years homogenization schemes for adhesive cracks (or material layers) [12, 13, 14, 15] and cohesive
cracks [16, 17] have been developed in which a traction-separation law is obtained based upon finite element com-
putations at the microscale wherein the complex microstructure of the material have been explicitly modelled. By
doing homogenization for adhesive cracks, in [14] the existence of an RVE for softening materials (under tensile and
mixed-mode loading) which exhibit diffusive damage has been reported. The same result has been recently presented in
[15] for fibre-epoxy material that shows discrete cracking. Very recently, in [17] the authors have proved the existence
of an RVE for softening materials, for both adhesive and cohesive cracks, by deriving a traction-separation law from
the microscopic inelastic stresses and strains. However the method has been applied only to materials with a simple
microstructure undergoing discrete cracking.

In [18, 1], the authors have developed the MAD (Multiscale Aggregating Discontinuities) method in which a macro-
scopic crack is determined as equivalent to a bunch of microscale cracks. The method is however restricted to cases
where the separation-of-scales principle is violated for the micro sample had to match the macro element to which it
is linked. Computational multiscale methods to model cracks wherein the microstructural length scale is of the same
magnitude as the macroscopic length scale are also given in [19, 20].

In [21], the existence of an RVE for quasi-brittle materials (under tensile loading) with random complex hetero-
geneous microstructure exhibiting diffusive damage has been confirmed based upon a special averaging scheme, the
failure zone averaging scheme, which filters out the linear contribution of the micro sample.

In this manuscript departing from the result reported in [21], we are going to derive cohesive laws, which are
objective with respect to micro sample size, for softening materials with a random heterogeneous microstructure
subjected to tensile, shear and mixed-mode loading. It is confirmed that an RVE does exist for softening materials
with microstructures undergoing diffusive damage. We also present a computational framework to incorporate those
objective cohesive laws in an iterative FE2 setting which is an extension of the approach given in [17] for micro discrete
cracking failure to micro diffusive damage fracture. Although similar in some aspects, the major difference between

2



our work and [17] is two-fold. Firstly, the microstructure in this paper exhibits diffusive damage i.e., we homogenize
a macroscopic cohesive law from a microscale localization band. Secondly, the representativeness of the macroscale
cohesive law is obtained for materials with a random microstructure and under various loading conditions.

The structure of the paper is as follows. In Section 2, the investigated microstructures and the utilized continuum
damage model are given. Section 3 presents the standard averaging scheme, the proposed failure zone averaging
technique followed by a series of numerical simulations that confirm the existence of an RVE for softening materials.
The next section, section 4, describes the energetic equivalence theorems to link macroscopic and microscopic models.
The multiscale algorithm for adhesive and cohesive cracks is given in Section 5 followed by three numerical examples
given in Section 6.

2. Microstructures and Constitutive model

2.1. Microstructures

40 x 40 

40 x 20

20 x 20

Figure 1: Investigated three unit cells made of regular microstructure. All units are in mm.

In this paper, two microstructures are considered. The first one is a simple voided microstructure (radius of the void
equals 5 mm) of which three samples with dimensions 20× 20 mm2, 40× 20 mm2 and 40× 40 mm2 as shown in Fig.(1)
will be studied. The second type of microstructure that is analyzed in this contribution is a random heterogeneous
material which is a three-phase material with matrix, aggregates and an interfacial transion zone (ITZ) surrounding each
aggregate, see Fig.(2). Two samples of dimensions 15× 15 mm2 and 20× 20 mm2, as shown in Fig.(3), corresponding
to 45% aggregate volume fraction are investigated. Details on the generation procedure of these samples can be found
in [22]. Note that we have not considered bigger samples and different realizations since a statistical analysis of the
existence of an RVE for this kind of material has already been given in [21].

2.2. Constitutive model

Damage of the samples is modelled by a simple isotropic damage model regularized by the gradient enhanced
method [23]. For sake of completeness, this model is briefly summarized here. The stress-strain relation is given by
[24]

σ = (1− ω)De : ǫ (1)

3



itz

matrix

aggregate

Figure 2: Finite element mesh of the three-phase material sample: full view (left) and close-up view (right).

15× 15 mm2 20× 20 mm2

Figure 3: Two micro samples of random heterogeneous material (45% aggregate).

4



where ω is the scalar damage variable and the fourth order tensor De contains the elastic moduli. Damage is governed
by the following exponential law

ω = 1−
κ

κI
[1− α+ α exp−β(κ−κI)], κ ≥ κI (2)

where α (residual stress), β (softening slope) and κI (damage threshold) denote the inelastic parameters. The variable
κ is the largest nonlocal equivalent strain ǭeq ever reached. The nonlocal equivalent strain is defined according to an
implicit gradient enhanced damage formulation given in [23]

ǭeq − c∇
2ǭeq = ǫeq (3)

in which ǫeq is the Mazars local equivalent strain [25] and c is a positive valued parameter of dimension length squared.
For the voided microstructure, the material parameters include a Young’s modulus E of 25000 MPa, Poisson’s ratio

ν of 0.2, damage threshold κI of 3×10
−5, α = 0.999, β = 5000 and c = 3.5 mm2. For the heterogeneous material, the

material parameters are given in table 1.

Matrix Aggregate ITZ

E [N/mm2] 25000 30000 20000
ν [-] 0.2 0.2 0.2
κI [-] 5e-06 0.5 3e-06
α [-] 0.999 0.999 0.999
β [-] 1500 1500 1500
c mm2 0.2 0.2 0.2

Table 1: Material parameters of different phases of the random heterogeneous material.

3. Objective macroscopic cohesive laws

n

s

xm1

xm2

ū ūh

w

T

B

RL

Macro Micro mode I mode II

Figure 4: From left to right: macro sample with a crack, micro model, boundary conditions for tensile and shear loading. Periodic boundary
conditions on the bottom and top edges are denoted by dashed lines. Material periodicity is also considered.

Considering a macro crack with the outward unit normal denoted by n and the unit tangent vector represented by
s. A micro sample Ωm, which is a rectangle of dimension w × h, wherein the underlying microstructure is explicitly

5



modelled is associated to every integration point on the macro crack. Let us consider the case in which n coincides
with xm1 see Fig.(4) for the microscale orthogonal coordinate system. Since the deformation modes of the macro crack
include mode I opening and mode II shearing, the boundary conditions (BCs) of the micro model are the ones given
in Fig.(4) for mode I and mode II cases. For mixed-mode problems, BCs are the combination of BCs of mode I and
mode II. The external boundary of the micro sample is denoted by Γm which is composed of ΓT, ΓB, ΓL and ΓR.

3.1. Standard averaging techniques

The macroscopic homogenized stress σM is given by see [26]

σM ≡
1

wh

∫

Ωm

σmdΩ =
1

wh

∫

Γm

tm ⊗ xmdΓ

=
1

wh

∫

ΓR

tm ⊗ (xR − xL)dΓ +
1

wh

∫

ΓT

tm ⊗ (xT − xB)dΓ

(4)

where use was made of the anti-periodicity of the tractions. In this manuscript, subscripts �M and �m are used to
indicate if a quantity belongs to the macro or micro scale, respectively. The micro stress tensor, traction vector and
position vector are denoted by σm, tm and xm, respectively. Quantities associated to the top, bottom, left and right
edges of the micro sample are indicated by subscripts T, B, L and R, respectively, see Fig.(4).

By using the following relations

xR − xL = wn, xT − xB = hs (5)

Equation (4) becomes

σM =
1

h

∫

ΓR

tmdΓ⊗ n+
1

w

∫

ΓT

tmdΓ⊗ s (6)

Adopting the fact that nT = (1, 0) and sT = (0, 1), the above is simplified to

σM =






f intR,x
h

f intT,x
w

f intR,y
h

f intT,y
w




 (7)

where f intR and f
int
T are the sum of nodal internal forces along the right and top edges, respectively. Note that the

homogenized stress tensor is symmetric due to the rotational equilibrium of the micro sample i.e., wf intR,y = hf
int
T,x.

The homogenized strain tensor ǫM is given by see [26]

ǫM ≡
1

wh

∫

Ωm

ǫmdΩ =
1

wh

∫

Γm

(um ⊗
sym

n)dΓ (8)

where the divergence theorem was used to convert the domain integral to a surface integral. The operator ⊗sym denotes
the symmetrized dyadic product. The micro strain tensor and the displacement vector are represented by ǫm and um,
respectively.

6



The above can be more elaborated as

ǫM =
1

wh

{∫

ΓT

[(umT − u
m
B )⊗

sym
s] dΓ +

∫

ΓR

[(umR − u
m
L )⊗

sym
n] dΓ

}

=
1

h
ū⊗sym s +

1

w
ū⊗sym n

(9)

where use has been made of the periodicity of the displacement field in the last equality. In matrix form, the homogenized
strain tensor is given by

ǫM =





ūx
w

1

2

( ūx
h

+
ūy
w

)

sym.
ūy
h



 (10)

The macroscopic traction vector tM is assumed to be the projection of the macroscopic stress tensor on the crack
plane [13, 17]. That is

tM ≡ σM · n =
f intR
h

(11)

where use was made of Eq.(7).
The homogenized stress-strain (σxM,ǫ

x
M) curves as well as the traction-displacement (t

x
M, ūx) diagrams of the three

voided samples (see Fig.(1)) subjected to a tensile loading are given in Fig.(5). The result on the left shows that
for bulk homogenization, the linear elastic response is objective to the micro model size (due to the fact that the
elastic slope of the stress-strain curves is the Young’s modulus E in one dimension) and the softening branches are,
however, micro model size dependent. For a complete analysis on the sample size dependency of the homogenized
stress-strain diagrams for quasi-brittle materials with a random microstructure, see [11]. On the contrary, for interface
homogenization [15, 14]5, the linear response is inversely proportional to the width of the sample i.e., being E/w for
one dimensional problems. Obviously, both bulk and interface homogenizations based on standard averaging theorems
give results which are not objective to the micro sample size. Figure (6) shows the damage distribution in the samples.

Remark 3.1. We have introduced a numerical imperfection to trigger localization at the left voids in samples 40 × 20
mm2 and 40× 40 mm2, see Fig.(6). Note that our target material is a brittle random heterogeneous material, Fig.(2),
of which failure is accompanied with the occurrence of one propagating localization band, see Fig.(7) (no numerical
imperfection is needed here). The voided microstructure merely serves as an exemplary material to illustrate our ideas
with very low computational cost. The introduction of artificial imperfections for voided samples is just to mimic
the behaviour of real random heterogeneous materials. Note that the 40 × 20 mm2 and 40 × 40 mm2 samples have
the same bifurcated solutions, thus the same homogenized response and the 20× 20 mm2 sample captures a different
bifurcated path, thus a different homogenized response, Fig.(5). However, as demonstrated in [21] (see also Fig.(8)b),
the homogenized macroscopic response is size-independent when a proper averaging technique is used even though the
samples follow different bifurcation paths. The discussion of bifurcated solutions at the microscale is beyond the scope
of this manuscript. Refer to [27] for a related discussion.

5By interface homogenization, the homogenized quantities are the traction and the displacement of the right edge.

7



 0

 0.05

 0.1

 0.15

 0.2

 0.25

 0.3

 0.35

 0.4

 0.45

 0.5

 0  0.02  0.04  0.06  0.08  0.1  0.12  0.14

st
re

ss
 [
M

P
a
]

strain [-] (x10-3)

20x20
40x20
40x40

(a) stress-strain

 0

 0.1

 0.2

 0.3

 0.4

 0.5

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9

tr
a
ct

io
n
 [
M

P
a
]

displacement [mm] (x10-2)

20x20
40x20
40x40

(b) traction-displacement

Figure 5: Three voided samples in tension: bulk vs interface homogenization.

Figure 6: Damage patterns of three samples under horizontal tensile loading.

8



3.2. Failure zone averaging technique

In [21], the authors have proposed a special averaging scheme which was named failure zone averaging scheme with
which the existence of an RVE for random heterogeneous quasi-brittle materials in softening regime has been proved.
For the sake of completeness, this averaging scheme is described shortly. Let us first denote Ωd as the active damaged
domain i.e., the region containing Gauss points which are damaged and loading. According to the continuum damage
model, this domain corresponds to Gauss points satisfying κ > κI and f = 0 (f is the loading function), see Fig.(7)
for a graphical illustration. We define the homogenized stresses and strains as the volume averages of the microscopic
stresses and strains, respectively, over Ωd rather than over Ωm

〈σ〉dam =
1

|Ωd|

∫

Ωd

σmdΩd

〈ǫ〉dam =
1

|Ωd|

∫

Ωd

ǫmdΩd

(12)

where |·| denotes the measure of the domain. Since the above domain integrals cannot be converted to surface integrals
along Γm

6, they are computed directly using numerical quadrature. This averaging will filter out the linear contribution
which makes the standard stress-strain diagrams micro-sample size dependent.

Ωe

Ωd

Ωdu

Figure 7: Definition of the damage domain Ωd over which the averages are performed: Ωd = Ωm \ Ωe(elastic) \ Ωdu(unloading damaged).

In Fig.(8) the homogenized stress-strain diagrams of the three voided samples (see Fig.(1)) obtained with the
standard averaging scheme (left) and the new failure zone averaging method (right) are given. Figure (8a) clearly
demonstrates that for softening regime there is no unique size of an RVE- a result reported in [28, 11]. However, Fig.(8b)
shows that the stress-strain curves are independent of the micro sample size which in turn means that there exists an
RVE for softening materials if the stresses and strains have been defined using the proposed failure zone averaging.
Note that the absence of a linear branch in the presented curves is due to the fact that the failure zone averaging
should only be used after development of a failure band. Based on this observation plus a statistical analysis presented
in [21], the authors have confirmed the existence of an RVE for quasi-brittle materials with random heterogeneous
microstructure that exhibit localized failure with a continuum damage model.

6Note that using standard averaging, see section 3.1, the homogenized quantities are directly related to the micro quantities on the
boundary.

9



 0

 0.05

 0.1

 0.15

 0.2

 0.25

 0.3

 0.35

 0.4

 0.45

 0.5

 0  0.02  0.04  0.06  0.08  0.1  0.12  0.14

st
re

ss
 [
M

P
a
]

strain [-] (x10-3)

20x20
40x20
40x40

 0

 0.2

 0.4

 0.6

 0.8

 1

 1.2

 0  0.05  0.1  0.15  0.2  0.25  0.3

st
re

ss
 [
M

P
a
]

strain [-] (x10-3)

20x20
40x20
40x40

Figure 8: Responses of micro samples of regular microstructure obtained with the standard averaging (left) and the failure zone averaging
(right).

3.3. Traction-separation law

In the previous section we have shown that, by performing the averaging over the active damaged domain Ωd,
homogenized stress-strain curves can be obtained which are objective with respect to micro sample size. In what
follows, we are going to present a method to extract a macroscopic cohesive law from the microscopic response in the
active damaged domain which is independent of the micro sample size.

To this end, let us first define the displacements due to damage udam as follows

udam = 〈ǫ〉dam · (ln) (13)

where l is the averaged width of the localization band which is equal to |Ωd| /h, see section 4 for the definition of l.
Figure (9) plots the traction versus the damage opening (txM, u

x
dam) curves

7 for the three voided samples in tension
which are obviously independent of the sample sizes. It should be noticed that this conclusion applies only for the
portion of the curves after the peak. We therefore define the macro crack opening [[u]]M as the damage opening udam
shifted to the left by an amount of ůdam which is the damage opening corresponding to the maximum traction

[[u]]M = udam − ůdam (14)

to obtain initially rigid macroscopic traction-opening relations.
Figure (10) reveals the fact that the traction-opening (txM, [[u]]

x
M)

8 relation is unique regardless of the sample size
which is a result recently reported by [17] for microstructures exhibiting discrete cracking. Note the similarity of
Eq.(14) with equation (19) in [17] that defines the macro opening displacement as the non-elastic part of the micro
displacement. However the result here holds for a continuum damage model which is relevant for many softening
materials.

At first glance this result might seem surprising since the traction tM reflects the tensile stress level at the whole
micro sample while the failure displacement udam is only evaluated at the area of damage growth. Nevertheless, it can
be explained in a rigorous manner by a proper energetic equivalence theorem which is given in section 4.

7The traction-displacement diagrams, already shown in Fig.(5), are re-given here to compare interface homogenization with the proposed
scheme.

8We have shown again the (tx
M
, ux

dam
) curves already presented in Fig.(9) so that the procedure from udam to [[u]]M can be easily followed.

10



 0

 0.1

 0.2

 0.3

 0.4

 0.5

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9

tr
a
ct

io
n
 [
M

P
a
]

displacement [mm] (x10-2)

20x20
40x20
40x40

 0

 0.1

 0.2

 0.3

 0.4

 0.5

 0  0.05  0.1  0.15  0.2  0.25  0.3  0.35  0.4  0.45  0.5

tr
a
ct

io
n
 [
M

P
a
]

opening [mm] (x10-2)

20x20
40x20
40x40

Figure 9: Three voided samples in tension: traction vs. applied displacement (left) and traction vs. normal damage displacement ux
dam

(right).

 0

 0.1

 0.2

 0.3

 0.4

 0.5

 0  0.05  0.1  0.15  0.2  0.25  0.3  0.35  0.4  0.45  0.5

tr
a
ct

io
n
 [
M

P
a
]

opening [mm] (x10-2)

20x20
40x20
40x40

 0

 0.1

 0.2

 0.3

 0.4

 0.5

 0  0.05  0.1  0.15  0.2  0.25  0.3  0.35  0.4  0.45

tr
a
ct

io
n
 [
M

P
a
]

opening [mm] (x10-2)

20x20
40x20
40x40

Figure 10: Traction vs. crack opening displacement diagrams. Left: standard one (computed directly from Eq.(13)) and right, shifted one
obtained with Eq.(14).

11



3.4. Samples under shear and mixed mode loading

The above analysis is repeated now for the three voided samples (see Fig.(1)) under shear loading, refer to Fig.(11)
for the damage distribution on the deformed configuration. The result for shear loading is given in Fig.(12) in which the
top figures show results corresponding to the standard averaging scheme whereas the bottom figures show the responses
obtained with the failure zone averaging scheme. It is observed once again that using the standard averaging technique,
both stress-strain (bulk homogenization) and traction-separation (crack homogenization) diagrams are sample size
dependent. On the contrary, when the failure zone averaging scheme is used, both the stress-strain and traction-
separation curves are independent of the sample size or equivalently an RVE does exist for softening materials under
shear loading.

Figure 11: Damage patterns of three voided samples under shear loading (magnification factor of 50).

Next, mixed mode loading (a displacement (ūx, ūy) was imposed on the right edge of the micro sample) has also
been performed for these three samples of which the result is given in Fig.(13) wherein the first row shows the result
of mode I whereas the second row gives the behavior of mode II. It is observed once again that the traction-separation
curves are independent of the sample size.

3.5. Existence of an RVE for materials with random microstructure

The analysis is finally applied to the two samples with random complex microstructure, see Fig.(3), for both tensile
and shear loading conditions. The results given in Fig.(14) and Fig.(15) confirm the independence of the homogenized
response with respect to the sample size if the failure zone averaging was used to extract only the inelastic responses
occurring in the samples. Please refer to [21] for a statistical study on the existence of an RVE for this material under a
tensile loading condition. For shear loading further studies for more samples in combination with a statistical analysis
would be necessary to prove the applicability of the proposed averaging technique. In Fig.(16) typical damage patterns
in the samples are given.

4. Energetic equivalence theorem

Fracture can occur inside the bulk of the material or along the interface between two different materials. For the
former, the fracture surface is termed a cohesive crack whereas for the latter, the term adhesive (or interfacial) crack
is used. For the case of cohesive cracks, homogenization is applied to a finite element model representing the bulk
material around the crack. In the case of adhesive cracks, the adopted micro model represents the material in the
adhesive layer. This section develops the link between macro and micro models for both cohesive and adhesive cracks.

4.1. Cohesive cracks

In section 3.2 the objectivity of the (〈σ〉dam, 〈ǫ〉dam) curves has been demonstrated via numerical experiments. We
have shown that the (tM,udam) diagrams are independent of the micro sample size as well. In what follows, we are going
to prove mathematically the representativeness of (tM,udam) diagrams providing the objectivity of (〈σ〉dam, 〈ǫ〉dam)

12



 0

 0.1

 0.2

 0.3

 0.4

 0  0.05  0.1  0.15  0.2  0.25  0.3

sh
e
a
r 

st
re

ss
 [
M

P
a
]

shear strain [-] (x10-3)

20x20
40x20
40x40

(a) Stress-strain

 0

 0.1

 0.2

 0.3

 0.4

 0  0.2  0.4  0.6  0.8  1  1.2  1.4  1.6
sh

e
a
r 

tr
a
ct

io
n
 [
M

P
a
]

displacement [mm] (x10-2)

20x20
40x20
40x40

(b) Traction-displacement

 0

 0.1

 0.2

 0.3

 0.4

 0.5

 0.6

 0  0.2  0.4  0.6  0.8  1

sh
e
a
r 

st
re

ss
 [
M

P
a
]

shear strain [-] (x10-3)

20x20
40x20
40x40

(c) Failure stress-strain

 0

 0.1

 0.2

 0.3

 0.4

 0  0.2  0.4  0.6  0.8  1

sh
e
a
r 

tr
a
ct

io
n
 [
M

P
a
]

sliding [mm] (x 10-2)

20x20
40x20
40x40

(d) Traction-sliding

Figure 12: Behaviour of three voided samples under shear loading. In the first row, standard homogenization for bulk and crack whereas in
the second row, failure zone averaging scheme for bulk and crack.

13



 0

 0.02

 0.04

 0.06

 0.08

 0.1

 0.12

 0.14

 0  0.05  0.1  0.15  0.2  0.25  0.3

20x20
40x20
40x40

 0

 0.1

 0.2

 0.3

 0.4

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7

20x20
40x20
40x40

 0

 0.02

 0.04

 0.06

 0.08

 0.1

 0.12

 0.14

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7

20x20
40x20
40x40

 0

 0.1

 0.2

 0.3

 0.4

 0  0.05  0.1  0.15  0.2  0.25  0.3

20x20
40x20
40x40

ūx [mm] (×10
−2)

ūy [mm] (×10
−2)

tx M
[M

P
a
]

tx M
[M

P
a
]

ty M
[M

P
a
]

ty M
[M

P
a
]

[[u]]xM [mm] (×10
−2)

[[u]]
y
M [mm] (×10

−2)

Figure 13: Three voided samples under mixed mode loading: standard averaging versus failuze zone averaging, for x-component (top) and
for y-component (bottom).

14



 0

 0.02

 0.04

 0.06

 0.08

 0.1

 0.12

 0.14

 0.16

 0  0.05  0.1  0.15  0.2  0.25  0.3  0.35  0.4

st
re

ss
 [
M

P
a
]

strain [-] (x10-3)

15x15
20x20

(a) stress-strain

 0

 0.02

 0.04

 0.06

 0.08

 0.1

 0.12

 0.14

 0.16

 0  0.1  0.2  0.3  0.4  0.5  0.6

tr
a
ct

io
n
 [
M

P
a
]

opening [mm] (x10-2)

15x15
20x20

(b) traction-opening

Figure 14: Bulk versus crack homogenization for random microstructure under tensile loading.

 0

 0.02

 0.04

 0.06

 0.08

 0.1

 0.12

 0.14

 0  0.2  0.4  0.6  0.8  1

st
re

ss
 [
M

P
a
]

strain [-] (x10-3)

15x15
20x20

(a) stress-strain

 0

 0.02

 0.04

 0.06

 0.08

 0.1

 0.12

 0.14

 0  0.2  0.4  0.6  0.8  1  1.2  1.4

tr
a
ct

io
n
 [
M

P
a
]

opening [mm] (x10-2)

15x15
20x20

(b) traction-opening

Figure 15: Bulk versus crack homogenization for random microstructure under shear loading.

Figure 16: Damage patterns in random heterogeneous samples under tension. Note that the failure bands are periodic.

15



Ωd

w

h

l

σm, ǫm

〈σ〉lin,

〈ǫ〉lin

〈σ〉dam, 〈ǫ〉dam tM,udam

Heterogeneous failure band Equivalent failure band Equivalent crack

Figure 17: From localization band to equivalent crack via energetic equivalence consideration.

curves (which have been demonstrated extensively in [21], see also Fig.(8)). To this end, we need to prove the following
equation

〈σ〉dam : 〈ǫ〉damlh = tM · udamh (15)

where the left hand side is the energy dissipated in the active damage zone Ωd and the right hand side is the dissipated
energy of the equivalent macro crack. Note that l is the width of the equivalent failure band which is equal to |Ωd| /h,
see Fig.(17).

The proof of the above is as follows. The right hand side of the above equation can be elaborated as

tM · udamh = [〈σ〉dam · n] · [〈ǫ〉dam · n]lh

= σdamij ǫ
dam
ik njnklh

= σdamij ǫ
dam
ik δjklh = σ

dam
ij ǫ

dam
ij lh

(16)

where use was made of Eq.(13) and the fact that tM equals 〈σ〉dam ·n due to equilibrium, see Fig.(18). In the above, δjk
is the Kronecker delta tensor9. Comparing the above with the left hand side of Eq.(15) concludes the proof. According
to Fig.(17), this proof corresponds to the transition from the equivalent failure band to the crack.

Applying the Hill-Mandel theorem [29] to the active damaged domain Ωd, we can write

1

|Ωd|

∫

Ωd

σm : δǫmdΩd = 〈σ〉dam : δ〈ǫ〉dam (17)

note that the above equation was obtained by considering Ωd as an independent domain. Since a mathematical proof
of the above equation is missing, we present numerical evidence of the validity of Eq.(17) in section 4.3. Using Eq.(15),
the above becomes

1

wh

∫

Ωd

σm : δǫmdΩd =
1

w
tM · δudam (18)

9We have switched the position of the subscript dam to superscript when indicial notation was used for convenience of reading.

16



〈σ〉dam

〈σ〉dam · n

n

tM

Figure 18: Equilibriuum of forces results in tM = 〈σ〉dam · n. Note that this relation is only used to prove Eq.(15).

The LHS of the above can be written as the difference between the virtual work of the whole micro sample and the
linear virtual work. Therefore, we can write

1

wh

∫

Ωm

σm : δǫmdΩm −
1

wh

∫

Ωl

σm : δǫmdΩl =
1

w
tM · δudam (19)

where Ωl is the linear domain i.e., Ωl = Ωm \ Ωd.
Using the virtual work equation for the first term of the above equation and the Hill-Mandel condition for the

second term, Eq.(19) can be rewritten as

1

wh

∫

Γm

tm · δumdΓ−
w − l

w
〈σ〉lin : δ〈ǫ〉lin =

1

w
tM · δudam (20)

where the homogenized linear stresses and strains 〈σ〉lin and δ〈ǫ〉lin are given by

〈σ〉lin =
1

(w − l)h

∫

Ωl

σmdΩl

δ〈ǫ〉lin =
1

(w − l)h

∫

Ωl

δǫmdΩl

(21)

In order to compute the term 〈σ〉lin : δ〈ǫ〉lin, considering a rectangular homogeneous sample subjected to a traction
tM on the right edge. The stresses in that sample are given by

〈σ〉linxx = t
x
M, 〈σ〉

lin
yy = 0, 〈σ〉

lin
xy = t

y
M (22)

The above equation expressed in matrix-vector notation by using Voigt notation becomes





〈σ〉linxx
〈σ〉linyy
〈σ〉linxy



 =





1 0
0 0
0 1





[
txM
t
y
M

]

≡ ∆tM (23)

or in tensor notation as

〈σ〉lin = ∆ · tM (24)

with the third-order tensor ∆ = n⊗ n⊗ n+ (n⊗ s+ s⊗ n)⊗ s, which was firstly given in [17].

17



Now, 〈σ〉lin : δ〈ǫ〉lin can be written as

〈σ〉lin : δ〈ǫ〉lin = 〈σ〉lin : D
−1
lin : δ〈σ〉lin

= (∆ · tM) : [D
−1
lin : (∆ · δtM)]

= tMp
[
∆ijp(D

lin
ijkl)

−1∆klm
]
δtMm

= tMp (∆pji(D
lin
jikl)

−1∆klm
︸ ︷︷ ︸

Clin
pm

)δtMm = tM ·Clin · δtM

(25)

Note that the second-order tensor Clin is the projection on the crack plane of the fourth-order compliance tensor D
−1
lin

[17]. In the above derivation, the minor symmetry of D−1lin was used.
Substituting Eq.(25) into Eq.(20) yields

1

wh

∫

Γm

tm · δumdΓ =
w − l

w
tM ·Clin · δtM +

1

w
tM · δudam (26)

or

1

w
tM · δuR =

w − l

w
tM ·Clin · δtM +

1

w
tM · δudam (27)

where the boundary conditions shown in Fig.(4) were adopted to compute the LHS of Eq.(26). In the above, uR is the
displacement vector of the right edge of the micro sample. The fact that the above holds true for any tM yields

δuR = (w − l)Clin · δtM + δudam (28)

The above can be rewritten as

δuR = (w − l)C0 · δtM + δudam + δůM (29)

with C0 being the second-order compliance tensor C but now evaluated in the undeformed microscale configuration
and δůM given by

δůM = (w − l)[Clin −C0] · δtM (30)

After a localization band has been formed, the nonlinear part of the total microscale displacement uR is assumed to
be completely governed by the damage opening udam. In other words, δůM = 0, hence Eq.(29) becomes

δuR = (w − l)C0 · δtM + δudam (31)

Using Eq.(14), the equation can be rewritten as follows

uR = (w − l)C0 · tM + [[u]]M + ůdam (32)

The above equation provides the scale transition relation from microscale responses to the macroscale cohesive law
(traction tM and separation [[u]]M). Note that for the case in which the micro sample undergoes discrete cracking
(l = 0), the above reduces to Eq.(17) given in [17].

18



macro micro

case I case II

w = tadh w < tadhtadh

Figure 19: Schematic representation of the homogenization schemes for adhesive cracks with thickness tadh. Case I refers to micro samples
having w = tadh whereas Case II corresponds to micro samples having w < tadh. Periodic BCs are denoted by dashed lines.

4.2. Adhesive cracks

There are two ways in which homogenization schemes for an adhesive crack can be developed, see Fig.(19). According
to the first way the micro sample width is chosen to be equal to the thickness of the adhesive crack tadh, referred to
as case I in Fig.(19). The authors in [17] have proposed the second approach in which the micro sample width can be
smaller than the adhesive crack thickness, referred to as case II in Fig.(19).

4.2.1. Case I

In this case, the micro model covers the complete thickness of the adhesive and crack the displacement of the micro
model uR can be directly related to the macro jump via

uR = [[u]]M (33)

The above is used as BCs for the micro model. After solving the micro model, the macro traction tM is given by
Eq.(11), see [15, 17].

4.2.2. Case II

In case the adhesive crack tadh is considerably larger than its microstructural constituents and additionally the
geometry in the thickness direction is periodic, the homogenization can be applied to a micro model having a width
smaller than tadh. The homogenization relation for a cohesive crack, Eq. (32) can be modified for the case of an
adhesive crack with thickness tadh as follows. When w = tadh, we have uR = [[u]]M, hence Eq.(32) becomes

[[u]]M = (tadh − l)C0 · tM + [[u]]M + ůdam (34)

solving for ůdam and substituting it into Eq.(32) yields

uR = (w − tadh)C0 · tM + [[u]]M (35)

which provides the homogenization relation between microscale information and the macroscale cohesive law (tM, [[u]]M).
Note that this equation resembles Eq.(35) in [17].

19



Remark 4.1. Homogenization scheme for case I is similar to a homogenization scheme for the bulk material, see Fig.(21).
The result obtained with this scheme is referred to as the reference solution. Case II is a homogenization scheme that
adjusts the solution of a smaller micro model to match the reference solution. Apparently those homogenization schemes
do not use the failure zone averaging technique since the entire response of the micro model is mapped to the macro
adhesive crack.

Remark 4.2. Since both homogenization schemes, case I and case II, should yield the same result, one might argue
that case I is sufficient. The use of case II, however, offers the following benefits

• a smaller micro sample results in less computational efforts;

• a smaller micro sample could minimize the possibility of microstructural snapback appearances, thus increase the
robustness of the method.

4.3. Numerical verification of Equation 17

Equation (17) can be rewritten as 〈σm : δǫm〉dam = 〈σ〉dam : δ〈ǫ〉dam which states that the volume average (over Ωd)
of the microscopic work equals the work done by the averaged (over Ωd) stresses and strains. Although this equation
bears similarity with the Hill-Mandel theorem which is used in standard homogenization schemes, we are currently
unable to provide a rigorous proof for it. Instead, we present numerical evidences of the satisfaction of Eq.(17) as shown
in Fig.(20). Two samples, of which one has a periodic microstructure and the other has a random microstructure, are
analyzed in a uni-axial tension test. The considered material is the three-phase material described in Section 2.1. It is
seen that Eq.(17) is practically verified.

 0

 2

 4

 6

 8

 10

 12

 14

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8

w
o

rk
 [

-]
 (

x1
0

-6
)

strain [-] (x10-3)

averaged work
work of averages

〈σm : δǫm〉dam

〈σ〉dam : δ〈ǫ〉dam

(a) periodic microstructure

 0

 5

 10

 15

 20

 25

 30

 35

 40

 45

 0  0.5  1  1.5  2  2.5

w
o

rk
 [

-]
 (

x1
0

-6
)

strain [-] (x10-3)

averaged work
work of averages

〈σm : δǫm〉dam

〈σ〉dam : δ〈ǫ〉dam

(b) random microstructure

Figure 20: Numerical evidences of Equation (17).

5. Computational multiscale crack modelling

In the previous sections it has been shown that traction-separation laws which are objective to the micro model
size are obtained for materials with simple underlying microstructure and complex random microstructure under
various loading conditions including tensile, shear and mixed-mode loading. These cohesive laws can be utilized in
two ways, either in sequential homogenization schemes or in semi-concurrent homogenization methods e.g., in a FE2

20



Bulk homogenization

Cohesive crack homogenization

Adhesive crack homogenization

ǫM σM,DM
tM,TM

tM,TM

[[u]]M

[[u]]M, tM

h

h

Figure 21: Schematic presentation of bulk homogenization, adhesive crack homogenization and cohesive crack homogenization. The first
two cases are typical in the sense of an FE2 setting: the input for micro FE model is the macro kinematic variable and the output from
micro FE model is the work conjugated variable plus its tangent. However, for the cohesive crack, the input for micro FE model includes
the opening plus the traction which is solved for simultaneously with the micro displacements.

21



setting. According to the former, a micro model with properly chosen dimension which is determined, for example, by
the RVE’s size quantification procedure given in [22, 11, 30], is numerically loaded at different loading conditions, the
resulting cohesive laws are snapshot and later on used in a macroscopic FE computations as standard phenomenological
constitutive laws10. In the spirit of the latter, there is a direct coupling between macro model and micro models.
Figure (21) gives an schematic representation of existing computational homogenization methods for bulk material
[6, 7, 5, 8], material layers (or interfaces) [13, 15, 14, 12] and cohesive cracks [17]. This section presents computational
homogenization schemes for both cohesive and adhesive cracks using the homogenization relations developed in Section
4.

5.1. Adhesive crack homogenization-case I

Homogenization for material layers with w = tadh has firstly been discussed in [12] for small strain problems and
later in [13] for the case of finite deformations. In this section, an algorithm for small deformation is given in which a
detailed derivation of the tangent matrix is presented. We provide the tangent in a form which is readily incorporated
in computer codes (not the case in [13]).

In case of case I adhesive crack homogenization, Fig.(19), the 2× 2 cohesive tangent matrix TM-the tangent in rate
format of the macro cohesive law δtM = TMδ[[u]]M, is determined as follows.

For illustration assuming that there are only two nodes on the right edge, the traction rate defined in Eq.(11) then
becomes

[
δtxM
δt

y
M

]

=
1

h

[
δf

R,x
1 + δf

R,x
2

δf
R,y
1 + δf

R,y
2

]

=
1

h

[
1 0 1 0
0 1 0 1

]







δf
R,x
1

δf
R,y
1

δf
R,x
2

δf
R,y
2







(36)

From the converged linear system of the micro model Kδu = δf , the force along the right edge can be written as
K∗δuR = δfR, so the above becomes

[
δtxM
δt

y
M

]

=
1

h

[
1 0 1 0
0 1 0 1

]







K∗11 K
∗

12 K
∗

13 K
∗

14

K∗21 K
∗

22 K
∗

23 K
∗

24

K∗31 K
∗

32 K
∗

33 K
∗

34

K∗41 K
∗

42 K
∗

43 K
∗

44













δu
R,x
1

δu
R,y
1

δu
R,x
2

δu
R,y
2







(37)

where K∗ is the condensed stiffness matrix according to the degrees of freedom of the nodes along the right edge, see
[8] for a discussion on this static condensation procedure. Writing the displacements of the right edge in terms of the
macro opening displacement, we can write the above as

[
δtxM
δt

y
M

]

=
1

h

[
1 0 1 0
0 1 0 1

]

︸ ︷︷ ︸

MT







K∗11 K
∗

12 K
∗

13 K
∗

14

K∗21 K
∗

22 K
∗

23 K
∗

24

K∗31 K
∗

32 K
∗

33 K
∗

34

K∗41 K
∗

42 K
∗

43 K
∗

44













1 0
0 1
1 0
0 1







[
δ[[u]]xM
δ[[u]]

y
M

]

(38)

which obviously shows that the macro cohesive tangent matrix is given by

TM =
1

h
M

T
K

∗

M (39)

10They are known as micromechanically derived traction-separation laws.

22



Upon convergence of the micro FE model, the micro stiffness matrix K is statically condensed out to obtain the right
edge micro stiffness matrix K∗ and finally the above equation gives the macro cohesive tangent matrix.

For an iteration of a macroscopic load step, the procedure to compute the macro traction and macro material
tangent providing a macro opening displacements [[u]]M is given in Box (1).

Box 1 Adhesive crack homogenization-case I.

1. Given [[u]]M
2. Compute u = [[u]]M
3. Apply that displacement u on the RVE’s right edge

4. Solve the RVE problem ∗

5. Compute the macro traction using Eq.(11)

6. Compute the macro tangent using Eq.(39)

7. Go back to macro model and proceed as in standard FE

8. Upon macro model convergence, update the state of all micro models

∗ With its state (displacement and internal variables) being reset to its previous converged values.

5.2. Adhesive crack homogenization-case II

Given the macro opening displacements [[u]]M, the dimension (w, h) of the micro model and the adhesive thickness
tadh, the system of equations that we want to solve for um and tM is the following

fint(um) = fext(tM)

uR(um) = [w − tadh]C0tM + [[u]]M
(40)

in words, solving the micro equilibrium Eq.(40)1 satisfying the homogenization relation Eq.(35). In the above, fint and
fext are the micro internal and external force vector, respectively.

In [17] the above system was solved simultaneously for um and tM. This means that the sought-for macro traction
tM is the external force applied on the right edge of the micro sample and Eq.(40)2 is similar to the constraint
equation in arc-length control methods. The method can therefore be considered as a direct force-control computational
homogenization for crack modelling. In the current implementation, we follow a displacement-control procedure, as
presented in the sequel.

We model the elastic behavior of the crack as follows. Denoting the thickness of the macro crack tadh, then the
displacement imposed on the micro model reads uR = (w/tadh)[[u]]M

11. In this way, the macro linear response will be
objective to the micro sample size. The proof of the relation uR = (w/tadh)[[u]]M in the linear regime is as follows. In
terms of displacements, Eq.(40)2 is rewritten as

uR =
w − tadh

w
ulin + [[u]]M =

w − tadh
w

uR + [[u]]M (41)

where the fact that ulin = uR has been used. Solving the above equation for uR yields

uR =
w

tadh
[[u]]M (42)

11Note that the tangent given in Eq.(39) in this case is scaled by a factor of w/tadh.

23



which concludes the proof.
Whenever the peak at the micro model is observed, say by an appearance of one negative eigenvalue of the macro

tangentTM as proposed in [31], we switch to the use of the algorithm given in Box (2) as a kind of multiscale constitutive
box for the softening branch. As can be seen, the proposed scheme is an iterative displacement-control computational
homogenization scheme for modelling cracks. It should be emphasized that the iterative procedure converged in the
numerical simulations presented here. The appealing point of the iterative scheme compared to the force-control scheme
in [17] is that at the micro level, a standard FE procedure is readily reused which facilitates the incorporation of the
method in existing FE codes.

Box 2 Iterative displacement-control homogenization for adhesive cracks-case II.

1. Given [[u]]M and u
0
lin

∗

2. Compute ūR = [[u]]M +

(
w − tadh

w

)

u0lin

3. Apply that displacement ūR on the RVE’s right edge
∗∗

4. Solve the RVE problem

5. Compute the macro traction tM using Eq.(11)

6. Computing the linear displacement ulin = wC0tM, with C0 = ∆
T
D

−1
0 ∆

7. Check convergence

(a) computing the total micro displacement uR =
w − tadh

w
ulin + [[u]]M

(b) check ||uR − ūR|| < ǫ ||uR||. If no, go back to step 2 with u
0
lin = ulin. Else, proceed to step 8

8. Compute the macro material tangent using Eq.(39) and proceed as usual

∗ Superscript 0 denotes quantities of the previous converged macroscopic load step.
∗∗ The left edge is fixed whereas periodic boundary conditions are imposed on the top and bottom edges, see Fig.4.

In Box (2), ǫ is the convergence tolerance and D0 is the homogenized elasticity matrix which is computed, in a
pre-processing step i.e., before the multiscale problem starts, using the standard bulk homogenization method see, for
instance, [8].

5.3. Cohesive crack homogenization

The system of equations that needs to be solved for um and tM, given the macro jump [[u]]M and the compatibility
displacement ůdam, is

fint(um) = fext(tM)

uR(um) = [w − l(um)]C0tM + [[u]]M + ůdam
(43)

which consists of the micro equilibrium equation Eq.(43)1 and the homogenization relation Eq.(32).
Similar to the case of adhesive cracks presented in the previous section, the above system is solved by an iterative

displacement-control procedure as given in Box (3). This is not only because both adhesive and cohesive cracks can be
handled in a common displacement-control framework but also due to the dependency of the localization band width l
on the micro displacements um. Since we mainly focus on the extraction of objective cohesive laws from the responses
of the micro sample, the crack initiation/propagation is based on the macroscopic maximum principle stress criterion
and the crack growth direction is computed based upon the nonlocal stresses at the crack tip, see for instance [32], as
conventionally adopted in monoscale crack modelling. It should be noticed that in [20], the crack initiation and growth

24



direction have been based on microscopic responses. The iterative displacement-control procedure for cohesive cracks
is summarized in Box (3).

Box 3 Iterative displacement-control homogenization for cohesive cracks.

1. Run macro model until σI ≥ ασult, α ≈ 1.0

2. Insert a crack segment with a proper direction

(a) Initialize 2 micro models associated to 2 Gauss points on the crack segment
(b) Loading those 2 micro models up to σI via load control

∗

(c) Computing the initial damage opening ůdam
3. Given [[u]]M, u

0
lin and l

0 ∗∗

(a) Compute ūR = [[u]]M + ůdam +

(
w − l0

w

)

u0lin

(b) Apply that displacement ūR on the RVE’s right edge
(c) Solve the RVE problem
(d) Compute the macro traction tM using Eq.(11)
(e) Compute the linear displacement ulin = wC0tM, with C0 = ∆

T
D

−1
0 ∆

(f) Computing the new localization band width l = |Ωd| /h
(g) Check convergence

i. computing the total micro displacement uR = [[u]]M + ůdam +
w − l

w
ulin

ii. check ||uR − ūR|| < ǫ ||uR||. If no, go back to step 3b with ūR = uR. Else, proceed to step 4

4. Compute the macro material tangent using Eq.(39) and proceed as usual.

∗ This is achieved by subdividing σI into a number of small load steps.
∗∗ Superscript 0 denotes quantities of the previous converged macroscopic load step.

In Box (3), the macroscopic maximum principal stress was denoted by σI and σult is the ultimate strength of the
material which is, in a multiscale framework, the ultimate load of the microscale model (this quantity is currently
determined by loading first the micro sample in a pre-processing step). The crack initiation equation σI ≥ ασult,
α ≈ 1.0, as proposed by [17], ensures that the time continuity condition [33] is fulfilled (thus enhance the robustness of
the crack growth algorithm) and more importantly the solution procedure for the micro models will not diverge. The
proposed algorithm can be incorporated in any numerical codes with the capacity to model cracks e.g., PUM-based
(Partition of Unity) enrichment finite elements [34, 32].

The macroscopic bulk behaves elastically with effective properties computed based on numerical homogenization
applied to the micro samples. Given the strain vector, the macroscopic stress vector is thus given by

σM = D0ǫM (44)

5.4. Some algorithmic aspects

For a robust and efficient implementation of the proposed multiscale framework, some algorithmic aspects have to
be considered. Since in [17] related details have already been given, in this section we only discuss some techniques
in order to have a robust multiscale scheme. It is likely that in a FE2 simulation divergence of one (or more) micro
problem(s) will occur. Straightforward remedies of this problem could be either (i) resolving the macro load step which
led to a micro divergence with a smaller step size or (ii) sub-stepping the imposed displacement ūR into a number of
smaller steps. In the current implementation, we are using the latter option. The sub-stepping scheme discussed in

25



[35] could be another option worth to be considered. Needless to say, a comparison study, say by means of numerical
experiments, of those techniques would be necessary to choose the most efficient one and is a topic of further study.
It is emphasized that the proposed scheme cannot deal with the snapback behavior occurring at the micro models12.
Macroscopic snapback can however be handled by, for instance, the energy-based arc-length control given in [36].

6. Benchmark problems

6.1. Adhesive crack

Figure (22) gives a benchmark problem for verifying the proposed multiscale scheme. The aim is to check whether
the macroscopic response is objective to the micro sample size. The material parameters of the micro model are given
in section 2.2. The macro bulk material is an elastic material with Young’s modulus of 25000 N/mm2 and Poisson’s
ratio of zero. Note that in contrary to the cohesive crack, for an adhesive crack, the macroscopic bulk is not related
to the microstructure of the adhesive crack. A plane stress condition is assumed for the macro model and the micro
models as well. The thickness of the interface tadh is assumed to be 40 mm.

ū

w
=

2
0
0
m
m

h = 100 mm

20× 20

40× 20

40× 40

Figure 22: Crack modelling by interface elements. Cohesive law extracted from micro FE computations whereas bulk material obeys a
phenomenological linear elastic constitutive law.

Using the case I adhesive crack homogenization scheme given in Box (1), the macroscopic load-displacement diagrams
corresponding to the 40×20 and 40×40 samples (note that the sample 20×20 cannot be used in this case) are given in
Fig.(23)-left. The responses are obviously objective to the micro sample size. Figure (23)-right presents the macroscopic
responses for all three samples using the new iterative homogenization scheme given in Box (2). The results are
practically coincident. It has been observed that for one macroscale Newton-Raphson iteration, the iterative scheme
(Box (2)) has converged in two to four iterations with a tolerance of ǫ = 10−4. Far from the peak, when the contribution
of elastic processes becomes negligible, the number of required iterations is usually only one or two.

12It is however noticed that snapback is not likely to occur in the micro samples.

26



 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 0  0.2  0.4  0.6  0.8  1

lo
a
d
 [
N

]

displacement [mm] (x10-2)

40x20 
40x40 

 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 0  0.2  0.4  0.6  0.8  1
lo

a
d
 [
N

]
displacement [mm] (x10-2)

20x20
40x20
40x20

 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7

lo
a
d
 [
N

]

displacement [mm] (x10-2)

40x20 
40x40 

 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 0  0.1  0.2  0.3  0.4  0.5  0.6  0.7

lo
a
d
 [
N

]

displacement [mm] (x10-2)

20x20
40x20
40x20

Figure 23: Adhesive crack benchmark problem: macroscopic load displacement (ū) curves obtained with the standard scheme (left) and the
iterative displacement-control homogenization scheme (right). Top figures correspond to ductile fracture (β = 3000) and the bottom one
for brittle fracture (β = 5000).

27



6.2. Cohesive crack

Figure (24) depicts a simple crack growth simulation problem, a bar in uniaxial tension which is discretized by
3 four-node quadrilateral elements. Refer to section 2.2 for the material parameters of the micro models (except
β = 1000). When the maximum principal stress in the bar exceeds 0.4475 MPa, 95% the micro model ultimate load
σult , a vertical crack is, due to symmetry, inserted in the middle element. The behavior of that crack is governed by
one of the three microstructures as shown in Fig.(24). A plane stress condition is assumed for the micro models. The
aim of the example is to verify the objectivity of the macroscopic responses with respect to the utilized microstructures.

ū2
0
0

10010 10

20× 20

40× 20

40× 40

Figure 24: Cohesive crack modelling by PUM with cohesive law coming from microscopic FE computations. Due to symmetry, a vertical
crack (dashed line) is inserted in the middle element upon violation of the fracture criterion. All units are in mm.

Figure (25) presents the macroscopic load-displacement (ū) curves which are clearly independent of the microstruc-
tures used to obtain the homogenized macroscopic cohesive laws shown in the right figure. Note that since the macro
crack was inserted slightly before the ultimate load of the micro models, the homogenized cohesive laws are not ini-
tially rigid as conventional cohesive models. We have also analyzed the effect of the α parameter used in the crack
initiation/propagation criterion σI ≥ ασult on the overall macroscopic response. The result, reported in Fig.(26) for
the 20×20 sample, shows that there is hardly any considerable effect of this parameter on the overall behavior of the
macroscopic sample. The observed load drops in the macroscopic load-displacement diagrams are due to the fact that
the microscopic dimensions are of the same magnitude with the macroscopic one.

6.3. Verification of the method against DNS

To verify the proposed multiscale method, let us consider the example shown in Fig.(27) of which the solution
obtained with the multiscale model is going to be compared with the one obtained with the DNS . The shaded region
is modelled as a damageable material (material parameters can be found in section 2.2 except β = 3000) whereas the
rest behaves elastically. The finite element mesh of the DNS model is given in Fig.(28).

In case that the shaded region represents the microstructure of a material layer of thickness tadh = 20 mm, the
finite element mesh for the multiscale model (adhesive crack-case I) is given in Fig.(29). The adequacy of the multiscale

28



 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 100

 0  0.5  1  1.5  2  2.5

lo
a

d
 [

N
]

displacement [mm] (x 10-2)

20x20
40x20
40x40

 0

 0.1

 0.2

 0.3

 0.4

 0.5

 0  0.5  1  1.5  2  2.5

tr
a
ct

io
n
 [
N

]

opening [mm] (x 10-2)

20x20
40x20
40x40

Figure 25: Cohesive crack problem: objective macroscopic load-displacement diagrams obtained with various microstructures (left) and
homogenized traction-opening laws (right).

 0

 10

 20

 30

 40

 50

 60

 70

 80

 90

 100

 0  0.5  1  1.5  2  2.5

lo
a
d
 [
N

]

displacement [mm] (x 10-2)

α=0.95
α=0.99

 80

 82

 84

 86

 88

 90

 92

 94

 0.3  0.35  0.4  0.45  0.5  0.55

lo
a
d
 [
N

]

displacement [mm] (x 10-2)

α=0.95
α=0.99

Figure 26: Cohesive crack problem: consequences of the crack initiation moment on the overall macroscopic response (left) and close-up
view (right).

29



1
0
0

ū

4040 20

Figure 27: Verification test: geometry and boundary conditions. All units are in mm.

solution can be judged from Fig.(30) which presents the comparison of load-displacement curves between the multiscale
(denoted as FE2) simulation and the DNS. The multiscale solution captures the peak load and later stages well with
a much lower computational time (in this particular example the DNS simulation time is approximately 10 times the
one of the multiscale method).

Figure 28: Verification test-DNS model: finite element discretization (14024 bilinear elements).

For the multiscale cohesive crack homogenization scheme, the finite element discretizations for the macro and micro
models are presented in Fig.(31). The adequacy of the multiscale solution can be judged from Fig.(32) which compares
the load-displacement curve of the multiscale model to that of the DNS model. The multiscale solution captures the
peak load and later stages well. The DNS simulation requires approximately 6 times the computation time of the
multiscale model. It is emphasized that for problems in which the crack path is not known a priori, the use of DNS is
impractical since the microstructure has to be resolved everywhere which leads to prohibitive computational expense.

30



1
0
0

4040

20× 20

Figure 29: Verification test-Multiscale model (adhesive crack): finite element discretization (2 bilinear elements and one linear interface
element) of the coarse scale model and a typical fine scale model (512 bilinear elements).

 0

 5

 10

 15

 20

 25

 30

 35

 40

 45

 0  0.002  0.004  0.006  0.008

lo
a
d
 [
N

]

displacement [mm]

DNS
FE2

Figure 30: Verification test: comparison of load-displacement curves between the DNS and the multiscale-case I adhesive crack scheme.

c

a b a

20× 20

Figure 31: Verification test-Multiscale model (cohesive crack): finite element discretization (3 bilinear elements) of the coarse scale model
and a typical fine scale model (512 bilinear elements).

31



 0

 5

 10

 15

 20

 25

 30

 35

 40

 45

 0  0.002  0.004  0.006  0.008
lo

a
d
 [
N

]

displacement [mm]

DNS
FE2

Figure 32: Verification test: comparison of load-displacement curves between the DNS and the multiscale cohesive crack scheme.

7. Conclusions

In this contribution macroscopic cohesive laws (both mode I and mode II), which are independent of the micro
sample size, were obtained for quasi-brittle materials with a random heterogeneous microstructure under various loading
conditions for both cohesive and adhesive cracks. This was achieved by extracting only the active inelastic responses
occuring in the micro sample (rather than the whole responses in the micro sample as in standard homogenization
schemes) to determine the equivalent homogenized macroscopic ones. The paper confirmed the existence of an RVE for
quasi-brittle materials with a random microstructure that exhibits damage in a smeared average fashion under tensile
and shear loadings.

Using the Hill’s energetic equivalence condition in combination with the proposed failure zone averaging scheme,
homogenization relations for both macroscopic adhesive and cohesive cracks were obtained for materials exhibiting
diffusive damage. The proposed homogenization scheme can be considered as an aggregation of a micro localization band
to a macro discontinuous crack in an energetically equivalent manner. The homogenization scheme was implemented
in a standard strain-driven FE2 framework and successfully verified by three simple numerical examples. The proposed
homogenization scheme is objective with respect to the micro model size apart being independent of macro and micro
finite element discretizations. The method has been verified by comparing it with a direct numerical simulation.

Future work would be (i) extension of the currently proposed energetic equivalence conditions to the case in which
there are simultaneously diffusive damage and discrete cracking e.g., decohesion of material interfaces occurring in the
microstructure, (ii) a statistical analysis of the representativeness of the macroscopic cohesive laws of samples subjected
to mixed mode loading and (iii) a study on the effect of volume fraction of the aggregates, shape of the aggregates on
the resulting cohesive laws.

Acknowledgements

The financial support from the Delft Center for Computational Science and Engineering (DCSE) is gratefully
acknowledged. The first author gratefully appreciate the discussion with Dr. Clemens Verhoosel.

[1] T. Belytschko and J.H. Song. Coarse-graining of multiscale crack propagation. International Journal for Numerical
Methods in Engineering, 81(5):537–563, 2010.

32



[2] O. van der Sluis, P. J. G. Schreurs, W. A. M. Brekelmans, and H. E. H. Meijer. Overall behaviour of heterogeneous
elastoviscoplastic materials: effect of microstructural modelling. Mechanics of Materials, 32(8):449–462, August
2000.

[3] P. M. Suquet. Local and global aspects in the mathematical theory of plasticity. In A. Sawczuk and G. Bianchi,
editors, Plasticity today: modelling, methods and applications, pages 279–310, London, 1985. Elsevier.

[4] I. M. Gitman, H. Askes, and L. J. Sluys. Coupled-volume multi-scale modelling of quasi-brittle material. European
Journal of Mechanics - A/Solids, 27(3):302–327, 2007.

[5] F. Feyel. A multilevel finite element method (fe2) to describe the response of highly non-linear structures using
generalized continua. Computer Methods in Applied Mechanics and Engineering, 192:3233–3244, 2003.

[6] R.J.M. Smit, W.A.M. Brekelmans, and H.E.H. Meijer. Prediction of the mechanical behavior of nonlinear hetero-
geneous systems by multi-level finite element modeling. Computer Methods in Applied Mechanics and Engineering,
55:181–192, 1998.

[7] S. Ghosh, K. Lee, and S. Moorthy. Two scale analysis of heterogeneous elastic-plastic materials with asymptotic
homogenization and Voronoi cell finite element model. Computer Methods in Applied Mechanics and Engineering,
132:63–116, 1996.

[8] V. Kouznetsova, W. A. M. Brekelmans, and F. P. T. Baaijens. An approach to micro-macro modeling of hetero-
geneous materials. Computational Mechanics, 27(1):37–48, 2001.

[9] M. G. D. Geers, V. G. Kouznetsova, and W. A. M. Brekelmans. Multi-scale computational homogenization: Trends
and challenges. Journal of Computational and Applied Mathematics, 234(7):2175–2182, 2010.

[10] A. Abdulle and A. Nonnenmacher. A short versatile finite element multiscale code for homogenization problems.
Computer Methods in Applied Mechanics and Engineering, 198(37-40):2839–2859, 2009.

[11] I.M. Gitman, H. Askes, and L.J. Sluys. Representative volume: Existence and size determination. Engineering
Fracture Mechanics, 74(16):2518–2534, 2007.

[12] K. Matouš, M. G. Kulkarni, and P. H. Geubelle. Multiscale cohesive failure modeling of heterogeneous adhesives.
Journal of the Mechanics and Physics of Solids, 56(4):1511–1533, 2008.

[13] C. B. Hirschberger, S. Ricker, P. Steinmann, and N. Sukumar. Computational multiscale modelling of heteroge-
neous material layers. Engineering Fracture Mechanics, 76(6):793–812, 2009.

[14] M. G. Kulkarni, P. H. Geubelle, and K. Matouš. Multi-scale modeling of heterogeneous adhesives: Effect of particle
decohesion. Mechanics of Materials, 41(5):573–583, 2009.

[15] M.V. Cid Alfaro, A.S.J. Suiker, C.V. Verhoosel, and R. de Borst. Numerical homogenization of cracking processes
in thin fibre-epoxy layers. European Journal of Mechanics - A/Solids, 29(2):119–131, 2010.

[16] C. V. Verhoosel, J. J. C. Remmers, and M. A. Gutiérrez. A partition of unity-based multiscale approach for
modelling fracture in piezoelectric ceramics. International Journal for Numerical Methods in Engineering, 2009.

[17] C. V. Verhoosel, J. J. C. Remmers, M. A. Gutiérrez, and R. de Borst. Computational homogenisation for adhesive
and cohesive failure in quasi-brittle solids. International Journal for Numerical Methods in Engineering, 2010.

33



[18] T. Belytschko, S. Loehnert, and J.H. Song. Multiscale aggregating discontinuities: A method for circumventing
loss of material stability. International Journal for Numerical Methods in Engineering, 73(6):869–894, 2008.

[19] A. Hund and E. Ramm. Locality constraints within multiscale model for non-linear material behaviour. Interna-
tional Journal for Numerical Methods in Engineering, 70(13):1613–1632, 2007.

[20] T.J. Massart and B.C.N. Mercatoris. Assessment of periodic homogenisation-based multiscale computational
schemes for quasi-brittle structural failure. International Journal for Multiscale Computational Engineering,
7(2):153–170, 2009.

[21] V.P. Nguyen, O. Lloberas Valls, M. Stroeven, and L.J. Sluys. On the existence of representative volumes for
softening quasi-brittle materials-A failure zone averaging scheme. Computer Methods in Applied Mechanics and
Engineering, 2010. In Press, Corrected Proof.

[22] M. Stroeven, H. Askes, and L. J. Sluys. Numerical determination of representative volumes for granular materials.
Computer Methods in Applied Mechanics and Engineering, 193(30-32):3221–3238, 2004.

[23] R. H. J. Peerlings, R. de Borst, W. A. M. Brekelmans, and J. H. P. de Vree. Gradient enhanced damage for
quasi-brittle materials. International Journal for Numerical Methods in Engineering, 39:3391–3403, 1996.

[24] J. Lemaitre. A course on damage mechanics. Springer-Verlag, 1996.

[25] J. Mazars and G.Pijaudier-Cabot. Continuum damage theory - application to concrete. Journal of Engineering
Mechanics Division ASCE, 115:345–365, 1989.

[26] T.I. Zohdi and P. Wriggers. Introduction to computational micromechanics. Springer-Verlag, 2005.

[27] K. Matouš and P.H. Geubelle. Multiscale modelling of particle debonding in reinforced elastomers subjected to
finite deformations. International Journal for Numerical Methods in Engineering, 65:190–223, 2006.

[28] I.M. Gitman, H. Askes, L.J. Sluys, and O. Lloberas. The concept of representative volume for elastic, hardening
and softening materials. In Proceedings of XXXII International Summer School-Conference ”Advance problems in
Mechanics”, pages 180–184, Saint Petersburg (Repino) Russia, 2004.

[29] R. Hill. On constitutive macro-variables for heterogeneous solids at finite strain. Proc. R. Soc. Lond., 326:131–147,
1972.

[30] C. Pelissou, J. Baccou, Y. Monerie, and F. Perales. Determination of the size of the representative volume element
for random quasi-brittle composites. International Journal of Solids and Structures, 46(14-15):2842–2855, 2009.

[31] T. J. Massart, R. H. J. Peerlings, and M. G. D. Geers. An enhanced multi-scale approach for masonry wall compu-
tations with localization of damage. International Journal for Numerical Methods in Engineering, 69(5):1022–1059,
2007.

[32] G. N. Wells and L. J. Sluys. A new method for modelling cohesive cracks using finite elements. International
Journal for Numerical Methods in Engineering, 50(12):2667–2682, 2001.

[33] K. D. Papoulia, C.H. Sam, and S. A. Vavasis. Time continuity in cohesive finite element modeling. International
Journal for Numerical Methods in Engineering, 58(5):679–701, 2003.

[34] N. Moës, J. Dolbow, and T. Belytschko. A finite element method for crack growth without remeshing. International
Journal for Numerical Methods in Engineering, 46(1):131–150, 1999.

34



[35] D.D. Somer, E.A. de Souza Neto, W.G. Dettmer, and D. Perić. A sub-stepping scheme for multi-scale analysis of
solids. Computer Methods in Applied Mechanics and Engineering, 198(9-12):1006–1016, February 2009.

[36] C. V. Verhoosel, J. J. C. Remmers, and M. A. Gutiérrez. A dissipation-based arc-length method for robust
simulation of brittle and ductile failure. International Journal for Numerical Methods in Engineering, 77(9):1290–
1321, 2009.

35

View publication statsView publication stats

https://www.researchgate.net/publication/235784581

	Introduction
	Microstructures and Constitutive model
	Microstructures
	Constitutive model

	Objective macroscopic cohesive laws
	Standard averaging techniques
	Failure zone averaging technique
	Traction-separation law
	Samples under shear and mixed mode loading
	Existence of an RVE for materials with random microstructure

	Energetic equivalence theorem
	Cohesive cracks
	Adhesive cracks
	Case I
	Case II

	Numerical verification of Equation 17

	Computational multiscale crack modelling
	Adhesive crack homogenization-case I
	Adhesive crack homogenization-case II
	Cohesive crack homogenization
	Some algorithmic aspects

	Benchmark problems
	Adhesive crack
	Cohesive crack
	Verification of the method against DNS

	Conclusions

