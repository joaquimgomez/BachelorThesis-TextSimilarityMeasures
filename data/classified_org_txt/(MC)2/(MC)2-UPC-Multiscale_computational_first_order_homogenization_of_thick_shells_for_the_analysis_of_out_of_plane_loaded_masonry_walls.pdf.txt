






















































Multiscale computational first order homogenization of thick shells for the analysis of out-of-plane loaded masonry walls


Multiscale computational first order homogenization of thick
shells for the analysis of out-of-plane loaded masonry walls

Massimo Petraccaa,b,c,∗, Luca Pelàa,b, Riccardo Rossia,b, Sergio Ollera,b, Guido
Camatac, Enrico Spaconec

aDepartment of Civil and Environmental Engineering, Technical University of Catalonia (UPC),
Barcelona 08034, Spain

bCIMNE - Centre Internacional de Metodes Numerics en Enginyeria, Technical University of
Catalonia (UPC), Barcelona 08034, Spain

cDepartment of Engineering, University "G.d’Annunzio" of Chieti and Pescara, Pescara 65127, Italy

Abstract

This work presents a multiscale method based on computational homogenization for the
analysis of general heterogeneous thick shell structures, with special focus on periodic
brick-masonry walls. The proposed method is designed for the analysis of shells whose
micro-structure is heterogeneous in the in-plane directions, but initially homogeneous in
the shell-thickness direction, a structural topology that can be found in single-leaf brick
masonry walls. Under this assumption, this work proposes an efficient homogenization
scheme where both the macro-scale and the micro-scale are described by the same shell
theory. The proposed method is then applied to the analysis of out-of-plane loaded
brick-masonry walls, and compared to experimental and micro-modeling results.

Keywords: Computational Multiscale Homogenization, Representative Volume
Element (RVE), Shell, Masonry, Periodic Micro-structure, Strain Localization

1. Introduction

Masonry is an ancient building material that have been extensively used throughout the
history, and it is still used nowadays. Being the main building technique adopted in
historical constructions, a deep understanding of masonry mechanical behavior is there-
fore of primary importance for the preservation of our cultural heritage. However, the
formulation of phenomenological constitutive equations for heterogeneous materials such
as masonry is still a challenge [1, 2, 3]. The evolution of the structural response strongly
depends on complex micro-structural phenomena such as damaged-induced anisotropy
and localization of deformation in the micro-structure. It is therefore difficult to ac-
count for the influence that this evolving micro-structure has on the overall macroscopic

∗corresponding author
Email addresses: mpetracca@cimne.upc.edu (Massimo Petracca), luca.pela@upc.edu (Luca Pelà),

rrossi@cimne.upc.edu (Riccardo Rossi), oller@cimne.upc.edu (Sergio Oller), g.camata@unich.it
(Guido Camata), espacone@unich.it (Enrico Spacone)

Preprint submitted to Elsevier September 27, 2016



behavior, especially when strain localization occurs in the micro-structure, leading to
complex dissipative mechanisms at the structural scale. Advanced numerical methods
are therefore attractive tools to understand and predict the behavior of masonry up to
its complete failure, allowing to estimate the residual strength and safety of structures.
A popular method commonly used nowadays to study masonry, accounting for its het-
erogeneous micro-structure, is micro-/meso-modeling, also known as Direct Numerical
Simulation (DNS), [4, 5, 6, 7, 8, 9, 10, 11]. In this approach, the complete micro-structure
(or a simplified version of it) is directly modeled, thus the complex interaction between
the masonry constituents is naturally taken into account. However, this approach leads
to complex models and high computational costs. Therefore DNS is suitable to model
in detail small structural members, but their usage soon becomes unaffordable for large
scale structures. On the contrary, macro-modeling regards masonry as an equivalent
homogeneous continuum, without making any distinction between units and joints in
the discrete model [1, 2, 12]. This method possesses some intrinsic difficulties related
to identification of mechanical properties and definition of reliable and predictive phe-
nomenological failure criteria. Nevertheless, macro-modeling is still the preferred option
for the analysis of large-scale structures, thanks to its affordable computational cost. An
example of masonry macro-modeling for shells has been proposed in [13].
In-between macro- and micro-modeling techniques, Computational Homogenization Meth-
ods (CHM) have recently emerged as a promising tool joining their advantages [14, 15, 16,
17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38]. The prob-
lem is split into two scales: the structural scale is treated as an equivalent homogeneous
medium, while the complex behavior of the heterogeneous micro-structure is taken into
account solving a micro-scale problem on a representative sample of the micro-structure
(RVE). Classical CHM has been extensively adopted to analyze micro-structures exhibit-
ing a stable behavior. However it was soon recognized to give non-objective results for
strain-softening materials, with the homogenized response not converging to a unique
meaningful solution upon mesh refinement and/or upon increasing the size of the RVE.
In fact the RVE, which is assumed to be representative of the micro-structure, looses
its representativeness upon localization of deformation. It should be noted that this
issue is not directly related to the CHM itself, but stems from the use of a first order
continuum. In the last years, some enhancements of the classical first order CHM were
proposed, and a review on most recent developments can be found in [39] and in the
references therein. Some methods regularize the response of the RVE adopting higher
order continua at the macro-scale, so that a material characteristic length is naturally
accounted for [19, 21, 22, 16, 17, 36, 14]. Others, known as continuous-discontinuous
methods, up-scale the micro-structural response to a discontinuity at the structural scale
[23, 24, 25, 26, 27, 29, 40, 15]. In [41] an extension of the fracture-energy-based regular-
ization to the homogenization problem has been proposed, and applied to the simulation
of in-plane loaded masonry shear walls, allowing the use of a standard continuum theory,
while ensuring a proper dissipation at the structural level.
Computational Homogenization for shell-like structures is an emerging branch of Com-
putational Homogenization Methods. The need for this kind of homogenization stems
from the fact that the size of the micro-structure has the same order of magnitude of the
structure thickness, so that a standard 3D continuum homogenization cannot be applied,
at least with respect to the thickness direction. In the last years some works have been
done for thin structured shells in generic structural applications, with elastic or inelastic

2



material behavior, with or without geometric non-linearity [42, 43, 44, 45, 46]. In these
approaches, a 3D solid RVE discretizing the whole micro-structure in the thickness di-
rection, is coupled to the macro-scale shell model. Applications of this concept to the
specific case of masonry structures can be found in [25, 26]. In those works, material
non-linearity was considered, and the homogenization was based on a Kirchhoff-Love
(thin) shell theory, while the nonlinear transverse shear behavior was obtained by means
of a separated model (i.e. not directly from the RVE calculations).
The present work proposes a new homogenization procedure for shell-like structures,
based on Reissner-Mindlin (thick) shell theory. This approach is tailored to the ho-
mogenization of micro-structures that are heterogeneous in the in-plane directions, but
(initially) homogeneous in the thickness direction (i.e. an extrusion of a heterogeneous
surface in the thickness direction). With this assumption, both the macro-scale domain
and the RVE domain can be accurately described according to shell theories. Reissner-
Mindlin shell theory is based on the hypothesis that the initially straight normals to the
mid-plane of the shell remain straight after deformation, even though not necessarily
perpendicular to the mid-plane. If the micro-structure is homogeneous in the thickness
direction, it is reasonable to assume that the previously mentioned hypothesis holds.
This assumption reduces the range of applicability of this method, with respect to those
methods using a 3D RVE, but it greatly simplifies the macro-micro scale transition
(both scale share the same theory), and it reduces the computational cost of the RVE
calculations. The proposed methodology is then applied to the analysis of Unreinforced
Masonry Walls (URM) subjected to out-of-plane loading. A deep understanding of the
out-of-plane behavior is a key aspect of the seismic response of URM buildings. The
experimental studies conducted in [47] on URM walls, are numerically reproduced here
to assess the capabilities of the proposed method. As highlighted in [47] and in the ref-
erences therein, assuming that a wall, subjected to out-of-plane loading, collapses if its
bending strength is exceeded is extremely conservative to assess its seismic response, as
the full collapse generally happens when the out-of-plane displacement due to bending
approaches the thickness of the wall. Therefore accurate constitutive models are required
to numerically reproduce the out-of-plane behavior of masonry. The proposed methodol-
ogy has proven to be rather accurate in reproducing the key aspects of the out-of-plane
behavior of URM emerged from the experimental tests.

3



2. Computational homogenization framework

Equivalent 

homogeneous shell 

Heterogeneous 

shell 

Shell-like RVE 

Heterogeneous solid 

(homogeneous in the 

thickness) 

Figure 1: work-flow of computational homogenization for shells

This section gives the main concepts and basic equations of the proposed computational
homogenization framework, where classical first order homogenization is extended to the
case of shell theory. The following derivations assume small strain theory.
The main work-flow of the proposed CHM for shells can be represented as in Figure 1.
The proposed method is formally identical to the classical CHM for 2D and 3D continua
[41]. The main difference is that now the continuum strain and stress tensors should be
replaced with the generalized strains and generalized stresses typical of shell kinematics,
as described in Section 2.1.
The homogenization process can be seen as a 3-step procedure:

1. Down-scaling or macro-micro transition. The macroscopic generalized strain, at
any point of the macroscopic domain, are sent to the micro-scale, and used to
define RVE boundary conditions;

2. Solution of the micro-scale Boundary Value Problem (BVP). The micro-structural
problem is solved on the RVE domain. Any numerical method can be used. FEM
is considered in this work;

3. Up-scaling or micro-macro transition. The macro-scale generalized stresses are
obtained via homogenization procedures.

4



2.1. Shell kinematics
From now on, any generalized quantity related to the shell theory is identified with a
superimposed hat (̂·)
The generalized unknown vector in the local coordinate system of the shell is defined as:

û =
[
u0 uz θ

]T
=
[
ux uy uz θx θy

]T
(1)

where u0 =
[
ux uy

]T
are the in-plane displacements, uz is the out-of-plane displace-

ment, and θ =
[
θx θy

]T
are the out-of-plane rotations about the local x and y axes

respectively.
According to the first order shear deformation theory of Reissner-Mindlin, the generalized
strains of the shell are defined as:

ε̂ =
[
ε0 κ γ0

]T
=
[
ε0,xx ε0,yy 2ε0,xy κxx κyy 2κxy 2ε0,xz 2ε0,yz

]T
(2)

The in-plane strain tensor due to membrane actions is defined as:

ε0 = ∇su0 (3)
The curvature tensor due to bending actions is defined as:

κ = ∇s (Pθ) (4)
The transverse shear strain is defined as:

γ0 = ∇uz + Pθ (5)
In the previous relations the transformation matrix P is introduced to account for the
sign convention about rotations:

P =

[
0 1
−1 0

]
(6)

Pθ =

[
θy
−θx

]
(7)

Therefore the generalized strains of the shell can be rewritten as:

ε̂ =




ε0,xx

ε0,yy

2ε0,xy

κxx

κyy

2κxy

2ε0,xz

2ε0,yz




=




∂ux
∂x

∂uy
∂y

∂ux
∂y

+
∂uy
∂x

∂θy
∂x

−∂θx
∂y

∂θy
∂y
− ∂θx

∂x

∂uz
∂x

+ θy
∂uz
∂y
− θx




(8)

5



2.2. Shell constitutive response: through-the-thickness integrated cross section
With the shell generalized strains ε̂ at hand, it is possible to calculate the constitutive
response of the shell to obtain the generalized stresses:

σ̂ =
[
N M Q

]T
=
[
Nxx Nyy Nxy Mxx Myy Mxy Qxz Qyz

]T
(9)

where N =
[
Nxx Nyy Nxy

]T
is the membrane force vector per unit length, M =[

Mxx Myy Mxy
]T

is the bending/twisting moment vector per unit length, and Q =[
Qxz Qyz

]T
is the transverse shear force vector per unit length. A very simple and

general way to obtain the shell constitutive response is by means of a through-the-
thickness integration of standard continuum constitutive models.
Defining ζ as the through-the-thickness coordinate, ranging from −H/2 to H/2 (H being
the thickness of the shell), the strain at each coordinate ζ can be defined as:

ε(ζ) = ε0 + ζκ+ γ0 (10)
or in matrix form:

ε(ζ) = Hε(ζ)ε̂ (11)




εxx
εyy
2εxy
2εxz
2εyz


 =




1 0 0 ζ 0 0 0 0
0 1 0 0 ζ 0 0 0
0 0 1 0 0 ζ 0 0
0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 1







ε0,xx
ε0,yy
2ε0,xy
κxx
κyy
2κxy
2ε0,xz
2ε0,yz




(12)

Then the stress tensor and the constitutive tangent operator at any coordinate ζ in the
thickness direction can be calculated from any constitutive model:

σ(ζ) = f
(
ε(ζ)

)
, C(ζ) =

∂σ(ζ)

∂ε(ζ)
(13)

The generalized stresses and the tangent constitutive matrix for the shell can be finally
integrated through the thickness:

σ̂ =

ˆ H
2

−H
2

Hσ(ζ)σ(ζ) dζ (14)


Nxx
Nyy
Nxy
Mxx
Myy
Mxy
Qxz
Qyz




=

ˆ H
2

−H
2




1 0 0 0 0
0 1 0 0 0
0 0 1 0 0
ζ 0 0 0 0
0 ζ 0 0 0
0 0 ζ 0 0
0 0 0 k 0
0 0 0 0 k






σxx
σyy
σxy
σxz
σyz


 dζ (15)

6



Ĉ =
∂σ̂

∂ε̂
=

ˆ H
2

−H
2

Hσ(ζ)C(ζ)Hε(ζ) dζ (16)

where k is the transverse shear correction factor [48].
It should be noted that in Eq. (13) the continuum stress tensor σ(ζ) at a certain ζ
coordinate in the thickness direction, is obtained as a function of the continuum strain
tensor ε(ζ) at the same ζ coordinate. However, the strain tensor ε(ζ), as defined in
Eq. (12), is lacking the thickness strain component εzz, since the standard shell kinematics
does not provide it. A simple way to cope with this issue would be to obtain σPS

(ζ)
, the

plane-stress part of σ(ζ), through any general (non-linear) plane stress constitutive law
fPS (·), while considering σTS

(ζ)
, the transverse shear part of σ(ζ), elastic:

σPS(ζ) = f
PS
(
εPS(ζ)

)
(17)

σTS(ζ) = Gε
TS
(ζ) (18)

σzz(ζ) = 0 (19)

This simple approach is applicable only if the transverse shear deformation is negligible,
so that one can expect a linear relation between σTS

(ζ)
and εTS

(ζ)
. In most general cases

this is not necessary true. In masonry, even if one considers a thin wall made of only
one layer of bricks, the in-plane dimension of the mortar joint (of the order of 10mm)
will always be smaller than the out-of-plane (wall thickness) dimension (of the order of
100mm). If one also considers that in many applications mortar joints are by far softer
than units (bricks or stones), it is evident that all shear deformation will concentrate
in mortar joints, and it will not be negligible with respect to the in-plane deformation.
Thus a nonlinear response for the transverse shear is also necessary.
In the present work, based on the idea given in [49], this goal is achieved by storing in each
integration point of the shell domain, an extra internal-like variable εzz (representing the
strain component in the thickness direction, which is not provided by shell kinematics).
Its evolution is obtained by imposing the following constraint through a nested iterative
procedure:

find εzz such that

ˆ H
2

−H
2

σzz(ζ)dζ = 0 (20)

In this way, the out-of-plane normal stress is not forced to be zero at every depth in
the thickness, but only its integral (the stress resultant Nzz) is constraint to be zero, as
required by the thick shell theory.
This procedure allows to use full 3D constitutive models along the thickness of the shell.
The generalized stresses and the generalized constitutive tensor can then be obtained
using Eq. (14) and Eq. (16), respectively. Indeed Eq. (14) and Eq. (16) are integrals along
the thickness direction, therefore a suitable integration scheme should be provided. Note
that this is an approximation of the real 3D behavior. The out-of-plane strain component,
εzz, is assumed constant in the thickness direction, and is calculated locally at each gauss-
point of the shell element. The iterative procedure in Eq. (20) can be avoided in case

7



of other shell formulations whose kinematics can provide the thickness stretch, such as
3D-shells for example.

2.3. Down-scaling or macro-micro transition and constraint conditions
The macroscopic generalized strain ε̂m , in each point xm of the macro-scale domain and
at each instant t, can be obtained as the surface average of the microscopic generalized
strain field ε̂µ defined at each point xµ of the micro-scale domain and at each instant t:

ε̂m(xm, t) =
1

Aµ

ˆ
Ωµ

ε̂µ(xµ, t) dA (21)

where Aµ is the surface area of the shell domain at the micro-scale.
To account for the heterogeneity of the micro-structure, the microscopic displacement
field ûµ can be additively split into a coarse scale contribution ûm (arising from the
macroscopic generalized strain field), and a fine scale contribution ̂̃uµ (obtained from
the solution of the micro-scale problem). Accordingly, the microscopic generalized strain
field is split in the same way:

ε̂µ(xµ, t) = ε̂m(xm, t) + ̂̃εµ(xµ, t) (22)
Inserting Eq. (22) into Eq. (21) and taking into account that ε̂m is constant over the RVE,
the minimal kinematic constraint required for the microscopic generalized displacement
fluctuation field to be kinematically admissible is:

ˆ
Aµ

̂̃εµ (xµ, t) dA = 0 (23)
In order to write this constraint as a function of the microscopic generalized displacement
fluctuation field, it is useful to split Eq. (23) into membrane ε̃0,µ, bending κ̃µ, and shear
γ̃0,µ components. For the membrane and bending components, using the Gauss theorem,
the surface integrals can be rewritten as boundary integrals over the RVE boundary ∂Aµ:

ˆ
Aµ

ε̃0,µ dA =

ˆ
Aµ

∇sũ0,µ dA =
ˆ
∂Aµ

ũ0,µ ⊗s n dS = 0 (24)

ˆ
Aµ

κ̃µ dA =

ˆ
Aµ

∇s
(
P θ̃µ

)
dA =

ˆ
∂Aµ

(
P θ̃µ

)
⊗s n dS = 0 (25)

Eq. (24) and Eq. (25) provide the minimal kinematic constraint to be applied to the
micro in-plane displacement fluctuations ũ0,µ and to the micro out-of-plane rotation
fluctuations θ̃µ.
As regarding the shear component, the following minimal constraint has to be satisfied:

ˆ
Aµ

γ̃0,µ dA =

ˆ
Aµ

∇ũz,µ + P θ̃µ dA = 0 (26)

This constraint can be either imposed directly as a surface integral, or, if periodic condi-
tions for the out-of-plane displacement fluctuation ũz are to be used, only the following
constraint should be applied as a surface integral over the RVE domain:

8



ˆ
Aµ

θ̃µ dA = 0 (27)

The previously defined minimal conditions can be imposed using different kinds of bound-
ary conditions. In the present work, taking advantage of the periodic nature of the
considered micro-structure, the following set of constraints have been adopted:

ũ0,µ(x
+
µ , t) = ũ0,µ(x

−
µ , t) ∀ pair {x

+
µ , x

−
µ } ∈ ∂Aµ (28)

θ̃µ(x
+
µ , t) = θ̃µ(x

−
µ , t) ∀ pair {x

+
µ , x

−
µ } ∈ ∂Aµ (29)

ũz,µ
(
x+µ , t

)
= ũz,µ

(
x−µ , t

)
∀ pair

{
x+µ , x

−
µ

}
∈ ∂Aµ (30)

ˆ
Aµ

θ̃µ (xµ, t) dA = 0 (31)

Eq. (28), Eq. (29) and Eq. (30) impose periodicity on the microscopic fluctuation fields.
This assumption showed a very good performance in a previous work by the authors on
in-plane multiscale analysis of masonry [41]. Eq. (31) is an extra constraint arising from
the definition of the transverse shear strain.

2.4. Solution of the micro-scale BVP
Neglecting inertia forces, and in absence of body forces and boundary traction, the
Principle of Virtual Work for the 3D continuum case at the micro-scale (RVE) reads:

ˆ
Ωµ

σµ : δε̃µ dV = 0 (32)

Considering that the shell works with generalized strains and stresses obtained from a
through-the-thickness integration, Eq. (32) can be rewritten in terms of these generalized
quantities:

ˆ
Aµ

{ˆ H
2

−H
2

σµ (ζ) : δε̃µ (ζ) dζ

}
dA = 0 (33)

ˆ
Aµ

{ˆ H
2

−H
2

σµ (ζ) :
(
δε̃0,µ + ζδκ̃µ + δγ̃0,µ

)
dζ

}
dA = 0 (34)

ˆ
Aµ

{ˆ H
2

−H
2

[
σµ,xx (δε̃0,µ,xx + ζδκ̃µ,xx) + σµ,yy (δε̃0,µ,yy + ζδκ̃µ,yy) +

σµ,xy (2δε̃0,µ,xy + 2ζδκ̃µ,xy) +

σµ,xz (2δε̃0,µ,xz) + σµ,yz (2δε̃0,µ,yz)

]
dζ

}
dA = 0

(35)

9



ˆ
Aµ

[
Nµ : δε̃0,µ +Mµ : δκ̃µ +Qµ : δγ̃0,µ

]
dA = 0 (36)

ˆ
Aµ

σ̂µ : δ̂̃εµ dA = 0 (37)
2.5. Up-scaling or micro-macro transition
Upon RVE equilibrium, the homogenized generalized stress should be computed. As
discussed in [20, 31], the definition of the homogenized stress can be directly obtained
from the Hill-Mandel Principle [50, 51] using the additive split of the microscopic strain.
The Hill-Mandel Principle can be written in terms of generalized stresses and strains as:

σ̂m : ̂̇εm = 1
Aµ

ˆ
Aµ

σ̂µ : ̂̇εµ dA (38)
Inserting the split of the microscopic generalized strain given in Eq. (22), into the Hill-
Mandel Principle Eq. (38), the following relation is obtained:

σ̂m : ̂̇εm = 1
Aµ

ˆ
Aµ

σ̂µ : ̂̇εm dA+ 1
Aµ

ˆ
Aµ

σ̂µ :
̂̃̇
εµ dA (39)

σ̂m : ̂̇εm = 1
Aµ

ˆ
Aµ

σ̂µ : ̂̇εm dA+ 1
Aµ

ˆ
Aµ

σ̂µ : L
̂̃̇
uµ dA (40)

where

L ̂̃̇uµ =



∇s ̂̃̇u0,µ
∇sP

̂̃̇
θµ

∇̂̃̇uz,µ + P ̂̃̇θµ


 (41)

Eq. (40) is valid for any kinematically admissible ̂̃̇uµ. Specifically, in the case of ̂̃̇uµ = 0,
the following relation is obtained:

σ̂m : ̂̇εm = 1
Aµ

ˆ
Aµ

σ̂µ : ̂̇εm dA ∀ε̇m (42)
which is valid for any macroscopic generalized strain rate field, leading to the definition of
the homogenized macroscopic generalized stress as the surface average of the microscopic
generalized stress field:

σ̂m =
1

Aµ

ˆ
Aµ

σ̂µ dA (43)

From a computational point of view, it is more convenient to obtain the homogenized
generalized stresses from the reactions obtained on the RVE boundaries upon equilibrium
[44]:

10



N =
1

Aµ

n∑
i=1

fr,i ⊗
s xµ,i (44)

M =
1

Aµ
P

n∑
i=1

mr,i ⊗s xµ,i −
1

Aµ

n∑
i=1

frz,ixµ,i ⊗ xµ,i (45)

Q =
1

Aµ

n∑
i=1

frz,ixµ,i (46)

where i = 1, 2, ..., n is the boundary node index, xµ,i =
[
xµ,i yµ,i

]T
is the position

vector of the boundary node i, fr,i =
[
frx,i fry,i

]T
is the in-plane reaction force

vector, mr,i =
[
mrx,i mry,i

]T
is the out-of-plane reaction moment vector, and frz,i

is the out-of-plane reaction force. The transformation matrix P in Eq. (45), is the same
introduced in Eq. (6). The explicit expression for each homogenized macro generalized
stress component is:

σ̂m =




Nxx

Nyy

Nxy

Mxx

Myy

Mxy

Qxz

Qyz




=
1

Aµ

n∑
i=1




frx,ixµ,i

fry,iyµ,i

1
2

(frx,iyµ,i + fry,ixµ,i)

mry,ixµ,i − 12frz,ix
2
µ,i

−mrx,iyµ,i − 12frz,iy
2
µ,i

1
2

(mry,iyµ,i −mrx,ixµ,i)− 12frz,ixµ,iyµ,i
frz,ixµ,i

frz,iyµ,i




(47)

2.6. Typical deformation modes obtained from the shell homogenization framework
This section shows the eight natural deformation modes obtained from the proposed ho-
mogenization framework for thick shells in terms of coarse scale displacements/rotations,
fine scale displacement/rotation fluctuations, and total displacements/rotations. In the
proposed method, the unknowns at the micro-scale are the fluctuations, so the total dis-
placements/rotations are just computed and displayed as a post-process for visualization
purposes.
The total microscopic displacement/rotation vector is defined as the sum of the coarse
scale contribution and the fine scale contribution (fluctuations):

ûµ = ûm + ̂̃uµ (48)
[
u0,µ uz,µ θµ

]T
=
[
u0,m uz,m θm

]T
+
[
ũ0,µ ũz,µ θ̃µ

]T
(49)

The microscopic displacement/rotation fluctuations ̂̃uµ are obtained by the solution of
the microscopic boundary value problem, while the displacement/rotation vector due to

11



the coarse scale contribution ûm can be calculated as a post-process from the macroscopic
generalized strains ε̂m:

u0,m = ε0,mxµ (50)

θm = P
Tκmxµ (51)

uz,m = −
1

2
(κmxµ) · xµ + γm · xµ (52)

In Eq. (51), the transformation matrix P is still the one defined in Eq. (6) to take into ac-
count the sign convention of rotations. In Eq. (52), the first term represents the deflection
due to the bending deformation, while the second term represents the deflection due to
the shear deformation. Figure 2 to Figure 9 show all the eight deformation modes associ-
ated with the eight deformation components of the macroscopic generalized strain vector.
In all of them, (a) shows the displacement/rotation field ûm arising from the associated
average macroscopic deformation mode representing the coarse-scale contribution, (b)
shows the microscopic displacement/rotation fluctuation field ̂̃uµ(unknown of the micro-
scopic BVP) that represents the fine-scale contribution accounting for the heterogeneity
(bricks and mortar), and (c) represents the total microscopic displacement/rotation ûµas
the superposition of coarse and fine scale contributions. Figure 2, Figure 3 and Figure 4
show the three membrane deformation modes. Figure 5, Figure 6 and Figure 7 show the
three bending deformation modes. Figure 8 and Figure 9 show the two transverse shear
deformation modes.

(a) (b) (c)

Figure 2: deformation mode due to εxx. (a) coarse scale, (b) fine scale, (c) total

12



(a) (b) (c)

Figure 3: deformation mode due to εyy . (a) coarse scale, (b) fine scale, (c) total

(a) (b) (c)

Figure 4: deformation mode due to εxy . (a) coarse scale, (b) fine scale, (c) total

(a) (b) (c)

Figure 5: deformation mode due to κxx. (a) coarse scale, (b) fine scale, (c) total

13



(a) (b) (c)

Figure 6: deformation mode due to κyy . (a) coarse scale, (b) fine scale, (c) total

(a) (b) (c)

Figure 7: deformation mode due to κxy . (a) coarse scale, (b) fine scale, (c) total

(a) (b) (c)

Figure 8: deformation mode due to γxz . (a) coarse scale, (b) fine scale, (c) total

14



(a) (b) (c)

Figure 9: deformation mode due to γyz . (a) coarse scale, (b) fine scale, (c) total

3. Fracture-energy regularization in 2-scale FE computational homogeniza-
tion

A generalized geometrical characteristic length, accounting for the size of (i) macro-scale
FE, (ii) micro-scale FE and (iii) RVE, was proposed in a previous work by the authors
[41]. This fracture-energy regularization for 2-scale FE analysis ensures that the energy
dissipated at the macro-scale be objective with respect to the discretization size in both
micro and macro scales, and with respect to the size of the RVE. Only a summary is
given here, while the reader can refer to [41] for further details.
Micro-scale local constitutive models are regularized with a modified characteristic length
l̃ch,µ, which depends on all the characteristic lengths involved in the homogenization
problem (see Figure 10):

l̃ch,µ = f(lch,µ, lch,m, lch,RV E) (53)

where lch,µ, lch,m and lch,RV E are respectively the micro-scale FE characteristic length,
the macro-scale FE characteristic length, and the RVE characteristic length. WRV E,D is
the energy dissipated in the damaged domain (VRV E,D ) of the RVE:

WRV E,D =
Gf

l̃ch,µ
VRV E,D =

Gf

l̃ch,µ
lch,µ tµ hRV E (54)

whit hRV E being the length of the RVE in the direction of the crack, and tµ being the
thickness of the RVE. “Smearing” this energy over the entire RVE domain (VRV E), an
equivalent specific fracture energy g̃f is obtained:

g̃f =
WRV E,D
VRV E

=
WRV E,D

lch,RV E hRV E tµ
=

Gf

l̃ch,µ

lch,µ
lch,RV E

(55)

g̃f can be integrated over the dissipating macro-scale domain to give the total energy
Wm dissipated at the macro-scale. Equating Wm to the actual dissipated energy W

15



Wm = W

g̃f lch,m hm tm = Gf hm tm (56)

gives a definition for the modified micro-scale FE characteristic length:

l̃ch,µ = lch,µ
lch,m
lch,RV E

(57)

Figure 10: fracture energy based regularization in 2-scale FEM [41]

It should be noticed that this regularization procedure is an extension of the classical
crack band theory, adapted to the 2-scale homogenization problem. As such, it regularizes
globally the problem, but still considers local values in the localization zone.

4. Numerical modeling of out-of-plane loaded masonry walls

The proposed method is applied to the simulation of the out-of-plane behavior of brick-
masonry walls. Experimental tests on Unreinforced Masonry Walls (URM) presented in
[47] are considered here for the numerical assessment of the method. Section 4.1 briefly
describes the experimental test. The nonlinear behavior of bricks and mortar joints is
modeled with a constitutive model based on Continuum-Damage Mechanics, described in
Section 4.2, while the adopted RVE and material parameters are described in Section 4.3.
A preliminary Direct Numerical Simulation (DNS) was performed in order to assess the
capability of the constitutive model to emulate the specific local responses of the masonry
wall under out-of-plane loadings, and the results are discussed in Section 4.4. Multiscale
simulations are discussed in Section 4.5, and the results are compared with both the
experimental test and the DNS.

16



The analyses were carried out using Kratos Multiphysics [52, 53], a free open-source
framework for the development of multidisciplinary solvers, developed at CIMNE. Pre
and post-processing were carried out in GiD [54], also developed at CIMNE.

4.1. Experimental test
Experimental tests on Unreinforced Masonry Walls (URM) have been presented in [47].
Eight full-scale clay brick URMwalls were subjected to quasi-static displacement-controlled
loading to investigate their load-deflection behavior beyond their point of maximum
strength. Of the eight walls analyzed in the experimental campaign, only one is con-
sidered here. The wall measures 4m× 2.5m, with bricks of 230mm× 76mm× 110mm,
and mortar joints of 10mm. After the first stage where a vertical pre-compression of
0.1N/mm2 is applied, the wall is subjected to a uniform pressure under displacement
control. In order to provide a realistic full moment connection along the vertical edges,
450mm long return walls were built in as part of the tested wall. Figure 11 shows the
wall geometry and the obtained failure pattern on the main face of the wall, and on the
lateral turning walls.

Figure 11: Tested wall geometry and obtained failure pattern [47]

4.2. Tension/Compression continuum damage model
4.2.1. Constitutive Model
The bi-dissipative d+/d− damage model, based on the works in [55, 56, 57], defines the
stress tensor as

σ =
(
1− d+

)
σ̄+ +

(
1− d−

)
σ̄− (58)

with σ̄+and σ̄−being respectively the positive and negative parts of the effective (elastic)
stress tensor σ̄:

17



σ̄ = C : ε, σ̄+ =

3∑
i=1

〈σ̄i〉pi ⊗ pi, σ̄
− = σ̄ − σ̄+ (59)

d+ and d− are, respectively, the tensile and compressive damage indexes, acting respec-
tively on σ̄+ and σ̄−. The damage indexes are scalar variables ranging from 0 (intact
material) to 1 (completely damaged material).

4.2.2. Failure Criteria
In order to identify “loading”, “unloading” or “reloading” conditions of a general state
of stress, two scalar measures are introduced, termed as equivalent stresses τ+ and τ−.
Both compressive and tensile failure criteria are based on the one described in [58], and
are computed as:

τ− = H (−σ̄min)
[

1

1− α

(
αĪ1 +

√
3J̄2 + k1β 〈σ̄max〉+ γ 〈−σ̄max〉

)]
(60)

τ+ = H (σ̄max)

[
1

1− α

(
αĪ1 +

√
3J̄2 + β 〈σ̄max〉

) ft
fcp

]
(61)

with

α =
kb − 1
2kb − 1

(62)

β =
fcp
ft

(1− α)− (1 + α) (63)

where Ī1 is the first invariant of the effective stress tensor, J̄2 is the second invariant of the
effective deviatoric stress tensor, σ̄max is the maximum effective principal stress, fcp is the
compressive peak stress, kb is the ratio of bi-axial to uniaxial compressive strengths, and
the term ft

fcp
is used to relate τ+ to the tensile strength ft. The constant k1 in Eq. (60)

controls shear behavior of the model acting on the shape of the compressive surface. k1
can range from 0 (Drucker-Prager criterion) to 1 (criterion proposed in [58]). Finally the
last term in Eq. (60), with a γ > 0, accounts for increasing strength under stress states
of triaxial compression. The two damage surfaces for the 2D plane-stress case are shown
in Figure 12, while the same surfaces for the 3D case are shown in Figure 13.

18



−15 −10 −5 0 5

−15

−10

−5

0

5

σ1

σ
2

 

 

τ
+

τ
−(κ1 = 0.00)

τ
−(κ1 = 0.25)

τ
−(κ1 = 0.50)

τ
−(κ1 = 1.00)

inactive
tensile surface

inactive
compressive 
surface

x = fc0 x = ft

x = κbfc0

x = fcp

Figure 12: initial damage surfaces (2D plane-stress)

(a) tensile surface (b) compressive surface

Figure 13: initial damage surfaces (3D). Inactive surfaces in transparency

19



Note that both compressive and tensile surfaces are defined for any stress state, it is
therefore necessary to inactivate them under certain conditions:

1. the compressive surface can evolve if and only if at least one principal stress is
negative

2. the tensile surface can evolve if and only if at least one principal stress is positive

These conditions are achieved with the Heaviside function H (x) introduced in Eq. (60)
and Eq. (61). The inactive portions of the two surfaces, i.e. those portions cut out by
the Heaviside function, are drawn with dashed-lines in Figure 12, and in transparency in
Figure 13.
To represent the irreversible nature of the damage process, other two scalar quantities,
termed as damage thresholds r±, are introduced. They represent the largest values
attained by the equivalent stresses τ± during the loading history. Therefore r± at time
t+ ∆t can be explicitly evaluated as

r± = max

(
r±0 , max

0≤n≤t
τ±n

)
, r+0 = ft, r

−
0 = fc0 (64)

where r+0 and r
−
0 are, respectively, the initial tensile and compressive damage thresholds

(i.e. the elastic limits in uniaxial tension ft and compression fc0), and n denotes the
time instant. Accordingly, the following damage criteria are defined:

Φ
(
τ±, r±

)
= τ± − r± ≤ 0 (65)

4.2.3. Evolution laws for damage variables
The tensile damage d+ is obtained with the following exponential softening law:

d+
(
r+
)

= 1−
r+0
r+
exp

{
2Hdis

(
r+0 − r

+

r+0

)}
(66)

where Hdis is the discrete softening parameter. In the discrete problem, when using local
constitutive models, the softening law should be adjusted depending on the width of the
dissipative zone (ldis) [59, 60, 61], so that the following equality holds:

gf ldis = Gf (67)

where the specific dissipated energy gf is

gf =

(
1 +

1

Hdis

)
f2t
2E

(68)

Hdis is calculated as

Hdis =
ldis

lmat − ldis
(69)

with lmat = 2EGf/f2t . ldis is taken equal to the FE characteristic length (ldis = lch).

20



(a) (b)

Figure 14: (a) tensile and (b) compressive uniaxial laws

The obtained tensile uniaxial law is shown in Figure 14a. The evolution of the compres-
sive damage d−is driven by a hardening/softening law (see Figure 14b) made of three
quadratic Bezier curves, as described in a previous work by the authors [41]. As for the
tensile case, in the discrete problem the compressive curve shown in Figure 14b needs to
be regularized so that the shaded area underneath be Gc/ldis.

4.3. RVE and material parameters
The geometry of the adopted RVE is shown in Figure 15. The boundary conditions for
the RVE are those listed from Eq. (28) to Eq. (31)

230 mm

172 mm

240 mm

76 mm

10 mm

Figure 15: RVE geometry.

21



The constitutive model used for both bricks and mortar joints is based on Continuum
Damage Mechanics, and it is briefly described in Section 4.2.
Material properties for bricks and mortar are summarized in Table 1.

E ν σt Gt σ0 σp σr Gc εp kb k1 γ

52700.0 0.15 2.0 0.08 9.0 18.0 2.5 40.0 0.003 1.2 0.0 3.0
N

mm2
- N

mm2
N
mm

N
mm2

N
mm2

N
mm2

N
mm

- - - -

(a)

E ν σt Gt σ0 σp σr Gc εp kb k1 γ

1000.0 0.15 0.15 0.003 1.0 2.5 0.5 30.0 0.02 1.2 0.16 1.0
N

mm2
- N

mm2
N
mm

N
mm2

N
mm2

N
mm2

N
mm

- - - -

(b)

Table 1: Material properties for (a) bricks and (b) mortar joints

4.4. Micro-modeling or direct numerical simulation
In the DNS the entire micro-structure is discretized in the computational model with
shell elements, taking advantage of the fact that the micro-structure is heterogeneous in
the in-plane direction but (initially) homogeneous in the thickness direction (1-layer of
bricks). The geometry of the micro-model is shown in Figure 16. Due to the symmetry of
both geometry and boundary conditions, only the left-half of the wall has been modeled.
Figure 17 shows the pressure-deflection curve obtained from the DNS and compared with
the experimental results. The deflection is measured at the center of the wall, where the
maximum value is attained. Overall the micro-model simulation shows a good agreement
with the experiment. Figure 18 shows the deformed shape at the end of the analysis, with
a good agreement in the prediction of the failure mode shown in Figure 11.
The most important feature shown by the experimental campaign, as reported in [47],
is the “apparent” plastic behavior of the tested walls: after reaching the wall strength at
deflections between 2.0 and 5.0 mm, a first loss of bearing capacity is shown, soon followed
by an almost constant strength plateau up to a deflection of 25.0 mm. As discussed by the
authors of the experimental campaign, this apparent plastic behavior may be attributed
to a redistribution of bending moment along diagonal cracks to horizontal bending along
the vertical edges, where the bending restraint provided by the return walls has additional
capacity to accept transfer of load from the diagonal bending mechanism. Table 2 shows
the evolution of tensile and compressive damage during the first stages of the analysis,
where the wall strength is attained, and the damage pattern at the end of the simulation.

22



Symmetry axis

600 mm
2035 

mm

2484 m
m

Figure 16: Micro-model geometry

 0

 0.5

 1

 1.5

 2

 2.5

 3

 3.5

 4

 4.5

 5

 0  5  10  15  20  25  30  35

Pr
es

su
re

 (k
Pa

)

Deflection (mm)

experimental
micro-model

Measured deflection

Figure 17: Pressure-deflection curve obtained from the micro-model analysis

23



(a) (b)

Figure 18: final deformed shape, (a) front and (b) back view from the micro-model analysis

24



Deflection [mm] d+ d−

0.7

2.9

4.0

35.0

Table 2: Tensile and Compressive damage evolution at different load stages from micro-model analysis

25



As a last note, the importance of adopting a 3D constitutive model instead of a plane-
stress one, as already pointed out in Section 2.2, is clearly shown in Figure 19, where a
detail of the bottom-left corner of the structure is given. The in-plane strain along local X-
direction at the top of the shell εxx(+H/2) = ε0,xx+κxx

H
2
∼= 0.11+0.0026×110/2 = 0.253

is larger but comparable to the transverse shear strain ε0,xz = 0.157. It is evident that the
transverse shear deformation cannot be neglected. The failure mode depicted in Figure 19
can be considered as an overall bending state of deformation along the local X-direction,
if one thinks about the overall behavior of the “composite” masonry material. However,
due to the arrangement of the micro-structure, and the strong difference in mechanical
properties of units and mortar, a significant amount of transverse shear appears in the
(softer) mortar joints, in order to allow units to bend around the vertical axis of the wall.

(a) ε0,xx (b) κxx (c) εxz

Figure 19: Comparison of membrane, bending and shear strains in micro-model analysis

4.5. Multiscale simulation
In this section the proposed computational homogenization framework for shells is as-
sessed, comparing it with the results obtained by the DNS presented in Section 4.4. For
the multiscale simulations three macro-scale discretizations have been used, in order to
check the regularization properties of the method with respect to the mesh size. It should
be noted that the regularization procedure presented in [41] and briefly reported in Sec-
tion 3 is only meant to provide objective results in terms of amount of dissipated energy
with respect to the mesh size (i.e. to alleviate the mesh-size dependency). For problems
related to mesh bias dependency [62, 63, 64, 12, 65] (i.e. dependency on the mesh orien-
tation), the adopted procedure should be accompanied with enhanced FE formulations
at the macro-scale. In the present work, the used Shell FE has an enhancement in the
membrane strain field following the EAS method [66], and in the transverse shear field
following the MITC plate formulation [67, 68]. The adopted element seems to be suffi-
ciently accurate with respect to mesh orientation dependency. The adopted meshes are
given in Figure 20, with a discretization size of 300 mm, 150 mm and 75 mm respectively.

26



(a) h = 300mm (b) h = 150mm (c) h = 75mm

Figure 20: macro-scale meshes used for the multiscale simulations

Figure 21 shows the pressure-deflection curves obtained from the three multiscale analy-
ses, compared to the DNS and experimental results.

 0

 0.5

 1

 1.5

 2

 2.5

 3

 3.5

 4

 4.5

 5

 0  5  10  15  20  25  30  35

Pr
es

su
re

 (k
Pa

)

Deflection (mm)

experimental
micro-model

multiscale model - h=300
multiscale model - h=150
multiscale model - h=75  

Measured deflection

Figure 21: pressure-deflection curves obtained from the multiscale analyses

A satisfactory agreement can be seen between the homogenized responses and the micro-
model response. Also the regularization of the response seems satisfactory, converging
to a meaningful solution upon mesh refinement. A slight difference between the homoge-
nized response and the DNS response can be seen for pressure values ranging from 3 kPa

27



to the peak load, with the homogenized models showing a softer response, thus leading
to a slight overestimation of the displacement at peak strength, while the peak force
is correctly predicted. This is believed to be due to the response given by connection
(corner) between the main wall and the turning wall: in the micro-model, bricks from
the front and lateral walls are physically connected. On the contrary, in the homoge-
nized model this doesn’t happen, with the RVEs being only weakly connected with one
another (i.e. by means of the macroscopic homogenized strain), thus offering a slightly
softer response. However, this initial small difference didn’t seem to affect the overall
response of the wall for the subsequent stages of the analysis.
Next, a detailed comparison between the DNS results and the Multiscale results is given.
Figure 22 shows a comparison between the tensile and compressive damage patterns
obtained from the three meshes used for the multiscale analyses, and those obtained
from the DNS. The failure modes are in very good agreement with the predictions of the
DNS, both in terms of crack-direction and in terms of initial spread of non-linearity (i.e.
before localization into a well defined rotational hinge). Note that the damage index
displayed in the homogenized results is defined as the volume average of the damage
indexes in the RVE, thus can never reach the unity, unless all the elements in RVE are
completely damaged. However this definition of damage has no physical meaning, and
it has been used just for post-process purposes. Real damage values can be retrieved
only from the RVE. The vertical hinge formed in the turning wall near the intersection
with the front wall, developed with a narrow damaged zone, while the diagonal hinges on
the front wall involved a significantly larger damaged zone. This behavior is mainly due
to the redistribution of compressive stresses, initially uniform over the entire wall, and
progressively increasing towards the center of the front wall, as shown in Figure 23. In
fact, as shown in Figure 24, the moment curvature response monitored along the diagonal
hinge (compared to the response monitored on the vertical hinge) showed a more ductile
behavior with a considerable initial hardening, since the shell cross section was there
subjected to significant compressive stresses. Figure 25 shows a comparison in terms of
rotations and out-of-plane deflection. A remarkable agreement can be seen for rotations,
both qualitatively and quantitatively, properly capturing the position and orientation
of the vertical (along the corner) and diagonal (on the front face) rotational hinges, as
predicted by the micro-model analysis. Figure 26 shows a comparison in terms of shell
moments. In this case a satisfactory agreement is found in the overall bending moments
distribution, while, obviously, from a quantitative point of view the peak values showed
by the micro-model are smoothed-out in the multiscale model, since they are average
values obtained from the homogenized response of the RVE.
Finally, Figure 27 shows a last comparison in terms of tensile damage obtained from
the micro-model, the homogenized model, and the actual damage distribution in some
relevant RVEs. It can be noticed how all the relevant failure modes highlighted by the
micro-model are correctly captured by the homogenized one. RVE 1 shows a bending
failure mechanism about the head joints direction. RVE 2, in the bottom-left corner of
the wall, shows a transition from uniaxial bending about the head joints direction to
diagonal bending. RVE 3 and RVE 4 show the damage pattern obtained from diagonal
bending, with RVE 4 being on the localization band defined by the diagonal rotational
hinge. RVE 5, in the center of the wall, shows a bending failure mechanism about the
bed joints direction.

28



Figure 22: Comparison of tensile and compressive damage. Multiscale (first three rows) vs. DNS (last
row)

29



Figure 23: Comparison of minimum principal shell forces [N/mm], after the initial pre-compression (row
1) and at the end of the analysis (row 2). DNS (column 1) vs. Multiscale (column 2).

-0.5

 0

 0.5

 1

 1.5

 2

 2.5

-0.2  0  0.2  0.4  0.6  0.8  1  1.2  1.4

x 103

x 10-4

S
h
el

l 
M

o
m

en
t 

(N
m

m
/m

m
)

Curvature (rad/mm)

Mxx-Kxx
Mxy-Kyy
Mxy-Kxy

(a)

-1.2

-1

-0.8

-0.6

-0.4

-0.2

 0

 0.2

 0.4

 0.6

 0.8

 1

-8 -6 -4 -2  0  2  4  6

x 103

x 10-5

S
h
el

l 
M

o
m

en
t 

(N
m

m
/m

m
)

Curvature (rad/mm)

   Mxx-Kxx
   Mxy-Kyy
   Mxy-Kxy

(b)

Figure 24: homogenized moment-curvature response: (a) at the center of the vertical hinge on the
turning wall; (b) at the center of the bottom diagonal hinge on the front wall

30



Figure 25: Comparison of rotations [rad] (rows 1,2,3) and deflection [mm] (row 4). DNS (column 1) vs.
Multiscale (column 2).

31



Figure 26: Comparison of shell moments [Nmm/mm]. DNS (column 1) vs. Multiscale (column 2).

32



Figure 27: Distribution of tensile damage in some significant RVEs

4.6. Computational cost of micro-scale and multi-scale simulations
Even though computational performance is not the main topic of this work, a brief com-
parison between micro- and multi-scale analyses is given here in terms of computational
costs. For both micro- and multi-scale analyses, the solution strategy consist of a first
stage (from time t = 0 to t = 0.02), for the application of the vertical load, conducted
under load control, and a second stage (from time t = 0.02 to t = 1.0), for the horizontal
pressure, conducted under displacement control. An average time step ∆t = 0.005 is
used. Equilibrium is attained within an average of three iterations per time step. In
both stages, a full Newton-Raphson iterative procedure is used, thus updating the tan-
gent matrix at each iteration. The analyses were carried out on a single machine with an

33



Intel Core i7-2670QM-2.20GHz CPU and 8.00 GB RAM. The code is parallelized with
OpenMP.
For the micro-model analysis, the average elapsed time per iteration is 00:00:43 [hh:mm:ss],
and the total elapsed time is 07:12:27 [hh:mm:ss]. For the multiscale analysis with the
coarsest discretization (h = 300 mm), the average elapsed time per iteration is 00:00:29
[hh:mm:ss], and the total elapsed time is 04:54:30 [hh:mm:ss].
Overall, a slight speed-up from micro- to multi-scale modeling is obtained. Such a limited
speed-up is probably due to the size of the masonry micro-structure, that is comparable
with the FE size at the macro-scale. One could expect more benefits with smaller micro-
structures or with larger structural models. However, the computational cost for a full
non-linear multiscale analysis is still too expensive for using this method with large scale
simulations. It should be noted that in the present implementation, every integration
point of the macro-scale has its own RVE (due to the non-linearity of the problem),
and the multiscale simulation is carried out from the very beginning at every integration
point. A substantial speed-up could be achieved using an adaptive triggering of RVE
simulations only where and when needed, on the line of what has been recently proposed
in [69].

5. Comparison between DNS-3D DNS-shell and multiscale models.

Section 4 presented an experimental-numerical comparison, used to assess the ability of
the proposed framework to represent the behavior of masonry walls when loaded in the
out-of-plane direction. This section gives a concluding example, where a 3D-based DNS,
a shell-based DNS and a shell-based multiscale model are compared. This example is
useful to assess the assumptions made in the shell model and in the shell-homogenization
framework, and the capability of the proposed method to simulate the response of a full
3D model.
The example consists in a simply supported slab, vertically loaded in the center. Due to
symmetry, only one half of the model is analyzed. The geometry is shown in Figure 28.
The same model is analyzed with two DNS, 3D-based and shell-based, respectively (to
assess the ability of the shell to simulate the 3D behavior), and with two shell-based
multiscale simulations, using two discretization sizes of 250 mm and 125 mm respectively
(to assess the regularization with respect to the macro-scale FE size).
Figure 29 shows the comparison of the load-deflection curves of the four analyses, while
Figure 30 shows the damage pattern for the four analyses. A satisfactory agreement can
be found between shell-based DNS and multiscale simulations, and the full 3D simulation.

34



Figure 28: Geometry of the masonry slab. Only one half modeled due to symmetry

 0

 0.2

 0.4

 0.6

 0.8

 1

 1.2

 1.4

 1.6

 1.8

 2

 0  1  2  3  4  5  6  7

V
er

ti
ca

l 
re

ac
ti

o
n
 (

k
N

)

Deflection (mm)

micro-model(3D)
micro-model(shell)

multiscale-model(shell)(coarse)
multiscale-model(shell)(fine)

Figure 29: Load-deflection curves for the DNS and the multiscale models

35



(a)

(b)

(c)

(d)

Figure 30: Tensile damage pattern for (a) 3D DNS, (b) Shell DNS, (c) Shell multiscale (coarse h =
250mm), and (d) Shell multiscale (fine h = 125mm).

6. Conclusions

Classical computational homogenization is now an established tool for the analysis of
complex heterogeneous structures. However, when dealing with thin shell-like structures,
the characteristic size of the micro-structure may approach the thickness of the structural
member, as it happens in one-leaf brick masonry walls, subject of the present study.
In those cases, classical homogenization towards a three dimensional continuum is not
applicable.

36



This paper has proposed a computational homogenization method based on thick shell
theory, able to provide an equivalent homogenous response in terms of generalized strains
and generalized stresses, directly from the nested solution of a RVE. The method is de-
signed to deal with micro-structures that can be considered as an extrusion of a het-
erogeneous surface (as in the case of one-leaf masonry walls), thus being heterogeneous
in the in-plane directions, but (initially) homogeneous in the thickness direction. Under
this hypothesis, both the macro-scale and the micro-scale RVE can be described by shell
theories, greatly simplifying the problem of coupling micro and macro scales.
The proposed method has been applied to the analysis of unreinforced masonry walls un-
dergoing out-of-plane loading. Experimental studies have been numerically reproduced
to assess the capabilities of the method. The proposed methodology has proven to be
rather accurate in reproducing the key aspects of the out-of-plane experimental behav-
ior of URM walls, properly describing all the failure mechanisms beyond the point of
maximum bending strength of the wall.

Acknowledgments

This research has received the financial support from the Graduate School of the Uni-
versity “G. d’Annunzio” of Chieti-Pescara, from the MINECO (Ministerio de Economia
y Competitividad of the Spanish Government) through the MULTIMAS project (Multi-
scale techniques for the experimental and numerical analysis of the reliability of masonry
structures, ref. num. BIA2015-63882-P) and the EACY project (Enhanced accuracy
computational and experimental framework for strain localization and failure mecha-
nisms, ref. MAT2013-48624-C2-1-P). Partial financial support by the ReLUIS (Network
of Earthquake Engineering Experimental Laboratories, funded by the Prime Minister
Office - Civil Protection Department) project is acknowledged and greatly appreciated.
This publication, however, might not necessarily reflect the viewpoint of the Civil Pro-
tection Department.
S. Oller acknowledges the support of the European Research Council under the Advanced
Grant: ERC-2012-AdG 320815 COMP-DES-MAT "Advanced tools for computational
design of engineering materials"

37



References

[1] L. Pelà, M. Cervera, P. Roca, Continuum damage model for orthotropic materials: Application
to masonry, Computer Methods in Applied Mechanics and Engineering 200 (9-12) (2011) 917–930,
ISSN 0045-7825, URL http://www.sciencedirect.com/science/article/pii/S0045782510003257.

[2] L. Pelà, M. Cervera, P. Roca, An orthotropic damage model for the analysis of masonry struc-
tures, Construction and Building Materials 41 (2013) 957–967, ISSN 0950-0618, URL http:
//www.sciencedirect.com/science/article/pii/S0950061812004837.

[3] P. Roca, M. Cervera, G. Gariup, L. Pelà, Structural Analysis of Masonry Historical Constructions.
Classical and Advanced Approaches, Archives of Computational Methods in Engineering 17 (3)
(2010) 299–325, ISSN 1134-3060.

[4] P. B. Lourenço, J. G. Rots, Multisurface interface model for analysis of masonry structures, Journal
of engineering mechanics 123 (7) (1997) 660–668.

[5] P. B. Lourenco, Computational strategies for masonry structures, Ph.D. thesis, TU Delft, Delft
University of Technology, 1996.

[6] D. V. Oliveira, P. B. Lourenço, Implementation and validation of a constitutive model for the cyclic
behaviour of interface elements, Computers & structures 82 (17) (2004) 1451–1461.

[7] A. Drougkas, L. Pelà, P. Roca, Numerical modelling of masonry shear walls failure mechanisms, in:
Proceedings of 9th International Masonry Conference, Guimarães, Portugal, 2014.

[8] C. Citto, Two-dimensional interface model applied to masonry structures, ProQuest, 2008.
[9] L. Gambarotta, S. Lagomarsino, Damage models for the seismic response of brick masonry shear

walls. Part I: The mortar joint model and its applications, Earthquake Engineering & Structural
Dynamics 26 (4) (1997) 423–439, ISSN 1096-9845.

[10] M. L. Raffa, F. Lebon, E. Sacco, H. Welemane, A multi-level interface model for damaged masonry,
in: E. B.H.V. Topping, P. Iv/’anyi (Ed.), "Proceedings of the Fourteenth International Conference
on Civil, Structural and Environmental Engineering Computing", Civil-Comp Press, Stirlingshire,
UK, 2013.

[11] E. Sacco, J. Toti, Interface Elements for the Analysis of Masonry Structures, International Journal
for Computational Methods in Engineering Science and Mechanics 11 (6) (2010) 354–373, URL
http://www.tandfonline.com/doi/abs/10.1080/15502287.2010.516793.

[12] L. Pelà, M. Cervera, S. Oller, M. Chiumenti, A localized mapped damage model for orthotropic
materials, Engineering Fracture Mechanics 124-125 (2014) 196–216, ISSN 0013-7944, URL http:
//www.sciencedirect.com/science/article/pii/S0013794414001386.

[13] P. B. Lourenço, Anisotropic softening model for masonry plates and shells, Journal of Structural
Engineering 126 (9) (2000) 1008–1016.

[14] D. Addessi, E. Sacco, A. Paolone, Cosserat model for periodic masonry deduced by nonlinear
homogenization, European Journal of Mechanics-A/Solids 29 (4) (2010) 724–737.

[15] E. Bosco, V. Kouznetsova, M. Geers, Multi-scale computational homogenization–localization for
propagating discontinuities using X-FEM, International Journal for Numerical Methods in Engi-
neering 102 (3-4) (2015) 496–527.

[16] M. L. De Bellis, A Cosserat based multi-scale technique for masonry structures, in: PHD Thesis,
2009.

[17] M. L. De Bellis, D. Addessi, A Cosserat based multi-scale model for masonry structures, Interna-
tional Journal for Multiscale Computational Engineering 9 (5).

[18] E. A. D. S. Neto, R. A. Feijóo, Variational Foundations of Multi-Scale Constitutive Models of Solid:
Small and Large Strain Kinematical Formulation, LNCC Research and Development (16).

[19] M. Geers, V. G. Kouznetsova, W. A. M. Brekelmans, MultiScale First-Order and Second-Order
Computational Homogenization of Microstructures towards Continua, International Journal for
Multiscale Computational Engineering 1 (4), ISSN 1543-1649.

[20] J. A. Hernández, J. Oliver, A. E. Huespe, M. Caicedo, High-Performance Model Reduction Proce-
dures in Multiscale Simulations, 127, Monograph CIMNE, 2012.

[21] V. Kouznetsova, M. Geers, W. Brekelmans, Multi-scale second-order computational homogenization
of multi-phase materials: a nested finite element solution strategy, Computer Methods in Applied
Mechanics and Engineering 193 (2004) 5525–5550, ISSN 0045-7825.

[22] V. Kouznetsova, M. G. D. Geers, W. A. M. Brekelmans, Multi-scale constitutive modelling of hetero-
geneous materials with a gradient-enhanced computational homogenization scheme, International
Journal for Numerical Methods in Engineering 54 (8) (2002) 1235–1260, ISSN 1097-0207.

[23] T. J. Massart, Multi-scale modeling of damage in masonry structures .
[24] T. Massart, R. Peerlings, M. Geers, An enhanced multi-scale approach for masonry wall compu-

38

http://www.sciencedirect.com/science/article/pii/S0045782510003257
http://www.sciencedirect.com/science/article/pii/S0950061812004837
http://www.sciencedirect.com/science/article/pii/S0950061812004837
http://www.tandfonline.com/doi/abs/10.1080/15502287.2010.516793
http://www.sciencedirect.com/science/article/pii/S0013794414001386
http://www.sciencedirect.com/science/article/pii/S0013794414001386


tations with localization of damage, International Journal for Numerical Methods in Engineering
69 (5) (2007) 1022–1059.

[25] B. Mercatoris, P. Bouillard, T. Massart, Multi-scale detection of failure in planar masonry thin
shells using computational homogenisation, Engineering fracture mechanics 76 (4) (2009) 479–499.

[26] B. Mercatoris, T. Massart, A coupled two-scale computational scheme for the failure of periodic
quasi-brittle thin planar shells and its application to masonry, International journal for numerical
methods in engineering 85 (9) (2011) 1177–1206.

[27] X. Oliver Olivella, M. A. Caicedo Silva, E. Roubin, A. E. Huespe, et al., Continuum approach to
computational multi-scale modeling of fracture, Key engineering materials 627 (2014) 349–352.

[28] J. Oliver, I. Dias, A. E. Huespe, Crack-path field and strain-injection techniques in computational
modeling of propagating material failure, Computer Methods in Applied Mechanics and Engineering
274 (2014) 289–348.

[29] J. Oliver, M. Caicedo, E. Roubin, J. Hernández, A. Huespe, Multi-scale (FE2) analysis of mate-
rial failure in cement/aggregate-type composite structures, Computational Modelling of Concrete
Structures (2014) 39.

[30] S. Oller, J. Miquel Canet, F. Zalamea, Composite material behavior using a homogenization double
scale method, Journal of Engineering mechanics 131 (1) (2005) 65–79.

[31] J. M. Ortolano, J. A. Hernández, J. Oliver, A Comparative Study on Homogenization Strategies
for Multi-Scale Analysis of Materials, 135, Monograph CIMNE, 2013.

[32] F. Otero, X. Martínez, S. Oller, O. Salomón, Study and prediction of the mechanical performance
of a nanotube-reinforced composite, Composite Structures 94 (2012) 2920–2930.

[33] F. Otero, S. Oller, X. Martinez, O. Salomón, Numerical homogenization for composite materials
analysis. Comparison with other micro mechanical formulations, Composite Structures 122 (2015)
405–416.

[34] H. A. Badillo, Numerical modelling based on the multiscale homogenization theory. Application in
composite materials and structures, Ph.D. thesis, Universitat Politécnica de Catalunya BarcelonaT-
ech, 2012.

[35] R. D. Quinteros, S. Oller, L. G. Nallim, Nonlinear homogenization techniques to solve masonry
structures problems, Composite Structures 94 (2) (2012) 724–730.

[36] P. Trovalusci, R. Masiani, Non-linear micropolar and classical continua for anisotropic discontinuous
materials, International Journal of Solids and Structures 40 (5) (2003) 1281–1297.

[37] A. Zucchini, P. Lourenço, A micro-mechanical model for the homogenisation of masonry, Interna-
tional Journal of Solids and Structures 39 (12) (2002) 3233–3255.

[38] A. Zucchini, P. B. Lourenço, A micro-mechanical homogenisation model for masonry: Application
to shear walls, International Journal of Solids and Structures 46 (3) (2009) 871–886.

[39] V. P. Nguyen, M. Stroeven, L. J. Sluys, Multiscale continuous and discontinuous modeling of
heterogeneous materials: A review on recent developments, Journal of Multiscale Modelling 3 (04)
(2011) 229–270.

[40] T. Belytschko, S. Loehnert, J.-H. Song, Multiscale aggregating discontinuities: a method for cir-
cumventing loss of material stability, International Journal for Numerical Methods in Engineering
73 (6) (2008) 869–894.

[41] M. Petracca, L. Pelà, R. Rossi, S. Oller, G. Camata, E. Spacone, Regularization of first order com-
putational homogenization for multiscale analysis of masonry structures, Computational Mechanics
57 (2) (2016) 257–276, ISSN 1432-0924, URL http://dx.doi.org/10.1007/s00466-015-1230-6.

[42] M. Geers, E. Coenen, V. Kouznetsova, Multi-scale computational homogenization of structured
thin sheets, Modelling and Simulation in Materials Science and Engineering 15 (4) (2007) S393.

[43] M. Geers, V. Kouznetsova, W. Brekelmans, Multi-scale computational homogenization: Trends and
challenges, Journal of computational and applied mathematics 234 (7) (2010) 2175–2182.

[44] E. Coenen, V. Kouznetsova, M. Geers, Computational homogenization for heterogeneous thin
sheets, International Journal for Numerical Methods in Engineering 83 (8-9) (2010) 1180–1205.

[45] Y. Cong, S. Nezamabadi, H. Zahrouni, J. Yvonnet, Multiscale computational homogenization of
heterogeneous shells at small strains with extensions to finite displacements and buckling, Interna-
tional Journal for Numerical Methods in Engineering 104 (4) (2015) 235–259.

[46] R. Grytz, G. Meschke, Computational homogenization in multi-scale shell analysis at large strains,
in: III European Conference on Computational Mechanics (ECCM 2006), 592, 2006.

[47] M. Griffith, J. Vaculik, Out-of-plane flexural strength of unreinforced clay brick masonry walls,
TMS Journal 25 (1) (2007) 53–68.

[48] G. Cowper, The shear coefficient in Timoshenko’s beam theory, Journal of applied mechanics 33 (2)
(1966) 335–340.

39

http://dx.doi.org/10.1007/s00466-015-1230-6


[49] R. De Borst, The zero-normal-stress condition in plane-stress and shell elastoplasticity, Communi-
cations in applied numerical methods 7 (1) (1991) 29–33.

[50] R. Hill, A self-consistent mechanics of composite materials, Journal of the Mechanics and Physics
of Solids 13 (4) (1965) 213–222.

[51] J. Mandel, Plasticité classique et viscoplasticité, Springer-Verlag, 1971.
[52] P. Dadvand, R. Rossi, E. Oñate, An object-oriented environment for developing finite element codes

for multi-disciplinary applications, Archives of computational methods in engineering 17 (3) (2010)
253–297.

[53] P. Dadvand, R. Rossi, M. Gil, X. Martorell, J. Cotela, E. Juanpere, S. R. Idelsohn, E. Oñate,
Migration of a generic multi-physics framework to HPC environments, Computers & Fluids 80
(2013) 301–309.

[54] GiD: The personal pre and post preprocessor, 2002.
[55] M. Cervera, J. Oliver, R. Faria, Seismic evaluation of concrete dams via continuum damage models,

Earthquake engineering & structural dynamics 24 (9) (1995) 1225–1245.
[56] R. Faria, J. Oliver, M. Cervera, A strain-based plastic viscous-damage model for massive concrete

structures, International Journal of Solids and Structures 35 (14) (1998) 1533–1558.
[57] J. Y. Wu, J. Li, R. Faria, An energy release rate-based plastic-damage model for concrete, Interna-

tional Journal of Solids and Structures 43 (3) (2006) 583–612.
[58] J. Lubliner, J. Oliver, S. Oller, E. Oñate, A plastic-damage model for concrete, International Journal

of solids and structures 25 (3) (1989) 299–326.
[59] Z. Bažant, B. Oh, Crack Band Theory for Fracture of Concrete, Bordas-Dunod, URL http://

books.google.it/books?id=x9citwAACAAJ, 1983.
[60] J. Oliver, A consistent characteristic length for smeared cracking models, International Journal for

Numerical Methods in Engineering 28 (2) (1989) 461–474.
[61] S. Oller, Fractura Mecánica: Un Enfoque Global, Ediciones CIMNE y UPC, 2001.
[62] M. Cervera, M. Chiumenti, R. Codina, Mixed stabilized finite element methods in nonlinear solid

mechanics. Part II: Strain Localization, Computer Methods in Applied Mechanics and Engineering
199 (37) (2010) 2571–2589.

[63] L. Benedetti, M. Cervera, M. Chiumenti, Stress-accurate Mixed FEM for soil failure under shallow
foundations involving strain localization in plasticity, Computers and Geotechnics 64 (2015) 32–47.

[64] M. Cervera, L. Pelà, R. Clemente, P. Roca, A crack-tracking technique for localized damage in
quasi-brittle materials, Engineering Fracture Mechanics 77 (13) (2010) 2431–2450.

[65] S. Saloustros, L. Pelà, M. Cervera, A crack-tracking technique for localized cohesive-frictional dam-
age, Engineering Fracture Mechanics 150 (2015) 96–114, ISSN 0013-7944, URL http://dx.doi.
org/10.1016/j.engfracmech.2015.10.039.

[66] J. C. Simo, M. Rifai, A class of mixed assumed strain methods and the method of incompatible
modes, International Journal for Numerical Methods in Engineering 29 (8) (1990) 1595–1638.

[67] E. N. Dvorkin, K.-J. Bathe, A continuum mechanics based four-node shell element for general
non-linear analysis, Engineering computations 1 (1) (1984) 77–88.

[68] K.-J. Bathe, E. N. Dvorkin, A four-node plate bending element based on Mindlin/Reissner plate
theory and a mixed interpolation, International Journal for Numerical Methods in Engineering
21 (2) (2005) 367–383.

[69] F. Otero, X. Martinez, S. Oller, O. Salomón, An efficient multi-scale method for non-linear analysis
of composite structures, Composite Structures 131 (2015) 707–719.

40

http://books.google.it/books?id=x9citwAACAAJ
http://books.google.it/books?id=x9citwAACAAJ
http://dx.doi.org/10.1016/j.engfracmech.2015.10.039
http://dx.doi.org/10.1016/j.engfracmech.2015.10.039

	Introduction
	Computational homogenization framework
	Shell kinematics
	Shell constitutive response: through-the-thickness integrated cross section
	Down-scaling or macro-micro transition and constraint conditions
	Solution of the micro-scale BVP
	Up-scaling or micro-macro transition
	Typical deformation modes obtained from the shell homogenization framework

	Fracture-energy regularization in 2-scale FE computational homogenization
	Numerical modeling of out-of-plane loaded masonry walls
	Experimental test
	Tension/Compression continuum damage model
	Constitutive Model
	Failure Criteria
	Evolution laws for damage variables

	RVE and material parameters
	Micro-modeling or direct numerical simulation
	Multiscale simulation
	Computational cost of micro-scale and multi-scale simulations

	Comparison between DNS-3D DNS-shell and multiscale models.
	Conclusions
	References

