



















































































Reduced order modeling strategies for computational multiscale fracture


Available online at www.sciencedirect.com

ScienceDirect

Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595
www.elsevier.com/locate/cma

Reduced order modeling strategies for computational multiscale
fracture

J. Olivera,b,∗, M. Caicedoa, A.E. Huespea,c, J.A. Hernándezb,d, E. Roubine

a E.T.S d’Enginyers de Camins, Canals i Ports, Technical University of Catalonia (BarcelonaTech), Campus Nord UPC, Mòdul C-1, c/ Jordi
Girona 1-3, 08034, Barcelona, Spain

b CIMNE – Centre Internacional de Metodes Numerics en Enginyeria, Campus Nord UPC, Mòdul C-1, c/ Jordi Girona 1-3, 08034, Barcelona,
Spain

c CIMEC-UNL-CONICET, Güemes 3450, Santa Fe, Argentina
d Escola Superior d’Enginyeries Industrial, Aerospacial i Audiovisual de Terrassa, Technical University of Catalonia (BarcelonaTech), C/Colom

11, 08222, Terrassa, Spain
e Laboratoire 3SR, Université Grenoble Alpes (UGA), CNRS Domaine Universitaire, 38000 Grenoble Cedex, France

Received 6 May 2016; received in revised form 23 August 2016; accepted 27 September 2016
Available online 14 October 2016

Highlights

• The RVE homogenization is stated in terms of a saddle-point problem.
• RVE unknowns are unconventionally rephrased in terms of the fluctuation strains.
• Separate Reduced Order Models are used in the RVE elastic and inelastic domains.
• HPROM combines Reduced Order Modeling and Reduced Optimal Quadrature techniques.
• Results exhibit outstanding speedups for multi-scale fracture problems.

Abstract

The paper proposes some new computational strategies for affordably solving multiscale fracture problems through a FE2

approach. To take into account the mechanical effects induced by fracture at the microstructure level the Representative Volume
Element (RVE), assumed constituted by an elastic matrix and inclusions, is endowed with a large set of cohesive softening bands
providing a good representation of the possible microstructure crack paths. The RVE response is then homogenized in accordance
with a model previously developed by the authors and upscaled to the macro-scale level as a continuum stress–strain constitutive
equation, which is then used in a conventional framework of a finite element modeling of propagating fracture.

For reduced order modeling (ROM) purposes, the RVE boundary value problem is first formulated in displacement fluctuations
and used, via the Proper Orthogonal Decomposition (POD), to find a low-dimension space for solving the reduced problem. A
domain separation strategy is proposed as a first technique for model order reduction: unconventionally, the low-dimension space
is spanned by a basis in terms of fluctuating strains, as primitive kinematic variables, instead of the conventional formulation in
terms of displacement fluctuations. The RVE spatial domain is then decomposed into a regular domain (made of the matrix and the
inclusions) and a singular domain (constituted by cohesive bands), the required RVE boundary conditions are rephrased in terms

∗ Corresponding author at: CIMNE – Centre Internacional de Metodes Numerics en Enginyeria, Campus Nord UPC, Mòdul C-1, c/ Jordi Girona
1-3, 08034, Barcelona, Spain.

E-mail address: xavier.oliver@upc.edu (J. Oliver).

http://dx.doi.org/10.1016/j.cma.2016.09.039
0045-7825/ c⃝ 2016 The Authors. Published by Elsevier B.V. This is an open access article under the CC BY-NC-ND license (http://
creativecommons.org/licenses/by-nc-nd/4.0/).

http://crossmark.crossref.org/dialog/?doi=10.1016/j.cma.2016.09.039&domain=pdf
http://www.elsevier.com/locate/cma
http://dx.doi.org/10.1016/j.cma.2016.09.039
http://www.elsevier.com/locate/cma
mailto:xavier.oliver@upc.edu
http://dx.doi.org/10.1016/j.cma.2016.09.039
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/


J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 561

of strains and imposed via Lagrange multipliers in the corresponding variational problem. Specific low-dimensional strain basis is
then derived, independently for each domain, via the POD of the corresponding strain snapshots.

Next step consists of developing a hyper-reduced model (HPROM). It is based on a second proposed technique, the Reduced
Optimal Quadrature (ROQ) which, again unconventionally, is determined through optimization of the numerical integration of the
primitive saddle-point problem arising from the RVE problem, rather than its derived variational equations, and substitutes the
conventional Gauss quadrature. The ROQ utilizes a very reduced number of, optimally placed, sampling points, the corresponding
weights and placements being evaluated through a greedy algorithm. The resulting low-dimensional and reduced-quadrature
variational problem translates into very relevant savings on the computational cost and high computational speed-ups.

Particular attention is additionally given to numerical tests and performance evaluations of the new hyper-reduced methodology,
by “a-priori” and “a-posteriori” error assessments. Moreover, for the purposes of validation of the present techniques, a real
structural problem exhibiting propagating fracture at two-scales is modeled on the basis of the strain injection-based multiscale
approach previously developed by the authors. The performance of the proposed strategy, in terms of speed-up vs. error, is deeply
analyzed and reported.
c⃝ 2016 The Authors. Published by Elsevier B.V. This is an open access article under the CC BY-NC-ND license (http://

creativecommons.org/licenses/by-nc-nd/4.0/).

Keywords: Reduced Order Modeling (ROM); Hyper-Reduced Order Modeling (HPROM); Multiscale fracture models; Computational
homogenization; Reduced Optimal Quadrature (ROQ)

Acronyms

BVP: Boundary Value Problem
CSDA: Continuum-Strong Discontinuity Approach
EFEM: Embedded Finite Element Methodology
FE2: Two-scale (macro and micro or meso) model, where both scales of analysis are represented by finite element
approaches
HF: High Fidelity model
HPROM: HyPer-Reduced Order Modeling
OQN: Optimal Quadrature Number
POD: Proper Orthogonal Decomposition
ROM: Reduced Order Modeling
ROQ: Reduced Optimal Quadrature
RVE: Representative Volume Element
SVD: Singular Value Decomposition
VBVP: Variational Boundary Value Problem

Symbols

Number of dimensions of vectors or vectorial spaces

nσ : Number of components of the stress and strain (or micro-stress and micro-strain) vectors described with
Voigt’s notation, typically: for strains and stresses in plane states: nσ = 4, and ε = [εxx , εyy, εzz, εxy]

T or
σ = [σxx , σyy, σzz, σxy]

T .
nε: Dimension of the reduced micro-strain fluctuation space (number of basis of Ψ spanning the full space of

reduced micro-strains).
n Iε,reg: Dimension of the reduced micro-strain fluctuation space Ψ

I
reg associated with the inelastic snapshots and

Gauss points in the regular domain (Bµ,reg).
n I
ε,coh : Dimension of the reduced micro-strain fluctuation space Ψ

I
coh associated with the inelastic snapshots and

Gauss points in the domain of cohesive bands (Bµ,coh).
nϕ : Dimension of the reduced micro internal energy space (number of basis of Φ spanning the full space of

reduced micro-internal energy ϕµ).

http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/


562 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

Number of quadrature points

Ng: Number of Gauss points associated with the original HF finite element mesh.
Ng,reg: Number of Gauss points of the HF model in the micro-cell regular domain (Bµ,reg).
Ng,coh : Number of Gauss points of the HF model in the micro-cell domain of the cohesive bands (Bµ,coh).
Nr : Number of quadrature points adopted for the ROQ scheme.

Other symbols

psnp: Number of micro-strain snapshots taken during the off-line sampling process constituting the micro-strain
snapshot matrix [X].

qsnp: Number of micro-energy snapshots taken during the off-line sampling process constituting the
micro-energy snapshot matrix [Xφ].

1. Introduction

Multiscale modeling is expected to become a key approach to enable the next wave of design paradigms for
engineering materials and structures. Indeed, it appears as an excellent potential setting to account for the physical
links between the different lower scale components, within the material (grains, particles, defects, inclusions, etc.), and
the overall large scale properties. However, this modeling concept, coined by the scientific community some decades
ago, is not yet part of the routinely engineering analysis and design methods. Quoting from a report by a group of
experts to the US National Science Foundation [1]

“. . . . In recent years, a large and growing body of literature in physics, chemistry, biology, and engineering
has focused on various methods to fit together simulation models of two or more scales, and this has led to the
development of various multi-level modeling approaches. . . .. To date, however, progress on multiscale modeling
has been agonizingly slow. Only a series of major breakthroughs will help us establish a general mathematical
and computational framework for handling multiscale events and reveal to us the commonalities and limitations
of existing methods . . . .”.

Certainly, and focusing on the specific case of computational homogenization-based multiscale techniques, they
can hardly be applied beyond some simple and academic purposes. Reasons for this arise from the multiplicative
character of the algorithmic complexity,1 and the corresponding computational cost, for hierarchical micro/macro
computations in multiscale analyses. A representative example of this challenge is the computational two-scale
modeling of structural fracturing materials, where a detailed geometrical description of the material morphology and
failure propagation is necessary at the low scale, in conjunction with a very fine representation of the crack distribution
and propagation at the upper scale.

On the other hand, model order reduction (data compression) techniques have become an intensive research field
in the computational mechanics community, because of the increasing interest on computational modeling of complex
phenomena in large scale multiphysics problems.

This work deals with a combination of both subjects by focusing on the reduced order modeling of computational
multiscale modeling of fracturing materials. Several works on fracture multiscale modeling using the Representative
Volume Element (RVE) notion have been published in the recent years, a (not complete) list is [2–7]. In this work, the
multiscale framework for numerical modeling of structural fracture in heterogeneous quasi-brittle materials, described
in [8], which overcomes some of the classically encountered difficulties for this type of approaches, is utilized as start
point. In short, it can be defined as a FE2 approach (see [9]), where the Continuum-Strong Discontinuity Approach
(CSDA) is used at the macroscale. Only a brief overview of this technique is presented in Appendix A.

Contrarily, emphasis is given in this work to the RVE modeling, i.e. the finite element approach at the micro
(or meso) scale of the problem. The objective here is to develop a Hyper-Reduced Order Model (HPROM) of the

1 Here understood as the number of numerical operations to be performed in the considered algorithm.



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 563

RVE finite element model. The most strong and motivating argument for developing a reduced order model of a
non-linear RVE problem, within a FE2 framework, stems from the following reason: during the online computation
of a multiscale problem, the RVE problem has to be solved a very large number of times.2 This relevant feature must
be taken into account for selecting an adequate HPROM. Moreover, since the parametric space of the RVE driving
forces is small,3 techniques based on off-line micro-cell sampling, such as the one proposed in this work, seem to be
feasible.

Development of reduced models for non-homogeneous materials has been tackled in numerous previous
contributions, such as [10], where the proposed reduction techniques are based on Fourier’s transforms, or [11], where
a reduced model is applied to homogenization analysis of hyperelastic solids subjected to finite strains. Also, the work
in [12] developed a hyper-reduced model of a monoscale analysis considering non-linear material behavior. However,
the existing literature barely considers reduced order modeling of non-smooth problems, as is the case of fracture,
where discontinuous displacements occur. The multiscale case, when fracture is also considered at the smaller scale
of the problem, makes the task even much heavier. Indeed, only very few contributions have been presented in the
literature about this topic, see for example: [13], which follows an eigendeformation-based methodology, or [14,15]
that resort to global–local approaches.

In this work, a number of techniques are combined to optimize the HPROM performance of FE2 multiscale
modeling algorithms for multiscale propagating fracture. They are:

1. A domain separation strategy. The RVE is split into the regular domain (made of the elastic matrix and possible
inclusions) and the singular domain (the cohesive bands exhibiting a softening cohesive behavior), which are
designed to provide a good enough representation of the microscopic fracture and of its effects on the homogenized
material behavior [8]. The distinct constitutive behavior of both domains suggests a specific ROM strategy
for each of them in order to obtain a reduction strategy keeping available the information on the mechanical
variables in every specific sub-domain. Therefore, selection of the ROM low-dimensional projection space is made
independently for each of these domains.

2. In combination with the previous strategy, the ROM boundary problem for the RVE is formulated in an
unconventional manner i.e.: in terms of the strain fluctuations rather than in terms of the conventional displacement
fluctuations. The reduced strain fluctuation space is spanned by basis functions satisfying, by construction, the
kinematical compatibility conditions, this guaranteeing that, after reduction, any solution in the strain fluctuation
space also satisfies the kinematical compatibility.

3. A specific Reduced Optimal Quadrature (ROQ) is used as a key technique to obtain relevant computational cost
reduction from the ROM. This technique, consisting of replacing the standard Gauss integration rule over the
whole finite element mesh by a different optimal quadrature involving much less sampling points, has been
proposed in recent works [16,17] as an ingredient of HyPer-Reduced Order Modeling (HPROM) strategies. In
these works, the reduced numerical integration technique is applied to the variational equations of the problem
(i.e. internal forces, involving n-dimensional vector entities) whereas, in the herein proposed approach, a similar
reduced integration technique is applied, again unconventionally, to the primitive problem, i.e: the functional (a
scalar entity) in the micro-scale saddle-point problem that supplies the RVE variational equations. In the present
proposal, this functional turns out to be the stored energy (free energy) at the RVE, which, being a scalar entity, is
less demanding as for the integration rule is concerned. This is expected to translate into very relevant savings in
both the numerical ROQ derivation procedure and the resulting computational cost.

The above techniques are combined to provide the proposed HPROM strategy for the RVE, using a standard two-stage
(off-line/on-line) strategy:

(I) OFF-LINE STAGE
– A sampling program of the high-fidelity RVE finite element model is performed with the objective of gathering

a set of solutions (snapshots) of micro-strain fluctuations, at the regular and singular RVE domains, as well as
the corresponding snapshots of the energy functional in the RVE variational principle.

2 Typically, as many times as sampling points are considered at the upper-scale times the number of iterations involved in the solution of the
non-linear problem.

3 As many of relevant strain dimensions in the RVE problem: 3 in 2-D cases and 6 in 3D cases.



564 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

– Through POD techniques, applied to the snapshots sets, the reduced bases (modes) for the regular and singular
micro-strain fluctuations and energies are computed.

– The ROQ rule, stated in terms of the placement of the sampling points and the corresponding integration weights
at the regular and singular domains, is determined on the basis of an optimal integration of the considered free
energy modes.

(II) ON-LINE STAGE
– The information collected in stage (I) (micro-strain fluctuation bases and reduced integration rule) is used for

the on-line solution, in stage (II) of a reduced problem. The micro-strain fluctuation projections onto the reduced
strain bases are now the unknowns, and the new HPROM problem is set in terms of the new ROM saddle-point
functional integrated with the Reduced Optimal Quadrature (ROQ).

In the remaining of this work, this strategy for HPROM of the RVE problem is detailed. After presenting, in Section 2,
a brief summary of the multiscale fracture model already presented by the authors elsewhere in [8] (and additionally
detailed in Appendix A), in Section 3 the BVP of the RVE is shown. Then, in Section 3.2, the ROM procedure is
developed by approaching the micro-strain fluctuation fields through the obtained low-dimensional spaces. Finally, a
technique to derive the Reduced Optimal Quadrature (ROQ) rule is proposed in Section 3.3.

It is emphasized that the ROQ rule described in this work is not only restricted to multiscale approaches, but
it can rather easily be extended and applied to more general mechanical problems. In order to sketch a possible
generalization of this technique, in Appendix B a summarized description of the ROQ procedure for a fairly general
family of non-linear solid mechanics problems is presented.

An important issue in developing an efficient HPROM method is the design of the off-line testing program. It
should be devised to obtain a representative set of RVE solutions, appropriately spanning the parametric space of the
RVE actions (the macroscopic strains). In Section 4.1 a devised sampling program for the high-fidelity RVE finite
element model is presented.

In Section 5, the a-priori and consistency errors of the HPROM model are studied. Additional assessment of the
model is then done for realistic structural problems exhibiting propagating fracture at the macro-scale. The work ends
with some concluding remarks in Section 6.

2. Multiscale mechanical model for propagating fracture

Let us consider the fracture problem of a body B composed of a heterogeneous material, which is modeled using
the multiscale technique developed in [8]. Although, here it is not paid attention to this multiscale technique, but to
its computational cost reduction, a summary of the main ingredients of the former has to be presented in order to
understand the proposed cost reduction procedure. Therefore, a sketch of the multiscale model is presented in Fig. 1
and it is outlined in the following items.

• Two scales of analysis, macro and micro (or meso) scales, are considered within a semi-concurrent FE2 approach
(see [9]). Every point at the macroscale is associated with an RVE (also termed here micro-cell) which, through
a convenient homogenization procedure, provides the effective constitutive response of the material at the
macroscale. The micro-cell model accounts for the material morphology at the lower scale.
• The failure process at the macroscale is characterized by cracks modeled with the Continuum-Strong Discontinuity

Approach (CSDA). This approach, with applications to monoscale fracture analysis, has been widely developed
by the authors in the past, see [18–21]. Briefly, this technique assumes a strong discontinuity kinematics
(i.e including displacement jumps in the crack paths), which is regularized by introducing very thin bands,
denoted Bloc, see Fig. 1(a), where strain localization can take place. The actual displacement discontinuities
are regularized inside these bands as highly localized strains (Fig. 1(b)). Cohesive forces in Bloc are calculated
with the stresses σ , evaluated inside these bands in terms of the localized strains rather than in terms of the
displacement jumps used in the more conventional discrete approaches governed by traction-separation laws.
The fact that in the CSDA the constitutive model is a continuum (stress–strain) one, makes this approach more
compatible with conventional computational homogenization procedures. Therefore, σ is evaluated everywhere
in B through a standard homogenization procedure involving a micro-cell which takes into account the material
micro-heterogeneity.



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 565

Fig. 1. Outline of the multiscale model for propagating fracture: (a) macro and micro-scales; (b) micro-cell model accounting for material failure.

• At the micro-cell (or RVE), material failure is modeled, using again the CSDA, through a large number of
predefined finite thickness micro-bands4 endowed with a very simple stress–strain continuum damage constitutive
law (see [22,23]). Activation of a given failure mechanism at the micro-cell, i.e. activation of the damage process
in a set of micro-bands, triggers a strain localization effect at the macroscale which finally leads to the formation
of a strong discontinuity (macro-crack). The strong discontinuity mechanism at the macroscale induced by strain
localization, as well as the propagating crack phenomenon represented by this mechanism, is properly captured
with finite elements enriched with a specific kinematics.

Since, as commented above, the objective of this work is to provide a reduced model of the RVE problem, emphasis
is only given to the RVE modeling. Additional details of the multiscale technique can be found in Appendix A and
the reference work [8].

2.1. Notation adopted in this work

The body domain at the macroscale is denoted B (B ⊂ Rndim and ndim is the space dimension), while Bloc indicates
the subdomain where strain localization happens, see Fig. 1(a). It is assumed that Bloc is a band of finite thickness h,
with a mean surface having a unit normal vector n. Points at macroscale are identified by x and displacements, strains
and stresses by u, ε and σ , respectively.

All geometrical entities and variables at the microscale are identified with the subindex (·)µ (so, Bµ is the micro-
cell domain at the microscale). In correspondence with the macro-scale fields, displacements, strains and stresses are
described at the microscale as uµ, εµ and σµ, respectively. Points at the microscale are denoted y.

Tensor notation vs. Voigt’s notation
In this work both notations are in accordance with the following criteria:

(a) conventional tensor notation, is used in the original, not-reduced, formulations of the micro-scale variational
problem. Being the space of the symmetric second order tensors: Sndim×ndim , then, typically stresses and strains,
are identified as: ε, σ ∈ Sndim×ndim . Double contraction of second order tensors is written as: (σµ : ε̃µ).

(b) Voigt’s notation, utilized in the reduced model formulations and their implementations. In this notation, strains
and stresses are described as column vectors: (ε, σ ∈ Rnσ , nσ = 4 in plane states of stress or strain). Fourth order
tensors are described by matrices in Rnσ×nσ . Double contraction of second order tensors is written as a vector
product in matrix form, i.e. (σµ)

T ε̃µ.
(c) The same symbol is used to identify identical entities in both notations. The proper context of every equation

determines which specific notation is used. For example, by writing ε ∈ Sndim×ndim it is understood that the strain,
and the corresponding equation, are expressed in tensor notation, while writing ε ∈ Rnσ , refers that the same
entity is expressed in Voigt’s notation.

4 Large enough to provide a good representation of the microscopic fracture variables relevant for the macroscopic homogenized constitutive
behavior.



566 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

2.2. Micro-cell model accounting for material failure: Variational boundary value problem (VBVP)

Let us consider the micro-cell Bµ sketched in Fig. 1(b), of size hµ, and boundary Γµ with unit normal vector
denoted by νµ. This micro-cell is large enough to satisfy the conditions of being a RVE.

5 The displacement field at
the microscale, denoted uµ, can be taken as the addition of three terms:

uµ(y) = u+ ε · y+ ũµ(y). (1)

The terms u and ε are the macro-scale displacement and strain, respectively, down-scaled to the RVE. The
displacement fluctuation field, ũµ(y) is the relevant term in the governing equations of the RVE problem. The micro-
strain εµ in the RVE is given by the addition of two terms

6:

εµ(y) = ε + ε̃µ(y) = ε +∇
s ũµ(y) ∀y ∈ Bµ, (2)

where the macro-strain ε is homogeneously distributed in Bµ, while the compatible micro-strain fluctuation, ε̃µ, is
the symmetric gradient of the displacement fluctuation field satisfying:

Bµ
ε̃µ d B =


Bµ
∇

s ũµ d B =

Γµ

ũµ⊗
s
νµ dΓ = 0. (3)

The last identity in (3) is obtained by applying the Green’s theorem to transform the volume integral, in Bµ, into the
surface integral, on Γµ.

From the kinematical constraint (3), we define the space U uµ of admissible displacement fluctuations
7:

U uµ :=


ũµ |

Γµ

ũµ⊗
s
νµ dΓ = 0


. (4)

Eqs. (1)–(4), plus the constitutive and equilibrium equations that should be satisfied at the RVE (described in
Appendix A but not repeated here, see Eqs. (76)–(79)), define a conventional Variational Boundary Value Problem
(VBVP) at the RVE where the actions (driving force) are the macro-strains, ε. A summary of the governing equations,
identified as PROBLEM I, is given next.

PROBLEM I (RVE variational displacement fluctuation-based problem)
Given the macroscale strain, ε, the space of displacement fluctuations, U uµ, and the space of admissible
displacement fluctuations V uµ:

U uµ = V
u
µ :=


ũµ |


Bµ

ε̃µ d B =

Γµ

ũµ ⊗
s
νµ dΓ = 0


; (5)

find ũµ ∈ U uµ such that:
Bµ

σµ(εµ, dµ) : ∇
s ûµ d B = 0; ∀ûµ ∈ V uµ; (6)

ḋµ(y, εµ) = g(εµ, dµ) (7)

Eq. (6) is the variational equilibrium equation in terms of the micro-stresses σµ. Implicitly in the same expression
have been considered the constitutive equation relating σµ in terms of the micro-strains, εµ, and internal damage
variable, dµ. While (7) describes the pointwise evolution law for this internal variable.

5 Micro-cell or RVE terms will be indistinctly used in this work.
6 Without dropping out the emphasis given to the fact that variables are typically load history-dependent, from now on references to time will be

omitted unless it is necessary.
7 The HPROM procedure presented in Section 3 is not restricted to deal with RVE models having minimum kinematical constraints defined by

Eq. (3) and the vectorial space (4) associated to it. In fact, and due to the linear properties of the SVD algorithms, the HPROM can be applied, with
no further modification, to the cases of homogeneous boundary conditions defined in every subdomain of the partitioned RVE (Bµ,reg and Bµ,coh).
Therefore, the proposed techniques can be used in RVE models having periodic boundary conditions.



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 567

2.3. Alternative descriptions of the micro-cell VBVP

2.3.1. Formulation in micro-strain fluctuations
As it will be shown later, for hyper-reduced order modeling purposes it may be convenient to rephrase PROBLEM

I taking as the primary unknowns the micro-strain fluctuations, ε̃µ, instead of the micro displacement fluctuations.
Let us consider the space Eµ of micro-strain tensorial functions which are kinematically compatible. Necessary and
sufficient conditions for this to happen are the classical compatibility equations (see [24]):

Eµ := {ζ ∈ Sndim×ndim | emjqenirζ i j,qr = 0} (8)

where e is the permutation tensor, while Einstein summation convention applies to the equation constraining ζ . Notice
that equations constraining ζ are linear and homogeneous, which is a crucial fact to be exploited later on.

We realize that Eq. (3) allows rephrasing Eqs. (5) and (6) as the following problem:

PROBLEM I-R (RVE rephrased variational strain fluctuation-based problem)
Given the macroscale strains, ε, and the spaces of kinematically compatible strain fluctuations, U ϵ̃µ , and
admissible strain fluctuations, V ϵ̃µ:

U ϵ̃µ = V
ϵ̃
µ :=


ε̃µ |


Bµ

ε̃µ d B = 0 and ε̃µ ∈ Eµ


; (9)

find ε̃µ ∈ U ϵ̃µ such that:
Bµ

σµ(εµ, dµ) :εµ d B = 0; ∀εµ ∈ V ϵ̃µ; (10)
ḋµ(y, εµ) = g(εµ, dµ) (11)

PROBLEM I-R is completely equivalent to PROBLEM-I as for the micro-stresses, σµ, and the homogenized
macroscopic results, but now they are given in terms of the micro-strain fluctuations εµ. The original displacement
fluctuations, ũµ, can be recovered, if necessary for the deformed RVE visualization purposes, through an additional
spatial integration of the equation ε̃µ = ∇

s ũµ. A variational procedure for doing this is provided in Appendix C.

2.3.2. Formulation as a saddle point problem
Let us consider the material free energy, ϕµ, for the isotropic damage model in Bµ,coh, which can be expressed as

(see [8]):

ϕµ(εµ, dµ(ε
τ
µ)) =

1
2
(1− dµ(ε

τ
µ))εµ · C · εµ (12)

where the micro-internal variable (isotropic damage), dµ, has been identified as a functional of the micro-strain history,
denoted ετµ(t). The supra-index τ refers to all the registered historical values until the current time t : τ ∈ [0, t].
Typically, the internal variable dµ is specified through evolution equations, generally expressed as:

ḋµ(y, εµ) = g(εµ, dµ). (13)

Additionally, and following the standard framework in constitutive modeling, and in consonance with Eq. (12), the
micro-stress, σµ, can be written as:

σµ(εµ) = ∂ϕµ(εµ, dµ)/∂εµ, (14)

where, it is implicitly assumed that the variable dµ, in the arguments of ϕµ, satisfies the constitutive relation (13).
Monolithic schemes to compute the stress σµ, in Eq. (14), jointly with Eq. (13), are conventional techniques in
non-linear solid mechanics (see for example [25]).



568 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

For subsequent developments, and accounting for Eq. (2), it is convenient to introduce a parameterized expression
of the free energy, identified as:

ϕµ[ε,dµ](ε̃µ) = ϕµ(ε + ε̃µ  
εµ

, dµ) =
1
2
(1− dµ)(ε + ε̃µ)C · (ε + ε̃µ) (15)

where the sub-index [ε, dµ] indicates that the macro-strain, ε (the action, or external driving force for the RVE
problem), and dµ ∈ [0, 1] are considered free parameters of the mapping ε̃µ → ϕµ, not necessarily satisfying
Eq. (13). Therefore, in expression (15), dµ is assumed to be independent of ε̃µ. Under this condition, the expression

σµ(ε + ε̃µ, dµ) =
∂

∂ ε̃µ
ϕµ(ε + ε̃µ, dµ) =

∂

∂ε
ϕµ(ε + ε̃µ, dµ) (16)

defines the stress only if it is combined with the evolution equation (13).
Next, in consonance with the concepts introduced in Appendix B.1, we define the parameterized functional:

Π[ε,dµ](ε̃µ,λ) =


B
ϕµ[ε,dµ](ε̃µ) d B + λ :


B

ε̃µ d B. (17)

In Eq. (17) λ(t) ∈ Sn×n , with uniform distribution on Bµ, is a symmetric second order tensor Lagrange multiplier
enforcing condition (3) on the micro-strain fluctuations ε̃µ.

With the parameterized functional Π[ε,dµ], we define the following:

PROBLEM II (RVE saddle point problem):
Given the macroscale strain, ε, find ε̃µ and λ satisfying

{ε̃µ(ε, dµ),λ(ε, dµ)} = arg


min
ε̃µ∈Eµ

max
λ∈Sn×n

Π[ε,dµ](ε̃µ,λ)


(18)

such that:

ḋµ(εµ) = g(εµ, dµ) (19)

After considering that the micro-stress σµ is given by the identity σµ = ∂ϕµ[ε,dµ]/∂ ε̃µ in conjunction with the
evolution equation (19), from the saddle point PROBLEM II the following optimality conditions emerge:

Bµ
[σµ(ε̃µ)(y)+ λ] : ε̂µ(y) d B = 0; ∀ε̂µ(y) ∈ Eµ (20)

λ : 
Bµ

ε̃µ d B = 0; ∀λ ∈ Sn×n . (21)
Comparison of Eqs. (20) and (21) with Eqs. (9) and (10) shows that the saddle-point PROBLEM II is equivalent

to the rephrased PROBLEM I-R and, therefore, PROBLEM II constitutes a primitive statement of PROBLEM I, in
Eqs. (5) and (6).

It is remarkable that the primitive PROBLEM II involves the numerical integration of a single scalar functional
Π[ε,dµ] (see Eqs. (18) and (17)) instead of the integration of vector-dimensional entities, as the ones stemming from the
optimality conditions in Eqs. (20) and (21). Therefore, taking Eq. (17) as the start point for the solution of the problem,
instead of Eqs. (9) and (10), offers an opportunity for a simplified reduced-integration strategy, as the one explored in
Section 3.3. Also notice, in Eq. (20), that the micro-strain variations, ε̂µ, are not constrained by the restriction defined
in Eq. (3).

3. RVE reduced order model

Let us start by introducing a standard finite element technique based on the formulation in PROBLEM I. The
so-defined discrete problem is termed the High-Fidelity (HF) finite element model, and solutions associated with it



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 569

are denoted HF solutions. High-dimensional fields of displacement fluctuations, ũµ, micro-strain fluctuations, ε̃µ, and
micro-stresses, σµ, are obtained as an outcome, during a sampling process, of successive solutions of the original HF
micro-cell problem. Next, a low-dimensional approximation of the micro-strain fluctuation field is derived.

Voigt’s notation, as an alternative to the tensor description, is used from now on. In particular, micro-strains and
micro-stresses are denoted as column vectors: ε̃µ ∈ Rnσ and σµ ∈ Rnσ .

3.1. Problem formulated in reduced strains

In the HF formulation, a finite element mesh covering the RVE domain Bµ is considered, while vectors ε̃µ and σµ
are defined at each Gauss Point of this mesh. Being the number of Gauss Points Ng , then, the dimension of the HF
finite element micro-strain fluctuation and micro-stress spaces, are of the order: O(Ng).

We search for a reduced vectorial space of dimension nε, with nε ≪ Ng , for modeling the micro-strain fluctuations.
This low-dimension space is obtained as the linear expansion of an orthogonal basis of nε spatial functions:
{Ψ(y)} = {Ψ1(y), . . . ,Ψnε (y)} (with Ψ i (y) ∈ R

nσ ; i = 1, . . . , nε), as follows:

ε̃µ(y, t) =
nε

i=1

Ψ i (y)ci (t) = Ψ(y)c(t) (22)

where each element Ψ i , of the basis {Ψ}, is recognized as a micro-strain fluctuation mode and the vector of time
dependent coefficients c(t) = [c1, . . . , cnε ] (c ∈ R

nε ) represents the amplitude of these modes. In the last identity of
(22), the matrix Ψ(y) = [Ψ1, . . . ,Ψnε ], with Ψ(y) ∈ R

nσ×nε collects, in column, the nε micro-strain modes of the
basis {Ψ}. Note that, in order to preserve a simplified notation, an identical symbol is used to identify the micro-strain
fluctuation field in the HF approach and in the low-dimensional approach.

The basis {Ψ}, composed of nε basis vectors (or modes), is obtained through a representative off-line sampling
program of the micro-cell model, solved with the HF formulation of PROBLEM I.8 From these solutions, the dominant
reduced modes of the micro-strain fluctuations are extracted through a Proper Orthogonal Decomposition (POD)
technique. Additional details of this procedure are given in the next sub-Section.

The variations of the micro-strain fluctuations are adopted with an identical approach to (22):

ε̂µ(y) = Ψ(y)ĉ (23)

where the vector ĉ (with ĉ ∈ Rnε ) collects the coefficients of the linear expansion.
Introducing (22) and (23) into the variational equations (20) and (21), derived from PROBLEM II, results in a new

model written in a reduced basis. It is termed the Reduced-Order Model (ROM) and it is presented in the following
box:

PROBLEM III (ROM) (RVE saddle point problem):
Given the macroscale strain, ε, find c ∈ Rnε and λ ∈ Rnσ satisfying:

{c(ε, dµ),λ(ε, dµ)} = arg


min
c∈Rnε

max
λ∈Rnσ

Π[ε,dµ](Ψc,λ)


= arg


min
c∈Rnε

max
λ∈Rnσ


B
ϕµ[ε,dµ](ε +Ψc) d B + λ

T


B
Ψd B


c


(24)

such that:

ḋµ(εµ) = g(εµ, dµ) (25)

8 In the next Section, it is shown that every function Ψ i in the basis spanning the reduced strain fluctuation fields, belongs by construction, to
the space Eµ (i.e.: Ψ i ∈ Eµ). This guarantees that any function ε̃µ, obtained by linear combination of these bases, also satisfies the condition:
ε̃µ ∈ Eµ.



570 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

After straightforward variational manipulations, the optimality conditions for the problem above yield,

∂

∂cT
Π[ε,dµ](Ψc,λ) =


Bµ

ΨT σµ(ε +Ψc)d B +


Bµ
ΨT d B


λ = 0; (26)

∂

∂λT
Π[ε,dµ](Ψc,λ) =


Bµ

Ψd B


c = 0. (27)

The system of equations (26) and (27) consists of nε and nσ algebraic equations, respectively. They are enough to
find the vector of coefficients, c, and the Lagrange multiplier vector λ.

3.2. Construction of a POD basis for the micro-strain fluctuations

Typically, the integrals in Eqs. (26) and (27) are evaluated by means of a numerical quadrature, such as the con-
ventional Gauss integration rule. Then, the kernel of the integrals has to be only evaluated in the quadrature points of
the original finite element mesh. In accordance with this procedure, by denoting Ng the number of Gauss points, only
the values ε̃µ(yi , t) of the reduced field at Gauss Point positions: yi , with i = 1, . . . , Ng , should be determined:

ε̃µ(yi , t) = Ψ(yi )c(t); for yi with i = 1, . . . , Ng. (28)

A convenient way to express the PROBLEM III in a compact notation is to collect in one-column vector [ε̃µ]G
all the micro-strain fluctuation vectors ε̃µ ∈ Rnσ corresponding to the set of Gauss points of the original HF finite
element mesh and the modes (basis vectors) evaluated in the Gauss point position in a matrix ΨG , resulting:

[ε̃µ]G =




ε̃µ(y1)
ε̃µ(y2)
...

ε̃µ(yNg )


 = ΨG c; ΨG =




Ψ(y1)
Ψ(y2)
...

Ψ(yNg )


 (29)

with:

[ε̃µ]G ∈ R
(nσ Ng); ΨG ∈ R

(nσ Ng×nε); c ∈ Rnε . (30)

Subindex G (standing for “Global”), which is added to the matrix of modes, means that this matrix is built by
piling up, in a single column, the modes evaluated at each Gauss point of the HF finite element model, as it is shown
in (29) (and unambiguously defined by the dimension of the vector). In the following, all matrices with subindex G
will have a similar meaning. It is also important to notice that the SVD technique, when applied to the snapshot matrix
[X], determines the basis {Ψ(y)} only through the matrix ΨG . Therefore, in the present approach, this basis is not
determined for arbitrary y.

Due to the linear character of the procedure by which the basis ΨG is constructed, and the linear homogeneous
character of the compatibility equations for strains, (8), every vector of ΨG fulfills the compatibility equations, then:
ΨG ∈ Eµ. This property is preserved for the reduced basis {Ψ} even after performing the spatial domain partition
described in Section 3.2.2. Therefore, any tensor field obtained by a linear span of {Ψ}, through an arbitrary vector of
parameters c, as in Eq. (28), also belongs to Eµ.

Finally, introducing Eq. (29) into the ROM equations (26)–(27), the following system of equations, in compact
notation, is obtained:

ΨT
G
[W]


[σµ(c)]G + [λ]G


= 0; (31)

[W ]ΨG c = 0; (32)

where [σµ(c)]G ∈ R
nσ Ng is the column vector constituted by piling-up the Ng stress vectors, σµ(c) ∈ Rnσ , evaluated

at the Gauss points. The column vector [λ]G (with [λ]G ∈ R
nσ Ng ) is also the piled-up of Ng repetitive values of the

same vector λ ∈ Rnσ . The square diagonal matrix [W] ∈ R(Ngnσ×Ngnσ ) and the rectangular matrix [W ] ∈ Rnσ×Ngnσ



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 571

collect the Gauss point weights: {W1,W2, . . . ,WNg }, which for plane stress or plane strain cases (with nσ = 4) are
distributed in sub-block matrices Wi ∈ R4×4 (i = 1, . . . , Ng), as follows:

[W] =


W1 . . . OO . . . O

O . . . WNg


 ; [W ] = W1 . . . WNg  ; (33)

Wi =




Wi 0 0 0
0 Wi 0 0
0 0 Wi 0
0 0 0 Wi


 .

In the set of equations (31)–(32), the internal damage variables, dµ(yi ), defining the stresses σµ(c) at each Gauss
point, yi , implicitly satisfy the evolution equation (13).

3.2.1. Collecting sampled solutions: the sampling program
Transition from the high-dimensional finite element space corresponding to the micro-strain fluctuations, ε̃µ, to

the desired reduced-order space spanned by the basis {Ψ}, is accomplished by resorting to the Proper Orthogonal
Decomposition (POD) technique, such as explained in [26] (see also [27]). Following that technique, the first step
consists of generating a collection of solutions, supplied by an off-line performed sampling program, of the High
Fidelity (HF) micro-cell finite element problem governed by Eqs. (5) and (6) (PROBLEM I).

This micro-cell sampling program consists of taking samples of RVE solutions for different trial cases. In each trial
case, the RVE is subjected to a given predefined history of the input driving force (or action). The sampling program,
should be designed such that the collected data determines a good-enough span of all possible loading histories. The
larger is the number of loading history cases represented in the data set the larger is the accuracy obtained with the
reduced model. Therefore, a good sampling program is the one whose loading HF model histories appropriately cover
a large part of the parametric space of solutions.

The actions, or loading system, of the micro-cell VBVP are the macro-strains ε. In each trial case corresponding to a
specific loading condition, the micro-strain fluctuation ε̃µ, at every Gauss point and for a given loading-step, is picked
up and collected. Section 4 gives additional details about the RVE sampling program designed for the present problem.

Let us consider the kth trial solution collected from the sampling program and which corresponds to a given time
step increment and loading case. The micro-strain fluctuation of all Gauss points provided by this solution is denoted
with supra-index k: ε̃kµ(yi ) (with i = 1, . . . , Ng). Then, each column vector Xk (with Xk ∈ R

(Ngnσ )) of the snapshot
matrix, [X], is defined as follows:

Xk =




ε̃
k
µ(y1)

ε̃
k
µ(y2)
...

ε̃
k
µ(yNg )


 . (34)

Furthermore, the snapshot matrix:

[X] = [X1 X2 . . .Xpsnp ]; ∈ R
(Ngnσ )×psnp (35)

is constituted by nnsp snapshot vectors. Therefore, [X] represents a number of time-step solutions, in terms of micro-
strain fluctuations, obtained with the HF model of PROBLEM I, under different loading conditions.

3.2.2. Partition of the micro-strain reduced basis
In order to get a more accurate estimation of the dominant modes of the micro-strain fluctuation fields, it is

convenient to partition the snapshot matrix components in accordance with: (i) the material response observed during
the load history in each sampled trajectory, and (ii) the different micro-cell domains. This procedure is sketched in
Fig. 2.

The snapshots taken from a given sampled trajectory are categorized depending on whether they are taken in the
micro-cell elastic regime (therefore all points of the micro-cell are in elastic state), or snapshots taken during the



572 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

Fig. 2. Partition of the snapshot matrix X. (a) Entries are partitioned into two sub-blocks: micro-strain fluctuations in Xi,reg are from points at
Bµ,reg, while micro-strain fluctuations in Xi,coh are from Gauss points at Bµ,coh. (b) Snapshots taken during the elastic regime of the micro-cell
(all Gauss points in Bµ,coh are in elastic states) correspond to the sub-block XE . Snapshots taken during the inelastic regime (at least one Gauss
point in Bµ,coh is in inelastic state) correspond to the sub-block X I (domains Bµ,reg and Bµ,coh are defined in Appendix A).

inelastic regime (at least one point in the macro-cell is damaging). In accordance with this criterion, the full snapshot
matrix can be partitioned into two sub-blocks of columns, i.e.:

[X] = [XE X I ]. (36)

In the sub-block of elastic snapshots, denoted XE , each column is one solution of the elastic regime, for some of the
sampling trajectories. The complementary sub-block is built with inelastic snapshots, and is denoted X I .

An additional partition of [X] is done by considering the singular domain of the RVE, represented by Bµ,coh, and
its disjoint domain, denoted regular domain Bµ,reg. These domains are defined in Appendix A, see Figs. 1(b) and 12.
Since each Gauss point in the HF finite element model lies on one of those domains, without loss of generality the
snapshot entries are organized so that the first, Ng,reg entries correspond to Gauss points in Bµ,reg, while the remaining
Ng,coh entries correspond to Gauss points in Bµ,coh. Clearly: Ng = Ng,reg + Ng,coh .

Then, in accordance with this criterion, the snapshots (36) can be now partitioned into rows as follows:

[X] =


Xreg
Xcoh


=


XEreg X

I
reg

XEcoh X
I
coh


; (37)

where Xreg collects the micro-strain fluctuations of the first N
reg
g Gauss points and Xcoh collects the micro-strain

fluctuations of the remaining Ng,coh Gauss points. In (37), the second identity emphasizes the double partition done in
accordance with the history loading stage of each snapshot and the spatial domain where the micro-strains have been
picked up from.

The second step of this procedure consists of finding a reduced POD basis, utilizing a SVD technique, of the elastic
snapshots. The SVD technique is applied, in a separate way, for each partition corresponding to Bµ,reg and Bµ,coh,
respectively, as follows:

Ψ EG,reg ← SVD[X
E
reg]; (38)

Ψ EG,coh ← SVD[X
E
coh]. (39)

Therefore, by construction, the basis of the elastic reduced-order micro-strain fluctuation space:

Ψ EG =


Ψ EG,reg 0

0 Ψ EG,coh


; Ψ EG,reg ∈ R

(Ng,reg×3); Ψ EG,coh ∈ R
(Ng,coh×3); (40)



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 573

reproduces the elastic response of the micro-cell. Furthermore, each sub-block, Ψ EG,reg and Ψ
E
G,coh, has dimension

3. This dimension results from the linear response of the mechanical system during the elastic regime and from the
loading parameter space dimension, which is 3. By normalizing each column of the matrix, Ψ EG , an orthonormal basis
is obtained, in the sense that:

[Ψ EG]
T
i [Ψ

E
G] j = δi j ; δi j = 1; if i = j; otherwise δi j = 0; (41)

where [·]i and [·] j denote columns i th and j th, respectively, of the matrix of modes of the reduced micro-strain
fluctuations.

In order to preserve the orthogonality of the full basis {Ψ}, the method in [17] is used. Therefore, to obtain the
remaining elements of {Ψ}, not contained in the space spanned by {Ψ E }, the inelastic snapshots X I are projected into
the orthogonal subspace spanned by the basis Ψ E :

X I⊥reg = X
I
reg −


i


[Ψ EG,reg]i · X

I
reg


[Ψ EG,reg]i (42)

X I⊥coh = X
I
coh −


i


[Ψ EG,coh]i · X

I
coh


[Ψ EG,coh]i (43)

then, similarly to (38)–(39), the POD technique is separately applied to the orthogonal projections of the snapshots
X I⊥reg and X

I⊥
coh to obtain:

Ψ IG,reg ← SVD[X
I⊥
reg ]; (44)

Ψ IG,coh ← SVD[X
I⊥
coh]. (45)

In this way, and by construction, the basis:

Ψ I
G
=


Ψ IG,reg 0

0 Ψ IG;coh


; Ψ IG,reg ∈ R

(Ng,reg×n
I
ε,reg); Ψ IG,coh ∈ R

(Ng,coh×n
I
ε,coh); (46)

reproduces the inelastic micro-strain fluctuations response in the micro-cell. In this equation, n Iε,reg and n
I
ε,coh are the

number of dominant micro-strain inelastic modes in Bµ,reg and Bµ,coh, respectively.
By construction, the space spanned by {Ψ IG} is orthogonal to that spanned by {Ψ

E
G}. Therefore, from (40) and (46)

it is possible to combine them into the reduced orthonormal basis:

{ΨG} = {Ψ
E
G; Ψ

I
G} (47)

which spans the full snapshot matrix X.
The number of basis vectors in {ΨG} is: nε = 6+ n

I
ε,reg + n

I
ε,coh .

9 The values n Iε,reg and n
I
ε,coh are obtained from

the solution of the SVD procedure,10 Eqs. (44) and (45), by taking those modes associated with the largest singular
values (see [26]).

3.3. Hyper-reduced order model (HPROM)

In many cases, it is an accepted fact that, although ROM markedly reduces the number of unknowns in the problem
(in the present case, the dimension nε of the vector c in Eq. (22)), this does not translate into an actual reduction
of the computational cost and, consequently, in a problem speedup (see [26] for details). Therefore, further actions
should be taken. These actions are known in the literature with the term hyper-reduction [12] which gives rise to the
HyPer-Reduced Order Model (HPROM).

9 In general, nε is smaller than the dimension of the space expanded by the columns of X. Therefore, there exists an inherent error (the a-priori
error) for capturing arbitrary snapshots Xi through a linear expansion of the base {ΨG }. This issue is studied in Section 5.
10 For the present case, the behavior in Bµ,reg is elastic, therefore n Iε,reg = 0.



574 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

The reason for the low-efficiency of the ROM is that the numerical integration of the integrals in (31) is yet
associated with a high computational cost, since it is necessary to evaluate the kernels in all the Ng Gauss points.
Therefore, the objective is to introduce an additional cost-reduction technique aiming at diminishing the computational
burden in evaluating these integrals.

To pursue this objective, a reduced integration technique has been developed by resorting to a nonconventional
method, termed Reduced Optimal Quadrature (ROQ), following the ideas that are presented, within a more general
context, in Appendix B. It is based on two actions:

1. Derive a reduced numerical integration scheme for some terms of the primitive PROBLEM III in Eqs. (24) and
(25): i.e. to evaluate the integral functional in Eq. (24), the classical Gauss integration rule is replaced by an optimal
reduced quadrature. More specifically, the integral term involving the free energy, ϕµ[ε,dµ] in Eq. (24) is evaluated
as  Gauss

Bµ
ϕµ[ε,dµ](Ψ(y)c) d B ≃

Nr
j=1

ϕµ[ε,dµ](Ψ(z j )c) ω j d B

:=

 Reduced
Bµ

ϕµ[ε,dµ](Ψ(y)c) d B. (48)

The reduced quadrature is based on selecting, through an adequate algorithm, a set of discrete sampling points,
z j ; j = 1, . . . , Nr and the corresponding weights ω j ; j = 1, . . . , Nr . The kernel of the integrand is evaluated in
those discrete points, z j , and weighted, with factors, ω j , to approach the exact integral as shown in Eq. (48). The
success of the reduced integration numerical scheme, in front of the conventional Gaussian quadrature, lies on the
fact that it is possible to reduce notably the number of involved quadrature points to Nr ≪ Ng , with respect to
the number of Gauss points, Ng , in the original HF model, but keeping under strict control the numerical error
introduced by the reduced quadrature.

2. Replace the reduced integrated functional (48) into the primitive statement, Eq. (24) of PROBLEM III and find the
corresponding optimality conditions (26) and (27). Considering that the derivative of Eq. (48) with respect to the
parameters c, can be written as:

∂

∂c

 Reduced
Bµ

ϕµ[ε,dµ](Ψ(y)c) d B =
 Reduced

Bµ

∂

∂c
ϕµ[ε,dµ](Ψ(y)c  

=ε̃µ(y,c)

) d B

=

 Reduced
Bµ


∂ ε̃µ(y, c)
∂c

T
  

Ψ (y)T

∂ϕµ[ε,dµ](ε̃µ(y, c))

∂ ε̃µ  
σµ(y,c)

d B

=

 Reduced
Bµ

Ψ(y)T σµ(y, c) d B ≃
Nr
j=1

Ψ(z j )
T

σµ(z j , c) ω j . (49)

Eqs. (49) can be utilized to evaluate the derivatives in the optimality condition (26) yielding the following set of
equations (from now on termed HPROM formulation):

PROBLEM IV (HPROM) (RVE saddle point problem):
Given the macroscale strain, ε, find c ∈ Rnε and λ ∈ Rnσ satisfying: Reduced

Bµ
Ψ(y)T σµ(y, c) d B +

 Gauss
Bµ

Ψ(y)T d B


λ = 0; (50)

 Gauss
Bµ

Ψ(y) d B


c = 0; (51)

A similar procedure could be also used for the other integral terms in Eqs. (50) (
 Gauss

B Ψ
T d B) and (51)

(
 Gauss

B Ψ d B), but, these being constant terms (not depending on the unknowns of the problem) they can be integrated



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 575

once for all (presumably in the off-line stage), using the standard Gauss quadrature, the result being stored and used,
when necessary, in the on-line stage.

3.3.1. Determination of the Reduced Optimal Quadrature (ROQ)
The minimum number of quadrature points providing an admissible integration error in the free energy integral (48)

can be determined by considering an optimal linear expansion of ϕµ[ε,dµ] in terms of energy modes Φi (i = 1, . . . , nϕ)
and amplitudes fi , i.e. a similar expression to that adopted for constructing the reduced micro-strain fluctuation in Eq.
(22), as follows:

ϕµ[ε,dµ](Ψ(y)c) =
nϕ

i=1

Φi (y) fi (c, ε, dµ). (52)

Replacing this linear expansion into the integral (48) yields
Bµ
ϕµ[ε,dµ](Ψ(y)c) d B =

nϕ
i=1


Bµ

Φi (y)d B


fi (c, ε, dµ). (53)

From Eq. (52) it is clear that the error associated with the numerical integration of the right-hand side, relies only on
the error associated with the integration of every one of the nϕ modes, Φi (y). Therefore, the strategy, for finding an
optimal numerical integration translates into seeking a reduced optimal quadrature rule (48) for every mode Φi :

Bµ
Φi (y) d B ≈

 Reduced
Bµ

Φi (y) d B =
Nr
j=1

Φi (z j ) ω j ; for: i = 1, . . . , nϕ . (54)

Following the strategy proposed in [17], the positions, z j , weights, ω j , and number, Nr , of quadrature points can
be determined by solving an adjoint minimization problem, where the objective is to minimize the error introduced
by evaluating the nϕ reduced integrals in Eq. (54), that is

( z j , ω j  
j=1,...,Nr

) = arg


min
z j ,ω j

nϕ
i=1

  Gauss
Bµ

Φi (y) d B  
Ng
j=1

Φi (y j ) W j

−

 Reduced
Bµ

Φi (z) d B  
Nr
j=1

Φi (z j ) ω j

+ |Bµ| − Nr
j=1

ω j

. (55)

The last term of the cost function in (55) forces the satisfaction of the additional constraint: Reduced
Bµ

d B =
Nr
j=1

ω j = |B|. (56)

By construction, the set of positions, ({z1, . . . , zNr }) of the reduced integration scheme sampling points are selected
among the positions, ({y1, . . . , yNg}) of the standard Gauss integration points. A greedy algorithm for solving (55),
preserving the positiveness of all the weight factors ω j , has been proposed in [17]. This algorithm is here adopted to
determine the position of points zi and their corresponding weights ωi .

Replacing the reduced quadrature rule (54) in (53), the integral of the free energy can finally be approached as:
Bµ
ϕµ[ε,dµ](Ψ(y)c) d B ≈

 reduced
Bµ

ϕµ[ε,dµ](Ψ(y)c) d B =
Nr
j=1

ϕµ[ε,dµ](Ψ(z j )c) ω j . (57)

Notice that Eq. (57) defines an integration rule with specific sampling points z j and weights ω j ( j = 1, . . . , Nr ),
which is distinctly different to the original Gauss integration quadrature, i.e.:

Bµ
ϕµ[ε,dµ](Ψ(y)c) d B w

Nr
j=1

ϕµ[ε,dµ](Ψ(z j )c) ω j :=
 Reduced

Bµ
ϕµ[ε,dµ](Ψ(z j )c) d B. (58)



576 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

Also the standard rules for integral’s derivatives, with respect to parameters apply, i.e.:

∂

∂γ


Bµ
ϕµ(y, γ ) d B w

∂

∂γ

 Reduced
Bµ

ϕµ(y, γ ) d B =
∂

∂γ

Nr
j=1

ϕµ(z j , γ ) ω j

=

Nr
j=1

∂

∂γ
ϕµ(z j , γ ) ω j :=

 Reduced
Bµ

∂

∂γ
ϕµ(y, γ ) d B (59)

the symbol γ ≡

c, ε, dµ


standing for any of the parameters in Eq. (58) as it has been done in Eq. (49).

The utilized greedy algorithm provides the optimum quadrature. Some additional interesting properties are
(see [17]):

• The set of Nr quadrature points ({z1, . . . , zNr }) is a sub-set of the Gauss point set associated with the HF model
(by construction).
• An exact integration rule can be achieved for Nr = nϕ + 1 quadrature points, where nϕ is the number of the free

energy modes in Eq. (52) (see [17] for the proof).
• The error introduced by using the (ROQ) scheme in Eq. (57), is governed by the neglected terms in the expansion

(52). The quadrature error diminishes by increasing nϕ .
11

It is remarked that, the determination of the reduced integration quadrature in Eq. (55) depends only on the free-energy
modes, Φi , in Eq. (52) and it is independent of the modal coefficients fi .

3.4. POD basis for the free energy

The development of the reduced quadrature rule in Eq. (54) is based on the concept of spanning the free energy
through an optimal linear combination of the basis {Φ}, and integrating exactly every element of the basis with the
reduced quadrature rule.

Regarding the computation of this basis in the off-line process, similar to the one described in Section 3.2 and
based on the construction of a snapshot matrix and the subsequent computation of the basis from a SVD technique,
two options appear:

1. Construct the free energy snapshots by collecting solutions of the ROM model in PROBLEM III (Eqs. (24) and
(25)). This sequential strategy implies that: (a) the ROM is constructed, (b) a number of micro-strain fluctuation
modes nε is considered to find the basis, and (c) this selected basis, with nε modes, is used to built the energy
snapshots (which, consequently, depends on the selected basis). This is an algorithmically consistent strategy
displaying, however, a practical flaw because step (c) has to be re-computed every time that nε is changed (for
instance to increase the HPROM accuracy or speedup).

2. Construct the free energy snapshots by collecting solutions of the HF model in PROBLEM II (Eqs. (18) and (19)).
This simultaneous strategy computes the free energy snapshots concurrently with the fluctuating strain snapshots
(both on the basis of the HF problem) the resulting free energy basis being independent of the chosen micro-strain
fluctuation modes. The number of modes of the basis can be changed arbitrarily, independent from each other, to
modify the resulting HPROM accuracy or speed-up, with no additional calculations. This is the strategy chosen in
this work. Of course, consistency (convergence to the HF solution) is achieved when the number of modes of both
bases is increased.

Therefore, for different sampling trajectories, a series of qsnp snapshots of the free energy, ϕµ, are evaluated and
collected for each Gauss point. Then, the free energy snapshot matrix is built as:

[Xϕ] = [Xϕ1 , . . . ,X
ϕ
qsnp ]; with: [X

ϕ
i ] =



ϕµ(y1)
ϕµ(y2)
...

ϕµ(yNg )




i

∈ RNg (60)

11 Sensitivity analyses of the integration errors, with respect to the number of energy bases nϕ , are presented in Section 5.



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 577

where ϕµ is evaluated, in each Gauss point yp (p = 1, . . . , Ng), with the reduced micro-strain fluctuations:
ε̃µ(yp) = Ψ(yp)c, and the internal variable dµ satisfying the constitutive relation for that micro-strain fluctuation:

ϕµ[ε,dµ](yp) =
1
2
(1− dµ)


(ε + ε̃µ(yp)) · C · (ε + ε̃µ(yp))


. (61)

In accordance with the position of the Gauss point, yp, in the original finite element mesh (HF model) and the ordering
given to the snapshot matrix [Xϕ], following a similar procedure to that adopted in expression (37), this matrix can be
partitioned in components associated with the domains: Bµ,coh and Bµ,reg:

[Xϕ] =


Xϕreg
Xϕcoh


(62)

and the SVD technique is then separately applied to both partitions of [Xϕ] to obtain two separated (orthogonal)
bases:

ΦG,reg ← SVD[X
ϕ
reg]; (63)

ΦG,coh ← SVD[X
ϕ
coh], (64)

which are subsequently used, through the algorithm in Eq. (55), to obtain the positions and weights of the ROQ
scheme.

3.5. Evaluation of the homogenized stresses and effective constitutive tensor

By deriving Eq. (57), with respect to the macro-strain argument, ε, and accounting for Eqs. (59) and (16) we
obtain:

∂

∂ε


Bµ
ϕµ[ε,dµ](ε̃µ(y, c)) d B =


Bµ

∂

∂ε
ϕµ[ε,dµ](ε̃µ(y, c))  

σµ(y,c)

d B

≃

Nr
j=1

∂

∂ε
ϕµ[ε,dµ](ε̃µ(z j , c))  

σµ(z j ,c)

ω j =

Nr
j=1

σµ(z j , c) ω j , (65)

where, additionally, the evolution equation (19) is assumed to be satisfied in each quadrature point z j :

ḋµ(z j , εµ) = g(εµ, dµ(z j )), ∀ j = 1, . . . , Nr . (66)

Then, from Eqs. (65), (66) and (80) (defined in Appendix B), the following rule can be utilized to approach the
homogenized stress:

σ =
1
|Bµ|


Bµ

σµ(y, c) d B ≈
1
|Bµ|

Nr
j=1

σµ(z j , c) ω j . (67)

Notice that evaluation of the homogenized values in Eq. (67) involves only the reduced number of quadrature points,
Nr , where the micro-stresses are sampled. A similar development can be utilized for evaluating the homogenized
constitutive tensor given in Eq. (75) (defined in Appendix B), yielding:

C ≃
1
|Bµ|

Nr
j=1

Cµ(z j , c)

I+Aµ(z j )


ω j . (68)

4. RVE off-line sampling program design

In accordance with the concepts introduced in Section 3.2, the snapshot matrix, [X], of ε̃µ, and the posterior
POD basis evaluation, are obtained from a sampling program of the RVE high-fidelity (HF) finite element model by



578 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

Fig. 3. Parametrization of the sampling trajectories. (a) Loading histories at the macro-scale defined by angles α and θ . Finite element model of
the micro-cells with a detail showing the cohesive bands for capturing the possible macroscopic failure mechanisms. (b) Selection of elastic and
inelastic snapshots during a sampled trajectory represented by the macrostructural response: loading component in the axial strip direction Fs
versus axial displacement component δs . (c) Microstructures MI, MII and MIII representing concrete, three phases are modeled: matrix, aggregates
and interfaces matrix–matrix and matrix–aggregates. The interfaces are simulated with cohesive bands.

gathering solutions from different trial cases. Each trial case corresponds to a micro-cell problem which is subjected
to a specific loading condition, and from each loading history, several solutions of ε̃µ and energies ϕµ (snapshots) are
taken. The success for constructing suitable POD basis, for spanning ε̃µ and ϕµ, lies on gathering the most appropriate
(discrete) solutions representing the space of solutions.

In the micro-cell VBVP, the input parameters, or driving forces, defining the loading history are the components
of the macro-strains ε. In plane problems, where the macro-strain component orthogonal to the plane is assumed
zero (εzz = 0),

12 these parameters live in a space of dimension 3 ({εxx , εyy, εxy}). This space can be typically
parameterized using the three components of the strain tensor in a canonical basis.

The exploration of the micro-cell (HF) finite element model is performed using the following strategy:

1. Multiscale tests described in Fig. 3(a) are solved.
2. A macroscale strip is considered as a simple structure to, indirectly, induce in the RVE the complex macro-strain

path leading to material instability. The strip is oriented along the direction s, forming an angle, α, with the hori-
zontal axis x .

3. This strip is stretched by imposing, on one side of the strip, uniform displacements δ forming an angle θ with
respect to the local axis s.

4. Displacements δ are then monotonically increased until getting the full structural degradation. Different test cases
are performed by sweeping the angle α in the interval: α ∈ [−80, 90]deg (every ∆α = 10.deg) and the angle θ in
the interval: θ ∈ [−20, 20]deg (every ∆θ = 10.deg).

12 In the conventional coordinate system {x, y, z}, with {x, y} defining the plane of analysis.



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 579

5. In this way, 90 structural trajectories (every one with 400 loading steps for increasing values of δ, until failure) are
performed. A selection of the corresponding micro-strain fluctuations ε̃µ, and free energy, ϕµ, snapshots are stored
to configure the corresponding snapshot matrices (see Fig. 3(b)) as explained in Section 4.1

The strip is modeled with only one EFEM finite element. At some loading level, the formation of one macro-
crack band Bloc, is captured by the EFEM element. For different tests, and depending on δ, the cracks would display
different directions.

The micro-cell related to the central singular Gauss point of the EFEM element is surveyed. And the snapshot
matrix [X] is built accordingly with the responses obtained in this surveyed cell during the sampling process. The
square micro-cell is designed with sides parallel to the horizontal and vertical axis.

Note that for every α, a uniaxial stretching is simulated when θ = 0.
With the devised sampling program, a wide spectrum of representative solutions of the problem, displaying macro-

cracks, induced by a large number of different micro-cell failure modes, can be captured.

4.1. Methodology for sampling snapshots in given trajectories

In the examples presented below, the following methodology has been used for sampling snapshots along the
sampling trajectories. Let us consider a given sampling trajectory, and the corresponding macroscopic structural
response in terms of the force–displacement, e.g. the one sketched in Fig. 3(b). A total of 33 snapshots are collected
(for each of the micro strain-fluctuation, ε̃µ, and free energy, ϕµ, fields) along three different stages of the trajectory:

1. The elastic regime (when no dissipation has taken place yet),13 which ends when some zero-dissipation threshold
is overcome at time tD , so that the elastic stage is characterized by the time interval [0, tD]. Three (approximately
equidistant) snapshots are taken in this stage, contributing to the matrices [XE ] and [Xϕ,E ] in Eqs. (36) and (60),
respectively.

2. The inelastic-stable regime, characterized by the time interval [tD, tB], where tB stands for the bifurcation time,
14

which triggers the onset of a macro-crack at the macro-scale. Ten, equidistant snapshots are taken at his stage,
contributing to the snapshot matrices [X I ] and [Xϕ,I ], in Eqs. (36) and (60), respectively.

3. The inelastic-unestable regime, when the material is propagating a crack at the macro-scale t > tB . Twenty
snapshots are taken at this stage, contributing to the snapshot matrices [X I ] and [Xϕ,I ], respectively.

In turn, every of those snapshots is allocated to the regular, (•)reg, and cohesive (•)coh blocks in Eqs. (37) and (60),
respectively, depending on the spatial position of the corresponding sampling points.

4.2. Sampled RVE’s

Three squared micro-cell models, made of a matrix and aggregates, are devised and sampled see (Fig. 3(a))
to simulate the meso-structure of a cementitious like material (concrete). They are of increasing complexity, with
finite element details shown in Table 1. Trying to mimic the concrete material response, the cells are modeled
with three components: aggregates, which are assumed elastic, bulk matrix, which is assumed elastic, and interfaces
(matrix–matrix and matrix–aggregates), which are simulated with banded elements and modeled with the isotropic
damage constitutive law. The properties of the materials in the micro-cell are defined in Table 2.

Typical deformed meshes of Microstructure III are depicted in Fig. 4. These deformed meshes have been obtained
by the superposition of the micro-displacement fluctuations to the original configuration. The micro-displacement
fluctuation of each picture is in correspondence with one of the micro-strain modes of the basis {Ψ E } or {Ψ I }
applying the POD procedure to the snapshot matrix [X] which has been constructed using the methodology above
described. Given one mode Ψ i , the procedure for evaluating the micro-displacements fluctuations at the RVE has
been described in Appendix C.

13 A procedure to obtain the macro-scale dissipation from the micro-scale one is provided in [8].
14 The bifurcation time tB is characterized by the loss of ellipticity of the localization tensor, obtained in terms of the homogenized tangent

constitutive tensor, given in Eq. (75) (see [28] for numerical algorithms for detecting this condition).



580 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

Table 1
Finite element models for Microstructures MI, MII and MIII.

Microstructure Number
of FE

Number
of D.o.f.’s

Number of
cohesive bands

Total number of
Gauss points (Ng)

M I 311 668 145 1244
M II 445 1036 161 1780
M III 5409 14256 2189 21636

Table 2
Material properties of the three sampled micro-cells. MI, MII and MIII refer to the micro-cells denoted: Microstructure I, II and II respectively in
Fig. 3. Properties are: Eµ (Young’s modulus), νµ (Poisson ratio), σµu (ultimate tensile stress) and Gµ, f (fracture energy).

Model Eµ [MPa] νµ σµu [MPa] Gµ f [N/m]

Elastic matrix MI 1.85e4 0.18 – –
MII 1.85e4 0.18 – –
MIII 1.85e4 0.18 – –

Elastic aggregate MI 3.70e4 0.18 – –
MII 3.70e4 0.18 – –
MIII 3.70e4 0.18 – –

Cohesive bands of matrix–matrix interface MI 1.85e4 0.18 2.60 140
MII 1.85e4 0.18 2.60 140
MIII 1.85e4 0.18 2.60 140

Cohesive bands of matrix–aggregate interface MI 1.85e4 0.18 1.30 70
MII 1.85e4 0.18 – –
MIII 1.85e4 0.18 – –

Fig. 4. Typical deformed meshes for micro-strain modes in microstructure MIII. The micro-displacements, required for post-processing, are
obtained with the recovery procedure in Appendix C. The amplification factors are different for elastic and inelastic modes. Active cohesive
bands, in inelastic modes, display unstructured crack opening.

5. Numerical assessment

The accuracy of the ROM model mainly depends on the number of modes, nε, taken in the basis {Ψ} spanning
the micro-strain fluctuation field. Additionally, the accuracy of the HPROM model also depends on the number of
quadrature points, Nr , adopted in the ROQ scheme. Accuracy of the combined HPROM strategy depends, then, on



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 581

both parameters. In this section the issue is addressed to evaluate sensitivity of the committed errors with respect to
those parameters, in different scenarios. Three different kinds of tests are presented:

(i) Consistency tests. A number of trajectories, already solved with the HF model during the micro-cell sampling
process in the off-line stage, are re-evaluated using the ROM and HPROM models. Errors of both approaches
with respect to the HF solutions are analyzed. This kind of assessment provides an estimation of the quality and
richness of basis to reproduce actual snapshots, Xi , and the accuracy of the ROQ scheme. It is expected that the
error with respect to the HF solutions (consistency-error) tends to zero as the number of considered modes for,
both, the micro strain-fluctuation, nε and Nr increase.

(ii) Accuracy tests. Similar to the aforementioned consistency tests, but for the RVE subjected to a random loading
trajectory (different from any previously sampled trajectory in the snapshot matrices). These tests also evaluate
the richness of the reduced bases but, in this case, HF solutions not tested during the sampling process are not
expected to be captured exactly, because of a remaining sampling error.

(iii) A multiscale structural test. With the objective of evaluating convergence of the solutions when the proposed
overall HPROM strategy is applied to a complex structural crack propagation problem, the classical benchmark
of crack propagation in a concrete L-shaped specimen is reproduced. Solution convergence, in terms of the
increasing number of quadrature points defining the ROQ scheme, is studied.

5.1. Consistency tests

Three types of errors are involved in consistency tests. First, by considering that the POD procedure, to select
the matrix of modes ΨG , neglects modes associated with singular values smaller than a given limit, then, ΨG cannot
expand completely the snapshot set defined by [X]. This error is identified as the a-priori error of the ROM model and
can be determined in the off-line stage, without constructing the ROM model. A second source of error is associated
with the snapshot sampling technique, in the sense that only a few snapshots, of each sampled trajectory, are taken to
build [X]. So, the ROM model reproducing sampled trajectories has associated an error, identified as the a-posteriori
error, which is the combination of the a-priori and the sampling errors. Finally, the HPROM model has also associated
an additional source of error which is governed by the reduced quadrature rule.

In this section first the a-priori and a-posteriori consistency errors of the ROM model, through solutions obtained
with Microstructures MI, II and III, are studied. Then, the convergence properties of the HPROM, in consistency tests,
are analyzed.

5.1.1. A-priori (off-line) consistency error of the ROM model
Once obtained the POD basis, {Ψ}, for micro-strain fluctuations, the a-priori (percentage) error in approaching

every snapshot Xi , with i = 1, . . . , psnp, can be estimated through:

errori % =
∥Xi −

XΨi  
ΨG c

i
∥

∥Xi∥
100; ci = ΨT

G
Xi (69)

where ci are coefficients of the vector XΨi (the orthogonal projection of Xi onto the space spanned by {Ψ}). Clearly,
if the space spanned by {Ψ} is rich enough to include Xi , then, the error (69) is zero. Then, the maximum error:

Error = max
i


errori %


; i = 1, . . . , psnp (70)

identifies the richness of {Ψ} for capturing all the snapshots in the matrix [X].
In accordance with the snapshot decomposition in Eq. (37), the POD bases {Ψ} and {Φ}, for micro-strain

fluctuations and energies, respectively, are partitioned into two domains: {Ψ reg}, {Ψ coh} and {Φreg}, {Φcoh}. Then,
using expression (69) and (70) for every partition of {Ψ} and {Φ}, the errors: ErrorΨreg and Error

Ψ
coh , for the regular

and cohesive band domains, respectively, of the micro-strain basis {Ψ}, and ErrorΦreg and Error
Φ
coh , for the regular and

cohesive band domains, respectively, of the energy basis {Φ} are computed. Fig. 5 plots these errors. There it can be
checked that the HPROM is fully consistent (zero errors are achieved for large enough values of nϵ and nϕ).



582 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

Fig. 5. Consistency test. A-priori consistency error for microstructures MI, MII and MIII ({Ψ} is the basis for the micro-strain fluctuation space
and {Φ} is the basis for the energy space): (a) ErrorΨreg , (b) Error

Ψ
coh (c) Error

Φ
reg and (d) Error

Φ
coh .

Fig. 6. Consistency test. Analysis of results obtained with the ROM model. Error of the homogenized traction-vector norm vs. number of modes
(tROM and tHF are the traction-vectors obtained with the ROM and HF models, respectively). (a) Results obtained with microstructures MI, MII
and MIII for the sampled trajectory characterized by α = 90.deg and θ = 15.deg. (b) Results obtained with microstructure MII for three different
sampled trajectories.

5.1.2. A-posteriori consistency error of the ROM model
Fig. 6 plots the error curves for evaluation of the homogenized traction vector norm, at the macro-scale, versus

the number of modes (nε) defining the basis {Ψ} of the reduced micro-strain fluctuation space. The relative error is



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 583

Fig. 7. Accuracy test for microstructure MIII with 21 636 Gauss points in the original HF model. Analysis of results obtained with the HPROM
model in terms of the number of quadrature points (Nr ) of the ROQ scheme (with nε = 106). (a) Vertical components of the reaction force (Fy )
vs. imposed displacement (δy ) at macro-scale (HF curve refers to the High-Fidelity finite element model); (b) normal component of homogenized
traction vector vs. displacement jump at the macro-scale (in S ); (c) shear component of the homogenized traction vector vs. displacement jump at
the macro-scale.

given by:

Error% =


∞

tB
∥tROM − tHF∥ dt
∞

tB
∥tHF∥ dt

(71)

where tROM and tHF are the traction-vectors determined with the ROM and HF models, and tB stands for the bifurcation
time. Fig. 6(a) compares the a-posteriori errors obtained with the microstructures MI, MII and MII by simulating one
sampled trajectory. While, Fig. 6(b) compares the errors obtained with microstructure MII by simulating three different
sampled trajectories.

Results in Fig. 6 corroborate the consistency of the ROM approach, i.e. the convergence of the reduced model
(ROM) solutions toward the HF solution by increasing the number nε of micro-strain fluctuation modes. It is
interesting to note that, in all different cases, it can be identified a minimum value of nε, above which the error
keeps small and constant. Also, according to these results, a residual error of the order of 1%–2% remains, even for
large values of nε. This residual error is associated with the sampling error, which could be diminished by increasing
the number of snapshots taken from every trajectory.

5.2. HPROM solutions for non-sampled trajectories

Fig. 7(a) plots the macrostructural responses provided by the HPROM model in microstructure MIII, with an
increasing number of quadrature points Nr . The simulated trajectory is characterized by the angles α = 90.deg and
θ = 15.deg.



584 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

Fig. 8. Accuracy test for the microstructure MIII with 21 636 Gauss points in the original HF model. Analysis of results obtained with the HPROM
model in terms of the number of quadrature points (Nr ) of the reduced integration scheme with nε = 106. (a) Vertical components of the reaction
force (Fy ) vs. imposed displacement (δy ) at macro-scale; (b) normal component of homogenized traction vector vs. δy ; (c) shear component of the
homogenized traction vector vs. δy . The Optimal Quadrature Number (OQN) is shown in both cases.

The macrostructural response is given in terms of the vertical component of the reaction force Fy versus the vertical
component of the imposed displacement δy . Convergence toward the HF solution with increasing Nr is observed.
Similarly, Fig. 7(b) plots the normal component of the macro-scale homogenized traction vector tn for increasing Nr ,
and Fig. 7(c) plots the shear component of the homogenized traction-vector for increasing Nr . The traction-vector, t,
governs the post-critical (post-bifurcation) macro-scale response.

Results in Fig. 7 are studied by selecting a fixed number of micro-strain fluctuation modes, nε = 106. Therefore,
these results depict the sensitivity of the HPROM solutions in terms of the number of quadrature points Nr .

The plots in Fig. 8 display the error of the homogenized macro traction vector evaluated with the HPROM approach,
obtained with nε = 60 and nε = 120 micro-strain modes, by varying the number of quadrature points Nr . In the same
plots, the computational speed-up (the inverse of the ratio of computational times), with respect to the HF case is also
depicted. It can be observed the error behavior is very noisy for low values of Nr .

However, by selecting an enough high value of Nr , which depends on the number of modes nε, the HPROM
approach error holds small and almost constant, indicating that there exist a minimum number of quadrature points,
the Optimal Quadrature Number (OQN), that must be taken to get an enough accurate solution. This threshold is also
a maximum, since significant increase of accuracy is not obtained with higher values.

Fig. 9 displays a set of pictures that help to understand the reason for such response. They show the deformed
RVE (obtained through the displacement recovery method in Appendix C) displaying the failure mode obtained for
nε = 100 and nε = 140 and increasing number of quadrature points Nr . For comparison, it is also shown the HF
failure mode for the simulated trajectory.

There, it can be observed the effects of increasing values of the HPROM parameters, nε and Nr , on capturing the
correct failure mode (crack path) at the RVE. When this crack path is exactly fitted i.e. for values equal to or larger
than the corresponding OQN, the job is already done and larger values of Nr do not translate into additional accuracy.

5.3. Design of the HPROM strategy

Fig. 10 shows the summary of a number of results obtained by running the HPROM strategy in a large number of
cases for microstructure MIII.

The plots can be used as an “abacus” for a-priori design by the user of the HPROM strategy in a multiscale problem
(for a given microstructure at the RVE). By selecting the admissible error, in the top figure, (say error = 3.5%), the
number of strain modes, (nε = 80) is obtained. Entering in the lower plot, with this result, (nε = 80), one obtains the
suitable number of integration points (OQN ≃ 200) and the speedup that can be expected (speedup ≃ 110).



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 585

Fig. 9. Non-sampled trajectory defined by α = −2.5deg and θ = −15.deg. Capture of failure modes with HPROM, by increasing the number of
quadrature points Nr and micro-strain modes nε , in comparison with the failure mode captured with the High-Fidelity (HF) finite element model.

The availability of such an abacus (constructed off-line) for a specific RVE microstructure, allows the user’s
selection of the most appropriate HPROM strategy, by balancing the admissible error vs. the desired speedup, for
the on-line multiscale computation stage.

5.4. Multiscale crack propagation problem: L-shaped panel

The panel in Fig. 11 is a benchmark commonly used for testing propagating fracture models. This concrete
specimen is considered here to test the qualitative results and convergence properties of the proposed HPROM
approach, when utilized in real FE2 multiscale crack propagation problems.

The geometry of the simulated specimen is depicted in Fig. 11(a). As shown in Fig. 11(b), the domain of the
L-shaped panel is split into two domains: (1) the multiscale domain (with 721 finite elements) corresponding to the
region where the crack may propagate, which is modeled with HPROM of the Microstructure MIII, depicted in Fig. 3,
and (2) the remaining part of the panel, which is modeled with an elastic monoscale approach (using 1709 finite
elements), where the elasticity tensor is obtained through an elastic homogenization of the micro-structure elastic
properties. Even for this (rather coarse) multiscale problem the high fidelity (HF) computational solution is extremely
costly to handle, till the point that, with the available computational resources,15 it has not been possible to display
the complete action–response curve (in Fig. 11(d)).

However, the remaining structural responses in Fig. 11(d), obtained through a number of HPROM strategies,
involve very reasonable computational costs, and they were obtained in advance with no previous knowledge of the
HFresults. The accuracies are very good, and a response indistinguishable from the HF can be obtained 60 times

15 A cluster of 500 cores, of recent generation, is used. The multiscale finite element code is written in a Matlab c⃝environment.



586 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

Fig. 10. HPROM design diagrams. Top: HPROM error in terms of number of strain modes. Bottom: OQN and obtained speedup in terms of the
number of strain modes. By selecting the admissible error (say 3.5%) in the upper diagram, one obtains the requested number of strain modes,
nε = 80. Entering with this result in the lower diagram one obtains the suitable number of integration points (T QN = 200) and the resulting
speedup (speedup = 110).

Fig. 11. L-shaped panel. (a) Specimen geometry; (b) finite element mesh; (c) macro-scale obtained crack path (red and green); d) structural
responses in terms of force P vs. vertical displacement ∆, for different RVE HPROM strategies. (For interpretation of the references to colour in
this figure legend, the reader is referred to the web version of this article.)

faster (speedup = 60). A less accurate response, but with a fairly good agreement with the HF can be obtained with
speedup = 130. This illustrates the new paradigm and computational possibilities open by HPROM strategies in
computational multiscale modeling.

6. Concluding remarks

Along this paper a new computational strategy for developing hyper-reduced order modeling (HPROM) of
multiscale fracture problems has been presented.

The proposed strategy consists of a series of new techniques, here developed and used to explore up to what extent
multiscale F E2 computational multiscale modeling of fracture can be made affordable in terms of computational



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 587

cost. It essentially consists of using a standard two-stage (off-line/on-line) strategy to produce a HyPer Reduced
Order Model (HPROM) with some specific techniques to exploit the computational-cost reduction.

Several aspects of the proposed methodology can be highlighted as new contributions in the literature:

• The RVE domain separation technique, to account for distinct constitutive models used at the RVE and take the
maximum advantage of this distinction.
• A strain-based formulation of the variational RVE problem allowing a simpler application of the previous

technique, without the need of introducing compatibility constraints.
• A specific sampling program, for the construction of the sets of snapshots in the off-line stage of the HPROM

procedure, in accordance with the rest of elements of the proposed strategy.
• The Reduced Optimal Quadrature (ROQ) technique, an evolution of some recent HPROM methods [16,17], which

resorts to the primitive formulation of the RVE problem as a saddle-point problem. This allows identifying the
involved functional as the appropriate (scalar) entity for designing an optimal reduced-cost integration rule, instead
of the internal forces (vector-entities) obtained from the corresponding variational principle.

The resulting methodology has been extensively tested, both at the RVE level and in multiscale modeling of propagat-
ing fracture benchmarks, this being totally unconventional for fracturing problems. The obtained results, in terms of
error vs. computational speedup, are certainly encouraging. Speedups of two orders of magnitude, much higher than
the ones currently reported in the literature for the same type of problems, have been obtained.

At this point it can be argued that only idealized, two-dimensional, problems have been considered. The real interest
of many multiscale modeling problems residing on actual three-dimensional problems, the following question arises:
to what extent this “encouraging” results can be extended to three-dimensional problems, where the involved RVE
complexity and the associated computational cost can be two or three orders of magnitudes larger? The answer can
be stated in two parts: (1) the proposed HPROM strategy methodology can be conceptually extended from 2D to 3D
cases without fundamental changes, and difficulties are not envisaged for this purpose, and (2) the obtained results in
terms of speedup can be understood as fully scalable from 2D to 3D problems. This means that one could think of
achievable values of 104–105 for the speedups in 3D problems... and this fact would turn the 3D multiscale case into
affordable (in conjunction with, currently available, HPC procedures). This would provide additional scientific and
industrial credit to the multiscale modeling concept. Although, this has to be proved in forthcoming works.

Acknowledgments

The research leading to these results has received funding from the European Research Council under the European
Union’s Seventh Framework Programme (FP/2007–2013)/ERC Grant Agreement No. 320815 (ERC Advanced Grant
Project “Advanced tools for computational design of engineering materials” COMP-DES-MAT).

Funding received from the Spanish Ministry of Economy and Competitiveness through the National Research Plan
2014: MAT2014-60919-R is gratefully acknowledged.

Appendix A. Multiscale model for propagating fracture

A brief overview of the multiscale model for propagating fracture fully developed in [8] is here presented. The
main interest in this contribution lies on the RVE model cost reduction and not on the multiscale problem itself.
However, and in order to introduce an appropriate setting for this purpose, the considered multiscale fracture model is
introduced here. This point is shown in Appendix A.2 of the Appendix, while the RVE finite element implementation,
which is taken as a starting point for constructing the HPROM model, is presented in Appendix A.3.

A.1. Macroscopic model

A.1.1. Kinematics
Let us consider a regularized strong discontinuity kinematics at the macroscale. The strain field stemming from a

regularized jump in Bloc, the localization band with a finite width h (the regularization parameter), is introduced as
follows:

ε(x, t) =


ε̄(x, t); ∀x ∈ B\Bloc ∀t ∈ [0, T ] ;
ε̄(x, t)+

χ

h


m(t)⊗s n(x)


; ∀x ∈ Bloc ∀t ∈ [0, T ] ;

(72)



588 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

where ε̄ is a smooth contribution to the strain field, and the term χh

m(t)⊗s n(x)


is the strain jump component

with strength given by the factor χ/h. The unit vector m(t), the polarization direction, indicates the direction of the
displacement jump across the band Bloc, and n(x) is the unit normal vector to the band. Supra index (·)s indicates the
symmetric part of the second order tensor and [0, T ] is the time (or pseudo-time) interval of interest.

A.1.2. Equilibrium and constitutive equations
Specific details of the Boundary Value Problem at the macroscale domain, B, are not necessary for the intended

development of the micro-cell reduced model. The only relevant fact is that the macroscopic stresses, σ (x, t), are
point-wise obtained, in terms of the macroscopic strains, ε(x, t), as

σ (x, t) = Σ

ε(x, t)


(73)

where Σ (•), stands for the homogenized constitutive model obtained from the computational homogenization in the
micro-cell.

After assuming the existence of a Representative Volume Element (RVE) and the variational Hill–Mandel Principle
(see [29]), which introduces the connection between both scales, the constitutive law Σ is defined through the
following sequence of operations: (i) first, the micro-stress field σµ, in Bµ, is determined by solving a standard
variational boundary value problem (VBVP) defined in the RVE. The actions, or driving forces, of this VBVP are the
macro-strains ε, which are homogeneously distributed in Bµ. The boundary conditions are prescribed according to
the rules defined in the next section, and (ii) the macro-stresses are computed as the volumetric average of σµ in Bµ,
as follows:

σ (x, t) = Σ

ε(x, t)


=

1
|Bµ|


Bµ

σµ(x, y, t)d Bµ. (74)

From this expression, the effective constitutive tensor: C = ∂σ/∂ε, can be written as:

C(x, t) =
1
|Bµ|


Bµ

Cµ(y)

I+Aµ(x, y, t)


d Bµ (75)

where I is the fourth order identity tensor and Aµ is the conventional localization tensor.
A complete description of the insertion of the resulting homogenized macroscopic constitutive model into a

propagating fracture scheme at the macro-scale can be found in [8].

A.2. Micro-cell model accounting for material failure

Let us consider a micro-cell Bµ model accounting for material failure. The micro-strain εµ in this RVE is given by
expression (2), where the relevant term is the micro-strain fluctuation ε̃µ, satisfying the natural conditions (3).

Let us assume that a pre-defined, network of cohesive bands, Bµ,coh, having finite thickness k (with k ≪ hµ) and
characterized by a high aspect ratio, is introduced in the cell, such as shown in Fig. 1(b). It is assumed that fracture at
the micro-cell can only appear and propagate along this network, which is dense enough to capture the relevant micro-
cell failure mechanisms. A conventional phenomenological non-linear dissipative model describes the constitutive
response of these bands. For this purpose the continuum damage model in [8] has been chosen, which, though being
extremely simple, provides the basic ingredients (strain softening controlled by fracture energy) involved in the onset
and propagation of the micro-cracks.

The cohesive bands constitutive response is governed by the damage model, while the remaining part of the micro-
cell, Bµ,reg, is assumed to behave as linear elastic.

Therefore, the following rules apply, see Fig. 1(b):

• Elastic material model is considered in Bµ,reg, so:

σµ(y) = C
e
: εµ; ∀ y ∈ Bµ,reg (76)

Ce being the fourth order Hooke’s isotropic elastic tensor.



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 589

Fig. 12. Finite element discretization at the micro-scale. (a) Finite element, B(e)
µ,coh, in the cohesive band Bµ,coh. Constrained and unconstrained

finite elements in Bµ,coh; (b) deformed RVE after activation of a micro-cell failure mode.

• The continuum damage model is considered in the bands Bµ,coh, so:

σµ(y, εµ, dµ) = (1− dµ)C
e
: εµ; ∀ y ∈ Bµ,coh (77)

where dµ ∈ [0, 1] is the scalar, micro-scale damage variable which plays the role of internal variable. Its evolution
equation is given by:

ḋµ(y, εµ) = g(εµ, dµ) (78)

where g is a function, of the instantaneous mechanical state, ruling the damage evolution and the material
hardening/softening. In Eq. (78) the upper dot is used to denote time (or pseudo-time) derivative. A uniform strain
is assumed within the cohesive bands, Bµ,coh, and therefore, the bandwidth k can be used as a regularization
parameter on the model softening modulus, in terms of the material fracture energy, G f , thus providing a correct
energy dissipation in the band. Damage evolution is considered only for tensile strain states. A brief summary of
the damage model can be found in [8].

To connect both scales of analysis, the Hill–Mandel variational principle is adopted, which assumes the equality
of the macro-scale virtual power density and the volumetric average of the micro-scale virtual power density. Two
consequences yield from this principle (see [29]):

(i) The micro-stresses should be, in a variational sense, self-equilibrated. Let us consider the space V uµ of
kinematically admissible micro-displacement fluctuations. Functions in V uµ have to satisfy the kinematical
constraint (3). So, V uµ := U

u
µ. Then, the self-equilibrium equation reads:

Bµ
∇

s
δũµ : σµ(ε +∇

s ũµ, dµ) d Bµ = 0; ∀ δũµ ∈ V uµ (79)

where ũµ ∈ U uµ.
(ii) The macro-stress is related to the micro-stresses through:

σ =
1
|Bµ|


Bµ

σµ(ε +∇
s ũµ, dµ) d Bµ (80)

which is the stress homogenization rule for stress up-scaling.

A.3. Finite element model of the RVE

A standard finite element model is adopted for the numerical simulation of the RVE failure response. One single
quadrilateral finite element is used along the thickness of the cohesive bands in Bµ,coh, as shown in Fig. 12. As



590 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

mentioned above, these elements are endowed with a damage model displaying a regularized softening, the parameter
k playing the role of regularization length.

In [8] it has been shown that, during the post-critical loading regime of the micro-cell endowed with the cohesive
bands network, the kinematical constraints (3) are not sufficient to preclude loss of uniqueness of the numerical
solution. It is also shown there that this instability can be easily avoided by the imposition of an internal restriction on
the displacement fluctuations at the cohesive bands.

Let us consider that ũµ(ξ, η) is the displacement fluctuation at the point with coordinates (ξ, η), in Bµ,coh
(increasing values of the coordinate, ξ , are in the sense of nµ,coh), see Fig. 12(a). The displacement fluctuation jump
across Bµ,coh, denoted as [[ũµ]], is defined by:

[[ũµ]](η) := ũµ(k, η)− ũµ(0, η) (81)

where ũµ(k, η) and ũµ(0, η) are the displacement fluctuation on the boundary ∂B
(e),+
µ,coh and ∂B

(e),−
µ,coh, respectively.

Then, the field ũµ(ξ, η) is constrained by the condition:

[[ũµ]](η) = constant. (82)

The internal constraint (82) is implemented in each finite element in Bµ,coh, through the nodal constraints :

ũ1µ − ũ
2
µ = ũ

4
µ − ũ

3
µ (83)

where ũ1µ, ũ
2
µ, ũ

3
µ and ũ

4
µ are defined in Fig. 12(a).

Restrictions in Eq. (83) can become troubleshooting in elements of Bµ,coh resulting from cohesive band
intersection, because they might over-constrain the adjacent bands. Therefore, they are only imposed on those cohesive
bands not producing those this over-constraint16 (see Fig. 12(a)). For the Bµ,coh morphologies used in this work, this
setting has shown an excellent behavior and no instability has appeared.

Appendix B. Hyper-reduced saddle-point formulation for inelastic mechanical problems

B.1. Saddle-point formulation

Let us consider a body B, constituted by a dissipative local inviscid material. For the present mechanical
description, the relevant state variables are displacement u(x, t), strains ε(u), stresses σ , and a set of internal variables
α(x, t). The specific aspect considered here is that α typically depends on the strain history, and therefore, it is
described in terms of evolution equations having the form:

α̇(x, t) = g(ε,α) (84)

which, after time integration returns the internal variables, α, in terms of the strain history ετ :

α(x, t) = α̂(x, ετ ); τ ∈ [0, t]. (85)

The free energy for any inelastic model can be generally defined by: ϕ(ε,α). Then, the stress σ is:

σ =
∂ϕ(ε, α)

∂ε
(86)

where it is assumed that α and ε are related through Eq. (85).
Following the same concept described in Section 2.3.1, we can introduce the parameterized free energy ϕ[α]. In

this function, the internal variable α is assumed as an independent parameter, in the sense that once the strain history
ετ is defined, α does not necessarily satisfy the evolution equation (85). Then, we can write that σ is given by the set
of equations:

σ =
∂ϕ[α](ε)

∂ε
; (87)

α(x, t) = α̂(x, ετ ); τ ∈ [0, t]. (88)

16 An alternative option, which is used in the examples presented in Section 5, is removal of these elements from the finite element mesh.



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 591

Next, we define a parameterized functional Π[t∗,u∗,α], where t∗(x, t) (the imposed traction at the boundary Γt ) and
u∗(x, t) (the imposed displacements at the boundary Γu) are the problem driving parameters (actions), and α(x, t) is,
again, considered as an additional free parameter:

Π[t∗,u∗,α](u,λu) =


B
ϕ[α](ε(u)) d B −


Γt

t∗ · u dΓ −

Γu

λu · (u− u
∗
) dΓ (89)

where λu(x, t) (with λu ∈ Rndim ) is a Lagrange multiplier defined in Γu enforcing the Dirichlet’s condition (u = u∗
at Γu).

Now, let us consider the saddle-point problem:
u(t∗,u∗, α),λu(t

∗
,u∗, α)


= arg


min

u
max
λu

Π[t∗,u∗,α](u,λu)


(90)

whose optimality conditions yield the following variational equations:
B

∂ϕ[α]

∂ε
: ∇

s
δu d B −


Γt

t∗ · δu dΓ −

Γu

λu · δu dΓ = 0; ∀δu ∈ Vu; (91)

−


Γu

δλu · (u− u
∗
) dΓ = 0; ∀δλu ∈ Vλ; (92)

while, the corresponding Euler–Lagrange equations are obtained:

divσ = 0; σ (ε,α) = ∂εϕ[α](ε); ∀x ∈ B (93)
σ · ν = t∗ ∀x ∈ Γt (94)

λu = σ · ν ∀x ∈ Γu (95)
u = u∗ ∀x ∈ Γu . (96)

Eqs. (93)–(96) in combination with (85) constitute the conventional BVP in B. The saddle-point problem (90) together
with (84) (or (85)) defines the full set of equations governing the inelastic mechanical problem.

Therefore, one can state the entire formulation in terms of the saddle point problem of the parameterized energy
functional Π[t∗,u∗,α] (Eq. (90)) complemented by the evolution equation (84). In this sense, the saddle point problem
(Eq. (90)) can be considered as the primitive statement of the standard variational formulation in Eqs. (91) and (92).
This is the paradigm of the proposed HPROM strategy, that considers as the start point the functional in Eq. (90).

B.2. Hyper-reduction of the problem

B.2.1. Low-dimensional problem. Reduced order model (ROM)
Initially, we assume that we have available a conventional finite element approach for the displacement, u, and

Lagrange multipliers, λu , fields solving the above described BVP (the HF finite element model). Then, using a
procedure similar to that described in [26], (performing an off-line sampling program of the HF model followed
by a POD technique) we can extract a reduced order model to approach both fields.17

In accordance with this procedure, the reduced displacement field can be written as a linear combination of vectors
defining the basis {U} := {U1, . . . ,Unq }, as follows:

u(x, t) =
nq

i=1

Ui (x)qi (t) = U(x)q(t); (97)

where

U = [U1, . . . ,Unq ] ∈ R
ndim×nq ; Ui =


Ui,x
Ui,y


; q = [q1, . . . , qnq ] ∈ R

nq . (98)

17 Voigt’s notation is used from now on.



592 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

Element Ui , of the basis {U}, has the same number of components as the displacement field, and, contrarily to the
finite element shape functions, they are global functions, in the sense that its support is B. The matrix U collects
all the displacement modes defined by the basis functions, while the vector q collects all the coefficients scaling the
displacement modes.

The Lagrange multiplier field can also be expanded using a low-dimension spatial basis {Υ} := {Υ1, . . . ,Υnγ }:

λu(x, t) =
nγ

i=1

Υ i (x)γ i (t) = Υ(x)γ (t); (99)

where now, matrices Υ ∈ Rndim×nγ and vector γ ∈ Rnγ have similar meaning to U and q.
In an infinitesimal strain setting, the strains are given by:

ε(x, t) = B(x)q(t) (100)

where B(x) is the strain–displacement matrix, which for 2-D (ndim = 2) problems is:

B(x) =




∂

∂x
0

0
∂

∂y
0 0
∂

∂y

∂

∂x


 U. (101)

Replacing the approximations (97) and (100) into the functional (89), results:

Π[t∗,u∗,α](q, γ ) =


B
ϕ[α](Bq) d B  

I1

−


Γt

(t∗)T Uq dΓ  
I2

−


Γu

γ
T ΥT (Uq− u∗) dΓ  

I3

. (102)

The min–max problem of Eq. (90) reads:
q(t∗,u∗, α), γ (t∗,u∗, α)


= arg


min

q
max

γ
Π[t∗,u∗,α](q, γ )


(103)

∂qΠ[t∗,u∗,α](q, γ ) =


B
BT
∂ϕ[α]

∂ε
(Bq) d B −


Γt

UT t∗ dΓ −

Γu

UT Υγ dΓ (104)

∂λu Π[t∗,u∗,α](q, γ ) = −

Γu

ΥT (Uq− u∗)d B = 0; (105)

which, in combination with the evolution equation (85):

α(x, t) = α̂(x, (Bq)τ ); τ ∈ [0, t] (106)

supplies the solution of the reduced problem.
Let us now assume that the actions t∗ and u∗ can be also projected on appropriated low-dimension spaces with

bases, U∗ and T∗, respectively, and expressed as follows:

u∗(x, t) = U∗(x)r∗(t); t∗(x, t) = T∗(x)s∗(t). (107)

Eqs. (104)–(107) constitute a set of non-linear algebraic equation in (q, γ ) solved in terms of the action parameters
(r∗, s∗), as:

q(t) = q̂(r∗(t), s∗(t)); γ (t) = γ̂ (r∗(t), s∗(t)) (108)

They constitute the Reduced Order Model, the number of unknowns being reduced to nq + nγ (ROM problem).



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 593

B.2.2. Reduced Optimal Quadrature (ROQ)

As a matter of example, let us assume that we are interested in reducing the numerical integration cost of the term
I1 in Eq. (102). Replacing the original conventional quadrature, based on the discrete Gauss points xi : i = 1, . . . , Ng ,
in B, and Gauss weights Wi : i = 1, . . . , Ng ,

 Gauss
B

ϕ[α](B(x)q) d B :=
Ng

i=1

ϕ[α](B(xi )q) Wi (109)

by a Reduced Optimal Quadrature, based on a new set of discrete points z j ; j = 1, . . . , Nr and weights ω j ; j =
1, . . . , Nr , with Nr ≪ Ng , i.e.:

 Reduced
B

ϕ[α](B(z)q) d B :=
Nr
j=1

ϕ[α](B(z j )q) ω j . (110)

The goal is to determine the weights and positions of these quadrature points so as to minimize the differences provided
by both integrations on the same kernel:

( z j , ω j  
j=1,...,Nr

) = arg


min
z j ,ω j


 Gauss

B
ϕ[α](B(z)q) d B −

 Reduced
B

ϕ[α](B(z)q) d B


. (111)

In order to achieve this goal, let us consider that kernel, ϕ[α], evaluated at the solutions of the ROM problem
(Eqs. (108)):

I1 =


B
ϕ[α](B(x)q̂(r

∗
, s∗)  

ε(x,r∗,s∗)

) d B =


B
ϕ(ε(x, r∗, s∗),α(x, r∗, s∗))  

Ψ (x,r∗,s∗)

d B;

=


B

Ψ(x, r∗, s∗) d B. (112)

And let us assume that an appropriate separated expansion of the kernel of the integral in (112) is available:

Ψ(x, r∗, s∗) =
nψ
i=1

Fi (x)fi (r
∗
, s∗). (113)

Then, I1 can be replaced by:

I1 =


B
Ψ(x, r∗, s∗) d B =

nψ
i=1


B

Fi (x) d B


fi (r
∗
, s∗). (114)

A sufficient condition for Eq. (114) to be fulfilled is that every element of the basis, Fi (z), is exactly integrated by the
proposed reduced integration scheme:


B

Fk(x) d B =
 Reduced

B
Fk(x) d B =

Nr
j=1

Fk(z j ) ω j ; for: k = 1, . . . , Nr . (115)

In addition, let us require that the volume is preserved by the reduced integration rule, e.g.:

 Reduced
B

d B = |B| =
Nr
j=1

ω j . (116)



594 J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595

Eqs. (115) and (116) can be reduced to

( z j , ω j  
j=1,...,nψ

) = arg


min
z j ,ω j

Nr
k=1

  Gauss
B

Fk(x) d B  
Ng
i=1

Fk (xi ) Wi

−

 Reduced
B

Fk(z) d B  
Nr
j=1

Fk (z j ) ω j

+ |B| − Nr
j=1

ω j

. (117)

Problem in Eq. (117) may be solved by means of a specific greedy algorithm (see [17] for a detailed description).
It is proven that, in general, an exact reduced integration scheme, keeping the weights ω j > 0, can be found for:
Nr = nψ+1. So, replacing this reduced integration scheme into the variational problem in (102)–(106) yields

∂qΠ (q, γ ) =
 Reduced

B
BT ∂εϕ[α](Bq) d B  
∂q I1

−

 Gauss
Γt

UT t∗ dΓ −
 Gauss
Γu

UT Υγ dΓ (118)

∂λu Π (q, γ ) = −
 Gauss
Γu

ΥT (Uq− u∗)d B = 0; (119)

α(x, t) = α̂(x,Bqτ ); τ ∈ [0, t]. (120)

A substantial cost reduction can be expected from the use of the reduced quadrature in the first integral term (I1)
in (118). If necessary, a similar treatment can be given to the remaining integrals (I2, I3) in the functional (102).
Combination of the ROM, in Appendix B.2.1, and ROQ, in Appendix B.2.2, constitutes the proposed HPROM
approach.

Appendix C. Displacement fluctuation field recovery

Solutions of the HPROM problem in Eqs. (50) and (51), provide the coefficient vectors q which, jointly with the
basis {Ψ}, define the micro-strain fluctuation field: ε̃µ = Ψc.

Although, within the context of the FE2 multiscale approach, computation of ε̃µ and σµ is sufficient to determine
the macroscale homogenized constitutive law, in same cases18 it could be necessary to evaluate the micro-displacement
fluctuation field ũµ. In this case, ũµ can be obtained by the projection of ε̃µ into the strain space approached by the
HF finite element model, as follows.

GIVEN Ψc, FIND: ũµ ∈ V H F such that:
B
(Ψc−∇s ũµ) : ∇

s ûµd B = 0; ∀ûµ ∈ V H F (121)

where V H F is the displacement space obtained with the HF conventional finite element model and removing the rigid
body motion modes. Note that functions in V H F are not subjected to the kinematical constraint defining the space U uµ
in expression (4).

Introducing the finite element approaches of ũµ and ûµ, and considering that [ũµ] is the global vector of nodal
parameters, interpolating ũµ in the original finite element mesh, Eq. (121) can be re-written as follows:

B
BTu Ψd B


  

F

c−


B
BTu Bud B


  

K

[ũµ] = 0; (122)

where Bu is the strain–displacement matrix of the conventional HF finite element method. Finally:

[ũµ] = K−1Fc; (123)

Computation of [ũµ] with (123) destroys the speed-up obtained with the HPROM approach. Therefore, this field
should be only determined as a post-processing step, at the end of the computation.

18 For instance, for geometric representation of the RVE deformation.



J. Oliver et al. / Comput. Methods Appl. Mech. Engrg. 313 (2017) 560–595 595

References

[1] J.T. Oden, T. Belytschko, J. Fish, T.J.R. Hughes, C. Johnson, L.A. Keyes, L. Petzold, L. Srolovitz, S. Yip, Simulation-based Engineering
Science. Report of the nsf sbes Panel to the nsf Engineering Advisory Committee, National Science Foundation (USA), 2006.

[2] T. Belytschko, S. Loehnert, J.H. Song, Multiscale aggregating discontinuities: A method for circumventing loss of material stability, Internat.
J. Numer. Methods Engrg. 73 (2008) 869–894.

[3] M.G.D. Geers, V.G. Kouznetsova, W.A.M. Brekelmans, Multi-scale computational homogenization: Trends and challenges, J. Comput. Appl.
Math. 234 (2010) 2175–2182.

[4] J.F. Unger, S. Eckardt, Multiscale modeling of concrete, Arch. Comput. Methods Eng. 18 (3) (2011) 341–393.
[5] V.P. Nguyen, O. Lloberas-Valls, L.J. Sluys, M. Stroeven, Homogenization-based multiscale crack modelling: from micro diffusive damage to

macro cracks, Comput. Methods. Appl. Mech. Engrg. 200 (2010) 1220–1236.
[6] P.J. Sánchez, P.J. Blanco, A.E. Huespe, R.A. Feijóo, Failure-oriented multi-scale variational formulation: micro-structures with nucleation

and evolution of softening bands, Comput. Methods Appl. Mech. Engrg. 257 (2013) 221–247.
[7] S. Toro, P.J. Sánchez, P.J. Blanco, E.A. de Souza Neto, A.E. Huespe, R.A. Feijóo, Multiscale formulation for material failure accounting for

cohesive cracks at the macro and micro scales, Int. J. Plast. 76 (2016) 75–110.
[8] J. Oliver, M. Caicedo, E. Roubin, A.E. Huespe, J.A. Hernández, Continuum approach to computational multiscale modeling of propagating

fracture, Comput. Methods Appl. Mech. Engrg. 294 (2015) 384–427.
[9] F. Feyel, J.L. Chaboche, FE2 multiscale approach for modelling the elastoviscoplastic behaviour of long fibre SiC/Ti composite materials,

Comput. Methods Appl. Mech. Engrg. 183 (2000) 309–330.
[10] J.L. Michel, H. Moulinec, P. Suquet, A computational scheme for linear and non-linear composites with arbitrary phase contrast, Internat. J.

Numer. Methods Engrg. 52 (1–2) (2001) 139–160.
[11] J.C Yvonnet, Q.-C. He, The reduced model multiscale method (R3M) for the non-linear homogenization of hyperelastic media at finite strains,

J. Comput. Phys. 223 (1) (2007) 341–368.
[12] D. Ryckelynck, Hyper-reduction of mechanical models involving internal variables, Internat. J. Numer. Methods Engrg. 77 (1) (2009) 75–89.
[13] C. Oskay, J. Fish, Eigendeformation-based reduced order homogenization for failure analysis of heterogeneous materials, Comput. Methods

Appl. Mech. Engrg. 196 (7) (2007) 1216–1243.
[14] S. Zhang, C. Oskay, Reduced order variational multiscale enrichment method for elasto-viscoplastic problems, Comput. Methods Appl. Mech.

Engrg. 300 (2016) 199–224.
[15] P. Kerfriden, O. Goury, T. Rabczuk, S. Bordas, A partitioned model order reduction approach to rationalise computational expenses in

nonlinear fracture mechanics, Comput. Methods Appl. Mech. Engrg. 256 (2013) 169–188.
[16] C. Farhat, T. Chapman, P. Avery, Structure-preserving, stability, and accuracy properties of the energy-conserving sampling and weighting

method for the hyper reduction of nonlinear finite element dynamic models, Internat. J. Numer. Methods Engrg. (2015).
[17] J.A. Hernández, M. Caicedo, A. Ferrer, Dimensional hyper-reduction of nonlinear finite element models via empirical cubature, Comput.

Methods Appl. Mech. Engrg. (2016). http://dx.doi.org/10.1016/j.cma.2016.10.022 (in press).
[18] J. Simo, J. Oliver, A new approach to the analysis and simulation of strain softening in solids, in: Z.B. Bazant, Z. Bittnar, M. Jirásek, J. Mazars

(Eds.), Fracture and Damage in Quasi-brittle Structures, E & FN Spon, 1994, pp. 25–39.
[19] J. Oliver, Modelling strong discontinuities in solids mechanics via strain softening constitutive equations. Part 1: Fundamentals, Internat. J.

Numer. Methods Engrg. 39(21) (1996) 3575–3600.
[20] J. Oliver, On the discrete constitutive models induced by strong discontinuity kinematics and continuum constitutive equations, Int. J. Solids

Struct. 37 (2000) 7207–7229.
[21] J. Oliver, A.E. Huespe, M.D.G. Pulido, E. Chaves, From continuum mechanics to fracture mechanics: the strong discontinuity approach, Eng.

Fract. Mech. 69 (2002) 113–136.
[22] O.L. Manzoli, A.L. Gamino, E.A. Rodrigues, G.K.S. Claro, Modeling of interfaces in two-dimensional problems using solid finite elements

with high aspect ratio, Comput. Struct. 94 (2012) 70–82.
[23] E.A. Rodrigues, O.L. Manzoli, L.A.G. Bitencourt Jr., T. Bittencourt, 2D mesoscale model for concrete based on the use of interface element

with a high aspect ratio, Int. J. Solids Struct. 94 (2016) 112–124.
[24] J. Oliver, C.A. de Saracı́bar Bosch, Mecánica de medios continuos para ingenieros, vol. 92, Univ. Politèc. de Catalunya, 2002.
[25] J. Simo, T. Hughes, Computational inelasticity, Springer-Verlag, 1998.
[26] J.A. Hernández, J. Oliver, A.E. Huespe, M.A. Caicedo, J.C. Cante, High-performance model reduction techniques in computational multiscale

homogenization, Comput. Methods Appl. Mech. Engrg. 276 (2014) 149–189.
[27] Anindya Chatterjee, An introduction to the proper orthogonal decomposition, Current Sci. 78 (7) (2000) 808–817.
[28] J. Oliver, A.E. Huespe, J.C. Cante, G. Dı́az, On the numerical resolution of the discontinuous material bifurcation problem, Internat. J. Numer.

Methods. Engrg. 83 (2010) 786–804.
[29] P.J. Blanco, P.J. Sánchez, E.A. de Souza Neto, R.A. Feijóo, Variational foundations and generalized unified theory of RVE-based multiscale

models, Arch. Comput. Methods Eng. (2014) 1–63.

http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref1
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref2
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref3
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref4
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref5
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref6
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref7
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref8
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref9
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref10
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref11
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref12
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref13
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref14
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref15
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref16
http://dx.doi.org/10.1016/j.cma.2016.10.022
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref18
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref19
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref20
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref21
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref22
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref23
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref24
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref25
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref26
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref27
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref28
http://refhub.elsevier.com/S0045-7825(16)30332-2/sbref29

	Reduced order modeling strategies for computational multiscale fracture
	Introduction
	Multiscale mechanical model for propagating fracture
	Notation adopted in this work
	Micro-cell model accounting for material failure: Variational boundary value problem (VBVP)
	Alternative descriptions of the micro-cell VBVP
	Formulation in micro-strain fluctuations
	Formulation as a saddle point problem


	RVE reduced order model
	Problem formulated in reduced strains
	Construction of a POD basis for the micro-strain fluctuations
	Collecting sampled solutions: the sampling program
	Partition of the micro-strain reduced basis

	Hyper-reduced order model (HPROM)
	Determination of the Reduced Optimal Quadrature (ROQ)

	POD basis for the free energy
	Evaluation of the homogenized stresses and effective constitutive tensor

	RVE off-line sampling program design
	Methodology for sampling snapshots in given trajectories
	Sampled RVE's

	Numerical assessment
	Consistency tests
	A-priori (off-line) consistency error of the ROM model
	A-posteriori consistency error of the ROM model

	HPROM solutions for non-sampled trajectories
	Design of the HPROM strategy
	Multiscale crack propagation problem: L-shaped panel

	Concluding remarks
	Acknowledgments
	Multiscale model for propagating fracture
	Macroscopic model
	Kinematics
	Equilibrium and constitutive equations

	Micro-cell model accounting for material failure
	Finite element model of the RVE

	Hyper-reduced saddle-point formulation for inelastic mechanical problems
	Saddle-point formulation
	Hyper-reduction of the problem
	Low-dimensional problem. Reduced order model (ROM)
	Reduced Optimal Quadrature (ROQ)


	Displacement fluctuation field recovery
	References


