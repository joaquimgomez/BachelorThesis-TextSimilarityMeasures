












































PROCEDURE BASED ON COMPOSITE FEM1
TECHNOLOGY FOR THE RESOLUTION OF2
CONCRETE FRAMED STRUCTURES WITH3
MASONRY IN-FILLS - COMPARISON WITH4

MEXICAN BUILDING CODE.5

Cuauhtemoc Escudero 1 2 (cuauhtemoc@cimne.upc.edu),
Sergio Oller 1 2 (sergio.oller@upc.edu),

Xavier Martinez 2 3 (xmartinez@cimne.upc.edu),
Alex Barbat 1 2 (alex.barbat@upc.edu).

6

ABSTRACT7
The construction of confined masonry buildings have become a good choice to meet8

the housing needs of low income families in big cities. Despite this, current building9
codes for such constructions, allows the use of highly simplified analysis techniques,10
that have hardly changed in the last 40 years.11

This paper is based on the numerical simulation, and emerges as the need to combine12
and improve existing technologies in the field of FEM (Finite Element Method) analysis13
for composite materials, to assess the overall structural behavior of reinforced concrete14
structures with masonry in-fills, and consequently, to support the derivation of rational15
rules for analysis and design purposes. So, through the use of a simple yet powerful16
shell FE (Finite Element), the state-of-the-art theories of mixtures to analyze composite17
materials, a computational tool to generate the volume fraction of composites, and a18
Mexican building code, this paper pretends to be a guidance to numerically reproduce19
the overall behavior of confined masonry structures.20

Keywords: Laminated element, Composite materials, large reinforced concrete21
(RC) structures, mechanical plane, Masonry structures, Mexican building code22

INTRODUCTION23
Confined masonry construction was introduced in Mexico City, Mexico, in the24

1940’s to control the wall cracking caused by large differential settlements under25

1Departamento de Resistencia de Materiales y Estructuras en la Ingenieŕıa, ETSECCPB,
Technical University of Catalonia, Spain.

2Centre Internacional de Metodes Numerics en Enginyeria (CIMNE), Gran Capitá s/n, 08034
Barcelona, Spain

3Departamento de Ciencia e Ingenieŕıa Náutica, FBN, Technical University of Catalonia,
Pla de Palau 18, 08003 Barcelona, Spain

1



soft soil conditions. Several years later, this system became popular in other ar-26
eas of highest seismic hazard due to its excellent earthquake performance (Meli27
and Alcocer 2004), but was until early 60s when the proper study of confined28
masonry started in the country, when Esteva (Esteva 1961; Esteva 1966; Esteva29
1963) tested masonry walls confined with reinforced concrete. Later on, several30
studies were made at the time, like the ones made by Meli et al. (Meli et al.31
1968), Meli and Salgado (Meli and Salgado 1969), Madinaveitia and Rodŕıguez32
(Madinaveitia and Rodŕıguez 1970), Turkstra (Turkstra 1970), Meli and Reyes33
(Meli and Reyes 1971), Madinaveitia (Madinaveitia 1971), Meli and Hernández34
(Meli and Hernández 1971; Meli and Hernández 1975), being the bases upon35
Hernández in 1975 (Hernández 1975) provided design and construction recom-36
mendations for structures made out of masonry bearing walls. Thus, in 197737
the first Mexican code for design and construction of masonry structures was38
established, where, for design purposes, a simplified use of mechanical of materi-39
als theories is used, which led to model confined masonry building subjected to40
ground shaking, mainly:41

a. As a truss (Brzev 2007), where masonry walls act as diagonal struts sub-42
jected to compression, whereas the reinforced concrete confining members43
act in tension/compression, depending on the lateral earthquake forces.44

b. As a frame (Fundación 1999), where confined masonry walls are modeled45
using an equivalent column, it is assumed the beams have infinite stiffness,46
and diagonal struts are used to model the slabs.47

In both cases, the analogy made are highly simplistic and lack in accuracy. Re-48
searching work has also been extended to the numerical field applying the finite49
element method. The majority of the proposed modeling strategies, in order50
to study the mechanical behavior of masonry has been identified by Lourenço51
(Lourenço 1996) and Rots (Rots 1997), and can be classified in two categories:52

• Micro-modeling, or two-phase material models: where the compo-53
nents are considered separately to account for the different inelastic be-54
havior, and the interaction between them. Analysis within this category55
are computationally quite expensive to use due to several reasons, such as,56
the great number of degrees of freedom involved, they require more input57
data, and their failure criterion has a complicated form because of the58
brick-mortar interaction. On the other hand, the constitutive equations of59
the components have normally a simple form, and they are suitable for the60
study of local behavior of masonry. This modeling strategy is categorized61
into62

a. Detailed micro-modeling where units and mortars are represented63
as continuum, with the unit/mortar interfaces modeled using dis-64
continuous interfaces elements as potential cracks, slip and crushing65
planes.66

2



b. Simplified micro-modeling through the adoption of geometrically ex-67
panded masonry units with a single average interface representing68
the mortar and the two mortar/unit interfaces. This models re-69
quires the material model of the expanded unit and masonry joints.70

• Macro-modeling or one-phase material models: treat masonry as71
an ideal homogeneous single material with constitutive models that differ72
from those of the components (mortar and bricks). The constitutive mod-73
els of this category are more efficient for a practice-oriented analysis due74
to the reduced calculation time and memory requirements, as well as due75
to the user-friendly mesh generation. The resulting material is regarded76
as an anisotropic composite and a relation is established between average77
masonry strains and average masonry stresses. Such material must repro-78
duce an orthotropic behavior as well as different tensile and compressive79
strengths along the material axes and different inelastic behavior for each80
material axis, which leads in more complicated constitutive equations.81

Current theories that allow the use of two-dimensional FE to model three-82
dimensional structures with composite materials, yet powerful, lack the necessary83
simplicity for their application in complex structures, where a large amount of84
FE are required to obtain a good approximation of the result. Thus, simpler and85
more efficient techniques are required for modeling three-dimensional laminated86
structures.87
The main objective of this work, is to develop an efficient methodology, and to88
be able of numerically reproduce the behavior of an entire masonry structure,89
to subsequently, find reliable estimates of the non-linear response which leads to90
fully understand the failure mechanisms and assess its safety.91
In order to achieve this objective, the state of the art for shell elements and92
for rules of mixtures for composite materials has been reviewed. Also the code93
regulations regarding the analysis and design of masonry buildings have been re-94
viewed, to compare the obtained results with the proposed analysis scheme.95
Finally, the theoretical principles used will be defined and applied to assemble96
a robust numerical tool capable of predicting the behavior of real life structures97
from linear elastic stage, through cracking and degradation until complete loss of98
strength.99
The paper is organized as follows. In section 2 is briefly described the used FE100
formulation for a shell finite element that reproduces in-plane (membrane) and101
out-of-plane (bending) non-linear behavior, also is described the used constitutive102
formulation for simple materials and for composite materials. Section 3 describes103
the methodology to determine the information related to the simple and com-104
posite materials, the procedure to mechanically generate the volume fraction for105
the composite materials, and a description of the followed computational strat-106
egy. Finally in section 4 a numerical tests is presented and compared with the107
Mexican in force Building code.108

3



The proposed approach is a general purpose one to treat large-scale reinforced109
concrete structures with masonry in-fills. The use of the Mexican Code was110
merely to have a base to compare the obtained results in terms of initial stiffness111
and total shear strength.112

FINTE ELEMENT FORMULATION113
Simulation of large multi-layered structures with many plies can be unafford-114

able with three-dimensional analyses because of the excessive computational cost,115
especially for non-linear materials. In addition, the discretization of very thin lay-116
ers can lead to highly distorted elements carrying numerical issues, hence, reduced117
models using multilayer shell elements arise as an affordable solution (Eijo 2014).118
In this section is carried out a brief description of the shell element used along119
this work, which besides its reliability, one key aspect which led to select it was120
the computational resources required for its implementation in a FE code.121

Shell element model122

One of the most popular approaches in the FE analysis of shells is to use an123
assemblage of flat triangular elements as an approximation to the curved surface,124
in addition, such FE can be obtained by combining a membrane and a plate125
bending element (Khosravi et al. 2007).126
There are several triangular plate bending elements to select and combine with127
membrane elements, next is carried out a brief description of the membrane and128
bending which have been selected due to their reliability (Batoz 1982; Felippa129
2003).130

Membrane element131

A membrane element without including a in-plane rotation degree (drilling132
rotation) leads to in-plane rotation singularity (Hughes and Brezzi 1989). Suc-133
cessful attempts at developing membrane elements with drilling degree of freedom134
are due to the work by Allman (Allman 1984) and later Felippa (Bergan and Fe-135
lippa 1985) developed an OPTimal membrane element with drilling degree of136
freedom.137
The degrees of freedom of the OPT membrane element are collectable in the138
nodal displacement vector as139

dm = {u1 v1 θz1 u2 v2 θz2 u3 v3 θz3 }T (1)140

The fundamental element stiffness decomposition of the two-stage direct fabrica-141
tion method is142

Km = Kmb + Kmh (2)143

where Kmb is the basic stiffness, which take care of the consistency, and Kmh144
is the high order stiffness, which takes care of stability (rank sufficiency) and145
accuracy. The final form of Km is a template with 11 free parameters, leading to146

K(αb,β0,...,β9)m =
1

V
LDmL

T +

∫
Ω

BTmDmBm dv (3)147

4



For a full reference of the geometry and the computational implementation of148
the OPT element reader may consult reference (Felippa 2003) where an exten-149
sive study of high-performance elements using an ANDES (Asumed Natural150
DEviatoric Strain) template is presented.151

Bending element152

Batoz (Batoz 1982) studied several triangular Kirchhoff plate bending ele-153
ments and showed that Discrete Kirchhoff Triangle (DKT) (Batoz et al. 1980) is154
the most reliable triangular element for the analysis of thin plates, d.o.f for such155
element can be presented in a vector as156

d b = {w1 θx1 θy1 w1 θx2 θy2 w1 θx3 θy3}T (4)157

where the evaluation of the stiffness matrix follows the standard procedures of158
the finite elements methods, this is159

Kb =

∫
Ω

BTb DbBb dA = 2A

∫ 1
0

∫ 1−ζ3
0

BTb DbBb dζ2dζ3 (5)160

For a full description of the DKT element and for the numeric implementation161
reader may consult reference (Batoz et al. 1980).162
In this work, it will be used the DKT element combined with the enhance-163
ment to the plate element proposed by Escudero (Escudero 2015; Escudero et al.164
2016), where in the integration along the thickness of the element is used an ESL165
(Equivalent Single Layer) description which takes into account the evolution of166
the eccentricity of geometric and mechanical planes. This makes it suitable for167
modeling the bending damage of shell structures at a low computational cost,168
since there is no need of additional degrees of freedom that the ones listed in169
equation 4.170

Constitutive formulation171

In this section a brief description of the expected bending degradation is172
carried out, focusing on the evaluation of the secant constitutive tensor Dsec,173
which is required to reproduce the bending degradation that arises when some174
layers within a laminated plate are beyond the elastic threshold and others are175
not.176

Concrete177

Concrete is a composite material, since it is produced of a granular material178
(aggregate) embedded in a hard matrix of material (cement), however, it is a179
common practice to represent its behavior using a macro-model scheme for a180
simple quasi-brittle geo-material, even though its high non-linear performance is181
achieved due formation of micro-cracks and slipping among its aggregate particles182
(Oller 1998).183
Large interest given to mechanical properties of concrete comes from its wide184
application range to the construction field, which has led to several authors to185
develop constitutive models to represent its mechanical behavior (Bazant and186

5



Pijaudier-Cabot 1989; Hillerborg et al. 1976; Rots and De Borst 1987). However,187
it was not until early eighty when models (Chaboche 1988a; Chaboche 1988b; Ju188
1989; Lemaitre 1985; Oliver et al. 1990; Simo and Ju 1987; Simo and Ju 1989)189
based upon the CMD (Continuum Damage Mechanics) were applied to model190
concrete materials.191

Two-scalar damage models Among the different possibilities the CDM offer,192
the simplest is the one referring to isotropic damage models where the non-linear193
behavior is monitored through a single internal scalar variable d called damage194
or degradation. The meaning of the internal variable d is the measurement of the195
loss of stiffness in the material, and it ranges from 0 to 1, being 0 an undamaged196
material and 1 for a fully degraded one (Oliver et al. 1990).197
Another approach highly extended to model the opening and closing of cracks198
due cyclic loads in geomaterials is the one proposed by Faria et al in (Faria et al.199
1998), where two scalar damage variables d+ and d− are introduced as internal200
variables, so it is possible to distinguish among the damage produced by tensile201
stresses (cracking) and the damage produced due compressive stresses (crushing).202
The nature of the scheme proposed by Faria et al makes it more convenient for203
seismic analysis purposes.204
From the definition of the elastic secant constitutive tensor, it can be evaluated205
for this scheme as (Faria et al. 1998):206

Dsec =
∂σ

∂ε
= (1− d+)

∂2Ψ+0
∂εe ⊗ ∂εe + (1− d

−)
∂2Ψ−0

∂εe ⊗ ∂εe (6)207

where208
σ = Dsec : ε (7)209

The use of two internal variables to reproduce the damage is an advantage in210
terms of the constitutive analysis, on the other hand, it becomes cumbersome211
while trying to establish one single parameter that defines the degradation of the212
material. This it can only be achieved with a equivalent damage index (Paredes213
et al. 2011) (eq. 13).214
In this work the damage model to represent the behavior of geomaterials will215
be carried out using the scheme presented by Paredes (Paredes 2013), which216
conceptually is based on the scheme proposed by Faria, consisting in a two-scalar217
damage model.218

Masonry219

Depending on the accuracy and the simplicity desired, masonry can be mod-220
eled using:221

• Detailed Micro-Modeling: Units and mortar in the joints are repre-222
sented by continuum elements whereas the unit-mortar interface is repre-223
sented by discontinuous elements.224

6



• Simplified Micro-Modeling: Expanded units are represented by contin-225
uum elements whereas the behavior of the mortar joints and unit-mortar226
interface is lumped in discontinuous elements.227

• Macro-Modeling: Units, mortar, and unit-mortar interface are bonded228
in the continuum.229

• Homogenized Modeling: This strategy is placed midway between micro-230
modeling and macro-modeling, since it consists in obtaining macro-231
constitutive laws starting from the micro-constitutive law of the constituents232
and the internal geometry of the masonry.233

Advantages and disadvantages of each approach are discussed in (Lourenco et al.234
2007; Lourenço 1996; Pelà 2009). This work uses a Macro-Modeling approach,235
combininig the damage model proposed by Paredes (Paredes 2013) with the or-236
thotropic yield criterion proposed by Oller et al (Oller et al. 2003). The macro-237
modeling scheme will be used because it is more practice oriented, due to the238
reduced time and memory requirements, as well as for the implied user-friendly239
mesh generation. Also because it provides the best compromise between accuracy240
and efficiency.241

Orthotropic yield criterion The objective of the approach proposed by Oller242
et al. (Oller et al. 2003) is to adjust an arbitrary isotropic yield criterion to the243
behavior of an anisotropic material. Is very convenient to apply this scheme to a244
macro-modeled masonry material due to its anisotropic nature.245
The transformed-tensor method is based on assuming the existence of a real246
anisotropic space of stresses σij and a conjugate space of strains εij, such that247
each of these spaces has its respective image in a fictitious isotropic space of248
stresses σij and strains εij, respectively. The corresponding relationships among249
them are;250

σij
def
= Aσijklσkl ; ε

def
= Aεijklεkl (8)251

where Aσijkl and A
ε
ijkl are the transformation tensors, for stress and strain, respec-252

tively, relating the fictitious and real spaces. These four-rank tensors embody the253
natural anisotropic properties of the material.254
The stress transformation tensor Aσijkl is a result of the properties of the materials255
and the shape of the yield surface, namely,256

Aσijkl =
(
Bσijkl

)−1
= (Wijrsαrskl)

−1
(9)257

where, Wijrs contains information on the yield stress along every axis of or-258
thotropy, and αrskl is the shape adjustment tensor (section 6 ref. (Oller et al.259
2003)). The relationship between the stress and strain transformation tensors260
can therefore be expressed as261

Aεrsmn =
[
C
σ

rsij

]−1
AσijklC

σ
klmn (10)262

where C
σ

rsij and C
σ
klmn represent the constitutive tensor in the fictitious and real263

space, respectively.264

7



Steel The most common approach to represent the behavior of ductile materi-265
als, such as steel, is via a macro-mechanical theory of plasticity (Kojić and Bathe266
2005) based on the notions of a yield surface giving the yield condition, a hard-267
ening rule and on the stress-plastic strain relations of the given material.268
The concepts of classic plasticity can be extended to plastic damage models, like269
the one proposed by Oller in (Oller 1998) or Martinez (Martinez et al. 2015),270
where it is used a normalized internal variable to represent the plastic damage271
κp. Range of values for κp are 0 ≤ κp ≤ 1, such that if κp = 0 there is no plastic272
damage, and κp = 1 defines the total damage of a solid.273
There are also other CDM which include the presence of permanent deformations274
on the mechanical behavior of geomaterials (Jason et al. 2006; Lubliner et al.275
1989; Mazars and Pijaudier-Cabot 1989; Tao and Phillips 2005) especially in276
concrete subjected to compression, where the internal variables are represented277
by damage variables and also for the permanent plastic deformation.278
The idea of using one single damage variable in a general form has been ex-279
plored by Paredes (Paredes 2013) to be applied in the assessment of the natural280
frequency of vibration of structures. Paredes considers the different existing pos-281
sibilities to define the damage index d, and proposes the index deqv be a function282
of the yield surface f(σ0) defined as:283

deqv = 1−
f(σc0)

f(σ0)
(11)284

hence, is now possible to use the damage index deqv in equation 7 to obtain an285
equivalent secant tensor. In equation 11 f(σ0) is evaluated with the current286
tensor of stress, whereas f(σc0) is evaluated with the tensor of effective stresses287
that define the damage threshold of the material which is defined as288

σc0 =



f ∗0 0 0

0 0 0

0 0 0


 (12)289

where f ∗0 is nominal threshold of the material’s resistance. For the case of con-290
crete, such threshold is defined by the resistance to compression, whereas for291
ductile materials such as steel, it is defined by the yield stress.292
Finally, the use of equation 11 takes to the modification of equation 7 resulting293
in equation 13.294

Dsec = (1− deqv)D0 (13)295
In this work, mechanical behavior of steel will be reproduced using the governing296
equations of classical rate-independent plasticity model (Simo and Hughes 1998)297
projected onto the plane-stress subspace and combined with a von Mises yield298
function.299

8



Mixing theories300

In a general sense, a mixing theory is a weighted mean proposed for modeling301
non-linear mechanical behavior of composite materials made up of continuum or302
unidirectional fibers.303
CMT (Classical Mixing Theory) was firstly studied by Truesdell and Toupin304
(Truesdell and Toupin 1960) establishing the basis for subsequent developments,305
like the ones made by Ortiz and Popov (Ortiz and Popov 1982), Oller et al (Oller306
et al. 1993) and Oñate et al (Oñate et al. 1991).307
CMT takes into account the volume fraction of components but not its morpho-308
logical distribution, being this a strong limitation to predict the behavior of most309
composites.310
Modifications to this theory were developed by Rastellini (Rastellini 2006) making311
the composite behavior dependent on the constitutive laws of component mate-312
rials according to their volume fractions and to their morphological distribution313
inside the composite.314
The Serial-parallel (SP) mixing theory proposed by Rastellini (Rastellini 2006)315
assumes that components behave in parallel (iso-strain condition) in the fibers316
direction and in serial (iso-stress condition) in the orthogonal directions. This317
work will simulate the composite materials with the SP mixing theory, following318
the approach used by Martinez in (Mart́ınez 2008).319

PROPOSED METHODOLOGY320
From a computational-cost point of view, the only viable strategy to perform321

the analysis of structures built from a large number of masonry units and joints,322
confined by RC elements with different reinforcement patterns, is using a smeared-323
cracking and the macro-modeling strategy. Hence the present section focuses on324
the definition of information related to the composite materials. It also focuses325
on the meshing requirements in order to carry out the analysis of such structures.326
An a priori concern in the proposed scheme is that the computational process327
in terms of time-consuming and RAM (Random Access Memory) needed would328
be rather expensive. Hence, as an attempt to overcome such disadvantage some329
alternatives have been explored, and are listed in this section.330

Thickness discretization for structural elements331

The shell element model used in this work is able of reproducing the out-of-332
plane degradation due to bending stresses. In order to reproduce this effect with333
a higher accuracy, becomes mandatory to perform a finer layer distribution of the334
laminated materials in the following cases (Escudero 2015):335

• At the farthest zones away from the geometric axis of the shell, since such336
layers will be subjected to the higher stresses while acting a bending stress.337

• At zones where exist a abrupt change of stiffness, as is the case of the pres-338
ence of steel reinforcement within the concrete, no matter their position339
within the overall thickness.340

9



Meshing and composite materials generation341

To cover the meshing needs, is selected the use of a pre and post processor342
for numerical simulations, in this case GiD (CIMNE 2015). GiD is a universal,343
adaptive and user-friendly pre and post-processor for numerical simulations in344
science and engineering designed to cover all the common needs in the numerical345
simulations field from pre to post-processing: geometrical modeling, effective346
definition of analysis data, meshing, data transfer to analysis software, as well347
as the visualization of numerical results. The process to obtain the required348
information to model a large structure formed by laminated materials where each349
layer are composite materials can be a cumbersome task. This because within350
the laminated material not only changes the orientation of the fibers, but also351
the thickness of the layer, and consequently, the volume participation of fiber and352
matrix. So, in order to overcome this situation, and being able to reproduce real353
life structures in term of steel reinforcement patterns, a computational tool has354
been developed having in mind the 3 principal requisites shown below.355

1. It must be capable of reproducing a more realistic steel reinforcement356
pattern.357

2. It has to be a mechanized process where volume participation of compo-358
nents on a composite materials are generated automatically.359

3. It has to be capable of handling information of large meshes.360

Such tool arises as a need of mechanizing and generate the composite material361
information given a large mesh of triangular finite elements and a real life steel362
reinforcement pattern of every layer within the composite. To achieve this, it is363
necessary to read pre-defined text files, where the information regarding the steel364
reinforcement patterns has been stored.365
The starting point of the generation of the composite materials presented here,366
is something called structured composite material (SCM from now on), where a367
pattern is selected to represent both, the reinforcement steel within layers and368
the SCM’s boundary. Main idea behind the use of this method, is making as369
mechanical as possible the generation of the composite material for every layer370
of the FE.371
A reader experienced in computer drawing design (using AutoCAD), would find372
similarities of a SCM with a hatch. Namely, both are a general pre-generated373
pattern of bi-dimensional closed polygons (steel reinforcement in the case of a374
SCM) stored in a text file, such pattern is ready to be used as much as needed,375
and becomes particular, once is given to it, information such as: a contour, a376
local x’, y’ plane and an insertion point. Then the code on purpose will take care377
of generate information such as: volume participation, fibers direction (when378
applicable), and thickness for every layer of the SCM. The process to generate379
such information is carried out as follows:380

1. Is generated the text file containing information related to all SCM within381

10



the model, also boundaries and insertion points are included.382
2. FE mesh is generated for the model (using GiD).383
3. The code on purpose searches for the FE’s intersecting the contour of the384

SCM.385
4. With the FE’s intersecting the given SCM, volume participation of the ma-386

trix mk and fiber fk for each layer are evaluated using the intersecting387
area of the steel reinforcement with the FE. In the case, when fk = 0388
the classic mixing theory is selected, whereas serial-parallel mixing theory389
shall be used if fk 6= 0.390

5. Finally, in order to reduce the number of composite materials, a smoothing391
for the volume participation of fiber is used.392

Let us consider figures 1 as an aid for a better explanation of the proposed393
method. Figure 1 shows structural drawings of a building with columns type C-01394
and beams type B-01, it is also shown the distribution of the steel reinforcement395
for the concrete slab.396
Using the proposed scheme, to model structure on figure 1 a total of three SCM397
will be required. The first one (SCM-01), represents the frame of both; axis 1 and398
2, the second one (SCM-02) represents only the beams along construction axis A399
and B. Finally, a third one (SCM-03) will be needed to represent the concrete slab.400
Section X-X’ from figure 1 can be seen as SCM-01, since it can be repeated over401
axis 1 and axis 2. Using figure 2 as a reference, step 1 of the proposed method, is402
to generate the information of the SCM, the starting point is the cross section of403
the corresponding structural elements (fig. 2.a) to later define the contour, and404
an insertion point A to refer the reinforcement pattern of all layers to such point405
(2.d).406
Once the mesh has been generated (step 2) the code on purpose searches for the407
FE’s intersecting the contour of the SCM. Figure 2.c depicts the result of step 3408
(SCM-01 at constructive axis 2). Step 4 consists in overlapping the reinforcement409
pattern and the intersecting FE’s of a given SCM to obtain the volume partici-410
pation of the matrix mk and fiber fk, and the fiber direction for each layer (fig.411
2.d). Finally, step 5 is performed to reduce the amount of composite materials412
generated.413

Computational strategy414

In this section are described the improvements performed in PLCd (CIMNE415
2014), in order to make possible to analyze large structures in a reasonably short416
amount of time. PLCd (CIMNE 2014) is a state of the art implicit finite element417
code written in Fortran, and originally developed by Prof. Oller at CIMNE. It418
has been developed to treat a large variety of composite materials through the419
use of Rules of Mixtures.420

Time-based optimization421

The optimization process in terms of time has been carried out using a paral-422
lelization scheme with OpenMP (Barney et al. 2010) directives in three different423

11



sections of the code. Such sections are shown below.424

1. Loop over elements while evaluating the generalized strains ε̂ and the425
generalized stresses σ̂.426

2. Loop over elements while integrating the constitutive equations (plasticity,427
damage, etc.). In this portion of the code the goal is to evaluate internal428
forces of each FE so they can be assembled into a global vector usually429
referred to as LHSg. Hence, the elemental LHSe can be evaluated in430
different threads to later be assembled restricting the access to the LHSg431
vector to only one thread at the time.432

3. Loop over elements while writing/reading information to perform a restart433
operation.434

Memory-consuming optimization435

A scheme using user-defined data types was implemented, where, at the be-436
ginning of the analysis process, the information is reserved and only allocated437
while needed (once the FE is in a non-linear range), leading to a less necessity438
of RAM memory resources. Starting from the assumption that not all elements439
reach a non-linear behavior, the proposed programming scheme (shown below)440
was implemented in PLCd.441

• It was used a template to store internal variable for every non-damaged442
FE with the same composite information. At this point it is not necessary443
to store strain or stress information of composite neither components of444
the laminated material.445

• Once a component within a FE has reach a non-linear behavior, then446
allocation of memory to store information of the FE was required (internal447
variables, stresses and strains).448

• Allocating at every loading step or iteration may be time consuming, how-449
ever, it will be justified for large structures where a considerable amount450
of RAM would be required.451

• For output and visualization purposes (writing information in GiD format)452
the information of non-damaged finite elements is evaluated using their453
local displacements, which can be seen as the major drawback.454

Basically, the process followed is this: if any of the components within any layer455
of the laminated material reach a non-linear range, such FE is considered as dam-456
aged, thus, information of the components has to be stored. Otherwise, strains457
and stresses are evaluated using the local displacements of the finite element.458
The use of an iterative solver has also been considered, so, it has been imple-459
mented in PLCd the library developed by Vargas and Botello-Rionda (Vargas-460
Félix and Botello-Rionda 2012), which contains routines running in parallel, to461
handle and solve the typical linear systems of equations resulting from finite el-462
ement or finite volume discretizations for a large number of unknowns. In the463
studied cases only comparisons in terms of consumed memory were carried out,464

12



however, further comparisons in terms of running time while using an iterative465
solver are required, to fit the best alternative.466

NUMERICAL EXAMPLES467
In this section two practical examples are proposed and intended to test the468

capabilities of the proposed analysis scheme. The first one corresponds to an469
experimental test carried out by Meli (Meli 1979) used in order to reproduce,470
from an experimental point of view, the isolated behavior of a masonry wall471
confined with two columns and a beam made of reinforced concrete. The second472
model corresponds to a construction outlined through structural drawings, sized473
and structured following the building code regulations for masonry structures in474
Mexico City. The results obtained using the building code regulation for this475
structure are for comparative purposes.476

Reinforced Concrete Frame With Masonry In-fill477

The example reproduced in this section, corresponds to an experimental test478
carried out by Meli, and fully described in (Meli 1979). Geometry of analyzed479
specimen is depicted in figure 3, where it is presented a lateral view (fig. 3.a)480
and a frontal view (fig. 3.b), also it is presented the location of the confining481
structural elements (C-01 and B-01), the distribution of the masonry units, and482
the boundary conditions such as, an imposed displacement at the top, and a483
fixed support at the bottom. Figure 3.b also depicts an overlapping of the crack484
patterns of the experimental test (Meli 1979). In the present study the masonry485
in-fill exhibits the typical response that takes place for low resistance masonry486
units, i.e. crack will cross indistinctly throughout masonry unit or mortar.487
To reproduce numerically the present model, three simple materials are involved,488
mechanical properties of each one of them are described next.489

Steel490

• Elasticity modulus: E = 2.1x105MPa491
• Poissons’s Ratio: υ = 0.00492
• Self-weight: γ = 7845kg/m3493
• Yield criterion: Von Mises.494
• Damage thresholds:495

σc = 270MPa σt = 270MPa496

• Fracture energy:497

Gc = 2.0MPa ·m. Gt = 2.0MPa ·m498

Concrete Mechanical properties of concrete have been evaluated considering499
a compression resistance equal to f ′cy = 250kg/cm

2 (24.53x106N/m2), to later,500
evaluate the elasticity modulus according to section 1.5.1.4 of reference (NTC501
2004b), namely:502

13



E = 4400
√
f ′cy (14)503

where units of equation 14 are given in MPa. All other mechanical properties504
needed are shown below.505

• Elasticity modulus: E = 2.18x104MPa506
• Poissons’s Ratio: υ = 0.00507
• Self-weight: γ = 2500kg/m3508
• Yield criterion: Mohr Coulomb.509
• Damage thresholds:510

σc = 24.53MPa σt = 2.45MPa511

• Fracture energy:512

Gc = 50.0KPa ·m. Gt = 5.0KPa ·m513

Masonry Mechanical properties used to reproduce behavior of the masonry514
in-fill, have been obtained assuming a compression resistance of f ′m = 40kg/cm

2
515

(3.92MPa) and υ∗m = 1.1kg/cm
2 (0.15MPa). Hence, elasticity modulus Emx =516

1.37x103MPa according to section 2.8.5.2 of reference (NTC 2004c), where517

Emx = 350f
′
mcy (15)518

elasticity modulus is evaluated under sustained loads (eq. 2.6) reference (NTC519
2004c).520

• Elasticity modulus:521

Emx = 1.37x103MPa522

Emy = 0.73x103MPa523

• Poisson’s ratio: υxy = 0.10, υyx = 0.15524
• self-weight γ = 1300kg/m3525
• Yield criterion: Mohr Coulomb.526
• Damage thresholds:527

σmcx = 3.920MPa σmtx = 200KPa528

σmcy = 1.270MPa σmty = 65KPa529

• Fracture energy:530

Gc = 20.0KPa ·m.531
Gt = 0.2KPa ·m532

Cross section of confining elements are presented in figure 4.a. Both section C-01533
and B-01 have been discretized using 10 layers with different thickness, since they534

14



have been adjusted to the location of the steel reinforcement. General location of535
the steel reinforcement is displayed in figure 4.b, there, it can be seen that layers536
01, 05, 06 and 10 do not have steel reinforcement, whereas, layer 03 and 08 con-537
tain both beam’s stirrup steel reinforcement (φ6.4mm) and column’s main steel538
reinforcement (φ15.9mm). On the other hand, layers 04 and 07 contain only the539
main steel reinforcement of beams, and finally, layers 02 and 09 contain only the540
stirrup steel reinforcement of columns. The analysis has been performed using541
two lading stages, the first one corresponds to gravity loads evaluated using the542
self-weight of the corresponding material, the second loading stage correspond to543
a pushover analysis intended to predict the force-displacement response of the544
structure.545
Comparison among force-displacement response of both, Meli (Meli 1979) and546
the present work is presented in figure 5.a. Figure 5 from b to d depict the547
damage state of three different loading steps δ1 = 0.46mm, δ2 = 1.94mm and548
δ3 = 7.66mm. Column on the left shows the damage state of layer 01 of the con-549
fining elements, column on the center displays the damage state of the masonry550
in-fill, and finally column on the right shows the stresses in local direction of steel551
fibers within layer 03.552
In both cases depicted in figure 5.a, the response is characterized by a high-553
stiffness zone at the beginning of the loading process. However, such response is554
followed by a slight decreasing of stiffness due the separation of the masonry cor-555
ners and the confining elements, as reported by Meli, such behavior was not556
captured in the present work leading to a significant difference in the force-557
displacement response, since only one diagonal crack is starting to grow while558
performing the numerical simulation, as can be seen in figure 5.b.559
Finally, beyond the point where occurs a slight loss of stiffness (δ2), characterized560
by the apparition of several diagonal cracks, a better concordance in the response561
between both testes is observed.562

One storey construction563

This example is a one-storey construction with the typical dimensions of a564
bedroom and will serve to highlight the capabilities of the analysis scheme pro-565
posed in this work, for now on, such model will be referred to as B-OSC.566
Building B-OSC is structured with load-bearing walls and a roofing system based567
on a solid reinforced concrete slab. It has a window in the rear façade, and a568
window and a door in the front façade. Load-bearing walls have been structured569
to meet the requirements of the masonry code regulation (NTC 2004c) in force570
for the Mexico City, namely:571

• Masonry units meet the minimum width necessary to prevent buckling572
problems in slender walls, according to section 5.1.4 of reference (NTC573
2004c).574

• Reinforced concrete elements whose purpose is confining the load-bearing575
masonry wall, meet the maximum separation among themselves in plan,576
in addition, also meet the rates of reinforcing steel necessary due bending577

15



and temperature, according to provisions stated in section 5.1.1, reference578
(NTC 2004c).579

• Openings like doors and windows in masonry load-bearing walls have been580
reinforced in the whole perimeter using beams and columns, according to581
provision stated in section 5.1.3, reference (NTC 2004c).582

• The thickness of the roof slab meets the requirements necessary to main-583
tain the deflections within the serviceability limits stated in section 3 of584
reference (NTC 2004b).585

Structural Drawings586

The structural drawings for the construction B-OSC are shown in figure 6.587
Effort has been put to make them as close to real life construction as possible,588
especially regarding the distribution of steel reinforcement, where the simplifica-589
tions that a structural engineer would make for an easy placement in the field.590
Typically, in all drawings the diameters of the reinforcing steel rods are shown in591
millimeters, although they correspond to the British nomenclature, where diam-592
eters of 6.4mm, 9.5mm y 1.27mm correspond to 1/4”, 3/8” y 1/2” respectively,593
this will be maintained as a common practice in structural drawings presented594
along this section.595

Structural elements596

A brief description of the reinforced concrete structural elements involved in597
the structure of this section is carried out next.598

Masonry in-fills Regarding the masonry in-fills, it will only be mentioned that599
has been discretized using an arrangement of 12 layers whose thickness have been600
detailed in figure 7.601

Columns It has only been selected one cross section for columns, which is602
shown in figure 8.a, named Kc-01 and endowed with a main steel reinforcement603
of 4 rods φ12.7mm (1/2”), whereas the secondary steel reinforcement is formed by604
steel rods φ6.4mm (1/4”) with a separation among themselves of 15 centimeters.605
Cross section Kc-01 has been discretized using an arrangement of 18 layers whose606
thickness is presented also in figure 8.b.607

Beams Two different sections of beams have been selected. The first one named608
Kb-01 to be used in the regular walls (union of the beam with the concrete slab),609
and the second one named Kb-02 to be used in the lower walls (walls forming the610
window opening).611
Figure 8.a shows the steel reinforcement pattern and layer distribution of both612
sections Kb-01 and section Kb-02. The basic difference among them is their613
height, since in both cases, the main steel reinforcement (4 rods φ12.7mm) and614
the secondary steel reinforcement (rods φ6.4mm separated 15 centimeters) are615

16



the same. Also, in both cases, the thickness has been discretized using an ar-616
rangement of 18 layers (table 8.b).617
In both cases, beam sections have a coating for the transverse steel of 33 millime-618
ters (left and right side) and 20 millimeters at the upper and lower part, this is619
usually done in the field as an adjustment to prevent longitudinal steel overlaps.620

Slabs Although simple materials that make up the concrete slab were fixed to621
have a linear behavior, it has been discretized using a pattern of 20 layers for a622
total thickness of 15 centimeters (9.b). Layer distribution of reinforced concrete623
slab can be seen in figure 9.a, where also can be noticed the steel reinforcement in624
both beds and in both orthogonal directions. The diameter of the steel reinforce-625
ment rods are φ9.5mm (3/8”), also can be noticed the different separation among626
themselves, which for the lower bed is 30 centimeters, whereas for the upper bed627
is 40 centimeters.628

Simple material properties629

Only three simple materials are needed to perform the analysis of models630
presented in this section, namely: steel, concrete and masonry. Their mechanical631
and constitutive properties are detailed next.632

Steel633

• Elasticity modulus: E = 2.1x105MPa634
• Poissons’s Ratio: υ = 0.00635
• Self-weight: γ = 7845kg/m3636
• Yield criterion: Von Mises.637
• Damage thresholds:638

σc = 420MPa σt = 420MPa639

• Fracture energy:640

Gc = 2.0MPa ·m. Gt = 2.0MPa ·m641

Concrete The compressive strength is assumed equal to642
f ′c = 250kg/cm

2 (24.53x106N/m2). The elasticity modulus is evaluated according643
section 1.5.1.4 of reference (NTC 2004c), namely:644

E = 4400
√
f ′cy (16)645

where units of equation 16 are given in MPa. All other mechanical properties646
needed are shown below.647

• Elasticity modulus: E = 2.5x104MPa648
• Poissons’s Ratio: υ = 0.20649

17



• Self-weight: γ = 2500kg/m3650
• Yield criterion: Mohr Coulomb.651
• Damage thresholds:652

σc = 25.0MPa σt = 3.50MPa653

• Fracture energy:654

Gc = 50.0KPa ·m. Gt = 5.0KPa ·m655

Masonry The mechanical properties of masonry described in this section, have656
been obtained assuming that simple compressive strength (fmcy) of the combi-657
nation of masonry units and mortar is equal to f ∗m = 120kg/cm

2, whereas the658
maximum shear strength is equal to υ∗m = 3.5kg/cm

2. Once such parameters659
have been settled, using 17 ((NTC 2004c)) is now possible to define the elasticity660
and shear modulus. Other mechanical and constitutive properties are described661
below.662

Em = E1 = E2 = 600f
∗
m = 7.06x10

3MPa

Gxy = 0.4Em = 2.825x10
3MPa

(17)663

• self-weight γ = 1500kg/m3664
• Yield criterion: Mohr Coulomb.665
• Damage thresholds:666

fmcx = 5.15MPa fmtx = 350KPa667

fmcy = 12.00MPa fmty = 600KPa668

• Fracture energy:669

Gc = 20.0KPa ·m.670
Gt = 0.5KPa ·m671

Composite material generation672

Since the used methodology to obtain the volume fraction for the composite673
materials belonging to a laminated shell has already been described in section 3674
of this work, in this section is only mentioned the case of a SCM, corresponding675
to the concrete slab (figure 10). Only finite elements belonging to the given SCM676
have been plot, also has been plot the contour of the slab, the steel reinforcement,677
and the contour of the remaining SCM for reference purposes. In both cases only678
is shown the bottom steel reinforcement.679

In figures on the right are depicted the corresponding FE with fk > 0.680

Boundary conditions681

Analysis process has been performed using 3 different loading phases. It is682
convenient to point out that in none of the 3 loading phases have been used the683

18



loading factors that are normally included in building code regulations, neither684
have been used security factor for designing purposes. Analysis has been per-685
formed in this way on purpose, so results obtained using a design code can be686
properly compared with the results obtained using the scheme proposed in this687
work.688

Fixed displacements In all loading phases, the basement of the structure has689
been set to remain rigidly fixed, hence, neither displacements nor rotations will690
be allowed.691

First stage loading condition: Dead loading This loading condition cor-692
responds to combined weight of the elements with structural purpose plus the693
weight of the elements belonging to the structure without a structural purpose694
and only used to fulfill architectural requirements. A small sketch (fig. 11 left) of695
structural and architectural elements belonging to masonry walls is displayed. It696
is also shown a table displaying thickness and weight of all components involved.697

Figure 11 on the right also shows a dead loading analysis; in this case, it is698
about the roofing system. As in the previous example, on the left is shown a699
sketch pointing all materials involved, while in the right part a table detailing700
weights and thicknesses are displayed. Also due the recommendation of article701
197 of reference (RCD 1993), it will be added 40kg/m2, yielding to the total702
weight due to the presence of concrete and mortar DL ≈ 525.0kg/m2.703

Second stage loading condition: Live loading Live loads, are tempo-704
rary and of short duration (while compared to permanent loads), such loads705
are based upon published regulations, in the case of this work, it has been used706
the Reglamento de construcciones para el Distrito Federal (RCD 1993) to predict707
them. Such code regulation in its chapter V article 199.V.g, marks a uniform708
load of 100 kg/m2 to be used in the roof for residential homes, being only valid709
when the slope of the roof is less or equal to 5%.710

Third stage loading condition: Pushover Finally, the third loading stage711
corresponds to a pushover applied separately in both orthogonal direction x and712
y. Hence, for both directions the displacements displayed in figure 12 have been713
imposed and their purpose is to predict the force-displacement response of the714
structure. Obtained results are detailed next.715

Reference solution - Building code716

Figure 13 (on the left) shows a numeration for masonry walls and their total717
length, it is important to state a numeration like this, since most of the results718
presented next will be referred to it. On the right side of the same figure, the719
tributary load of each masonry wall is presented. The total amount of bear-720
loading masonry walls is 5.721

19



For the analysis purposes regarding the code regulation (NTC 2004c), the722
short walls that form part of the window have not been considered, nor the723
stiffness due to reinforced concrete confining elements.724

It is also necessary to point out that according to the detailed analysis shown725
in reference (NTC 2004c), the walls perpendicular (in plan view) to the analysis726
direction have to be neglected, hence, in such cases, stiffness and shear strength is727
equal to 0. Thus, to evaluate the total stiffness and shear strength of the structure728
in X direction, only have to be considered walls W-01 and W-02 (fig. 13), while729
for direction Y only walls W-03, W-04 and W-05 have been considered.730

Table 1 displays the stiffness and shear strength of the masonry walls evaluated731
according to reference (NTC 2004c). From table 1 can be inferred the total732
stiffness of the structure in both orthogonal directions presented in 18.733

Kx = 948005.44kN/m ; Ky = 56602.81kN/m (18)734

also from table 1 it is possible to obtain the total shear strength of the structure735
in both orthogonal direction, this is:736

VxR = 443.12kN ; V
y
R = 168.07kN (19)737

values shown in 18 and 19 will be used as a comparison point.738

Result comparison X-direction analysis739

The response of the structure when the displacement has been applied in X740
direction will be described using the graph of figure 14. There, the combined741
response of walls W-03, W-04 and W-05 will be referred as shell-acting walls, or742
simply shell walls, since their ability to restrict displacements in X direction is743
given by their flexural stiffness. On the other hand, the combined response of744
walls W-01 and W-02 is referred as membrane-acting walls or simply membrane745
walls, since their ability to avoid displacements in X direction is given by their746
membrane stiffness acting as cantilever beams whose height is equal to the cor-747
responding length of the masonry wall. Finally, in red is shown the combined748
response of both membrane and shell walls.749

In graph from figure 14 can be noticed the well agreement among the stiffness750
evaluated using reference (NTC 2004c) and total stiffness of masonry walls evalu-751
ated with the proposed scheme even though neither concrete or steel stiffness are752
considered by reference (NTC 2004c). Not only stiffness shows a reasonably good753
agreement, also the total shear strength does, which in the case of reference (NTC754
2004c) is defined as the point where non-linear process would begin. The graph755
shown in figure 14 also confirms reference (NTC 2004c) regarding the low stiffness756
presented by bending walls and that they can be neglected for analysis and design757
purposes. In order to carry out a proper description of the displacement-force758
response graph, it has been divided into 6 segments, this is:759

• Segment OA, where the elastic response occurs.760

20



• Segment AB, where the first crack appears, reaching the maximum shear761
strength of the entire structure in x direction at point B.762

• Segment BC corresponds to the process of spending the entire capability of763
masonry walls to support lateral forces, beyond C point, high discontinu-764
ities are expected, since the resistance due lateral forces are only provided765
by the confining elements.766

• Segment CD is a sudden lost of stiffness due the rupture of confining767
elements at one of the points where the loads have been applied.768

• Segment DE can be described as a small amount of lateral force that the769
structure is able to support until the next rupture of a confining element770
occurs.771

• And finally, segment EF which is the sudden rupture of other confining772
element at the point where the displacement is imposed.773

Figure 15 is a set of images displaying the undergoing deformation from a774
frontal perspective where mostly can be appreciated the principal façade and775
the masonry wall W-01, although is also visible the wall W-02. In all cases the776
deformation has been amplified 200 times, image of case a correspond to the777
undeformed mesh. Figures b, c and d display the crack patterns of the masonry778
in-fill for three different loading steps, whereas figures e and f display the damage779
undergone in the confining RC elements.780

Result comparison Y-direction analysis781

From the performed analysis in Y direction, the first inference obtained is the782
low stiffness of the structure while compared with the X direction. Let us consider783
the displacement-force graph of figure 16, where the same consideration regarding784
bending and masonry walls have been made as in the X direction analysis. In this785
case, the bending-acting walls are W-01 and W-02, whereas W-03, W-04 and W-05786
are the membrane-acting walls. In figure 16 are represented the contribution of787
the walls separately, the overall response, the total stiffness and the total shear788
strength obtained according to reference (NTC 2004c).789

The first observation from the displacement-force response, is the evident790
mismatch among stiffness evaluated using reference (NTC 2004c) and the results791
obtained using the proposed scheme. Apart from the omission of steel and con-792
crete, such mismatch is because of the contribution of short walls (walls forming793
the windows openings), since they act as stiffeners shortening the total height794
of the adjacent walls. To better point out the stiffener effect of short walls let795
us consider table ??, where is reported the stiffness evaluated of the shortened796
walls, this is, reducing their total height in such a way it is not considered from797
the top of the short walls to the basement. If we make such consideration, the re-798
ported stiffness is Ky = 219404.31kN/m (table ??), which lead to a more precise799
prediction of the total stiffness.800

As in the previous section, the displacement-force graph (fig. 16) also has been801
divided into segments in order to carry out a proper description, such segments802
are described in next paragraph.803

21



• Segment OA, is where the elastic response occurs, reporting a total stiff-804
ness K = 291981.95kN/m which is 5.15 times the stiffness evaluated using805
reference (NTC 2004c). At the light of this result, it can be said that short806
walls should be included to obtain a more accurate evaluation of the stiff-807
ness.808

• Segment AB, corresponds to the propagation of the cracks, reaching the809
maximum shear strength of the structure at point B. It can be appreciated810
a well agreement among both shear strengths, the one evaluated using811
reference (NTC 2004c) with the maximum shear strength obtained using812
the proposed scheme.813

• And finally, segment BC where the resistance of the structure start to814
decrease, until it reaches point C, beyond such point, appears a sudden815
loss of stiffness due to the rupture at the bottom corner of the confining816
elements in the walls of the rear façade.817

As in previous section, a set of images (figure 17) is used to describe the damage818
evolution, and all cases the deformation has been amplified 500 times, except for819
the case a that corresponds to the reference mesh. Figure 17.b displays a point (at820
a imposed displacement equal to 0.4726mm) where the non-linear process starts,821
as can be seen, a timid damage process starts in wall W-03 in the union of confining822
column Kc-01 with the brickwork. Next, the crack propagates vertically along823
wall W-03 (figures 17.c and 17.d) until it reaches the horizontal confining element824
at the top (beam Kb-01), then the crack propagates diagonally until it reaches825
the confining element Kb-02. Also in figures 17.e and 17.f can be appreciated a826
slight damage of the confining element at the corners of the window openings. It827
is necessary to point out that the damage process at the bottom (from the bottom828
of the window opening to the foundation of the wall) of wall W-03 is almost zero829
due to the small tensional stress which the wall is subjected to in such area, same830
happens in wall W-04 and W-05.831

CONCLUSIONS832
This work deals with the analysis of large masonry structures, where a method-833

ology to analyze them has been developed, implemented in the context of the finite834
element method, and finally, compared with building regulations obtaining good835
results.836
The starting point of this work has been the use of a 3-node and 2-dimensional837
triangular shell element with one Gauss point combined with the state-of-the-art838
rule of mixtures theories for composite materials (Escudero 2015). Thus, make839
it possible to use composite materials whose components can be modeled with840
non-linear constitutive equations. Although the proposed methodology has only841
been applied to masonry structures in the present study, it can easily be extended842
to frame structures with or without masonry in-fills. Other conclusions regarding843
the development of this work are listed below.844

• The use of a macro-modeling technique combined with plain finite elements845

22



has proven been effective, and it is possible to obtain good concordance846
among modeled structures and the results obtained using references (RCD847
1993; NTC 2004a; NTC 2004b; NTC 2004c; NTC 2004d).848

• It has been proved the significant difference among the stiffness of masonry849
walls when their planes are perpendicular (bending-acting walls) or parallel850
(membrane-acting walls) to the direction of the acting force. Such effect851
has been taken into account for most of the construction code regulations,852
assuming the higher damage will occur on the membrane-acting walls, and853
despising for designing purposes, the bending-acting walls, which coincides854
with obtained results of this work.855

• In the studied cases of this work, has been observed the stiffener effect856
produced by the short masonry walls formed at the windows openings that857
entirely change the stiffness, and consequently, the structural behavior of858
the adjacent masonry walls.859

In order to be able to reproduce the steel reinforcement pattern of real-life con-860
structions, a computational tool was developed having in mind the 3 principal861
requisites shown next:862

1. It should reproduce a more realistic reinforcement pattern.863
2. It should mechanize a process where volume part of components within a864

composite material is generated.865
3. It should be capable of handling information of large meshes.866

Finally, it has to be stated that due to the size of the models considered in867
this work, it is necessary to adopt a programming strategy that allow to reduce868
the execution time of analysis, and also to reduce the computational resources869
required in terms of memory RAM. The strategies described in this document870
have proved valid, as they have allowed to obtain the presented results with a871
reasonable computational cost.872

ACKNOWLEDGEMENTS873
This work has been supported by the European Commission, under the Marie874

Curie program, at the IRSES agreement 612607 (TCAINMAND project), by875
the European Research Council through of the Advanced Grant: ERC-2012-AdG876
320815 COMP-DES-MAT Advanced tools for computational design of engineering877
materials, by the European Community under grant: NMP-2009-2.5-1 246067878
Multiscale Reinforcement of Semi-crystalline Thermoplastic Sheets and Honey-879
combs, and by the the Mexican government through the grant provided by CONA-880
CyT to complete the PhD studies. All this support is gratefully acknowledged.881

882

REFERENCES883

Reglamento de Construcciones del Distrito Federal. (1993). México, D.F.884
Normas Técnicas Complementarias para Diseño por Sismo (2004a). México, D.F.885

23



Normas Técnicas Complementarias para Diseño y Construcciones de Estructuras886
de Concreto (2004b). México, D.F.887

Normas Técnicas Complementarias para Diseño y Construcciones de Estructuras888
de Mamposteŕıa (2004c). México, D.F.889

Normas Técnicas Complementarias sobre Criterios y Acciones para el Diseño890
Estructural de las Edificaciones (2004d). México, D.F.891

Allman, D. (1984). “A compatible triangular element including vertex rotations892
for plane elasticity analyses.” Computer & Structures, 19(1-2), 1–8.893

Barney, B. et al. (2010). “Introduction to parallel comput-894
ing.” Lawrence Livermore National Laboratory, 6(13), 10895
https://computing.llnl.gov/tutorials/openMP/#Introduction.896

Batoz, J.-L. (1982). “An explicit formulation for an efficient triangular plate-897
bending element.” International Journal for Numerical Methods in Engineer-898
ing, 18(7), 1077–1089.899

Batoz, J.-L., Bathe, K.-J., and Ho, L.-W. (1980). “A study of three-node trian-900
gular plate bending elements.” International Journal for Numerical Methods901
in Engineering, 15, 1771–1812.902

Bazant, Z. P. and Pijaudier-Cabot, G. (1989). “Measurement of characteristic903
length of nonlocal continuum.” Journal of Engineering Mechanics, 115(4), 755–904
767.905

Bergan, P. and Felippa, C. (1985). “A triangular membrane element with rota-906
tional degree of freedom.” Computer Methods in Applied Mechanics and Engi-907
neering, 50, 25–69.908

Brzev, S. (2007). Earthquake-resistant confined masonry construction. NICEE,909
National Information Center of Earthquake Engineering, Indian Institute of910
Technology Kanpur.911

Chaboche, J. (1988a). “Continuum damage mechanics: Part i-general concepts.”912
Journal of Applied Mechanics, 55(1), 59–64.913

Chaboche, J. (1988b). “Continuum damage mechanics: Part ii—damage growth,914
crack initiation, and crack growth.” Journal of Applied Mechanics, 55(1), 65–915
72.916

CIMNE (1991-2014). PLCd - Non-linear thermomechanic finite element code917
(http://www.cimne.com/PLCd). International Center of Numerical Methods in918
Engineering, Barcelona, España. Finite element code oriented to PhD student919
education.920

CIMNE (2015). GiD - Adaptive and user-friendly pre and postprocessor for nu-921
merical simulations in science and engineering. International Center of Numer-922
ical Methods in Engineering, Barcelona, España. http://www.gidhome.com/.923

Eijo, A. (2014). “Finite element modelling of delamination in advanced composite924
beams and plates using one- and two-dimensional finite elements based on the925
refined zigzag theory..” PhD dissertation, Escola Tècnica Superior D’Enginyers926
de Camins, Canals I Ports. Universitat Politècnica de Catalunya, Barcelona,927
España.928

Escudero, C. (2015). “Numerical calculation model for the global analysis of con-929

24



crete structures with masonry walls.” Ph.D. thesis, Escola Tècnica Superior930
D’Enginyers de Camins, Canals I Ports. Universitat Politècnica de Catalunya,931
Barcelona, España.932

Escudero, C., Oller, S., Martinez, X., and Barbat, A. H. (2016). “A laminated933
structural finite element for the behavior of large non-linear reinforced concrete934
structures.” Finite Elements in Analysis and Design, 119, 78–94.935

Esteva, L. (1961). “Comportamiento de muros de mamposteŕıa sujetos a carga936
vertical.” Instituto de Ingenieria, Universidad Nacional Autonoma de Mexico.937

Esteva, L. (1963). “Estimaciones de daños probables producidos por temblores en938
edificios.” Instituto de Ingenieria, Universidad Nacional Autonoma de Mexico.939

Esteva, L. (1966). “Behaviour under alternating loads of masonry diaphragms940
framed by reinforced concrete members.” Proceedings of the International Sym-941
posium on the Effects of Repeated Loadings of Materials and Structures, V,942
1–36.943

Faria, R., Oliver, J., and Cervera, M. (1998). “A strain-based plastic viscous-944
damage model for massive concrete structures.” International Journal of Solids945
and Structures, 35(14), 1533–1558.946

Felippa, C. (2003). “A study of optimal membrane triangles with drilling free-947
dom.” Computer Methods in Applied Mechanics and Engineering, 192(16),948
2125–2168.949

Fundación, I. (1999). Edificaciones de mamposteŕıa para vivienda. Fundación950
ICA.951

Hernández, O. (1975). “Recomendaciones para el diseño y construcción de es-952
tructuras de mamposteŕıa.” Instituto de Ingenieŕıa, Universidad Nacional953
Autónoma de México.954

Hillerborg, A., Modéer, M., and Petersson, P.-E. (1976). “Analysis of crack for-955
mation and crack growth in concrete by means of fracture mechanics and finite956
elements.” Cement and concrete research, 6(6), 773–781.957

Hughes, T. and Brezzi, F. (1989). “On drilling degrees of freedom.” Computer958
Methods in Applied Mechanics and Engineering, 72, 105–121.959

Jason, L., Huerta, A., Pijaudier-Cabot, G., and Ghavamian, S. (2006). “An elastic960
plastic damage formulation for concrete: Application to elementary tests and961
comparison with an isotropic damage model.” Computer methods in applied962
mechanics and engineering, 195(52), 7077–7092.963

Ju, J. (1989). “On energy-based coupled elastoplastic damage theories: constitu-964
tive modeling and computational aspects.” International Journal of Solids and965
Structures, 25(7), 803–833.966

Khosravi, P., Ganesan, R., and Sedaghati, R. (2007). “Corotational non-linear967
analysis of thin plates and shells using a new shell element.” International968
Journal for Numerical Methods in Engineering, 69, 859–885.969

Kojić, M. and Bathe, K.-J. (2005). Inelastic analysis of solids and structures.970
Springer.971

Lemaitre, J. (1985). “Coupled elasto-plasticity and damage constitutive equa-972
tions.” Computer Methods in Applied Mechanics and Engineering, 51(1), 31–973

25



49.974
Lourenço, P. (1996). “Computational strategies for masonry structures.” PhD975

dissertation, Delft University, Delft, Netherlands.976
Lourenco, P. B., Milani, G., Tralli, A., and Zucchini, A. (2007). “Analysis of ma-977

sonry structures: review of and recent trends in homogenization techniques..”978
Canadian Journal of Civil Engineering, 34(11), 1443–1457.979

Lubliner, J., Oliver, J., Oller, S., and Oñate, E. (1989). “A plastic-damage model980
for concrete.” International Journal of Solids and Structures, 25(3), 299–326.981

Madinaveitia, M. (1971). “Ensayes de muros de mamposteŕıa con cargas982
excéntricas.” Instituto de Ingenieria, Universidad Nacional Autonoma de Mex-983
ico.984

Madinaveitia, M. and Rodŕıguez, G. (1970). “Resistencia a carga vertical de985
muros fabricados con materiales usuales en el distrito federal.” Instituto de986
Ingenieria, Universidad Nacional Autonoma de Mexico.987

Mart́ınez, X. (2008). “Micro-mechanical simulation of composite materials us-988
ing the serial/parallel mixing theory.” Ph.D. thesis, Escola Tècnica Superior989
D’Enginyers de Camins, Canals I Ports. Universitat Politècnica de Catalunya,990
Barcelona, España.991

Martinez, X., Oller, S., Barbu, L. G., Barbat, A., and De Jesus, A. (2015).992
“Analysis of ultra low cycle fatigue problems with the barcelona plastic damage993
model and a new isotropic hardening law.” International Journal of Fatigue,994
73, 132–142.995

Mazars, J. and Pijaudier-Cabot, G. (1989). “Continuum damage theory-996
application to concrete.” Journal of Engineering Mechanics, 115(2), 345–365.997

Meli, R. (1979). Comportamiento śısmico de muros de mamposteŕıa. Instituto de998
Ingenieria, Universidad Nacional Autonoma de México, México, D.F., second999
edition (May).1000

Meli, R. and Alcocer, S. M. (2004). “Implementation of structural earthquake-1001
disaster mitigation programs in developing countries.” Natural Hazards Review,1002
5(1), 29–39.1003

Meli, R. and Hernández, O. (1971). “Propiedades de piezas para mamposteŕıa1004
producidas en el distrito federal.” Instituto de Ingenieŕıa, Universidad Nacional1005
Autonoma de México.1006

Meli, R. and Hernández, O. (1975). “Efectos de hundimientos diferenciales en1007
construcciones a base de muros de mamposteŕıa.” Instituto de Ingenieria, Uni-1008
versidad Nacional Autonoma de Mexico.1009

Meli, R. and Reyes, A. (1971). “Propiedades mecánicas de la mamposteŕıa.”1010
Instituto de Ingenieria, Universidad Nacional Autonoma de Mexico.1011

Meli, R. and Salgado, G. (1969). “Comportamiento de muros de mamposteŕıa su-1012
jetos a carga lateral.” Instituto de Ingenieria, Universidad Nacional Autonoma1013
de Mexico.1014

Meli, R., Zeevart, W., and Esteva, L. (1968). “Comportamiento de muros de1015
mamposteŕıa hueca ante carga lateral alternada.” Instituto de Ingenieria, Uni-1016
versidad Nacional Autonoma de Mexico.1017

26



Oliver, J., Cervera, M., Oller, S., and Lubliner, J. (1990). “Isotropic damage mod-1018
els and smeared crack analysis of concrete.” Second international conference on1019
computer aided analysis and design of concrete structures, Vol. 2, 945–958.1020

Oller, S. (1998). “Un modelo de daño continuo para materiales friccionales.”1021
Ph.D. thesis, Escola Tècnica Superior D’Enginyers de Camins, Canals I Ports.1022
Universitat Politècnica de Catalunya, Barcelona, España.1023

Oller, S., Car, E., and Lubliner, J. (2003). “Definition of a general implicit or-1024
thotropic yield criterion.” Computer methods in applied mechanics and engi-1025
neering, 192(7), 895–912.1026

Oller, S., Oñate, E., Miquel Canet, J., and Botello, S. (1993). “A finite element1027
model for analysis of multiphase composite materials.” ICCM/9., Vol. 3, 94–1028
103.1029

Oñate, E., Oller, S., Botello, S., and Canet, J. M. (1991). Métodos avanzados1030
de cálculo de estructuras de materiales compuestos. Centro Internacional de1031
Métodos Numéricos en Ingenieŕıa (CIMNE).1032

Ortiz, M. and Popov, E. P. (1982). “Plain concrete as a composite material.”1033
Mechanics of Materials, 1(2), 139–150.1034

Paredes, J. A. (2013). “Modelización numérica del comportamiento constitutivo1035
del daño local y global y su correlación con la evolución de las frecuencias natu-1036
rales en estructuras de hormigón reforzado.” PhD dissertation, Escola Tècnica1037
Superior D’Enginyers de Camins, Canals I Ports. Universitat Politècnica de1038
Catalunya, Barcelona, España.1039

Paredes, J. A., Barbat, A. H., and Oller, S. (2011). “A compression–tension1040
concrete damage model, applied to a wind turbine reinforced concrete tower.”1041
Engineering Structures, 33(12), 3559–3569.1042

Pelà, L. (2009). “Continuum damage model for nonlinear analysis of masonry1043
structures.” Ph.D. thesis, Università degli studi di Ferrara, Ferrara, Italy.1044

Rastellini, F. G. (2006). “Modelación numérica de la no-linealidad constitutiva1045
de laminados compuestos.” Ph.D. thesis, Escola Tècnica Superior D’Enginyers1046
de Camins, Canals I Ports. Universitat Politècnica de Catalunya, Barcelona,1047
España.1048

Rots, J. G. (1997). Structural masonry: An experimental/numerical basis for1049
practical design rules. AA Balkema.1050

Rots, J. G. and De Borst, R. (1987). “Analysis of mixed-mode fracture in con-1051
crete.” Journal of engineering mechanics, 113(11), 1739–1758.1052

Simo, J. and Hughes, T. (1998). Computational inelasticity, Vol. 7 of Interdisci-1053
plinary applied mathematics. Springer.1054

Simo, J. and Ju, J. (1987). “Strain-and stress-based continuum damage models ii.1055
computational aspects.” International journal of solids and structures, 23(7),1056
841–869.1057

Simo, J. and Ju, J. (1989). “Strain-and stress-based continuum damage models1058
i. formulation.” Mathematical and Computer Modelling, 12(3), 378.1059

Tao, X. and Phillips, D. V. (2005). “A simplified isotropic damage model for1060
concrete under bi-axial stress states.” Cement and Concrete Composites, 27(6),1061

27



716–726.1062
Truesdell, C. and Toupin, R. (1960). The classical field theories. Springer.1063
Turkstra, C. (1970). “Resistencia de muros de mamposteŕıa ante cargas verti-1064

cales excéntricas.” Instituto de Ingenieria, Universidad Nacional Autonoma de1065
Mexico.1066

Vargas-Félix, M. and Botello-Rionda, S. (2012). “FEMT, an open source library1067
and tools for solving large systems of equations in parallel.1068

28



FIG. 1. Structural drawings (plans and elevations) of a typical framing con-
struction.

29



FIG. 2. Boundaries of SCM with their FE and steel reinforcement patterns.

30



FIG. 3. Geometry, crack patterns, loading and boundary conditions for can-
tilever wall with masonry in-fill

31



24

Figure 28 Distribution of reinforced fibres, and cross section of structural elements
for a reinforced concrete frame with masonry in-fills.

σt = 2.45MPa.

Fracture energy:

Gc = 50.0kPa ·m.
Gt = 5.0kPa ·m.

� self-weight γ = 2500kg/m3

Mechanical properties used to reproduce behaviour of the masonry in-fill, have been
obtained assuming a compression resistance of f ′mcy = 40kg/cm

2 (3.92MPa). Hence,
elasticity modulus Emx = 1.37x10

3MPa according to section 2.8.5.2 of reference [2],
where

Emx = 350f
′
mcy (7)

elasticity modulus is evaluated under sustained loads (eq. 2.6) reference [2].

� Elasticity modulus:

Emx = 1.37x103MPa

Emy = 0.73x103MPa

� Poisson’s ratio: υ = 0.10

� Yield criterion: Mohr Coulomb.

� Damage thresholds:

σcx = 3.63MPa σtx = 0.40MPa

FIG. 4. Distribution of reinforced fibers, and cross section of structural ele-
ments for a reinforced concrete frame with masonry in-fills.

32



28

0 1 2 3 4 5 6 7 8 9 10
0

10

20

30

40

50

60

 Displacement [mm]

 F
o

rc
e 

[k
N

]

 

 

Meli (1979).

Present Work.

Figure 25 Numerical results for the reinforced concrete frame with a masonry in-fill.FIG. 5. Numerical results for a reinforced concrete frame with a masonry
in-fill.

33



FIG. 6. Structural Drawings - One storey construction (units: cm).

34



FIG. 7. Detailed section of masonry in-fills.

35



FIG. 8. Detailed section of columns and beams.

36



FIG. 9. Detailed section of slab.

37



FIG. 10. Fibers reinforcement on slab.

38



FIG. 11. Dead loads - masonry bearing walls and roofing system.

39



FIG. 12. Application loads on pushover analysis.

40



FIG. 13. Bearing walls and tributary areas (units: cm).

41



Wall Number W-01 W-02 W-03 W-04 W-05
Stiffness(kN/m) 474002.72 474002.72 14787.67 20907.57 20907.57

Shear Strength (kN) 221.53 221.59 52.77 57.65 57.65

TABLE 1. Stiffness and shear strength of masonry walls.

0 0.2 0.4 0.6 0.8 1 1.2
0

100

200

300

400

500

 Displacement [mm]

 F
o

rc
e 

[k
N

]

 

 

Overall Response

Membrane Walls

Bending Walls

NTCM-2004

FIG. 14. Displacement-force response of model B-OSC in X direction.



FIG. 15. Front isometric view - Damage evolution of masonry walls in X
direction.

43



0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8
0

20

40

60

80

100

120

140

160

180

 Displacement [mm]

 F
o

rc
e 

[k
N

]

 

 

Overall Response

Bending Walls

Membrane Walls

NTCM-2004

FIG. 16. Displacement-force response of model B-OSC in Y direction.

44



FIG. 17. Front isometric view - Damage evolution of masonry walls in Y
direction.

45




