

























































A consistent relaxation of optimal design problems for coupling shape and topological derivatives


 
 

UPCommons 
Portal del coneixement obert de la UPC 

http://upcommons.upc.edu/e-prints 

 

 

This is a post-peer-review, pre-copy edit version of an article 
published in Numerische mathematik. The final authenticated version 
is available online at: https://doi.org/10.1007/s0021. 

 

Published paper: 

Amstutz, S., Dapogny, C., Ferrer, A. A consistent relaxation of 
optimal design problems for coupling shape and topological 
derivatives. "Numerische mathematik", 28 Març 2018. 
doi: 10.1007/s0021 
 
 

URL d'aquest document a UPCommons E-prints:  

https://upcommons.upc.edu/handle/2117/118037 

 

 

http://upcommonsdev.upc.edu/
http://upcommonsdev.upc.edu/
http://upcommons.upc.edu/e-prints
https://doi.org/10.1007/s0021
https://doi.org/10.1007/s0021
https://upcommons.upc.edu/handle/2117/118037


A CONSISTENT RELAXATION OF OPTIMAL DESIGN PROBLEMS FOR

COUPLING SHAPE AND TOPOLOGICAL DERIVATIVES

S. AMSTUTZ1, C. DAPOGNY2, A. FERRER3,4

1 LMA, Université d’Avignon, 301 rue Baruch de Spinoza, BP 21239, 84916 Avignon Cedex 9, France,
2 Laboratoire Jean Kuntzmann, CNRS, Université Grenoble-Alpes, BP 53, 38041 Grenoble Cedex 9, France,

3 CIMNE Centre Internacional de Metodes Numerics en Enginyeria, Campus Nord UPC, Edifici C-1,
c/Jordi Girona 1-3, 08034 Barcelona, Spain,

4 Escola Superior dEnginyeries Industrial, Aeroespacial i Audiovisual de Terrassa, Campus de Terrassa,
Edificio TR45. C. Colom, 11 08222 Terrassa, Spain

Abstract. In this article, we introduce and analyze a general procedure for approximating a ‘black and
white’ shape and topology optimization problem with a density optimization problem, allowing for the pres-

ence of ‘grayscale’ regions. Our construction relies on a regularizing operator for smearing the characteristic

functions involved in the exact optimization problem, and on an interpolation scheme, which endows the
intermediate density regions with fictitious material properties. Under mild hypotheses on the smoothing

operator and on the interpolation scheme, we prove that the features of the approximate density optimization

problem (material properties, objective function, etc.) converge to their exact counterparts as the smoothing
parameter vanishes. In particular, the gradient of the approximate objective functional with respect to the

density function converges to either the shape or the topological derivative of the exact objective. These

results shed new light on the connections between these two different notions of sensitivities for functions of
the domain, and they give rise to different numerical algorithms which are illustrated by several experiments.

Contents

1. Introduction 2
2. The exact two-phase shape optimization problem in the conductivity setting 3

2.1. The two-phase conductivity setting 3
2.2. Hadamard’s boundary variation method and shape derivative 5
2.3. Topological sensitivity analysis 5
2.4. Local optimality conditions 6

3. The approximate density optimization problem 6
3.1. Reformulation of the shape and topology optimization problem as a density optimization

problem 7
3.2. Two examples of constructions of a regularizing operator Lε : L

2(D)→ L∞(D) 8
3.3. Optimality conditions for the approximate problem and orientation 10

4. Asymptotic behaviors of the approximate conductivity γΩ,ε and potential uΩ,ε 11
4.1. Asymptotic behavior of the approximate conductivity γΩ,ε 11
4.2. Asymptotic behavior of the approximate potential uΩ,ε 13

5. Convergence of the approximate objective function and its derivative 14
5.1. First convergence results 15
5.2. Convergence of the approximate gradient on the boundary Γ 15

6. Extension to the linear elasticity case 20
6.1. Description of the linear elasticity setting 21
6.2. The smoothed approximation in the linear elasticity setting 22
6.3. Convergence of the approximate problem to its exact equivalent 23

7. Connection with the shape and topological derivatives of the exact problem 25
7.1. The case of the conductivity equation 25

1



7.2. The case of the linear elasticity system 26
8. Description of the numerical methods 27

8.1. Practical implementation of the regularizing operator Lε 28
8.2. Two numerical optimization algorithms 29

9. Numerical illustrations 30
9.1. Numerical assessment of the convergence of the approximate shape optimization problem to

its exact counterpart 31
9.2. A self-adjoint objective function for the elasticity problem 32
9.3. A non self-adjoint objective function 32

Appendix A. Sketch of the proof of Theorem 4.5 34
References 42

1. Introduction

Most optimal design problems arising from the fields of physics or continuum mechanics inherently feature
a ‘black-and-white’ design, that is, a ‘solid’ shape Ω, embedded in a fixed computational domain D, clearly
separated from the ‘void’ (or a different phase) D \ Ω. The geometry or topology of Ω are optimized, for
instance using steepest descent algorithms based on the notions of shape [33, 49] or topological derivative
(see [40] for an overview). A popular paradigm - termed relaxation - to circumvent some of the difficulties
posed by these shape and topology optimization problems, such as the lack of existence of an optimal
design or the tediousness of numerical implementation, cuts off this physical context; see for instance [24]
Chap. 3 or [33] Chap.7 for general presentations. It consists in enriching the set of admissible designs to
allow for the presence of intermediate ‘grayscale’ regions, composed of a mixture of solid and void. The
original, mathematically rigorous way to carry out this change in points of view is the homogenization
method, pioneered by F. Murat and L. Tartar (see [38]), which has then raised a significant enthusiasm
in the shape and topology optimization community: we refer for instance to [5, 17, 50], and to [3] for a
comprehensive presentation; the conventional representation of shapes is traded for the data of a density
function h : D → [0, 1], accounting for the local proportions of material (identified by h = 1) and void
(corresponding to h = 0), and of a homogenized tensor, describing the local, microscopic arrangement of
solid and void, and thereby the material properties of the design. Another way to achieve this relaxation is
the more heuristic and quite popular Solid Isotropic Material Penalization (SIMP) method, introduced in
[15]; see [17] for numerous applications. In a nutschell, the only retained information in the SIMP setting is
that of the density function h, and the local material properties of the design (i.e. the homogenized tensor)
are approximated by an empirical interpolation law, mimicking physical material properties for the regions
with intermediate densities: if the material properties (conductivity, linear elasticity tensor) of D \Ω and Ω
are represented by the respective quantities A0, A1, the material properties associated to an intermediate
density h ∈ [0, 1] are of the form:
(1.1) A0 + (A1 −A0)ζ(h), where ζ : R→ R satisfies ζ(0) = 0 and ζ(1) = 1.
Several such interpolation schemes and related properties are discussed in [16] in the setting of the SIMP
method for structural mechanics, and more recently in [20, 30] in the context of fluid mechanics.

In any event, such a relaxation procedure does not alleviate all the difficulties posed by optimal design
problems; see [48] for an overview. In the numerical setting, a common issue, related to the homogenized
nature of optimal designs, is mesh dependency: using finer and finer computational meshes to increase
the numerical accuracy of the Finite Element method often results in designs showing smaller and smaller
features, to the point that they become impossible to manufacture. So as to impose a minimum lengthscale,
many ideas have been thought off: relying on the theoretical result of [8], one may impose a constraint on the
perimeter of shapes [14]; other investigations have proposed to enforce a constraint on the gradient or the
total variation of the density function [32, 43, 44]. Closer to the present work, another possibility consists
in filtering either the sensitivities of the optimization problem [47], or directly the density function h, as

2



proposed in [23] (see [21] for a proof of existence of optimal designs in this context). The idea underlying
this last class of remedies is to replace the density function h in (1.1) with a smoothed approximation
Lεh obtained with the help of a regularizing operator Lε (the small parameter ε measuring the degree of
smoothing). In practice, Lε stands for a convolution with a regularizing kernel [21], or it is obtained by using
the regularizing effect of an elliptic equation [36]. Interestingly, all the aforementioned techniques also allow
to deal with checkerboards, a numerical artifact caused by the use of low-order Finite Element methods.

Elaborating on the previous work [12] of the first author, and relying on techniques reminiscent of [6], the
purpose of this article is to investigate in which capacity the relaxed and filtered version of an optimal design
problem is consistent with the original and more intuitive ‘black-and-white’ shape and topology optimization
problem. To be more specific, we introduce a model problem - featuring an objective criterion J(Ω) involving
‘black and white’ shapes Ω b D -, as well as a relaxed and filtered version, in which designs are density
functions h ∈ L∞(D, [0, 1]), which are ‘filtered’ by a regularization operator Lε before being interpolated
by a profile ζ accounting for the material properties (1.1) of regions with intermediate densities. This leads
to a relaxed, smoothed objective criterion Jε(h) depending on the density function. We then show that
the features of this smoothed problem (the value of the objective functional and the optimality conditions)
converge to those of the exact shape optimization problem of J(Ω) as the smoothing parameter ε vanishes.
Notably, the gradient of Jε(h) (which is defined in the whole computational domain) converges to either
the shape derivative of J(Ω) (when restricted to the boundary of Ω) or to its topological gradient (when
restricted to inside Ω or D \ Ω).

These results seem interesting for at least two reasons. On the one hand, they prove that density opti-
mization problems may be understood as consistent approximations of ‘black-and-white’, realistic shape and
topology optimization problems, provided the interpolation law for the fictitious material properties is ade-
quately chosen. On the other hand, they give an insight about a common origin for the quite different notions
of shape and topological derivatives. At this point, let us mention the article [26] where another connection
between these notions was evidenced, expressing topological derivatives as ‘limits of shapes derivatives’.

The remainder of this article is organized as follows. In Section 2, we present the two-phase conductivity
equations, a setting under scrutiny in the main part of this work, and we recall some definitions and existing
theoretical results as regards the model shape and topology optimization problem of interest in this work. In
Section 3, we introduce and analyze the smoothing and relaxation of this problem obtained by considering not
only ‘black-and-white’ shapes as designs, but also density functions. Then, in Sections 4 and 5, we investigate
the convergence of this approximate problem to its exact counterpart as the smoothing parameter ε goes
to 0. More precisely, the convergence of the approximate conductivity and voltage potential are proved in
Section 4, and the convergence of the objective function and that of its derivative are dealt with in Section 5.
In Section 6, we describe the extension of the previous material to the linearized elasticity setting. Then, in
Section 7, we explain how these results may be used so that the approximate density optimization problem
becomes consistent with the exact shape and topology optimization problem as ε → 0, in the sense that
the derivative of the approximate objective function with respect to the density function converges to either
the shape derivative or the topological derivative of the exact objective function. In Section 8, we present
two numerical algorithms for dealing with the two-phase optimization problem, based upon the previous
considerations, and some numerical results are discussed in Section 9.

2. The exact two-phase shape optimization problem in the conductivity setting

In this section, we present the model two-phase conductivity setting considered in the bulk of this article;
the targeted applications in linearized elasticity, which are dealt with in Section 6, are natural (albeit
sometimes technically tedious) extensions of the considerations in this context which allows for a simpler
exposition.

2.1. The two-phase conductivity setting.

Let D ⊂ Rd be a fixed, smooth bounded domain, and let Ω b D be a subset of class C∞, with boundary
Γ := ∂Ω. Note that a great deal of the material in this article can be adapted to the case where Γ∩ ∂D 6= ∅;
we ignore such generality for the sake of simplicity. The domain D is filled with two materials with different

3



conductivities 0 < γ0 6= γ1 <∞, which respectively occupy the two phases Ω0 := D \Ω and Ω1 := Ω induced
by Ω (see Figure 1).

�D

�N

⌦0

Figure 1. Setting of the two-phase conductivity problem.

Denoting by χΩ ∈ L∞(D, {0, 1}) the characteristic function of Ω, the conductivity γΩ inside D reads:
(2.1) γΩ = γ0 + (γ1 − γ0)χΩ.
The domain D is insulated on a part ΓD ⊂ ∂D of its boundary, and an incoming flux g ∈ H−1/2(ΓN ) is
imposed on the complementary subset ΓN = ∂D \ ΓD. Neglecting sources, the voltage potential uΩ in D
belongs to the Hilbert space

H1ΓD (D) :=
{
u ∈ H1(D), u = 0 on ΓD

}
,

and is the unique solution to the conductivity equation:

(2.2)



−div(γΩ∇uΩ) = 0 in D,

uΩ = 0 on ΓD,

γ1
∂uΩ
∂n

= g on ΓN .

Introducing the restrictions ui := uΩ|Ωi , recall that (2.2) encompasses transmission conditions: both uΩ
and its normal flux γΩ

∂uΩ
∂n

are continuous across the interface Γ between Ω1 and Ω0:

(2.3) [uΩ] = 0 and

[
γΩ
∂uΩ
∂n

]
= 0 in the sense of traces in H1/2(Γ) and H−1/2(Γ) respectively,

where n is the unit normal vector to Γ, pointing outward Ω1, and [α] := α0−α1 is the jump of a discontinuous
quantity α, taking values α0, α1 in Ω

0,Ω1 respectively.

Our goal is to optimize the repartition of the two phases Ω0 and Ω1 inside D with respect to a mechanical
criterion C(Ω), under a constraint on the volume Vol(Ω) =

∫
Ω
dx of the phase Ω1. To set ideas, in our

analyses, we limit ourselves with the compliance of the total domain D:

(2.4) C(Ω) =

∫
D

γΩ|∇uΩ|2 dx =
∫

ΓN

guΩ ds,

and the volume constraint is incorporated in the problem via a penalization by a fixed Lagrange multiplier
` > 0. In other terms, the exact shape optimization problem reads:

(2.5) min
Ω∈Uad

J(Ω), where J(Ω) = C(Ω) + `Vol(Ω),

and Uad is the set of admissible shapes; so as to avoid discussions about the tedious regularity requirements
for shape and topological derivative results, we impose that all admissible shapes are ‘smooth’:

Uad = {Ω b D, Ω is of class C∞} .
4



Let us emphasize that extending the conclusions of this article to constrained optimization problems and
more general objective functions poses no additionnal difficulty, but only unnecessary technicalities. See
Remark 5.3 and the numerical example of Section 9.3 about this point.

Notice also that, contrary to a common custom in the literature, (2.5) is labelled as a ‘shape optimization
problem’. This terminology is improper since (2.5) leaves room for optimizing the geometry and the topology
of Ω, and its purpose is to contrast with the density optimization problem defined in (3.5) below.

The optimization process of the shape and topology of Ω naturally brings into play the sensitivity of J(Ω)
with respect to the domain: from the theoretical point of view, it allows to write necessary (local) optimality
conditions; from an algorithmic point of view, it paves the way for practical minimization algorithms for
J(Ω), e.g. steepest descent methods.

Differentiating J(Ω) with respect to the domain may be achieved in several ways, and we now briefly
describe the two complementary ones of interest in this article.

2.2. Hadamard’s boundary variation method and shape derivative.

In order to assess the sensitivity of J(Ω) with respect to variations of the boundary of Ω, we rely on
Hadamard’s boundary variation method (see e.g. [4, 33, 37]), whereby variations of a bounded, Lipschitz
domain Ω ⊂ Rd are considered under the form:

Ωθ := (Id + θ)(Ω), θ ∈W 1,∞(Rd,Rd), ||θ||W 1,∞(Rd,Rd)< 1.
This naturally leads to the following notion of shape differentiability:

Definition 2.1. A function F (Ω) of the domain is shape differentiable at Ω if the underlying function
θ 7→ F (Ωθ), from W 1,∞(Rd,Rd) into R is Fréchet differentiable at θ = 0. The shape derivative F ′(Ω) of
F at Ω is the corresponding differential, and the following asymptotic expansion holds in the vicinity of
0 ∈W 1,∞(Rd,Rd):

(2.6) F (Ωθ) = F (Ω) + F
′(Ω)(θ) + o(θ), where lim

θ→0
|o(θ)|

||θ||W 1,∞(Rd,Rd)
= 0.

In practice, the considered deformations θ are confined to a class Θad of admissible deformations θ, so
that variations Ωθ of admissible shapes Ω ∈ Uad stay admissible. In the context of this article, one has:

Θad =
{
θ ∈ C∞(Rd,Rd), θ = 0 on ∂D

}
.

Let us now state a classical result about the differentiation of the compliance J(Ω) defined in (2.4), with
respect to the domain; see [34, 42] for a proof.

Theorem 2.1. The function J(Ω) defined by (2.4) is shape differentiable at any (smooth) shape Ω ∈ Uad,
and its shape derivative reads, for an arbitrary deformation θ ∈ Θad,

(2.7) J ′(Ω)(θ) =
∫

Γ

gSΩ θ · n ds, where gSΩ := [γΩ]∇ΓuΩ · ∇ΓuΩ −
[

1

γΩ

](
γΩ
∂uΩ
∂n

)(
γΩ
∂uΩ
∂n

)
+ `,

and ∇Γf := ∇f − (∇f · n)n denotes the tangential gradient of a regular enough function f : Γ→ R.
Remark 2.1. Notice that both terms in the above expression of gSΩ do make sense owing to the transmission
conditions (2.3) at the interface Γ.

2.3. Topological sensitivity analysis.

A concurrent means to perform variations of a shape Ω consists in subtracting (or adding) a small ball
from (to) Ω. Let x ∈ Ω0 ∪Ω1, and let r > 0 be small enough so that the open ball B(x, r) with center x and
radius r does not intersect Γ; we now consider perturbations of Ω of the form:

Ωx,r :=

{
Ω \B(x, r) if x ∈ Ω,
Ω ∪B(x, r) if x ∈ D \ Ω.

5



Definition 2.2. A function F (Ω) of the domain has a topological derivative at a particular point x ∈ Ω0∪Ω1
if there exists a real number gTΩ(x) such that the following asymptotic expansion holds:

F (Ωr,x) = F (Ω) + sΩ(x)g
T
Ω(x)|B(x, r)|+o(|B(x, r)|), where lim

r→0
o(|B(x, r)|)
|B(x, r)| = 0,

and:

(2.8) sΩ(x) = 1 when x ∈ Ω0 and sΩ(x) = −1 when x ∈ Ω1.
In the context of Section 2.1, the result of interest is the following [10]:

Theorem 2.2. The functional J(Ω) defined by (2.4) has a topological derivative gTΩ(x) at every admissible
shape Ω ∈ Uad, and point x ∈ Ω0 ∪ Ω1. Its expression reads:

gTΩ(x) = −(γ1 − γ0)ki∇uΩ(x) · ∇uΩ(x) + ` for x ∈ Ωi,
where the coefficients ki read: k0 = 2γ0

γ0+γ1
, k1 = 2γ1

γ0+γ1
if d = 2 and k0 = 3γ0

2γ0+γ1
, k1 = 3γ1

γ0+2γ1
if d = 3.

2.4. Local optimality conditions.

Relying on the variations of admissible shapes introduced in Sections 2.2 and 2.3, we are in position to
define local minimizers of a function F (Ω) defined over the set Uad of admissible shapes.
Definition 2.3. A shape Ω ∈ Uad is a local minimum for F (Ω) if:

• For any point x ∈ Ω0 ∪ Ω1, and for r > 0 small enough, F (Ωx,r) ≥ F (Ω).
• For any ‘small’ vector field θ ∈ Θad, F (Ωθ) ≥ F (Ω).

Using the Definitions 2.1 and 2.2 of shape and topological derivatives, we easily derive the necessary
first-order optimality conditions associated to F (Ω).

Proposition 2.3. Let F (Ω) be a function of the domain, and let Ω ∈ Uad be a local minimizer of F (Ω). If
F (Ω) has a shape derivative gSΩ at Ω and a topological derivative g

T
Ω(x) at every point x ∈ Ω0 ∪ Ω1, then:

(i) For all x ∈ Ω1, gTΩ(x) ≤ 0,
(ii) For all x ∈ Γ, gSΩ(x) = 0,

(iii) For all x ∈ Ω0, gTΩ(x) ≥ 0,
In particular, relying on Theorem 2.1 and Theorem 2.2, these considerations immediately apply to the

minimization problem (2.5) under scrutiny.

Remark 2.2. Section 2.3 and the present one have only considered spherical inclusions when it comes to the
notion of topological sensitivity and the inferred optimality conditions for shape and topology optimization
problems. Actually, Definition 2.2 and Theorem 2.2 may be generalized to encompass inclusions of a much
more general kind (see e.g. [9]), and one could for instance be tempted to impose optimality of shapes with
respect to topological perturbations caused by elliptic inclusions. As exemplified in [12], doing so gives rise
to too stringent optimality conditions, and the local minimizers for the relaxed optimization problem tend
to show large areas with intermediate densities.

3. The approximate density optimization problem

As was originally evidenced in the pioneering work of Murat and Tartar [38], one efficient way to cope
with many theoretical and numerical difficulties inherent to shape optimization problems of the form (2.5) is
the so-called relaxation process: the main idea is to enlarge the set of admissible designs (typically to include
density functions), so that it enjoys nicer theoretical properties (in terms of convexity, or compactness
notably), or lends itself to simpler or more efficient optimization algorithms. Such a relaxation may be
performed rigorously, by the homogenization method [3], or by simpler and more heuristic means, such as
the celebrated SIMP method; see [15] or the monograph [17] and references therein.

In this spirit, we presently describe an approximate setting that reformulates the shape and topology
optimization problem presented in Section 2 in terms of density functions.

6



3.1. Reformulation of the shape and topology optimization problem as a density optimization
problem.

The proposed relaxation of (2.5) consists in replacing the characteristic function χΩ of the optimized shape
Ω involved in the definition (2.1) of the conductivity γΩ by an interpolated, smoothed density function: for
a given h ∈ L2(D), we define the (regularized) conductivity γh,ε by:
(3.1) γh,ε := γ0 + (γ1 − γ0)ζ(Lεh) ∈ L∞(D).
This procedure relies on two key ingredients:

• The bounded, ‘regularizing’ operator
(3.2) Lε : L

2(D)→ L∞(D),
is self-adjoint when it is seen as an operator from L2(D) into itself: L∗ε = Lε. Several constructions
are possible when it comes to Lε, with different theoretical and numerical assets. In this article, Lε
will be one of the two operators Lconvε and L

ell
ε whose constructions are detailed in Section 3.2 below.

• The ‘interpolation profile’ ζ ∈ C2(R) makes the connection between the intermediate, ‘grayscale’
values of the (smoothed) density Lεh and the material properties in the domain. It has the properties:

(3.3) ζ, ζ ′ and ζ ′′ ∈ L∞(R),−ρ ≤ ζ ≤ 1 + ρ, and
{
ζ(0) = 0,
ζ(1) = 1.

Its definition involves a fixed real parameter ρ > 0, which is chosen sufficiently small so that
min(γ0, γ1)− ρ|γ1 − γ0|> 0.

The potential uh,ε associated to γh,ε is the solution in H
1
ΓD

(D) to the system:

(3.4)



−div(γh,ε∇uh,ε) = 0 in D,

uh,ε = 0 on ΓD,

γh,ε
∂uh,ε
∂n

= g on ΓN .

Our relaxed version of (2.5), hereafter referred to as the density approximation problem, is posed over the
closed convex subset K := L∞(D, [0, 1]) of L2(D) composed of density functions:
(3.5) min

h∈K
Jε(h), where Jε(h) = Cε(h) + `Volε(h),

the approximate compliance Cε(h) is defined by

(3.6) ∀h ∈ L2(D), Cε(h) =
∫
D

γh,ε|∇uh,ε|2 dx =
∫

ΓN

guh,ε dx,

and the approximate volume reads:

∀h ∈ L2(D), Volε(h) =
∫
D

Lεh dx.

When it comes to the differentiability of Jε(h), the result of interest is the following.

Proposition 3.1. The approximate compliance Jε(h) defined by (3.6) is of class C1 on L2(D), and its
Fréchet derivative in an arbitrary direction ĥ ∈ L2(D) reads:

(3.7) J ′ε(h)(ĥ) =
∫
D

gh,εĥ dx, where gh,ε = −(γ1 − γ0)Lε
(
ζ ′(Lεh)|∇uh,ε|2

)
+ `Lε1.

Proof. Even though results of this type are standard in optimal control theory, we outline the proof for
convenience. Let us first discuss the differentiability of Jε(h): clearly, the mapping L

2(D) 3 h 7→ γh,ε ∈
L∞(D) is of class C1. Then, a classical use of the implicit function theorem (see e.g. [33], Th. 5.3.2) reveals
that the mapping L2(D) 3 h 7→ uh,ε ∈ H1ΓD (D) is also of class C

1. Therefore, h 7→ Jε(h) has C1 regularity.
We then calculate the Fréchet derivative of Jε(h) by relying on Céa’s method [25], which is not merely for-

mal in this case but perfectly rigorous since we already know that h 7→ uh,ε and h 7→ Jε(h) are differentiable.
Define the Lagrangian L : L2(D)×H1ΓD (D)

2 by:

L(h, u, p) =
∫
D

γh,ε|∇u|2 dx+ `
∫
D

Lεh dx+

∫
D

γh,ε∇u · ∇p dx−
∫

ΓN

gp dx.

7



For a particular h ∈ L2(D), let us search for the critical points (u, p) ∈ H1ΓD (D)
2 of L(h, ·, ·):

• Cancelling the partial derivative ∂L
∂p

(h, u, p) in any direction p̂ ∈ H1ΓD (D) reveals that u = uh,ε.
• Applying the same argument to the partial derivative ∂L

∂u
(h, u, p), we obtain:

∀û ∈ H1ΓD (D), 2
∫
D

γh,ε∇uh,ε · ∇û dx+
∫
D

γh,ε∇p · ∇û dx = 0,

whence we readily identify: p = −2uh,ε.
Now, we use the fact that:

∀h ∈ L2(D), ∀p ∈ H1ΓD (D), L(h, uh,ε, p) = Jε(h);
differentiating with respect to h in an arbitrary direction ĥ then evaluating at p = −2uh,ε finally leads to:

J ′ε(h)(ĥ) = −
∫
D

∂γh,ε
∂h

(ĥ)|∇uh,ε|2 dx+
∫
D

Lεĥ dx,

and the desired result follows after a straightforward calculation.
�

Remark 3.1. The choice of a self-adjoint operator Lε is a simple commodity in the analysis; the results of
this section are easily adapted to the case where this hypothesis is omitted. In particular Proposition 3.1
holds, up to the change in the expression (3.7) of the approximate gradient gh,ε:

(3.8) gh,ε = −(γ1 − γ0)L∗ε
(
ζ ′(Lεh)|∇uh,ε|2

)
+ `L∗ε1.

On the one hand, (3.5) is a relaxation of (2.5) since the set of admissible shapes Ω ∈ Uad is extended to
the larger set of density functions h ∈ K. On the other hand, (3.5) is also a smoothing of (2.5) since the
values of the conductivity and the objective function of the approximate problem when the design h is the
characteristic function χΩ of an admissible shape Ω are smooth approximations of γΩ and J(Ω) respectively.

In the following, we shall be interested in the smoothed, non relaxed version of (2.5) obtained by consid-
ering only characteristic functions χΩ of shapes Ω ∈ Uad in (3.5). In this perspective, we denote by

χΩ,ε := LεχΩ, γΩ,ε := γχΩ,ε, and uΩ,ε := uχΩ,ε,

the corresponding (smoothed) characteristic function, conductivity and potential. Likewise, we denote by
Cε(Ω), Volε(Ω), Jε(Ω) and gΩ,ε the smoothed compliance Cε(χΩ), volume Volε(χΩ), objective Jε(χΩ) and
gradient gχΩ,ε. We now define the smoothed shape optimization problem by:

(3.9) min
Ω∈Uad

Jε(Ω).

3.2. Two examples of constructions of a regularizing operator Lε : L
2(D)→ L∞(D).

In this section, we present the two instances Lconvε and L
ell
ε of the regularizing operator Lε : L

2(D) →
L∞(D) that shall be considered throughout the article.

3.2.1. Regularization via convolution with a smoothing kernel: definition of Lconvε .

The perhaps most intuitive construction of a bounded operator from L2(D) into L∞(D) relies on a
function η ∈ C∞c (Rd) with the properties:

(3.10)

• η has compact support in the unit ball B(0, 1) of Rd,
• η is nonnegative: η ≥ 0,
• η has integral 1, i.e.

∫
Rd η dx = 1,

• η is radial, that is, η(x) = f(|x|) for some (smooth) function f .
It is then well-known that the family of functions ηε, defined by:

(3.11) ∀x ∈ Rd, ηε(x) =
1

εd
η
(x
ε

)
is an approximation of the identity (or a mollifier) in the sense that:

ηε
ε→0−→ δ in D′(Rd),

8



where δ ∈ D′(Rd) stands for the Dirac distribution. Owing to the properties of convolution, the operation
h 7→ Lconvε h := ηε ∗ h, where h is extended by 0 outside D,

accounts for a linear, bounded operator from L2(D) into L∞(D) - it actually maps L1(D) into C∞(D) - and
it is clearly self-adjoint from L2(D) into itself.

3.2.2. Regularization based on an elliptic partial differential equation: definition of Lellε .

Another possible construction of a bounded operator from L2(D) into L∞(D) relies on the regularizing
effects of elliptic partial differential equations: for h ∈ L2(D), we denote by Lellε h the unique solution
q ∈ H1(D) to the system:

(3.12)

{
−ε2∆q + q = h in D,

∂q
∂n

= 0 on ∂D.

By standard elliptic regularity, Lellε h actually belongs to H
2(D); since the spatial dimension is d = 2 or 3,

Sobolev’s embedding theorem (see [2]) implies that H2(D) is continuously embedded in the space C(D) of
continuous functions up to the boundary ∂D, and therefore in L∞(D). Hence, Lellε does define a bounded
operator from L2(D) into L∞(D), which is easily seen to be self-adjoint from L2(D) into itself.

Remark 3.2. Many other choices are available as far as the regularizing equation (3.12) for Lellε is concerned.
For instance, one may define Lellε h = q(ε, ·), where q ∈ L2(0, T,H1(D)) ∩H1(0, T, (H1(D))′) is the unique
solution to the heat equation: 


∂q
∂t
−∆q = 0 on (0, T )×D,

∂q
∂n

(t, x) = 0 for (t, x) ∈ (0, T )× ∂D,
q(t = 0, ·) = h on D,

a system in which h acts as an initial condition, and T > 0 is a fixed final time.

For further purpose, we now discuss an integral representation of Lellε . Let us first recall (see [35], §2.3)
that the function Gε(x, y) defined by

(3.13) ∀x 6= y, Gε(x, y) =
1

εd
G

(
|x− y|
ε

)
, where G(r) =

1

(2π)
d
2

1

r
d
2
−1
K d

2
−1(r),

and Kα is the modified Bessel function of second type with parameter α ≥ 0, is the fundamental solution of
the partial differential operator q 7→ −ε2∆q + q in the whole space Rd: for a given y ∈ Rd, Gε(·, y) satisfies:

−ε2∆xGε(x, y) +Gε(x, y) = δx=y in D′(Rd).
In the above identity, δx=y ∈ D′(Rd) is the Dirac distribution centered at y.

We now introduce a correction Rε for Gε in such a way that Nε(x, y) := Gε(x, y) +Rε(x, y) becomes the
fundamental solution of the operator q 7→ −ε2∆q + q with Neumann boundary conditions on ∂D, i.e. it
satisfies: {

−ε2∆xNε(x, y) +Nε(x, y) = δx=y in D,
∂Nε
∂nx

(x, y) = 0 on ∂D.

For a given point y /∈ ∂D, Rε(·, y) is the unique solution in H1(D) to the following system:

(3.14)

{
−ε2∆xRε(x, y) +Rε(x, y) = 0 for x ∈ D,

∂Rε
∂nx

(x, y) = −∂Gε
∂nx

(x, y) for x ∈ ∂D,
which makes sense, since for y /∈ ∂D, the function x 7→ Gε(x, y) is smooth on a neighborhood of ∂D.

Now, for h ∈ L2(D), extended by 0 to Rd \D, the solution q = Lellε h to (3.12) reads:

Lellε h(x) =

∫
Rd
Nε(x, y) h(y) dy.

For further use, the following lemma collects some properties of the kernels Gε, Nε and Rε.

Lemma 3.2.
9



(i) The correction Rε asymptotically vanishes far from the boundary ∂D as ε → 0: let V be an open
neighborhood of Ω such that Ω b V b D; then:

(3.15) ||Rε(·, y)||L∞(D)
ε→0−→ 0, uniformly in y ∈ V.

(ii) The kernel G satisfies:

(3.16)

∫
Rd
G(|x|) dx = 1.

Proof. (i). Let us first recall the following asymptotic estimates of the Kα (see [1], §9.6.8, §9.6.9 and §9.7.2):

(3.17)

{
Kα(r) ∼

r→0
1
2
Γ(α)( 1

2
r)−α if α > 0,

K0(r) ∼
r→0
− log r , and Kα(r) ∼r→+∞

√
π

2r
e−r,

where Γ stands for the Euler Gamma function. If V is an open set such that: Ω b V b D, the decay
property of Kα(r) as r →∞ featured in (3.17) combined with standard elliptic regularity estimates for the
system (3.14) lead to (3.15).

(ii). A switch to polar coordinates yields:∫
Rd
G(|x|) dx = sd

∫ ∞
0

rd−1G(r) dr =
sd

(2π)d/2

∫ ∞
0

rd/2K d
2
−1(r) dr,

where sd =
2πd/2

Γ( d
2

)
is the measure of the (d− 1)-dimensional sphere. Using the formula (see [1], §11.4.22):∫ ∞

0

rα−1Kν(r) dr = 2
α−2Γ(

α− ν
2

)Γ(
α+ ν

2
), for α > ν,

we obtain (3.16).
�

Remark 3.3. Formula (3.16) may be proved in the following alternative way: taking advantage of the fact
that q : x 7→ G(|x|) is the solution of −∆q + q = δ in the sense of distributions in Rd, the Fourier transform
q̂(ξ) :=

∫
Rd q(x)e

−2iπx·ξ dx of q equals q̂(ξ) = 1
1+4π2|ξ|2 . Hence,

∫
Rd G(|x|) dx = q̂(0) = 1.

3.3. Optimality conditions for the approximate problem and orientation.

In a nutschell, at this point we have built two approximate problems for (2.5):

• The first one (3.5) is a relaxation and a smoothing of (2.5). The set of designs is enlarged from that
of ‘black-and-white’ shapes Ω ∈ Uad - or equivalently the corresponding characteristic functions,
taking only values 0 and 1 - to that of density functions h ∈ K, taking intermediate, ‘grayscale’
values between 0 and 1. These density functions appear in a smoothed version via the operator Lε.

• The second one (3.9) is the restriction of (3.5) to the set of characteristic functions of admissible
shapes, and is only a smoothing of (2.5): the optimized designs are still shapes Ω ∈ Uad, but the
dependence of the minimization criterion on Ω is smoothed via Lε.

These problems feature designs of different natures but both are easier to handle than (2.5) from the theoret-
ical point of view - for instance, one proves along the line of [21] that there exists a minimizer to (3.5) - as well
as from the numerical one - the smoothing effect induced by Lε is bound to overcome the mesh-dependency
and checkerboards issues mentionned in the introduction. We shall see in Section 8 that they give rise to
two different, interesting numerical algorithms, with competing assets and drawbacks.

For the moment, we aim at evaluating in which capacity (3.5) and (3.9) are ‘close’ approximations to
(2.5). This comparison relies on the optimality conditions for (3.9):

Proposition 3.3. Let Ω ∈ Uad be a local minimum for Jε(Ω) in the sense of Definition 2.3; then:
(i) For all x ∈ Ω1, gΩ,ε(x) ≤ 0,

(ii) For all x ∈ Γ, gΩ,ε(x) = 0,
(iii) For all x ∈ Ω0, gΩ,ε(x) ≥ 0,

10



Proof. Let x ∈ Ω1; since Ω is a local minimum for Jε(Ω), one has, for r > 0 small enough:
Jε(Ωx,r) = Jε(χΩ,ε − χB(x,r)) ≥ Jε(Ω).

Since χB(x,r) → 0 strongly in L2(D) as r → 0, using Proposition 3.1, we obtain that gΩ,ε(x) ≤ 0, which
proves (i).

Let us now consider a point x ∈ Γ; for r > 0 small enough, one has:
Jε(Ω ∪B(x, r)) = Jε(χΩ + χcΩ∩B(x,r)) ≥ Jε(Ω).

Using again Proposition 3.1 together with the fact that χcΩ∩B(x,r) → 0 strongly in L2(D) as r → 0, we
obtain that gΩ,ε(x) ≥ 0. The same argument, using now

Jε(Ω ∩ cB(x, r)) = Jε(χΩ − χΩ∩B(x,r)) ≥ Jε(Ω)
yields the converse inequality gΩ,ε(x) ≤ 0, which proves (ii).

Eventually, (iii) is proved in the same way as (i).
�

In the next two Sections 4 and 5, we shall prove that, under suitable assumptions on the interpolation
profile ζ involved in (3.1), for a given admissible shape Ω ∈ Uad, the objective and the optimality conditions
of the approximate shape optimization problem (3.9) ‘converge’ to their counterparts in the context of the
exact shape optimization problem (2.5). More precisely, in Section 4, we investigate the convergence of the
approximate conductivities γΩ,ε and voltage potential uΩ,ε to their exact counterparts γΩ and uΩ for a given
shape Ω ∈ Uad. In Section 5, we then study the convergence of Jε(Ω) to J(Ω) and that of the optimality
conditions of Proposition 3.3 to those in Proposition 2.3.

4. Asymptotic behaviors of the approximate conductivity γΩ,ε and potential uΩ,ε

In this section, we examine the convergence of the approximate conductivity γΩ,ε and potential uΩ,ε fea-
tured in the approximate shape optimization problem (3.9) towards their respective counterparts γΩ and uΩ.

Let us first recall a few useful facts. Since, in the setting of Section 2, Ω b D is a bounded domain of
class C2 with boundary Γ, the projection mapping
(4.1) pΓ : x 7→ the unique y ∈ Γ such that |x− y|= d(x,Γ) := min

y∈Γ
|x− y|

is well-defined and of class C1 on some open neighborhood V of Γ; see e.g. [28]. Hence, the unit normal
vector n to Γ, pointing outward Ω, may be extended into a unit vector field (still denoted by n) on V via
the formula:

∀x ∈ V, n(x) = n(pΓ(x)).
By the same token, an arbitrary tangential vector field τ : Γ→ Rd has a natural extension to V , and so do
the notions of normal derivative ∂v

∂n
and tangential gradient ∇Γv of a smooth function v : V → R.

4.1. Asymptotic behavior of the approximate conductivity γΩ,ε.

Our purpose in this section is to prove the following proposition:

Proposition 4.1. The following convergence results hold:

(i) χΩ,ε → χΩ and γΩ,ε → γΩ strongly in Lp(D) as ε→ 0, for 1 ≤ p <∞,
(ii) For any open set U b Ω0 ∪ Ω1, and for any n ≥ 1, γΩ,ε → γΩ strongly in Hn(U),

(iii) There exists an open neighborhood V of Γ such that for any tangential vector field τ : Γ → Rd,
∂γΩ,ε
∂τ
→ ∂γΩ

∂τ
= 0 strongly in Lp(V ), for 1 ≤ p <∞.

These properties stem from quite different arguments depending on whether the regularizing operator
Lε : L

2(D)→ L∞(D) at play is that Lconvε defined in Section 3.2.1 or that Lellε defined in Section 3.2.2.
11



4.1.1. The case where Lε = L
conv
ε .

In this subsection, γΩ,ε is defined by the formula:

γΩ,ε = γ0 + (γ1 − γ0)ζ(χΩ,ε), where χΩ,ε = ηε ∗ χΩ,

and ηε is the smoothing kernel given by (3.10) (3.11). Let us start with a fairly easy lemma about χΩ,ε:

Lemma 4.2. The smoothed characteristic function χΩ,ε belongs to D(Rd) and takes the values 1 on {x ∈ Ω, d(x,Γ) > ε}
and 0 on

{
x ∈ D \ Ω, d(x,Γ) > ε

}
. Moreover, the following estimates hold in the tube Γε := {x ∈ D, d(x,Γ) < ε}:∣∣∣∣

∣∣∣∣∂χΩ,ε∂n
∣∣∣∣
∣∣∣∣
L∞(Γε)

≤ C
ε
, and

∣∣∣∣
∣∣∣∣∂χΩ,ε∂τ

∣∣∣∣
∣∣∣∣
L∞(Γε)

≤ C,

for a constant C which only depends on Ω and not on ε.

Proof. Since Ω is of class C2, an application of Green’s formula reveals that the derivative of the characteristic
function χΩ in the sense of distributions reads:

∇χΩ = −δΓn,

where δΓ ∈ D′(Rd) is the surface measure distribution of Γ, defined by:

∀ϕ ∈ D(Rd), 〈δΓ, ϕ〉 =
∫

Γ

ϕ ds,

where 〈·, ·〉 is the duality pairing between D′(Rd) and D(Rd). For an arbitrary test function ϕ ∈ D(Rd), it
comes:

〈∂χΩ,ε
∂n

, ϕ〉 = 〈ηε ∗ (∇χΩ), ϕn〉 = −
∫

Γ

n(x) · ηε ∗ (ϕn)(x) ds(x),

and, using elementary manipulations, we identify:

∂χΩ,ε
∂n

(x) = −
∫

Γ

ηε(x− y) n(x) · n(y) ds(y), and, likewise
∂χΩ,ε
∂τ

(x) = −
∫

Γ

ηε(x− y) τ(x) · n(y) ds(y).

Now, we estimate, for x ∈ Γε,∣∣∣∣∂χΩ,ε∂n (x)
∣∣∣∣ = 1εd

∣∣∣∣
∫

Γ

η(
x− y
ε

)n(x) · n(y) ds(y)
∣∣∣∣

≤ C
εd

∫
Γ∩B(x,ε)

ds(y),

≤ C
ε
,

where the constant C only depends on the mollifier η and the properties of the surface Γ.

The corresponding estimate for
∂χΩ,ε
∂τ

follows in the same way, using the additional ingredient that there
exists a constant C such that for any two points x, y ∈ Γε, |x−y|< ε⇒ |τ(x)·n(y)|= |τ(x)·(n(y)−n(x))|≤ Cε.

�

Proof of Proposition 4.1 in the case Lε = L
conv
ε .

(i). As a well-known property of mollifiers, for any 1 ≤ p < ∞, χΩ,ε → χΩ, strongly in Lp(D). Note
that, since the χΩ,ε are continuous and χΩ is not, such a convergence cannot possibly hold in L

∞(Ω). (i) is
therefore an immediate consequence of the fact that ζ is of class C1.

(ii). This point is immediate since, for ε small enough, γΩ,ε = γΩ on U .

(iii). This point is a straighforward consequence of Lemma 4.2.
�

12



4.1.2. The case where Lε = L
ell
ε .

In this section, we assume that γΩ,ε reads:

γΩ,ε = γ0 + (γ1 − γ0)ζ(χΩ,ε),
where χΩ,ε is the unique solution in H

1(D) to the system:

(4.2)

{
−ε2∆χΩ,ε + χΩ,ε = χΩ in D,

∂χΩ,ε
∂n

= 0 on ∂D.

Proof of Proposition 4.1 in the case Lε = L
ell
ε .

(i). We start by showing that χΩ,ε → χΩ strongly in L2(D). The variational formulation for (4.2) reads:

(4.3) ∀v ∈ H1(D), ε2
∫
D

∇χΩ,ε · ∇v dx+
∫
D

χΩ,εv dx =

∫
D

χΩv dx.

Hence, we obtain the a priori estimate:

(4.4) ε2||∇χΩ,ε||2L2(D)d+||χΩ,ε||
2
L2(D)≤ ||χΩ||2L2(D).

Therefore, for a fixed test function v ∈ C∞c (Rd),∫
D

χΩ,εv dx
ε→0−→

∫
D

χΩv dx.

Owing to a standard density argument, the above convergence actually holds for arbitrary v ∈ L2(D), so
that χΩ,ε → χΩ weakly in L2(D) as ε→ 0. Now taking limits in (4.4) yields:

||χΩ||L2(D)≤ lim inf
ε→0

||χΩ,ε||L2(D) ≤ ||χΩ||L2(D),

which reveals that the convergence χΩ,ε → χΩ holds strongly in L2(D) (and thus in Lp(D) for 1 ≤ p ≤ 2).
On a different note, the maximum principle for (4.2) (see e.g. [22], §9.7) implies that:

||χΩ,ε||L∞(D)≤ ||χΩ||L∞(D).
Now, for an arbitrary 2 ≤ p <∞, we simply calculate:∫

D

|χΩ,ε − χΩ|p dx ≤ ||χΩ,ε − χΩ||p−2L∞(D)||χΩ,ε − χΩ||
2
L2(D);

therefore χΩ,ε → χΩ strongly in Lp(D) for 1 ≤ p <∞, whence (i) easily follows.

(ii). It is an immediate consequence of the standard (interior) regularity theory for elliptic equations (and
of the fact that the right-hand side in (4.2) is smooth on U). See for instance [22], §9.6.

(iii). The proof is similar to that of the first point, up to a localization and local charts argument analogous
to that used in the proof of Theorem 4.5 performed in Appendix A (which arises in a slightly more difficult
context), and we do not repeat the argument. �

4.2. Asymptotic behavior of the approximate potential uΩ,ε.

In this section, we analyze the asymptotic properties of the approximate potential uΩ,ε and of its tangential
and normal fluxes; these are quite independent of the nature of the regularizing operator Lε involved, as
long as γΩ,ε satisfies the conclusions of Proposition 4.1, which we assume throughout this section.

Let us first recall Meyer’s theorem (see [18], p. 38):

Theorem 4.3. Let D ⊂ Rd be a smooth bounded domain whose boundary ∂D is decomposed as: ∂D =
ΓD ∪ ΓN ; let 0 < m < M <∞ be fixed. Let A ∈ L∞(D)d×d be a matrix-valued function such that:

∀ξ ∈ Rd, m|ξ|2≤ A(x)ξ · ξ ≤M |ξ|2, a.e. in x ∈ D.
13



Then, there exists p > 2 and a constant C, depending only on Ω, m and M such that, for any right-hand
side f ∈W−1,p(D), the unique solution u ∈ H1ΓD (D) to the system:


−div(A∇u) = f in D,

u = 0 on ΓD,
(A∇u) · n = 0 on ΓN ,

actually belongs to W 1,p(D) and satisfies:

||u||W 1,p(D)≤ C||f ||W−1,p(D).
Remark 4.1. Meyer’s theorem is a local result; it has numerous generalizations, notably to different types
of boundary conditions, and to the case of systems (e.g. the linearized elasticity system).

As far as the convergence of the potential uΩ,ε is concerned, the result of interest is the following.

Proposition 4.4. Let Ω ∈ Uad, and assume that γΩ,ε satisfies Proposition 4.1. Then, uΩ,ε → uΩ strongly
in W 1,p(D) for some p > 2.

Proof. The variational formulations associated to (2.2) and (3.4) read: for an arbitrary v ∈ H1ΓD (D),∫
D

γΩ∇uΩ · ∇v dx =
∫

ΓN

gv dx,

∫
D

γΩ,ε∇uΩ,ε · ∇v dx =
∫

ΓN

gv dx.

Subtracting and rearranging yields:

(4.5) ∀v ∈ H1ΓD (D),
∫
D

γΩ,ε∇(uΩ,ε − uΩ) · ∇v dx =
∫
D

(γΩ − γΩ,ε)∇uΩ · ∇v dx.

Taking v = uΩ,ε − uΩ in the previous identity, we obtain:∫
D

γΩ,ε|∇(uΩ,ε − uΩ)|2 dx =
∫
D

(γΩ − γΩ,ε)∇uΩ · ∇(uΩ,ε − uΩ) dx.

Now, using Meyer’s theorem, there exists p > 2 such that uΩ ∈W 1,p(D), and a constant C such that
||uΩ||W 1,p(D)≤ C||g||H1/2(ΓN ).

Let q <∞ be the real number defined by the relation 1
p

+ 1
q

+ 1
2

= 1. An application of Hölder’s inequality

yields the existence of a constant C such that:

||uΩ,ε − uΩ||H1(D)≤ C||γΩ,ε − γΩ||Lq(D)||g||H1/2(ΓN ),
which proves the desired strong convergence result in H1(D) norm. The proof that this convergence holds
in W 1,p(D) for some p > 2 follows the same path, applying Meyer’s Theorem 4.3 from the identity (4.5)

�

We now turn to study the convergence of the tangential derivative and the normal flux of uΩ,ε. The proof
of this result is postponed to Appendix A.

Theorem 4.5. For a given admissible shape Ω ∈ Uad,
(i) Let U be an open set such that U b Ω0 or U b Ω1. Then, for any n ≥ 1, the following convergence

holds:
uΩ,ε → uΩ strongly in Hn(U).

(ii) Let V be a neighborhood of Γ such that the projection pΓ given by (4.1) is well-defined on V . Then

(4.6)
∂uΩ,ε
∂τ

→ ∂uΩ
∂τ

strongly in H1(V ), and γΩ,ε
∂uΩ,ε
∂n

→ γΩ
∂uΩ
∂n

strongly in H1(V ).

Remark 4.2. A closer look to the proof of Theorem 4.5 reveals that the convergence results (4.6) actually
hold strongly in W 1,p(V ) for some p > 2, but we shall not need this fact.

5. Convergence of the approximate objective function and its derivative

In this section, we investigate the convergence of the objective Jε(χΩ), and that of the derivative gΩ,ε
defined in (3.7), for a given shape Ω ∈ Uad.

14



5.1. First convergence results.

The convergence of the approximate objective Jε(Ω) towards its exact counterpart J(Ω) straightforwardly
follows from Proposition 4.4.

Proposition 5.1. Let Ω ∈ Uad; then Jε(Ω)
ε→0−→ J(Ω).

Let us now turn to the convergence of the approximate gradient gΩ,ε inside each phase Ω
0 and Ω1.

Proposition 5.2. Let Ω ∈ Uad. Then, for any 1 ≤ p <∞,

gΩ,ε
ε→0−→

{
−(γ1 − γ0)ζ ′(0)|∇uΩ|2+` strongly in Lp(Ω0),
−(γ1 − γ0)ζ ′(1)|∇uΩ|2+` strongly in Lp(Ω1).

Proof. Let x0 ∈ Ω0 ∪ Ω1, and r > 0 be small enough so that the ball B(x0, r) does not intersect Γ; let
also n ≥ 1 be a large enough integer so that the continuous embedding Hn(B(x0, r)) ⊂ C1(B(x0, r)) holds.
Recalling the expression (3.7) of gΩ,ε, Proposition 4.1 and Theorem 4.5 (i), one obtains, for 1 ≤ p <∞:

gΩ,ε
ε→0−−−→

{
−(γ1 − γ0)ζ ′(0)|∇uΩ|2+` strongly in Lp(B(x0, r)) if x0 ∈ Ω0,
−(γ1 − γ0)ζ ′(1)|∇uΩ|2+` strongly in Lp(B(x0, r)) if x0 ∈ Ω1.

Now recalling the expression of the approximate conductivity γΩ,ε and the two possible constructions L
conv
ε

and Lellε carried out in Section 3.2, it is easily seen that gΩ,ε is bounded in L
∞(D) independently of ε. A

use of Lebesgue’s dominated convergence theorem allows to conclude.
�

Proposition 5.2 really supplies information about the convergence of the approximate gradient gΩ,ε(x)
at points x lying in the interior of Ω0 or Ω1, and we shall make the connection between its limit and the
topological derivative gTΩ of the exact shape optimization problem (2.5) in Section 7.

However, the lack of uniform convergence of gΩ,ε in the neighborhood of Γ indicates that it has a quite
different asymptotic behavior in this region, which we now investigate.

5.2. Convergence of the approximate gradient on the boundary Γ.

The main result of this section is the following:

Theorem 5.3. In the setting of Sections 2 and 3, the restriction to Γ of the approximate gradient gΩ,ε at
an admissible shape Ω ∈ Uad converges to the exact shape derivative gSΩ given by (2.7):

gΩ,ε
ε→0−→ gSΩ in L1(Γ).

Remark 5.1. The conclusion of Theorem 5.3 is quite remarkable insofar as the information contained in the
approximate gradient gΩ,ε is by essence of a topological nature: loosely speaking, gΩ,ε does not distinguish
the bulk and the boundary of Ω.

The proof of Theorem 5.3 mainly consists of two technical lemmas.

Lemma 5.4. Let ϕ : R → R be a function of class C2 such that ϕ,ϕ′ and ϕ′′ ∈ L∞(R). Let Lε : L2(D) →
L∞(D) stand either for the operator Lconvε constructed in Section 3.2.1 or for that L

ell
ε of Section 3.2.2. Let

the function ψε : Γ→ R be defined as:
ψε = Lε (ϕ

′(LεχΩ)) .

Then, for any point x0 ∈ Γ, one has:
(5.1) lim

ε→0
ψε(x0) = ϕ(1)− ϕ(0).

Remark 5.2. Since ψε is bounded in L
∞(Γ) uniformly with respect to ε, Lebesgue’s dominated convergence

theorem implies that the above convergence actually holds in Lp(Γ), 1 ≤ p <∞.
15



Proof of Lemma 5.4. The proof relies on completely similar arguments in both situations Lε = L
conv
ε and

Lε = L
ell
ε , and we deal with it in a joint fashion insofar as possible. To achieve this, for any density h ∈ L2(D)

(extended by 0 outside D), we write the function Lεh ∈ C(D) under the form:

Lεh(x) =

∫
Rd
Nε(x, y)h(y) dy, with Nε(x, y) = Gε(x, y) +Rε(x, y).

In this notation, Gε(x, y) has the structure

Gε(x, y) =
1

εd
G

(
|x− y|
ε

)
,

where the (nonnegative) real function G : (0,∞)→ R is smooth, satisfies
∫
Rd G(|x|) dx = 1 and the following

decay conditions: there exists constants C > 0 and M > 0 such that:

(5.2)

{
G(r) ≤ C|log r| if d = 2,
G(r) ≤ C

rd−2
if d ≥ 3, for r ≤ 1 and G(r) ≤ Ce

−Mr for r ≥ 1;

the correction Rε(x, y) satisfies:

(5.3) For any open set V b D, ||Rε(·, y)||L∞(D)
ε→0−→ 0 uniformly in y ∈ V.

As we have seen in Sections 3.2.1 and 3.2.2, both situations Lε = L
conv
ε and Lε = L

ell
ε fall into this setting

with:

• In the case Lε = Lconvε , G(r) = η(r) and Rε(x, y) = 0.
• In the case Lε = Lellε , G(r) is defined in (3.13) and Rε(x, y) is the solution to the system (3.14).

According to the above representation, one has, for x ∈ Γ:

ψε(x) =

∫
Rd
Nε(x, y) ϕ

′
(∫

Rd
Nε(y, z)χΩ(z) dz

)
dy.

We now divide the proof of the lemma into three steps.

Step 1: Elimination of the correction induced by Rε(x, y).

Define the scalar function ψ
(1)
ε : Γ→ R as:

ψ(1)ε (x) =

∫
Rd
Gε(x, y) ϕ

′
(∫

Rd
Gε(y, z)χΩ(z) dz

)
dy.

We prove that, for a given x0 ∈ Γ:
(5.4) |ψε(x0)− ψ(1)ε (x0)|

ε→0−→ 0.

To this end, using that ||Rε(x0, ·)||L∞(D)
ε→0−→ 0 together with the fact that ϕ′ is bounded, we see first that:

|ψε(x0)− ψ̃ε(x0)|
ε→0−→ 0, where ψ̃ε(x0) :=

∫
Rd
Gε(x0, y) ϕ

′
(∫

Rd
Nε(y, z)χΩ(z) dz

)
dy.

Now let r > 0 be so small that B(x0, r) b D. We decompose:

ψ̃ε(x0) =

∫
B(x0,r)

Gε(x0, y) ϕ
′
(∫

Rd
Nε(y, z)χΩ(z) dz

)
dy

+

∫
Rd\B(x0,r)

Gε(x0, y) ϕ
′
(∫

Rd
Nε(y, z)χΩ(z) dz

)
dy.

Since ϕ′ is bounded, the second term in the right-hand side vanishes in the limit ε→ 0 as a consequence of
the decay property (5.2). As for the first one, using the fact that:

||Rε(y, ·)||L∞(D)
ε→0−→ 0 uniformly in y ∈ B(x0, r),

it follows: ∣∣∣∣
∫
Rd
Nε(y, z)χΩ(z) dz −

∫
Rd
Gε(y, z)χΩ(z) dz

∣∣∣∣ ε→0−→ 0, uniformly in y ∈ B(x0, r)
16



and since ϕ′ is Lipschitz and Gε(x0, ·) is bounded in L1(Rd) independently of ε, we obtain:∣∣∣∣∣ψ̃ε(x0)−
∫
B(x0,r)

Gε(x0, y) ϕ
′
(∫

Rd
Gε(y, z)χΩ(z) dz

)
dy

∣∣∣∣∣ ε→0−→ 0.
Eventually, using the convergence∣∣∣∣∣ψ(1)ε (x0)−

∫
B(x0,r)

Gε(x0, y) ϕ
′
(∫

Rd
Gε(y, z)χΩ(z) dz

)
dy

∣∣∣∣∣ ε→0−→ 0,
which is proved thanks to the fact ||Gε(x0, ·)||L∞(Rd\B(x0,r))

ε→0−→ 0, we eventually get the sought result (5.4).

Step 2: Reduction to the case where Γ is flat around x0.
Precisely, we prove that:

(5.5) |ψ(1)ε (x0)− ψ(2)ε (x0)|
ε→0−→ 0, where ψ(2)ε (x0) :=

∫
Rd
Gε(x0, y) ϕ

′
(∫

Rd
Gε(y, z)χ(z) dz

)
dy,

and χ is the characteristic function of the half-space
{
x ∈ Rd, (x− x0) · n(x0) < 0

}
.

Grossly speaking, the proof of (5.5) consists in estimating the ‘difference’ between this half-space and the
domain Ω ‘near’ the point x0, which is the only region in Rd where Gε(x0, ·) takes large values.

To this end, simple changes of variables in the definitions of ψ
(1)
ε and ψ

(2)
ε yield:

ψ(1)ε (x0) =

∫
Rd
G(|y|)ϕ′

(∫
Rd
G(|z|) χΩ(x0 − εy − εz) dz

)
dy,

and

ψ(2)ε (x0) =

∫
Rd
G(|y|)ϕ′

(∫
Rd
G(|z|) χ(x0 − εy − εz) dz

)
dy.

To prove (5.5), owing to the Lipschitz character of ϕ′, it is therefore enough to show that:

(5.6)

∫
Rd

∫
Rd
G(|y|)G(|z|) |χΩ(x0 − εy − εz)− χ(x0 − εy − εz)| dydz

ε→0−→ 0.

Using the decay rate (5.2) it is in turn sufficient to prove that, for any fixed M > 0,

(5.7) Iε :=

∫
B(0,M)

∫
B(0,M)

G(|y|)G(|z|)|χΩ(x0 − εy − εz)− χ(x0 − εy − εz)| dydz
ε→0−→ 0,

which we now proceed to do. Using again the decay condition (5.2) for G and Hölder’s inequality, we have
the rough bound, for some p > 1:

Ipε ≤ C
∫
B(0,2M)

|χΩ(x0 − εy)− χ(x0 − εy)|p dy.

Here and throughout the proof, the constant C represents a generic positive constant which changes from
one line to the next, but is independent of ε.

Now, without loss of generality, we assume that x0 = 0 and n(x0) = ed (the d
th coordinate vector). Since

Ω is of class C2, there exists a neighborhood U of x0 and a function f : Rd−1 → R of class C2 such that Ω∩U
is the subgraph of f , that is:

Ω ∩ U = {x ∈ U s.t. xd < f(x1, ..., xd−1)} , Γ ∩ U = {x ∈ U s.t. xd = f(x1, ..., xd−1)} .
Hence, we obtain:

Ipε ≤ C
∫

[−2M,2M ]d−1
|f((x0,1 − εy1, ..., x0,d−1 − εyd−1))| dy1...dyd−1,

where the right-hand side simply corresponds to the red dashed area on Figure 2.
Since f is of class C2, f(x0) = 0 and ∇f(x0) = 0, it follows that:

Iε ≤ Cε2/p.
This terminates the proof of (5.5).

17



•
x0

n(x0)

⌦

•
(y1, ...yd�1)

f(y1, ...yd�1)

Figure 2. Illustration of the second step in the proof of Lemma 5.4.

Step 3: Reduction to a one-dimensional situation and end of the proof of Lemma 5.4

We eventually prove the limit lim
ε→0

ψ
(2)
ε (x0) = ϕ(1)− ϕ(0).

Without loss of generality, we retain the assumption that x0 = 0 and n(x0) = ed. Recall the alternative

expression for ψ
(2)
ε obtained by using changes of variables,

(5.8) ψ(2)ε (x0) =

∫
Rd
G(|y|) ϕ′

(∫
Rd
G(|z|) χ(x0 − εy − εz) dz

)
dy.

The key point now consists in remarking that, since χ is the characteristic function of the lower half-space,
the integral featured in (5.8)

y 7→
∫
Rd
G(|z|) χ(x0 − εy − εz) dz =

∫
{z∈Rd,−yd≤zd}

G(|z|) dz

depends on y only via its dth-component. To be precise, let us introduce the function G̃ ∈ L1(R) given by:

G̃(s) =

∫
Rd−1

G(|(z1, ..., zd−1, s)|) dz1...dzd−1;

notice this definition is possible owing to (5.2). A repeated use of Fubini’s theorem yields:

(5.9)

ψ(2)ε (x0) =

∫
Rd
G(|y|) ϕ′

(∫ +∞
−yd

G̃(s) ds

)
dy,

=

∫
Rd
G(|y|) ϕ′

(
(G̃ ∗ χ̃)(yd)

)
dy,

=

∫
R
G̃(s) ϕ′

(
(G̃ ∗ χ̃)(s)

)
ds.

In the previous inequalities, we have introduced the usual (one-dimensional) Heaviside function χ̃ ∈ L∞(R):

χ̃(s) =

{
1 if s > 0,
0 otherwise.

Now, the function G̃ ∗ χ̃ has the expression:

(G̃ ∗ χ̃)(t) =
∫
{y∈Rd, yd<t}

G(|y|) dy =
∫ t
−∞

G̃(s) ds, for a.e. t ∈ R.

It is therefore absolutely continuous, with derivative G̃, and has limits:

lim
t→+∞

(G̃ ∗ χ̃)(t) =
∫
Rd
G(|y|) dy = 1, and lim

t→−∞
(G̃ ∗ χ̃)(t) = 0.

18



It eventually follows from (5.9) that:

ψ(2)ε (x0) =

∫
R

d

ds

(
ϕ
(
G̃ ∗ χ

))
ds = lim

t→+∞
ϕ((G̃ ∗ χ)(t))− lim

t→−∞
ϕ((G̃ ∗ χ)(t)),

= ϕ(1)− ϕ(0),
which completes the proof.

�

The second ingredient in the proof of Theorem 5.3 is the following:

Lemma 5.5. Let Lε : L
2(D) → L∞(D) stand for one of the two operators Lconvε and Lellε constructed in

Section 3.2. Let vε, v ∈ H1(D) and fε ∈ L∞(D) be such that

vε
ε→0−→ v strongly in H1(V ), and ||fε||L∞(D)≤ C,

for an open neighborhood V of Γ and a constant C > 0 which is independent of ε. Then the following
convergence holds:

rε := Lε(fεv
2
ε)− Lε(fε)v2ε

ε→0−→ 0 strongly in L1(Γ).
Proof. We retain the notations introduced in the preamble of the proof of Lemma 5.4 in order to deal jointly
with both cases Lε = L

conv
ε and Lε = L

ell
ε . At first, easy calculations using (5.2) yield, for an arbitrary

M > 0:∫
Γ

|rε(x)| ds(x) ≤ C
∫

Γ

∫
Rd
G(|y|)|v2ε(x− εy)− v2ε(x)| dy ds(x) + o(1),

≤ C
∫

Γ

∫
B(0,M)

G(|y|)|v2ε(x− εy)− v2ε(x)| dy ds(x)

+C

∫
Γ

∫
Rd\B(0,M)

G(|y|)|v2ε(x− εy)− v2ε(x)| dy ds(x) + o(1),

≤ C
∫

Γ

∫
B(0,M)

G(|y|)|v2ε(x− εy)− v2ε(x)| dy ds(x) + Ce−αM ||vε||2H1(V )+o(1),

where o(1) → 0 as ε → 0. Since vε is uniformly bounded in H1(D), it is enough to prove that, for an
arbitrary, fixed M > 0,

Iε :=

∫
Γ

∫
B(0,M)

G(|y|)|v2ε(x− εy)− v2ε(x)| dy ds(x)
ε→0−→ 0.

To do so, using polar coordinates and (5.2), we obtain:

Iε =

∫
Γ

∫ M
0

∫
∂B(0,1)

rd−1G(r)|v2ε(x− εrω)− v2ε(x)| ds(ω) dr ds(x),

≤ C
∫

Γ

∫ M
0

∫
∂B(0,1)

|v2ε(x− εrω)− v2ε(x)| ds(ω) dr ds(x),

≤ C
∫

Γ

∫ M
0

∫
∂B(0,1)

|v2ε(x− εrω)− v2(x− εrω)| ds(ω) dr ds(x),

+C

∫
Γ

∫ M
0

∫
∂B(0,1)

|v2(x− εrω)− v2(x)| ds(ω) dr ds(x) + C
∫

Γ

∫ M
0

∫
∂B(0,1)

|v2ε(x)− v2(x)| ds(ω) dr ds(x),

≤ C
∫

Γ

∫ M
0

∫
∂B(0,1)

|v2(x− εrω)− v2(x)| ds(ω) dr ds(x) + C||vε − v||H1(V ).

Hence, the proof is complete if we can show that, for an arbitrary function v ∈ H1(V ), the integral:∫
Γ

∫ M
0

∫
∂B(0,1)

|v2(x− εrω)− v2(x)| ds(ω) dr ds(x)

converges to 0 as ε → 0; but this last point easily follows from a standard density argument of smooth
functions in H1(V ).

�
19



We are now in good position to complete the proof of Theorem 5.3.

Proof of Theorem 5.3. Let us decompose the expression (3.7) of gΩ,ε as:

gΩ,ε = −(γ1 − γ0) Lε
(
ζ ′(LεχΩ)

∣∣∣∣∂uΩ,ε∂τ
∣∣∣∣2
)
− (γ1 − γ0) Lε

(
ζ ′(LεχΩ)
γ2Ω,ε

∣∣∣∣γΩ,ε ∂uΩ,ε∂n
∣∣∣∣2
)

+ `Lε1.

Let us first remark that, as an easy consequence of Lemma 5.5 and Theorem 4.5:

(5.10) gΩ,ε − g̃Ω,ε
ε→0−→ 0 in L1(Γ),

where:

(5.11) g̃Ω,ε := −(γ1 − γ0) (Lεζ ′(LεχΩ))
∣∣∣∣∂uΩ,ε∂τ

∣∣∣∣2 − (γ1 − γ0) Lε
(
ζ ′(LεχΩ)
γ2Ω,ε

)∣∣∣∣γΩ,ε ∂uΩ,ε∂n
∣∣∣∣2 + `.

Now, using Lemma 5.4 with ϕ(t) = γ0 + (γ1 − γ0)ζ(t), ϕ′(t) = (γ1 − γ0)ζ ′(t), then ϕ(t) = 1γ0+(γ1−γ0)ζ(t) ,
ϕ′(t) = −(γ1−γ0)ζ

′(t)
(γ0+(γ1−γ0)(1−ζ(t)))2 , we obtain:

(γ1 − γ0)Lε (ζ ′(LεχΩ))
ε→0−→ γ1 − γ0 a.e. on Γ,

(γ1 − γ0)Lε
(
ζ ′(LεχΩ)
γ2Ω,ε

)
ε→0−→ 1

γ0
− 1
γ1

a.e. on Γ;

in light of (5.10), (5.11) and Theorem 4.5, this terminates the proof.
�

Remark 5.3. Let us comment on how the previous material extends to the case where the function C(Ω)
involved in (2.5) is not the compliance (2.4).

The main difference between this new case and the previous one lies in the expressions of the shape and
topological derivatives gSΩ and g

T
Ω : as is well-known (see e.g. [4, 33]), they now involve an adjoint state

pΩ ∈ H1ΓD (D), solution to a system of the form (2.2), with a different right-hand side (depending on the
expression of J(Ω)). For instance, Formula (2.7) for the shape derivative gSΩ becomes:

gSΩ := −[γΩ]∇ΓuΩ · ∇ΓpΩ +
[

1

γΩ

](
γΩ
∂uΩ
∂n

)(
γΩ
∂pΩ
∂n

)
+ `,

and a similar transformation occurs in the expression of gTΩ . The derivative of the approximate functional
Jε(h), cooked from J(Ω) along the lines of Section 3, involves in turn an approximate adjoint state ph,ε ∈
H1ΓD (D), solution to a similar system to (3.4), with, again, a different right-hand side.

In this context, the convergence of the approximate objective Jε(Ω) and that of its derivative are studied
as in the proofs of Propositions 5.1, 5.2 and Theorem 5.3, with the additional study of the convergence
pΩ,ε → pΩ which is carried out in a similar way to that of Theorem 4.5.

Remark 5.4. We have hitherto assumed the ‘hold-all’ domain D to be smooth; this is merely for technical
convenience, and the results of Sections 2, 3, 4 and 5 hold true when D is only Lipschitz regular, provided
their conclusions are restricted to a fixed subset D′ b D such that Ω b D′ b D.

6. Extension to the linear elasticity case

In this section, we point out how the proposed approximation process of shape and topology optimization
problems extends from the setting of the conductivity equation to that of the linearized elasticity system.
Both situations are similar from the mathematical point of view, and we mainly discuss the differences;
so as to emphasize the parallel between them, we re-use the notations from the previous sections for their
counterparts in the present context insofar as possible.

20



6.1. Description of the linear elasticity setting.

The geometric situation is that of Section 2: the computational domain D is divided into two complemen-
tary phases Ω0 = D \ Ω and Ω1 = Ω, separated by the interface Γ = ∂Ω, which are filled with two different
linearly elastic materials with respective Hooke’s law A0, A1. We assume that both laws are isotropic, i.e.
they are of the form:

∀e ∈ S(Rd), Aie = 2µie+ λitr(e)I, i = 0, 1,
where I is the identity matrix of size d, and µi, λi are the Lamé coefficients of the i

th material, which satisfy:

µi > 0, and λi + 2µi/d > 0.

Recall that the bulk modulus κ of such a material equals κ = λ+ 2
d
µ, and that the properties of a linearly

elastic material may be equivalently described in terms of its Young’s modulus E and Poisson’s ratio ν,
defined by:

E =
4κµ

κ+ µ
, ν =

κ− µ
κ+ µ

if d = 2, and E =
9κµ

3κ+ µ
, ν =

3κ− 2µ
2(3κ+ µ)

if d = 3.

The total Hooke’s law AΩ inside the structure D is discontinuous, and reads:

(6.1) AΩ = A0 + (A1 −A0)χΩ.
The structure D is clamped on a subset ΓD ⊂ ∂D, and surface loads g ∈ H−1/2(ΓN )d are applied on the

complementary part ΓN = ∂D \ ΓD; we omit body forces for simplicity. The displacement of D is then the
unique solution uΩ ∈ H1ΓD (D)

d to the system:

(6.2)



−div(AΩe(uΩ)) = 0 in D,
AΩe(uΩ)n = g on ΓN ,

uΩ = 0 on ΓD,

where e(uΩ) =
1
2
(∇uTΩ + ∇uΩ) is the strain tensor associated to uΩ, and the corresponding stress tensor

σ(uΩ) is defined by σ(uΩ) = AΩe(uΩ).
As in the case of the conductivity equation (2.2), the system (6.2) encompasses transmission conditions

at the interface Γ. To express them, let us introduce, at each point of Γ, a local basis of Rd obtained by
gathering the unit normal vector n (pointing outward Ω1) and a collection of unit tangential vectors, denoted
by τ , such that (τ, n) is an orthonormal frame. For a symmetric d × d matrix M written in this basis, we
introduce the notation

M =
(
Mττ Mτn
Mnτ Mnn

)
where Mττ stands for the (d− 1)× (d− 1) minor of M, Mτn is the vector of the (d− 1) first components
of the d-th column of M, Mnτ is the row vector of the (d− 1) first components of the d-th row of M, and
Mnn is the (d, d) entry of M.

Then it is well-known that uΩ is continuous across Γ (in the sense of traces in H
1/2(Γ)), that the tangential

components e(uΩ)ττ of the strain tensor, and the normal components σ(uΩ)τn and σ(uΩ)nn of the stress
tensor σ(uΩ) = AΩe(uΩ) are continuous across Γ in the sense of traces in H

−1/2(Γ).

The (exact) shape optimization problem at stake is still of the form:

(6.3) min
Ω∈Uad

J(Ω), where J(Ω) = C(Ω) + `Vol(Ω),

where C(Ω) is the compliance of the total structure:

(6.4) C(Ω) =

∫
D

AΩe(uΩ) : e(uΩ) dx =

∫
ΓN

g · uΩ ds.

Here, we have denoted by : the usual Frobenius inner product over matrices.
Again, more general objective functions could be considered with similar conclusions. The following result

about the differentiation of J(Ω) was proved in [7]:
21



Theorem 6.1. The objective function J(Ω) defined in (6.3) is shape differentiable at any admissible shape
Ω ∈ Uad, and its shape derivative reads, for an arbitrary deformation θ ∈ Θad,

J ′(Ω)(θ) =
∫

Γ

gSΩ θ · n ds,

where gSΩ = −σ(uΩ)nn : [e(uΩ)nn]− 2σ(uΩ)nτ : [e(uΩ)nτ ] + [σ(uΩ)ττ ] : e(uΩ)ττ + `,
where we recall that the notation [α] stands for the jump α0 − α1 of a discontinuous quantity α across Γ,
taking values α0, α1 inside Ω

0 and Ω1 respectively.

Remark 6.1. For further use, it is useful to give another expression to the above shape derivative. Using
the transmission conditions associated to (6.2), a calculation reveals that the discontinuous components of
the strain and stress tensors may be expressed in terms the continuous ones as:

[e(uΩ)τn] =

[
1

2µ

]
σ(uΩ)τn, [e(uΩ)nn] =

[
1

2µ+ λ

]
σ(uΩ)nn −

[
λ

2µ+ λ

]
tr(e(uΩ)ττ ),

[σ(uΩ)ττ ] = [2µ] e(uΩ)ττ +

([
2µλ

2µ+ λ

]
tr(e(uΩ)ττ ) +

[
λ

2µ+ λ

]
σ(uΩ)nn

)
δi,j .

Using these relations, it is a simple matter to prove that:

(6.5) gSΩ = [2µ]e(uΩ)ττ : e(uΩ)ττ +

[
2µλ

2µ+ λ

]
tr(e(uΩ)ττ )

2 −
[

1

2µ+ λ

]
σ(uΩ)

2
nn

+

[
2λ

2µ+ λ

]
σ(uΩ)nntr(e(uΩ)ττ )−

[
1

µ

]
σ(uΩ)τn · σ(uΩ)τn + `.

The calculation of the topological derivative of J(Ω) is performed in [10] in the particular case where the
Hooke’s tensors A0, A1 are proportional. In our precise case of interest (and in the more general case where
these tensors are anisotropic), we refer to [19, 31], from which we quote the result in the case of two space
dimensions.

Theorem 6.2. For any two-dimensional admissible shape Ω ∈ Uad, the function J(Ω) defined in (6.3) has
a topological derivative gTΩ(x) at any point x ∈ Ω0 ∪ Ω1. Its expression reads:

gTΩ(x) = sΩ(x) Pσ(uΩ(x)) : e(uΩ(x)),

where sΩ(x) is defined by (2.8) and P is the fourth-order Pólya-Szegö polarization tensor, given by:

(6.6) ∀e ∈ S(Rd), Pe = 1
ρ2ρ3 + τ1

(
(1 + ρ2)(τ1 − ρ3)e+

1

2
(ρ1 − ρ2)

ρ3(ρ3 − 2τ3) + τ1τ2
ρ1ρ3 + τ2

tr(e)I

)
,

where

(6.7) ρ1 =
1 + ν

1− ν , ρ2 =
3− ν
1 + ν

, ρ3 =
E?

E
, τ1 =

1 + ν?

1 + ν
, τ2 =

1− ν?
1− ν and τ3 =

ν?(3ν − 4) + 1
ν(3ν − 4) + 1 .

and we have posed:

• If x ∈ Ω1, E = E1, E? = E0, ν = ν1, and ν? = ν0,
• If x ∈ Ω0, E = E0, E? = E1, ν = ν0, and ν? = ν1.

6.2. The smoothed approximation in the linear elasticity setting.

Let us now describe the relaxed density optimization problem associated to (6.3). For an arbitrary density
function h ∈ L2(D), we define a smoothed Hooke’s tensor Ah,ε via the formula:
(6.8) ∀e ∈ S(Rd), Ah,εe = 2µh,εe+ λh,εtr(e)I,
cooked from the approximate Lamé coefficients:

(6.9) λh,ε = λ0 + (λ1 − λ0)α(Lεh), and µh,ε = µ0 + (µ1 − µ0)β(Lεh).
22



In the above formula, Lε : L
2(D)→ L∞(D) is either of the regularizing operators presented in Sections 4.1.1

and 4.1.2, and α, β ∈ C2(R) are two functions satisfying (3.3). In this context, the approximate solution uh,ε
to the linear elasticity system is the unique solution in H1ΓD (D)

d to:

(6.10)



−div(Ah,εe(uh,ε)) = 0 in D,
Ah,εe(uh,ε)n = g on ΓN ,

uh,ε = 0 on ΓD.

Our relaxed density optimization problem is still of the form:

(6.11) min
h∈K

Jε(h), where Jε(h) = Cε(h) + `Volε(h),

and Cε(h) reads:

(6.12) Cε(h) =

∫
D

Ah,εe(uh,ε) : e(uh,ε) dx.

The differentiation of Jε(h) is investigated in the same way as in Proposition 3.1, and we omit the proof:

Proposition 6.3. The relaxed functional Jε(h) is Fréchet differentiable on L
2(D) and:

∀ĥ ∈ L2(Ω), J ′ε(h)(ĥ) =
∫
D

gεĥ dx,

where:

gh,ε = −2(µ1 − µ0)Lε ((β′(Lεh)e(uh,ε) : e(uh,ε)))− (λ1 − λ0)Lε
(
α′(Lεh)div(uh,ε)

2
)

+ `Lε1.

Last but not least, in the particular case where h = χΩ is the characteristic function of a smooth domain
Ω b D, we use the notations AΩ,ε, λΩ,ε, µΩ,ε, uΩ,ε, Jε(Ω) and gΩ,ε instead of Ah,ε, λh,ε, µh,ε, uh,ε, Jε(h)
and gh,ε respectively. The density optimization problem (6.11) gives rise to a smoothed shape optimization
problem of the form (3.9) in the line of Section 3.1:

(6.13) min
Ω∈Uad

Jε(Ω).

6.3. Convergence of the approximate problem to its exact equivalent.

As in Sections 4 and 5, we examine the convergence of the approximate shape optimization problem (6.13)
to the exact one (6.3).

In this context, one can prove along the line of Section 4.1 that the equivalent of Proposition 4.1 holds
regarding the convergence of the approximate Lamé parameters λΩ,ε and µΩ,ε to their exact counterparts
λΩ and µΩ for a given admissible shape Ω ∈ Uad.

When it comes to the asymptotic behavior of the spatial derivatives of the elastic displacement uΩ,ε, the
following proposition is the exact counterpart of the convergence results of Theorem 4.5 in the context of
the linear elasticity equations. We state it precisely for the sake of convenience, but the proof is omitted.

Proposition 6.4. Let Ω ∈ Uad be an admissible shape. Then,
(i) Let U be an open set such that U b Ω0 or U b Ω1. Then for any n ≥ 1, one has:

uΩ,ε → uΩ strongly in Hn(U)d.
(ii) Let V be a neighborhood of Γ on which the projection mapping pΓ given by (4.1) is well-defined. Then

the following convergences hold:

eττ (uΩ,ε)
ε→0−→ eττ (uΩ) strongly in H1(V )(d−1)

2

,

στn(uΩ,ε)
ε→0−→ στn(uΩ) strongly in H1(V )d−1,

σnn(uΩ,ε)
ε→0−→ σnn(uΩ) strongly in H1(V ).

The main result of this section is now the following:

Theorem 6.5. Let Ω ∈ Uad be an admissible shape. Then,
(i) The approximate objective function Jε(Ω) converges to the exact one J(Ω) as ε→ 0.

23



(ii) For any 1 ≤ p <∞, the following ‘interior’ convergence of the approximate gradient holds:

gΩ,ε
ε→0−→

{
−2(µ1 − µ0)β′(0)e(uΩ) : e(uΩ)− (λ1 − λ0)α′(0)(div(uΩ))2 + ` strongly in Lp(Ω0),
−2(µ1 − µ0)β′(1)e(uΩ) : e(uΩ)− (λ1 − λ0)α′(1)(div(uΩ))2 + ` strongly in Lp(Ω1).

(iii) The following ‘boundary’ convergence of the approximate gradient holds:

gΩ,ε
ε→0−→ gSΩ in L1(Γ).

Proof. The proofs of (i) and (ii) are analogous to those of Propositions 5.1 and 5.2, and we focus on that of
(iii). To this end, we rely on the shorthands:

µε ≡ µΩ,ε, λε ≡ λΩ,ε, eε ≡ e(uΩ,ε), and σε ≡ AΩ,εe(uΩ,ε).
Proposition 6.4 reveals which are the components of the tensors eε and σε that behave well in the limit
ε→ 0, and we express all their remaining components in terms of these ones; in particular:

eετn =
1

2µε
σετn and e

ε
nn =

1

2µε + λε
(σεnn − λεtr(eεττ )).

Now, the expression of the approximate gradient gΩ,ε reads:

gΩ,ε = −2(µ1 − µ0)Lε (β′(LεχΩ)eε : eε)− (λ1 − λ0)Lε
(
α′(LεχΩ)tr(e

ε)2
)

+ `Lε1,

and we expand it as:

gΩ,ε = −2(µ1 − µ0)Lε (β′(LεχΩ)eεττ : eεττ )− Lε
(

(µ1−µ0)β′(LεχΩ)
µ2ε

σετn · σετn
)

−Lε
(

2(µ1−µ0)β′(LεχΩ)
(2µε+λε)2

(σεnn − λεtr(eεττ ))2
)

−(λ1 − λ0)Lε
(
α′(LεχΩ)(

2µε
2µε+λε

tr(eεττ ) +
1

2µε+λε
σεnn)

2
)

+ `Lε1.

which we may alternatively rewrite as, reordering terms:

gΩ,ε = −2(µ1 − µ0)Lε (β′(LεχΩ)eεττ : eεττ )− Lε
(

(µ1−µ0)β′(LεχΩ)
µ2ε

σετn · σετn
)

−Lε
(

2(µ1−µ0)β′(LεχΩ)+(λ1−λ0)α′(LεχΩ)
(2µε+λε)2

(σεnn)
2
)

−Lε
(

2λ2ε(µ1−µ0)β
′(LεχΩ)+4µ

2
ε(λ1−λ0)α

′(LεχΩ)
(2µε+λε)2

tr(eεττ )
2
)

+Lε

(
4λε(µ1−µ0)β′(LεχΩ)−4µε(λ1−λ0)α′(LεχΩ)

(2µε+λε)2
tr(eεττ )σ

ε
nn

)
+ `Lε1.

Like in the proof of Theorem 5.3, one may prove that

gΩ,ε − g̃Ω,ε
ε→0−→ 0 in L1(Γ),

where g̃Ω,ε is defined by:

g̃Ω,ε = −2(µ1 − µ0)Lε (β′(LεχΩ)) eεττ : eεττ − Lε
(

(µ1−µ0)β′(LεχΩ)
µ2ε

)
σετn · σετn

−Lε
(

2(µ1−µ0)β′(LεχΩ)+(λ1−λ0)α′(LεχΩ)
(2µε+λε)2

)
(σεnn)

2

−Lε
(

2λ2ε(µ1−µ0)β
′(LεχΩ)+4µ

2
ε(λ1−λ0)α

′(LεχΩ)
(2µε+λε)2

)
tr(eεττ )

2

+Lε

(
4λε(µ1−µ0)β′(LεχΩ)−4µε(λ1−λ0)α′(LεχΩ)

(2µε+λε)2

)
tr(eεττ )σ

ε
nn + `.

We now apply Lemma 5.4 repeatedly to each term in the above expression, using the shorthands:

λ(t) = λ0 + (λ1 − λ0)α(t) and µ(t) = µ0 + (µ1 − µ0)β(t).
• Using ϕ(t) = µ(t), we obtain:

lim
ε→0

((µ1 − µ0) Lεβ′(LεχΩ)) = µ1 − µ0,

• Using ϕ(t) = 1
µ(t)

, ϕ′(t) = −(µ1−µ0)β
′(t)

µ(t)2
we obtain:

lim
ε→0

(
Lε

(µ1 − µ0)β′(LεχΩ)
µ2ε

)
=

1

µ0
− 1
µ1
,

24



• Using ϕ(t) = 1
2µ(t)+λ(t)

, ϕ′(t) = − 2µ
′(t)+λ′(t)

(2µ(t)+λ(t))2
, we obtain:

lim
ε→0

(
Lε

2(µ1 − µ0)β′(LεχΩ) + (λ1 − λ0)α′(LεχΩ)
(2µε + λε)2

)
=

1

2µ0 + λ0
− 1

2µ1 + λ1
,

• Using ϕ(t) = 2µ(t)λ(t)
2µ(t)+λ(t)

, ϕ′(t) = 4µ
2(t)λ′(t)+2λ2(t)µ′(t)

(2µ(t)+λ2(t))2
yields:

lim
ε→0

(
Lε

2λ2ε(µ1 − µ0)β′(LεχΩ) + 4µ2ε(λ1 − λ0)α′(LεχΩ)
(2µε + λε)2

)
=

2µ1λ1
2µ1 + λ1

− 2µ0λ0
2µ0 + λ0

,

• Using ϕ(t) = 2λ(t)
2µ(t)+λ(t)

, ϕ′(t) = 4µ(t)λ
′(t)−4µ′(t)λ(t)

(2µ(t)+λ(t))2
yields:

lim
ε→0

(
Lε

4λε(µ1 − µ0)β′(LεχΩ)− 4µε(λ1 − λ0)α′(LεχΩ)
(2µε + λε)2

)
=

2λ0
2µ0 + λ0

− 2λ1
2µ1 + λ1

.

In view of the expression (6.5), this ends the proof of the theorem.
�

7. Connection with the shape and topological derivatives of the exact problem

At this point, the results obtained about the asymptotic behavior of the smoothed shape optimization
problem (3.9) may be summarized as follows, in the language of the two-phase conductivity equation for
simplicity: for a fixed admissible shape Ω ∈ Uad,

• The smoothed conductivity γΩ,ε defined in (3.1) converges to γΩ strongly in Lp(D) (1 ≤ p <∞) as
ε→ 0 (Theorem 4.1).

• The smoothed potential uΩ,ε defined in (3.4) converges to uΩ in the sense that Theorem 4.5 holds.
• The smoothed value Jε(Ω) of the objective function converges to its exact counterpart J(Ω).
• The restriction to Γ of the approximate gradient gΩ,ε defined by (3.7) converges to the shape gradient
gSΩ(x) of the exact objective J(Ω), defined by (2.7) (see Theorem 5.3):

gΩ,ε
ε→0−→ gSΩ, in Lp(Γ), 1 ≤ p <∞.

• The restriction to Ω0 ∪ Ω1 of gΩ,ε behaves as follows (see Proposition 5.2):

gΩ,ε
ε→0−−−→

{
−(γ1 − γ0)ζ ′(0)|∇uΩ|2+` strongly in Lp(Ω0),
−(γ1 − γ0)ζ ′(1)|∇uΩ|2+` strongly in Lp(Ω1),

and we shall soon connect these expressions to that of Theorem 2.2 for the topological gradient gTΩ
of J(Ω).

As we are about to see, Proposition 5.2 and Theorem 6.5 make it possible to identify the limit of the ap-
proximate gradient gΩ,ε outside the interface Γ with the topological gradient g

T
Ω of the original cost J(Ω).

This can be achieved through appropriate choices of the interpolation functions ζ, α and β, as we now discuss.

7.1. The case of the conductivity equation.

In this context, using Theorem 2.2 and Proposition 5.2, one easily observes that gΩ,ε → gTΩ in Lp(Ω0∪Ω1)
as ε→ 0, provided the interpolation profile ζ satisfies:

(7.1) ζ(0) = 0, ζ(1) = 1, ζ ′(0) = k0 and ζ ′(1) = k1.

Multiple possibilities are therefore available as for the function ζ:

• The simplest choice is a third-order polynomial function ζp(t) of the form:

ζp(t) = a3t
3 + a2t

2 + a1t+ a0,

where a0, a1, a2, a3 are uniquely determined by the relations (7.1).
25



• An alternative possibility is inspired by the homogenization theory: a classical result (see [4] or [3],
Th. 2.2.3.1) states that a d× d tensor with eigenvalues λ1, ..., λd, can be realized as a homogenized
conductivity tensor obtained by mixing the two materials with conductivities γ0 and γ1 in proportions
t and 1− t (for t ∈ (0, 1)) if and only if it fulfills the so-called Hashin-Shtrikman bounds. Assuming
for a moment that γ0 < γ1 to ease notations, these bounds read:

(7.2) λ−t ≤ λi ≤ λ+t , where λ−t =
(
t

γ0
+

1− t
γ1

)−1
, λ+t = tγ0 + (1− t)γ1, and

(7.3)

d∑
i=1

1

λi − γ0
≤ 1
λ−t − γ0

+

d∑
i=1

d− 1
λ+t − γ0

, and

d∑
i=1

1

γ1 − λi
≤ 1
γ1 − λ−t

+

d∑
i=1

d− 1
γ1 − λ+t

.

From (7.2) and (7.3), we easily infer a necessary and sufficient condition for a scalar conductivity
(corresponding to an isotropic conductivity tensor λ1 = ... = λd) to be achievable as a mixture of
the two materials with conductivities γ0 and γ0.

Since (7.2) and (7.3) behave as rational functions of the volume fraction t, a natural idea consists
in defining ζ(t) = ζr(t) under the form:

ζr(t) =
a2t

2 + a1t+ a0
bt+ 1

,

where the coefficients a0, a1, a2 and b are again uniquely determined by the relations (7.1).

Interestingly, in two space dimensions, in the limit γ0 → 0, a simple calculation reveals that the in-
terpolating functions ζp(t) and ζr(t) produced by the above procedures amount to the same second-order
polynomial ζp(t) = ζr(t) = t

2. In Figure 3, the common values of the polynomial and rational interpolation
functions ζp(t) and ζr(t) are represented in two space dimensions, in the (formal limit) case γ0 = 0 and γ1 = 1.

Figure 3. Interpolation process in the conductivity setting, in the case γ0 = 0 and γ1 = 1.
The harmonic and arithmetic means λ−t and λ

+
t defined in (7.2) are depicted in black. The

red segments account for the conditions (7.1) on ζ. The Hashin-Shtrikman bounds for the
common eigenvalue of an isotropic conductivity tensor (i.e. obtained by imposing λ1 = λ2
in (7.3)) are represented by the blue curves, and the common values of ζp(t) and ζr(t) in
this case are depicted in yellow.

7.2. The case of the linear elasticity system.

So as to directly observe and check the positive definiteness of the interpolated Hooke’s tensor (6.8) (6.9),
we rely on the description of this tensor in terms of the shear and bulk moduli µ and κ respectively.

26



Assuming an interpolation of the form (6.9) between the material properties of both phases Ω0, Ω1, the
bulk modulus κh,ε of the approximate Hooke’s tensor Ah,ε reads:

κh,ε = κ0 + (κ1 − κ0)α̃(Lεh), where α̃(t) :=
2

d
β(t) + α(t).

Then, Theorem 6.2 imposes explicit conditions on the values and derivatives of α(t) and β(t) (thus of α̃(t))
at t = 0 and 1 so that the convergence gΩ,ε → gTΩ holds in Lp(Ω0 ∪ Ω1), for 1 ≤ p < ∞. Like in the
conductivity case, polynomial functions α̃p(t), βp(t) and rational functions α̃r(t), βr(t) are possible when it
comes to constructing explicitly such interpolation functions.

Recall from [12] that in two space dimensions, and in the particular case where ν0 = ν1 = 1/3, elementary
albeit tedious calculations reveal that both polynomial interpolation profiles αp(t) for λ and βp(t) for µ
coincide. Hence, (6.8) reduces to:

Ah,ε = A0 + (A1 −A0)βp(Lεh);

besides, as E0 → 0, βp(t) ≈ t3, which is incidently the most commonly used power law for interpolationg
Hooke’s tensors in the context of the SIMP method.

An illustration of both interpolation procedures is presented In Figure 4. Notice that the interpolation
functions shown here satisfy the Hashin-Shtrikman bounds. Depending on the elastic coefficients of the
interpolated materials, this is not always the case using polynomial functions, as already remarked in the
context of the SIMP method [17], in contrast to the suggestion of our numerical investigations with rational
functions.

Figure 4. Interpolation functions (left) β for the shear modulus µ and (right) α̃ for the bulk
modulus κ. The coefficients of the materials filling Ω0 and Ω1 read: E0 = 0.001, E1 = 1,
ν0 = ν1 = 1/3. In both figures, the Hashin-Shtrikman bounds are depicted in blue, and the
polynomial (resp. rational) interpolation functions correspond to the yellow (resp. brown)
curves. The red segments illustrate the conditions imposed on their derivatives at t = 0 and
t = 1.

8. Description of the numerical methods

In this section, we describe the two main ingredients in the device of numerical algorithms from the
theoretical investigations in the previous sections.

27



8.1. Practical implementation of the regularizing operator Lε.

We first examine several possibilities offered by the numerical framework as regards the regularizing
operator Lε : L

2(D) → L∞(D). For simplicity, our discussion takes place in the two-dimensional setting,
but its extension to three space dimensions is straightforward.

Throughout this section, the domain D is equipped with a conforming, triangular mesh T composed of
K triangles Tk, k = 1, ...,K, and J vertices pj , j = 1, ..., J . Let us recall the classical Finite Element spaces:

• V0 ⊂ L2(D) is the finite-dimensional space of Lagrange P0 Finite Element functions on T , i.e. of
constant functions in restriction to each triangle Tk ∈ T . A basis of V0 is composed of the functions
N0k , k = 1, ...,K, where N

0
k ≡ 1 on Tk and Nk ≡ 0 on Tk′ , k 6= k′.

• V1 ⊂ L2(D) is the finite-dimensional space of Lagrange P1 Finite Element functions, i.e. of affine
functions in restriction to each triangle Tk ∈ T . A basis of V1 is composed of the functions N1j ,
j = 1, ..., J , where N1j is the unique element in V1 such that N

1
j (pj′) = 1 if j = j

′ and 0 otherwise.

We now propose three discrete versions of the operator Lε, mapping an arbitrary density h ∈ L2(D) to
a piecewise constant function Lεh ∈ V0. The first two ones are quite heuristic; they are inspired by the
convolution operator Lconvε described in Section 3.2.1 and take advantage of the Finite Element framework.
The third one is a direct discretization of the operator Lellε of Section 3.2.2.

8.1.1. The ‘ P0 kernel’ operator P0.

Our first operator P0 : L
2(D)→ V0 is the L2(D) orthogonal projection from L2(D) to the subspace V0:

∀h ∈ L2(D), P0h =
∑
k

1

|Tk|
(N0k , h)L2(D) N

0
k ,

i.e. for each triangle Tk ∈ T , P0h|Tk is the average of h over Tk. P0 is easily seen to be a self-adjoint operator
from L2(D) into itself. In this case, the mesh size - i.e. the maximum length of an edge in the mesh - plays
the role of the smoothing parameter ε.

When P0 is used as the regularizing operator Lε, the gradient gh,ε of the optimized functional Jε(h),
calculated via (3.7), naturally belongs to the space V0, and it is therefore constant in restriction to each tri-
angle of the mesh. This may cause difficulties when the numerical algorithm used to solve the optimization
problem (3.5) or (3.9) requires that this information be supplied at the vertices of T (this is the case of the
level set algorithm presented in Section 8.2.2 below). Then, a gradient defined at nodes can be recovered by
using e.g. a Clément Finite Element interpolate; see e.g. [29].

8.1.2. The ‘ P1 kernel’ operator P1.

Let us now define the operator P1 : L
2(D)→ V0 by:

∀h ∈ L2(D), P1h =
K∑
k=1

(Qk, h)L2(D) N
0
k ,

where for any triangle Tk, with vertices pj1 , pj2 , pj3 , the ‘ P1 kernel’ Qk ∈ V1 is defined by (see Figure 5):

(8.1) Qk =
1

3∑
i=1

(N1ji , 1)L2(D)

3∑
i=1

N1ji .

This operator is not self-adjoint from L2(D) into itself; nevertheless, as observed in Remark 3.1, the consid-
erations of Section 3.1 are easily adapted to this case. The gradient gh,ε of Jε(h), which is then calculated
as (3.8), naturally belongs to V1. Therefore, P1 smoothes the density h in such a way that the values of P1h
inside one triangle Tk of the mesh not only involve the values of h on Tk but also those on the neighboring
triangles.

28



Figure 5. Graph of the (non normalized) function Qk defined in (8.1).

8.1.3. The discretization LellT of L
ell
ε .

Our last operator LellT : L
2(D)→ V0 is defined as follows: for h ∈ L2(D), LellT h = P0 qT ,h, where qT ,h ∈ V1

is the numerical solution of (3.12) given by the P1 Lagrange Finite Element method on the mesh T ; more
precisely:

qT ,h =
J∑
i=1


 J∑
j=1

Rij(N
1
j , h)L2(D)


N1i , where R = (ε2K +M)−1,

and K, M stand respectively for the J × J stiffness and mass matrices associated to the resolution of (3.12)
by means of the Lagrange P1 Finite Element method:

Kij =

∫
D

∇N1j · ∇N1i dx, and Mij =
∫
D

N1jN
1
i dx.

LellT is not self-adjoint as an operator from L
2(D) into itself, but the mapping h 7→ qT ,h is. Again, the

corresponding discrete gradient gh,ε given by (3.7) is naturally a V1 function.
The smoothing effect induced by LellT is controlled at the same time by the parameter ε and the mesh

size. It is natural to demand that the mapping h 7→ qT ,h satisfy the discrete maximum principle, so that
regularized densities LellT h take values between 0 and 1. This requirement prevents ε from being ‘very small’;
our experience suggests a choice of ε of the order of the mesh size.

On a different note, notice that, contrary to the previous operators P0 and P1, the dependence of L
ell
T h

on h is non local, i.e. even if h has small support, LellT h is non trivial on the whole computational domain
D (which reflects the strong maximum principle satisfied by the continuous equation (3.12)). Therefore,
densites or characteristic functions smoothed using LellT are expected to show large grayscale areas.

8.2. Two numerical optimization algorithms.

We now present two numerical algorithms inspired by the previous considerations. The first one is a
simple projected gradient algorithm devoted to the resolution of the density optimization problem (3.5), and
the second one relies on the level set method for solving the approximate shape optimization problem (3.9).

These algorithms are motivated by the conclusions of Proposition 5.2 and Theorem 5.3, whereby per-
forming variations of a shape Ω with respect to the approximate gradient gΩ,ε defined in (3.7) should closely
approximate at the same time a shape optimization algorithm based on the shape derivative, and a topology
optimization algorithm based on the topological gradient, provided the interpolation profiles ζ, α̃ and β are
chosen according to the discussion in Section 7.

For simplicity, the discussion unfolds in the case of the two-phase conductivity equation of Section 2.

8.2.1. A projected gradient algorithm for solving the density optimization problem.

Our first numerical algorithm is a simple projected gradient algorithm for the resolution of the density
optimization problem (3.5), which is very close in essence to the standard filtered SIMP algorithm. Starting
from an initial density h0 ∈ L∞(D, [0, 1]), the algorithm produces a sequence hn ∈ L∞(D, [0, 1]), n = 0, ...,

29



passing from hn to hn+1 by following the steepest descent direction ghn,ε supplied by (3.7), then thresholding
in such a way that hn+1 ∈ L∞(D, [0, 1]) (hence the terminology ‘projected gradient’), i.e.:

hn+1(x) = max(0,min(1, hn(x)− τnghn,ε(x))),
for a sufficiently small pseudo-time step τn. The process ends when the relative difference ||hn+1−hn||L2(D)/||hn||L2(D)
between two consecutive values of the optimized density is smaller than a fixed, user-defined threshold r

pr
f .

Notice that the resulting optimized design from this algorithm is a density function, which may a priori
contain regions with intermediate densities, even if they are penalized by the interpolation profile ζ. A
popular method to eliminate possible such regions appearing in the final design consists in projecting the
latter onto the set of functions taking only values 0 and 1 as a post-processing in order to ‘interprete’ it as
a true ‘black and white’ shape.

8.2.2. An algorithm using the level set method.

Our second algorithm is devoted to the numerical resolution of the approximate shape optimization
problem (3.9); hence, it presents the important feature that it always involves a real, ‘black and white’ shape
(and not a density function). This algorithm is similar to the level set based topology optimization algorithm
introduced in [13], then analyzed in [11].

According to the general philosophy of the level set method (see [41] for the seminal article and [46] for an
overview), every considered shape Ω is viewed as the negative subdomain of an associated ‘level set’ function
φ : D → R, i.e.: 


φ(x) < 0 if x ∈ Ω,
φ(x) = 0 if x ∈ Γ,
φ(x) > 0 if x ∈ D \ Ω,

Relying on the necessary optimality condition for Problem (3.9) expressed in Proposition 3.3, if a shape
Ω ∈ Uad is optimal with respect to Jε(Ω) (in the sense of Definition 2.3), then gΩ,ε is an associated level set
function for Ω. Noting in addition that if ψ is one level set function for Ω, then so is cψ for any constant
c > 0, we are led to search for one function ψ such that:

(8.2) ||ψ||L2(D)= 1, and ψ =
1

||gΩ,ε||L2(D)
gΩ,ε, with Ω = {ψ < 0} .

Applying a fixed-point algorithm with relaxation to (8.2), elementary calculations produce the sequences of
level set functions ψn and associated shapes Ωn := {x ∈ D, ψn(x) < 0} defined by:

(8.3) ψn+1 =
1

sin an
(sin((1− τn)an)ψn + sin(τnan)g̃n) ,

where g̃n =
1

||gn||L2(D)
gn is the normalized version of the gradient gn := gΩn,ε, an ∈ [0, π] is the angle

an = arccos((ψn, gn)L2(D)), and τn plays the role of a time step.
The process described by (8.3) is iterated until the relative difference ||χΩn+1,ε − χΩn,ε||L2(D)/||χΩn,ε||L2(D)

becomes smaller than a user-defined threshold rlsf .

Remark 8.1. There are traditionnally two ways for evaluating numerically the gradient information gh,ε
(or gΩ,ε) see e.g. [45], §16.13. The ‘optimize-then-discretize’ strategy simply consists in discretizing the
continuous expression (3.7) for gh,ε, e.g. by using Finite Elements. In the applications of this article, we rely
on the competing ‘discretize-then-optimize’ paradigm: density functions h are first discretized - in our case,
they are decomposed on a basis of the Finite Element space V0 (see Section 8) -, then gh,ε is calculated as
the (finite-dimensional) gradient of the resulting finite-dimensional discretization of Jε(h).

9. Numerical illustrations

In this section, we present several numerical illustrations of the previous material, limiting ourselves to
the physically more relevant context of the linearized elasticity equations of Section 6. In all the considered
examples, the computational domain D is a polygon (see Remark 5.4 about the validity of the theoretical
results of this paper in this context). It is equipped with a triangular mesh, and the elastic coefficients of

30



the materials in Ω0 and Ω1 are E0 = 10
−3, E1 = 1, ν0 = ν1 = 1/3. We systematically rely on the rational

interpolation scheme for the interpolation profiles ζ, α̃ and β (see Section 7).
At first, Section 9.1 takes place in a model situation, and we appraise the main conclusions of Theorem

6.5 about the convergence of the approximate shape optimization problem (6.13) to its exact counterpart
(6.3) as the smoothing parameter ε vanishes.

Then, in Sections 9.2 and 9.3, we apply the constructions and algorithms discussed in Sections 7 and 8
to two classical examples in shape and topology optimization. In both cases, the initial design is the whole
computational domain, i.e. h0 ≡ 1 (resp. ψ0 ≡ −1/

√
|D|) on D when the projected gradient algorithm of

Section 8.2.1 (resp. the level set algorithm of Section 8.2.2) is used. The parameter ε is chosen of the order
of the mesh size, and as far as the stopping criterion is concerned, the common value 10−3 is used for the
thresholds r

pr
f and r

ls
f .

9.1. Numerical assessment of the convergence of the approximate shape optimization problem
to its exact counterpart.

A rectangular domain D of size 2× 1 is divided into two regions Ω1 = Ω and Ω0 = D \Ω1 corresponding
to its lower and upper halves respectively; D is clamped at its left- and right-hand sides, and a unit vertical
load g = (0,−1) is applied on a region ΓN located at the middle of its lower side; see Figure 6.

D

1

2

g

⌦�N

�D

0.2

Figure 6. Setting of the test case used in Section 9.1 for the evaluation of the convergence
of the approximate shape optimization problem to its exact counterpart.

The domain D is discretized by a regular triangular mesh T , obtained from a Cartesian grid of size h
by splitting each voxel into four triangles. In this setting, the interface Γ between Ω0 and Ω1 is explicitely
represented in T .

We first calculate a close approximation to the solution uΩ to (6.2) by using a very fine mesh of D with
size h = 1

320
(containing 819, 200 triangles). We thence infer precise calculations of the compliance C(Ω),

of the shape gradient gSΩ and of the topological derivative g
T
Ω of the exact shape optimization problem (6.3)

in this context, according to Formula (6.4) and Theorems 6.1 and 6.2. These quantities serve as reference
values in the experiments of this section; they are referred to as the ‘exact’ compliance, shape gradient and
topological gradient, and, abusing notations, they are still denoted by C(Ω), gSΩ and g

T
Ω , respectively.

We then calculate the approximate compliance Cε(Ω) given by (6.12) and the derivative gΩ,ε of the
approximate shape optimization problem (see Proposition 6.3) by using the discrete version of the regularizing
operator Lε based on either the ‘P1 kernel’ operator of Section 8.1.2 or the LellT operator of Section 8.1.3, on

31



successively refined meshes, with sizes h = 1
20

, 1
40

, 1
80

and 1
160

(corresponding to 3, 200, 12, 800, 51, 000 and

204, 800 triangles respectively), and for the values ε = h, h
2
, or h

10
in the latter case. In each situation, we

evaluate:

• The value of the approximate compliance Cε(Ω),
• The relative error

eTΩ,ε :=

∫
ω

|gTΩ − gΩ,ε|2 dx∫
ω

|gTΩ |2 dx

between gΩ,ε and g
T
Ω , on the subset ω :=

{
x = (x1, x2) ∈ Ω, x2 < 12 −

1
20

}
of Ω; i.e. ω is obtained

from Ω by removing one layer of elements of the coarser mesh.
• The relative error

eSΩ,ε :=

∫
Γ

|gSΩ − gΩ,ε|2 dx∫
Γ

|gSΩ|2 dx

between gΩ,ε and g
S
Ω.

The results of these experiments are reported on Figure 7, and are in good agreement with the conclusions
of Theorem 6.5: as the mesh size h (and thereby the regularization parameter) decreases, the approximate
compliance Cε(Ω) tends to its exact counterpart, and the approximate derivative gΩ,ε converges to the
topological derivative gTΩ of the exact shape optimization problem when it is restricted to the subset ω ⊂ Ω,
and to the shape gradient gSΩ when it is restricted to Γ.

9.2. A self-adjoint objective function for the elasticity problem.

A rectangular cantilever beam D of size 2× 1, equipped with a regular triangular mesh T made of 19600
elements, is clamped at its left-hand side, and a unit vertical load g = (0,−1) is applied at the middle of
its right-hand side, as depicted on Figure 8. The objective function of interest is a weighted sum of the
compliance of shapes and their volume:

J(Ω) =

∫
D

AΩe(uΩ) : e(uΩ) dx+ `Vol(Ω),

where AΩ is defined in (6.1), and the elastic displacement uΩ is the solution to (6.2). The Lagrange multiplier
is set to ` = 1.

We apply the projected gradient algorithm of Section 8.2.1 for solving the density optimization problem
(6.11) in this context, and the level set algorithm of Section 8.2.2 for solving the associated approximate shape
optimization problem (6.13). For the sake of comparison, the three different instances of the regularization
operators Lε described in Section 8.1 are used, corresponding to as many different ways to calculate the cost
function J(Ω) and the associated gradient. The resulting optimal topologies are shown in Figures 9 and 10;
the corresponding convergence histories are reported in Figure 11.

9.3. A non self-adjoint objective function.

In order to appraise the robustness of the proposed algorithms, we eventually turn to the study of a non
self-adjoint objective function; as pointed out in Remark 5.3, the main conclusions of this article remain
valid in this case.

Let us consider the optimal design of a gripping mechanism, as shown in Figure 12; the computational
domain D is discretized with a triangular mesh T containing 19600 triangles. The structure is fixed at two
nodes on its symmetry axis; the region ΓN where loads are applied is decomposed as ΓN = Γ

1
N ∪ Γ2N and:

• Vertical loads g1 = (0,±10) are applied on Γ1N , which represent the pressure exerted by the user,
• Vertical loads g2 = (0,±1) are applied on Γ2N , which account for the reaction force applied by the

object undergoing the action of the gripping mechanism.
32



Figure 7. (Top, left) Convergence of the approximate compliance Cε(Ω) to its exact coun-
terpart C(Ω) with respect to the mesh size; (top, right) relative error eTΩ,ε over the approxi-

mation of the topological derivative for various mesh sizes; (bottom) relative error eSΩ,ε over
the approximation of the shape gradient for various mesh sizes.

D�D g

•

2

1

Figure 8. Setting of the cantilever test case studied in Section 9.2

The considered objective function J(Ω) reads:

J(Ω) =

∫
ΓN

k · uΩ ds+ `Vol(Ω),

where the vector k is defined by:

• k = (0,−1) on the upper side of Γ1N and k = (0, 1) on the lower side of Γ1N ,
33



Projected gradient Level-set

LellT

Jε(h) = 2.4 Jε(Ω) = 2.394

P1

Jε(h) = 2.294 Jε(Ω) = 2.282

P0

Jε(h) = 2.247 Jε(Ω) = 2.216

Figure 9. Optimal shapes obtained in the cantilever test-case of Section 9.2, (left column)
using the projected gradient algorithm of Section 8.2.1 for the density optimization problem
(3.5) and (right column) using the level set algorithm of Section 8.2.2 for the smoothed shape
optimization problem (3.9). The regularized density Lεh (left) and characteristic function
χΩ,ε (right) are represented.

• k = (0, 2) on the upper side of Γ2N and k = (0,−2) on the lower side of Γ2N ,
so that it is expected that the elastic displacement of the resulting design shows a pinching of the jaws Γ2N
without inducing an excessive displacement of the region Γ1N where the user applies forces.

Again, the projected gradient algorithm and the level set algorithm are applied with the three different
instances of the regularization operators Lε discussed in Section 8.1. The resulting optimal topologies are
shown in Figures 13 and 14, and the corresponding deformed configurations of the grip are displayed in
Figure 15. The convergence histories are reported in Figure 16.

Acknowledgements. C.D. was partially supported by the ANR OptiForm. A.F. has received funding from
the European Research Council under the European Union’s Seventh Framework Programme (FP/2007-
2013) / ERC Grant Agreement n. 320815 (ERC Advanced Grant Project “Advanced tools for computational
design of engineering materials” COMP-DES-MAT).

Appendix A. Sketch of the proof of Theorem 4.5

The proof is a little technical, but rests on classical arguments, and notably Nirenberg’s technique of
difference quotients [39], as exposed, e.g. in [22] (see also the discussion in [27], §4.8). We therefore limit
ourselves to sketches of proofs.

Let us start with a useful result about the characterization of W 1,p spaces. Let 1 < p ≤ ∞, and
1 ≤ p′ <∞ be such that 1

p
+ 1

p′
= 1. For a function ϕ ∈ Lp(D), a subset V b D, and a vector h ∈ Rd with

|h|< dist(V, ∂D), we define the difference quotient Dhϕ ∈ Lp(V ) as:

Dhϕ(x) =
τhϕ(x)− ϕ(x)

|h| , a.e. x ∈ V, where τhϕ(x) := ϕ(x+ h).
34



Projected gradient Level-set

LellT

Jε(h) = 2.4 Jε(Ω) = 2.394

P1

Jε(h) = 2.294 Jε(Ω) = 2.282

P0

Jε(h) = 2.247 Jε(Ω) = 2.216

Figure 10. Optimal shapes obtained in the cantilever test-case of Section 9.2, (left column)
using the projected gradient algorithm of Section 8.2.1 for the density optimization problem
(3.5) and (right column) using the level set algorithm of Section 8.2.2 for the smoothed shape
optimization problem (3.9). The exact density h (left) and characteristic function χΩ (right)
are represented.

Figure 11. Convergence histories for the projected gradient and level-set algorithm with
P0, P1 and Lellε regularization operators for the cantilever test case of Section 9.2.

In the above context, it holds that, if V is convex and ϕ ∈W 1,p(D):
(A.1) ||Dhϕ||Lp(V )≤ ||∇ϕ||Lp(D).

35



D �1N

g1

g2

�2N
••

0.1

0.1

0.2 1

1

Figure 12. Setting of the gripping mechanism test case of Section 9.3

Then (see [22], Prop. 9.3):

Proposition A.1. Let ϕ ∈ Lp(D); the following assertions are equivalent:
(1) ϕ belongs to W 1,p(D).
(2) There exists a constant C > 0 such that:∣∣∣∣

∫
D

ϕ
∂ψ

∂xi
dx

∣∣∣∣ ≤ C||ψ||Lp′ (D), for any v ∈ C∞c (D), i = 1, ..., d.
(3) There exists a constant C > 0 such that, for any open subset V b D,

lim sup
h→0

||Dhϕ||Lp(V ) ≤ C.

Moreover, the smallest constant satisfying points (2) and (3) is C = ||∇ϕ||Lp(D)d .
Let us pass to the proof of Theorem 4.5 properly speaking. Throughout this appendix, a shape Ω ∈ Uad

is fixed; Lε stands for either one of the operators L
conv
ε or L

ell
ε constructed in Section 3.2, and we rely on the

shorthands:

γε ≡ γΩ,ε, and uε ≡ uΩ,ε.
Also, C consistently denotes a positive constant, that may change from one line to the other, but is in any
event independent of ε and the parameter h (to be introduced).

Proof of (i):
Without loss of generality, we assume that U b Ω0, and we introduce two other subsets V,W of D such

that U b V bW b Ω0. Let χ be a smooth cutoff function such that χ ≡ 1 on U , and χ ≡ 0 on V . Our aim
is to prove that:

(A.2) vε
ε→0−→ vΩ strongly in Hm(D),

for any m ≥ 1, where we have defined vε = χuε and vΩ = χuΩ. Note that we have already proved in
Proposition 4.4 that (A.2) holds for m = 1.

Using test functions of the form χϕ, for arbitrary ϕ ∈ H1(D), easy manipulations lead to the following
variational formulations for vε and vΩ:

(A.3) ∀ϕ ∈ H1(D),
∫
D

γε∇vε · ∇ϕ dx =
∫
D

fεϕ dx+

∫
D

hε · ∇ϕ dx, and
36



Projected gradient Level set

LellT

Jε(h) = −28.41 Jε(Ω) = −32.31

P1

Jε(h) = −29.65 Jε(Ω) = −57.57

P0

Jε(h) = −41.71 Jε(Ω) = −26.97

Figure 13. Optimal shapes obtained in the gripping mechanism test-case of Section 9.3,
(left column) using the projected gradient algorithm of Section 8.2.1 for the density opti-
mization problem (3.5) and (right column) using the level set algorithm of Section 8.2.2
for the smoothed shape optimization problem (3.9). The regularized density Lεh (left) and
characteristic function χΩ,ε (right) are represented.

(A.4) ∀ϕ ∈ H1(D),
∫
D

γΩ∇vΩ · ∇ϕ dx =
∫
D

fΩϕ dx+

∫
D

hΩ · ∇ϕ dx,

where fε, fΩ ∈ L2(D) and hε, hΩ ∈ H1(D)d are defined by:
(A.5) fε = −γε∇uε · ∇χ, fΩ = −γΩ∇uΩ · ∇χ, hε = γεuε∇χ, and hΩ = γΩuΩ∇χ.

37



Projected gradient Level-set

LellT

Jε(h) = −28.41 Jε(Ω) = −32.31

P1

Jε(h) = −29.65 Jε(Ω) = −57.57

P0

Jε(h) = −41.71 Jε(Ω) = −26.97

Figure 14. Optimal shapes obtained in the gripping mechanism test-case of Section 9.3,
(left column) using the projected gradient algorithm of Section 8.2.1 for the density opti-
mization problem (3.5) and (right column) using the level set algorithm of Section 8.2.2 for
the smoothed shape optimization problem (3.9). The exact density h (left) and characteristic
function χΩ (right) are represented.

Subtracting (A.4) to (A.3) yields the following variational formulation for wε := vε−vΩ: for any ϕ ∈ H1(D),

∫
D

γε∇wε · ∇ϕ dx = −
∫
D

(γε − γΩ)∇vΩ · ∇ϕ dx+
∫
D

(fε − fΩ)ϕ dx+
∫
D

(hε − hΩ) · ∇ϕ dx.
38



Projected gradient Level-set

LellT

P1

P0

Figure 15. Deformed configurations for the optimal gripping mechanisms in the setting of
Section 9.3.

Now, for any vector h ∈ Rd with sufficiently small length, let us insert ϕ = D−hDhwε in this variational
formulation:

(A.6)

∫
D

γε|∇Dhwε|2 dx = −
∫
D

Dhγε τh(∇wε) · ∇Dhwε dx−
∫
D

τh(γε − γΩ)∇DhvΩ · ∇Dhwε dx

−
∫
D

Dh(γε − γΩ)∇vΩ · ∇Dhwε dx+
∫
D

(fε − fΩ)D−hDhwε dx+
∫
D

Dh(hε − hΩ) · ∇Dhwε dx.

To achieve the last identity, we have used the ‘discrete integration by parts’:∫
D

w(Dhz) dx = −
∫
D

(D−hw)z dx,

39



Figure 16. Convergence histories for the projected gradient and level-set algorithm with
P0, P1 and Lellε regularization operators for the gripping mechanism test case of Section 9.3.

for arbitrary functions w, z ∈ L2(D) vanishing outside W (which just follows from a change of variables in
the corresponding integrals), as well as the discrete product rule:

Dh(uv) = Dhu τhv + uDhv.

Using Hölder’s inequality with 1
p

+ 1
q

+ 1
2

= 1 and Proposition A.1, we obtain:

(A.7)

lim sup
|h|→0

||∇Dhwε||L2(W )d ≤ ||∇wε||Lq(W )d lim sup
|h|→0

||∇Dhγε||Lp(W )d+||γε−γΩ||Lp(W )lim sup
|h|→0

||∇DhvΩ||Lq(W )d

+ ||∇vΩ||Lq(W )d lim sup
|h|→0

||∇Dh(γε − γΩ)||Lp(W )d + ||(fε − fΩ)||L2(W )+ lim sup
|h|→0

||Dh(hε − hΩ)||L2(W )d ,

and we now have to prove that each term in the right-hand side of this inequality tends to 0 as ε→ 0, which
follows quite easily from repeated uses of Proposition A.1 together with the convergences of Proposition 4.1
for the conductivity γε and the convergence results for wε expressed in Proposition 4.4. We omit the details,
referring to the proof of (ii), where similar ones (yet in any point more involved) are handled.

As a result, one has:

lim sup
|h|→0

||∇Dhwε||L2(W )d
ε→0−→ 0,

which implies, from Proposition A.1,

||∇wε||H1(W )d
ε→0−→ 0.

Therefore, (A.2) holds for m = 2. The case m > 2 is obtained by iterating the previous argument.

Proof of (ii):
Since Γ is compact, it is enough to prove that the estimates (4.6) hold in an open neighborhood U of any

arbitrary point x0 ∈ Γ; namely, we introduce two other subset V,W of D such that U b V bW b D; let χ
be a smooth cutoff function, which equals 1 on U et 0 on D \ V ; we aim to prove that:

(A.8)
∂vε
∂τ

ε→0−→ ∂vΩ
∂τ

in H1(W ), for any tangential vector field τ : Γ→ Rd, and

(A.9) γΩ,ε
∂vε
∂n

ε→0−→ γΩ
∂vΩ
∂n

in H1(W ),

where, again vε = χuε and vΩ = χuΩ.
Without loss of generality, we assume that Γ is flat in U , that is: Ω ∩ U = {x ∈ U, xd < 0} is a piece of

the lower half-space. The general case is recovered from this one by a standard argument of local charts for
40



the smooth boundary Γ. To prove (A.8), it is therefore enough to consider the case τ = ei, i = 1, ..., d − 1,
the ith-vector of the canonical basis (e1, ..., ed) of Rd, which we now do.

Introducing fε, fΩ ∈ L2(D), hε, hΩ ∈ H1(D)d as in (A.5), and wε = vε − vΩ, we now follow the exact
same trail as that leading to (A.6) in the proof of (i), using only vectors h of the form h = hei, with small
enough h > 0:

(A.10)

∫
D

γε|∇Dhwε|2 dx = −
∫
D

Dhγε τh(∇wε) · ∇Dhwε dx−
∫
D

τh(γε − γΩ)∇DhvΩ · ∇Dhwε dx

−
∫
D

Dh(γε − γΩ)∇vΩ · ∇Dhwε dx+
∫
D

(fε − fΩ)D−hDhwε dx+
∫
D

Dh(hε − hΩ) · ∇Dhwε dx

We now estimate each of the five terms in the right-hand side of (A.10):

• Using Hölder’s inequality with 1
p

+ 1
q

+ 1
2

= 1, the first term is controlled as:∣∣∣∣
∫
D

Dhγε∇wε · ∇Dhwε dx
∣∣∣∣ ≤ C||∇vε −∇vΩ||Lq(W )d

∣∣∣∣
∣∣∣∣∂γε∂xi

∣∣∣∣
∣∣∣∣
Lp(W )

||∇Dhwε||L2(W )d ,

where we have used Proposition A.1. Owing to Proposition 4.4, we know that ||∇vε−∇vΩ||Lq(D)d→ 0
as ε→ 0, while, from Proposition 4.1,

∣∣∣∣∣∣∂γε∂xi ∣∣∣∣∣∣Lp(D) is bounded since ei is a tangential direction to Γ.
• The second term is controlled as:∣∣∣∣
∫
D

τh(γε − γΩ)∇DhvΩ · ∇Dhwε dx
∣∣∣∣ ≤ C||γε − γΩ||Lp(D)

∣∣∣∣
∣∣∣∣∂(∇vΩ)∂xi

∣∣∣∣
∣∣∣∣
Lq(W )d

||∇Dhwε||L2(W )d ,

where we have used the regularity theory for vΩ and the fact that ei is tangential to Γ, and where

||γε − γΩ||Lp(D)
ε→0−→ 0 (see again Proposition 4.1).

• The third term in the right-hand side of (A.10) is estimated as:∣∣∣∣
∫
D

Dh(γε − γΩ)∇vΩ · ∇Dhwε dx
∣∣∣∣ ≤ C||∇vΩ||Lq(W )

∣∣∣∣
∣∣∣∣∂γε∂xi − ∂γΩ∂xi

∣∣∣∣
∣∣∣∣
Lp(W )

||∇Dhwε||L2(W )d ,

in which
∣∣∣∣∣∣∂γε∂xi − ∂γΩ∂xi ∣∣∣∣∣∣L2(W ) ε→0−→ 0 because of Proposition 4.1.

• One has: ∣∣∣∣
∫
D

(fε − fΩ)D−hDhwε dx
∣∣∣∣ ≤ ||fε − fΩ||L2(W )||D−hDhwε||L2(W ),
≤ ||fε − fΩ||L2(W )||∇Dhwε||L2(W )d ,

where we have used (A.1), and it is easily seen, using Proposition 4.4, that ||fε − fΩ||L2(W )
ε→0−→ 0.

• Likewise, ∣∣∣∣
∫
D

Dh(hε − hΩ) · ∇Dhwε dx
∣∣∣∣ ≤

∣∣∣∣
∣∣∣∣∂hε∂xi − ∂hΩ∂xi

∣∣∣∣
∣∣∣∣
L2(W )

||∇Dhwε||L2(W )d

and using the fact that ei is a tangential direction to Γ, it comes that
∣∣∣∣∣∣∂hε∂xi − ∂hΩ∂xi ∣∣∣∣∣∣L2(W ) ε→0−→ 0.

Putting things together, using Proposition A.1, we obtain that:

∂vε
∂τ

ε→0−→ ∂vΩ
∂τ

in H1(W ).

Remark that, using Meyer’s Theorem 4.3 from the identity (A.10) together with the previous estimates for
its right-hand side shows that (A.8) actually holds in W 1,p(W ) for some p > 2.

The only thing left to prove is then (A.9), where we recall the simplifying hypothesis n = ed. Actually,
(A.8) combined with Proposition 4.1 and the above remark already prove that, for i = 1, ..., d− 1,

∂

∂xi

(
γΩ,ε

∂vε
∂xd

)
= γΩ,ε

∂2vε
∂xi∂xd

= γΩ,ε
∂

∂xd

(
∂vε
∂xi

)
ε→0−→ γΩ

∂2vΩ
∂xi∂xd

in L2(W ).

41



Hence, the only thing left to prove is that:

∂

∂xd

(
γΩ,ε

∂vε
∂xd

)
ε→0−→ ∂

∂xd

(
γΩ,ε

∂vΩ
∂xd

)
;

this last convergence is obtained by using the original equations (2.2) and (3.4), and notably the facts that:

−div(γΩ,ε∇vε) = −div(γΩ∇vΩ) = 0 on U,
together with the previous convergences in (A.8) and Proposition 4.1:

∂

∂xd

(
γΩ,ε

∂vε
∂xd

)
= −

d−1∑
i=1

∂

∂xi

(
γΩ,ε

∂vε
∂xi

)
ε→0−→ −

d−1∑
i=1

∂

∂xi

(
γΩ
∂vΩ
∂xi

)
=

∂

∂xd

(
γΩ
∂vΩ
∂xd

)
.

This completes the proof.

References

[1] M. Abramowitz and I. Stegun, Handbook of mathematical functions: with formulas, graphs, and mathematical tables,

Dover Publications, (1965).

[2] R. A. Adams and J.F. Fournier, Sobolev spaces, Academic Press, 2nd Ed., (2003).
[3] G. Allaire, Shape optimization by the homogenization method, Springer Verlag, New York (2001).

[4] G. Allaire, Conception optimale de structures, Mathématiques & Applications, 58, Springer Verlag, Heidelberg (2006).

[5] G. Allaire, E. Bonnetier, G. Francfort and F. Jouve, Shape optimization by the homogenization method, Numer.
Math., 76, (1997) pp. 27–68.

[6] G. Allaire, C. Dapogny, G. Delgado and G. Michailidis, Multi-phase optimization via a level set method, ESAIM:

Control, Optimization and Calculus of Variations, 20, 2 (2014), pp. 576–611.
[7] G. Allaire, F. Jouve and N. Van Goethem, Damage evolution in brittle materials by shape and topological sensitivity

analysis, J. Comput. Phys., 230 (2011) pp. 5010–5044.
[8] L. Ambrosio and G. Buttazzo, An optimal design problem with perimeter penalization, Calculus of Variations and Partial

Differential Equations, 69, (1993), pp. 1–55.

[9] H. Ammari and H. Kang, Polarization and Moment Tensors; With Applications to Inverse Problems and Effective
Medium Theory, Springer Applied Mathematical Sciences, 162, (2007).

[10] S.Amstutz Sensitivity analysis with respect to a local perturbation of the material property, Asympt. Anal. 49, (2006),

pp. 87–108.
[11] S.Amstutz Analysis of a level set method for topology optimization, Optimization Methods and Software, 26(4-5), (2011),

pp. 555–573.

[12] S. Amstutz, Connections between topological sensitivity analysis and material interpolation schemes in topology optimiza-
tion, Struct. Multidisc. Optim., vol. 43, (2011), pp. 755–765.

[13] S. Amstutz and H. Andrä, A new algorithm for topology optimization using a level-set method, J. Comput. Phys., 216,

(2), (2006), pp. 573–588.
[14] M. Beckers, Topology optimization using a dual method with discrete variables, Structural Optimization, 17, (1999),

pp. 14–24.
[15] M. P. Bendsøe and N. Kikuchi, Generating optimal topologies in structural design using a homogenization method,

Comput. Meth. Appl. Mech. Engrg. 71, (1988), pp. 197–224

[16] M. Bendsøe and O. Sigmund, Material interpolation schemes in topology optimization, Archive of Applied Mechanics,
69, (1999), pp. 635–654.

[17] M. Bendsøe and O. Sigmund, Topology Optimization. Theory, Methods, and Applications, Springer Verlag, New York

(2003).
[18] A. Bensoussan, J.-L. Lions and G. Papanicolau, Asymptotic analysis of periodic structures, North Holland, (1978).

[19] M. Bonnet and G. Delgado, The topological derivative in anisotropic elasticity, Q. J. Mechanics Appl. Math., 66, (4),

(2013) pp. 557–586.
[20] T. Borrvall and J. Petersson, Topology optimization of fluids in stokes flow, Int. J. Numer. Meth. Fluids, 41 (2003),

pp. 77–107.

[21] B. Bourdin, Filters in topology optimization, Int. J. Numer. Methods Eng., 50(9), (2001), pp. 2143–2158.
[22] H. Brezis, Functional Analysis, Sobolev Spaces and Partial Differential Equations, Springer (2000).

[23] T. E. Bruns and D. A. Tortorelli, Topology optimization of non-linear elastic structures and compliant mechanisms,

Comput. Methods Appl. Mech. Engrg., 190, (2001), pp. 3443–3459.
[24] D. Bucur and G. Buttazzo, Variational Methods in Shape Optimization Problems, Birkäuser (2005).
[25] J. Céa , Conception optimale ou identification de formes, calcul rapide de la dérivée directionnelle de la fonction coût,

Math. Model. Num. 20, 3 (1986), pp. 371–420.
[26] J. Céa, S. Garreau, Ph. Guillaume and M. Masmoudi, The shape and topological optimizations connection, Comput.

Methods Appl. Mech. Engrg., 188, (2000), pp. 713–726.
[27] C. Dapogny, Shape optimization, level set methods on unstructured meshes and mesh evolution, PhD Thesis of University

Pierre et Marie Curie (2013), available at: http://tel.archives-ouvertes.fr/tel-00916224.

42



[28] M.C. Delfour and J.-P. Zolesio, Shapes and Geometries: Metrics, Analysis, Differential Calculus, and Optimization,
SIAM, Philadelphia 2nd ed. (2011).

[29] A. Ern and J.-L. Guermond, Theory and Practice of Finite Elements, Springer-Verlag, New York, (2004).

[30] A. Evgrafov, Topology optimization of slightly compressible fluids, ZAMM-Journal of Applied Mathematics and Mechan-
ics/Zeitschrift für Angewandte Mathematik und Mechanik, 86, (2006), pp. 46–62.

[31] S.M. Giusti, A. Ferrer and J. Oliver, Topological sensitivity analysis in heterogeneous anisotropic elasticity problem.

Theoretical and computational aspects, Comput. Methods Appl. Mech. Engrg., 311, (2016), pp. 134–150.
[32] R.B. Haber, C.S. Jog and M.P. Bendsöe, A new approach to variable-topology shape design using a constraint on

perimeter, Structural Optimization, 11, (1996), pp. 1–12.
[33] A. Henrot and M. Pierre, Variation et optimisation de formes, une analyse géométrique, Mathématiques et Applications

48, Springer, Heidelberg, (2005).

[34] K. Ito, K. Kunisch and G. Peichl, Variational approach to shape derivatives, ESAIM Control Optim. Calc. Var., 14,
(2008), pp. 517–539.

[35] P. K. Kythe, Fundamental Solutions for partial differential operators, and applications, Birkhäuser, Boston, (1996).

[36] B. S. Lazarov and O. Sigmund, Filters in topology optimization based on Helmholtz-type differential equations, Int. J.
Numer. Meth. Engng, 86, (2011), pp. 765–781.

[37] F. Murat and J. Simon, Sur le contrôle par un domaine géométrique, Technical Report RR-76015, Laboratoire d’Analyse

Numérique (1976).
[38] F. Murat and L. Tartar, Calculus of Variations and Homogenization, in Topics in the mathematical modelling of

composite materials, Progr. NonLinear Differential Equations, Birkhäuser, (1997), pp. 139–173.

[39] L. Nirenberg, Remarks on strongly elliptic partial differential equations, Comm. Pure Appl. Math., 8, (1955), pp. 649–675.
[40] A. Novotny and J. Sokolowski, Topological derivatives in shape optimization, Springer, Heidelberg (2012).

[41] S. Osher and J. Sethian, Fronts propagating with curvature-dependent speed: algorithms based on hamilton-jacobi for-
mulations, J. Comput. Phys., 79 (1988), pp. 12–49.

[42] O. Pantz, Sensibilité de l’équation de la chaleur aux sauts de conductivité, C. R. Acad. Sci. Paris, Ser. I 341 pp.333-337

(2005).
[43] J. Petersson, Some convergence results in perimeter-controlled topology optimization, Comp. Meth. Appl. Mech. Eng.,

171, (1999), pp. 123–140.

[44] J. Petersson and O. Sigmund, Slope constrained topology optimization, Int. J. Numer. Meth. Engng, 41, (1998), pp. 1417–
1434.

[45] A. Quarteroni, Numerical Models for Differential Problems, 2nd Edition, Series MS&A, vol. 8 Springer, (2014).

[46] J. Sethian, Level set methods and fast marching methods: evolving interfaces in computational geometry, fluid mechanics,
computer vision, and materials science, Cambridge university press, 1999.

[47] O. Sigmund, On the design of compliant mechanisms using topology optimization, Mechanical Structures and Machines,

25, (1997), pp. 493–524.
[48] O. Sigmund and J. Petersson, Numerical instabilities in topology optimization: A survey on procedures dealing with

checkerboards, mesh-dependencies and local minima, Structural Optimization, 16, (1998), pp. 68-75.
[49] J. Sokolowski and J.-P. Zolesio, Introduction to Shape Optimization; Shape Sensitivity Analysis, Springer Series in

Computational Mathematics, 16, Springer, Heidelberg (1992).

[50] N. Suzuki and N. Kikuchi, A homogenization method for shape and topology optimization. Comp. Meth. Appl. Mech.
Eng., 93, (1991), pp. 291–318.

43


	caratula springer.pdf
	UPCommons
	Portal del coneixement obert de la UPC
	http://upcommons.upc.edu/e-prints
	This is a post-peer-review, pre-copy edit version of an article published in Numerische mathematik. The final authenticated version is available online at: https://doi.org/10.1007/s0021.
	Published paper:
	URL d'aquest document a UPCommons E-prints:
	https://upcommons.upc.edu/handle/2117/118037


