















































































Strain injection techniques in dynamic fracture modeling


Available online at www.sciencedirect.com

ScienceDirect

Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534
www.elsevier.com/locate/cma

Strain injection techniques in dynamic fracture modeling

O. Lloberas-Vallsa,∗, A.E. Huespea,c, J. Olivera,b, I.F. Diasd

a CIMNE – Centre Internacional de Metodes Numerics en Enginyeria, Spain
b E.T.S d’Enginyers de Camins, Canals i Ports, Technical University of Catalonia (Barcelona Tech), Campus Nord UPC, Mòdul C-1, c/ Jordi

Girona 1-3, 08034, Barcelona, Spain
c CIMEC-UNL-CONICET, Güemes 3450, Santa Fe, Argentina

d Laboratório Nacional de Engenharia Civil (LNEC), Avenida Brazil 101, 1700 Lisbon, Portugal

Received 5 February 2016; received in revised form 27 April 2016; accepted 23 May 2016
Available online 2 June 2016

Abstract

A computationally affordable modeling of dynamic fracture phenomena is performed in this study by using strain injection
techniques and Finite Elements with Embedded strong discontinuities (E-FEM). In the present research, classical strain localization
and strong discontinuity approaches are considered by injecting discontinuous strain and displacement modes in the finite element
formulation without an increase of the total number of degrees of freedom. Following the Continuum Strong Discontinuity
Approach (CSDA), stress–strain constitutive laws can be employed in the context of fracture phenomena and, therefore, the
methodology remains applicable to a wide number of continuum mechanics models. The position and orientation of the
displacement discontinuity is obtained through the solution of a crack propagation problem, i.e. the crack path field, based on
the distribution of localized strains. The combination of the above mentioned approaches is envisaged to avoid stress-locking and
directional mesh bias phenomena.

Dynamic simulations are performed increasing the loading rate up to the appearance of crack branching, and the variation in
terms of failure modes is investigated as well as the influence of the strain injection together with the crack path field algorithm.
Objectivity of the presented methodology with respect to the spatial and temporal discretization is analyzed in terms of the
dissipated energy during the fracture process. The dissipation at the onset of branching is studied for different loading rate
conditions and is linked to the experimental maximum velocity observed before branching takes place.
c⃝ 2016 The Author(s). Published by Elsevier B.V. This is an open access article under the CC BY-NC-ND license (http://

creativecommons.org/licenses/by-nc-nd/4.0/).

Keywords: Fracture dynamics; Strong discontinuity approach; Crack path field; Strain injection techniques

1. Introduction

Fracture phenomena in engineering structures are strongly influenced by the loading rate which has a clear effect
on the strength, stiffness and ductility of the material [1]. At high strain rates, inertial forces play a dominant role over

∗ Correspondence to: CIMNE – Centre Internacional de Metodes Numerics en Enginyeria, Campus Nord UPC, Mòdul C-1 101, c/ Jordi Girona
1-3, 08034, Barcelona, Spain.

E-mail address: olloberas@cimne.upc.edu (O. Lloberas-Valls).

http://dx.doi.org/10.1016/j.cma.2016.05.023
0045-7825/ c⃝ 2016 The Author(s). Published by Elsevier B.V. This is an open access article under the CC BY-NC-ND license (http://
creativecommons.org/licenses/by-nc-nd/4.0/).

http://crossmark.crossref.org/dialog/?doi=10.1016/j.cma.2016.05.023&domain=pdf
http://www.elsevier.com/locate/cma
http://dx.doi.org/10.1016/j.cma.2016.05.023
http://www.elsevier.com/locate/cma
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
mailto:olloberas@cimne.upc.edu
http://dx.doi.org/10.1016/j.cma.2016.05.023
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/
http://creativecommons.org/licenses/by-nc-nd/4.0/


500 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

possible viscous behaviors in quasi-brittle and brittle materials and lead to crack curving and branching phenomena
when a critical crack tip velocity is exceeded [2]. In order to account for the progressive increase of resistance at
high strain rates it becomes crucial to accurately simulate materials designed to perform at such extreme loading
conditions. Studies on rate dependent behavior of civil engineering materials such as concrete have been conducted
by Reinhardt [1] showing that, at loading strain rates higher than 10 s−1, the increase of structural resistance is mainly
motivated by the inertial forces.

Experimental results on different types of brittle and quasi-brittle materials report that when a critical crack tip
velocity is met, unstable crack propagation takes place and mode I fracture tends to change to mixed mode [2–5].
In general, an increase of the crack tip propagation speed is observed upon increasing loading rates until a certain
fraction of the Rayleigh wave speed in the material is met. This fraction varies upon the material but the maximum
crack tip velocity is always bounded by the Rayleigh surface wave speed. Once the critical velocity is reached, the
crack may branch and the immediate resulting velocities of the branched cracks are found lower than the original
speed although they might increase upon increasing loading rate. Indeed, there is a relation between the maximum
crack velocity and the wave velocities in the medium, since those areas ahead of the crack tip that are not yet affected
by the pressure waves cannot undergo any fracturing phenomena. Moreover, if one considers that a single crack
cannot propagate beyond a certain velocity, the corresponding dissipation is, therefore, also bounded. In such scenario
it seems reasonable that a possible mechanism to increase the dissipation rate consists of an increase of the fracture
surface which is directly connected to the branching phenomena.

Dynamic fracture phenomena is in general difficult and expensive to study through experimental setups due to its
fast occurrence and because the loading conditions are often not straightforward to reproduce in a laboratory. For
this reason, numerical algorithms are regarded as valuable tools for its simulation and design of improved materials.
Finite element methods (FEM) for solving general dynamic fracture problems show some limitations, and have not
been widely adopted in the literature. In some cases, FEM fail to predict experimental tests, and according to [6],
the capacity for adequately modeling this kind of problem through FE simulations is yet negative. Works involving
cohesive interface elements (inter-elemental enrichment) for dynamic problems have been addressed by Falk et al. [7]
and Pandolfi et al. [8]. Intra-elemental enrichments have been used in Song and Belytschko [9] and Linder and
Armero [10] to model cracks intersecting the FE mesh, among other authors. Recent advances in the phase-field
modeling led to impressive 2D and 3D results but at the cost of extremely fine FE discretizations [11–13]. A softening
visco-elastic visco-plastic damage continuum model has been employed for dynamic fracture of concrete up to
intermediate loading rates in [14,15] where the visco-plastic contribution is used to regularize the model. Erosion
or element deletion models proposed by Camacho and Ortiz [16,17] have proven to be powerful methods specially for
the modeling of fragmentation and spalling processes. Besides this, many alternative numerical methodologies have
been addressed with some success, e.g. peridynamics [18,19], discrete methodologies such as lattice models [20] and
mesh-free methodologies [21], to mention a few.

One of the main challenges when modeling these type of problems employing finite element methodologies
consists in the accurate description of the strong discontinuity arising during crack nucleation and growth. The
complex geometry concerning the dominant crack paths may involve branching and sudden changes of the crack
propagation direction. Furthermore, successful energy convergence studies are hard to find. Besides the challenge
of accurately modeling complex failure phenomena, it is the objective of the present contribution to present a
computationally affordable methodology compared to those techniques (supra-elemental techniques) that model strain
localization phenomena with an explicit discretization of the failure band with the corresponding increase of the
number of finite elements.

The present contribution focuses on the description of a finite element method developed for analyzing a specific
range of crack propagation problems in specimens undergoing rapid loading conditions with the presence of a dom-
inant crack. Brittle or quasi-brittle fracture is considered and dynamic fracture problems involving fragmentation or
spalling are left outside the scope of our study. The concept of embedded discontinuities (cf. [22,23]), utilized for the
study of fracture in quasi-brittle materials and successfully applied to the study of tensile crack growth in gravity dams
(cf. [24,25]), is regarded as the starting point for the technique presented in this contribution. Particularly, the formu-
lation developed by Oliver et al. [26] and assessed for quasi-static multiscale fracture problems, is adopted together
with an injection procedure which is specifically tailored for dynamic fracture propagation problems. Cracks, repre-
sented by strong discontinuities embedded into the finite elements, may intersect the mesh in arbitrary directions and,
therefore, relatively coarse meshes can be employed which positively impacts the computational cost of the analyses.



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 501

Numerical tests have been performed to analyze the convergence of the developed technique with respect to the
adopted implicit integration time step and finite element size. As mentioned in [27], finite element solutions of
dynamic fracture problems using cohesive interface element approaches, provide an increasing energy dissipation
upon mesh refinement. Objective results in terms of the dissipation energy are provided for different time and space
discretizations in our numerical analyses. Mesh sensitivity in terms of the crack propagation direction and crack tip
velocity have been studied for unstructured and structured meshes with a predefined alignment. Crack tip velocities
are reported in our numerical experiments for different imposed loading rates and a correlation between the critical
crack tip velocity at the onset of branching is found with respect to the corresponding maximum dissipation for one
single crack.

2. Model description

The following Sections 2.1–2.3 aim at introducing the Strong Discontinuity kinematics to the reader that is
unfamiliar with this technique. Sections 2.4–2.8 contain the main novel contributions of the approach when applied to
dynamic simulations with complex fracture patterns. Due to the large amount of technical details required to render
the manuscript self-contained, the FE implementation, specific derivations and details on the constitutive model are
included in Appendices A–C.

2.1. Governing equations of the IBVP

The Initial Boundary Value Problem (IBVP) of a solid undergoing crack propagation phenomena is considered at
time t ∈ [0, T ]. The body domain is B ∈ Rndim , ndim being the space dimension, with boundary ∂B as shown in
Fig. 1. A cohesive propagating crack is represented by the surface S , across which, the displacement field is assumed
discontinuous, i.e. strong discontinuity kinematics is considered in B and its evolution, due to dynamic loading and
inertial effects, is the key aspect of the present computational mechanical model.

Displacement, strain and stress fields are denoted as u (with u(x, t) ∈ Rndim × [0, T ]), ε (with ε(x, t) ∈
Sndim×ndim × [0, T ]) and σ (with σ (x, t) ∈ Sndim×ndim × [0, T ]), respectively, where Sndim×ndim designates the space of
symmetric second order tensors.

Prescribed displacements u∗ are considered at the boundary ∂Bu and prescribed tractions t∗ are imposed at the
boundary ∂Bt, with ∂B = ∂Bu ∪ ∂Bt and ∂Bu ∩ ∂Bt = ∅. Tractions acting on the discontinuity S are considered as
well. Initial velocity conditions are denoted by u̇0(x) in B and initial displacement condition are assumed to be zero.

The governing equations of the dynamic fracture IBVP at B can be written as follows: find u, ε and σ , satisfying:

∇ · σ + b = ρü; ∀x ∈ B\S; t ∈ [0, T ]; Momentum equation (1)
ε = ∇

su; ∀x ∈ B\S; t ∈ [0, T ]; Compatibility equation (2)
σ = Σ (ε, r); ∀x ∈ B; t ∈ [0, T ]; Constitutive equation (3)
u = u∗(x, t); ∀x ∈ ∂Bu; t ∈ [0, T ]; Displacement boundary condition (4)
σ · n = t∗(x, t); ∀x ∈ ∂Bt; t ∈ [0, T ]; Traction boundary condition (5)
u(x, 0) = 0; ∀x ∈ B; Initial displacement condition (6)
u̇(x, 0) = u̇0(x); ∀x ∈ B; Initial velocity condition (7)
σ

+
· n = σ S · n = σ

−
· n; ∀xS ∈ S; t ∈ [τ, T ]; Traction continuity across S (8)

where b, ρ, Σ denote the volumetric forces, the density and the constitutive relation (generically depending on the
strains and internal variables indicated by r ), respectively. In the last Eq. (8), τ is the instant when the discontinuity
surface S is introduced at the point xS of the body B. In the present approach, σ S denotes the stress observed
at an interface point of S , while σ+ and σ− correspond to the stresses at each side of this interface. The disjoint
domains of B generated by S are denoted B+ and B− in Fig. 1. It is emphasized that, following the Continuum Strong
Discontinuity Approach (CSDA) in [28] and [29], the stresses σ S , defining the cohesive tractions acting on S , are
determined through the same, though regularized, constitutive model Σ which provides the constitutive response of
the bulk material.



502 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 1. (a) Solid with evolving crack. (b) Domain BM surrounding the discontinuity S .

2.2. Variational formulation

The governing equations of the problem (1)–(8), characterized by a strong discontinuity kinematics, can be written
in a variational format by introducing the description presented in [30] and by Oliver et al. [29]. According to these
works, the displacement field u(x, t) is defined as the addition of two terms:

u(x, t) = ū(x, t) + MS (x)[[u]](t). (9)

The first term, ū, represents a smooth part of the displacement field and the second one describes the displacement
jump across the surface S , [[u]] being the vector accounting for the displacement jump intensity. The scalar unit jump
function MS is:

MS = HS − ϕ; (10)

with HS being the Heaviside function shifted to S and the auxiliary function ϕ defined as follows:

HS (x) =


0 ∀x ∈ B−
1 ∀x ∈ B+; ϕ(x) =




0 ∀x ∈ (B\BM)−
1 ∀x ∈ (B\BM)+
continuous in B otherwise.

(11)

The domain BM, across which the function ϕ varies smoothly from 0 to 1, is a small region surrounding S , see
Fig. 1(b). The generalized strains, compatible with (9), can be defined as

ε = ∇
sū + (δS n − ∇

s
ϕ) ⊗

s
[[u]] (12)

where δS (x) is the Delta function shifted to S and n is the unit normal vector to S pointing towards B+.
By considering the strong discontinuity kinematics defined in (9), the spaces of kinematically admissible

displacements, Vu, and admissible displacement variations, V̂u, are defined as:

Vu =


u(x, t) = ū + MS [[u]]
 ū(x, t) = u∗(x, t), for x ∈ ∂Bu; u̇(x, 0) = u̇0(x), for x ∈ B; (13)

V̂u =

η(x) = η̄ + MS [[η]]

 η̄(x) = 0, for x ∈ ∂Bu. (14)
According to [30], the variational equation

B
σ : ∇

s
ηd B +


B
(b − ρü) · η d B +


∂Bt

t∗ · η dΓ = 0; ∀ η ∈ V̂u (15)

yields the strong form of the IVBP given by (1)–(8).

2.3. Finite element model

An Embedded Finite Element technique (EFEM), based on a mixed three-field Petrov–Galerkin formulation closely
related to the variational problem (15), has been presented in [23] and [26].

The EFEM technique in [26] has been utilized to solve quasi-static multiscale fracture problems. In this
contribution, the technique is tailored for modeling monoscale dynamic fracture problems.



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 503

Fig. 2. Subdomain categories of the discrete body along different times (t1, t2 and t3) of the analysis.

Let us consider the body domain B discretized by a finite element mesh denoted by Bh1 as shown in Fig. 2. It is
assumed that the strain localization process is taking place on the surface S . In the finite element model, this surface
is k-regularized in the sense that S is represented by a band of finite thickness k across which the displacements are
assumed to be continuous. The technology developed in [26] uses three different types of kinematics and interpolated
fields in disjoint parts of B, determining three different finite element approaches. These finite elements are here
identified as (see additional details in Appendix A):

1. Standard finite elements with continuous displacement.
2. Finite elements with weak discontinuity injection (Constant Stress-Discontinuous Strain Mode CS-DSM).
3. Finite elements with strong discontinuity injection (Discontinuous Displacement Mode DDM).

Approaches 2 and 3 use the strain injection concept by adding the CS-DSM and DDM strain modes to the
underlying standard finite element formulation. The so-injected strain modes can be categorized as assumed enhanced
strain models, within the framework developed in [31].

The three types of finite element approaches are used in different partitions, or subdomains of B, with the objective
of accommodating different kinematic descriptions during the structural loading process. With the evolution of
fracture, these partitions allow changes to the strain field according to the material degradation stage detected at
each point of B. Such changes are performed in a non-intrusive fashion in the computational code.

In the following sub-section, the criteria to divide B in subdomains, as well as the finite element and kinematics
approach assigned to every partition, are defined.

2.4. Partitions of B in subdomains with different kinematic descriptions

The finite element mesh is partitioned in two disjoint subdomains: Bstd(t) and Binj(t) (B = Bstd(t) ∪ Binj(t)). It is
stressed that both Bstd(t) and Binj(t) change with time as the modeling evolves2 (cf. Fig. 2). The partitions of B define
three types of domains which can be identified as follows:

1. The domain Bstd is modeled with finite elements using a standard approach with continuous displacements. The
subdomain Binj is modeled with finite elements equipped with strain injections, including CS-DSM and DDM
modes. Thus, Binj is called the strain injection domain and is composed by all points satisfying the criteria defined
in next paragraphs. Binj is additionally partitioned into two disjoint subdomains: Bwd and Bsd (Binj = Bwd ∪ Bsd).

2. The domain Bwd collects the finite elements where a weak discontinuity is considered in the kinematics. Thus,
finite elements in Bwd are equipped with the constant stress-discontinuous strain mode (CS-DSM).

3. The domain Bsd refer to those partitions in which a strong discontinuity is considered in the kinematics. Finite
elements in Bsd are equipped with the discontinuous displacement mode (DDM).

1 In the remaining of the text, the superscript h associated to an h-sized finite element discretization is dropped in order to avoid a dense notation.
2 In order to avoid a dense notation the time dependence of such domains is not explicitly written in the remaining part of the text unless is

strictly necessary.



504 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Partitioning criteria can be defined by considering the damage constitutive relation described in Appendix B and
summarized in Box I. The equivalent strain τε can be rewritten as follows:

τε(ε) =


σ̄+ : ε =


(C : ε)+ : ε (16)

where the positive part of the second order tensor (C : ε)+ (cf. Appendix B) is considered to account for an only
tension yield surface. From the last expression in (16), τε has the meaning of an equivalent positive strain counterpart
(only tensile stress states contribute to the strain norm).

The following criteria are used to partitioning B into the three subdomains. At the beginning of the analysis, t = 0,
all points in B belong to Bstd (B = Bstd). Upon increasing load, and considering the equivalent strain, τε, the subdomain
Binj is defined through:

Binj =


x ∈ B
 αinjr(x, t) ≤ τε(x, t) ≤ r(x, t) (17)

where r is the strain-like internal variable of the damage model which records the maximum historical value at time t
of the strain norm τε, and is defined by:

r(x, t) = max(r0, τε(x, χ)); χ ∈ [0, t]. (18)

The parameter αinj in (17) (with 0 < αinj ≤ 1) determines the interval width [αinjr, r ] of τϵ in which the injected
strains are introduced in the FE model. In this manner, all material points having τϵ within this interval will belong to
Binj. Fig. 3 sketches the criterion in (17). According to this criterion, it is emphasized that points originally in Binj can
return back to belong to the subdomain Bstd.

Furthermore, the domain Bsd is constituted by points x satisfying the following four conditions:
1.

x ∈ Binj. (19)
2.

t ≥ tB(x), (20)

where tB denotes the bifurcation time for the point x and corresponds to the instant when the singularity of the
acoustic tensor, Q, is verified:

det(Q(x, tB)) = 0; Q(x, t, n) = n(x) · C
d
(x, t) · n(x), (21)

Cd(t) being the tangent constitutive tensor of the damage model defined in [32]. Eq. (21) is satisfied when the
material point loses the strong ellipticity condition.

3.

gDS ≥ λsd Gf, g
D

S (xS , t) =
 χ=t

0
Dsd(xS , χ) dχ, (22)

where gDS , Gf and Dsd refer to the accumulated dissipated energy per unit of surface (with dimensions [J/m
2
]), the

material fracture energy (with dimensions [J/m2]) and the dissipation per unit of surface at the cohesive surface
S (with dimensions 2 [J/m2/s]), respectively. Note that λsd ≤ 1 and is assumed as a user-defined numerical
parameter. A detailed explanation of the energetic interpretation in (22), as well as the role played by λsd, are given
in Appendix B (cf. (B.20) in this appendix).

4. Additional kinematic constraints which are specified in sub-Section 2.6 (cf. Fig. 5).

From the above criteria, the subdomain Bwd is constituted by points satisfying the condition (17), but not all the
conditions 1–4. Conversely, the subdomain Bsd is constituted by points satisfying all conditions 1–4.

2.5. Crack Path Field tracking algorithm

An accurate determination of the crack propagation direction is a key issue to correctly inject a strong discontinuity
kinematics into the finite element model. The finite element formulation with discontinuous strain injection (DDM in



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 505

Fig. 3. Strain-based threshold (dark area between dashed thick lines) for injected domains. All points below the injection region belong to standard
domains. The lower bound of the injection region is computed as a fraction (αinj) of the current rt value and, therefore, the width of the injection
threshold increases upon increasing values of rt .

Fig. 4. Crack Path Field (CPF) strategy for the crack tracking algorithm. Γ denotes the crack path set. (a) Localized field r around a strong
discontinuity band. (b) Associated scalar displacement field ũ. (c) Γ (zero-level set of the crack path field function µ̃) and the trace of the strong
discontinuity S .

Bsd) is based on the knowledge of the crack path geometry as explained in more detail in Appendix A. The auxiliary
function ϕe in Eq. (A.10) is defined once the intersections between S and the finite element boundaries are known. In
addition, the normal vector n to S (cf. Eq. (A.14)) must be defined in order to determine the direction along which the
tractions are continuous.

The Crack Path Field (CPF) tracking algorithm originally introduced by Oliver et al. [23] is employed in this study
to retrieve the trace of S . Some additional issues, detailed in this section, need to be considered in order to adapt this
concept to the context of dynamic crack propagation with complex failure phenomena such as crack branching. The
methodology essentially consists in computing the crack path set Γ at time t formed by those points x in B which
constitute a directional maximum of a conveniently chosen localizing field r . Upon fracture, r becomes singular due
to the singular character of the strains in S . However, in the regularized model, the variable r displays a peak value of
O(1/k) since a finite band of thickness k simulates the crack at S (cf. Fig. 4). Even when this variable does not show
a singular character in the remaining parts of B, the maximum values of the r -field are utilized in the CPF strategy to
predict the direction of S .

An additional issue utilized in the CPF strategy consists in identifying the normal ê to the crack path set Γ
computed in terms of the characteristic displacement field observed in problems undergoing strong strain localization
processes. Fig. 4(b) shows the expected distribution of a well-selected smooth scalar field ũ which is a function of
the displacement field around a regularized strong discontinuity. At the domain Bsd, displacements ũ display a jump
across the bandwidth corresponding to the localized strain band S . Therefore, ũ may display a very large gradient



506 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

orthogonal to S . From this consideration, the vector field

ê(x, t) =
∇ũ(x, t)
∥∇ũ∥

(23)

and can be taken as an acceptable extension of n in S to all points of B. Possible scalar fields ũ, utilized in the 2D
numerical examples, are:

ũ(x, t) = ux(x, t) + uy(x, t), or (24)

ũ(x, t) = ux(x, t)uy(x, t), (25)

where the notation ux and uy refer to the Cartesian components of u. The choice for the selection of ũ(x, t) is
conveniently indicated at each example.

The directional maximum of r identifying the crack path set Γ can be evaluated by calculating the zero-level set
of the so called crack path field µ(x, t), defined as:

µ(x, t) =
∂ r̃

∂e
= ∇r̃ · ê (26)

where r̃ is a sufficiently smooth field of r . The zero-level set of µ defines the crack path set Γ as

Γ (t) :=


x
 µ(x, t) = ∂ r̃

∂e
= 0


. (27)

The solution of the problem in (27) contains the trace of the strong discontinuity S as shown in Fig. 4(c). A crack
path tracking algorithm based on similar ideas has been presented by Feld-Payet et al. [33], although the normal
derivative in (23) has not been considered by these authors.

Remark 2.1. Since the crack path field is calculated as a directional derivative of the localizing strain field r , this
derivative will be zero at those areas where r = r0, i.e. r being spatially constant. This will be the case at those
regions which do not undergo any non-linear behavior as described in or model (cf. (17) and (18)).

In order to get a robust finite element implementation, the injection of a weak discontinuity kinematics at a region
Bwd is of utmost importance since the use of sub-integrated elements with constant stress-discontinuous strain mode
(CS-DSM) increases the mesh flexibility at this specific region and makes more evident the localized distribution of r
ahead of the crack tip. As shown in [23] this strategy facilitates the computation of the propagation direction specially
in those cases in which crack propagation may be biased by mesh alignment or structured discretizations.

In the remaining of this manuscript, the injection of the strong discontinuity is performed such that the normal to
the injected discontinuity in (A.14) coincides with the normal n to the crack path set Γ as indicated in Fig. 4. It should
be stressed that the calculation of the crack path field is performed as a post processing stage after the loading step is
converged, i.e. in a staggered fashion, as shown in Oliver et al. [23].

2.6. Kinematic compatibility for complex fracture phenomena: crack branching

This section introduces the proposed procedure to model crack branching and crack intersection regions. The
procedure benefits from the fact that, in contrast with the strong discontinuity kinematics (which is clearly directional),
the weak discontinuity kinematics is completely non-directional and, therefore, capable of tackling strain localization
regardless of its propagation direction.

In the general two-dimensional case the crack path set, Γ , can intersect a finite element in an arbitrary manner
leading to two or more intersections NCP with the element boundaries (cf. Fig. 5(a)). In fact, according to
Eqs. (19)–(21), only those elements belonging to Binj that have reached bifurcation t > tB and have dissipated
an amount of energy per unit of surface gDS , which is greater than a certain fraction of the available fracture energy
λsdGf, will be eligible to be injected with the strong discontinuity.

Therefore, the necessary and sufficient conditions that need to be fulfilled at the barycenter of an element Be in
order to be injected with the strong discontinuity kinematics can be identified as:

Be ⊂ Binj
 gDS ≥ λsdGf; t > tB; NCP = 2. (28)



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 507

Fig. 5. Kinematic compatibility for the DDM injection in a two-dimensional setting. (a) Strong discontinuity injection at a Finite Element with
NCP = 2. (b) Kinematic incompatibilities and their resolution during the strong discontinuity injection. (c) Automatic capturing of complex fracture
phenomena such as crack intersection and crack branching.

However, situations may be encountered in which the strong discontinuity kinematics is not compatible with the
kinematic representations at adjacent elements. Two representative incompatibilities and their remedies are illustrated
in Fig. 5(b) (scenarios b.1 and b.2). A first scenario, i.e. b.1, occurs at an element (A), amenable to be injected
with a strong discontinuity, and sharing an edge with a standard kinematics element (B), when the common edge
is intersected by the crack path set Γ . Such situations might be encountered at elements in front of the crack tip
when the crack is propagating rapidly and the passage from the linear to a non-linear bifurcated regime occurs almost
immediately. In such a scenario, stress locking phenomena may be observed since the element in front of the crack tip
would not be sufficiently flexible to capture the appropriate deformation field. Locking is avoided by automatically
downgrading the strong discontinuity injection of the potentially incompatible element (A) into a weak discontinuity



508 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

kinematics (with a CS-DSM strain injection mode). Another kinematic incompatibility scenario (Fig. 5(b) (b.2)) may
arise at elements (A), amenable to be injected with the strong discontinuity kinematics, sharing an edge with elements
(B) equipped with weak discontinuity kinematics that may be bifurcated (t > tB) and experience non-linear loading
(g(ε, rt) = 0). Since the common edge between (A) and (B) is not intersected by the crack path set Γ , the enhanced
deformation of the weak discontinuity element (B), amenable to carry a non-directional discontinuity, may not be
compatible with the displacement field interpolation of element (A) at that common edge, which has no discontinuous
kinematics. The remedy consists in downgrading the strong discontinuity injection (DDM) into a weak discontinuity
injection (CS-DSM) at element (A).

The algorithm for the strong discontinuity compatibility essentially loops over the elements affected by the strong
discontinuity injection and performs a check over all neighbors, i.e. boundary elements with a common edge. These
searches can be made without compromising the efficiency of the implementation by pre-calculating in beforehand a
neighbor element connectivity table.

Notice, that the strong discontinuity injection strategy, sketched in Fig. 5(a) complemented by the kinematic
incompatibility resolution, depicted in Fig. 5(b), automatically accounts for complex fracture situations, e.g. crack
intersection and crack branching. These situations are outlined in Fig. 5(c) (scenarios c.1 and c.2). The crack path set
Γ will separate regions with positive or negative values of the crack path µ. In fact, the finite element approximation
unfolds the theoretical intersecting (or branching) paths into two independent traces. In both cases, the above strategies
automatically set the status of the elements (C), at the intersection/branching region, to weak-discontinuity injection,
this solving the possible kinematical incompatibilities.

2.7. Implicit time integration

As mentioned in Section 2.3, the weak variational form generically presented in Eq. (15) is discretized using Finite
Element techniques accounting for the different outlined kinematics (cf. Appendix A), e.g. standard in Bstd, CS-DSM
in Bwd (governed by the weak variational form (A.7)–(A.8)) and DDM in Bsd (governed by the weak variational form
(A.18)–(A.20)).

From the total degrees of freedom involved in the finite element formulation, the enhanced degrees of freedom
(ξ̄

e
and γ̄ e in (A.7)–(A.8), or ξ̄

e
and [[u ]]e in (A.18)–(A.20)) are condensed out at the element level and, therefore,

the unknowns in the discrete model consist on the vector of displacements u and accelerations ü corresponding to the
degrees of freedom of the smooth displacement field. Since the enhanced degrees of freedom do not have an associated
mass, their condensation is performed as done in quasi-static problems.

The resulting global system of equations in terms of u for each time step can be written as follows:

Mü(t) + Fint(u(t)) − Fext(t) = 0, (29)

where M and Fext represent the mass matrix and external force vector, without the inertial forces, respectively. The
mass matrix is computed in a standard way and is only associated to the degrees of freedom of the smooth displacement
field. The element contribution to the consistent mass matrix is

Me =


Be
ρNTN d B, (30)

N and Be being the element shape functions and the element domain, respectively. A lumped mass contribution to
the nodes is considered in the present implementation. All elements in B contribute to the global mass matrix M,
i.e. Be ⊂ {Bstd ∪ Bwd ∪ Bsd}. In (29), Fint is the internal force vector resulting from the evaluation of the first term, on
the l.h.s., of (15), (A.7) or (A.18) depending on the evaluation domain.

The solution of (29) at time step t +1 is found by means of a standard implicit time integration (Newmark) scheme.
Using this scheme and a time increment ∆t , displacements and velocities at time t + 1 are approached by

ut+1 = ut + ∆t u̇t + ∆t2

(0.5 − β) üt


+ ∆t2βüt+1, (31)

u̇t+1 = u̇t + ∆t (1 − γ ) üt + ∆t γ üt+1, (32)

where supra-indices refer to the time step at which the vectors are evaluated and β and γ are coefficients affecting
the nature of the integration scheme. By setting β = 0.25 and γ = 0.5 the trapezoidal rule is recovered which



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 509

constitutes a non-dissipative second order accurate scheme. In our computations the values for β and γ are set to
0.5 and 1, respectively. This had a positive impact in the robustness of the overall methodology in the sense that the
switching among different element kinematics was performed according to the overall stress and strain distributions
and not perturbed by fluctuations due to the passage of waves. The impact of this choice on the overall dissipation is
conveniently outlined in the presented examples.

Expressions (31) and (32) are replaced in (29) leading to

R(ut+1) = 0. (33)

Evaluation of the residual force vector, R, requires specific spatial integration rules in domains Bt+1std , B
t+1
wd and

Bt+1sd , involving different quadrature points within a given finite element. Since the integration domains vary in time,
as well as the spatial integration rules, the residual force vector has to be evaluated in an incremental way as follows:

R(ut+1) = R(ut ) + ∆R

∆ut+1, Btstd, B

t
wd, B

t
sd


. (34)

Note that the dependence of the residual force increment ∆R at time t + 1 with the integration rules related to each
domain has been explicited in (34). The supra-index t in the domain notations indicates the time step at which the
domains are fixed to evaluate the spatial integration.

Following the work by Oliver et al. [23], Eq. (34) can be alternatively evaluated rephrasing the integration rules.
By redefining the stresses, which take place in the internal force expressions, only one quadrature rule suffices for
evaluating R(ut+1) in the complete domain B. Typically, the chosen integration rule can be taken as the standard one
for bilinear quadrilaterals consisting on the four Gauss Points quadrature rule. In this strategy, the stresses are replaced
by the so-called “effective stresses” in the four Gauss Points and a convenient updating procedure for them is defined.
Therefore, the dependence of ∆R with the integration rules is removed, this allowing the evaluation of the residual
force vector in expression (33) using total effective stresses (at time step t + 1).

For details of the effective stress definition and their updating scheme the reader is referred to the work in [23].

2.8. Global monitoring of the total dissipated energy

In our analyses, the total dissipated energy of the body is monitored in order to assess the performance of the differ-
ent formulations for the simulation of the fracture process. The total dissipated energy W D at time t is calculated as:

W D(t) =


B
w

D
(t) d B =

 t
0

Pext(t) dt − Ψ(t) − K(t), (35)

where Pext(t) denotes the external mechanical power, performed by the external loads excluding the inertial forces,
Ψ(t) the total internal energy and K(t) the kinetic energy, at time t .

Each term is further identified by

Pext(t) =


∂Bt
t∗ · u̇ dΓ +


∂Bu

tu · u̇
∗ dΓ +


B

b · u̇ d B, (36)

Ψ(t) =


B
ϕ(t) d B =


B

1
2

(1 − d)ϵ : C  
σ (ϵ)

: ϵ d B =
1
2


B

σ (ϵ) : ϵ d B, (37)

K(t) =
1
2


B

ρu̇ · u̇ d B (38)

where, ϕ(t) is the internal energy density given in expression (B.1) in Box I and d corresponds to a scalar damage
variable with values in the range 0 to 1 for an intact to a fully damaged material. The second and third identities in (37)
are only valid for the Damage model described in Appendix B. The reactions tu at ∂Bu are determined according to
the momentum balance equation.

For the present finite element technique, it is more convenient, and less intrusive, to evaluate the free energy Ψ(t)
in Eq. (37) in terms of nodal displacements, velocities and accelerations, and in terms of tractions at the boundary,



510 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Table 1
Material parameters for the tension test.

σu [N/mm
2
] E [N/mm2] ν Gf [N/mm]

2.0 × 10−3 100.0 × 10−3 0.0 0.1

disregarding stresses and strains in the quadrature points of the finite element mesh. In this spirit, the total internal
energy Ψ(t) in (37) can be calculated through the identity:

2Ψ =


B
σ (ϵ) : ϵ d B =


B

σ (ϵ) : ∇
su d B

=


∂Bt

t∗ · u dΓ +


B
b · u d B −


B

ρü · u d B  
We(u,b,ü,t∗)

+


∂Bu

tu · u
∗ dΓ , (39)

where We(u, b, ü, t∗) refers to the external power. Details concerning the derivation of the identity in (39) are given
in Appendix C.

In order to ensure a correct computation of the total dissipated energy W D(t), the global quantities,
i.e. displacements, velocities, accelerations and forces, appearing in all terms in (B.13) are evaluated at time t + 0.5
in the corresponding numerical integration. Note that the computation of the total dissipation, as a global entropy
imbalance, allows us to monitor the possible numerical dissipation of the integration scheme detailed in Section 2.7.

The dissipation at time t

D(t) =


B
ddis(x, t) d B, (40)

with ddis(x, t) being the dissipation density (see Eq. (B.10)). This dissipation is utilized in the numerical analyses to
identify the appearance of branching phenomena.

3. Representative simulations

The following examples illustrate the performance of the crack path field and strain injection techniques in
dynamic simulations with different loading rates and material brittleness. Since the FE technology adopted in this
work, and previously introduced in [26] for two scale analyses, has not been sufficiently validated against previous
strain injection implementations [23], the first two analyses provide such validation and a justification of the adopted
techniques in challenging crack propagation scenarios with known reference solutions. Plane strain conditions are
assumed in all two-dimensional examples.

3.1. Validation of the strain injection implementation against reference solutions

Quasi-static fracture simulations using the strain injection concepts have been extensively studied in [23,22] but
the element technology utilized in this work is regarded more general since it can be used in multiscale applications
as well (cf. [26]). For this reason, a validation of its performance in single scale quasi-static analysis is presented,
comparing the results against the element technology presented in [23,22].

3.1.1. Tension test
The performance of the strain injection technique (including weak and strong discontinuities) is assessed when

utilizing the CS-DSM to model weak discontinuities in the displacement field. To this end, a homogeneous strip
undergoing uniaxial tension is considered as depicted in Fig. 6. The damage model presented in Appendix B is
utilized considering a linear softening law. All material parameters are reported in Table 1 and the numerical results
are compared to the theoretical solution consisting in a vertical fracture opening in mode I. A structured FE mesh
is considered at the region around the imperfection where the fracture starts to grow in order to induce an inclined
direction of propagation following the main orientation of the mesh.



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 511

Fig. 6. Tension test geometry and boundary conditions.

Fig. 7. Load–displacement curves for the homogeneous tension test.

The injection of the weak discontinuity (CS-DSM) is performed considering αinj = 0.95 and the strong
discontinuity is injected adopting λsd = 0.01. Initiation of crack growth at the lower middle part of the specimen
is triggered by weakening the elastic properties at this region.

The force–displacement curves shown in Fig. 7 refer to three different solution strategies:

1. The standard or irreducible formulation corresponds to no strain injection during the complete fracture process
and, therefore, the domain B is constituted solely by the standard formulation domains Bstd during the complete
test.

2. The CS-DSM injection corresponds to the injection up to the weak discontinuity. Therefore, the domain B consists
in the union of Bstd, with standard formulation, and Bwd, with weak discontinuity injection explained in (17). The
strong discontinuity injection is, therefore, blocked.

3. The DDM injection corresponds to the full model explained in this paper. In this sense, the domain B consists in
the union of Bstd, Bwd and Bsd fulfilling the injection conditions explained in (17)–(20).

The legends “DDM reference” and “DDM current” in Fig. 7 correspond to the DDM injection considering
the previous and current element formulations appearing in [22] and [26], respectively. The formulation in [22]
is slightly different from the formulation in [26] which is the one here adopted. Results reveal that the current
strong discontinuity approach matches almost exactly the reference results (DDM reference) reported in [22]. The
constant stress-discontinuous strain (CS-DSM) and standard formulations provide a behavior depicting a larger energy
dissipation due to stress locking effects. Besides that, the CS-DSM solution is found more ductile than the one obtained
using the standard formulation. This result has already been reported in [22] when comparing the standard and CSM
formulations for the damage model within the same tension test. This tendency is not detected in all cases but evidences
the need of introducing strong discontinuity kinematics in order to avoid stress locking effects.

Fracture propagation is studied by analyzing the iso-displacement contour lines (cf. Fig. 8). The benefits of the CS-
DSM and DDM injections are clear since no mesh bias dependence is observed in contrast with the results concerning
the standard approach. Note that zero level set of the crack path field µ reflects a vertical propagation. It is concluded
that the new FE technology (CS-DSM in combination with DDM injection) is regarded more general in terms of



512 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 8. Iso-displacement contour lines for the three formulations and injection pattern.

Fig. 9. Geometry and boundary conditions for the quasi-static CT test.

applicability but equivalent to the previous one concerning its performance in monolithic approaches or single scale
approaches. In fact, the previous element (denoted CSM in [23]) can be regarded as a particular case of the current
one (CS-DSM) for monoscale analysis.

3.1.2. Compact tension test
The compact tension (CT) test depicted in Fig. 9 is reproduced using the three formulations employing a structured

mesh with a predefined mesh alignment. The damage model described in Appendix B is employed with a linear
softening law and an only tension failure criterion. Material parameters are shown in Table 2. The injection of the
weak discontinuity (CS-DSM) is performed considering αinj = 0.4 and the strong discontinuity is injected according
to λsd = 0.015.

Fig. 10 clearly shows that the standard formulation does not overcome mesh bias effects which deviate the damage
distribution from the vertical crack. Both weak and strong discontinuity formulations contribute to a vertical crack



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 513

Table 2
Material parameters for the quasi-static compact tension (CT) test.

σu [N/mm
2
] E [N/mm2] ν Gf [N/mm]

3.5 30.0 × 103 0.18 0.09

Fig. 10. Damage contours and injection patterns for the quasi-static CT test. Solutions obtained with the three different formulations.

propagation due to the problem symmetry. Force–displacement and accumulated dissipation versus pseudo-time step
plots are shown in Fig. 11 for the three formulations. The total dissipated energy of a perfectly brittle material is
computed as the product of the fracture length (150 mm) times the fracture energy (0.09 N/mm), considering a width
of 1 mm, and is shown in Fig. 11 as the reference energy dissipation. Note that the DDM injection provides the most
brittle response (closest to the reference one) which involves the minimum external work for complete degradation.
This is due to the fact that the injection of displacement discontinuities reduces stress locking effects allowing for a
complete material unloading at both sides of the crack. Although the weak discontinuity injection is able to capture
the right propagation path, the energy dissipation is similar to the standard formulation case since it is not able to
overcome stress locking. It is, therefore, evident that the DDM injection plays a crucial role in quasi-static analysis
of quasi-brittle phenomena in terms of propagation and minimization of stress locking effects.



514 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 11. Structural responses (left) and dissipated energy (right) for the three formulations. A thickness of 1 mm is considered for the energy plots.

Table 3
Material parameters and wave velocities for the dynamic compact tension (CT) test.

σu [N/mm
2
] E [N/mm2] ν Gf [N/mm] ρ [Kg/m

3
] vR [mm/s] cd [mm/s] cs [mm/s]

3.5 30.0 × 103 0.18 0.09 2400 2100 × 103 3839.1 × 103 2301.4 × 103

3.2. Dynamic simulations of quasi-brittle fracture

In this section, dynamic fracture simulations are performed considering a quasi-brittle material such as concrete.
The influence of the loading regime is studied and the performance of the three formulations described at the beginning
of Section 3.1.1 and detailed in Section 2.3 is assessed. The algorithms are validated through spatial and temporal
sensitivity analysis in terms of the failure pattern and energy dissipation. Crack tip velocities and dissipation values
are reported at the onset of crack branching phenomena.

3.2.1. Dynamic fracture at different loading rates
The compact tension test described in Section 3.1.2 is adapted for the dynamic fracture study under different

loading rates. The geometry and dimensions are identical to the ones shown in Fig. 9 and the new boundary conditions
are described in Fig. 12. Note that the upper part of the specimen is kept elastic to prevent damage nucleation at high
loading rates at the vicinity of the wall where the pressure rate ṗ is applied. All material parameters and wave speeds
concerning the concrete specimen are summarized in Table 3. The Rayleigh wave speed vR for a concrete material is
approximately equal to 2100 m/s, as argued in [34]. The dilatational cd and shear cs wave speeds are calculated as

cd =


E(1 − ν)

ρ(1 + ν)(1 − 2ν)

1/2
(41)

cs =


E

2ρ(1 + ν)

1/2
. (42)

Table 4 summarizes the parameters concerning the spatial and temporal resolution for the analyses performed in
this section. We consider a characteristic length of the material given by:

lc =
EGf
σ 2u

(43)

and the Courant number [35] for a finite element mesh with size le:

C =
cd∆t

le
(44)



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 515

Fig. 12. Geometry and boundary conditions for the dynamic CT test.

Table 4
Courant numbers C , material’s characteristic length lc and lc/ le ratio for different spatial and temporal resolutions
utilized in the dynamic CT test.

Temporal resolution (∆t [s]) Spatial resolution (le [mm])
Coarse Medium Fine
5.0 3.0 2.0

Coarse 10−6 C = 0.768 C = 1.280 C = 1.920
Medium 5.0 × 10−7 – C = 0.640 –
Fine 5.0 × 10−8 – C = 0.064 –

Material characteristic length (lc [mm]) 227.8

lc/ le 45.558 75.930 113.894

where ∆t stands for the time-step discretization used in the time integration procedure. The injection of the weak
discontinuity (CS-DSM) is performed considering αinj = 0.95 and the strong discontinuity injection parameter
λsd = 0.15.

Different injection patterns are obtained when increasing the loading rate (cf. Fig. 13). Results concern the medium
spatial discretization and coarse temporal discretization. Note that, upon increasing loading rate, the failure pattern
changes from a vertical mode-I crack to mixed mode with multiple cracks. The number of branched cracks increases
with higher loading rates. Similar failure patterns have been reported in Ožbolt et al. [34] for a comparable test
employing prescribed velocities instead of pressure rates. Note that the methodology based on injection techniques in
combination with the Crack Path Field (CPF) tracking algorithm is able to automatically tackle branching phenomena
without the need for a special element with branched strong discontinuities as proposed in [10]. Due to the construction
of the method, the zero-level sets of the CPF, µ, cannot intersect itself and, therefore, the elements at the branching
region are injected with the CS-DSM which has no assumed direction of localization.

The total energy dissipation is plotted in Fig. 14 for the different loading rates and kinematic formulations. It can be
observed that the total energy dissipation increases with increasing loading rate since the amount of fractured material
increases as well. In general, energy dissipation curves for all three formulations are remarkably close. Differences are
observed at the latest loading steps specially between the standard and the two injection techniques. This is, however,
less visible for the high loading rates. In the same spirit, differences between DDM and CS-DSM injection seem to
diminish upon increasing loading rate which suggests that the DDM injection does not play a substantial role in fast
fracture processes.



516 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 13. Injection patterns upon increasing loading rate at the dynamic compact tension test.

3.2.2. Crack tip velocities
Branching phenomena have been studied in this section by monitoring the crack tip velocities and total dissipated

energy W D . Crack tip velocities for the medium with high loading rates are plotted in Fig. 15. Basically, two different
criteria are adopted to locate the crack tip position: (i) when the damage exceeds a heuristic threshold value indicating
total loss of load carrying capacity, i.e. d ≥ 0.999, and (ii) when the energy dissipation per unit of surface approaches
the fracture energy, i.e. gDS ≥ λsdGf with λsd = 0.85. The crack tip velocity plots have been filtered with a Gaussian
convolution to reduce the noise and it can be observed that results obtained with both criteria lead to similar crack
velocity profiles. Maximum registered crack speeds are comprised between 500 and 600 m/s which is in good
agreement with experimentally observed velocities.

Branching events are shown for both curves using black and red circles, respectively. For the medium loading
rate results, crack branching is observed close to peak values of the crack tip velocity. This is in agreement with
observations from experimentalists which report crack branching phenomena when a certain critical crack tip velocity
is reached. All critical velocities are bounded by the Rayleigh wave speed of the material but its value can be
significantly lower than the Rayleigh velocity as for the case of concrete. For high loading rates, branching episodes
do not seem to be located at peak regions of the crack velocity profiles. As opposed to what is expected, branching
phenomena seems to occur before the crack is accelerated to reach the peak value. We have observed in our energy
dissipation plots that, prior to the first branching event, energy dissipation occurs at the vicinity of the crack tip in a
smeared fashion. This can explain, in our results, that the dissipation D increases while the crack speed remains low
(cf. Fig. 16). In either case, crack velocity profiles present high oscillations which make the analysis more cumbersome
and, the fact that a region at the vicinity of the crack tip might be dissipating energy as well, which is the case for
quasi-brittle fracture, induces uncertainty when matching the branching event with peak values of the crack speed.

3.2.3. Branching identification based on the dissipation D
We present an alternative way to study crack propagation instabilities, such as branching, by monitoring the total

dissipated energy W D and the dissipation D. In Fig. 16 the total dissipated energy and the dissipation plots are shown



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 517

Fig. 14. Total dissipated energy at different loading rates for the dynamic CT test. A thickness of 1 mm is considered for the energy plots.

Fig. 15. Dynamic CT test crack speeds for the medium and high loading rate using the damage (d > 0.999) and dissipation (gDS ≥ 0.85Gf)
criteria. Red and black circles indicate branching episodes in the crack tip velocity plots corresponding to the dissipation and damage criteria,
respectively. The horizontal dashed blue line corresponds to a 25% of the Rayleigh velocity (vR). (For interpretation of the references to colour in
this figure legend, the reader is referred to the web version of this article.)

for different loading rates ṗ ranging 1.077 × 103–2.154 × 104 N/mm2/s. All analyses have been performed with the
combination of CS-CSM and DDM injections with the CPF tracking algorithm.

Upon increasing loading rate the total dissipated energy increases and the dissipation presents a higher peak value.
The branching episodes are indicated in the plots with black circles at each of the curves. It is worthwhile noting that
all dissipations measured during branching events cluster in a region between 1.35 × 105 and 1.62 × 105 N mm/s.



518 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 16. Time evolution of the total dissipated energy (left) and dissipation (right) for different loading rates. The black circles indicate the first
observed branching episode. A thickness of 1 mm is considered for the energy plots.

Such dissipation limits Db have been estimated using the expression

Db = vbGfk, (45)

where vb refers to the crack velocity at the onset of branching reported in experiments, i.e. between 500 and 600 m/s
for concrete material [34] and k stands for the considered bandwidth of the localization zone in the DDM. In this
view, Eq. (45) sets a maximum dissipation for a single crack assuming that the energy is instantaneously dissipated.
Therefore, all dissipations greater than the upper limit in (45) necessarily involve more than one crack in order to be
achieved. In all our analyses the detected dissipations at branching episodes fit reasonably well between the above
mentioned limits computed with the experimental maximum crack velocities 500 and 600 m/s. For this reason,
branching phenomena can be identified, from an energetic point of view, in the sense that one single crack cannot
propagate beyond a certain energy rate (dissipation) without branching. In this view, such a dissipation could only be
possible by adding more cracks that contribute to the dissipation process. The crack tip velocities for the medium and
high loading rates analyzed in Fig. 15 can be now computed through (45) assuming that the energy is instantaneously
dissipated. In this view, the obtained crack velocities are 501.82 and 545.58 m/s for the particular medium and high
loading rates, respectively. This alternative approach to calculate the crack tip velocity at the onset of branching for a
single crack provides a plausible agreement with experimental results and seems adequate for the study of branching
in quasi-brittle and brittle materials since is based on a field, i.e. the dissipation D, which is remarkably smoother and
reliably evaluated than the crack tip velocity field (cf. Fig. 15). A somewhat similar idea has been already introduced
by Hofacker and Miehe [11] where crack branching is detected when a critical crack surface rate is reached. However,
studying the rate of dissipated energy can be performed by accounting for a global energy balance instead of locally
studying crack surface growth. The total energy dissipation is simply calculated as the difference between the external
loads energy minus the deformation and kinetic energies and is, therefore, obtained with no additional criteria to locate
the crack tip position which might vary depending on the considered simulation strategy.

Remark 3.1. As mentioned in Section 2.1, a Newmark scheme with damping coefficients is utilized for the integration
of the velocity and acceleration fields. It has been convenient to chose such a scheme to minimize the oscillations at the
stress field produced by the passage of pressure waves which could induce spurious unloading–reloading conditions
of the injection status and a higher mobility of the crack path set Γ employed for the DDM injection. It should be
noted that, in this example, no difference between the total dissipated energy W D is detected in the plots shown in
Fig. 17 either using both damped or undamped coefficients for the Newmark integration scheme in (31) and (32).

3.2.4. Objectivity tests
The objectivity of the results with respect to the spatial and temporal discretizations is studied in this section.

All computations correspond to a medium loading rate ( ṗ = 7.180 × 103 MPa/s to ṗ = 10.0 × 103 MPa/s) with
DDM injection. Spatial discretizations of around 2000, 4500 and 10,000 elements are tested using the coarsest time



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 519

Fig. 17. Total energy dissipation obtained with both damped and undamped coefficients for the Newmark scheme. A thickness of 1 mm is
considered for the energy plots.

discretization ∆t = 1.0 × 10−6 s. In the same spirit, the time increments ∆t = 1.0 × 10−6, ∆t = 0.5 × 10−6 and
∆t = 0.5×10−7 s are utilized keeping a spatial discretization of 4500 elements. The corresponding Courant numbers
are reported in Table 4. Note that for the medium and fine size meshes, in combination with the coarsest time step
increment, the Courant numbers are slightly larger than 1.0. This limit is specially designed for calculations employing
an explicit time step integration which is not the case in our analyses and, therefore, stability of the computations is
not compromised.

Fig. 18 shows the final damage and strain injection patterns obtained with two different spatial and temporal
discretizations. No significant differences are appreciated among different time step discretizations. The damage and
injection patterns observed among the spatial discretizations present more variability. Note that the medium and fine
meshes capture the main crack branches although the finest is able to show secondary cracks due to the higher spatial
resolution. The total energy dissipation curves shown in Fig. 19 reveal that an increase in spatial resolution leads to
higher energy dissipation values while an increase in temporal resolution leads to lower energy dissipation values.
More importantly, a convergent behavior is observed for both spatial and temporal discretizations when the resolution
is increased.

3.3. Towards simulations of brittle failure involving complex fracture phenomena

The Kalthoff experiment [36] is simulated in this section employing the strain injection and crack path field
techniques. The test is depicted in Fig. 20 and essentially consists of an edged-cracked plate impacted by a projectile.
At an impact velocity v0 = 16.5 m/s a mode I crack opening is observed with cracks propagating from the notch
towards the superior and inferior specimen edges at an angle of approximately 70◦. Plane strain conditions are
considered and the projectile impact is modeled by imposing the impact velocity at the prescribed contour ΓD. The
material parameters for the metallic plate are summarized in Table 5. We have modeled the complete domain without
accounting for symmetry conditions. Both unstructured and structured meshes have been studied with approximately
15,000 elements at each of them. The parameters for the spatial and temporal discretization involving Courant numbers
and the lc/ le ratios are shown in Table 6. Note that the characteristic length of the fracture process zone is remarkably
lower than the one reported in the previous example which indicates that the fracture process is considered more
brittle.

The injection of the weak discontinuity (CS-DSM) is performed accounting for αinj = 0.7 for the unstructured
mesh and αinj = 0.3 for the structured mesh. The reason for this choice is illustrated in detail by the end of this
section (cf. Fig. 26) and is basically related to the fact that mesh bias phenomena are stronger when employing the
structured mesh and a larger CS-DSM region is needed to ensure a correct fracture propagation. Instead of employing
the parameter λsd, the strong discontinuity is injected considering a heuristic time delay of around 100 µs from the
injection of the weak discontinuity. The reason for this choice is because energy is dissipated almost immediately and
the global tracking algorithm (CPF) is not always able to provide a stable direction of propagation since the fracture
process zone in front of the crack tip is almost negligible.



520 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 18. Damage and strain injection patterns at time t = 5.75 × 10−4 s for different spatial and temporal discretizations corresponding to a
medium loading rate of ṗ = 10.0 × 103 MPa/s.

Table 5
Material parameters and wave velocities for the Kalthoff experiment.

σu [N/mm
2
] E [N/mm2] ν Gf [N/mm] ρ [Kg/m

3
] vR [mm/s] cd [mm/s] cs [mm/s]

844.0 190.0 × 103 0.3 22.17 8000 2799 × 103 8548.5 × 103 3022.4 × 103

Fig. 21 shows the injection patterns for both unstructured and structured meshes. The responses are very much
comparable and both propagation angles are close to 70◦. Note that, at regions where no nonlinearity occurs,
i.e. r = r0, the isosurface corresponding to the zero level set of the crack path field occupies the whole linear region
and is depicted in our postprocess following all FE boundaries. This effect could be filtered out in the quasi-static



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 521

Fig. 19. Energy dissipation objectivity with respect to the mesh size (left) and time step (right) corresponding to a medium loading rate of
ṗ = 7.180 × 103 MPa/s. A thickness of 1 mm is considered for the energy plots.

Fig. 20. Geometry and boundary conditions for the Kalthoff experiment.

Table 6
Courant numbers C , material’s characteristic length lc and lc/ le ratio for
the spatial and temporal resolutions utilized in the Kalthoff test.

Temporal resolution (∆t [s]) Spatial resolution (le [mm])
Unstructured Structured
1.1 1.2

1.0 × 10−7 C = 0.777 C = 0.712
Material characteristic length (lc [mm]) 6.4982
lc/ le 5.908 5.415

results (cf. Figs. 8 and 10) since only one crack path set appears in the plot. Displacement contours and the deformed
configuration are depicted in Fig. 22. The energy dissipation curves considering the three different formulations are



522 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 21. Injection patterns for the unstructured and structured meshes.

depicted in Fig. 23. It is important to note that the total energy dissipation profiles for both unstructured and structured
meshes are almost identical. Differences can be remarkable when the standard formulation is used at the structured
mesh. For these type of brittle and fast fracture processes the difference between the CS-DSM and DDM injection
does not seem to be very relevant which is in agreement with the results obtained with high loading rates for the CT
specimen. An equivalent energy dissipation profile is obtained for both unstructured and structured discretizations
when the strong discontinuity kinematics is employed (cf. Fig. 24). It is emphasized that the integration scheme with
damping parameters induces some extra numerical energy dissipation (cf. Fig. 25) as known for a free oscillation
problem. However, this spurious energy dissipation is the same for all formulations and, hence, the comparison in
Fig. 23 is still valid. The difference between results with and without numerical damping is more evident in this
example than in the CT test (cf. Fig. 17) since the loading velocity (in terms of equivalent imposed displacement per
unit of time) is at least two times higher. This causes a larger amount of high frequencies in the pressure waves which
are prone to be filtered out by the dissipative integration scheme [37].



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 523

Fig. 22. Displacement contours and deformation configurations.

Fig. 23. Total energy dissipation profiles for the unstructured and structured meshes using different kinematic formulations. A thickness of 1 mm
is considered for the energy plots.

The role of the first injection threshold, i.e. the selection of the injection parameter αinj, is illustrated in Fig. 26 for
the structured mesh which represents the most challenging scenarios. The propagation direction is corrected when the
threshold αinj = 0.3.

Crack velocities for the unstructured and structured meshes are reported in Fig. 27. The crack tip is identified as the
last element belonging to the observed crack element list in which the energy dissipation per unit of surface exceeds
85% of the fracture energy Gf. The crack tip velocity plots have been filtered with a Gaussian convolution to reduce
the noise as for the results presented in Fig. 15. In general terms, the results for both unstructured and structured



524 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 24. Total energy dissipation profiles for the unstructured and structured meshes using the strong discontinuity kinematics. A thickness of 1 mm
is considered for the energy plots.

Fig. 25. Total energy dissipation profiles with and without numerical damping. Circles denote the first detected damage episode within a precision
of 10 time steps. A thickness of 1 mm is considered for the energy plots.

meshes coincide. The plots are in good agreement with the results provided in [38,39] in the sense that the reported
speeds are comparable and peak values do not exceed the Rayleigh wave speed (cf. Table 5). As observed in Fig. 21
the injection patterns are remarkably symmetric as expected from the imposed boundary conditions and are found
in agreement with those provided by different numerical techniques, e.g. phase-field [13,11] and gradient damage
models [40] but at the expense of a mesh discretization which is around two orders of magnitude finer (cf. Fig. 28).

4. Conclusions

The presented FE formulation with weak and strong discontinuity injections provides additional information for
modeling fracture dynamics problems with FE methodologies. Due to the intra-element nature of the kinematic
enrichment, remarkably coarse meshes can be used compared to other extra-element techniques, such as non-local
damage and phase field models, rendering a computationally cheaper approach. Although a standard damage model
is employed throughout the simulations, the continuous strong discontinuity approach (CSDA) enables the use of a
wide range of standard constitutive models.

The crack path field global tracking technique in combination with the kinematic compatibility criteria employed
for the strong discontinuity injection automatically account for the injection of complex fracture phenomena such as



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 525

Fig. 26. Fracture propagation around the upper notch for the structured mesh considering different injection thresholds.

Fig. 27. Crack propagation velocities for the mode-I crack originating at the lower notch for the unstructured and structured meshes.

branching. Regions involving crack branching or intersection are injected with the non-directional CS-DSM element
while the rest of the discontinuity is modeled with the strong discontinuity injection.

As already addressed in quasi-static fracture propagation problems, the combination of weak and strong
discontinuity injection prevents stress locking as well as mesh bias but its effect seems to be less visible for dynamic
examples in which a high loading rate is considered. Structured meshes utilized in the dynamic simulations challenge
the scheme to provide an accurate fracture propagation. In such scenarios, the difference between standard and strain
injection techniques is remarkable. The injection threshold αinj plays a crucial role in those cases where the direction
of propagation might be affected by the mesh alignment and is therefore recommended in simulations using the strain
injection approach.

Crack curving and branching have been observed upon increasing loading rate once the crack tip exceeds an
experimentally observed velocity which corresponds to a fraction of the Rayleigh wave speed. An increase of loading
rate entails an increase of branching phenomena and, therefore, the fractured area grows and is reflected in the global



526 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 28. Equivalent mesh discretizations for the Kalthoff experiment employing different numerical techniques. A logarithmic scale is considered
in the vertical axis.

energy dissipation. The dissipation D is evaluated in order to identify crack branching phenomena. The maximum
dissipation for one crack can be estimated as the product of the fracture energy, the maximum crack tip velocity and
the crack band width assuming that the fracture energy is instantly released. In this view, the maximum dissipation for
one crack is reached when the crack tip is propagating at the maximum speed. In those situations where the dissipation
exceeds this value, a single crack must branch into multiple cracks propagating at an initially lower speed than the
limit crack speed which is, in turn, related to the Rayleigh wave speed for the particular material. The crack branching
velocities computed by means of the dissipation at the onset of branching Db are in good agreement with crack tip
velocities at the onset of branching reported experimentally.

Objectivity of the structural response of the simulations is studied for the compact tension test in terms of the total
dissipated energy W D . Convergence of the energy dissipation values is observed upon time and space discretization
refinements. The simulation of the Kalthoff experiment with both structured and unstructured meshes provides results
in agreement with experimental values in terms of crack speed and propagation direction.

It is highlighted that the employed FE technology has proven to be a valuable tool for the multiscale analysis of
quasi-static fracture propagation in earlier works. For this reason, it is expected that multiscale analysis of complex
dynamic fracture phenomena can be studied as well in future contributions.

Acknowledgments

The research leading to these results has received funding from the European Research Council under the European
Union’s Seventh Framework Programme (FP/2007-2013) / ERC Grant Agreement No. 320815 (ERC Advanced Grant
Project “Advanced tools for computational design of engineering materials” COMP-DES-MAT). Oriol Lloberas-Valls
gratefully acknowledges the funding received from the Spanish Ministry of Economy and Competitiveness through
the “Juan de la Cierva” Postdoctoral Junior Grant: JCI-2012-13782 and the National Research Plan 2014: MAT2014-
60919-R. Ivo Dias gratefully acknowledges the financial support from Laboratório Nacional de Engenharia Civil
(LNEC) through the postdoctoral research Grant (CoMatFail project).

Appendix A. Finite element formulation

The EFEM formulation mentioned in Section 2.3 and involved in the three subdomains, Bstd, Bwd and Bsd, is
presented in this Appendix.



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 527

Quadrilateral finite elements are used in all cases. The irreducible formulation with standard kinematics and con-
tinuous displacements mentioned in item 1 of Section 2.3 for modeling Bstd, uses bilinear polynomials to interpolate
displacements. This is a very standard technique which description can be found in several classical books related to
the Finite Element Method. Therefore, no additional details about this formulation are given in the present text.

Alternatively, finite elements with injected strains (weak and strong discontinuity injections mentioned in items
2 and 3 in Section 2.3) have been described in [26]. The summary of finite elements with injected strains in next
paragraphs follows closely the description given in that reference. Additional issues, as well as detailed aspects being
necessary for the adequate implementation of this technique, should be consulted there.

Finite elements with assumed enhanced strains can be formulated considering a three-field Petrov–Galerkin mixed
formulation by assuming in (15) that displacements u and strains ε are independent fields. The strain field is partitioned
in two terms: ε = ξ +γ . The first term ξ denotes a compatible strain field and γ a so-called enhanced strain field. The
enhanced strains are responsible for modeling possible singularities in the kinematics associated with the propagating
crack and are introduced in the formulation by following closely the variational framework of the assumed enhanced
strain method proposed in [31].

A.1. Weak discontinuity injection in Bwd. Constant stress-discontinuous strain mode (CS-DSM)

Considering the domain Be of element e, with Be ⊂ Bwd, spaces of displacement trial functions V wdu and
displacement test functions V̂ wdu are defined as follows:

V wdu =


u =
nnode
i=1

Ni (x)di (t); u|∂Bu = u
∗
(x, t)


; (A.1)

V̂ wdu =

η =

nnode
i=1

Ni (x)d̂i ; η|∂Bu = 0

; (A.2)

where nnode corresponds to the number of nodes of the finite element mesh in the domain Bwd, Ni (x) represents the
shape function associated with the i th node and di (or d̂i in (A.2)) stands for the vector of interpolation parameters
of the same node. The variations η(x) ∈ H1(Bwd), H1 being the Sobolev space of functions with square integrable
derivatives. Initial displacements and velocity conditions are approached by u0 and u̇0, respectively.

An element-wise constant interpolation of compatible strains is adopted for modeling elements belonging to the
domain Bwd. Compatible and enhanced components of the strains ε are defined as follows:

V wdε = V̂
wd
ε =


ξwd =


e∈Bwd

φ
e
(x)ξ e(t)


; (A.3)

V wdγ = V̂
wd
γ =


γ wd =


e∈Bwd

χ
(he,ke)
S (x) γ

e
(t)


. (A.4)

In Eq. (A.3), φei (x) is a spatially constant function at each element and ξ
e (with ξ e ∈ Sndim×ndim ) are the interpolation

parameters of element e. In Eq. (A.4), χ (h
e,ke)

S is the dipole function defined by (see Fig. 29):

χ
(he, ke)
S (x) =




−
1

he − ke
; x ∈ Breg;

1
ke

; x ∈ Bsing;
(A.5)

where he is the characteristic size of element e, and ke represents a bandwidth regularization parameter. Therefore,
the enhanced strain γ wd is discontinuous in Be, and the interpolation parameters γ e (with γ e ∈ Sndim×ndim ) can be
interpreted as the strain jump intensity. As depicted in Fig. 29, γ wd is piece-wise constant in Bsing and Breg which
facilitates the numerical evaluation of integrals in the variational formulation. Due to the dipole function definition,
note that:

Be
γ wd(x, t)d B = 0; ∀ γ wd ∈ V

wd
γ ; (A.6)



528 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 29. CS-DSM injected in element Be ⊂ Bwd (left). Strain discontinuity bands injected in element Be ⊂ Bsd (right).

This condition is required by the finite element model to satisfy the patch test.
According to [26], the variational equations for these finite elements with weak discontinuity injection can be

written as follows. Find u ∈ V wdu , ε = ξ + γ with ξ ∈ V
wd
ε and γ ∈ V

wd
γ , satisfying:

B
σ (ε) : ∇η d B −


B
(b − ρü) · η d B −


∂Bt

t∗ · η dΓ  
Wextη (η,b,ü,t

∗)

= 0; ∀η ∈ V̂ wdu ; (A.7)


Be

φ
e
ξ̂

e
:


φ

e
ξ

e
−

nenode
i=1

(∇
s N ei ⊗ d

e
i )


d B = 0; ∀ξ̂

e
∈ V̂ wdε ; (A.8)

Be
γ̂

e
: (χ

(he,ke)
S σ ) d B =


S e

γ̂
e

: [[σ ]] d B = 0; ∀γ̂ e ∈ V̂ wdγ . (A.9)

There is one Eq. (A.9) and (A.8) for every element in Bwd. In Eq. (A.7), the term denoted Wextη refers to the virtual
work due to the external and inertial forces.

A.2. Strong discontinuity injection in Bsd. Discontinuous displacement mode (DDM)

According to the criteria given in Section 2.4, the finite elements in Bsd are intersected by a discontinuity surface
S . Then, they are equipped with a strong discontinuity kinematics. Based on the kinematics defined in Eq. (9), we
adopt the following space of trial functions for displacements:

V sdu =


u =
nnode
i=1

Ni (x)d̄i (t) +


e∈Bsd
(HeS(x) − ϕ

e
(x))[[u ]]e(t)


, (A.10)

where [[u ]]e ∈ Rndim denotes the vector of displacement jump at element e (one vector per element). The Heaviside
step function at element e, already introduced in (11), is denoted by HeS , and the element auxiliary function is

ϕ
e
(x) =


i+

N ei (x); (A.11)

where the index i+ is related to all finite element nodes lying on the element subdomain Besd ∩ B
+ (cf. Fig. 1).



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 529

The space of test functions for displacements are adopted as follows:

V̂ sdu =

η =

nnode
i=1

Ni (x)d̂i (t); η|∂Bu = 0

, (A.12)

and the space of trial and test functions for the strains are:

V sdε = V̂
sd
ε =


ξ sd =


e∈Bsd

φ
e
(x)ξ e(t); ξ e ∈ Sndim×ndim


; (A.13)

V sdγ =

γ sd =


e∈Bsd

δS

[[u ]]e(t) ⊗s n


; [[u ]]e ∈ Rndim


, (A.14)

V̂ sdγ =

γ̂ sd =


e∈Bsd

χ
+

S (x)

[[û]]e ⊗s n


; [[û]]e ∈ Rndim


, (A.15)

where, similar to Eq. (A.3), φei (x) is a spatially constant function at each element and ξ
e represents the interpolation

parameters. In expression (A.14), χ+S (x) stands for the dipole-like generalized function satisfying:
B

χ
+

S (x)C(x) d B =


S
[[C(x) ]]+S dΓ =


S
(C(x+) − C(xS)) dΓ (A.16)

for any sufficiently regular, though not necessarily continuous, function C(x) in S . Note that functions γ sd ∈ V sdγ also
satisfy the condition:

Be
γ sd(x, t)d B = 0; ∀ γ sd ∈ V

sd
γ . (A.17)

The mixed variational problem in Bsd can be written as: find u ∈ V sdu , εsd = ξ sd + γ sd with ξ sd ∈ V
sd
ε and

γ sd ∈ V sdγ , satisfying:
B

σ (ε) : ∇
s
η d B − Wextη (η, b, ü, t

∗
) = 0; ∀η ∈ V̂ sdu , (A.18)

Be
χ

+

S (x) ([[û ]]
e
⊗

s n : σ ) d B =


S e
[[û ]]e ·[[σ · n]] dΓ = 0; ∀[[û ]]e ∈ Rndim , (A.19)

Be
φ

e
ξ̂

e
sd :


φ

e
ξ

e
sd −


∇

s N ei ⊗ d
e
i − ∇ϕ

e
⊗

s
[[u ]]e


d B = 0; ∀ξ̂

e
∈ Sndim×ndim . (A.20)

From the statements above it is highlighted that there is one Eq. (A.20) and (A.19) for every element in Bwd.
It should also be noted that the regular and singular parts of the strain, i.e. corresponding to the weak and strong
discontinuity injections, are evaluated at the specific integration points xreg and xsing indicated at Fig. 29, respectively.

Appendix B. Regularized local damage model

Box I presents a summary of the equations defining the damage model used in this contribution. This model
basically consists in an isotropic continuum damage model with a k-regularized softening modulus H , given by
Eq. (B.6) (cf. [41] and [42]).

The damage variable d depends on two internal variables q and r as indicated in (B.3). Evolution of d only occurs
in tensile stress states (cf. (B.4), (B.5)) and the damage criterion is defined in terms of the positive counterpart of the
effective stress σ̄+, as shown in Eq. (B.8). The loading–unloading conditions are given by (B.9).

Material degradation is defined by an exponential or linear law, according to the softening description adopted for
the intrinsic parameter H̄ , shown in Eq. (B.6). The material parameters of the constitutive model are: ultimate tensile
stress, σu, Young’s modulus, E , Poisson ratio, ν and fracture energy, G f .

Eq. (B.8) contains the expression of the damage surface g in the strain space. Note that the loading–unloading
conditions are defined in (B.9). Therefore, a loading situation is encountered when ṙ > 0 which implies g = 0.



530 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

ϕ(ε, r) =
1
2
(1 − d(r))ε : C : ε  

σ̄

(B.1)

σ =
q

r
C : ε = [1 − d(r)] C : ε (B.2)

d(r) = 1 −
q(r)

r
≥ 0. (B.3)

r |t=0 = r0 =
σ u
√

E
. (B.4)

q̇ = H̄(r) ṙ , q ≥ 0, q|t=0 = r0, (B.5)

H(r) = k H̄(r); H̄(r) =




−
r20

2G f
bilinear softening

−
k r20
G f

exp


−
k r0
G f

[r − r0]


exponential softening

(B.6)

k = regularization parameter (bandwidth of localized strains). (B.7)




g(ε, r) = τε(ε) − r =


σ̄+ : ε − r, σ̄+ =
3

i=1

⟨(σ̄ )i ⟩ ei ⊗ ei .

(σ̄ )i → principal stress“i”
ei → principal direction“i”

(B.8)

ṙ = 0; g ≤ 0; ṙ g = 0. (B.9)

Description of variables and symbols
r : strain-like internal variable,
q: stress-like internal variable,
d: scalar damage variable,
C: isotropic elastic constitutive tensor,
σ̄ : effective stress,
σ eff

ξ i : i th principal stress of σ̄
ei : i th eigenvector of σ̄
(σ̄ )+: positive counterpart of effective stress,
⟨·⟩: Macaulay brackets,
k: strain localization band thickness,
H : softening modulus in terms of G f .
τε(ε) =

√

σ̄+ : ε: equivalent strain.

Box I. Isotropic continuum tensile-damage model with strain-softening .

B.1. Dissipation density and related physical quantities frequently used in this work

For the present damage model, the dissipation density is defined as:

ddis(x, t) = σ : ε̇ − ϕ̇ = −ḋ(r)σ̄ : ε, (B.10)

where the units of ddis are [J/(m
3s)]. From this physical quantity, several useful expressions utilized in this work can

be derived. So, the total dissipation D in the body B is:

D(t) =


B
ddis(x, t) d B, (B.11)



O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 531

where the units of D are [J/s], while the accumulated dissipation density can be defined as:

w
D

(x, t) =
 χ=t

0
ddis(x, χ) dχ, (B.12)

where the units of wD are [J/m3], and finally, the total dissipated energy in B is:

W D(t) =


B
w

D
(x, t) d B =

 χ=t
0

D(χ) dχ, (B.13)

where the units of W D are [J].

B.2. Dissipation density generated by stresses acting at the cohesive surface S

Let us consider the surface S , described in the present model by a strong discontinuity kinematics as shown in
Fig. 30. The analysis of the material dissipation generated into S by the present damage model has been widely studied
by the authors in the context of the so-called Continuum-Strong Discontinuity Approach (CSDA). Particularly, the
reader is addressed to the work [43], where a full description of the topic here summarized can be found. According
to this reference work, the dissipation (B.10) at xS ∈ S can be written as follows:

ddis(xS , t) = σ S : ε̇S − ϕ̇(xS , t) = δS Dsd(xS , t), (B.14)

where δS is the Delta function shifted to S and Dsd is the dissipation per unit of area of S (dimensions of Dsd are
[J/(m2s)]). Additionally, and according to (B.12), the accumulated dissipation density in S can be defined as:

w
D

(xS , t) =
 χ=t

0
σ S : ε̇S − ϕ̇(xS , χ) dχ. (B.15)

The following very fundamental identity is assumed:

G f =
 χ=∞

0
Dsd(xS , χ) dχ, (B.16)

where the model parameter G f is the fracture energy utilized in (B.6).
The expression for Dsd has been derived in [43] in terms of surface quantities:

Dsd(xS , t) = tS ([[u]]) · [[u̇]]; (B.17)

where the cohesive traction in S is tS = σ S ·n, see Fig. 30(c). From (B.14), (B.17) and considering the k-regularization
of S (S is assumed as a band of thickness k as shown in Fig. 30(b)), the following identity holds:

Dsd(xS , t) = k(σ S : ε̇S − ϕ̇(xS , t)). (B.18)

The energy per unit of surface dissipated at the cohesive surface S can be expressed as

gDS (xS , t) =
 χ=t

0
Dsd(xS , χ) dχ = k

 χ=t
0

(σ S : ε̇S − ϕ̇(xS , χ)) dχ. (B.19)

Then, considering the relations in (B.15)–(B.19), a possible parameterization of the longitudinal coordinate along
the cohesive zone of S can be performed by adopting the ratio:

λ(xS , t) =
gDS (xS , t)

G f
; 0 ≤ λ ≤ 1; (B.20)

so that, λ = 1 at a given point on S indicates the total degradation of the material, and therefore, corresponds to points
on the cohesive-free zone, as shown in Fig. 30(b). Contrarily, material points which have just recently been introduced
at S , at time t = tB (points at the crack tip), are characterized by λ = 0. Then, intermediate values of λ correspond to
points in the interval between the crack tip and the cohesive-free zone, as shown in Fig. 30(b). In this sense, selecting
the value λsd < 1 is a specific assumption of the finite element model to define one of the criteria to constitute the
domain Bsd.



532 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

Fig. 30. Dissipation density along the surface S using the CSDA model: (a) representation of the cohesive and cohesion-free zone along S ,
(b) regularization parameter k (bandwidth across which the displacement discontinuity is regularized), λ-parameterization and (c) traction-
separation law.

Appendix C. Derivation of the total internal energy

The internal energy expression in (39) is derived in this section considering a given mechanical problem described
by the governing equations and variational formulation in Sections 2.1 and 2.2.

Assuming that the reactions tu on ∂Bu, i.e. the boundary with imposed displacements, are known at any time, we
define a second mechanical problem having identical initial and boundary conditions to the first one, except that,
reactions tu are imposed as external actions on ∂Bu. This second problem is mechanically equivalent to the first one.

In the second problem, the boundary ∂Bu where external tractions tu are imposed is re-identified as ∂Btu. The
admissible space of displacements V

(II)

u and displacement space of variations V̂
(II)

u , useful for defining the variational
equation (15), are redefined as :

V
(II)

u = {u = ū + MS [[u]] | u̇(x, 0) = u̇0(x), for x ∈ B}; (C.1)

V̂
(II)

u = {η = η̂ + MS [[η]]}. (C.2)

Then, the variational equation:
B

σ : ∇
s
ηd B +


B
(b − ρü) · η d B +


∂Bt

t∗ · η dΓ +


∂Btu
tu · η dΓ = 0; ∀ η ∈ V̂

(II)

u , (C.3)

is satisfied. Due to the equivalence between both mechanical problems, u∗ is the solution of (C.3) at the
boundary ∂Btu.

Observing that the displacement field solution of the variational problem (C.3), u(x, t), satisfies: u ∈ V̂
(II)

u , then,
choosing specifically η = u(x, t) in (C.3), the equation:

B
σ (ϵ) : ∇

su d B =


∂Bt
t∗ · u dΓ +


B

b · ud B −


B
ρü · u d B +


∂Btu

tu · u
∗ dΓ (C.4)

is satisfied.

References

[1] H.W. Reinhardt, Concrete Under Impact Loading: Tensile Strength and Bond, Stevin-Laboratory of the Department of Civil Engineering,
Delft University of Technology, 1982.

[2] L.B. Freund, Dynamic Fracture Mechanics, Cambridge University Press, 1998.
[3] E. Sharon, J. Fineberg, Confirming the continuum theory of dynamic brittle fracture for fast cracks, Nature 397 (6717) (1999) 333–335.
[4] E. Sharon, S.P. Gross, J. Fineberg, Local crack branching as a mechanism for instability in dynamic fracture, Phys. Rev. Lett. 74 (25) (1995)

5096–5099.
[5] M. Ramulu, A.S. Kobayashi, Mechanics of crack curving and branching a dynamic fracture analysis, Int. J. Fract. 27 (3–4) (1985) 187–201.

http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref2
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref3
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref4
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref5


O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534 533

[6] J.-H. Song, H. Wang, T. Belytschko, A comparative study on finite element methods for dynamic fracture, Comput. Mech. 42 (2) (2008)
239–250.

[7] M.L. Falk, A. Needleman, J.R. Rice, A critical evaluation of cohesive zone models of dynamic fracture, Le Journal de Physique IV 11 (PR5)
(2001) Pr5–43.

[8] A. Pandolfi, P. Krysl, M. Ortiz, Finite element simulation of ring expansion and fragmentation: the capturing of length and time scales through
cohesive models of fracture, Int. J. Fract. 95 (1–4) (1999) 279–297.

[9] J.-H. Song, T. Belytschko, Cracking node method for dynamic fracture with finite elements, Internat. J. Numer. Methods Engrg. 77 (3) (2009)
360–385.

[10] C. Linder, F. Armero, Finite elements with embedded branching, Finite Elem. Anal. Des. 45 (4) (2009) 280–293.
[11] M. Hofacker, C. Miehe, A phase field model of dynamic fracture: Robust field updates for the analysis of complex crack patterns, Internat. J.

Numer. Methods Engrg. 93 (3) (2013) 276–301.
[12] C. Miehe, M. Hofacker, F. Welschinger, A phase field model for rate-independent crack propagation: Robust algorithmic implementation

based on operator splits, Comput. Methods Appl. Mech. Engrg. 199 (45–48) (2010) 2765–2778.
[13] M.J. Borden, C.V. Verhoosel, M.A. Scott, T.J.R. Hughes, C.M. Landis, A phase-field description of dynamic brittle fracture, Comput. Methods

Appl. Mech. Engrg. 217220 (2012) 77–95.
[14] R.R. Pedersen, A. Simone, L.J. Sluys, An analysis of dynamic fracture in concrete with a continuum visco-elastic visco-plastic damage model,

Eng. Fract. Mech. 75 (13) (2008) 3782–3805.
[15] R.R. Pedersen, A. Simone, L.J. Sluys, Mesoscopic modeling and simulation of the dynamic tensile behavior of concrete, Cement Concr. Res.

50 (2013) 74–87.
[16] G.T. Camacho, M. Ortiz, Computational modelling of impact damage in brittle materials, Int. J. Solids Struct. 33 (20–22) (1996) 2899–2938.
[17] B. Li, A. Pandolfi, M. Ortiz, Material-point erosion simulation of dynamic fragmentation of metals, Mech. Mater. 80 (Part B) (2015) 288–297.
[18] Y. Ha, F. Bobaru, Studies of dynamic crack propagation and crack branching with peridynamics, Int. J. Fract. 162 (1–2) (2010) 229–244.
[19] S.A. Silling, Dynamic fracture modeling with a meshfree peridynamic code, in: K.J. Bathe (Ed.), Computational Fluid and Solid Mechanics

2003, Elsevier Science Ltd., Oxford, 2003, pp. 641–644.
[20] L. Kosteski, R.B D’Ambra, I. Iturrioz, Crack propagation in elastic solids using the truss-like discrete element method, International journal

of fracture 174 (2) (2012) 139–161.
[21] T. Belytschko, D. Organ, C. Gerlach, Element-free galerkin methods for dynamic fracture in concrete, Comput. Methods Appl. Mech. Engrg.

187 (3–4) (2000) 385–399.
[22] I.F. Dias, J. Oliver, A.E. Huespe, Strain Injection Techniques in Numerical Modeling of Propagating Material Failure, in: Monograph,

International Center for Numerical Methods in Engineering, ISBN: 978-84-940243-7-5, 2012.
[23] J. Oliver, I.F. Dias, A.E. Huespe, Crack-path field and strain-injection techniques in computational modeling of propagating material failure,

Comput. Methods Appl. Mech. Engrg. 274 (2014) 289–348.
[24] I.F. Dias, J. Oliver, J.V. Lemos, O. Lloberas-Valls, Modeling tensile crack propagation in concrete gravity dams via crack-path-field and strain

injection techniques, Eng. Fract. Mech. 154 (2016) 288–310.
[25] I.F. Dias, J. Oliver, J.V. Lemos, O. Lloberas-Valls, Advanced numerical techniques for modeling tensile crack propagation in gravity dams,

in: Second International Dam World Conference, LNEC, Lisbon, Portugal, 2015.
[26] J. Oliver, M. Caicedo, E. Roubin, A.E. Huespe, J.A. Hernández, Continuum approach to computational multiscale modeling of propagating

fracture, Comput. Methods Appl. Mech. Engrg. 294 (2015) 384–427.
[27] J.F. Molinari, G. Gazonas, R. Raghupathy, A. Rusinek, F.H. Zhou, The cohesive element approach to dynamic fragmentation: the question of

energy convergence, Internat. J. Numer. Methods Engrg. 69 (3) (2007) 484–503.
[28] J. Oliver, Modelling strong discontinuities in solids mechanics via strain softening constitutive equations. part 1: Fundamentals, Internat. J.

Numer. Methods Engrg. 39 (21) (1996) 3575–3600.
[29] J. Oliver, A.E. Huespe, M.D.G. Pulido, E. Chaves, From continuum mechanics to fracture mechanics: the strong discontinuity approach, Eng.

Fract. Mech. 69 (2002) 113–136.
[30] J.C. Simo, J. Oliver, A new approach to the analysis and simulation of strain softening in solids, in: Fracture and Damage in Quasibrittle

Structures, 1994, pp. 25–39.
[31] J.C. Simo, M.S. Rifai, A class of mixed assumed strain methods and the method of incompatible modes, Internat. J. Numer. Methods Engrg.

29 (8) (1990) 1595–1638.
[32] D.L. Linero, A Model of Material Failure for Reinforced Concrete via Continuum Strong Discontinuity Approach and Mixing Theory (Ph.D.

thesis), E.T.S. Enginyers de Camins, Canals i Ports, Technical University of Catalonia (UPC), Barcelona, 2006, Cimne Monograph Nbr.M106.
[33] S. Feld-Payet, V. Chiaruttini, J. Besson, F. Feyel, A new marching ridges algorithm for crack path tracking in regularized media, Int. J. Solids

Struct. 71 (2015) 57–69.
[34] J. Ožbolt, A. Sharma, H.-W. Reinhardt, Dynamic fracture of concrete—compact tension specimen, Int. J. Solids Struct. 48 (10) (2011)

1534–1543.
[35] R. Courant, K.O. Friedrichs, H. Lewy, Ueber die partiellen differenzengleichungen der mathematischen physik, Math. Ann. 100 (1928) 32–74;

On the partial difference equations of mathematical physics, IBM J. Res. Dev. 11 (1967) 215–234 (Transl.).
[36] J. Kalthoff, Modes of dynamic shear failure in solids, Int. J. Fract. 101 (1–2) (2000) 1–31.
[37] T.J.R. Hughes, The Finite Element Method: Linear Static and Dynamic Finite Element Analysis, N.J. Prentice-Hall International, Englewood

Cliffs, 1987.
[38] T. Belytschko, H. Chen, J. Xu, G. Zi, Dynamic crack propagation based on loss of hyperbolicity and a new discontinuous enrichment, Internat.

J. Numer. Methods Engrg. 58 (12) (2003) 1873–1905.
[39] A.E. Huespe, J. Oliver, P.J. Sanchez, S. Blanco, V. Sonzogni, Strong discontinuity approach in dynamic fracture simulations, in: Mecánica

Computacional, vol. XXV, 1995, pp. 1997–2018.

http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref6
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref7
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref8
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref9
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref10
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref11
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref12
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref13
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref14
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref15
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref16
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref17
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref18
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref19
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref20
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref21
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref23
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref24
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref25
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref26
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref27
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref28
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref29
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref30
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref31
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref32
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref33
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref34
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref35
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref35
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref35
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref35
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref36
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref37
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref38


534 O. Lloberas-Valls et al. / Comput. Methods Appl. Mech. Engrg. 308 (2016) 499–534

[40] T. Li, J.-J. Marigo, D. Guilbaud, S. Potapov, Gradient damage modeling of brittle fracture in an explicit dynamics context, Internat. J. Numer.
Methods Engrg. (2016) http://dx.doi.org/10.1002/nme.5262.

[41] J. Oliver, Continuum modelling of strong discontinuities in solid mechanics using damage models, Comput. Mech. 17 (1–2) (1995) 49–61.
[42] R. Faria, J. Oliver, M. Cervera, A strain-based plastic viscous-damage model for massive concrete structures, Int. J. Solids Struct. 35 (14)

(1998) 1533–1558.
[43] J. Oliver, On the discrete constitutive models induced by strong discontinuity kinematics and continuum constitutive equations, Int. J. Solids

Struct. 37 (48) (2000) 7207–7229.

http://dx.doi.org/10.1002/nme.5262
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref41
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref42
http://refhub.elsevier.com/S0045-7825(16)30424-8/sbref43

	Strain injection techniques in dynamic fracture modeling
	Introduction
	Model description
	Governing equations of the IBVP
	Variational formulation
	Finite element model
	Partitions of  B  in subdomains with different kinematic descriptions
	Crack Path Field tracking algorithm
	Kinematic compatibility for complex fracture phenomena: crack branching
	Implicit time integration
	Global monitoring of the total dissipated energy

	Representative simulations
	Validation of the strain injection implementation against reference solutions
	Tension test
	Compact tension test

	Dynamic simulations of quasi-brittle fracture
	Dynamic fracture at different loading rates
	Crack tip velocities
	Branching identification based on the dissipation  D 
	Objectivity tests

	Towards simulations of brittle failure involving complex fracture phenomena

	Conclusions
	Acknowledgments
	Finite element formulation
	Weak discontinuity injection in  Bwd . Constant stress-discontinuous strain mode (CS-DSM)
	Strong discontinuity injection in  Bsd . Discontinuous displacement mode (DDM)

	Regularized local damage model
	Dissipation density and related physical quantities frequently used in this work
	Dissipation density generated by stresses acting at the cohesive surface  S 

	Derivation of the total internal energy
	References


