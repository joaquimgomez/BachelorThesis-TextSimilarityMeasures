






















































Adaptive and Off-Line Techniques for Non-Linear Multiscale Analysis


Adaptive and O�-Line Techniques for Non-Linear Multiscale

Analysis

Stefano Zaghia, Xavier Martineza,c,∗, Riccardo Rossia,b, Massimo Petraccad

aCIMNE - Centre Internacional de Metodes Numerics en Enginyeria, Universitat Politècnica de
Catalunya (UPC-BarcelonaTech), Barcelona 08034, Spain

bDepartment of Civil and Environmental Engineering, Universitat Politècnica de Catalunya
(UPC-BarcelonaTech), Barcelona 08034, Spain

cDepartment of Nautical Science and Engineering, Universitat Politècnica de Catalunya
(UPC-BarcelonaTech), Barcelona 08003, Spain

dDepartment of Engineering, University "G.d'Annunzio" of Chieti and Pescara, Pescara 65127, Italy

Abstract

This paper presents two procedures, based on the numerical multiscale theory, developed
to predict the mechanical non-linear response of composite materials under monotoni-
cally increasing loads. Such procedures are designed with the objective of reducing the
computational cost required in these types of analysis. Starting from virtual tests of the
microscale, the solution of the macroscale structure via Classical First-Order Multiscale
Method will be replaced by an interpolation of a discrete number of homogenized surfaces
previously calculated. These surfaces describe the stress evolution of the microscale at
�xed levels of an equivalent damage parameter (deq). The information required for these
surfaces to conduct the analysis is stored in a Data Base using a json format. Of the two
methods developed, the �rst one uses the pre-computed homogenized surface just to ob-
tain the material non-linear threshold, and generates a Representative Volume Element
(RVE) once the material point goes into the nonlinear range; the second method is com-
pletely o�-line and is capable of describing the material linear and non-linear behavior
just by using the discrete homogenized surfaces stored in the Data Base. After describ-
ing the two procedures developed, this manuscript provides two examples to validate the
capabilities of the proposed methods.

Keywords: Multiscale, Multiphysics, Optimization

Introduction

A composite material is de�ned as a complex structure characterized by two or more
components with di�erent mechanical, thermal and/or chemical properties. The combi-
nations of multiple constituents leads to a new material that usually improves signi�cantly

∗corresponding author
Email addresses: zstefano@cimne.upc.edu (Stefano Zaghi), xmartinez@cimne.upc.edu (Xavier

Martinez), rrossi@cimne.upc.edu (Riccardo Rossi), mpetracca@cimne.upc.edu (Massimo Petracca)

Preprint submitted to Elsevier August 1, 2018



the properties of the base materials. Examples of composites are the �ber reinforced poly-
mers (FRP) or even the reinforced concrete used in civil engineering applications. From
a numerical point of view the simulation of these non-homogeneous materials has always
represented a challenge because of the interaction between the di�erent constituent ma-
terials, associated to the usually complex composite internal micro-structure. Modelling
each single component of the composite, also called Direct Numerical Simulation (DNS),
provides the highest level of accuracy but, at the same time, the simulation of large-
scale structures implies a prohibitively expensive computational cost. For this reason,
to increase the e�ciency of the simulations, the non-homogeneous composite materials
are often treated as homogeneous continua characterized by more complex constitutive
models. The classical mixing theory [1] is one of the most used phenomenological ho-
mogenization methods. The mechanical behavior of the composite is obtained as the
homogenized results of the mechanical properties of the components assuming an iso-
strain compatibility equation among them. Another important formulation, based on
a phenomenological homogenization, that accounts for a more general topological dis-
tribution of the components in the composite is the Serial/Parallel (SP) mixing theory.
This theory, developed by [2] [3], distinguishes two behaviors of the composite depending
on the alignment of the �ber on the composite. Iso-strain and iso-stress conditions are
applied in the �ber direction, and in the orthogonal direction, respectively. The serial-
parallel theory obtains the response of the composite assuming certain iso-stress and
iso-strain boundary conditions that regularizes the response of the material if it is de-
�ned with several laminates. However, phenomenological homogenization describes the
behavior of composite materials only at macroscopic level. This method cannot describe
accurately the stress and strain distribution among the components. Thanks to the in-
crease in computer capabilities, multiscale homogenizations started to become a viable
alternative. First-Order Multiscale Method [4] [5], or FM, starts from the assumption of
the scale separation from the macro and the microstructure [6] and analyzes the behavior
of the macro structure at each integration point solving a Representative Volume Ele-
ment (RVE) or unit cell, which is modelled as another independent structure. An RVE is
a geometrical representation of the microstructure, subjected to the macroscopic defor-
mation gradient. Complex RVE, with linear and non-linear behaviors, could be modelled
with FM method as it is studied by [7] [8] [9] [10] [11]. Of course, this methodology has
a high computational cost since the microstructure shall be calculated for each integra-
tion point of the macroscale. Indeed, it will replace the constitutive law representing
the material. Several model reductions were developed for the optimization of that type
of analysis like Response Surface Models (RSM) [12], proper orthogonal decomposition
(POD) [6] or others [13] [14]. When considering the problem of localized deformations,
we can observe that in most of the cases the fracture only involves a very small area of
the structure. This means that most of the material is still in the linear-elastic regime
and does not require the RVE. In particular, Otero et al. [14] use a non-linear activation
function that is de�ned considering the maximum level of an elastic energy density that
can be applied to the RVE before its failure. Despite the high computational e�ort ob-
tained with this procedure, with this method any changes at the macroscale level require
the re-computation of the non-linear activation function even when using the same RVE.
Another approach that can be used to optimize the computational cost of multiscale
analyses consist on just determining the failure threshold of the structure. In this case the
full multiscale analysis is replaced by a linear calculation using the obtained mechanical

2



homogenized properties of the RVE. Then, in a post-process analysis, the most critical
RVE are studied, i.e. those with larger elastic stresses, subjecting them to the same loads
of the macrostructure.
The purpose of this work is to de�ne a computationally e�cient multiscale procedure
able to predict the mechanical non-linear response of composite materials. This will be
achieved, using an RVE Data Base (DB) calculated a-priori. Through the de�nitions of
an equivalent damage parameter (deq), function of the global stress at the microscale,
a series of strain controlled virtual tests of the RVE are performed storing in the DB
the homogenized stress and strain state reached at certain levels of deq. Afterwards,
the solution of the macroscale structure via Classical First-Order Multiscale Method is
replaced by the interpolation of the stored data.
The �rst proposed method, named Discrete Threshold Surface de�nition (DMTS), will
provide the generation of the RVE in the non-linear part of the structure, while the
second one, named Discrete Multiscale Constitutive Model (DMCM), is completely o�-
line and uses only the stress information stored in the DB. Special attention has been
paid on creations and validation of the Data Base followed by the study of a complete
composite structure comparing the speedup obtained with both methods.
In the �rst part of the paper we give a brief description of the First-Order Multiscale
Methods. Then we report the algorithm and the formulation for both proposed tech-
niques with special attention on the Data Base creations and implementation. After-
wards, as validation, we compare the full multiscale method with the proposed ones.
Finally, we study a complete composite structure comparing the speedup obtained in
both cases.

1. Classical First-Order Multiscale Method

One of the most popular multiscale methods is the �rst-order homogenization. In this
procedure, the strain obtained when analyzing the macroscopic structure is used to de-
�ne the boundary conditions, applied on a Representative Volume Element (RVE), to
solve the Boundary Value Problem (BVP) at the microscale. The basic principles of
homogenization method were provided by Suquet [5] to obtain the constitutive equation
for the homogenized properties of a heterogeneous material. The unit cell is de�ned as
a microscopic subregion that is representative of the entire microstructure in an average
sense. The RVE is employed to obtain the e�ective properties for the homogenized ma-
terial because it is assumed that it must contain a su�cient number of heterogeneities
[15] [16]. The solution of the problem at the microscale, under such conditions, acts
as an equivalent constitutive law for the macroscale, and it provides material sti�ness
and stresses as the volume average of the microscopic ones. This equivalent constitu-
tive law is used in all the integration points of the macroscopic model to obtain the
global response of the structure. When dealing with nonlinear microstructures, it will
lead to an iterative procedure in which the RVE must be solved for di�erent boundary
conditions until both scales reach equilibrium, ensuring consistency between the micro-
and macroscale solutions. The �rst-order homogenization technique developed assumes a
scale separation between the macro and the microscale. This is, the characteristic length
of the microscale should be much smaller than the length of the macroscale elements,
L : l << L [6]. The main steps of a classical FM technique can be resumed in the Figure
[1]. On each integration point of the discretized macroscale domain, the macroscopic

3



strain tensor provides the input variables for the microscale domain. Then, the solution
of the microscopic behavior of the RVE provides the macroscopic output and properties
of the equivalent homogeneous medium.

Figure 1: Representative homogenization scheme

In this paper, for the sake of simplicity, the procedure assumes small displacements
and a quasi-static behavior in both macro and micro scales. However, the methodology
proposed can be extended to other cases.

1.1. Macro to micro transition

At the macro level, the starting point for a kinematically based computational homoge-
nization method is the assumption that the mechanical strain tensor, εm, at each point
of the macroscale domain, Ωm (where the position is de�ned through the vector xm),
and at a certain instant t can be obtained as the volume average of the microscopic
mechanical strain �eld, εµ, de�ned at each point of the microscale domain, Ωµ (where
the position is de�ned through the vector xµ), and at the same instant t as:

εm(xm, t) =
1

Vµ

∫
Ωµ

εµ(xµ, t)dV (1)

From the Eq. [1] the microscopic strain �eld can be expressed as the symmetric gradient
of the microscopic displacement �eld, uµ = (u

x
µ, u

y
µ):

εm(xm, t) =
1

Vµ

∫
Ωµ

∇suµdV (2)

Or using the Gauss theorem:

εm(xm, t) =
1

Vµ

∫
∂Ωµ

uµ ⊗s ndA (3)

4



Where n is the outward unit normal �eld on the RVE boundary δΩµ.
Without loss of generality, we can decompose the microscale displacement as:

uµ(xµ, t) = εm(xm, t) · (xµ − xg) + ũµ(xµ, t) (4)
where uµ(xµ, t) and ũµ are respectively the constant and �uctuation displacements with
respect to the average �elds xg (the centroid of the microscale) at each instant t.
In the same way the microscopic strain can be divided in two parts, a constant one from
the macroscopic scale (εm) and the contribution of �uctuation (ε̃µ).

εµ(xµ, t) = εm(xm, t) + ε̃µ(xµ, t) (5)

Moreover, the microscopic position vector xµ does not appear explicitly in the microstruc-
tural strain tensor expression (see Eq. [5]). Consequently, this variable does not ap-
pear in the microstructural stress tensor either. Therefore, the periodic microstructure
around the macro point xm does not have to be modeled with its exact dimensions. A
non-dimensional RVE with the internal distribution and volume fractions of the simple
materials is enough to obtain the microscopic strain and stress �elds. This is one of
the principal advantages of this �rst-order homogenization approach compared to other
multiscale high-order approaches [14]. On the other hand, it can be observed that the
kinematically admissible displacement �uctuation option used to satisfy the boundary
condition in the RVE problem a�ects the �nal macroscopic stress tensor obtained. Sev-
eral models have been de�ned that assume di�erent �uctuation �elds:

• Taylor model (or zero �uctuations): ũµ(xµ, t) = 0 ∀ xµ ∈ Ωµ This model gives
homogeneous deformation in the microstructural scale level.

• Linear boundary displacements (or zero boundary �uctuations): ũµ(xµ, t) = 0 ∀ xµ ∈
∂Ωµ. The deformation of the RVE boundary domain for this class are fully pre-
scribed.

• Periodic boundary �uctuations: ũµ(x+µ , t) = ũµ(x−µ , t) ∀ pair{x+µ ,x−µ } ∈ ∂Ωµ The
key kinematical constraint for this class is that the displacement �uctuation must
be periodic on the di�erent faces of the RVE.

• Minimal constraint (or uniform boundary traction): In this constraint the nontrivial
solution of

∫
∂Ωµ

uµ ⊗s ndA is obtained.

For the displacement �elds, we use periodic boundary conditions since they generally
provide an intermediate and more exact response compared to other type of boundary
conditions, as it is described in [16] [17] [18] [19] [14].

1.2. Micro to macro transition

Following the solution of the BVP [20] we get the homogenized macroscopic stress ten-
sor. In addition, we can obtain the homogenized constitutive tensor. The homogenized
macroscopic stress tensor can be obtained as the microscopic stress �eld of the RVE
averaged on the volume as [6] [21] [22]

σm =
1

Vµ

∫
Ωµ

σµ(xµ, t)dV (6)

5



1.3. Material homogenized properties

The macroscopic constitutive relation de�ned by the homogenized properties of the RVE
can be obtained after the solution of the microscale BVP. Assuming the equilibrium of
the microscale expressed as: ∫

Ωµ

σµ(xµ, t) : ∇sũµdV = 0 (7)

As is described in [23] and [14], the homogenized constitutive tensor CH can be de�ned
as:

CH =
1

Vµ

∫
Ωµ

CµdV (8)

where Cµ is the material constitutive tensor of the RVE. The evaluation of the homoge-
nized constitutive tensor is performed with a perturbation method, also see[8] [14]. For
each column j of the constitutive tensor, a small strain perturbation (δε̃j) is applied to
the RVE in order to obtain, along with Eq. [7], a perturbed stress tensor (δσ̃j). The j
columns of the homogenized constitutive tensor can be obtained as:

CH ≡
δσ̃j
δε̃j

(9)

2. Threshold Surface de�nition (DMTS) and Discrete Multiscale Constitu-
tive Model (DMCM)

In general, due to the complexity of the RVE, we cannot know a-priori the real stress
behavior of the microscale. To overcome this problem, we will study the strain space
doing a preliminary analysis of the RVE for di�erent loading cases storing the stress
response of the structure.
The purpose of this paper is to provide two multiscale optimization techniques, the
Discrete Multiscale Threshold Surface (DMTS) and the Discrete Multiscale Constitutive
Model (DMCM), directly derived from the classical �rst order multiscale theory (FM),
using periodic boundary condition as reference for future comparisons.
Considering these two methods, the main aim is to construct a strain collector Data Base
based on multiple simulations of the RVE able to describe the microscale behavior of the
material.
The DMTS method will describe with a �nite number of points, stored in the strain
collector Data Base, the boundary (threshold surface) of the elastic regime. Identifying
where a full RVE needs to be employed and where the homogenized elastic properties
are su�cient to obtain the macroscale response.
As an extension of the DMTS, the DMCM method aims to decouple the macroscale
analysis from the FM, interpolating multiple surfaces (also stored in the Strain Data
Base) that describes both linear and non-linear regime.
Below, the authors will describe in detail all the aspects of both methods, providing
examples and algorithms used for the numerical implementation.

6



2.1. Strain Data Base de�nition

The failure surface de�ned by the DMTS model, as well as the damage surfaces of the
DMCM model, are de�ned as a function of the applied strain on the composite. These
strains, de�ned as strain histories, are in the multidimensional spaces (εxx, εyy, εxy) for
2D or (εxx, εyy, εzz, εxy, εyz, εxz) for 3D mechanical problems. To make accessible this
information during the analysis we will store the strain histories in a Homogenized Strain
Data Base. In this section, for simplicity, we will only describe the 2D case, but it is
perfectly extendable to 3D.
To obtain a complete de�nition of the microscale behavior we will impose as strain
histories the value of equispaced points projected on the sphere of unitary radius centered
in the origin of the axes (εxx, εyy, εxy). We can uniquely de�ne these points in 3D
spherical coordinates system as the combination of three parameters (θ, ϕ, λ) , as we can
see in the Figure [2](a). Where the angles θ and ϕ represents the direction of the strain
loads that we applied to the microscale and λ is the unitary strain intensity. Then we
can obtain the components of the strain vector in cartesian coordinates as:


εxx = λ · cos(θ)
εyy = λ · sin(θ) · cos(ϕ)
εxy = λ · sin(θ) · sin(ϕ)

(10)

λ = ‖ε‖ =
√
ε2xx + ε

2
yy + ε

2
xy (11)

From Eq. [10] we can observe that the strain is periodic with sin and cos functions of
θ and ϕ, and that these two angles can be varying between [−π, π]. The subdivision
of this interval determines the number of analyses to perform and the precision of the
discretization.

Figure 2: (a)3D Strain Space, (b) Total number of analysis for 2D and 2D Reduced case

Introducing the parameterm ∈ [1,∞) as subdivision of the interval [0, π] we can uniquely
de�ne the strain direction with a pair of integer parameters ∈ [−m,m], that we will call

7



tag. With this method, each point is equally spaced from the other and the angles θ and
ϕ vary between [−π

m
, π
m

]. In that way, we can observe that the total amount of analyses
is (2 ·m+ 1)2. Considering the superposition of the same resulting strain directions the
amount of strain histories can be reduced to (2) · (m − 1) + 2. Despite this reduction,
we will remark that using a high value of m implies an exponential increasing of the
analyses, see Figure [2](b).
Once the strain loading directions are computed, we apply them to the RVE doing a
classical First Order Multiscale Analysis, as described in the section 1. As our interest
lays in the RVE performance, to reduce the computational cost this analysis is conducted
in a macroscale triangular FE element with a single gauss point, and in which the strains
are imposed as �xed displacement to the nodes. In this case, all the degrees of freedom
of the triangle are �xed and for each n time step we will solve the microscale problem,
evaluating the homogenized stress and constitutive tensor. With these information we
can determine the corresponding value of equivalent damage at each time step.

2.2. Equivalent damage de�nition

During a classical full multiscale analysis, the RVE is solved at each time step even if
the linear elastic limit of the material is not achieved. In terms of computational cost,
this is highly ine�cient. The two procedures proposed in this work will optimize this
performance with the use of a key parameter, called equivalent damage, that provide
the relation between the homogenized stress and the corresponding elastic one, once the
micro-model structure becomes non-linear. This parameter is de�ned as:

deq =
‖σel − σreal‖
‖σel‖

, deq ∈ [0, 1] (12)

where σreal is the homogenized stress, σel = C
H
el : ε is the elastic stress, and C

H
el is the

Homogenized Constitutive Elastic Tensor.
The characterization of the RVE response with a unique parameter is needed for the
interpolation of the Data Base DB information. In this way, we can obtain the stress
�ux surface at certain equivalent damage level and reconstruct the RVE behavior for any
strain directions interpolating the stored homogenized stress data. To speed up the Data
Base look-up and the parsing process, the information is stored in json format [24] that
provides a �exible, more compact, easier to parse and more human readable text.

2.3. Discrete Multiscale Threshold Surface

In this work we propose to de�ne the linear elastic threshold of the microstructure when
it reaches a equivalent damage, deq, equal to 0.1. Therefore, the Discrete Multiscale
Threshold Surface is represented by the corresponding stress at each tag studied. The
DMTS Data Base structure in json format provides a list of tags and corresponding
stress-strain vectors as proposed in Figure [3]:

8



Figure 3: Json Data Base Format for DMTS

To better understand the obtained Data Base, a graphical 3D visualization of DMTS
stresses in the strain space is proposed below for Tension-Compression damage material
used in section 4 and well explained in [25]

Figure 4: 3D visualization of DMTS for Tension-Compression Damage Law

Figure [5] shows a 3D visualtionation of a portion of the DMTS surface. In this �gure
point E corresponds to intersection of the elastic limit surface with the stress and strain
tensor applied on the macroscale structure. The points A,B,C,D correspond to the
nearest tags to point E, which are used to interpolate the results.

9



(a) (b)

Figure 5: Graphical representation of (a)Strain Space and (b) Stress Space for DMTS

The DMTS procedure veri�es if point E is inside or outside the elastic threshold surface
shown in Figure [4] and [5]. Having point E outside the threshold surface means that
there are some elements of the RVE damaged and, therefore, the elastic prediction made
is no longer valid. In this case the algorithm associates an RVE to the gauss-point which
will be used to obtain its constitutive performance in the rest of the simulation. This
whole procedure is described in the �ow diagram shown in Figure [6].

10



Figure 6: DMTS Algorithm

2.4. Discrete Multiscale Constitutive Model

The natural evolution of the DMTS model previously presented is the second method
proposed in this work. Indeed, the DMCM model stores the linear and non-linear perfor-
mance of the RVE behavior in the material Data Base. the stress-strain response related

11



to the equivalent damage parameter de�ned previously. Instead of only one value, cor-
responding to the elastic threshold, the DMCM approach computes and stores multiple
surfaces: the elastic threshold one and the ones corresponding to the non-linear behav-
ior, which are discretized with a series of equivalent damage levels ranging from 0 to 1.
A �nite number of surfaces are computed for the RVE, corresponding to a user-de�ned
number of damage levels. To obtain the strain and stress tensors associated to a given
value of the damage parameter, the strain increment applied to the RVE is iteratively
adapted, for each strain direction (tag), until the correct damage value is obtained. Hav-
ing stored the RVE performance in the linear and non-linear range, the FM analysis is no
longer needed, and the mechanical response of the macro-structure can be obtained from
the DB. Indeed, an additional interpolation method over the stored threshold surfaces
could be performed to predict the behavior of the macrostructure at each integration
point.
During the macroscale analysis, the algorithm evaluates the strain direction only at the
current time step without information about any previous strain orientation or magni-
tude. In case of changes in the load or coupling of failure phenomena, a misalignment
between the real loading path of the RVE and the DMCM solution is possible. Neverthe-
less, the validation examples proposed in section 4 provides a good correlation between
the Full Multiscale Method and the DMCM Method, making the error a�ordable.
Figure [7] shows a graphical representation, in the strain and stress space, of the DMCM
procedure.

(a) (b)

Figure 7: Graphical representation of (a)Strain Space and (b) Stress Space Evolution for DMCM

Points E and E′ represent the intersection of the direction of the stress and strain with
the surfaces at damage i and ii. Points A,B,C,D and A′, B′, C ′, D′ corresponds to the
nearest tag that is surrounding this direction for the di�erent level of damage. The value
of strain and stress for points E and E′ were determined by interpolating the data from
the DB of the nearest tag for each level of damage. In this way we can reconstruct the
stress strain response of the RVE for any possible direction in the strain space. The
DMCM algorithm is resumed in Figure [8]:

12



Figure 8: DMCM Algorithm

It is important to remark that, creating the DB with strain-controlled analysis, the refer-
ence surfaces in the strain space are convex. Considering advanced materials as reinforced
composites, the high dependence on the RVE geometry and the constitutive performance
of its constituent materials provide a global response comparable to a complex structure,
mathematically more complex than a classical homogeneous material. This complexity

13



re�ects to as well complex stress threshold surfaces.
In the same way as the DMTS, the DMCM Data Base was stored in json format [24].

Figure 9: Json Data Base Format for DMCM

The DB scheme provides at �rst level the tag. Then, for each tag, we will store the
information of σ and λ for di�erent values of equivalent damage analyzed.
Considering the number of analysis needed to create the stress-strain DB, which is pro-
portional to the discretization parameter m, it is obvious that as long as the number
of integration points at the macroscale level is higher than the number of tags, the ad-
vantages of the proposed method increases. Moreover, as we can see in the Figure [10],
where the numbers of RVEs simulations in case of DMCM is the total number of analyses
needed to create the stress-strain database. The author will remark that this number is
independent from the number of damage levels because for each analysis multiple values
can be stored. Indeed, in case of FM, as explained in section 1, the microscale structure
needs to be solved for each integration points of the macroscale.

Figure 10: Number of RVEs simulations in a 2D multiscale analysis for FM (�rst order triangular and
quadrilateral elements) and DMCM (discretization parameter m = 8)

14



2.5. Interpolation Methods

In order to determine if the stresses in the macro-model are below the threshold surface
or to know the equivalent damage parameter associated to the stress state, in the DMTS
and DMCM models respectively, we need to use an interpolation technique because
the most frequent scenario is that the strains associated with the stress analyzed do
not correspond to any of the tags previously calculated. The interpolation methods
implemented in DMTS and DMCM technique are:

• Nearest-neighbor: This method provides as output the value of the nearest point
without considering other neighboring points.

• Linear: this type of interpolation needs to know the values of the nearest 4 points
in order to perform a linear interpolation over each dimension.

• Cubic interpolation: in case of 2D interpolation this method required the values of
the nearest 16 points in the input data.

A comparison of the tree methods has been made for a well-known J2 material. In Figure
[11] is reported the elastic boundary in the strain space (εxx, εyy) for the 2D case. The
black line represents the conjunction of the reference tags, while the di�erent interpolation
methods are colored in green for the nearest-point method, in blue for the linear method
and in red for the cubic one. The authors observe that the Cubic interpolation provides
the best �tting of the theoretical J2 ellipsoid. Instead, the linear interpolation tends
to underestimate the interpolated magnitude due to the convexity of the surfaces under
study, as has been explained in section 2.3. Finally, Figure [11] shows that the nearest
neighbor approach does not provide good results, unless the known magnitudes are very
closed together.

Figure 11: Comparison of Di�erent Interpolation Techniques applied to a J2 plasticity constitutive law
database (black dashed lines). Section of (εxx, εyy) plane with (a) nearest-point, (b) linear and (c) cubic
interpolation method.

15



3. Data Base Regularization

In a FEM analysis an important aspect to consider is the mesh discretization of the
structure, namely the results must be independent of the mesh size. These aspects were
extensively investigated in [26] [27] [28] [29], where it is possible to observe how, during the
fracture process, the localization appears only on one band of the mesh. This localization,
as well as the fracture energy (Gf ) dissipated in during the fracture process, must be
independent of the mesh size. This is achieved by de�ning a volumetric fracture energy
(gf ) which is associated to the �nite element and its size. Larger �nite elements will
dissipate less energy per unit volume, in order to achieve the same structural response,
as we can see in Eq. [13]:

gf =
W

A

1

lf
=
Gf
lf

(13)

Where W is the total energy dissipated during the fracture process, A is the fracture
area, Gf is the fracture energy per unit of crack area A and gf is the fracture energy
per unit of volume. In case of multiscale analysis preserving the mesh objectivity is not
obvious and, as explained in [14] or [30], both characteristic lengths of the FE elements,
at the micro (lf,µ) and macro (lf,m) scale, need to be taken into account. In particular,
Otero et al. analysis preserving the mesh objectivity is not obvious and, as explained in
[14] and Petracca et al. [30] introduced a modi�ed characteristic length, that provides a
relation between the two length scales and the total length of the RVE (lf,RV E), in order
to preserve the correct dissipation.

l̃f = f(lf,µ, lf,m, lf,RV E) (14)

Figure 12: Fracture energy based regularization in 2-scale FEM (Petracca et al. [30])

This modi�ed characteristic length and the macroscale dissipation were de�ned as follow:

Wm =

∫
Am

gfdVm (15)

Wm = gf lf,mhmtm (16)
16



Where, hm is the length and tm is the thickness of the crack at the macroscale as in Figure
[12]. During the creation of the DB, this regularization process was adopted, where the
lf,m is the length of the macroscale element used to calculate the material database, that
from now on we will call lf,DB . Considering the intrinsic strain dependency of the DB we
will introduce a parameter α, function of the �nite element size and the global fracture
energy, that will modify the stored DB strain proportionally to the mesh re�nement
of the macroscale. To determine α we will de�ne Gf,DB as the global fracture energy
calculated as the integral of the norm of the stress, and G0 as the elastic counter part.

Gf = Gf,DB
lf,DB
lf,m

(17)

α =
Gf −G0

Gf,DB −G0
− 1 (18)

Then, at each time step i the regularized strain εi is calculated as in Eq. [19]. Where
εi,DB is the DB strain at the step i and ε0 is the DB strain corresponding to the linear
elastic boundary calculated for the DMTS method.

εi = εi,DB + α(εi,DB − ε0) (19)

In order to validate the proposed regularization approach, three di�erent models of the
same geometry with di�erent mesh sizes were studied, comparing the results with and
without regularizations. Geometry and mechanical properties of the model are given
respectively in Figure [13] and Table [1].

Table 1: Material Properties

E[MPa] ν σt[MPa] Gt[
J
m2

]

20000.0 0.15 2.2 0.012

17



(a)

(b)

(c)

Figure 13: Comparison of Force-Displacement evolution between di�erent mesh size for Non-Regularized
Method. (a) Macro 1x1, (b) Macro 2x2, (c) Macro 3x3. The contour �eld represents the applied
displacement.

As expected, the response is more brittle with �ner meshes and using the proposed
regularization technique all the analyses give the same result as we can see in the Figure
[14], obtaining the objectivity respect to the macro-scale FE size.

18



Figure 14: Force-Displacement Curve corresponded to the Regularized case.

4. Numerical Validation

4.1. Shear test on damage material with di�erent threshold values for tension and com-
pression

The �rst validation model that is analyzed corresponds to a shear test made on a unitary
(1m) square geometry. This macro-model is made with just one bulk material, which
is de�ned using a damage law with di�erent failure threshold for tensile and compres-
sive stresses. This analysis can be solved without the need of a multiscale procedure.
Therefore it will be used to validate the capability of the developed methods, DMTS and
DMCM, to predict the material response. The macro-element is simulated with 11x11
small displacement quadrilateral elements; while the micro-element is simulated with a
mesh of 1x1 quadrilateral element, and with a material with the damage constitutive law
presented in [25], which properties are described in Table 3.
In this case, the discretization parameter used to construct the stress-strain database
is m = 8 that required a minimum of 114 analyses of the RVE. While, the levels of
damage stored for each direction are [0.01, 0.05, 0.1, 0.5, 0.7, 0.8, 0.9, 0.99, 0.999]. Each
one of the analyses was carried out with a single standard PC equipped with an Intel
Core i7-6700HQ CPU and 8 GB RAM. In Table [2] is reported the computational e�ort
required for both DMTS and DMCM methods.

19



Table 2: Computational cost for Database construction of RVE with di�erent threshold values for tension
and compression in case of DMTS and DMCM method

Type Time Full Database [s] Memory Single RVE [MB]

DMTS 154 19.1
DMCM 585 19.1

Table 3: Material Properties

E[MPa] ν σt[MPa] Gt[
J
m2

] σc[MPa] Gc[
J
m2

]

900.0 0.15 0.25 0.016 10.5 40.0

Figure [15] shows a 3D representation of the surface obtained from the RVE for a equiv-
alent damage parmater deq = 0.1, which will be used as the failure threshold surface
in the simulation. This �gure also shows the cuts of this surface with planes (εxx, εyy),
(εxx, Gxy) and (εyy, Gxy). Figure [16] shows the intersection of the calculated sufraces
with plane (εxx, εyy) for equivalent damage values of deq = 0.1, 0.5, 0.9.

20



(a) (b)

(c) (d)

Figure 15: Elastic threshold surface for damage material with di�erent threshold values for tension and
compression

21



(a) (b)

Figure 16: Threshold surface evolution for damage material with di�erent threshold values for tension
and compression

As expected, observing the stress space evolution, the surfaces become smaller with the
increase of the damage parameter. In the compression zone, due to an initial hardening,
the stress for deq = 0.5 is bigger than the previous one at deq = 0.1.
Once having analyzed the RVE in all possible directions and constructed its associated
DB, it is possible to use it to conduct macro-analysis of a structural component. As
mentioned previously, current validation will be made on a square specimen subjected
to a shear load.
The DMTS procedure uses the information stored in the database only to verify if the
material has exceeded its elastic threshold. In such case, it will be de�ned an RVE
associated to that material point and its mechanical performance will be obtained from
the RVE during the rest of the analysis. On the other hand, the elements that are still in
the linear regime do not need the RVE generation. If the analysis is conducted with the
DMCM procedure, the response of the macro-scale is obtained entirely from the RVE
response previously computed and stored in the DB. Therefore, the multiscale analysis is
conducted only at the macro-scale level, with the obvious advantages in term of memory
and time.
In order to validate properly the DMTS and the DMCM procedures proposed, this sim-
ulation has been also analyzed with a full multiscale scheme (FM). The results from this
analysis will be considered reference values and will show the computational improve-
ments obtained with the proposed methodologies.

22



Figure 17: Force-Displacement result for shear test

Figure [17] shows that the global response of the structure, in both linear and non-linear
ranges, is identical independently of the numerical approach considered, which proves
the validity of the DMTS and DMCM procedures for conducting multiscale analysis of
structures. Both procedures not only provide the same structural performance, but they
do it with a substantially smaller computational cost, as it is shown by the values of Table
[4]. In this example, the DMCM procedure reduces the computational time to a third and
the computational cost to a sixth if compared to the FM procedure. The improvement
provided by the DMTS procedure is not so signi�cant, but this is because most of the
elements on the simulation reach their non-linear threshold, and, the more elements in
the non-linear range, the more that the method requires the same computational cost as
a FM procedure. This situation is reduced in large structures, where the elements that
su�er damage are a minimal portion of the whole structure.
In Table [4] are also reported the corresponding time speedup for both cases without
considering the time spent to generate the database since it is independent from the
performed analysis.

Table 4: Computational cost for Full Multiscale Method, DMTS and DMCM

Type T ime[s] Memory[kB] NumberofActiveRV Es T imeSpeedup

Full Multiscale 844.72 169788 484/484 -
DMTS 646.39 92140 388/484 1.307
DMCM 282.01 26696 0/484 2.995

23



We also provide in the following �gures the evolution of uy, σmin, εmax, deq for each
analyzed method at di�erent level of deformation in y − direction. We can appreciate
how the results obtained with DMTS and DMCM re�ect the reference values calculated
with FM.

Figure 18: Contour plot of uy

0.5mm 2.25mm 4.5mm uy

FM

DMTS

DMCM

24



Figure 19: Contour plot of σmin

0.5mm 2.25mm 4.5mm σmin

FM

DMTS

DMCM

25



Figure 20: Contour plot of εmax

0.5mm 2.25mm 4.5mm εmax

FM

DMTS

DMCM

26



Figure 21: Contour plot of deq

0.5mm 2.25mm 4.5mm deq

FM

DMTS

DMCM

4.2. Reinforced composite beam section

In this section we analyze a reinforced composite beam section comparing the three
proposed methods. The microscale used is a long �ber reinforced composite, contains
F155 Epoxy Resin matrix and Carbon �ber (simulated as elastic material for simplicity).
The geometry of the RVE was composed by 5 symmetric inclusions and the mesh used
for the micro scale is composed by 272 small displacement linear elements with 305
nodes. The macroscale structure is composed by 1075 triangular elements and 678 nodes
subjected to a vertical displacement uy. Geometry and boundary conditions of the beam
and RVE are described in the Figure [22]. The analysis was performed by using plane
stress theory and considering 200mm as thickness of the beam.
In this case, as in the section 4.1, the discretization parameter used to construct the
stress-strain database is m = 8 that required a minimum of 114 analyses of the RVE.
While, the levels of damage stored for each direction are [0.01, 0.05, 0.1, 0.5, 0.7, 0.8,
0.9, 0.99, 0.999]. Each one of the analyses was carried out with a single standard PC
equipped with an Intel Core i7-6700HQ CPU and 8 GB RAM. In Table [5] is reported
the computational e�ort required for both DMTS and DMCM methods.

27



Table 5: Computational cost for Database construction of composite RVE in case of DMTS and DMCM
method

Type Time Full Database [s] Memory Single RVE [MB]

DMTS 461 24.5
DMCM 1382 24.5

(a) (b)

Figure 22: Geometry in [mm], boundary conditions and mesh discretization for beam and RVE models

Table 6: Material Properties of F115 Epoxy Resin

E[MPa] ν σt[MPa] Gt[
J
m2

] σc[MPa] Gc[
J
m2

]

3.24e3 0.32 80 0.73 240 2.19

Table 7: Material Properties of Carbon �ber

E[MPa] ν

235e3 0.21

28



In Figure [23] are reported the sections in the σxx, σyy plane the elastic limit surface for
deq = 0.01 and the stress evolution for deq = 0.1, 0.5 for the composite.
Each graph shows the stress tensor associated to a given damage level, as well as the
damage parameter in the RVE at certain points of the graph. These show that failure
begins and evolves in the matrix material in contact with �bers.
Another important result shown in Figure [23] is the lost of convexity of the stress curves,
as well as the combination of hardening and softening behaviours, depending on the
strains applied to it. This phenomena cannot be captured by a regular constitutive law,
which makes imperative the use of multiscale procedures or discrete multiscale procedures
such the ones proposed in this work.

29



(a) (b)

(c) (d)

Figure 23: Composite Stress Evolution Surfaces

In order to reduce the computational cost of the numerical analysis, in case of Full
Multiscale and DMTS methods, only 84 elements are considered with double scale, using
elastic homogenized properties in the rest of the structure. As we can see in the Figure
[24], Force-Displacement curves of DMTS and DMCM methods overlap and achieve the
same maximum value of force of the FM2 case. Therefore, this result shows that the two
procedures developed are capable of predicting the global structural response. However,
our interest lays on obtaining the global response, as well as a good prediction of the
failure region and failure mode of the structure. This is shown by the contour plots
shown in Figure [27].

30



(a) (b)

Figure 24: Force-Displacement evolution for the Ful Multiscale, DMTS and DMCM methods

Figure [25] shows the equivalent damage distribution on the beam and in the microstruc-
ture at the end of the analysis, corresponded to uy = 2.5[mm].
In addition, regarding the DMTS method, in Figure [26] we proposed a portion of the
beam where we can observe, in red, the total number of the elements that exceed the
threshold surface. Indeed, during the analysis, the elements where the RVEs are gener-
ated increase proportionally to the non-linear behavior of the structure.

31



(a) (b)

(c)

Figure 25: Equivalent damage distribution for Full Multiscale (a), DMTS (b), DMCM (c)

(a) (b) (c)

Figure 26: Macroscale elements that exceed the DMTS linear elastic boundary at uy = 0.0[mm] (a),
uy = 2.27[mm] (b) and uy = 2.5[mm] (c)

32



Stress and strain distribution, when the 50% of maximum force (1250[N ]) was achieved,
are reported in the �gures below in order to appreciate the correspondence between the
reference FM results and the proposed methods.

Figure 27: Comparison between Full Multiscale, DMTS and DMCM for deq , σmax, σmin and deformation
εmax, εmin

FM DMTS DMCM

deq

σmax

σmin

εmax

εmin

33



In case of reinforced composite beam, computational e�ort decreases signi�cantly using
the optimization method proposed in this paper. Indeed, as we can see in Table [8], we
obtain a speedup of 4.7 and 661.2 for DMTS and DMCM method respectively. Each one
of the analyses was carried out with a single standard PC equipped with an Intel Core
i7-6700HQ CPU and 8 GB RAM.
The authors will remarks that, as in section 4.1, in Table [8] the reported time speedup
not considers the time spent to generate the database described in Table [5].
Despite of the 70 RVEs generated in the DMTS, against the 84 of the FM, we are still
having advantages using this method. Moreover, DMCM it is clearly faster than FM2
and DMTS as well. The linear interpolation of the RVE strain history can provide a non-
linear behavior of the macrostructure, able to reproduce crack initiation and propagation.

Table 8: Computational cost for Full Multiscale Method, DMTS and DMCM

Type T ime[s] Memory[MB] NumberofActiveRV Es T imeSpeedup

Full Multiscale 40267.5 152.2 84/1075 -
DMTS 8609.9 108.7 70/1075 4.7
DMCM 60.9 33.1 0/1075 661.2

5. Extension of the formulation to the 3D case

The two procedures proposed in this work DMTS and DMCM have been implemented
in a two-dimensional space. The extension of the formulation to the 3D case is quite
straightforward, as the FE code implementation needs only some marginal changes in
the parsing loop over the tags. Indeed, as in the 2D case, we can uniquely de�ne the strain
direction subdividing the interval [0, π] of each dimension with the parameterm ∈ [1,∞).
In that way we obtain (2 ·m + 1)5 sequence of 5 tags, one for each dimension, covering
all the 5D-Hypersphere. Also in this case, we can reduce the total amount of strain
histories, considering the superposition of the vectors, to ((((2 ·m) · (m− 1) + 2) · (m−
1) + 2) · (m− 1) + 2) · (m− 1) + 2.
Obviously, compared to the 2D the computational costs increase signi�cantly in terms of
number of analysis needed to cover all the strain spaces, as we can see in the Figure [28].
Despite the increase on the computational cost required to generate a material 3D
database, we can obtain enormous advantages during the a-posteriori analysis at the
structural level. Time and memory consumption of the macroscale analysis, thanks to
the DMCM technique, become equal to a linear elastic constitutive law because the
procedure only requires the interpolation of the stress-strain database values.

34



Figure 28: Comparison of Number of Analysis VS discretization parameter for 3D and 2D Case in both
classical and reduced form

6. Conclusions

First order multiscale homogenization method can fully describe both linear and non-
linear behavior of complex microstructures, and the impact they have on the macroscale
response. However, the computational cost required to analyze large structures is not
negligible. In the last years, many methods have been developed to overcome this prob-
lem. In this paper, the authors propose two techniques that can provide a signi�cant
speed-up compared to the classical FM without loss of accuracy on the �nal results. By
conducting a previous �nite element analysis of the RVE, the DMTS procedure gives the
linear elastic threshold. Once this is reached, it becomes necessary to solve the RVE in
that given material point to obtain the non-linear material performance.
On the other hand, the Discrete Multiscale Constitutive Model (DMCM) comes as a
natural extension of the DMTS. With this procedure, during the initial analysis of the
RVE it is computed, not only the threshold surface in which the non-linear behavior
starts, but the surfaces associated to di�erent damage values. Aftwerards, the non-linear
multiscale anaysis can be done using only the values stored in the database, without
having to solve the RVE at any time.
The keys of both methods are the precomputed Stress-Strain Data Base and the equiv-
alent damage parameter, essential to reconstruct the correct behavior of the structure.
Moreover, the JSON format used to construct the database makes all the data more read-
able, faster and easier to manage. A fracture-energy-based regularization procedure is
also proposed in order to remove the dependence of the results on macro and micro-scale
mesh size. Thanks to the proposed regularization, the Stress-Strain Data Base becomes

35



independent from the macro-scale mesh discretization. DMTS and DMCM methods are
validated by a simple benchmark analysis and by a more complex analysis of a rein-
forced composite beam, showing the capability and robustness of these techniques. The
achieved speed-up of more than 600 times respect to FM and the accuracy of the results,
justi�es the time spent to obtain the Stress-Strain Data Base.

Acknowledgments

This work has been supported by European Research Council through of Advanced
Grant: ERC-2012-AdG320815 (COMP-DES-MAT), by the Spanish Ministerio de Econo-
mia y Competividad through the project: MAT2014-60647-R (OMMC) and BIAS2015-
67807-R (RESCICLO), by European Union EU-H2020 (Agreement No 690638) and the
People's Republic of China (Agreement No [2016]92) (ECOCOMPASS). All this support
is gratefully acknowledged.

36



References

[1] E. Car, S. Oller, E. Oñate, An anisotropic elastoplastic constitutive model for large strain analysis
of �ber reinforced composite materials, Computer Methods in Applied Mechanics and Engineering
185 (2) (2000) 245 � 277, ISSN 0045-7825, doi https://dx.doi.org/10.1016/S0045-7825(99)00262-5,
URL http://www.sciencedirect.com/science/article/pii/S0045782599002625.

[2] F. Rastellini, S. Oller, O. Salomón, E. Oñate, Composite materials non-linear modelling
for long �bre-reinforced laminates: Continuum basis, computational aspects and validations,
Computers & Structures 86 (9) (2008) 879 � 896, ISSN 0045-7949, doi https://dx.doi.org/
10.1016/j.compstruc.2007.04.009, URL http://www.sciencedirect.com/science/article/pii/
S0045794907001642, composites.

[3] X. Martinez, S. Oller, F. Rastellini, A. H. Barbat, A numerical procedure simulating RC structures
reinforced with FRP using the serial/parallel mixing theory, Computers & Structures 86 (15) (2008)
1604 � 1618, ISSN 0045-7949, doi https://dx.doi.org/10.1016/j.compstruc.2008.01.007, URL http:
//www.sciencedirect.com/science/article/pii/S0045794908000096.

[4] E. Sanchez-Palencia, Non-Homogeneous Media and Vibration Theory, 127, Springer-Verlag Berlin
Heidelberg, 1 edn., ISBN 978-3-540-39317-7, doi https://dx.doi.org/10.1007/3-540-10000-8, 1980.

[5] P. M. Suquet, Local and Global Aspects in the Mathematical Theory of Plasticity, Plasticity Today
(1985) 279�309URL https://ci.nii.ac.jp/naid/10009833388/en/.

[6] J. Hernández, J. Oliver, A. Huespe, M. Caicedo-Silva, J. Cante, High-performance model reduction
techniques in computational multiscale homogenization, Computer Methods in Applied Mechanics
and Engineering 276 (2014) 149�189.

[7] F. Otero, X. Martinez, S. Oller, O. Salomon, Study and prediction of the mechanical performance
of a nanotube-reinforced composite, Composite Structures 94 (2012) 2920�2930.

[8] F. Otero, S. Oller, X. Martinez, O. Salomon, Numerical homogenization for composite materials
analysis. Comparison with other micro mechanical formulations, Composite Structures 122 (2015)
405�416.

[9] L. G. N. R. D. Quinteros, S. Oller, Nonlinear homogenization techniques to solve masonry structures
problems., Composite Structures 94 (2) (2012) 724�730.

[10] S. Oller, J. Miquel Canet, F. Zalamea, Composite Material Behavior Using a Homogenization
Double Scale Method, Journal of Engineering Mechanics-asce - J ENG MECH-ASCE 131, doi
https://dx.doi.org/10.1061/(ASCE)0733-9399(2005)131:1(65).

[11] E. Car, F. Zalamea, S. Oller, J. Miquel, E. Oñate, Numerical simulation of �ber reinforced composite
materials - Two procedures, International journal of solids and structures 39 (2002) 1967�1986.

[12] J. Yvonnet, Q.-C. He, The reduced model multiscale method (R3M) for the non-linear homogeniza-
tion of hyperelastic media at �nite strains, Journal of Computational Physics 223 (2007) 341�368.

[13] I. Temizer, P. Wriggers, An adaptive method for homogenization in orthotropic nonlinear elasticity,
Computer Methods in Applied Mechanics and Engineering 196 (2007) 3409�3423.

[14] F. Otero, X. Martinez, S. Oller, O. Salomón, An e�cient multi-scale method for non-linear anal-
ysis of composite structures, Composite Structures 131 (2015) 707 � 719, ISSN 0263-8223, doi
https://doi.org/10.1016/j.compstruct.2015.06.006, URL http://www.sciencedirect.com/science/
article/pii/S0263822315004699.

[15] M. Geers, V. Kouznetsova, W. Brekelmans, Multi-scale �rst-order and second-order computational
homogenization of microstructures towards continua, International Journal for Multiscale Compu-
tational Engineering 1 (4) (2003) 371�386, ISSN 1543-1649, doi 10.1615/IntJMultCompEng.v1.i4.

[16] T. Kanit, S. Forest, I. Galliet, V. Mounoury, D. Jeulin, Determination of the size of the represen-
tative volume element for random composites: statistical and numerical approach, International
Journal of Solids and Structures 40 (13) (2003) 3647 � 3679, ISSN 0020-7683, doi https://dx.
doi.org/10.1016/S0020-7683(03)00143-4, URL http://www.sciencedirect.com/science/article/
pii/S0020768303001434.

[17] M. Jiang, M. Ostoja-Starzewski, I. Jasiuk, Scale-dependent bounds on e�ective elastoplastic re-
sponse of random composites, Journal of the Mechanics and Physics of Solids 49 (2001) 655�673.

[18] M. Jiang, I. Jasiuk, M. Ostoja-Starzewski, Apparent elastic and elastoplastic behavior of periodic
composites, International Journal of Solids and Structures 39 (2002) 199�212.

[19] M. Ostoja-Starzewski, Ostoja-Starzewski, M.: Material spatial randomness: from statistical to
representative volume element., Probabilistic Engineering Mechanics 21 (2006) 112�132.

[20] R. Hill, A self-consistent mechanics of composite materials, Journal of the Mechanics and Physics
of Solids 13 (4) (1965) 213 � 222, ISSN 0022-5096, doi https://dx.doi.org/10.1016/0022-5096(65)
90010-4, URL http://www.sciencedirect.com/science/article/pii/0022509665900104.

37

http://dx.doi.org/https://dx.doi.org/10.1016/S0045-7825(99)00262-5
http://www.sciencedirect.com/science/article/pii/S0045782599002625
http://dx.doi.org/https://dx.doi.org/10.1016/j.compstruc.2007.04.009
http://dx.doi.org/https://dx.doi.org/10.1016/j.compstruc.2007.04.009
http://www.sciencedirect.com/science/article/pii/S0045794907001642
http://www.sciencedirect.com/science/article/pii/S0045794907001642
http://dx.doi.org/https://dx.doi.org/10.1016/j.compstruc.2008.01.007
http://www.sciencedirect.com/science/article/pii/S0045794908000096
http://www.sciencedirect.com/science/article/pii/S0045794908000096
http://dx.doi.org/https://dx.doi.org/10.1007/3-540-10000-8
https://ci.nii.ac.jp/naid/10009833388/en/
http://dx.doi.org/https://dx.doi.org/10.1061/(ASCE)0733-9399(2005)131:1(65)
http://dx.doi.org/https://dx.doi.org/10.1061/(ASCE)0733-9399(2005)131:1(65)
http://dx.doi.org/https://doi.org/10.1016/j.compstruct.2015.06.006
http://dx.doi.org/https://doi.org/10.1016/j.compstruct.2015.06.006
http://www.sciencedirect.com/science/article/pii/S0263822315004699
http://www.sciencedirect.com/science/article/pii/S0263822315004699
http://dx.doi.org/10.1615/IntJMultCompEng.v1.i4
http://dx.doi.org/https://dx.doi.org/10.1016/S0020-7683(03)00143-4
http://dx.doi.org/https://dx.doi.org/10.1016/S0020-7683(03)00143-4
http://www.sciencedirect.com/science/article/pii/S0020768303001434
http://www.sciencedirect.com/science/article/pii/S0020768303001434
http://dx.doi.org/https://dx.doi.org/10.1016/0022-5096(65)90010-4
http://dx.doi.org/https://dx.doi.org/10.1016/0022-5096(65)90010-4
http://www.sciencedirect.com/science/article/pii/0022509665900104


[21] E. de Souza Neto, R. Feijóo, EA de Souza Neto, RA Feijoo. Variational Foundations of Multi-Scale
Constitutive Models of Solid: Small and Large Strain Kinematical Formulation, LNCC R&D Report
.

[22] J. O. J. M. Ortolano J., A. Hernández, A Comparative Study on Homogenization Strategies for
Multi-Scale Analysis of Materials, Monograph CIMNE 135.

[23] S. Ghosh, K. Lee, S. Moorthy, Two scale analysis of heterogeneous elastic-plastic materials with
asymptotic homogenization and Voronoi cell �nite element model, Computer Methods in Ap-
plied Mechanics and Engineering 132 (1) (1996) 63 � 116, ISSN 0045-7825, doi https://dx.doi.
org/10.1016/0045-7825(95)00974-4, URL http://www.sciencedirect.com/science/article/pii/
0045782595009744.

[24] JSON (JavaScript Object Notation), URL http://www.json.org/, 1999.
[25] M. Petracca, L. Pelà, R. Rossi, S. Zaghi, G. Camata, E. Spacone, Micro-scale continuous and discrete

numerical models for nonlinear analysis of masonry shear walls, Construction and Building Materials
149 (2017) 296 � 314, ISSN 0950-0618, URL https://dx.doi.org/10.1016/j.conbuildmat.2017.
05.130.

[26] M. Cervera, M. Chiumenti, Mesh objective tensile cracking via a local continuum damage model
and a crack tracking technique, Computer Methods in Applied Mechanics and Engineering 196 (1)
(2006) 304�320.

[27] Z. Baºant, B. Oh, Crack Band Theory for Fracture of Concrete, Bordas-Dunod, URL http://
books.google.it/books?id=x9citwAACAAJ, 1983.

[28] J. Oliver, A consistent characteristic length for smeared cracking models, International Journal for
Numerical Methods in Engineering 28 (2) (1989) 461�474.

[29] S. Oller, Fractura Mecánica: Un Enfoque Global, Ediciones CIMNE y UPC, 2001.
[30] M. Petracca, P. Luca, R. Riccardo, O. Sergio, C. Guido, S. Enrico, Regularization of �rst order com-

putational homogenization for multiscale analysis of masonry structures, Computational Mechanics
57 (2) (2016) 257�276, ISSN 1432-0924, URL http://dx.doi.org/10.1007/s00466-015-1230-6.

[31] P. R. L. Pelà, M. Cervera, Continuum damage model for orthotropic materials: Application to
masonry., Computer Methods in Applied Mechanics and Engineering 200 (9) (2011) 917�930.

[32] P. R. L. Pelà, M. Cervera, An orthotropic damage model for the analysis of masonry structures,
Construction and Building Materials 41 (2013) 957�967.

[33] J. G. R. P. B. Lourenço, Multisurface interface model for analysis of masonry structures, Journal
of engineering mechanics 123 (7) (1997) 660�668.

[34] W. A. M. B. V. Kouznetsova, M. G. D. Geers, Multi-scale constitutive modelling of heterogeneous
materials with a gradient-enhanced computational homogenization scheme, International Journal
for Numerical Methods in Engineering 54 (8) (2002) 1235�1260.

[35] W. A. M. B. V. Kouznetsova, M. G. D. Geers, Multi-scale second-order computational homoge-
nization of multi-phase materials: a nested �nite element solution strategy, Computer Methods in
Applied Mechanics and Engineering 193 (2004) 5525�5550.

[36] E. O. P. Dadvand, R. Rossi, An object-oriented environment for developing �nite element codes
for multi-disciplinary applications, Archives of computational methods in engineering 17 (3) (2010)
253�297.

[37] GiD: The personal pre and post preprocessor, URL http://www.gid.cimne.upc.es/, 2002.
[38] M. Cervera, L. Pelà, R. Clemente, P. Roca, A crack-tracking technique for localized damage in

quasi-brittle materials, Engineering Fracture Mechanics 77 (13) (2010) 2431�2450.
[39] M. Cervera, J. Oliver, R. Faria, Seismic evaluation of concrete dams via continuum damage models,

Earthquake engineering & structural dynamics 24 (9) (1995) 1225�1245.
[40] R. Faria, J. Oliver, M. Cervera, A strain-based plastic viscous-damage model for massive concrete

structures, International Journal of Solids and Structures 35 (14) (1998) 1533�1558.
[41] J. Y. Wu, J. Li, R. Faria, An energy release rate-based plastic-damage model for concrete, Interna-

tional Journal of Solids and Structures 43 (3) (2006) 583�612.
[42] J. Lubliner, J. Oliver, S. Oller, E. Oñate, A plastic-damage model for concrete, International Journal

of solids and structures 25 (3) (1989) 299�326.
[43] D. V. Oliveira, P. B. Lourenço, Implementation and validation of a constitutive model for the cyclic

behaviour of interface elements, Computers & structures 82 (17) (2004) 1451�1461.
[44] J. C. Simo, M. Rifai, A class of mixed assumed strain methods and the method of incompatible

modes, International Journal for Numerical Methods in Engineering 29 (8) (1990) 1595�1638.
[45] P. Dadvand, R. Rossi, M. Gil, X. Martorell, J. Cotela, E. Juanpere, S. R. Idelsohn, E. Oñate,

Migration of a generic multi-physics framework to HPC environments, Computers & Fluids 80
(2013) 301�309.

38

http://dx.doi.org/https://dx.doi.org/10.1016/0045-7825(95)00974-4
http://dx.doi.org/https://dx.doi.org/10.1016/0045-7825(95)00974-4
http://www.sciencedirect.com/science/article/pii/0045782595009744
http://www.sciencedirect.com/science/article/pii/0045782595009744
http://www.json.org/
https://dx.doi.org/10.1016/j.conbuildmat.2017.05.130
https://dx.doi.org/10.1016/j.conbuildmat.2017.05.130
http://books.google.it/books?id=x9citwAACAAJ
http://books.google.it/books?id=x9citwAACAAJ
http://dx.doi.org/10.1007/s00466-015-1230-6
http://www.gid.cimne.upc.es/


[46] P. Dadvand, R. Rossi, E. Oñate, An object-oriented environment for developing �nite element codes
for multi-disciplinary applications, Archives of computational methods in engineering 17 (3) (2010)
253�297.

[47] P. Roca, M. Cervera, G. Gariup, L. Pelà, Structural Analysis of Masonry Historical Constructions.
Classical and Advanced Approaches, Archives of Computational Methods in Engineering 17 (3)
(2010) 299�325, ISSN 1134-3060.

[48] L. Pelà, M. Cervera, S. Oller, M. Chiumenti, A localized mapped damage model for orthotropic
materials, Engineering Fracture Mechanics 124-125 (2014) 196�216, ISSN 0013-7944, URL http:
//www.sciencedirect.com/science/article/pii/S0013794414001386.

[49] L. Pelà, M. Cervera, P. Roca, An orthotropic damage model for the analysis of masonry struc-
tures, Construction and Building Materials 41 (2013) 957�967, ISSN 0950-0618, URL http:
//www.sciencedirect.com/science/article/pii/S0950061812004837.

[50] S. Saloustros, L. Pelà, M. Cervera, A crack-tracking technique for localized cohesive-frictional dam-
age, Engineering Fracture Mechanics 150 (2015) 96�114, ISSN 0013-7944, URL http://dx.doi.
org/10.1016/j.engfracmech.2015.10.039.

[51] A. Anthoine, Homogenization of periodic masonry: plane stress, generalized plane strain or 3D
modelling?, International Journal for Numerical Methods in Biomedical Engineering 13 (5) (1997)
319�326.

[52] D. Addessi, E. Sacco, Nonlinear analysis of masonry panels using a kinematic enriched plane state
formulation, International Journal of Solids and Structures 90 (2016) 194�214.

[53] M. Petracca, L. Pelà, R. Rossi, S. Oller, G. Camata, E. Spacone, Multiscale computational �rst
order homogenization of thick shells for the analysis of out-of-plane loaded masonry walls, Computer
Methods in Applied Mechanics and Engineering 315 (2017) 273�301.

[54] S. Saloustros, L. Pelà, M. Cervera, P. Roca, Finite element modelling of internal and multiple
localized cracks, Computational Mechanics (2016) 1�18.

39

http://www.sciencedirect.com/science/article/pii/S0013794414001386
http://www.sciencedirect.com/science/article/pii/S0013794414001386
http://www.sciencedirect.com/science/article/pii/S0950061812004837
http://www.sciencedirect.com/science/article/pii/S0950061812004837
http://dx.doi.org/10.1016/j.engfracmech.2015.10.039
http://dx.doi.org/10.1016/j.engfracmech.2015.10.039

	Classical First-Order Multiscale Method
	Macro to micro transition
	Micro to macro transition 
	Material homogenized properties

	Threshold Surface definition (DMTS) and Discrete Multiscale Constitutive Model (DMCM)
	Strain Data Base definition 
	Equivalent damage definition 
	Discrete Multiscale Threshold Surface 
	Discrete Multiscale Constitutive Model 
	Interpolation Methods 

	Data Base Regularization 
	Numerical Validation
	Shear test on damage material with different threshold values for tension and compression
	Reinforced composite beam section

	Extension of the formulation to the 3D case
	Conclusions
	References

