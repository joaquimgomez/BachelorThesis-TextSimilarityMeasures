






















































Regularization of first order computational homogenization for multiscale analysis of masonry structures


Noname manuscript No.
(will be inserted by the editor)

Regularization of first order computational homogenization for
multiscale analysis of masonry structures

Massimo Petracca · Luca Pelà · Riccardo Rossi · Sergio Oller · Guido
Camata · Enrico Spacone

Received: date / Accepted: date

Abstract This paper investigates the possibility of us-
ing classical first order computational homogenization
together with a simple regularization procedure based
on the fracture energy of the micro-scale-constituents.
A generalized geometrical characteristic length takes
into account the size of the macro-scale element as well
as the size of the RVE (and its constituents).
The proposed regularization ensures objectivity of the
dissipated energy at the macro-scale, with respect to
the size of the FE in both scales and with respect to
the size of the RVE.
The proposed method is first validated against bench-
mark examples, and finally applied to the numerical
simulation of experimental tests on in-plane loaded shear
walls made of periodic masonry.

Massimo Petracca (�)

CIMNE - Centre Internacional de Metodes Numerics
en Enginyeria, Technical University of Catalonia (UPC),
Barcelona 08034, Spain
Department of Engineering, University "G.d’Annunzio" of
Chieti and Pescara, Pescara 65127, Italy
E-mail: mpetracca@cimne.upc.edu
E-mail: massimo.petracca@unich.it

Luca Pelà · Riccardo Rossi · Sergio Oller

CIMNE - Centre Internacional de Metodes Numerics
en Enginyeria, Technical University of Catalonia (UPC),
Barcelona 08034, Spain
E-mail: luca.pela@upc.edu
E-mail: rrossi@cimne.upc.edu
E-mail: oller@cimne.upc.edu

Guido Camata · Enrico Spacone

Department of Engineering, University "G.d’Annunzio"
of Chieti and Pescara, Pescara 65127, Italy
E-mail: g.camata@unich.it
E-mail: espacone@unich.it

Keywords Computational Multiscale Homogeniza-
tion · Periodic Microstructure · Strain Localization ·
Characteristic Length · Fracture Energy Regulariza-
tion · Masonry Shear Wall

1 Introduction

The formulation of phenomenological closed-form con-
stitutive laws for the analysis of heterogeneous quasi-
brittle materials such as masonry is still a challeng-
ing task [45, 46]. The evolution of macroscopic prop-
erties is highly influenced by the complex behavior of
micro-structural phenomena such as damaged-induced
anisotropy, stress redistribution among micro-structural
constituents or strain localization. In this context, it is
difficult to take into account the influence of the evolv-
ing micro-structure on the macroscopic properties, es-
pecially when strain localizations occur in the micro-
structure leading to complex dissipation mechanisms
at the structural level.
There are three main approaches to model this kind of
heterogeneous materials.
The first approach is the Direct Numerical Simulation
(DNS) where a classical 1-scale FE model is used, and
all the information about the micro-structure is explic-
itly modeled. This method provides the best accuracy
in taking into account the micro-structure influence on
the structural behavior. An interface model using mul-
tisurface plasticity has been proposed in [26] to describe
the in-plane behavior of masonry. In this kind of mod-
eling, both bricks and mortar joints are explicitly mod-
eled, and all nonlinear behaviors are lumped in the in-
terface elements. This approach is very efficient with
small-scale structures (i.e. structural members tested
in laboratory). When dealing with large-scale analysis



2 Massimo Petracca et al.

the computational cost becomes unaffordable, as well
as the effort required to prepare the geometrical model.
The second approach is known as Concurrent Multi-
scale Method (CMM). As a multiscale model, it in-
volves the study of multiple length scales as well as the
exchange of information among them. In this partic-
ular approach the micro-structural scale is adaptively
inserted and resolved on the structural model, thus es-
tablishing a strong coupling between macro and micro
scales. Works on this subject can be found in [24, 25],
among others.
The third approach is known as Computational Ho-
mogenization Method (CHM). Similar to the CMM,
it is based on multiscale modeling, in that informa-
tion is obtained from multiple length scales. Assum-
ing that the length scales are separated, this approach
establishes a weak coupling between them. The micro-
structural features are not physically inserted in the
structural model, as in the case of CMM, but they are
modeled into a so called representative volume element
(RVE) which is associated to each integration point of
the macroscopic mesh. This RVE, considered as a rep-
resentative sample of the micro-structure, is then used
to obtain a homogenized response to the macroscopic
strain field, thus emulating an equivalent homogeneous
medium. Due to its flexibility (no assumption has to be
made on the homogenized constitutive response) such
model has been used to model a large class of materials
characterized by complex micro-structures, with linear
and nonlinear behaviors [9, 41, 43, 44, 47, 54, 55].
Although classical first order CHM has been success-
fully used to model micro-structures exhibiting stable
behaviors, it has been recognized to give non-objective
results when dealing with strain-softening materials. In
fact the RVE looses its representativeness upon strain
localization. In the last years, several modifications to
the classical CHM have been proposed, and a review
on recent developments can be found in [35] and in the
references therein. Some approaches regularize the re-
sponse of the RVE by using a higher order theory at the
macro-scale, such that the information about a mate-
rial characteristic length is naturally taken into account
[3, 16, 17, 18, 22, 23, 52]. Others, known as continuous-
discontinuous approaches, up-scale the RVE response
to a traction-separation law (upon strain localization)
used by a discontinuity inserted into the macro-scale
model [6, 8, 30, 31, 32, 33, 37, 39]. Another issue re-
lated to the loss of representativeness of the RVE is the
choice of proper boundary conditions to be applied on
the RVE. A study on this topic has been done in [13],
where a novel boundary condition has been proposed,
using the concept of rotating periodicity to avoid cos-
training the crack propagation orientation.

In the context of masonry modeling, works on continuous-
discontinuous computational homogenization can be found
in [30, 35] for modeling the in-plane behavior of ma-
sonry structures, and later on extended to the study of
shell elements for the analysis of the out-of-plane be-
havior [32, 33], while works on computational homoge-
nization using a Cosserat continuum at the macro-scale
can be found in [16, 17].

Previous approaches based on first order homogeniza-
tion and fracture energy regularization considered the
characteristic length used in the microstructural con-
stitutive models equal to the characteristic length of
the macro-scale finite elements [4]. The same was done
in [16] to compare the classical first order homogeniza-
tion with the Cosserat-based homogenization. This pa-
per proposes an extension of the fracture energy-based
regularization to two-scale computational homogeniza-
tion based on classical first order continuum theory. The
main aim is to allow the usage of first order computa-
tional homogenization for the analysis of quasi-brittle
micro-structures. The main novelty of the proposed ap-
proach resides in the consistent definition of a frac-
ture energy based regularization, in order to account
for the characteristic lengths of the finite elements at
both scales, as well as the size of the RVE.

The paper is organized as follows: Section 2 presents
the main concepts of classical computational homog-
enization, without any reference to a particular class
of micro-structures, but for the sake of simplicity, as-
suming small strain theory. In Section 3, the issues in-
troduced by strain-softening materials are described,
and the proposed regularization procedure is derived.
In Section 4, a first benchmark test is used to assess
the proposed regularization with respect to a simple
mode I fracture test. Finally in Section 5, attention is
given to the modeling of masonry structures, through a
more complicated test on in-plane loaded shear walls.

2 Classical first order computational
homogenization

This section gives a brief summary of the main con-
cepts and basic equations of classical first order com-
putational homogenization, where a standard first or-
der continuum theory is assumed in both scales. In the
present work we assume the infinitesimal strain theory.

The main work-flow of the classical CHM can be rep-
resented as in Figure 1.



Regularization of first order computational homogenization for multiscale analysis of masonry structures 3

Fig. 1: work-flow of classical computational homoge-
nization

The procedure can be defined by three main steps:

1. Down-scaling or macro-micro transition, where the
macroscopic strain at any point of the macroscopic
mesh, are transferred to the micro-scale, where they
are used to apply boundary conditions on the RVE
mesh;

2. Solution of the micro-scale Boundary Value Problem
(BVP), which can be done through any numerical
method, but here FEM is considered;

3. Up-scaling ormicro-macro transition, where the macro-
scale stress tensor and the macro-scale tangent op-
erator are obtained via homogenization procedures.

2.1 Down-scaling or macro-micro transition

The macroscopic strain εm , in each point xm of the
macro-scale domain and at each instant t, can be ob-
tained as the volume average of the microscopic strain
field εµ defined at each point xµ of the micro-scale do-
main and at each instant t:

εm(xm, t) =
1

Vµ

ˆ
Ωµ

εµ(xµ, t) dV

=
1

Vµ

ˆ
Ωµ

∇suµ dV

=
1

Vµ

ˆ
∂Ωµ

uµ ⊗s ndA

(1)

being n the outward unit normal field on the RVE
boundary ∂Ωµ. It is assumed that the microscopic dis-
placement field can be additively split into a linear part
(coarse scale contribution) and a fluctuating part ũµ
(fine scale contribution)

uµ(xµ, t) = εm(xm, t)xµ + ũµ(xµ, t) (2)

and in the same way the microscopic strain field can
be split into a constant part (coarse scale contribution)
and a fluctuating part ε̃µ (fine scale contribution)

εµ(xµ, t) = εm(xm, t) + ε̃µ(xµ, t) (3)

Inserting the definition of the microscopic strain field
(Eq. (3)) into the definition of the macroscopic strain
field (Eq. (1)), one obtains:

εm(xm, t) = εm(xm, t) +
1

Vµ

ˆ
Ωµ

∇sũµ dV (4)

which provides the minimal kinematic constraint that
a microscopic displacement fluctuation field should sat-
isfy to be kinematically admissible:

ˆ
Ωµ

∇sũµ dV =
ˆ
∂Ωµ

ũµ ⊗s ndA = 0 (5)

The last step of the macro-micro transition is to define
the boundary conditions to be applied on the RVE dis-
placement fluctuation field, in order for the micro-BVP
to be solved. Following the work in [34], typical sub-
sets of kinematically admissible microscopic displace-
ment fluctuations are briefly summarized in the follow-
ing.

– Zero displacement fluctuations

ũµ(xµ, t) = 0 ∀xµ ∈ Ωµ (6)

Displacement fluctuations vanish in every point of
the RVE domain, thus the whole RVE undergoes a
uniform strain equal to the macro-scale strain field.

– Zero boundary displacement fluctuations

ũµ(xµ, t) = 0 ∀xµ ∈ ∂Ωµ (7)

Displacement fluctuations vanish only on the bound-
aries of the RVE.

– Periodic boundary displacement fluctuations

ũµ(x
+
µ , t) = ũµ(x

−
µ , t) ∀ pair {x

+
µ , x

−
µ } ∈ ∂Ωµ

(8)

being x+µ and x
−
µ two opposite points on the RVE

boundary ∂Ωµ. This model constraints the displace-
ment fluctuations on the boundaries of the RVE to
be periodic.



4 Massimo Petracca et al.

– Minimally constrained boundary displacement fluc-
tuations or Uniform boundary traction

σµ(xµ, t)n(xµ) = σm(xm, t)n(xµ) ∀xµ ∈ ∂Ωµ
(9)

Where σµ(xµ, t) is the microscopic stress field. As
shown in [34] , the distribution of stresses on the
RVE boundaries, reactive to the minimal kinematic
constraint given in Eq. (5), satisfies Eq. (9)

2.2 Solution of the micro-scale BVP

Assuming that inertia forces are negligible, the Prin-
ciple of Virtual Work establishes that the RVE is in
equilibrium if and only if the variational equation

ˆ
Ωµ

σµ(xµ, t) : ∇sη dV −
ˆ
Ωµ

b(xµ, t)·η dV

−
ˆ
∂Ωµ

te(xµ, t) · η dA = 0 ∀η ∈ Vµ
(10)

holds at each instant t. In Eq. (10), b(xµ, t) is the body
force field in the RVE domain, te(xµ, t) is the external
traction field on the boundaries of the RVE, and Vµ is
an appropriate space of virtual displacements η of the
RVE, subjected to one of the constraints defined in 2.1.
A key ingredient in the definition of multiscale consti-
tutive models is the Hill-Mandel Principle of Macro-
Homogeneity [20, 29], an energy average theorem es-
tablishing that the macroscopic stress power must equal
the volume average of the microscopic stress power over
the RVE

σm : ε̇m =
1

Vµ

ˆ
Ωµ

σµ : ε̇µ dV (11)

for any kinematically admissible microscopic strain rate
field ε̇µ, i.e. (following the additive split between coarse
scale and fine scale contributions) for any microscopic
strain rate field of the form:

ε̇µ = ε̇m +∇s ˙̃uµ ∀ ˙̃uµ ∈ Vµ (12)

As proved in [34], the Hill-Mandel Principle is equiva-
lent to requiring that body forces and surface traction
in the RVE be purely reactive, i.e. they are reaction to
the chosen kinematic constraints, and cannot be pre-
scribed independently. In this way the RVE equilibrium
reduces to:

ˆ
Ωµ

σµ(xµ, t) : ∇sη dV = 0 (13)

2.3 Up-scaling or micro-macro transition

The last step in the homogenization procedure consists
in finding the homogenized macroscopic stress tensor
(and if required the homogenized tangent operator) af-
ter the RVE equilibrium is found. As shown in [19, 42],
a definition of the homogenized stress tensor can be de-
rived directly from the Hill-Mandel Principle and the
additive split of the microscopic strain, and not as an as-
sumption of the model. Inserting the split of the micro-
scopic strain rate given in Eq. (12), into the Hill-Mandel
Principle Eq. (11), the following relation is obtained:

σm : ε̇m =
1

Vµ

ˆ
Ωµ

σµ : ε̇m dV

+
1

Vµ

ˆ
Ωµ

σµ : ∇s ˙̃uµ dV ∀ ˙̃uµ ∈ Vµ
(14)

which is valid for any kinematically admissible ˙̃uµ, and
for the case of ˙̃uµ = 0, the following relation is obtained:

σm : ε̇m =
1

Vµ

ˆ
Ωµ

σµ : ε̇m dV ∀ε̇m (15)

which is valid for any macroscopic strain rate field, lead-
ing to:

σm =
1

Vµ

ˆ
Ωµ

σµ(xµ, t) dV (16)

Thus the homogenized macroscopic stress tensor can
be obtained as the volume average of the microscopic
stress field of the RVE.

2.4 Interpretation and comparison with other
multiscale methods

As already mentioned in Section 1, CHM allows a straight-
forward interpretation within the framework of Varia-
tional Multiscale Methods (VMM). The main idea is to
consider that the continuous displacement field u can
be decomposed into a coarse and a fine component as

u = ū+ ũ (17)

where ū is defined as the “coarse” scale contribution
(i.e. the one described by the coarse FE mesh) and ũ
is the “fine” scale contribution (i.e. the one that would
correspond to a detail that cannot be solved by the
coarse FE mesh). The corresponding test functions are



Regularization of first order computational homogenization for multiscale analysis of masonry structures 5

named w̄ and w̃. Using such decomposition the strain
ε := ∇su becomes

ε = ∇sū+∇sũ (18)

To follow the standard multiscale procedure [21], one
shall at this point introduce a model to obtain ũ. This
can be done by applying the Galerkin approach at the
level of the fine scale to give

ˆ
Ω

w̃∇·σ (∇sũ) dV =
ˆ
Ω

w̃f dV −
ˆ
Ω

w̃∇·σ (∇sū) dV

(19)

which defines a “fine” scale problem which can be even-
tually solved if one, as in our case, provides a suitable
discretization of the fine scale domain (that is, a way
to actually compute w̃). The problem is completed once
one prescribes a suitable Boundary Condition for ũ. In
the VMM community it is customary to assume that´
Ω
w̃ (∇sũ) dV = 0 which can be reworked (by apply-

ing the Green-Gauss theorem) to give

ˆ
∂Ω

w̃ (ũ⊗s n) dA = 0 (20)

In the case of CHM, w̃ can be considered as a discontin-
uous function defined (locally in each integration point)
by the Finite Element discretization of the RVE. Under
this assumption, Eq. (19) and Eq. (20) can be restricted
to the RVE volume to give the Finite Element problem

ˆ
ΩRVE

w̃∇ · σ (∇sũ) dV =
ˆ
ΩRVE

w̃f dV −
ˆ
ΩRVE

w̃∇ · σ (∇sū) dV
(21)

ˆ
∂ΩRVE

w̃ (ũ⊗s n) dA = 0 (22)

Interestingly, Eq. (22) coincides with the so called “min-
imal” boundary conditions for ũ. Observe that both
ũ = 0 (in ∂ΩRV E) and the constraint of ũ being peri-
odic (in ∂ΩRV E) are special cases that comply with this
boundary condition. Observe also that no assumption
on the periodicity of ũ is needed when deriving minimal
boundary conditions.

3 Fracture-energy-based regularization in
two-scale FE Computational Homogenization

An essential aspect in numerical modeling is mesh ob-
jectivity, defined as the requirement that the results
must be independent of the adopted discretization.
In a continuum which exhibits strain-softening, the strain
localizes into a narrow zone where energy is dissipated
according to its size, while outside the material unloads
elastically. On the other hand, in the FEM context,
if standard local continuum models are used (i.e. the
material response is computed as a function of local
strains), this localization zone is related to the domain
(volume or area) of each finite element. Thus, if strain
softening appears, the dissipative domain will coincide
with only one strip of elements through the finite ele-
ment mesh, but since the dissipation of the total energy
is proportional to the size of the finite elements, the en-
ergy dissipated would diminish as the elements become
smaller upon mesh refinement, leading to non-objective
results that depend on the FE size.
A solution to this problem, now widely used, has been
proposed first in [5], and later on addressed by several
authors ([10, 36, 40], among others). The authors point
out that in a FEM framework, the concept of strain
softening should not be considered as a characteristic
of the material alone, since it is related to both the frac-
ture energy Gf and the size of the finite element where
the energy dissipation occurs. The computational width
of the fracture process is computed in each element de-
pending on its geometry and dimension. This compu-
tational width is known as the element characteristic
length lch. According to this model, the softening law
depends on both the material fracture energy per unit
of crack surface area Gf and the element characteris-
tic length lch, in such a way that the following relation
holds:

Gf =
W

A
=
W

V
lch = gf lch (23)

where W is the total energy dissipated by the fracture
process, A is the crack surface area, gf is the fracture
energy per unit of volume, and V is the volume of the
dissipative zone.
Referring to the notations given in Figure 2, Eq. (23)
can be rewritten as:

Gf =
W

ht
=

W

htlch
lch = gf lch (24)

In two-scale FE analysis, the concept of characteris-
tic length of the parent element (the element contain-
ing the constitutive law that needs to be regularized)



6 Massimo Petracca et al.

(a) strong discontinuity

(b) regularized smeared discontinuity

Fig. 2: representation of displacement and strain fields
in mode I fracture, and the regularization process

is not so obvious, in the sense that the non-linear be-
havior is generated by a constitutive model associated
to a domain of the micro-scale, but the dissipation fi-
nally occurs in a domain of the macro-scale. If one con-
siders only the characteristic length of the FE in the
micro-scale, one would obtain a correct dissipation in
the RVE, but then, changing the size of the RVE or
the size of the FE at the macro-scale, one would obtain
non-objective responses at the macro-scale. Both re-
quirements of mesh-objectivity and correct dissipation
can be satisfied only if a regularization is employed in
both scales of the analysis.
This suggests that the regularization parameter for the
constitutive model used in the micro-scale should be
adjusted to take into account the nested feature of the
multiscale homogenization procedure. As a starting point
we can assume that the constitutive law at the micro-
scale should be regularized using a modified character-
istic length l̃ch,µ, defined as a function of all the char-
acteristic lengths that may enter into the problem (see
Figure 3):

l̃ch,µ = f(lch,µ, lch,m, lch,RV E) (25)

where lch,µis the characteristic length of the FE in the
micro-scale, lch,m is the characteristic length of the FE

in the macro-scale, and lch,RV E is the characteristic
length of the RVE itself. The characteristic length of
the FE (both at the micro and at the macro scale) has
to be always computed according to the geometry, in-
terpolation and integration scheme of the considered
finite element [49].

Fig. 3: fracture energy based regularization in 2-scale
FEM

To obtain a definition for the modified characteristic
length, we can define the energy WRV E,D dissipated in
the damaged domain of the RVE as:

WRV E,D =
Gf

l̃ch,µ
VRV E,D =

Gf

l̃ch,µ
lch,µ tµ hRV E (26)

where VRV E,D is the damaged domain of the RVE, hRV E
is the length of the RVE in the direction of the crack,
and tµ is the thickness of the RVE. We can now “smear”
the dissipated energy over the whole RVE domain, defin-
ing an equivalent specific fracture energy g̃f as:

g̃f =
WRV E,D
VRV E

=
WRV E,D

lch,RV E hRV E tµ
=

Gf

l̃ch,µ

lch,µ
lch,RV E

(27)

Integrating this specific fracture energy over the dis-
sipating domain at the macro-scale we get the total
energy Wm dissipated at the macro-scale:

Wm =

ˆ

Am

g̃f dVm (28)

Wm = g̃f lch,m hm tm (29)



Regularization of first order computational homogenization for multiscale analysis of masonry structures 7

Where hm and tm are respectively the length and the
thickness of the crack at the macro-scale. Substituting
Eq. (27) in Eq. (29), and equating it with the actual
dissipated energy that we’re seeking at the structural
level

W = Gf hm tm (30)

we obtain a definition for the modified characteristic
length, to be used at the micro-scale, that provides the
proper dissipation at the macro-scale:

Wm =
Gf

l̃ch,µ

lch,µ
lch,RV E

lch,m hm tm = Gf hm tm (31)

l̃ch,µ = lch,µ
lch,m
lch,RV E

(32)

From Eq. (32) it can be seen that the characteristic
lengths at the micro-scale should be multiplied by a
scaling factor (constant over the RVE) which is the ratio
between the characteristic length of the parent-element
at the macro-scale and the characteristic length of the
RVE itself.
This procedure can be regarded as a 2-step smearing of
a discontinuity: (i) First, the discontinuity is smeared
over the localization band in the RVE (Eq. (26)) , with
a width of lch,µ, and a length of hRV E ; (ii) Then, the
discontinuity (now in the form of a localization band in
the RVE) is smeared over the localizing element at the
structural-level (Eq. (27), Eq. (28), Eq. (29)).
In [4], the modified characteristic length to be used at
the micro-scale was taken equal to the characteristic
length of the macro-scale FE. In that context, however,
the author was dealing with composites made of dam-
ageable matrix and long fibers. Long fibers are typically
oriented along the loading direction, allowing damage
to spread over a wide area. In those cases damage is
distributed over the whole RVE domain, while the lo-
calization may happen at the structural level. On the
contrary, in masonry the localization is already visi-
ble in the RVE, thus requiring to consider both length
scales during the regularization procedure. It should be
noted however, that the method proposed in [4] is re-
covered from Eq. (32), setting lch,µ = lch,RV E .
In [31] the localized RVE was homogenized towards
a discontinuity with a band width equal to the RVE
characteristic length. In the approach proposed by this
work, this corresponds to lch,m = lch,RV E , thus leav-
ing the characteristic length of the microstructural ele-
ments unchanged.
Eq. (26) defines the total energy dissipated in the dam-
aged part of the RVE, assuming that the total length

of the crack is equal to the length of the RVE in the
crack direction (hRV E), thus assuming a straight crack.
Let’s assume instead that in the RVE the crack is non-
straight, with a total length equal to ΦhRV E , where
Φ = 1 is a scaling factor that measures the tortuosity
of the crack. Eq. (26) then becomes

WRV E,D =
Gf

l̃ch,µ
lch,µ tµ ΦhRV E (33)

Eq. (30), refers to the total energy dissipated by the
real crack that we should simulate, and it was assumed
straight (as for the crack in the RVE) with a length
equal to the length of the specimen in the crack direc-
tion hm. If we consider instead a non-straight crack,
Eq. (30) becomes

W = GfΦhm tm (34)

Thus Eq. (31) becomes

Wm =
Gf

l̃ch,µ

lch,µ
lch,RV E

Φlch,m hm tm = Gf Φhm tm (35)

where the tortuosity factor Φ appears in both sides of
the equation, this it cancels out, and the modified char-
acteristic length defined in Eq. (32) remains unchanged.

4 Mode I fracture test

The test reported in this section is meant to assess the
regularization capabilities of the proposed method with
respect to a simple mode I fracture test. The specimen
is a rectangular plate in a state of plane-stress subject to
a uniaxial tensile load. The micro-structure is assumed
as a matrix with a periodic pattern of circular voids
(note that voids are emulated with a very soft linear
elastic material as reported in Table 1). The regulariza-
tion with respect to the macro-scale FE size and the size
of the RVE is checked by performing the same analy-
sis on two different macro-scale discretizations and two
different RVE sample sizes, for a total of four analyses.
The same analyses are conducted with and without the
regularization procedure to better show the differences.
Details about the geometry, the two macro-scale mod-
els, and the two RVEs, are given respectively in [Fig-
ure 4, Figure 5, Figure 6], while details about the me-
chanical properties of the micro-structural constituents
are given in Table 1. Periodic boundary displacement
fluctuations are employed in the multiscale analysis,
since in this example we expect cracks aligned with the
periodicity directions.



8 Massimo Petracca et al.

A local continuum damage model is used to describe
the constitutive behavior of the matrix in the RVE. The
main concepts of the model are summarized here. For
further details the reader can refer to [10, 12] and the
references therein. The constitutive equation is defined
as

σ = (1− d)σ̄ = (1− d)C : ε (36)

where the stress tensor σ is obtained as a function of
the effective stress tensor σ̄, computed from the to-
tal strain tensor ε and the fourth order isotropic linear
elastic constitutive tensor C, and the damage index d,
which ranges from zero for the undamaged material, to
one for the completely damaged material. In order to
compute this damage index, related to the current ef-
fective stress state, it is necessary to introduce a scalar
measure, termed as equivalent stress τ . In this example
we assume a Rankine criterion, so the equivalent stress
can be computed as follows:

τ =
[
σ̄+ : Λ : σ̄+

]1/2
(37)

where σ̄+ is the positive part of the effective stress ten-
sor, defined as

σ̄+ =

3∑
i=1

〈σ̄i〉pi ⊗ pi (38)

where pi is the eigenvector associated with the prin-
cipal stress σ̄i, symbols 〈•〉 are the Macaulay brackets
(〈x〉 = x, if x ≥ 0, 〈x〉 = 0, if x < 0), and Λ is a
non-dimensional fourth order tensor defined as

Λ = p1 ⊗ p1 ⊗ p1 ⊗ p1 (39)

Being the damage an irreversible process, we can intro-
duce another scalar quantity, termed as damage thresh-
old r, that represents the largest value ever reached by
the equivalent stress τ during the loading history. The
damage threshold r at time t+∆t can be evaluated as

r = max (r0, max (rt, τ)) (40)

where rt is the damage threshold at the previous (con-
verged) time step, and r0 is the initial damage threshold
(the one that defines the elastic limit) that in this case
is r0 = ft. Accordingly, the following damage criterion
is introduced:

Φ (τ, r) = τ − rt ≤ 0 (41)

In this way, the damage index d, in the time interval
[t, t+∆t], can grow only if τ > rt. In this test the
damage is assumed to evolve according to the following
exponential law:

d (r) = 1−
r0
r
exp

{
2Hdis

(
r0 − r
r0

)}
(42)

where Hdis is the discrete softening parameter. As de-
scribed in Section 3, in the discrete problem the soften-
ing law should be adjusted according to the size of the
dissipative zone (ldis), in such a way that the following
equation holds:

gf ldis = Gf (43)

where the specific dissipated energy gf , for the expo-
nential softening law, can be calculated as:

gf =

(
1 +

1

Hdis

)
f2t
2E

(44)

The discrete softening parameter is calculated as

Hdis =
ldis

lmat − ldis
(45)

where lmat = 2EGf/f2t . In standard 1-scale FE analy-
sis, ldis is assumed equal to the characteristic length of
the FE (ldis = lch). Here we are using this constitutive
law in the RVE of a 2-scale FE analysis, so ldis is equal
to the modified characteristic length l̃ch,µ, as defined in
Eq. (32).
The analysis has been performed using Kratos Multi-
physics [14], a free open-source framework for the devel-
opment of multidisciplinary solvers, developed at CIMNE,
while pre and post-processing have been done in GiD
[1], also developed at CIMNE.
The results obtained without the proposed regulariza-
tion procedure (Figure 7a) show four widely distinct
force-displacement curves. As expected, the response is
more brittle for larger RVEs and/or with finer meshes at
the macro-scale. Applying the proposed regularization
all the analyses give the same response (Figure 7b), thus
showing objectivity with respect to the macro-scale FE
size and to the RVE size. The macro-scale displacement
field and the micro-scale maximum principal strain, at
the end of the analysis, are shown in Figure 8.



Regularization of first order computational homogenization for multiscale analysis of masonry structures 9

Property Value (Material 1) Value (Material 2) Unit

Young’s modulus 14000.0 1.0 N/mm2

Poisson’s ratio 0.15 0.15 -

Type Continuum damage model Linear elastic -

Tensile maximum stress 2.2 - N/mm2

Tensile fracture energy 0.8 - N/mm

Damage criterion Rankine - -

Softening law Exponential - -

Table 1: material properties

 0

 500

 1000

 1500

 2000

 2500

 0  0.2  0.4  0.6  0.8  1  1.2  1.4

F
o
rc

e 
(N

)

Top displacement (mm)

macro 1x1 - rve 1x1
macro 1x1 - rve 3x3
macro 2x2 - rve 1x1
macro 2x2 - rve 3x3

(a)

 0

 500

 1000

 1500

 2000

 2500

 0  0.2  0.4  0.6  0.8  1  1.2  1.4

F
o
rc

e 
(N

)

Top displacement (mm)

macro 1x1 - rve 1x1
macro 1x1 - rve 3x3
macro 2x2 - rve 1x1
macro 2x2 - rve 3x3

(b)

Fig. 7: Force-Displacement curves: (a) without regularization; (b) with regularization

Fig. 8: macro-scale displacement field - RVEs maximum principal strain field (with regularization)



10 Massimo Petracca et al.

Fig. 4: geometry of the model and boundary conditions

(a) (b)

Fig. 5: macro-scale meshes: (a) macro 1x1 - mesh
size=1000;(b) macro 2x2 - mesh size=500

(a) (b)

Fig. 6: (a)RVE 1x1- size=100; (b)RVE 3x3 - size=300

5 Application to masonry structures.
Numerical modeling of shear walls

In this section, the proposed method is used to simu-
late the in-plane behavior of masonry structures. Shear
walls has been commonly used as in-plane shear tests.
Here we consider the experimental results obtained in
[48] as a reference to assess the capability of the pro-
posed approach. First, a brief description of the selected
experimental test is given in 5.1, then the adopted RVE
and the constitutive models used for each micro-structural
constituent are described in 5.2. Before proceeding with
the multiscale simulation, a Direct Numerical Simula-

tion (DNS) has been performed to check the capability
of the constitutive models to emulate the main behav-
iors of the masonry wall, and the results are discussed
in 5.3. Finally the results obtained from the multiscale
simulations are compared with both the experimental
results and the DNS results in 5.4.

The analysis has been performed using Kratos Multi-
physics [14, 15], a free open-source framework for the
development of multidisciplinary solvers, developed at
CIMNE, while pre and post-processing have been done
in GiD [1], also developed at CIMNE.

5.1 Experimental test: TU Eindhoven shear wall

The geometry of the wall (here denoted as W1) as well
as the boundary conditions are represented in Figure 9.
The wall has no opening and it is made of one layer
of solid bricks with dimensions 210mm × 52mm ×
100mm, with 10mm thick mortar joints [48]. The wall
is subjected to two load stages: (i) First, a uniform pres-
sure load of 0.3N/mm2 is applied on the top of the
wall, (ii) then a horizontal load is applied under dis-
placement control in a confined way, keeping the top
of the wall horizontal and precluding vertical displace-
ments. The experimental failure mechanisms obtained
from the tested walls are shown in Figure 10.

5.2 RVE and micro-scale constitutive laws

The walls considered in this section are made of running
bond masonry, thus showing a periodic texture. Taking
advantage of the periodicity of the micro-structure, pe-
riodic boundary displacement fluctuations (see Eq. (8))
are enforced on the boundaries of the RVE. In some
applications, the assumption of periodic boundary fluc-
tuations might enforce unphysical constraints on the
crack direction [13]. However, for the specific case of
masonry the cracks mainly take place following the pe-
riodic geometry of the weak mortar joints. In this sense,
the periodic assumption does not spoil the actual crack-
ing direction, both in the case of failure of bed/head
joints and in the case of staircase cracks. The mesh for
both bricks and mortar joints consists in a structured
grid of standard displacement-based 4-node quadrilat-
eral plane stress elements, with a uniform size of 10.0mm,
as shown in Figure 11.



Regularization of first order computational homogenization for multiscale analysis of masonry structures 11

(a)

(b)

Fig. 9: Wall W1 - TU Eindhoven shear wall [48]. Ge-
ometry and loading stages: (a) stage 1: uniform vertical
load; (b) stage 2: horizontal displacement under vertical
confinement

(a) (b)

Fig. 10: experimental crack patterns

Fig. 11: RVE mesh. All units are in mm

The constitutive models used for the micro-structural
constituents are here briefly presented, and they have
been used for both the Direct Numerical Simulation and
the Multiscale Computational Homogenization. Both
constituents, bricks and mortar joints, are assumed to
be isotropic. Their nonlinear behavior is simulated by
means of a local continuum damage model that is an
improvement of the scalar isotropic damage model de-
scribed in Section 4. To take into account the different
behaviors of these materials in tension and compres-
sion, a bi-dissipative d+/d− damage model has been
adopted, following the work in [53], such that the stress
state can be computed as

σ =
(
1− d+

)
σ̄+ +

(
1− d−

)
σ̄− (46)

where σ̄+and σ̄−are the positive and negative parts of
the effective stress tensor σ̄:

σ̄ = C : ε (47)

σ̄+ =

3∑
i=1

〈σ̄i〉pi ⊗ pi (48)

σ̄− = σ̄ − σ̄+ (49)

d+ and d− are respectively the tensile and compressive
damage indexes, and they affect respectively the posi-
tive σ̄+ and negative σ̄− part of the effective stress ten-
sor σ̄. Two scalar measures are introduced, termed as
equivalent stresses τ+ and τ−, in order to identify “load-
ing”, “unloading” or “reloading” situations for a general
state of stress. In the present work we have chosen dif-
ferent damage surfaces than those adopted in [53]. More
specifically, the same form of damage surface, based on
the one proposed in [28], has been used for both tensile
and compressive states, but with slight differences, in
order to better capture the shear behavior of masonry
components (especially mortar joints).



12 Massimo Petracca et al.

The equivalent stresses τ+ and τ− are computed as

τ− =
1

1− α

(
αI1 +

√
3J2 + κ1β 〈σmax〉

)
(50)

τ+ =
1

1− α

(
αI1 +

√
3J2 + β 〈σmax〉

) ft
fcp

(51)

α =
κb − 1
2κb − 1

(52)

β =
fcp
ft

(1− α)− (1 + α) (53)

where I1 is the first invariant of the stress tensor, J2 is
the second invariant of the stress deviator, σmax is the
maximum principal stress, and κb is the ratio between
bi-axial and uniaxial compressive strengths. The con-
stant κ1 in Eq. (50) has been here introduced to better
control the effect of the compressive surface on the shear
strength of the model. This constant can range from 0
(leading to the Drucker-Prager criterion) to 1 (leading
to the criterion proposed in [28]). ft and fcp are respec-
tively the tensile and compressive peak stresses, but
while ft coincides with the initiation of non linearity
in uniaxial tension, fcp doesn’t coincide with the initia-
tion of non linearity in uniaxial compression fc0, due to
the initial hardening. This choice is motivated by the
fact that in tension no hardening has been considered.
Finally the term ft

fcp
has been introduced in Eq. (51) to

relate τ+ to the tensile strength ft.
Being the damage an irreversible process, other two
scalar quantities are introduced, termed as damage thresh-
olds r±, that represent the largest values ever reached
by the equivalent stresses τ± during the loading his-
tory. The damage thresholds r± at time t+∆t can be
evaluated as

r± = max
(
r±0 , max

(
r±t , τ

±)) (54)
r+0 = ft (55)

r−0 = fc0 (56)

where r+0 and r
−
0 represent the initial damage thresh-

olds respectively in tension and compression (i.e. the
elastic limits in uniaxial tension ft and compression

−15 −10 −5 0 5

−15

−10

−5

0

5

σ1

σ
2

 

 

τ
+

τ
−(κ1 = 0.00)

τ
−(κ1 = 0.25)

τ
−(κ1 = 0.50)

τ
−(κ1 = 1.00)

inactive
tensile surface

x = fc0
x = fcp

x = ft

x = κbfc0

inactive
compressive 
surface

Fig. 12: initial damage surfaces (2D plane-stress)

fc0). Accordingly, the following damage criteria are in-
troduced:

Φ
(
τ±, r±

)
= τ± − r±t ≤ 0 (57)

A plot with the superposition of the two damage sur-
faces, in principal stress space for the 2D plane-stress
case, is given in Figure 12. The compressive surface is
plotted with different values of the constant κ1. Since
these surfaces are defined for any stress state, it is neces-
sary to make them inactive (as pointed out in Figure 12
with dashed lines) under certain conditions:

1. compressive surface is allowed to evolve only if at
least one principal stress is negative

2. tensile surface is allowed to evolve only if at least
one principal stress is positive

The tensile damage index d+ is calculated according to
the following equation:

d+
(
r+
)

= 1−
r+0
r+
exp

{
2Hdis

(
r+0 − r

+

r+0

)}
(58)

where Hdis is the discrete softening parameters, and
it’s calculated as explained in Eq. (45). The resulting
tensile uniaxial law is given in Figure 13.
For the evaluation of the compressive damage index
d−an ad hoc formulation has been adopted, in order



Regularization of first order computational homogenization for multiscale analysis of masonry structures 13

Fig. 13: tensile uniaxial law

Fig. 14: compressive uniaxial law

to obtain a compressive uniaxial law like the one given
in Figure 14.
This curve consists of: 1) a linear part [(0, 0)− (ε0, σ0)],
2) a hardening part[(ε0, σ0)− (εp, σp)], 3-4) two soft-
ening parts [(εp, σp)− (εk, σk)] [(εk, σk)− (εu, σu)], and
5) a final constant residual stress part [(εu, σu)− (+∞, σu)].
Parts 2,3 and 4 are quadratic bezier curves. Each one
has three control points defining the shape of the curve,
the end-positions, and the tangents to the curve at the
end-positions.
As for the tensile case, in the discrete problem this uni-
axial curve needs to be regularized in such a way that
the shaded area under the curve be Gc/ldis, where in
the present work ldis is equal to the modified charac-
teristic length l̃ch,µ, as defined in Eq. (32).
Material properties for bricks and mortar joints, used
next in the DNS and Multiscale simulations, are sum-
marized in Table 2. These values are taken from the
analysis conducted in [26, 27]. The material parame-
ters governing the compressive behavior of mortar joints
have been adapted to obtain the correct compressive be-
havior of the masonry composite material. In fact in this
simulation a plane stress behavior has been adopted,
which cannot capture the typical increase in compres-
sive capacity of mortar joints, due to the confining effect

of the surrounding bricks. Another possibility of cope
with this issue could be the Generalized Plane State
model [2].

Property Bricks Mortar Joints Units

E 16700.0 800.0 N/mm2

ν 0.15 0.15 -

σt 2.0 0.25 N/mm2

Gt 0.08 0.016 N/mm

σ0 3.0 2.0 N/mm2

σp 11.5 8.5 N/mm2

σr 2.0 2.0 N/mm2

Gc 1.0 80.0 N/mm

εp 0.003 0.04 -

kb 1.2 1.6 -

k1 0.0 0.16 -

Table 2: Material properties for bricks and mortar joints

5.3 Direct Numerical Simulation

In this section, the results obtained from the DNS are
discussed and compared to the experimental results.
This allows to assess the capability of the constitu-
tive model described in 5.2 to represent the in-plane
behavior of shear-walls. The discretization consists in a
structured mesh of standard displacement-based 4-node
quadrilateral plane stress elements. The size of the dis-
cretization is 10mm. The nonlinear static analysis is
conducted in two stages:

1. In the first stage, a uniform pressure of 0.3N/mm2

is applied on top of the wall, under load control;
2. In the second stage, a horizontal nodal load is ap-

plied on the top-right corner of the wall, under dis-
placement control. In this second stage, the vertical
displacement on top of the wall, is kept fixed at the
value reached at the previous step.

Figure 15 shows the structural response in terms of hor-
izontal top displacement against total horizontal reac-
tion. The results obtained with the DNS are in good
agreement with the experimental results, also in terms
of the obtained failure mechanisms, as it can be seen in
Table 3 and Table 4.



14 Massimo Petracca et al.

 0

 10

 20

 30

 40

 50

 60

 0  0.5  1  1.5  2  2.5  3

H
o
ri

zo
n
ta

l 
re

ac
ti

o
n
 (

k
N

)

Horizontal displacement (mm)

experimental
numerical (meso-model)

Fig. 15: Load-Displacement curve

In this context, it is interesting to highlight the main
features characterizing the behavior of this kind of ex-
periment (for a detailed description see [27]). To this
end, five significant snapshots of the analysis have been
extracted. These snapshots are identified by horizon-
tal top displacements Ux = [0.5, 1.1, 1.8, 2.5, 3.0]mm.
The obtained results can be seen in Table 3 and Table 4,
in terms of displacement, maximum principal strain,
minimum principal stress, tensile damage and compres-
sive damage.
The first non-linearity appears at a horizontal top dis-
placement Ux = 0.5mm, with horizontal tensile cracks
developing at the bottom-right and top-left parts of the
wall. In this first stage, compressive stresses form sev-
eral parallel struts oriented along the direction given
by the central points of the bricks. At a horizontal-top-
displacement Ux = 1.1mm, staircase diagonal cracks
appear from the center of the wall, proceeding towards
the supports through the mortar joints. In this stage
there are several cracks, but not yet a fully open unique
crack, due to the presence of bricks that are still be-
low their tensile peak stress. The formation of these
diagonal cracks also produces the first visible change in
the slope of the load-displacement curve. The stage be-
tween horizontal-top-displacements Ux = 1.8mm and
Ux = 2.5mm is characterized by the previously men-
tioned cracks joining to form a unique diagonal crack
that fully reaches the supports. The joining of those
cracks is due to tensile failure of bricks. In this stage,
is also visible the change in compressive stresses, now
rotating and forming two separated struts. The further
opening of the diagonal crack leads to the full develop-
ment of the shear mechanism for the ultimate displace-
ment Ux = 3.0mm.

5.4 Multiscale simulation

In order to assess the proposed method, the multiscale
homogenization analysis has been performed on four

different meshes, here denoted as mesh 7x7, mesh 8x8,
mesh 9x9, and mesh 15x15, as shown in Figure 16. All
macro-scale models consists of a structured mesh of 4-
node quadrilateral plane-stress finite elements. In or-
der to improve the performance of these rather coarse
discretizations, the Enhanced Assumed Strain (EAS)
quadrilateral element proposed in [51] was used.

(a) mesh 7x7 (b) mesh 8x8

(c) mesh 9x9 (d) mesh 15x15

Fig. 16: adopted meshes at the macro-scale

The results obtained from all four analyses are in very
good agreement with the DNS predictions. Figure 17
shows how the obtained load-displacement curves closely
follow the curve of the DNS. Furthermore it can be seen
how upon mesh refinement the relative error among the
curves diminishes, thus showing objectivity of the re-
sponse thanks to the regularization procedure proposed
by this research. The coarsest mesh (7x7) shows a pre-
mature failure in the compressed corners probably due
to the sudden loss of bearing capacity of the few ele-
ments involved in the nonlinear process. However, al-
ready the 8x8 mesh shows a better agreement in the

 0

 10

 20

 30

 40

 50

 60

 0  0.5  1  1.5  2  2.5  3

H
o
ri

zo
n
ta

l 
re

ac
ti

o
n

 (
k

N
)

Horizontal displacement (mm)

experimental
numerical (meso-model)

homogenized (mesh 7x7)
homogenized (mesh 8x8)
homogenized (mesh 9x9)

homogenized (mesh 15x15)

Fig. 17: Load-Displacement curve



Regularization of first order computational homogenization for multiscale analysis of masonry structures 15

top− displacement Ux (mm) εmax σmin (N/mm2)

0.5mm

1.1mm

1.8mm

2.5mm

3.0mm

Table 3: DNS. Incremental contour plots of (Ux) horizontal top displacement, (εmax) maximum principal strain,
and (σmin) minimum principal stress



16 Massimo Petracca et al.

top− displacement d+ d−

0.5mm

1.1mm

1.8mm

2.5mm

3.0mm

Table 4: DNS. Incremental contour plots of (d+) tensile damage, and (d−) compressive damage



Regularization of first order computational homogenization for multiscale analysis of masonry structures 17

final stage, and finally the 9x9 and 15x15 meshes start
showing smoother transitions towards the compressive
failure.
The 15x15 mesh from a practical point of view may not
seem the best choice for the analyzed problem, since
the FE size at the macro-level is smaller than the RVE
size. However, the 15x15 case has been intentionally ad-
dressed to show the mesh insensitivity of the proposed
regularization method. All the other cases with coarser
meshes actually look more appropriate, since the FE
size at the macro-level is larger than the RVE size. In
those cases, the main failure mechanisms, displacement
and force capacities are correctly represented despite
the mesh coarseness.
Table 6 shows the obtained results in terms of displace-
ment, maximum principal strain and minimum princi-
pal stress. In particular, it can be seen how the shape
of the crack (in terms of maximum principal strains)
and the redistribution of compressive stresses closely
resembles those obtained with the DNS.
Table 5 shows the final state (in terms of maximum
principal strain, tensile and compressive damage) of
three significant RVEs. The first RVE (RVE 1) shows
a prevailing mode I failure, where the tensile damage
concentrates in one of the bed joints. This is the first
source of non-linearity that appears during the test,
while the vertical confinement is still low. The second
RVE (RVE 2) shows the typical staircase failure due to
shear with low confining pressure. This RVE is taken
from the center of the wall, where the main diagonal
crack starts. Finally the third RVE (RVE 3) is taken
from the bottom-left corner of the wall, where the main
diagonal crack ultimately triggers the collapse of the
wall. This failure happens at a later stage of the test,
and due to the fact that vertical displacements on top
of the wall are constrained, this area is subjected to sig-
nificant concentration of compressive stresses. The RVE
successfully shows a first staircase damage pattern, fol-
lowed by the failure of the brick by vertical splitting.
The smeared crack approach adopted in this research,
together with proper fracture energy regularization, has
provided numerical results in remarkable agreement with
the experimental cracking patterns on masonry shear
walls.
However, it must be noted that in general the proposed
regularization cannot solve (and neither attempts to)
the well-known problem of mesh-bias dependency of the
FE solution, that is, some preferred directions might
still exist in the model depending on the orientation
of the mesh. Such issue can be however addressed by
carefully choosing the finite element model employed
in the coarse mesh, as demonstrated by recent works
[7, 10, 11, 12, 38]. In particular the element formulation

employed in current work (EAS [51]) makes it reason-
ably insensitive to mesh bias.

5.5 Computational cost

An important aspect in this kind of simulations is the
computational cost. Even if such a study is out of the
scope of this paper, this section gives just a brief com-
parison between the DNS and the Multiscale simula-
tions. It should be noted that the specimen described
in 5.1 is quite small (1m × 1m) and it is not the per-
fect candidate for a multiscale simulation. Nevertheless
it has been analyzed for a comparison with experimen-
tal results. To exploit the advantages of the proposed
multiscale model, a second DNS has been conducted on
a larger model (3m × 3m) which is a scaled version of
the original one. For both cases a multiscale simulation
has been carried out, using the same macro-scale dis-
cretization (7 x 7 mesh) which proved to be sufficient to
obtain good results in both analysis (see Figure 18a and
Figure 18b). Table 7a and Table 7b show the computa-
tional cost of the DNS and the Multiscale simulations
in terms of memory usage and (real) time. To give an

RVE εmax d+ d−

RVE 1

RVE 2

RVE 3

Table 5: final state in three significant RVEs



18 Massimo Petracca et al.

top− displacement Ux εmax σmin

0.5mm

1.1mm

1.8mm

2.5mm

3.0mm

Table 6: CHM. Incremental contour plots of (Ux) horizontal top displacement, (εmax) maximum principal strain,
and (σmin) minimum principal stress



Regularization of first order computational homogenization for multiscale analysis of masonry structures 19

 0

 10

 20

 30

 40

 50

 60

 0  0.5  1  1.5  2  2.5  3

H
o
ri

zo
n
ta

l 
re

ac
ti

o
n
 (

k
N

)

Horizontal displacement (mm)

numerical (meso-model)

homogenized (mesh 7x7)

(a)

 0

 20

 40

 60

 80

 100

 120

 140

 0  0.5  1  1.5  2  2.5  3  3.5  4

H
o
ri

zo
n
ta

l 
re

ac
ti

o
n
 (

k
N

)

Horizontal displacement (mm)

numerical (meso-model)

homogenized (mesh 7x7)

(b)

Fig. 18: load-displacement curves for the original (a) and scaled model (b)

DNS model number
of nodes

number
of

elements

average
time per
iteration

memory

1m × 1m 11152 10934 1.51 sec. 120MB

3m × 3m 77064 76502 9.72 sec. 730MB

(a)

number
of

nodes

number
of

elements

number
of RVEs

number
of nodes
(RVE)

number
of

elements
(RVE)

average
time
per it-
eration

memory

64 49 196 322 356 4.97 sec. 275MB

(b)

Table 7: computational cost for the Direct Numerical Simulations (a) and for the Multiscale simulation with a 7x7
mesh (b)

objective comparison, the measured time is not referred
to the entire simulation, but to the average duration of
a single global iteration (i.e. the total duration of a load
step, divided by the number of equilibrium iterations).
Furthermore the time has been measured during spe-
cific load steps where almost the entire model is in a
nonlinear range.

As it can be observed, the multiscale simulation proves
to be efficient with respect to the DNS when dealing
with large structures (or alternatively when the micro-
structure is very small compared to the specimen). The
DNS is penalized when used with large models due to
increasing time and memory requirements, mainly re-
quired by the storage and solution of large linear sys-
tems of equations. On the contrary, the Multiscale simu-
lation is penalized when used with small models, where
the overhead of the homogenization process dominates.

All the computations have been done on a single ma-
chine with an Intel Core i7-2670QM-2.20GHz CPU and

8.00 GB RAM. The code has been parallelized using
OpenMP.

6 Conclusions

Classical first order computational homogenization is a
well established framework used to capture the effect
that a complex micro-structure has on the structural
level. It has been however recognized to suffer from spu-
rious dependence on the macro-mesh size as well as on
the RVE size, when strain localization takes place.
In this paper, the authors propose a simple regular-
ization technique that allows to use classical first or-
der computational homogenization for problems involv-
ing strain localizations, while keeping its settings, and
thus its simplicity, unchanged. In the context of the
Smeared Crack Approach (SCA), the Fracture-Energy-
based regularization, commonly used in 1-scale FE anal-
ysis when dealing with strain-softening materials, is ex-



20 Massimo Petracca et al.

tended here to 2-scale FE analysis. The proposed regu-
larization procedure ensures objectivity of the dissipa-
tion at the macro-scale, by embedding in the definition
of the micro-scale characteristic lengths (used to reg-
ularize micro-structural constitutive laws), the size of
the finite elements from both scales as well as the size
of the RVE itself. This is achieved by means of a scal-
ing factor which is constant over the RVE. Of particular
interest is the fact that an existing FE code implement-
ing classical computational homogenization needs only
a marginal change in the evaluation of this scaling fac-
tor.
The proposed method is validated through basic bench-
mark tests as well as with more involved analyses of in-
plane loaded masonry shear walls, showing satisfactory
results. More specifically, the application of the pro-
posed multiscale procedure shows a remarkable agree-
ment with the results given by the DNS. As for the anal-
ysis of the masonry shear wall, the proposed model has
shown its capability at the micro-scale to represent the
local tensile, compressive and shear failures due to the
complex interaction between units and joints. At the
macro-scale, the model can correctly describe the phe-
nomenological structural response. The proposed mul-
tiscale approach is robust and objective for different
mesh discretizations.

Acknowledgements This research has received the finan-
cial support from the Graduate School of the University “G.
D’Annunzio” of Chieti-Pescara, from the Italian Department
of Civil Protection through the Reluis Project, from the MINECO
(Ministerio de Economia y Competitividad of the Spanish
Government) and the ERDF (European Regional Develop-
ment Fund) through the MICROPAR project (Identification
of mechanical and strength parameters of structural masonry
by experimental methods and numerical micro-modelling, ref
num. BIA2012-32234) and from the Excellence Programme
for Knowledge Generation by MINECO, through the EACY
project (Enhanced accuracy computational and experimental
framework for strain localization and failure mechanisms, ref.
MAT2013-48624-C2-1-P).
S. Oller acknowledges the support of the European Research
Council under the Advanced Grant: ERC-2012-AdG 320815
COMP-DES-MAT "Advanced tools for computational design
of engineering materials"

References

1. (2002) Gid: The personal pre and post preprocessor
2. Addessi D, Sacco E (2014) A kinematic enriched

plane state formulation for the analysis of masonry
panels. European Journal of Mechanics-A/Solids
44:188–200

3. Addessi D, Sacco E, Paolone A (2010) Cosserat
model for periodic masonry deduced by nonlinear

homogenization. European Journal of Mechanics-
A/Solids 29(4):724–737

4. Badillo HA (2012) Numerical modelling based on
the multiscale homogenization theory. application
in composite materials and structures. PhD thesis,
Universitat Politécnica de Catalunya BarcelonaT-
ech

5. Bažant Z, Oh B (1983) Crack Band Theory for
Fracture of Concrete. Bordas-Dunod, URL http:
//books.google.it/books?id=x9citwAACAAJ

6. Belytschko T, Loehnert S, Song JH (2008) Mul-
tiscale aggregating discontinuities: a method for
circumventing loss of material stability. Interna-
tional Journal for Numerical Methods in Engineer-
ing 73(6):869–894

7. Benedetti L, Cervera M, Chiumenti M (2015)
Stress-accurate mixed fem for soil failure under
shallow foundations involving strain localization in
plasticity. Computers and Geotechnics 64:32–47

8. Bosco E, Kouznetsova V, Geers M (2015) Multi-
scale computational homogenization–localization
for propagating discontinuities using x-fem. Inter-
national Journal for Numerical Methods in Engi-
neering 102(3-4):496–527

9. Car E, Zalamea F, Oller S, Miquel J, Oñate E
(2002) Numerical simulation of fiber reinforced
composite materials—-two procedures. Interna-
tional journal of solids and structures 39(7):1967–
1986

10. Cervera M, Chiumenti M (2006) Mesh objective
tensile cracking via a local continuum damage
model and a crack tracking technique. Computer
Methods in Applied Mechanics and Engineering
196(1):304–320

11. Cervera M, Chiumenti M, Codina R (2010) Mixed
stabilized finite element methods in nonlinear solid
mechanics. part ii: Strain localization. Computer
Methods in Applied Mechanics and Engineering
199(37):2571–2589

12. Cervera M, Pelà L, Clemente R, Roca P (2010)
A crack-tracking technique for localized damage in
quasi-brittle materials. Engineering Fracture Me-
chanics 77(13):2431–2450

13. Coenen E, Kouznetsova V, Geers M (2012) Novel
boundary conditions for strain localization analy-
ses in microstructural volume elements. Interna-
tional Journal for Numerical Methods in Engi-
neering 90(1):1–21, DOI 10.1002/nme.3298, URL
http://dx.doi.org/10.1002/nme.3298

14. Dadvand P, Rossi R, Oñate E (2010) An object-
oriented environment for developing finite ele-
ment codes for multi-disciplinary applications.
Archives of computational methods in engineering

http://books.google.it/books?id=x9citwAACAAJ
http://books.google.it/books?id=x9citwAACAAJ
http://dx.doi.org/10.1002/nme.3298


Regularization of first order computational homogenization for multiscale analysis of masonry structures 21

17(3):253–297
15. Dadvand P, Rossi R, Gil M, Martorell X, Cotela J,

Juanpere E, Idelsohn SR, Oñate E (2013) Migra-
tion of a generic multi-physics framework to hpc
environments. Computers & Fluids 80:301–309

16. De Bellis ML (2009) A cosserat based multi-scale
technique for masonry structures. In: PHD Thesis

17. De Bellis ML, Addessi D (2011) A cosserat based
multi-scale model for masonry structures. Interna-
tional Journal for Multiscale Computational Engi-
neering 9(5)

18. Geers M, Kouznetsova VG, Brekelmans WAM
(2003) Multiscale first-order and second-order com-
putational homogenization of microstructures to-
wards continua. International Journal for Multi-
scale Computational Engineering 1(4)

19. Hernández JA, Oliver J, Huespe AE, Caicedo M
(2012) High-Performance Model Reduction Proce-
dures in Multiscale Simulations. 127, Monograph
CIMNE

20. Hill R (1965) A self-consistent mechanics of com-
posite materials. J Mech Phys Solids 13:213–222

21. Hughes TJ, Feijóo GR, Mazzei L, Quincy JB (1998)
The variational multiscale method-a paradigm for
computational mechanics. Computer methods in
applied mechanics and engineering 166(1):3–24

22. Kouznetsova V, Geers MGD, Brekelmans WAM
(2002) Multi-scale constitutive modelling of hetero-
geneous materials with a gradient-enhanced com-
putational homogenization scheme. International
Journal for Numerical Methods in Engineering
54(8):1235–1260

23. Kouznetsova V, Geers M, Brekelmans W (2004)
Multi-scale second-order computational homoge-
nization of multi-phase materials: a nested finite el-
ement solution strategy. Computer Methods in Ap-
plied Mechanics and Engineering 193:5525–5550,
advances in Computational Plasticity

24. Lloberas-Valls O, Rixen D, Simone A, Sluys L
(2011) Domain decomposition techniques for the ef-
ficient modeling of brittle heterogeneous materials.
Computer Methods in Applied Mechanics and En-
gineering 200(13):1577–1590

25. Lloberas-Valls O, Rixen D, Simone A, Sluys L
(2012) Multiscale domain decomposition analysis
of quasi-brittle heterogeneous materials. Interna-
tional Journal for Numerical Methods in Engineer-
ing 89(11):1337–1366

26. Lourenço PB, Rots JG (1997) Multisurface inter-
face model for analysis of masonry structures. Jour-
nal of engineering mechanics 123(7):660–668

27. Lourenco PB (1996) Computational strategies for
masonry structures. PhD thesis, TU Delft, Delft

University of Technology
28. Lubliner J, Oliver J, Oller S, Oñate E (1989) A

plastic-damage model for concrete. International
Journal of solids and structures 25(3):299–326

29. Mandel J (1971) Plasticité classique et viscoplas-
ticité. Springer-Verlag

30. Massart T, Peerlings R, Geers M (2007) An en-
hanced multi-scale approach for masonry wall com-
putations with localization of damage. Interna-
tional journal for numerical methods in engineering
69(5):1022–1059

31. Massart TJ (2003) Multi-scale modeling of damage
in masonry structures

32. Mercatoris B, Massart T (2011) A coupled two-
scale computational scheme for the failure of peri-
odic quasi-brittle thin planar shells and its applica-
tion to masonry. International journal for numerical
methods in engineering 85(9):1177–1206

33. Mercatoris B, Bouillard P, Massart T (2009) Multi-
scale detection of failure in planar masonry thin
shells using computational homogenisation. Engi-
neering fracture mechanics 76(4):479–499

34. Neto EADS, Feijóo RA (2006) Variational foun-
dations of multi-scale constitutive models of solid:
Small and large strain kinematical formulation.
LNCC Research and Development (16)

35. Nguyen VP, Stroeven M, Sluys LJ (2011) Multi-
scale continuous and discontinuous modeling of het-
erogeneous materials: A review on recent develop-
ments. Journal of Multiscale Modelling 3(04):229–
270

36. Oliver J (1989) A consistent characteristic length
for smeared cracking models. International Journal
for Numerical Methods in Engineering 28(2):461–
474

37. Oliver J, Caicedo M, Roubin E, Hernández J, Hue-
spe A (2014) Multi-scale (fe2) analysis of material
failure in cement/aggregate-type composite struc-
tures. Computational Modelling of Concrete Struc-
tures p 39

38. Oliver J, Dias I, Huespe AE (2014) Crack-path
field and strain-injection techniques in computa-
tional modeling of propagating material failure.
Computer Methods in Applied Mechanics and En-
gineering 274:289–348

39. Oliver Olivella X, Caicedo Silva MA, Roubin E,
Huespe AE, et al (2014) Continuum approach
to computational multi-scale modeling of fracture.
Key engineering materials 627:349–352

40. Oller S (2001) Fractura Mecánica: Un Enfoque
Global. Ediciones CIMNE y UPC

41. Oller S, Miquel Canet J, Zalamea F (2005) Com-
posite material behavior using a homogenization



22 Massimo Petracca et al.

double scale method. Journal of Engineering me-
chanics 131(1):65–79

42. Ortolano JM, Hernández JA, Oliver J (2013) A
Comparative Study on Homogenization Strategies
for Multi-Scale Analysis of Materials. 135, Mono-
graph CIMNE

43. Otero F, Martínez X, Oller S, Salomón O (2012)
Study and prediction of the mechanical perfor-
mance of a nanotube-reinforced composite. Com-
posite Structures 94:2920–2930

44. Otero F, Oller S, Martinez X, Salomón O (2015)
Numerical homogenization for composite materials
analysis. comparison with other micro mechanical
formulations. Composite Structures 122:405–416

45. Pelà L, Cervera M, Roca P (2011) Continuum dam-
age model for orthotropic materials: Application to
masonry. Computer Methods in Applied Mechanics
and Engineering 200(9):917–930

46. Pelà L, Cervera M, Roca P (2013) An orthotropic
damage model for the analysis of masonry struc-
tures. Construction and Building Materials 41:957–
967

47. Quinteros RD, Oller S, Nallim LG (2012) Nonlinear
homogenization techniques to solve masonry struc-
tures problems. Composite Structures 94(2):724–
730

48. Raijmakers T, Vermeltfoort A (1992) Deformation
controlled tests in masonry shear walls: report B-
92-1156. URL http://books.google.it/books?
id=HUmTPgAACAAJ

49. Rots JG (1988) Computational modeling of con-
crete fracture. PhD thesis, Technische Hogeschool
Delft

50. Scott MH, Fenves GL (2003) A krylov subspace ac-
celerated newton algorithm. In: Proc., 2003 ASCE
Structures Congress

51. Simo JC, Rifai M (1990) A class of mixed assumed
strain methods and the method of incompatible
modes. International Journal for Numerical Meth-
ods in Engineering 29(8):1595–1638

52. Trovalusci P, Masiani R (2003) Non-linear microp-
olar and classical continua for anisotropic discon-
tinuous materials. International Journal of Solids
and Structures 40(5):1281–1297

53. Wu JY, Li J, Faria R (2006) An energy release rate-
based plastic-damage model for concrete. Interna-
tional Journal of Solids and Structures 43(3):583–
612

54. Zucchini A, Lourenço P (2002) A micro-mechanical
model for the homogenisation of masonry. In-
ternational Journal of Solids and Structures
39(12):3233–3255

55. Zucchini A, Lourenço PB (2009) A micro-
mechanical homogenisation model for masonry:
Application to shear walls. International Journal
of Solids and Structures 46(3):871–886

http://books.google.it/books?id=HUmTPgAACAAJ
http://books.google.it/books?id=HUmTPgAACAAJ

	Introduction
	Classical first order computational homogenization
	Fracture-energy-based regularization in two-scale FE Computational Homogenization
	Mode I fracture test
	Application to masonry structures. Numerical modeling of shear walls
	Conclusions

