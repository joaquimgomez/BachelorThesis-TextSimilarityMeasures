





























































Comparison between nested grids and unstructured grids for a high-resolution wave forecasting system in the western Mediterranean sea


Full Terms & Conditions of access and use can be found at
http://www.tandfonline.com/action/journalInformation?journalCode=tjoo20

Download by: [Dr Manuel Espino] Date: 28 November 2016, At: 00:28

Journal of Operational Oceanography

ISSN: 1755-876X (Print) 1755-8778 (Online) Journal homepage: http://www.tandfonline.com/loi/tjoo20

Comparison between nested grids and
unstructured grids for a high-resolution wave
forecasting system in the western Mediterranean
sea

Elena Pallares, Jaime Lopez, Manuel Espino & Agustín Sánchez-Arcilla

To cite this article: Elena Pallares, Jaime Lopez, Manuel Espino & Agustín Sánchez-Arcilla
(2016): Comparison between nested grids and unstructured grids for a high-resolution wave
forecasting system in the western Mediterranean sea, Journal of Operational Oceanography,
DOI: 10.1080/1755876X.2016.1260389

To link to this article:  http://dx.doi.org/10.1080/1755876X.2016.1260389

Published online: 25 Nov 2016.

Submit your article to this journal 

Article views: 1

View related articles 

View Crossmark data

http://www.tandfonline.com/action/journalInformation?journalCode=tjoo20
http://www.tandfonline.com/loi/tjoo20
http://www.tandfonline.com/action/showCitFormats?doi=10.1080/1755876X.2016.1260389
http://dx.doi.org/10.1080/1755876X.2016.1260389
http://www.tandfonline.com/action/authorSubmission?journalCode=tjoo20&show=instructions
http://www.tandfonline.com/action/authorSubmission?journalCode=tjoo20&show=instructions
http://www.tandfonline.com/doi/mlt/10.1080/1755876X.2016.1260389
http://www.tandfonline.com/doi/mlt/10.1080/1755876X.2016.1260389
http://crossmark.crossref.org/dialog/?doi=10.1080/1755876X.2016.1260389&domain=pdf&date_stamp=2016-11-25
http://crossmark.crossref.org/dialog/?doi=10.1080/1755876X.2016.1260389&domain=pdf&date_stamp=2016-11-25


Comparison between nested grids and unstructured grids for a high-resolution
wave forecasting system in the western Mediterranean sea
Elena Pallares , Jaime Lopez, Manuel Espino and Agustín Sánchez-Arcilla

Laboratori d’Enginyeria Marítima (LIM/UPC), Polytechnic University of Catalonia (UPC), Barcelona, Spain

ABSTRACT
Traditionally wave modelling uses a downscaling process by means of successive nested grids to
obtain high-resolution wave fields near the coast. This supposes an uncertain error due to
internal boundary conditions and a long computational time. Unstructured grids avoid multiple
meshes and thus the problem of internal boundary conditions. In the present study high-
resolution wave simulations are analysed for a full year where high-resolution meteorological
models were available in the Catalan coast. This coastal case presents sharp gradients in
bathymetry and orography and therefore correspondingly sharp variations in the wind and wave
fields. Simulations with SWAN v.4091A using a traditional nested sequence and a regional
unstructured grid have been compared. Also a local unstructured grid nested in an operational
forecast system is included in the analysis. The obtained simulations are compared to wave
observations from buoys near the coast; almost no differences are found between the
unstructured grids and the regular grids. Simultaneously, tests have been carried out in order to
analyse the computational time required for each of the alternatives, showing a decrease to less
than half the time when working with regional unstructured grids and maintaining the forecast
accuracy and coastal resolution with respect to the downscaling system.

ARTICLE HISTORY
Received 11 February 2016
Accepted 4 November 2016

1. Introduction

A significant part of the European Mediterranean coast
is limited in its ability to deal with environmental,
physical and hydro-meteorological hazards due to the
inhabitation of the first few hundred metres inland.
This inhabitation has progressed in most of the locations,
on the assumption of a stable coastal fringe. This idea is
probably reinforced by a gentle sea state during most of
the year, resulting in a false perception of security by
society. However, energetic storm events are not rare at
all and, when combined together with high water levels,
can cause significant damages. In the last 20 years,
extreme storm events have been responsible for at least
50 casualties on the north-western Mediterranean coast
and for significant damages in coastal defences, harbours
and infrastructure, amounting to over EUR 30 million
(Gracia et al. 2014).

The Catalan coast is not an exception. Located in the
northeast corner of Spain, on the north-western Mediter-
ranean Sea, Catalonia is a Spanish region that in 2014
received 16.8 million tourists, who spent around EUR
15,000 million. The harbour facilities together with the
touristic attractions of Barcelona city, the nice weather
and its strategic location on the Western Mediterranean

Sea and in Europe have been the main reasons for several
cruise companies picking Barcelona as their main port of
call. But tourism is not the only activity affecting the
coastal areas in Catalonia. On the one hand, there are
several economical activities affected by the ocean con-
ditions, such as maritime transport or fisheries. On the
other hand, along the Catalan coast it is easy to find pro-
menades, buildings, roads and even railways very close to
the coast that are highly exposed to the meteo-oceano-
graphic conditions.

Thanks to advances in numerical tools and coastal
observations it is now possible to implement operational
high-resolution forecast models (waves, oceanic and
sediment transport) yielding timely and valuable inter-
vention data to reduce coastal risks due to incoming
storms. In the framework of these ideas, the European
Union has supported the iCoast project (www.icoast.
eu) in order to develop a methodology to set up an
early warning system to minimise the coastal hazards
due to storm events on European coasts. The present
study is part of the wave forecasting system proposed
in the framework of the project applied to the Catalan
coast, where the SWAN model v.40.91A (Booij et al.
1999; Ris et al. 1999) has been used to provide

© 2016 Institute of Marine Engineering, Science & Technology

CONTACT Elena Pallares elena.pallares@upc.edu Laboratori d’Enginyeria Marítima (LIM/UPC), Polytechnic University of Catalonia (UPC), Jordi Girona, 1-3,
Ed. D1, 08034 Barcelona, Spain

JOURNAL OF OPERATIONAL OCEANOGRAPHY, 2016
http://dx.doi.org/10.1080/1755876X.2016.1260389

http://orcid.org/0000-0003-2656-2311
http://orcid.org/0000-0002-9026-3976
http://orcid.org/0000-0002-3450-6697
www.icoast.eu
www.icoast.eu
mailto:elena.pallares@upc.edu
http://www.tandfonline.com


high-resolution wave conditions in a reduced time
frame. This reduction of time is decisive in the period
previous to a storm event, when certain decisions need
to be made in order to minimise the impacts in coastal
areas.

Although nowadays there are several operational sys-
tems providing wave forecasts in the study area, all of
them use the traditional methodology of nested grids
to improve the resolution in some coastal areas. In the
present study different grid configurations are tested,
including unstructured grids as an alternative to the
downscaling process, and considering the use of bound-
ary conditions from an external system, in order to
obtain high-resolution wave forecast that are as accurate
as possible while reducing the computational time.

The paper is structured in three main sections. First, a
detailed revision of the methodology is presented,
including an introduction of the study area, a brief
description of the Simulating Waves Nearshore
(SWAN) wave model, a revision of the usage of unstruc-
tured grids in wave modelling, followed by the exper-
iment configuration, the data available and the
computer characteristics. Next are presented part of
the results obtained during the development of the
study for a one-year period and during a storm event.
The paper finishes with a discussion section and the
conclusions.

2. Methodology

2.1 Study area

The wave forecast presented in this study is focused on
the Catalan coast, despite all the configurations covering
the Western Mediterranean Sea. The Catalan coast is
located on the north-eastern Spanish coast, between lati-
tudes 40°45′N and 42°25′N and longitudes 0°45′E and
3°15′E, and has a length of about 600 km. The Pyrenees
mountain range, located northern of the study domain, is
the main orographic feature in the area and determines
in great measure the meteorological conditions on the
coast. The wind fields are highly variable, mainly con-
trolled by the heterogeneous orography, the air–sea
temperature differences and the passage of low-pressure
centres from the Atlantic. The prevalent winds, on aver-
age not very intense except for storm events, come from
the north and north-west, mainly during winter; south-
erly and easterly winds are also important, particularly
during the months of February, March, April and
November (Arnau 2000). When the wind blows from
the north, the mountain ranges induce wind channelling
through river valleys, with the most important being the
Ebro Delta wind jet. These characteristic land-to-sea

winds are highly variable both in space and time (Sán-
chez-Arcilla et al. 2008) and are particularly intense
and persistent during autumn and winter (Alomar
et al. 2014).

The predominant wave direction, as happens with the
wind fields, varies along the coast, showing the topo-
graphic control due to a complex bathymetry, with sub-
marine canyons and a heterogeneous continental shelf
width (Sánchez-Arcilla et al. 2008; Bolaños et al. 2009).
Sánchez-Arcilla et al. (2008) describe how the southern
and northern sections of the coast show a predominance
of north-west and north wave conditions, while the cen-
tral part of the Catalan coast is dominated by east and
south wave conditions. The higher waves come from
the east, where the largest fetches and stronger winds
coincide. In the areas where the wind blows from the
north-west (offshore winds), there is a tendency to
develop a large amount of bimodal spectra due to the
co-existence of sea and swell waves (Bolaños et al. 2007).

2.2 The SWAN model

The SWAN Cycle III v.4091A code has been used to
simulate the wave evolution in the area. SWAN is a
third-generation wave model that computes random,
short-crested wind generated waves in coastal regions
and inland waters (Booij et al. 1999; Ris et al. 1999).
This model is an extension of deep water third-gener-
ation wave models based on the wave action balance
equation with sources and sinks: it incorporates the
triad wave–wave interactions and the depth-induced
breaking, which are especially useful in shallow waters;
it also admits ambient currents as an input.

Pallares et al. (2014) performed a calibration process
of the SWANmodel for semi-enclosed domains, particu-
larly on the Catalan coast; the coefficients determined
therein have been used in the present work. Spherical
coordinates and nautical convention have been selected.
The wind growth is obtained as the sum of a linear term
due to Cavaleri and Malanotte-Rizzoli (1981) and an
exponential term that is the same one used by WAM
Cycle 3, due to Snyder et al. (1981) and rescaled by
Komen et al. (1984). The quadruplet non-linear wave–
wave interactions are computed using the Discrete Inter-
action Approximation proposed by Hasselmann et al.
(1985). The whitecapping term used is the Komen et al.
(1984) formulation but using a delta coefficient of 1.
Regarding the numerical aspects, the scheme for geo-
graphic propagation has a maximum number of iter-
ations per time step of 15, and a time step of 15 min
has been chosen, which is small enough to reproduce
the wind and wave variability but still allows an afford-
able computational cost. The frequency range considered

2 E. PALLARES ET AL.



is 0.01–1 Hz, with 49 values logarithmically spaced with
a frequency resolution of df/f = 0,1 as recommended by
the SWAN manual (SWAN team 2015a), and the direc-
tional resolution is 10°.

2.3 Unstructured grids

Traditionally, the methodology to improve the resol-
ution of wave forecasting near the coast consists of a
downscaling process with a system of nested domains,
each with a smaller resolution and covering a smaller
area than the previous one (Alari et al. 2008; Alomar
et al. 2014; Sánchez-Arcilla et al. 2014), where the
required boundary conditions are provided by the coar-
ser mesh.

In the present study the usage of an unstructured grid
with a varying mesh size is also considered. The main
advantage of using an unstructured grid for wave model-
ling is that it allows working with a single grid with
different resolutions at each sub-domain, thus improving
the resolution in coastal areas, and therefore the nesting
is not needed. Another advantage is that the unstruc-
tured grid is able to reproduce the sharp coastline
more accurately than regular meshes. Finally, unstruc-
tured grids allow indirectly what is known as two-way
nesting, where information is transferred not only
from the coarser to the finer domain but also in the
other direction – a process especially interesting in situ-
ations with inland winds, such as the case of the Mistral
on the Mediterranean coast.

The unstructured grids have been used in wave mod-
elling mainly in small domains (Hsu et al. 2005; Zijlema
2010; Siadatmousavi et al. 2015) nested to regional or
global grids. This more typical approach is presented
in the present study in comparison to a regional unstruc-
tured grid designed to cover the entire Western Mediter-
ranean Sea.

The SWAN model is able to work with both types of
grids, nested regular systems and unstructured grids,
using exactly the same physics, allowing a comparison
under the same conditions. Zijlema (2010) presents
and validates the numerical scheme adapted for unstruc-
tured grids, consisting of a vertex-based, fully implicit,
finite-differences method that requires several sweeps
through the grid. For the regular grids, SWAN provides
several numerical schemes; however, among them the
one that was used for this exercise is the backward
space and backward time, a first-order upwind scheme
(SWAN team 2015b), since it is the equivalent to the
numerical scheme used for the unstructured grids. As
mentioned by Zijlema (2010), in most of the situations
the CPU cost per grid point is higher for the

unstructured meshes; however, the reduction of the
number of grid points in this type of meshes offsets the
total time.

2.4 Experimental configuration

Four different configurations have been tested to deter-
mine which may be the best option, regarding the accu-
racy of results and the computational time, when
designing an operational wave forecasting system
(Figure 1). Different situations are considered: on the
one hand, the regular nested grids are compared with a
unique unstructured mesh, while, on the other hand,
the systems covering the entire Western Mediterranean
Sea, a semi-enclosed domain, are compared with local
grids nested in actually running regional forecast sys-
tems. The aim of this comparison is to provide accurate
wave conditions with high resolution in coastal areas in
an efficient way.

Regarding the grids covering the entire semi-enclosed
domain, the regular nested system (herein named A) is
comprised of three meshes with a spatial resolution of
9, 3 and 1 km, while the regional unstructured mesh
for the Western Mediterranean Sea (herein named B)
has 8317 elements and 4548 nodes, with a resolution
from 40 km in open waters to 800 m in shallow waters
(Figure 2(a)). Similar systems to the ones presented pre-
viously are considered in the second alternative, albeit
covering a smaller area, the Balear Sea, and nested to
an actually running regional operational system. The
first one (herein named C) consists of the two smaller
regular nested grids (with 3 km and 1 km spatial resol-
ution), and the second one consists of a local unstruc-
tured grid covering the same area (herein named D),
with 4928 elements and 2710 nodes, with a resolution
from 25 km at the boundaries to 800 m in the coastal
area (Figure 2(b)). In Tables 1 and 2 the characteristics
of all the meshes used and the configurations considered
are presented.

In order to provide some general results and con-
clusions, avoiding the seasonal effects, one year of simu-
lations is performed, corresponding to 2013.
Additionally, a storm event is also analysed in detail,
since during these periods the information provided by
the model forecast needs to be more accurate, mainly
for coastal early warning systems as mentioned
previously.

2.5 Data available

Three buoys located along the Catalan coast and oper-
ated by the Spanish harbour agency Puertos del Estado
(www.puertos.es) were considered for the validation

JOURNAL OF OPERATIONAL OCEANOGRAPHY 3

www.puertos.es


process. Two of the buoys, Barcelona coast and Tarra-
gona coast, are moored near the coast; the other buoy,
Tarragona, is moored in deep waters (Figure 1,
Table 3). The bathymetry used for the simulations is
obtained from GEBCO (General Bathymetric Chart of
the Oceans, www.gebco.net) with a grid resolution of
30 arc-seconds (.0083°, around 900 m in these latitudes).

The winds for the present study have been provided
by the Spanish Meteorological Agency (AEMet, www.
aemet.es) and include a coarser wind field that provides
the wind conditions 10 m above the sea level, with a
spatial resolution of .16° (around 16 km in these lati-
tudes) for the entire Western Mediterranean Sea, and a
better resolution wind field that covers only the Catalan
coast area, with a spatial resolution of .05° (around 5 km
in these latitudes). Both wind fields are obtained using
the High Resolution Limited Area Model (HIRLAM)
(Unden et al. 2002) and have a temporal resolution of
1 h and a forecast horizon of 72 h. In the present study
analysed winds have been used for the two resolutions
available, herein named HIRLAM .16° and HIRLAM
.05°.

The bad accuracy of the winds, especially when the
resolution is low, is commonly reported as one of the
main causes of poor results of the wave models near

the coast (Ardhuin et al. 2007), so a validation of the
wind fields over the sea has been performed for a one-
year period. Since it has not been possible to find other
wind measurements on the sea for the selected period,
only one validation location is presented, corresponding
to the Tarragona buoy described previously.

The results obtained are shown in Figure 3, where the
empirical histograms obtained as the distribution of the
different winds during the whole period are presented
using a range of 1 m/s. Additionally, some statistics
(detailed in Section 3.1) have been calculated and are
shown in Table 4. From the validation process it can
be stated that the general quality of the wind is accepta-
ble, with correlation coefficients around .85 in intensity
and slightly lowers, around .67, in direction for the two
models. However, both of them tend to underestimate
the wind lower than 2 m/s, and overestimate the inten-
sity of the wind fields for higher velocities (2–6 m/s).
For winds over 10 m/s (important during storm events),
both models present a similar slightly overestimation.
On the other hand, the root mean square error
(RMSE) of the direction obtained for both wind fields
are a little bit high due to the highly variability in wind
and wave directions in the measurement location. In
conclusion, in the validation location there are no

Figure 1. Representation of the four configurations tested in the study. The small circles in configuration D represent the buoy
locations. Source: Google, Landsat.

4 E. PALLARES ET AL.

www.gebco.net
www.aemet.es
www.aemet.es


Figure 2. Detail of the unstructured grids used for the western Mediterranean sea grid (top), used as configuration B, and the Balear
unstructured grid (bottom), used in configuration D. The colour scale represents the grid size in km as the medium length of the sides of
each triangle.

Table 2. Description of the four configurations considered in the
present study, named A–D and formed by one or several grids.
The need of boundary conditions is resumed in the third column.
Configuration Grids used Boundary conditions

A Mediterranean regular
Balear regular
Local regular

No

B Mediterranean unstructured No
C Balear regular Local regular Yes
D Balear unstructured Yes

Table 3. List of the instruments location and the information
provided by each of them for the Catalan coast.
Name Lon Lat Depth Parameters provided

Begur 3.65° E 41.92° N 1200 m Hs, Dir, Tm02, Tp, Wind
Barcelona coast 2.20° E 41.28° N 68 m Hs, Dir, Tp
Tarragona 1.47° E 40.68° N 688 m Hs, Dir, Tm02, Tp, Wind
Tarragona coast 1.19° E 41.07° N 15 m Hs, Dir, Tp

Table 1. Description of the grids used in the study, including the mesh resolution, the domain covered, the number of grid points for
regular grids and the number of nodes and triangles for unstructured grids and the wind forcing.
Grid Resolution Lat–Lon Grid points Wind forcing

Mediterranean regular 9 km 4.900 W–16.048 E
35.000 N–44.523 N

119 × 196 (23,324 nodes) HIRLAM .16°

Balear regular 3 km 0.470 W–4.500 E
38.670 N–42.830 N

155 × 139 (21,545 nodes) HIRLAM .16°

Local regular 1 km 0.145 E–3.291 E
40.083 N–42.787 N

136 × 332 (45,152 nodes) HIRLAM .05°

Mediterranean unstructured 40 km to 800 m 5.495 W–16.218 E
35.091 N–44.424 N

4548 nodes
8,317 triangles

Merged wind

Balear unstructured 25 km to 800 m 0.331 W–4.500 E
38.670 N–42.830 N

2710 nodes
4928 triangles

Merged wind

JOURNAL OF OPERATIONAL OCEANOGRAPHY 5



important differences in the accuracy of the two models
despite the different resolution, so one cannot be con-
sidered to work better than the other. However, as Alo-
mar et al. (2014) concluded, the wave field tends to
improve considerably when forced by winds with better
resolution in space and time, so when possible the high-
resolution wind field will be used instead of the coarser
one. In Table 1 the wind forcing used for each of the
SWAN domains is detailed.

For both unstructured grid configurations a unique
wind field can be used, so to take advantage of the
high-resolution information a merging process has
been performed to combine both existing wind fields
into a new one. Since both wind fields proceed from
the same source and the continuity is assured, the mer-
ging process consisted in interpolating the boundaries.

As previously introduced, in order to avoid some
computational time when running the coarser wave
domain, a consideration has been to nest our system to
an actually working operational service. The boundary
conditions necessary for running configurations C and
D are obtained from the wave forecast system of the

Spanish harbour agency, Puertos del Estado, using the
significant wave height, the mean wave period, the
mean wave direction and the wave spread coefficient to
generate a theoretical spectrum at the boundaries. The
operational forecast system, described in Gomez and
Carretero (2005), consists of an application of the
WAM model (the WAMDI group 1988) for the Spanish
Mediterranean coast, with two nested domains with a
spatial resolution from 5 to 10 min and a temporal resol-
ution of 1 h that are operated on a twice-a-day cycle and
provide a forecast horizon of 72 h. However, analysed
wave fields have been used in the present study. The sys-
tem is forced with the HIRLAM .16° wind field described
previously.

2.6 Computational structure

The computations were performed in a small cluster
named ‘Alien’ belonging to the computational centre of
the civil engineering school of Barcelona, BarcelonaTech.
The machine is made up of Dell computers and a Red
Hat Linux operating system, including four nodes with
Intel processors and two nodes with AMD processors.
Each of the four Dell PowerEdge R900 nodes has four
quad-core Intel Xeon processors with 2.4 GHz, 16 MB
of L3 cache per processor and 128 GB of RAM, while
the two Dell PowerEdge R805 nodes have quad-core
AMD Opteron processors with 2.5 GHZ, 6 MB of
cache per processor and 32 GB of RAM.

An initial test was performed to determine the time
requirements for running the SWAN model depending

Figure 3. Empirical histogram of the wind intensity (m/s) for the buoy measurements, the HIRLAM .16° wind model and the HIRLAM
.05° high-resolution wind model for the 2013.

Table 4. Results of the validation of the two wind models
including the wind intensity (m/s) and wind direction (deg) for
the 2013 year in Tarragona buoy location.

Wind intensity Wind direction

Model RMSE [m/s]
Bias
[m/s] SI R RMSE [°] SI R

HIRLAM .16° 1.89 .54 .397 .844 77.45 .368 .668
HIRLAM .05° 2.02 .92 .424 .856 77.08 .214 .667

6 E. PALLARES ET AL.



on the number of CPUs used. The Western Mediterra-
nean Sea domain was chosen for the exercise, forced
with the HIRLAM .16° wind field, for a period of three
days. Only the Intel nodes were considered, and the par-
allelisation was carried out through the OpenMP
protocol.

The results presented in Figure 4 show an expo-
nential decrease of the computational time required
to run the model when increasing the CPUs. The
reduction of time is especially significant from one
to eight processors, while adding more processors
does not result in an appreciable time savings. It
can be concluded that, for the machine used, the opti-
mal situation would be to work with eight or more
processors. However, the machine available is shared
with other users, so only one core can be guaranteed
per jobs (equivalent to four processors). For this
reason it was decided herein to use four processors
to run the SWAN model.

3. Results

3.1 Validation tools

The validation of results from the different simulations
was mainly based on time series and Taylor diagrams
(Taylor 2001). Some statistical parameters have also
been also employed for quantitative comparisons; the
main ones are the RMSE, the bias, the scatter index

(SI) and the correlation coefficient (R). These parameters
are obtained as follows:

RMSE =
�����������������∑N

i=1 (Si − Oi)2
N

√
, (1)

bias =
∑N

i=1 (Si − Oi)
N

, (2)

SI = RMSE
�O

, (3)

R =
∑N

i=1 ((Si − �S) · (Oi − �O))����������������∑N
i=1 (Si − �S)

2
√

·
�����������������∑N

i=1 (Oi − �O)
2

√ . (4)
where S corresponds to the simulated data and O to the
measured ones (observations); N is the number of data;
and �O and �S correspond to the mean value of the time
series for observed and measured values, respectively.
All these formulations except the bias have been adapted
to analyse the wave direction, considering the minimum
angle between the two data (simulated and measured).

The data measured by the instruments and those
obtained from the SWAN simulations both correspond
to 1 h time resolution for the entire study period, provid-
ing a time series longer than 8000 values. The wave par-
ameters considered for the validation are summarised in
Table 5. Results from the wave model correspond to the
same location as the measurement instruments after an

Figure 4. Time requirement in min necessary to run the test case using from 1 up to 16 processors.

JOURNAL OF OPERATIONAL OCEANOGRAPHY 7



interpolation performed by the SWAN model: a spatial
interpolation in the discrete components of the spectra;
hereafter the integral parameters are computed.

3.2 Yearly analysis

Four different configurations have been tested for a one-
year period and validated in three different locations. In
these sections only the most representative results are
presented. That implies that two unique locations will
be shown: the Tarragona deep water buoy, since it is
the only one located in the open sea, and the Barcelona
coast buoy. The results obtained from the Tarragona
coast buoy present very similar behaviour to the Barce-
lona coast buoy, and the observed differences will be
mentioned in the discussion but not shown in detail.

A comparison between the results from the different
configurations and the Barcelona coast buoy measure-
ments are represented in the Taylor diagrams in Figure 5
for the significant wave height and the mean wave
period, respectively. The results for the peak period are

not presented but have behaviour very similar to the
Tm02. From the graphics it is straightforward to declare
that configurations A and B have almost the same stat-
istics, while configuration C is slightly further from the
buoy point and configuration D presents the worst
results.

In the first columns of Table 6 the statistic for the sig-
nificant wave height are shown, with a RMSE around
22 cm and a negative bias of 5 cm in all the configur-
ations except D. The correlation coefficient is very
good for configurations A, B and C, with values around
.92, but SI is slightly high, around .30. Configuration D is
the only one presenting a positive bias.

Also in Table 6 the results for the mean period are
presented. The RMSE is around 0.6 s for configurations
A, B and C, and the bias is not very important except for
configuration D, where a clear overestimation is present.
The correlation coefficients take values around .80, and
SI has values around .16.

The wave direction is validated with RMSE around
36°, a very low scatter index and a correlation coefficient
of .68 in the best situations.

In summary, configurations A, B and C have a similar
quality for the significant wave height, while configur-
ations A and B work slightly better than C for the
mean period and the wave direction. For the three
wave parameters considered, configuration D is clearly
the one presenting the worst results, showing an overes-
timation of the significant wave height and the mean
wave period not present in the other alternatives.

Almost the same conclusions may be extracted from
the comparison between the four configurations and

Figure 5. Taylor diagram of the significant wave height (left) and the mean wave period (right) for the annual analyse in the Barcelona
coast location. The letters correspond to the configurations tested.

Table 5. Definition of the bulk parameters used to compare the
SWAN simulations.
Moment mn

mn =
�fmax
fmin

�2p
0
f n · E( f , u) du df .

Significant wave
height Hs Hs = 4

����
mo

√
.

Mean wave direction Dir Dir = arctg
�
sinu · E( f , u)df du�
cosu · E( f , u)df du

[ ]
.

Mean zero-crossing
period

Tm02 Tm02 = 2p
����
m0
m2

√
.

Peak wave period Tp Period corresponding to the maximum
energy

8 E. PALLARES ET AL.



the measurements of the Tarragona coast buoy (not
shown). The main differences derive from the fact that
the mean values of the variables are smaller, so the
RMSEs are also smaller, and the correlation coefficients
slightly worse (e.g. around .86 for the significant wave
height or .68 for the mean period).

The results from the validation process for the deep-
water Tarragon buoy are presented in Figure 6, where
the Taylor diagrams for the significant wave height and
the mean wave period are shown. From the diagrams it
can be declared that there are no important differences
between configurations A, B and C, while configuration
D tends to work slightly worse mainly for the mean wave
period.

The results in Table 7 show that, in contrast with the
previous case, configuration D does not present results
very different from the others for the significant wave
height in terms of correlation coefficient. At this point
located in deep water the RMSEs are around 25 cm;
the bias is negative in all the configurations except D,
as was happening in coastal waters; and the correlation

coefficients tend to be higher than in coastal zones,
between .91 and .94.

Similar behaviour is identified when looking at the
mean wave period in Table 7. The RMSE is around
0.60 s, there is an underestimation of the Tm02 in all
the configurations except D, and the correlation coef-
ficients and scatter index are better than in coastal
areas.

The wave direction is analysed in the last columns of
Table 7. In deep water the RMSE is slightly higher,
around 37°, for configurations A, B and C, while for con-
figuration D the RMSE is smaller than in coastal areas. In
general the correlation coefficients are better, with values
around .70 for configurations A, B and C, and .6 for con-
figuration D (still better than in coastal areas).

In summary, the four configurations have good accu-
racy for the significant wave height, but D is the worst
among them. For the mean wave period the bad behav-
iour of configuration D is enhanced. However, in general
all the configurations work better in deep water than in
coastal areas.

Table 6. Results of the validation of the four configurations including the significant wave height (m), the mean wave period (s) and the
wave direction (deg) for the 2013 year in Barcelona coast buoy location.

Hs Tm Dir

RMSE [m] Bias [m] SI R RMSE [s] Bias [s] SI R RMSE [°] SI R

A 0.227 −.053 .304 .921 0.602 .076 .155 .827 33.93 .094 .686
B 0.223 −.048 .299 .922 0.614 .092 .158 .816 33.69 .094 .681
C 0.227 −.046 .304 .920 0.654 .083 .169 .798 36.25 .101 .668
D 0.295 .156 .396 .823 0.849 .726 .219 .668 54.35 .151 .534

Figure 6. Taylor diagram of the significant wave height (left) and the mean wave period (right) for the annual analyse in the Tarragona
location. The letters correspond to the configurations tested.

JOURNAL OF OPERATIONAL OCEANOGRAPHY 9



3.3 Storm analysis

The previous results show the average behaviour of the four
configurations over a one-year period. However, one of the
main purposes of an operational forecast system is to be able
to predict a storm event a few days in advance. For this
reason, the annual results have been analysed in order to
identify all the storm events reaching the coast. The criteria
used to define a storm were a significant wave height
threshold of 2 m and a minimum duration of 8 h (Lin-Ye
et al. 2016). At the Tarragona deep-water location seven
storms were detected, with significant wave heights at the
peak of the storm between 3 and 4.5 m. However, only
three of them reached the coast and were detected from
the Barcelona coast buoy or Tarragona coast buoy. The
three stormshada similar pattern, occurringduring autumn
and winter and generated by important east winds. Since
one of them was particularly intense and caused severe
damages on the Catalan coast, it has been selected for the
present study. The chosen storm occurred between the
26th of February 2013 and the 6th ofMarch2013, and it pre-
sents a two-peak profile. The first peak reaches a significant
wave height of 4.5 m, and the secondone between3 and 4 m
depending on the locations.

In Figure 7 the time series for the significant wave
height, the mean wave period and the direction, both
observed and modelled, are presented for the Barcelona
coast and Tarragona locations. The storm also reached
the Tarragona coast buoy, but the results are not
shown due to their similarity to the Barcelona buoy.
From a qualitative analysis it seems that the four con-
figurations tested work properly for the first storm
peak but present some errors for the second one.

The statistics obtained for the Barcelona coast buoy,
presented in Table 8, show that for significant wave
height there is almost no differences between configur-
ations A, B and C, while configuration D presents the
worst results, with a RMSE that doubles the others. It
is interesting to remark that during the storm event con-
figuration D presents an important negative bias in con-
trast with what is happening in the annual mean, where
configuration D presents an overestimation. For the
mean wave period, configurations A and B have similar
behaviour, while C and D present some problems in the
RMSE for the first one and the correlation coefficient in

the second one. The bias for all the configurations is
higher than that observed for the annual average. The
direction is quite constant during the entire event and
is well represented by the four configurations, although
A and B present better results than C and D.

The results in deep waters, presented in Table 9, show
that, in contrast with the results for coastal areas, the sig-
nificant wave height has better behaviour for configur-
ations A and B than for configurations C and D, which
depend on the boundary conditions obtained from the
operational model. As previously seen, configuration D
tends to underestimate the significant wave height
during storm events as opposed to the annual behaviour.
For the mean wave period and the mean wave direction
similar observations can be made.

In conclusion, configurations A and B work best, and
configuration D is the one presenting the worst results.
The main difference can be found in configuration C,
which works fine in coastal areas but not so well in
deep waters.

3.4 Computational time requirements

Until now the comparison has been focused on the accu-
racy and quality of the results. However, there is another
key point to account for in the comparison: the compu-
tational time required to obtain the results. This aspect
can become vital in an early warning system when the
information is required as soon as possible in order to
be able to take decisions.

Following this idea, a comparison of the four con-
figurations described in Section 2.4 has been carried
out. The selected period for the comparison was June
2013, and the computer used is the one described in Sec-
tion 2.6.

The results for each of the grids are presented in the
third column of Table 10. The total time for each con-
figuration can be obtained as the sum of the time
required for each of the domains included in it. When
necessary, the time required to extract the boundary con-
ditions from the actual operational system and transform
it to introduce them in SWAN is included. The results
show a reduction of time of about 66% from the tra-
ditional way of providing a high-resolution wave forecast

Table 7. Results of the validation of the four configurations including the significant wave height (m), the mean wave period (s) and the
wave direction (deg) for the 2013 year in Tarragona buoy location.

Hs Tm Dir

RMSE [m] Bias [m] SI R RMSE [s] Bias [s] SI R RMSE [°] SI R

A 0.249 −.033 .276 .935 0.614 −.262 .149 .855 37.83 .105 .685
B 0.245 −.025 .271 .940 0.607 −.248 .148 .856 36.89 .103 .714
C 0.242 −.022 .268 .939 0.604 −.210 .147 .857 37.71 .105 .704
D 0.323 .150 .358 .914 0.683 .321 .166 .755 48.43 .135 .606

10 E. PALLARES ET AL.



Figure 7. Time series for the significant wave height (first row), the mean wave period (second row) and the mean wave direction (third
row) for the Barcelona coast location (first column) and the Tarragona location (right column) during the storm event. In black the buoy
measurements are represented, while the colours correspond to the four configurations tested.

Table 9. Results of the validation of the four configurations including the significant wave height (m), the mean wave period (s) and the
wave direction (deg) for the storm event in Tarragona buoy location.

Hs Tm Dir

RMSE [m] Bias [m] SI R RMSE [s] Bias [s] SI R RMSE [°] SI R

A 0.222 .008 .108 .975 0.565 .045 .094 .899 16.19 .045 .754
B 0.233 .005 .113 .975 0.532 .010 .088 .915 17.64 .049 .722
C 0.370 .137 .180 .949 0.809 .227 .134 .873 21.53 .060 .546
D 0.438 −.058 .213 .903 0.822 −.130 .136 .756 24.60 .068 .608

Table 8. Results of the validation of the four configurations including the significant wave height (m), the mean wave period (s) and the
wave direction (deg) for the storm event in Barcelona coast buoy location.

Hs Tm Dir

RMSE [m] Bias [m] SI R RMSE [s] Bias [s] SI R RMSE [°] SI R

A 0.364 −.190 .171 .965 0.871 .656 .162 .935 11.31 .031 .943
B 0.351 −.209 .165 .969 0.860 .611 .160 .940 13.45 .037 .811
C 0.326 −.068 .153 .958 1.049 .693 .196 .925 16.29 .045 .689
D 0.689 −.301 .324 .826 0.808 .394 .151 .796 20.81 .058 .676

JOURNAL OF OPERATIONAL OCEANOGRAPHY 11



(the nested grids, configuration A) to the regional
unstructured grid proposed in the present study (con-
figuration B). Configuration C, using boundary con-
ditions from an operational system, presents a
reduction of time of about 23% with respect to configur-
ation A. Finally, the Balear unstructured grid (configur-
ation D) is faster than configuration C but slower than
configuration B due to the time required to read the
boundary conditions, despite configuration D having
fewer nodes than B.

4. Discussion

In the present study the use of unstructured grids is pre-
sented as an alternative to the traditional downscaling
methods consisting of a series of nested grids. The
unstructured grids (Figure 2) allow the boundary con-
ditions to be removed, obtaining high-resolution fore-
casts in less computational time. However, it should be
taken into account that designing an efficient unstruc-
tured grid is a long process, and still some small pro-
blems can appear, as happens with configuration D
(Pallares 2016).

From the analysis of annual results it can be con-
cluded that using a system of nested grids (configuration
A) or a regional unstructured grid (configuration B) pro-
vides almost the same results, so there is no effect of the
meshes used on the accuracy of the forecast. Some differ-
ences may appear when nesting the local grids (regular as
in configuration C or unstructured as in configuration
D) due to the boundary conditions. These differences
mainly depend on the quality of the boundary conditions
for regular grids. From the present study it can be stated
that using good boundary conditions generates forecasts
very similar to the ones generated by a regional model.

The mentioned differences are more relevant when
nesting an unstructured grid into a regular regional sys-
tem (configuration D), obtaining lower correlation coef-
ficients and presenting a slight overestimation of the
results not seen in the other configurations. It should
be pointed out that in the SWAN model it is possible

to introduce boundary conditions in two different
ways: providing the full spectrum in all the boundary
points, or providing some bulk parameters (significant
wave height, wave period, wave direction and wave
spread) and letting the model calculate a theoretical
spectrum with this information. In both configurations
C and D, the second option has been used, but only
some problems have been detected with the unstructured
grid (configuration D). In order to assure that the small
problems in configuration D are due to the reading of the
boundary conditions and not related to the grid design,
some additional tests have been carried out. When run-
ning configuration D using the full spectra as boundary
conditions, obtained directly from SWAN simulations in
the biggest grid of configuration A, the obtained results
are almost equivalent to the ones from configuration
C. From the analysis of the test it seems that the local
unstructured grid only works properly when the bound-
ary conditions are provided as a spectra (not always
available from an operational forecast service), and
some errors appear when the boundary conditions are
provided in parameter form.

A storm event has also been analysed, with very similar
conclusions. Although during energetic events the differ-
ent configurations tend to work better than for the annual
average, the behaviours of the different configurations are
very similar. The regional configurations (A and B) pre-
sent very similar results, confirming that there is almost
no contrast between unstructured grids and regular nested
grids. The differences, more important during energetic
events, appear when introducing boundary conditions
from an operational forecasting system.

The computational time required is the key point of
the configuration comparison. All the considered con-
figurations present a reduction of time with respect to
the traditional methodology, with the unstructured
regional grid being the most important, with a decrease
of around 66% without losing quality in the wave fore-
cast. The local regular domains nested in a forecast sys-
tem also present very good results and a reduction of
time of 23% with respect to the traditional methodology.

The unstructured grids have considerably fewer
points than the regular grids (Table 1). However, the
numerical scheme for these grids is slower, obtaining a
total computational time per grid of the same order of
magnitude as a regular grid. The advantage derives
from the fact that only one unstructured grid is necessary
as compared to a system of several nested grids.

One last critical point is that the Mediterranean
unstructured grid is faster than the Balear unstructured
grid despite having a greater number of nodes. This
increase of time is due to the process of reading and
interpolating the boundary conditions from several

Table 10. Computational time requirements for each of the grids
used in the study (third column) and for each configuration
tested (fourth column).
Configuration Grids used Grid time Total time

A Mediterranean regular 7 h 46 min 24 h 17 min
Balear regular 8 h 10 min
Local regular 8 h 21 min

B Mediterranean unstructured 8 h 11 min 8 h11 min
C Processing boundary conditions 10 min 17 h 32 min

Balear regular 9 h 1 min
Local regular 8 h 21 min

D Processing boundary conditions 10 min 14 h 43 min
Balear unstructured 14 h 33 min

12 E. PALLARES ET AL.



locations at the boundaries into the grid nodes located at
the boundaries (not regularly distributed). When work-
ing with boundary conditions in spectral form, the
time required to run the Balear unstructured grid is
reduced to 5 h and 12 min.

5. Conclusions

In recent years the application of unstructured grids in
wave modelling has been gaining relevance. In the pre-
sent study an unstructured grid applied to a regional
environment like a semi-enclosed sea is compared to
the traditional downscaling method in terms of both
the accuracy of the results and the computational time
required. Two local grids (one regular and the other
unstructured) nested in an operational system are also
included in the comparison. The main conclusions
obtained are the following:

– Designing a good unstructured grid is a hard process
that only needs to be done once. After obtaining an
efficient and accurate unstructured grid, it is possible
to achieve the same forecast accuracy and costal resol-
ution as the traditional downscaling method, with an
important reduction of the computational time.

– For semi-enclosed domains it is more interesting to
generate a regional unstructured grid than a local
grid nested into an operational forecasting system.
However, if the operational system provides good
boundary conditions, as happens in the present
study, the local nested grid may provide accurate
results with a reduction of time with respect to the
traditional method.

– The SWAN model may present some differences
when using boundary conditions in parameter for-
mat in unstructured grids with respect to regular
grids. These differences disappear when the bound-
ary conditions come in a spectral format.

Acknowledgements

The authors want to acknowledge the Spanish meteorological
agency (Agencia Estatal de Meteorologia, AEMET, Ministerio
de Agricutura, Alimentación y Medio Ambiente) for providing
the wind fields for the present study, the Spanish harbour
authority Puertos del Estado for providing the buoy measure-
ments data and boundary conditions, and the Secretaria d’Uni-
versitats i Recerca del Dpt. d’Economia i Coneixement de la
Generalitat de Catalunya (ref. 2014SGR1253).

Disclosure Statement

No potential conflict of interest was reported by the authors.

Funding

This work has been performed in the framework of the Span-
ish national project PLANWAVE (ref. CTM2013-45141-R)
from the MINECO and FEDER and the European project
iCOAST (no. ECHO/SUB/2013/661009) funded by the Euro-
pean Commission, Directorate – General Humanitarian Aid
and Civil Protection – ECHO, A.5 Civil Protection Policy, Pre-
vention, Preparedness and Disaster Risk Reduction Unit.

ORCID

Elena Pallares http://orcid.org/0000-0003-2656-2311
Manuel Espino http://orcid.org/0000-0002-9026-3976
Agustín Sánchez-Arcilla http://orcid.org/0000-0002-3450-
6697

References

Alari V, Raudsepp U, Kouts T. 2008. Wind wave measure-
ments and modelling in Küdema bay, Estonian
Archipelago sea. J Mar Res. 74:S30–S40.

Alomar M, Sanchez-Arcilla A, Bolaños R, Sairouni A. 2014.
Wave growth and forecasting in variable, semi-enclosed
domains. Cont Shelf Res. 87:28–40.

Ardhuin F, Bertotti L, Bidlot J, Cavaleri L, Filipetto V, Lefevre
J, Wittmann P. 2007. Comparison of wind and wave
measurements and models in the western Mediterranean
sea. Ocean Eng. 34:526–541.

Arnau PA. 2000. Aspectos de la variabilidad de mesoescala de
la circulación marina en la plataforma continental catalana
[PhD thesis]. Barcelona: Universitat Politecnica de
Catalunya.

Bolaños R, Jordà G, Cateura J, Lopez J, Puigdefabregas J,
Gomez J, Espino M. 2009. The XIOM: 20 years of a regional
coastal observatory in the Spanish Catalan coast. J Mar Res.
77:237–260.

Bolaños R, Sánchez-Arcilla A, Cateura J. 2007. Evaluation of
two atmospheric models for wind-wave modelling in the
NW Mediterranean. J Mar Res. 65:336–353.

Booij N, Ris R, Holthuijsen L. 1999. A third-generation wave
model for coastal regions: 1. Model description and vali-
dation. J Geophys Res. 104:7649–7666.

Cavaleri L, Malanotte-Rizzoli P. 1981. Wind wave prediction
in shallow water: theory and applications. J Geophys Res.
86:961–973.

Gomez Lahoz M, Carretero Albiach J. 2005. Wave forecasting
at the Spanish coasts. J Atmos Ocean Technol Sci. 10:389–
405.

Gracia V, García-Leon M, Sánchez-Arcilla A, Gault J, Oller P,
Fernández J, Sairouni A, Cristofori E, Toldrà R. 2014. A new
generation of early warning system for coastal risk. The
iCoast project. International Conference in Coastal
Engineering, ICCE 2014, Seoul, Korea.

Hasselmann K, Hasselmann K, Allender JH, Barnett TP. 1985.
Computations and parameterizations of the nonlinear
energy transfer in a gravity-wave specturm. Part II: parame-
terizations of the nonlinear energy transfer for application
in wave models. J Phys Oceanogr. 15:1378–1391.

Hsu T, Ou S, Liau J. 2005. Hindcasting nearshore wind waves
using a FEM code for SWAN. Coast Eng. 52:177–195.

JOURNAL OF OPERATIONAL OCEANOGRAPHY 13

http://orcid.org/0000-0003-2656-2311
http://orcid.org/0000-0002-9026-3976
http://orcid.org/0000-0002-3450-6697
http://orcid.org/0000-0002-3450-6697


Komen GJ, Hasselmann S, Hasselmann K. 1984. On the exist-
ence of a fully developed wind-sea spectrum. J Phys
Oceanogr. 14:1271–1285.

Lin-Ye J, Garcia-Leon M, Gracia V, Sanchez-Arcilla A.
Forthcoming 2016. A multivariate model of NW
Mediterranean extreme events: hydrodynamics, energy
and duration. Coast Eng.

Pallares E. 2016. High-resolution wave forecasting. The
Catalan coast case. Modelling, coupling and validation
[Ph.D. thesis]. Barcelona: Universitat Politecnica de
Catalunya.

Pallares E, Sánchez-Arcilla A, Espino M. 2014. Wave energy
balance in wave models (SWAN) for semi-enclosed
domains – application to the Catalan coast. Cont Shelf Res
87:41–53.

Ris R, Holthuijsen L, Booij N. 1999. A third-generation wave
model for coastal regions: 2. Verification. J Geophys Res.
104:7667–7681.

Sánchez-Arcilla A, González-Marco D, Bolaños R. 2008. A
review of wave climate and prediction along the Spanish
Mediterranean coast. Nat Hazards Earth Syst Sci. 8:1217–
1228.

Sánchez-Arcilla A, Wolf J, Monbaliu J. 2014. Oceanography at
coastal scales: introduction to the special issue on results
from the EU FP7 FIELD_AC project. Cont Shelf Res.
87:1–6.

Siadatmousavi S, Jose F, Miot da Silva G. 2015. Sensitivity of a
third generationwavemodel towindandboundary condition
sources and model physics: a case study from the south
Atlantic Ocean off Brazil coast. Comput Geosci. 90:57–65.

Snyder RL, Dobson FW, Elliott JA, Long RB. 1981. Array
measurements of atmospheric pressure fluctuations above
surface gravity waves. J. Fluid Mech. 102:1–59.

SWAN team. 2015a. SWAN user’s manual. SWAN Cycle III
version 40.91A. Delft University of Technology. Technical
documentation.

SWAN team. 2015b. SWAN scientific and technical documen-
tation. SWAN Cycle III version 40.91A. Delft University of
Technology. Technical documentation.

Taylor K. 2001. Summarizing multiple aspects of model per-
formance in a single diagram. J Geophys Res Atmos.
106:7183–7192.

Unden P, Rontu L, Jarrinen H, Lynch P, Calvo J, Cats G,
Cuxart J, Eerola K, Fortelius C, Garcia-Moya JA, et al.
2002. HIRLAM-5 scientific documentation. Available
from: www.hirlam.org

WAMDI group. 1988. The WAM model – a third generation
ocean wave prediction model. J Phys Oceanogr. 18:1775–
1810.

Zijlema M. 2010. Computation of wind-wave spectra in coastal
waters with SWAN on unstructured grids. Coast Eng.
57:267–277.

14 E. PALLARES ET AL.

http://www.hirlam.org

	Abstract
	1. Introduction
	2. Methodology
	2.1 Study area
	2.2 The SWAN model
	2.3 Unstructured grids
	2.4 Experimental configuration
	2.5 Data available
	2.6 Computational structure

	3. Results
	3.1 Validation tools
	3.2 Yearly analysis
	3.3 Storm analysis
	3.4 Computational time requirements

	4. Discussion
	5. Conclusions
	Acknowledgements
	Disclosure Statement
	ORCID
	References



